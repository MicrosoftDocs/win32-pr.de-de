---
description: Kubische Umgebungs Zuordnungen (manchmal auch als Cubemaps bezeichnet) sind Texturen, die Bilddaten enthalten, die die Szene darstellen, die ein Objekt umgibt, als ob sich das Objekt in der Mitte eines Cubes befand.
ms.assetid: 4879d59b-e6d3-4811-ab2c-bcce8f214e1c
title: Kubische Umgebungs Zuordnung (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cecac83db067224195883485bcbd282aa82ae4b5
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104393210"
---
# <a name="cubic-environment-mapping-direct3d-9"></a><span data-ttu-id="727d3-103">Kubische Umgebungs Zuordnung (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="727d3-103">Cubic Environment Mapping (Direct3D 9)</span></span>

<span data-ttu-id="727d3-104">Kubische Umgebungs Zuordnungen (manchmal auch als Cubemaps bezeichnet) sind Texturen, die Bilddaten enthalten, die die Szene darstellen, die ein Objekt umgibt, als ob sich das Objekt in der Mitte eines Cubes befand.</span><span class="sxs-lookup"><span data-stu-id="727d3-104">Cubic environment maps - sometimes referred to as cube maps - are textures that contain image data representing the scene surrounding an object, as if the object were in the center of a cube.</span></span> <span data-ttu-id="727d3-105">Jedes Gesicht der kubischen Umgebungs Zuordnung deckt ein 90-Grad-Feld der Sicht in horizontaler und vertikaler Sicht ab, und es gibt sechs Gesichter pro cubemap.</span><span class="sxs-lookup"><span data-stu-id="727d3-105">Each face of the cubic environment map covers a 90-degree field of view in the horizontal and vertical, and there are six faces per cube map.</span></span> <span data-ttu-id="727d3-106">Die Ausrichtung der Flächen wird in der folgenden Abbildung dargestellt.</span><span class="sxs-lookup"><span data-stu-id="727d3-106">The orientation of the faces is shown in the following illustration.</span></span>

![Abbildung eines Cubes mit zentralen Koordinatenachsen, der in den Cube-Gesichtern senkrecht ist](images/cubemap-cube.png)

<span data-ttu-id="727d3-108">Jedes Gesicht des Cubes ist senkrecht zur x/y-, y/z-oder x/z-Ebene im Raum der Welt ausgerichtet.</span><span class="sxs-lookup"><span data-stu-id="727d3-108">Each face of the cube is oriented perpendicular to the x/y, y/z, or x/z plane, in world space.</span></span> <span data-ttu-id="727d3-109">In der folgenden Abbildung wird gezeigt, wie die einzelnen Ebenen einem Gesicht entsprechen.</span><span class="sxs-lookup"><span data-stu-id="727d3-109">The following illustration shows how each plane corresponds to a face.</span></span>

![Abbildung der Cube-Gesichter mit Koordinaten Projektionen von Ebenen](images/cube-faces.png)

<span data-ttu-id="727d3-111">Kubische Umgebungs Zuordnungen werden als eine Reihe von Textur Objekten implementiert.</span><span class="sxs-lookup"><span data-stu-id="727d3-111">Cubic environment maps are implemented as a series of texture objects.</span></span> <span data-ttu-id="727d3-112">Anwendungen können statische Bilder für die Zuordnung von kubischen Umgebungen verwenden, oder Sie können in die Flächen der cubemap hinein Rendering werden, um eine dynamische Umgebungs Zuordnung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="727d3-112">Applications can use static images for cubic environment mapping, or they can render into the faces of the cube map to perform dynamic environment mapping.</span></span> <span data-ttu-id="727d3-113">Diese Technik erfordert, dass die cubezuordnungs-Oberflächen gültige renderzieloberflächen darstellen, die mit dem \_ festgelegten Flag D3DUSAGE renderTarget erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="727d3-113">This technique requires that the cube-map surfaces be valid render-target surfaces, created with the D3DUSAGE\_RENDERTARGET flag set.</span></span>

<span data-ttu-id="727d3-114">Die Gesichter einer cubemap müssen keine äußerst detaillierten Renderings der umgebenden Szene enthalten.</span><span class="sxs-lookup"><span data-stu-id="727d3-114">The faces of a cube map don't need to contain extremely detailed renderings of the surrounding scene.</span></span> <span data-ttu-id="727d3-115">In den meisten Fällen werden Umgebungs Zuordnungen auf gekrümmte Oberflächen angewendet.</span><span class="sxs-lookup"><span data-stu-id="727d3-115">In most cases, environment maps are applied to curved surfaces.</span></span> <span data-ttu-id="727d3-116">Aufgrund der von den meisten Anwendungen verwendeten Krümmung wird die resultierende reflektierenden Verzerrung in der Umgebungs Zuordnung in Bezug auf Arbeitsspeicher und renderingaufwand in Bezug auf den Arbeitsspeicher verschwendet.</span><span class="sxs-lookup"><span data-stu-id="727d3-116">Given the amount of curvature used by most applications, the resulting reflective distortion makes extreme detail in the environment map wasteful in terms of memory and rendering overhead.</span></span>

## <a name="mipmapped-cubic-environment-maps"></a><span data-ttu-id="727d3-117">Mipzugeordnete kubische Umgebungs Zuordnungen</span><span class="sxs-lookup"><span data-stu-id="727d3-117">Mipmapped Cubic Environment Maps</span></span>

<span data-ttu-id="727d3-118">Cubemaps können mipzugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="727d3-118">Cube maps can be mipmapped.</span></span> <span data-ttu-id="727d3-119">Legen Sie zum Erstellen einer mipzugeordneten cubemap den Levels-Parameter der Methode " [**kreatecubetexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createcubetexture) " auf die gewünschte Anzahl von Ebenen fest.</span><span class="sxs-lookup"><span data-stu-id="727d3-119">To create a mipmapped cube map, set the Levels parameter of the [**CreateCubeTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createcubetexture) method to the number of levels that you want.</span></span> <span data-ttu-id="727d3-120">Sie können die Topografie dieser Oberflächen wie in der folgenden Abbildung dargestellt sehen.</span><span class="sxs-lookup"><span data-stu-id="727d3-120">You can envision the topography of these surfaces as shown in the following diagram.</span></span>

![Diagramm einer mipzugeordneten cubemap mit n MIP-Ebenen](images/cubemap-mipped.png)

<span data-ttu-id="727d3-122">Anwendungen, die mipzugeordnete kubische Umgebungs Zuordnungen erstellen, können auf jedes Gesicht zugreifen, indem Sie die [**getcubemapsurface**](/windows/desktop/api) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="727d3-122">Applications that create mipmapped cubic environment maps can access each face by calling the [**GetCubeMapSurface**](/windows/desktop/api) method.</span></span> <span data-ttu-id="727d3-123">Legen Sie zunächst den entsprechenden Wert aus dem enumerierten Typ [**D3DCUBEMAP \_ Gesichter**](./d3dcubemap-faces.md) fest, wie unter [Erstellen von kubischen Umgebungskarten Oberflächen (Direct3D 9)](creating-cubic-environment-map-surfaces.md)erläutert.</span><span class="sxs-lookup"><span data-stu-id="727d3-123">Start by setting the appropriate value from the [**D3DCUBEMAP\_FACES**](./d3dcubemap-faces.md) enumerated type, as discussed in [Creating Cubic Environment Map Surfaces (Direct3D 9)](creating-cubic-environment-map-surfaces.md).</span></span> <span data-ttu-id="727d3-124">Wählen Sie als nächstes die Ebene aus, die abgerufen werden soll, indem Sie den Parameter **getcubemapsurface** Level auf die gewünschte MipMap-Ebene festlegen.</span><span class="sxs-lookup"><span data-stu-id="727d3-124">Next, select the level to retrieve by setting the **GetCubeMapSurface** level parameter to the mipmap level that you want.</span></span> <span data-ttu-id="727d3-125">Beachten Sie, dass 0 dem Bild der obersten Ebene entspricht.</span><span class="sxs-lookup"><span data-stu-id="727d3-125">Remember that 0 corresponds with the top-level image.</span></span>

## <a name="texture-coordinates-for-cubic-environment-maps"></a><span data-ttu-id="727d3-126">Texturkoordinaten für die Karten der kubischen Umgebung</span><span class="sxs-lookup"><span data-stu-id="727d3-126">Texture Coordinates for Cubic Environment Maps</span></span>

<span data-ttu-id="727d3-127">Texturkoordinaten, die eine kubische Umgebungs Zuordnung indizieren, sind keine einfachen u-, v-Stil Koordinaten, die verwendet werden, wenn Standard Texturen angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="727d3-127">Texture coordinates that index a cubic environment map aren't simple u, v style coordinates, as used when standard textures are applied.</span></span> <span data-ttu-id="727d3-128">In der Tat werden bei kubischen Umgebungs Zuordnungen überhaupt keine Texturkoordinaten verwendet.</span><span class="sxs-lookup"><span data-stu-id="727d3-128">In fact, cubic environment maps don't use texture coordinates at all.</span></span> <span data-ttu-id="727d3-129">Anstelle eines Satzes von Texturkoordinaten benötigen kubische Umgebungs Zuordnungen einen 3D-Vektor.</span><span class="sxs-lookup"><span data-stu-id="727d3-129">In place of a set of texture coordinates, cubic environment maps require a 3D vector.</span></span> <span data-ttu-id="727d3-130">Sie müssen darauf achten, dass Sie ein ordnungsgemäßes Scheitelpunkt Format angeben.</span><span class="sxs-lookup"><span data-stu-id="727d3-130">You must take care to specify a proper vertex format.</span></span> <span data-ttu-id="727d3-131">Zusätzlich zur Angabe des Systems, wie viele Sätze von Texturkoordinaten von der Anwendung verwendet werden, müssen Sie Informationen über die Anzahl der Elemente in jeder Gruppe bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="727d3-131">In addition to telling the system how many sets of texture coordinates your application uses, you must provide information about how many elements are in each set.</span></span> <span data-ttu-id="727d3-132">Direct3D bietet zu diesem Zweck den [**D3DFVF \_ texcoordsizen**](d3dfvf-texcoordsizen.md) -Satz von Makros.</span><span class="sxs-lookup"><span data-stu-id="727d3-132">Direct3D offers the [**D3DFVF\_TEXCOORDSIZEN**](d3dfvf-texcoordsizen.md) set of macros for this purpose.</span></span> <span data-ttu-id="727d3-133">Diese Makros akzeptieren einen einzelnen Parameter, der den Index des Texturkoordinaten Satzes identifiziert, für den die Größe beschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="727d3-133">These macros accept a single parameter, identifying the index of the texture coordinate set for which the size is being described.</span></span> <span data-ttu-id="727d3-134">Im Fall eines 3D-Vektors fügen Sie das durch das D3DFVF TEXCOORDSIZE3-Makro erstellte Bitmuster ein \_ .</span><span class="sxs-lookup"><span data-stu-id="727d3-134">In the case of a 3D vector, you include the bit pattern created by the D3DFVF\_TEXCOORDSIZE3 macro.</span></span> <span data-ttu-id="727d3-135">Im folgenden Codebeispiel wird gezeigt, wie dieses Makro verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="727d3-135">The following code example shows how this macro is used.</span></span>


```
// Create a flexible vertex format descriptor for a vertex that contains
//   a position, normal, and one set of 3D texture coordinates.

DWORD dwFVF = D3DFVF_XYZ | D3DFVF_NORMAL | D3DFVF_TEX1 | D3DFVF_TEXCOORDSIZE3(0); 
```



<span data-ttu-id="727d3-136">In einigen Fällen, z. b. bei der diffuses Licht Zuordnung, verwenden Sie den Vertex-Zeichenbereich für den Vektor.</span><span class="sxs-lookup"><span data-stu-id="727d3-136">In some cases, such as diffuse light mapping, you use the camera-space vertex normal for the vector.</span></span> <span data-ttu-id="727d3-137">In anderen Fällen, z. b. in der Glanz Umgebungs Zuordnung, verwenden Sie einen Reflektionsvektor.</span><span class="sxs-lookup"><span data-stu-id="727d3-137">In other cases, like specular environment mapping, you use a reflection vector.</span></span> <span data-ttu-id="727d3-138">Da transformierte Vertex-Normale weitgehend verstanden werden, konzentrieren sich die Informationen hier auf das Berechnen eines reflektionvevektors.</span><span class="sxs-lookup"><span data-stu-id="727d3-138">Because transformed vertex normals are widely understood, the information here concentrates on computing a reflection vector.</span></span>

<span data-ttu-id="727d3-139">Wenn Sie einen reflektionvektor selbst berechnen, müssen Sie die Position der einzelnen Scheitel Punkte und einen Vektor vom Standpunkt bis zu diesem Scheitelpunkt verstehen.</span><span class="sxs-lookup"><span data-stu-id="727d3-139">Computing a reflection vector on your own requires understanding of the position of each vertex, and of a vector from the viewpoint to that vertex.</span></span> <span data-ttu-id="727d3-140">Direct3D kann die reflektionvektoren für Ihre Geometrie automatisch berechnen.</span><span class="sxs-lookup"><span data-stu-id="727d3-140">Direct3D can automatically compute the reflection vectors for your geometry.</span></span> <span data-ttu-id="727d3-141">Die Verwendung dieser Funktion spart Speicherplatz, da Sie keine Texturkoordinaten für die Umgebungs Zuordnung einschließen müssen.</span><span class="sxs-lookup"><span data-stu-id="727d3-141">Using this feature saves memory because you don't need to include texture coordinates for the environment map.</span></span> <span data-ttu-id="727d3-142">Außerdem wird die Bandbreite reduziert, und im Fall eines T&L HAL-Geräts kann es deutlich schneller sein als die Berechnungen, die Ihre Anwendung selbst durchführen kann.</span><span class="sxs-lookup"><span data-stu-id="727d3-142">It also reduces bandwidth and, in the case of a T&L HAL Device, it can be significantly faster than the computations that your application can make on its own.</span></span> <span data-ttu-id="727d3-143">Um dieses Feature zu verwenden, legen Sie in der Textur Phase, in der die kubische Umgebungs Zuordnung enthalten ist, den \_ Status D3DTSS texcoordindex Textur Phase auf eine Kombination aus dem D3DTSS \_ TCI \_ cameraspacereflectionvector-Member von [**D3DTEXTURESTAGESTATETYPE**](./d3dtexturestagestatetype.md) und dem Index eines Texturkoordinaten Satzes fest.</span><span class="sxs-lookup"><span data-stu-id="727d3-143">To use this feature, in the texture stage that contains the cubic environment map, set the D3DTSS\_TEXCOORDINDEX texture stage state to a combination of the D3DTSS\_TCI\_CAMERASPACEREFLECTIONVECTOR member of [**D3DTEXTURESTAGESTATETYPE**](./d3dtexturestagestatetype.md) and the index of a texture coordinate set.</span></span> <span data-ttu-id="727d3-144">In einigen Situationen, z. b. bei der diffuses Licht Zuordnung, können Sie den D3DTSS \_ TCI \_ cameraspacenormale-Member von **D3DTEXTURESTAGESTATETYPE** verwenden, der bewirkt, dass das System den transformierten Scheitelpunkt (Scheitelpunkt) als Adressierungs Vektor für die Textur verwendet.</span><span class="sxs-lookup"><span data-stu-id="727d3-144">In some situations, like diffuse light mapping, you might use the D3DTSS\_TCI\_CAMERASPACENORMAL member of **D3DTEXTURESTAGESTATETYPE**, which causes the system to use the transformed, camera-space, vertex normal as the addressing vector for the texture.</span></span> <span data-ttu-id="727d3-145">Der Index wird nur vom System verwendet, um den Wrapping Modus für die Textur zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="727d3-145">The index is only used by the system to determine the wrapping mode for the texture.</span></span>

<span data-ttu-id="727d3-146">Das folgende Codebeispiel zeigt, wie dieser Wert verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="727d3-146">The following code example shows how this value is used.</span></span>


```
// The m_d3dDevice variable is a valid pointer
// to an IDirect3DDevice9 interface.

// Automatically generate texture coordinates for stage 2.
// This assumes that stage 2 is assigned a cube map.
// Use the wrap mode from the texture coordinate set at index 1.

m_d3dDevice->SetTextureStageState( 2, D3DTSS_TEXCOORDINDEX,
                                   D3DTSS_TCI_CAMERASPACEREFLECTIONVECTOR | 1); 
```



<span data-ttu-id="727d3-147">Wenn Sie die automatische Generierung von Texturkoordinaten aktivieren, verwendet das System eines von zwei Formeln, um den reflektionvektor für jeden Scheitelpunkt zu berechnen.</span><span class="sxs-lookup"><span data-stu-id="727d3-147">When you enable automatic texture coordinate generation, the system uses one of two formulas to compute the reflection vector for each vertex.</span></span> <span data-ttu-id="727d3-148">Wenn der D3DRS \_ localviewer-Rendering-Zustand auf **true** festgelegt ist, wird die folgende Formel verwendet.</span><span class="sxs-lookup"><span data-stu-id="727d3-148">When the D3DRS\_LOCALVIEWER render state is set to **TRUE**, the following formula is used.</span></span>

![Formel des reflektionvevektors (r = 2 (EXN) n-e)](images/reflection-vector-local.png)

<span data-ttu-id="727d3-150">In der vorangehenden Formel ist R der zu berechnende reflektionvektor, E ist der normalisierte Positions-zu-Auge-Vektor, und N ist der Vertex-Raum des Kamera Raums.</span><span class="sxs-lookup"><span data-stu-id="727d3-150">In the preceding formula, R is the reflection vector being computed, E is the normalized position-to-eye vector, and N is the camera-space vertex normal.</span></span>

<span data-ttu-id="727d3-151">Wenn der D3DRS \_ localviewer-Rendering-Zustand auf **false** festgelegt ist, verwendet das System die folgende Formel.</span><span class="sxs-lookup"><span data-stu-id="727d3-151">When the D3DRS\_LOCALVIEWER render state is set to **FALSE**, the system uses the following formula.</span></span>

![Formel des reflektionvevektors (r = 2nzn-i)](images/reflection-vector-nonlocal.png)

<span data-ttu-id="727d3-153">Die R-und N-Elemente in dieser Formel sind mit der vorherigen Formel identisch.</span><span class="sxs-lookup"><span data-stu-id="727d3-153">The R and N elements in this formula are identical to the previous formula.</span></span> <span data-ttu-id="727d3-154">Das N<sub>Z</sub> -Element ist der Raum z des Scheitel Punkts normal, und ich bin der Vektor (0, 0, 1) eines unendlich entfernten Standpunkts.</span><span class="sxs-lookup"><span data-stu-id="727d3-154">The N<sub>Z</sub> element is the world-space z of the vertex normal, and I is the vector (0,0,1) of an infinitely distant viewpoint.</span></span> <span data-ttu-id="727d3-155">Das System verwendet den reflektionvektor aus beiden Formeln, um die entsprechende Oberfläche der cubemap auszuwählen und zu adressieren.</span><span class="sxs-lookup"><span data-stu-id="727d3-155">The system uses the reflection vector from either formula to select and address the appropriate face of the cube map.</span></span>

> [!Note]  
> <span data-ttu-id="727d3-156">In den meisten Fällen sollten Anwendungen die automatische Normalisierung von Scheitelpunkt normalen aktivieren.</span><span class="sxs-lookup"><span data-stu-id="727d3-156">In most cases, applications should enable automatic normalization of vertex normals.</span></span> <span data-ttu-id="727d3-157">Legen Sie zu diesem Zweck D3DRS \_ normalizenormals auf **true** fest.</span><span class="sxs-lookup"><span data-stu-id="727d3-157">To do this, set D3DRS\_NORMALIZENORMALS to **TRUE**.</span></span> <span data-ttu-id="727d3-158">Wenn Sie diesen renderzustand nicht aktivieren, unterscheidet sich die Darstellung der Umgebungs Zuordnung erheblich von dem, was Sie möglicherweise erwarten.</span><span class="sxs-lookup"><span data-stu-id="727d3-158">If you do not enable this render state, the appearance of the environment map will be drastically different than you might expect.</span></span>

 

<span data-ttu-id="727d3-159">Weitere Informationen finden Sie im folgenden Thema.</span><span class="sxs-lookup"><span data-stu-id="727d3-159">Additional information is contained in the following topic.</span></span>

-   [<span data-ttu-id="727d3-160">Erstellen von kubischen Umgebungs Zuordnungs Oberflächen (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="727d3-160">Creating Cubic Environment Map Surfaces (Direct3D 9)</span></span>](creating-cubic-environment-map-surfaces.md)

## <a name="related-topics"></a><span data-ttu-id="727d3-161">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="727d3-161">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="727d3-162">Umgebungs Zuordnung</span><span class="sxs-lookup"><span data-stu-id="727d3-162">Environment Mapping</span></span>](environment-mapping.md)
</dt> </dl>

 

 
