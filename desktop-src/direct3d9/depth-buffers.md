---
description: Ein tiefen Puffer, der häufig als z-Puffer oder w-Puffer bezeichnet wird, ist eine Eigenschaft des Geräts, das die von Direct3D zu verwendenden Tiefeninformationen speichert.
ms.assetid: vs|directx_sdk|~\depth_buffers.htm
title: Tiefen Puffer (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fc1ab41ba98ca5e3b08980ac90a572a19fc8a72a
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "104481550"
---
# <a name="depth-buffers-direct3d-9"></a><span data-ttu-id="027e8-103">Tiefen Puffer (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="027e8-103">Depth Buffers (Direct3D 9)</span></span>

<span data-ttu-id="027e8-104">Ein tiefen Puffer, der häufig als z-Puffer oder w-Puffer bezeichnet wird, ist eine Eigenschaft des Geräts, das die von Direct3D zu verwendenden Tiefeninformationen speichert.</span><span class="sxs-lookup"><span data-stu-id="027e8-104">A depth buffer, often called a z-buffer or a w-buffer, is a property of the device that stores depth information to be used by Direct3D.</span></span> <span data-ttu-id="027e8-105">Wenn Direct3D eine Szene in eine Ziel Oberfläche rendert, kann der Arbeitsspeicher in einer zugeordneten Tiefe Puffer Oberfläche als Arbeitsbereich verwendet werden, um zu bestimmen, wie die Pixel der gerachtelten Polygone einander einlesen.</span><span class="sxs-lookup"><span data-stu-id="027e8-105">When Direct3D renders a scene to a target surface, it can use the memory in an associated depth-buffer surface as a workspace to determine how the pixels of rasterized polygons occlude one another.</span></span> <span data-ttu-id="027e8-106">Direct3D verwendet eine Off-Screen Direct3D-Oberfläche als Ziel, auf das endgültige Farbwerte geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="027e8-106">Direct3D uses an off-screen Direct3D surface as the target to which final color values are written.</span></span> <span data-ttu-id="027e8-107">Die Tiefe-Puffer-Oberfläche, die der Renderziel-Oberfläche zugeordnet ist, wird zum Speichern von Tiefeninformationen verwendet, die Aufschluss darüber gibt Direct3D wie tief jedes sichtbare Pixel in der Szene ist.</span><span class="sxs-lookup"><span data-stu-id="027e8-107">The depth-buffer surface that is associated with the render-target surface is used to store depth information that tells Direct3D how deep each visible pixel is in the scene.</span></span>

<span data-ttu-id="027e8-108">Wenn eine Szene mit aktivierter tiefen Pufferung gerendert wird, wird jeder Punkt auf der Rendering-Oberfläche getestet.</span><span class="sxs-lookup"><span data-stu-id="027e8-108">When a scene is rasterized with depth buffering enabled, each point on the rendering surface is tested.</span></span> <span data-ttu-id="027e8-109">Die Werte im tiefen Puffer können die z-Koordinate eines Punkts oder seine homogene w-Koordinate sein, von der Position (x, y, z, w) des Punkts im Projektions Bereich.</span><span class="sxs-lookup"><span data-stu-id="027e8-109">The values in the depth buffer can be a point's z-coordinate or its homogeneous w-coordinate - from the point's (x,y,z,w) location in projection space.</span></span> <span data-ttu-id="027e8-110">Ein tiefen Puffer, der z-Werte verwendet, wird häufig als z-Puffer bezeichnet, und ein tiefen Puffer, der w-Werte verwendet, wird als w-Buffer bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="027e8-110">A depth buffer that uses z values is often called a z-buffer, and one that uses w values is called a w-buffer.</span></span> <span data-ttu-id="027e8-111">Jeder Typ von tiefen Puffern hat vor-und Nachteile, die später erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="027e8-111">Each type of depth buffer has advantages and disadvantages, which are discussed later.</span></span>

<span data-ttu-id="027e8-112">Zu Beginn des Tests wird der tiefen Wert im tiefen Puffer auf den größtmöglichen Wert für die Szene festgelegt.</span><span class="sxs-lookup"><span data-stu-id="027e8-112">At the beginning of the test, the depth value in the depth buffer is set to the largest possible value for the scene.</span></span> <span data-ttu-id="027e8-113">Der Farbwert auf der Rendering-Oberfläche wird entweder auf den Wert der Hintergrundfarbe oder auf den Farbwert der Hintergrundtextur an diesem Punkt festgelegt.</span><span class="sxs-lookup"><span data-stu-id="027e8-113">The color value on the rendering surface is set to either the background color value or the color value of the background texture at that point.</span></span> <span data-ttu-id="027e8-114">Jedes Polygon in der Szene wird getestet, um zu sehen, ob es sich mit der aktuellen Koordinate (x, y) auf der Renderingoberfläche überschneidet.</span><span class="sxs-lookup"><span data-stu-id="027e8-114">Each polygon in the scene is tested to see if it intersects with the current coordinate (x,y) on the rendering surface.</span></span> <span data-ttu-id="027e8-115">Wenn dies der Fall ist, wird der tiefen Wert, der die z-Koordinate in einem z-Puffer ist, und die w-Koordinate in einem w-buffer-an der aktuellen Stelle getestet, um festzustellen, ob er kleiner als der im tiefen Puffer gespeicherte tiefen Wert ist.</span><span class="sxs-lookup"><span data-stu-id="027e8-115">If it does, the depth value - which will be the z coordinate in a z-buffer, and the w coordinate in a w-buffer - at the current point is tested to see if it is smaller than the depth value stored in the depth buffer.</span></span> <span data-ttu-id="027e8-116">Wenn die Tiefe des Polygon Werts kleiner ist, wird Sie im tiefen Puffer gespeichert, und der Farbwert des Polygons wird in den aktuellen Punkt auf der Renderingoberfläche geschrieben.</span><span class="sxs-lookup"><span data-stu-id="027e8-116">If the depth of the polygon value is smaller, it is stored in the depth buffer and the color value from the polygon is written to the current point on the rendering surface.</span></span> <span data-ttu-id="027e8-117">Wenn der tiefen Wert des Polygons zu diesem Zeitpunkt größer ist, wird das nächste Polygon in der Liste getestet.</span><span class="sxs-lookup"><span data-stu-id="027e8-117">If the depth value of the polygon at that point is larger, the next polygon in the list is tested.</span></span> <span data-ttu-id="027e8-118">Dieser Vorgang wird in der folgenden Abbildung dargestellt.</span><span class="sxs-lookup"><span data-stu-id="027e8-118">This process is shown in the following diagram.</span></span>

![Diagramm der Test tiefen Werte](images/zbuffer.png)

> [!Note]  
> <span data-ttu-id="027e8-120">Obwohl die meisten Anwendungen diese Funktion nicht verwenden, können Sie den Vergleich ändern, den Direct3D verwendet, um zu bestimmen, welche Werte im tiefen Puffer und anschließend auf der renderzieloberfläche abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="027e8-120">Although most applications don't use this feature, you can change the comparison that Direct3D uses to determine which values are placed in the depth buffer and subsequently the render-target surface.</span></span> <span data-ttu-id="027e8-121">Zu diesem Zweck ändern Sie den Wert für den D3DRS \_ zfunc-Rendering-Zustand.</span><span class="sxs-lookup"><span data-stu-id="027e8-121">To do so, change the value for the D3DRS\_ZFUNC render state.</span></span> <span data-ttu-id="027e8-122">Bei bestimmter Hardware kann das Ändern der Vergleichsfunktion hierarchische z-Tests deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="027e8-122">On some hardware, changing the compare function may disable hierarchical z testing.</span></span>

 

<span data-ttu-id="027e8-123">Fast alle Accelerators auf dem Markt unterstützen z-Pufferung, sodass z-Puffer heute die häufigste Art von tiefen Puffer ist.</span><span class="sxs-lookup"><span data-stu-id="027e8-123">Nearly all accelerators on the market support z-buffering, making z-buffers the most common type of depth buffer today.</span></span> <span data-ttu-id="027e8-124">Allerdings haben z-Puffer ihre Nachteile.</span><span class="sxs-lookup"><span data-stu-id="027e8-124">However ubiquitous, z-buffers have their drawbacks.</span></span> <span data-ttu-id="027e8-125">Aufgrund der beteiligten Mathematik werden die generierten z-Werte in einem z-Puffer tendenziell nicht gleichmäßig auf den z-Pufferbereich verteilt (in der Regel 0,0 bis 1,0, einschließlich).</span><span class="sxs-lookup"><span data-stu-id="027e8-125">Due to the mathematics involved, the generated z values in a z-buffer tend not to be distributed evenly across the z-buffer range (typically 0.0 to 1.0, inclusive).</span></span> <span data-ttu-id="027e8-126">Insbesondere wirkt sich das Verhältnis zwischen der weit verbreiteten und der Near Clipping-Ebene stark aus, wie ungleich z-Werte verteilt werden.</span><span class="sxs-lookup"><span data-stu-id="027e8-126">Specifically, the ratio between the far and near clipping planes strongly affects how unevenly z values are distributed.</span></span> <span data-ttu-id="027e8-127">Durch die Verwendung einer Entfernung der Entfernung zu einem Abstand von 100 (in der Nähe der mittleren Ebene) werden 90 Prozent des tiefen Puffer Bereichs für die ersten 10 Prozent des Bereichs der Szenen Tiefe aufgewendet.</span><span class="sxs-lookup"><span data-stu-id="027e8-127">Using a far-plane distance to near-plane distance ratio of 100, 90 percent of the depth buffer range is spent on the first 10 percent of the scene depth range.</span></span> <span data-ttu-id="027e8-128">Typische Anwendungen für Unterhaltung oder visuelle Simulationen mit äußeren Szenen erfordern häufig ein Verhältnis von einer beliebigen Ebene zwischen 1.000 und 10.000.</span><span class="sxs-lookup"><span data-stu-id="027e8-128">Typical applications for entertainment or visual simulations with exterior scenes often require far-plane/near-plane ratios of anywhere between 1,000 to 10,000.</span></span> <span data-ttu-id="027e8-129">Bei einem Verhältnis von 1.000 werden 98 Prozent des Bereichs für die ersten 2 Prozent des tiefen Bereichs aufgewendet, und die Verteilung wird mit höheren Verhältnissen schlechter.</span><span class="sxs-lookup"><span data-stu-id="027e8-129">At a ratio of 1,000, 98 percent of the range is spent on the first 2 percent of the depth range, and the distribution becomes worse with higher ratios.</span></span> <span data-ttu-id="027e8-130">Dies kann zu verdeckten Oberflächen Artefakten in entfernten Objekten führen, insbesondere bei Verwendung von 16-Bit-Tiefen Puffern, der am häufigsten unterstützten Bittiefe.</span><span class="sxs-lookup"><span data-stu-id="027e8-130">This can cause hidden surface artifacts in distant objects, especially when using 16-bit depth buffers, the most commonly supported bit-depth.</span></span>

<span data-ttu-id="027e8-131">Auf der anderen Seite ist ein w-basierter tiefen Puffer oft gleichmäßig gleichmäßig zwischen den Near-und Far-Clip-Flächen verteilt als ein z-Puffer.</span><span class="sxs-lookup"><span data-stu-id="027e8-131">A w-based depth buffer, on the other hand, is often more evenly distributed between the near and far clip planes than a z-buffer.</span></span> <span data-ttu-id="027e8-132">Der Hauptvorteil besteht darin, dass das Verhältnis der Entfernungen für die weit entfernten und die Near Clipping-Ebene kein Problem mehr ist.</span><span class="sxs-lookup"><span data-stu-id="027e8-132">The key benefit is that the ratio of distances for the far and near clipping planes is no longer an issue.</span></span> <span data-ttu-id="027e8-133">Dies ermöglicht es Anwendungen, große maximale Bereiche zu unterstützen, während Sie immer noch relativ präzise Tiefe Pufferung in der Nähe des Augen Punkts erhalten.</span><span class="sxs-lookup"><span data-stu-id="027e8-133">This allows applications to support large maximum ranges, while still getting relatively accurate depth buffering close to the eye point.</span></span> <span data-ttu-id="027e8-134">Ein w-basierter tiefen Puffer ist nicht perfekt und kann manchmal verborgene Oberflächen Artefakte für Near-Objekte aufweisen.</span><span class="sxs-lookup"><span data-stu-id="027e8-134">A w-based depth buffer isn't perfect, and can sometimes exhibit hidden surface artifacts for near objects.</span></span> <span data-ttu-id="027e8-135">Ein weiterer Nachteil des w-gepufferten Ansatzes liegt im Zusammenhang mit der Hardwareunterstützung: w-buffereing wird in Hardware nicht so weit wie z-Pufferung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="027e8-135">Another drawback to the w-buffered approach is related to hardware support: w-buffering isn't supported as widely in hardware as z-buffering.</span></span>

<span data-ttu-id="027e8-136">Die Verwendung eines z-Puffers erfordert mehr Aufwand beim Rendern.</span><span class="sxs-lookup"><span data-stu-id="027e8-136">Using a z-buffer requires overhead during rendering.</span></span> <span data-ttu-id="027e8-137">Bei der Verwendung von z-Puffern können verschiedene Techniken verwendet werden, um das Rendering zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="027e8-137">Various techniques can be used to optimize rendering when using z-buffers.</span></span> <span data-ttu-id="027e8-138">Weitere Informationen finden Sie unter [Z-Puffer Leistung](performance-optimizations.md).</span><span class="sxs-lookup"><span data-stu-id="027e8-138">For details, see [Z-Buffer Performance](performance-optimizations.md).</span></span>

> [!Note]  
> <span data-ttu-id="027e8-139">Die tatsächliche Interpretation eines tiefen Werts ist spezifisch für den Renderer.</span><span class="sxs-lookup"><span data-stu-id="027e8-139">The actual interpretation of a depth value is specific to the renderer.</span></span>

 

<span data-ttu-id="027e8-140">Dieser Abschnitt enthält Informationen zur Verwendung von tiefen Puffern für ausgeblendete und ausgeblendete Oberflächen Entfernungs</span><span class="sxs-lookup"><span data-stu-id="027e8-140">This section presents information about using depth buffers for hidden line and hidden surface removal.</span></span>

-   [<span data-ttu-id="027e8-141">Abfragen der Tiefe Puffer Unterstützung (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="027e8-141">Querying for Depth Buffer Support (Direct3D 9)</span></span>](querying-for-depth-buffer-support.md)
-   [<span data-ttu-id="027e8-142">Erstellen eines tiefen Puffers (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="027e8-142">Creating a Depth Buffer (Direct3D 9)</span></span>](creating-a-depth-buffer.md)
-   [<span data-ttu-id="027e8-143">Aktivieren der tiefen Pufferung (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="027e8-143">Enabling Depth Buffering (Direct3D 9)</span></span>](enabling-depth-buffering.md)
-   [<span data-ttu-id="027e8-144">Abrufen eines tiefen Puffers (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="027e8-144">Retrieving a Depth Buffer (Direct3D 9)</span></span>](retrieving-a-depth-buffer.md)
-   [<span data-ttu-id="027e8-145">Löschen von tiefen Puffern (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="027e8-145">Clearing Depth Buffers (Direct3D 9)</span></span>](clearing-depth-buffers.md)
-   [<span data-ttu-id="027e8-146">Ändern des Schreibzugriffs auf den Lesezugriff (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="027e8-146">Changing Depth Buffer Write Access (Direct3D 9)</span></span>](changing-depth-buffer-write-access.md)
-   [<span data-ttu-id="027e8-147">Ändern von tiefen Puffer Vergleichsfunktionen (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="027e8-147">Changing Depth Buffer Comparison Functions (Direct3D 9)</span></span>](changing-depth-buffer-comparison-functions.md)

## <a name="related-topics"></a><span data-ttu-id="027e8-148">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="027e8-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="027e8-149">Direct3D-Rendering</span><span class="sxs-lookup"><span data-stu-id="027e8-149">Direct3D Rendering</span></span>](direct3d-rendering.md)
</dt> </dl>

 

 



