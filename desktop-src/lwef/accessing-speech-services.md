---
title: Zugreifen auf Speech-Dienste (Microsoft Agent-Serverschnittstelle)
description: Erfahren Sie mehr über den Zugriff auf Spracherkennungsdienste mit der Microsoft Agent-Serverschnittstelle. Microsoft Agent ist ab Windows 7 veraltet.
ms.assetid: 99cf630d-3bd1-403a-833a-9173a84fe3c0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1f87bf5cf88141344d5328592c9e823c7365c5d5
ms.sourcegitcommit: d0eb44d0a95f5e5efbfec3d3e9c143f5cba25bc3
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/17/2021
ms.locfileid: "112262702"
---
# <a name="accessing-speech-services-microsoft-agent-server-interface"></a><span data-ttu-id="0add8-104">Zugreifen auf Speech-Dienste (Microsoft Agent-Serverschnittstelle)</span><span class="sxs-lookup"><span data-stu-id="0add8-104">Accessing Speech Services (Microsoft Agent Server Interface)</span></span>

<span data-ttu-id="0add8-105">\[Microsoft Agent ist ab Windows 7 veraltet und in nachfolgenden Versionen von Windows möglicherweise nicht mehr verfügbar.\]</span><span class="sxs-lookup"><span data-stu-id="0add8-105">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="0add8-106">Obwohl die Dienste von Microsoft Agent Unterstützung für die Spracheingabe bieten, muss eine kompatible Engine für die Spracherkennung installiert werden, um auf die Spracheingabedienste des Agents zugreifen zu können.</span><span class="sxs-lookup"><span data-stu-id="0add8-106">Although Microsoft Agent's services include support for speech input, a compatible command-and-control speech recognition engine must be installed to access Agent's speech input services.</span></span> <span data-ttu-id="0add8-107">Wenn Sie die Sprachdienste von Microsoft Agent verwenden möchten, um die synthetisierte Sprachausgabe für ein Zeichen zu unterstützen, müssen Sie eine kompatible Spracherkennungs-Engine (Text-to-Speech, TTS) für Ihr Zeichen installieren.</span><span class="sxs-lookup"><span data-stu-id="0add8-107">Similarly, if you want to use Microsoft Agent's speech services to support synthesized speech output for a character, you must install a compatible text-to-speech (TTS) speech engine for your character.</span></span> <span data-ttu-id="0add8-108">Da die Sprachdienste von Microsoft Agent auf der Microsoft Speech-API (SAPI) basieren, können Sie alle Engines verwenden, die die erforderlichen Sprachschnittstellen inkompatibel unterstützen.</span><span class="sxs-lookup"><span data-stu-id="0add8-108">Because Microsoft Agent's speech services are based on the Microsoft Speech API (SAPI), you can use any engines that compatibly support the required speech interfaces.</span></span>

<span data-ttu-id="0add8-109">Definieren Sie zum Aktivieren der Spracheingabeunterstützung in Ihrer Anwendung ein [**Command-Objekt,**](https://www.bing.com/search?q=**Command**) und legen Sie dessen [**Voice-Eigenschaft**](https://www.bing.com/search?q=**Voice**) fest.</span><span class="sxs-lookup"><span data-stu-id="0add8-109">To enable speech input support in your application, define a [**Command**](https://www.bing.com/search?q=**Command**) object and set its [**Voice**](https://www.bing.com/search?q=**Voice**) property.</span></span> <span data-ttu-id="0add8-110">Microsoft Agent wird automatisch Spracherkennungsdienste laden, sodass die Spracherkennungs-Engine geladen wird, wenn der Benutzer die Taste "Lauschen" drückt oder "Lauschen" aufruft. [](https://www.bing.com/search?q=**Listen**)</span><span class="sxs-lookup"><span data-stu-id="0add8-110">Microsoft Agent will automatically load speech services, so that when the user presses the Listening key or you call [**Listen**](https://www.bing.com/search?q=**Listen**), the speech recognition engine will be loaded.</span></span> <span data-ttu-id="0add8-111">Standardmäßig bestimmt die Sprach-ID des Zeichens, welche Engine geladen wird.</span><span class="sxs-lookup"><span data-stu-id="0add8-111">By default the character's language ID will determine which engine is loaded.</span></span> <span data-ttu-id="0add8-112">Der Agent versucht, die erste Engine zu laden, die SAPI als mit dieser Sprache übereinstimmend zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="0add8-112">Agent attempts to load the first engine that SAPI returns as matching this language.</span></span> <span data-ttu-id="0add8-113">Verwenden **Sie IAgentCharacterEx::SetSRModeID,** wenn Sie eine bestimmte Engine laden möchten.</span><span class="sxs-lookup"><span data-stu-id="0add8-113">Use **IAgentCharacterEx::SetSRModeID** if you want to load a specific engine.</span></span>

<span data-ttu-id="0add8-114">Verwenden Sie zum Aktivieren der Sprachtextausgabe die [**Speak-Methode.**](https://www.bing.com/search?q=**Speak**)</span><span class="sxs-lookup"><span data-stu-id="0add8-114">To enable text-to-speech output, use the [**Speak**](https://www.bing.com/search?q=**Speak**) method.</span></span> <span data-ttu-id="0add8-115">Microsoft Agent versucht automatisch, eine Engine zu laden, die der Sprach-ID des Zeichens entspricht.</span><span class="sxs-lookup"><span data-stu-id="0add8-115">Microsoft Agent will automatically attempt to load an engine that matches the character's language ID.</span></span> <span data-ttu-id="0add8-116">Wenn die Definition des Zeichens eine bestimmte TTS-Engine-Modus-ID enthält und diese Engine verfügbar ist und der Sprach-ID des Zeichens entspricht, lädt der -Agent diese Engine für das Zeichen.</span><span class="sxs-lookup"><span data-stu-id="0add8-116">If the character's definition includes a specific TTS engine mode ID and that engine is available and matches the character's language ID, Agent loads that engine for the character.</span></span> <span data-ttu-id="0add8-117">Falls nicht, lädt der -Agent die erste TTS-Engine, die SAPI als mit der Spracheinstellung des Zeichens übereinstimmend zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="0add8-117">If not, Agent loads the first TTS engine that SAPI returns as matching the character's language setting.</span></span> <span data-ttu-id="0add8-118">Sie können auch **IAgentCharacterEx::SetTTSModeID** verwenden, um eine bestimmte Engine zu laden.</span><span class="sxs-lookup"><span data-stu-id="0add8-118">You can also use **IAgentCharacterEx::SetTTSModeID** to load a specific engine.</span></span>

<span data-ttu-id="0add8-119">In der Regel lädt Microsoft Agent eine Spracherkennungs-Engine, wenn der Lauschenmodus initiiert wird, und lädt eine Text-to-Speech-Engine, wenn [**Speak**](https://www.bing.com/search?q=**Speak**) zum ersten Mal aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="0add8-119">Typically, Microsoft Agent loads a speech recognition engine when the Listening mode is initiated and loads a text-to-speech engine when [**Speak**](https://www.bing.com/search?q=**Speak**) is first called.</span></span> <span data-ttu-id="0add8-120">Wenn Sie jedoch die Sprach-Engine vorab laden möchten, können Sie dazu die Eigenschaften abfragen, die sich auf die Sprachschnittstellen bezieht.</span><span class="sxs-lookup"><span data-stu-id="0add8-120">However, if you want to preload the speech engine, you can do this by querying the properties related to the speech interfaces.</span></span> <span data-ttu-id="0add8-121">Wenn Sie beispielsweise **IAgentCharacterEx::GetSRModeID** oder **IAgentCharacterEx::GetTTSModeID** aufrufen, wird versucht, diesen Engine-Typ zu laden.</span><span class="sxs-lookup"><span data-stu-id="0add8-121">For example, calling **IAgentCharacterEx::GetSRModeID** or **IAgentCharacterEx::GetTTSModeID** will attempt to load that type of engine.</span></span>

 

 




