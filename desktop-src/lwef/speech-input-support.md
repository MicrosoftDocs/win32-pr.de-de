---
title: Spracheingabe Unterstützung
description: Spracheingabe Unterstützung
ms.assetid: 4702b941-fcc9-4d00-aba2-eca624b6d417
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8ecb6f2ddfbbe10f8b892ce922cd466eca96890
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "106340908"
---
# <a name="speech-input-support"></a><span data-ttu-id="3ba73-103">Spracheingabe Unterstützung</span><span class="sxs-lookup"><span data-stu-id="3ba73-103">Speech Input Support</span></span>

<span data-ttu-id="3ba73-104">\[Der Microsoft-Agent ist ab Windows 7 veraltet und in nachfolgenden Versionen von Windows möglicherweise nicht verfügbar.\]</span><span class="sxs-lookup"><span data-stu-id="3ba73-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="3ba73-105">Zusätzlich zur Unterstützung der Maus-und Tastatur Interaktion bietet der Microsoft-Agent eine direkte Unterstützung für Spracheingaben.</span><span class="sxs-lookup"><span data-stu-id="3ba73-105">In addition to supporting mouse and keyboard interaction, Microsoft Agent includes direct support for speech input.</span></span> <span data-ttu-id="3ba73-106">Da die Unterstützung von Spracheingaben durch den Microsoft-Agent auf Microsoft SAPI (Sprache Application Programming Interface) basiert, können Sie den Microsoft-Agent mit sprach Erkennungs Befehlen und Steuerungsmodulen verwenden, die die SAPI-erforderliche Unterstützung enthalten.</span><span class="sxs-lookup"><span data-stu-id="3ba73-106">Because Microsoft Agent's support for speech input is based on Microsoft SAPI (Speech Application Programming Interface), you can use Microsoft Agent with speech recognition command and control engines that include the SAPI-required support.</span></span> <span data-ttu-id="3ba73-107">Weitere Informationen zu den Anforderungen an die Sprach-Engine finden Sie [unter Support Anforderungen für sprach](requirements-for-speech-recognition-engines.md)Modul.</span><span class="sxs-lookup"><span data-stu-id="3ba73-107">For more information on speech engine requirements, see [Speech Engine Support Requirements](requirements-for-speech-recognition-engines.md).</span></span>

<span data-ttu-id="3ba73-108">Microsoft stellt ein sprach Erkennungs Modul für die Befehls-und Steuerelemente bereit, das Sie mit dem Microsoft-Agent verwenden können.</span><span class="sxs-lookup"><span data-stu-id="3ba73-108">Microsoft provides a command-and-control speech recognition engine you can use with Microsoft Agent.</span></span> <span data-ttu-id="3ba73-109">Weitere Informationen finden Sie unter [Sprach-Engine-Auswahl](speech-engine-selection.md).</span><span class="sxs-lookup"><span data-stu-id="3ba73-109">For more information, see [Speech Engine Selection](speech-engine-selection.md).</span></span>

<span data-ttu-id="3ba73-110">Der Benutzer kann Spracheingaben initiieren, indem er den Push-to-Talk-lausch Hotkey drückt und hält.</span><span class="sxs-lookup"><span data-stu-id="3ba73-110">The user can initiate speech input by pressing and holding the push-to-talk Listening hotkey.</span></span> <span data-ttu-id="3ba73-111">Wenn die Sprach-Engine in diesem Empfangsmodus den Anfang der gesprochenen Eingabe empfängt, hält Sie den Audiokanal geöffnet, bis das Ende der Ausdrucks Zeile erkannt wird.</span><span class="sxs-lookup"><span data-stu-id="3ba73-111">In this Listening mode, if the speech engine receives the beginning of spoken input, it holds the audio channel open until it detects the end of the utterance.</span></span> <span data-ttu-id="3ba73-112">Beim Empfang von Eingaben wird die Audioausgabe jedoch nicht blockiert.</span><span class="sxs-lookup"><span data-stu-id="3ba73-112">However, when not receiving input, it does not block audio output.</span></span> <span data-ttu-id="3ba73-113">Dies ermöglicht es dem Benutzer, mehrere Sprachbefehle auszugeben, während der Schlüssel gedrückt gehalten wird, und das Zeichen kann Antworten, wenn der Benutzer nicht spricht.</span><span class="sxs-lookup"><span data-stu-id="3ba73-113">This enables the user to issue multiple voice commands while holding down the key, and the character can respond when the user isn't speaking.</span></span>

<span data-ttu-id="3ba73-114">Der Modus für die Überwachung wird nach einem Timeout durch den Benutzer aufgehoben.</span><span class="sxs-lookup"><span data-stu-id="3ba73-114">The Listening mode times out once the user releases the Listening key.</span></span> <span data-ttu-id="3ba73-115">Der Benutzer kann das Timeout für diesen Modus mithilfe der erweiterten Zeichen Optionen anpassen.</span><span class="sxs-lookup"><span data-stu-id="3ba73-115">The user can adjust the time-out for this mode using the Advanced Character Options.</span></span> <span data-ttu-id="3ba73-116">Dieser Timeout kann nicht aus dem Client Anwendungscode festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="3ba73-116">You cannot set this time-out from your client application code.</span></span>

<span data-ttu-id="3ba73-117">Wenn ein Zeichen versucht, zu sprechen, während der Benutzer spricht, schlägt die akustische Ausgabe des Zeichens fehl, obwohl Text weiterhin in der Wort Sprechblase angezeigt werden kann.</span><span class="sxs-lookup"><span data-stu-id="3ba73-117">If a character attempts to speak while the user is speaking, the character's audible output fails though text may still be displayed in its word balloon.</span></span> <span data-ttu-id="3ba73-118">Wenn das Zeichen über den Audiokanal verfügt, während die Abhör Taste gedrückt wird, überträgt der Server die Steuerung automatisch an den Benutzer zurück, nachdem der Text in der [**Sprech**](speak-method.md) Methode verarbeitet wurde.</span><span class="sxs-lookup"><span data-stu-id="3ba73-118">If the character has the audio channel while the Listening key is pressed, the server automatically transfers control back to the user after processing the text in the [**Speak**](speak-method.md) method.</span></span> <span data-ttu-id="3ba73-119">Ein optionaler MIDI-Ton wird wiedergegeben, um den Benutzer zu über den Einstieg zu sprechen.</span><span class="sxs-lookup"><span data-stu-id="3ba73-119">An optional MIDI tone is played to cue the user to begin speaking.</span></span> <span data-ttu-id="3ba73-120">Dadurch kann der Benutzer auch dann Eingaben bereitstellen, wenn die Anwendung, die das Zeichen steuert, keine logischen Pausen in der Ausgabe bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="3ba73-120">This enables the user to provide input even if the application driving the character failed to provide logical pauses in its output.</span></span>

<span data-ttu-id="3ba73-121">Sie können auch die Methode " [**lauschen**](listen-method.md) " verwenden, um Spracheingaben zu initiieren.</span><span class="sxs-lookup"><span data-stu-id="3ba73-121">You can also use the [**Listen**](listen-method.md) method to initiate speech input.</span></span> <span data-ttu-id="3ba73-122">Durch Aufrufen dieser Methode wird die Spracherkennung für einen vordefinierten Zeitraum eingeschaltet.</span><span class="sxs-lookup"><span data-stu-id="3ba73-122">Calling this method turns on the speech recognition for a predefined period of time.</span></span> <span data-ttu-id="3ba73-123">Wenn während dieses Intervalls keine Eingabe erfolgt, schaltet der Microsoft-Agent die sprach Erkennungs-Engine automatisch aus und gibt den Audiokanal frei.</span><span class="sxs-lookup"><span data-stu-id="3ba73-123">If there is no input during this interval, Microsoft Agent automatically turns off the speech recognition engine and frees up the audio channel.</span></span> <span data-ttu-id="3ba73-124">Dadurch wird verhindert, dass Eingaben für das Audiogerät blockiert werden, und der Prozessor Aufwand, der von der Spracherkennung verwendet wird, wird minimiert.</span><span class="sxs-lookup"><span data-stu-id="3ba73-124">This avoids blocking input to or output from the audio device and minimizes the processor overhead the speech recognition uses when it is on.</span></span> <span data-ttu-id="3ba73-125">Sie können die **Abhör Methode auch** verwenden, um die Spracheingabe zu deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="3ba73-125">You can also use the **Listen** method to turn off speech input.</span></span> <span data-ttu-id="3ba73-126">Beachten Sie jedoch, dass der Effekt möglicherweise nicht unmittelbar ist, da die Spracherkennungs-Engine asynchron arbeitet.</span><span class="sxs-lookup"><span data-stu-id="3ba73-126">However, be aware that because the speech recognition engine operates asynchronously, the effect may not be immediate.</span></span> <span data-ttu-id="3ba73-127">Daher ist es möglich, auch dann ein [**Befehls**](command-event.md) Ereignis zu empfangen, wenn der Code " **lauschen** " aufgerufen hat, um die Spracheingabe zu deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="3ba73-127">As a result, it is possible to receive a [**Command**](command-event.md) event even after your code called **Listen** to turn off speech input.</span></span>

<span data-ttu-id="3ba73-128">Zur Unterstützung von Spracheingaben definieren Sie eine *Grammatik*, eine Reihe von Wörtern, die die sprach Erkennungs-Engine überwachen und mit der **sprach** Einstellung für einen [**Befehl**](/windows/desktop/lwef/the-command-object) in der [**Commands**](/windows/desktop/lwef/the-commands-collection-object) -Auflistung vergleichen soll.</span><span class="sxs-lookup"><span data-stu-id="3ba73-128">To support speech input, you define a *grammar*, a set of words you want the speech recognition engine to listen and match for as the **Voice** setting for a [**Command**](/windows/desktop/lwef/the-command-object) in your [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="3ba73-129">Sie können optionale und alternative Wörter und wiederholte Sequenzen in die Grammatik einschließen.</span><span class="sxs-lookup"><span data-stu-id="3ba73-129">You can include optional and alternative words and repeated sequences in your grammar.</span></span> <span data-ttu-id="3ba73-130">Beachten Sie, dass der-Agent den lauschenden Hotkey erst aktiviert, wenn einer seiner Clients eine Sprach-Engine erfolgreich geladen hat oder eine **Stimme** für eines seiner **Befehls** Objekte verfasst hat.</span><span class="sxs-lookup"><span data-stu-id="3ba73-130">Note that Agent does not enable the Listening hotkey until one of its clients has successfully loaded a speech engine or has authored a **Voice** for one of its **Command** objects.</span></span>

<span data-ttu-id="3ba73-131">Ob der Benutzer den abzurufenden Hotkey drückt, oder die Client Anwendung ruft die [**Abhör Methode auf**](listen-method.md) , um die Spracheingabe zu initiieren. die Spracherkennungs-Engine versucht, die Eingabe einer Äußerung an die Grammatik für die Befehle abzugleichen, die definiert wurden, und übergibt die Informationen zurück an den Server.</span><span class="sxs-lookup"><span data-stu-id="3ba73-131">Whether the user presses the Listening hotkey or your client application calls the [**Listen**](listen-method.md) method to initiate speech input, the speech recognition engine attempts to match an utterance's input to the grammar for the commands that have been defined, and passes the information back the server.</span></span> <span data-ttu-id="3ba73-132">Der Server benachrichtigt die Client Anwendung dann mithilfe des [**Befehls**](command-event.md) Ereignisses ([**iagentnotifysink:: Command**](iagentnotifysink--command.md)); Zurückgeben des [**UserInput**](/windows/desktop/lwef/iagentuserinput) -Objekts, das die Befehls-ID der besten Übereinstimmung und der nächsten zwei alternativen Übereinstimmungen (sofern vorhanden), ein Vertrauens Ergebnis und den übereinstimmenden Text für jede Übereinstimmung enthält.</span><span class="sxs-lookup"><span data-stu-id="3ba73-132">The server then notifies the client application using the [**Command**](command-event.md) event ([**IAgentNotifySink::Command**](iagentnotifysink--command.md)); passing back the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object that includes the command ID of the best match and next two alternative matches (if any), a confidence score, and the matching text for each match.</span></span>

<span data-ttu-id="3ba73-133">Der Server benachrichtigt auch Ihre Client Anwendung, wenn Sie mit den Spracheingaben für einen der angegebenen Befehle übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="3ba73-133">The server also notifies your client application when it matches the speech input to one of its supplied commands.</span></span> <span data-ttu-id="3ba73-134">Obwohl die Befehls-ID **null** ist, erhalten Sie immer noch das Vertrauens Ergebnis und den Text, der übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="3ba73-134">While the command ID is **NULL**, you still get the confidence score and text matched.</span></span> <span data-ttu-id="3ba73-135">Im Empfangsmodus spielt der Server automatisch die Animation, die dem Empfangs Zustand des Zeichens **zugewiesen ist.**</span><span class="sxs-lookup"><span data-stu-id="3ba73-135">When in Listening mode, the server automatically plays the animation assigned to the character's **Listening** state.</span></span> <span data-ttu-id="3ba73-136">Wenn dann eine Äußerung tatsächlich erkannt wird, gibt der Server die Animation für den **hörzustand** des Zeichens wieder.</span><span class="sxs-lookup"><span data-stu-id="3ba73-136">Then, when an utterance is actually detected, the server plays the character's **Hearing** state animation.</span></span> <span data-ttu-id="3ba73-137">Der Server verbleibt das Zeichen in einem aufmerksamen Zustand, bis die Äußerung beendet ist.</span><span class="sxs-lookup"><span data-stu-id="3ba73-137">The server will keep the character in an attentive state until the utterance has ended.</span></span> <span data-ttu-id="3ba73-138">Dies ermöglicht das entsprechende soziale Feedback, um dem Benutzer die Eingabe zu geben.</span><span class="sxs-lookup"><span data-stu-id="3ba73-138">This provides the appropriate social feedback to cue the user for input.</span></span>

<span data-ttu-id="3ba73-139">Wenn der Benutzer die Spracheingabe in erweiterten Zeichen Optionen deaktiviert, wird der lausch Ende Hotkey ebenfalls deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="3ba73-139">If the user disables speech input in Advanced Character Options, the Listening hotkey will also be disabled.</span></span> <span data-ttu-id="3ba73-140">Ebenso führt der Versuch, die [**Abhör Methode aufzurufen, wenn die sprach**](listen-method.md) Eingabe deaktiviert ist, dazu, dass die Methode fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="3ba73-140">Similarly, attempting to call the [**Listen**](listen-method.md) method when speech input is disabled will cause the method to fail.</span></span>

 

 