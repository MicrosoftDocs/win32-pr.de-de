---
title: Erstellen von Spalten Handlern
description: In der Detailansicht in Windows-Explorer werden normalerweise mehrere Standard Spalten angezeigt.
ms.assetid: 805e0e13-d09e-40f8-955b-c585f388e07e
keywords:
- Spalten Handler
- registrieren, Spalten Handler
- GetColumnInfo
- GetItemData
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 940796e75f29ba0fcfa025d9a56267e14bdff38f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "104565664"
---
# <a name="creating-column-handlers"></a><span data-ttu-id="64e02-107">Erstellen von Spalten Handlern</span><span class="sxs-lookup"><span data-stu-id="64e02-107">Creating Column Handlers</span></span>

<span data-ttu-id="64e02-108">\[Dieses Feature wird nur unter Windows XP oder früher unterstützt.</span><span class="sxs-lookup"><span data-stu-id="64e02-108">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="64e02-109">\]</span><span class="sxs-lookup"><span data-stu-id="64e02-109">\]</span></span>

<span data-ttu-id="64e02-110">In der Detailansicht in Windows-Explorer werden normalerweise mehrere Standard Spalten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="64e02-110">The Details view in the Windows Windows Explorer normally displays several standard columns.</span></span> <span data-ttu-id="64e02-111">In jeder Spalte sind Informationen, z. b. die Dateigröße oder der Datentyp, für jede Datei im aktuellen Ordner aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="64e02-111">Each column lists information, such as the file size or type, for each file in the current folder.</span></span> <span data-ttu-id="64e02-112">Durch Implementieren und Registrieren eines Spalten Handlers können Sie benutzerdefinierte Spalten zur Anzeige verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="64e02-112">By implementing and registering a column handler, you can make custom columns available for display.</span></span>

<span data-ttu-id="64e02-113">Die allgemeinen Verfahren zum Implementieren und Registrieren eines Shellerweiterungs Handlers werden unter [Erstellen von Shellerweiterungs Handlern](/windows/desktop/shell/handlers)erläutert.</span><span class="sxs-lookup"><span data-stu-id="64e02-113">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="64e02-114">Dieses Dokument konzentriert sich auf die Aspekte der Implementierung, die für Spalten Handler spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="64e02-114">This document focuses on those aspects of implementation that are specific to column handlers.</span></span>

<span data-ttu-id="64e02-115">Die folgenden Themen werden erörtert.</span><span class="sxs-lookup"><span data-stu-id="64e02-115">The following topics are discussed.</span></span>

-   [<span data-ttu-id="64e02-116">Funktionsweise von Spalten Handlern</span><span class="sxs-lookup"><span data-stu-id="64e02-116">How Column Handlers Work</span></span>](#how-column-handlers-work)
-   [<span data-ttu-id="64e02-117">Registrieren von Spalten Handlern</span><span class="sxs-lookup"><span data-stu-id="64e02-117">Registering Column Handlers</span></span>](#registering-column-handlers)
-   [<span data-ttu-id="64e02-118">Implementieren von Spalten Handlern</span><span class="sxs-lookup"><span data-stu-id="64e02-118">Implementing Column Handlers</span></span>](#implementing-column-handlers)
    -   [<span data-ttu-id="64e02-119">Die Initialize-Methode</span><span class="sxs-lookup"><span data-stu-id="64e02-119">The Initialize Method</span></span>](#the-initialize-method)
    -   [<span data-ttu-id="64e02-120">Die GetColumnInfo-Methode</span><span class="sxs-lookup"><span data-stu-id="64e02-120">The GetColumnInfo Method</span></span>](#the-getcolumninfo-method)
    -   [<span data-ttu-id="64e02-121">Die GetItemData-Methode</span><span class="sxs-lookup"><span data-stu-id="64e02-121">The GetItemData Method</span></span>](#the-getitemdata-method)

## <a name="how-column-handlers-work"></a><span data-ttu-id="64e02-122">Funktionsweise von Spalten Handlern</span><span class="sxs-lookup"><span data-stu-id="64e02-122">How Column Handlers Work</span></span>

<span data-ttu-id="64e02-123">Die folgende Abbildung zeigt den Windows-Explorer in der Detailansicht.</span><span class="sxs-lookup"><span data-stu-id="64e02-123">The following illustration shows Windows Explorer in Details view.</span></span>

![Screenshot von Windows-Explorer in der Detailansicht](images/columnproviderhandler1.jpg)

<span data-ttu-id="64e02-125">Mit Windows 2000 kann der Ordner auch eine Reihe von Spalten unterstützen, die standardmäßig nicht angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="64e02-125">With Windows 2000, the folder can also support a number of columns that, by default, are not displayed.</span></span> <span data-ttu-id="64e02-126">Der Benutzer kann weitere Spalten anzeigen, indem Sie mit der rechten Maustaste auf einen der Spaltenüberschriften klicken und im Menü den Befehl **Weitere...** auswählen.</span><span class="sxs-lookup"><span data-stu-id="64e02-126">The user can display additional columns by right-clicking one of the column headers and selecting the **More...** command from the menu.</span></span> <span data-ttu-id="64e02-127">Daraufhin wird ein Dialogfeld angezeigt, in dem die für den Ordner verfügbaren Spalten aufgeführt sind, und der Benutzer kann auswählen, welche Spalten angezeigt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="64e02-127">A dialog box then appears that lists the available columns for the folder and allows the user to select which columns to display.</span></span> <span data-ttu-id="64e02-128">Die folgende Abbildung zeigt dieses Dialogfeld für das vorherige Beispiel.</span><span class="sxs-lookup"><span data-stu-id="64e02-128">The following illustration shows this dialog box for the preceding example.</span></span>

![Screenshot von Windows-Explorer mit dem angezeigten Dialogfeld "Details auswählen"](images/columnproviderhandler2.jpg)

<span data-ttu-id="64e02-130">Durch Erstellen eines Spalten Handlers können Sie benutzerdefinierte Spalten erstellen und diese dieser Liste hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="64e02-130">By creating a column handler, you can create custom columns and add them to that list.</span></span> <span data-ttu-id="64e02-131">Eine Auflistung von Dateien, die Musik enthalten, könnte z. b. einen Spalten Handler zum Anzeigen von Spalten verwenden, in denen der in jeder Datei enthaltene Teil des Künstlers und des Stückes aufgeführt ist</span><span class="sxs-lookup"><span data-stu-id="64e02-131">For example, a collection of files that contain music could use a column handler to display columns listing the artist and piece contained by each file.</span></span>

<span data-ttu-id="64e02-132">Ein Spalten Handler ist ein globales Objekt, das jedes Mal aufgerufen wird, wenn Windows Explorer die Detailansicht anzeigt.</span><span class="sxs-lookup"><span data-stu-id="64e02-132">A column handler is a global object that is called every time Windows Explorer displays the Details view.</span></span> <span data-ttu-id="64e02-133">Spalten Handler werden jedoch normalerweise verwendet, um benutzerdefinierte Spalten nur für Member eines bestimmten [Dateityps](/windows/desktop/shell/fa-file-types)anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="64e02-133">However, column handlers are typically used to display custom columns only for members of a particular [file type](/windows/desktop/shell/fa-file-types).</span></span> <span data-ttu-id="64e02-134">Bevor die Detailansicht angezeigt wird, fragt Windows Explorer alle registrierten Spalten Handler nach den Spalten Merkmalen ab.</span><span class="sxs-lookup"><span data-stu-id="64e02-134">Before it displays the Details view, Windows Explorer queries all registered column handlers for their column characteristics.</span></span> <span data-ttu-id="64e02-135">Wenn der Benutzer eine der Spalten des Handlers ausgewählt hat, fragt Windows Explorer den Handler nach den zugeordneten Daten ab.</span><span class="sxs-lookup"><span data-stu-id="64e02-135">If the user has selected one of the handler's columns, Windows Explorer queries the handler for the associated data.</span></span> <span data-ttu-id="64e02-136">Wenn ein Spalten Handler eine Anforderung für Daten empfängt, wird er bereitstellt, wenn die Datei ein Member des unterstützten Typs ist.</span><span class="sxs-lookup"><span data-stu-id="64e02-136">When a column handler receives a request for data, it provides it if the file is a member of its supported type.</span></span> <span data-ttu-id="64e02-137">Andernfalls wird die Anforderung ignoriert, indem S false zurückgegeben wird \_ .</span><span class="sxs-lookup"><span data-stu-id="64e02-137">Otherwise, it ignores the request by returning S\_FALSE.</span></span>

## <a name="registering-column-handlers"></a><span data-ttu-id="64e02-138">Registrieren von Spalten Handlern</span><span class="sxs-lookup"><span data-stu-id="64e02-138">Registering Column Handlers</span></span>

<span data-ttu-id="64e02-139">Spalten Handler werden unter dem folgenden Unterschlüssel registriert.</span><span class="sxs-lookup"><span data-stu-id="64e02-139">Column handlers are registered under the following subkey.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
```

<span data-ttu-id="64e02-140">Erstellen Sie einen Unterschlüssel von **columnhandlers** , der mit der Zeichen folgen Form der Klassen Bezeichner-GUID (CLSID) des Handlers benannt ist.</span><span class="sxs-lookup"><span data-stu-id="64e02-140">Create a subkey of **ColumnHandlers** named with the string form of the handler's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="64e02-141">Eine allgemeine Erläuterung zum Registrieren von Shellerweiterungs Handlern finden Sie unter [Erstellen von Shellerweiterungs Handlern](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="64e02-141">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="64e02-142">Das folgende Beispiel veranschaulicht das Registrieren eines Spalten Handlers.</span><span class="sxs-lookup"><span data-stu-id="64e02-142">The following example illustrates how to register a column handler.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
            {My Column Handler CLSID GUID}
```

## <a name="implementing-column-handlers"></a><span data-ttu-id="64e02-143">Implementieren von Spalten Handlern</span><span class="sxs-lookup"><span data-stu-id="64e02-143">Implementing Column Handlers</span></span>

<span data-ttu-id="64e02-144">Wie bei allen Shellerweiterungs Handlern sind Spalten Handler in-Process-Component Object Model (com)-Objekten, die als DLLs implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="64e02-144">Like all Shell extension handlers, column handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="64e02-145">Sie exportieren die [**icolumnprovider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) -Schnittstelle zusätzlich zu [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="64e02-145">They export the [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) interface in addition to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span>

<span data-ttu-id="64e02-146">Windows-Explorer Ruft die drei von [**icolumnprovider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) exportierten Methoden auf, um die Informationen anzufordern, die zum Anzeigen der Spalte benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="64e02-146">Windows Explorer calls the three methods exported by [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) to request the information it needs to display the column.</span></span> <span data-ttu-id="64e02-147">Der Windows-Explorer verwendet Folgendes:</span><span class="sxs-lookup"><span data-stu-id="64e02-147">The procedure used by Windows Explorer is:</span></span>

1.  <span data-ttu-id="64e02-148">Nennen Sie [**icolumnprovider:: Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) , um den Ordner anzugeben, der angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="64e02-148">Call [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to specify the folder that is about to be displayed.</span></span>
2.  <span data-ttu-id="64e02-149">Rufen Sie [**icolumnprovider:: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) auf, um den Bezeichner und die Merkmale der Spalte abzurufen.</span><span class="sxs-lookup"><span data-stu-id="64e02-149">Call [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to retrieve the column's identifier and characteristics.</span></span>
3.  <span data-ttu-id="64e02-150">Wenn die Spalte vom Benutzer ausgewählt wurde, rufen Sie [**icolumnprovider:: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) für jede Datei im Ordner auf, um die Daten abzurufen, die zu dem Spalten Eintrag der Datei gehören.</span><span class="sxs-lookup"><span data-stu-id="64e02-150">If the column has been selected by the user, call [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder to retrieve the data that belongs in the file's column entry.</span></span>

### <a name="the-initialize-method"></a><span data-ttu-id="64e02-151">Die Initialize-Methode</span><span class="sxs-lookup"><span data-stu-id="64e02-151">The Initialize Method</span></span>

<span data-ttu-id="64e02-152">In Windows Explorer wird [**icolumnprovider:: Initialisieren**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) aufgerufen, um den Spalten Handler zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="64e02-152">Windows Explorer calls [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to initialize the column handler.</span></span> <span data-ttu-id="64e02-153">Die-Methode verfügt über drei Parameter, aber zurzeit wird nur *wszfolder* verwendet.</span><span class="sxs-lookup"><span data-stu-id="64e02-153">The method has three parameters, but only *wszFolder* is currently used.</span></span> <span data-ttu-id="64e02-154">Sie wird auf den Ordner festgelegt, dessen Detailansicht angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="64e02-154">It is set to the folder whose Details view is about to be displayed.</span></span> <span data-ttu-id="64e02-155">Speichern Sie den Ordnernamen für die spätere Verwendung, und initialisieren Sie das Handlerobjekt nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="64e02-155">Store the folder name for later use and initialize the handler object as needed.</span></span>

### <a name="the-getcolumninfo-method"></a><span data-ttu-id="64e02-156">Die GetColumnInfo-Methode</span><span class="sxs-lookup"><span data-stu-id="64e02-156">The GetColumnInfo Method</span></span>

<span data-ttu-id="64e02-157">Windows Explorer Next ruft [**icolumnprovider:: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) auf, um den Bezeichner und die Merkmale der Spalte anzufordern.</span><span class="sxs-lookup"><span data-stu-id="64e02-157">Windows Explorer next calls [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to request the column's identifier and characteristics.</span></span> <span data-ttu-id="64e02-158">Sie übergibt einen Index für die Spalte im *dwIndex* -Parameter.</span><span class="sxs-lookup"><span data-stu-id="64e02-158">It passes in an index for the column in the *dwIndex* parameter.</span></span> <span data-ttu-id="64e02-159">Dieser Index ist ein beliebiger Wert, der zum Aufzählen von Spalten verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="64e02-159">This index is an arbitrary value that is used to enumerate columns.</span></span> <span data-ttu-id="64e02-160">Windows-Explorer übergibt auch einen Zeiger auf eine [**shcolumninfo**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="64e02-160">Windows Explorer also passes in a pointer to an [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure.</span></span> <span data-ttu-id="64e02-161">Diese Struktur wird verwendet, um den Bezeichner und die Merkmale der Spalte zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="64e02-161">This structure is used to return the column's identifier and characteristics.</span></span> <span data-ttu-id="64e02-162">**Icolumnprovider:: GetColumnInfo** sollte den Membern der Struktur geeignete Werte zuweisen und zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="64e02-162">**IColumnProvider::GetColumnInfo** should assign appropriate values to the members of the structure and return.</span></span>

<span data-ttu-id="64e02-163">Spalten werden durch ihre OLE-Eigenschafts Satz-ID (fmtid) und eine zugehörige Eigenschaften-ID (PID) identifiziert.</span><span class="sxs-lookup"><span data-stu-id="64e02-163">Columns are identified by their OLE property set ID (FMTID) and an associated property ID (PID).</span></span> <span data-ttu-id="64e02-164">Der erste Member der [**shcolumninfo**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) -Struktur, **scid**, ist ein Zeiger auf eine [**shcolumnid**](/windows/desktop/shell/objects) -Struktur, die zum Identifizieren der Spalte verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="64e02-164">The first member of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure, **scid**, is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that is used to identify the column.</span></span> <span data-ttu-id="64e02-165">Der **fmtid** -Member der Spalte enthält die fmtid der Spalte, und sein **PID** -Element enthält die PID der Spalte.</span><span class="sxs-lookup"><span data-stu-id="64e02-165">Its **fmtid** member holds the column's FMTID, and its **pid** member holds the column's PID.</span></span> <span data-ttu-id="64e02-166">Beispielsweise ist ein Standardmäßiges fmtid/PID-Paar, das häufig verwendet wird, um Spalten zu identifizieren, die Autor-PID des Eigenschaften Satzes für Zusammenfassungs Informationen.</span><span class="sxs-lookup"><span data-stu-id="64e02-166">For example, a standard FMTID/PID pair that is commonly used to identify columns is the Author PID of the Summary Information property set.</span></span>

<span data-ttu-id="64e02-167">Wenn möglich, sollte der Handler vorhandene fmtids und PIDs verwenden, um die unterstützte Spalte zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="64e02-167">If possible, your handler should use existing FMTIDs and PIDs to identify the column it supports.</span></span> <span data-ttu-id="64e02-168">Wenn Sie eine benutzerdefinierte [**shcolumnid**](/windows/desktop/shell/objects) -Struktur verwenden, werden in der Spalte nur Daten für die Dateien angezeigt, die vom Handler unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="64e02-168">If you use a custom [**SHCOLUMNID**](/windows/desktop/shell/objects) structure, the column will display data only for those files that are supported by the handler.</span></span> <span data-ttu-id="64e02-169">Wenn der Ordner andere Dateien enthält, sind die Einträge leer.</span><span class="sxs-lookup"><span data-stu-id="64e02-169">If the folder contains other files, their entries will be blank.</span></span> <span data-ttu-id="64e02-170">Wenn ein Ordner Dateien aus mehr als einem Dateityp enthält, kann das Zusammenführen von Daten aus unterschiedlichen Typen in derselben Spalte durch die Verwendung von Standard-fmtid/pid-Werten möglich sein.</span><span class="sxs-lookup"><span data-stu-id="64e02-170">If a folder contains files from more than one file type, using standard FMTID/PID values could make it possible to merge data from different types into the same column.</span></span>

<span data-ttu-id="64e02-171">Legen Sie das **VT** -Element auf den [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant)-Typ der Daten fest, die   Sie in der Spalte anzeigen möchten.</span><span class="sxs-lookup"><span data-stu-id="64e02-171">Set the **vt** member to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) type of the data you want to display in the column.</span></span> <span data-ttu-id="64e02-172">Der am häufigsten verwendete Typ ist VT \_ LPStr, da die meisten Spalten Ihre Daten als Zeichen folgen anzeigen.</span><span class="sxs-lookup"><span data-stu-id="64e02-172">The most commonly used type is VT\_LPSTR, as most columns display their data as character strings.</span></span> <span data-ttu-id="64e02-173">Die übrigen Member der [**shcolumninfo**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) -Struktur werden verwendet, um die Merkmale der Spalte zu definieren.</span><span class="sxs-lookup"><span data-stu-id="64e02-173">The remaining members of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure are used to define the characteristics of the column.</span></span> <span data-ttu-id="64e02-174">Weisen Sie Werte nach Bedarf zu.</span><span class="sxs-lookup"><span data-stu-id="64e02-174">Assign values as appropriate.</span></span>

### <a name="the-getitemdata-method"></a><span data-ttu-id="64e02-175">Die GetItemData-Methode</span><span class="sxs-lookup"><span data-stu-id="64e02-175">The GetItemData Method</span></span>

<span data-ttu-id="64e02-176">Wenn die Spalte des Spalten Handlers ausgewählt wurde, ruft Windows-Explorer [**icolumnprovider:: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) für jede Datei im Ordner auf, der angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="64e02-176">If the column handler's column has been selected, Windows Explorer calls [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder that is to be displayed.</span></span> <span data-ttu-id="64e02-177">Der *pscid-* Parameter ist ein Zeiger auf eine [**shcolumnid**](/windows/desktop/shell/objects) -Struktur, die die Spalte identifiziert.</span><span class="sxs-lookup"><span data-stu-id="64e02-177">The *pscid* parameter is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that identifies the column.</span></span> <span data-ttu-id="64e02-178">Der *PSCD-* Parameter verweist auf eine [**shcolumndata**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) -Struktur, die die jeweilige Datei identifiziert.</span><span class="sxs-lookup"><span data-stu-id="64e02-178">The *pscd* parameter points to an [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) structure that identifies the particular file.</span></span>

<span data-ttu-id="64e02-179">Der *pvardata* -Parameter gibt die Daten zurück, die in der Spalte des Handlers für die durch *PSCD* angegebene Datei angezeigt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="64e02-179">The *pvarData* parameter returns the data that should be displayed in the handler's column for the file specified by *pscd*.</span></span> <span data-ttu-id="64e02-180">Wenn diese Datei von Ihrem Spalten Handler unterstützt wird, weisen Sie *pvardata* den Datenwert zu, und geben Sie "S OK" zurück \_ .</span><span class="sxs-lookup"><span data-stu-id="64e02-180">If that file is supported by your column handler, assign its data value to *pvarData* and return S\_OK.</span></span> <span data-ttu-id="64e02-181">Wenn die Datei nicht vom Spalten Handler unterstützt wird, geben Sie S false zurück, \_ ohne *pvardata* einen Wert zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="64e02-181">If the file is not supported by your column handler, return S\_FALSE without assigning a value to *pvarData*.</span></span>

<span data-ttu-id="64e02-182">Viele Ordner enthalten eine Reihe von Dateien, die von keinem bestimmten Spalten Handler unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="64e02-182">Many folders will contain a number of files that are not supported by any particular column handler.</span></span> <span data-ttu-id="64e02-183">Um die Effizienz zu verbessern, sollte [**icolumnprovider:: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) zuerst den **pwszext** -Member der Struktur überprüfen, auf die von *PSCD* verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="64e02-183">To improve efficiency, [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) should first check the **pwszExt** member of the structure pointed to by *pscd*.</span></span> <span data-ttu-id="64e02-184">Dieser Member enthält die Dateinamenerweiterung.</span><span class="sxs-lookup"><span data-stu-id="64e02-184">This member holds the file name extension.</span></span> <span data-ttu-id="64e02-185">Wenn die Erweiterung angibt, dass die Datei kein Member eines Dateityps ist, der vom Handler unterstützt wird, sollten Sie unnötige Verarbeitung vermeiden, indem Sie den Wert "false" zurückgeben \_ .</span><span class="sxs-lookup"><span data-stu-id="64e02-185">If the extension indicates that the file is not a member of a file type supported by your handler, avoid unnecessary processing by immediately returning S\_FALSE.</span></span>

 

 