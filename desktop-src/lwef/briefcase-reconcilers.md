---
title: Erstellen von Briefcase-abgleichen
description: 'Eine Aktentasche-Abstimmung ermöglicht Brief: die Möglichkeit, unterschiedliche Versionen eines Dokuments abzugleichen.'
ms.assetid: 86d66291-96ae-40ea-98ef-ef263f25aa82
keywords:
- Brief Synchronisierer
- Erstattung
- Ireconcilableobject
- Ireconcileinitiator
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b925e7055e15f6c7a49408aa28d147fb2eef5a7e
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "104390160"
---
# <a name="creating-briefcase-reconcilers"></a><span data-ttu-id="57ae8-107">Erstellen von Briefcase-abgleichen</span><span class="sxs-lookup"><span data-stu-id="57ae8-107">Creating Briefcase Reconcilers</span></span>

<span data-ttu-id="57ae8-108">Eine Aktentasche-Abstimmung ermöglicht Brief: die Möglichkeit, unterschiedliche Versionen eines Dokuments abzugleichen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-108">A briefcase reconciler gives Briefcase the means to reconcile different versions of a document.</span></span>

-   [<span data-ttu-id="57ae8-109">Informationen über die Abgleichen von Brief Fällen</span><span class="sxs-lookup"><span data-stu-id="57ae8-109">About Briefcase Reconcilers</span></span>](#about-briefcase-reconcilers)
    -   [<span data-ttu-id="57ae8-110">Ö</span><span class="sxs-lookup"><span data-stu-id="57ae8-110">Reconciliation</span></span>](#reconciliation)
    -   [<span data-ttu-id="57ae8-111">Erstellen eines Briefcase-abversers</span><span class="sxs-lookup"><span data-stu-id="57ae8-111">Creating a Briefcase Reconciler</span></span>](#creating-a-briefcase-reconciler)
    -   [<span data-ttu-id="57ae8-112">Benutzerinteraktion bei Abstimmung</span><span class="sxs-lookup"><span data-stu-id="57ae8-112">User Interaction in Reconciliation</span></span>](#user-interaction-in-reconciliation)
    -   [<span data-ttu-id="57ae8-113">Abgleichen von eingebetteten Objekten</span><span class="sxs-lookup"><span data-stu-id="57ae8-113">Reconciling Embedded Objects</span></span>](#reconciling-embedded-objects)
    -   [<span data-ttu-id="57ae8-114">Stoff</span><span class="sxs-lookup"><span data-stu-id="57ae8-114">Residues</span></span>](#residues)
-   [<span data-ttu-id="57ae8-115">Referenz zur Briefcase-Synchronisierung</span><span class="sxs-lookup"><span data-stu-id="57ae8-115">Briefcase Reconciler Reference</span></span>](#briefcase-reconciler-reference)
    -   [<span data-ttu-id="57ae8-116">Schnittstellen und Methoden der Briefcase-Synchronisierung</span><span class="sxs-lookup"><span data-stu-id="57ae8-116">Briefcase Reconciler Interfaces and Methods</span></span>](#briefcase-reconciler-interfaces-and-methods)

## <a name="about-briefcase-reconcilers"></a><span data-ttu-id="57ae8-117">Informationen über die Abgleichen von Brief Fällen</span><span class="sxs-lookup"><span data-stu-id="57ae8-117">About Briefcase Reconcilers</span></span>

<span data-ttu-id="57ae8-118">Eine Aktentasche-Synchronisierung kombiniert verschiedene Eingabe Versionen eines Dokuments, um eine einzelne, neue Ausgabe Version des Dokuments zu generieren.</span><span class="sxs-lookup"><span data-stu-id="57ae8-118">A briefcase reconciler combines different input versions of a document to produce a single, new output version of the document.</span></span> <span data-ttu-id="57ae8-119">Möglicherweise müssen Sie eine Aktentasche-Konfiguration erstellen, um Ihren Dokumenttyp zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-119">You might need to create a briefcase reconciler to support your type of document.</span></span> <span data-ttu-id="57ae8-120">In dieser Übersicht werden die Protokolle von Brief Fällen beschrieben und erläutert, wie Sie erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="57ae8-120">This overview describes briefcase reconcilers and explains how to create them.</span></span>

<span data-ttu-id="57ae8-121">Die folgenden Themen werden erörtert:</span><span class="sxs-lookup"><span data-stu-id="57ae8-121">The following topics are discussed:</span></span>

-   [<span data-ttu-id="57ae8-122">Ö</span><span class="sxs-lookup"><span data-stu-id="57ae8-122">Reconciliation</span></span>](#reconciliation)
-   [<span data-ttu-id="57ae8-123">Erstellen eines Briefcase-abversers</span><span class="sxs-lookup"><span data-stu-id="57ae8-123">Creating a Briefcase Reconciler</span></span>](#creating-a-briefcase-reconciler)
-   [<span data-ttu-id="57ae8-124">Benutzerinteraktion bei Abstimmung</span><span class="sxs-lookup"><span data-stu-id="57ae8-124">User Interaction in Reconciliation</span></span>](#user-interaction-in-reconciliation)
-   [<span data-ttu-id="57ae8-125">Abgleichen von eingebetteten Objekten</span><span class="sxs-lookup"><span data-stu-id="57ae8-125">Reconciling Embedded Objects</span></span>](#reconciling-embedded-objects)
-   [<span data-ttu-id="57ae8-126">Stoff</span><span class="sxs-lookup"><span data-stu-id="57ae8-126">Residues</span></span>](#residues)

### <a name="reconciliation"></a><span data-ttu-id="57ae8-127">Ö</span><span class="sxs-lookup"><span data-stu-id="57ae8-127">Reconciliation</span></span>

<span data-ttu-id="57ae8-128">Ein Dokument ist eine Sammlung von Informationen, die kopiert und geändert werden können.</span><span class="sxs-lookup"><span data-stu-id="57ae8-128">A document is a collection of information that can be copied and changed.</span></span> <span data-ttu-id="57ae8-129">Ein Dokument weist verschiedene Versionen auf, wenn sich der Inhalt mindestens zweier Kopien des Dokuments unterscheidet.</span><span class="sxs-lookup"><span data-stu-id="57ae8-129">A document has different versions if the contents of at least two copies of the document are different.</span></span> <span data-ttu-id="57ae8-130">Die Abstimmung erzeugt eine einzelne Version eines Dokuments aus mindestens zwei Versionen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-130">Reconciliation produces a single version of a document from two or more initial versions.</span></span> <span data-ttu-id="57ae8-131">In der Regel ist die abgestimmte Version eine Kombination aus Informationen aus den anfänglichen Versionen mit den neuesten oder nützlichsten Informationen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-131">Typically, the reconciled version is a combination of information from the initial versions with the most recent or most useful information preserved.</span></span>

<span data-ttu-id="57ae8-132">Die Abstimmung wird von Briefcase initiiert, wenn festgelegt wird, dass sich mindestens zwei Kopien desselben Dokuments unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="57ae8-132">Reconciliation is initiated by Briefcase when it determines that two or more copies of the same document are different.</span></span> <span data-ttu-id="57ae8-133">In Aktentasche, das in diesem Kontext als Initiator fungiert, wird die dem angegebenen Dokumenttyp zugeordnete Aktentasche-Synchronisierung nach dem jeweiligen Dokumenttyp lokalisiert und gestartet.</span><span class="sxs-lookup"><span data-stu-id="57ae8-133">Briefcase, which acts as the initiator in this context, locates and starts the briefcase reconciler associated with the given document type.</span></span> <span data-ttu-id="57ae8-134">Die Synchronisierung vergleicht die Dokumente und bestimmt, welche Teile der Dokumente beibehalten werden.</span><span class="sxs-lookup"><span data-stu-id="57ae8-134">The reconciler compares the documents and determines which portions of the documents to retain.</span></span> <span data-ttu-id="57ae8-135">Einige Konflikt Handler erfordern möglicherweise eine Benutzerinteraktion, um die Abstimmung abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-135">Some reconcilers might require user interaction to complete reconciliation.</span></span> <span data-ttu-id="57ae8-136">Andere Benutzer können die Abstimmung ohne Benutzerinteraktion durchführen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-136">Others might complete reconciliation without user interaction.</span></span> <span data-ttu-id="57ae8-137">Die Synchronisierung kann in einer Anwendung enthalten sein oder eine Erweiterung sein, die als dll implementiert ist.</span><span class="sxs-lookup"><span data-stu-id="57ae8-137">The reconciler can be contained within an application or be an extension implemented as a DLL.</span></span>

<span data-ttu-id="57ae8-138">Einige brieffall-Abgleiche können zu Daten Rückständen führen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-138">Some briefcase reconcilers might create residues.</span></span> <span data-ttu-id="57ae8-139">Ein Rückstand ist ein Dokument, das in der Regel den gleichen Dateityp wie das ursprüngliche Dokument hat, das Informationen enthält, die nicht in der zusammengeführten Version gespeichert wurden.</span><span class="sxs-lookup"><span data-stu-id="57ae8-139">A residue is a document, usually having the same file type as the initial document, that contains information not saved in the merged version.</span></span> <span data-ttu-id="57ae8-140">Mithilfe von-Nachrichten können Autoren in der Regel schnell feststellen, welche Informationen aus Ihrem ursprünglichen Dokument nicht in der endgültigen zusammengeführten Version enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="57ae8-140">Residues are typically used to give authors a quick way to determine what information from their original document is not in the final merged version.</span></span> <span data-ttu-id="57ae8-141">Wenn ein-Abgleichen von Rückständen unterstützt wird, erstellt er einen Rückstand für jede der ursprünglichen Versionen des Dokuments.</span><span class="sxs-lookup"><span data-stu-id="57ae8-141">If a reconciler supports residues, it creates one residue for each of the original versions of the document.</span></span> <span data-ttu-id="57ae8-142">Es werden keine Reste erstellt, es sei denn, der Initiator fordert Sie an</span><span class="sxs-lookup"><span data-stu-id="57ae8-142">Residues are not created unless the initiator requests them.</span></span>

<span data-ttu-id="57ae8-143">Einige Brief Synchronisierer von Brief Fällen können mit Aktentasche verwendet werden, damit der Benutzer die Abstimmung beenden kann.</span><span class="sxs-lookup"><span data-stu-id="57ae8-143">Some briefcase reconcilers work with Briefcase to allow the user to terminate reconciliation.</span></span> <span data-ttu-id="57ae8-144">Dies ist eine wichtige Funktion für einen Benutzer, der sich entscheiden kann, dass die Abstimmung nicht fortgesetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="57ae8-144">This is an important feature for a user who might decide that the reconciliation should not proceed.</span></span> <span data-ttu-id="57ae8-145">Eine Abstimmung stellt in der Regel ein Beendigungs Objekt bereit, wenn die Abstimmung eine Benutzerinteraktion erfordert und lange dauern kann.</span><span class="sxs-lookup"><span data-stu-id="57ae8-145">A reconciler typically provides a termination object when the reconciliation requires user interaction and might be lengthy.</span></span> <span data-ttu-id="57ae8-146">In einigen Umgebungen kann eine Abstimmung eine partielle Abstimmung zulassen, sodass ein Benutzer eine Abstimmung vorübergehend aussetzen und später wieder fortsetzen kann.</span><span class="sxs-lookup"><span data-stu-id="57ae8-146">In some environments, a reconciler might allow partial reconciliation, enabling a user to temporarily suspend a reconciliation and resume it later.</span></span> <span data-ttu-id="57ae8-147">"Briefcase" unterstützt derzeit keine partielle Abstimmung.</span><span class="sxs-lookup"><span data-stu-id="57ae8-147">Briefcase does not currently support partial reconciliation, however.</span></span>

### <a name="creating-a-briefcase-reconciler"></a><span data-ttu-id="57ae8-148">Erstellen eines Briefcase-abversers</span><span class="sxs-lookup"><span data-stu-id="57ae8-148">Creating a Briefcase Reconciler</span></span>

<span data-ttu-id="57ae8-149">Sie erstellen eine Aktentasche-Abstimmung, indem Sie die ababstimmungs Schnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="57ae8-149">You create a briefcase reconciler by implementing the reconciliation interfaces.</span></span> <span data-ttu-id="57ae8-150">Ein-connecler implementiert mindestens die [**ireconcilableobject**](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) -Schnittstelle und die [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) -oder [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="57ae8-150">At a minimum, a reconciler implements the [**IReconcilableObject**](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) interface and the [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) or [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface.</span></span> <span data-ttu-id="57ae8-151">Als Initiator bestimmt Briefcase, wann eine Abstimmung erforderlich ist, und ruft die [**ireconcilableobject::**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) abstimmen-Methode auf, um die Abstimmung zu initiieren.</span><span class="sxs-lookup"><span data-stu-id="57ae8-151">As the initiator, Briefcase determines when reconciliation is needed and calls the [**IReconcilableObject::Reconcile**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) method to initiate reconciliation.</span></span>

<span data-ttu-id="57ae8-152">Obwohl [**ireconcilableobject::**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) abgestimmt einen umfangreichen Satz von abgleichsfunktionen bereitstellt, führt eine Aktentasche-Abstimmung in den meisten Fällen nur minimale Abstimmung durch.</span><span class="sxs-lookup"><span data-stu-id="57ae8-152">Although [**IReconcilableObject::Reconcile**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) provides a wide-ranging set of reconciliation capabilities, a briefcase reconciler carries out only minimal reconciliation in most cases.</span></span> <span data-ttu-id="57ae8-153">Insbesondere ist es für Briefcase nicht erforderlich, dass die Abkopplung die Rückstands Generierung unterstützt oder das Beendigungs Objekt unterstützt.</span><span class="sxs-lookup"><span data-stu-id="57ae8-153">In particular, Briefcase does not require the reconciler to support residue generation or to support the termination object.</span></span> <span data-ttu-id="57ae8-154">Die Abstimmung führt außerdem eine einzige von oben nach unten gerichteten Abstimmung durch und darf nicht den Wert "REC E notcomplete" zurückgeben, d \_ \_ . h., Sie sollte keine partielle Abstimmung versuchen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-154">Also, the reconciler carries out a single top-to-bottom reconciliation and must not return the REC\_E\_NOTCOMPLETE value; that is, it should not attempt partial reconciliation.</span></span>

<span data-ttu-id="57ae8-155">Briefcase stellt die [**ireconcileinitiator**](ireconcileinitiator.md) -Schnittstelle bereit.</span><span class="sxs-lookup"><span data-stu-id="57ae8-155">Briefcase provides the [**IReconcileInitiator**](ireconcileinitiator.md) interface.</span></span> <span data-ttu-id="57ae8-156">Die Aktentasche-Vergleichsfunktion kann die [**ireconcileinitiator:: setabortcallback**](/windows/win32/api/reconcil/nf-reconcil-ireconcileinitiator-setabortcallback) -Methode verwenden, um das Beendigungs Objekt festzulegen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-156">The briefcase reconciler can use the [**IReconcileInitiator::SetAbortCallback**](/windows/win32/api/reconcil/nf-reconcil-ireconcileinitiator-setabortcallback) method to set the termination object.</span></span> <span data-ttu-id="57ae8-157">"Briefcase" verwendet keine Versions Bezeichner und kann daher keine früheren Versionen eines Dokuments bereitstellen, wenn Sie von einem Vergleichsdienst mithilfe der entsprechenden Methoden in **ireconcileinitiator** angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="57ae8-157">Briefcase does not use version identifiers and cannot, therefore, provide previous versions of a document if a reconciler requests them using the corresponding methods in **IReconcileInitiator**.</span></span>

<span data-ttu-id="57ae8-158">Briefcase übergibt an [**ireconcilableobject::**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) ausgleichen dateimoniker, die die Versionen des zu stimmenden Dokuments darstellen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-158">Briefcase passes to [**IReconcilableObject::Reconcile**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) file monikers representing the versions of the document to be reconciled.</span></span> <span data-ttu-id="57ae8-159">Die Aktentasche-Synchronisierung erhält Zugriff auf die Versionen, indem Sie entweder die [IMoniker:: bindteobject](/windows/win32/api/objidl/nf-objidl-imoniker-bindtoobject) -Methode oder die [IMoniker:: bindesstorage](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage) -Methode verwendet.</span><span class="sxs-lookup"><span data-stu-id="57ae8-159">The briefcase reconciler gains access to the versions by using either the [IMoniker::BindToObject](/windows/win32/api/objidl/nf-objidl-imoniker-bindtoobject) or [IMoniker::BindToStorage](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage) method.</span></span> <span data-ttu-id="57ae8-160">Letzteres ist im Allgemeinen schneller und wird empfohlen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-160">The latter is generally faster and is recommended.</span></span> <span data-ttu-id="57ae8-161">Die Synchronisierung muss alle Objekte oder Speicher freigeben, an die Sie gebunden wird.</span><span class="sxs-lookup"><span data-stu-id="57ae8-161">The reconciler must release any objects or storage to which it binds.</span></span>

<span data-ttu-id="57ae8-162">Wenn der Aktentasche-Verbindungs Dienst [IMoniker:: bindesstorage](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage)verwendet, wird er an einen Speicher gebunden, bei dem es sich entweder um einen flatstorage (einen Stream) oder einen OLE-definierten strukturierten Speicher handelt.</span><span class="sxs-lookup"><span data-stu-id="57ae8-162">When the briefcase reconciler uses [IMoniker::BindToStorage](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage), it binds to storage that is either flat storage (a stream) or OLE-defined structured storage.</span></span> <span data-ttu-id="57ae8-163">Wenn für die Verbindung eine flache Speicherung erwartet wird, sollte IMoniker:: BindToStorage verwendet werden, um die [IStream](/windows/win32/api/objidl/nn-objidl-istream) -Schnittstelle anzufordern.</span><span class="sxs-lookup"><span data-stu-id="57ae8-163">If the reconciler expects flat storage, it should use IMoniker::BindToStorage to request the [IStream](/windows/win32/api/objidl/nn-objidl-istream) interface.</span></span> <span data-ttu-id="57ae8-164">Wenn die-Konfiguration eine strukturierte Speicherung erwartet, sollte Sie die [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) -Schnittstelle anfordern.</span><span class="sxs-lookup"><span data-stu-id="57ae8-164">If the reconciler expects structured storage, it should request the [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) interface.</span></span> <span data-ttu-id="57ae8-165">In beiden Fällen sollte Sie einen schreibgeschützten direkten (nicht transaktiven) Zugriff auf den Speicher anfordern. der Lese-/Schreibzugriff ist möglicherweise nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="57ae8-165">In both cases, it should request read-only direct (nontransacted) access to the storage; read/write access might not be available.</span></span>

<span data-ttu-id="57ae8-166">Ein minimaler Aktentasche-Vergleich sucht in der Regel direkt nach dem Speicher der anderen Versionen und verarbeitet eingebettete Objekte in sehr primitiver Weise, z. b. das Zusammenführen von zwei Versionen des Objekts durch einbeziehen beider Versionen in der Ausgabe Version.</span><span class="sxs-lookup"><span data-stu-id="57ae8-166">A minimal briefcase reconciler typically looks directly at the storage of the other versions and deals with embedded objects in a very primitive manner, such as merging two versions of the object by including both versions in the output version.</span></span>

<span data-ttu-id="57ae8-167">Der Initiator sucht mithilfe einer Teilmenge der Logik, die von der [getclassfile](/windows/win32/api/objbase/nf-objbase-getclassfile) -Funktion implementiert wird, den Typ einer bestimmten Datei und sucht dann in der Registrierung nach der dem angegebenen Dateityp zugeordneten "Versöhnler"-Klasse.</span><span class="sxs-lookup"><span data-stu-id="57ae8-167">The initiator locates the appropriate briefcase reconciler by using a subset of the logic implemented by the [GetClassFile](/windows/win32/api/objbase/nf-objbase-getclassfile) function to determine the type of a given file and then looks in the registry for the reconciler class associated with the given file type.</span></span> <span data-ttu-id="57ae8-168">In Briefcase wird wie bei anderen Shellkomponenten der Dateityp ausschließlich durch die Dateinamenerweiterung bestimmt.</span><span class="sxs-lookup"><span data-stu-id="57ae8-168">Briefcase, like other Shell components, determines the type of a file solely by the file name extension.</span></span> <span data-ttu-id="57ae8-169">Die Erweiterung einer Datei muss über einen registrierten Dateityp für "Briefcase" verfügen, um einen für die Datei abgleichen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-169">A file's extension must have a registered file type for Briefcase to invoke a reconciler for the file.</span></span> <span data-ttu-id="57ae8-170">Sie müssen einen Registrierungs Eintrag der folgenden Form festlegen, wenn Sie die-Synchronisierung installieren.</span><span class="sxs-lookup"><span data-stu-id="57ae8-170">You must set a registry entry of the following form when installing your reconciler.</span></span>

```
CLSID
   {the file CLSID}
      Roles
         Reconciler
            (Default) = {the reconciler-classid}
```

<span data-ttu-id="57ae8-171">Die Klasse muss schnell geladen werden, muss \_ als multipleuse angegeben werden, und es muss sich um einen in-Process-Server (der in einer DLL enthalten ist) und nicht um einen lokalen Server (Implementiert in einer exe-Datei) handeln.</span><span class="sxs-lookup"><span data-stu-id="57ae8-171">The class must be quick loading, must be designated \_MULTIPLEUSE, and, unless marshalers are provided for the reconciliation interface, must be an in-process server (contained in a DLL) rather than a local server (implemented in an .exe file).</span></span>

### <a name="user-interaction-in-reconciliation"></a><span data-ttu-id="57ae8-172">Benutzerinteraktion bei Abstimmung</span><span class="sxs-lookup"><span data-stu-id="57ae8-172">User Interaction in Reconciliation</span></span>

<span data-ttu-id="57ae8-173">Eine brieffall-Abstimmung sollte versuchen, eine Abstimmung ohne Benutzerinteraktion auszuführen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-173">A briefcase reconciler should attempt to carry out reconciliation without user interaction.</span></span> <span data-ttu-id="57ae8-174">Umso automatisierter ist die Abstimmung des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="57ae8-174">The more automated the reconciliation, the better the user's perception of the process.</span></span>

<span data-ttu-id="57ae8-175">In einigen Fällen kann der Benutzereingriff wertvoll sein.</span><span class="sxs-lookup"><span data-stu-id="57ae8-175">In some cases, user intervention can be valuable.</span></span> <span data-ttu-id="57ae8-176">Beispielsweise kann ein Dokument System erfordern, dass ein Benutzer Änderungen überprüfen kann, bevor er die zusammengeführte Version eines Dokuments annimmt. es kann auch sein, dass Kommentare vom Benutzer erforderlich sind, die die vorgenommenen Änderungen erläutern.</span><span class="sxs-lookup"><span data-stu-id="57ae8-176">For example, a document system might require a user to review changes before accepting the merged version of a document or might require comments from the user explaining the changes that have been made.</span></span> <span data-ttu-id="57ae8-177">In diesen Fällen ist der Initiator, nicht der Buchstabe "Aktentasche", dafür verantwortlich, den Benutzer abzufragen und die Anweisungen des Benutzers auszuführen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-177">In these cases, the initiator, not the briefcase reconciler, is responsible for querying the user and carrying out the user's instructions.</span></span>

<span data-ttu-id="57ae8-178">In anderen Fällen kann ein Benutzereingriff erforderlich sein, z. –., wenn zwei Versionen auf inkompatible Weise bearbeitet wurden.</span><span class="sxs-lookup"><span data-stu-id="57ae8-178">In other cases, user intervention might be necessary—for example, when two versions have been edited in incompatible ways.</span></span> <span data-ttu-id="57ae8-179">In solchen Fällen muss entweder der Initiator oder der Aktentasche-Konflikt Bezeichner den Benutzer Abfragen, um Anweisungen zum Beheben des Konflikts zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="57ae8-179">In such cases, either the initiator or briefcase reconciler must query the user for instructions on how to resolve the conflict.</span></span> <span data-ttu-id="57ae8-180">Im Allgemeinen kann kein Initiator auf das Abschließen einer Abstimmung verlassen, ohne dass eine Benutzerinteraktion erwartet wird.</span><span class="sxs-lookup"><span data-stu-id="57ae8-180">In general, no initiator can rely on completing a reconciliation without expecting some user interaction.</span></span> <span data-ttu-id="57ae8-181">Allerdings haben Sie die Möglichkeit, mit dem Benutzer zu interagieren, um Konflikte aufzulösen oder den Initiator zu erfordern.</span><span class="sxs-lookup"><span data-stu-id="57ae8-181">Reconcilers, on the other hand, have the option of interacting with the user to resolve conflicts or requiring the initiator to do so.</span></span>

### <a name="reconciling-embedded-objects"></a><span data-ttu-id="57ae8-182">Abgleichen von eingebetteten Objekten</span><span class="sxs-lookup"><span data-stu-id="57ae8-182">Reconciling Embedded Objects</span></span>

<span data-ttu-id="57ae8-183">Beim Abgleichen eines Dokuments kann die Aktentasche-Abstimmung selbst ein Initiator werden, wenn ein eingebettetes Objekt eines Typs erkannt wird, das nicht abgeglichen werden kann.</span><span class="sxs-lookup"><span data-stu-id="57ae8-183">When reconciling a document, the briefcase reconciler itself can become an initiator if it discovers an embedded object of a type that it cannot reconcile.</span></span> <span data-ttu-id="57ae8-184">In diesem Fall muss die Abstimmung jedes der eingebetteten Objekte rekursiv abstimmen und alle Verantwortlichkeiten eines Initiators annehmen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-184">In this case, the reconciler needs to recursively reconcile each of the embedded objects and assume all the responsibilities of an initiator.</span></span>

<span data-ttu-id="57ae8-185">Um die Rekursion auszuführen, lädt die Aktentasche-Konfiguration das Objekt und fragt die entsprechende Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="57ae8-185">To carry out the recursion, the briefcase reconciler loads the object and queries for the appropriate interface.</span></span> <span data-ttu-id="57ae8-186">Der-Handler für das-Objekt muss die-Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-186">The handler for the object must support the interface.</span></span> <span data-ttu-id="57ae8-187">Wenn eine Methode der Schnittstelle den OLE \_ E- \_ notrunning-Wert zurückgibt, muss das-Objekt das-Objekt ausführen, um den Vorgang auszuführen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-187">If any method of the interface returns the OLE\_E\_NOTRUNNING value, the reconciler must run the object in order to carry out the operation.</span></span> <span data-ttu-id="57ae8-188">Da Code für eingebettete Objekte nicht immer verfügbar ist, muss eine Problemlösung eine Lösung für diese Bedingung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-188">Because code for embedded objects is not always available, a reconciler must provide a solution for this condition.</span></span> <span data-ttu-id="57ae8-189">Beispielsweise kann die-Vereinbarkeit sowohl alte als auch neue Versionen des eingebetteten Objekts in der abgeglichen Version enthalten.</span><span class="sxs-lookup"><span data-stu-id="57ae8-189">For example, the reconciler might include both old and new versions of the embedded object in the reconciled version.</span></span> <span data-ttu-id="57ae8-190">Die Abstimmung darf nicht versuchen, Verknüpfungen über Verknüpfungen abzustimmen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-190">The reconciler must not attempt to reconcile across links.</span></span>

<span data-ttu-id="57ae8-191">Der Initiator speichert die Dokument Versionen, die zusammengeführt werden.</span><span class="sxs-lookup"><span data-stu-id="57ae8-191">The initiator stores the document versions being merged.</span></span> <span data-ttu-id="57ae8-192">In vielen Fällen hat der Initiator Zugriff auf den Speicher jeder Version und speichert das Ergebnis der Abstimmung mithilfe eines ähnlichen Speichers.</span><span class="sxs-lookup"><span data-stu-id="57ae8-192">In many cases, the initiator has access to the storage of each version and saves the result of reconciliation using similar storage.</span></span> <span data-ttu-id="57ae8-193">Manchmal verfügt der Initiator jedoch möglicherweise über ein in-Memory-Objekt, für das keine persistente Version verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="57ae8-193">Sometimes, however, the initiator might have an in-memory object for which no persistent version is available.</span></span> <span data-ttu-id="57ae8-194">Diese Situation kann auftreten, wenn ein Dokument mit geöffneten eingebetteten Objekten abgestimmt werden muss, bevor es gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="57ae8-194">This situation can occur when a document containing open embedded objects must be reconciled before being saved.</span></span> <span data-ttu-id="57ae8-195">In solchen Fällen speichert der Initiator das Ergebnis der Abstimmung in der Version, die im Arbeitsspeicher gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="57ae8-195">In such cases, the initiator saves the result of the reconciliation in the version found in memory.</span></span>

<span data-ttu-id="57ae8-196">Der Initiator verwendet die [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) -Schnittstelle, um die zusammengeführte Version zu binden (laden).</span><span class="sxs-lookup"><span data-stu-id="57ae8-196">The initiator uses the [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) interface to bind (load) the merged version.</span></span> <span data-ttu-id="57ae8-197">Der Initiator verwendet die [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) -Methode, wenn bereits eine anfängliche Version erstellt wurde, und verwendet die [IPersistStorage:: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) -Methode für die anfängliche Version.</span><span class="sxs-lookup"><span data-stu-id="57ae8-197">The initiator uses the [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) method if an initial version has already been created and uses the [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) method for the initial version.</span></span> <span data-ttu-id="57ae8-198">Wenn die zusammengeführte Version geladen wird, verwendet der Initiator [QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) , um die Adresse der [**ireconcilableobject**](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) -Schnittstelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-198">When the merged version is loaded, the initiator uses [QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to retrieve the address of the [**IReconcilableObject**](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) interface.</span></span> <span data-ttu-id="57ae8-199">Diese Schnittstelle ermöglicht dem Initiator den Zugriff auf die Speicherung der vorhandenen-Rest-und bietet eine Möglichkeit zum Erstellen von Speicherplatz für alle neuen-Rest-Geräte.</span><span class="sxs-lookup"><span data-stu-id="57ae8-199">This interface gives the initiator access to the storage of the existing residues and gives it a way to create storage for any new residues.</span></span> <span data-ttu-id="57ae8-200">Anschließend leitet der Initiator die-Schnittstelle an, um die Abstimmung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-200">Then the initiator directs the interface to carry out the reconciliation.</span></span> <span data-ttu-id="57ae8-201">Der Initiator fragt tatsächlich die [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) -Schnittstelle vor IPersistStorage ab.</span><span class="sxs-lookup"><span data-stu-id="57ae8-201">The initiator actually queries for the [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface before IPersistStorage.</span></span> <span data-ttu-id="57ae8-202">Wenn die-Methode IPersistFile unterstützt, manipuliert der Initiator das Replikat über die IPersistFile-Methode anstelle der IPersistStorage-Methoden.</span><span class="sxs-lookup"><span data-stu-id="57ae8-202">If the reconciler supports IPersistFile, the initiator manipulates the replica through the IPersistFile rather than the IPersistStorage methods.</span></span> <span data-ttu-id="57ae8-203">Dies ermöglicht die Abstimmung von Dateien, die nicht als Verbund Dokumente gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="57ae8-203">This permits reconciliation of files that are not stored as compound documents.</span></span>

<span data-ttu-id="57ae8-204">Wenn die Abstimmung vollständig ist, kann der Initiator die zusammengeführte Version mithilfe der [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) -oder [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) -Schnittstelle speichern.</span><span class="sxs-lookup"><span data-stu-id="57ae8-204">When the reconciliation is complete, the initiator can save the merged version by using the [IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) or [IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface.</span></span> <span data-ttu-id="57ae8-205">Während der Abstimmung erstellt der Aktentasche-Konflikt die nach Bedarf, und schreibt die persistenten Bits in den Speicher.</span><span class="sxs-lookup"><span data-stu-id="57ae8-205">During reconciliation, the briefcase reconciler creates residues as needed and writes their persistent bits to storage.</span></span> <span data-ttu-id="57ae8-206">Wenn die zusammengeführte Version ein Stream ist, enthält die an [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) über gegebene [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) -Schnittstelle einen Stream mit dem Namen "Content", wobei der Speicherstatus auf statebits Flat festgelegt ist \_ .</span><span class="sxs-lookup"><span data-stu-id="57ae8-206">If the merged version is a stream, the [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) interface passed to [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) contains a stream named "Contents" with its storage state set to STATEBITS\_FLAT.</span></span> <span data-ttu-id="57ae8-207">(Sie können die Zustands Bits mithilfe der [IStorage:: stat](/windows/win32/api/objidl/nf-objidl-istorage-stat) -Methode festlegen.) Nach der Zusammenführung speichert der Initiator die zusammengeführte Version, indem er die Daten in angemessener Weise schreibt.</span><span class="sxs-lookup"><span data-stu-id="57ae8-207">(You can set the state bits by using the [IStorage::Stat](/windows/win32/api/objidl/nf-objidl-istorage-stat) method.) After the merge, the initiator saves the merged version by writing the data in an appropriate manner.</span></span> <span data-ttu-id="57ae8-208">Dabei sollte sichergestellt werden, dass statebits \_ Flat für den Speicher entsprechend festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="57ae8-208">It should ensure that STATEBITS\_FLAT is set as appropriate for the storage.</span></span>

### <a name="residues"></a><span data-ttu-id="57ae8-209">Stoff</span><span class="sxs-lookup"><span data-stu-id="57ae8-209">Residues</span></span>

<span data-ttu-id="57ae8-210">Der Initiator gibt an, ob die Daten Rückstände durch Festlegen des Parameters *pstgnew-Rest* auf eine gültige Adresse beim Aufrufen der [**ireconcilableobject::**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) Rename-Methode festgelegt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-210">The initiator indicates whether it wants residues by setting the *pstgNewResidues* parameter to a valid address when calling the [**IReconcilableObject::Reconcile**](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile) method.</span></span> <span data-ttu-id="57ae8-211">Wenn die-Abstimmung die Erstellung von-Replikate nicht unterstützt, muss Sie sofort den Wert von "REC \_ E \_ noresidues" zurückgeben, es sei denn, der *dwFlags* -Parameter gibt den Wert für den Wert der **\_** Eigenschaft "" von "Wert"</span><span class="sxs-lookup"><span data-stu-id="57ae8-211">If the reconciler does not support the creation of residues, it must return immediately the REC\_E\_NORESIDUES value, unless the *dwFlags* parameter specifies the **RECONCILEF\_NORESIDUESOK** value.</span></span>

<span data-ttu-id="57ae8-212">Die Aktentasche-Synchronisierung gibt durch Erstellen neuer Speicherelemente und Kopieren in das Array, auf das von *pstgnewreturns* verwiesen wird, Rückstände an den Initiator zurück.</span><span class="sxs-lookup"><span data-stu-id="57ae8-212">The briefcase reconciler returns residues to the initiator by creating new storage elements and copying them to the array pointed to by *pstgNewResidues*.</span></span> <span data-ttu-id="57ae8-213">Bei strukturierten Speicher Rückständen kopiert der Verbindungs Dienst eine [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) -Schnittstelle, und bei flachen Speicher Rückständen wird entweder eine [IStream](/windows/win32/api/objidl/nn-objidl-istream) -oder eine IStorage-Schnittstelle mit dem festgelegten statebits- \_ Flag kopiert.</span><span class="sxs-lookup"><span data-stu-id="57ae8-213">For structured storage residues, the reconciler copies an [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) interface, and for flat storage residues, it copies either an [IStream](/windows/win32/api/objidl/nn-objidl-istream) or an IStorage interface with the STATEBITS\_FLAT flag set.</span></span> <span data-ttu-id="57ae8-214">Der-Abgleich verwendet IStorage, um den erforderlichen Speicher zu erstellen, wobei [IStorage:: foratestream](/windows/win32/api/objidl/nf-objidl-istorage-createstream) verwendet wird, um einen flachen Speicher für einen Restwert zu erstellen, bei dem es sich um einen Stream und [IStorage:: foratestorage](/windows/win32/api/objidl/nf-objidl-istorage-createstorage) handelt</span><span class="sxs-lookup"><span data-stu-id="57ae8-214">The reconciler uses IStorage to create the necessary storage, using [IStorage::CreateStream](/windows/win32/api/objidl/nf-objidl-istorage-createstream) to create flat storage for a residue that is a stream and [IStorage::CreateStorage](/windows/win32/api/objidl/nf-objidl-istorage-createstorage) to create structured storage.</span></span>

<span data-ttu-id="57ae8-215">Der Initiator bereitet *pstgnewrückstände* vor, sodass keine Elemente im nicht reservierten Teil des [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) -Namespace enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="57ae8-215">The initiator prepares *pstgNewResidues* so that it contains no elements in the nonreserved part of the [IStorage](/windows/win32/api/objidl/nn-objidl-istorage) namespace.</span></span> <span data-ttu-id="57ae8-216">Die Aktentasche-Synchronisierung platziert jeden Rest in einem Element, dessen Name der Reihenfolge ihrer ursprünglichen Version entspricht.</span><span class="sxs-lookup"><span data-stu-id="57ae8-216">The briefcase reconciler places each residue in an element whose name corresponds to the order of its initial version.</span></span> <span data-ttu-id="57ae8-217">Beispielsweise ist der erste Rest in "1", der zweite in "2" usw. enthalten.</span><span class="sxs-lookup"><span data-stu-id="57ae8-217">For example, the first residue is contained in "1", the second in "2", and so on.</span></span> <span data-ttu-id="57ae8-218">Wenn das abgeglichen Objekt selbst einen Rückstand erzeugt, befindet es sich im-Element mit dem Namen "0".</span><span class="sxs-lookup"><span data-stu-id="57ae8-218">If the reconciled object itself produces a residue, it is found in the element named "0".</span></span>

<span data-ttu-id="57ae8-219">Die Aktentasche-debuggung führt ein Commit für jedes der neu erstellten Elemente einzeln aus, um sicherzustellen, dass der Initiator auf die Informationen zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="57ae8-219">The briefcase reconciler commits each of the newly created elements individually, ensuring that the initiator has access to the information.</span></span> <span data-ttu-id="57ae8-220">Die-Synchronisierung führt jedoch kein Commit für *pstgnewrest* -Objekte aus.</span><span class="sxs-lookup"><span data-stu-id="57ae8-220">The reconciler does not, however, commit *pstgNewResidues* itself.</span></span> <span data-ttu-id="57ae8-221">Der Initiator ist dafür verantwortlich, diesen Commit auszuführen oder anderweitig zu verwerfen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-221">The initiator is responsible for committing this or otherwise disposing of it.</span></span>

## <a name="briefcase-reconciler-reference"></a><span data-ttu-id="57ae8-222">Referenz zur Briefcase-Synchronisierung</span><span class="sxs-lookup"><span data-stu-id="57ae8-222">Briefcase Reconciler Reference</span></span>

<span data-ttu-id="57ae8-223">Dieser Abschnitt enthält Informationen zu den Abstimmungs Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="57ae8-223">This section contains information about the reconciliation interfaces.</span></span> <span data-ttu-id="57ae8-224">Bei der Behandlung von Fehlern kann eine Methode nur die Fehler Werte zurückgeben, die explizit als mögliche Rückgabewerte definiert sind.</span><span class="sxs-lookup"><span data-stu-id="57ae8-224">When handling errors, a method can return only those error values that are explicitly defined as possible return values.</span></span> <span data-ttu-id="57ae8-225">Außerdem muss die-Methode alle Variablen festlegen, deren Adressen als Parameter an **null** weitergegeben werden, bevor der Fehler zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="57ae8-225">Furthermore, the method must set all variables whose addresses are passed as parameters to **NULL** before returning from the error.</span></span>

### <a name="briefcase-reconciler-interfaces-and-methods"></a><span data-ttu-id="57ae8-226">Schnittstellen und Methoden der Briefcase-Synchronisierung</span><span class="sxs-lookup"><span data-stu-id="57ae8-226">Briefcase Reconciler Interfaces and Methods</span></span>

-   [<span data-ttu-id="57ae8-227">**Ireconcilableobject**</span><span class="sxs-lookup"><span data-stu-id="57ae8-227">**IReconcilableObject**</span></span>](/windows/win32/api/reconcil/nn-reconcil-ireconcilableobject) 
    -   -   [<span data-ttu-id="57ae8-228">**Ireconcilableobject:: getprogressfeedbackmaxschätz**</span><span class="sxs-lookup"><span data-stu-id="57ae8-228">**IReconcilableObject::GetProgressFeedbackMaxEstimate**</span></span>](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-getprogressfeedbackmaxestimate)
        -   [<span data-ttu-id="57ae8-229">**Ireconcilableobject:: Abstimmung**</span><span class="sxs-lookup"><span data-stu-id="57ae8-229">**IReconcilableObject::Reconcile**</span></span>](/windows/win32/api/reconcil/nf-reconcil-ireconcilableobject-reconcile)

-   [<span data-ttu-id="57ae8-230">**Ireconcileinitiator**</span><span class="sxs-lookup"><span data-stu-id="57ae8-230">**IReconcileInitiator**</span></span>](ireconcileinitiator.md) 
    -   -   [<span data-ttu-id="57ae8-231">**Ireconcileinitiator::-tabortcallback**</span><span class="sxs-lookup"><span data-stu-id="57ae8-231">**IReconcileInitiator::SetAbortCallback**</span></span>](/windows/win32/api/reconcil/nf-reconcil-ireconcileinitiator-setabortcallback)
        -   [<span data-ttu-id="57ae8-232">**Ireconcileinitiator:: setprogressfeedback**</span><span class="sxs-lookup"><span data-stu-id="57ae8-232">**IReconcileInitiator::SetProgressFeedback**</span></span>](/windows/win32/api/reconcil/nf-reconcil-ireconcileinitiator-setprogressfeedback)

-   [<span data-ttu-id="57ae8-233">**Inotifyreplica**</span><span class="sxs-lookup"><span data-stu-id="57ae8-233">**INotifyReplica**</span></span>](/windows/desktop/api/reconcil/nn-reconcil-inotifyreplica) 
    -   -   [<span data-ttu-id="57ae8-234">**Inotifyreplica:: youareareplica**</span><span class="sxs-lookup"><span data-stu-id="57ae8-234">**INotifyReplica::YouAreAReplica**</span></span>](/windows/desktop/api/reconcil/nf-reconcil-inotifyreplica-youareareplica)

 

 