---
title: Implementieren einer Ordneransicht
description: Windows Shell stellt eine Standard Implementierung der Ordneransicht bereit, die als defview bezeichnet wird, sodass Sie einen Großteil der Arbeit bei der Implementierung Ihrer eigenen Namespace Erweiterung vermeiden können.
ms.assetid: 8c6712d8-c3cb-4450-8277-3a8675622651
keywords:
- Ordner Ansichts Objekt
- Ishellview
- Ishellbrowser, Ordner Ansichts Objekte
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 48c7b86d587154a034f276d4bdab903e5337ed4b
ms.sourcegitcommit: 469b6de41e2a565b7ead231d7f282ec4071ac158
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/11/2020
ms.locfileid: "104391161"
---
# <a name="implementing-a-folder-view"></a><span data-ttu-id="cf7c5-106">Implementieren einer Ordneransicht</span><span class="sxs-lookup"><span data-stu-id="cf7c5-106">Implementing a Folder View</span></span>

<span data-ttu-id="cf7c5-107">Windows Shell stellt eine Standard Implementierung der Ordneransicht bereit, die als defview bezeichnet wird, sodass Sie einen Großteil der Arbeit bei der Implementierung Ihrer eigenen Namespace Erweiterung vermeiden können.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-107">Windows Shell provides a default implementation of the folder view, colloquially known as DefView, so that you can avoid much of the work of implementing your own namespace extension.</span></span> <span data-ttu-id="cf7c5-108">Da einige Ansichts Features nicht durch benutzerdefinierte Ansichten erreicht werden können, wird häufig empfohlen, anstelle einer benutzerdefinierten Ansicht das standardmäßige Systemordner-Ansichts Objekt zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-108">Because some view features cannot be achieved through custom views, it is often recommended that the default system folder view object is used in place of a custom view.</span></span> <span data-ttu-id="cf7c5-109">Weitere Informationen finden Sie unter [**shkreateshellfolderview**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-109">For more information, see [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span></span> <span data-ttu-id="cf7c5-110">Im weiteren Verlauf dieses Themas wird die Implementierung einer benutzerdefinierten Ordneransicht erläutert, die keine neueren Ansichts Features unterstützt.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-110">The remainder of this topic discusses implementing a custom folder view that cannot support newer view features.</span></span>

<span data-ttu-id="cf7c5-111">Anders als in der Strukturansicht wird der Inhalt einer Ordneransicht von Windows-Explorer nicht verwaltet.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-111">Unlike the tree view, Windows Explorer does not manage the contents of a folder view.</span></span> <span data-ttu-id="cf7c5-112">Stattdessen hostet das Fenster "Ordneransicht" ein untergeordnetes Fenster, das durch das Ordner Objekt bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-112">Instead, the folder view window hosts a child window that is provided by the folder object.</span></span> <span data-ttu-id="cf7c5-113">Das Ordner Objekt ist dafür verantwortlich, ein Ordner Ansichts Objekt zu erstellen, um den Inhalt des Ordners im untergeordneten Fenster anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-113">The folder object is responsible for creating a folder view object to display the folder's contents in the child window.</span></span>

<span data-ttu-id="cf7c5-114">Der Schlüssel zum Implementieren eines Ordner Ansichts Objekts ist die [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-114">The key to implementing a folder view object is the [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="cf7c5-115">Diese Schnittstelle wird von Windows-Explorer verwendet, um mit dem Ordner Ansichts Objekt zu kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-115">This interface is used by Windows Explorer to communicate with the folder view object.</span></span> <span data-ttu-id="cf7c5-116">Vor dem Anzeigen einer Ordneransicht ruft der Windows-Explorer die [**IShellFolder::**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) -Methode des Ordner Objekts auf, wobei *riid* auf IID \_ ishellview festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-116">Before displaying a folder view, Windows Explorer calls the folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) method with *riid* set to IID\_IShellView.</span></span> <span data-ttu-id="cf7c5-117">Erstellen Sie ein Ordner Ansichts Objekt, und geben Sie dessen **ishellview** -Schnittstelle zurück</span><span class="sxs-lookup"><span data-stu-id="cf7c5-117">Create a folder view object and return its **IShellView** interface.</span></span> <span data-ttu-id="cf7c5-118">Das Ordner Ansichts Objekt muss dann ein untergeordnetes Fenster des Fensters Ordneransicht erstellen und das untergeordnete Fenster verwenden, um Informationen zum Inhalt des Ordners anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-118">The folder view object must then create a child window of the folder view window and use the child window to display information about the folder's contents.</span></span>

<span data-ttu-id="cf7c5-119">Zusätzlich zur Steuerung der Anzeige von Daten können Erweiterungen auch eine Reihe von Features von Windows Explorer anpassen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-119">In addition to controlling how data is displayed, extensions can also customize a number of the features of Windows Explorer.</span></span> <span data-ttu-id="cf7c5-120">Beispielsweise kann eine Erweiterung der Symbolleiste oder der Menüleiste Elemente hinzufügen oder Informationen auf der Statusleiste anzeigen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-120">For instance, an extension can add items to the toolbar or menu bar, or display information on the status bar.</span></span>

-   [<span data-ttu-id="cf7c5-121">Das Objekt der Ordneransicht</span><span class="sxs-lookup"><span data-stu-id="cf7c5-121">The Folder View Object</span></span>](#the-folder-view-object)
-   [<span data-ttu-id="cf7c5-122">Initialisieren des Ordner Ansichts Objekts</span><span class="sxs-lookup"><span data-stu-id="cf7c5-122">Initializing the Folder View Object</span></span>](#initializing-the-folder-view-object)
-   [<span data-ttu-id="cf7c5-123">Anzeigen der Ordneransicht</span><span class="sxs-lookup"><span data-stu-id="cf7c5-123">Displaying the Folder View</span></span>](#displaying-the-folder-view)
-   [<span data-ttu-id="cf7c5-124">Implementieren von ishellview</span><span class="sxs-lookup"><span data-stu-id="cf7c5-124">Implementing IShellView</span></span>](#implementing-ishellview)
    -   [<span data-ttu-id="cf7c5-125">Addpropertysheetpages</span><span class="sxs-lookup"><span data-stu-id="cf7c5-125">AddPropertySheetPages</span></span>](#addpropertysheetpages)
    -   [<span data-ttu-id="cf7c5-126">Getcurrentinfo</span><span class="sxs-lookup"><span data-stu-id="cf7c5-126">GetCurrentInfo</span></span>](#getcurrentinfo)
    -   [<span data-ttu-id="cf7c5-127">Aktualisieren</span><span class="sxs-lookup"><span data-stu-id="cf7c5-127">Refresh</span></span>](#refresh)
    -   [<span data-ttu-id="cf7c5-128">SaveViewState</span><span class="sxs-lookup"><span data-stu-id="cf7c5-128">SaveViewState</span></span>](#saveviewstate)
    -   [<span data-ttu-id="cf7c5-129">Translateacelerator</span><span class="sxs-lookup"><span data-stu-id="cf7c5-129">TranslateAcelerator</span></span>](#translateacelerator)
-   [<span data-ttu-id="cf7c5-130">Verwenden von ishellbrowser für die Kommunikation mit Windows-Explorer</span><span class="sxs-lookup"><span data-stu-id="cf7c5-130">Using IShellBrowser to Communicate with Windows Explorer</span></span>](#using-ishellbrowser-to-communicate-with-windows-explorer)
    -   [<span data-ttu-id="cf7c5-131">Ändern der Windows Explorer-Menüleiste</span><span class="sxs-lookup"><span data-stu-id="cf7c5-131">Modifying the Windows Explorer Menu Bar</span></span>](#modifying-the-windows-explorer-menu-bar)
    -   [<span data-ttu-id="cf7c5-132">Ändern der Windows-Explorer-Symbolleiste</span><span class="sxs-lookup"><span data-stu-id="cf7c5-132">Modifying the Windows Explorer Toolbar</span></span>](#modifying-the-windows-explorer-toolbar)
    -   [<span data-ttu-id="cf7c5-133">Ändern der Windows Explorer-Status Leiste</span><span class="sxs-lookup"><span data-stu-id="cf7c5-133">Modifying the Windows Explorer Status Bar</span></span>](#modifying-the-windows-explorer-status-bar)
    -   [<span data-ttu-id="cf7c5-134">Speichern von Ansichts spezifischen Informationen</span><span class="sxs-lookup"><span data-stu-id="cf7c5-134">Storing View-specific Information</span></span>](#storing-view-specific-information)

## <a name="the-folder-view-object"></a><span data-ttu-id="cf7c5-135">Das Objekt der Ordneransicht</span><span class="sxs-lookup"><span data-stu-id="cf7c5-135">The Folder View Object</span></span>

<span data-ttu-id="cf7c5-136">Ein Ordner Ansichts Objekt ist ein Component Object Model (com)-Objekt, das eine [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) -Schnittstelle verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-136">A folder view object is a Component Object Model (COM) object that exposes an [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="cf7c5-137">Dieses Objekt ist für Folgendes zuständig:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-137">This object is responsible for:</span></span>

-   <span data-ttu-id="cf7c5-138">Erstellen eines untergeordneten Fensters im Fenster "Ordneransicht" und verwenden dieses Fensters zum Anzeigen der Inhalte des Ordners.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-138">Creating a child window of the folder view window and using it to display the contents of the folder.</span></span>
-   <span data-ttu-id="cf7c5-139">Verarbeiten der Kommunikation mit Windows-Explorer.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-139">Handling communication with Windows Explorer.</span></span>
-   <span data-ttu-id="cf7c5-140">Hinzufügen Ordner spezifischer Befehle zur Windows Explorer-Menüleiste und-Symbolleiste und zum Behandeln dieser Befehle, wenn Sie ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-140">Adding folder-specific commands to the Windows Explorer menu bar and toolbar and handling those commands when they are selected.</span></span>
-   <span data-ttu-id="cf7c5-141">Verwalten der Benutzerinteraktion mit dem Fenster der Ordneransicht, z. b. Anzeigen von Kontextmenüs oder behandeln von Drag & Drop-Vorgängen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-141">Managing user interaction with the folder view window, such as displaying shortcut menus or handling drag-and-drop operations.</span></span>

<span data-ttu-id="cf7c5-142">In diesem Dokument werden die ersten drei Themen erläutert.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-142">This document discusses the first three topics.</span></span> <span data-ttu-id="cf7c5-143">Da die Benutzerinteraktion mit der Ordneransicht in Ihrem untergeordneten Fenster stattfindet, ist das Ordner Ansichts Objekt für die Verarbeitung wie für jedes andere Fenster verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-143">Because user interaction with the folder view takes place within your child window, your folder view object is responsible for handling it as it would for any other window.</span></span>

<span data-ttu-id="cf7c5-144">Windows-Explorer fordert ein Ordner Ansichts Objekt an, indem das [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) Ihres Ordner Objekts aufgerufen wird, dessen *riid* auf IID \_ ishellview festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-144">Windows Explorer requests a folder view object by calling your folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) with *riid* set to IID\_IShellView.</span></span> <span data-ttu-id="cf7c5-145">Die Vorgehensweise zum Erstellen einer Ordneransicht lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-145">The procedure for creating a folder view is:</span></span>

1.  <span data-ttu-id="cf7c5-146">Ihr Folder-Objekt erstellt eine neue Instanz des Ordner Ansichts Objekts und gibt einen Zeiger auf seine [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) -Schnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-146">Your folder object creates a new instance of your folder view object and returns a pointer to its [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span>
2.  <span data-ttu-id="cf7c5-147">Der Windows-Explorer initialisiert das Ordner Ansichts Objekt durch Aufrufen der [**ishellview:: createviewwindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) -Methode.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-147">Windows Explorer initializes the folder view object by calling the [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) method.</span></span> <span data-ttu-id="cf7c5-148">Erstellen Sie ein untergeordnetes Fenster des Fensters Ordneransicht, und geben Sie das zugehörige Handle an Windows-Explorer zurück.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-148">Create a child window of the folder view window and return its handle to Windows Explorer.</span></span>
3.  <span data-ttu-id="cf7c5-149">Das Ordner Ansichts Objekt verwendet die [**ishellbrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) -Schnittstelle von Windows Explorer, um die Windows-Explorer-Symbolleiste, die Menüleiste und die Statusleiste anzupassen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-149">The folder view object uses the Windows Explorer [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface to customize the Windows Explorer toolbar, menu bar, and status bar.</span></span>
4.  <span data-ttu-id="cf7c5-150">Das Ordner Ansichts Objekt zeigt den Inhalt des Ordners im untergeordneten Fenster an.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-150">The folder view object displays the contents of the folder in the child window.</span></span>
5.  <span data-ttu-id="cf7c5-151">Das Ordner Ansichts Objekt behandelt die Benutzerinteraktion mit der Ordneransicht und allen Ordner spezifischen Symbolleisten-oder Menüleisten Elementen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-151">The folder view object handles user interaction with the folder view and any folder-specific toolbar or menu bar items.</span></span>

## <a name="initializing-the-folder-view-object"></a><span data-ttu-id="cf7c5-152">Initialisieren des Ordner Ansichts Objekts</span><span class="sxs-lookup"><span data-stu-id="cf7c5-152">Initializing the Folder View Object</span></span>

<span data-ttu-id="cf7c5-153">Der Windows-Explorer initialisiert das Ordner Ansichts Objekt durch Aufrufen der [**ishellview:: createviewwindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) -Methode.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-153">Windows Explorer initializes the folder view object by calling the [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) method.</span></span> <span data-ttu-id="cf7c5-154">Die Parameter der Methode stellen dem Ordner Ansichts Objekt die Informationen zur Verfügung, die es benötigt, um das untergeordnete Fenster zu erstellen, das zum Anzeigen des Ordner Inhalts verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-154">The method's parameters provide the folder view object with the information it needs to create the child window that will be used to display the folder's contents:</span></span>

-   <span data-ttu-id="cf7c5-155">Ein Zeiger auf die [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) -Schnittstelle des vorherigen Ordner Ansichts Objekts.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-155">A pointer to the previous folder view object's [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="cf7c5-156">Dieser Parameter kann auf **null** festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-156">This parameter can be set to **NULL**.</span></span>
-   <span data-ttu-id="cf7c5-157">Eine [**foldersettings**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) -Struktur, die die Einstellungen der vorherigen Ordneransicht enthält.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-157">A [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure that contains the previous folder view's settings.</span></span>
-   <span data-ttu-id="cf7c5-158">Ein Zeiger auf die [**ishellbrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) -Schnittstelle von Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-158">A pointer to the Windows Explorer [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface.</span></span>
-   <span data-ttu-id="cf7c5-159">Eine [Rect](/previous-versions//ms536136(v=vs.85)) -Struktur mit den Abmessungen des Fensters der Ordneransicht.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-159">A [RECT](/previous-versions//ms536136(v=vs.85)) structure with the dimensions of the folder view window.</span></span>

<span data-ttu-id="cf7c5-160">Die [**ishellview:: kreateviewwindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) -Methode wird aufgerufen, bevor das vorherige Ordner Ansichts Objekt zerstört wird.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-160">The [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) method is called before the previous folder view object is destroyed.</span></span> <span data-ttu-id="cf7c5-161">Der [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) -Schnittstellen Zeiger ermöglicht Ihnen somit die Kommunikation mit dem vorherigen Ordner Ansichts Objekt.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-161">The [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface pointer thus allows you to communicate with the previous folder view object.</span></span> <span data-ttu-id="cf7c5-162">Diese Schnittstelle ist vor allem dann nützlich, wenn der vorherige Ordner zu ihrer Erweiterung gehört und dasselbe Anzeige Schema verwendet hat.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-162">This interface is primarily useful if the previous folder belonged to your extension and used the same display scheme.</span></span> <span data-ttu-id="cf7c5-163">Wenn dies der Fall ist, können Sie mit dem vorherigen Ordner Ansichts Objekt kommunizieren, indem Sie private Einstellungen austauschen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-163">If so, you can communicate with the previous folder view object for such purposes as exchanging private settings.</span></span>

<span data-ttu-id="cf7c5-164">Eine einfache Möglichkeit, um zu bestimmen, ob der [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) -Zeiger zu ihrer Erweiterung gehört, besteht darin, dass alle Ordner Ansichts Objekte eine private Schnittstelle verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-164">A simple way to determine whether the [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) pointer belongs to your extension is to have all your folder view objects expose a private interface.</span></span> <span data-ttu-id="cf7c5-165">Nennen Sie [ishellview:: QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) , um die private Schnittstelle anzufordern, und überprüfen Sie den Rückgabewert, um zu bestimmen, ob das Ordner Ansichts Objekt eine ihrer Werte ist.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-165">Call [IShellView::QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to request the private interface, and examine the return value to determine whether the folder view object is one of yours.</span></span> <span data-ttu-id="cf7c5-166">Sie können dann eine private Methode für diese Schnittstelle verwenden, um Informationen auszutauschen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-166">You can then use a private method on that interface to exchange information.</span></span>

<span data-ttu-id="cf7c5-167">Die [**foldersettings**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) -Struktur enthält die Anzeigeeinstellungen der vorherigen Ordneransicht.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-167">The [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure contains the previous folder view's display settings.</span></span> <span data-ttu-id="cf7c5-168">Die primäre Einstellung ist der Anzeigemodus: großes Symbol, kleines Symbol, Liste oder Details.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-168">The primary setting is the viewing mode: large icon, small icon, list, or details.</span></span> <span data-ttu-id="cf7c5-169">Es gibt auch ein Flag, das die Einstellungen einer Vielzahl von Anzeigeoptionen enthält, z. b., ob die Ansicht linksbündig ausgerichtet werden soll.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-169">There is also a flag that contains the settings of a variety of display options, such as whether the view should be left-aligned.</span></span> <span data-ttu-id="cf7c5-170">In Ihrer Ordner Anzeige sollten diese Einstellungen so weit wie möglich befolgt werden, damit Benutzer eine konsistente Benutzerumgebung erhalten, wenn Sie von einem Ordner in einen anderen wechseln.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-170">Your folder display should follow these settings to the extent possible, to give users a consistent experience as they go from one folder to another.</span></span> <span data-ttu-id="cf7c5-171">Sie sollten diese Struktur speichern und aktualisieren, wenn sich die Einstellungen ändern.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-171">You should store this structure and update it as the settings change.</span></span> <span data-ttu-id="cf7c5-172">In Windows Explorer wird [**ishellview:: getcurrentinfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) aufgerufen, um den aktuellen Wert dieser Struktur zu erhalten, bevor die nächste Ordneransicht geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-172">Windows Explorer calls [**IShellView::GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) to obtain the most recent value of this structure before it opens the next folder view.</span></span>

<span data-ttu-id="cf7c5-173">Die [**ishellbrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) -Schnittstelle wird von Windows Explorer verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-173">The [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface is exposed by Windows Explorer.</span></span> <span data-ttu-id="cf7c5-174">Diese Schnittstelle ist ein Begleitelement von [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) und ermöglicht es einem Ordner Ansichts Objekt, mit Windows-Explorer zu kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-174">This interface is a companion to [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) and allows a folder view object to communicate with Windows Explorer.</span></span> <span data-ttu-id="cf7c5-175">Es gibt keine andere Möglichkeit, diesen Schnittstellen Zeiger abzurufen, daher sollte Ihr Ordner Ansichts Objekt ihn zur späteren Verwendung speichern.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-175">There is no other way to retrieve this interface pointer, so your folder view object should store it for later use.</span></span> <span data-ttu-id="cf7c5-176">Insbesondere müssen Sie [ishellbrowser:: GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) aufrufen, um das Ansichts Fenster des übergeordneten Ordners abzurufen, das Sie zum Erstellen Ihres untergeordneten Fensters verwenden werden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-176">In particular, you will need to call [IShellBrowser::GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) to retrieve the parent folder view window that you will use to create your child window.</span></span> <span data-ttu-id="cf7c5-177">Beachten Sie, dass die ishellbrowser:: GetWindow-Methode nicht in der **ishellbrowser** -Dokumentation enthalten ist, da Sie von [IOleWindow](/windows/win32/api/oleidl/nn-oleidl-iolewindow)geerbt wird.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-177">Note that the IShellBrowser::GetWindow method is not included in the **IShellBrowser** documentation because it is inherited from [IOleWindow](/windows/win32/api/oleidl/nn-oleidl-iolewindow).</span></span> <span data-ttu-id="cf7c5-178">Denken Sie nach dem Speichern des Schnittstellen Zeigers daran, [ishellbrowser:: adressf](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) aufzurufen, um den Verweis Zähler der Schnittstelle zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-178">After storing the interface pointer, remember to call [IShellBrowser::AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) to increment the interface's reference count.</span></span> <span data-ttu-id="cf7c5-179">Wenn Sie die Schnittstelle nicht mehr benötigen, wenden Sie sich an [ishellbrowser:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-179">When you no longer need the interface, call [IShellBrowser::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release).</span></span>

<span data-ttu-id="cf7c5-180">So erstellen Sie ein untergeordnetes Fenster:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-180">To create your child window:</span></span>

1.  <span data-ttu-id="cf7c5-181">Überprüfen Sie die [**foldersettings**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) -und [Rect](/previous-versions//ms536136(v=vs.85)) -Strukturen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-181">Examine the [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) and [RECT](/previous-versions//ms536136(v=vs.85)) structures.</span></span>
2.  <span data-ttu-id="cf7c5-182">Rufen Sie bei Bedarf private Einstellungen aus dem vorherigen Ordner Ansichts Objekt ab.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-182">If needed, obtain private settings from the previous folder view object.</span></span>
3.  <span data-ttu-id="cf7c5-183">Rufen Sie [ishellbrowser:: GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) auf, um das Fenster für die übergeordnete Ordneransicht abzurufen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-183">Call [IShellBrowser::GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) to retrieve the parent folder view window.</span></span>
4.  <span data-ttu-id="cf7c5-184">Erstellen Sie ein untergeordnetes Element des Fensters Ordneransicht, das Sie im vorherigen Schritt abgerufen haben, und geben Sie es an Windows-Explorer zurück</span><span class="sxs-lookup"><span data-stu-id="cf7c5-184">Create a child of the folder view window obtained in the previous step and return it to Windows Explorer.</span></span>

## <a name="displaying-the-folder-view"></a><span data-ttu-id="cf7c5-185">Anzeigen der Ordneransicht</span><span class="sxs-lookup"><span data-stu-id="cf7c5-185">Displaying the Folder View</span></span>

<span data-ttu-id="cf7c5-186">Nachdem Sie das untergeordnete Fenster erstellt und an den Windows-Explorer zurückgegeben haben, können Sie den Inhalt des Ordners anzeigen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-186">Once you have created the child window and returned it to Windows Explorer, you can display the folder's contents.</span></span> <span data-ttu-id="cf7c5-187">In der Regel zeigen Erweiterungen Ihre Informationen an, indem das untergeordnete Fenster entweder ein Listenansicht-Steuerelement oder ein **Webbrowser-Steuer** Element [hostet](../controls/list-view-control-reference.md) .</span><span class="sxs-lookup"><span data-stu-id="cf7c5-187">Typically, extensions display their information by having the child window host either a [list view control](../controls/list-view-control-reference.md) or a **WebBrowser control**.</span></span> <span data-ttu-id="cf7c5-188">Mit dem Listenansicht-Steuerelement können Sie die klassische Windows-Explorer- [Ansicht](web-view.md)replizieren.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-188">The list view control allows you to replicate the Windows Explorer [classic view](web-view.md).</span></span> <span data-ttu-id="cf7c5-189">Das WebBrowser-Steuerelement ermöglicht die Verwendung eines dynamischen HTML-Dokuments (DHTML) zum Anzeigen Ihrer Informationen, ähnlich wie die Windows Explorer-Webansicht.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-189">The WebBrowser control allows you to use a Dynamic HTML (DHTML) document to display your information, much like the Windows Explorer Web view.</span></span> <span data-ttu-id="cf7c5-190">Weitere Informationen finden Sie in der Dokumentation zu diesen Steuerelementen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-190">For further information, refer to the documentation of those controls.</span></span>

<span data-ttu-id="cf7c5-191">Das Fenster "Ordneransicht" ist immer vorhanden, auch wenn es nicht den Fokus besitzt.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-191">The folder view window always exists, even if it does not have focus.</span></span> <span data-ttu-id="cf7c5-192">Daher sollten Sie drei Zustände für das untergeordnete Fenster aufbewahren:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-192">You should therefore maintain three states for your child window:</span></span>

-   <span data-ttu-id="cf7c5-193">Aktiviert mit dem Fokus.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-193">Activated with focus.</span></span> <span data-ttu-id="cf7c5-194">Die Ordneransicht wurde erstellt und hat den Fokus.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-194">The folder view has been created and has focus.</span></span> <span data-ttu-id="cf7c5-195">Legen Sie die Menüleiste oder die Symbolleisten Elemente fest, die für einen Fokus Zustand geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-195">Set the menu bar or toolbar items that are appropriate for a focused state.</span></span>
-   <span data-ttu-id="cf7c5-196">Aktiviert ohne Fokus.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-196">Activated without focus.</span></span> <span data-ttu-id="cf7c5-197">Die Ordneransicht wurde erstellt und ist aktiv, aber Sie hat keinen Fokus.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-197">The folder view has been created and is active, but it does not have focus.</span></span> <span data-ttu-id="cf7c5-198">Legen Sie die Menüleiste oder die Symbolleisten Elemente fest, die für den Zustand "nicht fokussiert" geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-198">Set the menu bar or toolbar items that are appropriate for a nonfocused state.</span></span> <span data-ttu-id="cf7c5-199">Lassen Sie alle Elemente aus, die für die Auswahl von Elementen in der Ordneransicht gelten.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-199">Omit any items that apply to the selection of items within the folder view.</span></span>
-   <span data-ttu-id="cf7c5-200">Deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-200">Deactivated.</span></span> <span data-ttu-id="cf7c5-201">Die Ordneransicht wird zerstört.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-201">The folder view is about to be destroyed.</span></span> <span data-ttu-id="cf7c5-202">Entfernen Sie alle Ordner spezifischen Menü Elemente.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-202">Remove all folder-specific menu items.</span></span>

<span data-ttu-id="cf7c5-203">Windows-Explorer benachrichtigt das Ordner Ansichts Objekt, wenn der Fenster Zustand durch Aufrufen von [**ishellview:: uiaktivierungs**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate)geändert wird.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-203">Windows Explorer notifies your folder view object when the window state changes by calling [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate).</span></span> <span data-ttu-id="cf7c5-204">Im Gegenzug sollte das Ordner Ansichts Objekt Windows-Explorer Benachrichtigen, wenn ein Benutzer das Fenster "Ordneransicht" durch Aufrufen von " [**ishellbrowser:: onviewwindowactive**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-onviewwindowactive)" aktiviert.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-204">In turn, the folder view object should notify Windows Explorer when a user activates the folder view window by calling [**IShellBrowser::OnViewWindowActive**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-onviewwindowactive).</span></span> <span data-ttu-id="cf7c5-205">Weitere Informationen zu dieser Schnittstelle finden [Sie unter Verwenden von ishellbrowser für die Kommunikation mit Windows-Explorer](#using-ishellbrowser-to-communicate-with-windows-explorer).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-205">For further discussion of this interface, see [Using IShellBrowser to Communicate with Windows Explorer](#using-ishellbrowser-to-communicate-with-windows-explorer).</span></span>

<span data-ttu-id="cf7c5-206">Während die Ordneransicht aktiv ist, müssen Sie alle Windows-Meldungen, z. b. die [WM- \_ Größe](../winmsg/wm-size.md), verarbeiten, die zu Ihrem untergeordneten Fenster gehören.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-206">While the folder view is active, you need to process any Windows messages, such as [WM\_SIZE](../winmsg/wm-size.md), that belong to your child window.</span></span> <span data-ttu-id="cf7c5-207">Die Fenster Prozedur empfängt auch [WM- \_ Befehls](../menurc/wm-command.md) Meldungen für alle Elemente, die Sie der Windows-Explorer-Menüleiste oder der Symbolleiste hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-207">Your window procedure will also receive [WM\_COMMAND](../menurc/wm-command.md) messages for any items you have added to the Windows Explorer menu bar or toolbar.</span></span>

<span data-ttu-id="cf7c5-208">Nach dem Erstellen der Ordneransicht ruft Windows-Explorer die [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) -Schnittstelle des Ordner Ansichts Objekts auf, um eine Vielzahl von Informationen zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-208">After creating the folder view, Windows Explorer calls the folder view object's [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface to pass it a variety of information.</span></span> <span data-ttu-id="cf7c5-209">Das Objekt muss seine Anzeige entsprechend ändern.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-209">Your object must modify its display accordingly.</span></span> <span data-ttu-id="cf7c5-210">Wenn die Ordneransicht zerstört wird, benachrichtigt Windows Explorer das Ordner Ansichts Objekt durch Aufrufen seiner [**ishellview::D estroyviewwindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-destroyviewwindow) -Methode.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-210">When the folder view is about to be destroyed, Windows Explorer notifies the folder view object by calling its [**IShellView::DestroyViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-destroyviewwindow) method.</span></span>

## <a name="implementing-ishellview"></a><span data-ttu-id="cf7c5-211">Implementieren von ishellview</span><span class="sxs-lookup"><span data-stu-id="cf7c5-211">Implementing IShellView</span></span>

<span data-ttu-id="cf7c5-212">Nachdem das Ordner Objekt erstellt wurde, ruft Windows Explorer verschiedene [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) -Methoden auf, um Informationen anzufordern oder das Objekt über eine Änderung des Windows-Explorer-Status zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-212">After the folder object has been created, Windows Explorer calls various [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) methods to either request information or notify the object of a change in the state of Windows Explorer.</span></span> <span data-ttu-id="cf7c5-213">In diesem Abschnitt wird beschrieben, wie diese **ishellview** -Methoden implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-213">This section outlines how to implement those **IShellView** methods.</span></span> <span data-ttu-id="cf7c5-214">Die übrigen Methoden werden für speziellere Zwecke verwendet, z. b. das Dialogfeld "Datei öffnen" (allgemein).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-214">The remaining methods are used for more specialized purposes, such as the File Open common dialog box.</span></span> <span data-ttu-id="cf7c5-215">Weitere Informationen finden Sie in der **ishellview** -Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-215">For details, see the **IShellView** documentation.</span></span>

### <a name="addpropertysheetpages"></a><span data-ttu-id="cf7c5-216">Addpropertysheetpages</span><span class="sxs-lookup"><span data-stu-id="cf7c5-216">AddPropertySheetPages</span></span>

<span data-ttu-id="cf7c5-217">Wenn ein Benutzer im Menü Extras von Windows **-Explorer** **Ordneroptionen** auswählt, wird ein Eigenschaften Blatt angezeigt, das es dem Benutzer ermöglicht, die Ordneroptionen zu ändern.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-217">When a user selects **Folder Options** from the Windows Explorer **Tools** menu, a property sheet is displayed that allows the user to modify the folder options.</span></span> <span data-ttu-id="cf7c5-218">Windows-Explorer Ruft die [**ishellview:: addpropertysheetpages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages) -Methode Ihres Ordner Ansichts Objekts auf, damit Sie eine Seite zu diesem Eigenschaften Blatt hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-218">Windows Explorer calls your folder view object's [**IShellView::AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages) method to allow you to add a page to this property sheet.</span></span>

<span data-ttu-id="cf7c5-219">Windows-Explorer übergibt einen Zeiger auf eine [addpropsheetpageproc](/windows/win32/api/prsht/nc-prsht-lpfnaddpropsheetpage) -Rückruffunktion im *lpfn* -Parameter von [**ishellview:: addpropertysheetpages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-219">Windows Explorer passes a pointer to an [AddPropSheetPageProc](/windows/win32/api/prsht/nc-prsht-lpfnaddpropsheetpage) callback function in the *lpfn* parameter of [**IShellView::AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages).</span></span> <span data-ttu-id="cf7c5-220">Rufen Sie die Seite "" auf [, um die](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) Seite zu erstellen, und rufen Sie dann "addpropsheetpageproc" auf, um Sie dem Eigenschaften Blatt hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-220">Call [CreatePropertySheetPage](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) to create the page, and then call the AddPropSheetPageProc to add it to the property sheet.</span></span> <span data-ttu-id="cf7c5-221">Weitere Informationen zum Behandeln von Eigenschaften Blättern finden Sie unter [Eigenschaften Blätter](../controls/property-sheets.md).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-221">For further discussion of how to handle property sheets, see [Property Sheets](../controls/property-sheets.md).</span></span>

### <a name="getcurrentinfo"></a><span data-ttu-id="cf7c5-222">Getcurrentinfo</span><span class="sxs-lookup"><span data-stu-id="cf7c5-222">GetCurrentInfo</span></span>

<span data-ttu-id="cf7c5-223">Wenn der Benutzer von einem Ordner in einen anderen wechselt, versucht Windows Explorer, eine ähnliche Ordneransicht zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-223">When the user switches from one folder to another, Windows Explorer attempts to maintain a similar folder view.</span></span> <span data-ttu-id="cf7c5-224">Wenn beispielsweise in der vorherigen Ordneransicht große Symbole angezeigt werden, sollte auch das nächste angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-224">For instance, if the previous folder view showed large icons, the next should as well.</span></span> <span data-ttu-id="cf7c5-225">Wenn Windows Explorer [**ishellview:: dashateviewwindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) aufruft, um das Ordner Ansichts Objekt zu initialisieren, empfängt die Methode eine [**foldersettings**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-225">When Windows Explorer calls [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) to initialize your folder view object, the method receives a [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure.</span></span> <span data-ttu-id="cf7c5-226">Diese Struktur enthält Informationen, mit denen Sie die Anzeige der Ordneransicht mit der vorherigen Ordneransicht konsistent gestalten können.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-226">This structure contains information that allows you to make your folder view display consistent with the previous folder view.</span></span>

<span data-ttu-id="cf7c5-227">Speichern Sie die [**foldersettings**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) -Struktur, um sicherzustellen, dass die nächste Ansicht mit der aktuellen Ansicht konsistent ist.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-227">To help ensure that the next view is consistent with the current view, store the [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure.</span></span> <span data-ttu-id="cf7c5-228">Wenn sich die Ansicht ändert, z.b. von großen zu kleinen Symbolen, aktualisieren Sie die Struktur entsprechend.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-228">If the view changes, for instance from large to small icons, update the structure accordingly.</span></span> <span data-ttu-id="cf7c5-229">Vor dem Wechseln von Ansichten wird in Windows-Explorer [**ishellview:: getcurrentinfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) aufgerufen, um die aktuellen **foldersettings** -Werte anzufordern, um Sie an das nächste Ordner Ansichts Objekt zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-229">Prior to switching views, Windows Explorer will call [**IShellView::GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) to request the current **FOLDERSETTINGS** values to pass them to the next folder view object.</span></span>

### <a name="refresh"></a><span data-ttu-id="cf7c5-230">Aktualisieren</span><span class="sxs-lookup"><span data-stu-id="cf7c5-230">Refresh</span></span>

<span data-ttu-id="cf7c5-231">Der Benutzer kann sicherstellen, dass in der Ordneransicht der aktuelle Zustand des Ordners angezeigt wird, indem Sie im Menü **Ansicht** die Option **Aktualisieren** auswählen oder die Taste F5 drücken.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-231">The user can ensure that the folder view reflects the current state of the folder by selecting **Refresh** from the **View** menu or pressing the F5 key.</span></span> <span data-ttu-id="cf7c5-232">Wenn der Benutzer dies tut, ruft Windows-Explorer die [**ishellview:: Refresh**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-refresh) -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-232">When the user does so, Windows Explorer calls the [**IShellView::Refresh**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-refresh) method.</span></span> <span data-ttu-id="cf7c5-233">Das Ordner Ansichts Objekt sollte die Anzeige der Ordneransicht sofort aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-233">Your folder view object should immediately update the folder view display.</span></span>

### <a name="saveviewstate"></a><span data-ttu-id="cf7c5-234">SaveViewState</span><span class="sxs-lookup"><span data-stu-id="cf7c5-234">SaveViewState</span></span>

<span data-ttu-id="cf7c5-235">Windows-Explorer Ruft die [**ishellview:: SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate) -Methode auf, um das Ordner Ansichts Objekt zum Speichern des Ansichts Zustands aufzufordern.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-235">Windows Explorer calls the [**IShellView::SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate) method to prompt your folder view object to save its view state.</span></span> <span data-ttu-id="cf7c5-236">Sie können dann den Zustand wiederherstellen, wenn der Ordner das nächste Mal angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-236">You can then recover the state the next time the folder is viewed.</span></span> <span data-ttu-id="cf7c5-237">Die bevorzugte Methode zum Speichern eines Ansichts Zustands ist das Aufrufen der [**ishellbrowser:: getviewstatestream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream) -Methode.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-237">The preferred way to save a view state is by calling the [**IShellBrowser::GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream) method.</span></span> <span data-ttu-id="cf7c5-238">Diese Methode gibt eine [IStream](/windows/win32/api/objidl/nn-objidl-istream) -Schnittstelle zurück, die das Ordner Ansichts Objekt verwenden kann, um seinen Zustand zu speichern.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-238">This method returns an [IStream](/windows/win32/api/objidl/nn-objidl-istream) interface that your folder view object can use to save its state.</span></span> <span data-ttu-id="cf7c5-239">Wenn Sie eine weitere Ordneransicht erstellen, können Sie dieselbe **ishellbrowser:: getviewstatestream** -Methode aufrufen, um einen IStream-Zeiger zu erhalten, mit dem Sie die in den vorherigen Ordner Sichten gespeicherten Einstellungen lesen können.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-239">When you create another folder view, you can call the same **IShellBrowser::GetViewStateStream** method to obtain an IStream pointer that allows you to read the settings saved by previous folder views.</span></span>

### <a name="translateacelerator"></a><span data-ttu-id="cf7c5-240">Translateacelerator</span><span class="sxs-lookup"><span data-stu-id="cf7c5-240">TranslateAcelerator</span></span>

<span data-ttu-id="cf7c5-241">Wenn der Benutzer eine Tastenkombination drückt, übergibt Windows Explorer die Nachricht durch Aufrufen von [**ishellview:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator)an das Ordner Ansichts Objekt.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-241">When the user presses a shortcut key, Windows Explorer passes the message to the folder view object by calling [**IShellView::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator).</span></span> <span data-ttu-id="cf7c5-242">Gibt den Wert "false" zurück \_ , damit Windows-Explorer die Nachricht verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-242">Return S\_FALSE to have Windows Explorer process the message.</span></span> <span data-ttu-id="cf7c5-243">Wenn das Ordner Ansichts Objekt die Nachricht verarbeitet hat, geben Sie S \_ OK zurück.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-243">If your folder view object has processed the message, return S\_OK.</span></span>

<span data-ttu-id="cf7c5-244">Wenn das Fenster der Ordneransicht den Fokus besitzt, ruft Windows Explorer [**ishellview:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator) auf, bevor die Nachricht verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-244">When the folder view window has focus, Windows Explorer calls [**IShellView::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator) before it processes the message.</span></span> <span data-ttu-id="cf7c5-245">Da die meisten Meldungen in der Regel der Windows Explorer-Menüleiste oder den Symbolleisten Befehlen zugeordnet sind, sollte das Ordner Ansichts Objekt normalerweise den Wert "false" zurückgeben \_</span><span class="sxs-lookup"><span data-stu-id="cf7c5-245">Because most of the messages are typically associated with Windows Explorer menu bar or toolbar commands, your folder view object should normally return S\_FALSE.</span></span> <span data-ttu-id="cf7c5-246">Die Nachricht kann dann von Windows Explorer normal verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-246">Windows Explorer can then process the message normally.</span></span> <span data-ttu-id="cf7c5-247">Gibt \_ nur dann OK zurück, wenn die Meldung Ordner spezifisch ist und Sie nicht möchten, dass Windows-Explorer eine weitere Verarbeitung durchführen kann.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-247">Return S\_OK only if the message is folder-specific and you do not want Windows Explorer to do any further processing.</span></span> <span data-ttu-id="cf7c5-248">Wenn die Ordneransicht keinen Fokus hat, wird die Nachricht von Windows Explorer zuerst verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-248">If the folder view does not have focus, Windows Explorer processes the message first.</span></span> <span data-ttu-id="cf7c5-249">[**Ishellbrowser:: translateacceleratorsb**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-translateacceleratorsb) wird nur aufgerufen, wenn die Nachricht nicht verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-249">It calls [**IShellBrowser::TranslateAcceleratorSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-translateacceleratorsb) only if it does not handle the message.</span></span>

## <a name="using-ishellbrowser-to-communicate-with-windows-explorer"></a><span data-ttu-id="cf7c5-250">Verwenden von ishellbrowser für die Kommunikation mit Windows-Explorer</span><span class="sxs-lookup"><span data-stu-id="cf7c5-250">Using IShellBrowser to Communicate with Windows Explorer</span></span>

<span data-ttu-id="cf7c5-251">Die [**ishellbrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) -Schnittstelle wird vom Ordner Ansichts Objekt für die Kommunikation mit Windows-Explorer für eine Vielzahl von Zwecken verwendet, einschließlich:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-251">The [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface is used by the folder view object to communicate with Windows Explorer for a variety of purposes, including:</span></span>

-   [<span data-ttu-id="cf7c5-252">Ändern der Windows Explorer-Menüleiste</span><span class="sxs-lookup"><span data-stu-id="cf7c5-252">Modifying the Windows Explorer Menu Bar</span></span>](#modifying-the-windows-explorer-menu-bar)
-   [<span data-ttu-id="cf7c5-253">Ändern der Windows-Explorer-Symbolleiste</span><span class="sxs-lookup"><span data-stu-id="cf7c5-253">Modifying the Windows Explorer Toolbar</span></span>](#modifying-the-windows-explorer-toolbar)
-   [<span data-ttu-id="cf7c5-254">Ändern der Windows Explorer-Status Leiste</span><span class="sxs-lookup"><span data-stu-id="cf7c5-254">Modifying the Windows Explorer Status Bar</span></span>](#modifying-the-windows-explorer-status-bar)
-   [<span data-ttu-id="cf7c5-255">Speichern von Ansichts spezifischen Informationen</span><span class="sxs-lookup"><span data-stu-id="cf7c5-255">Storing View-specific Information</span></span>](#storing-view-specific-information)

### <a name="modifying-the-windows-explorer-menu-bar"></a><span data-ttu-id="cf7c5-256">Ändern der Windows Explorer-Menüleiste</span><span class="sxs-lookup"><span data-stu-id="cf7c5-256">Modifying the Windows Explorer Menu Bar</span></span>

<span data-ttu-id="cf7c5-257">In der Windows-Explorer-Menüleiste kann der Benutzer eine Vielzahl von Befehlen starten.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-257">The Windows Explorer menu bar allows the user to launch a variety of commands.</span></span> <span data-ttu-id="cf7c5-258">Standardmäßig unterstützt die Menüleiste nur Befehle, die für Windows Explorer spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-258">By default, the menu bar only supports commands that are specific to Windows Explorer.</span></span> <span data-ttu-id="cf7c5-259">Die zugehörigen [WM- \_ Befehls](../menurc/wm-command.md) Meldungen werden von Windows Explorer verarbeitet und nicht an das Objekt der Ordneransicht übermittelt.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-259">The related [WM\_COMMAND](../menurc/wm-command.md) messages are processed by Windows Explorer and are not passed to your folder view object.</span></span> <span data-ttu-id="cf7c5-260">Sie können jedoch die Menüleiste ändern, sodass Sie mindestens ein Ordner spezifisches Menü Element mit [**ishellbrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser)enthält.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-260">However, you can modify the menu bar to include one or more folder-specific menu items with [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser).</span></span> <span data-ttu-id="cf7c5-261">Windows-Explorer übergibt die zugeordneten WM \_ -befehlsnachrichten dieser Elemente zur Verarbeitung an die Fenster Prozedur des Ordner Objekts.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-261">Windows Explorer passes the associated WM\_COMMAND messages of those items to your folder object's window procedure for processing.</span></span> <span data-ttu-id="cf7c5-262">Sie können auch alle Standard Befehle entfernen oder deaktivieren, die nicht für die Anwendung gelten.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-262">You can also remove or disable any standard commands that do not apply to your application.</span></span>

<span data-ttu-id="cf7c5-263">Ordner Ansichts Objekte ändern in der Regel die Menüleiste, bevor die Ordneransicht zum ersten Mal angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-263">Folder view objects typically modify the menu bar before the folder view is first displayed.</span></span> <span data-ttu-id="cf7c5-264">Wenn die Ordneransicht zerstört wird, muss die Menüleiste in ihren ursprünglichen Zustand zurückversetzt werden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-264">They must return the menu bar to its original state when the folder view is destroyed.</span></span> <span data-ttu-id="cf7c5-265">Möglicherweise müssen Sie die Menüleiste auch jedes Mal ändern, wenn die Ordneransicht den Fokus erhält oder verliert.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-265">You might also need to modify the menu bar each time your folder view gains or loses focus.</span></span>

<span data-ttu-id="cf7c5-266">Da Windows Explorer [**ishellview:: uiaktivierungs**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) jedes Mal aufruft, wenn sich der Zustand der Ordner Ansichts Fenster ändert, ist die Menüleisten Änderung normalerweise in der Implementierung dieser Methode enthalten.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-266">Because Windows Explorer calls [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) each time the folder view window's state changes, menu bar modification is normally included in that method's implementation.</span></span> <span data-ttu-id="cf7c5-267">Das grundlegende Verfahren zum Ändern der Windows Explorer-Menüleiste lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-267">The basic procedure for modifying the Windows Explorer menu bar is:</span></span>

1.  <span data-ttu-id="cf7c5-268">Rufen Sie " [anatemdeu](/windows/win32/api/winuser/nf-winuser-createmenu) " auf, um ein Menü Handle zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-268">Call [CreateMenu](/windows/win32/api/winuser/nf-winuser-createmenu) to create a menu handle.</span></span>
2.  <span data-ttu-id="cf7c5-269">Übergeben Sie das Menü Handle an den Windows-Explorer, indem Sie [**ishellbrowser:: insertmenussb**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-269">Pass that menu handle to Windows Explorer by calling [**IShellBrowser::InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb).</span></span> <span data-ttu-id="cf7c5-270">In Windows Explorer werden die Menü Informationen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-270">Windows Explorer will fill in its menu information.</span></span>
3.  <span data-ttu-id="cf7c5-271">Ändern Sie das Menü nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-271">Modify the menu as needed.</span></span>
4.  <span data-ttu-id="cf7c5-272">Aufrufen von [**ishellbrowser:: setmenusb**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) , damit Windows-Explorer die geänderte Menüleiste anzeigt.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-272">Call [**IShellBrowser::SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) to have Windows Explorer display the modified menu bar.</span></span>

<span data-ttu-id="cf7c5-273">Windows-Explorer verfügt über sechs Popup Menüs in der Menüleiste.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-273">Windows Explorer has six pop-up menus on its menu bar.</span></span> <span data-ttu-id="cf7c5-274">Wie bei allen OLE-Containern ist das Windows-Explorer-Menü in sechs Gruppen unterteilt: Datei, Bearbeitung, Container, Objekt, Fenster und Hilfe.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-274">As with all OLE containers, the Windows Explorer menu is divided into six groups: File, Edit, Container, Object, Window, and Help.</span></span> <span data-ttu-id="cf7c5-275">In der folgenden Tabelle werden die Popup Menüs von Windows-Explorer und die zugehörige Gruppe zusammen mit den Menü-IDs aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-275">The following table lists the Windows Explorer pop-up menus and their associated group, along with the menu IDs.</span></span>



| <span data-ttu-id="cf7c5-276">Popup Menü</span><span class="sxs-lookup"><span data-stu-id="cf7c5-276">Pop-up menu</span></span> | <span data-ttu-id="cf7c5-277">id</span><span class="sxs-lookup"><span data-stu-id="cf7c5-277">ID</span></span>                     | <span data-ttu-id="cf7c5-278">Gruppieren</span><span class="sxs-lookup"><span data-stu-id="cf7c5-278">Group</span></span>     |
|-------------|------------------------|-----------|
| <span data-ttu-id="cf7c5-279">File</span><span class="sxs-lookup"><span data-stu-id="cf7c5-279">File</span></span>        | <span data-ttu-id="cf7c5-280">f- \_ Menü \_ Datei</span><span class="sxs-lookup"><span data-stu-id="cf7c5-280">FCIDM\_MENU\_FILE</span></span>      | <span data-ttu-id="cf7c5-281">File</span><span class="sxs-lookup"><span data-stu-id="cf7c5-281">File</span></span>      |
| <span data-ttu-id="cf7c5-282">Bearbeiten</span><span class="sxs-lookup"><span data-stu-id="cf7c5-282">Edit</span></span>        | <span data-ttu-id="cf7c5-283">ficidm- \_ Menü \_ Bearbeiten</span><span class="sxs-lookup"><span data-stu-id="cf7c5-283">FCIDM\_MENU\_EDIT</span></span>      | <span data-ttu-id="cf7c5-284">File</span><span class="sxs-lookup"><span data-stu-id="cf7c5-284">File</span></span>      |
| <span data-ttu-id="cf7c5-285">Sicht</span><span class="sxs-lookup"><span data-stu-id="cf7c5-285">View</span></span>        | <span data-ttu-id="cf7c5-286">scidm- \_ Menü \_ Ansicht</span><span class="sxs-lookup"><span data-stu-id="cf7c5-286">FCIDM\_MENU\_VIEW</span></span>      | <span data-ttu-id="cf7c5-287">Container</span><span class="sxs-lookup"><span data-stu-id="cf7c5-287">Container</span></span> |
| <span data-ttu-id="cf7c5-288">Favoriten</span><span class="sxs-lookup"><span data-stu-id="cf7c5-288">Favorites</span></span>   | <span data-ttu-id="cf7c5-289">Favoriten für das f- \_ Menü \_</span><span class="sxs-lookup"><span data-stu-id="cf7c5-289">FCIDM\_MENU\_FAVORITES</span></span> | <span data-ttu-id="cf7c5-290">Container</span><span class="sxs-lookup"><span data-stu-id="cf7c5-290">Container</span></span> |
| <span data-ttu-id="cf7c5-291">Tools</span><span class="sxs-lookup"><span data-stu-id="cf7c5-291">Tools</span></span>       | <span data-ttu-id="cf7c5-292">f- \_ Menü \_ Tools</span><span class="sxs-lookup"><span data-stu-id="cf7c5-292">FCIDM\_MENU\_TOOLS</span></span>     | <span data-ttu-id="cf7c5-293">Container</span><span class="sxs-lookup"><span data-stu-id="cf7c5-293">Container</span></span> |
| <span data-ttu-id="cf7c5-294">Hilfe</span><span class="sxs-lookup"><span data-stu-id="cf7c5-294">Help</span></span>        | <span data-ttu-id="cf7c5-295">Hilfe zum scidm- \_ Menü \_</span><span class="sxs-lookup"><span data-stu-id="cf7c5-295">FCIDM\_MENU\_HELP</span></span>      | <span data-ttu-id="cf7c5-296">Fenster</span><span class="sxs-lookup"><span data-stu-id="cf7c5-296">Window</span></span>    |



 

<span data-ttu-id="cf7c5-297">Wenn Sie das Menü Handle an den Windows-Explorer übergeben, indem Sie [**ishellbrowser:: insertmenussb**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb)aufrufen, müssen Sie auch einen Zeiger an eine [olemenugroupbreiten](/windows/win32/api/oleidl/ns-oleidl-olemenugroupwidths) -Struktur übergeben, deren Member mit 0 (null) initialisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-297">When you pass the menu handle to Windows Explorer by calling [**IShellBrowser::InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb), you must also pass a pointer to an [OLEMENUGROUPWIDTHS](/windows/win32/api/oleidl/ns-oleidl-olemenugroupwidths) structure whose members have been initialized to zero.</span></span>

<span data-ttu-id="cf7c5-298">Wenn [**ishellbrowser:: insertmenussb**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb) zurückgibt, hat Windows-Explorer seine Menü Elemente hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-298">When [**IShellBrowser::InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb) returns, Windows Explorer will have added its menu items.</span></span> <span data-ttu-id="cf7c5-299">Anschließend können Sie das zurückgegebene Menü Handle mit standardmäßigen Windows-Menüfunktionen wie [InsertMenuItem](/windows/win32/api/winuser/nf-winuser-insertmenuitema) für Folgendes verwenden:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-299">You can then use the returned menu handle with standard Windows menu functions such as [InsertMenuItem](/windows/win32/api/winuser/nf-winuser-insertmenuitema) to:</span></span>

-   <span data-ttu-id="cf7c5-300">Fügen Sie den Windows-Explorer-Popup Menüs Elemente hinzu.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-300">Add items to the Windows Explorer pop-up menus.</span></span>
-   <span data-ttu-id="cf7c5-301">Ändern oder Löschen vorhandener Elemente in den Popup Menüs von Windows-Explorer.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-301">Modify or delete existing items in the Windows Explorer pop-up menus.</span></span>
-   <span data-ttu-id="cf7c5-302">Fügen Sie neue Popup Menüs hinzu.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-302">Add new pop-up menus.</span></span>

<span data-ttu-id="cf7c5-303">Verwenden Sie die in der Tabelle aufgeführten IDs, um die verschiedenen Popup Menüs von Windows-Explorer zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-303">Use the IDs listed in the table to identify the various Windows Explorer pop-up menus.</span></span>

> [!Note]  
> <span data-ttu-id="cf7c5-304">Um Konflikte mit Windows Explorer-Befehls-IDs zu vermeiden, müssen die IDs aller Menü Elemente, die Sie hinzufügen, zwischen fcidm \_ shviewfirst und fcidm \_ shviewlast liegen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-304">To avoid conflicts with Windows Explorer command IDs, the IDs of any menu items that you add must fall between FCIDM\_SHVIEWFIRST and FCIDM\_SHVIEWLAST.</span></span> <span data-ttu-id="cf7c5-305">Diese beiden Werte werden in "shlobj. h" definiert.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-305">These two values are defined in Shlobj.h.</span></span>

 

<span data-ttu-id="cf7c5-306">Wenn Sie die Änderung des Menüs abgeschlossen haben, nennen Sie [**ishellbrowser:: setmenusb**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) , damit Windows-Explorer die neue Menüleiste anzeigt.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-306">Once you have finished modifying the menu, call [**IShellBrowser::SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) to have Windows Explorer display the new menu bar.</span></span>

<span data-ttu-id="cf7c5-307">Nachdem die Ordneransicht zum ersten Mal angezeigt wird, ruft Windows-Explorer [**ishellview:: uiaktivierungs**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) auf, sobald die Ordneransicht den Fokus erhält oder verliert.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-307">After the folder view is initially displayed, Windows Explorer calls [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) each time the folder view gains or loses focus.</span></span> <span data-ttu-id="cf7c5-308">Wenn Sie über Menü Elemente verfügen, die für den Zustand der Ordneransicht sensibel sind, sollten Sie das Menü entsprechend ändern, wenn sich der Status ändert.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-308">If you have any menu items that are sensitive to the state of the folder view, you should modify the menu accordingly, each time the state changes.</span></span> <span data-ttu-id="cf7c5-309">Beispielsweise können Sie über ein Menü Element verfügen, das für ein Element in der Ordneransicht fungiert, das vom Benutzer ausgewählt wurde.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-309">For instance, you might have a menu item that acts on an item in the folder view that has been selected by the user.</span></span> <span data-ttu-id="cf7c5-310">Sie sollten dieses Menü Element deaktivieren oder entfernen, wenn die Ordneransicht den Fokus verliert.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-310">You should disable or remove this menu item when the folder view loses focus.</span></span>

<span data-ttu-id="cf7c5-311">Wenn Windows Explorer [**ishellview:: uiaktivierungs**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) aufruft, um anzugeben, dass die Ordneransicht deaktiviert wird, stellen Sie die Menüleiste in Ihrem ursprünglichen Zustand wieder her, indem Sie [**ishellbrowser:: removemenussb**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-removemenussb)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-311">When Windows Explorer calls [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) to indicate that the folder view is being deactivated, restore the menu bar to its original state by calling [**IShellBrowser::RemoveMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-removemenussb).</span></span>

### <a name="modifying-the-windows-explorer-toolbar"></a><span data-ttu-id="cf7c5-312">Ändern der Windows-Explorer-Symbolleiste</span><span class="sxs-lookup"><span data-stu-id="cf7c5-312">Modifying the Windows Explorer Toolbar</span></span>

<span data-ttu-id="cf7c5-313">Zusätzlich zum Ändern der Windows Explorer-Menüleiste können Sie auch Schaltflächen zur Symbolleiste hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-313">In addition to modifying the Windows Explorer menu bar, you can also add buttons to the toolbar.</span></span> <span data-ttu-id="cf7c5-314">Wie bei der Menüleiste ist die Symbolleisten Änderung in der Regel Teil der [**ishellview:: uiaktivierungs**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) -Implementierung.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-314">As with the menu bar, toolbar modification is usually part of the [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) implementation.</span></span> <span data-ttu-id="cf7c5-315">Die Vorgehensweise zum Hinzufügen von Schaltflächen zur Windows-Explorer-Symbolleiste lautet:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-315">The procedure for adding buttons to the Windows Explorer toolbar is:</span></span>

1.  <span data-ttu-id="cf7c5-316">Fügen Sie die Bitmap der Schaltfläche der Bildliste der Symbolleiste hinzu.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-316">Add the button's bitmap to the toolbar's image list.</span></span>
2.  <span data-ttu-id="cf7c5-317">Hiermit wird die Text Zeichenfolge der Schaltfläche definiert.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-317">Define the button's text string.</span></span>
3.  <span data-ttu-id="cf7c5-318">Fügen Sie der Symbolleiste die Schaltfläche hinzu.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-318">Add the button to the toolbar.</span></span>

<span data-ttu-id="cf7c5-319">Um der Bildliste einer Symbolleiste eine Bitmap hinzuzufügen, senden Sie die Symbolleiste eine [TB- \_ AddBitmap](../controls/tb-addbitmap.md) -Nachricht, indem Sie [**ishellbrowser:: sendcontrolmsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-319">To add a bitmap to a toolbar's image list, send the toolbar a [TB\_ADDBITMAP](../controls/tb-addbitmap.md) message by calling [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span></span> <span data-ttu-id="cf7c5-320">Legen Sie zum Angeben des Toolbar-Steuer Elements den *ID* -Parameter der Methode auf die **FCW- \_ Symbolleiste** fest.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-320">To specify the toolbar control, set the method's *id* parameter to **FCW\_TOOLBAR**.</span></span> <span data-ttu-id="cf7c5-321">Legen Sie *wParam* auf die Anzahl der Schaltflächen Bilder in der Bitmap und *LPARAM* auf die Adresse einer [tbaddbitmap](/windows/win32/api/commctrl/ns-commctrl-tbaddbitmap) -Struktur fest.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-321">Set *wParam* to the number of button images in the bitmap, and *lParam* to the address of a [TBADDBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbaddbitmap) structure.</span></span> <span data-ttu-id="cf7c5-322">Der Bildindex wird im *Pret* -Parameter zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-322">The image index is returned in the *pret* parameter.</span></span>

<span data-ttu-id="cf7c5-323">Es gibt zwei Möglichkeiten, eine Zeichenfolge für die Schaltfläche zu definieren:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-323">There are two ways to define a string for the button:</span></span>

-   <span data-ttu-id="cf7c5-324">Weisen Sie die Zeichenfolge dem **IString** -Member der [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) -Struktur der Schaltfläche zu.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-324">Assign the string to the **iString** member of the button's [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) structure.</span></span>
-   <span data-ttu-id="cf7c5-325">Ruft [**ishellbrowser:: sendcontrolmsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) auf, um das Symbolleisten-Steuerelement an eine [TB \_ AddString](../controls/tb-addstring.md) -Nachricht zu senden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-325">Call [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) to send the toolbar control a [TB\_ADDSTRING](../controls/tb-addstring.md) message.</span></span> <span data-ttu-id="cf7c5-326">Der *wParam* -Parameter muss auf 0 (null) und den *LPARAM* -Parameter auf die Zeichenfolge festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-326">The *wParam* parameter should be set to zero and the *lParam* parameter to the string.</span></span> <span data-ttu-id="cf7c5-327">Der Zeichen folgen Index wird im *Pret* -Parameter zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-327">The string index is returned in the *pret* parameter.</span></span>

<span data-ttu-id="cf7c5-328">Wenn Sie der Symbolleiste die Schaltfläche hinzufügen möchten, füllen Sie die [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) -Struktur aus, und übergeben Sie Sie an [**ishellbrowser:: settoolbaritems**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-settoolbaritems).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-328">To add the button to the toolbar, fill in a [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) structure and pass it to [**IShellBrowser::SetToolbarItems**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-settoolbaritems).</span></span> <span data-ttu-id="cf7c5-329">Wie beim Menü muss die Befehls-ID zwischen " \_ shviewfirst" und "scidm \_ shviewlast" liegen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-329">As with the menu, your command ID must fall between FCIDM\_SHVIEWFIRST and FCIDM\_SHVIEWLAST.</span></span> <span data-ttu-id="cf7c5-330">Die Symbolleiste fügt dann die Schaltfläche rechts neben den vorhandenen Schaltflächen ein.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-330">The toolbar will then append the button to the right of the existing buttons.</span></span>

<span data-ttu-id="cf7c5-331">Das folgende Code Fragment fügt z. b. der Windows-Explorer-Symbolleiste eine Standard Schaltfläche mit der Befehls-ID IDB \_ MyButton hinzu.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-331">For instance, the following code fragment adds one standard button to the Windows Explorer toolbar with a command ID of IDB\_MYBUTTON.</span></span>


```
TBADDBITMAP tbadbm;
int iButtonIndex;
TBBUTTON tbb;

tbadbm.hInst = g_hInstance;    // The module's instance handle
tbadbm.nID = IDB_BUTTONIMAGE;  // The bitmap's resource ID

psb->SendControlMsg(FCW_TOOLBAR, TB_ADDBITMAP, 1,
                    reinterpret_cast<LPARAM>(&tbadbm), &iButtonIndex);

psb->SendControlMsg(FCW_TOOLBAR, TB_ADDSTRING, NULL,
                    reinterpret_cast<LPARAM>(szLabel), &iStringIndex);

ZeroMemory(&tbb, sizeof(TBBUTTON));
tbb.iBitmap = iButtonIndex;
tbb.iCommand = IDB_MYBUTTON;
tbb.iString = iStringIndex;
tbb.fsState = TBSTATE_ENABLED;
tbb.fsStyle = TBSTYLE_BUTTON;

psb->SetToolbarItems(&tbb, 1, FCT_MERGE);
```



<span data-ttu-id="cf7c5-332">Weitere Informationen zum Behandeln von Symbolleisten-Steuerelementen finden Sie unter Symbolleisten-Steuer [Elemente](../controls/toolbar-control-reference.md).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-332">For further discussion of how to handle toolbar controls, see [Toolbar Controls](../controls/toolbar-control-reference.md).</span></span>

### <a name="modifying-the-windows-explorer-status-bar"></a><span data-ttu-id="cf7c5-333">Ändern der Windows Explorer-Status Leiste</span><span class="sxs-lookup"><span data-stu-id="cf7c5-333">Modifying the Windows Explorer Status Bar</span></span>

<span data-ttu-id="cf7c5-334">Sie können die Windows-Explorer-Statusleiste verwenden, um eine Vielzahl nützlicher Informationen anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-334">You can use the Windows Explorer status bar to display a variety of useful information.</span></span> <span data-ttu-id="cf7c5-335">Es gibt zwei Möglichkeiten, die Statusleiste zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="cf7c5-335">There are two ways to use the status bar:</span></span>

-   <span data-ttu-id="cf7c5-336">Verwenden Sie [**ishellbrowser:: setstatustextb**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setstatustextsb) , um eine Text Zeichenfolge auf der Statusleiste anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-336">Use [**IShellBrowser::SetStatusTextSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setstatustextsb) to display a text string on the status bar.</span></span>
-   <span data-ttu-id="cf7c5-337">Senden Sie Nachrichten direkt an das StatusBar-Steuerelement mit [**ishellbrowser:: sendcontrolmsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-337">Send messages directly to the status bar control with [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span></span>

<span data-ttu-id="cf7c5-338">Die erste Methode ist unkompliziert, aber für viele Zwecke ausreichend.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-338">The first method is straightforward but sufficient for many purposes.</span></span> <span data-ttu-id="cf7c5-339">Sie können Nachrichten direkt an das StatusBar-Steuerelement senden, indem Sie [**ishellbrowser:: sendcontrolmsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) aufrufen, wobei der *ID* -Parameter auf **FCW- \_ Status** festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-339">For greater flexibility, you can send messages directly to the status bar control by calling [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) with the *id* parameter set to **FCW\_STATUS**.</span></span> <span data-ttu-id="cf7c5-340">Weitere Informationen zu StatusBar-Steuerelementen finden Sie unter [Status leisten](../controls/status-bars.md).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-340">For further discussion of status bar controls, see [Status Bars](../controls/status-bars.md).</span></span>

### <a name="storing-view-specific-information"></a><span data-ttu-id="cf7c5-341">Speichern von Ansichts spezifischen Informationen</span><span class="sxs-lookup"><span data-stu-id="cf7c5-341">Storing View-specific Information</span></span>

<span data-ttu-id="cf7c5-342">Wenn eine Ansicht zerstört wird, ist es häufig hilfreich, Informationen wie den Zustand oder die Einstellungen der Ansicht zu speichern.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-342">When a view is about to be destroyed, it is often useful to store information such as the view's state or settings.</span></span> <span data-ttu-id="cf7c5-343">Windows-Explorer fordert Sie auf, diese Aufgabe durch Aufrufen von [**ishellview:: SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate)auszuführen.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-343">Windows Explorer prompts you to do this task by calling [**IShellView::SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate).</span></span> <span data-ttu-id="cf7c5-344">Die bevorzugte Methode zum Speichern von Ansichts spezifischen Informationen ist das Aufrufen von [**ishellbrowser:: getviewstatestream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream).</span><span class="sxs-lookup"><span data-stu-id="cf7c5-344">The preferred way to save view-specific information is to call [**IShellBrowser::GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream).</span></span> <span data-ttu-id="cf7c5-345">Diese Methode stellt eine [IStream](/windows/win32/api/objidl/nn-objidl-istream) -Schnittstelle bereit, die Sie zum Speichern der Informationen verwenden können.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-345">This method provides you with an [IStream](/windows/win32/api/objidl/nn-objidl-istream) interface that you can use to store the information.</span></span> <span data-ttu-id="cf7c5-346">Sie können ein beliebiges geeignetes Datenformat verwenden.</span><span class="sxs-lookup"><span data-stu-id="cf7c5-346">You are free to use any suitable data format.</span></span>

 

 
