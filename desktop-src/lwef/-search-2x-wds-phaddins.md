---
title: Entwickeln von Protokoll Handler-Add-ins
description: Sie können Microsoft Windows Desktop Search (WDS) erweitern, um neue Datenspeicher einzuschließen, indem Sie einen benutzerdefinierten Protokollhandler implementieren.
ms.assetid: 2447d95f-5832-453c-8857-3b4f4c158177
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45a8688621f7d2fda653d769c0e1dfdadd240f49
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "104516787"
---
# <a name="developing-protocol-handler-add-ins"></a><span data-ttu-id="81707-103">Entwickeln von Protokoll Handler-Add-ins</span><span class="sxs-lookup"><span data-stu-id="81707-103">Developing Protocol Handler Add-ins</span></span>

> [!NOTE]
> <span data-ttu-id="81707-104">Windows-Desktop Suche 2. x ist eine veraltete Technologie, die ursprünglich als Add-in für Windows XP und Windows Server 2003 verfügbar war.</span><span class="sxs-lookup"><span data-stu-id="81707-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="81707-105">Verwenden Sie in späteren Versionen stattdessen [Windows Search](../search/-search-3x-wds-overview.md) .</span><span class="sxs-lookup"><span data-stu-id="81707-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="81707-106">Sie können Microsoft Windows Desktop Search (WDS) erweitern, um neue Datenspeicher einzuschließen, indem Sie einen benutzerdefinierten Protokollhandler implementieren.</span><span class="sxs-lookup"><span data-stu-id="81707-106">You can extend Microsoft Windows Desktop Search (WDS) to include new data stores by implementing a custom protocol handler.</span></span>

## <a name="indexing-data-stores-with-protocol-handlers"></a><span data-ttu-id="81707-107">Indizieren von Daten speichern mit Protokoll Handlern</span><span class="sxs-lookup"><span data-stu-id="81707-107">Indexing Data Stores with Protocol Handlers</span></span>

<span data-ttu-id="81707-108">Bei einem Datenspeicher handelt es sich um eine Inhaltsquelle (ein Datenbanksystem, ein Verzeichnis, ein Dateisystem), in der Daten gespeichert und vom WDS-Indexer durchsucht werden können.</span><span class="sxs-lookup"><span data-stu-id="81707-108">A data store is a content source (a database system, a directory, a file system) where data is stored and can be crawled by the WDS Indexer.</span></span> <span data-ttu-id="81707-109">Der Speicher kann hierarchisch (z. b. eine Datenbank) oder ein Link basiertes (z. b. eine Website) sein.</span><span class="sxs-lookup"><span data-stu-id="81707-109">The store can be hierarchical (like a database) or link-based (like a website).</span></span> <span data-ttu-id="81707-110">Ein Protokollhandler ermöglicht das Indizieren von Anwendungen wie WDS zum systematischen durchforsten der Knoten eines Datenspeicher, um relevante Informationen zu extrahieren, die in den Index aufgenommen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="81707-110">A protocol handler enables indexing applications like WDS to systematically crawl the nodes of a data store to extract relevant information to include in the index.</span></span> <span data-ttu-id="81707-111">Jeder Protokollhandler wird verwendet, um einen bestimmten Typ von Datenspeicher zu indizieren.</span><span class="sxs-lookup"><span data-stu-id="81707-111">Each protocol handler is used to index a specific type of data store.</span></span> <span data-ttu-id="81707-112">WDS wird mit Protokoll Handlern für Dateisystem Speicher und sowohl für Microsoft Outlook-als auch für Microsoft Outlook Express-Datenspeicher (e-Mail-Speicher) ausgeliefert. PST-Dateien usw.).</span><span class="sxs-lookup"><span data-stu-id="81707-112">WDS ships with protocol handlers for file system stores and for both Microsoft Outlook and Microsoft Outlook Express data stores (email stores, .PST files, and so on).</span></span> <span data-ttu-id="81707-113">Beim Indizieren von Outlook-e-Mails durchsucht der Protokollhandler z. b. alle Nachrichten in allen Ordnern, die Informationen aus jeder Nachricht und Anlage extrahieren.</span><span class="sxs-lookup"><span data-stu-id="81707-113">When indexing Outlook email, for example, the protocol handler crawls all messages in all folders extracting information from each message and attachment.</span></span> <span data-ttu-id="81707-114">Diese Informationen werden an den Indexer für die Einbeziehung in den WDS-Katalog übermittelt.</span><span class="sxs-lookup"><span data-stu-id="81707-114">This information is passed to the Indexer to include in the WDS catalog.</span></span>

<span data-ttu-id="81707-115">Häufig müssen Benutzer andere Datenspeicher wie Legacy Datenbanken, e-Mail-Speicher oder Datenstrukturen durchsuchen, die nicht von WDS unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="81707-115">Often users need to search other data stores such as legacy databases, email stores or data structures not supported by WDS.</span></span> <span data-ttu-id="81707-116">Sie können WDS zum durchforsten eines neuen Datenspeicher erweitern, indem Sie verwenden oder einen Protokollhandler speziell für diesen Datenspeicher implementieren.</span><span class="sxs-lookup"><span data-stu-id="81707-116">You can extend WDS to crawl a new data store by using or implementing a protocol handler specifically for that data store.</span></span> <span data-ttu-id="81707-117">Zuerst sollten Sie zunächst feststellen, ob bereits ein Protokollhandler für Ihren Datenspeicher vorhanden ist, z. b. für die Verwendung mit einer anderen Anwendung wie SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="81707-117">First, you should first determine if a protocol handler already exists for your data store, perhaps for use with another application like SharePoint Services.</span></span> <span data-ttu-id="81707-118">Wenn dies der Fall ist, können Sie diesen Protokollhandler auf dem System installieren.</span><span class="sxs-lookup"><span data-stu-id="81707-118">If so, you can install that protocol handler on the system.</span></span> <span data-ttu-id="81707-119">Wenn jedoch kein anderer Protokollhandler vorhanden ist, müssen Sie einen implementieren.</span><span class="sxs-lookup"><span data-stu-id="81707-119">If, however, another protocol handler does not exist, then you need to implement one.</span></span> <span data-ttu-id="81707-120">WDS-Protokollhandler verwenden die gleichen Designspezifikationen wie SharePoint Services, und Sie können häufig austauschbar verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="81707-120">WDS protocol handlers use the same design specifications as SharePoint Services, and they can often be used interchangeably.</span></span>

<span data-ttu-id="81707-121">Außerdem müssen Sie einen Filter implementieren, um auf den Inhalt von Elementen im Speicher zuzugreifen und ihn zu indizieren, wenn der Datenspeicher andere Daten oder andere Dateitypen als einen der von WDS unterstützten 200-Dateitypen enthält.</span><span class="sxs-lookup"><span data-stu-id="81707-121">Furthermore, if the data store contains data or file types other than one of the 200 file types supported by WDS, you also need to implement a filter to access and index the contents of items in the store.</span></span> <span data-ttu-id="81707-122">WDS 2. x verwendet den Protokollhandler und die [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)-Technologie, die von SharePoint Services verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="81707-122">WDS 2.x uses the protocol handler and [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)technology used by SharePoint Services.</span></span> <span data-ttu-id="81707-123">Wenn Sie bereits Filter für einen bestimmten Speicher und Dateityp auf dem System installiert haben, der indiziert wird, werden die Daten von WDS mithilfe der vorhandenen Schnittstellen indiziert.</span><span class="sxs-lookup"><span data-stu-id="81707-123">If you already have filters for a specific store and file type installed on the system being indexed, WDS uses the existing interfaces to index this data.</span></span>

 

## <a name="roadmap-to-adding-new-data-stores"></a><span data-ttu-id="81707-124">Roadmap zum Hinzufügen neuer Datenspeicher</span><span class="sxs-lookup"><span data-stu-id="81707-124">Roadmap to Adding New Data Stores</span></span>

<span data-ttu-id="81707-125">Zum Erweitern von WDS für die durch Forstung neuer Datenspeicher können Sie einen Protokollhandler und mindestens eines der folgenden Add-Ins erstellen: Kontextmenü Handler, Symbol Handler und ein searchprotocoloptions-Add-in.</span><span class="sxs-lookup"><span data-stu-id="81707-125">To extend WDS to crawl new data stores, you can create a protocol handler and one or more of the following add-ins: context menu handler, icon handler and a SearchProtocolOptions add-in.</span></span>

1.  <span data-ttu-id="81707-126">Erstellen und registrieren Sie einen Multithread-Protokollhandler für den Datenspeicher:</span><span class="sxs-lookup"><span data-stu-id="81707-126">Create and register a multithreaded protocol handler for the data store:</span></span>
    -   <span data-ttu-id="81707-127">**Isearchprotocol** : Diese Schnittstelle greift auf ein Protokoll zu und ordnet einer iurlaccessor eine URL zu.</span><span class="sxs-lookup"><span data-stu-id="81707-127">**ISearchProtocol** - This interface accesses a protocol and maps a URL to an IUrlAccessor.</span></span>
    -   <span data-ttu-id="81707-128">**Iurlaccessor** : Dies ist die Hauptschnittstelle, die für den Zugriff auf Elemente aus der Inhaltsquelle und zum Binden des Inhalts an den entsprechenden Filter verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="81707-128">**IUrlAccessor** - This is the main interface used for accessing items from the content source and binding the content to appropriate filter.</span></span>
    -   <span data-ttu-id="81707-129">**Iprotocolhandlersite** : Diese Schnittstelle wird verwendet, um zusätzliche Filter anzufordern und zu laden.</span><span class="sxs-lookup"><span data-stu-id="81707-129">**IProtocolHandlerSite** - This interface is used to request and load additional filters.</span></span>
    -   <span data-ttu-id="81707-130">**IFilter** : Diese Schnittstelle gibt die URL der einzelnen Elemente in einem Ordner als Wert Eigenschaften für die Verarbeitung zurück.</span><span class="sxs-lookup"><span data-stu-id="81707-130">**IFilter** - This interface returns the URL of each item in a folder as value properties for processing.</span></span>

    > [!Note]
    >
    > <span data-ttu-id="81707-131">Die minimale Add-in-Funktionalität, die benötigt wird, um Suchergebnisse aus einem nicht hierarchischen Datenspeicher zurückzugeben, ist eine Implementierung der Schnittstellen isearchprotocol und iurlaccessor.</span><span class="sxs-lookup"><span data-stu-id="81707-131">The minimum add-in functionality needed to return search results from a non-hierarchical data store is an implementation of ISearchProtocol and IUrlAccessor interfaces.</span></span>

     

2.  <span data-ttu-id="81707-132">Implementieren Sie die isearchprotocoloptions-Schnittstelle, um angepasste protokollhandleroptionen wie vordefinierte Startseiten einzuschließen:</span><span class="sxs-lookup"><span data-stu-id="81707-132">Implement the ISearchProtocolOptions interface to include customized protocol handler options, like predefined start page(s):</span></span>
    -   <span data-ttu-id="81707-133">**Isearchprotocoloptions** : Diese Schnittstelle definiert Standard-URLs für den Protokollhandler, die verarbeitet werden sollen, bestimmt, welche Anforderungen für einen Protokollhandler gelten, und bestimmt, ob die Anforderungen für ein bestimmtes System erfüllt sind.</span><span class="sxs-lookup"><span data-stu-id="81707-133">**ISearchProtocolOptions** - This interface defines default URLs for the protocol handler to process, determines what the requirements are for a protocol handler, and determines whether the requirements have been met on a given system.</span></span>
3.  <span data-ttu-id="81707-134">Erweitern Sie Shell, indem Sie die folgenden Schnittstellen implementieren, um Benutzeroberflächen Elemente, wie z. b. Kontextmenüs und Datei spezifische Symbole, einzubeziehen:</span><span class="sxs-lookup"><span data-stu-id="81707-134">Extend Shell to include user interface elements, like context menus and file-specific icons, by implementing the following interfaces:</span></span>
    -   <span data-ttu-id="81707-135">**IShellFolder** : Diese Schnittstelle, die zum Verwalten von Ordnern verwendet wird, ist erforderlich, um die IContextMenu-und iextracticon-Schnittstellen für eine URL in einem neuen Speicher bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="81707-135">**IShellFolder** - This interface, which is used to manage folders, is required to provide the IContextMenu and IExtractIcon interfaces for a URL in a new store.</span></span>
    -   <span data-ttu-id="81707-136">**Ipersistfolder** : Diese Schnittstelle ist erforderlich, um ein shellordnerobjekt anzuweisen, sich selbst zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="81707-136">**IPersistFolder** - This interface is required to instruct a Shell folder object to initialize itself.</span></span>
    -   <span data-ttu-id="81707-137">**Ipersistent** : Diese Schnittstelle stellt den Klassen Bezeichner (CLSID) eines Objekts bereit, das im System dauerhaft gespeichert werden kann.</span><span class="sxs-lookup"><span data-stu-id="81707-137">**IPersist** - This interface supplies the class identifier (CLSID) of an object that can be stored persistently in the system.</span></span>
    -   <span data-ttu-id="81707-138">**IContextMenu** : Diese Schnittstelle definiert das Kontextmenü des Rechtsklick für ein Element, auf das von URL verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="81707-138">**IContextMenu** - This interface defines the right-click context menu for an item pointed to by URL.</span></span>
    -   <span data-ttu-id="81707-139">**Iextracticon** : Diese Schnittstelle definiert das Symbol, das für ein Element angezeigt wird, auf das von URL verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="81707-139">**IExtractIcon** - This interface defines the icon to display for an item pointed to by URL.</span></span>
4.  <span data-ttu-id="81707-140">Implementieren Sie einen Mechanismus, um den Indexer über Änderungen an Ihrem Datenspeicher zu benachrichtigen:</span><span class="sxs-lookup"><span data-stu-id="81707-140">Implement a mechanism to notify the Indexer of changes to your data store:</span></span>
    -   <span data-ttu-id="81707-141">**Isearchitemschangedsink** : Diese Schnittstelle ermöglicht dem Protokollhandler, den Index von Änderungen an Ihrem Datenspeicher zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="81707-141">**ISearchItemsChangedSink** - This interface enables your protocol handler to notify the Index of changes to your data store.</span></span> <span data-ttu-id="81707-142">Dadurch wird die Leistung verbessert, da der Indexer nicht den gesamten Speicher auf inkrementellen Indizes durchsucht.</span><span class="sxs-lookup"><span data-stu-id="81707-142">This improves performance by ensuring the Indexer doesn't crawl the entire store on incremental indexes.</span></span>

## <a name="related-topics"></a><span data-ttu-id="81707-143">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="81707-143">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="81707-144">**Referenz**</span><span class="sxs-lookup"><span data-stu-id="81707-144">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="81707-145">Implementieren eines Protokoll Handlers für WDS</span><span class="sxs-lookup"><span data-stu-id="81707-145">Implementing a Protocol Handler for WDS</span></span>](-search-2x-wds-phimplementing.md)
</dt> <dt>

[<span data-ttu-id="81707-146">Hinzufügen von Symbolen, Vorschauen und Kontextmenüs mit Shellerweiterungen</span><span class="sxs-lookup"><span data-stu-id="81707-146">Adding Icons, Previews, and Context Menus with Shell Extensions</span></span>](-search-2x-wds-ph-ui-extensions.md)
</dt> <dt>

[<span data-ttu-id="81707-147">Benachrichtigen des Index von Änderungen</span><span class="sxs-lookup"><span data-stu-id="81707-147">Notifying the Index of Changes</span></span>](-search-2x-wds-notifyingofchanges.md)
</dt> <dt>

[<span data-ttu-id="81707-148">Installieren und Registrieren von Protokoll Handlern</span><span class="sxs-lookup"><span data-stu-id="81707-148">Installing and Registering Protocol Handlers</span></span>](-search-2x-wds-ph-install-registration.md)
</dt> </dl>

 

 