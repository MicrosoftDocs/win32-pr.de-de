---
title: Erstellen von Such Handlern
description: Die Shell unterstützt mehrere Such Dienstprogramme, die Benutzern das Auffinden von Namespace Objekten wie Dateien oder Druckern ermöglichen. Sie können eine benutzerdefinierte Such-Engine erstellen und für Benutzer verfügbar machen, indem Sie einen Such Handler implementieren und registrieren.
ms.assetid: ffd023bb-16ab-43ce-b00b-5e32656c8013
keywords:
- Such Handler
- registrieren, Durchsuchen von Handlern
- statische Such Handler
- registrieren, statische Such Handler
- dynamische Such Handler
- registrieren, dynamische Such Handler
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e6476109302a176822137747353b2762b0caea8a
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "104315033"
---
# <a name="creating-search-handlers"></a><span data-ttu-id="80365-110">Erstellen von Such Handlern</span><span class="sxs-lookup"><span data-stu-id="80365-110">Creating Search Handlers</span></span>

<span data-ttu-id="80365-111">\[Dieses Feature wird nur unter Windows XP oder früher unterstützt.</span><span class="sxs-lookup"><span data-stu-id="80365-111">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="80365-112">Verwenden Sie stattdessen die Windows-Suche.\]</span><span class="sxs-lookup"><span data-stu-id="80365-112">Use Windows Search instead.\]</span></span>

<span data-ttu-id="80365-113">Die Shell unterstützt mehrere Such Dienstprogramme, die Benutzern das Auffinden von Namespace Objekten wie Dateien oder Druckern ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="80365-113">The Shell supports several search utilities that allow users to locate namespace objects such as files or printers.</span></span> <span data-ttu-id="80365-114">Sie können eine benutzerdefinierte Such-Engine erstellen und für Benutzer verfügbar machen, indem Sie einen *Such Handler* implementieren und registrieren.</span><span class="sxs-lookup"><span data-stu-id="80365-114">You can create a custom search engine and make it available to users by implementing and registering a *search handler*.</span></span>

<span data-ttu-id="80365-115">Die allgemeinen Verfahren zum Implementieren und Registrieren eines Shellerweiterungs Handlers werden unter [Erstellen von Shellerweiterungs Handlern](/windows/desktop/shell/handlers)erläutert.</span><span class="sxs-lookup"><span data-stu-id="80365-115">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="80365-116">Dieses Dokument konzentriert sich auf die Aspekte der Implementierung, die für Such Handler spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="80365-116">This document focuses on those aspects of implementation that are specific to search handlers.</span></span>

-   [<span data-ttu-id="80365-117">Funktionsweise von Such Handlern</span><span class="sxs-lookup"><span data-stu-id="80365-117">How Search Handlers Work</span></span>](#how-search-handlers-work)
-   [<span data-ttu-id="80365-118">Registrieren von Such Handlern</span><span class="sxs-lookup"><span data-stu-id="80365-118">Registering Search Handlers</span></span>](#registering-search-handlers)
    -   [<span data-ttu-id="80365-119">Registrieren eines statischen Such Handlers</span><span class="sxs-lookup"><span data-stu-id="80365-119">Registering a Static Search Handler</span></span>](#registering-a-static-search-handler)
    -   [<span data-ttu-id="80365-120">Registrieren eines dynamischen Such Handlers</span><span class="sxs-lookup"><span data-stu-id="80365-120">Registering a Dynamic Search Handler</span></span>](#registering-a-dynamic-search-handler)
-   [<span data-ttu-id="80365-121">Implementieren von Such Handlern</span><span class="sxs-lookup"><span data-stu-id="80365-121">Implementing Search Handlers</span></span>](#implementing-search-handlers)

## <a name="how-search-handlers-work"></a><span data-ttu-id="80365-122">Funktionsweise von Such Handlern</span><span class="sxs-lookup"><span data-stu-id="80365-122">How Search Handlers Work</span></span>

<span data-ttu-id="80365-123">Benutzer haben zwei Möglichkeiten, eine Suchmaschine auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="80365-123">Users have two ways to select a search engine.</span></span> <span data-ttu-id="80365-124">Die erste Möglichkeit ist das Startmenü.</span><span class="sxs-lookup"><span data-stu-id="80365-124">The first way is from the Start menu.</span></span> <span data-ttu-id="80365-125">Mit Systemen vor Windows 2000 wird durch Auswählen des **Befehls Suchen im** **Startmenü** ein Untermenü der verfügbaren Suchmaschinen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="80365-125">With systems earlier than Windows 2000, selecting the **Find** command on the **Start** menu displays a submenu of the available search engines.</span></span> <span data-ttu-id="80365-126">Bei Windows 2000 und höher wird **der Befehl Suchen im** **St**-Art-Menü in suchen umbenannt.</span><span class="sxs-lookup"><span data-stu-id="80365-126">With Windows 2000 and later, the **St** art menu's **Find** command is renamed Search.</span></span> <span data-ttu-id="80365-127">Die folgende Abbildung zeigt die **Such** Schaltfläche auf einem Windows XP-System.</span><span class="sxs-lookup"><span data-stu-id="80365-127">The following illustration shows the **Search** button on a Windows XP system.</span></span>

![Das suchuntermenü des Startmenüs](images/searchhandler1.jpg)

<span data-ttu-id="80365-129">Benutzer können auch eine Suche in Windows-Explorer starten.</span><span class="sxs-lookup"><span data-stu-id="80365-129">Users can also launch a search from Windows Explorer.</span></span> <span data-ttu-id="80365-130">Auf Systemen, die älter als Windows 2000 sind, klicken Sie auf den Befehl **Suchen** **im Menü Extras** , um im Wesentlichen das gleiche Menü wie das, das dem **Startmenü** zugeordnet ist, anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="80365-130">On systems earlier than Windows 2000, they click the **Find** command on the **Tools** menu to display essentially the same menu as the one associated with the **Start** menu.</span></span> <span data-ttu-id="80365-131">Windows Explorer für Windows 2000 verarbeitet Suchmaschinen jedoch auf eine ganz andere Weise.</span><span class="sxs-lookup"><span data-stu-id="80365-131">However, Windows Explorer for Windows 2000 handles search engines in a very different way.</span></span> <span data-ttu-id="80365-132">Anstatt Suchmaschinen als Untermenü des Menüs Extras zu behandeln, gibt es jetzt eine **Such** Schaltfläche **auf der Symbol** Leiste.</span><span class="sxs-lookup"><span data-stu-id="80365-132">Instead of handling search engines as a submenu of the **Tools** menu, there is now a **Search** button on the toolbar.</span></span> <span data-ttu-id="80365-133">Durch Klicken auf diese Schaltfläche wird der **Such** Bereich der Explorer-Leiste geöffnet.</span><span class="sxs-lookup"><span data-stu-id="80365-133">Clicking this button opens the Explorer bar's **Search** pane.</span></span> <span data-ttu-id="80365-134">Die folgende Abbildung zeigt den Suchbereich **für Dateien und Ordner suchen** .</span><span class="sxs-lookup"><span data-stu-id="80365-134">The following illustration shows the **Search For Files And Folders** search pane.</span></span>

![der Suchbereich der Windows-Explorer-Leiste](images/searchhandler2.jpg)

<span data-ttu-id="80365-136">Es gibt eine Reihe von Unterschieden in der Art und Weise, wie Windows 2000 und frühere Systeme Such Handler verwalten, die sowohl die Implementierung als auch die Registrierung beeinflussen.</span><span class="sxs-lookup"><span data-stu-id="80365-136">There are a number of differences in how Windows 2000 and earlier systems manage search handlers that affect both implementation and registration.</span></span>



| <span data-ttu-id="80365-137">Vor Windows 2000</span><span class="sxs-lookup"><span data-stu-id="80365-137">Pre-Windows 2000</span></span>                                                                                                                                                                                                       | <span data-ttu-id="80365-138">Windows 2000 und höher</span><span class="sxs-lookup"><span data-stu-id="80365-138">Windows 2000 and later</span></span>                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="80365-139">Such Handler werden als Typ eines Kontext [Menü Handler](/windows/desktop/shell/context-menu-handlers)implementiert.</span><span class="sxs-lookup"><span data-stu-id="80365-139">Search handlers are implemented as a type of [shortcut menu handler](/windows/desktop/shell/context-menu-handlers).</span></span>                                                                                                                     | <span data-ttu-id="80365-140">Such Handler können als Kontextmenü Handler oder als dynamische HTML (DHTML)-Dokumente implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="80365-140">Search handlers can be implemented as shortcut menu handlers, or as Dynamic HTML (DHTML) documents.</span></span>                                                                                                                                                                                                               |
| <span data-ttu-id="80365-141">Such Handler können statisch oder dynamisch sein.</span><span class="sxs-lookup"><span data-stu-id="80365-141">Search handlers can be either static or dynamic.</span></span> <span data-ttu-id="80365-142">Statische Handler werden nur geladen, wenn Sie vom Benutzer ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="80365-142">Static handlers are loaded only when they are selected by the user.</span></span> <span data-ttu-id="80365-143">Dynamische Handler werden beim Start von der Shell geladen und erst beendet, wenn die Shell beendet wird.</span><span class="sxs-lookup"><span data-stu-id="80365-143">Dynamic handlers are loaded by the Shell at startup and are not terminated until the Shell exits.</span></span> | <span data-ttu-id="80365-144">Handler, die als Kontextmenü Handler implementiert werden, können entweder statisch oder dynamisch sein.</span><span class="sxs-lookup"><span data-stu-id="80365-144">Handlers implemented as shortcut menu handlers can be either static or dynamic.</span></span> <span data-ttu-id="80365-145">Handler, die als DHTML-Dokumente implementiert werden, müssen statisch sein.</span><span class="sxs-lookup"><span data-stu-id="80365-145">Handlers implemented as DHTML documents must be static.</span></span>                                                                                                                                                                           |
| <span data-ttu-id="80365-146">Such Handler werden im Menü " **Suchen"** im Menü " **Start** " **und im Menü "suchen"** im Menü "Extras" von  **Windows Explorer angezeigt** .</span><span class="sxs-lookup"><span data-stu-id="80365-146">Search handlers appear on the **Find** submenu of the **Start** menu and the **Find** submenu of the Windows Explorer **Tools** menu.</span></span>                                                                                  | <span data-ttu-id="80365-147">Such Handler werden nur im Untermenü **Suchen** im **Startmenü** angezeigt.</span><span class="sxs-lookup"><span data-stu-id="80365-147">Search handlers appear only on the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="80365-148">Um einen benutzerdefinierten Suchbereich über die Windows Explorer-Menüleiste verfügbar zu machen, müssen Sie ihn als [Band Objekt](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85))implementieren.</span><span class="sxs-lookup"><span data-stu-id="80365-148">To make a custom search pane available through the Windows Explorer menu bar, you must implement it as a [band object](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span> <span data-ttu-id="80365-149">Er wird dann im Untermenü der **Explorer-Leiste** des Windows-Explorer- **Ansichts** Menüs aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="80365-149">It is then listed on the **Explorer Bar** submenu of the Windows Explorer **View** menu.</span></span> |



 

## <a name="registering-search-handlers"></a><span data-ttu-id="80365-150">Registrieren von Such Handlern</span><span class="sxs-lookup"><span data-stu-id="80365-150">Registering Search Handlers</span></span>

<span data-ttu-id="80365-151">Such Handler werden unter dem **findextensions**-Unterschlüssel des Datei Typs registriert.</span><span class="sxs-lookup"><span data-stu-id="80365-151">Search handlers are registered under the file types's **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="80365-152">An diesem Punkt hängt das Registrierungsverfahren davon ab, ob der Handler statisch oder dynamisch ist.</span><span class="sxs-lookup"><span data-stu-id="80365-152">From this point, the registration procedure depends on whether the handler is to be static or dynamic.</span></span> <span data-ttu-id="80365-153">Eine allgemeine Erläuterung zum Registrieren von Shellerweiterungs Handlern finden Sie unter [Erstellen von Shellerweiterungs Handlern](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="80365-153">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span>

### <a name="registering-a-static-search-handler"></a><span data-ttu-id="80365-154">Registrieren eines statischen Such Handlers</span><span class="sxs-lookup"><span data-stu-id="80365-154">Registering a Static Search Handler</span></span>

<span data-ttu-id="80365-155">Statische Such Handler werden nur geladen, wenn Sie vom Benutzer gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="80365-155">Static search handlers are loaded only when they are launched by the user.</span></span> <span data-ttu-id="80365-156">Diese Vorgehensweise funktioniert am besten für DLLs, die klein sind und schnell geladen werden können.</span><span class="sxs-lookup"><span data-stu-id="80365-156">This approach works best for DLLs that are small and can be loaded quickly.</span></span> <span data-ttu-id="80365-157">Wenn Sie DHTML verwenden, um den Handler zu implementieren, muss er statisch sein.</span><span class="sxs-lookup"><span data-stu-id="80365-157">If you are using DHTML to implement your handler, it must be static.</span></span> <span data-ttu-id="80365-158">Um einen statischen Erweiterungs Handler zu registrieren, erstellen Sie einen Unterschlüssel mit dem Namen für den Handler unter dem **statischen** Unterschlüssel des **findextensions** -unter Schlüssels.</span><span class="sxs-lookup"><span data-stu-id="80365-158">To register a static extension handler, create a subkey named for the handler under the **Static** subkey of the **FindExtensions** subkey.</span></span> <span data-ttu-id="80365-159">Der Name wird nicht vom System verwendet, er darf jedoch nicht mit anderen suchhandlernamen unter dem **findextensions** -Unterschlüssel identisch sein.</span><span class="sxs-lookup"><span data-stu-id="80365-159">The name is not used by the system, but it must not be identical to other search handler names under the **FindExtensions** subkey.</span></span>

### <a name="shortcut-menu-based-search-handlers"></a><span data-ttu-id="80365-160">Kontextmenü basierte Such Handler</span><span class="sxs-lookup"><span data-stu-id="80365-160">Shortcut menu-based search handlers</span></span>

<span data-ttu-id="80365-161">Wenn der Handler als Kontext [Menü Handler](/windows/desktop/shell/context-menu-handlers)implementiert ist, legen Sie den Standardwert des Namens unter Schlüssels des Handlers auf die Klassen-ID des-Objekts (CLSID) des Objekts fest.</span><span class="sxs-lookup"><span data-stu-id="80365-161">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), set the default value of the handler's name subkey to the object's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="80365-162">Erstellen Sie unter dem namens Unterschlüssel des Handlers einen Unterschlüssel mit dem Namen **0**   (null), und legen Sie dessen Standardwert auf die Zeichenfolge fest,  die im Untermenü **Suchen oder suchen** angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="80365-162">Under the handler's name subkey, create a subkey named **0** (zero) and set its default value to the string that will be displayed in the **Search** or **Find** submenu.</span></span> <span data-ttu-id="80365-163">Sie können Tastenkombinationen auf die übliche Weise aktivieren, indem Sie das Tastenkombination mit einem kaufmännischen und-Zeichen (&) vorangestellt werden.</span><span class="sxs-lookup"><span data-stu-id="80365-163">You can enable keyboard shortcuts in the usual way, by preceding the shortcut character with an ampersand (&).</span></span> <span data-ttu-id="80365-164">Sie können ein optionales kleines Symbol rechts neben dem Menütext anzeigen, indem Sie einen **DefaultIcon** -Unterschlüssel unter dem **0** -Unterschlüssel erstellen.</span><span class="sxs-lookup"><span data-stu-id="80365-164">You can have an optional small icon displayed to the right of the menu text by creating a **DefaultIcon** subkey under the **0** subkey.</span></span> <span data-ttu-id="80365-165">Legen Sie den Standardwert auf eine Zeichenfolge fest, die den Pfad der Datei enthält, die das Symbol enthält, gefolgt von einem Komma, gefolgt vom Null basierten Index des Symbols.</span><span class="sxs-lookup"><span data-stu-id="80365-165">Set its default value to a string containing the path of the file containing the icon, followed by a comma, followed by the icon's zero-based index.</span></span>

<span data-ttu-id="80365-166">Im folgenden Beispiel wird der Such Handler **mysearchengine** registriert.</span><span class="sxs-lookup"><span data-stu-id="80365-166">The following example registers the **MySearchEngine** search handler.</span></span> <span data-ttu-id="80365-167">Der Menütext lautet "meine Suchmaschine", wobei M als Tastenkombination angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="80365-167">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="80365-168">Das Symbol befindet sich in C: \\ mydir \\MySearch.dll mit einem Index von 2.</span><span class="sxs-lookup"><span data-stu-id="80365-168">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {MySearchEngine CLSID GUID}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
```

### <a name="dhtml-based-search-handlers"></a><span data-ttu-id="80365-169">DHTML-basierte Such Handler</span><span class="sxs-lookup"><span data-stu-id="80365-169">DHTML-based search handlers</span></span>

<span data-ttu-id="80365-170">Mit Windows 2000 können Sie auch einen Such Handler als DHTML-Dokument implementieren.</span><span class="sxs-lookup"><span data-stu-id="80365-170">With Windows 2000, you can also implement a search handler as a DHTML document.</span></span> <span data-ttu-id="80365-171">Der Name wird im Untermenü **Suchen** im **Startmenü** aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="80365-171">Its name is listed in the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="80365-172">Wenn der Benutzer das Symbol auswählt, wird Windows-Explorer gestartet, und die Explorer-Leiste wird für das Such Dokument geöffnet.</span><span class="sxs-lookup"><span data-stu-id="80365-172">When the user selects it, it launches Windows Explorer with the Explorer bar opened to the search document.</span></span> <span data-ttu-id="80365-173">Sie können auch ein DHTML-Dokument angeben, das rechts neben der Explorer-Leiste angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="80365-173">You can also specify a DHTML document to be displayed to the right of the Explorer bar.</span></span> <span data-ttu-id="80365-174">Es gibt keine Möglichkeit, einen anderen Handler aus dem Standard Suchbereich zu starten.</span><span class="sxs-lookup"><span data-stu-id="80365-174">There is no way to launch a different handler from the default Search pane.</span></span> <span data-ttu-id="80365-175">Suchmaschinen können direkt aus dem Windows-Explorer gestartet werden, jedoch nur, wenn Sie als [Band Objekte](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85))implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="80365-175">Search engines can be launched directly from Windows Explorer, but only if they are implemented as as [band objects](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span>

<span data-ttu-id="80365-176">Legen Sie zum Registrieren eines DHTML-basierten Such Handlers den namens Unterschlüssel des Handlers auf die Zeichen folgen Form von CLSID \_ shellsearchext fest (aktuell {169 a0691-8df9-11d1-a1c4-00c04fd75d13}), und erstellen Sie die folgenden Unterschlüssel.</span><span class="sxs-lookup"><span data-stu-id="80365-176">To register a DHTML-based search handler, set the handler's name subkey to the string form of CLSID\_ShellSearchExt (currently {169A0691-8DF9-11d1-A1C4-00C04FD75D13}) and create the following subkeys.</span></span>

1.  <span data-ttu-id="80365-177">Erstellen Sie den Unterschlüssel " **0**" (null) unter dem Unterschlüssel "HandlerName", und legen Sie dessen Standardwert auf den Menütext fest.</span><span class="sxs-lookup"><span data-stu-id="80365-177">Create a **0**(zero) subkey under the handler name subkey and set its default value to the menu text.</span></span>
2.  <span data-ttu-id="80365-178">Wenn neben dem Menütext ein Symbol angezeigt werden soll, erstellen Sie einen **DefaultIcon** -Unterschlüssel unter **0** , und legen Sie dessen Standardwert auf den Pfad und den Index des Symbols fest.</span><span class="sxs-lookup"><span data-stu-id="80365-178">To have an icon displayed next to the menu text, create a **DefaultIcon** subkey under **0** and set its default value to the icon's path and index.</span></span>
3.  <span data-ttu-id="80365-179">Erstellen Sie den Unterschlüssel " **searchguid** " unter **0**.</span><span class="sxs-lookup"><span data-stu-id="80365-179">Create a **SearchGUID** subkey under **0**.</span></span> <span data-ttu-id="80365-180">Weisen Sie dem DHTML-Dokument eine GUID zu, und legen Sie den Standardwert von **searchguid** auf das zugehörige Zeichen folgen Formular fest.</span><span class="sxs-lookup"><span data-stu-id="80365-180">Assign a GUID to the DHTML document and set the default value of **SearchGUID** to its string form.</span></span> <span data-ttu-id="80365-181">Diese GUID muss nicht unter **HKEY \_ Classes \_ root \\ CLSID** registriert werden.</span><span class="sxs-lookup"><span data-stu-id="80365-181">This GUID does not need to be registered under **HKEY\_CLASSES\_ROOT\\CLSID**.</span></span>
4.  <span data-ttu-id="80365-182">Erstellen Sie unter **searchguid** einen **URL** -Unterschlüssel.</span><span class="sxs-lookup"><span data-stu-id="80365-182">Create a **Url** subkey under **SearchGUID**.</span></span> <span data-ttu-id="80365-183">Legen Sie den Standardwert auf den Pfad des HTML-Dokuments fest, das in der Explorer-Leiste angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="80365-183">Set its default value to the path of the HTML document that will appear in the Explorer bar.</span></span>
5.  <span data-ttu-id="80365-184">Erstellen Sie unter " **searchguid**" einen **urlnavnew** -Unterschlüssel.</span><span class="sxs-lookup"><span data-stu-id="80365-184">Create a **UrlNavNew** subkey under **SearchGUID**.</span></span> <span data-ttu-id="80365-185">Legen Sie den Standardwert auf den Pfad des HTML-Dokuments fest, das rechts neben der Explorer-Leiste angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="80365-185">Set its default value to the path of the HTML document that will appear to the right of the Explorer bar.</span></span>

<span data-ttu-id="80365-186">Im folgenden Beispiel wird der als DHTML-Dokument implementierte **mysearchengine** -Such Handler registriert.</span><span class="sxs-lookup"><span data-stu-id="80365-186">The following example registers the **MySearchEngine** search handler implemented as a DHTML document.</span></span> <span data-ttu-id="80365-187">Der Menütext lautet "meine Suchmaschine", wobei M als Tastenkombination angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="80365-187">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="80365-188">Das Symbol befindet sich in C: \\ mydir \\MySearch.dll mit einem Index von 2.</span><span class="sxs-lookup"><span data-stu-id="80365-188">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span> <span data-ttu-id="80365-189">Das DHTML-Dokument der Explorer-Leiste ist c: \\ mydir \\MySearch.htm, und das Dokument, das rechts von der Explorer-Leiste angezeigt wird, ist c: \\ mydir \\MySearchPage.htm.</span><span class="sxs-lookup"><span data-stu-id="80365-189">The Explorer bar's DHTML document is C:\\MyDir\\MySearch.htm, and the document that will be displayed to the right of the Explorer bar is C:\\MyDir\\MySearchPage.htm.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {169A0691-8DF9-11d1-A1C4-00C04FD75D13}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
                                 SearchGUID
                                    (Default) = {My Search GUID}
                                    Url
                                       (Default) = C:\MyDir\MySearch.htm
                                    UrlNavNew
                                       (Default) = C:\MyDir\MySearchPage.htm
```

### <a name="registering-a-dynamic-search-handler"></a><span data-ttu-id="80365-190">Registrieren eines dynamischen Such Handlers</span><span class="sxs-lookup"><span data-stu-id="80365-190">Registering a Dynamic Search Handler</span></span>

<span data-ttu-id="80365-191">Wenn der Handler als Kontext [Menü Handler](/windows/desktop/shell/context-menu-handlers)implementiert ist, können Sie ihn auch als dynamischen Handler registrieren.</span><span class="sxs-lookup"><span data-stu-id="80365-191">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), you can also register it as a dynamic handler.</span></span> <span data-ttu-id="80365-192">In diesem Fall wird Sie mit der Shell geladen und wird nur beendet, wenn die Shell beendet wird.</span><span class="sxs-lookup"><span data-stu-id="80365-192">In that case, it will be loaded with the Shell and will terminate only when the Shell exits.</span></span> <span data-ttu-id="80365-193">Dynamische Such Handler reagieren viel schneller als statische Handler, wenn Sie vom Benutzer gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="80365-193">Dynamic search handlers respond much more quickly than static handlers when they are launched by the user.</span></span> <span data-ttu-id="80365-194">Diese Vorgehensweise funktioniert am besten, wenn die dll Ihres Handlers viel Zeit in Anspruch nehmen kann, oder wenn Sie wahrscheinlich häufig aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="80365-194">This approach works best if your handler's DLL might take a long time to load, or if it is likely to be called frequently.</span></span>

<span data-ttu-id="80365-195">Dynamische Such Handler werden unter dem **findextensions** -Unterschlüssel registriert.</span><span class="sxs-lookup"><span data-stu-id="80365-195">Dynamic search handlers are registered under the **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="80365-196">Erstellen Sie einen Unterschlüssel von **findextensions** mit dem Namen für den Handler, und legen Sie dessen Standardwert auf die CLSID-GUID des Handlers fest.</span><span class="sxs-lookup"><span data-stu-id="80365-196">Create a subkey of **FindExtensions** named for the handler, and set its default value to the handler's CLSID GUID.</span></span> <span data-ttu-id="80365-197">Menü Symbole werden für dynamische Such Handler nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="80365-197">Menu icons are not supported for dynamic search handlers.</span></span> <span data-ttu-id="80365-198">Im folgenden Beispiel wird mysearchengine als dynamischer Such Handler registriert.</span><span class="sxs-lookup"><span data-stu-id="80365-198">The following example registers MySearchEngine as a dynamic search handler.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     MySearchEngine
                        (Default) = {MySearchEngine CLSID GUID}
                        0
                           (Default) = &My Search Engine
```

<span data-ttu-id="80365-199">Im Unterschied zu statischen Such Handlern geben Sie den Menütext nicht in der Registrierung an.</span><span class="sxs-lookup"><span data-stu-id="80365-199">Unlike static search handlers, you do not specify the menu text in the registry.</span></span> <span data-ttu-id="80365-200">Wenn der Handler geladen wird, ruft die **Shell die** [**IContextMenu:: querycontextmenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) -Methode des Handlers auf, um dem Untermenü suchen oder **Suchen** Elemente hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="80365-200">When the handler is loaded, the Shell will call the handler's [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) method to add items to the **Find** or **Search** submenu.</span></span>

## <a name="implementing-search-handlers"></a><span data-ttu-id="80365-201">Implementieren von Such Handlern</span><span class="sxs-lookup"><span data-stu-id="80365-201">Implementing Search Handlers</span></span>

<span data-ttu-id="80365-202">Such Handler können als Kontextmenü Handler für alle Versionen von Windows implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="80365-202">Search handlers can be implemented as shortcut menu handlers for all versions of Windows.</span></span> <span data-ttu-id="80365-203">Für Windows 2000 können diese auch als DHTML-Dokumente implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="80365-203">For Windows 2000, they can also be implemented as DHTML documents.</span></span>

<span data-ttu-id="80365-204">Eine allgemeine Erörterung der Implementierung von Kontextmenü Handlern finden Sie unter [Erstellen von Kontextmenü Handlern](/windows/desktop/shell/context-menu-handlers).</span><span class="sxs-lookup"><span data-stu-id="80365-204">For a general discussion of how to implement shortcut menu handlers, see [Creating Context Menu Handlers](/windows/desktop/shell/context-menu-handlers).</span></span> <span data-ttu-id="80365-205">Such Handler unterscheiden sich von standardmäßigen Kontextmenü Handlern in wenigen Punkten.</span><span class="sxs-lookup"><span data-stu-id="80365-205">Search handlers differ from standard shortcut menu handlers in only a few ways.</span></span>

<span data-ttu-id="80365-206">Bei statischen Menü Handlern wird das Untermenü **Suchen oder** **Suchen** aus den Informationen in der Registrierung erstellt.</span><span class="sxs-lookup"><span data-stu-id="80365-206">For static menu handlers, the **Find** or **Search** submenu is created from the information in the registry.</span></span> <span data-ttu-id="80365-207">Es ist nicht erforderlich, dass der Handler ein Menü Element hinzufügt, da es sich dabei um einen normalen Kontextmenü Handler handelt.</span><span class="sxs-lookup"><span data-stu-id="80365-207">There is no need to have the handler add a menu item, as a normal shortcut menu handler would.</span></span> <span data-ttu-id="80365-208">Die Shell verwaltet statische Menü Handler wie folgt.</span><span class="sxs-lookup"><span data-stu-id="80365-208">The Shell manages static menu handlers in the following way.</span></span>

-   <span data-ttu-id="80365-209">Wenn der Benutzer das Menü Element des Handlers startet, lädt die Shell die DLL des Handlers und ruft [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) auf, um den Handler zu benachrichtigen, dass die Such-Engine gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="80365-209">When the user launches the handler's menu item, the Shell loads the handler's DLL and calls [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) to notify the handler to launch the search engine.</span></span> <span data-ttu-id="80365-210">Die [**ishellextinit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) -und [**IContextMenu:: querycontextmenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) -Methoden werden nicht aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="80365-210">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) methods are not called.</span></span>
-   <span data-ttu-id="80365-211">Wenn [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) aufgerufen wird, identifiziert der **lpverb** -Member der [**cminvokecommandinfo**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) -Struktur, die übergeben wird, den Befehl.</span><span class="sxs-lookup"><span data-stu-id="80365-211">When [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) is called, the **lpVerb** member of the [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) structure that is passed in identifies the command.</span></span> <span data-ttu-id="80365-212">Das nieder wertige Wort von **lpverb** wird auf die numerische Entsprechung des Unterschlüssel namens des Befehls festgelegt.</span><span class="sxs-lookup"><span data-stu-id="80365-212">The low-order word of **lpVerb** is set to the numerical equivalent of the command's subkey name.</span></span> <span data-ttu-id="80365-213">Da dieser Unterschlüssel normalerweise den Namen **0** hat, wird **lpverb** normalerweise auf NULL festgelegt.</span><span class="sxs-lookup"><span data-stu-id="80365-213">Since this subkey is normally named **0**, **lpVerb** is usually set to zero.</span></span> <span data-ttu-id="80365-214">Der Handler sollte dann die Suchmaschine starten.</span><span class="sxs-lookup"><span data-stu-id="80365-214">The handler should then launch the search engine.</span></span>

<span data-ttu-id="80365-215">Dynamische Such Handler werden ähnlich wie normale Kontextmenü Handler implementiert.</span><span class="sxs-lookup"><span data-stu-id="80365-215">Dynamic search handlers are implemented in much the same way as normal shortcut menu handlers.</span></span> <span data-ttu-id="80365-216">Die primäre Ausnahme besteht darin, dass beim Aufrufen von [**ishellextinit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) die Argumente *pidlfolder* und *lpdobj* auf **null** festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="80365-216">The primary exception is that when [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) is called, the *pidlFolder* and *lpdobj* arguments are set to **NULL**.</span></span>

<span data-ttu-id="80365-217">DHTML-basierte Such Handler werden als normales DHTML-Dokument implementiert.</span><span class="sxs-lookup"><span data-stu-id="80365-217">DHTML-based search handlers are implemented as a normal DHTML document.</span></span> <span data-ttu-id="80365-218">Sie können beliebige HTML-, DHTML-oder Skript Erstellungs Technologien enthalten, die von Windows Internet Explorer unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="80365-218">They can include any HTML, DHTML, or scripting technology that is supported by Windows Internet Explorer.</span></span>

 

 