---
title: Hinzufügen von Microsoft-Agent-Funktionen zu Ihrer Anwendung
description: Hinzufügen von Microsoft-Agent-Funktionen zu Ihrer Anwendung
ms.assetid: 2b4816dd-11bf-4c17-873e-4bdbb7fa1ccf
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a2972b0251a4114e5d280d8f739d416ebc5dc1c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "104314835"
---
# <a name="adding-microsoft-agent-functionality-to-your-application"></a><span data-ttu-id="bccee-103">Hinzufügen von Microsoft-Agent-Funktionen zu Ihrer Anwendung</span><span class="sxs-lookup"><span data-stu-id="bccee-103">Adding Microsoft Agent Functionality to Your Application</span></span>

<span data-ttu-id="bccee-104">\[Der Microsoft-Agent ist ab Windows 7 veraltet und in nachfolgenden Versionen von Windows möglicherweise nicht verfügbar.\]</span><span class="sxs-lookup"><span data-stu-id="bccee-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="bccee-105">Um auf die Server Schnittstellen von Microsoft Agent zuzugreifen, muss der-Agent bereits auf dem Zielsystem installiert sein.</span><span class="sxs-lookup"><span data-stu-id="bccee-105">To access Microsoft Agent's server interfaces, Agent must already be installed on the target system.</span></span> <span data-ttu-id="bccee-106">Die Installation außer der selbst Installationsdatei des Agents, wie z. b. der Versuch, agentkomponentendateien zu kopieren und zu registrieren, wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="bccee-106">Installation other than using Agent's self-installing executable file, such as attempting to copy and register Agent component files, is not supported.</span></span> <span data-ttu-id="bccee-107">Dadurch wird eine konsistente und umfassende Installation sichergestellt.</span><span class="sxs-lookup"><span data-stu-id="bccee-107">This ensures consistent and complete installation.</span></span> <span data-ttu-id="bccee-108">Beachten Sie, dass die selbst Installationsdatei des Microsoft-Agents nicht unter Microsoft Windows 2000 und höheren Betriebssystemen installiert werden kann, da diese Versionen des Betriebssystems bereits eine eigene Agent-Version enthalten.</span><span class="sxs-lookup"><span data-stu-id="bccee-108">Note that the Microsoft Agent self-installing file will not install on Microsoft Windows 2000 and later operating systems because these versions of the operating system already include their own version of Agent.</span></span>

<span data-ttu-id="bccee-109">Um den-Agent erfolgreich auf einem Zielsystem mit einem früheren Microsoft Windows-Betriebssystem zu installieren, müssen Sie auch sicherstellen, dass das Zielsystem über eine aktuelle Version der Microsoft Visual C++ Runtime (Msvcrt.dll), des Microsoft-Registrierungs Tools (Regsvr32.dll) und der Microsoft com-DLLs verfügt.</span><span class="sxs-lookup"><span data-stu-id="bccee-109">To successfully install Agent on a target system with a prior Microsoft Windows operating system, you must also ensure that the target system has a recent version of the Microsoft Visual C++ runtime (Msvcrt.dll), Microsoft registration tool (Regsvr32.dll), and Microsoft COM dlls.</span></span> <span data-ttu-id="bccee-110">Die einfachste Möglichkeit, um sicherzustellen, dass die erforderlichen Komponenten auf dem Zielsystem installiert sind, besteht darin, dass Microsoft Internet Explorer 3,02 oder höher installiert ist.</span><span class="sxs-lookup"><span data-stu-id="bccee-110">The easiest way to ensure that the necessary components are on the target system is to require that Microsoft Internet Explorer 3.02 or later is installed.</span></span> <span data-ttu-id="bccee-111">Alternativ können Sie die ersten beiden Komponenten installieren, die als Teil Microsoft Visual C++ verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="bccee-111">Alternatively, you can install the first two components which are available as part of Microsoft Visual C++.</span></span> <span data-ttu-id="bccee-112">Die erforderlichen COM-DLLs können als Teil des Microsoft DCOM-Updates installiert werden, das auf der Microsoft-Website verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="bccee-112">The necessary COM dlls can be installed as part of the Microsoft DCOM update, available at the Microsoft website.</span></span> <span data-ttu-id="bccee-113">Weitere Informationen und Lizenzierungsinformationen zu diesen Komponenten finden Sie auf der Microsoft-Website.</span><span class="sxs-lookup"><span data-stu-id="bccee-113">You can find further information and licensing information for these components at the Microsoft website.</span></span>

<span data-ttu-id="bccee-114">Die Sprachkomponenten des Agents können auf die gleiche Weise installiert werden.</span><span class="sxs-lookup"><span data-stu-id="bccee-114">Agent's language components can be installed the same way.</span></span> <span data-ttu-id="bccee-115">Auf ähnliche Weise können Sie diese Technik verwenden, um das ACS-Format der Microsoft-Zeichen zu installieren, die für die Verteilung auf der Microsoft Agent-Website verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="bccee-115">Similarly, you can use this technique to install the ACS format of the Microsoft characters available for distribution from the Microsoft Agent website.</span></span> <span data-ttu-id="bccee-116">Die Zeichen Dateien werden automatisch im Unterverzeichnis Microsoft-Agent- \\ chars installiert.</span><span class="sxs-lookup"><span data-stu-id="bccee-116">The character files automatically install to the Microsoft Agent \\Chars subdirectory.</span></span>

<span data-ttu-id="bccee-117">Da die Komponenten des Microsoft-Agents als Betriebssystemkomponenten entworfen wurden, ist der-Agent möglicherweise nicht deinstalliert.</span><span class="sxs-lookup"><span data-stu-id="bccee-117">Because Microsoft Agent's components are designed as operating system components, Agent may not be uninstalled.</span></span> <span data-ttu-id="bccee-118">Ebenso, wo der-Agent bereits als Teil des Windows-Betriebssystems installiert ist, kann die CAB-Datei des Agents möglicherweise nicht installiert werden.</span><span class="sxs-lookup"><span data-stu-id="bccee-118">Similarly, where Agent is already installed as part of the Windows operating system, the Agent self-installing cabinet may not install.</span></span>

<span data-ttu-id="bccee-119">Wenn die Schnittstellen des Agents aufgerufen wurden, erstellen Sie eine Instanz des Servers, und fordern Sie einen Zeiger auf eine bestimmte Schnittstelle an, die der Server unter Verwendung der com-Standard Konvention unterstützt.</span><span class="sxs-lookup"><span data-stu-id="bccee-119">Once installed, to call Agent's interfaces, create an instance of the server and request a pointer to a specific interface that the server supports using the standard COM convention.</span></span> <span data-ttu-id="bccee-120">Insbesondere die com-Bibliothek stellt eine API-Funktion, [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance), bereit, die eine Instanz des-Objekts erstellt und einen Zeiger auf die angeforderte Schnittstelle des-Objekts zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="bccee-120">In particular, the COM library provides an API function, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance), that creates an instance of the object and returns a pointer to the requested interface of the object.</span></span> <span data-ttu-id="bccee-121">Fordern Sie einen Zeiger auf die [**iagent**](iagent.md) -oder [**iagentex**](iagentex.md) -Schnittstelle in Ihrem **copurateinstance** -Befehl oder in einem nachfolgenden Aufrufen von [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q))an.</span><span class="sxs-lookup"><span data-stu-id="bccee-121">Request a pointer to the [**IAgent**](iagent.md) or [**IAgentEx**](iagentex.md) interface in your **CoCreateInstance** call or in a subsequent call to [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span>

<span data-ttu-id="bccee-122">Der folgende Code veranschaulicht dies in C/C++.</span><span class="sxs-lookup"><span data-stu-id="bccee-122">The following code illustrates this in C/C++.</span></span>


```
hRes = CoCreateInstance(CLSID_AgentServer,
                     NULL,
                     CLSCTX_SERVER,
                     IID_IAgentEx,
                     (LPVOID *)&amp;pAgentEx);
```



<span data-ttu-id="bccee-123">Wenn der Microsoft-Agent-Server ausgeführt wird, stellt diese Funktion eine Verbindung mit dem Server her. Andernfalls wird der Server gestartet.</span><span class="sxs-lookup"><span data-stu-id="bccee-123">If the Microsoft Agent server is running, this function connects to the server; otherwise, it starts up the server.</span></span>

<span data-ttu-id="bccee-124">Beachten Sie, dass die Microsoft-Agent-Server Schnittstellen häufig Erweiterte Schnittstellen enthalten, die das Suffix "ex" enthalten.</span><span class="sxs-lookup"><span data-stu-id="bccee-124">Note that the Microsoft Agent server interfaces often include extended interfaces that include an "Ex" suffix.</span></span> <span data-ttu-id="bccee-125">Diese Schnittstellen werden von abgeleitet und enthalten daher sämtliche Funktionen von, ihre nicht-Ex-Entsprechungen.</span><span class="sxs-lookup"><span data-stu-id="bccee-125">These interfaces are derived from, and therefore include all the functionality of, their non-Ex counterparts.</span></span> <span data-ttu-id="bccee-126">Wenn Sie eine der erweiterten Features verwenden möchten, verwenden Sie die Ex-Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="bccee-126">If you want to use any of the extended features, use the Ex interfaces.</span></span>

<span data-ttu-id="bccee-127">Funktionen, die Zeiger auf bstrins verwenden, belegen mithilfe von [**SysAllocString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysallocstring)Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="bccee-127">Functions that take pointers to BSTRs allocate memory using [**SysAllocString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysallocstring).</span></span> <span data-ttu-id="bccee-128">Es liegt in der Verantwortung des Aufrufers, diesen Arbeitsspeicher mit [**SysFreeString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysfreestring)freizugeben.</span><span class="sxs-lookup"><span data-stu-id="bccee-128">It is the caller's responsibility to free this memory using [**SysFreeString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysfreestring).</span></span>

 

 