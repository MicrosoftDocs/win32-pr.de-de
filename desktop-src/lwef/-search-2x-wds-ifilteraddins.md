---
title: Entwickeln von IFilter-Add-ins
description: Sie können Microsoft Windows Desktop Search (WDS) mit Filter-Add-Ins, Komponenten, die ifilterinterface implementieren, erweitern, um neue Dateitypen einzubeziehen.
ms.assetid: 71dd515d-a73e-4e0a-b0da-c8a6209d09fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 79f846cf2101eefc17b1e92fbd7992529a06fb43
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "104473028"
---
# <a name="developing-ifilter-add-ins"></a><span data-ttu-id="5a988-103">Entwickeln von IFilter-Add-ins</span><span class="sxs-lookup"><span data-stu-id="5a988-103">Developing IFilter Add-ins</span></span>

> [!NOTE]
> <span data-ttu-id="5a988-104">Windows-Desktop Suche 2. x ist eine veraltete Technologie, die ursprünglich als Add-in für Windows XP und Windows Server 2003 verfügbar war.</span><span class="sxs-lookup"><span data-stu-id="5a988-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="5a988-105">Verwenden Sie in späteren Versionen stattdessen [Windows Search](../search/-search-3x-wds-overview.md) .</span><span class="sxs-lookup"><span data-stu-id="5a988-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="5a988-106">Sie können Microsoft Windows Desktop Search (WDS) mit Filter-Add-Ins, Komponenten, die die [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)-Schnittstelle implementieren, erweitern, um neue Dateitypen einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="5a988-106">You can extend Microsoft Windows Desktop Search (WDS) with filter add-ins, components that implement the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface, to include new file types.</span></span> <span data-ttu-id="5a988-107">Filter sind für den Zugriff und die Datenverarbeitung in Dateien und für das Zurückgeben von Paaren von Eigenschaften und Werten sowie von Textabschnitten für die Indizierung verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="5a988-107">Filters are responsible for accessing and parsing data in files and for returning pairs of properties and values as well as chunks of text for indexing.</span></span> <span data-ttu-id="5a988-108">Während des Indizierungs Vorgangs ruft WDS den entsprechenden Filter mit der URL für jede Datei oder jedes Element auf.</span><span class="sxs-lookup"><span data-stu-id="5a988-108">During the indexing process, WDS calls the appropriate filter with the URL for each file or item.</span></span> <span data-ttu-id="5a988-109">Der Filter extrahiert zuerst Metadaten, die Eigenschaften entsprechen, die im WDS-Schema als abrufbar gekennzeichnet sind, z. b. Titel, Dateigröße und Datum der letzten Änderung.</span><span class="sxs-lookup"><span data-stu-id="5a988-109">The filter first extracts metadata that corresponds to properties that are marked retrievable in the WDS schema, such as title, file size, and last modified date.</span></span> <span data-ttu-id="5a988-110">Anschließend wird der Element Inhalt in Textblöcke aufgeteilt.</span><span class="sxs-lookup"><span data-stu-id="5a988-110">Then it breaks the item content into chunks of text.</span></span> <span data-ttu-id="5a988-111">WDS fügt dem Katalog die Eigenschaften und den Text hinzu, die vom Filter zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-111">WDS adds the properties and text returned by the filter to the catalog.</span></span> <span data-ttu-id="5a988-112">WDS kann jeden Dateityp indizieren, für den er einen registrierten Filter hat.</span><span class="sxs-lookup"><span data-stu-id="5a988-112">WDS can index any file type for which it has a registered filter.</span></span>

<span data-ttu-id="5a988-113">In einigen Fällen müssen Sie keinen neuen Filter schreiben.</span><span class="sxs-lookup"><span data-stu-id="5a988-113">In some circumstances, you do not need to write a new filter.</span></span> <span data-ttu-id="5a988-114">WDS 2. x enthält Filter für mehr als 200 Typen von Elementen (einschließlich Klartext-Elemente wie HTML-, XML-und Quell Code Dateien) und verwendet dieselbe [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)-Technologie wie SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="5a988-114">WDS 2.x contains filters for over 200 types of items (including plaintext items such as HTML, XML, and source code files) and uses the same [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)technology as SharePoint Services.</span></span> <span data-ttu-id="5a988-115">Wenn Sie bereits Filter für die Dateitypen installiert haben, kann WDS diese vorhandenen Filter verwenden, um diese Daten zu indizieren.</span><span class="sxs-lookup"><span data-stu-id="5a988-115">If you already have filters installed for your file types, WDS can use those existing filters to index this data.</span></span> <span data-ttu-id="5a988-116">Außerdem enthält WDS einen allgemeinen Filter für Dateitypen, die nur-Text-basiert sind.</span><span class="sxs-lookup"><span data-stu-id="5a988-116">Furthermore, WDS includes a general filter for file types that are plaintext-based.</span></span> <span data-ttu-id="5a988-117">Wenn Sie über einen Dateityp verfügen, der entweder von einem vorhandenen SharePoint Services-Filter oder dem Klartext-Filter verarbeitet werden kann, können Sie die Dateinamenerweiterung und die Filter-GUID der Registrierung hinzufügen, sodass Sie von WDS gefunden und verwendet werden kann. (Weitere Informationen finden Sie [unter Registrieren eines Filter-Add-ins](#to-register-a-filter-add-in) .)</span><span class="sxs-lookup"><span data-stu-id="5a988-117">If you have a file type that can be processed by either an existing SharePoint Services filter or the plaintext filter, you can add the file name extension and filter GUID to the Registry so WDS can locate and use it (see [To Register a Filter Add-in](#to-register-a-filter-add-in) for more information).</span></span>

<span data-ttu-id="5a988-118">Wenn Sie jedoch ein nicht-Klartext-und ein proprietäres Daten-oder Dateiformat haben, ist das Schreiben einer benutzerdefinierten Filter Implementierung der einzige Weg, um sicherzustellen, dass WDS das Dateiformat im Katalog indizieren kann.</span><span class="sxs-lookup"><span data-stu-id="5a988-118">If, however, you have a non-plaintext and proprietary data or file format, writing a custom filter implementation is the only way to ensure WDS can index the file format in the catalog.</span></span> <span data-ttu-id="5a988-119">Sie können nur ein Filter-Add-in für einen Dateityp haben, sodass es möglich ist, einen vorhandenen Filter zu überschreiben oder einen anderen Filter für einen bestimmten Dateityp zu überschreiben.</span><span class="sxs-lookup"><span data-stu-id="5a988-119">You can have only one filter add-in for a file type, so it is possible to override an existing filter or to have another filter override yours for a specific file type.</span></span>

<span data-ttu-id="5a988-120">Dieser Abschnitt enthält die folgenden Themen:</span><span class="sxs-lookup"><span data-stu-id="5a988-120">This section contains the following topics:</span></span>

-   [<span data-ttu-id="5a988-121">Erforderliche Filter Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="5a988-121">Required Filter Interfaces</span></span>](#required-filter-interfaces)
    -   [<span data-ttu-id="5a988-122">IFilter-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="5a988-122">IFilter Interface</span></span>](#ifilter-interface)
    -   [<span data-ttu-id="5a988-123">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="5a988-123">IPersistStream</span></span>](#ipersiststream)
    -   [<span data-ttu-id="5a988-124">IPersistFile</span><span class="sxs-lookup"><span data-stu-id="5a988-124">IPersistFile</span></span>](#ipersistfile)
    -   [<span data-ttu-id="5a988-125">IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="5a988-125">IPersistStorage</span></span>](#ipersiststorage)
-   [<span data-ttu-id="5a988-126">Ausgabe von Eigenschaften mit Filtern</span><span class="sxs-lookup"><span data-stu-id="5a988-126">Outputting Properties with Filters</span></span>](#outputting-properties-with-filters)
    -   [<span data-ttu-id="5a988-127">Eigenschaftswerte</span><span class="sxs-lookup"><span data-stu-id="5a988-127">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="5a988-128">Installation des Add-ins Filtern</span><span class="sxs-lookup"><span data-stu-id="5a988-128">Filter Add-in Installation</span></span>](#filter-add-in-installation)
    -   [<span data-ttu-id="5a988-129">Für die Registrierung erforderliche CLSIDs</span><span class="sxs-lookup"><span data-stu-id="5a988-129">CLSIDs Required for Registration</span></span>](#clsids-required-for-registration)
    -   [<span data-ttu-id="5a988-130">Registrierungs Modell</span><span class="sxs-lookup"><span data-stu-id="5a988-130">Registration Model</span></span>](#registration-model)
    -   [<span data-ttu-id="5a988-131">So registrieren Sie ein Filter-Add-in</span><span class="sxs-lookup"><span data-stu-id="5a988-131">To Register a Filter Add-in</span></span>](#to-register-a-filter-add-in)
-   [<span data-ttu-id="5a988-132">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="5a988-132">Related topics</span></span>](#related-topics)

## <a name="required-filter-interfaces"></a><span data-ttu-id="5a988-133">Erforderliche Filter Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="5a988-133">Required Filter Interfaces</span></span>

<span data-ttu-id="5a988-134">Ein Filter-Add-in muss die [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)-Schnittstelle und eine der folgenden Schnittstellen implementieren:</span><span class="sxs-lookup"><span data-stu-id="5a988-134">A filter add-in must implement the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface and one of the following interfaces:</span></span>

-   <span data-ttu-id="5a988-135">[IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) -zum Laden von Daten aus einem Stream.</span><span class="sxs-lookup"><span data-stu-id="5a988-135">[IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) - To load data from a stream.</span></span> <span data-ttu-id="5a988-136">Dies ist sicherer als die Verwendung von Dateien, da nichts auf den Datenträger geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="5a988-136">This is more secure than using files because nothing is written to disk.</span></span> <span data-ttu-id="5a988-137">Die IPersistStream-Schnittstelle ist die bevorzugte Methode für die Vorwärtskompatibilität mit Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="5a988-137">The IPersistStream interface is the preferred method for forward compatibility with Windows Vista.</span></span>
-   <span data-ttu-id="5a988-138">[IPersistFile-Schnittstelle](/windows/win32/api/objidl/nn-objidl-ipersistfile) : zum Laden von Daten aus einer Datei.</span><span class="sxs-lookup"><span data-stu-id="5a988-138">[IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) - To load data from a file.</span></span> <span data-ttu-id="5a988-139">Diese Schnittstelle wird in Windows Vista nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="5a988-139">This interface is not supported in Windows Vista.</span></span>
-   <span data-ttu-id="5a988-140">[IPersistStorage-Schnittstelle](/windows/win32/api/objidl/nn-objidl-ipersiststorage) : zum Laden von Daten aus einem strukturierten OLE-com-Speicher.</span><span class="sxs-lookup"><span data-stu-id="5a988-140">[IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) - To load data from an OLE COM Structured Storage.</span></span>

<span data-ttu-id="5a988-141">Ein Filter-Add-in verwendet diese Schnittstellen, um den Inhalt des Elements zu erhalten und Sie iterativ an den Index zurückzugeben, bis das Ende der Datei erreicht ist.</span><span class="sxs-lookup"><span data-stu-id="5a988-141">A filter add-in uses these interfaces to get the contents of the item and return them iteratively to the index until the end of the file is reached.</span></span> <span data-ttu-id="5a988-142">Ein Filter-Add-in sollte so robust wie möglich sein, damit beschädigte Dateien verarbeitet werden können, die nicht den erwarteten Eingabe Formaten entsprechen.</span><span class="sxs-lookup"><span data-stu-id="5a988-142">A filter add-in should be as robust as possible to handle corrupt files and those that do not meet expected input formats.</span></span>

### <a name="ifilter-interface"></a><span data-ttu-id="5a988-143">IFilter-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="5a988-143">IFilter Interface</span></span>

<span data-ttu-id="5a988-144">Dies ist eine erforderliche Schnittstelle für eine Filter Implementierung.</span><span class="sxs-lookup"><span data-stu-id="5a988-144">This is a required interface for a filter implementation.</span></span> <span data-ttu-id="5a988-145">Weitere Informationen finden Sie in der Referenz zur [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="5a988-145">For more information, see the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface reference.</span></span>



| <span data-ttu-id="5a988-146">Methode</span><span class="sxs-lookup"><span data-stu-id="5a988-146">Method</span></span>       | <span data-ttu-id="5a988-147">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="5a988-147">Description</span></span>                                                                            |
|--------------|----------------------------------------------------------------------------------------|
| <span data-ttu-id="5a988-148">Init ()</span><span class="sxs-lookup"><span data-stu-id="5a988-148">Init()</span></span>       | <span data-ttu-id="5a988-149">Initialisiert eine Filter Sitzung.</span><span class="sxs-lookup"><span data-stu-id="5a988-149">Initializes a filtering session.</span></span>                                                       |
| <span data-ttu-id="5a988-150">GetChunk ()</span><span class="sxs-lookup"><span data-stu-id="5a988-150">GetChunk()</span></span>   | <span data-ttu-id="5a988-151">Positioniert den Filter am Anfang des ersten oder nächsten Blocks und gibt einen Deskriptor zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-151">Positions the filter at the beginning of first or next chunk and returns a descriptor.</span></span> |
| <span data-ttu-id="5a988-152">Gettext ()</span><span class="sxs-lookup"><span data-stu-id="5a988-152">GetText()</span></span>    | <span data-ttu-id="5a988-153">Ruft Text aus dem aktuellen Segment ab.</span><span class="sxs-lookup"><span data-stu-id="5a988-153">Retrieves text from the current chunk.</span></span>                                                 |
| <span data-ttu-id="5a988-154">GetValue()</span><span class="sxs-lookup"><span data-stu-id="5a988-154">GetValue()</span></span>   | <span data-ttu-id="5a988-155">Ruft Eigenschaftswerte aus dem aktuellen Segment ab.</span><span class="sxs-lookup"><span data-stu-id="5a988-155">Retrieves property values from the current chunk.</span></span>                                      |
| <span data-ttu-id="5a988-156">BindRegion ()</span><span class="sxs-lookup"><span data-stu-id="5a988-156">BindRegion()</span></span> | <span data-ttu-id="5a988-157">Derzeit für die interne Verwendung reserviert. nicht implementieren.</span><span class="sxs-lookup"><span data-stu-id="5a988-157">Currently reserved for internal use; do not implement.</span></span> <span data-ttu-id="5a988-158">Diese Methode gibt "E \_ notimpl" zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-158">This method returns E\_NOTIMPL.</span></span> |



 

### <a name="ipersiststream"></a><span data-ttu-id="5a988-159">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="5a988-159">IPersistStream</span></span>

<span data-ttu-id="5a988-160">Diese Schnittstelle lädt eine Datei aus einem Stream für eine sicherere Verarbeitung als die [IPersistFile-Schnittstelle](/windows/win32/api/objidl/nn-objidl-ipersistfile) , da der Kontext, in dem ein [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) -Filter ausgeführt wird, nicht die Berechtigung zum Öffnen von Dateien auf dem Datenträger oder über das Netzwerk benötigt.</span><span class="sxs-lookup"><span data-stu-id="5a988-160">This interface loads a file from a stream for more secure processing than [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) because the context in which a [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) filter runs does not need the rights to open any files on the disk or over the network.</span></span> <span data-ttu-id="5a988-161">Von den beiden Methoden für den Zugriff auf eine einzelne Datei wird dies als bevorzugte Methode für die Vorwärtskompatibilität mit Windows empfohlen.</span><span class="sxs-lookup"><span data-stu-id="5a988-161">Of the two methods for accessing a single file, this is the preferred method for forward compatibility with Windows.</span></span>



| <span data-ttu-id="5a988-162">Methode</span><span class="sxs-lookup"><span data-stu-id="5a988-162">Method</span></span>       | <span data-ttu-id="5a988-163">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="5a988-163">Description</span></span>                                                                                                                                        |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="5a988-164">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="5a988-164">IsDirty()</span></span>    | <span data-ttu-id="5a988-165">Prüft, ob eine Änderung vorliegt.</span><span class="sxs-lookup"><span data-stu-id="5a988-165">Checks if there has been a change.</span></span> <span data-ttu-id="5a988-166">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-166">This method returns E\_NOTIMPL in filters.</span></span>                                                                      |
| <span data-ttu-id="5a988-167">InitNew ()</span><span class="sxs-lookup"><span data-stu-id="5a988-167">InitNew()</span></span>    | <span data-ttu-id="5a988-168">Erstellt einen neuen Speicher.</span><span class="sxs-lookup"><span data-stu-id="5a988-168">Creates a new storage.</span></span> <span data-ttu-id="5a988-169">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-169">This method returns E\_NOTIMPL in filters.</span></span>                                                                                  |
| <span data-ttu-id="5a988-170">Load ()</span><span class="sxs-lookup"><span data-stu-id="5a988-170">Load()</span></span>       | <span data-ttu-id="5a988-171">Initialisiert ein Objekt aus dem Stream, in dem es zuvor gespeichert wurde.</span><span class="sxs-lookup"><span data-stu-id="5a988-171">Initializes an object from the stream where it was previously saved.</span></span>                                                                               |
| <span data-ttu-id="5a988-172">Speichern ()</span><span class="sxs-lookup"><span data-stu-id="5a988-172">Save()</span></span>       | <span data-ttu-id="5a988-173">Speichert ein Objekt in den angegebenen Stream und gibt an, ob das Objekt das geänderte Flag zurücksetzen soll.</span><span class="sxs-lookup"><span data-stu-id="5a988-173">Saves an object into the specified stream and indicates whether the object should reset its dirty flag.</span></span> <span data-ttu-id="5a988-174">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-174">This method returns E\_NOTIMPL in filters.</span></span> |
| <span data-ttu-id="5a988-175">GetSizeMax ()</span><span class="sxs-lookup"><span data-stu-id="5a988-175">GetSizeMax()</span></span> | <span data-ttu-id="5a988-176">Gibt die Größe des Streams in Bytes zurück, der für das Speichern des Objekts benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="5a988-176">Returns the size in bytes of the stream needed to save the object.</span></span> <span data-ttu-id="5a988-177">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-177">This method returns E\_NOTIMPL in filters.</span></span>                                      |



 

### <a name="ipersistfile"></a><span data-ttu-id="5a988-178">IPersistFile</span><span class="sxs-lookup"><span data-stu-id="5a988-178">IPersistFile</span></span>

<span data-ttu-id="5a988-179">Diese Schnittstelle lädt eine Datei nach dem absoluten Pfad und wird in Windows Vista nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="5a988-179">This interface loads a file by absolute path and is not supported in Windows Vista.</span></span>



| <span data-ttu-id="5a988-180">Methode</span><span class="sxs-lookup"><span data-stu-id="5a988-180">Method</span></span>          | <span data-ttu-id="5a988-181">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="5a988-181">Description</span></span>                                                                                                                  |
|-----------------|------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="5a988-182">Getcurrfile ()</span><span class="sxs-lookup"><span data-stu-id="5a988-182">GetCurFile()</span></span>    | <span data-ttu-id="5a988-183">Ruft den aktuellen Namen der Datei ab, die dem-Objekt zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="5a988-183">Gets the current name of the file associated with the object.</span></span> <span data-ttu-id="5a988-184">Gibt den in Load () angegebenen Pfad zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-184">Returns the path specified in Load().</span></span>                          |
| <span data-ttu-id="5a988-185">Load ()</span><span class="sxs-lookup"><span data-stu-id="5a988-185">Load()</span></span>          | <span data-ttu-id="5a988-186">Öffnet die angegebene Datei, und initialisiert ein Objekt aus dem Dateiinhalt.</span><span class="sxs-lookup"><span data-stu-id="5a988-186">Opens the specified file and initializes an object from the file contents.</span></span> <span data-ttu-id="5a988-187">Sie können das Öffnen der Datei verzögern, bis Sie Sie benötigen.</span><span class="sxs-lookup"><span data-stu-id="5a988-187">You can delay opening the file until you need it.</span></span> |
| <span data-ttu-id="5a988-188">GetClassID ()</span><span class="sxs-lookup"><span data-stu-id="5a988-188">GetClassID()</span></span>    | <span data-ttu-id="5a988-189">Gibt den Klassen Bezeichner (CLSID) für den neuen Dateityp zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-189">Returns the class identifier (CLSID) for the new file type.</span></span> <span data-ttu-id="5a988-190">Verwenden Sie uuidgen.exe, um eine eindeutige CLSID zu generieren.</span><span class="sxs-lookup"><span data-stu-id="5a988-190">You should use uuidgen.exe to generate a unique CLSID.</span></span>           |
| <span data-ttu-id="5a988-191">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="5a988-191">IsDirty()</span></span>       | <span data-ttu-id="5a988-192">"E \_ notimpl" muss nur in Filtern zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-192">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |
| <span data-ttu-id="5a988-193">Speichern ()</span><span class="sxs-lookup"><span data-stu-id="5a988-193">Save()</span></span>          | <span data-ttu-id="5a988-194">"E \_ notimpl" muss nur in Filtern zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-194">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |
| <span data-ttu-id="5a988-195">Saveabgeschlossen ()</span><span class="sxs-lookup"><span data-stu-id="5a988-195">SaveCompleted()</span></span> | <span data-ttu-id="5a988-196">"E \_ notimpl" muss nur in Filtern zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-196">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |



 

### <a name="ipersiststorage"></a><span data-ttu-id="5a988-197">IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="5a988-197">IPersistStorage</span></span>

<span data-ttu-id="5a988-198">Diese Schnittstelle unterstützt das strukturierte Speichermodell, in dem jedes enthaltene Objekt über einen eigenen Speicher verfügt, der im Speicher des Containers geschachtelt ist.</span><span class="sxs-lookup"><span data-stu-id="5a988-198">This interface supports the structured storage model, in which each contained object has its own storage that is nested within the container's storage.</span></span> <span data-ttu-id="5a988-199">Ebenso wie die [IPersistFile-Schnittstelle](/windows/win32/api/objidl/nn-objidl-ipersistfile)wird diese Schnittstelle nach dem absoluten Pfad geladen und wird in Windows Vista nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="5a988-199">Like [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile), this interface loads by absolute path and is not supported in Windows Vista.</span></span>



| <span data-ttu-id="5a988-200">Methode</span><span class="sxs-lookup"><span data-stu-id="5a988-200">Method</span></span>            | <span data-ttu-id="5a988-201">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="5a988-201">Description</span></span>                                                                                                   |
|-------------------|---------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="5a988-202">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="5a988-202">IsDirty()</span></span>         | <span data-ttu-id="5a988-203">Prüft, ob eine Änderung vorliegt.</span><span class="sxs-lookup"><span data-stu-id="5a988-203">Checks if there has been a change.</span></span> <span data-ttu-id="5a988-204">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-204">This method returns E\_NOTIMPL in filters.</span></span>                                 |
| <span data-ttu-id="5a988-205">InitNew ()</span><span class="sxs-lookup"><span data-stu-id="5a988-205">InitNew()</span></span>         | <span data-ttu-id="5a988-206">Erstellt einen neuen Speicher.</span><span class="sxs-lookup"><span data-stu-id="5a988-206">Creates a new storage.</span></span> <span data-ttu-id="5a988-207">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-207">This method returns E\_NOTIMPL in filters.</span></span>                                             |
| <span data-ttu-id="5a988-208">Load ()</span><span class="sxs-lookup"><span data-stu-id="5a988-208">Load()</span></span>            | <span data-ttu-id="5a988-209">Speichert den Speicher.</span><span class="sxs-lookup"><span data-stu-id="5a988-209">Saves the storage.</span></span> <span data-ttu-id="5a988-210">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-210">This method returns E\_NOTIMPL in filters.</span></span>                                                 |
| <span data-ttu-id="5a988-211">Speichern ()</span><span class="sxs-lookup"><span data-stu-id="5a988-211">Save()</span></span>            | <span data-ttu-id="5a988-212">Gibt die Größe des Streams in Bytes zurück, der für das Speichern des Objekts benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="5a988-212">Returns the size in bytes of the stream needed to save the object.</span></span> <span data-ttu-id="5a988-213">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-213">This method returns E\_NOTIMPL in filters.</span></span> |
| <span data-ttu-id="5a988-214">Saveabgeschlossen ()</span><span class="sxs-lookup"><span data-stu-id="5a988-214">SaveCompleted()</span></span>   | <span data-ttu-id="5a988-215">Für die interne Verwendung reserviert.</span><span class="sxs-lookup"><span data-stu-id="5a988-215">Reserved for internal use.</span></span> <span data-ttu-id="5a988-216">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-216">This method returns E\_NOTIMPL in filters.</span></span>                                         |
| <span data-ttu-id="5a988-217">HandsOffStorage ()</span><span class="sxs-lookup"><span data-stu-id="5a988-217">HandsOffStorage()</span></span> | <span data-ttu-id="5a988-218">Für die interne Verwendung reserviert.</span><span class="sxs-lookup"><span data-stu-id="5a988-218">Reserved for internal use.</span></span> <span data-ttu-id="5a988-219">Diese Methode gibt "E \_ notimpl" in Filtern zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-219">This method returns E\_NOTIMPL in filters.</span></span>                                         |



 

## <a name="outputting-properties-with-filters"></a><span data-ttu-id="5a988-220">Ausgabe von Eigenschaften mit Filtern</span><span class="sxs-lookup"><span data-stu-id="5a988-220">Outputting Properties with Filters</span></span>

<span data-ttu-id="5a988-221">Der Zweck eines Filters besteht darin, den Inhalt und die Eigenschaften von Dateien zu extrahieren, die in den Volltextindex eingeschlossen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="5a988-221">The purpose of a filter is to extract the content and properties of files for inclusion in the full-text index.</span></span> <span data-ttu-id="5a988-222">WDS ruft zuerst die Load-Methode für die Implementierungen IPersistFile, IPersistStream oder IPersistStorage auf und ruft dann die Init-Methode der IFilter-Implementierung auf.</span><span class="sxs-lookup"><span data-stu-id="5a988-222">WDS first calls the Load method on either the IPersistFile, IPersistStream, or IPersistStorage implementations and then invokes the Init method of the IFilter implementation.</span></span> <span data-ttu-id="5a988-223">**GetChunk** wird aufgerufen, um Segmente von Text-oder Eigenschafts Wert Daten abzurufen, und dann wird entweder **gettext** oder **GetValue** so oft wie nötig aufgerufen, um alle dem Block zugeordneten Text-oder Eigenschaftswerte abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5a988-223">**GetChunk** is called to retrieve chunks of text or property value data, and then either **GetText** or **GetValue** is called as many times as needed to retrieve all of the text or property values associated with the chunk.</span></span> <span data-ttu-id="5a988-224">Dieser Prozess wird wiederholt, bis **GetChunk** meldet, dass im Dokument keine weiteren Segmente vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="5a988-224">This process repeats until **GetChunk** reports that there are no more chunks in the document.</span></span>

<span data-ttu-id="5a988-225">Die **GetChunk** -Methode ruft Informationen zum ersten oder nächsten logischen Informationsblock aus der zu filternden Datei ab und gibt diese Informationen in einer stat-Blockstruktur zurück. \_ einschließlich einer monoton zunehmenden Block-ID, Statusinformationen darüber, wie sich der aktuelle Block auf den vorherigen Block bezieht, ein Flag, das angibt, ob der Block Text oder einen Wert, das Gebiets Schema des Segments und die Eigenschafts Spezifikation des Segments enthält.</span><span class="sxs-lookup"><span data-stu-id="5a988-225">The **GetChunk** method retrieves information about the first or next logical block of information from the file being filtered and returns that information in a STAT\_CHUNK structure, including a monotonically increasing chunk ID, status information about how the current chunk relates to the previous chunk, a flag indicating whether the chunk contains text or a value, the chunk's locale, and the chunk's property specification.</span></span> <span data-ttu-id="5a988-226">Die Eigenschafts Spezifikation ist eine [**fullpropspec**](/windows/desktop/api/filter/ns-filter-fullpropspec) , die aus einer CLSID und einem ganzzahligen Eigenschafts Bezeichner (z. b. D5CDD505-2E9C-101B-9397-08002B2CF9AE/wahrnehmvedtype) besteht.</span><span class="sxs-lookup"><span data-stu-id="5a988-226">The property specification is a [**FULLPROPSPEC**](/windows/desktop/api/filter/ns-filter-fullpropspec) consisting of a CLSID and either an integer or string property identifier (for example, D5CDD505-2E9C-101B-9397-08002B2CF9AE/PerceivedType).</span></span> <span data-ttu-id="5a988-227">Sie identifiziert den Typ der Eigenschaft und nicht den Eigenschafts Wert selbst.</span><span class="sxs-lookup"><span data-stu-id="5a988-227">It identifies the type of property rather than the property value itself.</span></span>

<span data-ttu-id="5a988-228">Der Gebiets Schema Bezeichner "Block" wird verwendet, um eine entsprechende Wörter Trennung auszuwählen, und es ist sehr wichtig, dass Sie ihn ordnungsgemäß identifizieren.</span><span class="sxs-lookup"><span data-stu-id="5a988-228">The chunk locale identifier is used to choose an appropriate word breaker, and it is very important that you correctly identify it.</span></span> <span data-ttu-id="5a988-229">Wenn der Filter das Gebiets Schema des Texts nicht ermitteln kann, sollte er das standardmäßige System Gebiets Schema annehmen, das mit **GetSystemDefaultLCID** verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="5a988-229">If the filter cannot determine the locale of the text, it should assume the default system locale, available by using **GetSystemDefaultLCID**.</span></span> <span data-ttu-id="5a988-230">Wenn Sie das Dateiformat Steuern und es derzeit keine Gebiets Schema Informationen enthält, sollten Sie eine Benutzerfunktion hinzufügen, um die ordnungsgemäße Gebiets Schema Identifizierung zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="5a988-230">If you control the file format and it currently does not contain locale information, you should add a user feature to enable proper locale identification.</span></span> <span data-ttu-id="5a988-231">Wenn eine nicht übereinstimmende Wörter Trennung verwendet wird, kann dies zu einer ungültigen Abfrageleistung für den Benutzer führen.</span><span class="sxs-lookup"><span data-stu-id="5a988-231">Using a mismatched word breaker can lead to a bad query experience for the user.</span></span>

<span data-ttu-id="5a988-232">**GetChunk** verwaltet nur den Zugriff auf Blöcke und gibt weder den Text noch den Eigenschafts Wert selbst zurück.</span><span class="sxs-lookup"><span data-stu-id="5a988-232">**GetChunk** only manages accessing chunks and does not return the text or property value itself.</span></span> <span data-ttu-id="5a988-233">Stattdessen rufen nachfolgende Aufrufe von **gettext** und **GetValue** den Text des Segments ab.</span><span class="sxs-lookup"><span data-stu-id="5a988-233">Rather, subsequent calls to **GetText** and **GetValue** retrieve the body of the chunk.</span></span> <span data-ttu-id="5a988-234">**Gettext** gibt Textblöcke zurück, bei denen es sich um Unicode-Zeichen folgen aus dem aktuellen \_ Block Textabschnitt handelt.</span><span class="sxs-lookup"><span data-stu-id="5a988-234">**GetText** returns text chunks, which are Unicode strings, from the current CHUNK\_TEXT chunk.</span></span> <span data-ttu-id="5a988-235">Wenn der aktuelle Block zu groß ist, können mehrere Aufrufe der **gettext** -Methode erforderlich sein.</span><span class="sxs-lookup"><span data-stu-id="5a988-235">If the current chunk is too large, more than one call to the **GetText** method can be required.</span></span> <span data-ttu-id="5a988-236">Jeder Aufrufen der **gettext** -Methode ruft Text ab, der direkt auf den Text des letzten Aufrufens der **gettext** -Methode folgt.</span><span class="sxs-lookup"><span data-stu-id="5a988-236">Each call to the **GetText** method retrieves text that immediately follows the text from the last call to the **GetText** method.</span></span> <span data-ttu-id="5a988-237">Beispielsweise kann das letzte Zeichen eines Aufrufes in der Mitte eines Worts sein, und das erste Zeichen im nächsten-Befehl würde dieses Wort fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="5a988-237">For example, the last character from one call can be in the middle of a word, and the first character in the next call would continue that word.</span></span> <span data-ttu-id="5a988-238">Diese Situation muss von Suchmaschinen behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-238">Search engines must handle this situation.</span></span>

<span data-ttu-id="5a988-239">**GetValue** gibt Eigenschaftswerte für den aktuellen Block \_ Wert Block in PROPVARIANT-Strukturen zurück, die eine Vielzahl von Datentypen enthalten können.</span><span class="sxs-lookup"><span data-stu-id="5a988-239">**GetValue** returns property values for the current CHUNK\_VALUE chunk in PROPVARIANT structures, which can hold a wide variety of data types.</span></span> <span data-ttu-id="5a988-240">" **GetValue** " muss die PROPVARIANT-Struktur selbst mithilfe von "CoTaskMemAlloc" zuordnen.</span><span class="sxs-lookup"><span data-stu-id="5a988-240">**GetValue** must allocate the PROPVARIANT structure itself using CoTaskMemAlloc.</span></span> <span data-ttu-id="5a988-241">Der Aufrufer von **GetValue** ist verantwortlich für das Freigeben von Speicher, auf den von der PROPVARIANT mithilfe von propvariantclear verwiesen wird, und zum Freigeben der Struktur selbst mit CoTaskMemFree.</span><span class="sxs-lookup"><span data-stu-id="5a988-241">The caller of **GetValue** is responsible for freeing memory pointed to by the PROPVARIANT using PropVariantClear, and for freeing the structure itself with CoTaskMemFree.</span></span> <span data-ttu-id="5a988-242">Weitere Informationen zu propvarianten finden Sie in der Referenz zu [PROPVARIANT](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="5a988-242">For more information on PROPVARIANTs, see the [PROPVARIANT](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) reference.</span></span>

### <a name="property-values"></a><span data-ttu-id="5a988-243">Eigenschaftswerte</span><span class="sxs-lookup"><span data-stu-id="5a988-243">Property Values</span></span>

<span data-ttu-id="5a988-244">Filter sollten mindestens die folgenden Eigenschaften ausgeben, bei denen es sich um die Standard Spalten in der WDS-Ergebnis Ansicht handelt.</span><span class="sxs-lookup"><span data-stu-id="5a988-244">Filters should output at a minimum the following properties which are the default columns in the WDS results view.</span></span>



| <span data-ttu-id="5a988-245">GUID</span><span class="sxs-lookup"><span data-stu-id="5a988-245">GUID</span></span>                                 | <span data-ttu-id="5a988-246">PROPSPEC</span><span class="sxs-lookup"><span data-stu-id="5a988-246">PROPSPEC</span></span>      | <span data-ttu-id="5a988-247">Anzeigename</span><span class="sxs-lookup"><span data-stu-id="5a988-247">Friendly Name</span></span>  | <span data-ttu-id="5a988-248">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="5a988-248">Description</span></span>                                                                                                                                     |
|--------------------------------------|---------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="5a988-249">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span><span class="sxs-lookup"><span data-stu-id="5a988-249">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span></span> | <span data-ttu-id="5a988-250">2</span><span class="sxs-lookup"><span data-stu-id="5a988-250">2</span></span>             | <span data-ttu-id="5a988-251">Primarytitle</span><span class="sxs-lookup"><span data-stu-id="5a988-251">PrimaryTitle</span></span>   | <span data-ttu-id="5a988-252">Der Titel, der für dieses Element angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="5a988-252">Title that displays for this item.</span></span>                                                                                                              |
| <span data-ttu-id="5a988-253">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span><span class="sxs-lookup"><span data-stu-id="5a988-253">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span></span> | <span data-ttu-id="5a988-254">4</span><span class="sxs-lookup"><span data-stu-id="5a988-254">4</span></span>             | <span data-ttu-id="5a988-255">Primaryauthors</span><span class="sxs-lookup"><span data-stu-id="5a988-255">PrimaryAuthors</span></span> | <span data-ttu-id="5a988-256">Person, die diesem Element am meisten zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="5a988-256">Person most associated with this item.</span></span>                                                                                                          |
| <span data-ttu-id="5a988-257">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span><span class="sxs-lookup"><span data-stu-id="5a988-257">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span></span> | <span data-ttu-id="5a988-258">Primarydate</span><span class="sxs-lookup"><span data-stu-id="5a988-258">PrimaryDate</span></span>   | <span data-ttu-id="5a988-259">Primarydate</span><span class="sxs-lookup"><span data-stu-id="5a988-259">PrimaryDate</span></span>    | <span data-ttu-id="5a988-260">Das wichtigste Datum für ein Element, z. b. für e-Mail empfangene oder für Dateien geänderte Datumsangaben.</span><span class="sxs-lookup"><span data-stu-id="5a988-260">Most important date for item, like date received for email or modified for files.</span></span>                                                               |
| <span data-ttu-id="5a988-261">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span><span class="sxs-lookup"><span data-stu-id="5a988-261">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span></span> | <span data-ttu-id="5a988-262">Wahrnehmungstyp</span><span class="sxs-lookup"><span data-stu-id="5a988-262">PerceivedType</span></span> | <span data-ttu-id="5a988-263">Wahrnehmungstyp</span><span class="sxs-lookup"><span data-stu-id="5a988-263">PerceivedType</span></span>  | <span data-ttu-id="5a988-264">Der Typ der Datei, die analysiert wird.</span><span class="sxs-lookup"><span data-stu-id="5a988-264">Type of file being parsed.</span></span> <span data-ttu-id="5a988-265">Muss einem der Typen von Windows-Desktop Suchtypen entsprechen, die unter von WDS [erkannte](-search-2x-wds-perceivedtype.md)Typen aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="5a988-265">Must match one of the Windows Desktop Search types listed in WDS [Perceived Type](-search-2x-wds-perceivedtype.md).</span></span> |



 

<span data-ttu-id="5a988-266">Für nur-Text-Elemente extrahiert WDS alle Text-und System definierten Eigenschaften, z. b. Dateigröße oder Erweiterung, bei denen neue Klartext-Dateitypen in den Index eingeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-266">For plaintext items, WDS extracts all text and system-defined properties such as file size or extension on including new plaintext file types to the index).</span></span> <span data-ttu-id="5a988-267">Weitere Eigenschaften, die an den Index zurückgegeben werden können, sind:</span><span class="sxs-lookup"><span data-stu-id="5a988-267">Other types of properties that can be returned to the index include:</span></span>

-   <span data-ttu-id="5a988-268">Für Dateien: Autor, Titel, Status, Schlüsselwörter</span><span class="sxs-lookup"><span data-stu-id="5a988-268">For files: author, title, status, keywords</span></span>
-   <span data-ttu-id="5a988-269">Für Medien: Album, Genre, Kamera Marke, ergriffene Datumsangaben</span><span class="sxs-lookup"><span data-stu-id="5a988-269">For media: album, genre, camera make, date taken</span></span>
-   <span data-ttu-id="5a988-270">Für die Kommunikation: from, to, CC, Wichtigkeit</span><span class="sxs-lookup"><span data-stu-id="5a988-270">For communications: from, to, cc, importance</span></span>
-   <span data-ttu-id="5a988-271">Für Kontakte: Berufsbezeichnung, geschäftlich Telefon, Unternehmen</span><span class="sxs-lookup"><span data-stu-id="5a988-271">For contacts: job title, business phone, company</span></span>

<span data-ttu-id="5a988-272">Die obige Liste gruppiert Eigenschaften, die einem angegebenen wahrgenommenen Typ gemeinsam sind. Allerdings kann jede Eigenschaft unabhängig vom Typ verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-272">The list above groups properties common to a specified Perceived Type; however, any property can be used regardless of the type.</span></span> <span data-ttu-id="5a988-273">Beispielsweise könnte Company für den Arbeitgeber Namen eines Kontakts verwendet werden und kann auch verwendet werden, um auf den Namen eines Clients zu verweisen, auf den sich die Datei bezieht.</span><span class="sxs-lookup"><span data-stu-id="5a988-273">For example, company could be used for a contact's employer name and could also be used to refer to the name of a client the file relates to.</span></span> <span data-ttu-id="5a988-274">Viele dieser Eigenschaften werden verwendet, um Suchergebnisse in der WDS-Ergebnis Ansicht anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="5a988-274">Many of these properties are used to display search results in the WDS results view.</span></span> <span data-ttu-id="5a988-275">Beispielsweise wird die Title-Eigenschaft einer Datei in der Standard Ergebnis Ansicht als Haupt Spalte angezeigt.</span><span class="sxs-lookup"><span data-stu-id="5a988-275">For example, a file's Title property is shown as the main column in the default results view.</span></span> <span data-ttu-id="5a988-276">IFilter-Objekte sollten alle Eigenschaften ausgeben, die mit dem Elementtyp in Zusammenhang stehen, den Sie untersuchen.</span><span class="sxs-lookup"><span data-stu-id="5a988-276">IFilter objects should output all the properties related to the item type they are parsing.</span></span> <span data-ttu-id="5a988-277">In WDS 2. x können keine benutzerdefinierten Eigenschaften hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-277">Custom properties cannot be added in WDS 2.x.</span></span> <span data-ttu-id="5a988-278">Eine vollständige Liste der verfügbaren Eigenschaften finden Sie im [WDS-Schema](-search-2x-wds-schematable.md).</span><span class="sxs-lookup"><span data-stu-id="5a988-278">For a full list of properties available, see the [WDS Schema](-search-2x-wds-schematable.md).</span></span>

## <a name="filter-add-in-installation"></a><span data-ttu-id="5a988-279">Installation des Add-ins Filtern</span><span class="sxs-lookup"><span data-stu-id="5a988-279">Filter Add-in Installation</span></span>

<span data-ttu-id="5a988-280">Die Installation des Filters umfasst das Kopieren der dll an einen geeigneten Speicherort im Verzeichnis "Programme" und deren Registrierung.</span><span class="sxs-lookup"><span data-stu-id="5a988-280">Installing the filter involves copying the DLL to an appropriate location in the Program Files directory and registering it.</span></span> <span data-ttu-id="5a988-281">Filter sollten die Selbstregistrierung für die Installation implementieren und die folgenden Richtlinien befolgen:</span><span class="sxs-lookup"><span data-stu-id="5a988-281">Filters should implement self-registration for installation and should follow these guidelines:</span></span>

-   <span data-ttu-id="5a988-282">Das Installationsprogramm muss entweder exe oder das MSI-Installationsprogramm verwenden.</span><span class="sxs-lookup"><span data-stu-id="5a988-282">The installer must use either EXE or MSI installer.</span></span>
-   <span data-ttu-id="5a988-283">Anmerkungen zu dieser Version müssen bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-283">Release notes must be provided.</span></span>
-   <span data-ttu-id="5a988-284">Ein Eintrag zum **Hinzufügen/Entfernen von Programmen** muss für jedes installierte Add-in erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="5a988-284">An **Add/Remove Programs** entry must be created for each add-in installed.</span></span>
-   <span data-ttu-id="5a988-285">Das Installationsprogramm muss alle Registrierungs Einstellungen für einen bestimmten Dateityp oder-Speicher übernehmen, den das aktuelle Add-in versteht.</span><span class="sxs-lookup"><span data-stu-id="5a988-285">The installer must take over all registry settings for the particular file type or store that the current add-in understands.</span></span>
-   <span data-ttu-id="5a988-286">Wenn ein vorheriges Add-in überschrieben wird, sollte das Installationsprogramm den Benutzer benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="5a988-286">If a previous add-in is being overwritten, the installer should notify the user.</span></span>
-   <span data-ttu-id="5a988-287">Wenn das vorherige Add-in von einem neueren Add-in überschrieben wurde, sollte es möglich sein, die vorherige Add-in-Funktion wiederherzustellen und Sie als Standard-Add-in für diesen Dateityp oder-Speicher zu speichern.</span><span class="sxs-lookup"><span data-stu-id="5a988-287">If a newer add-in has overwritten the previous add-in, there should be the ability to restore the previous add-in's functionality and make it the default add-in for that file type or store again.</span></span>

### <a name="clsids-required-for-registration"></a><span data-ttu-id="5a988-288">Für die Registrierung erforderliche CLSIDs</span><span class="sxs-lookup"><span data-stu-id="5a988-288">CLSIDs Required for Registration</span></span>

<span data-ttu-id="5a988-289">Es gibt drei Klassen Bezeichner (CLSIDs), die mit jedem Filter verknüpft sind.</span><span class="sxs-lookup"><span data-stu-id="5a988-289">There are three class identifiers, or CLSIDs, associated with every filter.</span></span> <span data-ttu-id="5a988-290">Zum Registrieren des Filter-Add-Ins müssen Sie mindestens einen der folgenden (verwenden Sie uuidgen.exe) generieren.</span><span class="sxs-lookup"><span data-stu-id="5a988-290">You'll need to generate one or more of these (use uuidgen.exe) to register your filter add-in.</span></span>

-   <span data-ttu-id="5a988-291">Der erste identifiziert den persistenten Handler für alle Filter, IID \_ IFilter, der {89bcb740-6119-101A-bcb7-00dd010655af} ist.</span><span class="sxs-lookup"><span data-stu-id="5a988-291">The first identifies all filters' persistent handler, IID\_IFilter, which is {89BCB740-6119-101A-BCB7-00DD010655AF}.</span></span> <span data-ttu-id="5a988-292">Diese CLSID ist für alle Filter, die IFilter implementieren, konstant.</span><span class="sxs-lookup"><span data-stu-id="5a988-292">This CLSID is constant for all filters that implement IFilter.</span></span>
-   <span data-ttu-id="5a988-293">Der zweite Wert (der Wert des IID- \_ IFilter-Schlüssels) identifiziert die IFilter-Implementierung für den Dateityp.</span><span class="sxs-lookup"><span data-stu-id="5a988-293">The second (the value of the IID\_IFilter key) identifies the IFilter implementation for your file type.</span></span> <span data-ttu-id="5a988-294">Dieser Schlüssel enthält einen InprocServer32-Wert, der den DLL-Namen nach Pfad und dem Threading Modell angibt.</span><span class="sxs-lookup"><span data-stu-id="5a988-294">This key contains an InprocServer32 value that specifies the DLL name by path and the threading model.</span></span> <span data-ttu-id="5a988-295">Wenn sich der Filter im Systempfad befindet, wie z. b. das Verzeichnis System32, genügt ein Dateiname.</span><span class="sxs-lookup"><span data-stu-id="5a988-295">If the filter is in the system path, like the system32 directory, a file name is sufficient.</span></span> <span data-ttu-id="5a988-296">Andernfalls sollte dieser Wert über eine vollständige Pfadspezifikation verfügen.</span><span class="sxs-lookup"><span data-stu-id="5a988-296">Otherwise, this value should have a full path specification.</span></span>
-   <span data-ttu-id="5a988-297">Das dritte identifiziert den Dateityp, den der Filter verarbeitet, und wird von der GetClassID-Methode in ihrer ipersistent-Schnittstelle zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="5a988-297">The third identifies the file type the filter processes and is returned by the GetClassID method on your IPersist interface.</span></span>

> [!Note]
>
> <span data-ttu-id="5a988-298">In zukünftigen Versionen von Microsoft-Betriebssystemen kann das Installieren von Dateien im Verzeichnis "System32" schwieriger werden. Daher wird empfohlen, dass Sie die Dateien unter "Programme" installieren und einen vollständigen Pfad zum Filter in der Registrierung einschließen.</span><span class="sxs-lookup"><span data-stu-id="5a988-298">In future versions of Microsoft operating systems, installing files in the system32 directory may get more difficult, so we recommend you install them under Program Files and include a full path to the filter in the registry.</span></span> <span data-ttu-id="5a988-299">Aus Sicherheitsgründen ist es auch ratsam, in der Registrierung einen vollständigen Pfad zu Ihrer DLL anzugeben.</span><span class="sxs-lookup"><span data-stu-id="5a988-299">For security reasons, it is also prudent to specify a full path to your DLL in the registry.</span></span> <span data-ttu-id="5a988-300">Andernfalls könnte eine "Trojaner"-Version der DLL geladen werden, wenn Sie sich vor der Version im Prozess Pfad befinden.</span><span class="sxs-lookup"><span data-stu-id="5a988-300">Otherwise, a "Trojan horse" version of your DLL could be loaded if it happens to be in the process path before your version.</span></span>

 

### <a name="registration-model"></a><span data-ttu-id="5a988-301">Registrierungs Modell</span><span class="sxs-lookup"><span data-stu-id="5a988-301">Registration Model</span></span>

<span data-ttu-id="5a988-302">Wenn WDS bereit ist, eine Datei zu filtern, wird die Registrierung in der Registrierung unter der Dateierweiterung ermittelt, um zu ermitteln, welcher Filter geladen werden soll.</span><span class="sxs-lookup"><span data-stu-id="5a988-302">When WDS is ready to filter a file, it looks in the registry under the file's extension to determine which filter to load.</span></span> <span data-ttu-id="5a988-303">Anschließend folgt eine Reihe von Registrierungs Links, um den Namen der Filter-DLL in dieser Reihenfolge zu finden:</span><span class="sxs-lookup"><span data-stu-id="5a988-303">It then follows a series of registry links to find the name of the filter DLL, in this order:</span></span>

1.  <span data-ttu-id="5a988-304">Von CLSIDs unter:</span><span class="sxs-lookup"><span data-stu-id="5a988-304">From CLSIDs located at:</span></span>

    <span data-ttu-id="5a988-305">**HKEY \_ Current \_ User \\ Software \\ Microsoft \\ rsSearch \\ contentindexcommon \\ Filters \\ override \\ rsapp**</span><span class="sxs-lookup"><span data-stu-id="5a988-305">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters\\Override\\RSApp**</span></span>

    <span data-ttu-id="5a988-306">**HKEY \_ Current \_ User \\ Software \\ Microsoft \\ rsSearch \\ contentindexcommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="5a988-306">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

2.  <span data-ttu-id="5a988-307">Aus dem Datei Inhaltstyp:</span><span class="sxs-lookup"><span data-stu-id="5a988-307">From the file content type at:</span></span>

    <span data-ttu-id="5a988-308">**HKEY \_ - \_ \\ Software \\ Klassen der \\ MIME- \\ Datenbank- \\ Inhaltstyp**</span><span class="sxs-lookup"><span data-stu-id="5a988-308">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\MIME\\Database\\Content Type**</span></span>

3.  <span data-ttu-id="5a988-309">Aus der Dateinamenerweiterung (identisch mit der Win32-loadifilter-API) unter:</span><span class="sxs-lookup"><span data-stu-id="5a988-309">From the file name extension (same as Win32 LoadIFilter API) at:</span></span>

    <span data-ttu-id="5a988-310">**HKEY \_ Current \_ User \\ Software \\ Microsoft \\ rsSearch \\ contentindexcommon \\ Filters \\ override \\ rsapp**</span><span class="sxs-lookup"><span data-stu-id="5a988-310">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters\\Override\\RSApp**</span></span>

    <span data-ttu-id="5a988-311">**HKEY \_ Current \_ User \\ Software \\ Microsoft \\ rsSearch \\ contentindexcommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="5a988-311">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

    <span data-ttu-id="5a988-312">**HKEY \_ \_ -Klassen root \\ extpersistenthandler->CLSID->IID \_ IFilter->CLSID**</span><span class="sxs-lookup"><span data-stu-id="5a988-312">**HKEY\_CLASSES\_ROOT\\extpersistentHandler->CLSID->IID\_IFilter->CLSID**</span></span>

4.  <span data-ttu-id="5a988-313">Standardmäßig:</span><span class="sxs-lookup"><span data-stu-id="5a988-313">From Default at:</span></span>

    <span data-ttu-id="5a988-314">**HKEY \_ local \_ Machine \\ Software \\ Microsoft \\ rsSearch \\ contentindexcommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="5a988-314">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

### <a name="to-register-a-filter-add-in"></a><span data-ttu-id="5a988-315">So registrieren Sie ein Filter-Add-in</span><span class="sxs-lookup"><span data-stu-id="5a988-315">To Register a Filter Add-in</span></span>

<span data-ttu-id="5a988-316">Sie müssen insgesamt acht Einträge in der Registrierung vornehmen, um das Filter-Add-in zu registrieren, wobei Folgendes gilt:</span><span class="sxs-lookup"><span data-stu-id="5a988-316">You need to make a total of eight entries in the registry to register your filter add-in, where:</span></span>

-   <span data-ttu-id="5a988-317">**. ext** ist die neue Dateinamenerweiterung.</span><span class="sxs-lookup"><span data-stu-id="5a988-317">**.ext** is the new file name extension</span></span>
-   <span data-ttu-id="5a988-318">**GUID \_ 1** kann jede neue GUID sein, die für diese Erweiterung generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="5a988-318">**GUID\_1** can be any new GUID generated for this extension</span></span>
-   <span data-ttu-id="5a988-319">**89bcb740-6119-101A-bcb7-00dd010655af** ist die GUID der IFilter-Schnittstelle, die eine Konstante für alle IFilter-Implementierungen ist.</span><span class="sxs-lookup"><span data-stu-id="5a988-319">**89BCB740-6119-101A-BCB7-00DD010655AF** is the IFilter interface GUID, which is a constant for all IFilter implementations.</span></span>

1.  <span data-ttu-id="5a988-320">Registrieren Sie den persistenten Handler für die Dateinamenerweiterung mit den folgenden Schlüsseln und Werten:</span><span class="sxs-lookup"><span data-stu-id="5a988-320">Register the persistent handler for the file name extension with the following keys and values:</span></span>

    ```
    HKEY_CLASSES_ROOT\<.ext>\PersistentHandler
       (Default) = {GUID_1}
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}
       (Default) = <Persistent Handler Description>
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentAddinsRegistered
       (Default) = (Value Not Set)
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentAddinsRegistered\{89BCB740-6119-101A-BCB7-00DD010655AF}
       (Default) = {CLSID of IFilter implementation}
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentHandler
       (Default) = {GUID_1}
    ```

2.  <span data-ttu-id="5a988-321">Registrieren Sie die IFilter-Implementierung mit den folgenden Schlüsseln und Werten:</span><span class="sxs-lookup"><span data-stu-id="5a988-321">Register the IFilter implementation with the following keys and values:</span></span>

    ```
    HKEY_CLASSES_ROOT\CLSID\{CLSID of IFilter implementation}
       (Default) = Extension IFilter Description">
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{CLSID of IFilter implementation}\InprocServer32
       (Default) = <DLL Install Path>
       ThreadingModel = Both
    ```

3.  <span data-ttu-id="5a988-322">Registrieren Sie die IFilter-Implementierung bei der Windows-Desktop Suche mit dem folgenden Schlüssel und Wert:</span><span class="sxs-lookup"><span data-stu-id="5a988-322">Register the IFilter implementation with Windows Desktop Search with the following key and value:</span></span>

    ```
    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\RSSearch\ContentIndexCommon\Filters\Extension\<.ext>
       (Default) = {CLSID of IFilter implementation}"
    ```

## <a name="related-topics"></a><span data-ttu-id="5a988-323">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="5a988-323">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="5a988-324">**Referenz**</span><span class="sxs-lookup"><span data-stu-id="5a988-324">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="5a988-325">Schema Tabelle</span><span class="sxs-lookup"><span data-stu-id="5a988-325">SchemaTable</span></span>](-search-2x-wds-schematable.md)
</dt> <dt>

[<span data-ttu-id="5a988-326">Wahrgenommene Typen</span><span class="sxs-lookup"><span data-stu-id="5a988-326">Perceived Types</span></span>](-search-2x-wds-perceivedtype.md)
</dt> <dt>

[<span data-ttu-id="5a988-327">Entwickeln von Protokoll Handlern</span><span class="sxs-lookup"><span data-stu-id="5a988-327">Developing Protocol Handlers</span></span>](-search-2x-wds-phaddins.md)
</dt> <dt>

<span data-ttu-id="5a988-328">**Andere Ressourcen**</span><span class="sxs-lookup"><span data-stu-id="5a988-328">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="5a988-329">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="5a988-329">**IFilter**</span></span>](/windows/desktop/api/filter/nn-filter-ifilter)
</dt> </dl>

 

 