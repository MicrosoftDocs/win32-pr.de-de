---
title: Aktivieren der DirectX-Video Beschleunigung
description: Aktivieren der DirectX-Video Beschleunigung
ms.assetid: 5cb2f564-88e3-4b60-bde3-6ccf69c97c48
keywords:
- Windows Media-Format-SDK, Aktivieren von DXVA
- Windows Media-Format-SDK, DirectX-Video Beschleunigung (DXVA)
- Windows Media-Format-SDK, Videobeschleunigung
- Advanced Systems Format (ASF), Aktivieren von DXVA
- ASF (Advanced Systems Format), Aktivieren von DXVA
- Advanced Systems Format (ASF), DirectX-Video Beschleunigung (DXVA)
- ASF (Advanced Systems-Format), DirectX-Video Beschleunigung (DXVA)
- Advanced Systems Format (ASF), Videobeschleunigung
- ASF (Advanced Systems Format), Videobeschleunigung
- DirectX-Video Beschleunigung (DXVA), aktivieren
- DXVA (DirectX-Video Beschleunigung), aktivieren
- DirectX-Video Beschleunigung (DXVA), Reihenfolge der Vorgänge
- DXVA (DirectX-Video Beschleunigung), Reihenfolge der Vorgänge
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 896147fe11b4b7f5fb91d8dc288e616b643bd5ce
ms.sourcegitcommit: 48d1c892045445bcbd0f22bafa2fd3861ffaa6e7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/19/2020
ms.locfileid: "104389846"
---
# <a name="enabling-directx-video-acceleration"></a><span data-ttu-id="e2620-116">Aktivieren der DirectX-Video Beschleunigung</span><span class="sxs-lookup"><span data-stu-id="e2620-116">Enabling DirectX Video Acceleration</span></span>

<span data-ttu-id="e2620-117">In diesem Abschnitt wird beschrieben, wie Sie Microsoft® DirectX® Video Beschleunigung bei der Wiedergabe von gestreuten Inhalten in einem benutzerdefinierten Player aktivieren.</span><span class="sxs-lookup"><span data-stu-id="e2620-117">This section describes how to enable Microsoft® DirectX® Video Acceleration when playing streamed content in a custom player.</span></span>

## <a name="background"></a><span data-ttu-id="e2620-118">Hintergrund</span><span class="sxs-lookup"><span data-stu-id="e2620-118">Background</span></span>

<span data-ttu-id="e2620-119">DirectX-Video Beschleunigung (DirectX VA) ist eine API-Spezifikation für die Hardwarebeschleunigung von 2D-Decodierungs Vorgängen.</span><span class="sxs-lookup"><span data-stu-id="e2620-119">DirectX Video Acceleration (DirectX VA) is an API specification for hardware acceleration of 2-D decoding operations.</span></span> <span data-ttu-id="e2620-120">Dadurch können Software Decoder bestimmte CPU-intensive Vorgänge zur Verarbeitung auf die Grafikkarte auslagern.</span><span class="sxs-lookup"><span data-stu-id="e2620-120">It enables software decoders to offload certain CPU-intensive operations to the graphics card for processing.</span></span> <span data-ttu-id="e2620-121">Für Endbenutzer ist dies ein Video mit hoher Bitrate, z. b. voll Bild-DVD-Wiedergabe auf älteren Computern, die mit DirectX VA-kompatiblen Grafikkarten ausgestattet sind.</span><span class="sxs-lookup"><span data-stu-id="e2620-121">For end users, this makes possible high-bit-rate video such as full-screen DVD playback on older computers equipped with DirectX VA-compatible graphics cards.</span></span>

<span data-ttu-id="e2620-122">Der DMO-Wrapper Filter unterstützt ab dem Windows Media Format 9-Reihe-SDK DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="e2620-122">Beginning with the Windows Media Format 9 Series SDK, the DMO Wrapper filter supports DirectX VA.</span></span> <span data-ttu-id="e2620-123">Dies bedeutet, dass Anwendungen für die lokale Wiedergabe den WM-ASF-Reader-Filter verwenden können, um Windows Media-basierte Inhalte wiederzugeben, und die DirectX VA-Hardwarebeschleunigung wird automatisch aufgerufen, wenn Sie von der Grafikkarte unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="e2620-123">This means that, for local playback, applications can use the WM ASF Reader filter to play Windows Media-based content and DirectX VA hardware acceleration will be invoked automatically if the graphics card supports it.</span></span> <span data-ttu-id="e2620-124">Der WM-ASF-Reader-Filter unterstützt die Wiedergabe von gestreuten Inhalten jedoch nicht.</span><span class="sxs-lookup"><span data-stu-id="e2620-124">However, the WM ASF Reader filter does not support playback of streamed content.</span></span> <span data-ttu-id="e2620-125">Wenn Sie DirectX VA bei der Wiedergabe von gestreuten Inhalten in einem benutzerdefinierten Player unterstützen möchten, müssen Sie daher einen alternativen Mechanismus verwenden. dieser Mechanismus wird von Windows Media Player der mit der Windows Media 9-Reihe verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="e2620-125">Therefore, if you want to support DirectX VA when playing streamed content in a custom player, you must use an alternate mechanism, which is the one used by Windows Media Player beginning with the Windows Media 9 Series.</span></span>

<span data-ttu-id="e2620-126">Da Windows Media Player vor der Entwicklung der qasf-Filter entworfen wurde, verfügt Windows Media Player über einen eigenen Quell Filter, der auf dem Windows Media-Format-SDK für die Wiedergabe von Windows Media-basierten Inhalten basiert.</span><span class="sxs-lookup"><span data-stu-id="e2620-126">Because Windows Media Player was designed before the QASF filters had been developed, Windows Media Player has its own source filter, based on the Windows Media Format SDK, for playing Windows Media-based content.</span></span> <span data-ttu-id="e2620-127">Der WMP-Windows Media-Quell Filter liefert dekomprimierte Daten direkt an die Audio-und Videorenderer.</span><span class="sxs-lookup"><span data-stu-id="e2620-127">The WMP Windows Media Source Filter delivers decompressed data downstream directly to the audio and video renderers.</span></span> <span data-ttu-id="e2620-128">Im Gegensatz dazu stellt der WM-ASF-Reader komprimierte Inhalte Downstream an den Windows Media Decoder DirectX Media Objects (DMOs) bereit, die im DMO-Wrapper gehostet werden.</span><span class="sxs-lookup"><span data-stu-id="e2620-128">By contrast, the WM ASF Reader delivers compressed content downstream to the Windows Media Decoder DirectX Media Objects (DMOs), which are hosted inside the DMO Wrapper.</span></span> <span data-ttu-id="e2620-129">In den folgenden Diagrammen werden die Unterschiede zwischen dem WM-ASF-Reader und dem WMP-Windows Media-Quell Filter veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="e2620-129">The following diagrams illustrate the differences between the WM ASF Reader and the WMP Windows Media Source Filter.</span></span>

![benutzerdefinierter Quell Filter gibt unkomprimierte Beispiele aus](images/wmp-dxva-graph.png)

![qasf-Quell Filter gibt komprimierte Beispiele aus.](images/qasf-dxva-graph.png)

<span data-ttu-id="e2620-132">Um DirectX VA für das Streamen von Inhalten zu aktivieren, müssen Sie einen benutzerdefinierten Quell Filter wie den im oberen Diagramm erstellen.</span><span class="sxs-lookup"><span data-stu-id="e2620-132">To enable DirectX VA for streamed content, you must create a custom source filter like the one in the top diagram.</span></span> <span data-ttu-id="e2620-133">Im Grunde wird mit diesem Filter das Windows Media-Format-SDK verwendet, um ein WM-Reader-Objekt zu instanziieren, die Beispiele zu dekomprimieren und an die Ausgabe Pins zu senden.</span><span class="sxs-lookup"><span data-stu-id="e2620-133">Basically, this filter will use the Windows Media Format SDK to instantiate a WM Reader object, decompress the samples, and send them downstream on its output pins.</span></span> <span data-ttu-id="e2620-134">In dieser Erläuterung wird davon ausgegangen, dass Sie den Quell Filter bereits erstellt haben und jetzt bereit sind, die DirectX-VA-Unterstützung zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="e2620-134">This discussion assumes that you have created the source filter already and are now ready to implement the DirectX VA support.</span></span>

<span data-ttu-id="e2620-135">Zum Aktivieren von DirectX VA besteht die grundlegende Aufgabe des Quell Filters darin, den Videorenderer und den WMV-Decoder DMO mit den Schnittstellen bereitzustellen, die für die Aushandlung der DirectX-VA-Verbindung erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="e2620-135">To enable DirectX VA, the basic task of the source filter is to provide the Video Renderer and the WMV Decoder DMO with the interfaces they will need to negotiate the DirectX VA connection.</span></span> <span data-ttu-id="e2620-136">Der Quell Filter ist nicht an diesen Verhandlungen beteiligt.</span><span class="sxs-lookup"><span data-stu-id="e2620-136">The source filter does not participate in those negotiations.</span></span> <span data-ttu-id="e2620-137">Nachdem das Streaming gestartet wurde, besteht die einzige DirectX-VA-bezogene Aufgabe, die der Quell Filter ausführen kann, darin, die Zeitstempel in den Videobeispielen zu ändern, bevor der WMV-Decoder Sie an den Videorenderer übergibt.</span><span class="sxs-lookup"><span data-stu-id="e2620-137">After streaming starts, the only DirectX VA-related task that the source filter can perform is to modify the time stamps on the video samples before the WMV decoder delivers them to the Video Renderer.</span></span> <span data-ttu-id="e2620-138">Der Hauptgrund hierfür ist die Bereitstellung eines benutzerdefinierten Zeitachsen-Steuer Elements, das über die Aktivierung der standardmäßigen DirectShow-® Schnittstellen hinausgeht</span><span class="sxs-lookup"><span data-stu-id="e2620-138">The primary reason for doing this is to provide custom timeline control beyond what the standard DirectShow® interfaces enable.</span></span>

<span data-ttu-id="e2620-139">Es werden drei Schnittstellen definiert, um die erforderliche Kommunikation zwischen dem Windows Media-Format-SDK, dem Quell Filter des Players, dem Windows Media Video Decoder DMO und dem Überlagerungs-oder videomischungs-Renderer zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="e2620-139">Three interfaces are defined to enable the necessary communications between the Windows Media Format SDK, the player's source filter, the Windows Media Video decoder DMO, and the Overlay Mixer or Video Mixing Renderer.</span></span> <span data-ttu-id="e2620-140">Diese Schnittstellen werden in der folgenden Tabelle beschrieben.</span><span class="sxs-lookup"><span data-stu-id="e2620-140">These interfaces are described in the following table.</span></span>



| <span data-ttu-id="e2620-141">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="e2620-141">Interface</span></span>                                                        | <span data-ttu-id="e2620-142">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="e2620-142">Description</span></span>                                                                                                                                                                                        |
|------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e2620-143">**Iwmcodecamvideoaccelerator**</span><span class="sxs-lookup"><span data-stu-id="e2620-143">**IWMCodecAMVideoAccelerator**</span></span>](/previous-versions/windows/desktop/api/wmdxva/nn-wmdxva-iwmcodecamvideoaccelerator) | <span data-ttu-id="e2620-144">Wird vom Windows Media Decoder DMO verfügbar gemacht und durch den Quell Filter eines Media Player aufgerufen, um die verschiedenen Verbindungen einzurichten, die zum Aktivieren von DirectX VA für das Decodieren von Windows Media Video Inhalt erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="e2620-144">Exposed by the Windows Media Decoder DMO and called by a media player's source filter to set up the various connections required to enable DirectX VA for decoding of Windows Media Video content.</span></span> |
| [<span data-ttu-id="e2620-145">**Iwmplayertimestamphook**</span><span class="sxs-lookup"><span data-stu-id="e2620-145">**IWMPlayerTimestampHook**</span></span>](/previous-versions/windows/desktop/api/wmdxva/nn-wmdxva-iwmplayertimestamphook)         | <span data-ttu-id="e2620-146">Wird für den Quell Filter des Players implementiert.</span><span class="sxs-lookup"><span data-stu-id="e2620-146">Implemented on the player's source filter.</span></span> <span data-ttu-id="e2620-147">Sie ermöglicht es dem Filter, die Zeitstempel in den Videobeispielen vor der Übertragung zu ändern.</span><span class="sxs-lookup"><span data-stu-id="e2620-147">It enables the filter to modify the time stamps on the video samples before delivering them downstream.</span></span>                                                 |
| [<span data-ttu-id="e2620-148">**Iwmreaderaccelerator**</span><span class="sxs-lookup"><span data-stu-id="e2620-148">**IWMReaderAccelerator**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreaderaccelerator)             | <span data-ttu-id="e2620-149">Wird für das WM Reader-Objekt implementiert.</span><span class="sxs-lookup"><span data-stu-id="e2620-149">Implemented on the WM Reader object.</span></span> <span data-ttu-id="e2620-150">Sie wird von einem Player-Quell Filter aufgerufen, um Schnittstellen vom Decoder-DMO abzurufen.</span><span class="sxs-lookup"><span data-stu-id="e2620-150">It is called by a player source filter to obtain interfaces from the decoder DMO.</span></span>                                                                             |



 

## <a name="order-of-operations-in-directx-vaenabled-playback"></a><span data-ttu-id="e2620-151">Reihenfolge der Vorgänge in DirectX VA – aktivierter Wiedergabe</span><span class="sxs-lookup"><span data-stu-id="e2620-151">Order of Operations in DirectX VA–enabled Playback</span></span>

<span data-ttu-id="e2620-152">In diesem Abschnitt wird die allgemeine Reihenfolge der Vorgänge zur Laufzeit für einen DirectX-aktivierten Player und dessen Quell Filter beschrieben.</span><span class="sxs-lookup"><span data-stu-id="e2620-152">This section describes the general order of operations at run time for a DirectX VA-enabled player and its source filter.</span></span> <span data-ttu-id="e2620-153">Die Komponenten, auf die in diesem Abschnitt verwiesen wird, lauten:</span><span class="sxs-lookup"><span data-stu-id="e2620-153">The components referred to in this section are:</span></span>

-   <span data-ttu-id="e2620-154">Ein Drittanbieter-Media Player, der als Player bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="e2620-154">A third-party media player, referred to as the player.</span></span>
-   <span data-ttu-id="e2620-155">Ein benutzerdefinierter Quell Filter, der vom Player instanziiert wird, der das Windows Media-Format-SDK zum Dekomprimieren von Windows Media-basiertem Inhalt verwendet.</span><span class="sxs-lookup"><span data-stu-id="e2620-155">A custom source filter, instantiated by the player, that uses the Windows Media Format SDK to decompress Windows Media-based content.</span></span>
-   <span data-ttu-id="e2620-156">Die Videoausgabe-PIN des Quell Filters des Players, der als Ausgabe-PIN bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="e2620-156">The video output pin of the player's source filter, referred to as the output pin.</span></span>
-   <span data-ttu-id="e2620-157">Das Diagramm für den DirectShow-Videowiedergabe Filter, das als Graph bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="e2620-157">The DirectShow video playback filter graph, referred to as the graph.</span></span>
-   <span data-ttu-id="e2620-158">Der Video Mischungs-Renderer, der als VMR bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="e2620-158">The Video Mixing Renderer, referred to as the VMR.</span></span>
-   <span data-ttu-id="e2620-159">Das Windows Media Format SDK-asynchrone Reader-Objekt, das als Reader bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="e2620-159">The Windows Media Format SDK Asynchronous Reader object, referred to as the reader.</span></span>
-   <span data-ttu-id="e2620-160">Das DirectX-Medienobjekt Windows Media Video Decoder, das als Decoder DMO bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="e2620-160">The Windows Media Video Decoder DirectX Media Object, referred to as the decoder DMO.</span></span>

<span data-ttu-id="e2620-161">Die Reihenfolge der Vorgänge lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="e2620-161">The order of operations is as follows:</span></span>

1.  <span data-ttu-id="e2620-162">Der Player instanziiert seinen Quell Filter und ein Reader-Objekt.</span><span class="sxs-lookup"><span data-stu-id="e2620-162">The player instantiates its source filter and a reader object.</span></span> <span data-ttu-id="e2620-163">Der Reader erstellt einen Video Decoder DMO und legt den (komprimierten) Eingabetyp darauf fest.</span><span class="sxs-lookup"><span data-stu-id="e2620-163">The reader creates a video decoder DMO and sets the (compressed) input type on it.</span></span> <span data-ttu-id="e2620-164">Dies muss eintreten, bevor der Player versucht, das Videowiedergabe Diagramm zu konfigurieren, da das SDK und der Decoder-DMO an dem Aushandlungs Prozess mit dem Diagramm beteiligt sein müssen, und der DMO muss das Eingabeformat in Schritt 9 kennen.</span><span class="sxs-lookup"><span data-stu-id="e2620-164">This must happen before the player attempts to configure its video playback graph because the SDK and the decoder DMO must be involved in the negotiation process with the graph, and the DMO must know the input format during step 9.</span></span>
2.  <span data-ttu-id="e2620-165">Der Player ruft **igraphbuilder:: Rendering** auf und stellt ihm die Ausgabe-PIN des Video Quell Filters bereit.</span><span class="sxs-lookup"><span data-stu-id="e2620-165">The player calls **IGraphBuilder::Render**, providing it the video source filter's output pin.</span></span> <span data-ttu-id="e2620-166">An diesem Punkt versucht der DirectShow Filter Graph-Manager, die VMR mit dem Video Quell Filter des Players zu verbinden.</span><span class="sxs-lookup"><span data-stu-id="e2620-166">At this point, the DirectShow filter graph manager tries to connect the VMR to the player's video source filter.</span></span>
3.  <span data-ttu-id="e2620-167">Der Filter Graph-Manager ruft **IPin:: Connect** in der Ausgabe-PIN des Video Quell Filters des Players auf.</span><span class="sxs-lookup"><span data-stu-id="e2620-167">The filter graph manager calls **IPin::Connect** on the output pin of the player's video source filter.</span></span>

<span data-ttu-id="e2620-168">Die Schritte 4 bis 10 erfolgen innerhalb von **IPin:: Connect**.</span><span class="sxs-lookup"><span data-stu-id="e2620-168">Steps 4 through 10 occur inside of **IPin::Connect**.</span></span>

1.  <span data-ttu-id="e2620-169">Der Quell Filter Ruft die **iwmcodecamvideoaccelerator** -Schnittstelle aus der **iwmreaderaccelerator:: getcodecinterface** -Methode des Readers ab.</span><span class="sxs-lookup"><span data-stu-id="e2620-169">The source filter obtains the **IWMCodecAMVideoAccelerator** interface from the reader's **IWMReaderAccelerator::GetCodecInterface** method.</span></span> <span data-ttu-id="e2620-170">Wenn der Codec DirectX VA nicht unterstützt, tritt beim Aufrufen von **getcodecinterface** möglicherweise ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="e2620-170">If the codec does not support DirectX VA, the call to **GetCodecInterface** may fail.</span></span> <span data-ttu-id="e2620-171">In diesem Fall verläuft die Aushandlung wie gewohnt, ohne DirectX-VA-Unterstützung.</span><span class="sxs-lookup"><span data-stu-id="e2620-171">In this case, negotiation proceeds as usual, without DirectX VA support.</span></span>
2.  <span data-ttu-id="e2620-172">Der Quell Filter übergibt den **iamvideoaccelerator** -Zeiger von **der an übergebenen Pin über** **iwmcodecamvideoaccelerator:: setacceleratorinterface**.</span><span class="sxs-lookup"><span data-stu-id="e2620-172">The source filter passes the **IAMVideoAccelerator** pointer from the pin passed into **Connect** to the decoder DMO through **IWMCodecAMVideoAccelerator::SetAcceleratorInterface**.</span></span>
3.  <span data-ttu-id="e2620-173">Der Quell Filter delegiert dann den Rest des **IPin:: Connect** -Vorgangs an die **cbaseoutputpin:: Connect** -Methode.</span><span class="sxs-lookup"><span data-stu-id="e2620-173">The source filter then delegates the remainder of the **IPin::Connect** operation to the **CBaseOutputPin::Connect** method.</span></span> <span data-ttu-id="e2620-174">Die formatenumeration mit dem SDK verläuft wie heute.</span><span class="sxs-lookup"><span data-stu-id="e2620-174">The format enumeration with the SDK proceeds as it does today.</span></span> <span data-ttu-id="e2620-175">Wenn der Codec DirectX VA für den Inhalt unterstützt, der verbunden wird, stellt der Codec-DMO diese DirectX VA-Untertypen zuerst vor, bevor die unterstützten YUV-und RGB-Typen unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="e2620-175">If the codec supports DirectX VA for the content being connected, the codec DMO presents those DirectX VA subtypes first, prior to the YUV and RGB types supported.</span></span> <span data-ttu-id="e2620-176">Wenn die DirectX-VA-Unterstützung verfügbar ist, werden die Schritte 7 bis 11 im Kontext eines DirectX VA-unter Typs ausprobiert.</span><span class="sxs-lookup"><span data-stu-id="e2620-176">If DirectX VA support is available, steps 7 through 11 are attempted in the context of a DirectX VA subtype.</span></span> <span data-ttu-id="e2620-177">Der folgende Code Ausschnitt zeigt, wie ein DirectX-VA-Medien Untertyp identifiziert wird.</span><span class="sxs-lookup"><span data-stu-id="e2620-177">The following code snippet shows how to identify a DirectX VA media subtype.</span></span>
    ```C++
    bool IsDXVASubtype( AM_MEDIA_TYPE * pmt )
    {
        // All DXVA types have the same last 3 DWORDs.
        // guidDXVA is the base GUID for all DXVA subtypes.

        GUID guidDXVA = { 0x00000000, 0xa0c7, 0x11d3, { 0xb9,0x84,0x00,0xc0,0x4f,0x2e,0x73,0xc5 } };

        unsigned long const * plguid;
        unsigned long const * plguidDXVA;
        plguid = (unsigned long const *)&pmt->subtype;
        plguidDXVA = (unsigned long *)&guidDXVA;

        if( ( plguid[1] == plguidDXVA[1] ) &&
            ( plguid[2] == plguidDXVA[2] ) &&
            ( plguid[3] == plguidDXVA[3] ) )
        {
            return true;
        }

        return false;
    }
    
    ```

    

4.  <span data-ttu-id="e2620-178">Die **cbaseoutputpin:: Connect** -Implementierung ruft **IPin:: completeconnect** während Schritt 3 auf.</span><span class="sxs-lookup"><span data-stu-id="e2620-178">The **CBaseOutputPin::Connect** implementation calls **IPin::CompleteConnect** during step 3.</span></span> <span data-ttu-id="e2620-179">Wenn ein DirectX-VA-Untertyp berücksichtigt wird, wird versucht, die DirectX-VA-Aushandlung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="e2620-179">If a DirectX VA subtype is being considered, the DirectX VA negotiation is attempted.</span></span> <span data-ttu-id="e2620-180">Die Ausgabepin ruft **iwmcodecamvideoaccelerator:: aushandateconnetction** auf und übergibt dabei den aktuellen Ausgabe Medientyp.</span><span class="sxs-lookup"><span data-stu-id="e2620-180">The output pin calls **IWMCodecAMVideoAccelerator::NegotiateConnection**, passing it the current output media type.</span></span>
5.  <span data-ttu-id="e2620-181">Der Decoder DMO führt die erforderliche Aushandlung mit der VMR über die **iamvideoaccelerator** -Schnittstelle aus und gibt den Video Untertyp GUID zurück, den die beiden zugestimmt haben.</span><span class="sxs-lookup"><span data-stu-id="e2620-181">The decoder DMO performs the required negotiation with the VMR through the **IAMVideoAccelerator** interface, and returns the video subtype GUID that the two have agreed on.</span></span> <span data-ttu-id="e2620-182">Die Ausgabe-PIN delegiert alle **iamvideoacceleratornotify** -Aufrufe, die während dieses Prozesses empfangen werden, an die **iamvideoacceleratornotify** -Schnittstelle des Decoders DMO, die auch über die **iwmreaderaccelerator:: getcodecinterface** -Methode abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="e2620-182">The output pin delegates all **IAMVideoAcceleratorNotify** calls received during this process to the decoder DMO's **IAMVideoAcceleratorNotify** interface, which can also be obtained through the **IWMReaderAccelerator::GetCodecInterface** method.</span></span>
6.  <span data-ttu-id="e2620-183">Wenn **aushandateconnetction** erfolgreich ist, ruft die Ausgabepin **iwmcodecamvideoaccelerator:: setplayernotify** mit einer **iwmplayertimestamphook** -Schnittstelle auf.</span><span class="sxs-lookup"><span data-stu-id="e2620-183">If **NegotiateConnection** succeeds, the output pin calls **IWMCodecAMVideoAccelerator::SetPlayerNotify** with an **IWMPlayerTimestampHook** interface.</span></span> <span data-ttu-id="e2620-184">Mit diesem Hook kann der Quell Filter die Zeitstempel der Beispiele aktualisieren, bevor Sie an den Renderer übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="e2620-184">This hook allows the source filter to update the time stamps on the samples before they are handed to the renderer.</span></span>
7.  <span data-ttu-id="e2620-185">Der Quell Filter ruft **iwmreaderaccelerator:: notify** mit dem ausgehandelten Medientyp auf.</span><span class="sxs-lookup"><span data-stu-id="e2620-185">The source filter calls **IWMReaderAccelerator::Notify** with the negotiated media type.</span></span> <span data-ttu-id="e2620-186">Dies ermöglicht es dem Reader, seine internen Variablen zu aktualisieren und an DirectX VA zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="e2620-186">This allows the reader to update its internal variables and commit to DirectX VA.</span></span> <span data-ttu-id="e2620-187">Dies ist die letzte Stelle, an der der Codec oder der Reader fehlschlagen kann.</span><span class="sxs-lookup"><span data-stu-id="e2620-187">This is the last place the codec or reader can fail.</span></span> <span data-ttu-id="e2620-188">Wenn einer der obigen Schritte fehlschlägt, sollte der Quell Filter zu Schritt 3 zurückkehren und den nächsten Typ, der vom Reader aufgelistet wird, testen.</span><span class="sxs-lookup"><span data-stu-id="e2620-188">If any of the above steps fail, the source filter should return to step 3 and try the next type enumerated by the reader.</span></span>
8.  <span data-ttu-id="e2620-189">Wiedergabe wird gestartet.</span><span class="sxs-lookup"><span data-stu-id="e2620-189">Playback starts.</span></span> <span data-ttu-id="e2620-190">Der Reader ignoriert Ausgabepuffer aus dem DMO-Decoder, wenn der Verbindungs Ausgabetyp DirectX VA ist.</span><span class="sxs-lookup"><span data-stu-id="e2620-190">The reader ignores output buffers from the decoder DMO if the connection output type is DirectX VA.</span></span>
9.  <span data-ttu-id="e2620-191">Wenn **IPin::D isconnect** auftritt, ruft der Quell Filter **iwmcodecamvideoaccelerator:: setacceleratorinterface** mit einem **null**-Wert auf.</span><span class="sxs-lookup"><span data-stu-id="e2620-191">When **IPin::Disconnect** occurs, the source filter calls **IWMCodecAMVideoAccelerator::SetAcceleratorInterface** with a **NULL**.</span></span> <span data-ttu-id="e2620-192">Dadurch wird die DirectX-VA-Verbindung zwischen dem Codec und dem Renderer unterbrochen.</span><span class="sxs-lookup"><span data-stu-id="e2620-192">This breaks the DirectX VA connection between the codec and the renderer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e2620-193">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="e2620-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e2620-194">**Lesen von ASF-Dateien**</span><span class="sxs-lookup"><span data-stu-id="e2620-194">**Reading ASF Files**</span></span>](reading-asf-files.md)
</dt> </dl>

 

 




