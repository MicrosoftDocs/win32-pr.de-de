---
title: Wandeln Sie eine DRM-Protected Datei in eine Windows Media DRM 10 for Network Devices Stream-Datei um.
description: Wandeln Sie eine DRM-Protected Datei in eine Windows Media DRM 10 for Network Devices Stream-Datei um.
ms.assetid: 11aa0cfd-6d87-4ec4-82d8-db2507402911
keywords:
- Windows Media-Format-SDK, Umrechnen von DRM-geschützten Dateien
- Windows Media-Format-SDK, DRM-geschützte Dateien
- Advanced Systems Format (ASF), das wandeln von DRM-geschützten Dateien
- ASF (Advanced Systems Format), Umrechnen von DRM-geschützten Dateien
- Advanced Systems Format (ASF), DRM-geschützte Dateien
- ASF (Advanced Systems Format), DRM-geschützte Dateien
- Digital Rights Management (DRM), das Umrechnen von DRM-geschützten Dateien
- DRM (Digital Rights Management), Umrechnen von DRM-geschützten Dateien
- Digital Rights Management (DRM), DRM-geschützte Dateien
- DRM-Dateien (Digital Rights Management), DRM-geschützte Dateien
- Windows Media-Format-SDK, Windows Media DRM 10 für Netzwerkgeräte
- Windows Media-Format-SDK, DRM 10 für Netzwerkgeräte
- Advanced Systems Format (ASF), Windows Media DRM 10 für Netzwerkgeräte
- ASF (Advanced Systems Format), Windows Media DRM 10 für Netzwerkgeräte
- Advanced Systems Format (ASF), DRM 10 für Netzwerkgeräte
- ASF (Advanced Systems Format), DRM 10 für Netzwerkgeräte
- Digital Rights Management (DRM), Windows Media DRM 10 für Netzwerkgeräte
- DRM (Digital Rights Management), Windows Media DRM 10 für Netzwerkgeräte
- Digital Rights Management (DRM), DRM 10 für Netzwerkgeräte
- DRM (Digital Rights Management), DRM 10 für Netzwerkgeräte
- Windows Media DRM 10 für Netzwerkgeräte, das Umrechnen von DRM-geschützten Dateien
- DRM 10 für Netzwerkgeräte, Umrechnen von DRM-geschützten Dateien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 644c1b4f7ede688434fbb1dde11b7051c6f644a5
ms.sourcegitcommit: 48d1c892045445bcbd0f22bafa2fd3861ffaa6e7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/19/2020
ms.locfileid: "103723600"
---
# <a name="converting-a-drm-protected-file-to-a-windows-media-drm-10-for-network-devices-stream"></a><span data-ttu-id="4746f-125">Wandeln Sie eine DRM-Protected Datei in eine Windows Media DRM 10 for Network Devices Stream-Datei um.</span><span class="sxs-lookup"><span data-stu-id="4746f-125">Converting a DRM-Protected File to a Windows Media DRM 10 for Network Devices Stream</span></span>

<span data-ttu-id="4746f-126">Nachdem ein Gerät registriert und überprüft wurde, können Sie mit der Verarbeitung von Lizenz Anforderungs Nachrichten beginnen.</span><span class="sxs-lookup"><span data-stu-id="4746f-126">After a device is registered and validated, you can begin processing license request messages from it.</span></span> <span data-ttu-id="4746f-127">Lizenz Anforderungs Nachrichten werden von Geräten gesendet, wenn eine Aktion aus der Anwendung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="4746f-127">License request messages are sent by devices when action from the application is needed.</span></span> <span data-ttu-id="4746f-128">Die einzige derzeit unterstützte Aktion ist "Play", bei der es sich um eine Anforderung für sichere Daten für die Wiedergabe handelt.</span><span class="sxs-lookup"><span data-stu-id="4746f-128">The only action currently supported is "Play", which is a request for secure data for playback.</span></span>

<span data-ttu-id="4746f-129">Wenn Sie eine Lizenz Anforderungs Nachricht erhalten, sollten Sie die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="4746f-129">When you receive a license request message, you should perform the following steps:</span></span>

1.  <span data-ttu-id="4746f-130">Analysieren Sie die Lizenz Anforderungs Nachricht, indem Sie die [**iwmdrmmessageparser::P arselicenserequestmsg**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmmessageparser-parselicenserequestmsg) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="4746f-130">Parse the license request message by calling the [**IWMDRMMessageParser::ParseLicenseRequestMsg**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmmessageparser-parselicenserequestmsg) method.</span></span>
2.  <span data-ttu-id="4746f-131">Rufen Sie die [**iwmregistereddevice**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmregistereddevice) -Schnittstelle für das Gerät ab, indem Sie die [**iwmdeviceregistration:: getregistereddevicebyid**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdeviceregistration-getregistereddevicebyid) -Methode aufrufen und das Zertifikat und die Seriennummer übergeben, die Sie in Schritt 1 abgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="4746f-131">Get the [**IWMRegisteredDevice**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmregistereddevice) interface for the device by calling the [**IWMDeviceRegistration::GetRegisteredDeviceByID**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdeviceregistration-getregistereddevicebyid) method, passing in the certificate and serial number obtained in step 1.</span></span>
3.  <span data-ttu-id="4746f-132">Vergewissern Sie sich, dass das Gerät für den Empfang sicherer Daten bereit ist:</span><span class="sxs-lookup"><span data-stu-id="4746f-132">Verify that the device is ready to receive secure data:</span></span>
    -   <span data-ttu-id="4746f-133">Nennen Sie [**iwmregistereddevice:: IsApproved**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-isapproved) , um zu überprüfen, ob das Gerät genehmigt wurde.</span><span class="sxs-lookup"><span data-stu-id="4746f-133">Call [**IWMRegisteredDevice::IsApproved**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-isapproved) to verify that the device has been approved.</span></span> <span data-ttu-id="4746f-134">Die Genehmigung sollte immer auf der Benutzereinstellung basieren.</span><span class="sxs-lookup"><span data-stu-id="4746f-134">Approval should always be based on user preference.</span></span>
    -   <span data-ttu-id="4746f-135">Nennen Sie [**iwmregistereddevice:: IsValid**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-isvalid) , um sicherzustellen, dass das Gerät innerhalb der letzten 48 Stunden überprüft wurde.</span><span class="sxs-lookup"><span data-stu-id="4746f-135">Call [**IWMRegisteredDevice::IsValid**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-isvalid) to verify that the device has been validated within the last 48 hours.</span></span> <span data-ttu-id="4746f-136">Wenn das Gerät nicht gültig ist, müssen Sie die Near-Erkennung durchführen.</span><span class="sxs-lookup"><span data-stu-id="4746f-136">If the device is not valid, you need to perform proximity detection.</span></span> <span data-ttu-id="4746f-137">Weitere Informationen finden Sie unter [Durchführen der Near-Erkennung](performing-proximity-detection.md).</span><span class="sxs-lookup"><span data-stu-id="4746f-137">For more information, see [Performing Proximity Detection](performing-proximity-detection.md).</span></span>
    -   <span data-ttu-id="4746f-138">Nennen Sie [**iwmregistereddevice:: isgeöffnet**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-isopened) , um zu überprüfen, ob das Gerät geöffnet wurde.</span><span class="sxs-lookup"><span data-stu-id="4746f-138">Call [**IWMRegisteredDevice::IsOpened**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-isopened) to verify that the device has been opened.</span></span> <span data-ttu-id="4746f-139">Wenn das Gerät nicht geöffnet ist, können Sie es durch Aufrufen von [**iwmregistereddevice:: Open**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-open)öffnen.</span><span class="sxs-lookup"><span data-stu-id="4746f-139">If the device is not open, you can open it by calling [**IWMRegisteredDevice::Open**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-open).</span></span> <span data-ttu-id="4746f-140">Es können jeweils nur 10 Geräte auf dem Computer geöffnet sein.</span><span class="sxs-lookup"><span data-stu-id="4746f-140">You can only have 10 devices open on the computer at a time.</span></span> <span data-ttu-id="4746f-141">Möglicherweise müssen Sie ein anderes Gerät schließen, bevor Sie das öffnen können, für das Sie die Anforderung verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="4746f-141">It is possible that you may need to close another device before you can open the one for which you are processing the request.</span></span> <span data-ttu-id="4746f-142">Um ein Gerät zu schließen, müssen Sie die [**iwmregistereddevice:: Close**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-close) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="4746f-142">To close a device, call the [**IWMRegisteredDevice::Close**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-close) method.</span></span>
4.  <span data-ttu-id="4746f-143">Erstellen Sie eine Instanz des DRM-transryptor-Objekts, indem Sie die [**wmcreatedrmtranscryptor**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-wmcreatedrmtranscryptor) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="4746f-143">Create an instance of the DRM transcryptor object by calling the [**WMCreateDRMTranscryptor**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-wmcreatedrmtranscryptor) function.</span></span>
5.  <span data-ttu-id="4746f-144">Nennen Sie die [**iwmdrmtranszenryptor:: Initialisieren**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmtranscryptor-initialize) -Methode, um den transzenryptor zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="4746f-144">Call the [**IWMDRMTranscryptor::Initialize**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmtranscryptor-initialize) method to initialize the transcryptor.</span></span> <span data-ttu-id="4746f-145">Diese Methode nimmt einen Zeiger auf Ihre Implementierung der [**iwmstatuscallback**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstatuscallback) -Schnittstelle an, die für die Bereitstellung von Statusmeldungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="4746f-145">This method takes a pointer to your implementation of the [**IWMStatusCallback**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstatuscallback) interface, which it uses to deliver status messages.</span></span> <span data-ttu-id="4746f-146">Diese Methode gibt auch eine Lizenz Anforderungs Nachricht zurück, die an das Gerät gesendet werden muss, bevor Sie fortfahren.</span><span class="sxs-lookup"><span data-stu-id="4746f-146">This method also returns a license request message that must be sent to the device before continuing.</span></span>
6.  <span data-ttu-id="4746f-147">Wenn die [**iwmstatuscallback:: OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) -Methode der Anwendung die WMT- \_ transryptor- \_ Init-Statusmeldung empfängt, rufen Sie die [**iwmdrmtranszenryptor:: Seek**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmtranscryptor-seek) -Methode auf, um die entsprechende Startposition in der Datei zu suchen.</span><span class="sxs-lookup"><span data-stu-id="4746f-147">When your application's [**IWMStatusCallback::OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) method receives the WMT\_TRANSCRYPTOR\_INIT status message, call the [**IWMDRMTranscryptor::Seek**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmtranscryptor-seek) method to seek to the appropriate start position in the file.</span></span> <span data-ttu-id="4746f-148">Um am Anfang der Datei zu beginnen, müssen Sie **Seek** mit der Zeit 0 (null) aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="4746f-148">To start at the beginning of the file, you must call **Seek** with time 0.</span></span>
7.  <span data-ttu-id="4746f-149">Der transryptor sendet eine WMT- \_ \_ transryptornachricht, wenn er bereit ist, Daten aus der Datei zum Zeitpunkt der neuen Präsentation bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="4746f-149">The transcryptor sends a WMT\_TRANSCRYPTOR\_SEEKED message when it is ready to deliver data from the file at the new presentation time.</span></span> <span data-ttu-id="4746f-150">Führen Sie wiederholte Aufrufe der [**iwmdrmtranszenryptor:: Read**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmtranscryptor-read) -Methode aus, um konvertierte Blöcke von Mediendaten zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="4746f-150">Make repeated calls to the [**IWMDRMTranscryptor::Read**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmtranscryptor-read) method to get converted chunks of media data.</span></span> <span data-ttu-id="4746f-151">Jeder-Rückruf ist asynchron und wird erst beendet, wenn eine WMT- \_ transryptor- \_ Lese Nachricht empfangen wird.</span><span class="sxs-lookup"><span data-stu-id="4746f-151">Each call is asynchronous and is not complete until a WMT\_TRANSCRYPTOR\_READ message is received.</span></span> <span data-ttu-id="4746f-152">Wenn Sie die Meldung erhalten, können Sie die Daten an das empfangende Gerät senden.</span><span class="sxs-lookup"><span data-stu-id="4746f-152">When you receive the message, you can send the data to the receiving device.</span></span>
8.  <span data-ttu-id="4746f-153">Wenn Sie eine WMT- \_ transryptor- \_ Lese Nachricht empfangen, bei der der *HR* -Parameter auf NS \_ S- \_ transryptor \_ EOF festgelegt ist, wurde die gesamte Datei gelesen.</span><span class="sxs-lookup"><span data-stu-id="4746f-153">When you receive a WMT\_TRANSCRYPTOR\_READ message with the *hr* parameter set to NS\_S\_TRANSCRYPTOR\_EOF, the entire file has been read.</span></span> <span data-ttu-id="4746f-154">Nennen Sie an diesem Punkt die [**iwmdrmtranszenryptor:: Close**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmtranscryptor-close) -Methode, um die Datei zu schließen und Ressourcen freizugeben.</span><span class="sxs-lookup"><span data-stu-id="4746f-154">At this point, call the [**IWMDRMTranscryptor::Close**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmtranscryptor-close) method to close the file and free resources.</span></span>
9.  <span data-ttu-id="4746f-155">Wenn die geschlossene WMT- \_ transryptor- \_ Nachricht empfangen wird, können Sie die [**iwmdrmtranszenryptor**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmdrmtranscryptor) -Schnittstelle freigeben.</span><span class="sxs-lookup"><span data-stu-id="4746f-155">When the WMT\_TRANSCRYPTOR\_CLOSED message is received, you can release the [**IWMDRMTranscryptor**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmdrmtranscryptor) interface.</span></span>

> [!Note]  
> <span data-ttu-id="4746f-156">DRM wird von der x64-basierten Version dieses SDK nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4746f-156">DRM is not supported by the x64-based version of this SDK.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="4746f-157">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="4746f-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4746f-158">**Verwenden des Protokolls "Windows Media DRM 10 for Network Devices"**</span><span class="sxs-lookup"><span data-stu-id="4746f-158">**Using the Windows Media DRM 10 for Network Devices Protocol**</span></span>](using-the-windows-media-drm-10-for-network-devices-protocol.md)
</dt> </dl>

 

 




