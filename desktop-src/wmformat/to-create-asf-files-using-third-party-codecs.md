---
title: So erstellen Sie ASF-Dateien mithilfe von Codecs von Drittanbietern
description: So erstellen Sie ASF-Dateien mithilfe von Codecs von Drittanbietern
ms.assetid: 5cd348ca-1f86-429d-92ee-4eab4ced8571
keywords:
- Windows Media-Format-SDK, Erstellen von ASF-Dateien
- Windows Media-Format-SDK, Codecs von Drittanbietern
- Advanced Systems Format (ASF), Erstellen von Dateien
- ASF (Advanced Systems Format), Erstellen von Dateien
- Advanced Systems Format (ASF), Drittanbieter Codecs
- ASF (Advanced Systems Format), Codecs von Drittanbietern
- Drittanbieter Codecs
- Codecs, Drittanbieter
- Codecs, Erstellen von ASF-Dateien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9d6c057f1785ed50e328ac6094ff7dbe078e98fc
ms.sourcegitcommit: ad672d3a10192c5ccac619ad2524407109266e93
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/25/2020
ms.locfileid: "104314506"
---
# <a name="to-create-asf-files-using-third-party-codecs"></a><span data-ttu-id="53e3b-112">So erstellen Sie ASF-Dateien mithilfe von Codecs von Drittanbietern</span><span class="sxs-lookup"><span data-stu-id="53e3b-112">To Create ASF Files Using Third-Party Codecs</span></span>

<span data-ttu-id="53e3b-113">Sie können das Windows Media Format SDK zum Erstellen von ASF-Dateien verwenden, die digitale Medien enthalten, die mit einem beliebigen von Ihnen gewählten Codec codiert sind.</span><span class="sxs-lookup"><span data-stu-id="53e3b-113">You can use the Windows Media Format SDK to create ASF files that contain digital media encoded with any codec you choose.</span></span> <span data-ttu-id="53e3b-114">Wenn Sie einen anderen Codec als einen in diesem SDK enthaltenen Codec verwenden, müssen Sie die folgenden Schritte ausführen.</span><span class="sxs-lookup"><span data-stu-id="53e3b-114">When using a codec other than one included with this SDK, you must perform the following steps.</span></span>

1.  <span data-ttu-id="53e3b-115">Codieren Sie den Inhalt mit dem gewünschten Codec.</span><span class="sxs-lookup"><span data-stu-id="53e3b-115">Encode the content with the desired codec.</span></span>
2.  <span data-ttu-id="53e3b-116">Suchen oder erstellen Sie einen GUID-Wert, um Inhalte zu identifizieren, die mit dem in Schritt 1 verwendeten Codec codiert sind.</span><span class="sxs-lookup"><span data-stu-id="53e3b-116">Find or create a GUID value to identify content encoded with the codec used in step 1.</span></span>
3.  <span data-ttu-id="53e3b-117">Erstellen Sie ein neues Profil, oder ändern Sie ein vorhandenes Profil für die Verwendung mit dem codierten Inhalt.</span><span class="sxs-lookup"><span data-stu-id="53e3b-117">Create a new profile, or modify an existing profile for use with the encoded content.</span></span>
    -   <span data-ttu-id="53e3b-118">Erstellen Sie einen Stream für den codierten Inhalt mit dem entsprechenden Haupttyp.</span><span class="sxs-lookup"><span data-stu-id="53e3b-118">Create a stream for the encoded content with the appropriate major type.</span></span> <span data-ttu-id="53e3b-119">Weitere Informationen zu wichtigen Medientypen finden Sie unter [Medientypen](media-types.md).</span><span class="sxs-lookup"><span data-stu-id="53e3b-119">For more information about major media types, see [Media Types](media-types.md).</span></span> <span data-ttu-id="53e3b-120">Verwenden Sie die in Schritt 2 identifizierte GUID als Medien Untertyp.</span><span class="sxs-lookup"><span data-stu-id="53e3b-120">Use the GUID identified in step 2 as the media subtype.</span></span>
    -   <span data-ttu-id="53e3b-121">Legen Sie für den Datenstrom die Bitrate und das Puffer Fenster Werte fest, die nicht zu einem Pufferüberlauf führen.</span><span class="sxs-lookup"><span data-stu-id="53e3b-121">Set the bit rate and buffer window for the stream to values that will not result in buffer overflow.</span></span> <span data-ttu-id="53e3b-122">Sie sollten diese Werte zum Zeitpunkt der Codierung vom Codec abrufen können.</span><span class="sxs-lookup"><span data-stu-id="53e3b-122">You should be able to obtain these values from the codec at the time of encoding.</span></span> <span data-ttu-id="53e3b-123">Die SDK-Laufzeitkomponenten überprüfen die Werte für das Bitrate/Puffer Fenster und löschen ggf. Beispiele, um die angegebenen Daten in diese Werte einzufügen.</span><span class="sxs-lookup"><span data-stu-id="53e3b-123">The SDK runtime components check the bitrate/buffer window values and drop samples if necessary to make the given data fit in with these values.</span></span> <span data-ttu-id="53e3b-124">Wenn Sie die Werte falsch festlegen, wird die Datei nicht ordnungsgemäß gestreamt, was zu einer schlechten Wiedergabe führt.</span><span class="sxs-lookup"><span data-stu-id="53e3b-124">If you set the values incorrectly, the file will not stream properly, resulting in poor playback.</span></span>
    -   <span data-ttu-id="53e3b-125">Für Videostreams müssen Sie das **bicompression** -Member der **BITMAPINFOHEADER** -Struktur, die in der [**wmvideoinfoheader**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) -Struktur enthalten ist, auf den entsprechenden FourCC-Wert für den Inhalt festlegen.</span><span class="sxs-lookup"><span data-stu-id="53e3b-125">For video streams, you must set the **biCompression** member of the **BITMAPINFOHEADER** structure contained in the [**WMVIDEOINFOHEADER**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) structure to the appropriate FOURCC value for the content.</span></span> <span data-ttu-id="53e3b-126">Dieser Wert muss gleich den ersten vier Bytes der Untertyp-GUID sein.</span><span class="sxs-lookup"><span data-stu-id="53e3b-126">This value must be equal to the first four bytes of the subtype GUID.</span></span> <span data-ttu-id="53e3b-127">Wenn die **bicompression** z. b. makefourcc ('t ', ' E ', 's ') = 0x54455354 ist, beginnt die GUID des unter Typs wie folgt: 54455354-xxxx-xxxx-xxxx-xxxxxxxxxxxx.</span><span class="sxs-lookup"><span data-stu-id="53e3b-127">For example, if **biCompression** is MAKEFOURCC('T','E','S','T')=0x54455354, then the subtype GUID will begin like this: 54455354-XXXX-XXXX-XXXX-XXXXXXXXXXXX.</span></span>
4.  <span data-ttu-id="53e3b-128">Erstellen Sie ein Writer-Objekt, und laden Sie das im vorherigen Schritt erstellte Profil.</span><span class="sxs-lookup"><span data-stu-id="53e3b-128">Create a writer object and load the profile created in the previous step.</span></span> <span data-ttu-id="53e3b-129">Weitere Informationen zum Schreiben von Dateien finden Sie unter [Schreiben von ASF-Dateien](writing-asf-files.md).</span><span class="sxs-lookup"><span data-stu-id="53e3b-129">For more information about writing files, see [Writing ASF Files](writing-asf-files.md).</span></span>
5.  <span data-ttu-id="53e3b-130">Durchlaufen Sie die Eingaben der Datei, und weisen Sie Ihnen wie gewohnt Eingabe Eigenschaften zu.</span><span class="sxs-lookup"><span data-stu-id="53e3b-130">Loop through the inputs of the file and assign input properties for each as you normally would.</span></span> <span data-ttu-id="53e3b-131">Weitere Informationen zu Eingaben finden Sie unter [Arbeiten mit Eingaben](working-with-inputs.md).</span><span class="sxs-lookup"><span data-stu-id="53e3b-131">For more information about inputs, see [Working with Inputs](working-with-inputs.md).</span></span> <span data-ttu-id="53e3b-132">Legen Sie für den mit einem Drittanbieter-Codec codierten Stream den [**iwminputmedia-**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwminputmediaprops) Schnittstellen Zeiger auf **null** fest, bevor Sie [**iwmwriter:: BeginWrite**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-beginwriting)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="53e3b-132">For the stream encoded with a third-party codec, set the [**IWMInputMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwminputmediaprops) interface pointer to **NULL** before calling [**IWMWriter::BeginWriting**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-beginwriting).</span></span>
6.  <span data-ttu-id="53e3b-133">Verwenden Sie das neue Profil, das Sie im vorherigen Schritt erstellt haben, um die Datei zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="53e3b-133">Use the new profile created in the previous step to write the file.</span></span> <span data-ttu-id="53e3b-134">Übergeben Sie die komprimierten Beispiele, indem Sie [**iwmschreiteradvanced:: Write-streamsample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-writestreamsample) anstelle von [**iwmwriter:: Write tesample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-writesample)verwenden.</span><span class="sxs-lookup"><span data-stu-id="53e3b-134">Pass the compressed samples using [**IWMWriterAdvanced::WriteStreamSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-writestreamsample) instead of [**IWMWriter::WriteSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-writesample).</span></span> <span data-ttu-id="53e3b-135">Für Videos müssen Sie angeben, welche Stichproben Keyframes sind, indem Sie WM \_ SF- \_ Cleanpoint als *dwFlags* -Parameter übergeben.</span><span class="sxs-lookup"><span data-stu-id="53e3b-135">For video, you must specify which samples are key frames by passing WM\_SF\_CLEANPOINT as the *dwFlags* parameter.</span></span>

<span data-ttu-id="53e3b-136">Um den mit einem Drittanbieter-Codec codierten Stream zu verarbeiten und zu dekomprimieren, müssen Sie komprimierte streambeispiele lesen.</span><span class="sxs-lookup"><span data-stu-id="53e3b-136">To process and decompress the stream encoded with a third-party codec, you must read compressed stream samples.</span></span> <span data-ttu-id="53e3b-137">Die Leseanwendung muss auch die Beispiel Dekomprimierung für den Stream verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="53e3b-137">Your reading application must handle sample decompression for the stream as well.</span></span>

## <a name="putting-mpeg-2-streams-into-asf"></a><span data-ttu-id="53e3b-138">Einfügen von MPEG-2-Streams in ASF</span><span class="sxs-lookup"><span data-stu-id="53e3b-138">Putting MPEG-2 streams into ASF</span></span>

> [!Note]  
> <span data-ttu-id="53e3b-139">Dieses Thema gilt für Anwendungen, die das Windows Media-Format-SDK verwenden, um MPEG-2 (oder andere Komprimierungs Formate, die B-Frames verwenden) in den ASF-Datei Container einzufügen.</span><span class="sxs-lookup"><span data-stu-id="53e3b-139">This topic applies to applications that use the Windows Media Format SDK to put MPEG-2 (or other compression formats that use B frames) into the ASF file container.</span></span>

 

<span data-ttu-id="53e3b-140">Das Writer-Objekt erfordert, dass alle Eingabe Beispiele Zeitstempel enthalten, und es wird davon ausgegangen, dass jedes Eingabe Beispiel eine Präsentationszeit aufweist, die später als das vorangegangene vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="53e3b-140">The writer object requires that all input samples have time stamps, and it assumes that each input sample has a presentation time later than the one that preceded it.</span></span> <span data-ttu-id="53e3b-141">Obwohl praktisch alle nicht komprimierten Videos und sogar einige komprimierte Videostreams diese Bedingungen erfüllen, ist dies in MPEG-2-Streams nicht der Fall.</span><span class="sxs-lookup"><span data-stu-id="53e3b-141">While virtually all uncompressed video and even some compressed video streams meet these conditions, MPEG-2 streams do not.</span></span> <span data-ttu-id="53e3b-142">In MPEG-2 sind nicht alle Beispiele mit Zeitstempel versehen, und wenn B-Frames vorhanden sind, ist die Decodierung der Decodierung nicht mit der Rendering-Reihenfolge identisch.</span><span class="sxs-lookup"><span data-stu-id="53e3b-142">In MPEG-2, not all samples are time stamped, and when B frames are present, the sample decoding order is not the same as the rendering order.</span></span> <span data-ttu-id="53e3b-143">Wenn das Writer-Objekt nicht ordnungsgemäß formatierte Stichproben findet, ordnet es diese in der Reihenfolge "richtig" an.</span><span class="sxs-lookup"><span data-stu-id="53e3b-143">When the writer object encounters out-of-order samples, it rearranges them into the "correct" order.</span></span> <span data-ttu-id="53e3b-144">Daher müssen Sie zum Speichern von MPEG-2-Streams (nicht decodiert) in einem ASF-Container die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="53e3b-144">Therefore, to store MPEG-2 streams natively (not decoded) in an ASF container, you must perform the following steps:</span></span>

<span data-ttu-id="53e3b-145">Beim Schreiben der Datei:</span><span class="sxs-lookup"><span data-stu-id="53e3b-145">When writing the file:</span></span>

1.  <span data-ttu-id="53e3b-146">Fügen Sie jedem Eingabe Beispiel, das eine Struktur mit den tatsächlichen Start-und Endzeit Werten für den MPEG-Zeitstempel für das Beispiel enthält, eine Dateneinheiten Erweiterung mit fester Größe (Due) hinzu.</span><span class="sxs-lookup"><span data-stu-id="53e3b-146">Add a fixed-size data unit extension (DUE) to each input sample that will hold a structure that contains the actual MPEG time-stamp start-time and stop-time values for the sample.</span></span> <span data-ttu-id="53e3b-147">Verwenden Sie-1 für diese Werte, wenn das Beispiel keinen Zeitstempel aufweist.</span><span class="sxs-lookup"><span data-stu-id="53e3b-147">Use -1 for these values if the sample has no time stamp.</span></span>
2.  <span data-ttu-id="53e3b-148">Geben Sie dem Writer-Objekt "Dummy"-Eingabe Zeitstempel, die immer zunehmen, sodass die Beispiele in genau derselben Reihenfolge in die Datei geschrieben werden, in der Sie empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="53e3b-148">Give the writer object "dummy" input time stamps that are always increasing so that it will write the samples to the file in exactly the same order as they are received.</span></span> <span data-ttu-id="53e3b-149">Die Dummy-Zeitstempel sollten ungefähr der tatsächlichen Präsentationszeit entsprechen, wie im Laufe der Zeit.</span><span class="sxs-lookup"><span data-stu-id="53e3b-149">The dummy time stamps should correspond approximately to the actual presentation times, as averaged over time.</span></span> <span data-ttu-id="53e3b-150">Die Dummy-Zeitstempel bilden die gesuchte Zeitachse. Wenn Sie also relativ zu den echt Zeitstempeln abweichen, führen Suchvorgänge in der Datei zu unerwarteten Ergebnissen.</span><span class="sxs-lookup"><span data-stu-id="53e3b-150">The dummy time stamps will form the seeking timeline, so if they diverge relative to the real time stamps, seek operations on the file will produce unexpected results.</span></span> <span data-ttu-id="53e3b-151">Eine begrenzte Menge an Jitter zwischen den Stichproben Zeiten wirkt sich jedoch nicht ernsthaft auf Suchvorgänge aus.</span><span class="sxs-lookup"><span data-stu-id="53e3b-151">However, a limited amount of jitter between the sample times will not seriously affect seek operations.</span></span>

<span data-ttu-id="53e3b-152">Beim Lesen der Datei:</span><span class="sxs-lookup"><span data-stu-id="53e3b-152">When reading the file:</span></span>

-   <span data-ttu-id="53e3b-153">Überprüfen Sie für jedes aus der Datei gelesene Beispiel den fälligen.</span><span class="sxs-lookup"><span data-stu-id="53e3b-153">For each sample read from the file, examine the DUE.</span></span> <span data-ttu-id="53e3b-154">Wenn Sie eine Startzeit enthält, die größer oder gleich 0 (null) ist, kopieren Sie diesen Wert in den Zeitstempel für das Ausgabe Beispiel, bevor dieser an den Decoder übermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="53e3b-154">If it contains a start time that is greater than or equal to zero, copy that value to the time stamp for the output sample before it is delivered to the decoder.</span></span> <span data-ttu-id="53e3b-155">Legen Sie alle anderen Zeitstempel der Ausgabe Beispiele auf **null** fest.</span><span class="sxs-lookup"><span data-stu-id="53e3b-155">Set all other time stamps on the output samples to **NULL**.</span></span> <span data-ttu-id="53e3b-156">In DirectShow erfolgt dies durch Aufrufen von **imediasample:: setTime**(**null**,**null**).</span><span class="sxs-lookup"><span data-stu-id="53e3b-156">In DirectShow, this is done by calling **IMediaSample::SetTime**(**NULL**,**NULL**).</span></span>

## <a name="related-topics"></a><span data-ttu-id="53e3b-157">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="53e3b-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="53e3b-158">**Pufferung von Inhalten**</span><span class="sxs-lookup"><span data-stu-id="53e3b-158">**Buffering Content**</span></span>](buffering-content.md)
</dt> <dt>

[<span data-ttu-id="53e3b-159">**Iwmwriter-Schnittstelle**</span><span class="sxs-lookup"><span data-stu-id="53e3b-159">**IWMWriter Interface**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriter)
</dt> <dt>

[<span data-ttu-id="53e3b-160">**Iwmschreiteradvanced-Schnittstelle**</span><span class="sxs-lookup"><span data-stu-id="53e3b-160">**IWMWriterAdvanced Interface**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriteradvanced)
</dt> <dt>

[<span data-ttu-id="53e3b-161">**So liefern Sie komprimierte Beispiele mit dem asynchronen Reader**</span><span class="sxs-lookup"><span data-stu-id="53e3b-161">**To Deliver Compressed Samples with the Asynchronous Reader**</span></span>](to-deliver-compressed-samples-with-the-asynchronous-reader.md)
</dt> <dt>

[<span data-ttu-id="53e3b-162">**So rufen Sie streambeispiele mit dem synchronen Reader ab**</span><span class="sxs-lookup"><span data-stu-id="53e3b-162">**To Retrieve Stream Samples with the Synchronous Reader**</span></span>](to-retrieve-stream-samples-with-the-synchronous-reader.md)
</dt> <dt>

[<span data-ttu-id="53e3b-163">**Wmvideoinfoheader**</span><span class="sxs-lookup"><span data-stu-id="53e3b-163">**WMVIDEOINFOHEADER**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader)
</dt> <dt>

[<span data-ttu-id="53e3b-164">**Arbeiten mit Profilen**</span><span class="sxs-lookup"><span data-stu-id="53e3b-164">**Working with Profiles**</span></span>](working-with-profiles.md)
</dt> <dt>

[<span data-ttu-id="53e3b-165">**Schreiben von ASF-Dateien**</span><span class="sxs-lookup"><span data-stu-id="53e3b-165">**Writing ASF Files**</span></span>](writing-asf-files.md)
</dt> </dl>

 

 




