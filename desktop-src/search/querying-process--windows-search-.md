---
description: .
ms.assetid: 0e5a633e-1703-4b72-8a04-6da71aec0ae2
title: Abfrageprozess in Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d92d868cb843e96b04d6b4bd575284638b6652ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103750345"
---
# <a name="querying-process-in-windows-search"></a><span data-ttu-id="22f40-103">Abfrageprozess in Windows Search</span><span class="sxs-lookup"><span data-stu-id="22f40-103">Querying Process in Windows Search</span></span>

<span data-ttu-id="22f40-104">Dieses Thema ist wie folgt organisiert:</span><span class="sxs-lookup"><span data-stu-id="22f40-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="22f40-105">Informationen zum Abfragen in Windows Search</span><span class="sxs-lookup"><span data-stu-id="22f40-105">About Querying in Windows Search</span></span>](#about-querying-in-windows-search)
    -   [<span data-ttu-id="22f40-106">Lokale Abfragen und Remote Abfragen</span><span class="sxs-lookup"><span data-stu-id="22f40-106">Local and Remote Queries</span></span>](#local-and-remote-queries)
    -   [<span data-ttu-id="22f40-107">Übersicht über die strukturierte Abfrage-API</span><span class="sxs-lookup"><span data-stu-id="22f40-107">Structured Query API Overview</span></span>](#structured-query-api-overview)
-   [<span data-ttu-id="22f40-108">Abfragen von Szenarien</span><span class="sxs-lookup"><span data-stu-id="22f40-108">Querying Scenarios</span></span>](#querying-scenarios)
    -   [<span data-ttu-id="22f40-109">Bedingungs Extraktion und Abfrage Verarbeitung</span><span class="sxs-lookup"><span data-stu-id="22f40-109">Condition Extraction and Query Parsing</span></span>](#condition-extraction-and-query-parsing)
    -   [<span data-ttu-id="22f40-110">Abfragen des Indexes</span><span class="sxs-lookup"><span data-stu-id="22f40-110">Querying the Index</span></span>](#querying-the-index)
-   [<span data-ttu-id="22f40-111">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="22f40-111">Related topics</span></span>](#related-topics)

## <a name="about-querying-in-windows-search"></a><span data-ttu-id="22f40-112">Informationen zum Abfragen in Windows Search</span><span class="sxs-lookup"><span data-stu-id="22f40-112">About Querying in Windows Search</span></span>

<span data-ttu-id="22f40-113">Das Abfragen in Windows Search basiert auf den folgenden vier Ansätzen:</span><span class="sxs-lookup"><span data-stu-id="22f40-113">Querying in Windows Search is based on the following four approaches:</span></span>

-   <span data-ttu-id="22f40-114">[Erweiterte Abfrage Syntax](-search-3x-advancedquerysyntax.md) (AQS)</span><span class="sxs-lookup"><span data-stu-id="22f40-114">[Advanced Query Syntax](-search-3x-advancedquerysyntax.md) (AQS)</span></span>
-   <span data-ttu-id="22f40-115">Natürliche Abfrage Syntax (NQS)</span><span class="sxs-lookup"><span data-stu-id="22f40-115">Natural Query Syntax (NQS)</span></span>
-   <span data-ttu-id="22f40-116">Structured Query Language (SQL) (Structured Query Language, SQL)</span><span class="sxs-lookup"><span data-stu-id="22f40-116">Structured Query Language (SQL)</span></span>
-   <span data-ttu-id="22f40-117">Strukturierte Abfrageschnittstellen</span><span class="sxs-lookup"><span data-stu-id="22f40-117">Structured query interfaces</span></span>

<span data-ttu-id="22f40-118">AQS ist die Standard Abfrage Syntax, die von Windows Search verwendet wird, um den Index abzufragen und Suchparameter zu verfeinern und einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="22f40-118">AQS is the default query syntax used by Windows Search to query the index and to refine and narrow search parameters.</span></span> <span data-ttu-id="22f40-119">AQS ist hauptsächlich für Benutzer sichtbar und kann von Benutzern verwendet werden, um AQS-Abfragen zu erstellen. Sie kann jedoch auch von Entwicklern verwendet werden, um Abfragen Programm gesteuert zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="22f40-119">AQS is primarily user facing, and can be used by users to build AQS queries, but can also be used by developers to build queries programmatically.</span></span> <span data-ttu-id="22f40-120">In Windows 7 wurde die kanonische AQS eingeführt und muss zum programmgesteuerten Generieren von AQS-Abfragen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="22f40-120">In Windows 7, canonical AQS was introduced and must be used to programmatically generate AQS queries.</span></span> <span data-ttu-id="22f40-121">In Windows 7 und höher kann eine Kontextmenü Option basierend darauf verfügbar sein, ob eine AQS-Bedingung erfüllt ist.</span><span class="sxs-lookup"><span data-stu-id="22f40-121">In Windows 7 and later, a shortcut menu option can be available based on whether an AQS condition is met.</span></span> <span data-ttu-id="22f40-122">Weitere Informationen finden Sie unter "erzielen von dynamischen Verhalten bei statischen Verben mithilfe der erweiterten Abfrage Syntax" unter [Erstellen von Kontextmenü Handlern](../shell/context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="22f40-122">For more information, see "Getting Dynamic Behavior for Static Verbs by Using Advanced Query Syntax" in [Creating Context Menu Handlers](../shell/context-menu-handlers.md).</span></span> <span data-ttu-id="22f40-123">AQS-Abfragen können auf bestimmte Typen von Dateien beschränkt werden, die als Dateitypen bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="22f40-123">AQS queries can be limited to specific types of files, which are known as file kinds.</span></span> <span data-ttu-id="22f40-124">Weitere Informationen finden Sie unter [Dateitypen und Zuordnungen](../shell/fa-intro.md).</span><span class="sxs-lookup"><span data-stu-id="22f40-124">For more information, see [File Types and Associations](../shell/fa-intro.md).</span></span> <span data-ttu-id="22f40-125">Eine Referenz Dokumentation zu den relevanten Eigenschaften finden Sie unter [System. Kind](../properties/props-system-kind.md)und [System. kindtext](../properties/props-system-kindtext.md).</span><span class="sxs-lookup"><span data-stu-id="22f40-125">For reference documentation on the relevant properties, see [System.Kind](../properties/props-system-kind.md), and [System.KindText](../properties/props-system-kindtext.md).</span></span>

<span data-ttu-id="22f40-126">NQS ist eine Abfrage Syntax, die einfacher als AQS ist und der menschlichen Sprache ähnelt.</span><span class="sxs-lookup"><span data-stu-id="22f40-126">NQS is a query syntax that is more relaxed than AQS, and is similar to human language.</span></span> <span data-ttu-id="22f40-127">NQS kann von Windows Search verwendet werden, um den Index abzufragen, wenn NQS anstelle der standardmäßigen AQS ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="22f40-127">NQS can be used by Windows Search to query the index if NQS is selected instead of the default, AQS.</span></span>

<span data-ttu-id="22f40-128">SQL ist eine Text Sprache, mit der Abfragen definiert werden.</span><span class="sxs-lookup"><span data-stu-id="22f40-128">SQL is a text language that defines queries.</span></span> <span data-ttu-id="22f40-129">SQL ist in vielen verschiedenen Datenbanktechnologien üblich.</span><span class="sxs-lookup"><span data-stu-id="22f40-129">SQL is common across many different database technologies.</span></span> <span data-ttu-id="22f40-130">Windows Search verwendet SQL, implementiert eine Teilmenge davon und erweitert Sie durch Hinzufügen von Elementen zur Sprache.</span><span class="sxs-lookup"><span data-stu-id="22f40-130">Windows Search uses SQL, implements a subset of it, and extends it by adding elements to the language.</span></span> <span data-ttu-id="22f40-131">Windows Search SQL erweitert die Standard Abfrage Syntax von SQL-92 und SQL-99, um die Nützlichkeit durch textbasierte Suchvorgänge zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="22f40-131">Windows Search SQL extends the standard SQL-92 and SQL-99 database query syntax to enhance its usefulness with text-based searches.</span></span> <span data-ttu-id="22f40-132">Alle Features von Windows Search SQL sind mit Windows Search unter Windows XP und Windows Server 2003 und höher kompatibel.</span><span class="sxs-lookup"><span data-stu-id="22f40-132">All features of Windows Search SQL are compatible with Windows Search on Windows XP and Windows Server 2003, and later.</span></span> <span data-ttu-id="22f40-133">Weitere Informationen zu Windows Search SQL finden Sie unter [Abfragen des Indexes mit der SQL-Syntax von Windows Search](-search-sql-windowssearch-entry.md)und [Übersicht über die SQL-Syntax von Windows Search](-search-sql-ovwofsearchquery.md).</span><span class="sxs-lookup"><span data-stu-id="22f40-133">For more information about Windows Search SQL, see [Querying the Index with Windows Search SQL Syntax](-search-sql-windowssearch-entry.md), and [Overview of Windows Search SQL Syntax](-search-sql-ovwofsearchquery.md).</span></span>

<span data-ttu-id="22f40-134">Die APIs für strukturierte Abfragen werden weiter unten in diesem Thema beschrieben.</span><span class="sxs-lookup"><span data-stu-id="22f40-134">The structured query APIs are described later in this topic.</span></span> <span data-ttu-id="22f40-135">Eine Referenz Dokumentation zu den APIs für strukturierte Abfragen finden Sie unter [Abfragen von Schnittstellen](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="22f40-135">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="22f40-136">Schnittstellen wie [**isearchqueryhelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) helfen beim Erstellen von SQL-Zeichen folgen aus einem Satz von Eingabe Werten.</span><span class="sxs-lookup"><span data-stu-id="22f40-136">Interfaces such as [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) help construct SQL strings from a set of input values.</span></span> <span data-ttu-id="22f40-137">Diese Schnittstelle konvertiert AQS-Benutzer Abfragen in Windows Search SQL und gibt Abfrage Einschränkungen an, die in SQL, aber nicht in AQS ausgedrückt werden können.</span><span class="sxs-lookup"><span data-stu-id="22f40-137">This interface converts AQS user queries to Windows Search SQL and specifies query restrictions that can be expressed in SQL but not in AQS.</span></span> <span data-ttu-id="22f40-138">[**Isearchqueryhelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) erhält auch eine OLE DB Verbindungs Zeichenfolge, um eine Verbindung mit der Windows Search-Datenbank herzustellen.</span><span class="sxs-lookup"><span data-stu-id="22f40-138">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) also obtains an OLE DB connection string to connect to the Windows Search database.</span></span>

### <a name="local-and-remote-queries"></a><span data-ttu-id="22f40-139">Lokale Abfragen und Remote Abfragen</span><span class="sxs-lookup"><span data-stu-id="22f40-139">Local and Remote Queries</span></span>

<span data-ttu-id="22f40-140">Sie können Ihre Abfragen entweder lokal oder Remote ausführen.</span><span class="sxs-lookup"><span data-stu-id="22f40-140">You can execute your queries either locally or remotely.</span></span> <span data-ttu-id="22f40-141">Eine lokale Abfrage mit der [from-Klausel](-search-sql-from.md) wird im folgenden Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="22f40-141">A local query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="22f40-142">Eine lokale Abfrage fragt nur den lokalen SystemIndex-Katalog ab.</span><span class="sxs-lookup"><span data-stu-id="22f40-142">A local query queries the local SystemIndex catalog only.</span></span>


```
FROM SystemIndex
```



<span data-ttu-id="22f40-143">Eine Remote Abfrage mit der [from-Klausel](-search-sql-from.md) wird im folgenden Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="22f40-143">A remote query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="22f40-144">Durch das Hinzufügen von Computername wird das vorherige Beispiel in eine Remote Abfrage transformiert.</span><span class="sxs-lookup"><span data-stu-id="22f40-144">Adding ComputerName transforms the previous example into a remote query.</span></span>


```
FROM [<ComputerName>.]SystemIndex
```



<span data-ttu-id="22f40-145">In Windows XP und Windows Server 2003 ist Windows Search standardmäßig nicht installiert.</span><span class="sxs-lookup"><span data-stu-id="22f40-145">By default, Windows XP and Windows Server 2003 do not have Windows Search installed.</span></span> <span data-ttu-id="22f40-146">Nur Windows Search 4 (WS4) bietet Unterstützung für Remote Abfragen.</span><span class="sxs-lookup"><span data-stu-id="22f40-146">Only Windows Search 4 (WS4) provides remote query support.</span></span> <span data-ttu-id="22f40-147">Frühere Versionen von Windows Desktop Search (WDS), wie z. b. 3,01 und früher, unterstützen keine Remote Abfragen.</span><span class="sxs-lookup"><span data-stu-id="22f40-147">Previous versions of Windows Desktop Search (WDS), such as 3.01 and earlier, do not support remote querying.</span></span> <span data-ttu-id="22f40-148">Mit Windows Explorer können Sie den lokalen Index eines Remote Computers für Dateisystem Elemente (Elemente, die vom Protokoll "file:" behandelt werden) Abfragen.</span><span class="sxs-lookup"><span data-stu-id="22f40-148">With Windows Explorer you can query the local index of a remote computer for file system items (items handled by the "file:" protocol).</span></span>

<span data-ttu-id="22f40-149">Zum Abrufen eines Elements nach Remote Abfrage muss das Element die folgenden Anforderungen erfüllen:</span><span class="sxs-lookup"><span data-stu-id="22f40-149">To retrieve an item by remote query, the item must meet the following requirements:</span></span>

-   <span data-ttu-id="22f40-150">Kann über Universal Naming Convention (UNC)-Pfad aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="22f40-150">Be accessible via Universal Naming Convention (UNC) path.</span></span>
-   <span data-ttu-id="22f40-151">Vorhanden auf dem Remote Computer, auf den der Client Zugriff hat.</span><span class="sxs-lookup"><span data-stu-id="22f40-151">Exist on the remote computer to which the client has access.</span></span>
-   <span data-ttu-id="22f40-152">Die Sicherheit muss festgelegt sein, damit der Client über Lesezugriff verfügen kann.</span><span class="sxs-lookup"><span data-stu-id="22f40-152">Have its security set to allow the client to have Read access.</span></span>

<span data-ttu-id="22f40-153">Windows-Explorer verfügt über Features zum Freigeben von Elementen, einschließlich einer öffentlichen Freigabe ( \\ \\ \\ Public \\ ...) im **Netzwerk-und Freigabe Center** und einer "Benutzer Freigabe" ( \\ \\ Computer \\ Benutzer.. \\ .) für Elemente, die über den Freigabe-Assistenten freigegeben werden.</span><span class="sxs-lookup"><span data-stu-id="22f40-153">Windows Explorer has features for sharing items, including a "Public" share (\\\\Machine\\Public\\...) in the **Network and Sharing Center**, and a "Users" share (\\\\Machine\\Users\\...) for items shared via the Sharing Wizard.</span></span> <span data-ttu-id="22f40-154">Nachdem Sie die Ordner freigegeben haben, können Sie den lokalen Index Abfragen, indem Sie den Computernamen des Remote Computers in der from-Klausel und einen UNC-Pfad auf dem Remote Computer in der Scope-Klausel angeben.</span><span class="sxs-lookup"><span data-stu-id="22f40-154">After you share the folder(s), you can query the local index by specifying the remote computer's machine name in the FROM clause, and a UNC path on the remote computer in the SCOPE clause.</span></span> <span data-ttu-id="22f40-155">Eine Remote Abfrage mit der from-Klausel und der Scope-Klausel ist im folgenden Beispiel dargestellt.</span><span class="sxs-lookup"><span data-stu-id="22f40-155">A remote query using the FROM and SCOPE clauses is shown in the following example.</span></span>


```
SELECT System.ItemName FROM MachineName.SystemIndex WHERE SCOPE='file://MachineName/<path>' 
```



<span data-ttu-id="22f40-156">In den hier bereitgestellten Beispielen wird SQL verwendet.</span><span class="sxs-lookup"><span data-stu-id="22f40-156">The examples provided here use SQL.</span></span>

### <a name="structured-query-api-overview"></a><span data-ttu-id="22f40-157">Übersicht über die strukturierte Abfrage-API</span><span class="sxs-lookup"><span data-stu-id="22f40-157">Structured Query API Overview</span></span>

<span data-ttu-id="22f40-158">Eine strukturierte Abfrage bietet die Möglichkeit, anhand von booleschen Kombinationen von Abfragen über einzelne Eigenschaften nach Informationen zu suchen.</span><span class="sxs-lookup"><span data-stu-id="22f40-158">A structured query provides the ability to search for information by Boolean combinations of queries over individual properties.</span></span> <span data-ttu-id="22f40-159">In diesem Thema werden die Funktionen der wichtigsten strukturierten Abfrage-APIs und-Methoden erläutert.</span><span class="sxs-lookup"><span data-stu-id="22f40-159">In this topic we outline the functionality of the most important structured query APIs and methods.</span></span> <span data-ttu-id="22f40-160">Eine Referenz Dokumentation zu den APIs für strukturierte Abfragen finden Sie unter [Abfragen von Schnittstellen](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="22f40-160">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span>

### <a name="iqueryparser"></a><span data-ttu-id="22f40-161">Iqueryparser</span><span class="sxs-lookup"><span data-stu-id="22f40-161">IQueryParser</span></span>

<span data-ttu-id="22f40-162">Die [**iqueryparser::P Arse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) -Methode analysiert eine Benutzereingabe Zeichenfolge und erzeugt eine Interpretation in Form einer [**iquerysolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span><span class="sxs-lookup"><span data-stu-id="22f40-162">The [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method parses a user input string, and produces an interpretation in the form of an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span></span> <span data-ttu-id="22f40-163">Wenn der *pcustomproperties* -Parameter dieser Methode nicht NULL ist, handelt es sich um eine Enumeration von [**irichchunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) -Objekten (eine für jede erkannte benutzerdefinierte Eigenschaft).</span><span class="sxs-lookup"><span data-stu-id="22f40-163">If the *pCustomProperties* parameter of that method is not null, then it is an enumeration of [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) objects(one for each recognized custom property).</span></span> <span data-ttu-id="22f40-164">Die anderen [**iqueryparser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) -Methoden ermöglichen es der Anwendung, mehrere Optionen wie locale, ein Schema, eine Wörter Trennung und Handler für verschiedene Typen von benannten Entitäten festzulegen.</span><span class="sxs-lookup"><span data-stu-id="22f40-164">The other [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) methods permit the application to set several options, such as locale, a schema, a word breaker, and handlers for various types of named entities.</span></span> <span data-ttu-id="22f40-165">[**Iqueryparser:: getschemaprovider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) gibt eine [**ischemaprovider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) -Schnittstelle zum Durchsuchen des geladenen Schemas zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-165">[**IQueryParser::GetSchemaProvider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) returns an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface for browsing the loaded schema.</span></span>

### <a name="iquerysolution--iconditionfactory"></a><span data-ttu-id="22f40-166">Iquerysolution: iconditionfactory</span><span class="sxs-lookup"><span data-stu-id="22f40-166">IQuerySolution : IConditionFactory</span></span>

<span data-ttu-id="22f40-167">Die [**iquerysolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) -Schnittstelle stellt alle Informationen über das Ergebnis der Verarbeitung einer Eingabe Zeichenfolge bereit.</span><span class="sxs-lookup"><span data-stu-id="22f40-167">The [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface provides all information about the result of parsing an input string.</span></span> <span data-ttu-id="22f40-168">Da **iquerysolution** auch eine [**iconditionfactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) -Schnittstelle ist, können zusätzliche Bedingungs Struktur Knoten erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="22f40-168">Because **IQuerySolution** is also an [**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) interface, additional condition tree nodes can be created.</span></span> <span data-ttu-id="22f40-169">Die [**iquerysolution:: GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) -Methode erzeugt eine Bedingungs Struktur für die Interpretation.</span><span class="sxs-lookup"><span data-stu-id="22f40-169">The [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) method produces a condition tree for the interpretation.</span></span> <span data-ttu-id="22f40-170">**Iquerysolution:: GetQuery** gibt auch den Semantik Typ zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-170">**IQuerySolution::GetQuery** also returns the semantic type.</span></span>

### <a name="iconditionfactory"></a><span data-ttu-id="22f40-171">Iconditionfactory</span><span class="sxs-lookup"><span data-stu-id="22f40-171">IConditionFactory</span></span>

<span data-ttu-id="22f40-172">[**Iconditionfactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) erstellt Bedingungs Struktur Knoten.</span><span class="sxs-lookup"><span data-stu-id="22f40-172">[**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) creates condition tree nodes.</span></span> <span data-ttu-id="22f40-173">Wenn der *vereinfachte Parameter* von [**iconditionfactory:: makenot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) **Variant \_ true** ist, wird die resultierende [**icondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) -Eigenschaft vereinfacht und muss kein Negations Knoten sein.</span><span class="sxs-lookup"><span data-stu-id="22f40-173">If the *simplify* parameter of [**IConditionFactory::MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) is **VARIANT\_TRUE**, then the resulting [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) is simplified, and need not be a negation node.</span></span> <span data-ttu-id="22f40-174">Wenn der *psubconditions* -Parameter von [**iconditionfactory:: makeandor**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) nicht NULL ist, sollte dieser Parameter eine Enumeration von [**icondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) -Objekten sein und zu Unterstrukturen werden. [**Iconditionfactory:: makeleaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) erstellt einen Blattknoten mit einem angegebenen Eigenschaftsnamen,-Vorgang und-Wert.</span><span class="sxs-lookup"><span data-stu-id="22f40-174">If the *pSubConditions* parameter of [**IConditionFactory::MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) is not null, then that parameter should be an enumeration of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) objects, and become subtrees.[**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) constructs a leaf node with a specified property name, operation, and value.</span></span> <span data-ttu-id="22f40-175">Die Zeichenfolge im *pvaluetype* -Parameter sollte der Name eines Semantik Typs aus dem Schema sein.</span><span class="sxs-lookup"><span data-stu-id="22f40-175">The string in the *pValueType* parameter should be the name of a semantic type from the schema.</span></span> <span data-ttu-id="22f40-176">Wenn der *Erweiterungs Parameter* **Variant \_ true** und die-Eigenschaft virtuell ist, ist die resultierende Bedingungs Struktur in der Regel eine Disjunktion, die sich aus der Erweiterung der-Eigenschaft auf die definierten-Bestandteile ergibt.</span><span class="sxs-lookup"><span data-stu-id="22f40-176">If the *expand* parameter is **VARIANT\_TRUE** and the property is virtual, the resulting condition tree is typically a disjunction resulting from expanding the property to its defined constituents.</span></span> <span data-ttu-id="22f40-177">Wenn der Wert nicht NULL ist, sollten die Parameter *ppropertynameterm*, *poperatorterm* und *pvalueterm* Begriffe identifizieren, die die Eigenschaft, den Vorgang und den Wert angeben.</span><span class="sxs-lookup"><span data-stu-id="22f40-177">If not null, the *pPropertyNameTerm*, *pOperatorTerm*, and *pValueTerm* parameters should identify terms indicating the property, operation, and value.</span></span>

### <a name="icondition--ipersiststream"></a><span data-ttu-id="22f40-178">Icondition: IPersistStream</span><span class="sxs-lookup"><span data-stu-id="22f40-178">ICondition : IPersistStream</span></span>

<span data-ttu-id="22f40-179">Die [**icondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) -Schnittstelle ist ein einzelner Knoten in einer Bedingungs Struktur.</span><span class="sxs-lookup"><span data-stu-id="22f40-179">The [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface is a single node in a condition tree.</span></span> <span data-ttu-id="22f40-180">Der Knoten kann ein Negation-Knoten, ein Knoten, ein Knoten oder ein Blattknoten sein.</span><span class="sxs-lookup"><span data-stu-id="22f40-180">The node can be a negation node, AND node, OR node, or a leaf node.</span></span> <span data-ttu-id="22f40-181">Für einen nicht Blattknoten gibt [**icondition:: getsubconditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) eine Enumeration der Teil Strukturen zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-181">For a non-leaf node [**ICondition::GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) returns an enumeration of the subtrees.</span></span> <span data-ttu-id="22f40-182">Bei einem Blattknoten geben die folgenden Methoden von [**icondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) die folgenden Werte zurück:</span><span class="sxs-lookup"><span data-stu-id="22f40-182">For a leaf node the following methods of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) return the following values:</span></span>

-   <span data-ttu-id="22f40-183">[**Getcomparisoninfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) gibt den Eigenschaftsnamen, den Vorgang und den Wert zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) returns the property name, operation, and value.</span></span>
-   <span data-ttu-id="22f40-184">[**Getvaluetype**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) gibt den semantischen Typ des Werts zurück, der im *pszvaluetype* -Parameter von [**iconditionfactory:: makeleaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf)angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="22f40-184">[**GetValueType**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) returns the semantic type of the value, which was specificied in the *pszValueType* parameter of [**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span></span>
-   <span data-ttu-id="22f40-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) gibt eine Zeichen folgen Form des Werts zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) returns a string form of the value.</span></span> <span data-ttu-id="22f40-186">(Wenn der Wert bereits eine Zeichenfolge ist, wird dieses Formular in Bezug auf Groß-/Kleinschreibung, Akzente usw. normalisiert.)</span><span class="sxs-lookup"><span data-stu-id="22f40-186">(If the value was already a string, this form will be normalized with regard to case, accents, and so forth.)</span></span>
-   <span data-ttu-id="22f40-187">[**Getinputterms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) gibt Informationen darüber zurück, welche Teile des Eingabe Satzes den Eigenschaftsnamen, den Vorgang und den Wert generiert haben.</span><span class="sxs-lookup"><span data-stu-id="22f40-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) returns information about which parts of the input sentence generated the property name, the operation, and the value.</span></span>
-   <span data-ttu-id="22f40-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) gibt eine tiefe Kopie einer Bedingungs Struktur zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) returns a deep copy of a condition tree.</span></span>

### <a name="irichchunk"></a><span data-ttu-id="22f40-189">Irichchunk</span><span class="sxs-lookup"><span data-stu-id="22f40-189">IRichChunk</span></span>

<span data-ttu-id="22f40-190">Jedes [**irichchunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) -Objekt identifiziert eine tokenspanne und eine Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="22f40-190">Each [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) object identifies a token span and a string.</span></span> <span data-ttu-id="22f40-191">**Irichchunk** ist eine hilfsprogrammschnittstelle, die Informationen über eine Spanne (in der Regel eine Spanne von Token) darstellt, die durch eine Anfangsposition und-Länge gekennzeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="22f40-191">**IRichChunk** is a utility interface that represents information about a span (typically a span of tokens) identified by a starting position and length.</span></span> <span data-ttu-id="22f40-192">Diese Spannen Informationen beinhalten eine Zeichenfolge und/oder eine **Variante**.</span><span class="sxs-lookup"><span data-stu-id="22f40-192">This span information includes a string and/or a **VARIANT**.</span></span>

### <a name="iconditiongenerator"></a><span data-ttu-id="22f40-193">Iconditiongenerator</span><span class="sxs-lookup"><span data-stu-id="22f40-193">IConditionGenerator</span></span>

<span data-ttu-id="22f40-194">Die [**iconditiongenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) -Schnittstelle wird von der Anwendung bereitgestellt, um die Generierung von Erkennungs-und Bedingungs Strukturen für einen benannten Entitätstyp zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="22f40-194">The [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) interface is provided by the application to handle recognition and condition tree generation for a named entity type.</span></span> <span data-ttu-id="22f40-195">Ein Bedingungs Generator wird an [**iqueryparser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) über [**iqueryparser:: setmultioption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption)übergeben.</span><span class="sxs-lookup"><span data-stu-id="22f40-195">A condition generator is given to an [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) through [**IQueryParser::SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span></span> <span data-ttu-id="22f40-196">[**Iqueryparser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) ruft [**iconditiongenerator:: Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) mit einem [**ischemaprovider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) für das aktuell geladene Schema auf.</span><span class="sxs-lookup"><span data-stu-id="22f40-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) calls [**IConditionGenerator::Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) with an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) for the currently loaded schema.</span></span> <span data-ttu-id="22f40-197">Auf diese Weise kann [**iconditiongenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) alle erforderlichen Schema Informationen abrufen.</span><span class="sxs-lookup"><span data-stu-id="22f40-197">Doing so permits [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) to obtain any schema information that is required.</span></span> <span data-ttu-id="22f40-198">Beim Parsen einer Eingabe Zeichenfolge ruft **iqueryparser** die [**iconditiongenerator:: erkenzenamedentities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) -Methode jedes [**iconditiongenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator)auf, sodass das Vorkommen von benannten Entitäten, das in der Eingabe Zeichenfolge erkannt wird, gemeldet werden kann.</span><span class="sxs-lookup"><span data-stu-id="22f40-198">When parsing an input string, **IQueryParser** calls the [**IConditionGenerator::RecognizeNamedEntities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) method of each [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), so that the occurrence of named entities it recognizes in the input string can be reported.</span></span> <span data-ttu-id="22f40-199">**Iqueryparser** kann das aktuelle Gebiets Schema verwenden und sollte die Tokenisierung der Eingabe verwenden, da es die tokenspannen von benannten Entitäten melden muss.</span><span class="sxs-lookup"><span data-stu-id="22f40-199">**IQueryParser** can make use of the current locale and should make use of the tokenization of the input as it needs to report the token spans of any named entities.</span></span>

<span data-ttu-id="22f40-200">Wenn [**iqueryparser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) einen Blattknoten ausgibt und der Semantik Typ des Werts mit dem benannten Entitätstyp für einen [**iconditiongenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator)übereinstimmt, ruft **iqueryparser** [**iconditiongenerator:: generateforleaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) mit den Informationen für den zu generierenden Knoten auf.</span><span class="sxs-lookup"><span data-stu-id="22f40-200">When [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) is about to emit a leaf node, and the semantic type of the value matches the named entity type for an [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **IQueryParser** calls [**IConditionGenerator::GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) with the information for the node to be generated.</span></span> <span data-ttu-id="22f40-201">Wenn der [**iconditiongenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) S OK zurückgibt \_ , sollte er eine Bedingungs Struktur zurückgeben (bei der es sich nicht um einen Endknoten handeln muss) und **iqueryparser** darüber informieren, ob die Alternative Zeichen folgen Interpretation unterdrückt werden soll, die normalerweise als Vorsichtsmaßnahme generiert würde.</span><span class="sxs-lookup"><span data-stu-id="22f40-201">If the [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) returns S\_OK, it should return a condition tree (which does not have to be a leaf node), and inform **IQueryParser** whether to suppress the alternative string interpretation that it would normally generate as a precaution.</span></span>

### <a name="itokencollection"></a><span data-ttu-id="22f40-202">Iabkencollection</span><span class="sxs-lookup"><span data-stu-id="22f40-202">ITokenCollection</span></span>

<span data-ttu-id="22f40-203">Die [**itokencollection:: numoftokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) -Methode gibt die Anzahl der Token zurück. [**Itokencollection:: GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) gibt Informationen zum *i* Th-Token zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-203">The [**ITokenCollection::NumberOfTokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) method returns the number of tokens.[**ITokenCollection::GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) returns information about the *i* th token.</span></span> <span data-ttu-id="22f40-204">Der Anfang und die Länge sind Zeichen Positionen in der Eingabe Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="22f40-204">The beginning and length are character positions in the input string.</span></span> <span data-ttu-id="22f40-205">Der zurückgegebene Text ist nur ungleich NULL, wenn ein Text vorhanden ist, der die Zeichen aus der Eingabe Zeichenfolge überschreibt.</span><span class="sxs-lookup"><span data-stu-id="22f40-205">The returned text will be non-null only if there is a text overriding the characters from the input string.</span></span> <span data-ttu-id="22f40-206">Dies wird z. b. verwendet, um einen Bindestrich in der Eingabe Zeichenfolge zu überschreiben, und nicht, wenn sich dieser Bindestrich in einem Kontext befindet, in dem er als Negation interpretiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="22f40-206">This is used, for example, to override a dash in the input string with NOT when that dash is in a context where it should be interpreted as a negation.</span></span>

### <a name="inamedentitycollector"></a><span data-ttu-id="22f40-207">Inamedentitycollector</span><span class="sxs-lookup"><span data-stu-id="22f40-207">INamedEntityCollector</span></span>

<span data-ttu-id="22f40-208">[**Iconditiongenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) Ruft für jede erkannte benannte Entität [**inamedentitycollector:: Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) auf.</span><span class="sxs-lookup"><span data-stu-id="22f40-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) calls [**INamedEntityCollector::Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) for each named entity it recognized.</span></span> <span data-ttu-id="22f40-209">Die Spannen sind tokenspannen.</span><span class="sxs-lookup"><span data-stu-id="22f40-209">The spans are token spans.</span></span> <span data-ttu-id="22f40-210">Dies muss immer die Groß-/Kleinschreibung *sein?*</span><span class="sxs-lookup"><span data-stu-id="22f40-210">It must always be the case that *beginSpan* ?</span></span> <span data-ttu-id="22f40-211">*beginactual*  <  *endactual* ?</span><span class="sxs-lookup"><span data-stu-id="22f40-211">*beginActual* < *endActual* ?</span></span> <span data-ttu-id="22f40-212">*endspan*.</span><span class="sxs-lookup"><span data-stu-id="22f40-212">*endSpan*.</span></span> <span data-ttu-id="22f40-213">*beginspan* und *endspan* können von *beginactual* und *endactual* abweichen, wenn die benannte Entität beginnt und/oder mit semantisch unbedeutenden Token, wie z. b. Anführungszeichen, endet (die von der benannten Entität abgedeckt werden).</span><span class="sxs-lookup"><span data-stu-id="22f40-213">*beginSpan* and *endSpan* may differ from *beginActual* and *endActual* if the named entity begins and/or ends with semantically insignificant tokens such as quotation marks (that are nevertheless covered by the named entity).</span></span> <span data-ttu-id="22f40-214">Der Wert muss als Zeichenfolge ausgedrückt werden und wird anschließend in einem Aufrufen von [**iconditiongenerator:: generateforleaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf)angezeigt.</span><span class="sxs-lookup"><span data-stu-id="22f40-214">The value must be expressed as a string and will subsequently appear in a call to [**IConditionGenerator::GenerateForLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span></span>

### <a name="ischemaprovider"></a><span data-ttu-id="22f40-215">Ischemaprovider</span><span class="sxs-lookup"><span data-stu-id="22f40-215">ISchemaProvider</span></span>

<span data-ttu-id="22f40-216">Die [**ischemaprovider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) -Schnittstelle kann verwendet werden, um ein geladenes Schema nach Entitäten (Typen) und Beziehungen (Eigenschaften) zu durchsuchen.</span><span class="sxs-lookup"><span data-stu-id="22f40-216">The [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface can be used to browse a loaded schema for entities (types) and relations (properties).</span></span> <span data-ttu-id="22f40-217">Im folgenden werden die einzelnen Methoden beschrieben:</span><span class="sxs-lookup"><span data-stu-id="22f40-217">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="22f40-218">[**Entitäten**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) gibt eine Enumeration aller Entitäten ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) im Schema zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-218">[**Entities**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) returns an enumeration of every entity ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) in the schema.</span></span>
-   <span data-ttu-id="22f40-219">[**Rootentity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) gibt die Stamm Entität des Schemas zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-219">[**RootEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) returns the root entity of the schema.</span></span> <span data-ttu-id="22f40-220">Bei einem flachen Schema wird der Haupttyp jeder [**iquerysolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="22f40-220">For a flat schema, the main type of every [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) is returned.</span></span>
-   <span data-ttu-id="22f40-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) sucht eine Entität anhand des Namens und gibt S false zurück, \_ Wenn keine solche Entität im Schema vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="22f40-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) finds an entity by name and returns S\_FALSE if there is no such entity in the schema.</span></span>
-   <span data-ttu-id="22f40-222">[**Metadaten**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) gibt eine Enumeration von [**IMetadata**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) -Schnittstellen zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-222">[**MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces.</span></span>

### <a name="ientity"></a><span data-ttu-id="22f40-223">IEntity</span><span class="sxs-lookup"><span data-stu-id="22f40-223">IEntity</span></span>

<span data-ttu-id="22f40-224">Die [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) -Schnittstelle ist eine Schema Entität, die einen Typ mit einem Namen darstellt, eine Anzahl benannter Beziehungen zu anderen Typen (Eigenschaften) aufweist und von einer Basis Entität abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="22f40-224">The [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) interface is a schema entity that represents a type that has a name, has a number of named relationships to other types (properties), and derives from a base entity.</span></span> <span data-ttu-id="22f40-225">Im folgenden werden die einzelnen Methoden beschrieben:</span><span class="sxs-lookup"><span data-stu-id="22f40-225">Here's what its individual methods do:</span></span>

-   <span data-ttu-id="22f40-226">[**IEntity::**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) Relationship gibt eine Enumeration von [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) -Objekten zurück, eine für jede ausgehende Beziehung dieses Typs.</span><span class="sxs-lookup"><span data-stu-id="22f40-226">[**IEntity::Relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) returns an enumeration of [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) objects, one for each outgoing relation of this type.</span></span> <span data-ttu-id="22f40-227">Jede ausgehende Beziehung einer Entität hat einen Namen.</span><span class="sxs-lookup"><span data-stu-id="22f40-227">Each outgoing relation of an entity has a name.</span></span>
-   <span data-ttu-id="22f40-228">[**IEntity:: GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) findet eine Beziehung nach Name und gibt S false zurück, \_ Wenn keine solche Beziehung für diese Entität vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="22f40-228">[**IEntity::GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) finds a relationship by name, and returns S\_FALSE if there is no such relationship for this entity.</span></span>
-   <span data-ttu-id="22f40-229">[**IEntity:: Metadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) gibt eine Enumeration von [**IMetadata**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) -Schnittstellen zurück, eine für jedes metadatenpaar dieser Entität.</span><span class="sxs-lookup"><span data-stu-id="22f40-229">[**IEntity::MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="22f40-230">[**IEntity::D efaultphrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) gibt einen Standardausdruck zurück, um das Erstellen einer AQS-oder NQS-neuanweisung einer Bedingungs Struktur zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="22f40-230">[**IEntity::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) returns a default phrase to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="irelationship"></a><span data-ttu-id="22f40-231">IRelationship</span><span class="sxs-lookup"><span data-stu-id="22f40-231">IRelationship</span></span>

<span data-ttu-id="22f40-232">Die [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) -Schnittstelle stellt eine Beziehung zwischen zwei Entitäten dar: eine Quelle und ein Ziel.</span><span class="sxs-lookup"><span data-stu-id="22f40-232">The [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) interface represents a relationship between two entities: a source and a destination.</span></span> <span data-ttu-id="22f40-233">Im folgenden werden die einzelnen Methoden beschrieben:</span><span class="sxs-lookup"><span data-stu-id="22f40-233">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="22f40-234">[**IRelationship:: Isreal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) meldet, ob eine Beziehung Real ist.</span><span class="sxs-lookup"><span data-stu-id="22f40-234">[**IRelationship::IsReal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) reports whether a relationship is real.</span></span> <span data-ttu-id="22f40-235">Wenn z. B. Entität a von Entität B abgeleitet ist und eine Beziehung namens r von ihr erbt, hat eine möglicherweise noch eine eigene Beziehung namens r. Allerdings müssen die Beziehungen A und R den gleichen Zieltyp wie b aufweisen, und der einzige Grund dafür ist das Speichern von Metadaten, die für b spezifisch sind. Eine solche Beziehung von B ist nicht Real.</span><span class="sxs-lookup"><span data-stu-id="22f40-235">For example, if entity A derives from entity B and inherits a relationship named R from it, A may still have its own relationship named R. However, the relationship beween A and R must have the same destination type as that of B, and the only reason for it to exist is to store metadata specific to B. Such a relationship of B is said not to be real.</span></span>
-   <span data-ttu-id="22f40-236">[**IRelationship:: medadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) gibt eine Enumeration von [**IMetadata**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) -Schnittstellen zurück, eine für jedes metadatenpaar dieser Entität.</span><span class="sxs-lookup"><span data-stu-id="22f40-236">[**IRelationship::Medadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="22f40-237">[**IRelationship::D efaultphrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) gibt den für diese Beziehung in Restatements zu verwendenden Standardausdruck zurück.</span><span class="sxs-lookup"><span data-stu-id="22f40-237">[**IRelationship::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) returns the default phrase to use for this relationship in restatements.</span></span> <span data-ttu-id="22f40-238">Jede Beziehung verfügt über einen Standardausdruck, der die Erstellung einer AQS-oder NQS-neuanweisung einer Bedingungs Struktur erleichtert.</span><span class="sxs-lookup"><span data-stu-id="22f40-238">Each relationship has a default phrase that denotes it to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="imetadata"></a><span data-ttu-id="22f40-239">IMetadata</span><span class="sxs-lookup"><span data-stu-id="22f40-239">IMetaData</span></span>

<span data-ttu-id="22f40-240">Metadaten sind Schlüssel-Wert-Paare, die jeweils mit einer Entität, einer Beziehung oder dem gesamten Schema verknüpft sind.</span><span class="sxs-lookup"><span data-stu-id="22f40-240">Metadata are key-value pairs that are each associated with either an entity, a relationship, or the whole schema.</span></span> <span data-ttu-id="22f40-241">Da Schlüssel nicht notwendigerweise eindeutig sind, kann eine Auflistung von Metadaten als mehrfach Zuordnung betrachtet werden.</span><span class="sxs-lookup"><span data-stu-id="22f40-241">Because keys are not necessarily unique, a collection of metadata can be thought of as a multi-map.</span></span> <span data-ttu-id="22f40-242">[**IMetadata:: GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) wird aufgerufen, um den Schlüssel und den Wert für ein metatdatenpaar abzurufen.</span><span class="sxs-lookup"><span data-stu-id="22f40-242">[**IMetaData::GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) is called to retrieve the key and value for a metatdata pair.</span></span>

## <a name="querying-scenarios"></a><span data-ttu-id="22f40-243">Abfragen von Szenarien</span><span class="sxs-lookup"><span data-stu-id="22f40-243">Querying Scenarios</span></span>

<span data-ttu-id="22f40-244">In den folgenden Szenarien wird die Verwendung von strukturierten Abfrage-APIs in Windows Search in allgemeinen Abfrage Szenarios beschrieben, wie z. b. das Erstellen einer Bedingungs Struktur und das Abfragen des Indexes.</span><span class="sxs-lookup"><span data-stu-id="22f40-244">The following scenarios describe the use of structured query APIs in Windows Search in common querying scenarios, such as creating a condition tree and querying the index.</span></span>

### <a name="condition-extraction-and-query-parsing"></a><span data-ttu-id="22f40-245">Bedingungs Extraktion und Abfrage Verarbeitung</span><span class="sxs-lookup"><span data-stu-id="22f40-245">Condition Extraction and Query Parsing</span></span>

<span data-ttu-id="22f40-246">Wenn eine Abfrage erstellt wird, wird der zugehörige Bereich definiert, indem dem System mitgeteilt wird, wo gesucht werden soll.</span><span class="sxs-lookup"><span data-stu-id="22f40-246">When a query is created, its scope is defined by telling the system where to search.</span></span> <span data-ttu-id="22f40-247">Dadurch werden die Suchergebnisse eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="22f40-247">This restricts the search results.</span></span> <span data-ttu-id="22f40-248">Nachdem der Bereich definiert wurde, wird ein Filter angewendet, und es wird ein Filtersatz zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="22f40-248">After the scope is defined, a filter is applied, and a filter set is returned.</span></span> <span data-ttu-id="22f40-249">Die Suchergebnisse werden durch das Entwickeln einer Bedingungs Struktur mit Blattknoten, ähnlich einem Diagramm, eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="22f40-249">Search results are restricted by building a condition tree with leaf nodes, similar to a graph.</span></span> <span data-ttu-id="22f40-250">Diese Bedingungen werden dann extrahiert.</span><span class="sxs-lookup"><span data-stu-id="22f40-250">Those conditions are then extracted.</span></span> <span data-ttu-id="22f40-251">Eine Bedingungs Struktur ist eine boolesche Kombination (and, or, not) der Blatt Bedingungen, von denen jede eine Eigenschaft über einen Vorgang mit einem Wert verknüpft.</span><span class="sxs-lookup"><span data-stu-id="22f40-251">A condition tree is a Boolean combination (AND, OR, NOT) of leaf conditions, each of which relates a property, through an operation, to a value.</span></span> <span data-ttu-id="22f40-252">Ein Blattknoten stellt eine Einschränkung für eine einzelne Eigenschaft zu einem Wert durch einige Vorgänge dar.</span><span class="sxs-lookup"><span data-stu-id="22f40-252">A leaf node represents a restriction on a single property to a value through some operations.</span></span>

<span data-ttu-id="22f40-253">Eine Filter Einschränkung erfordert einen logischen Ausdruck, der die Einschränkung beschreibt.</span><span class="sxs-lookup"><span data-stu-id="22f40-253">A filter restriction requires a logical expression that describes the restriction.</span></span> <span data-ttu-id="22f40-254">Die Definition dieses Ausdrucks beginnt mit der [**icondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) -Schnittstelle, die verwendet wird, um einen einzelnen Knoten in einer Bedingungs Struktur zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="22f40-254">Defining this expression starts with the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface, which is used to create a single node in a condition tree.</span></span> <span data-ttu-id="22f40-255">Da im folgenden Beispiel nur eine Bedingung vorhanden ist, ändert sich die Struktur nicht.</span><span class="sxs-lookup"><span data-stu-id="22f40-255">Because there is only one condition in the following example, the tree does not change.</span></span>


```C++
    
    [
        object,
        uuid(0FC988D4-C935-4b97-A973-46282EA175C8),
        pointer_default(unique)
    ]
    interface ICondition : IPersistStream
    {
        HRESULT GetConditionType([out, retval] CONDITION_TYPE* pNodeType);
        HRESULT GetSubConditions([in] REFIID riid, [out, retval, iid_is(riid)] void** ppv);
        [local] HRESULT GetComparisonInfo([out, annotation("__deref_opt_out")] LPWSTR *ppszPropertyName, [out, annotation("__out_opt")] CONDITION_OPERATION *pOperation, [out, annotation("__out_opt")] PROPVARIANT *pValue);
        HRESULT GetValueType([out, retval] LPWSTR* ppszValueTypeName);
        HRESULT GetValueNormalization([out, retval] LPWSTR* ppszNormalization);
        [local] HRESULT GetInputTerms([out, annotation("__out_opt")] IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] IRichChunk** ppValueTerm);
        HRESULT Clone([out, retval] ICondition** ppc);
    };


```



<span data-ttu-id="22f40-256">Wenn mehrere Filterbedingungen vorhanden sind, werden und und andere boolesche Operatoren verwendet, um eine einzelne Struktur zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="22f40-256">If there is more than one filter condition, then AND and other Boolean operators are used to achieve a single tree.</span></span> <span data-ttu-id="22f40-257">-Strukturen und-Strukturen und-Strukturen stellen Zusammenhänge und Disjunktionen ihrer Teil Strukturen dar.</span><span class="sxs-lookup"><span data-stu-id="22f40-257">AND-trees and OR-trees represent conjunctions and disjunctions of their subtrees.</span></span> <span data-ttu-id="22f40-258">Eine not-Tree-Struktur stellt die Negation der einzelnen Unterstruktur dar.</span><span class="sxs-lookup"><span data-stu-id="22f40-258">A NOT-tree represents the negation of its single subtree.</span></span> <span data-ttu-id="22f40-259">AQS bietet einen Text Ansatz, mit dem logische Ausdrücke mit booleschen Operatoren erreicht werden können. Dies ist häufig einfacher.</span><span class="sxs-lookup"><span data-stu-id="22f40-259">AQS provides a text approach to achieving logical expressions with Boolean operators, and is often simpler.</span></span>

<span data-ttu-id="22f40-260">Im nächsten Beispiel wird die Bedingungs Struktur ([**icondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) in das visuelle Formular konvertiert.</span><span class="sxs-lookup"><span data-stu-id="22f40-260">In the next example we convert the condition tree ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) into visual form.</span></span> <span data-ttu-id="22f40-261">Der Abfrage Parser konvertiert mithilfe der [**iqueryparser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) -Schnittstelle die [**icondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) in eine RTF-Abfrage Zeichenfolge (Rich Text formatiert).</span><span class="sxs-lookup"><span data-stu-id="22f40-261">The query parser, using the [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) interface, converts the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) into a rich text formatted (RTF) query string.</span></span> <span data-ttu-id="22f40-262">Die [**iqueryparser:: restateto String**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) -Methode gibt den Abfragetext zurück, während die [**iqueryparser::P Arse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) -Methode eine [**iquerysolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) -Schnittstelle erzeugt.</span><span class="sxs-lookup"><span data-stu-id="22f40-262">The [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) method returns the query text, while the [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method produces an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface.</span></span> <span data-ttu-id="22f40-263">Das folgende Beispiel zeigt, wie Sie das tun.</span><span class="sxs-lookup"><span data-stu-id="22f40-263">The following example shows how to do all that.</span></span>


```C++
    [
        object,
        uuid(2EBDEE67-3505-43f8-9946-EA44ABC8E5B0),
        pointer_default(unique)
    ]
    interface IQueryParser : IUnknown
    {
        HRESULT Parse([in] LPCWSTR pszInputString, [in] IEnumUnknown* pCustomProperties, [out, retval] IQuerySolution** ppSolution);
        HRESULT SetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [out, retval] PROPVARIANT* pOptionValue);
        HRESULT SetMultiOption([in] STRUCTURED_QUERY_MULTIOPTION option, [in] LPCWSTR pszOptionKey, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetSchemaProvider([out, retval] ISchemaProvider** ppSchemaProvider);
        HRESULT RestateToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszQueryString);
        HRESULT ParsePropertyValue([in] LPCWSTR pszPropertyName, [in] LPCWSTR pszInputString, [out, retval] IQuerySolution** ppSolution);
        HRESULT RestatePropertyValueToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszPropertyName, [out] LPWSTR* ppszQueryString);
    };

```



<span data-ttu-id="22f40-264">Die Haupt Eingabe von [**iqueryparser::P Arse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) ist eine Benutzereingabe Zeichenfolge, die analysiert werden soll, aber die Anwendung kann den Abfrage Parser auch über alle Eigenschaften informieren, die er in der Eingabe erkannt hat (von anwendungsspezifischer Syntax).</span><span class="sxs-lookup"><span data-stu-id="22f40-264">The main input of [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) is a user input string to be parsed, but the application can also inform the query parser of any properties it has recognized in the input (from application-specific syntax).</span></span> <span data-ttu-id="22f40-265">Die Ausgabe von **iqueryparser::P Arse** ist eine [**iquerysolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), die alle Informationen zu diesem analysieren-Aufruf bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="22f40-265">The output of **IQueryParser::Parse** is an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), which provides all information pertaining to that parse invocation.</span></span> <span data-ttu-id="22f40-266">Es gibt Methoden zum Abrufen der Eingabe Zeichenfolge, zur Tokenisierung der Eingabe Zeichenfolge, zu Analyse Fehlern und der analysierten Abfrage als Bedingungs Struktur, die durch eine [**icondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)dargestellt wird.</span><span class="sxs-lookup"><span data-stu-id="22f40-266">There are methods for obtaining the input string, how the input string was tokenized, any parse errors, and the parsed query as condition tree, represented by an [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span></span> <span data-ttu-id="22f40-267">Das folgende Beispiel zeigt...</span><span class="sxs-lookup"><span data-stu-id="22f40-267">The following example shows ...</span></span>


```C++
    [
        object,
        uuid(D6EBC66B-8921-4193-AFDD-A1789FB7FF57),
        pointer_default(unique)
    ]
    interface IQuerySolution : IConditionFactory
    {
        [local] HRESULT GetQuery([out, annotation("__out_opt")] ICondition** ppQueryNode, [out, annotation("__out_opt")] IEntity** ppMainType);
        HRESULT GetErrors([in] REFIID riid, [out, retval, iid_is(riid)] void** ppParseErrors);
        [local] HRESULT GetLexicalData([out, annotation("__deref_opt_out")] LPWSTR* ppszInputString, [out, annotation("__out_opt")] ITokenCollection** ppTokens, [out, annotation("__out_opt")] LCID* pLocale, [out, annotation("__out_opt")] IUnknown** ppWordBreaker);
    }    

    

```



<span data-ttu-id="22f40-268">Im vorherigen Beispiel konnte [**iquerysolution:: GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) alle Informationen über die Abfrage abrufen, einschließlich des ursprünglichen Texts, der Token, die den Text umfassen, oder der Bedingungs Struktur.</span><span class="sxs-lookup"><span data-stu-id="22f40-268">In the previous example, [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) could obtain any information about the query including the original text, tokens that comprise the text, or the condition tree.</span></span> <span data-ttu-id="22f40-269">Beispiele für mögliche zurückgegebene Abfrage Werte sind in der folgenden Tabelle aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="22f40-269">Examples of possible returned query values are listed in the following table.</span></span>



| <span data-ttu-id="22f40-270">Beispiele für zurückgegebene Abfrage Werte</span><span class="sxs-lookup"><span data-stu-id="22f40-270">Examples of returned query values</span></span>                        | <span data-ttu-id="22f40-271">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="22f40-271">Description</span></span>                                                                                               |
|----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
| `  author:relja OR author:tyler`                         | <span data-ttu-id="22f40-272">Der Abfragetext, den [**iqueryparser:: restateto String**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="22f40-272">The query text that [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) returns</span></span> |
| `?author?, ?:?, ?relja?, ?OR?, ?author?, ?:?, ?tyler?`   | <span data-ttu-id="22f40-273">Die Unterbrechung von Token</span><span class="sxs-lookup"><span data-stu-id="22f40-273">The break-down of tokens</span></span>                                                                                  |
| ![eine nicht aufgelöste Bedingungs Struktur](images/queryvalues1.png) | <span data-ttu-id="22f40-275">Eine nicht aufgelöste Bedingungs Struktur</span><span class="sxs-lookup"><span data-stu-id="22f40-275">An unresolved condition tree</span></span>                                                                              |



 

<span data-ttu-id="22f40-276">Die ursprüngliche Bedingungs Struktur, die zurückgegeben wird, ist nicht aufgelöst.</span><span class="sxs-lookup"><span data-stu-id="22f40-276">The initial condition tree that is returned is unresolved.</span></span> <span data-ttu-id="22f40-277">In einer nicht aufgelösten Bedingungs Struktur werden Datums-und Uhrzeit Verweise, wie z `date:yesterday` . b., nicht in die absolute Zeit konvertiert.</span><span class="sxs-lookup"><span data-stu-id="22f40-277">In an unresolved condition tree, date and time references, such as `date:yesterday`, are not converted to absolute time.</span></span> <span data-ttu-id="22f40-278">Außerdem werden virtuelle Eigenschaften nicht erweitert.</span><span class="sxs-lookup"><span data-stu-id="22f40-278">Also, virtual properties are not expanded.</span></span> <span data-ttu-id="22f40-279">Virtuelle Eigenschaften sind Eigenschaften, die als Aggregate mehrerer Eigenschaften fungieren.</span><span class="sxs-lookup"><span data-stu-id="22f40-279">Virtual properties are properties that act as aggregates of multiple properties.</span></span>

<span data-ttu-id="22f40-280">Die Abfrage `kind:email from:reljai` erzeugt z. b. die folgenden nicht aufgelösten und aufgelösten Bedingungs Strukturen.</span><span class="sxs-lookup"><span data-stu-id="22f40-280">For example, the query `kind:email from:reljai` produces the following unresolved and resolved condition trees.</span></span> <span data-ttu-id="22f40-281">Die nicht aufgelöste Bedingungs Struktur befindet sich auf der linken Seite, und die aufgelöste Bedingungs Struktur befindet sich auf der rechten Seite.</span><span class="sxs-lookup"><span data-stu-id="22f40-281">The unresolved condition tree is to the left, and the resolved condition tree is to the right.</span></span>

![nicht aufgelöste und aufgelöste Bedingungs Strukturen](images/conditiontree.png)

<span data-ttu-id="22f40-283">Die aufgelöste Struktur kann durch Aufrufen von [**iconditionfactory:: Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve)abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="22f40-283">The resolved tree can be obtained by calling [**IConditionFactory::Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span></span> <span data-ttu-id="22f40-284">Durch die Übergabe von [**sqro nicht \_ Auflösen von \_ \_ DateTime**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) bleiben jedoch das Datum und die Uhrzeit nicht aufgelöst.</span><span class="sxs-lookup"><span data-stu-id="22f40-284">However, passing [**SQRO\_DONT\_RESOLVE\_DATETIME**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) leaves the date and time unresolved.</span></span> <span data-ttu-id="22f40-285">Eine nicht aufgelöste Bedingungs Struktur hat Vorteile, da eine nicht aufgelöste Bedingungs Strukturinformationen zur Abfrage enthält.</span><span class="sxs-lookup"><span data-stu-id="22f40-285">There are advantages to an unresolved condition tree, because an unresolved condition tree contains information about the query.</span></span> <span data-ttu-id="22f40-286">Jeder Blattknoten verweist auf die von [**iquerysolution:: getlexicaldata**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata)zurückgegebenen Token, die der-Eigenschaft, dem-Operator und dem-Wert entsprechen, wenn die [**irichchunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) -Schnittstelle verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="22f40-286">Each leaf node points to the tokens returned by [**IQuerySolution::GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), which correspond to the property, operator, and value when using the [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) interface.</span></span> <span data-ttu-id="22f40-287">Das folgende Beispiel zeigt...</span><span class="sxs-lookup"><span data-stu-id="22f40-287">The following example shows ...</span></span>


```C++
    interface ITokenCollection : IUnknown
    {
        HRESULT NumberOfTokens(ULONG* pCount);
        HRESULT GetToken([in] ULONG i, [out, annotation("__out_opt")] ULONG* pBegin, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz);
    };

ICondition:: GetInputTerms([out, annotation("__out_opt")] 
IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] 
IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] 
IRichChunk** ppValueTerm);

    interface IRichChunk : IUnknown
    {
        HRESULT GetData([out, annotation("__out_opt")] ULONG* pFirstPos, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz, [out, annotation("__out_opt")] PROPVARIANT* pValue);
    }
```



### <a name="querying-the-index"></a><span data-ttu-id="22f40-288">Abfragen des Indexes</span><span class="sxs-lookup"><span data-stu-id="22f40-288">Querying the Index</span></span>

<span data-ttu-id="22f40-289">Es gibt mehrere Ansätze zum Abfragen des Indexes.</span><span class="sxs-lookup"><span data-stu-id="22f40-289">There are several approaches to querying the index.</span></span> <span data-ttu-id="22f40-290">Einige basieren auf SQL, und andere basieren auf AQS.</span><span class="sxs-lookup"><span data-stu-id="22f40-290">Some are based on the SQL and others are based on AQS.</span></span> <span data-ttu-id="22f40-291">Mithilfe von Abfrage [Schnittstellen](./-search-querying-interfaces-entry-page.md)können Sie den Windows-Suchindex auch Programm gesteuert Abfragen.</span><span class="sxs-lookup"><span data-stu-id="22f40-291">You can also query the Windows Search index programmatically by using [querying interfaces](./-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="22f40-292">Es gibt drei Schnittstellen, die für das Abfragen des Indexes spezifisch sind: [**isearchqueryhelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**irowsetprioritisierung**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization)und [**irowsetevents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span><span class="sxs-lookup"><span data-stu-id="22f40-292">There are three interfaces that are specific to querying the index: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization), and [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span></span> <span data-ttu-id="22f40-293">Konzeptionelle Informationen finden Sie unter [Programm gesteuertes Abfragen des Indexes](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="22f40-293">For conceptual information, see [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

<span data-ttu-id="22f40-294">Sie können eine Komponente oder Hilfsklasse entwickeln, um den Index mithilfe der [**isearchqueryhelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) -Schnittstelle abzufragen.</span><span class="sxs-lookup"><span data-stu-id="22f40-294">You can develop a component or helper class to query the index by using the [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) interface.</span></span> <span data-ttu-id="22f40-295">Diese Schnittstelle wird als Hilfsklasse in [**isearchcatalogmanager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (und [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)) implementiert und durch Aufrufen von [**isearchcatalogmanager:: getqueryhelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper)abgerufen.</span><span class="sxs-lookup"><span data-stu-id="22f40-295">This interface is implemented as a helper class to [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (and [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)), and is obtained by calling [**ISearchCatalogManager::GetQueryHelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span></span> <span data-ttu-id="22f40-296">Konzeptionelle Informationen finden Sie unter [Abfragen des Indexes mit isearchqueryhelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span><span class="sxs-lookup"><span data-stu-id="22f40-296">For conceptual information, see [Querying the Index with ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span></span>

<span data-ttu-id="22f40-297">[**Isearchqueryhelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) ermöglicht Folgendes:</span><span class="sxs-lookup"><span data-stu-id="22f40-297">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) permits you to:</span></span>

-   <span data-ttu-id="22f40-298">Rufen Sie eine OLE DB Verbindungs Zeichenfolge für die Verbindung mit der Windows Search-Datenbank ab.</span><span class="sxs-lookup"><span data-stu-id="22f40-298">Obtain an OLE DB connection string to connect to the Windows Search database.</span></span>
-   <span data-ttu-id="22f40-299">Konvertieren Sie AQS-Benutzer Abfragen in Windows Search SQL.</span><span class="sxs-lookup"><span data-stu-id="22f40-299">Convert AQS user queries to Windows Search SQL.</span></span>
-   <span data-ttu-id="22f40-300">Geben Sie Abfrage Einschränkungen an, die in SQL ausgedrückt werden können, aber nicht in AQS.</span><span class="sxs-lookup"><span data-stu-id="22f40-300">Specify query restrictions that can be expressed in SQL but not in AQS.</span></span>

<span data-ttu-id="22f40-301">Indizierungs Priorisierung und rowsetereignisse werden in Windows 7 und höher unterstützt.</span><span class="sxs-lookup"><span data-stu-id="22f40-301">Indexing prioritization and rowset events are supported in Windows 7 and later.</span></span> <span data-ttu-id="22f40-302">Bei [**irowsetpriorisierung**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) gibt es einen Prioritäts Stapel, der es dem Client ermöglicht, anzufordern, dass die in einer bestimmten Abfrage verwendeten Bereiche höher als normale Priorität sind.</span><span class="sxs-lookup"><span data-stu-id="22f40-302">With [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) there is a priority stack that enables the client to request that the scopes used in a particular query be given higher than normal priority.</span></span> <span data-ttu-id="22f40-303">[**Irowsetevents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) ermöglicht das Benachrichtigen von Änderungen an Elementen in Rowsets, einschließlich der Addition neuer Elemente, dem Löschen von Elementen und der Änderung von Elementdaten.</span><span class="sxs-lookup"><span data-stu-id="22f40-303">[**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) provides notification of changes to items in rowsets, including the addition of new items, the deletion of items, and the modification of item data.</span></span> <span data-ttu-id="22f40-304">Durch die Verwendung von Rowset-Ereignis Benachrichtigungen wird sichergestellt, dass die Ergebnisse für vorhandene Abfragen so aktuell wie möglich sind.</span><span class="sxs-lookup"><span data-stu-id="22f40-304">Using rowset event notifications ensures that the results for existing queries are as up to date as possible.</span></span> <span data-ttu-id="22f40-305">Konzeptionelle Informationen finden Sie unter [Indizieren von Priorisierung und rowsetereignissen in Windows 7](indexing-prioritization-and-rowset-events.md).</span><span class="sxs-lookup"><span data-stu-id="22f40-305">For conceptual information, see [Indexing Prioritization and Rowset Events in Windows 7](indexing-prioritization-and-rowset-events.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="22f40-306">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="22f40-306">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="22f40-307">Indizierung, Abfragen und Benachrichtigungen in Windows Search</span><span class="sxs-lookup"><span data-stu-id="22f40-307">Indexing, Querying and Notifications in Windows Search</span></span>](-search-3x-wds-included-in-index.md)
</dt> <dt>

[<span data-ttu-id="22f40-308">Was ist im Index enthalten?</span><span class="sxs-lookup"><span data-stu-id="22f40-308">What is Included in the Index</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="22f40-309">Indizierungsprozess in Windows Search</span><span class="sxs-lookup"><span data-stu-id="22f40-309">Indexing Process in Windows Search</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="22f40-310">Benachrichtigungs Prozess in Windows Search</span><span class="sxs-lookup"><span data-stu-id="22f40-310">Notifications Process in Windows Search</span></span>](-search-3x-wds-support.md)
</dt> <dt>

[<span data-ttu-id="22f40-311">URL-Formatierungs Anforderungen</span><span class="sxs-lookup"><span data-stu-id="22f40-311">URL Formatting Requirements</span></span>](url-formatting-requirements.md)
</dt> </dl>

 

 
