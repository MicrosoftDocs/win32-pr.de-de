---
description: Abfrageprozess in Windows Search
ms.assetid: 0e5a633e-1703-4b72-8a04-6da71aec0ae2
title: Abfrageprozess in Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d3585f2cca2a6d5d8548a85ae8fac759ec94b4fa
ms.sourcegitcommit: 95685061d5b0333bbf9e6ebd208dde8190f97005
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2021
ms.locfileid: "108117328"
---
# <a name="querying-process-in-windows-search"></a><span data-ttu-id="bd02b-103">Abfrageprozess in Windows Search</span><span class="sxs-lookup"><span data-stu-id="bd02b-103">Querying Process in Windows Search</span></span>

<span data-ttu-id="bd02b-104">Dieses Thema ist wie folgt organisiert:</span><span class="sxs-lookup"><span data-stu-id="bd02b-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="bd02b-105">Informationen zum Abfragen in Windows Search</span><span class="sxs-lookup"><span data-stu-id="bd02b-105">About Querying in Windows Search</span></span>](#about-querying-in-windows-search)
    -   [<span data-ttu-id="bd02b-106">Lokale und Remoteabfragen</span><span class="sxs-lookup"><span data-stu-id="bd02b-106">Local and Remote Queries</span></span>](#local-and-remote-queries)
    -   [<span data-ttu-id="bd02b-107">Übersicht über die API für strukturierte Abfragen</span><span class="sxs-lookup"><span data-stu-id="bd02b-107">Structured Query API Overview</span></span>](#structured-query-api-overview)
-   [<span data-ttu-id="bd02b-108">Abfrageszenarien</span><span class="sxs-lookup"><span data-stu-id="bd02b-108">Querying Scenarios</span></span>](#querying-scenarios)
    -   [<span data-ttu-id="bd02b-109">Bedingungsextraktion und Abfrageparsing</span><span class="sxs-lookup"><span data-stu-id="bd02b-109">Condition Extraction and Query Parsing</span></span>](#condition-extraction-and-query-parsing)
    -   [<span data-ttu-id="bd02b-110">Abfragen des Index</span><span class="sxs-lookup"><span data-stu-id="bd02b-110">Querying the Index</span></span>](#querying-the-index)
-   [<span data-ttu-id="bd02b-111">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="bd02b-111">Related topics</span></span>](#related-topics)

## <a name="about-querying-in-windows-search"></a><span data-ttu-id="bd02b-112">Informationen zum Abfragen in Windows Search</span><span class="sxs-lookup"><span data-stu-id="bd02b-112">About Querying in Windows Search</span></span>

<span data-ttu-id="bd02b-113">Abfragen in Windows Search basieren auf den folgenden vier Ansätzen:</span><span class="sxs-lookup"><span data-stu-id="bd02b-113">Querying in Windows Search is based on the following four approaches:</span></span>

-   <span data-ttu-id="bd02b-114">[Erweiterte Abfragesyntax](-search-3x-advancedquerysyntax.md) (AQS)</span><span class="sxs-lookup"><span data-stu-id="bd02b-114">[Advanced Query Syntax](-search-3x-advancedquerysyntax.md) (AQS)</span></span>
-   <span data-ttu-id="bd02b-115">Syntax natürlicher Abfragen (Natural Query Syntax, NQS)</span><span class="sxs-lookup"><span data-stu-id="bd02b-115">Natural Query Syntax (NQS)</span></span>
-   <span data-ttu-id="bd02b-116">Structured Query Language (SQL) (Structured Query Language, SQL)</span><span class="sxs-lookup"><span data-stu-id="bd02b-116">Structured Query Language (SQL)</span></span>
-   <span data-ttu-id="bd02b-117">Strukturierte Abfrageschnittstellen</span><span class="sxs-lookup"><span data-stu-id="bd02b-117">Structured query interfaces</span></span>

<span data-ttu-id="bd02b-118">AQS ist die Standardabfragesyntax, die von Windows Search zum Abfragen des Indexes und zum Verfeinern und Einengen von Suchparametern verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="bd02b-118">AQS is the default query syntax used by Windows Search to query the index and to refine and narrow search parameters.</span></span> <span data-ttu-id="bd02b-119">AQS steht hauptsächlich für Benutzer zur Verfügung und kann von Benutzern zum Erstellen von AQS-Abfragen verwendet werden, kann aber auch von Entwicklern verwendet werden, um Abfragen programmgesteuert zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-119">AQS is primarily user facing, and can be used by users to build AQS queries, but can also be used by developers to build queries programmatically.</span></span> <span data-ttu-id="bd02b-120">In Windows 7 wurde kanonische AQS eingeführt und muss zum programmgesteuerten Generieren von AQS-Abfragen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="bd02b-120">In Windows 7, canonical AQS was introduced and must be used to programmatically generate AQS queries.</span></span> <span data-ttu-id="bd02b-121">Unter Windows 7 und höher kann eine Kontextmenüoption verfügbar sein, je nach Erfüllt einer AQS-Bedingung.</span><span class="sxs-lookup"><span data-stu-id="bd02b-121">In Windows 7 and later, a shortcut menu option can be available based on whether an AQS condition is met.</span></span> <span data-ttu-id="bd02b-122">Weitere Informationen finden Sie unter "Getting Dynamic Behavior for Static Verbs by Using Advanced Query Syntax" (Abrufen des dynamischen Verhaltens für statische Verben mit erweiterter Abfragesyntax) in [Erstellen von Kontextmenühandlern.](../shell/context-menu-handlers.md)</span><span class="sxs-lookup"><span data-stu-id="bd02b-122">For more information, see "Getting Dynamic Behavior for Static Verbs by Using Advanced Query Syntax" in [Creating Context Menu Handlers](../shell/context-menu-handlers.md).</span></span> <span data-ttu-id="bd02b-123">AQS-Abfragen können auf bestimmte Dateitypen beschränkt werden, die als Dateiarten bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="bd02b-123">AQS queries can be limited to specific types of files, which are known as file kinds.</span></span> <span data-ttu-id="bd02b-124">Weitere Informationen finden Sie unter [Dateitypen und Zuordnungen.](../shell/fa-intro.md)</span><span class="sxs-lookup"><span data-stu-id="bd02b-124">For more information, see [File Types and Associations](../shell/fa-intro.md).</span></span> <span data-ttu-id="bd02b-125">Eine Referenzdokumentation zu den relevanten Eigenschaften finden Sie unter [System.Kind](../properties/props-system-kind.md)und [System.KindText](../properties/props-system-kindtext.md).</span><span class="sxs-lookup"><span data-stu-id="bd02b-125">For reference documentation on the relevant properties, see [System.Kind](../properties/props-system-kind.md), and [System.KindText](../properties/props-system-kindtext.md).</span></span>

<span data-ttu-id="bd02b-126">NQS ist eine Abfragesyntax, die gelockerter als AQS ist und der menschlichen Sprache ähnelt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-126">NQS is a query syntax that is more relaxed than AQS, and is similar to human language.</span></span> <span data-ttu-id="bd02b-127">NQS kann von Windows Search Indexabfrage verwendet werden, wenn NQS anstelle der Standardeinstellung AQS ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="bd02b-127">NQS can be used by Windows Search to query the index if NQS is selected instead of the default, AQS.</span></span>

<span data-ttu-id="bd02b-128">SQL ist eine Textsprache, die Abfragen definiert.</span><span class="sxs-lookup"><span data-stu-id="bd02b-128">SQL is a text language that defines queries.</span></span> <span data-ttu-id="bd02b-129">SQL ist in vielen verschiedenen Datenbanktechnologien üblich.</span><span class="sxs-lookup"><span data-stu-id="bd02b-129">SQL is common across many different database technologies.</span></span> <span data-ttu-id="bd02b-130">Windows Search SQL verwendet, implementiert eine Teilmenge davon und erweitert sie durch Hinzufügen von Elementen zur Sprache.</span><span class="sxs-lookup"><span data-stu-id="bd02b-130">Windows Search uses SQL, implements a subset of it, and extends it by adding elements to the language.</span></span> <span data-ttu-id="bd02b-131">Windows Search SQL erweitert die Standardmäßige Sql-92- und SQL-99-Datenbankabfragesyntax, um ihre Nützlichkeit mit textbasierten Suchvorgängen zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="bd02b-131">Windows Search SQL extends the standard SQL-92 and SQL-99 database query syntax to enhance its usefulness with text-based searches.</span></span> <span data-ttu-id="bd02b-132">Alle Features von Windows Search SQL sind mit Windows Search unter Windows XP und Windows Server 2003 und höher kompatibel.</span><span class="sxs-lookup"><span data-stu-id="bd02b-132">All features of Windows Search SQL are compatible with Windows Search on Windows XP and Windows Server 2003, and later.</span></span> <span data-ttu-id="bd02b-133">Weitere Informationen zu Windows Search SQL finden Sie unter [Querying the Index with Windows Search SQL Syntax](-search-sql-windowssearch-entry.md)und Overview of Windows Search SQL [Syntax](-search-sql-ovwofsearchquery.md).</span><span class="sxs-lookup"><span data-stu-id="bd02b-133">For more information about Windows Search SQL, see [Querying the Index with Windows Search SQL Syntax](-search-sql-windowssearch-entry.md), and [Overview of Windows Search SQL Syntax](-search-sql-ovwofsearchquery.md).</span></span>

<span data-ttu-id="bd02b-134">Die strukturierten Abfrage-APIs werden weiter unten in diesem Thema beschrieben.</span><span class="sxs-lookup"><span data-stu-id="bd02b-134">The structured query APIs are described later in this topic.</span></span> <span data-ttu-id="bd02b-135">Eine Referenzdokumentation zu den strukturierten Abfrage-APIs finden Sie unter [Abfragen von Schnittstellen.](-search-querying-interfaces-entry-page.md)</span><span class="sxs-lookup"><span data-stu-id="bd02b-135">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="bd02b-136">Schnittstellen wie [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) helfen beim Erstellen von SQL-Zeichenfolgen aus einem Satz von Eingabewerten.</span><span class="sxs-lookup"><span data-stu-id="bd02b-136">Interfaces such as [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) help construct SQL strings from a set of input values.</span></span> <span data-ttu-id="bd02b-137">Diese Schnittstelle konvertiert AQS-Benutzerabfragen in Windows Search SQL und gibt Abfrageeinschränkungen an, die in SQL, aber nicht in AQS ausgedrückt werden können.</span><span class="sxs-lookup"><span data-stu-id="bd02b-137">This interface converts AQS user queries to Windows Search SQL and specifies query restrictions that can be expressed in SQL but not in AQS.</span></span> <span data-ttu-id="bd02b-138">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) erhält auch eine OLE DB Verbindungszeichenfolge, um eine Verbindung mit der Windows Search herzustellen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-138">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) also obtains an OLE DB connection string to connect to the Windows Search database.</span></span>

### <a name="local-and-remote-queries"></a><span data-ttu-id="bd02b-139">Lokale und Remoteabfragen</span><span class="sxs-lookup"><span data-stu-id="bd02b-139">Local and Remote Queries</span></span>

<span data-ttu-id="bd02b-140">Sie können Ihre Abfragen entweder lokal oder remote ausführen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-140">You can execute your queries either locally or remotely.</span></span> <span data-ttu-id="bd02b-141">Eine lokale Abfrage, die die [FROM-Klausel verwendet,](-search-sql-from.md) wird im folgenden Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-141">A local query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="bd02b-142">Eine lokale Abfrage fragt nur den lokalen SystemIndex-Katalog ab.</span><span class="sxs-lookup"><span data-stu-id="bd02b-142">A local query queries the local SystemIndex catalog only.</span></span>


```
FROM SystemIndex
```



<span data-ttu-id="bd02b-143">Eine Remoteabfrage mithilfe der [FROM-Klausel](-search-sql-from.md) wird im folgenden Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-143">A remote query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="bd02b-144">Durch hinzufügen von ComputerName wird das vorherige Beispiel in eine Remoteabfrage transformiert.</span><span class="sxs-lookup"><span data-stu-id="bd02b-144">Adding ComputerName transforms the previous example into a remote query.</span></span>


```
FROM [<ComputerName>.]SystemIndex
```



<span data-ttu-id="bd02b-145">Standardmäßig ist für Windows XP und Windows Server 2003 Windows Search nicht installiert.</span><span class="sxs-lookup"><span data-stu-id="bd02b-145">By default, Windows XP and Windows Server 2003 do not have Windows Search installed.</span></span> <span data-ttu-id="bd02b-146">Nur Windows Search 4 (WS4) bietet Remoteabfrageunterstützung.</span><span class="sxs-lookup"><span data-stu-id="bd02b-146">Only Windows Search 4 (WS4) provides remote query support.</span></span> <span data-ttu-id="bd02b-147">Frühere Versionen von Windows Desktop Search (WDS), z.B. 3.01 und früher, unterstützen keine Remoteabfragen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-147">Previous versions of Windows Desktop Search (WDS), such as 3.01 and earlier, do not support remote querying.</span></span> <span data-ttu-id="bd02b-148">Mit Windows-Explorer können Sie den lokalen Index eines Remotecomputers nach Dateisystemelementen abfragen (Elemente, die vom Protokoll "file:" verarbeitet werden).</span><span class="sxs-lookup"><span data-stu-id="bd02b-148">With Windows Explorer you can query the local index of a remote computer for file system items (items handled by the "file:" protocol).</span></span>

<span data-ttu-id="bd02b-149">Um ein Element per Remoteabfrage abzurufen, muss das Element die folgenden Anforderungen erfüllen:</span><span class="sxs-lookup"><span data-stu-id="bd02b-149">To retrieve an item by remote query, the item must meet the following requirements:</span></span>

-   <span data-ttu-id="bd02b-150">Der Zugriff ist über Universal Naming Convention (UNC)-Pfad möglich.</span><span class="sxs-lookup"><span data-stu-id="bd02b-150">Be accessible via Universal Naming Convention (UNC) path.</span></span>
-   <span data-ttu-id="bd02b-151">Auf dem Remotecomputer vorhanden, auf den der Client Zugriff hat.</span><span class="sxs-lookup"><span data-stu-id="bd02b-151">Exist on the remote computer to which the client has access.</span></span>
-   <span data-ttu-id="bd02b-152">Lassen Sie die Sicherheit so festgelegt, dass der Client Lesezugriff hat.</span><span class="sxs-lookup"><span data-stu-id="bd02b-152">Have its security set to allow the client to have Read access.</span></span>

<span data-ttu-id="bd02b-153">Windows-Explorer verfügt über Funktionen für die Freigabe von Elementen, einschließlich einer "öffentlichen" Freigabe \\ \\ (Öffentliche \\ \\ Computerfreigabe ...) im **Netzwerk- und Freigabecenter** und einer Benutzerfreigabe \\ \\ \\ (Computerbenutzer ...) für \\ Elemente, die über den Freigabe-Assistenten freigegeben wurden.</span><span class="sxs-lookup"><span data-stu-id="bd02b-153">Windows Explorer has features for sharing items, including a "Public" share (\\\\Machine\\Public\\...) in the **Network and Sharing Center**, and a "Users" share (\\\\Machine\\Users\\...) for items shared via the Sharing Wizard.</span></span> <span data-ttu-id="bd02b-154">Nachdem Sie die Ordner freigegeben haben, können Sie den lokalen Index abfragen, indem Sie den Computernamen des Remotecomputers in der FROM-Klausel und einen UNC-Pfad auf dem Remotecomputer in der SCOPE-Klausel angeben.</span><span class="sxs-lookup"><span data-stu-id="bd02b-154">After you share the folder(s), you can query the local index by specifying the remote computer's machine name in the FROM clause, and a UNC path on the remote computer in the SCOPE clause.</span></span> <span data-ttu-id="bd02b-155">Eine Remoteabfrage mithilfe der FROM- und SCOPE-Klauseln wird im folgenden Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-155">A remote query using the FROM and SCOPE clauses is shown in the following example.</span></span>


```
SELECT System.ItemName FROM MachineName.SystemIndex WHERE SCOPE='file://MachineName/<path>' 
```



<span data-ttu-id="bd02b-156">In den hier bereitgestellten Beispielen wird SQL verwendet.</span><span class="sxs-lookup"><span data-stu-id="bd02b-156">The examples provided here use SQL.</span></span>

### <a name="structured-query-api-overview"></a><span data-ttu-id="bd02b-157">Übersicht über die API für strukturierte Abfragen</span><span class="sxs-lookup"><span data-stu-id="bd02b-157">Structured Query API Overview</span></span>

<span data-ttu-id="bd02b-158">Eine strukturierte Abfrage bietet die Möglichkeit, nach Informationen nach booleschen Kombinationen von Abfragen für einzelne Eigenschaften zu suchen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-158">A structured query provides the ability to search for information by Boolean combinations of queries over individual properties.</span></span> <span data-ttu-id="bd02b-159">In diesem Thema werden die Funktionen der wichtigsten strukturierten Abfrage-APIs und -Methoden beschrieben.</span><span class="sxs-lookup"><span data-stu-id="bd02b-159">In this topic we outline the functionality of the most important structured query APIs and methods.</span></span> <span data-ttu-id="bd02b-160">Eine Referenzdokumentation zu den strukturierten Abfrage-APIs finden Sie unter [Abfragen von Schnittstellen.](-search-querying-interfaces-entry-page.md)</span><span class="sxs-lookup"><span data-stu-id="bd02b-160">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span>

### <a name="iqueryparser"></a><span data-ttu-id="bd02b-161">IQueryParser</span><span class="sxs-lookup"><span data-stu-id="bd02b-161">IQueryParser</span></span>

<span data-ttu-id="bd02b-162">Die [**IQueryParser::P arse-Methode**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) analysiert eine Benutzereingabezeichenfolge und erzeugt eine Interpretation in Form einer [**IQuerySolution.**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution)</span><span class="sxs-lookup"><span data-stu-id="bd02b-162">The [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method parses a user input string, and produces an interpretation in the form of an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span></span> <span data-ttu-id="bd02b-163">Wenn der *pCustomProperties-Parameter dieser* Methode nicht NULL ist, handelt es sich um eine Enumeration von [**IRichChunk-Objekten**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) (eines für jede erkannte benutzerdefinierte Eigenschaft).</span><span class="sxs-lookup"><span data-stu-id="bd02b-163">If the *pCustomProperties* parameter of that method is not null, then it is an enumeration of [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) objects(one for each recognized custom property).</span></span> <span data-ttu-id="bd02b-164">Mit den [**anderen IQueryParser-Methoden**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) kann die Anwendung mehrere Optionen festlegen, z. B. ein Locale, ein Schema, eine Wörtertrenneinheit und Handler für verschiedene Typen benannter Entitäten.</span><span class="sxs-lookup"><span data-stu-id="bd02b-164">The other [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) methods permit the application to set several options, such as locale, a schema, a word breaker, and handlers for various types of named entities.</span></span> <span data-ttu-id="bd02b-165">[**IQueryParser::GetSchemaProvider gibt**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) eine [**ISchemaProvider-Schnittstelle**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) zum Durchsuchen des geladenen Schemas zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-165">[**IQueryParser::GetSchemaProvider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) returns an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface for browsing the loaded schema.</span></span>

### <a name="iquerysolution--iconditionfactory"></a><span data-ttu-id="bd02b-166">IQuerySolution: IConditionFactory</span><span class="sxs-lookup"><span data-stu-id="bd02b-166">IQuerySolution : IConditionFactory</span></span>

<span data-ttu-id="bd02b-167">Die [**IQuerySolution-Schnittstelle**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) stellt alle Informationen zum Ergebnis der Analyse einer Eingabezeichenfolge bereit.</span><span class="sxs-lookup"><span data-stu-id="bd02b-167">The [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface provides all information about the result of parsing an input string.</span></span> <span data-ttu-id="bd02b-168">Da **IQuerySolution auch** eine [**IConditionFactory-Schnittstelle**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) ist, können zusätzliche Bedingungsstrukturknoten erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="bd02b-168">Because **IQuerySolution** is also an [**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) interface, additional condition tree nodes can be created.</span></span> <span data-ttu-id="bd02b-169">Die [**IQuerySolution::GetQuery-Methode**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) erzeugt eine Bedingungsstruktur für die Interpretation.</span><span class="sxs-lookup"><span data-stu-id="bd02b-169">The [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) method produces a condition tree for the interpretation.</span></span> <span data-ttu-id="bd02b-170">**IQuerySolution::GetQuery** gibt auch den semantischen Typ zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-170">**IQuerySolution::GetQuery** also returns the semantic type.</span></span>

### <a name="iconditionfactory"></a><span data-ttu-id="bd02b-171">IConditionFactory</span><span class="sxs-lookup"><span data-stu-id="bd02b-171">IConditionFactory</span></span>

<span data-ttu-id="bd02b-172">[**IConditionFactory erstellt**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) Bedingungsstrukturknoten.</span><span class="sxs-lookup"><span data-stu-id="bd02b-172">[**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) creates condition tree nodes.</span></span> <span data-ttu-id="bd02b-173">Wenn der *simplify-Parameter* von [**IConditionFactory::MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) **VARIANT \_ TRUE** ist, wird die resultierende [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) vereinfacht und muss kein Negationsknoten sein.</span><span class="sxs-lookup"><span data-stu-id="bd02b-173">If the *simplify* parameter of [**IConditionFactory::MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) is **VARIANT\_TRUE**, then the resulting [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) is simplified, and need not be a negation node.</span></span> <span data-ttu-id="bd02b-174">Wenn der *pSubConditions-Parameter* von [**IConditionFactory::MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) nicht NULL ist, sollte dieser Parameter eine Enumeration von [**ICondition-Objekten**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) sein und zu Teilstruktur werden. [**IConditionFactory::MakeLeaf erstellt**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) einen Blattknoten mit einem angegebenen Eigenschaftennamen, Vorgang und Wert.</span><span class="sxs-lookup"><span data-stu-id="bd02b-174">If the *pSubConditions* parameter of [**IConditionFactory::MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) is not null, then that parameter should be an enumeration of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) objects, and become subtrees.[**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) constructs a leaf node with a specified property name, operation, and value.</span></span> <span data-ttu-id="bd02b-175">Die Zeichenfolge im *pValueType-Parameter* sollte der Name eines semantischen Typs aus dem Schema sein.</span><span class="sxs-lookup"><span data-stu-id="bd02b-175">The string in the *pValueType* parameter should be the name of a semantic type from the schema.</span></span> <span data-ttu-id="bd02b-176">Wenn der *expand-Parameter* **VARIANT \_ TRUE** ist und die Eigenschaft virtuell ist, ist die resultierende Bedingungsstruktur in der Regel eine Disjunktion, die sich aus dem Erweitern der Eigenschaft auf die definierten Bestandteile ergibt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-176">If the *expand* parameter is **VARIANT\_TRUE** and the property is virtual, the resulting condition tree is typically a disjunction resulting from expanding the property to its defined constituents.</span></span> <span data-ttu-id="bd02b-177">Wenn nicht NULL, sollten die Parameter *pPropertyNameTerm,* *pOperatorTerm* und *pValueTerm* Begriffe identifizieren, die die Eigenschaft, den Vorgang und den Wert angeben.</span><span class="sxs-lookup"><span data-stu-id="bd02b-177">If not null, the *pPropertyNameTerm*, *pOperatorTerm*, and *pValueTerm* parameters should identify terms indicating the property, operation, and value.</span></span>

### <a name="icondition--ipersiststream"></a><span data-ttu-id="bd02b-178">ICondition : IPersistStream</span><span class="sxs-lookup"><span data-stu-id="bd02b-178">ICondition : IPersistStream</span></span>

<span data-ttu-id="bd02b-179">Die [**ICondition-Schnittstelle**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) ist ein einzelner Knoten in einer Bedingungsstruktur.</span><span class="sxs-lookup"><span data-stu-id="bd02b-179">The [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface is a single node in a condition tree.</span></span> <span data-ttu-id="bd02b-180">Der Knoten kann ein Negationsknoten, AND-Knoten, OR-Knoten oder Blattknoten sein.</span><span class="sxs-lookup"><span data-stu-id="bd02b-180">The node can be a negation node, AND node, OR node, or a leaf node.</span></span> <span data-ttu-id="bd02b-181">Für einen Nicht-Blattknoten gibt [**ICondition::GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) eine Enumeration der Unterstrukturen zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-181">For a non-leaf node [**ICondition::GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) returns an enumeration of the subtrees.</span></span> <span data-ttu-id="bd02b-182">Für einen Blattknoten geben die folgenden Methoden von [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) die folgenden Werte zurück:</span><span class="sxs-lookup"><span data-stu-id="bd02b-182">For a leaf node the following methods of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) return the following values:</span></span>

-   <span data-ttu-id="bd02b-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) gibt den Namen, den Vorgang und den Wert der Eigenschaft zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) returns the property name, operation, and value.</span></span>
-   <span data-ttu-id="bd02b-184">[**GetValueType**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) gibt den semantischen Typ des Werts zurück, der im *pszValueType-Parameter* von [**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf)spezifisch war.</span><span class="sxs-lookup"><span data-stu-id="bd02b-184">[**GetValueType**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) returns the semantic type of the value, which was specificied in the *pszValueType* parameter of [**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span></span>
-   <span data-ttu-id="bd02b-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) gibt eine Zeichenfolgenform des Werts zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) returns a string form of the value.</span></span> <span data-ttu-id="bd02b-186">(Wenn es sich bei dem Wert bereits um eine Zeichenfolge handelt, wird dieses Formular hinsichtlich Groß-/Schreibung, Akzenten usw. normalisiert.)</span><span class="sxs-lookup"><span data-stu-id="bd02b-186">(If the value was already a string, this form will be normalized with regard to case, accents, and so forth.)</span></span>
-   <span data-ttu-id="bd02b-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) gibt Informationen darüber zurück, welche Teile des Eingabesatzes den Eigenschaftennamen, den Vorgang und den Wert generiert haben.</span><span class="sxs-lookup"><span data-stu-id="bd02b-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) returns information about which parts of the input sentence generated the property name, the operation, and the value.</span></span>
-   <span data-ttu-id="bd02b-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) gibt eine tiefe Kopie einer Bedingungsstruktur zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) returns a deep copy of a condition tree.</span></span>

### <a name="irichchunk"></a><span data-ttu-id="bd02b-189">IRichChunk</span><span class="sxs-lookup"><span data-stu-id="bd02b-189">IRichChunk</span></span>

<span data-ttu-id="bd02b-190">Jedes [**IRichChunk-Objekt**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) identifiziert eine Tokenspanne und eine Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="bd02b-190">Each [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) object identifies a token span and a string.</span></span> <span data-ttu-id="bd02b-191">**IRichChunk** ist eine Hilfsprogrammschnittstelle, die Informationen über eine Spanne (in der Regel eine Tokenspanne) darstellt, die durch eine Anfangsposition und Länge identifiziert wird.</span><span class="sxs-lookup"><span data-stu-id="bd02b-191">**IRichChunk** is a utility interface that represents information about a span (typically a span of tokens) identified by a starting position and length.</span></span> <span data-ttu-id="bd02b-192">Diese Spanneninformationen umfassen eine Zeichenfolge und/oder eine **VARIANT -Datei.**</span><span class="sxs-lookup"><span data-stu-id="bd02b-192">This span information includes a string and/or a **VARIANT**.</span></span>

### <a name="iconditiongenerator"></a><span data-ttu-id="bd02b-193">IConditionGenerator</span><span class="sxs-lookup"><span data-stu-id="bd02b-193">IConditionGenerator</span></span>

<span data-ttu-id="bd02b-194">Die [**IConditionGenerator-Schnittstelle**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) wird von der Anwendung bereitgestellt, um die Erkennung und Bedingungsstrukturgenerierung für einen benannten Entitätstyp zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="bd02b-194">The [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) interface is provided by the application to handle recognition and condition tree generation for a named entity type.</span></span> <span data-ttu-id="bd02b-195">Ein Bedingungsgenerator wird einem [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) über [**IQueryParser::SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption)übergeben.</span><span class="sxs-lookup"><span data-stu-id="bd02b-195">A condition generator is given to an [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) through [**IQueryParser::SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span></span> <span data-ttu-id="bd02b-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) ruft [**IConditionGenerator::Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) mit einem [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) für das derzeit geladene Schema auf.</span><span class="sxs-lookup"><span data-stu-id="bd02b-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) calls [**IConditionGenerator::Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) with an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) for the currently loaded schema.</span></span> <span data-ttu-id="bd02b-197">Dadurch kann [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) alle erforderlichen Schemainformationen abrufen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-197">Doing so permits [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) to obtain any schema information that is required.</span></span> <span data-ttu-id="bd02b-198">Beim Analyse einer Eingabezeichenfolge ruft **IQueryParser** die [**IConditionGenerator::RecognizeNamedEntities-Methode**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) jedes [**IConditionGenerators**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator)auf, damit das Vorkommen benannter Entitäten, die es in der Eingabezeichenfolge erkennt, gemeldet werden kann.</span><span class="sxs-lookup"><span data-stu-id="bd02b-198">When parsing an input string, **IQueryParser** calls the [**IConditionGenerator::RecognizeNamedEntities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) method of each [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), so that the occurrence of named entities it recognizes in the input string can be reported.</span></span> <span data-ttu-id="bd02b-199">**IQueryParser** kann das aktuelle Locale verwenden und sollte die Tokenisierung der Eingabe nutzen, da er die Tokenspanne aller benannten Entitäten melden muss.</span><span class="sxs-lookup"><span data-stu-id="bd02b-199">**IQueryParser** can make use of the current locale and should make use of the tokenization of the input as it needs to report the token spans of any named entities.</span></span>

<span data-ttu-id="bd02b-200">Wenn [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) einen Blattknoten aus geben möchte und der semantische Typ des Werts mit dem benannten Entitätstyp für einen [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator)abschneidet, ruft **IQueryParser** [**IConditionGenerator::GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) mit den Informationen für den zu generierenden Knoten auf.</span><span class="sxs-lookup"><span data-stu-id="bd02b-200">When [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) is about to emit a leaf node, and the semantic type of the value matches the named entity type for an [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **IQueryParser** calls [**IConditionGenerator::GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) with the information for the node to be generated.</span></span> <span data-ttu-id="bd02b-201">Wenn [**der IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) S OK zurückgibt, sollte er eine Bedingungsstruktur zurückgeben (die kein Blattknoten sein muss) und \_ **IQueryParser** darüber informieren, ob die alternative Zeichenfolgeninterpretation unterdrückt werden soll, die normalerweise als Vorsichtsmaßnahme generiert wird.</span><span class="sxs-lookup"><span data-stu-id="bd02b-201">If the [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) returns S\_OK, it should return a condition tree (which does not have to be a leaf node), and inform **IQueryParser** whether to suppress the alternative string interpretation that it would normally generate as a precaution.</span></span>

### <a name="itokencollection"></a><span data-ttu-id="bd02b-202">ITokenCollection</span><span class="sxs-lookup"><span data-stu-id="bd02b-202">ITokenCollection</span></span>

<span data-ttu-id="bd02b-203">Die [**ITokenCollection::NumberOfTokens-Methode**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) gibt die Anzahl der Token zurück. [**ITokenCollection::GetToken gibt**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) Informationen zum *ith-Token* zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-203">The [**ITokenCollection::NumberOfTokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) method returns the number of tokens.[**ITokenCollection::GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) returns information about the *i* th token.</span></span> <span data-ttu-id="bd02b-204">Der Anfang und die Länge sind Zeichenpositionen in der Eingabezeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="bd02b-204">The beginning and length are character positions in the input string.</span></span> <span data-ttu-id="bd02b-205">Der zurückgegebene Text ist nur dann nicht NULL, wenn ein Text die Zeichen aus der Eingabezeichenfolge überschreiben muss.</span><span class="sxs-lookup"><span data-stu-id="bd02b-205">The returned text will be non-null only if there is a text overriding the characters from the input string.</span></span> <span data-ttu-id="bd02b-206">Dies wird beispielsweise verwendet, um einen Bindestrich in der Eingabezeichenfolge mit NOT zu überschreiben, wenn sich dieser Bindestrich in einem Kontext befindet, in dem er als Negation interpretiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="bd02b-206">This is used, for example, to override a dash in the input string with NOT when that dash is in a context where it should be interpreted as a negation.</span></span>

### <a name="inamedentitycollector"></a><span data-ttu-id="bd02b-207">INamedEntityCollector</span><span class="sxs-lookup"><span data-stu-id="bd02b-207">INamedEntityCollector</span></span>

<span data-ttu-id="bd02b-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) ruft [**INamedEntityCollector::Add für**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) jede erkannte benannte Entität auf.</span><span class="sxs-lookup"><span data-stu-id="bd02b-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) calls [**INamedEntityCollector::Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) for each named entity it recognized.</span></span> <span data-ttu-id="bd02b-209">Die Spannen sind Tokenspanne.</span><span class="sxs-lookup"><span data-stu-id="bd02b-209">The spans are token spans.</span></span> <span data-ttu-id="bd02b-210">Es muss immer der Fall sein, dass *beginSpan* ?</span><span class="sxs-lookup"><span data-stu-id="bd02b-210">It must always be the case that *beginSpan* ?</span></span> <span data-ttu-id="bd02b-211">*beginActual*  <  *endActual* ?</span><span class="sxs-lookup"><span data-stu-id="bd02b-211">*beginActual* < *endActual* ?</span></span> <span data-ttu-id="bd02b-212">*endSpan*.</span><span class="sxs-lookup"><span data-stu-id="bd02b-212">*endSpan*.</span></span> <span data-ttu-id="bd02b-213">*beginSpan* und *endSpan* können sich von *beginActual* und *endActual* unterscheiden, wenn die benannte Entität mit semantisch nicht signifikanten Token wie Anführungszeichen beginnt und/oder endet (die dennoch von der benannten Entität abgedeckt werden).</span><span class="sxs-lookup"><span data-stu-id="bd02b-213">*beginSpan* and *endSpan* may differ from *beginActual* and *endActual* if the named entity begins and/or ends with semantically insignificant tokens such as quotation marks (that are nevertheless covered by the named entity).</span></span> <span data-ttu-id="bd02b-214">Der Wert muss als Zeichenfolge ausgedrückt werden und wird anschließend in einem Aufruf von [**IConditionGenerator::GenerateForLeaf angezeigt.**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf)</span><span class="sxs-lookup"><span data-stu-id="bd02b-214">The value must be expressed as a string and will subsequently appear in a call to [**IConditionGenerator::GenerateForLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span></span>

### <a name="ischemaprovider"></a><span data-ttu-id="bd02b-215">ISchemaProvider</span><span class="sxs-lookup"><span data-stu-id="bd02b-215">ISchemaProvider</span></span>

<span data-ttu-id="bd02b-216">Die [**ISchemaProvider-Schnittstelle**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) kann verwendet werden, um ein geladenes Schema nach Entitäten (Typen) und Beziehungen (Eigenschaften) zu durchsuchen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-216">The [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface can be used to browse a loaded schema for entities (types) and relations (properties).</span></span> <span data-ttu-id="bd02b-217">Dies sind die einzelnen Methoden:</span><span class="sxs-lookup"><span data-stu-id="bd02b-217">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="bd02b-218">[**Entitäten**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) geben eine Enumeration jeder Entität ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) im Schema zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-218">[**Entities**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) returns an enumeration of every entity ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) in the schema.</span></span>
-   <span data-ttu-id="bd02b-219">[**RootEntity gibt**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) die Stammentität des Schemas zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-219">[**RootEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) returns the root entity of the schema.</span></span> <span data-ttu-id="bd02b-220">Bei einem flachen Schema wird der Haupttyp jeder [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="bd02b-220">For a flat schema, the main type of every [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) is returned.</span></span>
-   <span data-ttu-id="bd02b-221">[**GetEntity sucht**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) nach einer Entität nach Namen und gibt S FALSE zurück, wenn im Schema keine entität \_ dieser Entität vorkommt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) finds an entity by name and returns S\_FALSE if there is no such entity in the schema.</span></span>
-   <span data-ttu-id="bd02b-222">[**MetaData gibt**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) eine Enumeration von [**IMetaData-Schnittstellen**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) zurück.</span><span class="sxs-lookup"><span data-stu-id="bd02b-222">[**MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces.</span></span>

### <a name="ientity"></a><span data-ttu-id="bd02b-223">IEntity</span><span class="sxs-lookup"><span data-stu-id="bd02b-223">IEntity</span></span>

<span data-ttu-id="bd02b-224">Die [**IEntity-Schnittstelle**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) ist eine Schemaentität, die einen Typ darstellt, der einen Namen hat, über eine Reihe benannter Beziehungen zu anderen Typen (Eigenschaften) verfügt und von einer Basisentität abstammt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-224">The [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) interface is a schema entity that represents a type that has a name, has a number of named relationships to other types (properties), and derives from a base entity.</span></span> <span data-ttu-id="bd02b-225">Die einzelnen Methoden führen dies aus:</span><span class="sxs-lookup"><span data-stu-id="bd02b-225">Here's what its individual methods do:</span></span>

-   <span data-ttu-id="bd02b-226">[**IEntity::Relationships gibt**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) eine Enumeration von [**IRelationship-Objekten**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) zurück, eine für jede ausgehende Beziehung dieses Typs.</span><span class="sxs-lookup"><span data-stu-id="bd02b-226">[**IEntity::Relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) returns an enumeration of [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) objects, one for each outgoing relation of this type.</span></span> <span data-ttu-id="bd02b-227">Jede ausgehende Beziehung einer Entität hat einen Namen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-227">Each outgoing relation of an entity has a name.</span></span>
-   <span data-ttu-id="bd02b-228">[**IEntity::GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) sucht eine Beziehung anhand des Namens und gibt S FALSE zurück, wenn für diese Entität keine \_ solche Beziehung besteht.</span><span class="sxs-lookup"><span data-stu-id="bd02b-228">[**IEntity::GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) finds a relationship by name, and returns S\_FALSE if there is no such relationship for this entity.</span></span>
-   <span data-ttu-id="bd02b-229">[**IEntity::MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) gibt eine Enumeration von [**IMetaData-Schnittstellen**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) zurück, eine für jedes Metadatenpaar dieser Entität.</span><span class="sxs-lookup"><span data-stu-id="bd02b-229">[**IEntity::MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="bd02b-230">[**IEntity::D efaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) gibt einen Standardbegriff zurück, um das Generieren einer AQS- oder NQS-Neukonfiguration einer Bedingungsstruktur zu erleichtern.</span><span class="sxs-lookup"><span data-stu-id="bd02b-230">[**IEntity::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) returns a default phrase to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="irelationship"></a><span data-ttu-id="bd02b-231">IRelationship</span><span class="sxs-lookup"><span data-stu-id="bd02b-231">IRelationship</span></span>

<span data-ttu-id="bd02b-232">Die [**IRelationship-Schnittstelle**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) stellt eine Beziehung zwischen zwei Entitäten dar: einer Quelle und einem Ziel.</span><span class="sxs-lookup"><span data-stu-id="bd02b-232">The [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) interface represents a relationship between two entities: a source and a destination.</span></span> <span data-ttu-id="bd02b-233">Einzelne Methoden haben folgende Möglichkeiten:</span><span class="sxs-lookup"><span data-stu-id="bd02b-233">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="bd02b-234">[**IRelationship::IsReal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) meldet, ob eine Beziehung real ist.</span><span class="sxs-lookup"><span data-stu-id="bd02b-234">[**IRelationship::IsReal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) reports whether a relationship is real.</span></span> <span data-ttu-id="bd02b-235">Wenn Entität A beispielsweise von Entität B abgeleitet ist und eine Beziehung mit dem Namen R erbt, verfügt A möglicherweise noch über eine eigene Beziehung mit dem Namen R. Die Beziehung zwischen A und R muss jedoch den gleichen Zieltyp wie B aufweisen, und der einzige Grund dafür ist das Speichern von Metadaten, die für B spezifisch sind. Eine solche Beziehung von B wird als nicht real bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="bd02b-235">For example, if entity A derives from entity B and inherits a relationship named R from it, A may still have its own relationship named R. However, the relationship beween A and R must have the same destination type as that of B, and the only reason for it to exist is to store metadata specific to B. Such a relationship of B is said not to be real.</span></span>
-   <span data-ttu-id="bd02b-236">[**IRelationship::Medadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) gibt eine Enumeration von [**IMetaData-Schnittstellen**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) zurück, eine für jedes Metadatenpaar dieser Entität.</span><span class="sxs-lookup"><span data-stu-id="bd02b-236">[**IRelationship::Medadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="bd02b-237">[**IRelationship::D efaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) gibt den Standardbegriff zurück, der für diese Beziehung in Neueinstellungen verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="bd02b-237">[**IRelationship::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) returns the default phrase to use for this relationship in restatements.</span></span> <span data-ttu-id="bd02b-238">Jede Beziehung verfügt über einen Standardphrasen, der sie bezeichnet, um das Generieren einer AQS- oder NQS-Neudarstellung einer Bedingungsstruktur zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-238">Each relationship has a default phrase that denotes it to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="imetadata"></a><span data-ttu-id="bd02b-239">IMetaData</span><span class="sxs-lookup"><span data-stu-id="bd02b-239">IMetaData</span></span>

<span data-ttu-id="bd02b-240">Metadaten sind Schlüssel-Wert-Paare, die jeweils einer Entität, einer Beziehung oder dem gesamten Schema zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="bd02b-240">Metadata are key-value pairs that are each associated with either an entity, a relationship, or the whole schema.</span></span> <span data-ttu-id="bd02b-241">Da Schlüssel nicht unbedingt eindeutig sind, kann eine Sammlung von Metadaten als Mehrfachzuordnung bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="bd02b-241">Because keys are not necessarily unique, a collection of metadata can be thought of as a multi-map.</span></span> <span data-ttu-id="bd02b-242">[**IMetaData::GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) wird aufgerufen, um den Schlüssel und wert für ein Metadatenpaar abzurufen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-242">[**IMetaData::GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) is called to retrieve the key and value for a metatdata pair.</span></span>

## <a name="querying-scenarios"></a><span data-ttu-id="bd02b-243">Abfragen von Szenarien</span><span class="sxs-lookup"><span data-stu-id="bd02b-243">Querying Scenarios</span></span>

<span data-ttu-id="bd02b-244">In den folgenden Szenarien wird die Verwendung strukturierter Abfrage-APIs in Windows Search in gängigen Abfrageszenarien beschrieben, z. B. beim Erstellen einer Bedingungsstruktur und beim Abfragen des Indexes.</span><span class="sxs-lookup"><span data-stu-id="bd02b-244">The following scenarios describe the use of structured query APIs in Windows Search in common querying scenarios, such as creating a condition tree and querying the index.</span></span>

### <a name="condition-extraction-and-query-parsing"></a><span data-ttu-id="bd02b-245">Bedingungsextraktion und Abfrageparsing</span><span class="sxs-lookup"><span data-stu-id="bd02b-245">Condition Extraction and Query Parsing</span></span>

<span data-ttu-id="bd02b-246">Wenn eine Abfrage erstellt wird, wird ihr Bereich definiert, indem dem System mitgeteilt wird, wo gesucht werden soll.</span><span class="sxs-lookup"><span data-stu-id="bd02b-246">When a query is created, its scope is defined by telling the system where to search.</span></span> <span data-ttu-id="bd02b-247">Dies schränkt die Suchergebnisse ein.</span><span class="sxs-lookup"><span data-stu-id="bd02b-247">This restricts the search results.</span></span> <span data-ttu-id="bd02b-248">Nachdem der Bereich definiert wurde, wird ein Filter angewendet, und ein Filtersatz wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="bd02b-248">After the scope is defined, a filter is applied, and a filter set is returned.</span></span> <span data-ttu-id="bd02b-249">Suchergebnisse werden durch erstellen einer Bedingungsstruktur mit Blattknoten eingeschränkt, ähnlich wie ein Diagramm.</span><span class="sxs-lookup"><span data-stu-id="bd02b-249">Search results are restricted by building a condition tree with leaf nodes, similar to a graph.</span></span> <span data-ttu-id="bd02b-250">Diese Bedingungen werden dann extrahiert.</span><span class="sxs-lookup"><span data-stu-id="bd02b-250">Those conditions are then extracted.</span></span> <span data-ttu-id="bd02b-251">Eine Bedingungsstruktur ist eine boolesche Kombination (AND, OR, NOT) von Blattbedingungen, von denen jede eine Eigenschaft über einen Vorgang mit einem Wert verbindet.</span><span class="sxs-lookup"><span data-stu-id="bd02b-251">A condition tree is a Boolean combination (AND, OR, NOT) of leaf conditions, each of which relates a property, through an operation, to a value.</span></span> <span data-ttu-id="bd02b-252">Ein Blattknoten stellt eine Einschränkung für eine einzelne Eigenschaft auf einen Wert durch einige Vorgänge dar.</span><span class="sxs-lookup"><span data-stu-id="bd02b-252">A leaf node represents a restriction on a single property to a value through some operations.</span></span>

<span data-ttu-id="bd02b-253">Eine Filtereinschränkung erfordert einen logischen Ausdruck, der die Einschränkung beschreibt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-253">A filter restriction requires a logical expression that describes the restriction.</span></span> <span data-ttu-id="bd02b-254">Das Definieren dieses Ausdrucks beginnt mit der [**ICondition-Schnittstelle,**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) die zum Erstellen eines einzelnen Knotens in einer Bedingungsstruktur verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="bd02b-254">Defining this expression starts with the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface, which is used to create a single node in a condition tree.</span></span> <span data-ttu-id="bd02b-255">Da es im folgenden Beispiel nur eine Bedingung gibt, ändert sich die Struktur nicht.</span><span class="sxs-lookup"><span data-stu-id="bd02b-255">Because there is only one condition in the following example, the tree does not change.</span></span>


```C++
    
    [
        object,
        uuid(0FC988D4-C935-4b97-A973-46282EA175C8),
        pointer_default(unique)
    ]
    interface ICondition : IPersistStream
    {
        HRESULT GetConditionType([out, retval] CONDITION_TYPE* pNodeType);
        HRESULT GetSubConditions([in] REFIID riid, [out, retval, iid_is(riid)] void** ppv);
        [local] HRESULT GetComparisonInfo([out, annotation("__deref_opt_out")] LPWSTR *ppszPropertyName, [out, annotation("__out_opt")] CONDITION_OPERATION *pOperation, [out, annotation("__out_opt")] PROPVARIANT *pValue);
        HRESULT GetValueType([out, retval] LPWSTR* ppszValueTypeName);
        HRESULT GetValueNormalization([out, retval] LPWSTR* ppszNormalization);
        [local] HRESULT GetInputTerms([out, annotation("__out_opt")] IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] IRichChunk** ppValueTerm);
        HRESULT Clone([out, retval] ICondition** ppc);
    };


```



<span data-ttu-id="bd02b-256">Wenn es mehrere Filterbedingung gibt, werden AND und andere boolesche Operatoren verwendet, um eine einzelne Struktur zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-256">If there is more than one filter condition, then AND and other Boolean operators are used to achieve a single tree.</span></span> <span data-ttu-id="bd02b-257">AND-Strukturen und OR-Strukturen stellen Konjunktionen und Disjunktionen ihrer Teilstrukturen dar.</span><span class="sxs-lookup"><span data-stu-id="bd02b-257">AND-trees and OR-trees represent conjunctions and disjunctions of their subtrees.</span></span> <span data-ttu-id="bd02b-258">Eine NOT-Struktur stellt die Negation ihrer einzelnen Teilstruktur dar.</span><span class="sxs-lookup"><span data-stu-id="bd02b-258">A NOT-tree represents the negation of its single subtree.</span></span> <span data-ttu-id="bd02b-259">AQS bietet einen Textansatz zum Erreichen logischer Ausdrücke mit booleschen Operatoren und ist häufig einfacher.</span><span class="sxs-lookup"><span data-stu-id="bd02b-259">AQS provides a text approach to achieving logical expressions with Boolean operators, and is often simpler.</span></span>

<span data-ttu-id="bd02b-260">Im nächsten Beispiel konvertieren wir die Bedingungsstruktur ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) in visuelle Form.</span><span class="sxs-lookup"><span data-stu-id="bd02b-260">In the next example we convert the condition tree ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) into visual form.</span></span> <span data-ttu-id="bd02b-261">Der Abfrageparser konvertiert mithilfe der [**IQueryParser-Schnittstelle**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) [**die ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) in eine RTF-Abfragezeichenfolge (Rich Text Formatted).</span><span class="sxs-lookup"><span data-stu-id="bd02b-261">The query parser, using the [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) interface, converts the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) into a rich text formatted (RTF) query string.</span></span> <span data-ttu-id="bd02b-262">Die [**IQueryParser::RestateToString-Methode**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) gibt den Abfragetext zurück, während die [**IQueryParser::P arse-Methode**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) eine [**IQuerySolution-Schnittstelle**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) erzeugt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-262">The [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) method returns the query text, while the [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method produces an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface.</span></span> <span data-ttu-id="bd02b-263">Das folgende Beispiel zeigt, wie Sie all dies tun.</span><span class="sxs-lookup"><span data-stu-id="bd02b-263">The following example shows how to do all that.</span></span>


```C++
    [
        object,
        uuid(2EBDEE67-3505-43f8-9946-EA44ABC8E5B0),
        pointer_default(unique)
    ]
    interface IQueryParser : IUnknown
    {
        HRESULT Parse([in] LPCWSTR pszInputString, [in] IEnumUnknown* pCustomProperties, [out, retval] IQuerySolution** ppSolution);
        HRESULT SetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [out, retval] PROPVARIANT* pOptionValue);
        HRESULT SetMultiOption([in] STRUCTURED_QUERY_MULTIOPTION option, [in] LPCWSTR pszOptionKey, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetSchemaProvider([out, retval] ISchemaProvider** ppSchemaProvider);
        HRESULT RestateToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszQueryString);
        HRESULT ParsePropertyValue([in] LPCWSTR pszPropertyName, [in] LPCWSTR pszInputString, [out, retval] IQuerySolution** ppSolution);
        HRESULT RestatePropertyValueToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszPropertyName, [out] LPWSTR* ppszQueryString);
    };

```



<span data-ttu-id="bd02b-264">Die Haupteingabe von [**IQueryParser::P arse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) ist eine zu analysierende Benutzereingabezeichenfolge, aber die Anwendung kann den Abfrageparser auch über alle Eigenschaften informieren, die er in der Eingabe erkannt hat (aus anwendungsspezifischer Syntax).</span><span class="sxs-lookup"><span data-stu-id="bd02b-264">The main input of [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) is a user input string to be parsed, but the application can also inform the query parser of any properties it has recognized in the input (from application-specific syntax).</span></span> <span data-ttu-id="bd02b-265">Die Ausgabe von **IQueryParser::P arse** ist eine [**IQuerySolution,**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution)die alle Informationen zu diesem Analyseaufruf enthält.</span><span class="sxs-lookup"><span data-stu-id="bd02b-265">The output of **IQueryParser::Parse** is an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), which provides all information pertaining to that parse invocation.</span></span> <span data-ttu-id="bd02b-266">Es gibt Methoden zum Abrufen der Eingabezeichenfolge, zum Tokenisieren der Eingabezeichenfolge, zu Analysefehlern und zur analysierten Abfrage als Bedingungsstruktur, die durch [**eine ICondition dargestellt wird.**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)</span><span class="sxs-lookup"><span data-stu-id="bd02b-266">There are methods for obtaining the input string, how the input string was tokenized, any parse errors, and the parsed query as condition tree, represented by an [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span></span> <span data-ttu-id="bd02b-267">Das folgende Beispiel zeigt ...</span><span class="sxs-lookup"><span data-stu-id="bd02b-267">The following example shows ...</span></span>


```C++
    [
        object,
        uuid(D6EBC66B-8921-4193-AFDD-A1789FB7FF57),
        pointer_default(unique)
    ]
    interface IQuerySolution : IConditionFactory
    {
        [local] HRESULT GetQuery([out, annotation("__out_opt")] ICondition** ppQueryNode, [out, annotation("__out_opt")] IEntity** ppMainType);
        HRESULT GetErrors([in] REFIID riid, [out, retval, iid_is(riid)] void** ppParseErrors);
        [local] HRESULT GetLexicalData([out, annotation("__deref_opt_out")] LPWSTR* ppszInputString, [out, annotation("__out_opt")] ITokenCollection** ppTokens, [out, annotation("__out_opt")] LCID* pLocale, [out, annotation("__out_opt")] IUnknown** ppWordBreaker);
    }    

    

```



<span data-ttu-id="bd02b-268">Im vorherigen Beispiel konnte [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) alle Informationen zur Abfrage abrufen, einschließlich des ursprünglichen Texts, token, die den Text bilden, oder der Bedingungsstruktur.</span><span class="sxs-lookup"><span data-stu-id="bd02b-268">In the previous example, [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) could obtain any information about the query including the original text, tokens that comprise the text, or the condition tree.</span></span> <span data-ttu-id="bd02b-269">Beispiele für mögliche zurückgegebene Abfragewerte sind in der folgenden Tabelle aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-269">Examples of possible returned query values are listed in the following table.</span></span>



| <span data-ttu-id="bd02b-270">Beispiele für zurückgegebene Abfragewerte</span><span class="sxs-lookup"><span data-stu-id="bd02b-270">Examples of returned query values</span></span>                        | <span data-ttu-id="bd02b-271">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="bd02b-271">Description</span></span>                                                                                               |
|----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
| `  author:relja OR author:tyler`                         | <span data-ttu-id="bd02b-272">Der Abfragetext, den [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) zurückgibt</span><span class="sxs-lookup"><span data-stu-id="bd02b-272">The query text that [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) returns</span></span> |
| `?author?, ?:?, ?relja?, ?OR?, ?author?, ?:?, ?tyler?`   | <span data-ttu-id="bd02b-273">Auflisten von Token</span><span class="sxs-lookup"><span data-stu-id="bd02b-273">The break-down of tokens</span></span>                                                                                  |
| ![Eine nicht aufgelöste Bedingungsstruktur](images/queryvalues1.png) | <span data-ttu-id="bd02b-275">Eine nicht aufgelöste Bedingungsstruktur</span><span class="sxs-lookup"><span data-stu-id="bd02b-275">An unresolved condition tree</span></span>                                                                              |



 

<span data-ttu-id="bd02b-276">Die zurückgegebene Anfangsbedingungsstruktur ist nicht aufgelöst.</span><span class="sxs-lookup"><span data-stu-id="bd02b-276">The initial condition tree that is returned is unresolved.</span></span> <span data-ttu-id="bd02b-277">In einer nicht aufgelösten Bedingungsstruktur werden Datums- und Uhrzeitverweise wie `date:yesterday` nicht in absolute Zeit konvertiert.</span><span class="sxs-lookup"><span data-stu-id="bd02b-277">In an unresolved condition tree, date and time references, such as `date:yesterday`, are not converted to absolute time.</span></span> <span data-ttu-id="bd02b-278">Außerdem werden virtuelle Eigenschaften nicht erweitert.</span><span class="sxs-lookup"><span data-stu-id="bd02b-278">Also, virtual properties are not expanded.</span></span> <span data-ttu-id="bd02b-279">Virtuelle Eigenschaften sind Eigenschaften, die als Aggregate mehrerer Eigenschaften fungieren.</span><span class="sxs-lookup"><span data-stu-id="bd02b-279">Virtual properties are properties that act as aggregates of multiple properties.</span></span>

<span data-ttu-id="bd02b-280">Die Abfrage erzeugt beispielsweise `kind:email from:reljai` die folgenden nicht aufgelösten und aufgelösten Bedingungsstrukturen.</span><span class="sxs-lookup"><span data-stu-id="bd02b-280">For example, the query `kind:email from:reljai` produces the following unresolved and resolved condition trees.</span></span> <span data-ttu-id="bd02b-281">Die nicht aufgelöste Bedingungsstruktur befindet sich links, und die aufgelöste Bedingungsstruktur befindet sich rechts.</span><span class="sxs-lookup"><span data-stu-id="bd02b-281">The unresolved condition tree is to the left, and the resolved condition tree is to the right.</span></span>

![Nicht aufgelöste und aufgelöste Bedingungsstrukturen](images/conditiontree.png)

<span data-ttu-id="bd02b-283">Die aufgelöste Struktur kann durch Aufrufen von [**IConditionFactory::Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve)abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="bd02b-283">The resolved tree can be obtained by calling [**IConditionFactory::Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span></span> <span data-ttu-id="bd02b-284">Bei der Übergabe von [**SQRO \_ DONT \_ RESOLVE \_ DATETIME**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) bleiben Datum und Uhrzeit jedoch ungelöst.</span><span class="sxs-lookup"><span data-stu-id="bd02b-284">However, passing [**SQRO\_DONT\_RESOLVE\_DATETIME**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) leaves the date and time unresolved.</span></span> <span data-ttu-id="bd02b-285">Eine nicht aufgelöste Bedingungsstruktur bietet Vorteile, da eine nicht aufgelöste Bedingungsstruktur Informationen über die Abfrage enthält.</span><span class="sxs-lookup"><span data-stu-id="bd02b-285">There are advantages to an unresolved condition tree, because an unresolved condition tree contains information about the query.</span></span> <span data-ttu-id="bd02b-286">Jeder Blattknoten zeigt auf die von [**IQuerySolution::GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata)zurückgegebenen Token, die der Eigenschaft, dem Operator und dem Wert entsprechen, wenn die [**IRichChunk-Schnittstelle**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="bd02b-286">Each leaf node points to the tokens returned by [**IQuerySolution::GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), which correspond to the property, operator, and value when using the [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) interface.</span></span> <span data-ttu-id="bd02b-287">Das folgende Beispiel zeigt ...</span><span class="sxs-lookup"><span data-stu-id="bd02b-287">The following example shows ...</span></span>


```C++
    interface ITokenCollection : IUnknown
    {
        HRESULT NumberOfTokens(ULONG* pCount);
        HRESULT GetToken([in] ULONG i, [out, annotation("__out_opt")] ULONG* pBegin, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz);
    };

ICondition:: GetInputTerms([out, annotation("__out_opt")] 
IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] 
IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] 
IRichChunk** ppValueTerm);

    interface IRichChunk : IUnknown
    {
        HRESULT GetData([out, annotation("__out_opt")] ULONG* pFirstPos, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz, [out, annotation("__out_opt")] PROPVARIANT* pValue);
    }
```



### <a name="querying-the-index"></a><span data-ttu-id="bd02b-288">Abfragen des Index</span><span class="sxs-lookup"><span data-stu-id="bd02b-288">Querying the Index</span></span>

<span data-ttu-id="bd02b-289">Es gibt mehrere Ansätze zum Abfragen des Indexes.</span><span class="sxs-lookup"><span data-stu-id="bd02b-289">There are several approaches to querying the index.</span></span> <span data-ttu-id="bd02b-290">Einige basieren auf SQL, andere auf AQS.</span><span class="sxs-lookup"><span data-stu-id="bd02b-290">Some are based on the SQL and others are based on AQS.</span></span> <span data-ttu-id="bd02b-291">Sie können den Index Windows Search auch programmgesteuert abfragen, indem Sie [Schnittstellen abfragen.](./-search-querying-interfaces-entry-page.md)</span><span class="sxs-lookup"><span data-stu-id="bd02b-291">You can also query the Windows Search index programmatically by using [querying interfaces](./-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="bd02b-292">Es gibt drei Schnittstellen, die für das Abfragen des Index spezifisch sind: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization)und [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span><span class="sxs-lookup"><span data-stu-id="bd02b-292">There are three interfaces that are specific to querying the index: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization), and [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span></span> <span data-ttu-id="bd02b-293">Konzeptionelle Informationen finden Sie unter [Programmgesteuertes Abfragen des Indexes.](-search-3x-wds-qryidx-overview.md)</span><span class="sxs-lookup"><span data-stu-id="bd02b-293">For conceptual information, see [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

<span data-ttu-id="bd02b-294">Sie können eine Komponente oder Hilfsklasse entwickeln, um den Index mithilfe der [**ISearchQueryHelper-Schnittstelle abfragen zu**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) können.</span><span class="sxs-lookup"><span data-stu-id="bd02b-294">You can develop a component or helper class to query the index by using the [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) interface.</span></span> <span data-ttu-id="bd02b-295">Diese Schnittstelle wird als Hilfsklasse für [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (und [**ISearchCatalogManager2)**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)implementiert und wird durch Aufrufen von [**ISearchCatalogManager::GetQueryHelper erhalten.**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper)</span><span class="sxs-lookup"><span data-stu-id="bd02b-295">This interface is implemented as a helper class to [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (and [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)), and is obtained by calling [**ISearchCatalogManager::GetQueryHelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span></span> <span data-ttu-id="bd02b-296">Konzeptionelle Informationen finden Sie unter [Querying the Index with ISearchQueryHelper (Abfragen des Index mit ISearchQueryHelper).](-search-3x-wds-qryidx-searchqueryhelper.md)</span><span class="sxs-lookup"><span data-stu-id="bd02b-296">For conceptual information, see [Querying the Index with ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span></span>

<span data-ttu-id="bd02b-297">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) ermöglicht Ihnen:</span><span class="sxs-lookup"><span data-stu-id="bd02b-297">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) permits you to:</span></span>

-   <span data-ttu-id="bd02b-298">Abrufen einer OLE DB Verbindungszeichenfolge zum Herstellen einer Verbindung mit der Windows Search Datenbank.</span><span class="sxs-lookup"><span data-stu-id="bd02b-298">Obtain an OLE DB connection string to connect to the Windows Search database.</span></span>
-   <span data-ttu-id="bd02b-299">Konvertieren Sie AQS-Benutzerabfragen in Windows Search SQL.</span><span class="sxs-lookup"><span data-stu-id="bd02b-299">Convert AQS user queries to Windows Search SQL.</span></span>
-   <span data-ttu-id="bd02b-300">Geben Sie Abfrageeinschränkungen an, die in SQL, aber nicht in AQS ausgedrückt werden können.</span><span class="sxs-lookup"><span data-stu-id="bd02b-300">Specify query restrictions that can be expressed in SQL but not in AQS.</span></span>

<span data-ttu-id="bd02b-301">Indizierungspriorisierungs- und Rowsetereignisse werden in Windows 7 und höher unterstützt.</span><span class="sxs-lookup"><span data-stu-id="bd02b-301">Indexing prioritization and rowset events are supported in Windows 7 and later.</span></span> <span data-ttu-id="bd02b-302">Mit [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) gibt es einen Prioritätsstapel, mit dem der Client anfordern kann, dass die in einer bestimmten Abfrage verwendeten Bereiche eine höhere Priorität als die normale Priorität erhalten.</span><span class="sxs-lookup"><span data-stu-id="bd02b-302">With [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) there is a priority stack that enables the client to request that the scopes used in a particular query be given higher than normal priority.</span></span> <span data-ttu-id="bd02b-303">[**IRowsetEvents bietet**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) Benachrichtigungen über Änderungen an Elementen in Rowsets, einschließlich des Hinzufügens neuer Elemente, des Löschens von Elementen und der Änderung von Elementdaten.</span><span class="sxs-lookup"><span data-stu-id="bd02b-303">[**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) provides notification of changes to items in rowsets, including the addition of new items, the deletion of items, and the modification of item data.</span></span> <span data-ttu-id="bd02b-304">Durch die Verwendung von Rowsetereignisbenachrichtigungen wird sichergestellt, dass die Ergebnisse für vorhandene Abfragen so aktuell wie möglich sind.</span><span class="sxs-lookup"><span data-stu-id="bd02b-304">Using rowset event notifications ensures that the results for existing queries are as up to date as possible.</span></span> <span data-ttu-id="bd02b-305">Konzeptionelle Informationen finden Sie unter [Indizierungspriorisierung und Rowsetereignisse in Windows 7.](indexing-prioritization-and-rowset-events.md)</span><span class="sxs-lookup"><span data-stu-id="bd02b-305">For conceptual information, see [Indexing Prioritization and Rowset Events in Windows 7](indexing-prioritization-and-rowset-events.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="bd02b-306">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="bd02b-306">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bd02b-307">Indizierung, Abfrage und Benachrichtigungen in Windows Search</span><span class="sxs-lookup"><span data-stu-id="bd02b-307">Indexing, Querying and Notifications in Windows Search</span></span>](-search-3x-wds-included-in-index.md)
</dt> <dt>

[<span data-ttu-id="bd02b-308">Was ist im Index enthalten?</span><span class="sxs-lookup"><span data-stu-id="bd02b-308">What is Included in the Index</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="bd02b-309">Indizierungsprozess in Windows Search</span><span class="sxs-lookup"><span data-stu-id="bd02b-309">Indexing Process in Windows Search</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="bd02b-310">Benachrichtigungsprozess in Windows Search</span><span class="sxs-lookup"><span data-stu-id="bd02b-310">Notifications Process in Windows Search</span></span>](-search-3x-wds-support.md)
</dt> <dt>

[<span data-ttu-id="bd02b-311">Anforderungen an die URL-Formatierung</span><span class="sxs-lookup"><span data-stu-id="bd02b-311">URL Formatting Requirements</span></span>](url-formatting-requirements.md)
</dt> </dl>

 

 
