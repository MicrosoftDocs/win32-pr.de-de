---
description: Es ist wichtig, dass Sie die erforderliche DLL-Struktur eines Filter Handlers verstehen (eine Implementierung der IFilter-Schnittstelle).
ms.assetid: a2b5a813-573a-44d3-8780-99603e3246c1
title: Implementieren von Filter Handlern in Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bc5f326440b31b62ff5697274962f4d4a2cfe7c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106346078"
---
# <a name="implementing-filter-handlers-in-windows-search"></a><span data-ttu-id="81dd7-103">Implementieren von Filter Handlern in Windows Search</span><span class="sxs-lookup"><span data-stu-id="81dd7-103">Implementing Filter Handlers in Windows Search</span></span>

<span data-ttu-id="81dd7-104">Es ist wichtig, dass Sie die erforderliche DLL-Struktur eines Filter Handlers verstehen (eine Implementierung der [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle).</span><span class="sxs-lookup"><span data-stu-id="81dd7-104">It is important that you understand the required DLL structure of a filter handler (an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span>

<span data-ttu-id="81dd7-105">Dieses Thema ist wie folgt organisiert:</span><span class="sxs-lookup"><span data-stu-id="81dd7-105">This topic is organized as follows:</span></span>

- [<span data-ttu-id="81dd7-106">Implementieren und Exportieren der DLL-Einstiegspunkte</span><span class="sxs-lookup"><span data-stu-id="81dd7-106">Implementing and Exporting the DLL Entry Points</span></span>](#implementing-and-exporting-the-dll-entry-points)
- [<span data-ttu-id="81dd7-107">Implementieren der IFilter-Klasse und der Klassenfactory</span><span class="sxs-lookup"><span data-stu-id="81dd7-107">Implementing the IFilter Class and Class Factory</span></span>](#implementing-the-ifilter-class-and-class-factory)
- [<span data-ttu-id="81dd7-108">Vererbung der COM-Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="81dd7-108">Inheriting the COM Interfaces</span></span>](#inheriting-the-com-interfaces)
- [<span data-ttu-id="81dd7-109">Implementieren der Methoden der COM-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="81dd7-109">Implementing the COM Interface Methods</span></span>](#implementing-the-com-interface-methods)
  - [<span data-ttu-id="81dd7-110">Nicht implementierte com-Methoden</span><span class="sxs-lookup"><span data-stu-id="81dd7-110">COM Methods that are not Implemented</span></span>](#com-methods-that-are-not-implemented)
- [<span data-ttu-id="81dd7-111">Weitere Ressourcen</span><span class="sxs-lookup"><span data-stu-id="81dd7-111">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="81dd7-112">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="81dd7-112">Related topics</span></span>](#related-topics)

## <a name="implementing-and-exporting-the-dll-entry-points"></a><span data-ttu-id="81dd7-113">Implementieren und Exportieren der DLL-Einstiegspunkte</span><span class="sxs-lookup"><span data-stu-id="81dd7-113">Implementing and Exporting the DLL Entry Points</span></span>

<span data-ttu-id="81dd7-114">Jede [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -dll (durch Ifilter.dll in diesem Abschnitt bezeichnet) muss die folgenden Einstiegspunkte implementieren und exportieren.</span><span class="sxs-lookup"><span data-stu-id="81dd7-114">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL (denoted by Ifilter.dll in this section) must implement and export the following entry points.</span></span> <span data-ttu-id="81dd7-115">Diese Einstiegspunkte werden in der Regel mit einer Modul Definitionsdatei (. def) für die **IFilter** -Schnittstelle oder mit dem **\_ \_ declspec (dllexport)** -Schlüsselwort exportiert.</span><span class="sxs-lookup"><span data-stu-id="81dd7-115">These entry points are typically exported using a module-definition (.def) file for the **IFilter** interface or by using the **\_\_declspec(dllexport)** keyword.</span></span> <span data-ttu-id="81dd7-116">Die DLL-Datei kann in einem beliebigen Ordner registriert werden, befindet sich jedoch in der Regel im Ordner "% SystemRoot% \\ system32".</span><span class="sxs-lookup"><span data-stu-id="81dd7-116">The DLL file can be registered to be in any folder, but it usually resides in the %SystemRoot%\\system32 folder.</span></span>

<span data-ttu-id="81dd7-117">DLL-Einstiegspunkte werden in der folgenden Tabelle aufgelistet und beschrieben.</span><span class="sxs-lookup"><span data-stu-id="81dd7-117">DLL entry points are listed and described in the following table.</span></span>

| <span data-ttu-id="81dd7-118">DLL-Name</span><span class="sxs-lookup"><span data-stu-id="81dd7-118">DLL name</span></span>                                                                                     | <span data-ttu-id="81dd7-119">DLL-beschreibung</span><span class="sxs-lookup"><span data-stu-id="81dd7-119">DLL description</span></span>                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="81dd7-120">DllRegisterServer</span><span class="sxs-lookup"><span data-stu-id="81dd7-120">DllRegisterServer</span></span>](/windows/win32/api/olectl/nf-olectl-dllregisterserver)            | <span data-ttu-id="81dd7-121">Der [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) -Einstiegspunkt registriert die dll als Filter in der Registrierung.</span><span class="sxs-lookup"><span data-stu-id="81dd7-121">The [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) entry point registers the DLL as a filter in the registry.</span></span> <span data-ttu-id="81dd7-122">Sie registrieren die dll, indem Sie das regsvr32.exe Programm mit dem Dateinamen der [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle als Argument ausführen: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="81dd7-122">You register the DLL by running the regsvr32.exe program with the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface DLL file name as an argument: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span></span>                                              |
| [<span data-ttu-id="81dd7-123">DllUnregisterServer-Funktion</span><span class="sxs-lookup"><span data-stu-id="81dd7-123">DllUnregisterServer Function</span></span>](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) | <span data-ttu-id="81dd7-124">Der Einstiegspunkt der [DllUnregisterServer-Funktion](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) entfernt die dll als permanenten Handler in der Registrierung.</span><span class="sxs-lookup"><span data-stu-id="81dd7-124">The [DllUnregisterServer Function](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) entry point removes the DLL as a persistent handler in the registry.</span></span> <span data-ttu-id="81dd7-125">Sie heben die Registrierung der dll auf, indem Sie das regsvr32.exe Programm mit dem folgenden `/u` Flag ausführen: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="81dd7-125">You unregister the DLL by running the regsvr32.exe program with the `/u` flag: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span></span>                                                                                    |
| [<span data-ttu-id="81dd7-126">DllGetClassObject-Funktion</span><span class="sxs-lookup"><span data-stu-id="81dd7-126">DllGetClassObject Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)   | <span data-ttu-id="81dd7-127">Der Inhalts Indizierungs Client ruft den Einstiegspunkt der [DllGetClassObject-Funktion](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) über Component Object Model (com) auf, um ein klassenfactoryobjekt für die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle zu erstellen und einen Zeiger auf die Klassenfactoryschnittstelle dieses Objekts zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="81dd7-127">The content indexing client calls the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point, through Component Object Model (COM), to create a class factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface and to get a pointer to the class factory interface of that object.</span></span>                                               |
| [<span data-ttu-id="81dd7-128">DllCanUnloadNow-Funktion</span><span class="sxs-lookup"><span data-stu-id="81dd7-128">DllCanUnloadNow Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)     | <span data-ttu-id="81dd7-129">Der Content-Indizierungs Client ruft den [DllCanUnloadNow-Funktions](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) Einstiegspunkt über com auf, um zu bestimmen, ob es möglich ist, die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  -dll zu entladen.</span><span class="sxs-lookup"><span data-stu-id="81dd7-129">The content-indexing client calls the [DllCanUnloadNow Function](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) entry point, through COM, to determine whether it is possible to unload the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  DLL.</span></span> <span data-ttu-id="81dd7-130">Die **IFilter** -Schnittstelle wird entladen, wenn Sie für ein Zeitintervall nicht verwendet wird, wie im Registrierungs Wert filteridletimeout angegeben.</span><span class="sxs-lookup"><span data-stu-id="81dd7-130">The **IFilter** interface is unloaded after it is unused for an interval of time, as specified by the FilterIdleTimeOut registry value.</span></span> |

## <a name="implementing-the-ifilter-class-and-class-factory"></a><span data-ttu-id="81dd7-131">Implementieren der IFilter-Klasse und der Klassenfactory</span><span class="sxs-lookup"><span data-stu-id="81dd7-131">Implementing the IFilter Class and Class Factory</span></span>

<span data-ttu-id="81dd7-132">Mindestens zwei Klassen, z. b. cfilter und cfiltercf, werden in der Regel von jeder [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -dll implementiert.</span><span class="sxs-lookup"><span data-stu-id="81dd7-132">At least two classes, such as CFilter and CFilterCF, are typically implemented by each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL.</span></span> <span data-ttu-id="81dd7-133">Die cfilter-Klasse erzeugt das IFilter-Schnittstellen Objekt, das die Inhalts **Filterungs** Funktion implementiert.</span><span class="sxs-lookup"><span data-stu-id="81dd7-133">The CFilter class produces the **IFilter** interface object that implements the content-filtering functionality.</span></span> <span data-ttu-id="81dd7-134">Seine Member-Funktionen implementieren die Schnittstellen Methoden der **IFilter** -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="81dd7-134">Its member functions implement the interface methods of the **IFilter** interface.</span></span> <span data-ttu-id="81dd7-135">Jede **IFilter** -Klasse benötigt eine eindeutige Klassen-ID (CLSID), die der Implementierer der **IFilter** -Schnittstelle generiert.</span><span class="sxs-lookup"><span data-stu-id="81dd7-135">Each **IFilter** class requires a unique class identifier (CLSID), which the **IFilter** interface implementer generates.</span></span>

<span data-ttu-id="81dd7-136">Die cfiltercf-Klasse erzeugt das klassenfactoryobjekt für die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="81dd7-136">The CFilterCF class produces the class-factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="81dd7-137">Die Klassenfactory wird durch die Schnittstelle der [IClassFactory-Schnittstelle](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) durch den Einstiegspunkt der [DllGetClassObject-Funktion](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) der dll aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="81dd7-137">The class factory is called, through its [IClassFactory Interface](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, by the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point of the DLL.</span></span> <span data-ttu-id="81dd7-138">Die cfiltercf-Klasse erstellt das cfilter-Objekt und gibt einen Zeiger auf [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown)zurück.</span><span class="sxs-lookup"><span data-stu-id="81dd7-138">The CFilterCF class creates the CFilter object and returns a pointer to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="81dd7-139">In komplexeren Fällen kann ein **IFilter** eine Klassenhierarchie anstelle der einzelnen cfilter-Klasse implementieren.</span><span class="sxs-lookup"><span data-stu-id="81dd7-139">In more complex cases, an **IFilter** can implement a class hierarchy in place of the single CFilter class.</span></span>

## <a name="inheriting-the-com-interfaces"></a><span data-ttu-id="81dd7-140">Vererbung der COM-Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="81dd7-140">Inheriting the COM Interfaces</span></span>

<span data-ttu-id="81dd7-141">Windows Search 3,0 und höher erfordert die Verwendung von [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) aus den folgenden Gründen:</span><span class="sxs-lookup"><span data-stu-id="81dd7-141">Windows Search 3.0 and later require that you use [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) for the following reasons:</span></span>

- <span data-ttu-id="81dd7-142">Um Leistung und zukünftige Kompatibilität zu gewährleisten.</span><span class="sxs-lookup"><span data-stu-id="81dd7-142">To ensure performance and future compatibility.</span></span>
- <span data-ttu-id="81dd7-143">, Um die Sicherheit zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="81dd7-143">To help increase security.</span></span> <span data-ttu-id="81dd7-144">Mit [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) implementierte IFilters sind sicherer, da der Kontext, in dem die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle ausgeführt wird, nicht die Berechtigung zum Öffnen von Dateien auf dem Datenträger oder über das Netzwerk benötigt.</span><span class="sxs-lookup"><span data-stu-id="81dd7-144">IFilters implemented with [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) are more secure because the context in which the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface runs does not need the rights to open files on the disk or over the network.</span></span>
- <span data-ttu-id="81dd7-145">Obwohl bei Windows Search nur [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream)verwendet wird, kann die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) Interface-Klasse auch die [IPersistFile-Schnittstelle](/windows/win32/api/objidl/nn-objidl-ipersistfile) und/oder [IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) Interface-Implementierungen aus Gründen der Abwärtskompatibilität erben.</span><span class="sxs-lookup"><span data-stu-id="81dd7-145">While Windows Search uses only [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface class can also inherit the [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) and/or [IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) interface implementations for backward compatibility.</span></span>

<span data-ttu-id="81dd7-146">Diese Schnittstellen werden in Dateien deklariert, die aus dem MSSDK \\ include-Verzeichnis eingeschlossen werden und über vordefinierte Schnittstellen Bezeichner (IIDs) verfügen.</span><span class="sxs-lookup"><span data-stu-id="81dd7-146">These interfaces are declared in files included from the mssdk\\include directory and have pre-defined interface identifiers (IIDs).</span></span> <span data-ttu-id="81dd7-147">Der Inhalts Indizierungs Client fragt die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle über [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) ab, um zu bestimmen, welche dieser Schnittstellen beim Filtern von Inhalten verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="81dd7-147">The content-indexing client queries the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface through [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) to determine which of these interfaces to use when filtering content.</span></span>

## <a name="implementing-the-com-interface-methods"></a><span data-ttu-id="81dd7-148">Implementieren der Methoden der COM-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="81dd7-148">Implementing the COM Interface Methods</span></span>

<span data-ttu-id="81dd7-149">Die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle implementiert die [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) -Methoden für die **IFilter** -Schnittstellen Klasse und die **IFilter** -schnittstellenklassenfactory.</span><span class="sxs-lookup"><span data-stu-id="81dd7-149">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface implements the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) methods for both the **IFilter** interface class and the **IFilter** interface-class factory.</span></span> <span data-ttu-id="81dd7-150">In der folgenden Tabelle werden die Schnittstellen spezifischen Schnittstellen und Methoden der **IFilter** -Schnittstelle aufgelistet, die von der **IFilter** -Schnittstelle implementiert werden sollten.</span><span class="sxs-lookup"><span data-stu-id="81dd7-150">The following table lists, in vtable order, the **IFilter** interface-specific interfaces and methods that the **IFilter** interface should implement.</span></span> <span data-ttu-id="81dd7-151">Die **IFilter** -Schnittstelle muss mindestens [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream)implementieren, kann jedoch zusätzliche Schnittstellen, die von ipersistent abgeleitet werden, implementieren.</span><span class="sxs-lookup"><span data-stu-id="81dd7-151">The **IFilter** interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but can implement additional IPersist-derived interfaces.</span></span>

| <span data-ttu-id="81dd7-152">COM-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="81dd7-152">COM interface</span></span>                                                                             | <span data-ttu-id="81dd7-153">Methode</span><span class="sxs-lookup"><span data-stu-id="81dd7-153">Method</span></span>                                                                                                                                                                                                                                                                         |
|-------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="81dd7-154">IClassFactory-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="81dd7-154">IClassFactory Interface</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)   | <span data-ttu-id="81dd7-155">"Kreatabstance", "LockServer"</span><span class="sxs-lookup"><span data-stu-id="81dd7-155">CreateInstance, LockServer</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="81dd7-156">IClassFactory2-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="81dd7-156">IClassFactory2 Interface</span></span>](/windows/win32/api/ocidl/nn-ocidl-iclassfactory2)  | <span data-ttu-id="81dd7-157">GetLicInfo, RequestLicKey, kreateingestancelic</span><span class="sxs-lookup"><span data-stu-id="81dd7-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span></span>                                                                                                                                                                                                                                   |
| [<span data-ttu-id="81dd7-158">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="81dd7-158">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)                                                        | <span data-ttu-id="81dd7-159">[**IFilter:: init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter:: GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter:: gettext**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter:: GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter:: BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span><span class="sxs-lookup"><span data-stu-id="81dd7-159">[**IFilter::Init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter::GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter::BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span></span> |
| [<span data-ttu-id="81dd7-160">Ipersistent-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="81dd7-160">IPersist Interface</span></span>](/windows/desktop/api/objidl/nn-objidl-ipersist)               | <span data-ttu-id="81dd7-161">GetClassID</span><span class="sxs-lookup"><span data-stu-id="81dd7-161">GetClassID</span></span>                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="81dd7-162">IPersistFile-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="81dd7-162">IPersistFile Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersistfile)    | <span data-ttu-id="81dd7-163">IsDirty, Load, Save, saveabgeschlossene, getcurrfile</span><span class="sxs-lookup"><span data-stu-id="81dd7-163">IsDirty, Load, Save, SaveCompleted, GetCurFile</span></span>                                                                                                                                                                                                                                 |
| [<span data-ttu-id="81dd7-164">IPersistStorage-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="81dd7-164">IPersistStorage Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststorage) | <span data-ttu-id="81dd7-165">IsDirty, Load, Save, GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="81dd7-165">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="81dd7-166">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="81dd7-166">IPersistStream</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststream)            | <span data-ttu-id="81dd7-167">IsDirty, Load, Save, GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="81dd7-167">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |

<span data-ttu-id="81dd7-168">Die Referenzseite für jede Methode gibt die Parameter und das funktionale Verhalten für diese Methode an.</span><span class="sxs-lookup"><span data-stu-id="81dd7-168">The reference page for each method specifies the parameters and functional behavior for that method.</span></span> <span data-ttu-id="81dd7-169">Jede Verweisseite gibt auch die Ergebnis Codes an, die für diese Methode implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="81dd7-169">Each reference page also gives the result codes to implement for that method.</span></span> <span data-ttu-id="81dd7-170">Die Verweis Seiten für die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Methoden geben die schnittstellenspezifischen [Codes in den \_ in der Einrichtung](../com/codes-in-facility-itf.md) -Ergebnis Codes-Ergebnis Codes implementierten Codes an, und der Inhalts Indizierungs Client kann auch jeden der allgemeinen Ergebnis Codes verarbeiten, wie z. b. die Funktion \_ null und die Win32-Anlage \_ .</span><span class="sxs-lookup"><span data-stu-id="81dd7-170">The reference pages for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) methods give the interface-specific [Codes in FACILITY\_ITF](../com/codes-in-facility-itf.md) result codes to be implemented, and the content-indexing client can also handle any of the generic result codes, such as FACILITY\_NULL and FACILITY\_WIN32.</span></span> <span data-ttu-id="81dd7-171">Weitere Informationen finden Sie unter [Struktur von com-Fehler Codes](../com/structure-of-com-error-codes.md).</span><span class="sxs-lookup"><span data-stu-id="81dd7-171">For more information, see [Structure of COM Error Codes](../com/structure-of-com-error-codes.md).</span></span>

### <a name="com-methods-that-are-not-implemented"></a><span data-ttu-id="81dd7-172">Nicht implementierte com-Methoden</span><span class="sxs-lookup"><span data-stu-id="81dd7-172">COM Methods that are not Implemented</span></span>

<span data-ttu-id="81dd7-173">Die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle muss mindestens [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream)implementieren, aber es müssen keine weiteren von ipersistent abgeleiteten Schnittstellen implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="81dd7-173">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but does not need to implement additional IPersist-derived interfaces.</span></span>

<span data-ttu-id="81dd7-174">Die in der folgenden Tabelle aufgeführten com-Methoden müssen von Windows Search nicht implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="81dd7-174">Windows Search does not need to implement the COM methods listed in the following table.</span></span>

| <span data-ttu-id="81dd7-175">Nicht erforderliche Methode</span><span class="sxs-lookup"><span data-stu-id="81dd7-175">Method that is not required</span></span>                               | <span data-ttu-id="81dd7-176">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="81dd7-176">Description</span></span>                       |
|-----------------------------------------------------------|-----------------------------------|
| <span data-ttu-id="81dd7-177">IPersistStream:: IsDirty</span><span class="sxs-lookup"><span data-stu-id="81dd7-177">IPersistStream::IsDirty</span></span>                                   | <span data-ttu-id="81dd7-178">Filter sollten E \_ notimpl zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="81dd7-178">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="81dd7-179">IPersistStream:: Save</span><span class="sxs-lookup"><span data-stu-id="81dd7-179">IPersistStream::Save</span></span>                                      | <span data-ttu-id="81dd7-180">Filter sollten E \_ notimpl zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="81dd7-180">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="81dd7-181">IPersistStream:: GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="81dd7-181">IPersistStream::GetSizeMax</span></span>                                | <span data-ttu-id="81dd7-182">Filter sollten E \_ notimpl zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="81dd7-182">Filters should return E\_NOTIMPL.</span></span> |
| [<span data-ttu-id="81dd7-183">**IFilter:: BindRegion**</span><span class="sxs-lookup"><span data-stu-id="81dd7-183">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="81dd7-184">Filter sollten E \_ notimpl zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="81dd7-184">Filters should return E\_NOTIMPL.</span></span> |

## <a name="additional-resources"></a><span data-ttu-id="81dd7-185">Weitere Ressourcen</span><span class="sxs-lookup"><span data-stu-id="81dd7-185">Additional Resources</span></span>

- <span data-ttu-id="81dd7-186">Das in [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample)verfügbare [ifiltersample](-search-sample-ifiltersample.md) -Codebeispiel veranschaulicht, wie eine IFilter-Basisklasse für die Implementierung der [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="81dd7-186">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="81dd7-187">Eine Übersicht über den Indizierungsprozess finden Sie [im Abschnitt zur Indizierung](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="81dd7-187">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="81dd7-188">Eine Übersicht über die Dateitypen finden Sie unter [Dateitypen](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="81dd7-188">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="81dd7-189">Informationen zum Abfragen von Datei Zuordnungs Attributen für einen Dateityp finden Sie unter " [wahrtentypen", "systemfileassociation" und "Anwendungs Registrierung](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85))".</span><span class="sxs-lookup"><span data-stu-id="81dd7-189">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="81dd7-190">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="81dd7-190">Related topics</span></span>

[<span data-ttu-id="81dd7-191">Entwickeln von Filter Handlern</span><span class="sxs-lookup"><span data-stu-id="81dd7-191">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="81dd7-192">Grundlegendes zu Filter Handlern in Windows Search</span><span class="sxs-lookup"><span data-stu-id="81dd7-192">Understanding Filter Handlers in Windows Search</span></span>](-search-ifilter-about.md)

[<span data-ttu-id="81dd7-193">Bewährte Methoden zum Erstellen von Filter Handlern in Windows Search</span><span class="sxs-lookup"><span data-stu-id="81dd7-193">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="81dd7-194">Zurückgeben von Eigenschaften aus einem Filter Handler</span><span class="sxs-lookup"><span data-stu-id="81dd7-194">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="81dd7-195">Filtern von Handlern, die mit Windows ausgeliefert werden</span><span class="sxs-lookup"><span data-stu-id="81dd7-195">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="81dd7-196">Registrieren von Filter Handlern</span><span class="sxs-lookup"><span data-stu-id="81dd7-196">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="81dd7-197">Testen von Filter Handlern</span><span class="sxs-lookup"><span data-stu-id="81dd7-197">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
