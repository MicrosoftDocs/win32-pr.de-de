---
description: Filter Handler, bei denen es sich um Implementierungen der IFilter-Schnittstelle handelt, Scannen Dokumente nach Text und Eigenschaften.
ms.assetid: 2ee9ea19-ae03-4f14-8f06-f8aa670e204e
title: Grundlegendes zu Filter Handlern in Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e49cc1d3e479ae03645665618c60a33bdcfe19ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104525520"
---
# <a name="understanding-filter-handlers-in-windows-search"></a><span data-ttu-id="6c3db-103">Grundlegendes zu Filter Handlern in Windows Search</span><span class="sxs-lookup"><span data-stu-id="6c3db-103">Understanding Filter Handlers in Windows Search</span></span>

<span data-ttu-id="6c3db-104">Filter Handler, bei denen es sich um Implementierungen der [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle handelt, Scannen Dokumente nach Text und Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="6c3db-104">Filter handlers, which are implementations of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface, scan documents for text and properties.</span></span> <span data-ttu-id="6c3db-105">Filter Handler extrahieren Textabschnitte aus diesen Elementen, Filtern eingebettete Formatierungen und behalten Informationen zur Position des Texts bei.</span><span class="sxs-lookup"><span data-stu-id="6c3db-105">Filter handlers extract chunks of text from these items, filtering out embedded formatting and retaining information about the position of the text.</span></span> <span data-ttu-id="6c3db-106">Sie extrahieren auch Blöcke von Werten, die Dokumenteigenschaften sind.</span><span class="sxs-lookup"><span data-stu-id="6c3db-106">They also extract chunks of values, which are document properties.</span></span> <span data-ttu-id="6c3db-107">**IFilter** ist die Grundlage für das Entwickeln von Anwendungen höherer Ebene, z. b. dokumentindexer und Anwendungs unabhängige Viewer.</span><span class="sxs-lookup"><span data-stu-id="6c3db-107">**IFilter** is the foundation for building higher-level applications such as document indexers and application-independent viewers.</span></span>

<span data-ttu-id="6c3db-108">Dieses Thema ist wie folgt organisiert:</span><span class="sxs-lookup"><span data-stu-id="6c3db-108">This topic is organized as follows:</span></span>

- [<span data-ttu-id="6c3db-109">Informationen zur IFilter-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="6c3db-109">About the IFilter Interface</span></span>](#about-the-ifilter-interface)
  - [<span data-ttu-id="6c3db-110">Isolations Prozess</span><span class="sxs-lookup"><span data-stu-id="6c3db-110">Isolation Process</span></span>](#isolation-process)
  - [<span data-ttu-id="6c3db-111">IFilter-DLLs</span><span class="sxs-lookup"><span data-stu-id="6c3db-111">IFilter DLLs</span></span>](#ifilter-dlls)
  - [<span data-ttu-id="6c3db-112">IFilter-Struktur</span><span class="sxs-lookup"><span data-stu-id="6c3db-112">IFilter Structure</span></span>](#ifilter-structure)
  - [<span data-ttu-id="6c3db-113">Nativer Code</span><span class="sxs-lookup"><span data-stu-id="6c3db-113">Native Code</span></span>](#native-code)
- [<span data-ttu-id="6c3db-114">Suchen des IFilter-Klassen Bezeichners</span><span class="sxs-lookup"><span data-stu-id="6c3db-114">Finding the IFilter Class Identifier</span></span>](#finding-the-ifilter-class-identifier)
  - [<span data-ttu-id="6c3db-115">IFilter:: GetChunk-und locale-Code Bezeichner</span><span class="sxs-lookup"><span data-stu-id="6c3db-115">IFilter::GetChunk and Locale Code Identifiers</span></span>](#ifiltergetchunk-and-locale-code-identifiers)
- [<span data-ttu-id="6c3db-116">Weitere Ressourcen</span><span class="sxs-lookup"><span data-stu-id="6c3db-116">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="6c3db-117">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="6c3db-117">Related topics</span></span>](#related-topics)

## <a name="about-the-ifilter-interface"></a><span data-ttu-id="6c3db-118">Informationen zur IFilter-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="6c3db-118">About the IFilter Interface</span></span>

<span data-ttu-id="6c3db-119">Microsoft Windows Search verwendet Filter zum Extrahieren des Inhalts von Elementen für die Aufnahme in einen Volltextindex.</span><span class="sxs-lookup"><span data-stu-id="6c3db-119">Microsoft Windows Search uses filters to extract the content of items for inclusion in a full-text index.</span></span> <span data-ttu-id="6c3db-120">Sie können Windows Search erweitern, um neue oder proprietäre Dateitypen zu indizieren, indem Sie Filter zum Extrahieren des Inhalts schreiben und Eigenschaften Handler, um die Eigenschaften von Dateien zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="6c3db-120">You can extend Windows Search to index new or proprietary file types by writing filters to extract the content, and property handlers to extract the properties of files.</span></span>

<span data-ttu-id="6c3db-121">Die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle ist so konzipiert, dass Sie den spezifischen Anforderungen der Volltext-Suchmaschinen entspricht.</span><span class="sxs-lookup"><span data-stu-id="6c3db-121">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface is designed to meet the specific needs of full-text search engines.</span></span> <span data-ttu-id="6c3db-122">Volltext-Suchmaschinen wie Windows Search nennen die **IFilter** -Methoden, um Text-und Eigenschafts Informationen zu extrahieren und Sie einem Index hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-122">Full-text search engines like Windows Search call the **IFilter** methods to extract text and property information and add them to an index.</span></span> <span data-ttu-id="6c3db-123">Windows Search unterbricht die Ergebnisse der zurückgegebenen [**IFilter:: gettext**](/windows/win32/api/filter/nf-filter-ifilter-gettext) -Methode in Wörter, normalisiert Sie und speichert Sie in einem Index.</span><span class="sxs-lookup"><span data-stu-id="6c3db-123">Windows Search breaks the results of the returned [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext) method into words, normalizes them, and saves them in an index.</span></span> <span data-ttu-id="6c3db-124">Falls verfügbar, verwendet die Suchmaschine den Sprachcode Bezeichner (Language Code Identifier, LCID) eines Text Abschnitts, um die sprachspezifische Wörter Trennung und-Normalisierung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-124">If available, the search engine uses the language code identifier (LCID) of a text chunk to perform language-specific word breaking and normalization.</span></span>

<span data-ttu-id="6c3db-125">Windows Search verwendet drei Funktionen, die in der folgenden Tabelle beschrieben werden, um auf registrierte Filter Handler (Implementierungen der [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle) zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-125">Windows Search uses three functions, described in the following table, to access registered filter handlers (implementations of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span> <span data-ttu-id="6c3db-126">Diese Funktionen sind besonders nützlich, wenn der Filter Handler eines eingebetteten Objekts geladen und gebunden wird.</span><span class="sxs-lookup"><span data-stu-id="6c3db-126">These functions are especially useful when loading and binding to an embedded object's filter handler.</span></span>

| <span data-ttu-id="6c3db-127">Funktion</span><span class="sxs-lookup"><span data-stu-id="6c3db-127">Function</span></span>               | <span data-ttu-id="6c3db-128">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="6c3db-128">Description</span></span>                                                                                                                                                                                               |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6c3db-129">Loadifilter</span><span class="sxs-lookup"><span data-stu-id="6c3db-129">LoadIFilter</span></span>            | <span data-ttu-id="6c3db-130">Ruft einen Zeiger auf den [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ab, der für den angegebenen Inhaltstyp am besten geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="6c3db-130">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for the specified content type.</span></span>                                                                                            |
| <span data-ttu-id="6c3db-131">Bindifilterfromstorage</span><span class="sxs-lookup"><span data-stu-id="6c3db-131">BindIFilterFromStorage</span></span> | <span data-ttu-id="6c3db-132">Ruft einen Zeiger auf den [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ab, der sich am besten für den Inhalt eignet, der in einem [IStorage-Schnittstellen](/windows/win32/api/objidl/nn-objidl-istorage) Objekt enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="6c3db-132">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for the content contained in an [IStorage Interface](/windows/win32/api/objidl/nn-objidl-istorage) object.</span></span> |
| <span data-ttu-id="6c3db-133">Bindifilterfromstream</span><span class="sxs-lookup"><span data-stu-id="6c3db-133">BindIFilterFromStream</span></span>  | <span data-ttu-id="6c3db-134">Ruft einen Zeiger auf den [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ab, der am besten für eine angegebene Klassen-ID (CLSID) geeignet ist, die aus einer Datenstrom Variablen abgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="6c3db-134">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for a specified class identifier (CLSID) retrieved from a stream variable.</span></span>                                                 |

<span data-ttu-id="6c3db-135">Die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle verfügt über fünf Methoden, die in der folgenden Tabelle beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="6c3db-135">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface has five methods, described in the following table.</span></span>

| <span data-ttu-id="6c3db-136">Methode</span><span class="sxs-lookup"><span data-stu-id="6c3db-136">Method</span></span>                                                    | <span data-ttu-id="6c3db-137">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="6c3db-137">Description</span></span>                                                                                                        |
|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6c3db-138">**IFilter:: init**</span><span class="sxs-lookup"><span data-stu-id="6c3db-138">**IFilter::Init**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-init)          | <span data-ttu-id="6c3db-139">Initialisiert eine Filter Sitzung.</span><span class="sxs-lookup"><span data-stu-id="6c3db-139">Initializes a filtering session.</span></span>                                                                                   |
| [<span data-ttu-id="6c3db-140">**IFilter:: GetChunk**</span><span class="sxs-lookup"><span data-stu-id="6c3db-140">**IFilter::GetChunk**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getchunk)     | <span data-ttu-id="6c3db-141">Positioniert [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) am Anfang des ersten oder nächsten Blocks und gibt einen Deskriptor zurück.</span><span class="sxs-lookup"><span data-stu-id="6c3db-141">Positions [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) at the beginning of the first or next chunk and returns a descriptor.</span></span> |
| [<span data-ttu-id="6c3db-142">**IFilter:: gettext**</span><span class="sxs-lookup"><span data-stu-id="6c3db-142">**IFilter::GetText**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-gettext)       | <span data-ttu-id="6c3db-143">Ruft Text aus dem aktuellen Segment ab.</span><span class="sxs-lookup"><span data-stu-id="6c3db-143">Retrieves text from the current chunk.</span></span>                                                                             |
| [<span data-ttu-id="6c3db-144">**IFilter:: GetValue**</span><span class="sxs-lookup"><span data-stu-id="6c3db-144">**IFilter::GetValue**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getvalue)     | <span data-ttu-id="6c3db-145">Ruft Werte aus dem aktuellen Segment ab.</span><span class="sxs-lookup"><span data-stu-id="6c3db-145">Retrieves values from the current chunk.</span></span>                                                                           |
| [<span data-ttu-id="6c3db-146">**IFilter:: BindRegion**</span><span class="sxs-lookup"><span data-stu-id="6c3db-146">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="6c3db-147">Ruft eine Schnittstelle ab, die den angegebenen Teil des Objekts darstellt.</span><span class="sxs-lookup"><span data-stu-id="6c3db-147">Retrieves an interface representing the specified portion of object.</span></span> <span data-ttu-id="6c3db-148">Für die zukünftige Verwendung reserviert.</span><span class="sxs-lookup"><span data-stu-id="6c3db-148">Reserved for future use.</span></span>                      |

### <a name="isolation-process"></a><span data-ttu-id="6c3db-149">Isolations Prozess</span><span class="sxs-lookup"><span data-stu-id="6c3db-149">Isolation Process</span></span>

<span data-ttu-id="6c3db-150">Die Windows-Suche führt IFilters im Sicherheitskontext des lokalen Systems mit eingeschränkten Rechten aus.</span><span class="sxs-lookup"><span data-stu-id="6c3db-150">Windows Search runs IFilters in the Local System security context with restricted rights.</span></span> <span data-ttu-id="6c3db-151">In diesem [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) Host-Isolations Prozess werden eine Reihe von rechten entfernt:</span><span class="sxs-lookup"><span data-stu-id="6c3db-151">In this [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) host isolation process, a number of rights are removed:</span></span>

- <span data-ttu-id="6c3db-152">Eingeschränkter Code</span><span class="sxs-lookup"><span data-stu-id="6c3db-152">Restricted Code</span></span>
- <span data-ttu-id="6c3db-153">Jeder</span><span class="sxs-lookup"><span data-stu-id="6c3db-153">Everyone</span></span>
- <span data-ttu-id="6c3db-154">Lokal</span><span class="sxs-lookup"><span data-stu-id="6c3db-154">Local</span></span>
- <span data-ttu-id="6c3db-155">Interactive</span><span class="sxs-lookup"><span data-stu-id="6c3db-155">Interactive</span></span>
- <span data-ttu-id="6c3db-156">Authentifizierte Benutzer</span><span class="sxs-lookup"><span data-stu-id="6c3db-156">Authenticated Users</span></span>
- <span data-ttu-id="6c3db-157">Integrierte Benutzer</span><span class="sxs-lookup"><span data-stu-id="6c3db-157">Built-in Users</span></span>
- <span data-ttu-id="6c3db-158">Sicherheits-ID (SID) des Benutzers</span><span class="sxs-lookup"><span data-stu-id="6c3db-158">Users' security identifier (SID)</span></span>

<span data-ttu-id="6c3db-159">Das Entfernen dieser Rechte bedeutet, dass die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle keinen Zugriff auf das Datenträger System oder das Netzwerk oder auf eine Benutzeroberfläche oder Zwischenablage Funktionen hat.</span><span class="sxs-lookup"><span data-stu-id="6c3db-159">The removal of these rights means the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface does not have access to the disk system or network or to any user interface or clipboard functions.</span></span> <span data-ttu-id="6c3db-160">Außerdem wird der Isolations Prozess unter einem Job-Objekt ausgeführt, das verhindert, dass untergeordnete Prozesse erstellt werden, und es wird ein Grenzwert von 100 MB für das Workingset erzwungen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-160">Furthermore, the isolation process runs under a job object that prevents child processes from being created and imposes a 100 MB limit on the working set.</span></span> <span data-ttu-id="6c3db-161">der Host Isolations Prozess der **IFilter** -Schnittstelle erhöht die Stabilität der Indizierungs Plattform, weil falsch implementierte Filter von Drittanbietern möglich sind.</span><span class="sxs-lookup"><span data-stu-id="6c3db-161">the **IFilter** interface host isolation process increases the stability of the indexing platform, due to the possibility of incorrectly implemented third-party filters.</span></span>

> [!NOTE]  
> <span data-ttu-id="6c3db-162">Filter Handler müssen geschrieben werden, um Puffer zu verwalten und ordnungsgemäß Stapel zu stellen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-162">Filter handlers must be written to manage buffers, and stack correctly.</span></span> <span data-ttu-id="6c3db-163">Alle Zeichen folgen Kopien müssen über explizite Überprüfungen zum Schutz vor Pufferüberläufen verfügen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-163">All string copies must have explicit checks to guard against buffer overruns.</span></span> <span data-ttu-id="6c3db-164">Sie sollten immer die zugeordnete Größe des Puffers überprüfen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-164">You should always verify the allocated size of the buffer.</span></span> <span data-ttu-id="6c3db-165">Sie sollten immer die Größe der Daten mit der Größe des Puffers testen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-165">You should always test the size of the data against the size of the buffer.</span></span>

### <a name="ifilter-dlls"></a><span data-ttu-id="6c3db-166">IFilter-DLLs</span><span class="sxs-lookup"><span data-stu-id="6c3db-166">IFilter DLLs</span></span>

<span data-ttu-id="6c3db-167">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLLs implementieren die **IFilter** -Schnittstelle, um es einem Client zu ermöglichen, Text-und Eigenschafts Wert Informationen aus einem Dateityp, einer Klasse oder einem erkannten Typ zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="6c3db-167">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLLs implement the **IFilter** interface to enable a client to extract text and property value information from a file type, class, or perceived type.</span></span> <span data-ttu-id="6c3db-168">Der Windows Search-Filterprozess **SearchFilterHost.exe** an den **IFilter** gebunden, der für die Klasse, den wahrgenommenen Typ oder die Namenserweiterung des Elements registriert ist.</span><span class="sxs-lookup"><span data-stu-id="6c3db-168">The Windows Search filtering process **SearchFilterHost.exe** binds to the **IFilter** that is registered for the class, perceived type, or name extension of the item.</span></span>

### <a name="ifilter-structure"></a><span data-ttu-id="6c3db-169">IFilter-Struktur</span><span class="sxs-lookup"><span data-stu-id="6c3db-169">IFilter Structure</span></span>

<span data-ttu-id="6c3db-170">Jeder [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ist eine DLL-Datei, die einen in-Process-Component Object Model (com)-Server implementiert, um die angegebenen Filterfunktionen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-170">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) is a DLL file that implements an in-process Component Object Model (COM) server to supply the specified filtering capabilities.</span></span> <span data-ttu-id="6c3db-171">In der folgenden Abbildung wird die Gesamtstruktur einer typischen **IFilter** -DLLs veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="6c3db-171">The following figure illustrates shows the overall structure of a typical **IFilter** DLLs.</span></span> <span data-ttu-id="6c3db-172">Ein komplexeres Beispiel könnte mehr als eine **IFilter** -Klasse implementieren.</span><span class="sxs-lookup"><span data-stu-id="6c3db-172">A more complex example could implement more than one **IFilter** class.</span></span>

![Diagramm der Struktur einer typischen IFilter-DLL](images/ifilter-structure.png)

### <a name="native-code"></a><span data-ttu-id="6c3db-174">nativer Code</span><span class="sxs-lookup"><span data-stu-id="6c3db-174">Native Code</span></span>

<span data-ttu-id="6c3db-175">Filter müssen in nativem Code geschrieben werden, da bei dem Prozess, in dem mehrere Add-Ins ausgeführt werden, mögliche Common Language Runtime (CLR)-Versions Probleme aufgetreten sind.</span><span class="sxs-lookup"><span data-stu-id="6c3db-175">Filters must be written in native code due to potential common language runtime (CLR) versioning issues with the process that multiple add-ins run in.</span></span> <span data-ttu-id="6c3db-176">In Windows 7 und höher und höher werden in verwaltetem Code geschriebene Filter explizit blockiert.</span><span class="sxs-lookup"><span data-stu-id="6c3db-176">In Windows 7 and later and later, filters written in managed code are explicitly blocked.</span></span>

## <a name="finding-the-ifilter-class-identifier"></a><span data-ttu-id="6c3db-177">Suchen des IFilter-Klassen Bezeichners</span><span class="sxs-lookup"><span data-stu-id="6c3db-177">Finding the IFilter Class Identifier</span></span>

<span data-ttu-id="6c3db-178">Die Klasse der [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -dll wird unter dem PersistentHandler-Registrierungsschlüssel registriert.</span><span class="sxs-lookup"><span data-stu-id="6c3db-178">The class of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL is registered under the PersistentHandler registry key.</span></span> <span data-ttu-id="6c3db-179">Im folgenden Beispiel wird für HTML-Dateien veranschaulicht, wie die **IFilter** -dll für ein HTML-Dokument gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="6c3db-179">The following example, for HTML files, illustrates how to find the **IFilter** DLL for an HTML document.</span></span> <span data-ttu-id="6c3db-180">In diesem Beispiel wird die Logik befolgt, ähnlich der, die vom System verwendet wird, um den einem Element zugeordneten **IFilter** zu suchen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-180">This example follows logic similar to that used by the system to find the **IFilter** associated with an item.</span></span>

1. <span data-ttu-id="6c3db-181">Überprüfen Sie, ob die Erweiterung für den Typ der Dateien, die die dll filtert, über einen PersistentHandler verfügt, der unter dem Registrierungs Eintrag \\ HKEY Local Machine Machines registriert ist \_ \_ \\ \\ .</span><span class="sxs-lookup"><span data-stu-id="6c3db-181">Check whether the extension for the type of files that the DLL filters has a PersistentHandler registered under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes.</span></span> <span data-ttu-id="6c3db-182">Lassen Sie uns diesen Schlüssel verwenden `Value1` .</span><span class="sxs-lookup"><span data-stu-id="6c3db-182">Let this key be `Value1`.</span></span> <span data-ttu-id="6c3db-183">Wenn dieser Eintrag bereits vorhanden ist, fahren Sie mit Schritt 4 dieses Verfahrens fort, und verwenden Sie diesen `Value1` Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="6c3db-183">If that entry already exists, then skip to step 4 of this procedure and use `Value1` in that key.</span></span> <span data-ttu-id="6c3db-184">Die Werte sind vom Typ reg \_ SZ.</span><span class="sxs-lookup"><span data-stu-id="6c3db-184">The values are of type REG\_SZ.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             .htm
                PersistentHandler
                   {EEC97550-47A9-11CF-B952-00AA0051FE20}
```

2. <span data-ttu-id="6c3db-185">Wenn kein PersistentHandler für die Erweiterung registriert ist, suchen Sie die CLSID, die dem Dokumenttyp zugeordnet ist, unter dem Registrierungs Eintrag \\ HKEY \_ local \_ Machine \\ Machines \\ .</span><span class="sxs-lookup"><span data-stu-id="6c3db-185">Alternatively, if there is not a PersistentHandler registered for the extension, find the CLSID associated with the document type under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes.</span></span> <span data-ttu-id="6c3db-186">Lassen Sie uns diesen Schlüssel verwenden `Value2` .</span><span class="sxs-lookup"><span data-stu-id="6c3db-186">Let this key be `Value2`.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             htmlfile
                 = Class for WWW HTML files
                CLSID
                   {25336920-03F9-11CF-8FD0-00AA00686F13}
```

3. <span data-ttu-id="6c3db-187">Bestimmen Sie, ob ein PersistentHandler für die CLSID registriert ist.</span><span class="sxs-lookup"><span data-stu-id="6c3db-187">Determine whether a PersistentHandler is registered for the CLSID.</span></span> <span data-ttu-id="6c3db-188">`Value2`Suchen Sie die in Schritt 2 festgelegte Verwendung von PersistentHandler für den \\ HKEY \_ local \_ Machine \\ \\ Classes \\ CLSID \\ value2 Entry.</span><span class="sxs-lookup"><span data-stu-id="6c3db-188">Using `Value2` determined in step 2, find the PersistentHandler for the \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CLSID\\Value2 entry.</span></span> <span data-ttu-id="6c3db-189">Lassen Sie uns diesen Schlüssel verwenden `Value3` .</span><span class="sxs-lookup"><span data-stu-id="6c3db-189">Let this key be `Value3`.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             htmlfile
                 = Class for WWW HTML files
                PersistentHandler
                   {EEC97550-47A9-11CF-B952-00AA0051FE20}
```

4. <span data-ttu-id="6c3db-190">Bestimmen Sie die GUID des persistenten [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Handlers.</span><span class="sxs-lookup"><span data-stu-id="6c3db-190">Determine the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) persistent handler GUID.</span></span> <span data-ttu-id="6c3db-191">Suchen `Value1` Sie `Value3` unter Verwendung von und nach der GUID des beständigen **IFilter** -Handlers für den Dokumenttyp.</span><span class="sxs-lookup"><span data-stu-id="6c3db-191">Using `Value1` and `Value3`, find the **IFilter** Persistent Handler GUID for the document type.</span></span> <span data-ttu-id="6c3db-192">Der Wert unter dem Registrierungs Eintrag \\ HKEY \_ local \_ Machine \\ \\ Classes \\ CLSID \\ value1 oder 3 \\ persistentaddinsregistered \\ 89bcb740-6119-101A-bcb7-00dd010655af "/> gibt die **IFilter** PersistentHandler-GUID für diesen Dokumenttyp aus.</span><span class="sxs-lookup"><span data-stu-id="6c3db-192">The value under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CLSID\\Value1 or 3\\PersistentAddinsRegistered\\ 89BCB740-6119-101A-BCB7-00DD010655AF"/> yields the **IFilter** PersistentHandler GUID for this document type.</span></span> <span data-ttu-id="6c3db-193">Lassen Sie uns diesen Schlüssel verwenden `Value4` .</span><span class="sxs-lookup"><span data-stu-id="6c3db-193">Let this key be `Value4`.</span></span> <span data-ttu-id="6c3db-194">In diesem Beispiel lautet die GUID der **IFilter** -Schnittstelle 89bcb740-6119-101A-bcb7-00dd010655af.</span><span class="sxs-lookup"><span data-stu-id="6c3db-194">In this example, the **IFilter** interface GUID is 89BCB740-6119-101A-BCB7-00DD010655AF.</span></span>

```
    HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             {EEC97550-47A9-11CF-B952-00AA0051FE20}
                 = HTML File Persistent Handler
                    Data type         REG_SZ
                        PersistentAddinsRegistered
                        {89BCB740-6119-101A-BCB7-00DD010655AF}

                    Data type         REG_SZ
                        default = {E0CA5340-4534-11CF-B952-00AA0051FE20}
```

> [!NOTE]  
> <span data-ttu-id="6c3db-195">In diesem Beispiel wird die [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -dll für HTML-Dokumente nlhtml.dll.</span><span class="sxs-lookup"><span data-stu-id="6c3db-195">In this example, the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL for HTML documents is nlhtml.dll.</span></span>

### <a name="ifiltergetchunk-and-locale-code-identifiers"></a><span data-ttu-id="6c3db-196">IFilter:: GetChunk-und locale-Code Bezeichner</span><span class="sxs-lookup"><span data-stu-id="6c3db-196">IFilter::GetChunk and Locale Code Identifiers</span></span>

<span data-ttu-id="6c3db-197">Die LCID von Text kann innerhalb einer einzelnen Datei geändert werden.</span><span class="sxs-lookup"><span data-stu-id="6c3db-197">The LCID of text can change within a single file.</span></span> <span data-ttu-id="6c3db-198">Beispielsweise kann der Text eines Anweisungs Handbuchs zwischen Englisch (en-US) und Spanisch (es) wechseln, oder der Text kann ein einzelnes Wort in einer anderen Sprache als der Primärsprache enthalten.</span><span class="sxs-lookup"><span data-stu-id="6c3db-198">For example, the text of an instruction manual might alternate between English (en-us) and Spanish (es) or the text may include a single word in a language other than the primary language.</span></span> <span data-ttu-id="6c3db-199">In jedem Fall muss Ihr [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) jedes Mal, wenn die LCID geändert wird, einen neuen Block starten.</span><span class="sxs-lookup"><span data-stu-id="6c3db-199">In either case, your [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) must begin a new chunk each time the LCID changes.</span></span> <span data-ttu-id="6c3db-200">Da die LCID verwendet wird, um eine geeignete Wörter Trennung auszuwählen, ist es sehr wichtig, dass Sie diese ordnungsgemäß identifizieren.</span><span class="sxs-lookup"><span data-stu-id="6c3db-200">Because the LCID is used to choose an appropriate word breaker, it is very important that you correctly identify it.</span></span> <span data-ttu-id="6c3db-201">Wenn der **IFilter** das Gebiets Schema des Texts nicht ermitteln kann, sollte er eine LCID von 0 (null) mit dem Block zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="6c3db-201">If the **IFilter** cannot determine the locale of the text, then it should return an LCID of zero with the chunk.</span></span> <span data-ttu-id="6c3db-202">Wenn eine LCID 0 (null) zurückgegeben wird, verwendet die Windows-Suche die Technologie zur automatischen Erkennung von Sprachen (LAD), um die Gebiets Schema-ID des Blocks zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="6c3db-202">Returning an LCID of zero causes Windows Search to use Language Auto-Detection (LAD) technology to determine the locale ID of the chunk.</span></span> <span data-ttu-id="6c3db-203">Wenn die Windows-Suche keine Entsprechung findet, wird standardmäßig das Standard Gebiets Schema des Systems (durch Aufrufen der [getsystemdefaultlocalename-Funktions](/windows/win32/api/winnls/nf-winnls-getsystemdefaultlocalename) Funktion) verwendet.</span><span class="sxs-lookup"><span data-stu-id="6c3db-203">If Windows Search cannot find a match, it defaults to the system default locale (by calling the [GetSystemDefaultLocaleName Function](/windows/win32/api/winnls/nf-winnls-getsystemdefaultlocalename) function).</span></span> <span data-ttu-id="6c3db-204">Weitere Informationen finden Sie unter [**IFilter:: GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**Chunk \_ breaktype**](/windows/win32/api/filter/ne-filter-chunk_breaktype), [**chunkstate**](/windows/win32/api/filter/ne-filter-chunkstate)und [**stat Block \_**](/windows/win32/api/filter/ns-filter-stat_chunk).</span><span class="sxs-lookup"><span data-stu-id="6c3db-204">For more information, see [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**CHUNK\_BREAKTYPE**](/windows/win32/api/filter/ne-filter-chunk_breaktype), [**CHUNKSTATE**](/windows/win32/api/filter/ne-filter-chunkstate), and [**STAT\_CHUNK**](/windows/win32/api/filter/ns-filter-stat_chunk).</span></span>

<span data-ttu-id="6c3db-205">Wenn Sie das Dateiformat Steuern und es derzeit keine Gebiets Schema Informationen enthält, sollten Sie eine Benutzerfunktion hinzufügen, um die ordnungsgemäße Gebiets Schema Identifizierung zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="6c3db-205">If you control the file format and it currently does not contain locale information, you should add a user feature to enable proper locale identification.</span></span> <span data-ttu-id="6c3db-206">Wenn eine nicht übereinstimmende Wörter Trennung verwendet wird, kann dies zu einer schlechten Abfrageleistung für den Benutzer führen.</span><span class="sxs-lookup"><span data-stu-id="6c3db-206">Using a mismatched word breaker can result in a poor query experience for the user.</span></span> <span data-ttu-id="6c3db-207">Weitere Informationen finden Sie unter [**iwordbreaker**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span><span class="sxs-lookup"><span data-stu-id="6c3db-207">For more information, see [**IWordBreaker**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span></span>

> [!NOTE]  
> <span data-ttu-id="6c3db-208">Filter sind Dateitypen zugeordnet, die durch Dateinamen Erweiterungen, MIME-Typen oder CLSIDs bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="6c3db-208">Filters are associated with file types, as denoted by file name extensions, MIME types or CLSIDs.</span></span> <span data-ttu-id="6c3db-209">Obwohl ein Filter mehrere Dateitypen verarbeiten kann, kann jeder Typ nur mit einem einzigen Filter verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="6c3db-209">While one filter can handle multiple file types, each type works with only one filter.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="6c3db-210">Weitere Ressourcen</span><span class="sxs-lookup"><span data-stu-id="6c3db-210">Additional Resources</span></span>

- <span data-ttu-id="6c3db-211">Das in [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample7)verfügbare [ifiltersample](-search-sample-ifiltersample.md) -Codebeispiel veranschaulicht, wie eine IFilter-Basisklasse für die Implementierung der [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) -Schnittstelle erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="6c3db-211">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample7), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="6c3db-212">Eine Übersicht über den Indizierungsprozess finden Sie [im Abschnitt zur Indizierung](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6c3db-212">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="6c3db-213">Eine Übersicht über die Dateitypen finden Sie unter [Dateitypen](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="6c3db-213">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="6c3db-214">Informationen zum Abfragen von Datei Zuordnungs Attributen für einen Dateityp finden Sie unter " [wahrtentypen", "systemfileassociation" und "Anwendungs Registrierung](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85))".</span><span class="sxs-lookup"><span data-stu-id="6c3db-214">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="6c3db-215">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="6c3db-215">Related topics</span></span>

[<span data-ttu-id="6c3db-216">Entwickeln von Filter Handlern</span><span class="sxs-lookup"><span data-stu-id="6c3db-216">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="6c3db-217">Bewährte Methoden zum Erstellen von Filter Handlern in Windows Search</span><span class="sxs-lookup"><span data-stu-id="6c3db-217">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="6c3db-218">Zurückgeben von Eigenschaften aus einem Filter Handler</span><span class="sxs-lookup"><span data-stu-id="6c3db-218">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="6c3db-219">Filtern von Handlern, die mit Windows ausgeliefert werden</span><span class="sxs-lookup"><span data-stu-id="6c3db-219">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="6c3db-220">Implementieren von Filter Handlern in Windows Search</span><span class="sxs-lookup"><span data-stu-id="6c3db-220">Implementing Filter Handlers in Windows Search</span></span>](-search-ifilter-constructing-filters.md)

[<span data-ttu-id="6c3db-221">Registrieren von Filter Handlern</span><span class="sxs-lookup"><span data-stu-id="6c3db-221">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="6c3db-222">Testen von Filter Handlern</span><span class="sxs-lookup"><span data-stu-id="6c3db-222">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
