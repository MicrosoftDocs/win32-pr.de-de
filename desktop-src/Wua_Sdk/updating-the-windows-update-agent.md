---
description: Windows Update-Agent (WUA) aktualisiert sich automatisch selbst, wenn er mit einem Windows Server Update Services (WSUS)-Server verbunden ist oder Windows Update.
ms.assetid: 829112ab-b240-4cc4-8053-18b484934886
title: Aktualisieren von Windows Update-Agent
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b00fe439b1bea377e2699f6fe5714b208ac5d951
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106357361"
---
# <a name="updating-windows-update-agent"></a><span data-ttu-id="27415-103">Aktualisieren von Windows Update-Agent</span><span class="sxs-lookup"><span data-stu-id="27415-103">Updating Windows Update Agent</span></span>

<span data-ttu-id="27415-104">Der Windows Update-Agent (WUA) wird auf verschiedene Weise aktualisiert, abhängig von der Windows-Version, die auf dem Gerät ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="27415-104">Windows Update Agent (WUA) updates itself through various means, depending on the version of Windows running on the device.</span></span> <span data-ttu-id="27415-105">Alte Versionen von WUA sind möglicherweise nicht in der Lage, eine Verbindung mit aktuellen Update Diensten herzustellen, sind möglicherweise nicht mit allen Updates kompatibel und unterstützen möglicherweise nicht alle dokumentierten APIs.</span><span class="sxs-lookup"><span data-stu-id="27415-105">Old versions of WUA may not be able to connect to current update services, may not be compatible with all updates, and may not support all documented APIs.</span></span> <span data-ttu-id="27415-106">Im folgenden wird erläutert, wie sichergestellt wird, dass WUA vollständig aktualisiert und kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="27415-106">Here is how to insure that WUA is fully updated and compatible.</span></span>

<span data-ttu-id="27415-107">**Unter Windows-Versionen ab Windows 7 und Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="27415-107">**On versions of Windows beginning with Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="27415-108">Die Updates von Windows Update-Agent (WUA) sind in regelmäßigen regelmäßigen Updates für Windows enthalten, die über Windows Update oder die Windows Server Update Services (WSUS) verteilt sind.</span><span class="sxs-lookup"><span data-stu-id="27415-108">Windows Update Agent (WUA) updates are included in the regular periodic updates to Windows distributed through Windows Update or to Windows Server Update Services (WSUS).</span></span> <span data-ttu-id="27415-109">Sie müssen keine besonderen Schritte ausführen, um WUA für diese Windows-Versionen zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="27415-109">You do not need to take any special steps to update WUA on these Windows versions.</span></span>

<span data-ttu-id="27415-110">**Unter Windows-Versionen vor Windows 7 und Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="27415-110">**On versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="27415-111">WUA wird automatisch aktualisiert, wenn automatische Updates eine Verbindung mit Windows Update oder mit WSUS herstellt.</span><span class="sxs-lookup"><span data-stu-id="27415-111">WUA automatically updates itself when Automatic Updates connects to Windows Update or to WSUS.</span></span>

<span data-ttu-id="27415-112">Wenn automatische Updates noch nicht erfolgreich ausgeführt wurde, ist es möglich, dass auf einem Gerät, auf dem diese Windows-Versionen ausgeführt werden, eine ältere Version von WUA ausgeführt wird, die nicht alle dokumentierten APIs unterstützt.</span><span class="sxs-lookup"><span data-stu-id="27415-112">If Automatic Updates has not yet successfully run, it is possible that a device running these Windows versions will be running an older version of WUA that does not support all the documented APIs.</span></span> <span data-ttu-id="27415-113">Wenn Sie ein WU_E_SELFUPDATE_REQUIRED Ergebnis erhalten, wenn Sie die WUA-API zum Durchführen einer Überprüfung, eines Downloads oder einer Installation verwenden, wird mit diesem Fehler angezeigt, dass die installierte Version von WUA zu alt ist, um eine Verbindung mit aktuellen Windows Update Diensten herzustellen.</span><span class="sxs-lookup"><span data-stu-id="27415-113">If you receive a WU_E_SELFUPDATE_REQUIRED result when you use the WUA API to perform a scan, download, or install, this error tells you that the installed version of WUA is too old to connect to current Windows Update services.</span></span> <span data-ttu-id="27415-114">Sie können die normalen WUA-APIs nicht zum Aktualisieren von WUA unter diesen Betriebssystemen verwenden.</span><span class="sxs-lookup"><span data-stu-id="27415-114">You cannot use the normal WUA APIs to update WUA on these operating systems.</span></span> 

<span data-ttu-id="27415-115">Ein Benutzer kann WUA manuell auf eine aktuelle Version aktualisieren, indem er die Windows Update Systemsteuerung öffnet, auf nach Updates suchen und dann das selbst Update annimmt, das angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="27415-115">A user can manually update WUA to a current version by opening the Windows Update control panel, selecting Check for Updates, then accepting the self-update that appears.</span></span> <span data-ttu-id="27415-116">Alternativ können Sie WUA Programm gesteuert aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="27415-116">Alternately, you can update WUA programmatically.</span></span>

<span data-ttu-id="27415-117">**So aktualisieren Sie WUA auf Windows-Versionen vor Windows 7 und Windows Server 2008 R2 Programm gesteuert**</span><span class="sxs-lookup"><span data-stu-id="27415-117">**To programmatically update WUA on versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

1.  <span data-ttu-id="27415-118">Verwenden Sie die [WinHTTP](../winhttp/winhttp-start-page.md) -APIs, um [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab)herunterzuladen.</span><span class="sxs-lookup"><span data-stu-id="27415-118">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
2.  <span data-ttu-id="27415-119">Verwenden Sie die [Kryptografiefunktionen](../seccrypto/cryptography-functions.md) , um zu überprüfen, ob die heruntergeladene Kopie [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) über eine digitale Signatur von Microsoft verfügt.</span><span class="sxs-lookup"><span data-stu-id="27415-119">Use the [Cryptography Functions](../seccrypto/cryptography-functions.md) to verify that the downloaded copy of [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) has a digital signature from Microsoft.</span></span> <span data-ttu-id="27415-120">Wenn die digitale Signatur nicht überprüft werden kann, können Sie den Vorgang abbrechen.</span><span class="sxs-lookup"><span data-stu-id="27415-120">If you can't verify the digital signature, stop.</span></span>
3.  <span data-ttu-id="27415-121">Extrahieren Sie die XML-Datei mit den APIs für die [Datei Dekomprimierungs Schnittstelle](../devnotes/cabinet-api-functions.md) aus [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span><span class="sxs-lookup"><span data-stu-id="27415-121">Use the [File Decompression Interface](../devnotes/cabinet-api-functions.md) APIs to extract the XML file from [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
4.  <span data-ttu-id="27415-122">Verwenden Sie die Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)))-APIs, um die XML-Datei zu laden und den Knoten wuredist/standaloneredist/Architecture für die Architektur des Computers zu suchen.</span><span class="sxs-lookup"><span data-stu-id="27415-122">Use the Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) APIs to load the XML file and locate the WURedist/StandaloneRedist/architecture node for the computer's architecture.</span></span> <span data-ttu-id="27415-123">Suchen Sie z. b. für x86 den Knoten wuredist/standaloneredist/Architecture mit dem **namens** Attribut x86.</span><span class="sxs-lookup"><span data-stu-id="27415-123">For example, for x86, locate the WURedist/StandaloneRedist/architecture node with the **name** attribute of x86.</span></span>
5.  <span data-ttu-id="27415-124">Aufrufen von [**iwindowsupdateagentinfo:: GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) , um die aktuelle Version von WUA zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="27415-124">Call [**IWindowsUpdateAgentInfo::GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) to determine the current version of WUA.</span></span> <span data-ttu-id="27415-125">Wenn **iwindowsupdateagentinfo:: GetInfo** eine Versionsnummer zurückgibt, die mindestens so hoch ist wie das **Clientversion** -Attribut im Knoten "Architektur", den Sie gefunden haben, wird beendet.</span><span class="sxs-lookup"><span data-stu-id="27415-125">If **IWindowsUpdateAgentInfo::GetInfo** returns a version number that is at least as high as the **clientVersion** attribute in the architecture node you located, stop.</span></span>
6.  <span data-ttu-id="27415-126">Verwenden Sie die [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) -APIs, um das **DownloadURL** -Attribut aus dem Knoten Architektur zu lesen, den Sie gefunden haben.</span><span class="sxs-lookup"><span data-stu-id="27415-126">Use the [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) APIs to read the **downloadUrl** attribute from the architecture node that you located.</span></span> <span data-ttu-id="27415-127">**Download URL** gibt Ihnen die Download-URL für den entsprechenden WUA-Installer für die Architektur des Computers.</span><span class="sxs-lookup"><span data-stu-id="27415-127">**downloadUrl** gives you the download URL for the appropriate WUA installer for the computer's architecture.</span></span>
7.  <span data-ttu-id="27415-128">Verwenden Sie die [WinHTTP](../winhttp/winhttp-start-page.md) -APIs, um den entsprechenden Installer herunterzuladen.</span><span class="sxs-lookup"><span data-stu-id="27415-128">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download the appropriate installer.</span></span>
8.  <span data-ttu-id="27415-129">Verwenden Sie die Funktion "up- [**Process**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) " oder eine ähnliche API, um den heruntergeladenen Installer auszuführen.</span><span class="sxs-lookup"><span data-stu-id="27415-129">Use the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function or a similar API to execute the downloaded installer.</span></span>

 

 
