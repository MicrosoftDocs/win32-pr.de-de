---
title: Image-Data Komprimierung
description: Image-Data Komprimierung
ms.assetid: 689cf403-cbb5-4ccb-a05b-0caa617430ed
keywords:
- Videokomprimierungs-Manager (VCM), Image-Datenkomprimierung
- VCM (Videokomprimierungs-Manager), Image-Datenkomprimierung
- Iccompress-Funktion
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8b8f59a163a9b5a74d2d2fe984417069985fa86a
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "104390199"
---
# <a name="image-data-compression"></a><span data-ttu-id="eeeb0-106">Image-Data Komprimierung</span><span class="sxs-lookup"><span data-stu-id="eeeb0-106">Image-Data Compression</span></span>

<span data-ttu-id="eeeb0-107">Die Anwendung kann eine Reihe von [**iccompress**](/windows/desktop/api/Vfw/nf-vfw-iccompress) -Funktionen und-Makros verwenden, um Daten zu komprimieren.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-107">Your application can use a series of [**ICCompress**](/windows/desktop/api/Vfw/nf-vfw-iccompress) functions and macros to compress data.</span></span> <span data-ttu-id="eeeb0-108">Mithilfe der Funktionen und Makros können Sie die folgenden Aufgaben ausführen:</span><span class="sxs-lookup"><span data-stu-id="eeeb0-108">The functions and macros can help you perform the following tasks:</span></span>

-   <span data-ttu-id="eeeb0-109">Bestimmen Sie das zu verwendende Komprimierungs Format für ein angegebenes Eingabeformat.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-109">Determine the compression format to use for a specified input format.</span></span>
-   <span data-ttu-id="eeeb0-110">Bereiten Sie den-Kompressor vor.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-110">Prepare the compressor.</span></span>
-   <span data-ttu-id="eeeb0-111">Komprimieren Sie die Daten.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-111">Compress the data.</span></span>
-   <span data-ttu-id="eeeb0-112">Ende der Komprimierung.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-112">End compression.</span></span>

<span data-ttu-id="eeeb0-113">Die Anwendung kann die Kontrolle über den Komprimierungs Prozess mithilfe der [**iccompress**](/windows/desktop/api/Vfw/nf-vfw-iccompress) -Funktionen und-Makros erhöhen.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-113">Your application can increase control over the compression process by using the [**ICCompress**](/windows/desktop/api/Vfw/nf-vfw-iccompress) functions and macros.</span></span> <span data-ttu-id="eeeb0-114">Diese Gruppe von Funktionen und Makros verarbeitet einzelne Frames anstelle der gesamten Sequenz.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-114">This group of functions and macros handles individual frames, rather than the sequence as a whole.</span></span> <span data-ttu-id="eeeb0-115">Die Anwendung kann z. b. die Frames identifizieren, die mithilfe der **iccompress** -Funktion als Keyframes komprimiert werden.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-115">For example, your application can identify the frames to compress as key frames by using the **ICCompress** function.</span></span>

<span data-ttu-id="eeeb0-116">Ein-Kompressor empfängt Daten in einem Format, komprimiert die Daten und gibt eine komprimierte Version der Daten mit einem angegebenen Format zurück.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-116">A compressor receives data in one format, compresses the data, and returns a compressed version of the data using a specified format.</span></span> <span data-ttu-id="eeeb0-117">Das typische Eingabeformat gibt Disb mithilfe der [**BitmapInfo**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) -Struktur an.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-117">The typical input format specifies DIBs using the [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) structure.</span></span> <span data-ttu-id="eeeb0-118">Das typische Ausgabeformat gibt komprimierte Disb an, wobei auch die **BitmapInfo** -Struktur verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-118">The typical output format specifies compressed DIBs, also using the **BITMAPINFO** structure.</span></span>

> [!Note]  
> <span data-ttu-id="eeeb0-119">Um die Abbild-und audioabnahme während der Wiedergabe zu minimieren, sollten Sie eine AVI-Datei nicht mehrmals komprimieren.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-119">To minimize image and audio degradation during playback, avoid compressing an AVI file more than once.</span></span> <span data-ttu-id="eeeb0-120">Kombinieren Sie unkomprimierte Video Teile in Ihrem Bearbeitungssystem, und komprimieren Sie dann das endgültige Produkt.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-120">Combine uncompressed pieces of video in your editing system and then compress the final product.</span></span>

 

## <a name="compressor-and-compression-format-selection"></a><span data-ttu-id="eeeb0-121">Auswahl des Kompressors und Komprimierungs Formats</span><span class="sxs-lookup"><span data-stu-id="eeeb0-121">Compressor and Compression Format Selection</span></span>

<span data-ttu-id="eeeb0-122">Wenn Sie Daten komprimieren möchten und die Anwendung ein bestimmtes Ausgabeformat erfordert, senden Sie die [**ICM- \_ Komprimierungs \_ Abfrage**](icm-compress-query.md) Nachricht (oder verwenden Sie das [**iccompressquery**](/windows/desktop/api/Vfw/nf-vfw-iccompressquery) -Makro), um den-Kompressor abzufragen und zu ermitteln, ob die Eingabe-und Ausgabeformate unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-122">If you want to compress data and your application requires a specific output format, send the [**ICM\_COMPRESS\_QUERY**](icm-compress-query.md) message (or use the [**ICCompressQuery**](/windows/desktop/api/Vfw/nf-vfw-iccompressquery) macro) to query the compressor to determine if it supports the input and output formats.</span></span>

<span data-ttu-id="eeeb0-123">Wenn das Ausgabeformat für die Anwendung nicht wichtig ist, müssen Sie nur einen Kompressor finden, der das Eingabeformat verarbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-123">If the output format is not important to your application, you need only find a compressor that can handle the input format.</span></span> <span data-ttu-id="eeeb0-124">Um zu ermitteln, ob ein-Kompressor das Eingabeformat verarbeiten kann, können Sie die **ICM- \_ Komprimierungs \_ Abfrage** senden und **null** für den *LPARAM* -Parameter angeben.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-124">To determine if a compressor can handle the input format, you can send **ICM\_COMPRESS\_QUERY**, specifying **NULL** for the *lParam* parameter.</span></span> <span data-ttu-id="eeeb0-125">Diese Meldung gibt das Ausgabeformat nicht an die Anwendung zurück.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-125">This message does not return the output format to your application.</span></span> <span data-ttu-id="eeeb0-126">Die Anwendung kann die erforderliche Puffergröße für die Daten bestimmen, die das Komprimierungs Format angeben, indem Sie die [**ICM \_ Compress \_ get- \_ Format**](icm-compress-get-format.md) Meldung sendet (oder das Makro [**iccompressgetformatsize**](/windows/desktop/api/Vfw/nf-vfw-iccompressgetformatsize) verwenden).</span><span class="sxs-lookup"><span data-stu-id="eeeb0-126">Your application can determine the buffer size needed for the data specifying the compression format by sending the [**ICM\_COMPRESS\_GET\_FORMAT**](icm-compress-get-format.md) message (or use the [**ICCompressGetFormatSize**](/windows/desktop/api/Vfw/nf-vfw-iccompressgetformatsize) macro).</span></span> <span data-ttu-id="eeeb0-127">Sie können die Format Daten auch abrufen, indem Sie ICM \_ Compress \_ get \_ Format (oder das Makro [**iccompressgetformat**](/windows/desktop/api/Vfw/nf-vfw-iccompressgetformat) ) senden.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-127">You can also retrieve the format data by sending ICM\_COMPRESS\_GET\_FORMAT (or the [**ICCompressGetFormat**](/windows/desktop/api/Vfw/nf-vfw-iccompressgetformat) macro).</span></span>

<span data-ttu-id="eeeb0-128">Wenn Sie den größten Puffer ermitteln möchten, den der-Kompressor für die Komprimierung benötigen könnte, senden Sie die [**ICM \_ Compress \_ get \_ size**](icm-compress-get-size.md) -Nachricht (oder verwenden Sie das [**iccompressgetsize**](/windows/desktop/api/Vfw/nf-vfw-iccompressgetsize) -Makro).</span><span class="sxs-lookup"><span data-stu-id="eeeb0-128">If you want to determine the largest buffer that the compressor could require for compression, send the [**ICM\_COMPRESS\_GET\_SIZE**](icm-compress-get-size.md) message (or use the [**ICCompressGetSize**](/windows/desktop/api/Vfw/nf-vfw-iccompressgetsize) macro).</span></span> <span data-ttu-id="eeeb0-129">Sie können die Anzahl von Bytes, die von der [**icsendmessage**](/windows/desktop/api/Vfw/nf-vfw-icsendmessage) -Funktion zurückgegeben werden, verwenden, um einen Puffer für nachfolgende Bild Komprimierungen zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-129">You can use the number of bytes returned by the [**ICSendMessage**](/windows/desktop/api/Vfw/nf-vfw-icsendmessage) function to allocate a buffer for subsequent image compressions.</span></span>

## <a name="compressor-initialization"></a><span data-ttu-id="eeeb0-130">Initialisierung des Kompressors</span><span class="sxs-lookup"><span data-stu-id="eeeb0-130">Compressor Initialization</span></span>

<span data-ttu-id="eeeb0-131">Nachdem die Anwendung einen Kompressor ausgewählt hat, mit dem die Eingabe-und Ausgabeformate verarbeitet werden können, die Sie benötigt, können Sie den-Kompressor mithilfe der [**ICM- \_ Komprimierungs \_ Begin**](icm-compress-begin.md) -Nachricht initialisieren (oder das-Makro von [**iccompressbegin**](/windows/desktop/api/Vfw/nf-vfw-iccompressbegin) verwenden).</span><span class="sxs-lookup"><span data-stu-id="eeeb0-131">After your application selects a compressor that can handle the input and output formats it needs, you can initialize the compressor by using the [**ICM\_COMPRESS\_BEGIN**](icm-compress-begin.md) message (or use the [**ICCompressBegin**](/windows/desktop/api/Vfw/nf-vfw-iccompressbegin) macro).</span></span> <span data-ttu-id="eeeb0-132">Diese Nachricht erfordert das-Kompressor-Handle und die Eingabe-und Ausgabeformate.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-132">This message requires the compressor handle and the input and output formats.</span></span>

## <a name="data-compression"></a><span data-ttu-id="eeeb0-133">Datenkomprimierung</span><span class="sxs-lookup"><span data-stu-id="eeeb0-133">Data Compression</span></span>

<span data-ttu-id="eeeb0-134">Sie können die [**iccompress**](/windows/desktop/api/Vfw/nf-vfw-iccompress) -Funktion verwenden, um einen Frame zu komprimieren.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-134">You can use the [**ICCompress**](/windows/desktop/api/Vfw/nf-vfw-iccompress) function to compress a frame.</span></span> <span data-ttu-id="eeeb0-135">Die Anwendung muss diese Funktion wiederholt verwenden, bis alle Frames in einer Sequenz komprimiert sind.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-135">Your application must use this function repeatedly until all the frames in a sequence are compressed.</span></span> <span data-ttu-id="eeeb0-136">Die Anwendung muss außerdem die Anzahl der einzelnen mit **iccompress** komprimierten Frames nachverfolgen und inkrementalisieren.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-136">Your application must also track and increment the number of each frame compressed with **ICCompress**.</span></span> <span data-ttu-id="eeeb0-137">Der-Kompressor verwendet diesen Wert, um zu überprüfen, ob Frames während der schnellen temporalen Komprimierung außerhalb der Reihenfolge gesendet werden (Unterschiede zwischen aufeinander folgenden Frames werden</span><span class="sxs-lookup"><span data-stu-id="eeeb0-137">The compressor uses this value to check if frames are sent out of order during fast temporal compression (storing differences between successive frames).</span></span> <span data-ttu-id="eeeb0-138">Wenn die Anwendung einen Frame erneut komprimiert, sollte Sie dieselbe Frame Nummer wie beim ersten Komprimieren des Frames verwenden.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-138">If your application recompresses a frame, it should use the same frame number as when the frame was first compressed.</span></span> <span data-ttu-id="eeeb0-139">Wenn Ihre Anwendung ein Bild mit einem anderen Frame komprimiert, kann Sie eine Frame Nummer von NULL angeben.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-139">If your application compresses a still-frame image, it can specify a frame number of zero.</span></span>

<span data-ttu-id="eeeb0-140">Die Anwendung kann das **iccompress- \_ Keyframe** -Flag verwenden, um den Frame durch [**iccompress**](/windows/desktop/api/Vfw/nf-vfw-iccompress) als Keyframe komprimiert zu gestalten.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-140">Your application can use the **ICCOMPRESS\_KEYFRAME** flag to make the frame compressed by [**ICCompress**](/windows/desktop/api/Vfw/nf-vfw-iccompress) a key frame.</span></span>

<span data-ttu-id="eeeb0-141">Wenn VCM die Steuerung an die Anwendung zurückgibt, nachdem ein Frame komprimiert wurde, speichert VCM die komprimierten Daten in den Strukturen, auf die von den Parametern *lpbioutput* und *lpdata* verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-141">When VCM returns control to your application after compressing a frame, VCM stores the compressed data in the structures referenced by the *lpbiOutput* and *lpData* parameters.</span></span> <span data-ttu-id="eeeb0-142">Wenn die Anwendung die komprimierten Daten verschieben muss, kann Sie Ihre Größe im *bisizeimage* -Member der [**BitmapInfo**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) -Struktur ermitteln, die in *lpbioutput* angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-142">If your application needs to move the compressed data, it can find its size in the *biSizeImage* member of the [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) structure specified in *lpbiOutput*.</span></span>

> [!Note]  
> <span data-ttu-id="eeeb0-143">Die Anwendung muss die Strukturen und Puffer zuordnen, in denen die nicht komprimierten und komprimierten Daten gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-143">Your application must allocate the structures and buffers that store the uncompressed and compressed data.</span></span> <span data-ttu-id="eeeb0-144">Wenn der-Kompressor Temporale Komprimierung unterstützt, muss die Anwendung auch eine Struktur und einen Puffer zuordnen, um das Format und die Daten für den vorherigen Frame von Informationen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-144">If the compressor supports temporal compression, your application must also allocate a structure and buffer to hold the format and data for the previous frame of information.</span></span>

 

## <a name="ending-compression"></a><span data-ttu-id="eeeb0-145">Komprimierung wird beendet</span><span class="sxs-lookup"><span data-stu-id="eeeb0-145">Ending Compression</span></span>

<span data-ttu-id="eeeb0-146">Nachdem die Anwendung die Daten komprimiert hat, kann Sie das [**iccompressend**](/windows/desktop/api/Vfw/nf-vfw-iccompressend) -Makro verwenden, um den Kompressor zu benachrichtigen, dass der Vorgang abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="eeeb0-146">After your application has compressed the data, it can use the [**ICCompressEnd**](/windows/desktop/api/Vfw/nf-vfw-iccompressend) macro to notify the compressor that it has finished.</span></span> <span data-ttu-id="eeeb0-147">Wenn Sie die Komprimierung nach der Verwendung dieser Funktion neu starten möchten, muss die Anwendung den-Kompressor erneut initialisieren, indem Sie die [**ICM \_ Compress \_ Begin**](icm-compress-begin.md) -Nachricht sendet (oder das [**iccompressbegin**](/windows/desktop/api/Vfw/nf-vfw-iccompressbegin) -Makro verwenden).</span><span class="sxs-lookup"><span data-stu-id="eeeb0-147">If you want to restart compression after using this function, your application must reinitialize the compressor by sending the [**ICM\_COMPRESS\_BEGIN**](icm-compress-begin.md) message (or use the [**ICCompressBegin**](/windows/desktop/api/Vfw/nf-vfw-iccompressbegin) macro).</span></span>

 

 