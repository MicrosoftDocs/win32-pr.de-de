---
title: Der OLE-Component Object Model
description: Der OLE-Component Object Model
ms.assetid: f3200d81-c2fa-4cc7-bf85-54f6c753a529
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 211c41de8c16eb1cabb1e62f475adbbf603e2c92
ms.sourcegitcommit: 52d79b29f3b9933c8bef43207ff80c668a81cb73
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/20/2020
ms.locfileid: "103949212"
---
# <a name="the-ole-component-object-model"></a><span data-ttu-id="c68d2-103">Der OLE-Component Object Model</span><span class="sxs-lookup"><span data-stu-id="c68d2-103">The OLE Component Object Model</span></span>

<span data-ttu-id="c68d2-104">Die von der avifile-Bibliothek verwendeten Objekte sind Teil der OLE-Component Object Model.</span><span class="sxs-lookup"><span data-stu-id="c68d2-104">The objects used by the AVIFile library are all part of the OLE Component Object Model.</span></span> <span data-ttu-id="c68d2-105">Dies bedeutet hauptsächlich, dass Sie bestimmte Methoden gemeinsam nutzen, die Ihnen die Arbeit erleichtern, und die zurückgegebenen Werte gelten für die meisten OLE-Schnittstellen Methoden.</span><span class="sxs-lookup"><span data-stu-id="c68d2-105">Primarily, this means they share certain methods that make them easier to work with, and the values they return are common to most OLE interface methods.</span></span>

<span data-ttu-id="c68d2-106">Der OLE-Component Object Model der Datei-und Datenstrom Handler verwendet die OLE **IClassFactory** -Schnittstelle, um Instanzen Ihrer Objektklasse zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="c68d2-106">The OLE Component Object Model of the file and stream handlers uses the OLE **IClassFactory** interface to create instances of their object class.</span></span> <span data-ttu-id="c68d2-107">Als Komponenten Objekte implementieren Sie die [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) -Schnittstelle, die aus der [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void))-, [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)-und [**adressf**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) -Methode besteht.</span><span class="sxs-lookup"><span data-stu-id="c68d2-107">As component objects, they implement the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface, which consists of the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release), and [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) methods.</span></span> <span data-ttu-id="c68d2-108">Mit der **IUnknown** -Schnittstelle kann eine Anwendung Zeiger auf andere Schnittstellen abrufen, die vom gleichen Objekt unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="c68d2-108">The **IUnknown** interface lets an application obtain pointers to other interfaces supported by the same object.</span></span>

<span data-ttu-id="c68d2-109">Mithilfe der **QueryInterface** -Methode können Sie feststellen, ob ein Objekt eine bestimmte Schnittstelle unterstützt.</span><span class="sxs-lookup"><span data-stu-id="c68d2-109">You can determine if an object supports a specific interface by using the **QueryInterface** method.</span></span> <span data-ttu-id="c68d2-110">Wenn ein Objekt eine angegebene Schnittstelle unterstützt, gibt **QueryInterface** einen Zeiger auf diese Schnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="c68d2-110">If an object supports a specified interface, **QueryInterface** returns a pointer to that interface.</span></span>

<span data-ttu-id="c68d2-111">Sie können den Verweis Zähler, der einem Objekt zugeordnet ist, erhöhen und verringern, indem Sie die [**adressf**](/previous-versions//dd757100(v=vs.85)) -und [**releasemethoden**](/previous-versions//dd757102(v=vs.85)) verwenden.</span><span class="sxs-lookup"><span data-stu-id="c68d2-111">You can increment and decrement the reference count associated with an object by using the [**AddRef**](/previous-versions//dd757100(v=vs.85)) and [**Release**](/previous-versions//dd757102(v=vs.85)) methods.</span></span> <span data-ttu-id="c68d2-112">Der Verweis Zähler ermöglicht mehreren Clients den Zugriff auf ein Objekt.</span><span class="sxs-lookup"><span data-stu-id="c68d2-112">The reference count lets multiple clients access an object.</span></span> <span data-ttu-id="c68d2-113">Wenn ein Objekt von der ersten Anwendung verwendet wird, wird der Verweis Zähler auf 1 festgelegt.</span><span class="sxs-lookup"><span data-stu-id="c68d2-113">When an object is used by the first application, its reference count is set to 1.</span></span> <span data-ttu-id="c68d2-114">Anwendungen verwenden anschließend die **adressf** -Methode, um die Anzahl zu erhöhen, damit das Objekt nachverfolgen kann, wie oft auf das Objekt zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="c68d2-114">Applications subsequently use the **AddRef** method to increment the count to let the object keep track of the number of times it is accessed.</span></span>

<span data-ttu-id="c68d2-115">Wenn eine Anwendung mithilfe eines Objekts ausgeführt wird, wird die **releasemethode** aufgerufen, um den Verweis Zähler zu Dekrementen.</span><span class="sxs-lookup"><span data-stu-id="c68d2-115">When an application is done using an object, it calls the **Release** method to decrement the reference count.</span></span> <span data-ttu-id="c68d2-116">Wenn der Verweis Zähler Null ist, wird das Objekt nicht mehr benötigt, und das Release gibt alle Ressourcen **frei** , die es verwendet, und zerstört das-Objekt.</span><span class="sxs-lookup"><span data-stu-id="c68d2-116">When the reference count is zero, the object is no longer needed and **Release** frees any resources it uses and destroys the object.</span></span> <span data-ttu-id="c68d2-117">Da ein Objekt interne Ressourcen verwendet, die für die Anwendung transparent sind, ist das-Objekt für die Freigabe verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="c68d2-117">Because an object uses internal resources transparent to the application, the object is responsible for freeing them.</span></span> <span data-ttu-id="c68d2-118">Beispielsweise kann es vorkommen, dass ein Datei Handler geöffnete Datenträger Dateien und freien Pufferspeicher bei der Freigabe schließt.</span><span class="sxs-lookup"><span data-stu-id="c68d2-118">For example, a file handler might need to close open disk files and free buffer memory when released.</span></span>

<span data-ttu-id="c68d2-119">Die meisten OLE-Schnittstellen Methoden geben Ergebnis Handles zurück, die mithilfe des **HRESULT** -Datentyps definiert werden.</span><span class="sxs-lookup"><span data-stu-id="c68d2-119">Most OLE interface methods return result handles that are defined by using the **HRESULT** data type.</span></span> <span data-ttu-id="c68d2-120">Dieser Datentyp besteht aus einem Schweregrad Code, Kontextinformationen, einem Einrichtungs Code und einem Statuscode.</span><span class="sxs-lookup"><span data-stu-id="c68d2-120">This data type is made of a severity code, contextual information, a facility code, and a status code.</span></span> <span data-ttu-id="c68d2-121">Ein Rückgabe Ergebnis Handle, das angibt, dass der Wert 0 (null) ist.</span><span class="sxs-lookup"><span data-stu-id="c68d2-121">A return result handle that indicates success has the value zero.</span></span> <span data-ttu-id="c68d2-122">Ein Wert ungleich 0 (null) gibt einen Fehler an, und der Statuscode-Member des Rückgabe Ergebnis Handles stellt eine Grundlage für die zusätzliche Interpretation dar.</span><span class="sxs-lookup"><span data-stu-id="c68d2-122">A nonzero value indicates failure and the status code member of the return result handle provides a basis for additional interpretation.</span></span> <span data-ttu-id="c68d2-123">Weitere Informationen zu OLE-Rückgabe Ergebnis Handles finden Sie in der *OLE-Programmier Referenz*.</span><span class="sxs-lookup"><span data-stu-id="c68d2-123">For additional information about OLE return result handles, see the *OLE Programmer's Reference*.</span></span>

 

 