---
title: Benutzerkontensteuerung und Bits
description: Wenn sich ein Administrator Benutzer auf dem Computer anmeldet, werden zwei Zugriffs Token erstellt. Eine ist ein gefiltertes Standardbenutzer Zugriffs Token, das andere ein vollständiges Administrator Zugriffs Token.
ms.assetid: 02439ab3-b885-4a2f-b507-0c48d2b30b76
ms.topic: article
ms.date: 7/12/2019
ms.openlocfilehash: 3017b3a0d816ba393d1427c5c1d2315a68b2dcc0
ms.sourcegitcommit: be77ed1f97d3be57a2f42070589de21b66034adf
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/29/2020
ms.locfileid: "103948513"
---
# <a name="bits-security-tokens-and-administrator-accounts"></a><span data-ttu-id="e0e6c-104">Bits-Sicherheit,-Token und-Administrator Konten</span><span class="sxs-lookup"><span data-stu-id="e0e6c-104">BITS Security, Tokens, and Administrator Accounts</span></span>

## <a name="http-server-certificate-callbacks"></a><span data-ttu-id="e0e6c-105">HTTP-Server-Zertifikat Rückrufe</span><span class="sxs-lookup"><span data-stu-id="e0e6c-105">HTTP Server certificate callbacks</span></span>
<span data-ttu-id="e0e6c-106">Das korrekte Validieren von Server Zertifikaten ist ein wichtiger Bestandteil der Verwaltung der HTTPS-Sicherheit.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-106">Correctly validating server certificates is a key part of maintaining HTTPS security.</span></span> <span data-ttu-id="e0e6c-107">Bits hilft bei der stets Validierung von Server Zertifikaten anhand einer Liste von Anforderungen, die von [**setsecurityflags**](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setsecurityflags)angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-107">BITS helps by always validating server certificates against a list of requirements specified by [**SetSecurityFlags**](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setsecurityflags).</span></span> <span data-ttu-id="e0e6c-108">Standardmäßig verwendet Bits die Überprüfung des "Browser"-Stil Zertifikats.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-108">By default, BITS uses "browser" style certificate validation.</span></span>

<span data-ttu-id="e0e6c-109">Sie können auch eine benutzerdefinierte Funktion angeben, die aufgerufen werden soll, um das Zertifikat weiter zu validieren.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-109">You can also specify a custom function to call in order to further validate the certificate.</span></span> <span data-ttu-id="e0e6c-110">Legen Sie den Serverzertifikat Rückruf mit der [**setservercertificatevalidationinterface**](/windows/desktop/api/Bits10_3/nf-bits10_3-ibackgroundcopyjobhttpoptions3-setservercertificatevalidationinterface) -Methode fest.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-110">Set the server certificate callback with the [**SetServerCertificateValidationInterface**](/windows/desktop/api/Bits10_3/nf-bits10_3-ibackgroundcopyjobhttpoptions3-setservercertificatevalidationinterface) method.</span></span> <span data-ttu-id="e0e6c-111">Die-Methode wird nur aufgerufen, nachdem das Betriebssystem das Zertifikat auf der Grundlage des Aufrufs von [ **setsecurityflag** s](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setsecurityflags) überprüft hat.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-111">Your method will only be called after the operating system has validated the certificate based on the [**SetSecurityFlag** s](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setsecurityflags) call.</span></span> 

## <a name="http-client-certificates"></a><span data-ttu-id="e0e6c-112">HTTP-Client Zertifikate</span><span class="sxs-lookup"><span data-stu-id="e0e6c-112">HTTP Client certificates</span></span>
<span data-ttu-id="e0e6c-113">Sie können ein Client Zertifikat für einen HTTP-Auftrag mit zwei verschiedenen Methoden für Zertifikat Einstellungen festlegen.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-113">You can set a client certificate on an HTTP job with two different certificate settings methods.</span></span> <span data-ttu-id="e0e6c-114">Sie können ein Zertifikat entweder über die [ID](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setclientcertificatebyid) oder den [Namen](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setclientcertificatebyname)des Zertifikat Antragstellers festlegen.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-114">You can set a certificate either by [ID](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setclientcertificatebyid) or by the certificate [subject name](/windows/desktop/api/bits2_5/nf-bits2_5-ibackgroundcopyjobhttpoptions-setclientcertificatebyname).</span></span> <span data-ttu-id="e0e6c-115">Das Client Zertifikat wird während der TLS-Aushandlung (oder der Aushandlung) verwendet, wenn für den Server eine Client Authentifizierung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-115">The client certificate will be used during TLS negotiation (or renegotiation) if the server requires client authentication.</span></span>

## <a name="write-only-http-headers"></a><span data-ttu-id="e0e6c-116">Schreibgeschützte HTTP-Header</span><span class="sxs-lookup"><span data-stu-id="e0e6c-116">Write-only HTTP headers</span></span>
<span data-ttu-id="e0e6c-117">Mit Bits können Sie http-Authentifizierungs Token vor unerwünschtem Zugriff schützen.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-117">BITS helps you protect HTTP authentication tokens from unwanted access.</span></span> <span data-ttu-id="e0e6c-118">Ein HTTP-Server benötigt häufig ein Sicherheits Token oder eine beliebige Zeichenfolge, wenn eine Datei auf http-Server heruntergeladen oder hochgeladen wird.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-118">Often an HTTP server will need some kind of security token or string when downloading or uploading a file to HTTP servers.</span></span>

<span data-ttu-id="e0e6c-119">Bits schützt diese Authentifizierungs Token auf verschiedene Weise.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-119">BITS protects these authentication tokens in several ways.</span></span>
* <span data-ttu-id="e0e6c-120">Mithilfe von Bits können Sie TLS-und SSL-geschützte http-Verbindungen verwenden, indem Sie eine HTTPS-URL angeben.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-120">BITS lets you use TLS- and SSL-protected HTTP connections by specifying an HTTPS URL.</span></span>
* <span data-ttu-id="e0e6c-121">Benutzerdefinierte Header werden immer in einem verschlüsselten Format auf dem Datenträger gespeichert.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-121">Custom headers are always persisted in an encrypted format on disk.</span></span>
* <span data-ttu-id="e0e6c-122">Sie können verhindern, dass Kunden Header mit der [**IBackgroundCopyJobHttpOptions3:: makecustomheadersschreiteonly**](/windows/win32/api/Bits10_3/nf-bits10_3-ibackgroundcopyjobhttpoptions3-makecustomheaderswriteonly) -Methode an andere Programme zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-122">You can prevent customer headers from being returned to other programs with the [**IBackgroundCopyJobHttpOptions3::MakeCustomHeadersWriteOnly**](/windows/win32/api/Bits10_3/nf-bits10_3-ibackgroundcopyjobhttpoptions3-makecustomheaderswriteonly) method.</span></span>


## <a name="standard-and-administrator-users"></a><span data-ttu-id="e0e6c-123">Standard-und Administrator Benutzer</span><span class="sxs-lookup"><span data-stu-id="e0e6c-123">Standard and Administrator users</span></span>
<span data-ttu-id="e0e6c-124">Ein Benutzer, der der Administrator Gruppe angehört, kann einen Prozess mit Standardbenutzer Zugriff oder mit erhöhten Rechten (mit Administratorrechten) ausführen.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-124">A user who is in the administrator group can run a process with standard user access or in an elevated state (with administrator privileges).</span></span> <span data-ttu-id="e0e6c-125">Bits führt den Auftrag in einem der beiden Zustände aus, solange der Benutzer am Computer angemeldet ist.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-125">BITS will run the job in either state as long as the user is logged onto the computer.</span></span> <span data-ttu-id="e0e6c-126">Wenn der Benutzer den Auftrag jedoch erstellt oder den Besitz des Auftrags im Zustand "erhöht" übernehmen würde, muss der Benutzer den Status "erhöht" aufweisen, um den Auftrag abzurufen oder zu ändern (andernfalls schlägt der-Befehl fehl, wenn der Zugriff verweigert wird (0x80070005)).</span><span class="sxs-lookup"><span data-stu-id="e0e6c-126">However, if the user created the job or took ownership of the job in an elevated state, the user must be in the elevated state to retrieve or modify the job (otherwise, the call fails with Access Denied (0x80070005)).</span></span> <span data-ttu-id="e0e6c-127">Um den erhöhten Status eines Auftrags zu ermitteln, müssen Sie die [**IBackgroundCopyJob4:: getownerelevationstate**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyjob4-getownerelevationstate) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-127">To determine the elevated state of a job, call the [**IBackgroundCopyJob4::GetOwnerElevationState**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyjob4-getownerelevationstate) method.</span></span>

<span data-ttu-id="e0e6c-128">Ein Standardbenutzer kann keine Aufträge auflisten oder ändern, die sich im Besitz anderer Benutzer befinden.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-128">A standard user cannot enumerate or modify jobs owned by other users.</span></span>

## <a name="integrity-level"></a><span data-ttu-id="e0e6c-129">Integritäts Stufe</span><span class="sxs-lookup"><span data-stu-id="e0e6c-129">Integrity level</span></span>
<span data-ttu-id="e0e6c-130">Zusätzlich zum Status erhöht kann die Integritäts Stufe des Tokens ermitteln, ob der Benutzer einen Auftrag ändern kann.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-130">In addition to the elevated state, the integrity level of the token can determine if the user can modify a job.</span></span> <span data-ttu-id="e0e6c-131">Ein Client kann keine Aufträge ändern, die von einem Token mit einer höheren Integritäts Ebene erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-131">A client cannot modify jobs created by a token with a higher integrity level.</span></span> <span data-ttu-id="e0e6c-132">Insbesondere verfügen viele Token des lokalen Systems über eine Integritäts Stufe, die höher als die Integritäts Stufe eines erweiterten Fensters ist, sodass Sie nicht von einem Administrator von einem normalen Befehlsfenster mit erhöhten Rechten geändert werden können.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-132">In particular, many local-system tokens carry an integrity level higher than the integrity level of an elevated window, and so they cannot be modified by an administrator from an ordinary elevated command window.</span></span> <span data-ttu-id="e0e6c-133">Beispielsweise werden Windows Update-und SMS-Aufträge als "LocalSystem" ausgeführt, das eine höhere Integritäts Stufe aufweist als ein Token mit erhöhten Rechten, sodass ein Administrator diese Aufträge nicht ändern oder löschen kann.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-133">For example, Windows Update and SMS jobs run as LocalSystem which has a higher integrity level than an elevated token so an administrator cannot modify or delete these jobs.</span></span> <span data-ttu-id="e0e6c-134">Erstellen Sie einen Taskplaner Task, der als lokales System ausgeführt wird, um diesen Auftrag zu ändern.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-134">To modify these job, create a Task Scheduler task that runs as local system.</span></span> <span data-ttu-id="e0e6c-135">Der Task kann eine Konsolenanwendung ausführen, die die Bits-API verwendet, oder der Task kann ein Skript ausführen, das BitsAdmin.exe aufruft.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-135">The task can execute a console application that uses the BITS API, or the task could execute a script that calls BitsAdmin.exe.</span></span> <span data-ttu-id="e0e6c-136">Um die verwendete Integritäts Stufe zu ermitteln, müssen Sie die [**IBackgroundCopyJob4:: getownerintegratylevel**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyjob4-getownerintegritylevel) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-136">To determine the integrity level used, call the [**IBackgroundCopyJob4::GetOwnerIntegrityLevel**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyjob4-getownerintegritylevel) method.</span></span>

## <a name="service-identity"></a><span data-ttu-id="e0e6c-137">Dienst Identität</span><span class="sxs-lookup"><span data-stu-id="e0e6c-137">Service identity</span></span>
<span data-ttu-id="e0e6c-138">Beginnend mit dem Windows 10-Update von Mai 2019 (10,0; Build 18362), von einem Dienst gestartete BITS-Aufträge behalten die Dienst Identität bei.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-138">Starting in the Windows 10 May 2019 Update (10.0; Build 18362), BITS jobs started from a service will maintain the service identity.</span></span> <span data-ttu-id="e0e6c-139">Dies ermöglicht es Diensten, die Bits verwenden möchten, um Dateien herunterzuladen oder Dateien aus einem Verzeichnis hochzuladen, dessen Berechtigungen an die Dienst-SID gebunden sind.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-139">This allows for services that wish to use BITS to download files to or upload files from a directory whose permissions are tied to the service SID.</span></span> <span data-ttu-id="e0e6c-140">Außerdem wird der Netzwerk Datenverkehr dem Dienst, der den BITS-Auftrag angefordert hat, ordnungsgemäß zugeordnet, anstatt Bits zugeordnet zu werden.</span><span class="sxs-lookup"><span data-stu-id="e0e6c-140">Additionally, network traffic will be correctly attributed to the service that requested the BITS job instead of being attributed to BITS.</span></span>

 




