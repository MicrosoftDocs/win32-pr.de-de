---
title: Modulinformationen
description: Ein Modul ist eine ausführbare Datei oder dll.
ms.assetid: e15b5e15-ca06-4733-bd0a-705058ba2db8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1625877832b7e57e68ec6baff79f0c34b4478176
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104390424"
---
# <a name="module-information"></a><span data-ttu-id="a8f05-103">Modulinformationen</span><span class="sxs-lookup"><span data-stu-id="a8f05-103">Module Information</span></span>

<span data-ttu-id="a8f05-104">Ein *Modul* ist eine ausführbare Datei oder dll.</span><span class="sxs-lookup"><span data-stu-id="a8f05-104">A *module* is an executable file or DLL.</span></span> <span data-ttu-id="a8f05-105">Jeder Prozess besteht aus einem oder mehreren Modulen.</span><span class="sxs-lookup"><span data-stu-id="a8f05-105">Each process consists of one or more modules.</span></span> <span data-ttu-id="a8f05-106">Sie können die Liste der Modul Handles für einen Prozess abrufen, indem Sie die [**enumprocessmodules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a8f05-106">You can retrieve the list of module handles for a process by calling the [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) function.</span></span> <span data-ttu-id="a8f05-107">Diese Funktion füllt ein Array von **HMODULE** -Werten mit den Modul Handles für den angegebenen Prozess auf.</span><span class="sxs-lookup"><span data-stu-id="a8f05-107">This function fills an array of **HMODULE** values with the module handles for the specified process.</span></span> <span data-ttu-id="a8f05-108">Das erste Modul ist die ausführbare Datei.</span><span class="sxs-lookup"><span data-stu-id="a8f05-108">The first module is the executable file.</span></span> <span data-ttu-id="a8f05-109">Beachten Sie, dass diese Modul Handles wahrscheinlich von einem anderen Prozess verarbeitet werden, sodass Sie Sie nicht mit Funktionen wie [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea)verwenden können.</span><span class="sxs-lookup"><span data-stu-id="a8f05-109">Remember that these module handles are most likely from some other process, so you cannot use them with functions such as [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span></span> <span data-ttu-id="a8f05-110">Sie können jedoch [PSAPI-Funktionen](psapi-functions.md) verwenden, um Informationen zu einem Modul von einem anderen Prozess abzurufen.</span><span class="sxs-lookup"><span data-stu-id="a8f05-110">However, you can use [PSAPI functions](psapi-functions.md) to obtain information about a module from another process.</span></span>

<span data-ttu-id="a8f05-111">Im folgenden Verfahren wird beschrieben, wie Modul Informationen von einem anderen Prozess abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="a8f05-111">The following procedure describes how to obtain module information from another process.</span></span>

<span data-ttu-id="a8f05-112">**So rufen Sie Modul Informationen von einem anderen Prozess ab**</span><span class="sxs-lookup"><span data-stu-id="a8f05-112">**To obtain module information from another process**</span></span>

1.  <span data-ttu-id="a8f05-113">Aufrufen der [**getmodulebasename**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="a8f05-113">Call the [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) function.</span></span> <span data-ttu-id="a8f05-114">Diese Funktion nimmt ein Prozess handle und ein Modul Handle als Eingabe und füllt einen Puffer mit dem Basisnamen eines Moduls (z. b. Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="a8f05-114">This function takes a process handle and a module handle as input and fills in a buffer with the base name of a module (for example, Kernel32.dll).</span></span> <span data-ttu-id="a8f05-115">Die verknüpfte Funktion [**getmoduledatameex**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa)übernimmt dieselben Parameter wie die Eingabe, gibt jedoch den vollständigen Pfad zum Modul zurück (z. b. C: \\ Windows \\ system32 \\Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="a8f05-115">A related function, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), takes the same parameters as input but returns the full path to the module (for example, C:\\Windows\\System32\\Kernel32.dll).</span></span>
2.  <span data-ttu-id="a8f05-116">Aufrufen der [**getmoduleinformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="a8f05-116">Call the [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) function.</span></span> <span data-ttu-id="a8f05-117">Diese Funktion nimmt ein Prozess handle und ein Modul Handle an und füllt eine [**ModuleInfo**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) -Struktur mit der Lade Adresse des Moduls, der Größe des belegten linearen Adressraums und einem Zeiger auf den Einstiegspunkt.</span><span class="sxs-lookup"><span data-stu-id="a8f05-117">This function takes a process handle and a module handle and fills a [**MODULEINFO**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) structure with the load address of the module, the size of the linear address space it occupies, and a pointer to its entry point.</span></span>

<span data-ttu-id="a8f05-118">Wenn eine Anwendung Modul Informationen für den aktuellen Prozess erfordert, sollte Sie die [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) -Funktion anstelle der PSAPI-Modulfunktionen verwenden.</span><span class="sxs-lookup"><span data-stu-id="a8f05-118">If an application requires module information for the current process, it should use the [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) function instead of the PSAPI module functions.</span></span> <span data-ttu-id="a8f05-119">Dies unterstützt die Anwendungsleistung auf zwei Arten: die **GetModuleFileName** -Funktion ist effizienter als die PSAPI-Modulfunktionen, und eine Anwendung kann das Laden von psapi.dll vermeiden, wenn keine PSAPI-Funktionen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a8f05-119">This helps application performance in two ways: The **GetModuleFileName** function is more efficient than the PSAPI module functions, and an application can avoid loading psapi.dll if it does not use any PSAPI functions.</span></span>

<span data-ttu-id="a8f05-120">Die Funktionen [**getmodulebasename**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) und [**getmoduledateinameex**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) sind hauptsächlich für die Verwendung durch Debugger und ähnliche Anwendungen konzipiert, die Modul Informationen aus einem anderen Prozess extrahieren müssen.</span><span class="sxs-lookup"><span data-stu-id="a8f05-120">The [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) and [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) functions are primarily designed for use by debuggers and similar applications that must extract module information from another process.</span></span> <span data-ttu-id="a8f05-121">Wenn die Modulliste im Ziel Prozess beschädigt ist oder noch nicht initialisiert wurde oder wenn sich die Modulliste während des Funktions Aufrufes ändert, da DLLs geladen oder entladen werden, können diese Funktionen fehlschlagen oder falsche Informationen zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="a8f05-121">If the module list in the target process is corrupted or is not yet initialized, or if the module list changes during the function call as a result of DLLs being loaded or unloaded, these functions may fail or return incorrect information.</span></span>

 

 