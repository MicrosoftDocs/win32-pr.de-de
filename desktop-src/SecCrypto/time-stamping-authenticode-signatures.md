---
description: Das Authenticode-Zeitstempeling basiert auf PKCS \# 7-Standard-Gegensignaturen. Mit Signaturtools von Microsoft können Entwickler Zeitstempel gleichzeitig anheften, während sie Authenticode-Signaturen anheften.
ms.assetid: d0bd3e2f-1eee-4f71-9467-974994f720d5
title: Zeitstempel von Authenticode-Signaturen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0232853441d2c11d331c175ac7e8dfd120b341ff
ms.sourcegitcommit: dc2f43e0f23f4a4ce239118cf9a5180f3ff0dd1d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/30/2021
ms.locfileid: "108327185"
---
# <a name="time-stamping-authenticode-signatures"></a><span data-ttu-id="1e87e-104">Zeitstempel von Authenticode-Signaturen</span><span class="sxs-lookup"><span data-stu-id="1e87e-104">Time Stamping Authenticode Signatures</span></span>

<span data-ttu-id="1e87e-105">Microsoft Authenticode-Signaturen bieten Erstellungs- und Integritätsgarantien für Binärdaten.</span><span class="sxs-lookup"><span data-stu-id="1e87e-105">Microsoft Authenticode signatures provide authorship and integrity guarantees for binary data.</span></span> <span data-ttu-id="1e87e-106">Das Authenticode-Zeitstempeling basiert auf PKCS \# 7-Standard-Gegensignaturen.</span><span class="sxs-lookup"><span data-stu-id="1e87e-106">Authenticode time stamping is based on standard PKCS \#7 countersignatures.</span></span> <span data-ttu-id="1e87e-107">Mit Signaturtools von Microsoft können Entwickler Zeitstempel gleichzeitig anheften, während sie Authenticode-Signaturen anheften.</span><span class="sxs-lookup"><span data-stu-id="1e87e-107">Signing tools from Microsoft allow developers to affix time stamps at the same time as they affix Authenticode signatures.</span></span> <span data-ttu-id="1e87e-108">Mit dem Zeitstempel können Authenticode-Signaturen auch dann überprüfbar sein, wenn die für die Signatur verwendeten Zertifikate abgelaufen sind.</span><span class="sxs-lookup"><span data-stu-id="1e87e-108">Time stamping allows Authenticode signatures to be verifiable even after the certificates used for signature have expired.</span></span>

## <a name="a-brief-introduction-to-authenticode"></a><span data-ttu-id="1e87e-109">Eine kurze Einführung in Authenticode</span><span class="sxs-lookup"><span data-stu-id="1e87e-109">A Brief Introduction to Authenticode</span></span>

<span data-ttu-id="1e87e-110">[*Authenticode*](../secgloss/a-gly.md) wendet digitale Signaturtechnologie an, um die Erstellung und Integrität von Binärdaten wie installierbarer Software zu gewährleisten.</span><span class="sxs-lookup"><span data-stu-id="1e87e-110">[*Authenticode*](../secgloss/a-gly.md) applies digital signature technology to guarantee the authorship and integrity of binary data such as installable software.</span></span> <span data-ttu-id="1e87e-111">Ein Clientwebbrowser oder andere Systemkomponenten können die Authenticode-Signaturen verwenden, um die Integrität der Daten zu überprüfen, wenn die Software heruntergeladen oder installiert wird.</span><span class="sxs-lookup"><span data-stu-id="1e87e-111">A client web browser, or other system components, can use the Authenticode signatures to verify the integrity of the data when the software is downloaded or installed.</span></span> <span data-ttu-id="1e87e-112">Authenticode-Signaturen können mit vielen Softwareformaten verwendet werden, einschließlich CAB, EXE, OCX und DLL.</span><span class="sxs-lookup"><span data-stu-id="1e87e-112">Authenticode signatures can be used with many software formats, including .cab, .exe, .ocx, and .dll.</span></span>

<span data-ttu-id="1e87e-113">Microsoft verwaltet eine Liste mit öffentlichen [*Zertifizierungsstellen*](/security/trusted-root/participants-list) (CAs).</span><span class="sxs-lookup"><span data-stu-id="1e87e-113">Microsoft maintains a list of public [*certification authorities*](/security/trusted-root/participants-list) (CAs).</span></span> <span data-ttu-id="1e87e-114">Zu den Ausstellern von Authenticode-Zertifikaten gehören derzeit [SSL.com](https://www.ssl.com/), [Digicert](https://www.digicert.com/), [Sectigo(Comodo)](https://www.sectigo.com/)und [GlobalSign](https://www.globalsign.com/).</span><span class="sxs-lookup"><span data-stu-id="1e87e-114">Issuers of Authenticode certificates currently include [SSL.com](https://www.ssl.com/), [Digicert](https://www.digicert.com/), [Sectigo(Comodo)](https://www.sectigo.com/), and [GlobalSign](https://www.globalsign.com/).</span></span>

## <a name="about-cryptographic-time-stamping"></a><span data-ttu-id="1e87e-115">Informationen zum kryptografischen Zeitstempel</span><span class="sxs-lookup"><span data-stu-id="1e87e-115">About Cryptographic Time Stamping</span></span>

<span data-ttu-id="1e87e-116">In der Vergangenheit wurde eine Vielzahl kryptografischer Zeitstempelmethoden vorgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="1e87e-116">In the past, a variety of cryptographic time stamping methods have been proposed.</span></span> <span data-ttu-id="1e87e-117">Siehe z.B. Haber und Storn msi "How to Time-Stamp a Digital Document" im *Journal of Crypto alternatives* (1991) und Benaloh und de Signe "One-Way Akkumulatoren: Eine dezentralisierte Alternative zu digitalen Signaturen" in *Springer-Umleitungshinweisen in Der Computer science* vol. 765 (EUROCRYPT '93).</span><span class="sxs-lookup"><span data-stu-id="1e87e-117">See, for example, Haber and Stornetta "How to Time-Stamp a Digital Document" in the *Journal of Cryptology* (1991) and Benaloh and de Mare "One-Way Accumulators: A Decentralized Alternative to Digital Signatures" in *Springer-Verlag Lecture Notes in Computer Science* vol. 765 (EUROCRYPT '93).</span></span> <span data-ttu-id="1e87e-118">Eine erweiterte Zusammenfassung dieses Artikels finden Sie unter [Microsoft Research.](https://research.microsoft.com/research/pubs/view.aspx?id=233&type=Publication&0sr=a)</span><span class="sxs-lookup"><span data-stu-id="1e87e-118">An extended abstract of this article is available from [Microsoft Research](https://research.microsoft.com/research/pubs/view.aspx?id=233&type=Publication&0sr=a).</span></span> <span data-ttu-id="1e87e-119">(Diese Ressourcen sind in einigen Sprachen und Ländern oder Regionen möglicherweise nicht verfügbar.) Da die Zeit eine physische statt einer mathematischen Menge ist, betreffen diese Methoden im Allgemeinen, wie Objekte so verlinkt werden, dass ihre Reihenfolge der Erstellung bestimmt werden kann, oder wie Objekte effizient gruppieren, die alle als gleichzeitig erstellt beschrieben werden können.</span><span class="sxs-lookup"><span data-stu-id="1e87e-119">(These resources may not be available in some languages and countries or regions.) Because time is a physical, rather than a mathematical, quantity, these methods generally concern how to link objects so that their order of creation can be determined or how to efficiently group objects that can all be described as having been created concurrently.</span></span>

<span data-ttu-id="1e87e-120">Systeme, bei denen die Authentifizierungszeit als Menge verwendet wird, erfordern immer eine Form von Vertrauensstellung.</span><span class="sxs-lookup"><span data-stu-id="1e87e-120">Systems that purport to authenticate time as a quantity always require some form of trust.</span></span> <span data-ttu-id="1e87e-121">In einer stark konversiven Einstellung können komplexe Protokolle verwendet werden, um ein gewisses Maß an Synchronität sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="1e87e-121">In a strongly adversarial setting, complex protocols can be used to ensure some degree of synchrony.</span></span> <span data-ttu-id="1e87e-122">Diese Protokolle erfordern jedoch eine umfassende Interaktion zwischen den betroffenen Parteien.</span><span class="sxs-lookup"><span data-stu-id="1e87e-122">However, these protocols require extensive interaction between affected parties.</span></span> <span data-ttu-id="1e87e-123">In der Praxis kann die Quelle einfach als Notar fungieren, wenn nur eine Zeitzertifizierung von einer vertrauenswürdigen Quelle benötigt wird, indem eine signierte Anweisung (Zertifizierung) angegeben wird, dass das Objekt zum angegebenen Zeitpunkt zur Signatur präsentiert wurde.</span><span class="sxs-lookup"><span data-stu-id="1e87e-123">In practice, if one only needs certification of time from a trusted source, the source can simply act as a notary by providing a signed statement (certification) that the object was presented for signature at the indicated time.</span></span>

<span data-ttu-id="1e87e-124">Die unten implementierte Gegensignaturmethode des Zeitstempels ermöglicht die Überprüfung von Signaturen, auch nachdem das Signaturzertifikat abgelaufen oder widerrufen wurde.</span><span class="sxs-lookup"><span data-stu-id="1e87e-124">The countersignature method of time stamping implemented below allows for signatures to be verified even after the signing certificate has expired or been revoked.</span></span> <span data-ttu-id="1e87e-125">Mit dem Zeitstempel kann der Verifizierer zuverlässig wissen, zu welchem Zeitpunkt die Signatur angebracht wurde, und dadurch der Signatur vertrauen, wenn sie zu diesem Zeitpunkt gültig war.</span><span class="sxs-lookup"><span data-stu-id="1e87e-125">The time stamp allows the verifier to reliably know the time that the signature was affixed and thereby trust the signature if it was valid at that time.</span></span> <span data-ttu-id="1e87e-126">Der Zeitstempel sollte über eine zuverlässige und geschützte Zeitquelle verfügen.</span><span class="sxs-lookup"><span data-stu-id="1e87e-126">The time stamper should have a reliable and protected time source.</span></span>

## <a name="pkcs-7-signed-documents-and-countersignatures"></a><span data-ttu-id="1e87e-127">SIGNIERTE PKCS \# 7-Dokumente und Gegensignaturen</span><span class="sxs-lookup"><span data-stu-id="1e87e-127">PKCS \#7 Signed Documents and Countersignatures</span></span>

<span data-ttu-id="1e87e-128">PKCS 7 ist ein Standardformat für kryptografische Daten, einschließlich signierter Daten, Zertifikate und \# Zertifikatsperrlisten (Certificate [*Revocation Lists,*](../secgloss/c-gly.md) CRLs).</span><span class="sxs-lookup"><span data-stu-id="1e87e-128">PKCS \#7 is a standard format for cryptographic data, including signed data, certificates, and [*certificate revocation lists*](../secgloss/c-gly.md) (CRLs).</span></span> <span data-ttu-id="1e87e-129">Der spezielle PKCS 7-Typ, der im Kontext des Zeitstempels von Interesse ist, sind signierte Daten, die dem von \# PKCS 7 definierten \# [**SignedData-Inhaltstyp**](signeddata.md) entspricht.</span><span class="sxs-lookup"><span data-stu-id="1e87e-129">The particular PKCS \#7 type of interest in the context of time stamping is signed data, corresponding to the PKCS \#7 defined [**SignedData**](signeddata.md) content type.</span></span>

<span data-ttu-id="1e87e-130">Das PKCS 7-Paket besteht aus SignedData, die den tatsächlichen Inhalt und bestimmte Informationen darüber sowie \# SignerInfo-Signaturblöcke identifiziert. [](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="1e87e-130">The PKCS \#7 package consists of [**SignedData**](signeddata.md) that identifies the actual content and certain information about it and SignerInfo signature blocks.</span></span> <span data-ttu-id="1e87e-131">SignerInfo kann selbst eine Gegensignatur enthalten, die rekursiv eine weitere SignerInfo ist.</span><span class="sxs-lookup"><span data-stu-id="1e87e-131">A SignerInfo may itself contain a countersignature, which recursively is another SignerInfo.</span></span> <span data-ttu-id="1e87e-132">Im Prinzip kann eine Sequenz solcher Gegensignaturen vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="1e87e-132">In principle, a sequence of such countersignatures may be present.</span></span> <span data-ttu-id="1e87e-133">Die Gegensignatur ist ein nicht authentifiziertes Attribut in Bezug auf die Signatur in der SignerInfo. Das heißt, sie kann nach der ursprünglichen Signatur fixiert werden.</span><span class="sxs-lookup"><span data-stu-id="1e87e-133">The countersignature is an unauthenticated attribute with respect to the signature in the SignerInfo; that is, it may be affixed subsequent to the original signature.</span></span> <span data-ttu-id="1e87e-134">In Gliederungsform:</span><span class="sxs-lookup"><span data-stu-id="1e87e-134">In outline form:</span></span>

<span data-ttu-id="1e87e-135">[**SignedData**](signeddata.md) (PKCS \# 7)</span><span class="sxs-lookup"><span data-stu-id="1e87e-135">[**SignedData**](signeddata.md) (PKCS \#7)</span></span>

-   <span data-ttu-id="1e87e-136">Version (von PKCS \# 7, in der Regel Version 1)</span><span class="sxs-lookup"><span data-stu-id="1e87e-136">Version (of PKCS \#7, generally version 1)</span></span>
-   <span data-ttu-id="1e87e-137">DigestAlgorithms (Sammlung aller Algorithmen, die von SignerInfo-Signaturblöcken für die optimierte Verarbeitung verwendet werden)</span><span class="sxs-lookup"><span data-stu-id="1e87e-137">DigestAlgorithms (collection of all algorithms used by SignerInfo signature blocks, for optimized processing)</span></span>
-   <span data-ttu-id="1e87e-138">ContentInfo (contentType entspricht [**SignedData**](signeddata.md), plus Inhalt oder Verweis auf Inhalt)</span><span class="sxs-lookup"><span data-stu-id="1e87e-138">ContentInfo (contentType equals [**SignedData**](signeddata.md), plus content or reference to content)</span></span>
-   <span data-ttu-id="1e87e-139">OPTIONALE Zertifikate (Sammlung aller verwendeten Zertifikate)</span><span class="sxs-lookup"><span data-stu-id="1e87e-139">OPTIONAL Certificates (collection of all certificates used)</span></span>
-   <span data-ttu-id="1e87e-140">OPTIONALE CRLs (Sammlung aller CRLs)</span><span class="sxs-lookup"><span data-stu-id="1e87e-140">OPTIONAL CRLs (collection of all CRLs)</span></span>
-   <span data-ttu-id="1e87e-141">SignerInfo-Signaturblöcke (die tatsächliche Signatur, die aus einem oder mehreren SignerInfo-Signaturblöcken besteht)</span><span class="sxs-lookup"><span data-stu-id="1e87e-141">SignerInfo signature blocks (the actual signature, composed of one or more SignerInfo signature blocks)</span></span>

<span data-ttu-id="1e87e-142">SignerInfo (der Signaturblock)</span><span class="sxs-lookup"><span data-stu-id="1e87e-142">SignerInfo (the signature block)</span></span>

-   <span data-ttu-id="1e87e-143">Version (von PKCS \# 7, in der Regel Version 1)</span><span class="sxs-lookup"><span data-stu-id="1e87e-143">Version (of PKCS \#7, generally version 1)</span></span>
-   <span data-ttu-id="1e87e-144">Zertifikat (Aussteller und Seriennummer zur eindeutigen Identifizierung des Signaturgeberzertifikats in [**SignedData)**](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="1e87e-144">Certificate (issuer and serial number to uniquely identify of signer's certificate in [**SignedData**](signeddata.md))</span></span>
-   <span data-ttu-id="1e87e-145">DigestAlgorithm plus DigestEncryptionAlgorithm plus Digest (Hash) plus EncryptedDigest (tatsächliche Signatur)</span><span class="sxs-lookup"><span data-stu-id="1e87e-145">DigestAlgorithm plus the DigestEncryptionAlgorithm plus the Digest (hash), plus the EncryptedDigest (actual signature)</span></span>
-   <span data-ttu-id="1e87e-146">OPTIONAL AuthenticatedAttributes (z. B. von diesem Signaturgeber signiert)</span><span class="sxs-lookup"><span data-stu-id="1e87e-146">OPTIONAL AuthenticatedAttributes (for example, signed by this signer)</span></span>
-   <span data-ttu-id="1e87e-147">OPTIONAL UnauthenticatedAttributes (z. B. nicht von diesem Signaturgeber signiert)</span><span class="sxs-lookup"><span data-stu-id="1e87e-147">OPTIONAL UnauthenticatedAttributes (for example, not signed by this signer)</span></span>

<span data-ttu-id="1e87e-148">Ein Beispiel für ein authentifiziertes Attribut ist die Signierungszeit (OID 1.2.840.113549.1.9.5), da sie Teil der Signatur des Zeitstempeldiensts ist.</span><span class="sxs-lookup"><span data-stu-id="1e87e-148">An example of an authenticated attribute is the signing time (OID 1.2.840.113549.1.9.5) because it is part of what the time stamp service signs.</span></span> <span data-ttu-id="1e87e-149">Ein Beispiel für ein nicht authentifiziertes Attribut ist die Gegensignatur (OID 1.2.840.113549.1.9.6), da sie nach dem Signieren fixiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="1e87e-149">An example of an unauthenticated attribute is the countersignature (OID 1.2.840.113549.1.9.6) because it can be affixed after signing.</span></span> <span data-ttu-id="1e87e-150">In diesem Fall enthält signerInfo selbst eine SignerInfo (countersignature).</span><span class="sxs-lookup"><span data-stu-id="1e87e-150">In this case, the SignerInfo itself contains a SignerInfo (the Countersignature).</span></span>

> [!Note]  
> <span data-ttu-id="1e87e-151">Das Objekt, das in der Gegensignatur signiert ist, ist die ursprüngliche Signatur (d. b. EncryptedDigest der ursprünglichen SignerInfo).</span><span class="sxs-lookup"><span data-stu-id="1e87e-151">The object that is signed in the countersignature is the original signature (that is, the EncryptedDigest of the original SignerInfo).</span></span>

 

## <a name="signtool-and-the-authenticode-process"></a><span data-ttu-id="1e87e-152">SignTool und der Authenticode-Prozess</span><span class="sxs-lookup"><span data-stu-id="1e87e-152">SignTool and the Authenticode Process</span></span>

<span data-ttu-id="1e87e-153">[SignTool ist](signtool.md) für Authenticode-Signatur- und Zeitstempel-Binärdaten verfügbar.</span><span class="sxs-lookup"><span data-stu-id="1e87e-153">[SignTool](signtool.md) is available for Authenticode signing and time stamping binary data.</span></span> <span data-ttu-id="1e87e-154">Das Tool wird im Ordner \\ Bin des Installationspfads von Microsoft Windows Software Development Kit (SDK) installiert.</span><span class="sxs-lookup"><span data-stu-id="1e87e-154">The tool is installed in the \\Bin folder of the Microsoft Windows Software Development Kit (SDK) installation path.</span></span>

<span data-ttu-id="1e87e-155">Das Signieren und Das Zeitstempeln von Binärdaten ist mit [SignTool relativ einfach.](signtool.md)</span><span class="sxs-lookup"><span data-stu-id="1e87e-155">Signing and time stamping binary data is relatively straightforward using [SignTool](signtool.md).</span></span> <span data-ttu-id="1e87e-156">Der Herausgeber muss ein Codesignaturzertifikat von einer kommerziellen Codesignatur-Zertifizierungsstelle erhalten.</span><span class="sxs-lookup"><span data-stu-id="1e87e-156">The publisher must get a code signing certificate from a commercial code signing CA.</span></span> <span data-ttu-id="1e87e-157">Der Einfachheit halber veröffentlicht und aktualisiert Microsoft eine Liste mit öffentlichen Zertifizierungsstelle, einschließlich der Zertifizierungsstelle, die Authenticode-Zertifikate aushing.</span><span class="sxs-lookup"><span data-stu-id="1e87e-157">For convenience, Microsoft publishes and updates a list of public CAs, including those that issue Authenticode certificates.</span></span> <span data-ttu-id="1e87e-158">Wenn sie zur Veröffentlichung bereit sind, werden die Objektdateien signiert und mithilfe der entsprechenden Befehlszeilenparameter mit dem SignTool-Tool mit einem Zeitstempel versehen.</span><span class="sxs-lookup"><span data-stu-id="1e87e-158">When ready to publish, the object files are signed and time stamped using appropriate command line parameters with the SignTool tool.</span></span> <span data-ttu-id="1e87e-159">Das Ergebnis eines SignTool-Vorgangs ist immer das PKCS \# 7-Format [**SignedData.**](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="1e87e-159">The result of any SignTool operation is always a PKCS \#7 format [**SignedData**](signeddata.md).</span></span>

<span data-ttu-id="1e87e-160">SignTool akzeptiert als Eingabe entweder binäre Rohdaten, die signiert und mit einem Zeitstempel versehen werden sollen, oder zuvor signierte Binärdaten, die mit einem Zeitstempel versehen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="1e87e-160">SignTool accepts as input either raw binary data to be signed and time stamped, or previously signed binary data to be time stamped.</span></span> <span data-ttu-id="1e87e-161">Daten, die zuvor signiert wurden, können mithilfe des Befehls **signtool timestamp** mit einem Zeitstempel versehen werden.</span><span class="sxs-lookup"><span data-stu-id="1e87e-161">Data that has previously been signed can be time stamped by using the **signtool timestamp** command.</span></span>



| <span data-ttu-id="1e87e-162">Argument</span><span class="sxs-lookup"><span data-stu-id="1e87e-162">Argument</span></span>             | <span data-ttu-id="1e87e-163">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="1e87e-163">Description</span></span>                                                                                                                                                                                                    |
|----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1e87e-164">**/t** *HTTPAddress*</span><span class="sxs-lookup"><span data-stu-id="1e87e-164">**/t** *HTTPAddress*</span></span> | <span data-ttu-id="1e87e-165">Gibt an, dass für die Datei ein Zeitstempel verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="1e87e-165">Indicates that the file is to be time stamped.</span></span> <span data-ttu-id="1e87e-166">Eine URL, die eine Adresse eines Zeitstempelservers angibt, muss angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="1e87e-166">A URL that specifies an address of a time stamping server must be provided.</span></span> <span data-ttu-id="1e87e-167">**/t kann** sowohl mit **signtool sign-** als auch **mit signtool-Zeitstempelbefehlen verwendet** werden.</span><span class="sxs-lookup"><span data-stu-id="1e87e-167">**/t** can be used with both **signtool sign** and **signtool timestamp** commands.</span></span> |



 

<span data-ttu-id="1e87e-168">Weitere Informationen zu Tools, die in diesem Kontext nützlich sein können, finden Sie unter [Cryptography Tools](cryptography-tools.md) und [SignTool](signtool.md).</span><span class="sxs-lookup"><span data-stu-id="1e87e-168">For more information about tools that may be useful in this context, see [Cryptography Tools](cryptography-tools.md) and [SignTool](signtool.md).</span></span>

## <a name="implementation-details-and-wire-format"></a><span data-ttu-id="1e87e-169">Implementierungsdetails und Wire Format</span><span class="sxs-lookup"><span data-stu-id="1e87e-169">Implementation Details and Wire Format</span></span>

<span data-ttu-id="1e87e-170">[SignTool verwendet](signtool.md) die Windows Authenticode-Implementierung zum Erstellen von Und Zeitstempelsignaturen.</span><span class="sxs-lookup"><span data-stu-id="1e87e-170">[SignTool](signtool.md) relies on the Windows Authenticode implementation to create and time stamp signatures.</span></span> <span data-ttu-id="1e87e-171">[*Authenticode*](../secgloss/a-gly.md) arbeitet mit Binärdateien wie CAB, EXE, DLL oder OCX.</span><span class="sxs-lookup"><span data-stu-id="1e87e-171">[*Authenticode*](../secgloss/a-gly.md) operates on binary files, for example .cab, .exe, .dll, or .ocx.</span></span> <span data-ttu-id="1e87e-172">Authenticode erstellt zuerst die Signatur und erzeugt einen PKCS \# 7 [**SignedData-Wert.**](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="1e87e-172">Authenticode first creates the signature, producing a PKCS \#7 [**SignedData**](signeddata.md).</span></span> <span data-ttu-id="1e87e-173">Diese **SignedData-Daten** müssen gegensigniert werden, wie in PKCS \# 9 beschrieben.</span><span class="sxs-lookup"><span data-stu-id="1e87e-173">It is this **SignedData** that must be countersigned, as described in PKCS \#9.</span></span>

<span data-ttu-id="1e87e-174">Der Gegensignaturprozess erfolgt in vier Schritten:</span><span class="sxs-lookup"><span data-stu-id="1e87e-174">The countersignature process takes place in four steps:</span></span>

1.  <span data-ttu-id="1e87e-175">Kopieren Sie die Signatur (d.h. encryptedDigest) aus der SignerInfo des PKCS \# 7 [**SignedData**](signeddata.md).</span><span class="sxs-lookup"><span data-stu-id="1e87e-175">Copy the signature (that is, the encryptedDigest) from the SignerInfo of the PKCS \#7 [**SignedData**](signeddata.md).</span></span>
2.  <span data-ttu-id="1e87e-176">Erstellen Sie eine Zeitstempelanforderung, deren Inhalt die ursprüngliche Signatur ist.</span><span class="sxs-lookup"><span data-stu-id="1e87e-176">Construct a time stamp request whose content is the original signature.</span></span> <span data-ttu-id="1e87e-177">Senden Sie dies an den Zeitstempelserver [*Abstract Syntax Notation One*](../secgloss/a-gly.md) (ASN.1), der als TimeStampRequest codiert ist.</span><span class="sxs-lookup"><span data-stu-id="1e87e-177">Send this to the time stamp server [*Abstract Syntax Notation One*](../secgloss/a-gly.md) (ASN.1) encoded as a TimeStampRequest.</span></span>
3.  <span data-ttu-id="1e87e-178">Empfangen Sie einen Zeitstempel, der als zweites PKCS 7 SignedData formatiert ist \# und vom Zeitstempelserver zurückgegeben wird. [](signeddata.md)</span><span class="sxs-lookup"><span data-stu-id="1e87e-178">Receive a time stamp, formatted as a second PKCS \#7 [**SignedData**](signeddata.md), returned from the time stamp server.</span></span>
4.  <span data-ttu-id="1e87e-179">Kopieren Sie signerInfo aus dem Zeitstempel direkt in die ursprüngliche PKCS \# 7 [**SignedData**](signeddata.md)als PKCS \# 9-Gegensignatur (d.amp;n.b. ein nicht authentifiziertes Attribut in der SignerInfo des Originals).</span><span class="sxs-lookup"><span data-stu-id="1e87e-179">Copy the SignerInfo from the time stamp directly into the original PKCS \#7 [**SignedData**](signeddata.md), as a PKCS \#9 countersignature (that is, an unauthenticated attribute in the SignerInfo of the original).</span></span>

## <a name="time-stamp-request"></a><span data-ttu-id="1e87e-180">Zeitstempelanforderung</span><span class="sxs-lookup"><span data-stu-id="1e87e-180">Time Stamp Request</span></span>

<span data-ttu-id="1e87e-181">Die Zeitstempelanforderung wird innerhalb einer HTTP 1.1 POST-Nachricht gesendet.</span><span class="sxs-lookup"><span data-stu-id="1e87e-181">The time stamp request is sent within an HTTP 1.1 POST message.</span></span> <span data-ttu-id="1e87e-182">Im HTTP-Header wird die CacheControl-Direktive auf no-cache und die Content-Type-Direktive auf application/octet-stream festgelegt.</span><span class="sxs-lookup"><span data-stu-id="1e87e-182">In the HTTP header, the CacheControl directive is set to no-cache, and the Content-Type directive is set to application/octet-stream.</span></span> <span data-ttu-id="1e87e-183">Der Text der HTTP-Nachricht ist eine Base64-Codierung der [*Distinguished Encoding Rules*](../secgloss/d-gly.md) (DER)-Codierung der Zeitstempelanforderung.</span><span class="sxs-lookup"><span data-stu-id="1e87e-183">The body of the HTTP message is a base64 encoding of [*Distinguished Encoding Rules*](../secgloss/d-gly.md) (DER) encoding of the time stamp request.</span></span>

<span data-ttu-id="1e87e-184">Obwohl sie derzeit nicht verwendet wird, sollte die Content-Length-Direktive auch zum Erstellen der HTTP-Nachricht verwendet werden, da sie dem Zeitstempelserver hilft, zu ermitteln, wo sich die Anforderung innerhalb von HTTP POST befindet.</span><span class="sxs-lookup"><span data-stu-id="1e87e-184">Although not currently used, the Content-Length directive should also be used in constructing the HTTP message because it helps the time stamp server locate where the request is within the HTTP POST.</span></span>

<span data-ttu-id="1e87e-185">Andere HTTP-Header können ebenfalls vorhanden sein und sollten ignoriert werden, wenn sie vom Anforderer oder Zeitstempelserver nicht verstanden werden.</span><span class="sxs-lookup"><span data-stu-id="1e87e-185">Other HTTP headers may also be present and should be ignored if they are not understood by the requestor or time stamp server.</span></span>

<span data-ttu-id="1e87e-186">Die Zeitstempelanforderung ist eine ASN.1-codierte Nachricht.</span><span class="sxs-lookup"><span data-stu-id="1e87e-186">The time stamp request is an ASN.1 encoded message.</span></span> <span data-ttu-id="1e87e-187">Das Format der Anforderung lautet wie folgt.</span><span class="sxs-lookup"><span data-stu-id="1e87e-187">The format of the request is as follows.</span></span>

``` syntax
TimeStampRequest ::= SEQUENCE {
   countersignatureType OBJECT IDENTIFIER,
   attributes Attributes OPTIONAL, 
   content  ContentInfo
}
```

<span data-ttu-id="1e87e-188">CountersignatureType ist der [*Objektbezeichner*](../secgloss/o-gly.md) (OID), der diese als Zeitstempel-Gegensignatur identifiziert und die genaue OID 1.3.6.1.4.1.311.3.2.1 sein sollte.</span><span class="sxs-lookup"><span data-stu-id="1e87e-188">The countersignatureType is the [*object identifier*](../secgloss/o-gly.md) (OID) that identifies this as a time stamp countersignature and should be the exact OID 1.3.6.1.4.1.311.3.2.1.</span></span>

<span data-ttu-id="1e87e-189">In der Zeitstempelanforderung sind derzeit keine Attribute enthalten.</span><span class="sxs-lookup"><span data-stu-id="1e87e-189">No attributes are currently included in the time stamp request.</span></span>

<span data-ttu-id="1e87e-190">Der Inhalt ist eine ContentInfo, wie in PKCS \# 7 definiert.</span><span class="sxs-lookup"><span data-stu-id="1e87e-190">The content is a ContentInfo as defined by PKCS \#7.</span></span> <span data-ttu-id="1e87e-191">Bei dem Inhalt handelt es sich um die zu signierten Daten.</span><span class="sxs-lookup"><span data-stu-id="1e87e-191">The content is the data to be signed.</span></span> <span data-ttu-id="1e87e-192">Für das Signaturzeitstempeln sollte der ContentType Data sein, und der Inhalt sollte der encryptedDigest (Signatur) aus der SignerInfo des PKCS \# 7-Inhalts sein, um einen Zeitstempel zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1e87e-192">For signature time stamping, the ContentType should be Data, and the content should be the encryptedDigest (signature) from the SignerInfo of the PKCS \#7 content to be time stamped.</span></span>

## <a name="time-stamp-response"></a><span data-ttu-id="1e87e-193">Zeitstempelantwort</span><span class="sxs-lookup"><span data-stu-id="1e87e-193">Time Stamp Response</span></span>

<span data-ttu-id="1e87e-194">Die Zeitstempelantwort wird auch innerhalb einer HTTP 1.1-Nachricht gesendet.</span><span class="sxs-lookup"><span data-stu-id="1e87e-194">The time stamp response is also sent within an HTTP 1.1 message.</span></span> <span data-ttu-id="1e87e-195">Im HTTP-Header wird die Content-Type-Direktive ebenfalls auf application/octet-stream festgelegt.</span><span class="sxs-lookup"><span data-stu-id="1e87e-195">In the HTTP header, the Content-Type directive is also set to application/octet-stream.</span></span> <span data-ttu-id="1e87e-196">Der Text der HTTP-Nachricht ist eine Base64-Codierung der DER-Codierung der Zeitstempelantwort.</span><span class="sxs-lookup"><span data-stu-id="1e87e-196">The body of the HTTP message is a base64 encoding of DER encoding of the time stamp response.</span></span>

<span data-ttu-id="1e87e-197">Die Zeitstempelantwort ist eine vom Zeitstempeler signierte PKCS \# 7-Nachricht.</span><span class="sxs-lookup"><span data-stu-id="1e87e-197">The time stamp response is a PKCS \#7 signed message signed by the time stamper.</span></span> <span data-ttu-id="1e87e-198">Die ContentInfo der PKCS 7-Nachricht ist mit der im Zeitstempel \# empfangenen ContentInfo identisch.</span><span class="sxs-lookup"><span data-stu-id="1e87e-198">The ContentInfo of the PKCS \#7 message is identical to the ContentInfo received in the time stamp.</span></span> <span data-ttu-id="1e87e-199">Der PKCS 7-Inhalt enthält das authentifizierte Signaturzeitattribut \# (definiert in PKCS \# 99, OID 1.2.840.113549.9.5).</span><span class="sxs-lookup"><span data-stu-id="1e87e-199">The PKCS \#7 content contains the signing time authenticated attribute (defined in PKCS \#99, OID 1.2.840.113549.9.5).</span></span>

<span data-ttu-id="1e87e-200">Nachdem Authenticode den Zeitstempel vom Server empfangen hat, integriert Authenticode den Zeitstempel in die ursprünglichen PKCS \# 7 [**SignedData-Daten**](signeddata.md) als Gegensignatur.</span><span class="sxs-lookup"><span data-stu-id="1e87e-200">After Authenticode receives the time stamp from the server, Authenticode incorporates the time stamp into the original PKCS \#7 [**SignedData**](signeddata.md) as a countersignature.</span></span> <span data-ttu-id="1e87e-201">Hierzu wird die ContentInfo der zurückgegebenen PKCS 7 SignedData verworfen, und die SignerInfo des zurückgegebenen Zeitstempels wird als Gegensignatur in die SignerInfo der ursprünglichen \# PKCS  \# 7 **SignedData** kopiert.</span><span class="sxs-lookup"><span data-stu-id="1e87e-201">To accomplish this, the ContentInfo of the returned PKCS \#7 **SignedData** is discarded, and the SignerInfo of the returned time stamp is copied as a countersignature into the SignerInfo of the original PKCS \#7 **SignedData**.</span></span> <span data-ttu-id="1e87e-202">Die Zertifikatkette des Zeitstempels wird auch in Zertifikate in den ursprünglichen PKCS \# 7 **SignedData** als nicht authentifizierte Attribute des ursprünglichen Signaturers kopiert.</span><span class="sxs-lookup"><span data-stu-id="1e87e-202">The certificate chain of the time stamper is also copied into Certificates in the original PKCS \#7 **SignedData** as an unauthenticated attribute of the original signer.</span></span>

<span data-ttu-id="1e87e-203">Weitere Informationen zu PKCS und anderen Sicherheitsthemen finden Sie in der [Inhaltsbibliothek der RSA-Website](https://www.rsa.com/content_library.aspx).</span><span class="sxs-lookup"><span data-stu-id="1e87e-203">For more information about PKCS and other security subjects, see the [content library of the RSA website](https://www.rsa.com/content_library.aspx).</span></span>

 

 
