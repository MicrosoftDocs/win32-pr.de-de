---
description: Generieren, abrufen und Exportieren von RSA/SChannel-Schlüsseln.
ms.assetid: 3069232f-d016-4973-ae39-89b0e2a03cd7
title: RSA/SChannel-Schlüssel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93c9d23de40f32a499013928086ccb52fc1d1e67
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526327"
---
# <a name="rsaschannel-keys"></a><span data-ttu-id="4140a-103">RSA/SChannel-Schlüssel</span><span class="sxs-lookup"><span data-stu-id="4140a-103">RSA/Schannel Keys</span></span>

## <a name="generating-and-retrieving-rsaschannel-keys"></a><span data-ttu-id="4140a-104">Erstellen und Abrufen von RSA/SChannel-Schlüsseln</span><span class="sxs-lookup"><span data-stu-id="4140a-104">Generating and Retrieving RSA/Schannel Keys</span></span>

<span data-ttu-id="4140a-105">[*RSA*](../secgloss/r-gly.md) / [*SChannel*](../secgloss/s-gly.md) -Schlüssel können durch Aufrufen der [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey) -Funktion generiert werden.</span><span class="sxs-lookup"><span data-stu-id="4140a-105">[*RSA*](../secgloss/r-gly.md)/[*Schannel*](../secgloss/s-gly.md) keys can be generated by calling the [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey) function.</span></span> <span data-ttu-id="4140a-106">Der Aufruf von **CryptGenKey** erfordert, dass ein an \_ keyexchange-Algorithmus bezeichnerbezeichner im *algid* -Parameter übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="4140a-106">The call to **CryptGenKey** requires an AT\_KEYEXCHANGE algorithm identifier passed in the *Algid* parameter.</span></span>

<span data-ttu-id="4140a-107">**So generieren Sie ein öffentliches/privates RSA/SChannel-Schlüsselpaar**</span><span class="sxs-lookup"><span data-stu-id="4140a-107">**To generate an RSA/Schannel public/private key pair**</span></span>

1.  <span data-ttu-id="4140a-108">Aufrufen der [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) -Funktion, um ein Handle für den [Kryptografieanbieter von Microsoft RSA/SChannel](microsoft-rsa-schannel-cryptographic-provider.md)zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="4140a-108">Call the [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) function to get a handle to the [Microsoft RSA/Schannel Cryptographic Provider](microsoft-rsa-schannel-cryptographic-provider.md).</span></span>
2.  <span data-ttu-id="4140a-109">Rufen Sie die [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey) -Funktion auf, um die Schlüssel zu generieren.</span><span class="sxs-lookup"><span data-stu-id="4140a-109">Call the [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey) function to generate the keys.</span></span> <span data-ttu-id="4140a-110">An \_ keyexchange muss für den *algid* -Parameter übergeben werden, und die oberen 16 Bits des *dwFlags* -Parameters müssen auf die gewünschte Schlüsselgröße (512 Bits) festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="4140a-110">AT\_KEYEXCHANGE must be passed in for the *Algid* parameter, and the upper 16 bits of the *dwFlags* parameter must be set to the desired key size (512 bits).</span></span> <span data-ttu-id="4140a-111">Ein [**hcryptkey**](hcryptkey.md) -Struktur handle wird im *HKEY* -Parameter zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="4140a-111">An [**HCRYPTKEY**](hcryptkey.md) structure handle is returned in the *hKey* parameter.</span></span>

<span data-ttu-id="4140a-112">**So rufen Sie einen Zeiger auf zuvor generierte RSA/SChannel-Benutzerschlüssel ab**</span><span class="sxs-lookup"><span data-stu-id="4140a-112">**To retrieve a pointer to previously generated RSA/Schannel user keys**</span></span>

1.  <span data-ttu-id="4140a-113">Aufrufen der [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) -Funktion, um ein Handle für den [Kryptografieanbieter von Microsoft RSA/SChannel](microsoft-rsa-schannel-cryptographic-provider.md)zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="4140a-113">Call the [**CryptAcquireContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta) function to get a handle to the [Microsoft RSA/Schannel Cryptographic Provider](microsoft-rsa-schannel-cryptographic-provider.md).</span></span>
2.  <span data-ttu-id="4140a-114">Rufen Sie die Funktion [**CryptGetUserKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetuserkey) auf, bei der der Parameter *dwkeyspec* bei keyexchange auf festgelegt ist \_ .</span><span class="sxs-lookup"><span data-stu-id="4140a-114">Call the [**CryptGetUserKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetuserkey) function, with the *dwKeySpec* parameter set to AT\_KEYEXCHANGE.</span></span>

## <a name="exporting-rsaschannel-keys"></a><span data-ttu-id="4140a-115">Exportieren von RSA/SChannel-Schlüsseln</span><span class="sxs-lookup"><span data-stu-id="4140a-115">Exporting RSA/Schannel Keys</span></span>

<span data-ttu-id="4140a-116">[*Hauptschlüssel*](../secgloss/m-gly.md) können in einfache Schlüsselblob-Strukturen exportiert werden.</span><span class="sxs-lookup"><span data-stu-id="4140a-116">[*Master keys*](../secgloss/m-gly.md) can be exported into simple key BLOB structures.</span></span> <span data-ttu-id="4140a-117">Dies sollte auf die gleiche Weise wie der Export von normalen [*RC4*](../secgloss/r-gly.md) -oder [*Daten Verschlüsselungs Standard*](../secgloss/d-gly.md) - [*Massen Verschlüsselungsschlüsseln*](../secgloss/b-gly.md)implementiert werden, wie in [Simple Key BLOB](https://www.bing.com/search?q=Simple+Key+BLOB)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="4140a-117">This should be implemented the same way as the export of normal [*RC4*](../secgloss/r-gly.md) or [*Data Encryption Standard*](../secgloss/d-gly.md) (DES) [*bulk encryption keys*](../secgloss/b-gly.md), as described in [Simple Key BLOB](https://www.bing.com/search?q=Simple+Key+BLOB).</span></span> <span data-ttu-id="4140a-118">Der **aikeyalg** -Member der [**publickeystruc**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) -Struktur ist auf den Algorithmusbezeichner des Haupt Schlüssels (calg \_ das PCT1 verwendet \_ Master, calg \_ SSL2 verwendet \_ Master, calg \_ SSL3 \_ Master oder calg \_ das TLS1 verwendet \_ Master) festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4140a-118">The **aiKeyAlg** member of the [**PUBLICKEYSTRUC**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) structure is set to the algorithm identifier of the master key (CALG\_PCT1\_MASTER, CALG\_SSL2\_MASTER, CALG\_SSL3\_MASTER, or CALG\_TLS1\_MASTER).</span></span>

<span data-ttu-id="4140a-119">Wenn die [**cpexportkey**](https://www.bing.com/search?q=**CPExportKey**) -Funktion einen SSL2 verwendet-Hauptschlüssel exportiert und das \_ Flag "Crypt SSL2 verwendet \_ Fallback" festgelegt ist, legen Sie zur Vermeidung von Versions Rollback-Angriffen die ersten acht Bytes des [](../secgloss/p-gly.md) Verschlüsselungs Blocks auf 0x03 anstatt auf zufällige Daten fest.</span><span class="sxs-lookup"><span data-stu-id="4140a-119">If the [**CPExportKey**](https://www.bing.com/search?q=**CPExportKey**) function is exporting an SSL2 master key and the CRYPT\_SSL2\_FALLBACK flag is set, then, to help prevent version rollback attacks, set the first eight bytes of the encryption block [*padding*](../secgloss/p-gly.md) to 0x03 rather than to random data.</span></span>

<span data-ttu-id="4140a-120">Wenn die **crypt \_ destroykey** -Konstante im *dwFlags* -Parameter der [**cpexportkey**](https://www.bing.com/search?q=**CPExportKey**) -Funktion angegeben wird, zerstört der CSP den Schlüssel oder das Schlüssel Handle nach dem Exportieren des Schlüssels.</span><span class="sxs-lookup"><span data-stu-id="4140a-120">If the **CRYPT\_DESTROYKEY** constant is specified in the *dwFlags* parameter of the [**CPExportKey**](https://www.bing.com/search?q=**CPExportKey**) function, the CSP destroys the key or key handle after exporting the key.</span></span> <span data-ttu-id="4140a-121">Dieses Flag ist nur für die Verwendung mit nicht transparenten [*blobnetzen*](../secgloss/o-gly.md)vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="4140a-121">This flag is intended for use only with [*opaque BLOBs*](../secgloss/o-gly.md).</span></span>

 

 
