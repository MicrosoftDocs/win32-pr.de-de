---
description: Zeigt die Beziehung zwischen den Funktionsparametern an, die auf Strukturen oder Arrays und deren initialisierte Daten zeigen.
ms.assetid: 89caf4d3-727f-472b-9a09-e81b4ff4d127
title: Verfahren zum Signieren von Daten
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ba289928ab39c690e1c44bdbf65c77c18b7edab3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106358490"
---
# <a name="procedure-for-signing-data"></a><span data-ttu-id="d2072-103">Verfahren zum Signieren von Daten</span><span class="sxs-lookup"><span data-stu-id="d2072-103">Procedure for Signing Data</span></span>

<span data-ttu-id="d2072-104">Eine einzelne Funktion ( [**cryptsignmessage**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignmessage)) führt alle Aufgaben aus, die unter [Erstellen einer signierten Nachricht](creating-a-signed-message.md)aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="d2072-104">A single function, [**CryptSignMessage**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignmessage), performs all of the tasks listed in [Creating a Signed Message](creating-a-signed-message.md).</span></span> <span data-ttu-id="d2072-105">Die Initialisierung von Strukturen und anderen Daten ist jedoch weiterhin erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d2072-105">However, initialization of structures and other data is still necessary.</span></span> <span data-ttu-id="d2072-106">Die folgende Abbildung zeigt die Beziehung zwischen den Funktionsparametern, die auf Strukturen oder Arrays und deren initialisierte Daten zeigen.</span><span class="sxs-lookup"><span data-stu-id="d2072-106">The following illustration shows the relationship between those function parameters that point to structures or arrays and their initialized data.</span></span> <span data-ttu-id="d2072-107">Die Abbildung zeigt nur die Funktionsparameter und Strukturmember, die von anderen Strukturen oder Funktionen abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="d2072-107">The illustration shows only the function parameters and structure members that are derived from other structures or functions.</span></span> <span data-ttu-id="d2072-108">Die restlichen Parameter sind einfache Initialisierungen.</span><span class="sxs-lookup"><span data-stu-id="d2072-108">The rest of the parameters are straightforward initializations.</span></span>

![Initialisierungs Zuordnung für einen Rückruf von "cryptsignmessage"](images/crypsign.png)

<span data-ttu-id="d2072-110">**So signieren Sie Daten mithilfe von cryptsignmessage**</span><span class="sxs-lookup"><span data-stu-id="d2072-110">**To sign data using CryptSignMessage**</span></span>

1.  <span data-ttu-id="d2072-111">Einen Zeiger auf die zu Signier enden Daten erhalten.</span><span class="sxs-lookup"><span data-stu-id="d2072-111">Get a pointer to the data that is to be signed.</span></span>
2.  <span data-ttu-id="d2072-112">Weisen Sie den-Zeiger den Daten zu, um 0 (null) des Arrays "zu Signier Ende Daten" zu indizieren.</span><span class="sxs-lookup"><span data-stu-id="d2072-112">Assign the pointer to the data to index zero of a "data to be signed" array.</span></span>
3.  <span data-ttu-id="d2072-113">Erhalten Sie ein Handle für den Kryptografieanbieter.</span><span class="sxs-lookup"><span data-stu-id="d2072-113">Get a handle to the cryptographic provider.</span></span>
4.  <span data-ttu-id="d2072-114">Öffnen Sie einen [*Zertifikat Speicher*](../secgloss/c-gly.md) , der das Zertifikat des Signatur Gebers enthält.</span><span class="sxs-lookup"><span data-stu-id="d2072-114">Open a [*certificate store*](../secgloss/c-gly.md) that contains the signer's certificate.</span></span>
5.  <span data-ttu-id="d2072-115">Erhalten Sie eine Adresse für das Zertifikat des Signatur Gebers.</span><span class="sxs-lookup"><span data-stu-id="d2072-115">Get an address to the signer's certificate.</span></span>
6.  <span data-ttu-id="d2072-116">Weisen Sie die Adresse des Zertifikats dem Index NULL des *msgcert* -Arrays zu.</span><span class="sxs-lookup"><span data-stu-id="d2072-116">Assign the address of the certificate to the zero index of the *MsgCert* array.</span></span>
7.  <span data-ttu-id="d2072-117">Weisen Sie die Adressen aller anderen Zertifikate, die in die Nachricht eingeschlossen werden sollen, dem *msgcert* -Array zu.</span><span class="sxs-lookup"><span data-stu-id="d2072-117">Assign the addresses of any other certificates to be included with the message to the *MsgCert* array.</span></span>
8.  <span data-ttu-id="d2072-118">Initialisieren Sie die Struktur des [**crypt- \_ Algorithmus \_ Bezeichners**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_algorithm_identifier) , und initialisieren Sie den Member **pszobjid** mit dem gewünschten Hash Algorithmus und den anderen Membern entsprechend.</span><span class="sxs-lookup"><span data-stu-id="d2072-118">Initialize the [**CRYPT\_ALGORITHM\_IDENTIFIER**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_algorithm_identifier) structure, initializing the **pszObjId** member to the desired hash algorithm and the other members as appropriate.</span></span>
9.  <span data-ttu-id="d2072-119">Initialisieren Sie die Struktur der Crypt-Signierungs [**\_ \_ Nachricht \_**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_sign_message_para) , und initialisieren Sie das **psigningcert** -Element mit der Adresse des Zertifikats des Signatur Gebers, dem **msgcert** -Arraymember in die Adresse des Signatur Gebers und der anderen Zertifikate, dem **HashAlgorithm** -Member für die Adresse der [**crypt-Algorithmus- \_ \_ bezeichnerstruktur**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_algorithm_identifier) und den anderen Membern.</span><span class="sxs-lookup"><span data-stu-id="d2072-119">Initialize the [**CRYPT\_SIGN\_MESSAGE\_PARA**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_sign_message_para) structure, initializing the **pSigningCert** member to the address of the signer's certificate, the **MsgCert** array member to the address of the signer's and other's certificates, the **HashAlgorithm** member to the address of the [**CRYPT\_ALGORITHM\_IDENTIFIER**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_algorithm_identifier) structure, and the other members as appropriate.</span></span>
10. <span data-ttu-id="d2072-120">Nennen Sie die Funktion [**cryptsignmessage**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignmessage) , und übergeben Sie dabei die [**crypt \_ Sign \_ Message- \_ para**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_sign_message_para) -Struktur für den *psignpara* -Parameter, die Adresse des Arrays "zu Signier Ende Daten" für den Parameter " *rgpbtobesigned* ", eine Adresse für den *pbsignedblob* -Ausgabeparameter und Werte für die anderen Parameter nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="d2072-120">Call the [**CryptSignMessage**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignmessage) function, passing the [**CRYPT\_SIGN\_MESSAGE\_PARA**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_sign_message_para) structure for the *pSignPara* parameter, the address of the "data to be signed" array for the *rgpbToBeSigned* parameter, an address for the *pbSignedBlob* output parameter, and values for the other parameters as appropriate.</span></span>

 

 
