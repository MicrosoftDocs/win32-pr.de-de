---
description: Anwendungen, die CAPICOM-Objekte verwenden, müssen mit CAPICOM.dll erstellt werden. CAPICOM.dll müssen auch zur Laufzeit vorhanden und registriert sein, um CAPICOM-Objekte zu verwenden.
ms.assetid: 69de5232-e2f9-4aed-935d-5fbcd7998cc9
title: Vorbereiten der Verwendung von CAPICOM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f6fc1ad0dbfe3d4f8c4dae3286eb3ffa5e1ae03d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106366089"
---
# <a name="getting-ready-to-use-capicom"></a><span data-ttu-id="b8e0f-104">Vorbereiten der Verwendung von CAPICOM</span><span class="sxs-lookup"><span data-stu-id="b8e0f-104">Getting Ready to Use CAPICOM</span></span>

<span data-ttu-id="b8e0f-105">\[CAPICOM ist eine nur-32-Bit-Komponente, die für die Verwendung in den folgenden Betriebssystemen verfügbar ist: Windows Server 2008, Windows Vista und Windows XP.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-105">\[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows Server 2008, Windows Vista, and Windows XP.</span></span> <span data-ttu-id="b8e0f-106">Verwenden Sie stattdessen die .NET Framework, um Sicherheitsfunktionen zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-106">Instead, use the .NET Framework to implement security features.</span></span> <span data-ttu-id="b8e0f-107">Weitere Informationen finden Sie unter [Alternativen zur Verwendung von CAPICOM](alternatives-to-using-capicom.md).\]</span><span class="sxs-lookup"><span data-stu-id="b8e0f-107">For more information, see [Alternatives to Using CAPICOM](alternatives-to-using-capicom.md).\]</span></span>

<span data-ttu-id="b8e0f-108">Anwendungen, die CAPICOM-Objekte verwenden, müssen mit CAPICOM.dll erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-108">Applications that use CAPICOM objects must be created by using CAPICOM.dll.</span></span> <span data-ttu-id="b8e0f-109">CAPICOM.dll müssen auch zur Laufzeit vorhanden und registriert sein, um CAPICOM-Objekte zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-109">CAPICOM.dll must also be present and registered at run time to use CAPICOM objects.</span></span> <span data-ttu-id="b8e0f-110">CAPICOM.dll sollten Visual Basic Projekt verweisen hinzugefügt werden, um CAPICOM-Objekte zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-110">CAPICOM.dll should be added to Visual Basic projects references to use CAPICOM objects.</span></span>

<span data-ttu-id="b8e0f-111">CAPICOM ist als verteilbare Datei verfügbar, die von [Platform SDK Redistributable: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281)heruntergeladen werden kann.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-111">CAPICOM is available as a redistributable file that can be downloaded from [Platform SDK Redistributable: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span></span> <span data-ttu-id="b8e0f-112">Informationen zu CAPICOM-Versionen finden Sie unter [CAPICOM-Versionen](capicom-versions.md).</span><span class="sxs-lookup"><span data-stu-id="b8e0f-112">For information about CAPICOM versions, see [CAPICOM Versions](capicom-versions.md).</span></span>

<span data-ttu-id="b8e0f-113">**So registrieren Sie CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="b8e0f-113">**To register CAPICOM.dll**</span></span>

-   <span data-ttu-id="b8e0f-114">Wechseln Sie an einer Eingabeaufforderung in das Verzeichnis, in dem CAPICOM.dll gespeichert ist, und geben Sie dann den folgenden Befehl ein:</span><span class="sxs-lookup"><span data-stu-id="b8e0f-114">At a command prompt, change the directory to the directory where CAPICOM.dll is stored, and then enter the following command:</span></span>

    <span data-ttu-id="b8e0f-115">**regsvr32 CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="b8e0f-115">**regsvr32 CAPICOM.dll**</span></span>

## <a name="example-code-limitations"></a><span data-ttu-id="b8e0f-116">Einschränkungen für Code Beispiele</span><span class="sxs-lookup"><span data-stu-id="b8e0f-116">Example Code Limitations</span></span>

<span data-ttu-id="b8e0f-117">Um präziseren, besser lesbaren Code bereitzustellen, werden die Prinzipien der bewährten Programmierpraxis nicht immer in diesen Beispielen befolgt.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-117">To provide more concise, more readable code, principles of good programming practice are not always followed in these examples.</span></span> <span data-ttu-id="b8e0f-118">Insbesondere werden nur eingeschränkte Fehler Antworten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-118">In particular, only limited error responses are shown.</span></span> <span data-ttu-id="b8e0f-119">Funktionierende Anwendungen sollten die zurückgegebenen Fehlercodes immer überprüfen und geeignete Aktionen ausführen, wenn ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-119">Working applications should always check returned error codes and perform appropriate actions when an error is encountered.</span></span>

## <a name="necessary-key-containers-keys-and-certificates-in-capicom"></a><span data-ttu-id="b8e0f-120">Erforderliche Schlüssel Container, Schlüssel und Zertifikate in CAPICOM</span><span class="sxs-lookup"><span data-stu-id="b8e0f-120">Necessary Key Containers, Keys, and Certificates in CAPICOM</span></span>

<span data-ttu-id="b8e0f-121">Einige Vorgänge mit CAPICOM-Objekten können von jedem beliebigen Benutzer auf jedem Computer durchgeführt werden. das Erstellen [*digitaler Signaturen*](../secgloss/d-gly.md) und das Abrufen des Klartext-Inhalts einer eingeschlossenen Nachricht mithilfe von CAPICOM-Objekten sind Zertifikat basierte Vorgänge.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-121">While some operations with CAPICOM objects can be done on any computer by any user, creating [*digital signatures*](../secgloss/d-gly.md) and retrieving the plaintext content of an enveloped message using CAPICOM objects are certificate-based operations.</span></span> <span data-ttu-id="b8e0f-122">Der Benutzer, der eine digitale Signatur erstellt, und der Benutzer, der den verschlüsselten Inhalt einer eingeschlossenen Nachricht abruft, müssen über ein digitales Zertifikat mit einem verfügbaren zugeordneten privaten Schlüssel verfügen.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-122">The user who creates a digital signature and the user who retrieves the encrypted contents of an enveloped message must have a digital certificate with an available associated private key.</span></span> <span data-ttu-id="b8e0f-123">Wenn kein Zertifikat mit einem zugeordneten privaten Schlüssel vorhanden ist, kann der Kryptografievorgang nicht ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-123">If a certificate with an associated private key is not present, the cryptographic operation will fail.</span></span> <span data-ttu-id="b8e0f-124">Benutzer von CAPICOM-Anwendungen müssen sicherstellen, dass Sie über das geeignete Zertifikat und den verfügbaren privaten Schlüssel verfügen, wenn die Anwendungen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-124">Users of CAPICOM applications must ensure that they have the appropriate certificate and available private key when the applications are running.</span></span>

<span data-ttu-id="b8e0f-125">Einige Beispiele in den folgenden Abschnitten führen Vorgänge aus, die ein verfügbares [*öffentliches/privates Schlüsselpaar*](../secgloss/p-gly.md) zum Verschlüsseln und Entschlüsseln von Dateien, Nachrichten und Signaturen erfordern.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-125">Some examples in the following sections perform operations that require an available [*public/private key pair*](../secgloss/p-gly.md) for encrypting and decrypting files, messages, and signatures.</span></span> <span data-ttu-id="b8e0f-126">Viele dieser Programme werden kompiliert und ausgeführt, schlagen aber zur Laufzeit fehl, ohne dass in diesen speichern ordnungsgemäße [*Schlüssel Container*](../secgloss/k-gly.md), Schlüssel, Zertifikat Speicher und [*Zertifikate*](../secgloss/c-gly.md) vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-126">Many of these programs will compile and run but fail at run time without the existence of proper [*key containers*](../secgloss/k-gly.md), keys, certificate stores, and [*certificates*](../secgloss/c-gly.md) in those stores.</span></span>

<span data-ttu-id="b8e0f-127">**So erstellen Sie ein selbstsigniertes Zertifikat**</span><span class="sxs-lookup"><span data-stu-id="b8e0f-127">**To create a self-signed certificate**</span></span>

1.  <span data-ttu-id="b8e0f-128">Installieren Sie die Signierungs Tools.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-128">Install the signing tools.</span></span> <span data-ttu-id="b8e0f-129">Diese werden als Teil des Microsoft Windows Software Development Kit (SDK), des Platform Software Development Kit (SDK) oder des .NET Framework SDK installiert.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-129">These are installed as part of the Microsoft Windows Software Development Kit (SDK), the Platform Software Development Kit (SDK), or the .NET Framework SDK.</span></span>
2.  <span data-ttu-id="b8e0f-130">Nachdem Makecert.exe heruntergeladen wurde, führen Sie den folgenden Befehl an einer Eingabeaufforderung aus, indem Sie einen Benutzernamen für *username*, einen Organisationsnamen für *OrganizationName* und einen Firmennamen für *CompanyName* ersetzen:</span><span class="sxs-lookup"><span data-stu-id="b8e0f-130">After Makecert.exe is downloaded, run the following command at a command prompt, substituting a user name for *UserName*, an organization name for *OrganizationName*, and a company name for *CompanyName*:</span></span>

    <span data-ttu-id="b8e0f-131">**Makecert-r-n "CN =**_username_*_, ou =_*_OrganizationName_*_, o =_*_CompanyName_*_"-SS My_*</span><span class="sxs-lookup"><span data-stu-id="b8e0f-131">**makecert -r -n "cn=**_UserName_*_, ou=_*_OrganizationName_*_, o=_*_CompanyName_*_" -ss my_*</span></span>

3.  <span data-ttu-id="b8e0f-132">Das Zertifikat kann im My-Speicher des aktuellen Benutzers abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-132">The certificate can be placed in the My store of the current user.</span></span> <span data-ttu-id="b8e0f-133">Importieren Sie das erstellte Zertifikat in den Stamm Speicher, damit es als vertrauenswürdig eingestuft wird.</span><span class="sxs-lookup"><span data-stu-id="b8e0f-133">Import the certificate created into the root store so that it is trusted.</span></span>

 

 
