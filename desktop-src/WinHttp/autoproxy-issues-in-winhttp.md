---
description: Beachten Sie die folgenden wichtigen Probleme bei der Verwendung der Funktion "WinHTTP aktivierter automatischer Proxy".
ms.assetid: 9bae89b7-8f54-42ec-a240-998c97e26d25
title: AutoProxy-Probleme in WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22c6edbf56ec1ffc4dfac930a5d4858429cc6447
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104217614"
---
# <a name="autoproxy-issues-in-winhttp"></a><span data-ttu-id="c959f-103">AutoProxy-Probleme in WinHTTP</span><span class="sxs-lookup"><span data-stu-id="c959f-103">AutoProxy Issues in WinHTTP</span></span>

<span data-ttu-id="c959f-104">Beachten Sie die folgenden wichtigen Probleme bei der Verwendung der Funktion "WinHTTP aktivierter automatischer Proxy".</span><span class="sxs-lookup"><span data-stu-id="c959f-104">Consider the following important issues when using the WinHTTP autoproxy feature.</span></span>

## <a name="only-one-proxy-server-is-currently-supported"></a><span data-ttu-id="c959f-105">Zurzeit wird nur ein Proxy Server unterstützt.</span><span class="sxs-lookup"><span data-stu-id="c959f-105">Only One Proxy Server is Currently Supported</span></span>

<span data-ttu-id="c959f-106">Von WinHTTP werden derzeit keine Proxy Konfigurationen unterstützt, die mehr als einen Proxy Server angeben.</span><span class="sxs-lookup"><span data-stu-id="c959f-106">WinHTTP does not currently support proxy configurations that specify more than one proxy server.</span></span> <span data-ttu-id="c959f-107">Wenn [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) eine [**WinHTTP- \_ Proxy \_ Informations**](/windows/win32/api/winhttp/ns-winhttp-winhttp_proxy_info) Struktur zurückgibt, die eine Liste von Proxy Servern enthält, die von der Anwendung dann auf dem Anforderungs Handle mithilfe der **WinHTTP- \_ Option \_ Proxy** -Option festgelegt wird, verwendet WinHTTP nur den ersten Proxy Server in der Liste.</span><span class="sxs-lookup"><span data-stu-id="c959f-107">If [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) returns a [**WINHTTP\_PROXY\_INFO**](/windows/win32/api/winhttp/ns-winhttp-winhttp_proxy_info) structure that contains a list of proxy servers, which the application then sets on the request handle using the **WINHTTP\_OPTION\_PROXY** option, WinHTTP uses only the first proxy server in the list.</span></span> <span data-ttu-id="c959f-108">Wenn auf diesen Proxy Server nicht zugegriffen werden kann, führt WinHTTP kein Failover auf einen der anderen Proxy Server in der Liste aus.</span><span class="sxs-lookup"><span data-stu-id="c959f-108">If that proxy server is not accessible, WinHTTP does not failover to any of the other proxy servers in the list.</span></span> <span data-ttu-id="c959f-109">Es ist für die Anwendung von der Anwendung, diesen Fall zu behandeln, indem die **\_ Option \_ Proxy Option WinHTTP** erneut mit dem nächsten Proxy Server in der Liste festgelegt und die Anforderung erneut gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="c959f-109">It is up to the application to handle this case by setting the **WINHTTP\_OPTION\_PROXY** option again with the next proxy server in the list, and resending the request.</span></span>

## <a name="security-risk-mitigation"></a><span data-ttu-id="c959f-110">Minderung von Sicherheitsrisiken</span><span class="sxs-lookup"><span data-stu-id="c959f-110">Security Risk Mitigation</span></span>

<span data-ttu-id="c959f-111">Zum Verarbeiten der automatischen Proxy Konfigurationsdatei muss der heruntergeladene Skriptcode ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="c959f-111">Processing the proxy auto-configuration file requires executing downloaded script code.</span></span> <span data-ttu-id="c959f-112">Zu berücksichtigende Sicherheitsbedenken: Wenn der Server, auf dem sich die PAC-Datei befindet, kompromittiert wurde, ist der PAC-Skriptcode möglicherweise bösartig.</span><span class="sxs-lookup"><span data-stu-id="c959f-112">Some security concerns to consider: If the server on which the PAC file resides has been compromised, it is possible the PAC script code is malicious.</span></span> <span data-ttu-id="c959f-113">Daher verwendet WinHTTP die folgenden Vorsichtsmaßnahmen zum Schutz des Clients:</span><span class="sxs-lookup"><span data-stu-id="c959f-113">Therefore, WinHTTP uses the following precautions to protect the client:</span></span>

1.  <span data-ttu-id="c959f-114">Der Skriptcode wird daran gehindert, ActiveX-Objekte zu instanziieren.</span><span class="sxs-lookup"><span data-stu-id="c959f-114">The script code is prevented from instantiating any ActiveX objects.</span></span> <span data-ttu-id="c959f-115">Dies blockiert viele potenziell gefährliche Funktionen, wie z. b. die Fähigkeit, auf Dateien zuzugreifen und Netzwerk-e/a auszuführen.</span><span class="sxs-lookup"><span data-stu-id="c959f-115">This blocks a lot of potentially dangerous functionality, such as the ability to access files and to perform network I/O.</span></span>
2.  <span data-ttu-id="c959f-116">\* \* Windows Server 2003: \* \*[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) delegiert die gesamte WPAD-Verarbeitung an einen externen Prozess externen Dienst, den Dienst für die automatische Ermittlung von WinHTTP-Webproxys, der unter dem integrierten Benutzerkonto des lokalen Diensts mit geringen Berechtigungen ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="c959f-116">\*\*Windows Server 2003:  \*\*[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) delegates the entire WPAD processing to an external out-of-process service, the WinHTTP Web Proxy Auto-Discovery service, which runs under the low-privileged Local Service built-in user account.</span></span>

3.  <span data-ttu-id="c959f-117">**Windows XP mit SP2 und Windows Server 2003:** Ein PAC-Skript kann nicht länger als 60 Sekunden ausgeführt werden, nachdem die Skriptausführung beendet wurde.</span><span class="sxs-lookup"><span data-stu-id="c959f-117">**Windows XP with SP2 and Windows Server 2003:** A PAC script is not permitted to execute for longer than 60 seconds, after which script execution is terminated.</span></span>

4.  <span data-ttu-id="c959f-118">**Windows XP mit SP2 und Windows Server 2003:** WinHTTP lehnt PAC-Dateien ab, die größer als 1 MB sind.</span><span class="sxs-lookup"><span data-stu-id="c959f-118">**Windows XP with SP2 and Windows Server 2003:** WinHTTP rejects PAC files larger than 1MB.</span></span> <span data-ttu-id="c959f-119">Eine typische PAC-Datei ist in der Regel nicht mehr als ein paar Kilobyte groß.</span><span class="sxs-lookup"><span data-stu-id="c959f-119">A typical PAC file is usually no more than a few kilobytes in size.</span></span>

<span data-ttu-id="c959f-120">Beachten Sie, dass die Verarbeitung des PAC-Skriptcodes die Verwendung von com erfordert, da WinHTTP die Microsoft JScript-Komponente zum Ausführen des Skripts verwendet.</span><span class="sxs-lookup"><span data-stu-id="c959f-120">Be aware that processing the PAC script code requires the use of COM, because WinHTTP uses Microsoft JScript component to execute the script.</span></span> <span data-ttu-id="c959f-121">Wenn die WPAD-Protokoll Verarbeitung von WinHTTP nicht an einen externen, Prozess externen WebProxy-Dienst für die automatische Ermittlung delegiert werden kann, lädt [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) die com-Laufzeit innerhalb des Anwendungsprozesses für die Dauer des Aufrufes.</span><span class="sxs-lookup"><span data-stu-id="c959f-121">If WinHTTP cannot delegate WPAD protocol processing to an external, out-of-process Web Proxy Auto-Discovery service, [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) loads the COM runtime within the application process for the duration of the call.</span></span> <span data-ttu-id="c959f-122">Wenn die Anwendung selbst bereits com verwendet, sollte dies kein Problem sein.</span><span class="sxs-lookup"><span data-stu-id="c959f-122">If the application itself is already using COM, this should not be a concern.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="c959f-123">Überlegungen zur Leistung</span><span class="sxs-lookup"><span data-stu-id="c959f-123">Performance Considerations</span></span>

<span data-ttu-id="c959f-124">Der Prozess für die automatische Erkennung kann langsam sein, möglicherweise so lange wie mehrere Sekunden.</span><span class="sxs-lookup"><span data-stu-id="c959f-124">The auto-detection process can be slow, possibly as long as several seconds.</span></span> <span data-ttu-id="c959f-125">Die Funktionen " [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) " und " [winhttpdetectautoproxyconfigurl](/windows/desktop/api/Winhttp/nf-winhttp-winhttpdetectautoproxyconfigurl) " blockieren synchrone Funktionen.</span><span class="sxs-lookup"><span data-stu-id="c959f-125">The [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) and [WinHttpDetectAutoProxyConfigUrl](/windows/desktop/api/Winhttp/nf-winhttp-winhttpdetectautoproxyconfigurl) functions are blocking, synchronous functions.</span></span> <span data-ttu-id="c959f-126">Es kann sein, dass ein bestimmter Mechanismus zur automatischen Erkennung (z. b. DHCP) wesentlich langsamer ist als der andere (z. b. DNS).</span><span class="sxs-lookup"><span data-stu-id="c959f-126">It could be that one particular auto-detection mechanism (such as DHCP) is much slower than the other (such as DNS).</span></span> <span data-ttu-id="c959f-127">Wenn sowohl der **\_ \_ \_ \_ DHCP** -als auch der automatische Erkennungs- **\_ \_ \_ \_ DNS \_ -Typ** für die automatische Erkennung von WinHTTP automatisch erkannt werden, verwendet WinHTTP DHCP zuerst in Übereinstimmung mit der WPAD-Spezifikation.</span><span class="sxs-lookup"><span data-stu-id="c959f-127">If both the **WINHTTP\_AUTO\_DETECT\_TYPE\_DHCP** and **WINHTTP\_AUTO\_DETECT\_TYPE\_DNS\_A** auto-detection flags are specified, WinHTTP uses DHCP first, in accordance with the WPAD specification.</span></span> <span data-ttu-id="c959f-128">Wenn keine PAC-URL erkannt wird, indem eine DHCP-Anforderung ausgegeben wird, versucht WinHTTP, die PAC-Datei unter einer bekannten DNS-Adresse zu finden.</span><span class="sxs-lookup"><span data-stu-id="c959f-128">If no PAC URL is discovered by issuing a DHCP request, then WinHTTP tries to locate the PAC file at a well-known DNS address.</span></span>

<span data-ttu-id="c959f-129">[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) verwendet den WinHTTP-Sitzungshandle-Parameter zum Zwischenspeichern der PAC-Datei und die Ergebnisse der automatischen Erkennung.</span><span class="sxs-lookup"><span data-stu-id="c959f-129">[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) uses the WinHTTP Session handle parameter for caching the PAC file and the results of auto-detection.</span></span> <span data-ttu-id="c959f-130">Es empfiehlt sich, nach Möglichkeit dasselbe Sitzungs Handle für mehrere **WinHttpGetProxyForUrl** -Aufrufe zu verwenden, um eine wiederholte PAC-URL-Erkennung und das Herunterladen von Dateien zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="c959f-130">It is best to use the same session handle for multiple **WinHttpGetProxyForUrl** calls if possible to avoid repeated PAC URL detection and file downloading.</span></span> <span data-ttu-id="c959f-131">Die PAC-Datei wird nur im Arbeitsspeicher zwischengespeichert und wird verworfen, wenn die Anwendung das Sitzungs handle schließt.</span><span class="sxs-lookup"><span data-stu-id="c959f-131">The PAC file is cached in-memory only, and is discarded when the application closes the session handle.</span></span>

<span data-ttu-id="c959f-132">Aufgrund der Auswirkungen auf die Leistung von AutoProxy wird empfohlen, dass die Funktion nur von Desktop Client Anwendungen oder-Diensten verwendet wird. serverbasierte Anwendungen sollten sich auf den Server Administrator mit dem Hilfsprogramm "ProxyCfg.exe" stützen.</span><span class="sxs-lookup"><span data-stu-id="c959f-132">Because of the performance impact of autoproxy, it is recommended that only desktop client applications or services use the feature; server-based applications should rely on the server administrator using the "ProxyCfg.exe" utility.</span></span>

 

 



