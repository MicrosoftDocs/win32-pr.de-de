---
description: Die Microsoft Windows HTTP-Dienste (WinHTTP) unterstützen die Client seitige Verwendung des Microsoft Passport Authentifizierungs Protokolls vollständig. Dieses Thema enthält eine Übersicht über die Transaktionen, die an der Passport-Authentifizierung beteiligt sind und wie Sie behandelt werden.
ms.assetid: 395d7aef-4da0-4664-8328-7d31ce58fedd
title: Passport-Authentifizierung in WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b8fc00217c7c14fbd4635fab68398d2056c1ea5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104484182"
---
# <a name="passport-authentication-in-winhttp"></a><span data-ttu-id="7a6b8-104">Passport-Authentifizierung in WinHTTP</span><span class="sxs-lookup"><span data-stu-id="7a6b8-104">Passport Authentication in WinHTTP</span></span>

<span data-ttu-id="7a6b8-105">Die Microsoft Windows HTTP-Dienste (WinHTTP) unterstützen die Client seitige Verwendung des Microsoft Passport Authentifizierungs Protokolls vollständig.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-105">Microsoft Windows HTTP Services (WinHTTP) fully support the client side use of the Microsoft Passport authentication protocol.</span></span> <span data-ttu-id="7a6b8-106">Dieses Thema enthält eine Übersicht über die Transaktionen, die an der Passport-Authentifizierung beteiligt sind und wie Sie behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-106">This topic provides an overview of the transactions involved in Passport authentication and how to handle them.</span></span>

> [!Note]  
> <span data-ttu-id="7a6b8-107">In WinHTTP 5,1 ist die Passport-Authentifizierung standardmäßig deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-107">In WinHTTP 5.1, Passport authentication is disabled by default.</span></span>

 

## <a name="passport-14"></a><span data-ttu-id="7a6b8-108">Passport 1,4</span><span class="sxs-lookup"><span data-stu-id="7a6b8-108">Passport 1.4</span></span>

<span data-ttu-id="7a6b8-109">Passport ist eine Kernkomponente der Microsoft .net Baustein Dienste.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-109">Passport is a core component of the Microsoft .NET building block services.</span></span> <span data-ttu-id="7a6b8-110">Dadurch können Unternehmen verteilte Webdienste für eine Vielzahl von Anwendungen entwickeln und anbieten, und die Mitglieder können einen Anmelde Namen und ein Kennwort auf allen Beteiligten Websites verwenden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-110">It enables businesses to develop and offer distributed Web services across a wide range of applications and enables its members to use one sign-in name and password at all participating Web sites.</span></span>

<span data-ttu-id="7a6b8-111">WinHTTP bietet Platt Form Unterstützung für Microsoft Passport 1,4 durch Implementieren des Client seitigen Protokolls für die Passport 1,4-Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-111">WinHTTP provides platform support for Microsoft Passport 1.4 by implementing the client-side protocol for Passport 1.4 authentication.</span></span> <span data-ttu-id="7a6b8-112">Anwendungen werden aus den Details der Interaktion mit der Passport-Infrastruktur und den gespeicherten Benutzernamen und Kenn Wörtern in Windows XP freigegeben.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-112">It frees applications from the details of interacting with the Passport infrastructure and the Stored User Names and Passwords in Windows XP.</span></span> <span data-ttu-id="7a6b8-113">Diese Abstraktion unterscheidet sich von der Verwendung von Passport von der Perspektive eines Entwicklers, als herkömmliche Authentifizierungs Schemas wie Basic oder Digest zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-113">This abstraction makes using Passport no different from a developer's perspective than using traditional authentication schemes like Basic or Digest.</span></span>

<span data-ttu-id="7a6b8-114">**Windows XP:** Der Registrierungsschlüssel " **HKCU \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Internet Settings \\ Passport \\ numregistrationruns** " gibt an, wie oft der Passport Authentication Wizard angezeigt wird, wenn eine Passport-Authentifizierung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-114">**Windows XP:** The **HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Passport\\NumRegistrationRuns** registry key identifies the number of times the Passport Authentication Wizard is displayed when PassPort authentication is required.</span></span> <span data-ttu-id="7a6b8-115">Wenn der Wert für diesen Schlüssel auf eine Zahl größer als 5 festgelegt ist, wird der Assistent nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-115">If the value for this key is set to a number greater than 5, the wizard is not displayed.</span></span>

<span data-ttu-id="7a6b8-116">In den folgenden Abschnitten werden die für die Passport-Authentifizierung beteiligten Transaktionen aus der Sicht einer Client Anwendung beschrieben.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-116">The following sections describe the transactions involved in Passport authentication from the point of view of a client application.</span></span> <span data-ttu-id="7a6b8-117">Informationen zur serverseitigen Passport-Entwicklung finden Sie in der Dokumentation zur Passport SDK-Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-117">For server-side Passport development, see the Passport SDK Documentation Overview.</span></span>

-   [<span data-ttu-id="7a6b8-118">Erste Anforderung</span><span class="sxs-lookup"><span data-stu-id="7a6b8-118">Initial Request</span></span>](#initial-request)
-   [<span data-ttu-id="7a6b8-119">Passport-Anmelde Server</span><span class="sxs-lookup"><span data-stu-id="7a6b8-119">Passport Login Server</span></span>](#passport-login-server)
-   [<span data-ttu-id="7a6b8-120">Authentifizierte Anforderung</span><span class="sxs-lookup"><span data-stu-id="7a6b8-120">Authenticated Request</span></span>](#authenticated-request)

### <a name="initial-request"></a><span data-ttu-id="7a6b8-121">Erste Anforderung</span><span class="sxs-lookup"><span data-stu-id="7a6b8-121">Initial Request</span></span>

<span data-ttu-id="7a6b8-122">Wenn ein Client eine Ressource auf einem Server anfordert, der die Passport-Authentifizierung erfordert, überprüft der Server die Anforderung auf das vorhanden sein von [*Tickets*](glossary.md).</span><span class="sxs-lookup"><span data-stu-id="7a6b8-122">When a client requests a resource on a server that requires Passport authentication, the server checks the request for the presence of [*tickets*](glossary.md).</span></span> <span data-ttu-id="7a6b8-123">Wenn ein gültiges *Ticket* mit der Anforderung gesendet wird, antwortet der Server mit der angeforderten Ressource.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-123">If a valid *ticket* is sent with the request, the server responds with the requested resource.</span></span> <span data-ttu-id="7a6b8-124">Wenn das *Ticket* nicht auf dem Client vorhanden ist, antwortet der Server mit dem Statuscode 302.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-124">If the *ticket* does not exist on the client, the server responds with a 302 status code.</span></span> <span data-ttu-id="7a6b8-125">Die Antwort enthält den Challenge-Header "www-Authenticate: Passport 1.4".</span><span class="sxs-lookup"><span data-stu-id="7a6b8-125">The response includes the challenge header, "WWW-Authenticate: Passport1.4".</span></span> <span data-ttu-id="7a6b8-126">Clients, die Passport nicht verwenden, können der Umleitung zum Passport-Anmelde Server folgen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-126">Clients that are not using Passport can follow the redirection to the Passport login server.</span></span> <span data-ttu-id="7a6b8-127">Erweiterte Clients kontaktieren in der Regel den Passport-Nexus, um den Speicherort des Passport-Anmelde Servers zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-127">More advanced clients typically contact the Passport nexus to determine the location of the Passport login server.</span></span>

> [!Note]  
> <span data-ttu-id="7a6b8-128">In der Mitte des Microsoft Passport Netzwerks ist der Passport *Nexus*, der die Synchronisierung von Passport-Teilnehmer Standorten ermöglicht, um sicherzustellen, dass jeder Standort über die neuesten Details zur Netzwerkkonfiguration und zu anderen Problemen verfügt.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-128">Central to the Microsoft Passport network is the Passport *Nexus*, which facilitates synchronization of Passport participant sites to assure that each site has the latest details on network configuration and other issues.</span></span> <span data-ttu-id="7a6b8-129">Jede Passport-Komponente (Passport Manager, Login Servers, Update Servers usw.) kommuniziert regelmäßig mit dem Nexus, um die Informationen abzurufen, die für die Suche und die ordnungsgemäße Kommunikation mit den anderen Komponenten im Passport-Netzwerk benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-129">Each Passport component (Passport Manager, Login servers, Update servers, and so on) periodically communicates with the Nexus to retrieve the information it needs to locate, and properly communicate with, the other components in the Passport network.</span></span> <span data-ttu-id="7a6b8-130">Diese Informationen werden als XML-Dokument, das als Komponenten Konfigurations Dokument bezeichnet wird, oder als "CCD" abgerufen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-130">This information is retrieved as an XML document called a Component Configuration Document, or CCD.</span></span>

 

<span data-ttu-id="7a6b8-131">Die folgende Abbildung zeigt die anfängliche Anforderung an einen Passport-Partner.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-131">The following image shows the initial request to a Passport affiliate.</span></span>

![Image zeigt die anfängliche Anforderung an einen Passport-Partner an.](images/art-passport1.png)

### <a name="passport-login-server"></a><span data-ttu-id="7a6b8-133">Passport-Anmelde Server</span><span class="sxs-lookup"><span data-stu-id="7a6b8-133">Passport Login Server</span></span>

<span data-ttu-id="7a6b8-134">Ein Passport-Anmelde Server verarbeitet alle Anforderungen für [*Tickets*](glossary.md) für beliebige Ressourcen in einer Passport- *Domänen Autorität*.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-134">A Passport login server handles all requests for [*tickets*](glossary.md) for any resource in a Passport *domain authority*.</span></span> <span data-ttu-id="7a6b8-135">Bevor eine Anforderung mithilfe von Passport authentifiziert werden kann, muss die Client Anwendung den Anmelde Server kontaktieren, um die entsprechenden *Tickets* zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-135">Before a request can be authenticated using Passport, the client application must contact the login server to obtain the appropriate *tickets*.</span></span>

<span data-ttu-id="7a6b8-136">Wenn ein Client [*Tickets*](glossary.md) von einem Passport-Anmelde Server anfordert, antwortet der Anmelde Server in der Regel mit dem Statuscode 401, um anzugeben, dass Benutzer Anmelde Informationen angegeben werden müssen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-136">When a client requests [*tickets*](glossary.md) from a Passport login server, the login server typically responds with a 401 status code to indicate that user credentials must be provided.</span></span> <span data-ttu-id="7a6b8-137">Wenn diese Anmelde Informationen bereitgestellt werden, antwortet der Anmelde Server mit den *Tickets* , die für den Zugriff auf die angegebene Ressource auf dem Server erforderlich sind, der die ursprünglich angeforderte Ressource enthält.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-137">When these credentials are provided, the login server responds with the *tickets* required to access the specified resource on the server that contains the originally requested resource.</span></span> <span data-ttu-id="7a6b8-138">Der Anmelde Server kann den Client auch an einen anderen Server umleiten, der die angeforderte Ressource bereitstellen kann.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-138">The login server can also redirect the client to another server that can provide the requested resource.</span></span>

![das Image zeigt eine Client Ticket Anforderung an einen Passport-Anmelde Server an.](images/art-passport2.png)

### <a name="authenticated-request"></a><span data-ttu-id="7a6b8-140">Authentifizierte Anforderung</span><span class="sxs-lookup"><span data-stu-id="7a6b8-140">Authenticated Request</span></span>

<span data-ttu-id="7a6b8-141">Wenn der Client über die [*Tickets*](glossary.md) verfügt, die einem bestimmten Server entsprechen, sind diese *Tickets* in allen Anforderungen an diesen Server enthalten.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-141">When the client has the [*tickets*](glossary.md) that correspond to a given server, those *tickets* are included with all requests to that server.</span></span> <span data-ttu-id="7a6b8-142">Wenn die *Tickets* nicht geändert wurden, weil Sie vom Passport-Anmelde Server abgerufen wurden und die *Tickets* für den Ressourcen Server gültig sind, sendet der Ressourcen Server eine Antwort mit der angeforderten Ressource und den Cookies, die darauf hinweisen, dass der Benutzer für zukünftige Anforderungen authentifiziert ist.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-142">If the *tickets* have not been modified since they were retrieved from the Passport login server, and the *tickets* are valid for the resource server, the resource server sends a response that includes both the requested resource and cookies that indicate that the user is authenticated for future requests.</span></span>

<span data-ttu-id="7a6b8-143">Die zusätzlichen Cookies in der Antwort dienen dazu, den Authentifizierungsprozess zu beschleunigen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-143">The additional cookies in the response are intended to speed the authentication process.</span></span> <span data-ttu-id="7a6b8-144">Weitere Anforderungen in derselben Sitzung für Ressourcen auf Servern in derselben Passport-Domänen Autorität enthalten alle diese zusätzlichen Cookies.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-144">Additional requests in the same session for resources on servers in the same Passport Domain Authority all include these additional cookies.</span></span> <span data-ttu-id="7a6b8-145">Anmelde Informationen müssen erst wieder an den Anmelde Server gesendet werden, wenn die Cookies ablaufen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-145">Credentials do not need to be sent to the login server again until the cookies expire.</span></span>

![das Image zeigt eine authentifizierte Anforderung an den Passport-Anmelde Server an.](images/art-passport3.png)

## <a name="using-passport-in-winhttp"></a><span data-ttu-id="7a6b8-147">Verwenden von Passport in WinHTTP</span><span class="sxs-lookup"><span data-stu-id="7a6b8-147">Using Passport in WinHTTP</span></span>

<span data-ttu-id="7a6b8-148">Die Passport-Authentifizierung in WinHTTP ähnelt anderen Authentifizierungs Schemas.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-148">Passport authentication in WinHTTP is very similar to other authentication schemes.</span></span> <span data-ttu-id="7a6b8-149">Eine Übersicht über die Authentifizierung in WinHTTP finden Sie unter [Authentifizierung in WinHTTP](authentication-in-winhttp.md) .</span><span class="sxs-lookup"><span data-stu-id="7a6b8-149">See [Authentication in WinHTTP](authentication-in-winhttp.md) for an overview of authentication in WinHTTP.</span></span>

<span data-ttu-id="7a6b8-150">In WinHTTP 5,1 ist die Passport-Authentifizierung standardmäßig deaktiviert und muss vor der Verwendung von [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) explizit aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-150">In WinHTTP 5.1, Passport authentication is disabled by default and must be explicitly enabled with [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) before use.</span></span>

<span data-ttu-id="7a6b8-151">WinHTTP behandelt viele Transaktionsdetails intern für die Passport-Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-151">WinHTTP handles many of the transaction details internally for Passport authentication.</span></span> <span data-ttu-id="7a6b8-152">Während der ersten Anforderung antwortet der Server mit einem 302-Statuscode, wenn eine Authentifizierung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-152">During the initial request, the server responds with a 302 status code when authentication is necessary.</span></span> <span data-ttu-id="7a6b8-153">Der 302-Statuscode weist tatsächlich auf eine Umleitung hin und ist Teil des Passport-Protokolls aus Gründen der Abwärtskompatibilität.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-153">The 302 status code actually indicates a redirection and is part of the Passport protocol for backwards compatibility.</span></span> <span data-ttu-id="7a6b8-154">WinHTTP blendet den 302-Statuscode aus und kontaktiert den Passport-Nexus und den Anmelde Server.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-154">WinHTTP hides the 302 status code and contacts the Passport nexus, and then the login server.</span></span> <span data-ttu-id="7a6b8-155">Die WinHTTP-Anwendung wird über den 401-Statuscode benachrichtigt, der vom Anmelde Server gesendet wird, um Benutzer Anmelde Informationen anzufordern.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-155">The WinHTTP application is notified of the 401 status code sent by the login server to request user credentials.</span></span> <span data-ttu-id="7a6b8-156">Die Anwendung wird jedoch so angezeigt, als ob der 401-Status von dem Server stammt, von dem die Ressource angefordert wurde.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-156">To the application, however, it appears as if the 401 status originates from the server from which the resource was requested.</span></span> <span data-ttu-id="7a6b8-157">Auf diese Weise kennt die WinHTTP-Anwendung keine Interaktionen mit anderen Servern und kann die Passport-Authentifizierung mit dem gleichen Code verarbeiten, der andere Authentifizierungs Schemas behandelt.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-157">In this way, the WinHTTP application is unaware of interactions with other servers, and it can handle Passport authentication with the same code that handles other authentication schemes.</span></span>

<span data-ttu-id="7a6b8-158">Normalerweise antwortet eine WinHTTP-Anwendung auf einen 401-Statuscode, indem Anmelde Informationen zur Authentifizierung bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-158">Typically, a WinHTTP application responds to a 401 status code by supplying authentication credentials.</span></span> <span data-ttu-id="7a6b8-159">Wenn Anmelde Informationen mit [**winhttpsetanmelde**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) Informationen oder [**setanmelde**](iwinhttprequest-setcredentials.md) Informationen für die Passport-Authentifizierung bereitgestellt werden, werden die Anmelde Informationen tatsächlich an den Anmelde Server gesendet, nicht an den in der Anforderung angegebenen Server.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-159">When credentials are supplied with [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) or [**SetCredentials**](iwinhttprequest-setcredentials.md) for passport authentication, the credentials are actually being sent to the login server, not to the server indicated in the request.</span></span>

<span data-ttu-id="7a6b8-160">Bei der Reaktion auf einen 407-Statuscode muss eine WinHTTP-Anwendung jedoch " [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) " verwenden, um Proxy Anmelde Informationen anstelle von " [**winhttpsetanmelde**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials)Informationen" bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-160">However, when responding to a 407 status code, a WinHTTP application must use [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) to provide proxy credentials, rather than [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials).</span></span> <span data-ttu-id="7a6b8-161">Da **WinHttpSetOption** eine weniger sichere Möglichkeit zum Angeben von Anmelde Informationen ist, sollte es normalerweise vermieden werden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-161">Because **WinHttpSetOption** is a less secure way to supply credentials, it should normally be avoided.</span></span>

<span data-ttu-id="7a6b8-162">Nach dem Abrufen werden [*Tickets*](glossary.md) intern verwaltet und automatisch an die entsprechenden Server in zukünftigen Anforderungen gesendet.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-162">Once retrieved, [*tickets*](glossary.md) are managed internally and are automatically sent to applicable servers in future requests.</span></span>

> [!Note]  
> <span data-ttu-id="7a6b8-163">WinHTTP ermöglicht das Deaktivieren der automatischen Umleitung durch Aufrufen der [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) -Funktion für die [**WinHTTP- \_ Option \_ \_ Feature**](option-flags.md) -Flag deaktivieren und Angeben eines Werts von WinHTTP-Deaktivierungs Umleitungen [**\_ \_**](option-flags.md).</span><span class="sxs-lookup"><span data-stu-id="7a6b8-163">WinHTTP enables you to disable automatic redirection by calling the [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) function for the [**WINHTTP\_OPTION\_DISABLE\_FEATURE**](option-flags.md) flag and specifying a value of [**WINHTTP\_DISABLE\_REDIRECTS**](option-flags.md).</span></span> <span data-ttu-id="7a6b8-164">Die Deaktivierung der Umleitung beeinträchtigt nicht die Umleitung, die WinHTTP intern für Passport-Transaktionen verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-164">Disabling redirection does not interfere with the redirection that WinHTTP handles internally for Passport transactions.</span></span>

 

<span data-ttu-id="7a6b8-165">WinHTTP kann die Passport-Authentifizierung auch dann erfolgreich vervollständigen, wenn eine Anwendung die automatische Umleitung deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-165">WinHTTP can successfully complete the Passport authentication even if an application disables auto redirection.</span></span> <span data-ttu-id="7a6b8-166">Nach Abschluss der Passport-Authentifizierung muss jedoch eine implizite Umleitung von der Passport-Anmelde Server-URL zurück zur ursprünglichen URL erfolgen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-166">However, after the Passport authentication is complete, an implicit redirect must occur from the Passport login server URL back to the original URL.</span></span> <span data-ttu-id="7a6b8-167">Diese Umleitung wird nicht durch eine 302-HTTP-Antwort ausgelöst, ist jedoch im Passport-Protokoll implizit.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-167">This redirect is not triggered by a 302 HTTP response, but is implicit in the Passport protocol.</span></span>

<span data-ttu-id="7a6b8-168">WinHTTP behandelt diese implizite Umleitung speziell.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-168">WinHTTP handles this implicit redirect specially.</span></span> <span data-ttu-id="7a6b8-169">Wenn eine Anwendung die automatische Umleitung deaktiviert hat, erfordert WinHTTP, dass die Anwendung die WinHTTP-Berechtigung "Berechtigung" für die automatische Umleitung in diesem Sonderfall erteilt.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-169">If an application has disabled automatic redirection, WinHTTP requires that the application give WinHTTP "permission" to redirect automatically in this special case.</span></span>

<span data-ttu-id="7a6b8-170">Damit WinHTTP nach der Authentifizierung wieder an die ursprüngliche URL umgeleitet wird, muss die Anwendung eine Rückruffunktion mit [**winhttpsetstatus-Rückruf**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetstatuscallback)registrieren.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-170">In order to have WinHTTP redirect back to the original URL after authentication, the application must register a callback function using [**WinHttpSetStatusCallback**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetstatuscallback).</span></span> <span data-ttu-id="7a6b8-171">WinHTTP kann die Anwendung dann mit einem WinHTTP- \_ Rückruf \_ Status- \_ Umleitungs Rückruf Benachrichtigen, der es der Anwendung ermöglicht, die Umleitung abzubrechen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-171">WinHTTP can then notify the application with a WINHTTP\_CALLBACK\_STATUS\_REDIRECT callback, which allows the application to cancel the redirect.</span></span> <span data-ttu-id="7a6b8-172">Eine Anwendung muss keine Funktionalität in der Rückruffunktion bereitstellen. die Registrierung des Rückrufs ist ausreichend, damit WinHTTP diese spezielle Umleitung befolgt.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-172">An application does not need to provide any functionality in the callback function; registration of the callback is sufficient to enable WinHTTP to follow this special-case redirect.</span></span>

<span data-ttu-id="7a6b8-173">\_ \_ \_ Wenn eine Rückruffunktion nicht von der Anwendung festgelegt wird, wird die Fehlermeldung WinHTTP Login Failure (Fehlermeldung) generiert.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-173">The ERROR\_WINHTTP\_LOGIN\_FAILURE message is generated if a callback function is not set by the application.</span></span>

### <a name="passport-cobranding"></a><span data-ttu-id="7a6b8-174">Passport-Cobranding</span><span class="sxs-lookup"><span data-stu-id="7a6b8-174">Passport Cobranding</span></span>

<span data-ttu-id="7a6b8-175">Im Gegensatz zu herkömmlichen Authentifizierungs Schemas, die von WinHTTP unterstützt werden, kann Passport ausführlich [*coziert*](glossary.md)werden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-175">Unlike traditional authentication schemes supported by WinHTTP, Passport can be extensively [*cobranded*](glossary.md).</span></span> <span data-ttu-id="7a6b8-176">Nach dem Empfang eines 401-Statuscodes, der eine Herausforderung anzeigt, kann eine Anwendung die *cobrandinggrafik* und den Text abrufen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-176">Upon receiving a 401 status code that indicates a challenge, an application can retrieve the *cobranding* graphic and text.</span></span> <span data-ttu-id="7a6b8-177">Rufen Sie eine URL für die *Cobranding* -Grafik ab, indem Sie [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) mit der WinHTTP- \_ Option \_ Passport \_ Cobranding \_ URL-Flag aufrufen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-177">Retrieve a URL for the *cobranding* graphic by calling [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) with the WINHTTP\_OPTION\_PASSPORT\_COBRANDING\_URL flag.</span></span> <span data-ttu-id="7a6b8-178">Rufen Sie den *cobrandingtext* ab, indem Sie [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) mit der WinHTTP- \_ Option \_ Passport \_ Cobranding- \_ textflag aufrufen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-178">Retrieve the *cobranding* text by calling [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) with the WINHTTP\_OPTION\_PASSPORT\_COBRANDING\_TEXT flag.</span></span> <span data-ttu-id="7a6b8-179">Diese Elemente können verwendet werden, um ein Dialogfeld zum Erfassen von Anmelde Informationen anzupassen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-179">These items can be used to customize a credential-gathering dialog.</span></span>

### <a name="stored-user-names-and-passwords"></a><span data-ttu-id="7a6b8-180">Gespeicherte Benutzernamen und Kennwörter</span><span class="sxs-lookup"><span data-stu-id="7a6b8-180">Stored User Names and Passwords</span></span>

<span data-ttu-id="7a6b8-181">In Windows XP wurde das Konzept von gespeicherten Benutzernamen und Kenn Wörtern eingeführt.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-181">Windows XP introduced the concept of Stored User Names and Passwords.</span></span> <span data-ttu-id="7a6b8-182">Wenn die Passport-Anmelde Informationen eines Benutzers über den **Passport-Registrierungs-Assistenten** oder das Standard **Dialogfeld** Anmelde Informationen gespeichert werden, werden diese in den gespeicherten Benutzernamen und Kenn Wörtern gespeichert.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-182">If a user's Passport credentials are saved through the **Passport Registration Wizard** or the standard **Credential Dialog**, it is saved in the Stored User Names and Passwords.</span></span> <span data-ttu-id="7a6b8-183">Bei Verwendung von WinHTTP unter Windows XP oder höher verwendet WinHTTP automatisch die Anmelde Informationen in den gespeicherten Benutzernamen und Kenn Wörtern, wenn die Anmelde Informationen nicht explizit festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-183">When using WinHTTP on Windows XP or later, WinHTTP automatically uses the credentials in the Stored User Names and Passwords if credentials are not explicitly set.</span></span> <span data-ttu-id="7a6b8-184">Dies ähnelt der Unterstützung von Standard Anmelde Informationen für NTLM/Kerberos.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-184">This is similar to the support of default logon credentials for NTLM/Kerberos.</span></span> <span data-ttu-id="7a6b8-185">Die Verwendung von standardmäßigen Passport-Anmelde Informationen unterliegt jedoch nicht den Einstellungen für die automatische Anmelde Richtlinie.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-185">However, use of default Passport credentials is not subject to the automatic logon policy settings.</span></span>

### <a name="disabling-passport-authentication"></a><span data-ttu-id="7a6b8-186">Deaktivieren der Passport-Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="7a6b8-186">Disabling Passport Authentication</span></span>

<span data-ttu-id="7a6b8-187">Einige Anwendungen erfordern möglicherweise die Möglichkeit, die Passport-Authentifizierung zu deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-187">Some applications might require the ability to disable Passport authentication.</span></span> <span data-ttu-id="7a6b8-188">Wenn ein Passport-Partner z. b. mit dem ersten 302-Statuscode antwortet, empfiehlt es sich, die folgende Umleitung zu befolgen und die HTML-Passport-Authentifizierungsseite zu erzeugen, anstatt WinHTTP das interne behandeln der Authentifizierung zu gestatten.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-188">For example, when a Passport affiliate responds with the initial 302 status code, it might be preferable to follow the indicated redirection and render the HTML Passport authentication page rather than allowing WinHTTP to handle the authentication internally.</span></span> <span data-ttu-id="7a6b8-189">Die Passport-Authentifizierung ist in WinHTTP deaktiviert, indem die [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) -Funktion mit der WinHTTP \_ -Option " \_ \_ Passport auth" Konfigurieren aufgerufen \_ und der Wert "WinHTTP \_ deaktiviert \_ Passport auth" übergeben wird \_ .</span><span class="sxs-lookup"><span data-stu-id="7a6b8-189">Passport authentication is disabled in WinHTTP by calling the [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) function with the WINHTTP\_OPTION\_CONFIGURE\_PASSPORT\_AUTH option and passing the value WINHTTP\_DISABLE\_PASSPORT\_AUTH.</span></span> <span data-ttu-id="7a6b8-190">Sie kann später mit WinHTTP \_ enable \_ Passport auth wieder aktiviert werden \_ .</span><span class="sxs-lookup"><span data-stu-id="7a6b8-190">It can later be re-enabled with WINHTTP\_ENABLE\_PASSPORT\_AUTH.</span></span>

<span data-ttu-id="7a6b8-191">Die Passport-Authentifizierung kann nicht deaktiviert werden, wenn das [**WinHttpRequest**](winhttprequest.md) -Objekt verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-191">Passport authentication cannot be disabled when using the [**WinHttpRequest**](winhttprequest.md) object.</span></span>

<span data-ttu-id="7a6b8-192">Wie bereits weiter oben in diesem Abschnitt erwähnt, ist die Passport-Authentifizierung in WinHTTP 5,1 standardmäßig deaktiviert und muss vor der Verwendung von [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) explizit aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-192">As noted earlier in this section, Passport authentication is disabled by default in WinHTTP 5.1, and must be explicitly enabled with [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) before use.</span></span>

## <a name="passport-configuration-overrides-used-for-testing"></a><span data-ttu-id="7a6b8-193">Zum Testen verwendete außer Kraft setzungen für die Passport-Konfiguration</span><span class="sxs-lookup"><span data-stu-id="7a6b8-193">Passport Configuration Overrides Used for Testing</span></span>

<span data-ttu-id="7a6b8-194">WinHTTP basiert auf den Konfigurationsinformationen, die er vom Passport Nexus-Server herunterlädt, um die Passport 1,4-Authentifizierung zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-194">WinHTTP relies on the configuration information it downloads from the passport nexus server to support Passport 1.4 authentication.</span></span> <span data-ttu-id="7a6b8-195">Standardmäßig ist dieser Secure (SSL)-Server Nexus.Passport.com, und die Konfigurations Ressource ist rdr/pprdr. ASP, die als "Live"-Passport-Konfiguration bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-195">By default this secure (SSL) server is nexus.passport.com, and the configuration resource is rdr/pprdr.asp, which is known as the "live" passport configuration.</span></span> <span data-ttu-id="7a6b8-196">Das Format der Informationen ist ein benutzerdefinierter HTTP-Header "passporturls", gefolgt von durch Trennzeichen getrennten Attribut-Wert-Paaren.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-196">The format of the information is a custom HTTP header "PassportURLs", followed by comma delimited attribute-value pairs.</span></span>

<span data-ttu-id="7a6b8-197">" https://nexus.passport.com/rdr/pprdr.asp " Gibt beispielsweise die folgenden Konfigurationsinformationen zurück:</span><span class="sxs-lookup"><span data-stu-id="7a6b8-197">For example, "https://nexus.passport.com/rdr/pprdr.asp" returns the following configuration information:</span></span>

``` syntax
PassportURLs: DARealm=Passport.net,
DALogin=login.passport.com/login2.asp,
DAReg=https://register.passport.com/defaultwiz.asp,
Properties=https://memberservices.passport.com/ppsecure/MSRV_EditProfile.asp,
Privacy=https://www.passport.com/consumer/privacypolicy.asp,
GeneralRedir=https://nexusrdr.passport.com/redir.asp,
Help=https://memberservices.passport.com/UI/MSRV_UI_Help.asp,
ConfigVersion=2
\r\n
```

<span data-ttu-id="7a6b8-198">Die für WinHTTP relevanten Teile sind darealm, dalogin und ConfigVersion.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-198">The parts that are relevant to WinHTTP are DARealm, DALogin, and ConfigVersion.</span></span> <span data-ttu-id="7a6b8-199">Aus Leistungsgründen werden Sie während der Lebensdauer einer WinHTTP-Sitzung zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-199">For performance reasons, they are cached for the lifetime of a WinHTTP session.</span></span> <span data-ttu-id="7a6b8-200">Diese drei Werte können von Anwendungen außer Kraft gesetzt werden, die für die Arbeit mit einer anderen Passport-Infrastruktur als der "Live"-Produktions Einrichtung erforderlich sind, indem Sie die entsprechenden Registrierungs Einstellungen unter ändern.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-200">These three values can be overridden by applications that are required to work with another passport infrastructure other than the "live" production setup by changing the appropriate registry settings under</span></span>

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Windows
            CurrentVersion
               Internet Settings
                  WinHttp
                     Passport Test
```

``` syntax
LoginServerRealm (REG_SZ)    For example: abc.net
LoginServerUrl (REG_SZ)      For example: https://private-login.passport.com/login2.asp
ConfigVersion (REG_DWORD)    For example: 10
```

<span data-ttu-id="7a6b8-201">Wenn LoginServerUrl in der Registrierung vorhanden ist, kontaktiert WinHTTP keine Verbindung mit dem Nexus-Server für andere Konfigurationswerte.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-201">If LoginServerUrl is present in the registry, WinHTTP does not contact the nexus server for other configuration values.</span></span> <span data-ttu-id="7a6b8-202">In diesem Fall sollten loginserverrealm und ConfigVersion auch über die Registrierung festgelegt werden, um die Werte zu korrigieren.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-202">In this case, LoginServerRealm and ConfigVersion should also be set through the registry to correct values.</span></span>

<span data-ttu-id="7a6b8-203">Eine Anwendung kann zu Testzwecken zum Herunterladen der Passport-Konfiguration von einem privaten Nexus-Server benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-203">An application may, for testing purposes, be required to download passport configuration from a private nexus server.</span></span> <span data-ttu-id="7a6b8-204">Dies können Sie erreichen, indem Sie zwei Registrierungs Werte überschreiben.</span><span class="sxs-lookup"><span data-stu-id="7a6b8-204">This can be done by overriding two registry values under</span></span>

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Windows
            CurrentVersion
               Internet Settings
                  WinHttp
                     Passport Test
```

``` syntax
NexusHost (REG_SZ)    e.g. private-nexus.passport.com
NexusObj(REG_SZ)      e.g. config/passport.asp
```

## <a name="related-topics"></a><span data-ttu-id="7a6b8-205">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="7a6b8-205">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7a6b8-206">Authentifizierung in WinHTTP</span><span class="sxs-lookup"><span data-stu-id="7a6b8-206">Authentication in WinHTTP</span></span>](authentication-in-winhttp.md)
</dt> </dl>

 

 



