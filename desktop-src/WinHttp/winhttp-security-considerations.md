---
description: 'Die folgenden Sicherheitsüberlegungen gelten für Anwendungen, die WinHTTP verwenden: Server Zertifikate werden nur einmal pro Sitzung überprüft.'
ms.assetid: 287e85ed-a324-4785-872a-26e4ab37986d
title: Überlegungen zur WinHTTP-Sicherheit
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc06725ba03631eb4d5e5c29f8cfa0aae69b5022
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104484979"
---
# <a name="winhttp-security-considerations"></a>Überlegungen zur WinHTTP-Sicherheit

Die folgenden Sicherheitsüberlegungen gelten für Anwendungen, die WinHTTP verwenden:

-   **Server Zertifikate werden nur einmal pro Sitzung überprüft.** Nachdem ein Zertifikat überprüft wurde, ist es für die Dauer der aktuellen Sitzung gültig. Solange der Fingerabdruck des Zertifikats übereinstimmt, was darauf hinweist, dass das Zertifikat nicht geändert wurde, wird das Zertifikat weiterhin überprüft. Folglich wird jede Änderung der Überprüfungs Kriterien, über das Protokoll, die Sperr Überprüfung oder das Zertifikat-Error-Ignore-Flags, nicht wirksam, nachdem das Zertifikat überprüft wurde. Um zu erzwingen, dass eine Änderung sofort wirksam wird, muss die aktuelle Sitzung beendet und ein neues gestartet werden. Ebenso kann der Ablauf eines Zertifikats während einer Sitzung nur erkannt werden, wenn die Anwendung selbst regelmäßig den Zertifikat Server zum Abrufen von Ablaufdaten prüft.
-   **Der automatische Proxy umfasst das herunterladen und Ausführen von Skripts.** Die automatische Unterstützung für die Proxy Ermittlung umfasst das Erkennen von DHCP oder DNS, das herunterladen und Ausführen von Proxy Skripts wie Java-Skripts. Um ein höheres Maß an Sicherheit zu erreichen, muss eine Anwendung das **WinHTTP AutoProxy-Flag " \_ \_ \_ InProcess** " nicht übergeben, sodass die automatische Proxy Ermittlung außerhalb des Prozesses initiiert wird. Auch dann versucht WinHTTP standardmäßig, ein automatisch Proxy Skript auszuführen, wenn das Skript nicht ordnungsgemäß außerhalb des Prozesses ausgeführt werden kann. Wenn Sie der Ansicht sind, dass dieses Fall Back Verhalten ein unzulässiger Risiko darstellt, deaktivieren Sie das Fall Back Verhalten mit dem Flag " **WinHTTP \_ AutoProxy \_ Run \_ outprocess \_ only** ".
-   **WinHTTP- \_ Status \_ Rückruf Funktionen müssen umgehend zurückgegeben werden.** Wenn Sie eine dieser Rückruf Funktionen schreiben, achten Sie darauf, dass Sie nicht blockiert wird. Beispielsweise sollte weder der Rückruf noch eine Funktion, die er aufruft, ein Benutzer Dialogfeld anzeigen oder auf ein Ereignis warten. Wenn eine [*WinHTTP- \_ Status \_ Rückruf*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) Funktion blockiert, wirkt sie sich auf die interne Planung von WinHTTP aus und bewirkt, dass andere Anforderungen innerhalb desselben Prozesses den Dienst verweigert werden.
-   **WinHTTP- \_ Status \_ Rückruf Funktionen müssen Wiedereinstiegs fähig sein.** Vermeiden Sie beim Schreiben eines Rückrufs statische Variablen oder andere Konstrukte, die bei erneuter Aufnahme unsicher sind, und vermeiden Sie das Aufrufen anderer Funktionen, die nicht wieder einentrant sind.
-   **Wenn ein asynchroner Vorgang möglich ist, übergeben Sie NULL-Werte für Out-Parameter.** Wenn Sie den asynchronen Vorgang durch das Registrieren einer Rückruffunktion aktiviert haben, übergeben Sie immer **null** -Werte für solche out-Parameter wie *lpdwdataavailable* für " [**winhttpquerydataavailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable)", " *lpdwbytesread* " für " [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata)" oder " *lpdwbytesread* " für [**winhttpschreitedata**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata). Unter bestimmten Umständen wird der aufrufende Thread beendet, bevor der Vorgang abgeschlossen ist. wenn die Out-Parameter nicht **null** sind, kann die Funktion am Ende in den Arbeitsspeicher schreiben, der bereits freigegeben wurde.
-   **Die Passport-Authentifizierung ist nicht Foolproof.** Jedes cookiebasierte Authentifizierungsschema ist anfällig für Angriffe. Die Passport-Version 1,4 ist cookiebasiert und unterliegt daher den Sicherheitsrisiken, die mit jedem Cookie oder Formular basierten Authentifizierungsschema verknüpft sind. Die Passport-Unterstützung ist in WinHTTP standardmäßig deaktiviert. Sie kann mit [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption)aktiviert werden.
-   **Die Standard Authentifizierung sollte nur über eine sichere Verbindung verwendet werden.** Die Standard Authentifizierung, bei der der Benutzername und das Kennwort im Klartext gesendet werden (siehe [RFC 2617](https://www.ietf.org/rfc/rfc2617.txt)), sollte nur über verschlüsselte SSL-oder TLS-Verbindungen verwendet werden.
-   **Das Festlegen der Richtlinie für die automatische Anmeldung auf "niedrig" kann ein Risiko darstellen.** Wenn die Richtlinie für die automatische Anmeldung auf niedrig festgelegt ist, können die Anmelde Informationen eines Benutzers für die Authentifizierung bei einer beliebigen Site verwendet werden. Es ist jedoch keine gute Sicherheitsmaßnahme, sich bei Websites zu authentifizieren, denen Sie nicht vertrauen.
-   **SSL 2,0-Verbindungen werden nur verwendet, wenn diese explizit aktiviert sind.** Die Sicherheitsprotokolle TLS 1,0 und SSL 3,0 gelten als sicherer als SSL 2,0. Standardmäßig fordert WinHTTP beim Aushandeln einer SSL-Verbindung, nicht bei SSL 2,0, TLS 1,0 oder SSL 3,0 an. Die SSL 2,0-Unterstützung in WinHTTP kann nur durch Aufrufen von " [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption)" aktiviert werden.
-   **Die Zertifikat Sperr Überprüfung muss explizit angefordert werden.** Standardmäßig überprüft WinHTTP beim Ausführen der Zertifikat Authentifizierung nicht, ob das Zertifikat des Servers widerrufen wurde. Die Zertifikat Sperr Überprüfung kann mithilfe von [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption)aktiviert werden.
-   **Anwendungen müssen sicherstellen, dass eine Sitzung einer einzelnen Identität zugeordnet ist.** Eine WinHTTP-Sitzung sollte jeweils nur einer Identität zugeordnet werden. Das heißt, dass eine WinHTTP-Sitzung verwendet wird, um die Internet Aktivität eines einzelnen authentifizierten Benutzers oder eine Gruppe anonymer Benutzer zu verwalten. Da WinHTTP diese Zuordnung jedoch nicht automatisch erzwingt, muss Ihre Anwendung Maßnahmen ergreifen, um sicherzustellen, dass nur eine einzige Identität beteiligt ist.
-   **Vorgänge für ein WinHTTP-Anforderungs handle sollten synchronisiert werden.** Beispielsweise sollte eine Anwendung das Schließen eines Anforderungs Handles in einem Thread vermeiden, während ein anderer Thread eine Anforderung sendet oder empfängt. Um eine asynchrone Anforderung zu beenden, schließen Sie das Anforderungs Handle während einer Rückruf Benachrichtigung. Um eine synchrone Anforderung zu beenden, schließen Sie das Handle, wenn der vorherige WinHTTP-Rückruf zurückgegeben wurde.
-   **Ablauf Verfolgungs Dateien enthalten vertrauliche Informationen.** Ablauf Verfolgungs Dateien werden mithilfe von Access-Control Listen (ACLs) geschützt, sodass normalerweise nur der lokale Administrator oder das Benutzerkonto, das Sie erstellt hat, darauf zugegriffen werden kann. Vermeiden Sie das kompromittieren von Ablauf Verfolgungs Dateien durch nicht autorisierten Zugriff.
-   **Vermeiden Sie das Übergeben von sensiblen Daten über** [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption). Geben Sie für **WinHttpSetOption** keinen Benutzernamen, kein Kennwort oder keine anderen Anmelde Informationen an, da Sie keine Kontrolle über das verwendete Authentifizierungsschema haben und die sensiblen Daten unerwartet als Klartext gesendet werden können. Verwenden Sie zum Festlegen von Anmelde Informationen [**winhttpqueryauthschemas**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes) und **winhttpsetanmelde** Informationen anstelle von **WinHttpSetOption** .
-   **Die automatische Umleitung kann ein Sicherheitsrisiko darstellen.** Standardmäßig wird die Umleitung (302-Nachricht) auch für einen Beitrag automatisch befolgt. Um die Möglichkeit falscher Umleitungen zu vermeiden, sollten Anwendungen beim Bereitstellen von vertraulichen Informationen die automatische Umleitung oder die Umleitung des Monitors in Rückrufe deaktivieren.
-   **Benutzerdefinierte Header werden unveränderte Umleitungen übertragen.** Benutzerdefinierte Header, wie z. b. mit **winhttpadressquestheaders** hinzugefügte Cookies, werden ohne Änderung über Umleitungen übertragen, während von WinHTTP generierte Header automatisch aktualisiert werden. Wenn das übertragen eines benutzerdefinierten Headers über Umleitungen hinweg ein Sicherheitsrisiko darstellt, verwenden Sie den [*WinHTTP- \_ Status \_ Rückruf*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) Rückruf mit dem **WinHTTP- \_ Rückruf \_ Status \_ Umleitung** , um den betreffenden Header zu ändern, wenn eine Umleitung erfolgt.
-   **WinHTTP ist im synchronen Modus nicht Wiedereintritts fähig.** Da WinHTTP im synchronen Modus nicht Wiedereintritts fähig ist, planen Sie keine asynchronen Prozedur Aufrufe (APC), die WinHTTP für einen Anwendungs Thread aufrufen können, der in einer WinHTTP-Funktion ausgeführt wird. Im synchronen Modus führt WinHTTP einen Warnungs Tabellen-warte Vorgang aus, und wenn der wartende Thread vorzeitig entfernt wird, um ein APC auszuführen, und dann wieder in WinHTTP Wiedereintritt, kann der interne WinHTTP-Zustand beschädigt werden.

 

 
