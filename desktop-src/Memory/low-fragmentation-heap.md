---
description: Die Heap Fragmentierung ist ein Status, in dem der verfügbare Arbeitsspeicher in kleine, nicht zusammenhängende Blöcke unterteilt ist.
ms.assetid: d10abf82-423c-4942-b05e-55de3a5c4219
title: Heap mit niedriger Fragmentierung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8ad14a97fa6d95b663f63b21f0982332ba0de01e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106349398"
---
# <a name="low-fragmentation-heap"></a><span data-ttu-id="532b9-103">Heap mit niedriger Fragmentierung</span><span class="sxs-lookup"><span data-stu-id="532b9-103">Low-fragmentation Heap</span></span>

<span data-ttu-id="532b9-104">\[Die Informationen in diesem Thema gelten für Windows Server 2003 und Windows XP.</span><span class="sxs-lookup"><span data-stu-id="532b9-104">\[The information in this topic applies to Windows Server 2003 and Windows XP.</span></span> <span data-ttu-id="532b9-105">Ab Windows Vista verwendet das System den Low-Fragmentierung-Heap (LFH), der für die Speicher Belegungs Anforderungen benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="532b9-105">Starting with Windows Vista, the system uses the low-fragmentation heap (LFH) as needed to service memory allocation requests.</span></span> <span data-ttu-id="532b9-106">Anwendungen müssen die LFH nicht für Ihre Heaps aktivieren.\]</span><span class="sxs-lookup"><span data-stu-id="532b9-106">Applications do not need to enable the LFH for their heaps.\]</span></span>

<span data-ttu-id="532b9-107">Die Heap Fragmentierung ist ein Status, in dem der verfügbare Arbeitsspeicher in kleine, nicht zusammenhängende Blöcke unterteilt ist.</span><span class="sxs-lookup"><span data-stu-id="532b9-107">Heap fragmentation is a state in which available memory is broken into small, noncontiguous blocks.</span></span> <span data-ttu-id="532b9-108">Wenn ein Heap fragmentiert ist, kann die Speicher Belegung auch dann fehlschlagen, wenn der gesamte verfügbare Arbeitsspeicher im Heap ausreichend ist, um eine Anforderung zu erfüllen, da kein einzelner Speicherblock groß genug ist.</span><span class="sxs-lookup"><span data-stu-id="532b9-108">When a heap is fragmented, memory allocation can fail even when the total available memory in the heap is enough to satisfy a request, because no single block of memory is large enough.</span></span> <span data-ttu-id="532b9-109">Der Heap mit niedriger Fragmentierung (LFH) trägt dazu bei, die Heap Fragmentierung zu verringern.</span><span class="sxs-lookup"><span data-stu-id="532b9-109">The low-fragmentation heap (LFH) helps to reduce heap fragmentation.</span></span>

<span data-ttu-id="532b9-110">Der LFH ist kein separater Heap.</span><span class="sxs-lookup"><span data-stu-id="532b9-110">The LFH is not a separate heap.</span></span> <span data-ttu-id="532b9-111">Stattdessen handelt es sich um eine Richtlinie, die Anwendungen für Ihre Heaps aktivieren können.</span><span class="sxs-lookup"><span data-stu-id="532b9-111">Instead, it is a policy that applications can enable for their heaps.</span></span> <span data-ttu-id="532b9-112">Wenn die LFH aktiviert ist, ordnet das Systemspeicher in bestimmten vordefinierten Größen zu.</span><span class="sxs-lookup"><span data-stu-id="532b9-112">When the LFH is enabled, the system allocates memory in certain predetermined sizes.</span></span> <span data-ttu-id="532b9-113">Wenn eine Anwendung eine Speicher Belegung von einem Heap anfordert, für den LFH aktiviert ist, ordnet das System den kleinsten Speicherblock zu, der groß genug ist, um die angeforderte Größe zu enthalten.</span><span class="sxs-lookup"><span data-stu-id="532b9-113">When an application requests a memory allocation from a heap that has the LFH enabled, the system allocates the smallest block of memory that is large enough to contain the requested size.</span></span> <span data-ttu-id="532b9-114">Das System verwendet nicht die LFH für Zuordnungen, die größer als 16 KB sind, unabhängig davon, ob die LFH aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="532b9-114">The system does not use the LFH for allocations larger than 16 KB, whether or not the LFH is enabled.</span></span>

<span data-ttu-id="532b9-115">Eine Anwendung sollte die LFH nur für den Standard Heap des aufrufenden Prozesses oder für [private Heaps](heap-functions.md) aktivieren, die von der Anwendung erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="532b9-115">An application should enable the LFH only for the default heap of the calling process or for [private heaps](heap-functions.md) that the application has created.</span></span> <span data-ttu-id="532b9-116">Um die LFH für einen Heap zu aktivieren, verwenden Sie die [**GetProcessHeap**](/windows/desktop/api/HeapApi/nf-heapapi-getprocessheap) -Funktion, um ein Handle für den Standard Heap des aufrufenden Prozesses zu erhalten, oder verwenden Sie das Handle für einen privaten Heap, der von der [**HeapCreate**](/windows/desktop/api/HeapApi/nf-heapapi-heapcreate) -Funktion erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="532b9-116">To enable the LFH for a heap, use the [**GetProcessHeap**](/windows/desktop/api/HeapApi/nf-heapapi-getprocessheap) function to obtain a handle to the default heap of the calling process, or use the handle to a private heap created by the [**HeapCreate**](/windows/desktop/api/HeapApi/nf-heapapi-heapcreate) function.</span></span> <span data-ttu-id="532b9-117">Dann wenden Sie die [**HeapSetInformation**](/windows/desktop/api/HeapApi/nf-heapapi-heapsetinformation) -Funktion mit dem Handle an.</span><span class="sxs-lookup"><span data-stu-id="532b9-117">Then call the [**HeapSetInformation**](/windows/desktop/api/HeapApi/nf-heapapi-heapsetinformation) function with the handle.</span></span>

<span data-ttu-id="532b9-118">Der LFH kann nicht für Heaps aktiviert werden, die mit **Heap \_ No \_ serialize** erstellt wurden, oder für Heaps, die mit einer festgelegten Größe erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="532b9-118">The LFH cannot be enabled for heaps created with **HEAP\_NO\_SERIALIZE** or for heaps created with a fixed size.</span></span> <span data-ttu-id="532b9-119">Der LFH kann auch nicht aktiviert werden, wenn Sie die Heap-Debuggingtools in [Debuggingtools für Windows](/windows-hardware/drivers/debugger/) oder [Microsoft Application Verifier](https://www.microsoft.com/downloads/details.aspx?FamilyID=c4a25ab9-649d-4a1b-b4a7-c9d8b095df18&displaylang=en)verwenden.</span><span class="sxs-lookup"><span data-stu-id="532b9-119">The LFH also cannot be enabled if you are using the heap debugging tools in [Debugging Tools for Windows](/windows-hardware/drivers/debugger/) or [Microsoft Application Verifier](https://www.microsoft.com/downloads/details.aspx?FamilyID=c4a25ab9-649d-4a1b-b4a7-c9d8b095df18&displaylang=en).</span></span>

<span data-ttu-id="532b9-120">Nachdem die LFH für einen Heap aktiviert wurde, kann Sie nicht deaktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="532b9-120">After the LFH has been enabled for a heap, it cannot be disabled.</span></span>

<span data-ttu-id="532b9-121">Anwendungen, die am meisten von der LFH profitieren, sind Multithreadanwendungen, die Arbeitsspeicher häufig belegen und eine Vielzahl von Zuordnungs Größen unter 16 KB verwenden.</span><span class="sxs-lookup"><span data-stu-id="532b9-121">Applications that benefit most from the LFH are multithreaded applications that allocate memory frequently and use a variety of allocation sizes under 16 KB.</span></span> <span data-ttu-id="532b9-122">Nicht alle Anwendungen profitieren jedoch von der LFH.</span><span class="sxs-lookup"><span data-stu-id="532b9-122">However, not all applications benefit from the LFH.</span></span> <span data-ttu-id="532b9-123">Um die Auswirkungen der Aktivierung von LFH in Ihrer Anwendung zu bewerten, verwenden Sie Leistungsprofil Erstellungs Daten.</span><span class="sxs-lookup"><span data-stu-id="532b9-123">To assess the effects of enabling the LFH in your application, use performance profiling data.</span></span>

 

 
