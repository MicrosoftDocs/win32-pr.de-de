---
description: Die Daten Ausführungs Verhinderung (Data Execution Prevention, DEP) ist ein Feature zum Schutz von Arbeitsspeicher auf Systemebene, das in das Betriebssystem integriert ist, beginnend mit Windows XP und Windows Server 2003.
ms.assetid: 75cd83a5-4b77-4ca9-b595-e32d0dd609d0
title: Datenausführungsverhinderung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8bc53febb383ef2789c2798b091960c2d20856d0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106373030"
---
# <a name="data-execution-prevention"></a><span data-ttu-id="a93b3-103">Datenausführungsverhinderung</span><span class="sxs-lookup"><span data-stu-id="a93b3-103">Data Execution Prevention</span></span>

<span data-ttu-id="a93b3-104">Die Daten Ausführungs Verhinderung (Data Execution Prevention, DEP) ist ein Feature zum Schutz von Arbeitsspeicher auf Systemebene, das in das Betriebssystem integriert ist, beginnend mit Windows XP und Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="a93b3-104">Data Execution Prevention (DEP) is a system-level memory protection feature that is built into the operating system starting with Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="a93b3-105">DEP ermöglicht dem System, eine oder mehrere Seiten des Arbeitsspeichers als nicht ausführbare Datei zu markieren.</span><span class="sxs-lookup"><span data-stu-id="a93b3-105">DEP enables the system to mark one or more pages of memory as non-executable.</span></span> <span data-ttu-id="a93b3-106">Das Markieren von Speicherbereichen als nicht ausführbare Datei bedeutet, dass Code nicht von diesem Bereich des Arbeitsspeichers aus ausgeführt werden kann, was die Ausnutzung von Pufferüberläufen erschwert.</span><span class="sxs-lookup"><span data-stu-id="a93b3-106">Marking memory regions as non-executable means that code cannot be run from that region of memory, which makes it harder for the exploitation of buffer overruns.</span></span>

<span data-ttu-id="a93b3-107">DEP verhindert, dass Code von Datenseiten ausgeführt wird, wie z. b. der Standard Heap, Stapel und Speicherpools.</span><span class="sxs-lookup"><span data-stu-id="a93b3-107">DEP prevents code from being run from data pages such as the default heap, stacks, and memory pools.</span></span> <span data-ttu-id="a93b3-108">Wenn eine Anwendung versucht, Code auf einer geschützten Datenseite auszuführen, tritt eine Ausnahme aufgrund einer Speicherzugriffs Verletzung auf, und wenn die Ausnahme nicht behandelt wird, wird der aufrufende Prozess beendet.</span><span class="sxs-lookup"><span data-stu-id="a93b3-108">If an application attempts to run code from a data page that is protected, a memory access violation exception occurs, and if the exception is not handled, the calling process is terminated.</span></span>

<span data-ttu-id="a93b3-109">DEP ist nicht als umfassende Verteidigung gegen alle Exploits vorgesehen. Es ist ein weiteres Tool, das Sie zum Sichern Ihrer Anwendung verwenden können.</span><span class="sxs-lookup"><span data-stu-id="a93b3-109">DEP is not intended to be a comprehensive defense against all exploits; it is intended to be another tool that you can use to secure your application.</span></span>

## <a name="how-data-execution-prevention-works"></a><span data-ttu-id="a93b3-110">Funktionsweise der Daten Ausführungs Verhinderung</span><span class="sxs-lookup"><span data-stu-id="a93b3-110">How Data Execution Prevention Works</span></span>

<span data-ttu-id="a93b3-111">Wenn eine Anwendung versucht, Code von einer geschützten Seite auszuführen, empfängt die Anwendung eine Ausnahme mit der Statuscode **Status- \_ Zugriffs \_ Verletzung**.</span><span class="sxs-lookup"><span data-stu-id="a93b3-111">If an application attempts to run code from a protected page, the application receives an exception with the status code **STATUS\_ACCESS\_VIOLATION**.</span></span> <span data-ttu-id="a93b3-112">Wenn die Anwendung Code von einer Arbeitsspeicher Seite ausführen muss, muss Sie die richtigen Attribute für den [Schutz](memory-protection.md) von virtuellen Arbeitsspeicher zuordnen und festlegen.</span><span class="sxs-lookup"><span data-stu-id="a93b3-112">If your application must run code from a memory page, it must allocate and set the proper virtual [memory protection](memory-protection.md) attributes.</span></span> <span data-ttu-id="a93b3-113">Der zugeordnete Arbeitsspeicher muss als " **Seite \_ Ausführen**", " **Seite \_ Ausführen \_ Lesen**", " **Seite \_ Ausführen \_**" "lesen" oder "Schreiben von **Seiten \_ Ausführen \_** " beim belegen von Speicher gekennzeichnet sein</span><span class="sxs-lookup"><span data-stu-id="a93b3-113">The allocated memory must be marked **PAGE\_EXECUTE**, **PAGE\_EXECUTE\_READ**, **PAGE\_EXECUTE\_READWRITE**, or **PAGE\_EXECUTE\_WRITECOPY** when allocating memory.</span></span> <span data-ttu-id="a93b3-114">Heap Zuweisungen, die durch den Aufruf der Funktionen **malloc** und [**HeapAlloc**](/windows/desktop/api/HeapApi/nf-heapapi-heapalloc) vorgenommen werden, sind nicht ausführbare Dateien.</span><span class="sxs-lookup"><span data-stu-id="a93b3-114">Heap allocations made by calling the **malloc** and [**HeapAlloc**](/windows/desktop/api/HeapApi/nf-heapapi-heapalloc) functions are non-executable.</span></span>

<span data-ttu-id="a93b3-115">Anwendungen können keinen Code aus dem Standardprozess Heap oder dem Stapel ausführen.</span><span class="sxs-lookup"><span data-stu-id="a93b3-115">Applications cannot run code from the default process heap or the stack.</span></span>

<span data-ttu-id="a93b3-116">DEP wird beim Systemstart gemäß der Einstellung "No-Execute Page Protection Policy" in den Start Konfigurationsdaten konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="a93b3-116">DEP is configured at system boot according to the no-execute page protection policy setting in the boot configuration data.</span></span> <span data-ttu-id="a93b3-117">Eine Anwendung kann die aktuelle Richtlinien Einstellung abrufen, indem Sie die [**getsystemdeppolicy**](/windows/desktop/api/WinBase/nf-winbase-getsystemdeppolicy) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a93b3-117">An application can get the current policy setting by calling the [**GetSystemDEPPolicy**](/windows/desktop/api/WinBase/nf-winbase-getsystemdeppolicy) function.</span></span> <span data-ttu-id="a93b3-118">Abhängig von der Richtlinien Einstellung kann eine Anwendung die DEP-Einstellung für den aktuellen Prozess ändern, indem Sie die Funktion [**setprocessdeppolicy**](/windows/desktop/api/WinBase/nf-winbase-setprocessdeppolicy) aufruft.</span><span class="sxs-lookup"><span data-stu-id="a93b3-118">Depending on the policy setting, an application can change the DEP setting for the current process by calling the [**SetProcessDEPPolicy**](/windows/desktop/api/WinBase/nf-winbase-setprocessdeppolicy) function.</span></span>

## <a name="programming-considerations"></a><span data-ttu-id="a93b3-119">Überlegungen zur Programmierung</span><span class="sxs-lookup"><span data-stu-id="a93b3-119">Programming Considerations</span></span>

<span data-ttu-id="a93b3-120">Eine Anwendung kann die [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) -Funktion verwenden, um ausführbaren Arbeitsspeicher mit den entsprechenden Speicherschutz Optionen zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="a93b3-120">An application can use the [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) function to allocate executable memory with the appropriate memory protection options.</span></span> <span data-ttu-id="a93b3-121">Es wird empfohlen, dass ein Anwendungs Satz mindestens die Option zum **\_ Ausführen** des Speicher Schutzes auf der Seite ist.</span><span class="sxs-lookup"><span data-stu-id="a93b3-121">It is suggested that an application set, at a minimum, the **PAGE\_EXECUTE** memory protection option.</span></span> <span data-ttu-id="a93b3-122">Nachdem der ausführbare Code generiert wurde, empfiehlt es sich, dass die Anwendung den Speicherschutz so festlegen, dass der Schreibzugriff auf den zugewiesenen Speicher nicht zulässig ist.</span><span class="sxs-lookup"><span data-stu-id="a93b3-122">After the executable code is generated, it is recommended that the application set memory protections to disallow write access to the allocated memory.</span></span> <span data-ttu-id="a93b3-123">Anwendungen können den Schreibzugriff auf zugeordneten Speicher mithilfe der [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) -Funktion nicht zulassen.</span><span class="sxs-lookup"><span data-stu-id="a93b3-123">Applications can disallow write access to allocated memory by using the [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) function.</span></span> <span data-ttu-id="a93b3-124">Das Zulassen des Schreibzugriffs gewährleistet einen maximalen Schutz für ausführbare Bereiche des Prozess Adressraums.</span><span class="sxs-lookup"><span data-stu-id="a93b3-124">Disallowing write access ensures maximum protection for executable regions of process address space.</span></span> <span data-ttu-id="a93b3-125">Sie sollten versuchen, Anwendungen zu erstellen, die den kleinsten ausführbaren, ausführbaren Adressraum verwenden. Dadurch wird die Menge an Arbeitsspeicher minimiert, die für die Speicher Ausnutzung verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="a93b3-125">You should attempt to create applications that use the smallest executable address space possible, which minimizes the amount of memory that is exposed to memory exploitation.</span></span>

<span data-ttu-id="a93b3-126">Außerdem sollten Sie versuchen, das Layout des virtuellen Speichers Ihrer Anwendung zu steuern und ausführbare Bereiche zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a93b3-126">You should also attempt to control the layout of your application's virtual memory and create executable regions.</span></span> <span data-ttu-id="a93b3-127">Diese ausführbaren Bereiche sollten sich in einem geringeren Speicherplatz als nicht ausführbare Bereiche befinden.</span><span class="sxs-lookup"><span data-stu-id="a93b3-127">These executable regions should be located in a lower memory space than non-executable regions.</span></span> <span data-ttu-id="a93b3-128">Durch die Suche nach ausführbaren Regionen unterhalb nicht ausführbarer Bereiche können Sie verhindern, dass ein Pufferüberlauf in den ausführbaren Bereich des Arbeitsspeichers übertragen wird.</span><span class="sxs-lookup"><span data-stu-id="a93b3-128">By locating executable regions below non-executable regions, you can help prevent a buffer overflow from overflowing into the executable area of memory.</span></span>

## <a name="application-compatibility"></a><span data-ttu-id="a93b3-129">Anwendungskompatibilität</span><span class="sxs-lookup"><span data-stu-id="a93b3-129">Application Compatibility</span></span>

<span data-ttu-id="a93b3-130">Einige Anwendungsfunktionen sind mit DEP nicht kompatibel.</span><span class="sxs-lookup"><span data-stu-id="a93b3-130">Some application functionality is incompatible with DEP.</span></span> <span data-ttu-id="a93b3-131">Anwendungen, die eine dynamische Codegenerierung ausführen (z. b. Just-in-Time-Codegenerierung) und generierten Code nicht explizit mit EXECUTE-Berechtigung markieren, haben möglicherweise Kompatibilitätsprobleme auf Computern, die DEP verwenden.</span><span class="sxs-lookup"><span data-stu-id="a93b3-131">Applications that perform dynamic code generation (such as Just-In-Time code generation) and do not explicitly mark generated code with execute permission may have compatibility issues on computers that are using DEP.</span></span> <span data-ttu-id="a93b3-132">Anwendungen, die in die Active Template Library (ATL) Version 7,1 und früher geschrieben wurden, können versuchen, Code auf Seiten auszuführen, die als nicht ausführbare Datei gekennzeichnet sind. Dadurch wird ein NX-Fehler ausgelöst und die Anwendung beendet. Weitere Informationen finden Sie unter [**setprocessdeppolicy**](/windows/desktop/api/WinBase/nf-winbase-setprocessdeppolicy).</span><span class="sxs-lookup"><span data-stu-id="a93b3-132">Applications written to the Active Template Library (ATL) version 7.1 and earlier can attempt to execute code on pages marked as non-executable, which triggers an NX fault and terminates the application; for more information, see [**SetProcessDEPPolicy**](/windows/desktop/api/WinBase/nf-winbase-setprocessdeppolicy).</span></span> <span data-ttu-id="a93b3-133">Die meisten Anwendungen, die mit DEP nicht kompatible Aktionen ausführen, müssen aktualisiert werden, damit Sie ordnungsgemäß funktionieren.</span><span class="sxs-lookup"><span data-stu-id="a93b3-133">Most applications that perform actions incompatible with DEP must be updated to function properly.</span></span>

<span data-ttu-id="a93b3-134">Eine kleine Anzahl ausführbarer Dateien und Bibliotheken kann ausführbaren Code im Daten Abschnitt einer Bilddatei enthalten.</span><span class="sxs-lookup"><span data-stu-id="a93b3-134">A small number of executable files and libraries may contain executable code in the data section of an image file.</span></span> <span data-ttu-id="a93b3-135">In einigen Fällen können Anwendungen kleinere Code Segmente (in der Regel als thunas bezeichnet) in den Daten Abschnitten platzieren.</span><span class="sxs-lookup"><span data-stu-id="a93b3-135">In some cases, applications may place small segments of code (commonly referred to as thunks) in the data sections.</span></span> <span data-ttu-id="a93b3-136">Allerdings markiert DEP-Abschnitte der Bilddatei, die im Arbeitsspeicher geladen werden, als nicht ausführbare Datei, es sei denn, der Abschnitt enthält das ausführbare Attribut.</span><span class="sxs-lookup"><span data-stu-id="a93b3-136">However, DEP marks sections of the image file that is loaded in memory as non-executable unless the section has the executable attribute applied.</span></span>

<span data-ttu-id="a93b3-137">Daher sollte der ausführbare Code in den Daten Abschnitten zu einem Code Abschnitt migriert werden, oder der Daten Abschnitt, der den ausführbaren Code enthält, sollte explizit als ausführbare Datei gekennzeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="a93b3-137">Therefore, executable code in data sections should be migrated to a code section, or the data section that contains the executable code should be explicitly marked as executable.</span></span> <span data-ttu-id="a93b3-138">Das ausführbare Attribut **Image \_ SCN \_ mem \_ Execute** sollte dem Feld **Merkmale** der entsprechenden Abschnitts Kopfzeile für Abschnitte hinzugefügt werden, die ausführbaren Code enthalten.</span><span class="sxs-lookup"><span data-stu-id="a93b3-138">The executable attribute, **IMAGE\_SCN\_MEM\_EXECUTE**, should be added to the **Characteristics** field of the corresponding section header for sections that contain executable code.</span></span> <span data-ttu-id="a93b3-139">Weitere Informationen zum Hinzufügen von Attributen zu einem Abschnitt finden Sie in der Dokumentation, die in Ihrem Linker enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="a93b3-139">For more information about adding attributes to a section, see the documentation included with your linker.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a93b3-140">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="a93b3-140">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="a93b3-141">[Daten Ausführungs Verhinderung (TechNet)](/previous-versions/windows/it-pro/windows-xp/bb457155(v=technet.10))</span><span class="sxs-lookup"><span data-stu-id="a93b3-141">[Data Execution Prevention (TechNet)](/previous-versions/windows/it-pro/windows-xp/bb457155(v=technet.10))</span></span>
</dt> <dt>

[<span data-ttu-id="a93b3-142">Vorgehensweise beim Konfigurieren des Speicher Schutzes</span><span class="sxs-lookup"><span data-stu-id="a93b3-142">How to Configure Memory Protection</span></span>](https://www.microsoft.com/technet/security/prodtech/windowsxp/depcnfxp.mspx)
</dt> <dt>

[<span data-ttu-id="a93b3-143">KB-Artikel 875352</span><span class="sxs-lookup"><span data-stu-id="a93b3-143">KB Article 875352</span></span>](https://support.microsoft.com/kb/875352)
</dt> </dl>

 

 
