---
description: '4-Gigabyte-Optimierung: bcdedit und Boot.ini'
ms.assetid: 991eb86f-9e6f-4084-8b6f-f979e42104b5
title: '4-Gigabyte-Optimierung: bcdedit und Boot.ini'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f997ae09748370d5ec8ec246da80b6440d7aaf45
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104215914"
---
# <a name="4-gigabyte-tuning-bcdedit-and-bootini"></a><span data-ttu-id="a926c-103">4-Gigabyte-Optimierung: bcdedit und Boot.ini</span><span class="sxs-lookup"><span data-stu-id="a926c-103">4-Gigabyte Tuning: BCDEdit and Boot.ini</span></span>

<span data-ttu-id="a926c-104">Bei 32-Bit-Editionen von Windows sind für Anwendungen 4 Gigabyte (GB) virtueller Adressraum verfügbar.</span><span class="sxs-lookup"><span data-stu-id="a926c-104">On 32-bit editions of Windows, applications have 4 gigabyte (GB) of virtual address space available.</span></span> <span data-ttu-id="a926c-105">Der virtuelle Adressraum ist dividiert, sodass der Anwendung 2 GB zur Verfügung stehen und die anderen 2 GB nur für das System verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="a926c-105">The virtual address space is divided so that 2 GB is available to the application and the other 2 GB is available only to the system.</span></span> <span data-ttu-id="a926c-106">Das mit dem Befehl *bcdedit/set reaseuserva* aktivierte Feature zur Optimierung von 4 Gigabyte (4GT oder 4GT RAM) erhöht den virtuellen Adressraum, der für die Anwendung zur Verfügung steht, auf bis zu 3 GB und reduziert den für das System verfügbaren Betrag zwischen 1 und 2 GB.</span><span class="sxs-lookup"><span data-stu-id="a926c-106">The 4-gigabyte tuning (4GT or 4GT RAM Tuning) feature, enabled with the *BCDEdit /set increaseuserva* command, increases the virtual address space that is available to the application up to 3 GB, and reduces the amount available to the system to between 1 and 2 GB.</span></span>

<span data-ttu-id="a926c-107">Bei Anwendungen, die Arbeitsspeicher intensiv sind, wie z. b. Datenbank-Managementsysteme (DBMS), kann die Verwendung eines größeren virtuellen Adressraums erhebliche Leistungs-und Skalierbarkeits Vorteile bieten.</span><span class="sxs-lookup"><span data-stu-id="a926c-107">For applications that are memory-intensive, such as database management systems (DBMS), the use of a larger virtual address space can provide considerable performance and scalability benefits.</span></span> <span data-ttu-id="a926c-108">Der Dateicache, der Auslagerungs Pool und der nicht Auslagerungs Pool sind jedoch kleiner, was sich negativ auf Anwendungen mit starker Netzwerk-oder e/a-Auslastung auswirken kann.</span><span class="sxs-lookup"><span data-stu-id="a926c-108">However, the file cache, paged pool, and nonpaged pool are smaller, which can adversely affect applications with heavy networking or I/O.</span></span> <span data-ttu-id="a926c-109">Daher empfiehlt es sich, die Anwendung unter Last zu testen und die Leistungsindikatoren zu überprüfen, um festzustellen, ob Ihre Anwendung von dem größeren Adressraum profitiert.</span><span class="sxs-lookup"><span data-stu-id="a926c-109">Therefore, you might want to test your application under load, and examine the performance counters to determine whether your application benefits from the larger address space.</span></span>

<span data-ttu-id="a926c-110">Um 4GT zu aktivieren, verwenden Sie den Befehl [bcdedit/set](/windows-hardware/drivers/devtest/bcdedit--set) , um die Option für den **starteuserva** -Start Eintrag auf einen Wert zwischen 2048 (2 GB) und 3072 (3 GB) festzulegen.</span><span class="sxs-lookup"><span data-stu-id="a926c-110">To enable 4GT, use the [BCDEdit /set](/windows-hardware/drivers/devtest/bcdedit--set) command to set the **increaseuserva** boot entry option to a value between 2048 (2 GB) and 3072 (3 GB).</span></span>

<span data-ttu-id="a926c-111">**Windows Server 2003 und früher:** Fügen Sie zum Aktivieren von 4GT den **/3GB** -Schalter zur Boot.ini Datei hinzu.</span><span class="sxs-lookup"><span data-stu-id="a926c-111">**Windows Server 2003 and earlier:** To enable 4GT, add the **/3GB** switch to the Boot.ini file.</span></span> <span data-ttu-id="a926c-112">Der Schalter " **/3GB** " wird auf den folgenden Systemen unterstützt:</span><span class="sxs-lookup"><span data-stu-id="a926c-112">The **/3GB** switch is supported on the following systems:</span></span>

-   <span data-ttu-id="a926c-113">Windows Server 2003</span><span class="sxs-lookup"><span data-stu-id="a926c-113">Windows Server 2003</span></span>
-   <span data-ttu-id="a926c-114">Windows XP Professional</span><span class="sxs-lookup"><span data-stu-id="a926c-114">Windows XP Professional</span></span>

<span data-ttu-id="a926c-115">Mit dem **/3GB** -Switch werden für Anwendungen ein vollständiger virtueller Adressraum von 3 GB zur Verfügung gestellt, und der für das System verfügbare Betrag wird auf 1 GB reduziert.</span><span class="sxs-lookup"><span data-stu-id="a926c-115">The **/3GB** switch makes a full 3 GB of virtual address space available to applications and reduces the amount available to the system to 1 GB.</span></span> <span data-ttu-id="a926c-116">Unter Windows Server 2003 kann der für Anwendungen verfügbare Adressraum angepasst werden, indem der **Option/USERVA bei** -Schalter in Boot.ini auf einen Wert zwischen 2048 und 3072 festgelegt wird. dadurch erhöht sich der für das System verfügbare Adressraum.</span><span class="sxs-lookup"><span data-stu-id="a926c-116">On Windows Server 2003, the amount of address space available to applications can be adjusted by setting the **/USERVA** switch in Boot.ini to a value between 2048 and 3072, which increases the amount of address space available to the system.</span></span> <span data-ttu-id="a926c-117">Dadurch kann die Gesamtsystemleistung beibehalten werden, wenn die Anwendung mehr als 2 GB, aber weniger als 3 GB Adressraum erfordert.</span><span class="sxs-lookup"><span data-stu-id="a926c-117">This can help maintain overall system performance when the application requires more than 2 GB but less than 3 GB of address space.</span></span>

<span data-ttu-id="a926c-118">Damit eine Anwendung den größeren Adressraum verwenden kann, legen Sie das Flag für die Groß-und Adresserkennung der [**Abbild \_ Datei \_ \_ \_**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) im Image-Header fest.</span><span class="sxs-lookup"><span data-stu-id="a926c-118">To enable an application to use the larger address space, set the [**IMAGE\_FILE\_LARGE\_ADDRESS\_AWARE**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) flag in the image header.</span></span> <span data-ttu-id="a926c-119">Der in Microsoft Visual C++ enthaltene Linker unterstützt den Schalter **/LARGEADDRESSAWARE** , um dieses Flag festzulegen.</span><span class="sxs-lookup"><span data-stu-id="a926c-119">The linker included with Microsoft Visual C++ supports the **/LARGEADDRESSAWARE** switch to set this flag.</span></span> <span data-ttu-id="a926c-120">Das Festlegen dieses Flags und das anschließende Ausführen der Anwendung auf einem System, das über keinen 4GT-Support verfügt, sollte sich nicht auf die Anwendung auswirken.</span><span class="sxs-lookup"><span data-stu-id="a926c-120">Setting this flag and then running the application on a system that does not have 4GT support should not affect the application.</span></span>

<span data-ttu-id="a926c-121">Bei 64-Bit-Editionen von Windows sind für 32-Bit-Anwendungen, die mit dem Flag für die [**Image \_ Datei mit \_ großen \_ Adressen \_**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) gekennzeichnet sind, 4 GB Adressraum verfügbar.</span><span class="sxs-lookup"><span data-stu-id="a926c-121">On 64-bit editions of Windows, 32-bit applications marked with the [**IMAGE\_FILE\_LARGE\_ADDRESS\_AWARE**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) flag have 4 GB of address space available.</span></span>

<span data-ttu-id="a926c-122">**Itanium-Editionen von Windows Server 2003:** Vor SP1 sind für 32-Bit-Prozesse nur 2 GB Adressraum verfügbar.</span><span class="sxs-lookup"><span data-stu-id="a926c-122">**Itanium editions of Windows Server 2003:** Prior to SP1, 32-bit processes have only 2 GB of address space available.</span></span>

<span data-ttu-id="a926c-123">Verwenden Sie die folgenden Richtlinien zur Unterstützung von 4GT in-Anwendungen:</span><span class="sxs-lookup"><span data-stu-id="a926c-123">Use the following guidelines to support 4GT in applications:</span></span>

-   <span data-ttu-id="a926c-124">Adressen in der Nähe der 2-GB-Grenze werden in der Regel von verschiedenen System-DLLs verwendet.</span><span class="sxs-lookup"><span data-stu-id="a926c-124">Addresses near the 2-GB boundary are typically used by various system DLLs.</span></span> <span data-ttu-id="a926c-125">Daher kann ein 32-Bit-Prozess nicht mehr als 2 GB zusammenhängenden Speicher zuweisen, auch wenn der gesamte 4-GB-Adressraum verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="a926c-125">Therefore, a 32-bit process cannot allocate more than 2 GB of contiguous memory, even if the entire 4-GB address space is available.</span></span>
-   <span data-ttu-id="a926c-126">Verwenden Sie die [**GlobalMemoryStatus usex**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex) -Funktion, um die Gesamtmenge des virtuellen Speicherplatzes für den Benutzer abzurufen.</span><span class="sxs-lookup"><span data-stu-id="a926c-126">To retrieve the amount of total user virtual space, use the [**GlobalMemoryStatusEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex) function.</span></span> <span data-ttu-id="a926c-127">Verwenden Sie die [**GetSystemInfo**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) -Funktion, um die höchstmögliche Benutzer Adresse abzurufen.</span><span class="sxs-lookup"><span data-stu-id="a926c-127">To retrieve the highest possible user address, use the [**GetSystemInfo**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) function.</span></span> <span data-ttu-id="a926c-128">Erkennen Sie den tatsächlichen Wert immer zur Laufzeit, und vermeiden Sie die Verwendung von hart verdrahteten Konstanten Definitionen wie z `#define HIGHEST_USER_ADDRESS 0xC0000000` . b.:.</span><span class="sxs-lookup"><span data-stu-id="a926c-128">Always detect the real value at runtime, and avoid using hard-wired constant definitions such as: `#define HIGHEST_USER_ADDRESS 0xC0000000`.</span></span>
-   <span data-ttu-id="a926c-129">Vermeiden Sie signierte Vergleiche mit Zeigern, da Sie möglicherweise dazu führen, dass Anwendungen auf einem 4GT-fähigen Systemabstürzen.</span><span class="sxs-lookup"><span data-stu-id="a926c-129">Avoid signed comparisons with pointers, because they might cause applications to crash on a 4GT-enabled system.</span></span> <span data-ttu-id="a926c-130">Eine Bedingung wie die folgende ist für einen Zeiger, der oberhalb von 2 GB liegt, auf false fest `if (pointer > 40000000)` .</span><span class="sxs-lookup"><span data-stu-id="a926c-130">A condition such as the following is false for a pointer that is above 2 GB: `if (pointer > 40000000)`.</span></span>
-   <span data-ttu-id="a926c-131">Code, der das höchste Bit eines Zeigers für einen Anwendungs definierten Zweck verwendet, schlägt fehl, wenn 4GT aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="a926c-131">Code that uses the highest bit of a pointer for an application-defined purpose will fail when 4GT is enabled.</span></span> <span data-ttu-id="a926c-132">Beispielsweise kann ein 32-Bit-Wort als benutzermodusadresse angesehen werden, wenn es unter 0x80000000 liegt, und ein Fehlercode, wenn dies der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="a926c-132">For example, a 32-bit word might be considered a user-mode address if it is below 0x80000000, and an error code if above.</span></span> <span data-ttu-id="a926c-133">Dies gilt nicht für 4GT.</span><span class="sxs-lookup"><span data-stu-id="a926c-133">This is not true with 4GT.</span></span>

<span data-ttu-id="a926c-134">[**Virtualzuordc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) gibt in der Regel niedrige Adressen vor hohen Adressen zurück.</span><span class="sxs-lookup"><span data-stu-id="a926c-134">[**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) usually returns low addresses before high addresses.</span></span> <span data-ttu-id="a926c-135">Der Prozess verwendet daher möglicherweise nicht sehr hohe Adressen, es sei denn, er ordnet viel Speicherplatz zu oder verfügt über einen fragmentierten virtuellen Adressraum.</span><span class="sxs-lookup"><span data-stu-id="a926c-135">Therefore, your process may not use very high addresses unless it allocates a lot of memory or has a fragmented virtual address space.</span></span> <span data-ttu-id="a926c-136">Geben Sie beim Aufrufen von **VirtualAlloc** den Wert **\_ Top- \_ down** an, oder legen Sie den folgenden Registrierungs Wert auf 0x100000 fest, um Zuordnungen für die Zuordnung von höheren Adressen vor niedrigeren Adressen zu Testzwecken zu erzwingen:</span><span class="sxs-lookup"><span data-stu-id="a926c-136">To force allocations to allocate from higher addresses before lower addresses for testing purposes, specify **MEM\_TOP\_DOWN** when calling **VirtualAlloc** or set the following registry value to 0x100000:</span></span>

<span data-ttu-id="a926c-137">**HKEY \_ Lokales \_ Computer** \\ **System** \\ **CurrentControlSet** \\ **Control** \\ **Session Manager** \\ **Memory Management** \\ **zustandspreference**</span><span class="sxs-lookup"><span data-stu-id="a926c-137">**HKEY\_LOCAL\_MACHINE**\\**System**\\**CurrentControlSet**\\**Control**\\**Session Manager**\\**Memory Management**\\**AllocationPreference**</span></span>

## <a name="related-topics"></a><span data-ttu-id="a926c-138">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="a926c-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a926c-139">Arbeitsspeicher Grenzwerte für Windows-Releases</span><span class="sxs-lookup"><span data-stu-id="a926c-139">Memory Limits for Windows Releases</span></span>](memory-limits-for-windows-releases.md)
</dt> <dt>

[<span data-ttu-id="a926c-140">Physical Address Extension</span><span class="sxs-lookup"><span data-stu-id="a926c-140">Physical Address Extension</span></span>](physical-address-extension.md)
</dt> <dt>

<span data-ttu-id="a926c-141">[4GT Technische Referenz](/previous-versions/windows/it-pro/windows-server-2003/cc778496(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="a926c-141">[4GT Technical Reference](/previous-versions/windows/it-pro/windows-server-2003/cc778496(v=ws.10))</span></span>
</dt> </dl>

 

 
