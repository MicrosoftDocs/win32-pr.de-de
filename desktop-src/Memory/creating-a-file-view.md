---
description: Um die Daten aus einer Datei dem virtuellen Arbeitsspeicher eines Prozesses zuzuordnen, müssen Sie eine Ansicht der Datei erstellen.
ms.assetid: b1ebd9a4-cde4-4c0c-80d2-5ccb655cd3a4
title: Erstellen einer Dateiansicht
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 498f7ba132efd9ecf82f9ec087492c9622824b51
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103959669"
---
# <a name="creating-a-file-view"></a><span data-ttu-id="e2b90-103">Erstellen einer Dateiansicht</span><span class="sxs-lookup"><span data-stu-id="e2b90-103">Creating a File View</span></span>

<span data-ttu-id="e2b90-104">Um die Daten aus einer Datei dem virtuellen Arbeitsspeicher eines Prozesses zuzuordnen, müssen Sie eine Ansicht der Datei erstellen.</span><span class="sxs-lookup"><span data-stu-id="e2b90-104">To map the data from a file to the virtual memory of a process, you must create a view of the file.</span></span> <span data-ttu-id="e2b90-105">Die Funktionen [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) und [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) verwenden das von " [**kreatefilemapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) " zurückgegebene dateimappingobjekthandle, um eine Ansicht der Datei oder einen Teil der Datei im virtuellen Adressraum des Prozesses zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="e2b90-105">The [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) and [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) functions use the file mapping object handle returned by [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) to create a view of the file or a portion of the file in the process's virtual address space.</span></span> <span data-ttu-id="e2b90-106">Diese Funktionen schlagen fehl, wenn die Zugriffsflags einen Konflikt mit den **beim Erstellen des** Datei Zuordnungsobjekts angegebenen Zugriffsflags verursachen.</span><span class="sxs-lookup"><span data-stu-id="e2b90-106">These functions fail if the access flags conflict with those specified when **CreateFileMapping** created the file mapping object.</span></span>

<span data-ttu-id="e2b90-107">Die [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) -Funktion gibt einen Zeiger auf die Dateiansicht zurück.</span><span class="sxs-lookup"><span data-stu-id="e2b90-107">The [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) function returns a pointer to the file view.</span></span> <span data-ttu-id="e2b90-108">Durch Dereferenzierung eines Zeigers im Adressbereich, der in **MapViewOfFile** angegeben ist, kann eine Anwendung Daten aus der Datei lesen und Daten in die Datei schreiben.</span><span class="sxs-lookup"><span data-stu-id="e2b90-108">By dereferencing a pointer in the range of addresses specified in **MapViewOfFile**, an application can read data from the file and write data to the file.</span></span> <span data-ttu-id="e2b90-109">Das Schreiben in die Dateiansicht führt zu Änderungen am Datei Zuordnungsobjekt.</span><span class="sxs-lookup"><span data-stu-id="e2b90-109">Writing to the file view results in changes to the file mapping object.</span></span> <span data-ttu-id="e2b90-110">Das eigentliche Schreiben in die Datei auf dem Datenträger wird vom System verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="e2b90-110">The actual writing to the file on disk is handled by the system.</span></span> <span data-ttu-id="e2b90-111">Die Daten werden nicht tatsächlich zu dem Zeitpunkt übertragen, zu dem das Datei Mapping-Objekt geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="e2b90-111">Data is not actually transferred at the time the file mapping object is written to.</span></span> <span data-ttu-id="e2b90-112">Stattdessen wird ein Großteil der Dateieingabe und-Ausgabe (e/a) zwischengespeichert, um die allgemeine Systemleistung zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="e2b90-112">Instead, much of the file input and output (I/O) is cached to improve general system performance.</span></span> <span data-ttu-id="e2b90-113">Anwendungen können dieses Verhalten überschreiben, indem Sie die [**flushviewoffile**](/windows/win32/api/memoryapi/nf-memoryapi-flushviewoffile) -Funktion aufrufen, um die sofortige Ausführung von Datenträger Transaktionen durch das System zu erzwingen.</span><span class="sxs-lookup"><span data-stu-id="e2b90-113">Applications can override this behavior by calling the [**FlushViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-flushviewoffile) function to force the system to perform disk transactions immediately.</span></span>

<span data-ttu-id="e2b90-114">Die [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) -Funktion funktioniert genau wie die [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) -Funktion, mit der Ausnahme, dass Sie es einem Prozess ermöglicht, die Basisadresse der Dateiansicht im virtuellen Adressraum des Prozesses im *lpvBase* -Parameter anzugeben.</span><span class="sxs-lookup"><span data-stu-id="e2b90-114">The [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) function works exactly like the [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) function except that it allows a process to specify the base address of the view of the file in the process's virtual address space in the *lpvBase* parameter.</span></span> <span data-ttu-id="e2b90-115">Wenn an der angegebenen Adresse nicht genügend Speicherplatz vorhanden ist, tritt ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="e2b90-115">If there is not enough space at the specified address, the call fails.</span></span> <span data-ttu-id="e2b90-116">Wenn Sie also eine Datei derselben Adresse in mehreren Prozessen zuordnen müssen, sollten die Prozesse eine entsprechende Adresse aushandeln: der *lpvBase* -Parameter muss ein ganzzahliges Vielfaches der Granularität der systemarbeitsspeicherbelegung sein, oder der-Rückruf schlägt fehl.</span><span class="sxs-lookup"><span data-stu-id="e2b90-116">Therefore, if you must map a file to the same address in multiple processes, the processes should negotiate an appropriate address: The *lpvBase* parameter must be an integral multiple of the system memory allocation granularity or the call fails.</span></span> <span data-ttu-id="e2b90-117">Verwenden Sie die [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) -Funktion, die die Elemente einer [**System \_ Informations**](/windows/win32/api/sysinfoapi/ns-sysinfoapi-system_info) Struktur füllt, um die Granularität der Speicher Belegung des Systems zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="e2b90-117">To obtain the system's memory allocation granularity, use the [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) function, which fills in the members of a [**SYSTEM\_INFO**](/windows/win32/api/sysinfoapi/ns-sysinfoapi-system_info) structure.</span></span>

<span data-ttu-id="e2b90-118">Eine Anwendung kann mehrere Datei Sichten aus demselben Datei Mapping-Objekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="e2b90-118">An application can create multiple file views from the same file mapping object.</span></span> <span data-ttu-id="e2b90-119">Eine Dateiansicht kann eine andere Größe aufweisen als das Datei Zuordnungsobjekt, von dem Sie abgeleitet ist, aber Sie muss kleiner als das Datei Zuordnungsobjekt sein.</span><span class="sxs-lookup"><span data-stu-id="e2b90-119">A file view can be a different size than the file mapping object from which it is derived, but it must be smaller than the file mapping object.</span></span> <span data-ttu-id="e2b90-120">Der Offset, der von den Parametern *dwoffsethigh* und *dwoffsetlow* von [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) angegeben wird, muss ein Vielfaches der Zuordnungs Granularität des Systems sein.</span><span class="sxs-lookup"><span data-stu-id="e2b90-120">The offset specified by the *dwOffsetHigh* and *dwOffsetLow* parameters of [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) must be a multiple of the allocation granularity of the system.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e2b90-121">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="e2b90-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e2b90-122">Erstellen einer Ansicht in einer Datei</span><span class="sxs-lookup"><span data-stu-id="e2b90-122">Creating a View Within a File</span></span>](creating-a-view-within-a-file.md)
</dt> </dl>

 

 
