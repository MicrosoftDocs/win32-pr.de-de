---
title: Benutzerkontensteuerung für Spieleentwickler
description: In diesem Artikel werden die Richtlinien und bewährten Methoden für Spieleentwickler beschrieben, die mit dem in Windows Vista eingeführten Sicherheits Feature der Benutzerkontensteuerung (User Account Control, UAC) effektiv arbeiten.
ms.assetid: dbac1c07-73dd-f2bc-3c5c-d6160368a88f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57d5533a3fbdd349cc25dfde501a234bbd7b05b1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104390625"
---
# <a name="user-account-control-for-game-developers"></a><span data-ttu-id="ad71a-103">Benutzerkontensteuerung für Spieleentwickler</span><span class="sxs-lookup"><span data-stu-id="ad71a-103">User Account Control for Game Developers</span></span>

<span data-ttu-id="ad71a-104">In diesem Artikel werden die Richtlinien und bewährten Methoden für Spieleentwickler beschrieben, die mit dem in Windows Vista eingeführten Sicherheits Feature der Benutzerkontensteuerung (User Account Control, UAC) effektiv arbeiten.</span><span class="sxs-lookup"><span data-stu-id="ad71a-104">This article describes the guidelines and best practices for game developers to work effectively with the User Account Control (UAC) security feature introduced in Windows Vista.</span></span>

-   [<span data-ttu-id="ad71a-105">Übersicht über die Benutzerkontensteuerung</span><span class="sxs-lookup"><span data-stu-id="ad71a-105">Overview of User Account Control</span></span>](#overview-of-user-account-control)
-   [<span data-ttu-id="ad71a-106">Benutzerkonten in Windows Vista</span><span class="sxs-lookup"><span data-stu-id="ad71a-106">User Accounts in Windows Vista</span></span>](#user-accounts-in-windows-vista)
-   [<span data-ttu-id="ad71a-107">Dateizugriff als Standard Benutzer</span><span class="sxs-lookup"><span data-stu-id="ad71a-107">File Access as a Standard User</span></span>](#file-access-as-a-standard-user)
-   [<span data-ttu-id="ad71a-108">Registrierungs Zugriff als Standard Benutzer</span><span class="sxs-lookup"><span data-stu-id="ad71a-108">Registry Access as a Standard User</span></span>](#registry-access-as-a-standard-user)
-   [<span data-ttu-id="ad71a-109">Rechteerweiterungen</span><span class="sxs-lookup"><span data-stu-id="ad71a-109">Privilege Elevation</span></span>](#privilege-elevation)
-   [<span data-ttu-id="ad71a-110">UAC-Implikationen mit "kreateprocess ()"</span><span class="sxs-lookup"><span data-stu-id="ad71a-110">UAC Implications with CreateProcess()</span></span>](#uac-implications-with-createprocess)
-   [<span data-ttu-id="ad71a-111">Festlegen der Ausführungs Ebene im Anwendungs Manifest</span><span class="sxs-lookup"><span data-stu-id="ad71a-111">Setting the Execution Level in the Application Manifest</span></span>](#setting-the-execution-level-in-the-application-manifest)
-   [<span data-ttu-id="ad71a-112">Einbetten eines Manifests in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ad71a-112">Embedding a Manifest in Visual Studio</span></span>](#embedding-a-manifest-in-visual-studio)
-   [<span data-ttu-id="ad71a-113">UAC-Kompatibilität mit älteren spielen</span><span class="sxs-lookup"><span data-stu-id="ad71a-113">UAC Compatibility with Older Games</span></span>](#uac-compatibility-with-older-games)
-   [<span data-ttu-id="ad71a-114">Legacy Szenarios und Manifeste</span><span class="sxs-lookup"><span data-stu-id="ad71a-114">Legacy Scenarios and Manifests</span></span>](#legacy-scenarios-and-manifests)
-   [<span data-ttu-id="ad71a-115">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="ad71a-115">Conclusion</span></span>](#conclusion)
-   [<span data-ttu-id="ad71a-116">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="ad71a-116">Further Reading</span></span>](#further-reading)

## <a name="overview-of-user-account-control"></a><span data-ttu-id="ad71a-117">Übersicht über die Benutzerkontensteuerung</span><span class="sxs-lookup"><span data-stu-id="ad71a-117">Overview of User Account Control</span></span>

<span data-ttu-id="ad71a-118">Die in Windows Vista eingeführte Benutzerkontensteuerung (User Account Control, UAC) ist ein Sicherheits Feature, das dazu dient, böswillige Angreifer daran zu hindern, Schwachstellen oder Fehler in häufig verwendeten Anwendungen zu verwenden, um das Betriebssystem oder andere installierte Programme zu ändern.</span><span class="sxs-lookup"><span data-stu-id="ad71a-118">User Account Control (UAC), introduced in Windows Vista, is a security feature that is designed to help prevent malicious attackers from using weaknesses or bugs found in widely-used applications to alter the operating system or other installed programs.</span></span> <span data-ttu-id="ad71a-119">Dies wird erreicht, indem die meisten Programme und Prozesse als Standard Benutzer (auch als eingeschränkter Benutzer, eingeschränkter Benutzer oder Least-Privileged Benutzer bezeichnet) ausgeführt werden, auch wenn das Konto des aktuellen Benutzers über Administrator Anmelde Informationen verfügt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-119">This is accomplished by running the vast majority of programs and processes as a Standard User (also known as a Limited User, Restricted User, or Least-Privileged User) even if the current user's account has administrative credentials.</span></span> <span data-ttu-id="ad71a-120">Ein Prozess mit Standardbenutzer Berechtigungen weist viele inhärente Einschränkungen auf, die eine systemweite Änderung verhindern.</span><span class="sxs-lookup"><span data-stu-id="ad71a-120">A process with standard user privileges has many inherent restrictions that prevent it from making system-wide changes.</span></span>

<span data-ttu-id="ad71a-121">UAC ist auch für die Berechtigungs Erweiterung eines Prozesses mithilfe eines dialogbasierten Authentifizierungs Schemas verantwortlich, das bei der Ausführung bestimmter Prozesse initiiert wurde, die als erforderliches Administrator Recht festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="ad71a-121">UAC is also responsible for privilege elevation of a process by use of a dialog-based, authentication scheme initiated upon execution of certain processes that are designated as requiring administrative privileges.</span></span> <span data-ttu-id="ad71a-122">Die Rechte Erweiterung ermöglicht es Administratoren, die Mehrzahl Ihrer Anwendungen auf einer sicheren Berechtigungsebene (identisch mit allen anderen Standard Benutzern) auszuführen, aber auch Prozesse und Vorgänge zuzulassen, für die Administratorrechte erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="ad71a-122">Privilege elevation allows administrators to run the majority of their applications at a safe privilege level (the same as any other standard user), but also allow processes and operations that require administrative privileges.</span></span> <span data-ttu-id="ad71a-123">UAC unterstützt die Authentifizierung über die Schulter, sodass ein Administrator einem Programm erweiterte Berechtigungen erteilen kann, während ein Standardbenutzer zurzeit beim System angemeldet ist.</span><span class="sxs-lookup"><span data-stu-id="ad71a-123">UAC supports over-the-shoulder authentication so that an administrator can grant elevated privileges to a program while a standard user is currently logged onto the system.</span></span>

<span data-ttu-id="ad71a-124">Die UAC-Funktion ist standardmäßig aktiviert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-124">The UAC feature is enabled by default.</span></span> <span data-ttu-id="ad71a-125">Es ist zwar möglich, dass ein Administrator die systemweite UAC-systemweite deaktiviert, aber dies hat eine Reihe negativer Auswirkungen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-125">While it is possible for an administrator to disable UAC system-wide, doing so has a number of negative ramifications.</span></span> <span data-ttu-id="ad71a-126">Erstens wird die Sicherheit aller Administrator Konten dadurch geschwächt, dass alle Prozesse mit Administrator Anmelde Informationen ausgeführt werden, selbst wenn Sie von den meisten Anwendungen nicht tatsächlich benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-126">First, this weakens the security of all administrative accounts, as all processes would be run with administrative credentials, even when most applications do not actually require them.</span></span> <span data-ttu-id="ad71a-127">Wenn UAC deaktiviert ist, kann eine Standardbenutzer Anwendung, die eine ausnutzbare Sicherheitslücke in der Sicherheit verfügbar macht, zum stehlen privater Informationen, zum Installieren von Rootkits oder Spyware, zum zerstören der Systemintegrität oder zum Hosten von Zombie Angriffen auf anderen Systemen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-127">With UAC disabled, a standard user application that exposes an exploitable vulnerability in security can potentially be used to steal private information, install rootkits or spyware, destroy the system integrity, or host zombie attacks on other systems.</span></span> <span data-ttu-id="ad71a-128">Während bei aktivierter Benutzerkontensteuerung die Mehrzahl der Software als Standardbenutzer ausgeführt wird, werden die potenziellen Schäden durch einen solchen Fehler erheblich eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-128">Whereas with UAC enabled, running the majority of software as a standard user greatly limits the potential damage from such a bug.</span></span> <span data-ttu-id="ad71a-129">Zweitens werden bei der Deaktivierung der Benutzerkontensteuerung viele der Problem Umgehungen für die Anwendungs Kompatibilität deaktiviert, mit denen echte Standardbenutzer eine große Bandbreite von Anwendungen erfolgreich ausführen können.</span><span class="sxs-lookup"><span data-stu-id="ad71a-129">Secondly, turning off UAC disables many of the workarounds for application compatibility that allow true standard users to successfully run a broad range of applications.</span></span> <span data-ttu-id="ad71a-130">Das Deaktivieren von UAC sollte nie als Kompatibilitätsproblem Umgehung empfohlen werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-130">Disabling UAC should never be recommended as a compatibility workaround.</span></span>

<span data-ttu-id="ad71a-131">Es ist wichtig zu beachten, dass Anwendungen nur dann die Standardbenutzer Rechte verwenden sollten, wenn dies möglich ist.</span><span class="sxs-lookup"><span data-stu-id="ad71a-131">It is important to note that applications should strive to only use standard user rights if at all possible.</span></span> <span data-ttu-id="ad71a-132">Administratoren können die Berechtigungen eines Prozesses zwar problemlos erhöhen, die Erhöhung erfordert jedoch immer noch Benutzerinteraktion und-Bestätigung, wenn eine Anwendung ausgeführt wird, für die administrative Anmelde Informationen erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="ad71a-132">While administrators can easily elevate the privileges of a process, the elevation still requires user interaction and acknowledgement every time that an application is run that requires administrative credentials.</span></span> <span data-ttu-id="ad71a-133">Diese Erhöhung muss auch zu dem Zeitpunkt erfolgen, zu dem das Programm gestartet wird. Wenn Sie also administrative Anmelde Informationen auch für einen einzelnen Vorgang benötigen, ist es erforderlich, dass das System für die gesamte laufende Laufzeit der Anwendung stärker gefährdet wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-133">This elevation must also be done at the time that the program starts, so requiring administrative credentials   even for a single operation   requires exposing the system to greater risk for the entire running time of the application.</span></span> <span data-ttu-id="ad71a-134">Standard Benutzer, die keine Rechte haben, ihre Berechtigungen zu erhöhen, sind auch in den Einstellungen für Familie und Geschäftsumgebungen üblich.</span><span class="sxs-lookup"><span data-stu-id="ad71a-134">Standard users without any ability to elevate their privileges are also common in family and business settings.</span></span> <span data-ttu-id="ad71a-135">"Als Administrator ausführen" ist keine gute Lösung für die Kompatibilität, macht dem Benutzer und dem System ein höheres Sicherheitsrisiko und führt in vielen Fällen zu einer Frustration für Benutzer.</span><span class="sxs-lookup"><span data-stu-id="ad71a-135">"Run As Administrator" is not a good workaround for compatibility, exposes the user and the system to greater security risk, and creates frustration for users in many situations.</span></span>

> [!Note]  
> <span data-ttu-id="ad71a-136">Das in Windows Vista eingeführte Feature "Benutzerkontensteuerung" ist auch in Windows 7 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ad71a-136">The User Account Control feature introduced in Windows Vista is also present in Windows 7.</span></span> <span data-ttu-id="ad71a-137">Obwohl die Benutzererfahrung bei der Arbeit mit den verschiedenen Systemfunktionen in Bezug auf die Benutzerkontensteuerung verbessert wurde, sind die Auswirkungen auf Anwendungen im Grunde genommen identisch.</span><span class="sxs-lookup"><span data-stu-id="ad71a-137">While the user experience working with the various system features has been improved with respect to User Account Control, the impact on applications is basically the same.</span></span> <span data-ttu-id="ad71a-138">Alle Windows Vista-Empfehlungen in diesem Artikel gelten auch für Windows 7.</span><span class="sxs-lookup"><span data-stu-id="ad71a-138">All of the Windows Vista recommendations in this article apply to Windows 7 as well.</span></span> <span data-ttu-id="ad71a-139">Ausführliche Informationen zu den Änderungen der UAC-Benutzeroberfläche für Windows 7 finden Sie unter [Benutzeroberfläche-Dialog Informationen zur Benutzerkontensteuerung](../win7appqual/user-interface---user-account-control-dialog-updates.md).</span><span class="sxs-lookup"><span data-stu-id="ad71a-139">For details on the UAC UI changes for Windows 7, see [User Interface - User Account Control Dialog Updates](../win7appqual/user-interface---user-account-control-dialog-updates.md).</span></span>

 

## <a name="user-accounts-in-windows-vista"></a><span data-ttu-id="ad71a-140">Benutzerkonten in Windows Vista</span><span class="sxs-lookup"><span data-stu-id="ad71a-140">User Accounts in Windows Vista</span></span>

<span data-ttu-id="ad71a-141">In Windows Vista werden alle Benutzer in zwei Benutzerkonto Typen kategorisiert: Administratoren und Standardbenutzer.</span><span class="sxs-lookup"><span data-stu-id="ad71a-141">Windows Vista categorizes every user into two user account types: administrators and standard users.</span></span>

<span data-ttu-id="ad71a-142">Ein Standardbenutzer Konto ähnelt einem eingeschränkten Benutzerkonto in Windows XP.</span><span class="sxs-lookup"><span data-stu-id="ad71a-142">A standard user account is similar to a limited-user account in Windows XP.</span></span> <span data-ttu-id="ad71a-143">Wie in Windows XP kann ein Standardbenutzer nicht in den Ordner "Programme" schreiben, kann nicht in den lokalen HKEY \_ \_ -Computerbereich der Registrierung schreiben und kann keine Aufgaben ausführen, die das System ändern, wie z. b. das Installieren eines Kernelmodustreibers oder das Zugreifen auf Systemebene-Prozess Räume.</span><span class="sxs-lookup"><span data-stu-id="ad71a-143">Like in Windows XP, a standard user cannot write to the Program Files folder, cannot write to the HKEY\_LOCAL\_MACHINE portion of the registry, and cannot perform tasks that alter the system, such as installing a kernel-mode driver or accessing system-level process spaces.</span></span>

<span data-ttu-id="ad71a-144">Das Administrator Konto wurde seit der Veröffentlichung von Windows XP erheblich geändert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-144">The Administrator account has significantly changed since Windows XP was released.</span></span> <span data-ttu-id="ad71a-145">Bisher erhielten alle Prozesse, die von einem Mitglied der Gruppe "Administratoren" gestartet wurden, Administratorrechte.</span><span class="sxs-lookup"><span data-stu-id="ad71a-145">Previously, all processes launched by a member of the Administrators group were given administrative privileges.</span></span> <span data-ttu-id="ad71a-146">Wenn UAC aktiviert ist, werden alle Prozesse mit Standardbenutzer Berechtigungen ausgeführt, sofern diese nicht ausdrücklich von einem Administrator herauf gestuft werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-146">With UAC enabled, all processes execute with standard user privileges, unless specifically elevated by an administrator.</span></span> <span data-ttu-id="ad71a-147">Dieser Unterschied bewirkt, dass Konten in der Administratoren Gruppe sicherer werden, indem das Sicherheitsrisiko reduziert wird, das durch potenzielle Fehler in den meisten Programmen verursacht wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-147">This difference makes accounts in the Administrators group more secure by reducing the security risk posed by potential bugs in most programs.</span></span>

<span data-ttu-id="ad71a-148">Es ist wichtig, dass alle Anwendungen, insbesondere Spiele, effektiv und verantwortungsvoll arbeiten, wenn Sie als Standardbenutzer Prozess ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-148">It is important that all applications, especially games, operate effectively and responsibly when run as a standard user process.</span></span> <span data-ttu-id="ad71a-149">Alle Vorgänge, für die Administratorrechte erforderlich sind, sollten entweder zur Installationszeit oder durch Hilfsprogramme erfolgen, die explizit administrative Anmelde Informationen anfordern.</span><span class="sxs-lookup"><span data-stu-id="ad71a-149">All operations that require administrative privileges should be done either at installation time or by auxiliary programs that explicitly request administrative credentials.</span></span> <span data-ttu-id="ad71a-150">Obwohl die Rechte Erweiterung für ein Mitglied der Gruppe "Administratoren" Recht einfach ist, müssen Standardbenutzer eine Person mit Administrator Anmelde Informationen zur physischen Eingabe Ihres Kennworts zur Erhöhung der Berechtigungen zurückstellen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-150">While privilege elevation is fairly trivial for a member of the Administrators group, standard users must defer to someone with administrative credentials to physically enter their password to elevate privileges.</span></span> <span data-ttu-id="ad71a-151">Da Konten, die von Eltern Kontrollen geschützt sind, Standardbenutzer sein müssen, ist dies eine gängige Situation für Spieler, die Windows Vista verwenden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-151">Since accounts protected by parental controls must be standard users, this will be a very common situation for gamers who are using Windows Vista.</span></span>

<span data-ttu-id="ad71a-152">Wenn Ihr Spiel bereits unter Windows XP mit eingeschränkten Benutzerkonten funktioniert, sollte der Umstieg auf die Benutzerkontensteuerung unter Windows Vista sehr einfach sein.</span><span class="sxs-lookup"><span data-stu-id="ad71a-152">If your game is already working on Windows XP with limited-user accounts, then the move to User Account Control on Windows Vista should be very easy.</span></span> <span data-ttu-id="ad71a-153">Der Großteil dieser Anwendungen funktioniert unverändert, obwohl das Hinzufügen eines Anwendungs Manifests dringend empfohlen wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-153">The majority of such applications will work as-is, although adding an application manifest is highly recommended.</span></span> <span data-ttu-id="ad71a-154">(Manifeste werden weiter unten in diesem Thema unter [Festlegen der Ausführungs Ebene im Anwendungs Manifest](#setting-the-execution-level-in-the-application-manifest)beschrieben.)</span><span class="sxs-lookup"><span data-stu-id="ad71a-154">(Manifests are described later in this topic in [Setting the Execution Level in the Application Manifest](#setting-the-execution-level-in-the-application-manifest).)</span></span>

## <a name="file-access-as-a-standard-user"></a><span data-ttu-id="ad71a-155">Dateizugriff als Standard Benutzer</span><span class="sxs-lookup"><span data-stu-id="ad71a-155">File Access as a Standard User</span></span>

<span data-ttu-id="ad71a-156">Der Aspekt Ihres Spiels, der am meisten von Standardbenutzer Einschränkungen betroffen ist, ist die Dateisystem Organisation und Barrierefreiheit.</span><span class="sxs-lookup"><span data-stu-id="ad71a-156">The aspect of your game most affected by standard user restrictions is file system organization and accessibility.</span></span> <span data-ttu-id="ad71a-157">Sie sollten niemals davon ausgehen, dass Ihr Spieldateien in den Ordner schreiben kann, in dem das Spiel installiert ist.</span><span class="sxs-lookup"><span data-stu-id="ad71a-157">You should never assume that your game can write files to the folder where your game is installed.</span></span> <span data-ttu-id="ad71a-158">In Windows Vista muss beispielsweise eine Benutzer Berechtigung vom Betriebssystem erhöht werden, damit eine Anwendung in den Ordner "Programme" schreiben kann.</span><span class="sxs-lookup"><span data-stu-id="ad71a-158">In Windows Vista for instance, a user s privileges must be elevated by the operating system before an application can write to the Program Files folder.</span></span> <span data-ttu-id="ad71a-159">Um dies zu vermeiden, sollten Sie die Datendateien Ihres Spiels nach Bereich und Barrierefreiheit kategorisieren und die [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) -Funktion zusammen mit den CSIDL-Konstanten, die von der Windows-Shell bereitgestellt werden, verwenden, um die entsprechenden Dateipfade zu generieren.</span><span class="sxs-lookup"><span data-stu-id="ad71a-159">To avoid this, you should categorize your game s data files by scope and accessibility, and use the [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) function, along with the CSIDL constants provided by the Windows shell, to generate the appropriate file paths.</span></span> <span data-ttu-id="ad71a-160">Die CSIDL-Konstanten entsprechen bekannten Ordnern im Dateisystem, die vom Betriebssystem verwendet und für die Partitionierung globaler und Benutzer spezifischer Dateien herauf gestuft werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-160">The CSIDL constants correspond to known folders in the file system that the operating system uses and promotes to partition global and user-specific files.</span></span>

<span data-ttu-id="ad71a-161">Der Versuch, eine Datei oder ein Verzeichnis in einem Ordner zu erstellen oder zu schreiben, der keine Schreib Berechtigung für den Prozess gewährt, schlägt unter Windows Vista fehl, wenn die Anwendung nicht über Administratorrechte verfügt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-161">Attempting to create or write a file or directory under a folder which does not grant write permission to the process will fail under Windows Vista if the application does not have administrative privileges.</span></span> <span data-ttu-id="ad71a-162">Wenn die ausführbare 32-Bit-Spiel Datei im Legacy Modus ausgeführt wird, weil Sie keine angeforderte Ausführungs Ebene deklariert hat, sind Ihre Schreibvorgänge erfolgreich, aber Sie werden der Virtualisierung unterzogen, wie im Abschnitt "UAC-Kompatibilität mit älteren spielen" weiter unten in diesem Artikel beschrieben.</span><span class="sxs-lookup"><span data-stu-id="ad71a-162">If your 32-bit game executable is running in legacy mode, because it did not declare a requested execution level, its write operations will succeed, but they will be subjected to virtualization as described in the section "UAC Compatibility with Older Games" later in this article.</span></span>

<span data-ttu-id="ad71a-163">**Tabelle 1. Bekannte Ordner**</span><span class="sxs-lookup"><span data-stu-id="ad71a-163">**Table 1. Known Folders**</span></span>



| <span data-ttu-id="ad71a-164">CSIDL-Name</span><span class="sxs-lookup"><span data-stu-id="ad71a-164">CSIDL Name</span></span>             | <span data-ttu-id="ad71a-165">Typischer Pfad (Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="ad71a-165">Typical Path (Windows Vista)</span></span>                                                   | <span data-ttu-id="ad71a-166">Standard Benutzerrechte</span><span class="sxs-lookup"><span data-stu-id="ad71a-166">Standard User Rights</span></span> | <span data-ttu-id="ad71a-167">Administratorrechte</span><span class="sxs-lookup"><span data-stu-id="ad71a-167">Administrator Rights</span></span> | <span data-ttu-id="ad71a-168">Zugriffsbereich</span><span class="sxs-lookup"><span data-stu-id="ad71a-168">Access Scope</span></span> | <span data-ttu-id="ad71a-169">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="ad71a-169">Description</span></span>                                                                                                                      | <span data-ttu-id="ad71a-170">Beispiele</span><span class="sxs-lookup"><span data-stu-id="ad71a-170">Examples</span></span>                                                          |
|------------------------|--------------------------------------------------------------------------------|----------------------|----------------------|--------------|----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|
| <span data-ttu-id="ad71a-171">CSIDL \_ Personal</span><span class="sxs-lookup"><span data-stu-id="ad71a-171">CSIDL\_PERSONAL</span></span>        | <span data-ttu-id="ad71a-172">C: \\ Benutzer \\ Benutzername \\ Dokumente</span><span class="sxs-lookup"><span data-stu-id="ad71a-172">C:\\Users\\user name\\Documents</span></span>                                                | <span data-ttu-id="ad71a-173">Lesen/Schreiben</span><span class="sxs-lookup"><span data-stu-id="ad71a-173">Read/Write</span></span>           | <span data-ttu-id="ad71a-174">Lesen/Schreiben</span><span class="sxs-lookup"><span data-stu-id="ad71a-174">Read/Write</span></span>           | <span data-ttu-id="ad71a-175">Per-User</span><span class="sxs-lookup"><span data-stu-id="ad71a-175">Per-User</span></span>     | <span data-ttu-id="ad71a-176">Benutzerspezifische Spieldateien, die gelesen und geändert werden und außerhalb des Spiel Kontexts bearbeitet werden können.</span><span class="sxs-lookup"><span data-stu-id="ad71a-176">User-specific game files that are read and modified and can be manipulated outside of the game context.</span></span>                          | <span data-ttu-id="ad71a-177">Bildschirmaufnahmen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-177">Screen shots.</span></span> <span data-ttu-id="ad71a-178">Die Spieldateien wurden mit einer Datei Erweiterungs Zuordnung gespeichert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-178">Saved game files with a file extension association.</span></span> |
| <span data-ttu-id="ad71a-179">lokale CSIDL- \_ \_ AppData</span><span class="sxs-lookup"><span data-stu-id="ad71a-179">CSIDL\_LOCAL\_APPDATA</span></span>  | <span data-ttu-id="ad71a-180">C: \\ Benutzer \\ Benutzername \\ AppData \\ local</span><span class="sxs-lookup"><span data-stu-id="ad71a-180">C:\\Users\\user name\\AppData\\Local</span></span>                                           | <span data-ttu-id="ad71a-181">Lesen/Schreiben</span><span class="sxs-lookup"><span data-stu-id="ad71a-181">Read/Write</span></span>           | <span data-ttu-id="ad71a-182">Lesen/Schreiben</span><span class="sxs-lookup"><span data-stu-id="ad71a-182">Read/Write</span></span>           | <span data-ttu-id="ad71a-183">Per-User</span><span class="sxs-lookup"><span data-stu-id="ad71a-183">Per-User</span></span>     | <span data-ttu-id="ad71a-184">Benutzerspezifische Spieldateien, die gelesen und geändert werden und nur innerhalb des Spiel Kontexts verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-184">User-specific game files that are read and modified and are of use only within the game context.</span></span>                                 | <span data-ttu-id="ad71a-185">Spiele Cache Dateien.</span><span class="sxs-lookup"><span data-stu-id="ad71a-185">Game cache files.</span></span> <span data-ttu-id="ad71a-186">Player Konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-186">Player configurations.</span></span>                          |
| <span data-ttu-id="ad71a-187">Allgemeine CSIDL- \_ \_ AppData</span><span class="sxs-lookup"><span data-stu-id="ad71a-187">CSIDL\_COMMON\_APPDATA</span></span> | <span data-ttu-id="ad71a-188">C: \\ programmdata</span><span class="sxs-lookup"><span data-stu-id="ad71a-188">C:\\ProgramData</span></span>                                                                | <span data-ttu-id="ad71a-189">Lese-/Schreibzugriff bei Besitzer</span><span class="sxs-lookup"><span data-stu-id="ad71a-189">Read/Write if owner</span></span>  | <span data-ttu-id="ad71a-190">Lesen/Schreiben</span><span class="sxs-lookup"><span data-stu-id="ad71a-190">Read/Write</span></span>           | <span data-ttu-id="ad71a-191">Allen Benutzern</span><span class="sxs-lookup"><span data-stu-id="ad71a-191">All Users</span></span>    | <span data-ttu-id="ad71a-192">Spieldateien, die von einem Benutzer erstellt und von allen Benutzern gelesen werden können.</span><span class="sxs-lookup"><span data-stu-id="ad71a-192">Game files that can be created by a user and read by all users.</span></span> <span data-ttu-id="ad71a-193">Schreibzugriff wird nur dem Ersteller der Datei (Besitzer) gewährt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-193">Write access is granted only to the creator of the file (owner).</span></span> | <span data-ttu-id="ad71a-194">Benutzerprofile</span><span class="sxs-lookup"><span data-stu-id="ad71a-194">User Profiles</span></span>                                                     |
| <span data-ttu-id="ad71a-195">CSIDL- \_ Programm \_ Dateien</span><span class="sxs-lookup"><span data-stu-id="ad71a-195">CSIDL\_PROGRAM\_FILES</span></span>  | <span data-ttu-id="ad71a-196">C: \\ Programmdateien</span><span class="sxs-lookup"><span data-stu-id="ad71a-196">C:\\Program Files</span></span><br/> <span data-ttu-id="ad71a-197">oder</span><span class="sxs-lookup"><span data-stu-id="ad71a-197">or</span></span><br/> <span data-ttu-id="ad71a-198">C: \\ Programmdateien (x86)</span><span class="sxs-lookup"><span data-stu-id="ad71a-198">C:\\Program Files (x86)</span></span> <br/> | <span data-ttu-id="ad71a-199">Nur Lesezugriff</span><span class="sxs-lookup"><span data-stu-id="ad71a-199">Read only</span></span>            | <span data-ttu-id="ad71a-200">Lesen/Schreiben</span><span class="sxs-lookup"><span data-stu-id="ad71a-200">Read/Write</span></span>           | <span data-ttu-id="ad71a-201">Allen Benutzern</span><span class="sxs-lookup"><span data-stu-id="ad71a-201">All Users</span></span>    | <span data-ttu-id="ad71a-202">Statische Spieldateien, die vom Spiel-Installer geschrieben wurden und von allen Benutzern gelesen werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-202">Static game files written by the game s installer that are read by all users.</span></span>                                                    | <span data-ttu-id="ad71a-203">Spiel Ressourcen, z. b. Material und Meshes.</span><span class="sxs-lookup"><span data-stu-id="ad71a-203">Game assets, such as materials and meshes.</span></span>                        |



 

<span data-ttu-id="ad71a-204">Das Spiel wird in der Regel in einem Ordner unter dem Ordner installiert, der durch die CSIDL- \_ Programmdateien-Konstante dargestellt wird \_ .</span><span class="sxs-lookup"><span data-stu-id="ad71a-204">Your game will typically be installed in a folder under the folder represented by the CSIDL\_PROGRAM\_FILES constant.</span></span> <span data-ttu-id="ad71a-205">Dies ist jedoch nicht immer der Fall.</span><span class="sxs-lookup"><span data-stu-id="ad71a-205">However, this is not always the case.</span></span> <span data-ttu-id="ad71a-206">Sie sollten stattdessen einen relativen Pfad aus der ausführbaren Datei verwenden, wenn Sie Pfad Zeichenfolgen zu Dateien oder Verzeichnissen erstellen, die sich unter dem Installationsordner befinden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-206">You should instead use a relative path from your executable file when generating path strings to files or directories located under your installation folder.</span></span>

<span data-ttu-id="ad71a-207">Sie sollten auch von hart codierten Annahmen über die bekannten Ordner Pfade verzichten.</span><span class="sxs-lookup"><span data-stu-id="ad71a-207">You should also refrain from hard-coded assumptions about the known folder paths.</span></span> <span data-ttu-id="ad71a-208">In Windows XP Professional 64-Bit Edition und Windows Vista x64 lautet der Pfad der Programmdateien z. b. c: \\ Program Files (x86) für 32-Bit-Programme und c: \\ Program Files für 64-Bit-Programme.</span><span class="sxs-lookup"><span data-stu-id="ad71a-208">For example, on Windows XP Professional 64-bit Edition and Windows Vista x64, the program files path is C:\\Program Files (x86) for 32-bit programs and C:\\Program Files for 64-bit programs.</span></span> <span data-ttu-id="ad71a-209">Diese bekannten Pfade werden von Windows XP geändert, und Benutzer können den Speicherort für viele dieser Ordner neu konfigurieren und sogar auf verschiedenen Laufwerken suchen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-209">These known paths are changed from Windows XP, and users can reconfigure the location of many of these folders and even locate them on different drives.</span></span> <span data-ttu-id="ad71a-210">Verwenden Sie daher immer die CSIDL-Konstanten, um Verwirrung und potenzielle Probleme zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-210">So, always use the CSIDL constants to avoid confusion and potential problems.</span></span> <span data-ttu-id="ad71a-211">Windows Setup diese bekannten Ordner Speicherorte versteht und die Daten bei der Aktualisierung des Betriebssystems von Windows XP verschieben. im Gegensatz dazu kann die Verwendung von nicht standardmäßigen Speicherorten oder hart codierten Pfaden nach einem Betriebssystem Upgrade fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-211">Windows Setup understands these known folder locations and will move the data when upgrading the operating system from Windows XP; in contrast, use of non-standard locations or hard-coded paths may well fail after an OS upgrade.</span></span>

<span data-ttu-id="ad71a-212">Die geringfügigen Nutzbarkeits Unterschiede zwischen den benutzerspezifischen Ordnern, die durch CSIDL \_ Personal und CSIDL \_ local \_ AppData angegeben werden, sollten berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-212">Attention should be given to the subtle usability differences between the user-specific folders specified by CSIDL\_PERSONAL and CSIDL\_LOCAL\_APPDATA.</span></span> <span data-ttu-id="ad71a-213">Die empfohlene Vorgehensweise zum Auswählen der zum Schreiben einer Datei zu verwendenden CSIDL-Konstante besteht darin, CSIDL persönlich zu verwenden \_ , wenn der Benutzer mit der Datei interagieren soll, z. b. durch Doppelklicken darauf, um ihn in einem Tool oder einer Anwendung zu öffnen, und für die Verwendung von lokalen APPDATA (CSIDL) \_ \_ für andere Dateien.</span><span class="sxs-lookup"><span data-stu-id="ad71a-213">The recommended practice for selecting the CSIDL constant to use for writing a file is to use CSIDL\_PERSONAL if the user is expected to interact with the file, such as double-clicking on it to open it in a tool or application, and to use CSIDL\_LOCAL\_APPDATA for other files.</span></span> <span data-ttu-id="ad71a-214">Beide Ordner können von Ihrer Anwendung genutzt werden, um benutzerspezifische Datendateien zu speichern und zu organisieren, da es keinen Unterschied in Bezug auf den Zugriffs Bereich oder die Berechtigungsebene gibt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-214">Both folders can be leveraged by your application to store and organize user-specific data files, as there is no difference in their access scope or privilege level.</span></span> <span data-ttu-id="ad71a-215">Es sollte darauf geachtet werden, Pfadnamen zu erstellen, die eindeutig genug sind, um nicht mit anderen Anwendungen zu kollidieren, aber kurz genug, um die Anzahl der Zeichen im vollständigen Pfad kleiner als der Wert von "Max \_ path, 260" beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="ad71a-215">Care should be taken to create path names that are unique enough to not collide with other applications, but short enough to keep the number of characters in the full path fewer than the value of MAX\_PATH, 260.</span></span>

<span data-ttu-id="ad71a-216">Der folgende Code enthält ein Beispiel für das Schreiben einer Datei in einen bekannten Ordner:</span><span class="sxs-lookup"><span data-stu-id="ad71a-216">The following code provides an example of how to write a file to a known folder:</span></span>

``` syntax
#include <windows.h>
#include <shlobj.h>
#include <shlwapi.h>
        ...
        ...
        ...
        TCHAR strPath[MAX_PATH];
        if( SUCCEEDED(
        SHGetFolderPath( NULL, CSIDL_PERSONAL, NULL, SHGFP_TYPE_CURRENT, strPath ) ) )
        {
        PathAppend( strPath, TEXT( "Company Name\\Title" ) );

        if( !PathFileExists( strPath ) )
        {
        if( ERROR_SUCCESS != SHCreateDirectoryEx( NULL, strPath, NULL ) )
        return E_FAIL;
        }

        PathAppend( strPath, TEXT( "gamefile.txt" ) );

        // strPath is now something like:
        // C:\Users\<current user>\Documents\Company Name\Title\gamefile.txt
        // Open the file for writing
        HANDLE hFile = CreateFile(strPath, GENERIC_WRITE, NULL, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);

        if( INVALID_HANDLE_VALUE != hFile )
        {
        // TODO: Write to file
        CloseHandle(hFile);
        }
        }
```

## <a name="registry-access-as-a-standard-user"></a><span data-ttu-id="ad71a-217">Registrierungs Zugriff als Standard Benutzer</span><span class="sxs-lookup"><span data-stu-id="ad71a-217">Registry Access as a Standard User</span></span>

<span data-ttu-id="ad71a-218">Der Registrierungs Zugriff durch einen Standardbenutzer ist auf ähnliche Weise wie das Dateisystem eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-218">Registry access by a standard user is restricted in a similar fashion as the file system.</span></span> <span data-ttu-id="ad71a-219">Einem Standardbenutzer ist Lesezugriff auf alle Schlüssel in der Registrierung gestattet. der Schreibzugriff wird jedoch nur der \_ \_ HKCU-Unterstruktur (HKEY Current User) gewährt, die der benutzerspezifischen \_ \\ Sicherheits-ID (SID) des aktuellen Benutzers intern zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-219">A standard user is permitted read access to all keys in the registry; however, write access is only granted to the HKEY\_CURRENT\_USER (HKCU) subtree, which is mapped internally to the user-specific subkey HKEY\_USERS\\Security ID (SID) of current user.</span></span> <span data-ttu-id="ad71a-220">Eine Anwendung, die in einen anderen Registrierungs Speicherort als HKEY Current User schreiben muss, \_ \_ benötigt Administratorrechte.</span><span class="sxs-lookup"><span data-stu-id="ad71a-220">An application that needs to write to any registry location other than HKEY\_CURRENT\_USER requires administrative privileges.</span></span>

<span data-ttu-id="ad71a-221">Wenn die 32-Bit-Anwendung im Manifest keine angeforderte Ausführungs Ebene enthält, werden alle Schreibvorgänge in HKEY ( \_ lokale \_ Computer Software) \\ virtualisiert, während Schreibvorgänge an anderen Speicherorten außerhalb des aktuellen HKEY- \_ \_ Benutzers fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-221">If the 32-bit application does not contain a requested execution level in its manifest, then all writes to HKEY\_LOCAL\_MACHINE\\Software will be virtualized, while writes to other locations outside of HKEY\_CURRENT\_USER will fail.</span></span>

<span data-ttu-id="ad71a-222">Das Speichern persistenter Daten in der Registrierung, wie z. b. die Konfiguration eines Benutzers, wird nicht empfohlen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-222">Storing persistent data in the registry, like a user's configuration, is not recommended.</span></span> <span data-ttu-id="ad71a-223">Die bevorzugte Methode zum Speichern persistenter Daten aus dem Spiel besteht darin, die Daten in das Dateisystem zu schreiben, indem Sie [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) aufrufen und den Wert einer CSIDL-Konstante abrufen, die im vorherigen Abschnitt beschrieben wurde.</span><span class="sxs-lookup"><span data-stu-id="ad71a-223">The preferred method of storing persistent data from your game is to write the data to the file system by calling [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) and to get the value of a CSIDL constant, described in the previous section.</span></span>

## <a name="privilege-elevation"></a><span data-ttu-id="ad71a-224">Rechteerweiterungen</span><span class="sxs-lookup"><span data-stu-id="ad71a-224">Privilege Elevation</span></span>

<span data-ttu-id="ad71a-225">In Windows Vista muss jede Anwendung, für die Administratorrechte erforderlich sind, eine Anforderung für eine administrative Ausführungs Ebene im Manifest deklarieren (im nächsten Abschnitt [Festlegen der Ausführungs Ebene im Anwendungs Manifest](#setting-the-execution-level-in-the-application-manifest)).</span><span class="sxs-lookup"><span data-stu-id="ad71a-225">In Windows Vista, any application that requires administrative privileges must declare a request for an administrative execution level in its manifest (described in the next section, [Setting the Execution Level in the Application Manifest](#setting-the-execution-level-in-the-application-manifest)).</span></span>

<span data-ttu-id="ad71a-226">Erhöhte Rechte sind das Verfahren, das von der Benutzerkontensteuerung zum herauf Stufen eines Prozesses zu einem administrativen Prozess gesteuert wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-226">Elevation, as it is known, is the procedure driven by UAC to promote a process to an administrative process.</span></span> <span data-ttu-id="ad71a-227">Die Berechtigungen eines Prozesses können nur zur Erstellungszeit erhöht werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-227">The privileges of a process can only be elevated at creation time.</span></span> <span data-ttu-id="ad71a-228">Nach der Erstellung wird ein Prozess nie auf eine höhere Berechtigungsstufe herauf gestuft.</span><span class="sxs-lookup"><span data-stu-id="ad71a-228">Once created, a process will never be promoted to a higher privilege level.</span></span> <span data-ttu-id="ad71a-229">Aus diesem Grund.</span><span class="sxs-lookup"><span data-stu-id="ad71a-229">For this reason.</span></span> <span data-ttu-id="ad71a-230">Vorgänge, für die administrative Anmelde Informationen erforderlich sind, sollten in separaten Installationsprogrammen und anderen Hilfsprogrammen isoliert werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-230">operations that require administrative credentials should be isolated to separate installers and other auxiliary programs.</span></span>

<span data-ttu-id="ad71a-231">Bei der Ausführung eines Programms prüft UAC die angeforderte Ausführungs Ebene im Manifest. wenn erhöhte Rechte erforderlich sind, wird der aktuelle Benutzer von einem von zwei Standard Dialogfeldern aufgefordert: eine für einen Standardbenutzer und eine für einen Administrator.</span><span class="sxs-lookup"><span data-stu-id="ad71a-231">Upon execution of a program, UAC inspects the requested execution level in the manifest, and if elevated privileges are required, prompts the current user with one of two standard dialog boxes: one for a standard user and one for an administrator.</span></span>

<span data-ttu-id="ad71a-232">Wenn der aktuelle Benutzer ein Standardbenutzer ist, fordert UAC den Benutzer zur Eingabe der Anmelde Informationen eines Administrators auf, bevor die Ausführung des Programms zugelassen wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-232">If the current user is a standard user, UAC prompts the user for the credentials of an administrator before allowing the program to run.</span></span>

<span data-ttu-id="ad71a-233">**Abbildung 1. Eingabeaufforderung für einen Standard Benutzer zur Eingabe von Anmelde Informationen für ein Administrator Konto**</span><span class="sxs-lookup"><span data-stu-id="ad71a-233">**Figure 1. Prompt for a Standard User to enter credentials for an administrative account**</span></span>

![Eingabeaufforderung für einen Standardbenutzer zur Eingabe von Anmelde Informationen für ein Administrator Konto](images/uac-prompt-elevation.jpg)

<span data-ttu-id="ad71a-235">Wenn der aktuelle Benutzer ein Administrator ist, fordert UAC den Benutzer zur Eingabe der Berechtigung auf, bevor das Programm ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="ad71a-235">If the current user is an administrator, UAC prompts the user for permission before allowing the program to run.</span></span>

<span data-ttu-id="ad71a-236">**Abbildung 2. Auffordern des Administrators, Änderungen am Computer zu autorisieren**</span><span class="sxs-lookup"><span data-stu-id="ad71a-236">**Figure 2. Prompt for an Administrator to authorize changes to the computer**</span></span>

![auffordern des Administrators, Änderungen am Computer zu autorisieren](images/uac-prompt-authorization.jpg)

<span data-ttu-id="ad71a-238">Der Anwendung werden nur Administratorrechte erteilt, wenn ein Standardbenutzer die richtigen Administratorrechte bereitstellt oder ein Administrator die Bestätigung erteilt. alles andere bewirkt, dass die Anwendung beendet wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-238">The application will only be granted administrative privileges if a standard user provides the proper administrative credentials or an administrative user provides acknowledgement; anything else will cause the application to terminate.</span></span>

<span data-ttu-id="ad71a-239">Es ist wichtig zu beachten, dass ein Prozess mit erhöhten Rechten als Administrator ausgeführt wird, der Anmelde Informationen in die UAC-Eingabeaufforderung eingegeben hat, anstatt als Standardbenutzer, der aktuell angemeldet ist.</span><span class="sxs-lookup"><span data-stu-id="ad71a-239">It is important to note that a process with elevated privileges runs as the administrative user who entered credentials in the UAC prompt rather than as the standard user who is currently logged in.</span></span> <span data-ttu-id="ad71a-240">Dies ähnelt **runas** in Windows XP beim erweiterten Prozess werden die Ordner-und Registrierungsschlüssel des Administrators beim Zugriff auf benutzerspezifische Daten abgerufen, und alle Programme, die vom erweiterten Prozess gestartet werden, erben sowohl die Administratorrechte als auch die Benutzerkonten.</span><span class="sxs-lookup"><span data-stu-id="ad71a-240">This is similar to **RunAs** in Windows XP   the elevated process gets the administrator's folder and registry keys when accessing per-user data, and all programs that the elevated process launches also inherit both the administrative rights and user account locations.</span></span> <span data-ttu-id="ad71a-241">Für Administratoren, die zur Bestätigung aufgefordert werden (**fortfahren** oder **Abbrechen**), entsprechen diese Standorte den Speicherorten des aktuellen Benutzers.</span><span class="sxs-lookup"><span data-stu-id="ad71a-241">For administrators who are prompted for acknowledgement (**Continue** or **Cancel**), these locations will match the currently user's locations.</span></span> <span data-ttu-id="ad71a-242">Im Allgemeinen sollten Prozesse, die erhöhte Rechte erfordern, jedoch nicht auf benutzerspezifische Daten angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-242">In general, however, processes that require elevation should not operate on per-user data.</span></span> <span data-ttu-id="ad71a-243">Beachten Sie, dass sich dies erheblich auf die Funktionsweise Ihres Installers auswirken kann!</span><span class="sxs-lookup"><span data-stu-id="ad71a-243">Note that this can substantially affect how your installer must operate!</span></span> <span data-ttu-id="ad71a-244">Wenn das Installationsprogramm, das als Administrator ausgeführt wird, in HKCU oder das Profil eines Benutzers schreibt, ist es möglicherweise sehr gut, an den falschen Speicherort zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="ad71a-244">If the installer, running as an administrator, writes to HKCU or to a user's profile, it may very well be writing to the wrong location.</span></span> <span data-ttu-id="ad71a-245">Sie sollten diese pro-Benutzer-Werte bei der ersten Durchführung des Spiels erstellen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-245">Consider creating these per-user values upon the first run of the game.</span></span>

## <a name="uac-implications-with-createprocess"></a><span data-ttu-id="ad71a-246">UAC-Implikationen mit "kreateprocess ()"</span><span class="sxs-lookup"><span data-stu-id="ad71a-246">UAC Implications with CreateProcess()</span></span>

<span data-ttu-id="ad71a-247">Der UAC-Erweiterungsmechanismus wird nicht durch einen Aufruf der Win32-Funktion " [**deateprocess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)()" aufgerufen, um eine ausführbare Datei zu starten, die so konfiguriert ist, dass Sie eine höhere Ausführungs Ebene als der aktuelle Prozess erfordert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-247">The UAC elevation mechanism will not be invoked from a call to the Win32 [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)() function to start an executable which is configured to require a higher execution level than the current process.</span></span> <span data-ttu-id="ad71a-248">Dies führt dazu, dass der Aufrufen von " **anateprocess**()" fehlschlägt, wenn " [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror)()" die erforderliche Erhöhung des Fehlers zurückgibt \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="ad71a-248">As a result, the call to **CreateProcess**() will fail with [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror)() returning ERROR\_ELEVATION\_REQUIRED.</span></span> <span data-ttu-id="ad71a-249">" **Deateprocess**()" ist nur erfolgreich, wenn die Ausführungs Ebene des aufgerufenen gleich oder kleiner ist als die des Aufrufers.</span><span class="sxs-lookup"><span data-stu-id="ad71a-249">**CreateProcess**() will only succeed when the execution level of the callee is equal-to or less-than that of the caller.</span></span> <span data-ttu-id="ad71a-250">Ein Prozess ohne erhöhte Rechte, der erweiterte Prozesse erzeugen muss, sollte dies mithilfe der [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea)()-Funktion bewirken, was bewirkt, dass der UAC-Erweiterungsmechanismus mithilfe der Shell ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-250">A non-elevated process that must spawn elevated processes should do so using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea)() function, which will cause the UAC elevation mechanism to be triggered by means of the shell.</span></span>

## <a name="setting-the-execution-level-in-the-application-manifest"></a><span data-ttu-id="ad71a-251">Festlegen der Ausführungs Ebene im Anwendungs Manifest</span><span class="sxs-lookup"><span data-stu-id="ad71a-251">Setting the Execution Level in the Application Manifest</span></span>

<span data-ttu-id="ad71a-252">Sie deklarieren die angeforderte Ausführungs Ebene des Spiels, indem Sie dem Anwendungs Manifest eine Erweiterung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-252">You declare the requested execution level of your game by adding an extension to the application s manifest.</span></span> <span data-ttu-id="ad71a-253">Der folgende XML-Code zeigt die minimale Konfiguration, die erforderlich ist, um die Ausführungs Ebene für eine Anwendung festzulegen:</span><span class="sxs-lookup"><span data-stu-id="ad71a-253">The following XML code shows the minimal configuration required to set the execution level for an application:</span></span>

``` syntax
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <ms_asmv2:trustInfo xmlns:ms_asmv2="urn:schemas-microsoft-com:asm.v2">
        <ms_asmv2:security>
            <ms_asmv2:requestedPrivileges>
                <ms_asmv2:requestedExecutionLevel level="asInvoker" uiAccess="false" />
            </ms_asmv2:requestedPrivileges>
        </ms_asmv2:security>
    </ms_asmv2:trustInfo>
</assembly>
```

<span data-ttu-id="ad71a-254">Im vorangehenden Code wird das Betriebssystem darüber informiert, dass das Spiel nur Standardbenutzer Berechtigungen mit dem folgenden Tag erfordert:</span><span class="sxs-lookup"><span data-stu-id="ad71a-254">In the preceding code, the operating system is informed that the game only requires standard user privileges by the following tag:</span></span>

``` syntax
<ms_asmv2:requestedExecutionLevel level="asInvoker" uiAccess="false" />
```

<span data-ttu-id="ad71a-255">Durch explizites Festlegen von requestedExecutionLevel auf "asInvoker" wird in diesem Beispiel dem Betriebssystem bestätigt, dass sich das Spiel ohne Administratorrechte ordnungsgemäß verhält.</span><span class="sxs-lookup"><span data-stu-id="ad71a-255">By explicitly setting requestedExecutionLevel to "asInvoker", this example asserts to the operating system that the game will behave properly without administrative privileges.</span></span> <span data-ttu-id="ad71a-256">Folglich deaktiviert UAC die Virtualisierung und führt das Spiel mit denselben Berechtigungen wie der aufrufende Instanz aus, bei dem es sich in der Regel um Standardbenutzer Berechtigungen handelt, da Windows Explorer als Standardbenutzer ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-256">As a result, UAC disables virtualization and runs the game with the same privileges as the invoker   which is typically standard user privileges, since Windows Explorer runs as standard user.</span></span>

<span data-ttu-id="ad71a-257">Das Betriebssystem kann darüber informiert werden, dass ein Spiel eine Erhöhung der Administratorrechte erfordert, indem "asInvoker" durch "requiumministrator" ersetzt wird, um das folgende Tag zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="ad71a-257">The operating system can be informed a game requires elevation to administrative privileges by replacing "asInvoker" with "requireAdministrator", to create the following tag:</span></span>

``` syntax
<ms_asmv2:requestedExecutionLevel level="requireAdministrator" uiAccess="false" />
```

<span data-ttu-id="ad71a-258">Bei dieser Konfiguration fordert das Betriebssystem den aktuellen Benutzer bei jedem Ausführen des Spiels zu einer der standardmäßigen UAC-Erweiterungs Dialogfelder auf.</span><span class="sxs-lookup"><span data-stu-id="ad71a-258">With this configuration, the operating system prompts the current user with one of the standard UAC elevation dialogs every time that the game is executed.</span></span> <span data-ttu-id="ad71a-259">Es wird dringend empfohlen, dass kein Spiel Administratorrechte für die Durchführung erfordert, da dieses Dialogfeld nicht nur schnell lästig wird, sondern auch das Spiel mit den Eltern Steuerelementen nicht kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="ad71a-259">It is highly recommended that no game require administrator privileges to run, because not only will this dialog quickly become annoying, but it also makes the game incompatible with parental controls.</span></span> <span data-ttu-id="ad71a-260">Stellen Sie sich vor dem Hinzufügen dieser Anforderung zu einer ausführbaren Datei vor.</span><span class="sxs-lookup"><span data-stu-id="ad71a-260">Think very carefully before adding this requirement to any executable.</span></span>

<span data-ttu-id="ad71a-261">Ein gängiges Missverständnis besteht darin, dass durch Hinzufügen eines Manifests, das requestedExecutionLevel auf "requisionministrator" festlegt, der Bedarf an einer Eingabeaufforderung mit erhöhten Rechten umgangen wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-261">A common misconception is that adding a manifest that sets requestedExecutionLevel to "requireAdministrator" bypasses the need for an elevation prompt.</span></span> <span data-ttu-id="ad71a-262">Das ist falsch.</span><span class="sxs-lookup"><span data-stu-id="ad71a-262">This is not true.</span></span> <span data-ttu-id="ad71a-263">Sie hindert das Betriebssystem einfach daran zu erraten, ob Ihre Setup-oder Update Anwendung Administratorrechte benötigt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-263">It simply prevents the operating system from guessing whether your setup or update application needs administrative privileges.</span></span> <span data-ttu-id="ad71a-264">Der Benutzer wird weiterhin aufgefordert, Rechte Erweiterungen zu autorisieren.</span><span class="sxs-lookup"><span data-stu-id="ad71a-264">The user is still prompted to authorize elevation.</span></span>

<span data-ttu-id="ad71a-265">Die Signatur einer Anwendung, die für die Rechte Erweiterung markiert ist, wird von Windows überprüft, bevor die UAC-Eingabeaufforderung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-265">Windows checks the signature of any application that is marked for elevation before it displays the UAC prompt.</span></span> <span data-ttu-id="ad71a-266">Eine große ausführbare Datei, die für die Rechte Erweiterung markiert ist, dauert länger als eine kleine ausführbare Datei und länger als eine ausführbare Datei, die als "asInvoker" gekennzeichnet ist.</span><span class="sxs-lookup"><span data-stu-id="ad71a-266">A large executable that is marked for elevation takes longer to check than a small executable and longer than an executable that is marked as "asInvoker".</span></span> <span data-ttu-id="ad71a-267">Ausführbare Setup Dateien, die selbst extrahiert werden, sollten daher als "asInvoker" gekennzeichnet werden, und jeder Teil, der als "requiumministrator" markiert werden muss, sollte in einer separaten Hilfsdatei für das Hilfsprogramm abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-267">Setup executables that are self-extracting should, therefore, be marked as "asInvoker", and any portion that needs to be marked as "requireAdministrator" should be placed in a separate helper executable.</span></span>

<span data-ttu-id="ad71a-268">Das UIAccess-Attribut, das in den vorangehenden Beispielen gezeigt wird, sollte für Spiele immer false sein.</span><span class="sxs-lookup"><span data-stu-id="ad71a-268">The uiAccess attribute, shown in the preceding examples, should always be FALSE for games.</span></span> <span data-ttu-id="ad71a-269">Dieses Attribut gibt an, ob Benutzeroberflächenautomatisierungs-Clients Zugriff auf die Benutzeroberfläche des geschützten Systems haben. Dies hat besondere Auswirkungen auf die Sicherheit, wenn auf true festgelegt</span><span class="sxs-lookup"><span data-stu-id="ad71a-269">This attribute specifies whether UI automation clients have access to the protected system UI, and it has special security implications if set to TRUE.</span></span>

## <a name="embedding-a-manifest-in-visual-studio"></a><span data-ttu-id="ad71a-270">Einbetten eines Manifests in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ad71a-270">Embedding a Manifest in Visual Studio</span></span>

<span data-ttu-id="ad71a-271">Die Manifest-Unterstützung wurde zunächst zu Visual Studio hinzugefügt, beginnend bei VS2005.</span><span class="sxs-lookup"><span data-stu-id="ad71a-271">Manifest support was first added to Visual Studio beginning in VS2005.</span></span> <span data-ttu-id="ad71a-272">Standardmäßig wird für eine ausführbare Datei, die in Visual Studio 2005 (oder höher) erstellt wurde, im Rahmen des Buildprozesses ein automatisch generiertes Manifest eingebettet.</span><span class="sxs-lookup"><span data-stu-id="ad71a-272">By default, an executable built in Visual Studio 2005 (or newer) will have an auto-generated manifest embedded in it as part of the build process.</span></span> <span data-ttu-id="ad71a-273">Der Inhalt des automatisch generierten Manifests ist von bestimmten Projekt Konfigurationen abhängig, die Sie im Dialogfeld Projekteigenschaften angeben.</span><span class="sxs-lookup"><span data-stu-id="ad71a-273">The contents of the auto-generated manifest are dependent on certain project configurations that you specify in the project properties dialog.</span></span>

<span data-ttu-id="ad71a-274">Das Manifest, das von Visual Studio 2005 automatisch generiert wird, enthält keinen <trustInfo> Block, da es keine Möglichkeit gibt, die UAC-Ausführungs Ebene in den Projekteigenschaften zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="ad71a-274">The manifest that is auto-generated by Visual Studio 2005 will not contain a <trustInfo> block as there is no way to configure the UAC execution level in the project properties.</span></span> <span data-ttu-id="ad71a-275">Die bevorzugte Methode zum Hinzufügen dieser Informationen besteht darin, VS2005 ein benutzerdefiniertes Manifest mit dem <trustInfo> Block mit dem automatisch generierten Manifest zusammenzuführen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-275">The preferred way to add this information is to let VS2005 merge a user-defined manifest containing the <trustInfo> block with the auto-generated manifest.</span></span> <span data-ttu-id="ad71a-276">Dies ist so einfach wie das Hinzufügen einer \* Manifest-Datei zu ihrer Projekt Mappe, die die im vorherigen Abschnitt aufgeführten XML-Daten enthält.</span><span class="sxs-lookup"><span data-stu-id="ad71a-276">This is as simple as adding a \*.manifest file to your solution that contains the XML listed in the previous section.</span></span> <span data-ttu-id="ad71a-277">Wenn Visual Studio auf eine Manifest-Datei in der Projekt Mappe trifft, wird automatisch das Manifest-Tool (mt.exe) aufgerufen, um die Manifest-Dateien mit der automatisch generierten Datei zusammenzuführen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-277">When Visual Studio encounters a .manifest file in your solution, it will automatically invoke the Manifest Tool (mt.exe) to merge the .manifest files with the auto-generated one.</span></span>

> [!Note]  
> <span data-ttu-id="ad71a-278">Im Manifest-Tool (mt.exe), das von Visual Studio 2005 bereitgestellt wird, ist ein Fehler aufgetreten, der zu einem zusammengeführten und eingebetteten Manifest führt, das Probleme verursachen kann, wenn die ausführbare Datei unter Windows XP vor SP3 ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-278">There is a bug in the Manifest Tool (mt.exe) provided by Visual Studio 2005 that results in a merged and embedded manifest which can cause problems when the executable is run on Windows XP prior to SP3.</span></span> <span data-ttu-id="ad71a-279">Der Fehler ist darauf zurückzuführen, wie das Tool den Standard Namespace bei der Deklaration des <trustInfo> Blocks neu definiert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-279">The bug is a result of how the tool redefines the default namespace upon declaration of the <trustInfo> block.</span></span> <span data-ttu-id="ad71a-280">Glücklicherweise ist es einfach, das Problem vollständig zu umgehen, indem Sie explizit einen anderen Namespace im <trustInfo> Block deklarieren und die untergeordneten Knoten auf den neuen Namespace umleiten.</span><span class="sxs-lookup"><span data-stu-id="ad71a-280">Fortunately, it is easy to bypass the issue entirely by explicitly declaring a different namespace in the <trustInfo> block and by scoping the child nodes to the new namespace.</span></span> <span data-ttu-id="ad71a-281">Der im vorherigen Abschnitt bereitgestellte XML-Code veranschaulicht diese Korrektur.</span><span class="sxs-lookup"><span data-stu-id="ad71a-281">The XML provided in the previous section demonstrates this fix.</span></span>

 

<span data-ttu-id="ad71a-282">Ein Nachteil bei der Verwendung des mt.exe Tools, das in Visual Studio 2005 enthalten ist, besteht darin, dass bei der Verarbeitung des Blocks eine Warnung generiert wird, <trustInfo> da das Tool kein aktualisiertes Schema zum Validieren des XML-Codes enthält.</span><span class="sxs-lookup"><span data-stu-id="ad71a-282">A caveat in using the mt.exe tool included in Visual Studio 2005 is that it will generate a warning when processing the <trustInfo> block as the tool does not contain an updated schema to validate the XML against.</span></span> <span data-ttu-id="ad71a-283">Um diese Warnung zu beheben, empfiehlt es sich, alle mt.exe Dateien im Installationsverzeichnis von Visual Studio 2005 (es sind mehrere Instanzen vorhanden) mit den mt.exe zu ersetzen, die im letzten Windows SDK bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-283">To remedy this warning, it is recommended that you replace all mt.exe files under the Visual Studio 2005 install directory (there are multiple instances) with the mt.exe provided in the latest Windows SDK.</span></span>

<span data-ttu-id="ad71a-284">Ab Visual Studio 2008 können Sie nun die Ausführungs Ebene einer Anwendung aus dem Dialogfeld "Projekteigenschaften" (Abbildung 3) oder mit dem/MANIFESTUAC Linker-Flag angeben.</span><span class="sxs-lookup"><span data-stu-id="ad71a-284">Beginning in Visual Studio 2008, you can now specify an application's execution level from within the project properties dialog (Figure 3), or by using the /MANIFESTUAC linker flag.</span></span> <span data-ttu-id="ad71a-285">Das Festlegen dieser Optionen bewirkt, dass Visual Studio 2008 ein Manifest mit dem entsprechenden Block automatisch generiert und <trustInfo> in die ausführbare Datei einbettet.</span><span class="sxs-lookup"><span data-stu-id="ad71a-285">Setting these options will cause Visual Studio 2008 to auto-generate and embed a manifest with the appropriate <trustInfo> block into the executable.</span></span>

<span data-ttu-id="ad71a-286">**Abbildung 3. Festlegen der Ausführungs Ebene in Visual Studio 2008**</span><span class="sxs-lookup"><span data-stu-id="ad71a-286">**Figure 3. Setting the execution level in Visual Studio 2008**</span></span>

![Festlegen der Ausführungs Ebene in Visual Studio 2008](images/setting-execution-level-in-vs2008.jpg)

<span data-ttu-id="ad71a-288">Das Einbetten eines Manifests in älteren Versionen von Visual Studio ohne Unterstützung von Manifests ist weiterhin möglich, erfordert aber mehr Arbeit vom Entwickler.</span><span class="sxs-lookup"><span data-stu-id="ad71a-288">Embedding a manifest in older versions of Visual Studio without manifest support is still possible, but does require more work from the developer.</span></span> <span data-ttu-id="ad71a-289">Ein Beispiel hierfür finden Sie im Visual Studio 2003-Projekt, das in einem beliebigen Beispiel im DirectX SDK vor der Release vom März 2008 enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="ad71a-289">For an example on how to do this, please examine the Visual Studio 2003 project included in any sample in the DirectX SDK prior to the March 2008 release.</span></span>

## <a name="uac-compatibility-with-older-games"></a><span data-ttu-id="ad71a-290">UAC-Kompatibilität mit älteren spielen</span><span class="sxs-lookup"><span data-stu-id="ad71a-290">UAC Compatibility with Older Games</span></span>

<span data-ttu-id="ad71a-291">Wenn das Spiel scheint, eine Datei erfolgreich in das Verzeichnis "Programme" zu speichern und zu laden, aber kein Beweis für die Datei "Windows Vista" ist, wird jede 32-Bit-Anwendung, die keine angeforderte Ausführungs Ebene im Manifest enthält, als ältere Anwendung betrachtet.</span><span class="sxs-lookup"><span data-stu-id="ad71a-291">If your game appears to be saving and loading a file successfully to the Program Files directory, yet no evidence of the file iOn Windows Vista, any 32-bit application that does not contain a requested execution level in its manifest is considered a legacy application.</span></span> <span data-ttu-id="ad71a-292">Vor Windows Vista wurden die meisten Anwendungen normalerweise von Benutzern mit Administratorrechten ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-292">Prior to Windows Vista, most applications were typically run by users with administrative privileges.</span></span> <span data-ttu-id="ad71a-293">Daher konnten diese Anwendungen Systemdateien und Registrierungsschlüssel kostenlos lesen und schreiben, und viele Entwickler haben die Änderungen, die für die ordnungsgemäße Ausführung von eingeschränkten Benutzerkonten unter Windows XP erforderlich waren, nicht vorgenommen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-293">As a result, these applications could freely read and write system files and registry keys, and many developers did not make the changes needed to work properly on Limited User Accounts on Windows XP.</span></span> <span data-ttu-id="ad71a-294">Bei Windows Vista würden diese Anwendungen jedoch aufgrund unzureichender Zugriffsrechte unter dem neuen Sicherheitsmodell, das die Standardbenutzer Ausführung für ältere Anwendungen erzwingt, fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-294">However on Windows Vista, these same applications would now fail due to insufficient access privileges under the new security model, which enforces standard user execution for legacy applications.</span></span> <span data-ttu-id="ad71a-295">Um die Auswirkungen dieses Beispiels zu mindern, wurde die Virtualisierung auch Windows Vista hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-295">To mitigate the impact of this, virtualization was also added to Windows Vista.</span></span> <span data-ttu-id="ad71a-296">Durch die Virtualisierung werden Tausende von Legacy Anwendungen in Windows Vista gut funktionieren, ohne dass diese Anwendungen jederzeit über erweiterte Berechtigungen verfügen müssen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-296">Virtualization will keep thousands of legacy applications working well on Windows Vista without requiring those applications to have elevated privileges at all times simply to succeed at a few minor operations.</span></span> <span data-ttu-id="ad71a-297">s gefunden. die Wahrscheinlichkeit ist, dass Ihr Spiel im Legacy Modus ausgeführt wird und Virtualisierung unterliegt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-297">s found, chances are your game is running in legacy mode and was subjected to virtualization.</span></span>

<span data-ttu-id="ad71a-298">Die Virtualisierung wirkt sich auf das Dateisystem und die Registrierung aus, indem systemabhängige Schreibvorgänge (und nachfolgende Datei-oder Registrierungs Vorgänge) an einen benutzerspezifischen Speicherort innerhalb des Profils des aktuellen Benutzers umgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-298">Virtualization affects the file system and registry by redirecting system-sensitive writes (and subsequent file or registry operations) to a per-user location within the current user's profile.</span></span> <span data-ttu-id="ad71a-299">Wenn z. b. eine Anwendung versucht, in die folgende Datei zu schreiben:</span><span class="sxs-lookup"><span data-stu-id="ad71a-299">For example, if an application attempts to write to the following file:</span></span>

<dl> <span data-ttu-id="ad71a-300">C: \\ \\ Unternehmens-namens Titel des Unternehmens \\ \\config.ini</span><span class="sxs-lookup"><span data-stu-id="ad71a-300">C:\\Program Files\\Company Name\\Title\\config.ini</span></span>  
</dl>

<span data-ttu-id="ad71a-301">der Schreibvorgang wird automatisch an Folgendes umgeleitet:</span><span class="sxs-lookup"><span data-stu-id="ad71a-301">the write is automatically redirected to:</span></span>

<dl> <span data-ttu-id="ad71a-302">C: \\ Benutzer \\ Benutzername \\ AppData \\ local \\ virtualstore- \\ Programmdateien \\ Firmenname \\ Titel \\config.ini</span><span class="sxs-lookup"><span data-stu-id="ad71a-302">C:\\Users\\user name\\AppData\\Local\\VirtualStore\\Program Files\\Company Name\\Title\\config.ini</span></span>  
</dl>

<span data-ttu-id="ad71a-303">Ebenso, wenn eine Anwendung versucht, einen Registrierungs Wert wie den folgenden zu schreiben:</span><span class="sxs-lookup"><span data-stu-id="ad71a-303">Likewise, if an application attempts to write a registry value like the following:</span></span>

<dl> <span data-ttu-id="ad71a-304">Name des \_ Unternehmens für lokale HKEY- \_ Computer \\ Software \\ \\</span><span class="sxs-lookup"><span data-stu-id="ad71a-304">HKEY\_LOCAL\_MACHINE\\Software\\Company Name\\Title</span></span>  
</dl>

<span data-ttu-id="ad71a-305">Sie wird stattdessen umgeleitet an:</span><span class="sxs-lookup"><span data-stu-id="ad71a-305">it will be redirected instead to:</span></span>

<dl> <span data-ttu-id="ad71a-306">HKEY \_ Current \_ User \\ Software \\ Classes \\ virtualstore \\ Computer \\ Software \\ Unternehmens Name \\ Titel</span><span class="sxs-lookup"><span data-stu-id="ad71a-306">HKEY\_CURRENT\_USER\\Software\\Classes\\VirtualStore\\MACHINE\\Software\\Company Name\\Title</span></span>  
</dl>

<span data-ttu-id="ad71a-307">Der Zugriff auf Dateien und Registrierungsschlüssel, die von der Virtualisierung betroffen sind, erfolgt nur durch Datei-und Registrierungs Vorgänge von virtualisierten Anwendungen, die als aktueller Benutzer ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-307">Files and registry keys affected by virtualization are only be accessed by file and registry operations from virtualized applications that are running as the current user.</span></span>

<span data-ttu-id="ad71a-308">Es gibt jedoch viele Einschränkungen bei der Virtualisierung.</span><span class="sxs-lookup"><span data-stu-id="ad71a-308">However, there are many restrictions to virtualization.</span></span> <span data-ttu-id="ad71a-309">Eine davon besteht darin, dass 64-Bit-Anwendungen niemals im Legacy Modus für Kompatibilitäts Vorgänge ausgeführt werden, die in 32-Bit-64 Anwendungen für die Virtualisierung unterliegen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-309">One is that 64-bit applications are never run in legacy mode for compatibility   operations subjected to virtualization in 32-bit applications will just fail in 64-bit.</span></span> <span data-ttu-id="ad71a-310">Wenn eine ältere Anwendung, die als Standardbenutzer ausgeführt wird, versucht, eine beliebige ausführbare Datei an einen Speicherort zu schreiben, für den Administrator Anmelde Informationen erforderlich sind, wird die Virtualisierung nicht ausgeführt, und der Schreibvorgang schlägt fehl.</span><span class="sxs-lookup"><span data-stu-id="ad71a-310">Also if a legacy application running as a standard user tries to write any type of executable file to a location that requires administrative credentials, then virtualization will not occur and the write will fail.</span></span>

<span data-ttu-id="ad71a-311">**Abbildung 4. Virtualisierungsprozess**</span><span class="sxs-lookup"><span data-stu-id="ad71a-311">**Figure 4. Virtualization Process**</span></span>

![Virtualisierungsprozess](images/uac-virtualization-process.jpg)

<span data-ttu-id="ad71a-313">Wenn eine Legacy Anwendung einen Lesevorgang für System sensible Speicherorte im Dateisystem oder in der Registrierung versucht, werden zuerst die virtuellen Speicherorte durchsucht.</span><span class="sxs-lookup"><span data-stu-id="ad71a-313">When a legacy application attempts a read operation on system-sensitive locations in the file system or registry, the virtual locations are searched first.</span></span> <span data-ttu-id="ad71a-314">Wenn die Datei oder der Registrierungsschlüssel nicht gefunden wird, greift das Betriebssystem auf die standardmäßigen Systemspeicher Orte zu.</span><span class="sxs-lookup"><span data-stu-id="ad71a-314">If the file or registry key is not found, then the operating system accesses the default system locations.</span></span>

<span data-ttu-id="ad71a-315">Die Virtualisierung wird aus den nachfolgenden Versionen von Windows entfernt, sodass es wichtig ist, dieses Feature nicht zu verlassen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-315">Virtualization will be removed from subsequent versions of Windows so it important not to rely on this feature.</span></span> <span data-ttu-id="ad71a-316">Stattdessen sollten Sie das Anwendungs manifest explizit entweder für Standardbenutzer-oder Administratorrechte konfigurieren, da hierdurch die Virtualisierung deaktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="ad71a-316">Instead, you should explicitly configure your application manifest for either standard user or administrative privileges, as this will disable virtualization.</span></span> <span data-ttu-id="ad71a-317">Die Virtualisierung ist für Endbenutzer auch nicht offensichtlich. Obwohl die Virtualisierung die Anwendung möglicherweise zulässt, kann Sie Support Anrufe generieren und es schwierig machen, Probleme für diese Kunden zu lösen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-317">Virtualization is also not obvious to end users, so even though virtualization may allow your application to run, it can generate support calls and make it difficult to trouble-shoot for these customers.</span></span>

<span data-ttu-id="ad71a-318">Beachten Sie Folgendes: Wenn die UAC deaktiviert ist, wird die Virtualisierung ebenfalls deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-318">Note that if UAC is disabled, then virtualization is also disabled.</span></span> <span data-ttu-id="ad71a-319">Wenn die Virtualisierung deaktiviert ist, Verhalten sich Standardbenutzer Konten genau wie eingeschränkte Benutzerkonten in Windows XP, und ältere Anwendungen funktionieren möglicherweise nicht ordnungsgemäß für Standardbenutzer, die andernfalls aufgrund der Virtualisierung erfolgreich gewesen wären.</span><span class="sxs-lookup"><span data-stu-id="ad71a-319">If virtualization is disabled, standard user accounts behave exactly like limited user accounts in Windows XP, and legacy applications may not function correctly for standard users that would otherwise have succeeded due to virtualization.</span></span>

## <a name="legacy-scenarios-and-manifests"></a><span data-ttu-id="ad71a-320">Legacy Szenarios und Manifeste</span><span class="sxs-lookup"><span data-stu-id="ad71a-320">Legacy Scenarios and Manifests</span></span>

<span data-ttu-id="ad71a-321">Bei den meisten Verwendungs Szenarien ist es einfach, die exe-Datei mit den korrekten UAC-Manifest-Elementen zu markieren und sicherzustellen, dass die Anwendung ordnungsgemäß funktioniert, da ein Standard Benutzer für eine ausgezeichnete UAC-Kompatibilität ausreicht.</span><span class="sxs-lookup"><span data-stu-id="ad71a-321">For the majority of usage scenarios, simply marking the .exe with the correct UAC manifest elements and ensuring the application works correctly as a Standard User is sufficient for excellent UAC compatibility.</span></span> <span data-ttu-id="ad71a-322">Die meisten Spieler führen Windows Vista oder Windows 7 mit aktivierter Benutzerkontensteuerung aus.</span><span class="sxs-lookup"><span data-stu-id="ad71a-322">Most gamers are running Windows Vista or Windows 7 with User Account Control enabled.</span></span> <span data-ttu-id="ad71a-323">Für Windows XP und Benutzer unter Windows Vista oder Windows7 mit deaktivierter Funktion "Benutzerkontensteuerung" werden Sie normalerweise mithilfe von Administrator Konten ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-323">For Windows XP and users on Windows Vista or Windows7 with the User Account Control feature disabled, they typically run using administrator accounts.</span></span> <span data-ttu-id="ad71a-324">Obwohl es sich hierbei um einen weniger sicheren Betriebsmodus handelt, treten in der Regel keine zusätzlichen Kompatibilitätsprobleme auf, obwohl die Deaktivierung der Benutzerkontensteuerung auch die Virtualisierung deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-324">While this is a less secure mode of operation, it will generally not run into any additional compatibility issues although as noted above, disabling UAC disables virtualization as well.</span></span>

<span data-ttu-id="ad71a-325">Es ist ein Sonderfall zu beachten, wenn das Programm im UAC-Manifest als "requisionministrator" gekennzeichnet ist.</span><span class="sxs-lookup"><span data-stu-id="ad71a-325">There is a special case worth noting when the program is marked as "requireAdministrator" in the UAC manifest.</span></span> <span data-ttu-id="ad71a-326">Unter Windows XP und Windows Vista oder Windows 7 mit deaktivierter Benutzerkontensteuerung werden die UAC-Manifest-Elemente vom System ignoriert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-326">On Windows XP and on Windows Vista or Windows 7 with User Account Control disabled, the UAC manifest elements are ignored by the system.</span></span> <span data-ttu-id="ad71a-327">In dieser Situation werden Benutzer mit Administrator Konten immer alle Programme mit vollständigen Administratorrechten ausführen, sodass diese Programme erwartungsgemäß funktionieren.</span><span class="sxs-lookup"><span data-stu-id="ad71a-327">In this situation, users with administrator accounts will always run all programs with full administrator rights, and thus these programs will function as expected.</span></span> <span data-ttu-id="ad71a-328">Eingeschränkte Windows XP-Benutzer und Standard Benutzer, die unter Windows Vista oder Windows 7 ausgeführt werden, führen diese Programme jedoch immer mit eingeschränkten Rechten aus, und alle Vorgänge auf Administratorebene können nicht ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-328">Windows XP Restricted Users and Standard Users running on Windows Vista or Windows 7, however, will always run these programs with restricted rights and all administrator-level operations will fail.</span></span> <span data-ttu-id="ad71a-329">Daher wird empfohlen, dass Programme, die als "Requirements-Administrator" gekennzeichnet sind, [**isuseranadmin**](/windows/win32/api/shlobj_core/nf-shlobj_core-isuseranadmin) beim Start aufrufen und eine schwerwiegende Fehlermeldung anzeigen, wenn Sie false zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="ad71a-329">It is therefore recommended that programs marked as "requiretAdministrator" call [**IsUserAnAdmin**](/windows/win32/api/shlobj_core/nf-shlobj_core-isuseranadmin) on startup, and display a fatal error message if it returns FALSE.</span></span> <span data-ttu-id="ad71a-330">Für das obige Mehrheits Szenario ist dies immer erfolgreich, bietet aber eine bessere Benutzer Darstellung und eine eindeutige Fehlermeldung in dieser seltenen Situation.</span><span class="sxs-lookup"><span data-stu-id="ad71a-330">For the majority scenario above, this will always succeed, but provides a better user experience and a clear error message for this rare situation.</span></span>

## <a name="conclusion"></a><span data-ttu-id="ad71a-331">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="ad71a-331">Conclusion</span></span>

<span data-ttu-id="ad71a-332">Als Spielentwickler für die mehr Benutzerumgebung von Windows ist es zwingend erforderlich, dass Sie Ihr Spiel so entwerfen, dass es effektiv und verantwortungsvoll funktioniert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-332">As a game developer targeting the Windows multi-user environment, it is imperative that you design your game to operate effectively and responsibly.</span></span> <span data-ttu-id="ad71a-333">Die ausführbare Hauptdatei des Spiels sollte nicht von Administratorrechten abhängig sein.</span><span class="sxs-lookup"><span data-stu-id="ad71a-333">Your game's main executable file should not be dependent on administrative privileges.</span></span> <span data-ttu-id="ad71a-334">Dies verhindert nicht nur, dass bei jeder Ausführung des Spiels Eingabe Aufforderungen angefordert werden, was sich negativ auf die Gesamt Benutzer Leistung auswirken kann, sondern auch die Nutzung anderer Features, die eine Ausführung mit Standardbenutzer Berechtigungen erfordern, wie z. b. Jugendschutz.</span><span class="sxs-lookup"><span data-stu-id="ad71a-334">This not only prevents the appearance of prompts for elevation every time that your game is run   which can negatively impact the overall user experience   but it also enables your game to take advantage of other features that require execution with standard user privileges, such as Parental Controls.</span></span>

<span data-ttu-id="ad71a-335">Anwendungen, die unter früheren Versionen von Windows ordnungsgemäß für den Betrieb mit den Anmelde Informationen eines Standard Benutzers (oder eines eingeschränkten Benutzers) entworfen wurden, werden von der Benutzerkontensteuerung nicht beeinträchtigt, weil Sie ohne erhöhte Rechte ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-335">Applications that are properly designed to operate as with the credentials of a standard user (or limited user) under previous versions of Windows will not be impacted by UAC   they will run without elevation.</span></span> <span data-ttu-id="ad71a-336">Sie sollten jedoch ein Manifest mit der angeforderten Ausführungs Ebene enthalten, das auf "asInvoker" festgelegt ist, um Anwendungsstandards für Vista zu entsprechen.</span><span class="sxs-lookup"><span data-stu-id="ad71a-336">However, they should include a manifest with their requested execution level set to "asInvoker" to conform to application standards for Vista.</span></span>

## <a name="further-reading"></a><span data-ttu-id="ad71a-337">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="ad71a-337">Further Reading</span></span>

<span data-ttu-id="ad71a-338">Wenn Sie Unterstützung beim Entwerfen von Anwendungen für Windows Vista haben, die mit der Benutzerkontensteuerung kompatibel sind, laden Sie das folgende Whitepaper herunter: [Windows Vista Anwendungs Entwicklungsanforderungen für die Kompatibilität mit der Benutzerkontensteuerung](/previous-versions/dotnet/articles/bb530410(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="ad71a-338">For assistance with designing applications for Windows Vista that are compliant with User Account Control, download the following white paper: [Windows Vista Application Development Requirements for User Account Control Compatibility](/previous-versions/dotnet/articles/bb530410(v=msdn.10)).</span></span>

<span data-ttu-id="ad71a-339">Dieses Whitepaper enthält ausführliche Schritte zum Entwurfsprozess sowie Codebeispiele, Anforderungen und bewährte Methoden.</span><span class="sxs-lookup"><span data-stu-id="ad71a-339">This white paper provides detailed steps about the design process, along with code samples, requirements, and best practices.</span></span> <span data-ttu-id="ad71a-340">Außerdem werden in diesem Artikel die technischen Updates und Änderungen an der Benutzer Darstellung in Windows Vista ausführlich erläutert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-340">This paper also details the technical updates and changes to the user experience in Windows Vista.</span></span>

<span data-ttu-id="ad71a-341">Weitere Informationen zur Benutzerkontensteuerung finden Sie unter [Windows Vista: Benutzerkontensteuerung](https://www.microsoft.com/technet/windowsvista/security/uac.mspx) auf [Microsoft TechNet](https://www.microsoft.com/technet/).</span><span class="sxs-lookup"><span data-stu-id="ad71a-341">For more information about User Account Control, visit [Windows Vista: User Account Control](https://www.microsoft.com/technet/windowsvista/security/uac.mspx) on [Microsoft TechNet](https://www.microsoft.com/technet/).</span></span>

<span data-ttu-id="ad71a-342">Eine weitere nützliche Ressource ist der Artikel [zum Erlernen Ihrer Apps, um mit der Windows Vista-Benutzerkontensteuerung zu](/archive/msdn-magazine/2007/january/teach-your-apps-to-work-with-windows-vista-user-account-control)experimentieren, vom [MSDN Magazine](/archive/msdn-magazine/msdn-magazine-issues), Januar 2007.</span><span class="sxs-lookup"><span data-stu-id="ad71a-342">Another useful resource is the article [Teach Your Apps To Play Nicely with Windows Vista User Account Control](/archive/msdn-magazine/2007/january/teach-your-apps-to-work-with-windows-vista-user-account-control), from [MSDN Magazine](/archive/msdn-magazine/msdn-magazine-issues), January 2007.</span></span> <span data-ttu-id="ad71a-343">In diesem Artikel werden allgemeine Probleme mit der Anwendungs Kompatibilität sowie die Vorteile und Probleme bei der Verwendung von Windows Installer-Paketen unter Windows Vista erläutert.</span><span class="sxs-lookup"><span data-stu-id="ad71a-343">This article discusses general issues of application compatibility, as well as the advantages and issues of using Windows Installer packages on Windows Vista.</span></span>

<span data-ttu-id="ad71a-344">Weitere Informationen zum Fehler und zum Beheben von mt.exe finden Sie im Tool, das von Visual Studio 2005 zum automatischen Zusammenführen und Einbetten eines Manifests in eine ausführbare Datei verwendet wird. Weitere Informationen finden Sie unter unter [Suchen von Manifesten Teil 2: Standardnamespaces und UAC-Manifeste in Windows Vista](https://techcommunity.microsoft.com/t5/Windows-Blog-Archive/bg-p/Windows-Blog-Archive/2006/09/08/exploring-manifests-part-2-default-namespaces-and-uac-manifests-in-windows-vista/) auf der [MSDN](/archive/blogs/)-Website.</span><span class="sxs-lookup"><span data-stu-id="ad71a-344">For more information about the bug and the fix for mt.exe, the tool used by Visual Studio 2005 to automatically merge and embed a manifest into an executable, see [Exploring Manifests Part 2: Default Namespaces and UAC Manifests in Windows Vista](https://techcommunity.microsoft.com/t5/Windows-Blog-Archive/bg-p/Windows-Blog-Archive/2006/09/08/exploring-manifests-part-2-default-namespaces-and-uac-manifests-in-windows-vista/) on Chris Jackson's blog on [MSDN](/archive/blogs/).</span></span>

 

