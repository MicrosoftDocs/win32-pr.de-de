---
title: Nutzen der High-Definition Mausbewegung
description: Dieser Artikel konzentriert sich auf die beste Methode zur Optimierung der Leistung von High-Definition-Maus Eingaben in einem Spiel, wie z. b. einem ersten Mitarbeiter.
ms.assetid: 0138a248-e8e0-a392-564e-7a9229b94b56
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7ebe2abd9487d95b8fe12aa3c6938e21d72d8e2f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104390699"
---
# <a name="taking-advantage-of-high-definition-mouse-movement"></a><span data-ttu-id="dc9d2-103">Nutzen der High-Definition Mausbewegung</span><span class="sxs-lookup"><span data-stu-id="dc9d2-103">Taking Advantage of High-Definition Mouse Movement</span></span>

<span data-ttu-id="dc9d2-104">Eine Standard Computermaus gibt Daten mit 400 Punkten pro Zoll (dpi) zurück, während eine High-Definition-Maus Daten mit 800 dpi oder höher generiert.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-104">A standard computer mouse returns data at 400 dots per inch (DPI), whereas a high-definition mouse generates data at 800 DPI or greater.</span></span> <span data-ttu-id="dc9d2-105">Dadurch wird die Eingabe von einer High-Definition-Maus wesentlich präziser als die von der Standard Maus.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-105">This makes input from a high-definition mouse much more precise than that from a standard mouse.</span></span> <span data-ttu-id="dc9d2-106">Hoch Definitionsdaten können jedoch nicht über die standardmäßigen WM- \_ mouset-Nachrichten abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-106">However, high-definition data cannot be obtained through the standard WM\_MOUSEMOVE messages.</span></span> <span data-ttu-id="dc9d2-107">Im Allgemeinen profitieren Spiele von High-Definition-Maus Geräten, aber Spiele, die mithilfe von WM MouseMove Maus Daten abrufen, \_ können nicht auf die vollständige, ungefilterte Auflösung der Maus zugreifen.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-107">In general, games will benefit from high-definition mouse devices but games that obtain mouse data using just WM\_MOUSEMOVE won't be able to access the full, unfiltered resolution of the mouse.</span></span>

<span data-ttu-id="dc9d2-108">Eine Reihe von Unternehmen ist die Herstellung von High-Definition-Maus Geräten, z. b. Microsoft und Logitech.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-108">A number of companies are manufacturing high-definition mouse devices, such as Microsoft and Logitech.</span></span> <span data-ttu-id="dc9d2-109">Dank der zunehmenden Beliebtheit von Maus Geräten mit hoher Auflösung ist es wichtig, dass Entwickler wissen, wie die von diesen Geräten generierten Informationen optimal verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-109">With the increasing popularity of high-resolution mouse devices, it is important that developers understand how to use the information generated by these devices optimally.</span></span> <span data-ttu-id="dc9d2-110">Dieser Artikel konzentriert sich auf die beste Methode zur Optimierung der Leistung von High-Definition-Maus Eingaben in einem Spiel, wie z. b. einem ersten Mitarbeiter.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-110">This article focuses on the best way to optimize the performance of high-definition mouse input in a game like a first-person shooter.</span></span>

## <a name="retrieving-mouse-movement-data"></a><span data-ttu-id="dc9d2-111">Abrufen von Maus Verschiebungs Daten</span><span class="sxs-lookup"><span data-stu-id="dc9d2-111">Retrieving Mouse Movement Data</span></span>

<span data-ttu-id="dc9d2-112">Im folgenden sind die drei primären Methoden zum Abrufen von Mausdaten aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="dc9d2-112">Here are the three primary methods to retrieve mouse data:</span></span>

-   [<span data-ttu-id="dc9d2-113">WM- \_ mouseelmove</span><span class="sxs-lookup"><span data-stu-id="dc9d2-113">WM\_MOUSEMOVE</span></span>](/windows)
-   [<span data-ttu-id="dc9d2-114">WM- \_ Eingabe</span><span class="sxs-lookup"><span data-stu-id="dc9d2-114">WM\_INPUT</span></span>](/windows)
-   [<span data-ttu-id="dc9d2-115">DirectInput</span><span class="sxs-lookup"><span data-stu-id="dc9d2-115">DirectInput</span></span>](#directinput)

<span data-ttu-id="dc9d2-116">Jede Methode hat vor-und Nachteile, abhängig davon, wie die Daten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-116">There are advantages and disadvantages to each method, depending on how the data will be used.</span></span>

### <a name="wm_mousemove"></a><span data-ttu-id="dc9d2-117">WM- \_ mouseelmove</span><span class="sxs-lookup"><span data-stu-id="dc9d2-117">WM\_MOUSEMOVE</span></span>

<span data-ttu-id="dc9d2-118">Die einfachste Methode zum Lesen von Maus Verschiebungs Daten ist die Verwendung von WM- \_ MouseMove-Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-118">The simplest method of reading mouse movement data is through WM\_MOUSEMOVE messages.</span></span> <span data-ttu-id="dc9d2-119">Im folgenden finden Sie ein Beispiel für das Lesen von Maus Verschiebungs Daten aus der WM- \_ MouseMove-Nachricht:</span><span class="sxs-lookup"><span data-stu-id="dc9d2-119">The following is an example of how to read mouse movement data from the WM\_MOUSEMOVE message:</span></span>

```cpp
case WM_MOUSEMOVE:
{
    int xPosAbsolute = GET_X_PARAM(lParam); 
    int yPosAbsolute = GET_Y_PARAM(lParam);
    // ...
    break;
}
```

<span data-ttu-id="dc9d2-120">Der primäre Nachteil von Daten aus WM- \_ mousmove ist, dass Sie auf die Bildschirmauflösung beschränkt ist.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-120">The primary disadvantage to data from WM\_MOUSEMOVE is that it is limited to the screen resolution.</span></span> <span data-ttu-id="dc9d2-121">Dies bedeutet Folgendes: Wenn Sie die Maus leicht verschieben – aber nicht genug, um den Zeiger auf das nächste Pixel zu bewegen – wird keine WM- \_ MouseMove-Nachricht generiert.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-121">This means that if you move the mouse slightly — but not enough to cause the pointer to move to the next pixel — then no WM\_MOUSEMOVE message is generated.</span></span> <span data-ttu-id="dc9d2-122">Die Verwendung dieser Methode zum Lesen der Mausbewegung negiert die Vorteile der Eingabe von hoch Definitionen.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-122">So, using this method to read mouse movement negates the benefits of high-definition input.</span></span>

<span data-ttu-id="dc9d2-123">Der Vorteil von WM \_ MouseMove besteht jedoch darin, dass Windows Zeiger Beschleunigung (auch als "Ballistik" bezeichnet) auf die rohdatenmausdaten anwendet, wodurch sich der Mauszeiger wie erwartet verhält.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-123">The advantage to WM\_MOUSEMOVE, however, is that Windows applies pointer acceleration (also known as ballistics) to the raw mouse data, which makes the mouse pointer behave as customers expect.</span></span> <span data-ttu-id="dc9d2-124">Dies bewirkt, dass WM \_ MouseMove die bevorzugte Option für das Zeiger Steuerelement (über WM- \_ Eingabe oder DirectInput) ist, da es für Benutzer zu einem natürlicheren Verhalten führt.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-124">This makes WM\_MOUSEMOVE the preferred option for pointer control (over WM\_INPUT or DirectInput), since it results in more natural behavior for users.</span></span> <span data-ttu-id="dc9d2-125">Während WM \_ MouseMove für das Bewegen von Maus Zeigern ideal ist, ist es nicht so gut, eine erste Person Kamera zu verschieben, da die Genauigkeit der hoch Definition verloren geht.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-125">While WM\_MOUSEMOVE is ideal for moving mouse pointers, it is not so good for moving a first-person camera, since the high-definition precision will be lost.</span></span>

<span data-ttu-id="dc9d2-126">Weitere Informationen zu WM \_ mousee Move finden Sie unter [**WM \_ mousee Move**](/windows/desktop/inputdev/wm-mousemove).</span><span class="sxs-lookup"><span data-stu-id="dc9d2-126">For more info about WM\_MOUSEMOVE, see [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove).</span></span>

### <a name="wm_input"></a><span data-ttu-id="dc9d2-127">WM- \_ Eingabe</span><span class="sxs-lookup"><span data-stu-id="dc9d2-127">WM\_INPUT</span></span>

<span data-ttu-id="dc9d2-128">Die zweite Methode zum Abrufen von Maus Daten ist das Lesen von WM- \_ Eingabe Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-128">The second method of obtaining mouse data is to read WM\_INPUT messages.</span></span> <span data-ttu-id="dc9d2-129">Die Verarbeitung von WM \_ -Eingabe Nachrichten ist komplizierter als \_ die Verarbeitung von WM-mouset-Nachrichten, aber WM \_ -Eingabe Nachrichten werden direkt aus dem Eingabegeräte (HID)-Stapel gelesen und spiegeln Ergebnisse der hoch Definition wider.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-129">Processing WM\_INPUT messages is more complicated than processing WM\_MOUSEMOVE messages, but WM\_INPUT messages are read directly from the Human Interface Device (HID) stack and reflect high-definition results.</span></span>

<span data-ttu-id="dc9d2-130">Zum Lesen von Maus Verschiebungs Daten aus der WM- \_ Eingabe Nachricht muss das Gerät zuerst registriert werden. der folgende Code stellt ein Beispiel dafür dar:</span><span class="sxs-lookup"><span data-stu-id="dc9d2-130">To read mouse movement data from the WM\_INPUT message, the device must first be registered; the following code provides an example of this:</span></span>

```cpp
// you can #include <hidusage.h> for these defines
#ifndef HID_USAGE_PAGE_GENERIC
#define HID_USAGE_PAGE_GENERIC         ((USHORT) 0x01)
#endif
#ifndef HID_USAGE_GENERIC_MOUSE
#define HID_USAGE_GENERIC_MOUSE        ((USHORT) 0x02)
#endif

RAWINPUTDEVICE Rid[1];
Rid[0].usUsagePage = HID_USAGE_PAGE_GENERIC; 
Rid[0].usUsage = HID_USAGE_GENERIC_MOUSE; 
Rid[0].dwFlags = RIDEV_INPUTSINK;   
Rid[0].hwndTarget = hWnd;
RegisterRawInputDevices(Rid, 1, sizeof(Rid[0]));
```

<span data-ttu-id="dc9d2-131">Der folgende Code behandelt WM \_ -Eingabe Meldungen im WinProc-Handler der Anwendung:</span><span class="sxs-lookup"><span data-stu-id="dc9d2-131">The following code handles WM\_INPUT messages in the application's WinProc handler:</span></span>

```cpp
case WM_INPUT: 
{
    UINT dwSize = sizeof(RAWINPUT);
    static BYTE lpb[sizeof(RAWINPUT)];

    GetRawInputData((HRAWINPUT)lParam, RID_INPUT, lpb, &dwSize, sizeof(RAWINPUTHEADER));

    RAWINPUT* raw = (RAWINPUT*)lpb;

    if (raw->header.dwType == RIM_TYPEMOUSE) 
    {
        int xPosRelative = raw->data.mouse.lLastX;
        int yPosRelative = raw->data.mouse.lLastY;
    } 
    break;
}
```

<span data-ttu-id="dc9d2-132">Der Vorteil der Verwendung von WM- \_ Eingaben besteht darin, dass Ihr Spiel Rohdaten von der Maus auf der niedrigsten möglichen Ebene empfängt.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-132">The advantage to using WM\_INPUT is that your game receives raw data from the mouse at the lowest level possible.</span></span>

<span data-ttu-id="dc9d2-133">Der Nachteil ist, dass \_ für die WM-Eingabe keine Ballistik auf die Daten angewendet wird. Wenn Sie also einen Cursor mit diesen Daten steuern möchten, ist zusätzlicher Aufwand erforderlich, um den Cursor wie in Windows aussehen zu lassen.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-133">The disadvantage is that WM\_INPUT has no ballistics applied to its data, so if you want to drive a cursor with this data, extra effort will be required to make the cursor behave like it does in Windows.</span></span> <span data-ttu-id="dc9d2-134">Weitere Informationen zum Anwenden von zeigereignis finden Sie unter [Zeiger-Ballistik für Windows XP](https://www.microsoft.com/whdc/archive/pointer-bal.mspx).</span><span class="sxs-lookup"><span data-stu-id="dc9d2-134">For more information about applying pointer ballistics, see [Pointer Ballistics for Windows XP](https://www.microsoft.com/whdc/archive/pointer-bal.mspx).</span></span>

<span data-ttu-id="dc9d2-135">Weitere Informationen zu WM- \_ Eingaben finden Sie unter Informationen [zu](/windows/desktop/inputdev/about-raw-input)unformatierten Eingaben.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-135">For more info about WM\_INPUT, see [About Raw Input](/windows/desktop/inputdev/about-raw-input).</span></span>

### <a name="directinput"></a><span data-ttu-id="dc9d2-136">DirectInput</span><span class="sxs-lookup"><span data-stu-id="dc9d2-136">DirectInput</span></span>

<span data-ttu-id="dc9d2-137">[DirectInput](/windows-hardware/drivers/hid/directinput) ist ein Satz von API-aufrufen, mit denen Eingabegeräte auf dem System abstrahiert werden.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-137">[DirectInput](/windows-hardware/drivers/hid/directinput) is a set of API calls that abstracts input devices on the system.</span></span> <span data-ttu-id="dc9d2-138">Intern erstellt DirectInput einen zweiten Thread zum Lesen von WM \_ -Eingabedaten, und die Verwendung der DirectInput-APIs führt zu mehr Aufwand als das einfache Lesen von WM- \_ Eingaben.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-138">Internally, DirectInput creates a second thread to read WM\_INPUT data, and using the DirectInput APIs will add more overhead than simply reading WM\_INPUT directly.</span></span> <span data-ttu-id="dc9d2-139">DirectInput ist nur für das Lesen von Daten aus DirectInput-Joysticks nützlich. Wenn Sie jedoch nur den Xbox 360-Controller für Windows unterstützen müssen, verwenden Sie stattdessen [xinput](/windows/desktop/xinput/xinput-game-controller-apis-portal) .</span><span class="sxs-lookup"><span data-stu-id="dc9d2-139">DirectInput is only useful for reading data from DirectInput joysticks; however, if you only need to support the Xbox 360 controller for Windows, use [XInput](/windows/desktop/xinput/xinput-game-controller-apis-portal) instead.</span></span> <span data-ttu-id="dc9d2-140">Insgesamt bietet die Verwendung von DirectInput keine Vorteile beim Lesen von Daten von Maus-oder Tastatur Geräten, und die Verwendung von DirectInput in diesen Szenarien wird davon abgeraten.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-140">Overall, using DirectInput offers no advantages when reading data from mouse or keyboard devices, and the use of DirectInput in these scenarios is discouraged.</span></span>

<span data-ttu-id="dc9d2-141">Vergleichen Sie die Komplexität der Verwendung von [DirectInput](/windows-hardware/drivers/hid/directinput), wie im folgenden Code gezeigt, mit den Methoden, die zuvor beschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-141">Compare the complexity of using [DirectInput](/windows-hardware/drivers/hid/directinput), shown in the following code, to the methods previously described.</span></span> <span data-ttu-id="dc9d2-142">Die folgenden Aufrufe sind erforderlich, um eine DirectInput-Maus zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="dc9d2-142">The following set of calls are needed to create a DirectInput mouse:</span></span>

```cpp
LPDIRECTINPUT8 pDI;
LPDIRECTINPUTDEVICE8 pMouse;

hr = DirectInput8Create(GetModuleHandle(NULL), DIRECTINPUT_VERSION, IID_IDirectInput8, (VOID**)&pDI, NULL);
if(FAILED(hr))
    return hr;

hr = pDI->CreateDevice(GUID_SysMouse, &pMouse, NULL);
if(FAILED(hr))
    return hr;

hr = pMouse->SetDataFormat(&c_dfDIMouse2);
if(FAILED(hr))
    return hr;

hr = pMouse->SetCooperativeLevel(hWnd, DISCL_NONEXCLUSIVE | DISCL_FOREGROUND);
if(FAILED(hr))
    return hr;

if(!bImmediate)
{
    DIPROPDWORD dipdw;
    dipdw.diph.dwSize       = sizeof(DIPROPDWORD);
    dipdw.diph.dwHeaderSize = sizeof(DIPROPHEADER);
    dipdw.diph.dwObj        = 0;
    dipdw.diph.dwHow        = DIPH_DEVICE;
    dipdw.dwData            = 16; // Arbitrary buffer size

    if(FAILED(hr = pMouse->SetProperty(DIPROP_BUFFERSIZE, &dipdw.diph)))
        return hr;
}

pMouse->Acquire();
```

<span data-ttu-id="dc9d2-143">Und dann kann das DirectInput-Mausgerät jeden Frame lesen:</span><span class="sxs-lookup"><span data-stu-id="dc9d2-143">And then the DirectInput mouse device can be read each frame:</span></span>

```cpp
DIMOUSESTATE2 dims2; 
ZeroMemory(&dims2, sizeof(dims2));

hr = pMouse->GetDeviceState(sizeof(DIMOUSESTATE2), &dims2);
if(FAILED(hr)) 
{
    hr = pMouse->Acquire();
    while(hr == DIERR_INPUTLOST) 
        hr = pMouse->Acquire();

    return S_OK; 
}

int xPosRelative = dims2.lX;
int yPosRelative = dims2.lY;
```

## <a name="summary"></a><span data-ttu-id="dc9d2-144">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="dc9d2-144">Summary</span></span>

<span data-ttu-id="dc9d2-145">Insgesamt ist die beste Methode zum Empfangen von Daten mit hoher Definitions Datenbewegung "WM \_ Input".</span><span class="sxs-lookup"><span data-stu-id="dc9d2-145">Overall, the best method to receive high-definition mouse movement data is WM\_INPUT.</span></span> <span data-ttu-id="dc9d2-146">Wenn die Benutzer nur einen Mauszeiger bewegen, erwägen Sie die Verwendung von "WM \_ MouseMove", um zu vermeiden, dass Zeiger-ballistiken durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-146">If your users are just moving a mouse pointer, then consider using WM\_MOUSEMOVE to avoid needing to perform pointer ballistics.</span></span> <span data-ttu-id="dc9d2-147">Beide Fenster Meldungen funktionieren auch dann gut, wenn die Maus keine High-Definition-Maus ist.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-147">Both of these window messages will work well even if the mouse isn't a high-definition mouse.</span></span> <span data-ttu-id="dc9d2-148">Durch die Unterstützung hoher Definitionen können Windows-Spiele Benutzern eine präzisere Kontrolle bieten.</span><span class="sxs-lookup"><span data-stu-id="dc9d2-148">By supporting high definition, Windows games can offer more precise control to users.</span></span>