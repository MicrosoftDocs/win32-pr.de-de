---
title: Allgemeine Artikel zum Verbessern von Tiefenkarten für Schatten
description: Dieser technische Artikel bietet einen Überblick über einige gängige schatteneitenzuordnungs Algorithmen und allgemeine Artefakte und erläutert verschiedene Techniken – im Bereich der Schwierigkeit von Basic bis zwischen –, die verwendet werden können, um die Qualität von standardmäßigen Schatten Zuordnungen zu erhöhen.
ms.assetid: bf994838-a261-0379-9301-eb9b250d216c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c8b25507d7f6b8608d4dacf5fab620bc8a3294c7
ms.sourcegitcommit: 218b1ff779402c3ebe1786679e1aa80a5c0d6c95
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/01/2020
ms.locfileid: "103730712"
---
# <a name="common-techniques-to-improve-shadow-depth-maps"></a><span data-ttu-id="6a7b7-103">Allgemeine Artikel zum Verbessern von Tiefenkarten für Schatten</span><span class="sxs-lookup"><span data-stu-id="6a7b7-103">Common Techniques to Improve Shadow Depth Maps</span></span>

<span data-ttu-id="6a7b7-104">Schatten Zuordnungen, die erstmals in 1978 eingeführt wurden, sind ein gängiges Verfahren zum Hinzufügen von Schatten zu spielen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-104">Shadow maps, first introduced in 1978, are a common technique for adding shadows to games.</span></span> <span data-ttu-id="6a7b7-105">Drei Jahrzehnte später, trotz der Fortschritte in Hardware und Software, shadoocken von Artefakten – das heißt, dass sich auch die Kanten, perspektivische und andere Genauigkeits Probleme –</span><span class="sxs-lookup"><span data-stu-id="6a7b7-105">Three decades later, despite advances in hardware and software, shadowing artifacts—namely shimmering edges, perspective aliasing, and other precision issues—persist.</span></span>

<span data-ttu-id="6a7b7-106">Dieser technische Artikel bietet einen Überblick über einige gängige schatteneitenzuordnungs Algorithmen und allgemeine Artefakte und erläutert verschiedene Techniken – im Bereich der Schwierigkeit von Basic bis zwischen –, die verwendet werden können, um die Qualität von standardmäßigen Schatten Zuordnungen zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-106">This technical article provides an overview of some common shadow depth map algorithms and common artifacts, and explains several techniques—ranging in difficulty from basic to intermediate—that can be used to increase the quality of standard shadow maps.</span></span> <span data-ttu-id="6a7b7-107">Das Hinzufügen von grundlegenden Schatten Zuordnungen zu einem Titel ist in der Regel unkompliziert, aber das Verständnis der Nuancen von Schatten Artefakten kann schwierig sein.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-107">Adding basic shadow maps to a title typically is straightforward, but understanding the nuances of shadow artifacts can be challenging.</span></span> <span data-ttu-id="6a7b7-108">Dieser technische Artikel ist für den Entwickler von zwischen Grafiken geschrieben, der Shadows implementiert hat, aber nicht vollständig versteht, warum bestimmte Artefakte angezeigt werden und nicht sicher sind, wie Sie diese umgehen können.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-108">This technical article is written for the intermediate graphics developer who has implemented shadows, but does not fully understand why specific artifacts appear and is not sure how to work around them.</span></span>

<span data-ttu-id="6a7b7-109">Die Auswahl der richtigen Verfahren zum mindern bestimmter Artefakte ist nicht trivial.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-109">Selecting the correct techniques to mitigate specific artifacts is nontrivial.</span></span> <span data-ttu-id="6a7b7-110">Wenn schattenkarten Mängel behandelt werden, kann der Unterschied in der Qualität beeindruckend sein (Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="6a7b7-110">When shadow map shortcomings are addressed, the difference in quality can be impressive (Figure 1).</span></span> <span data-ttu-id="6a7b7-111">Durch eine ordnungsgemäße Implementierung dieser Techniken werden Standard Schatten drastisch verbessert.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-111">Correctly implementing these techniques drastically improves standard shadows.</span></span> <span data-ttu-id="6a7b7-112">Die in diesem Artikel erläuterten Verfahren werden im DirectX SDK im Beispiel CascadedShadowMaps11 implementiert.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-112">The techniques explained in this article are implemented in the sample CascadedShadowMaps11 in the DirectX SDK.</span></span>

<span data-ttu-id="6a7b7-113">**Abbildung 1. Schatten mit schweren Artefakten (links) und Schatten nach der Implementierung der in diesem Artikel beschriebenen Verfahren (right)**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-113">**Figure 1. Shadows with severe artifacts (left), and shadows after implementing the techniques described in this article (right)**</span></span>

![Schatten mit schweren Artefakten (links) und Schatten nach der Implementierung der in diesem Artikel beschriebenen Verfahren (right)](images/shadows-before-and-after.jpg)

## <a name="shadow-depth-maps-review"></a><span data-ttu-id="6a7b7-115">Überprüfung der Schatten Tiefe-Karten</span><span class="sxs-lookup"><span data-stu-id="6a7b7-115">Shadow Depth Maps Review</span></span>

<span data-ttu-id="6a7b7-116">Der Algorithmus für die Schatten Tiefe ist ein zwei-Pass-Algorithmus.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-116">The shadow depth map algorithm is a two-pass algorithm.</span></span> <span data-ttu-id="6a7b7-117">Der erste Durchlauf generiert eine tiefen Zuordnung im Leerraum.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-117">The first pass generates a depth map in light space.</span></span> <span data-ttu-id="6a7b7-118">Im zweiten Durchlauf wird diese Karte verwendet, um die Tiefe der einzelnen Pixel in einem hellen Raum mit der entsprechenden Tiefe in der tiefenkarte für den hellen Raum zu vergleichen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-118">In the second pass, this map is used to compare each pixel's depth in light space against its corresponding depth in the light space depth map.</span></span>

<span data-ttu-id="6a7b7-119">**Abbildung 2. Wichtige Teile einer Schatten Szene**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-119">**Figure 2. Key parts of a shadow scene**</span></span>

![wichtige Teile einer Schatten Szene](images/key-parts-of-shadow-scene.jpg)

### <a name="pass-1"></a><span data-ttu-id="6a7b7-121">Durchlauf 1</span><span class="sxs-lookup"><span data-stu-id="6a7b7-121">Pass 1</span></span>

<span data-ttu-id="6a7b7-122">Die Szene ist in Abbildung 2 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-122">The scene is shown in Figure 2.</span></span> <span data-ttu-id="6a7b7-123">Im ersten Durchlauf (Abbildung 3) wird die Geometrie aus der Sicht des Lichts in einen tiefen Puffer gerendert.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-123">In the first pass (Figure 3), the geometry is rendered into a depth buffer from the point of view of the light.</span></span> <span data-ttu-id="6a7b7-124">Genauer gesagt wandelt der Vertex-Shader die Geometrie in einen Licht Ansichts Bereich um.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-124">More specifically, the vertex shader transforms the geometry into light-view space.</span></span>

<span data-ttu-id="6a7b7-125">Das Endergebnis dieses ersten Durchlauf ist ein tiefen Puffer, der die Tiefeninformationen der Szene aus der Sicht des Lichts enthält.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-125">The end result of this first pass is a depth buffer containing the scene's depth information from the point of view of the light.</span></span> <span data-ttu-id="6a7b7-126">Dies kann nun in Pass 2 verwendet werden, um zu bestimmen, welche Pixel aus dem Licht ausgeblendet werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-126">This now can be used in pass 2 to determine which pixels are occluded from the light.</span></span>

<span data-ttu-id="6a7b7-127">**Abbildung 3. Erster Durchlauf der einfachen Schatten Zuordnung**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-127">**Figure 3. First pass of basic shadow mapping**</span></span>

![erster Durchlauf der einfachen Schatten Zuordnung](images/first-pass-of-basic-hadow-mapping.png)

### <a name="pass-2"></a><span data-ttu-id="6a7b7-129">Durchlauf 2</span><span class="sxs-lookup"><span data-stu-id="6a7b7-129">Pass 2</span></span>

<span data-ttu-id="6a7b7-130">Im zweiten Durchlauf (Abbildung 4) transformiert der Vertex-Shader jeden Scheitelpunkt zweimal.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-130">In the second pass (Figure 4), the vertex shader transforms each vertex twice.</span></span> <span data-ttu-id="6a7b7-131">Jeder Scheitelpunkt wird in den Ansichts Bereich der Kamera transformiert und als Position an den Pixelshader übermittelt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-131">Each vertex is transformed into the camera's view space and passed to the pixel shader as the position.</span></span> <span data-ttu-id="6a7b7-132">Jeder Scheitelpunkt wird auch durch die View-Projection-Texture-Matrix des Lichts transformiert und als Textur Koordinate an den Pixelshader übergeben.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-132">Each vertex is also transformed by the light's view-projection-texture matrix and passed to the pixel shader as a texture coordinate.</span></span> <span data-ttu-id="6a7b7-133">Die Matrix View-Projection-Texture ist dieselbe Matrix, die zum Rendern der Szene in Pass 1 mit einer zusätzlichen Transformation verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-133">The view-projection-texture matrix is the same matrix used to render the scene in pass 1 with one additional transform.</span></span> <span data-ttu-id="6a7b7-134">Dabei handelt es sich um eine Transformation, mit der die Punkte von Ansichts Raum (– 1 auf 1 in x und Y) skaliert und in den Textur Bereich (0 bis 1 in x und 1 bis 0 in Y) übersetzt werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-134">It's a transformation that scales and translates the points from view space (–1 to 1 in X and Y) to texture space (0 to 1 in X and 1 to 0 in Y).</span></span>

<span data-ttu-id="6a7b7-135">Der Pixelshader empfängt die interinterpolierte Position und die interpoliert-Texturkoordinaten.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-135">The pixel shader receives the interpolated position and the interpolated texture coordinates.</span></span> <span data-ttu-id="6a7b7-136">Alles, was für die Ausführung des tiefen Tests benötigt wird, ist jetzt in dieser Textur Koordinate.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-136">Everything needed to perform the depth test is now in this texture coordinate.</span></span> <span data-ttu-id="6a7b7-137">Der tiefen Test kann nun ausgeführt werden, indem der tiefen Puffer aus dem ersten Durchlauf mit den X-und Y-Texturkoordinaten indiziert und der resultierende tiefen Wert mit der Z-Textur Koordinate verglichen wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-137">The depth test can now be performed by indexing the depth buffer from the first pass with the X and Y texture coordinates and comparing the resulting depth value against the Z-texture coordinate.</span></span>

<span data-ttu-id="6a7b7-138">**Abbildung 4. Zweiter Durchlauf der grundlegenden Schatten Zuordnung**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-138">**Figure 4. Second pass of basic shadow mapping**</span></span>

![zweiter Durchlauf der grundlegenden Schatten Zuordnung](images/second-pass-of-basic-shadow-mapping.png)

## <a name="shadow-map-artifacts"></a><span data-ttu-id="6a7b7-140">Schattenkarten Artefakte</span><span class="sxs-lookup"><span data-stu-id="6a7b7-140">Shadow Map Artifacts</span></span>

<span data-ttu-id="6a7b7-141">Der Algorithmus für die schatteneitenzuordnung ist der am häufigsten verwendete echt zeitalgorithmus für Shadowing, erzeugt jedoch immer noch mehrere Artefakte, die eine Entschärfung erfordern.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-141">The shadow depth map algorithm is the most widely used real-time shadowing algorithm, but still produces several artifacts requiring mitigation.</span></span> <span data-ttu-id="6a7b7-142">Die Typen von Artefakten, die auftreten können, werden als nächstes zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-142">The types of artifacts that can occur are summarized next.</span></span>

### <a name="perspective-aliasing"></a><span data-ttu-id="6a7b7-143">Perspektiven Aliasing</span><span class="sxs-lookup"><span data-stu-id="6a7b7-143">Perspective Aliasing</span></span>

<span data-ttu-id="6a7b7-144">Perspektivische Aliasing, ein gängiges artefaktelement, ist in Abbildung 5 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-144">Perspective aliasing, a common artifact, is shown in Figure 5.</span></span> <span data-ttu-id="6a7b7-145">Dies tritt auf, wenn die Zuordnung von Pixeln im Anzeigebereich zu texeln in der Schatten Zuordnung kein eins-zu-eins-Verhältnis ist.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-145">It occurs when the mapping of pixels in view space to texels in the shadow map is not a one-to-one ratio.</span></span> <span data-ttu-id="6a7b7-146">Dies liegt daran, dass Pixel in der Nähe der nahen Ebene einander näher beieinander liegen und eine höhere schattenkarten Auflösung erfordern.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-146">This is because pixels close to the near plane are closer together and require a higher shadow map resolution.</span></span>

<span data-ttu-id="6a7b7-147">Abbildung 6 zeigt eine Schatten Zuordnung und eine Ansicht "Frustum".</span><span class="sxs-lookup"><span data-stu-id="6a7b7-147">Figure 6 shows a shadow map and a view frustum.</span></span> <span data-ttu-id="6a7b7-148">Im Augenblick werden die Pixel näher beieinander angezeigt, und viele Pixel entsprechen denselben Schatten texeln.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-148">Near the eye, the pixels are closer together, and many pixels map to the same shadow texels.</span></span> <span data-ttu-id="6a7b7-149">Die Pixel der äußersten Ebene werden verteilt, wodurch peraliasing der Perspektive reduziert wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-149">The pixels by the far plane are spread out, thereby reducing perspective aliasing.</span></span>

<span data-ttu-id="6a7b7-150">**Abbildung 5. Aliasing in hoher Perspektive (links) im Vergleich zum Aliasing mit niedriger Perspektive (rechts)**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-150">**Figure 5. High-perspective aliasing (left) vs. low-perspective aliasing (right)**</span></span>

![Aliasing in hoher Perspektive (links) im Vergleich zum Aliasing mit niedriger Perspektive (rechts)](images/high-perspective-aliasing-vs-low-perspective-aliasing.jpg)

<span data-ttu-id="6a7b7-152">Für das Bild auf der linken Seite ist das Aliasing der Perspektive höher. zu viele Eye-Space-Pixel sind denselben schattenkarten texeln zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-152">For the image at left, perspective aliasing is higher; too many eye-space pixels map to the same shadow-map texels.</span></span> <span data-ttu-id="6a7b7-153">Im Bild auf der rechten Seite ist das perasing von Perspektiven gering, weil es eine 1:1-Zuordnung zwischen den Augen Raum Pixeln und schattenkarten texeln gibt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-153">In the image at right, perspective aliasing is low because there is a 1:1 mapping between the eye-space pixels and shadow-map texels.</span></span>

<span data-ttu-id="6a7b7-154">**Abbildung 6. Anzeigen von "Frustum" mit Schatten Zuordnung**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-154">**Figure 6. View frustum with shadow map**</span></span>

![Anzeigen von "Frustum" mit Schatten Zuordnung](images/view-frustum-with-shadow-map.jpg)

<span data-ttu-id="6a7b7-156">Helle Pixel in der äußersten Ebene stellen ein Aliasing mit niedriger Perspektive dar, und dunkle Pixel in der nahen Ebene stellen ein Aliasing mit hoher Perspektive dar.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-156">Light pixels in the far plane represent low-perspective aliasing, and dark pixels in the near plane represent high-perspective aliasing.</span></span>

<span data-ttu-id="6a7b7-157">Die Auflösung von schattenkarten kann ebenfalls zu hoch sein.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-157">Shadow map resolution can also be too high.</span></span> <span data-ttu-id="6a7b7-158">Obwohl eine höhere Auflösung weniger bemerkbar ist, kann Sie trotzdem zu kleinen Objekten, wie z. b. Telefonleitungen, führen, die keine Schatten umwandeln.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-158">Although a higher resolution is less noticeable, it nevertheless can result in small objects, such as telephone wires, not casting shadows.</span></span> <span data-ttu-id="6a7b7-159">Außerdem kann eine zu hohe Auflösung aufgrund von Textur Zugriffs Mustern schwerwiegende Leistungsprobleme verursachen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-159">Also, having too high of a resolution can cause severe performance issues because of texture access patterns.</span></span>

<span data-ttu-id="6a7b7-160">Perspektivische Schatten Zuordnungen (PSMS) und Leerraum-perspektivische Schatten Zuordnungen (lspsms) versuchen, perspektivische Aliasing zu adressieren, indem Sie die Projektions Matrix des Lichts verzerren, um mehr texeln in der Nähe der benötigten Zeit zu platzieren</span><span class="sxs-lookup"><span data-stu-id="6a7b7-160">Perspective shadow maps (PSMs) and light space perspective shadow maps (LSPSMs) attempt to address perspective aliasing by skewing the light's projection matrix in order to place more texels near the eye where they are needed.</span></span> <span data-ttu-id="6a7b7-161">Leider ist keines der beiden Verfahren in der Lage, das Aliasing der Perspektive zu lösen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-161">Unfortunately, neither technique is able to solve the perspective aliasing.</span></span> <span data-ttu-id="6a7b7-162">Die Parametrisierung der Transformation, die erforderlich ist, um den texeln in der Schatten Zuordnung die Augen Raum Pixel zuzuordnen, kann nicht durch eine lineare Neigung gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-162">The parameterization of the transform required to map eye-space pixels to texels in the shadow map cannot be bound by a linear skew.</span></span> <span data-ttu-id="6a7b7-163">Eine logarithmische Parametrisierung ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-163">A logarithmic parameterization is required.</span></span> <span data-ttu-id="6a7b7-164">Die PSMS-Datei hat zu viele Details in naher Nähe, was dazu führt, dass entfernte Schatten von geringer Qualität oder sogar verschwinden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-164">PSMs put too much detail near the eye, causing distant shadows to be of low quality or to even disappear.</span></span> <span data-ttu-id="6a7b7-165">Lspsms ist eine bessere Aufgabe, einen mittleren Grund zwischen zunehmender Auflösung im Auge zu finden und genug Details für Objekte zu erhalten, die weit entfernt sind.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-165">LSPSMs do a better job of finding a middle ground between increasing resolution near the eye, and leaving enough detail for objects far away.</span></span> <span data-ttu-id="6a7b7-166">Beide Verfahren werden in manchen Szenen Konfigurationen in orthografischen Schatten entdebugtet.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-166">Both techniques degenerate to orthographic shadows in some scene configurations.</span></span> <span data-ttu-id="6a7b7-167">Diese Degeneration kann durch das Rendern einer separaten Schatten Zuordnung für jede Oberfläche der Ansicht "Frustum" ausgeglichen werden, obwohl dies teuer ist.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-167">This degeneration can be counteracted by rendering a separate shadow map for each face of the view frustum, although this is expensive.</span></span> <span data-ttu-id="6a7b7-168">Logarithmische Perspektiven Schatten Zuordnungen (logpsms) erzeugen auch eine separate Zuordnung pro Gesicht der Ansicht.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-168">Logarithmic perspective shadow maps (LogPSMs) also render a separate map per face of the view frustum.</span></span> <span data-ttu-id="6a7b7-169">Bei dieser Methode wird die nichtlineare rasterisierung verwendet, um mehr texeln im Auge zu platzieren.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-169">This technique uses nonlinear rasterization to place more texels near the eye.</span></span> <span data-ttu-id="6a7b7-170">Die Hardware der d3d10-und D3D11-Klasse unterstützt keine nichtlineare rasterisierung.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-170">D3D10 and D3D11-class hardware do not support nonlinear rasterization.</span></span> <span data-ttu-id="6a7b7-171">Weitere Informationen zu diesen Techniken und Algorithmen finden Sie im Abschnitt "Verweise".</span><span class="sxs-lookup"><span data-stu-id="6a7b7-171">For more information about these techniques and algorithms, see the References section.</span></span>

<span data-ttu-id="6a7b7-172">Cascaded Shadow Maps (CSMS) sind die gängigste Technik für den Umgang mit peraliasing von Perspektiven.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-172">Cascaded shadow maps (CSMs) are the most popular technique for dealing with perspective aliasing.</span></span> <span data-ttu-id="6a7b7-173">Obwohl CSMS mit PSMS und lspsms kombiniert werden kann, ist es unnötig.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-173">Although CSMs can be combined with PSMs and LSPSMs, it's unnecessary.</span></span> <span data-ttu-id="6a7b7-174">Die Verwendung von CSMS zum Beheben von perspektivischen Aliasing Fehlern wird im Begleitartikel [Cascaded Shadow Maps](/windows/desktop/DxTechArts/cascaded-shadow-maps)behandelt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-174">Using CSMs to fix perspective aliasing errors is addressed in the companion article, [Cascaded Shadow Maps](/windows/desktop/DxTechArts/cascaded-shadow-maps).</span></span>

### <a name="projective-aliasing"></a><span data-ttu-id="6a7b7-175">Projektives Aliasing</span><span class="sxs-lookup"><span data-stu-id="6a7b7-175">Projective Aliasing</span></span>

<span data-ttu-id="6a7b7-176">Das projektives Aliasing ist schwieriger anzusehen als peraliasing von Perspektiven.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-176">Projective aliasing is harder to show than perspective aliasing.</span></span> <span data-ttu-id="6a7b7-177">Die in Abbildung 7 markierten in Abbildung 7 markierten Schatten veranschaulichen Projective Aliasing-Fehler.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-177">The distended shadows highlighted in Figure 7 demonstrate projective aliasing errors.</span></span> <span data-ttu-id="6a7b7-178">Das projektives Aliasing tritt auf, wenn die Zuordnung zwischen texeln im Kamera Raum und texeln im Leerraum kein 1: eins-Verhältnis ist. Dies liegt an der Ausrichtung der Geometrie in Bezug auf die helle Kamera.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-178">Projective aliasing occurs when the mapping between texels in camera space to texels in light space is not a one-to-one ratio; this is because of the orientation of the geometry with respect to the light camera.</span></span> <span data-ttu-id="6a7b7-179">Das projektives Aliasing tritt auf, wenn die tangential Ebene der Geometrie parallel zu den Lichtstrahlen wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-179">Projective aliasing occurs as the tangent plane of the geometry becomes parallel to the light rays.</span></span>

<span data-ttu-id="6a7b7-180">**Abbildung 7: Hoch projektives Aliasing im Vergleich zu Low-Projective Aliasing**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-180">**Figure 7. High-projective aliasing vs. low-projective aliasing**</span></span>

![hoch projektives Aliasing im Vergleich zu Low-Projective Aliasing](images/high-projective-aliasing-vs-low%20projective-aliasing.jpg)

<span data-ttu-id="6a7b7-182">Techniken zum lindern von perspektivischen Aliasing Fehlern mindern auch das Projective Aliasing.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-182">Techniques used to alleviate perspective aliasing errors also mitigate projective aliasing.</span></span> <span data-ttu-id="6a7b7-183">Das Projective Aliasing tritt auf, wenn die Oberflächen normale orthogonal im Licht ist. Diese Oberflächen sollten auf der Grundlage diffuses Beleuchtungs Gleichungen weniger hell empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-183">Projective aliasing occurs when the surface normal is orthogonal to the light; these surfaces should be receiving less light based on diffuse lighting equations.</span></span>

### <a name="shadow-acne-and-erroneous-self-shadowing"></a><span data-ttu-id="6a7b7-184">Schatten-Akne und fehlerhafte Self-Shadowing</span><span class="sxs-lookup"><span data-stu-id="6a7b7-184">Shadow Acne and Erroneous Self-Shadowing</span></span>

<span data-ttu-id="6a7b7-185">Schatten-Akne (Abbildung 8), ein Begriff, der mit fehlerhaftem selbst Shadowing Synonym ist, tritt auf, wenn die Schatten Zuordnung die Tiefe über einen ganzen texquantifizierert.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-185">Shadow acne (Figure 8), a term synonymous with erroneous self-shadowing, occurs when the shadow map quantizes the depth over an entire texel.</span></span> <span data-ttu-id="6a7b7-186">Wenn der Shader eine tatsächliche Tiefe mit diesem Wert vergleicht, ist es so wahrscheinlich, dass er sich selbst schattiert, da er unschattiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-186">When the shader compares an actual depth against this value, it is as likely to be self-shadowed as it is to be unshadowed.</span></span>

<span data-ttu-id="6a7b7-187">Ein weiterer Grund für die Schatten-Akne ist, dass sich die texesequenz in einem Leerraum so nah wie die Tiefe der entsprechenden texesequenz in der tiefenkarte befindet, dass bei Genauigkeits Fehlern der tiefen Test fälschlicherweise fehlschlägt</span><span class="sxs-lookup"><span data-stu-id="6a7b7-187">Another reason for shadow acne is that the texel in light space is so close to the depth of the corresponding texel in the depth map that precision errors cause the depth test to erroneously fail.</span></span> <span data-ttu-id="6a7b7-188">Ein Grund für diesen Genauigkeits Unterschied besteht darin, dass die tiefen Zuordnung von der Hardware für die rasterisierung mit fester Funktionsweise berechnet wurde, während die verglichene Tiefe vom Shader berechnet wurde.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-188">One reason for this precision difference is that the depth map was calculated by the fixed-function rasterization hardware, while the depth being compared was computed by the shader.</span></span> <span data-ttu-id="6a7b7-189">Projective Aliasing kann auch Schatten-Akne verursachen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-189">Projective aliasing can also cause shadow acne.</span></span>

<span data-ttu-id="6a7b7-190">**Abbildung 8. Schatten-Akne-Element**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-190">**Figure 8. Shadow acne artifact**</span></span>

![Schatten-Akne-Element](images/shadow-acne-artifact.jpg)

<span data-ttu-id="6a7b7-192">Wie im linken Bild gezeigt, haben einige der Pixel den tiefen Test nicht bestanden und die gesprengenen Artefakte und die Muster für das Muster erstellt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-192">As shown in the left image, some of pixels failed the depth test and created speckled artifacts and moiré patterns.</span></span> <span data-ttu-id="6a7b7-193">Um die fehlerhafte selbst shadonisweise zu reduzieren, sollten die Begrenzungen in der Nähe der Nähe und die weite Ebene für die Leerraum Ansicht Frustum so eng wie möglich berechnet werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-193">In order to reduce erroneous self-shadowing, the bounds on the near plane and the far plane for the light space view frustum should be calculated as tightly as possible.</span></span> <span data-ttu-id="6a7b7-194">Die auf der Skala basierende Tiefe und andere Typen von Bias sind andere Lösungen, mit denen Schatten-Akne verringert werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-194">The slope scale-based depth bias and other types of bias are other solutions used to mitigate shadow acne.</span></span>

### <a name="peter-panning"></a><span data-ttu-id="6a7b7-195">Peter-Panning</span><span class="sxs-lookup"><span data-stu-id="6a7b7-195">Peter Panning</span></span>

<span data-ttu-id="6a7b7-196">Der Begriff *Peter Panning* leitet seinen Namen aus dem Buchstaben eines Children ab, dessen Schatten getrennt wurde und von dem er fliegen konnte.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-196">The term *Peter Panning* derives its name from a children's book character whose shadow became detached and who could fly.</span></span> <span data-ttu-id="6a7b7-197">Dieses artefaktelement bewirkt, dass Objekte, die fehlende Schatten haben, von und über der Oberfläche getrennt werden (Abbildung 9).</span><span class="sxs-lookup"><span data-stu-id="6a7b7-197">This artifact makes objects with missing shadows appear to be detached from and to float above the surface (Figure 9).</span></span>

<span data-ttu-id="6a7b7-198">**Abbildung 9. Peter Panning-artefaktelement**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-198">**Figure 9. Peter Panning artifact**</span></span>

![Peter schwenken-artefaktelement](images/peter-panning-artifact.jpg)

<span data-ttu-id="6a7b7-200">Im Bild auf der linken Seite wird der Schatten vom Objekt getrennt, wodurch ein Gleit Komma Effekt entsteht.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-200">In the image at left, the shadow is detached from the object, creating a floating effect.</span></span>

<span data-ttu-id="6a7b7-201">Eine Methode zum Entfernen von Oberflächen Akne ist das Hinzufügen eines Werts zur Pixelposition im Leerraum. Dies wird als Hinzufügen eines tiefen Offsets bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-201">One technique for removing surface acne is to add some value to pixel position in light space; this is called adding a depth offset.</span></span> <span data-ttu-id="6a7b7-202">Peter schwenken Ergebnisse, wenn der verwendete tiefen Offset zu groß ist.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-202">Peter Panning results when the depth offset used is too large.</span></span> <span data-ttu-id="6a7b7-203">In diesem Fall bewirkt der tiefen Offset, dass der tiefen Test irrtümlich durchlaufen wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-203">In this case the depth offset causes the depth test to erroneously pass.</span></span> <span data-ttu-id="6a7b7-204">Wie bei der Schatten-Akne wird Peter Panning erschwert, wenn der tiefen Puffer nicht genügend Genauigkeit hat.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-204">Like shadow acne, Peter Panning is aggravated when there is insufficient precision in the depth buffer.</span></span> <span data-ttu-id="6a7b7-205">Das Berechnen von engen Flächen in naher und weit entfernten Ebenen hilft auch, Peter Panning zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-205">Calculating tight near planes and far planes also helps avoid Peter Panning.</span></span>

## <a name="techniques-to-improve-shadow-maps"></a><span data-ttu-id="6a7b7-206">Techniken zum Verbessern von schattenkarten</span><span class="sxs-lookup"><span data-stu-id="6a7b7-206">Techniques to Improve Shadow Maps</span></span>

<span data-ttu-id="6a7b7-207">Das Hinzufügen von Schatten zu einem Titel ist ein Prozess.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-207">Adding shadows to a title is a process.</span></span> <span data-ttu-id="6a7b7-208">Der erste Schritt besteht darin, grundlegende Schatten Zuordnungen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-208">The first step is to get basic shadow maps working.</span></span> <span data-ttu-id="6a7b7-209">Die zweite Möglichkeit besteht darin sicherzustellen, dass alle grundlegenden Berechnungen optimal durchgeführt werden: frusta passt so eng wie möglich an, nah-und ganz nach Ebenen passen eng an, wenn eine Neigung skaliert ist und so weiter.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-209">The second is to ensure all basic calculations are done optimally: frusta fit as tightly as possible, near/far planes fit tightly, slope-scaled bias is used, and so on.</span></span> <span data-ttu-id="6a7b7-210">Nachdem Sie die grundlegenden Schatten aktiviert und so gut wie möglich betrachtet haben, hat der Entwickler eine bessere Vorstellung davon, welche Algorithmen erforderlich sind, um die Schatten in eine ausreichende Treue zu bringen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-210">Once basic shadows are enabled, and look as good as possible, the developer has a better idea of what algorithms are needed to get the shadows to sufficient fidelity.</span></span> <span data-ttu-id="6a7b7-211">Grundlegende Tipps, die möglicherweise erforderlich sind, um grundlegende schattenkarten zu erhalten, die sich am besten in diesem Abschnitt befinden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-211">Basic tips that may be needed to get basic shadow maps looking at their best are given in this section.</span></span>

### <a name="slope-scale-depth-bias"></a><span data-ttu-id="6a7b7-212">Slope-Scale Tiefe-Abweichung</span><span class="sxs-lookup"><span data-stu-id="6a7b7-212">Slope-Scale Depth Bias</span></span>

<span data-ttu-id="6a7b7-213">Wie bereits erwähnt, kann selbst Shadowing zu Schatten-Akne führen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-213">As previously mentioned, self-shadowing can lead to shadow acne.</span></span> <span data-ttu-id="6a7b7-214">Das Hinzufügen zu einer zu großen Abweichung kann dazu führen, dass Peter schwenken.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-214">Adding too much bias can result in Peter Panning.</span></span> <span data-ttu-id="6a7b7-215">Außerdem erleiden Polygone mit steilen Pisten (relativ zum Licht) mehr von projectivem Aliasing als Polygone mit flachen Pisten (relativ zum Licht).</span><span class="sxs-lookup"><span data-stu-id="6a7b7-215">Additionally, polygons with steep slopes (relative to the light) suffer more from projective aliasing than polygons with shallow slopes (relative to the light).</span></span> <span data-ttu-id="6a7b7-216">Daher kann jeder tiefen Zuordnungs Wert abhängig von der Neigung des Polygons relativ zum Licht einen anderen Offset erfordern.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-216">Because of this, each depth map value may need a different offset depending on the polygon's slope relative to the light.</span></span>

<span data-ttu-id="6a7b7-217">Direct3D 10-Hardware bietet die Möglichkeit, ein Polygon auf der Grundlage der Neigung in Bezug auf die Ansichts Richtung zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-217">Direct3D 10 hardware has the ability to bias a polygon based on its slope with respect to the view direction.</span></span> <span data-ttu-id="6a7b7-218">Dies hat den Effekt, dass eine große Abweichung auf ein Polygon angewendet wird, das Edge-on in der Lichtrichtung angezeigt wird, aber keine Abweichung auf ein Polygon direkt mit dem Licht anwendet.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-218">This has the effect of applying a large bias to a polygon that is viewed edge-on to the light direction, but not applying any bias to a polygon facing the light directly.</span></span> <span data-ttu-id="6a7b7-219">Abbildung 10 zeigt, wie sich zwei benachbarte Pixel zwischen Schatten und unshadowing beim Testen gegen dieselbe unausgewogene Steigung unterschiedlichen können.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-219">Figure 10 illustrates how two neighboring pixels can alternate between shadowed and unshadowed when testing against the same unbiased slope.</span></span>

<span data-ttu-id="6a7b7-220">**Abbildung 10. Horizontal skalierte Tiefe-Bias im Vergleich zu einer unausgewogenen Tiefe**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-220">**Figure 10. Slope scaled depth-bias compared to unbiased depth**</span></span>

![horizontal skalierte Tiefe-Bias im Vergleich zu einer unausgewogenen Tiefe](images/slope-scaled-depth-bias-compared-to-unbiased-depth.png)

### <a name="calculating-a-tight-projection"></a><span data-ttu-id="6a7b7-222">Berechnen einer engen Projektion</span><span class="sxs-lookup"><span data-stu-id="6a7b7-222">Calculating a Tight Projection</span></span>

<span data-ttu-id="6a7b7-223">Durch eine enge Anpassung der Lichtprojektion an die Ansicht Frust wird die schattenkarten Abdeckung vergrößert.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-223">Tightly fitting the light's projection to the view frustum increases the shadow map coverage.</span></span> <span data-ttu-id="6a7b7-224">Abbildung 11 zeigt, dass die Verwendung einer beliebigen Projektion oder die Anpassung der Projektion an die Szenen Grenzen zu einem höheren perspektivischen Aliasing führt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-224">Figure 11 illustrates that using an arbitrary projection, or fitting the projection to the scene bounds, results in higher perspective aliasing.</span></span>

<span data-ttu-id="6a7b7-225">**Abbildung 11. Beliebige Schatten-Frustum und Schatten Frust an Szene anpassen**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-225">**Figure 11. Arbitrary shadow frustum and shadow frustum fit to scene**</span></span>

![beliebige Schatten-Frustum und Schatten Frust an Szene anpassen](images/arbitrary-shadow-frustum-and-shadow-frustum-fit-to-scene.jpg)

<span data-ttu-id="6a7b7-227">Die Ansicht ist aus der Sicht des Lichts entfernt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-227">The view is from the point of view of the light.</span></span> <span data-ttu-id="6a7b7-228">Der Wert von "Trapez" stellt den Frustum der Ansichts Kamera dar.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-228">The trapezoid represents the view camera's frustum.</span></span> <span data-ttu-id="6a7b7-229">Das Raster, das über dem Bild gezeichnet wird, stellt die schattenkarte dar.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-229">The grid drawn over the image represents the shadow map.</span></span> <span data-ttu-id="6a7b7-230">Das Bild auf der rechten Seite zeigt, dass dieselbe Auflösungs Schatten Zuordnung eine größere texesequenz erstellt, wenn diese enger an die Szene angepasst wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-230">The image on the right shows that the same resolution shadow map creates more texel coverage when it is fit more tightly to the scene.</span></span>

<span data-ttu-id="6a7b7-231">In Abbildung 12 werden Frustums veranschaulicht, die ordnungsgemäß geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-231">Figure 12 illustrates frustums that are correctly fit.</span></span> <span data-ttu-id="6a7b7-232">Zum Berechnen der Projektion werden die acht Punkte, aus denen die Ansicht hervorgeht, in einen Leerraum transformiert.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-232">To calculate the projection, the eight points that make up the view frustum are transformed into light space.</span></span> <span data-ttu-id="6a7b7-233">Als nächstes werden die Mindest-und Höchstwerte in X und Y gefunden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-233">Next, the minimum and maximum values in X and Y are found.</span></span> <span data-ttu-id="6a7b7-234">Diese Werte bilden die Begrenzungen für eine orthografische Projektion.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-234">These values make up the bounds for an orthographic projection.</span></span>

<span data-ttu-id="6a7b7-235">**Abbildung 12. Schatten Projektion passend zum Anzeigen von Frustum**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-235">**Figure 12. Shadow projection fit to view frustum**</span></span>

![Schatten Projektion passend zum Anzeigen von Frustum](images/shadow-projection-fit-to-view-frustum.jpg)

<span data-ttu-id="6a7b7-237">Es ist auch möglich, die Frustration auf die Szene aabb zu setzen, um eine strengere Grenze zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-237">It is also possible to clip the frustum to the scene AABB to get a tighter bound.</span></span> <span data-ttu-id="6a7b7-238">Dies wird nicht in allen Fällen empfohlen, da dadurch die Größe der Projektion der hellen Kamera von Frame zu Frame geändert werden kann.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-238">This is not advised in all cases because this can change the size of the light camera's projection from frame to frame.</span></span> <span data-ttu-id="6a7b7-239">Viele Techniken, wie z. b. die, die im Abschnitt Verschieben der hellen Texel-Sized Inkrementen beschrieben werden, führen zu besseren Ergebnissen, wenn die Größe der Lichtprojektion in jedem Frame konstant bleibt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-239">Many techniques, such as those described in the section Moving the Light Texel-Sized Increments, give better results when the size of the light's projection remains constant in every frame.</span></span>

### <a name="calculating-the-near-plane-and-far-plane"></a><span data-ttu-id="6a7b7-240">Berechnen der nahen und der äußersten Ebene</span><span class="sxs-lookup"><span data-stu-id="6a7b7-240">Calculating the Near Plane and Far Plane</span></span>

<span data-ttu-id="6a7b7-241">Die nahe Ebene und die weite Ebene sind die letzten Elemente, die zum Berechnen der Projektions Matrix erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-241">The near plane and far plane are the final pieces required to calculate the projection matrix.</span></span> <span data-ttu-id="6a7b7-242">Umso genauer sind die Ebenen, desto genauer sind die Werte im tiefen Puffer.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-242">The more closely together the planes are, the more precise the values in the depth buffer.</span></span>

<span data-ttu-id="6a7b7-243">Der tiefen Puffer kann ein 16-Bit-, 24-Bit-oder 32-Bit-Wert mit Werten zwischen 0 und 1 sein.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-243">The depth buffer can be 16-bit, 24-bit, or 32-bit, with values between 0 and 1.</span></span> <span data-ttu-id="6a7b7-244">Im Allgemeinen sind tiefen Puffer ein fester Punkt, wobei die Werte in der Nähe der Near-Ebene genauer gruppiert sind als die Werte in der Nähe der äußersten Ebene.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-244">Generally, depth buffers are fixed point, with the values close to the near plane grouped more closely together than the values close to the far plane.</span></span> <span data-ttu-id="6a7b7-245">Der Genauigkeits Grad, der für den tiefen Puffer verfügbar ist, wird durch das Verhältnis zwischen der nahen Ebene und der äußersten Ebene bestimmt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-245">The degree of precision available to the depth buffer is determined by the ratio of the near plane to the far plane.</span></span> <span data-ttu-id="6a7b7-246">Durch die Verwendung der fast-und Far-Ebene für die enge Prüfung kann die Verwendung eines 16-Bit-Tiefen Puffers ermöglicht werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-246">Using the tightest possible near/far plane could allow use of a 16-bit depth buffer.</span></span> <span data-ttu-id="6a7b7-247">Ein 16-Bit-Tiefen Puffer könnte die Verwendung des Arbeitsspeichers verringern und gleichzeitig die Verarbeitungsgeschwindigkeit erhöhen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-247">A 16-bit depth buffer could reduce the use of memory while increasing processing speed.</span></span>

### <a name="aabb-based-near-plane-and-far-plane"></a><span data-ttu-id="6a7b7-248">AABB-Based in der Nähe der Ebene und der äußersten Ebene</span><span class="sxs-lookup"><span data-stu-id="6a7b7-248">AABB-Based Near Plane and Far Plane</span></span>

<span data-ttu-id="6a7b7-249">Eine einfache und naive Möglichkeit zum Berechnen der Nähe und der äußersten Ebene besteht darin, das umgebende Volume der Szene in Leerraum umzuwandeln.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-249">An easy and naive way to calculate the near plane and far plane is to transform the scene's bounding volume into light space.</span></span> <span data-ttu-id="6a7b7-250">Der kleinste z-Koordinaten Wert ist die nahe Ebene, und der größte z-Koordinaten Wert ist die weite Ebene.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-250">The smallest Z-coordinate value is the near plane and the largest Z-coordinate value is the far plane.</span></span> <span data-ttu-id="6a7b7-251">Für viele Konfigurationen der Szene und des Lichts ist dieser Ansatz ausreichend.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-251">For many configurations of the scene and light, this approach is sufficient.</span></span> <span data-ttu-id="6a7b7-252">Der schlimmste Fall kann jedoch zu einem erheblichen Genauigkeits Verlust im tiefen Puffer führen. Abbildung 13 zeigt ein solches Szenario.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-252">The worst case scenario, however, can result in a significant loss of precision in the depth buffer; Figure 13 shows such a scenario.</span></span> <span data-ttu-id="6a7b7-253">Hier ist der Bereich der Near-Ebene bis hin zur äußersten Ebene viermal größer als notwendig.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-253">Here the range of the near plane to the far plane is four times larger than necessary.</span></span>

<span data-ttu-id="6a7b7-254">Die Ansicht "Frustum" in Abbildung 13 wurde absichtlich als klein gewählt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-254">The view frustum in Figure 13 was purposely chosen to be small.</span></span> <span data-ttu-id="6a7b7-255">In einer sehr großen Szene, die aus der Ansichts Kamera reicht, wird eine kleine Ansicht von "Frustum" angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-255">A small view frustum is shown in a very large scene consisting of pillars extending out from the view camera.</span></span> <span data-ttu-id="6a7b7-256">Die Verwendung der Szene aabb für die Near-und Far-Plane ist nicht optimal.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-256">Using the Scene AABB for the near and far planes is not optimal.</span></span> <span data-ttu-id="6a7b7-257">Der CSM-Algorithmus, der im Artikel [Cascaded Shadow Maps (Cascaded Shadow Maps](/windows/desktop/DxTechArts/cascaded-shadow-maps) ) beschrieben wird, muss für sehr kleine Frustrationen fast und weit berechnen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-257">The CSM algorithm described in the [Cascaded Shadow Maps](/windows/desktop/DxTechArts/cascaded-shadow-maps) technical article must calculate near and far planes for very small frustums.</span></span>

<span data-ttu-id="6a7b7-258">**Abbildung 13. Near und Far Plane basierend auf der Szene aabb**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-258">**Figure 13. Near and far planes based on Scene AABB**</span></span>

![Near und Far Plane basierend auf der Szene aabb](images/near-far-%20planes-based-on-scene-aabb.jpg)

### <a name="frustum-based-near-plane-and-far-plane"></a><span data-ttu-id="6a7b7-260">Frustum-Based in der Nähe der Ebene und der äußersten Ebene</span><span class="sxs-lookup"><span data-stu-id="6a7b7-260">Frustum-Based Near Plane and Far Plane</span></span>

<span data-ttu-id="6a7b7-261">Ein weiteres Verfahren zum Berechnen der Near-und Far-Ebene besteht darin, die Frustration in Leerraum zu transformieren und die minimalen und maximalen Werte in Z als die Near-und all-Ebenen zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-261">Another technique for calculating the near and far planes is to transform the frustum into light space and use the minimal and maximal values in Z as the near and the far planes, respectively.</span></span> <span data-ttu-id="6a7b7-262">In Abbildung 14 werden die beiden Probleme mit diesem Ansatz veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-262">Figure 14 illustrates the two issues with this approach.</span></span> <span data-ttu-id="6a7b7-263">Zuerst ist die Berechnung zu konservativ, wie Sie angezeigt wird, wenn der Frustum die Geometrie der Szene überschreitet.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-263">First, the calculation is too conservative, as shown when the frustum extends beyond the scene's geometry.</span></span> <span data-ttu-id="6a7b7-264">Zweitens könnte die nahe Ebene zu eng sein, was dazu führt, dass Schatten-Caster zugeschnitten werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-264">Second, the near plane could be too tight, causing shadow casters to be cropped.</span></span>

<span data-ttu-id="6a7b7-265">**Abbildung 14. Near und all-Ebenen, die ausschließlich auf der Anzeige von Frustum basieren**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-265">**Figure 14. Near and far planes based solely on view frustum**</span></span>

![Near und all-Ebenen, die ausschließlich auf der Anzeige von Frustum basieren](images/near-far-planes-based-solely-on-view-frustum.jpg)

### <a name="light-frustum-intersected-with-scene-to-calculate-near-and-far-planes"></a><span data-ttu-id="6a7b7-267">Light Frustum mit der Szene, um nahe-und fern Ebenen zu berechnen</span><span class="sxs-lookup"><span data-stu-id="6a7b7-267">Light Frustum Intersected with Scene to Calculate Near and Far Planes</span></span>

<span data-ttu-id="6a7b7-268">Die richtige Methode zum Berechnen der Near-und Far-Ebenen ist in Abbildung 15 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-268">The proper way to calculate the near and far planes is shown in Figure 15.</span></span> <span data-ttu-id="6a7b7-269">Vier der Ebenen der orthografischen hell Frustration wurden mit dem minimal-und Maximalwert der X-und Y-Koordinaten der Ansicht im Leerraum berechnet.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-269">Four of the planes of the orthographic light frustum were calculated using the minimum and maximum of the X and Y coordinates of the view frustum in light space.</span></span> <span data-ttu-id="6a7b7-270">Die letzten zwei Ebenen der orthogonalen Ansicht "Frustum" sind die nahe und die äußersten Ebenen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-270">The last two planes of the orthogonal view frustum are the near and the far planes.</span></span> <span data-ttu-id="6a7b7-271">Um diese Ebenen zu finden, werden die Begrenzungen der Szene anhand der vier bekannten hell Frustum-Ebenen abgeschnitten.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-271">To find these planes, the scene's bounds are clipped against the four known light frustum planes.</span></span> <span data-ttu-id="6a7b7-272">Die kleinsten und größten Z-Werte aus der neu abgeschnittenen Grenze stellen die Near-Ebene bzw. die weite Ebene dar.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-272">The smallest and largest Z-values from the newly clipped boundary represent the near plane and far plane, respectively.</span></span>

<span data-ttu-id="6a7b7-273">Der Code, der diesen Vorgang ausführt, befindet sich im CascadedShadowMaps11-Beispiel.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-273">The code that performs this operation is located in the CascadedShadowMaps11 sample.</span></span> <span data-ttu-id="6a7b7-274">Die acht Punkte, aus denen die aabb der Welt besteht, werden in einen Leerraum transformiert.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-274">The eight points that make up the world's AABB are transformed into light space.</span></span> <span data-ttu-id="6a7b7-275">Durch das Transformieren der Punkte in den Leerraum werden die clippingtests vereinfacht.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-275">Transforming the points into light space simplifies the clipping tests.</span></span> <span data-ttu-id="6a7b7-276">Die vier bekannten Flächen der hell Frustration können nun als Linien dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-276">The four known planes of the light frustum can now be represented as lines.</span></span> <span data-ttu-id="6a7b7-277">Die Kulissen des umgebenden Volumes im Leerraum können als sechs viereckale dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-277">The scenes bounding volume in light space can be represented as six quadrilaterals.</span></span> <span data-ttu-id="6a7b7-278">Diese 6 Vierecke können dann für Dreieck basiertes Clipping in 12 Dreiecke umgewandelt werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-278">These 6 quadrilaterals can then be turned into 12 triangles for triangle-based clipping.</span></span> <span data-ttu-id="6a7b7-279">Die Dreiecke werden anhand der bekannten Flächen der Ansicht "Frustum" abgeschnitten (Hierbei handelt es sich um horizontale und vertikale Linien in X und Y im Leerraum).</span><span class="sxs-lookup"><span data-stu-id="6a7b7-279">The triangles are clipped against the known planes of the view frustum (these are horizontal and vertical lines in X and Y in light space).</span></span> <span data-ttu-id="6a7b7-280">Wenn in X und Y ein Schnittpunkt gefunden wird, wird das 3D-Dreieck an diesem Punkt abgeschnitten.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-280">When an intersection point is found in X and Y, the 3D triangle is clipped at that point.</span></span> <span data-ttu-id="6a7b7-281">Die minimalen und maximalen Z-Werte aller ausgeschnittenen Dreiecke sind die nahe Ebene und die weite Ebene.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-281">The minimum and maximum Z-values of all the clipped triangles are the near plane and far plane.</span></span> <span data-ttu-id="6a7b7-282">Das CascadedShadowMaps11-Beispiel zeigt, wie dieses Clipping in der **computenearandfar** -Funktion durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-282">The CascadedShadowMaps11 sample shows how to perform this clipping in the **ComputeNearAndFar** function.</span></span>

<span data-ttu-id="6a7b7-283">Es gibt zwei weitere Techniken, die verwendet werden können, um die in der Nähe und in der Ferne Anzahl möglicher Ebenen zu berechnen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-283">There are two more techniques that could be used to calculate the tightest possible near and far planes.</span></span> <span data-ttu-id="6a7b7-284">Diese Techniken werden im caskadetten dshadowmaps-Beispiel nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-284">These techniques are not shown in the CascadedShadowMaps sample.</span></span>

-   <span data-ttu-id="6a7b7-285">Sogar strengere Near-und Far-Ebenen können berechnet werden, indem eine Hierarchie einer Szene oder einzelne Objekte in einer Szene gegen den hellen Frust angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-285">Even tighter near and far planes could be calculated by intersecting a hierarchy of a scene or individual objects in a scene against the light frustum.</span></span> <span data-ttu-id="6a7b7-286">Dies wäre rechnerisch komplexer.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-286">This would be computationally more complex.</span></span> <span data-ttu-id="6a7b7-287">Dies ist zwar nicht im CascadedShadowMaps11-Beispiel dargestellt, dies kann jedoch ein gültiges Verfahren für einige Kacheln sein.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-287">While not illustrated in the CascadedShadowMaps11 sample, this could be a valid technique for some tiles.</span></span>
-   <span data-ttu-id="6a7b7-288">Die weitaus mögliche Ebene kann berechnet werden, indem Sie die Mindestanzahl von:</span><span class="sxs-lookup"><span data-stu-id="6a7b7-288">The far plane could be calculated by taking the minimum of:</span></span>

    -   <span data-ttu-id="6a7b7-289">Die größte Tiefe der Ansicht für die Frustration im Leerraum.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-289">The largest depth of the view frustum in light space.</span></span>
    -   <span data-ttu-id="6a7b7-290">Die größte Tiefe der Schnittmenge der Ansicht Frustum und der Szene aabb.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-290">The largest depth of the intersection of the view frustum and the scene AABB.</span></span>

<span data-ttu-id="6a7b7-291">Diese Vorgehensweise kann problematisch sein, wenn Sie mit kaskadierenden Schatten Zuordnungen verwendet wird, in denen es möglich ist, außerhalb einer Ansicht zu indizieren.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-291">This approach can be problematic when used with cascaded shadow maps where it is possible to index outside of a view frustum.</span></span> <span data-ttu-id="6a7b7-292">In diesem Fall fehlt in der Schatten Zuordnung die Geometrie.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-292">In this case, the shadow map might be missing geometry.</span></span>

<span data-ttu-id="6a7b7-293">**Abbildung 15. Near und Far Plane basierend auf der Schnittmenge der vier berechneten Flächen der hellen Frustration und der umgebenden Geometrie der Szene.**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-293">**Figure 15. Near and far planes based on the intersection of the four calculated planes of the light frustum and the scene's bounding geometry**</span></span>

![Near und Far Plane basierend auf der Schnittmenge der vier berechneten Flächen der hellen Frustration und der umgebenden Geometrie der Szene.](images/near-far-plane-based-on-intersection-of-four.jpg)

### <a name="moving-the-light-in-texel-sized-increments"></a><span data-ttu-id="6a7b7-295">Verschieben des Lichts in Texel-Sized Inkrementen</span><span class="sxs-lookup"><span data-stu-id="6a7b7-295">Moving the Light in Texel-Sized Increments</span></span>

<span data-ttu-id="6a7b7-296">Ein gängiges Element in Schatten Zuordnungen ist der schimmernde Rand Effekt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-296">A common artifact in shadow maps is the shimmering edge effect.</span></span> <span data-ttu-id="6a7b7-297">Wenn die Kamera bewegt wird, werden die Pixel entlang der Ränder der Shadows heller und Darken.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-297">As the camera moves, the pixels along the shadows' edges brighten and darken.</span></span> <span data-ttu-id="6a7b7-298">Dies kann in immer noch Bildern nicht angezeigt werden, aber es ist sehr bemerkbar und ablenkend in Echtzeit.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-298">This cannot be seen in still images, but it is very noticeable and distracting in real time.</span></span> <span data-ttu-id="6a7b7-299">In Abbildung 16 wird dieses Problem hervorgehoben, und Abbildung 17 zeigt, wie die Schatten Ränder aussehen sollten.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-299">Figure 16 highlights this problem and Figure 17 shows how the shadow edges should look.</span></span>

<span data-ttu-id="6a7b7-300">Der Fehler beim schimmernden Edge tritt auf, wenn die Licht Projektions Matrix bei jedem Verschieben der Kamera neu berechnet wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-300">The shimmering edge error occurs because the light projection matrix is being recalculated every time the camera moves.</span></span> <span data-ttu-id="6a7b7-301">Dies erzeugt feine Unterschiede in den generierten Schatten Zuordnungen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-301">This creates subtle differences in the generated shadow maps.</span></span> <span data-ttu-id="6a7b7-302">Alle folgenden Faktoren können die Matrix beeinflussen, die zum Binden der Szene erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-302">All of the following factors can influence the matrix created to bound the scene.</span></span>

-   <span data-ttu-id="6a7b7-303">Größe der Ansicht "Frustum"</span><span class="sxs-lookup"><span data-stu-id="6a7b7-303">Size of the view frustum</span></span>
-   <span data-ttu-id="6a7b7-304">Ausrichtung der Ansicht "Frustum"</span><span class="sxs-lookup"><span data-stu-id="6a7b7-304">Orientation of the view frustum</span></span>
-   <span data-ttu-id="6a7b7-305">Speicherort des Lichts</span><span class="sxs-lookup"><span data-stu-id="6a7b7-305">Location of the light</span></span>
-   <span data-ttu-id="6a7b7-306">Speicherort der Kamera</span><span class="sxs-lookup"><span data-stu-id="6a7b7-306">Location of the camera</span></span>

<span data-ttu-id="6a7b7-307">Jedes Mal, wenn sich diese Matrix ändert, können sich die Schatten Ränder ändern.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-307">Every time this matrix changes, the shadows edges could change.</span></span>

<span data-ttu-id="6a7b7-308">**Abbildung 16. Schimmernde Schatten Ränder**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-308">**Figure 16. Shimmering shadow edges**</span></span>

![schimmernde Schatten Ränder](images/shimmering-shadow-edges.jpg)

<span data-ttu-id="6a7b7-310">Die Pixel entlang des Schattens treten ein und aus Schatten, wenn die Kamera von links nach rechts bewegt wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-310">The pixels along the border of the shadow come in and out of shadow as the camera moves from left to right.</span></span>

<span data-ttu-id="6a7b7-311">**Abbildung 17. Schatten ohne schimmernde Kanten**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-311">**Figure 17. Shadows without shimmering edges**</span></span>

![Schatten ohne schimmernde Kanten](images/shadows-without-shimmering-edges.jpg)

<span data-ttu-id="6a7b7-313">Die Schatten Ränder bleiben konstant, wenn die Kamera von links nach rechts bewegt wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-313">The shadow edges stay constant as the camera moves from left to right.</span></span>

<span data-ttu-id="6a7b7-314">Bei direktionalen Lichtern besteht die Lösung für dieses Problem darin, den minimalen/maximalen Wert in X und Y (aus den orthografischen Projektions Begrenzungen besteht) auf die Pixelgrößen Inkremente zu runden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-314">For directional lights, the solution to this problem is to round the minimum/maximum value in X and Y (that make up the orthographic projection bounds) to pixel size increments.</span></span> <span data-ttu-id="6a7b7-315">Dies kann mit einem Teilungs Vorgang, einem Floor-Vorgang und einem Multiplikations Vorgang durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-315">This can be done with a divide operation, a floor operation, and a multiply.</span></span>


```C++
        vLightCameraOrthographicMin /= vWorldUnitsPerTexel;
        vLightCameraOrthographicMin = XMVectorFloor( vLightCameraOrthographicMin );
        vLightCameraOrthographicMin *= vWorldUnitsPerTexel;
        vLightCameraOrthographicMax /= vWorldUnitsPerTexel;
        vLightCameraOrthographicMax = XMVectorFloor( vLightCameraOrthographicMax );
        vLightCameraOrthographicMax *= vWorldUnitsPerTexel;
```



<span data-ttu-id="6a7b7-316">Der vworldunitspertex-Wert wird berechnet, indem eine Begrenzung der Ansicht "Frustum" verwendet und durch die Puffergröße aufgeteilt wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-316">The vWorldUnitsPerTexel value is calculated by taking a bound of the view frustum, and dividing by the buffer size.</span></span>


```C++
        FLOAT fWorldUnitsPerTexel = fCascadeBound /
        (float)m_CopyOfCascadeConfig.m_iBufferSize;
        vWorldUnitsPerTexel = XMVectorSet( fWorldUnitsPerTexel, fWorldUnitsPerTexel,                            0.0f, 0.0f );
```



<span data-ttu-id="6a7b7-317">Das umschließende der maximalen Größe der Ansicht "Frustum" führt zu einer lockeren Anpassung der orthografischen Projektion.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-317">Bounding the maximum size of the view frustum results in a looser fit for the orthographic projection.</span></span>

<span data-ttu-id="6a7b7-318">Es ist wichtig zu beachten, dass die Textur bei der Verwendung dieses Verfahrens 1 Pixel größer ist als Breite und Höhe.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-318">It is important to note that the texture is 1 pixel larger in width and height when using this technique.</span></span> <span data-ttu-id="6a7b7-319">Dadurch werden Schatten Koordinaten von der Indizierung außerhalb der Schatten Zuordnung bewahrt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-319">This keeps shadow coordinates from indexing outside of the shadow map.</span></span>

### <a name="back-face-and-front-face"></a><span data-ttu-id="6a7b7-320">Rückseite und Vorderseite</span><span class="sxs-lookup"><span data-stu-id="6a7b7-320">Back Face and Front Face</span></span>

<span data-ttu-id="6a7b7-321">Schatten Zuordnungen sollten mit der standardmäßigen Hintergrund Erkennung gerendert werden, einem Prozess, der die rasterisierung von Objekten überspringt, die der Viewer nicht sehen kann, und das Rendern der Szene beschleunigt.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-321">Shadow maps should be rendered with standard back-face culling, a process that skips rasterization of objects that the viewer cannot see, and speeds up rendering of the scene.</span></span> <span data-ttu-id="6a7b7-322">Eine weitere gängige Option besteht darin, Schatten Zuordnungen mit aktiviertem Front-Face-culeln zu Rendering</span><span class="sxs-lookup"><span data-stu-id="6a7b7-322">Another common option is to render shadow maps with front-face culling enabled, which means that objects facing the viewer are eliminated.</span></span> <span data-ttu-id="6a7b7-323">Das Argument hierfür ist, dass es bei selbst shadobau hilfreich ist, da die Geometrie, die die Rückseite von Objekten bilden, etwas ausgeglichen ist.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-323">The argument for this is that it helps with self-shadowing as the geometry making up the back of objects is slightly offset.</span></span> <span data-ttu-id="6a7b7-324">Bei dieser Idee gibt es zwei Probleme.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-324">There are two problems with this idea.</span></span>

-   <span data-ttu-id="6a7b7-325">Alle Objekte mit unsachgemäßer Vorder-oder Hintergrund Geometrie verursachen Artefakte in der Schatten Zuordnung.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-325">Any object with improper front-face or back-face geometry causes artifacts in the shadow map.</span></span> <span data-ttu-id="6a7b7-326">Wenn jedoch eine falsche Vorder-oder Hintergrund Geometrie vorhanden ist, kann dies zu anderen Problemen führen. Daher kann es sicher sein, dass die Front-und Hintergrund Geometrie ordnungsgemäß ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-326">However, having incorrect front-face or back-face geometry will cause other problems, so it may be safe to assume front-face and back-face geometry is done correctly.</span></span> <span data-ttu-id="6a7b7-327">Es ist möglicherweise nicht praktikabel, Hinterflächen für Sprite-basierte Geometrie wie z. b. Laub zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-327">It may be impractical to create back faces for sprite-based geometry such as foliage.</span></span>
-   <span data-ttu-id="6a7b7-328">Peter Panning und Schatten Lücken in der Nähe der Basis von Objekten, wie z. b. Wände, treten eher auf, weil die Schatten Tiefe nicht zu klein ist.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-328">Peter Panning and shadow gaps near the base of objects such as walls are more likely to occur because the shadow depth disparity is too small.</span></span>

### <a name="shadow-mapfriendly-geometry"></a><span data-ttu-id="6a7b7-329">Schattenmap – freundliche Geometrie</span><span class="sxs-lookup"><span data-stu-id="6a7b7-329">Shadow Map–Friendly Geometry</span></span>

<span data-ttu-id="6a7b7-330">Das Erstellen von Geometrie, die in schattenkarten gut funktioniert, bietet mehr Flexibilität bei der Bekämpfung von Artefakten wie Peter Panning und Schatten-Akne.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-330">Creating geometry that works well in shadow maps allows for more flexibility when combating artifacts like Peter Panning and shadow acne.</span></span>

<span data-ttu-id="6a7b7-331">Fest Kanten sind für selbst shadobau problematisch.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-331">Hard edges are problematic for self-shadowing.</span></span> <span data-ttu-id="6a7b7-332">Der tiefen Unterschied in der Nähe der Spitze des Edge ist sehr gering.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-332">The depth disparity near the tip of the edge is very small.</span></span> <span data-ttu-id="6a7b7-333">Selbst ein kleiner Offset kann bewirken, dass Objekte ihre Schatten verlieren (Abbildung 18).</span><span class="sxs-lookup"><span data-stu-id="6a7b7-333">Even a small offset can cause objects to lose their shadows (Figure 18).</span></span>

<span data-ttu-id="6a7b7-334">**Abbildung 18. Spitzen Ränder bewirken Artefakte, die aus geringer Tiefe Differenz mit Offsets resultieren**</span><span class="sxs-lookup"><span data-stu-id="6a7b7-334">**Figure 18. Sharp edges cause artifacts stemming from low-depth disparity with offsets**</span></span>

![Spitzen Ränder bewirken Artefakte, die aus geringer Tiefe Differenz mit Offsets resultieren](images/sharp-edges-cause%20artifacts.jpg)

<span data-ttu-id="6a7b7-336">Schmale Objekte wie z. b. Wände sollten über Backs verfügen, auch wenn Sie nie sichtbar sind.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-336">Narrow objects such as walls should have backs even if they are never visible.</span></span> <span data-ttu-id="6a7b7-337">Dadurch wird die Tiefe der Tiefe erhöht.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-337">This will increase the depth disparity.</span></span>

<span data-ttu-id="6a7b7-338">Außerdem ist es wichtig sicherzustellen, dass die Richtung der Geometrie korrekt ist. Das heißt, der Außenbereich eines Objekts sollte sich im Hintergrund befinden, und der Innere eines Objekts sollte sich im Vordergrund befinden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-338">It's also important to make sure that the direction the geometry is facing is correct; that is, the outside of an object should be back facing and the inside of an object should be front facing.</span></span> <span data-ttu-id="6a7b7-339">Dies ist wichtig für das Rendering mit aktivierter Hintergrund Erkennung sowie für die Bekämpfung der Auswirkungen der tiefen Abweichung.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-339">This is important for rendering with back-face culling enabled, as well as for combating the effects of depth bias.</span></span>

## <a name="summary"></a><span data-ttu-id="6a7b7-340">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="6a7b7-340">Summary</span></span>

<span data-ttu-id="6a7b7-341">Die in diesem Artikel beschriebenen Verfahren können verwendet werden, um die Qualität von Standard Schatten Zuordnungen zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-341">The techniques described in this article can be used to increase the quality of standard shadow maps.</span></span> <span data-ttu-id="6a7b7-342">Der nächste Schritt besteht darin, sich mit den standardmäßigen Schatten Zuordnungen Techniken anzusehen, die gut funktionieren.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-342">The next step is to look at techniques that can work well with standard shadow maps.</span></span> <span data-ttu-id="6a7b7-343">CSMS werden als eine übergeordnete Technik empfohlen, um Perspektiven Aliasing zu bekämpfen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-343">CSMs are recommended as a superior technique to combat perspective aliasing.</span></span> <span data-ttu-id="6a7b7-344">Mit einem Prozentsatz an näherem filtern oder Varianz Schatten Maps können Schatten Ränder weich gezogen werden.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-344">Percentage closer filtering or variance shadow maps can be used to soften shadow edges.</span></span> <span data-ttu-id="6a7b7-345">Weitere Informationen finden Sie im technischen Artikel [Cascaded Shadow Maps](/windows/desktop/DxTechArts/cascaded-shadow-maps) .</span><span class="sxs-lookup"><span data-stu-id="6a7b7-345">See the [Cascaded Shadow Maps](/windows/desktop/DxTechArts/cascaded-shadow-maps) technical article for more information.</span></span>

<span data-ttu-id="6a7b7-346">Donnelly, W. und Lauritzen, A. [Varianz Schatten](https://portal.acm.org/citation.cfm?doid=1111411.1111440)Zuordnungen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-346">Donnelly, W., and Lauritzen, A. [Variance Shadow Maps](https://portal.acm.org/citation.cfm?doid=1111411.1111440).</span></span> <span data-ttu-id="6a7b7-347">Symposium für interaktive 3D-Grafiken, Verfahren des 2006-Symposiums zu interaktiven 3D-Grafiken und-spielen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-347">Symposium on Interactive 3D Graphics, Proceedings of the 2006 Symposium on Interactive 3D Graphics and Games.</span></span> <span data-ttu-id="6a7b7-348">2006, pp. 161 – 165.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-348">2006, pp. 161–165.</span></span>

<span data-ttu-id="6a7b7-349">Engel, woflgang F., Abschnitt 4.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-349">Engel, Woflgang F. Section 4.</span></span> <span data-ttu-id="6a7b7-350">Kaskadierenden Schatten Zuordnungen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-350">Cascaded Shadow Maps.</span></span> <span data-ttu-id="6a7b7-351">ShaderX5, *Erweiterte renderingtechniken*, Wolfgang F. Engel, Ed.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-351">ShaderX5, *Advanced Rendering Techniques*, Wolfgang F. Engel, Ed.</span></span> <span data-ttu-id="6a7b7-352">Charles River Media, Boston, Massachusetts.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-352">Charles River Media, Boston, Massachusetts.</span></span> <span data-ttu-id="6a7b7-353">2006.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-353">2006.</span></span> <span data-ttu-id="6a7b7-354">PP. 197 – 206.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-354">pp. 197–206.</span></span>

<span data-ttu-id="6a7b7-355">Stamminger, Marc und drettakis, George.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-355">Stamminger, Marc, and Drettakis, George.</span></span> <span data-ttu-id="6a7b7-356">[Perspektiven Schatten](https://portal.acm.org/citation.cfm?id=566616)Zuordnungen.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-356">[Perspective Shadow Maps](https://portal.acm.org/citation.cfm?id=566616).</span></span> <span data-ttu-id="6a7b7-357">Internationale Konferenz zu Computergrafiken und interaktiven Verfahren, *Verfahren der 29. jährlichen Konferenz zu Computergrafiken und interaktiven Techniken*.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-357">International Conference on Computer Graphics and Interactive Techniques, *Proceedings of the 29th Annual Conference on Computer Graphics and Interactive Techniques*.</span></span> <span data-ttu-id="6a7b7-358">2002, PP 557 – 562.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-358">2002, pp 557–562.</span></span>

<span data-ttu-id="6a7b7-359">"Wimmer", "M.", "Scherzer", "D." und "Purgathofer", W. [Leerraum-Perspektiven schattenkarten](https://www.cg.tuwien.ac.at/research/vr/lispsm/shadows_egsr2004_revised.pdf)</span><span class="sxs-lookup"><span data-stu-id="6a7b7-359">Wimmer, M., Scherzer, D., and Purgathofer, W. [Light Space Perspective Shadow Maps](https://www.cg.tuwien.ac.at/research/vr/lispsm/shadows_egsr2004_revised.pdf).</span></span> <span data-ttu-id="6a7b7-360">Das Euro graphics-Symposium zum Rendern.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-360">Eurographics Symposium on Rendering.</span></span> <span data-ttu-id="6a7b7-361">2004.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-361">2004.</span></span> <span data-ttu-id="6a7b7-362">Überarbeitet am 10. Juni 2005.</span><span class="sxs-lookup"><span data-stu-id="6a7b7-362">Revised June 10, 2005.</span></span> <span data-ttu-id="6a7b7-363">Die [Technische Universität Wien](https://www.cg.tuwien.ac.at/research/vr/lispsm/).</span><span class="sxs-lookup"><span data-stu-id="6a7b7-363">[Technische Universität Wien](https://www.cg.tuwien.ac.at/research/vr/lispsm/).</span></span>

 

 
