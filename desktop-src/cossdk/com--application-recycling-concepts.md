---
description: Durch die Wiederverwendung von Anwendungen können Sie die Gesamtstabilität ihrer com+-Anwendungen beträchtlich erhöhen, indem Sie eine schnelle Lösung für bekannte Probleme bieten und Schutz vor unerwarteten Problemen bieten.
ms.assetid: bf98318b-4d87-44cc-85a1-68faf5547e06
title: Konzepte der com+-Anwendungs Wiederverwendung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab37376ff3bc6d03f454f63822641ed69fad0b47
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104393018"
---
# <a name="com-application-recycling-concepts"></a><span data-ttu-id="19295-103">Konzepte der com+-Anwendungs Wiederverwendung</span><span class="sxs-lookup"><span data-stu-id="19295-103">COM+ Application Recycling Concepts</span></span>

<span data-ttu-id="19295-104">Durch die Wiederverwendung von Anwendungen können Sie die Gesamtstabilität ihrer com+-Anwendungen beträchtlich erhöhen, indem Sie eine schnelle Lösung für bekannte Probleme bieten und Schutz vor unerwarteten Problemen bieten.</span><span class="sxs-lookup"><span data-stu-id="19295-104">Application recycling can significantly increase the overall stability of your COM+ applications by offering a quick fix for known problems and helping to protect against unexpected ones.</span></span> <span data-ttu-id="19295-105">Beispielsweise kann die Anwendungsleistung im Lauf der Zeit aufgrund von Problemen wie Speicherlecks, nicht skalierbarer Ressourcenverwendung und Prozessfehlern beeinträchtigt werden.</span><span class="sxs-lookup"><span data-stu-id="19295-105">For example, application performance can degrade over time because of problems such as memory leaks, nonscalable resource usage, and process failure.</span></span> <span data-ttu-id="19295-106">Com+ bietet Anwendungs Wiederverwendung als Lösung für diese Probleme.</span><span class="sxs-lookup"><span data-stu-id="19295-106">COM+ provides application recycling as a solution to these problems.</span></span> <span data-ttu-id="19295-107">Mithilfe der Anwendungs Wiederverwendung können Sie einen Prozess automatisch Herunterfahren und neu starten. auf diese Weise können Sie einen fehlerhaften Prozess erneut initialisieren und den verwendeten Speicher neu zuordnen.</span><span class="sxs-lookup"><span data-stu-id="19295-107">You can use application recycling to automatically shut down a process and restart it, thus reinitializing a failing process and reallocating memory it uses.</span></span>

<span data-ttu-id="19295-108">Die Anwendungs Wiederverwendung funktioniert, indem ein Duplikat des dllhost-Prozesses erstellt wird, der einer Anwendung zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="19295-108">Application recycling works by creating a duplicate of the Dllhost process associated with an application.</span></span> <span data-ttu-id="19295-109">Mit diesem doppelten dllhost-Prozess werden alle zukünftigen Objekt Anforderungen verarbeitet, sodass der alte dllhost die Wartung der restlichen Objekt Anforderungen verlässt.</span><span class="sxs-lookup"><span data-stu-id="19295-109">This duplicate Dllhost process services all future object requests, which leaves the old Dllhost to finish servicing the remaining object requests.</span></span> <span data-ttu-id="19295-110">Der alte dllhost-Prozess wird heruntergefahren, wenn er das Release aller externen Verweise auf Objekte im Prozess erkennt oder wenn der Ablauf Timeout Wert erreicht wird.</span><span class="sxs-lookup"><span data-stu-id="19295-110">The old Dllhost process is shut down when it detects the release of all external references to objects in the process or when the expiration time-out value is reached.</span></span> <span data-ttu-id="19295-111">Durch dieses Verhalten stellt die Anwendungs Wiederverwendung sicher, dass bei einer Client Anwendung keine Dienst Unterbrechung auftritt.</span><span class="sxs-lookup"><span data-stu-id="19295-111">Through this behavior, application recycling ensures that a client application does not experience a service interruption.</span></span>

> [!Note]  
> <span data-ttu-id="19295-112">Eine COM+-Anwendung, die für die Verwendung als Windows-Dienst konfiguriert wurde, kann nicht wieder verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="19295-112">You cannot recycle a COM+ application that has been configured to run as a Windows service.</span></span> <span data-ttu-id="19295-113">Außerdem verfügen Bibliotheksanwendungen über die Eigenschaften zum wieder verwenden und zum Pooling Ihres Host Prozesses.</span><span class="sxs-lookup"><span data-stu-id="19295-113">Also, library applications have the recycling and pooling properties of their host process.</span></span>

 

<span data-ttu-id="19295-114">Mithilfe des Verwaltungs Tools Komponenten Dienste oder Programm gesteuert über das com+-Verwaltungs-SDK können Sie die Anwendungs Wiederverwendung administrativ konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="19295-114">You can configure application recycling administratively, by using the Component Services administrative tool, or programmatically, through the COM+ Administrative SDK.</span></span> <span data-ttu-id="19295-115">Sie können Prozesse auf der Grundlage verschiedener Kriterien wieder verwenden, die durch die folgenden Eigenschaften eines [**COMAdminCatalogObject**](comadmincatalogobject.md) -Objekts in der [**Anwendungs**](applications.md) Auflistung bestimmt werden:</span><span class="sxs-lookup"><span data-stu-id="19295-115">You can recycle processes based on several criteria, determined by the following properties of a [**COMAdminCatalogObject**](comadmincatalogobject.md) object in the [**Applications**](applications.md) collection:</span></span>

-   <span data-ttu-id="19295-116">**"Recyclelifetimelimit".**</span><span class="sxs-lookup"><span data-stu-id="19295-116">**RecycleLifetimeLimit.**</span></span> <span data-ttu-id="19295-117">Die maximale Anzahl von Minuten, die ein Prozess ausgeführt werden kann, bevor er wieder verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="19295-117">The maximum number of minutes a process can run before it's recycled.</span></span> <span data-ttu-id="19295-118">Der gültige Bereich liegt zwischen 0 und 30.240 Minuten (21 Tage).</span><span class="sxs-lookup"><span data-stu-id="19295-118">The valid range is 0 through 30,240 minutes (21 days).</span></span> <span data-ttu-id="19295-119">Die Standard Anzahl von Minuten ist 0 (null). Dies bedeutet, dass der Prozess nicht wieder verwendet werden kann, um eine Lebensdauer zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="19295-119">The default number of minutes is 0, which indicates that the process will not recycle from reaching a lifetime limit.</span></span>
-   <span data-ttu-id="19295-120">**Recyclememorylimit.**</span><span class="sxs-lookup"><span data-stu-id="19295-120">**RecycleMemoryLimit.**</span></span> <span data-ttu-id="19295-121">Die maximale Menge an Prozess Speicherauslastung (in Kilobyte), bevor der Prozess wieder verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="19295-121">The maximum amount of process memory usage (in kilobytes) before recycling the process.</span></span> <span data-ttu-id="19295-122">Wenn die Prozess Speicherauslastung die angegebene Anzahl länger als eine Minute überschreitet, wird der Prozess wieder verwendet.</span><span class="sxs-lookup"><span data-stu-id="19295-122">If the process memory usage exceeds the specified number for longer than one minute, the process is recycled.</span></span> <span data-ttu-id="19295-123">Der gültige Bereich liegt zwischen 0 und 1.048.576 KB.</span><span class="sxs-lookup"><span data-stu-id="19295-123">The valid range is 0 through 1,048,576 KB.</span></span> <span data-ttu-id="19295-124">Der Standardwert für die Speicherauslastung beträgt 0 KB. Dies bedeutet, dass der Prozess das Erreichen eines Arbeitsspeicher Limits nicht wieder verwendet.</span><span class="sxs-lookup"><span data-stu-id="19295-124">The default amount of memory usage is 0 KB, which indicates that the process will not recycle from reaching a memory limit.</span></span>
-   <span data-ttu-id="19295-125">**"RecycleCallLimit".**</span><span class="sxs-lookup"><span data-stu-id="19295-125">**RecycleCallLimit.**</span></span> <span data-ttu-id="19295-126">Die maximale Anzahl von aufrufen, die von Anwendungs Objekten angenommen werden können, bevor der Prozess wieder verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="19295-126">The maximum number of calls that application objects can accept before recycling the process.</span></span> <span data-ttu-id="19295-127">Der gültige Bereich liegt zwischen 0 und 1.048.576 aufrufen.</span><span class="sxs-lookup"><span data-stu-id="19295-127">The valid range is 0 through 1,048,576 calls.</span></span> <span data-ttu-id="19295-128">Die Standard Anzahl von Aufrufen ist 0 (null), was darauf hinweist, dass der Prozess das Erreichen eines Aufruf Limits nicht wieder verwendet.</span><span class="sxs-lookup"><span data-stu-id="19295-128">The default number of calls is 0, which indicates that the process will not recycle from reaching a call limit.</span></span>
-   <span data-ttu-id="19295-129">**Recycleactivationlimit.**</span><span class="sxs-lookup"><span data-stu-id="19295-129">**RecycleActivationLimit.**</span></span> <span data-ttu-id="19295-130">Die maximale Anzahl von Anwendungs Objekt Aktivierungen, die vor der Wiederverwendung des Prozesses akzeptiert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="19295-130">The maximum number of application object activations to accept before recycling the process.</span></span> <span data-ttu-id="19295-131">Der gültige Bereich liegt zwischen 0 und 1.048.576 Aktivierungen.</span><span class="sxs-lookup"><span data-stu-id="19295-131">The valid range is 0 through 1,048,576 activations.</span></span> <span data-ttu-id="19295-132">Die Standard Anzahl von Aktivierungen ist 0 (null), was darauf hinweist, dass der Prozess das Erreichen eines Aktivierungs Limits nicht wieder verwendet.</span><span class="sxs-lookup"><span data-stu-id="19295-132">The default number of activations is 0, which indicates that the process will not recycle from reaching an activation limit.</span></span>

<span data-ttu-id="19295-133">Außerdem wird die Eigenschaft "recycleexpirationtimeout" des Objekts " [**COMAdminCatalogObject**](comadmincatalogobject.md) " verwendet, um das Herunterfahren eines wiederverwendeten Prozesses zu erzwingen.</span><span class="sxs-lookup"><span data-stu-id="19295-133">Additionally, the RecycleExpirationTimeout property of the [**COMAdminCatalogObject**](comadmincatalogobject.md) object is used to force the shutdown of a recycled process.</span></span> <span data-ttu-id="19295-134">Gibt die Anzahl von Minuten an, die auf das Release aller externen Verweise auf Objekte im wiederverwendeten Prozess gewartet werden soll, bevor der Prozess beendet wird.</span><span class="sxs-lookup"><span data-stu-id="19295-134">It indicates the number of minutes to wait for the release of all external references to objects in the recycled process before forcibly shutting down the process.</span></span> <span data-ttu-id="19295-135">Der gültige Bereich liegt zwischen 1 und 1440 Minuten (24 Stunden), und das Standard Ablauf Timeout beträgt 15 Minuten.</span><span class="sxs-lookup"><span data-stu-id="19295-135">The valid range is 1 through 1440 minutes (24 hours), and the default expiration time-out is 15 minutes.</span></span> <span data-ttu-id="19295-136">Dieser Wert wird nur verwendet, wenn bereits festgestellt wurde, dass ein Prozess basierend auf den anderen Kriterien wieder verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="19295-136">This value is used only when it is already determined that a process will be recycled based on the other criteria.</span></span>

<span data-ttu-id="19295-137">Sie können mehr als ein Kriterium für die Wiederverwendung einer Anwendung auswählen.</span><span class="sxs-lookup"><span data-stu-id="19295-137">You can select more than one criterion for recycling an application.</span></span> <span data-ttu-id="19295-138">Com+ wieder verwendet die Anwendung, nachdem der erste Satz Kriterien erfüllt wurde.</span><span class="sxs-lookup"><span data-stu-id="19295-138">COM+ recycles the application after the first of the set of criteria is satisfied.</span></span> <span data-ttu-id="19295-139">Sie können den Timeout Wert für den Ablauf festlegen, um zu bestimmen, wie lange ein Alter dllhost-Prozess verbleibende Dienst Anforderungen abschließen kann, bevor das Herunterfahren erzwungen wird.</span><span class="sxs-lookup"><span data-stu-id="19295-139">You can set the expiration time-out value to determine how long an old Dllhost process can spend completing remaining service requests before being forcibly shut down.</span></span>

<span data-ttu-id="19295-140">Die [**ApplicationInstance**](applicationinstances.md) -Auflistung stellt die hasrecycelt-Eigenschaft bereit, die eine Möglichkeit bietet, zu bestimmen, ob die Anwendung jemals wieder verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="19295-140">The [**ApplicationInstances**](applicationinstances.md) collection provides the HasRecycled property, which provides a way to determine whether the application has ever been recycled.</span></span>

## <a name="related-topics"></a><span data-ttu-id="19295-141">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="19295-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="19295-142">Com+-Anwendungs Wiederverwendungs Tasks</span><span class="sxs-lookup"><span data-stu-id="19295-142">COM+ Application Recycling Tasks</span></span>](com--application-recycling-tasks.md)
</dt> <dt>

[<span data-ttu-id="19295-143">**Recycleersatz**</span><span class="sxs-lookup"><span data-stu-id="19295-143">**RecycleSurrogate**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-recyclesurrogate)
</dt> </dl>

 

 



