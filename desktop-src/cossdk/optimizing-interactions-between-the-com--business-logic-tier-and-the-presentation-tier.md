---
description: In der Regel unterscheidet sich die Latenz zwischen den Ebenen einer verteilten Anwendung erheblich.
ms.assetid: 4780a9fd-5940-4b10-a596-22214b17c033
title: Optimieren von Interaktionen zwischen der COM+-Geschäftslogikebene und der Präsentationsebene
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3258453a16549eacf3a7ed77444674d425c85613
ms.sourcegitcommit: 0f7a8198bacd5493ab1e78a9583c7a3578794765
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/25/2021
ms.locfileid: "110423500"
---
# <a name="optimizing-interactions-between-the-com-business-logic-tier-and-the-presentation-tier"></a><span data-ttu-id="b6220-103">Optimieren von Interaktionen zwischen der COM+-Geschäftslogikebene und der Präsentationsebene</span><span class="sxs-lookup"><span data-stu-id="b6220-103">Optimizing Interactions Between the COM+ Business Logic Tier and the Presentation Tier</span></span>

<span data-ttu-id="b6220-104">In der Regel unterscheidet sich die Latenz zwischen den Ebenen einer verteilten Anwendung erheblich.</span><span class="sxs-lookup"><span data-stu-id="b6220-104">Typically, the latency between tiers of a distributed application differs greatly.</span></span> <span data-ttu-id="b6220-105">Aufrufe zwischen der Präsentationsebene und der Geschäftslogikebene sind häufig um ein Vielfaches langsamer als Aufrufe zwischen der Geschäftsebene und der Datenschicht.</span><span class="sxs-lookup"><span data-stu-id="b6220-105">Calls between the presentation tier and business logic tier are often an order of magnitude slower than calls between the business tier and data tier.</span></span> <span data-ttu-id="b6220-106">Daher ist der Zustand "Held" teurer, wenn die Geschäftslogikebene aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="b6220-106">As a result, held state is more costly when calling into the business logic tier.</span></span>

<span data-ttu-id="b6220-107">In den folgenden Themen werden Möglichkeiten zum Übergeben von Daten zwischen präsentations- und geschäftslogikebenen erörtert:</span><span class="sxs-lookup"><span data-stu-id="b6220-107">The following topics discuss ways to pass data between the presentation and business logic tiers:</span></span>

-   [<span data-ttu-id="b6220-108">Übergeben von Parametern</span><span class="sxs-lookup"><span data-stu-id="b6220-108">Passing Parameters</span></span>](#passing-parameters)
-   [<span data-ttu-id="b6220-109">Datenübergabeoptionen</span><span class="sxs-lookup"><span data-stu-id="b6220-109">Data Passing Options</span></span>](#data-passing-options)
-   [<span data-ttu-id="b6220-110">Verwenden eines Factorymusters zum Übergeben von Daten</span><span class="sxs-lookup"><span data-stu-id="b6220-110">Using a Factory Pattern to Pass Data</span></span>](#using-a-factory-pattern-to-pass-data)
-   [<span data-ttu-id="b6220-111">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="b6220-111">Related topics</span></span>](#related-topics)

## <a name="passing-parameters"></a><span data-ttu-id="b6220-112">Übergeben von Parametern</span><span class="sxs-lookup"><span data-stu-id="b6220-112">Passing Parameters</span></span>

<span data-ttu-id="b6220-113">Damit ein bestimmter Satz von Informationen zwischen der Präsentationsebene und der Geschäftslogikebene übergeben wird, verfügen Sie möglicherweise über eine einzelne Zeile, mehrere Zeilen oder eine Kombination aus einer einzelnen Zeile (z. B. einem Header) und mehreren Detailzeilen von Daten.</span><span class="sxs-lookup"><span data-stu-id="b6220-113">For a given set of information to be passed between the presentation tier and the business logic tier, you may have a single row, multiple rows, or a combination of a single row (such as a header) and multiple detail rows of data.</span></span> <span data-ttu-id="b6220-114">Die effizienteste Möglichkeit, diese Informationen zwischen Ebenen zu übergeben, ist ein einzelner Methodenaufruf.</span><span class="sxs-lookup"><span data-stu-id="b6220-114">The most efficient way to pass this information between tiers is by a single method call.</span></span> <span data-ttu-id="b6220-115">Mit diesem einzelnen Aufruf wird der gesamte zu übergebende Informationssatz verwaltet.</span><span class="sxs-lookup"><span data-stu-id="b6220-115">This single call would manage the entire information set to be passed.</span></span> <span data-ttu-id="b6220-116">Dies ist erforderlich, es sei denn, Sie entscheiden sich dafür, die Transaktion von der Präsentationsebene aus zu steuern (und alle Transaktionsbehandlungen auf der Präsentationsebene in der Funktion identisch zu machen).</span><span class="sxs-lookup"><span data-stu-id="b6220-116">This is necessary unless you choose to control the transaction from the presentation tier (and make all transaction treatment in the presentation tier identical in function).</span></span> <span data-ttu-id="b6220-117">Microsoft empfiehlt nicht, Transaktionen von der Präsentationsebene aus durchzuführen, da Aufrufe zwischen dieser Ebene und der Geschäftslogikebene in der Regel die langsamsten Aufrufe in einer Anwendung mit mehreren Ebenen sind.</span><span class="sxs-lookup"><span data-stu-id="b6220-117">Microsoft does not recommend conducting transactions from the presentation tier because calls between this tier and the business logic tier are usually the slowest of any calls in a multi-tier application.</span></span>

<span data-ttu-id="b6220-118">Eine Möglichkeit zum Erstellen einer solchen Methode besteht darin, einzelne Informationszeilen als Parameter und mehrere Zeilen als ADO-Recordsets zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="b6220-118">One way to create such a method is to pass single rows of information as parameters and pass multiple rows as ADO recordsets.</span></span> <span data-ttu-id="b6220-119">Recordsets sind der Kern der ADO-Datenzugriffsmethodik von Microsoft, und die Verwendung von ADO-Recordsets ermöglicht es Ihnen, alle Informationen im Zusammenhang mit einer einzelnen Transaktion in einem Schritt zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="b6220-119">Recordsets are the core of Microsoft's ADO data access methodology, and using ADO recordsets allows you to pass all the information related to a single transaction in one step.</span></span>

## <a name="data-passing-options"></a><span data-ttu-id="b6220-120">Datenübergabeoptionen</span><span class="sxs-lookup"><span data-stu-id="b6220-120">Data Passing Options</span></span>

<span data-ttu-id="b6220-121">Es gibt weitere Optionen, die beim Übergeben von Daten zu berücksichtigen sind.</span><span class="sxs-lookup"><span data-stu-id="b6220-121">There are other options to consider when passing data.</span></span> <span data-ttu-id="b6220-122">Dazu gehören die Verwendung einer Liste von Parametern und ADO-Recordsets (wie oben beschrieben), nur ADO-Recordsets, XML-codierte Zeichenfolgen oder Arrays von Strukturen.</span><span class="sxs-lookup"><span data-stu-id="b6220-122">These include using a list of parameters and ADO recordsets (as discussed above), just ADO recordsets, XML encoded strings, or arrays of structures.</span></span> <span data-ttu-id="b6220-123">In diesem Abschnitt werden die einzelnen Optionen erläutert.</span><span class="sxs-lookup"><span data-stu-id="b6220-123">This section discusses each of these options.</span></span>

<span data-ttu-id="b6220-124">In der folgenden Tabelle sind Bereiche aufgeführt, in denen bei verwendung einer der vier verschiedenen Argumentübergebungsmöglichkeiten besondere Vorsicht zu bieten ist.</span><span class="sxs-lookup"><span data-stu-id="b6220-124">The following table shows areas where extra care needs to be taken when using any of the four different argument-passing possibilities.</span></span> <span data-ttu-id="b6220-125">Ein "X" stellt Bereiche dar, in denen Vor- und Abwägungen verstanden und gegen die Anforderungen der einzelnen Projekte abgewogen werden müssen.</span><span class="sxs-lookup"><span data-stu-id="b6220-125">An "X" represents areas where trade-offs need to be understood and weighed against the needs of each project.</span></span> <span data-ttu-id="b6220-126">Versuchen Sie, keine Entscheidungen über die Argumentübergeteilung auf Komponentenbasis zu treffen.</span><span class="sxs-lookup"><span data-stu-id="b6220-126">Try not to make argument-passing decisions on a per-component basis.</span></span> <span data-ttu-id="b6220-127">Die Vorteile eines konsistenten Programmiermodells in einem Projekt übersteigt bei allen bis auf die extremsten Umstände den Vorteil einer Methoden- oder Komponentenoptimierung.</span><span class="sxs-lookup"><span data-stu-id="b6220-127">The benefits of a consistent programming model throughout a project far outweigh any advantage of optimizing on a per-method or per-component basis in all but the most extreme circumstances.</span></span> <span data-ttu-id="b6220-128">Die Spalten werden in der Liste beschrieben, die auf die Tabelle folgt.</span><span class="sxs-lookup"><span data-stu-id="b6220-128">The columns are described in the list that follows the table.</span></span>



|     &nbsp;                  | <span data-ttu-id="b6220-129">Parallelität</span><span class="sxs-lookup"><span data-stu-id="b6220-129">Concurrency</span></span>  | <span data-ttu-id="b6220-130">WAN</span><span class="sxs-lookup"><span data-stu-id="b6220-130">WAN</span></span>          | <span data-ttu-id="b6220-131">Bereitstellung</span><span class="sxs-lookup"><span data-stu-id="b6220-131">Deployment</span></span>   | <span data-ttu-id="b6220-132">Komplexität</span><span class="sxs-lookup"><span data-stu-id="b6220-132">Complexity</span></span>   |
|-----------------------|--------------|--------------|--------------|--------------|
| <span data-ttu-id="b6220-133">Eingabe</span><span class="sxs-lookup"><span data-stu-id="b6220-133">Entry</span></span> | <span data-ttu-id="b6220-134">Wert</span><span class="sxs-lookup"><span data-stu-id="b6220-134">Value</span></span> |
| <span data-ttu-id="b6220-135">Recordsets</span><span class="sxs-lookup"><span data-stu-id="b6220-135">Recordsets</span></span><br/> |              | <span data-ttu-id="b6220-136">X</span><span class="sxs-lookup"><span data-stu-id="b6220-136">X</span></span><br/> | <span data-ttu-id="b6220-137">X</span><span class="sxs-lookup"><span data-stu-id="b6220-137">X</span></span><br/> | <span data-ttu-id="b6220-138">X</span><span class="sxs-lookup"><span data-stu-id="b6220-138">X</span></span><br/> |
| <span data-ttu-id="b6220-139">XML</span><span class="sxs-lookup"><span data-stu-id="b6220-139">XML</span></span><br/>        | <span data-ttu-id="b6220-140">X</span><span class="sxs-lookup"><span data-stu-id="b6220-140">X</span></span><br/> |              | <span data-ttu-id="b6220-141">X</span><span class="sxs-lookup"><span data-stu-id="b6220-141">X</span></span><br/> | <span data-ttu-id="b6220-142">X</span><span class="sxs-lookup"><span data-stu-id="b6220-142">X</span></span><br/> |
| <span data-ttu-id="b6220-143">Arrays</span><span class="sxs-lookup"><span data-stu-id="b6220-143">Arrays</span></span><br/>     | <span data-ttu-id="b6220-144">X</span><span class="sxs-lookup"><span data-stu-id="b6220-144">X</span></span><br/> |              | <span data-ttu-id="b6220-145">X</span><span class="sxs-lookup"><span data-stu-id="b6220-145">X</span></span><br/> | <span data-ttu-id="b6220-146">X</span><span class="sxs-lookup"><span data-stu-id="b6220-146">X</span></span><br/> |



 

<span data-ttu-id="b6220-147">Die vier Spalten definieren Bereiche, auf die Sie achten müssen, wenn Sie diese Option zum Übergeben von Parametern verwenden.</span><span class="sxs-lookup"><span data-stu-id="b6220-147">The four columns define areas to watch out for when using that option to pass parameters.</span></span>

-   <span data-ttu-id="b6220-148">**Die Spalte Parallelität stellt** die Notwendigkeit dar, einen Mechanismus zum Verwalten von Sperrbedingungen für Updatevorgänge zu codieren oder bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="b6220-148">**The Concurrency column** represents the need to code or provide a mechanism that manages locking conditions on update operations.</span></span> <span data-ttu-id="b6220-149">Da Methoden, die Speichern ausführen, Updates darstellen können, können Parallelitätsprobleme auftreten.</span><span class="sxs-lookup"><span data-stu-id="b6220-149">Since methods that perform saves can represent updates, concurrency problems can arise.</span></span> <span data-ttu-id="b6220-150">Zwei Arten von Sperren sind häufig optimistisch und pessimistisch.</span><span class="sxs-lookup"><span data-stu-id="b6220-150">Two types of locking are prevalent optimistic and pessimistic.</span></span> <span data-ttu-id="b6220-151">Pessimistische Sperren verhindern, dass ein Benutzer Daten zum Aktualisieren abrufen kann, während ein anderer Benutzer das Potenzial hat, ein Update zu durchführen.</span><span class="sxs-lookup"><span data-stu-id="b6220-151">Pessimistic locks prevent a user from getting data for update while another user has the potential for performing an update.</span></span> <span data-ttu-id="b6220-152">Die optimistische Sperre unterstützt deutlich mehr Benutzer, indem gegen die Wahrscheinlichkeit gehandelt wird, dass zwei Benutzer dasselbe Dokument gleichzeitig aktualisieren würden.</span><span class="sxs-lookup"><span data-stu-id="b6220-152">Optimistic locking supports a great many more users by trading against the likelihood that any two users would be updating the same document at the same time.</span></span> <span data-ttu-id="b6220-153">Die optimistische Sperrung erfordert die Überprüfung, um zu überprüfen, ob die gespeicherten Daten den Daten zu dem Zeitpunkt entspricht, an dem zur Änderung auf eine Kopie der Daten zugegriffen wurde.</span><span class="sxs-lookup"><span data-stu-id="b6220-153">Optimistic locking calls for checking to see that the data that is stored matches the data at the point when a copy of the data was accessed for modification.</span></span> <span data-ttu-id="b6220-154">ADO-Recordsets bieten automatische Unterstützung für optimistische Sperren.</span><span class="sxs-lookup"><span data-stu-id="b6220-154">ADO recordsets provide automatic support for optimistic locking.</span></span> <span data-ttu-id="b6220-155">Updateszenarien, die Einzelne-Zeilen-Parameterlisten enthalten, bieten keine ausreichende Unterstützung für die Parallelitätsüberprüfung.</span><span class="sxs-lookup"><span data-stu-id="b6220-155">Update scenarios involving single row parameter lists do not provide sufficient support for concurrency checking.</span></span> <span data-ttu-id="b6220-156">XML hat das gleiche Problem, da in XML-Daten kein Sperrbewusstsein vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="b6220-156">XML suffers from this same problem, in that no locking awareness is present in XML data.</span></span>
-   <span data-ttu-id="b6220-157">**Die WAN-Spalte** stellt Bedingungen dar, unter denen Übertragungsübertritte in einem Wan (Wide Area Network) möglich sind.</span><span class="sxs-lookup"><span data-stu-id="b6220-157">**The WAN column** represents conditions where there may be transmission contention on a wide area network (WAN ).</span></span> <span data-ttu-id="b6220-158">Wenn das WAN nicht über genügend Kapazität verfügt, um alle zu verschiebenden Daten gleichzeitig zu verwalten, kommt es bei Anwendungsbenutzern zu Verzögerungen bei der Antwortzeit.</span><span class="sxs-lookup"><span data-stu-id="b6220-158">When the WAN does not have sufficient capacity to manage all of the data being moved at any one time, application users experience response time delays.</span></span> <span data-ttu-id="b6220-159">Um optimistische Parallelität zu unterstützen, übergeben getrennte ADO-Recordsets zwei Kopien der Daten vom Server an den Client.</span><span class="sxs-lookup"><span data-stu-id="b6220-159">To support optimistic concurrency, disconnected ADO recordsets pass two copies of the data from the server to the client.</span></span> <span data-ttu-id="b6220-160">Die zweite Kopie wird vom Client verwendet, um das kleinste Updaterowset zu bestimmen, das beim Commit einer Änderung übergeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="b6220-160">The second copy is used by the client to determine the smallest update rowset to pass back when a change is being committed.</span></span> <span data-ttu-id="b6220-161">Dies reduziert zwar den Datenverkehr von der Präsentationsebene zu den Daten, aber die zusätzliche Last der zweiten Kopie kann erheblich sein.</span><span class="sxs-lookup"><span data-stu-id="b6220-161">While this cuts down on traffic from the presentation tier to the data, the extra load of the second copy can be significant.</span></span> <span data-ttu-id="b6220-162">Die Verwendung von Recordsets als einziges Mittel zum Übergeben aller Informationen führt daher dazu, dass doppelt so viele Daten zwischen Ebenen wie erforderlich übergeben werden, es sei denn, das Updaterowset wird von einer Präsentationsebene zurück an die Datenebene übergeben.</span><span class="sxs-lookup"><span data-stu-id="b6220-162">Using recordsets as the sole means of passing all information therefore causes twice as much data to be passed between tiers as is required, except when the update rowset is being passed back to the data tier from a presentation tier.</span></span>
-   <span data-ttu-id="b6220-163">**Die Spalte Bereitstellung** stellt Probleme im Zusammenhang mit der Datenübergabe dar, wenn sowohl auf der Aufrufer- als auch auf der Komponentenseite des Netzwerks eine spezielle Technologie erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="b6220-163">**The Deployment column** represents issues associated with data passing when special technology is required on both the caller and component side of the network.</span></span> <span data-ttu-id="b6220-164">Die Verwendung von ADO-Recordsets erfordert beispielsweise, dass ADO-Komponenten sowohl auf dem Client als auch auf dem Server vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="b6220-164">For example, using ADO recordsets requires ADO components to be present on both client and server.</span></span> <span data-ttu-id="b6220-165">XML-Parser müssen auch auf beiden Seiten vorhanden sein, um zu vermeiden, dass Parser in Ihre Anwendungen codiert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="b6220-165">XML parsers must be present on both sides as well, to avoid having to code parsers into your applications.</span></span>
-   <span data-ttu-id="b6220-166">**Die Spalte Komplexität** ist für alle vier Optionen angegeben und ist eine Frage der Präferenz oder vorherigen Programmiermodellerfahrung, die möglicherweise bereits in Ihrer Entwicklungsorganisation eingerichtet wurde.</span><span class="sxs-lookup"><span data-stu-id="b6220-166">**The Complexity column** is indicated for all four choices, and is a matter of preference or prior programming model experience that may be already established in your development organization.</span></span> <span data-ttu-id="b6220-167">Einige Benutzer finden die Übergabe von Parametern umständlich und haben das Gefühl, dass dies dem Programmierproblem zu viel Komplexität hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="b6220-167">Some people find parameter passing to be cumbersome and feel it adds too much complexity to the programming problem.</span></span> <span data-ttu-id="b6220-168">Wenn Sie nachverfolgen, welchen Parameter Sie behandeln, und sie alle in einem Bearbeitungsfenster sichtbar machen, kann dies zu einer erhöhten Komplexität führen, die von einigen Entwicklern als nicht verwaltet bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="b6220-168">Keeping track of which parameter you are handling, and getting them all visible in one editing window, can create a logistical complexity that some developers find unmanageable.</span></span>

<span data-ttu-id="b6220-169">Die Parameterübergabemethode kann auch Vor- und Nachholungen aufweisen, z. B. die folgenden:</span><span class="sxs-lookup"><span data-stu-id="b6220-169">The parameter-passing method also can have trade-offs, such as the following:</span></span>

-   <span data-ttu-id="b6220-170">Parameter können die Verwaltung mehrerer Argumente und Argumenttypen sowie die Entscheidung umfassen, wann ein Recordset als Parameter geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="b6220-170">Parameters can involve managing multiple arguments and argument types as well as having to decide when it is appropriate to make a recordset a parameter.</span></span>
-   <span data-ttu-id="b6220-171">ADO-Recordsets können hierarchische Beziehungen in Methodenparametern auf ein oder zwei Argumente reduzieren.</span><span class="sxs-lookup"><span data-stu-id="b6220-171">ADO recordsets can cut hierarchical relationships in method parameters down to one or two arguments.</span></span> <span data-ttu-id="b6220-172">Dies vereinfacht das Programmiermodell erheblich und unterstützt das Hinzufügen von Spalten zu einem späteren Zeitpunkt, aber es blendet auch die Informationshierarchie aus.</span><span class="sxs-lookup"><span data-stu-id="b6220-172">This simplifies the programming model dramatically and supports adding columns at a later time, but it also hides the information hierarchy.</span></span> <span data-ttu-id="b6220-173">Wenn Sie Informationen in ein ADO-Recordset einpacken und später extrahieren, müssen Sie die Namen der einzelnen Spalten kennen oder die Spalten reihenfolge kennen.</span><span class="sxs-lookup"><span data-stu-id="b6220-173">Stuffing information into an ADO recordset and later extracting it involves knowing the names of each column or knowing the column order.</span></span> <span data-ttu-id="b6220-174">Diese Situation kann die Komplexität für andere Komponenten- oder Anwendungsentwickler im Projekt erhöhen.</span><span class="sxs-lookup"><span data-stu-id="b6220-174">This situation can add complexity for other component or application developers on the project.</span></span>
-   <span data-ttu-id="b6220-175">XML ist eine andere Drehung in der oben erwähnten verborgenen Hierarchiekomplikation.</span><span class="sxs-lookup"><span data-stu-id="b6220-175">XML is a different spin on the hidden hierarchy complication mentioned above.</span></span> <span data-ttu-id="b6220-176">Der Programmierer muss die Verwendung eines XML-Parsers verstehen, um Zugriff auf die Informationen zu erhalten, und muss häufig die Namen der einzelnen Elemente im DataSet kennen, bevor das DataSet gefunden werden kann.</span><span class="sxs-lookup"><span data-stu-id="b6220-176">The programmer needs to understand the use of an XML parser to gain access to the information and often must know the names of each item in the data set before the data set can be found.</span></span>
-   <span data-ttu-id="b6220-177">Arrays von -Strukturen führen zur Notwendigkeit eines gemeinsamen Verständnisses der Informationen, die sowohl vom Aufrufer als auch von der Komponente übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="b6220-177">Arrays of structures introduce the need for a common understanding of the information being passed on the part of both caller and component.</span></span> <span data-ttu-id="b6220-178">Diese Notwendigkeit einer Zuordnung, die von zwei Systemelementen gemeinsam genutzt wird, kann zu Schwierigkeiten beim Umgang mit verschiedenen Versionen von Komponenten führen.</span><span class="sxs-lookup"><span data-stu-id="b6220-178">This need for a map that is shared between two system elements can lead to difficulties when dealing with different versions of components.</span></span> <span data-ttu-id="b6220-179">Obwohl sich die Methodensignatur möglicherweise nicht ändert, können Änderungen an den erwarteten Informationen aufrufende Programme inkompatibel machen.</span><span class="sxs-lookup"><span data-stu-id="b6220-179">While the method signature might not change, changes to the expected information can render calling programs incompatible.</span></span>

<span data-ttu-id="b6220-180">Da die Komplexitätsprobleme im Zusammenhang mit allen vier Methoden zur Parameterübergibtung so ähnlich sind, ist es unübersetzbar, dass es eine erhebliche Vereinfachungsmöglichkeit im Zusammenhang mit einer Auswahl gibt.</span><span class="sxs-lookup"><span data-stu-id="b6220-180">Because the complexity issues associated with all four parameter-passing methods are so similar, it is debatable that there is a significant simplification opportunity associated with any one selection.</span></span>

## <a name="using-a-factory-pattern-to-pass-data"></a><span data-ttu-id="b6220-181">Verwenden eines Factorymusters zum Übergeben von Daten</span><span class="sxs-lookup"><span data-stu-id="b6220-181">Using a Factory Pattern to Pass Data</span></span>

<span data-ttu-id="b6220-182">Ein wichtiger Entwurfspunkt ist die Benutzerfreundlichkeit.</span><span class="sxs-lookup"><span data-stu-id="b6220-182">One important design point is ease of use.</span></span> <span data-ttu-id="b6220-183">In dem Moment, in dem Sie sich entschieden haben, ADO-Recordsets zu verwenden, um einen strukturierten Satz von Details an die Präsentationsebene zurückübertragen, haben Sie ein Komplexitätsproblem eingeführt.</span><span class="sxs-lookup"><span data-stu-id="b6220-183">The moment you decided to use ADO recordsets to pass a structured set of details back to the presentation tier, you introduced a complexity problem.</span></span> <span data-ttu-id="b6220-184">Programmierer der Präsentationsebene müssen die Struktur dieser Recordsets verstehen.</span><span class="sxs-lookup"><span data-stu-id="b6220-184">Presentation tier programmers need to understand the structure of those recordsets.</span></span> <span data-ttu-id="b6220-185">Ein höheres Komplexitätsproblem kann auftreten, wenn Sie mehrere Details für eine Gruppe von Daten benötigen, die in einem Recordset übergeben werden sollen.</span><span class="sxs-lookup"><span data-stu-id="b6220-185">A greater complexity issue can arise when you require multiple details for a set of data to be passed in a recordset.</span></span> <span data-ttu-id="b6220-186">Zur Vereinfachung sollten Sie erwägen, immer dann eine Recordset-Factorymethode zu erstellen, wenn Sie beabsichtigen, daten in strukturierten ADO-Recordsets zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="b6220-186">To simplify matters, you should consider creating a recordset factory method whenever you intend to require data to be passed in structured ADO recordsets.</span></span>

<span data-ttu-id="b6220-187">Die Recordset-Factory sollte ein leeres, aber beschreibbares getrenntes Recordset an den Aufrufer zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="b6220-187">The recordset factory should return an empty but writable disconnected recordset to the caller.</span></span> <span data-ttu-id="b6220-188">Dieses Recordset sollte die richtigen Felder (Namen und Datentypen) bereits konfiguriert haben, damit der aufrufende Client nicht wissen muss, wie das Recordset hergestellt werden soll.</span><span class="sxs-lookup"><span data-stu-id="b6220-188">This recordset should have the proper fields (names and data types) already configured so that the calling client does not need to know how to manufacture the recordset.</span></span> <span data-ttu-id="b6220-189">Dieser Ansatz wird häufig als *Factorymuster* bezeichnet und ist ein gängiges Lösungsmuster, das die Notwendigkeit löst, ein Objekt mit einer bestimmten Komplexität zu erstellen, ohne die Nuancen der Erstellung kennen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="b6220-189">This approach is often referred to as the *factory pattern* and is a common solution pattern that solves the need to create an object of a given complexity without having to know the nuances of creating it.</span></span>

<span data-ttu-id="b6220-190">Einfache Entwurfsentscheidungen, z. B. das Auswählen des gleichen Parameternamens für denselben Datenteil für jede Methode, bei der diese Informationen übergeben werden, erleichtern es, eine Methode zu betrachten und zu wissen, was erwartet wird.</span><span class="sxs-lookup"><span data-stu-id="b6220-190">Simple design choices such as choosing the same parameter name for the same piece of data across every method where that information is passed makes it easy to look at a method and know what is expected.</span></span> <span data-ttu-id="b6220-191">Die Sicherstellung, dass die Reihenfolge, in der like-Argumente übergeben werden, über eine gesamte Methodenfamilie hinweg konsistent ist, stellt einen Komfortpunkt dar, der ein konsistentes Modell erzwingt.</span><span class="sxs-lookup"><span data-stu-id="b6220-191">Making sure that the order in which like arguments are passed is consistent across an entire family of methods provides a comfort point that enforces a consistent model.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b6220-192">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="b6220-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b6220-193">Optimieren von Interaktionen zwischen der COM+-Geschäftslogikebene und der Datenschicht</span><span class="sxs-lookup"><span data-stu-id="b6220-193">Optimizing Interactions Between the COM+ Business Logic Tier and the Data Tier</span></span>](optimizing-interactions-between-the-com--business-logic-tier-and-the-data-tier.md)
</dt> </dl>

 

 




