---
description: Erstellen eines Herausgeber Filters
ms.assetid: d91efecc-f02a-41c6-acf7-37b74723e7e8
title: Erstellen eines Herausgeber Filters
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 997fe37cf0021bcb2aa153c2dc4b73597e0c43cc
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104127556"
---
# <a name="creating-a-publisher-filter"></a><span data-ttu-id="ed882-103">Erstellen eines Herausgeber Filters</span><span class="sxs-lookup"><span data-stu-id="ed882-103">Creating a Publisher Filter</span></span>

<span data-ttu-id="ed882-104">Es gibt zwei Methoden zum Einrichten des Herausgeber Filters: mithilfe der multipublisherfilterclsid-Eigenschaft der Ereignisklasse oder mit [**IEventControl:: setpublisherfilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span><span class="sxs-lookup"><span data-stu-id="ed882-104">There are two methods to establish the publisher filter: using the MultiPublisherFilterCLSID property of the event class, or using [**IEventControl::SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span></span>

-   <span data-ttu-id="ed882-105">Da es Ihnen ermöglicht, das Ereignis Objekt mit dem com+-Dienst in der [Warteschlange für die Warteschlange](com--queued-components.md) zu verfassen, ist die bevorzugte Methode die Verwendung der multipublisherfilterclsid-Eigenschaft in der Ereignisklasse, um den Herausgeber Filter festzulegen.</span><span class="sxs-lookup"><span data-stu-id="ed882-105">Because it allows you to compose the event object with the [COM+ queued components](com--queued-components.md) service, the preferred method is to use the MultiPublisherFilterCLSID property in the event class to set the publisher filter.</span></span> <span data-ttu-id="ed882-106">Dadurch wird ein Filter Objekt für alle Methoden der Ereignis Schnittstellen für ein Ereignis Objekt festgelegt.</span><span class="sxs-lookup"><span data-stu-id="ed882-106">This establishes one filter object for all the methods of the event interfaces for an event object.</span></span> <span data-ttu-id="ed882-107">Das Ereignis Objekt aktiviert den Herausgeber Filter, wenn das Ereignis Klassenobjekt mithilfe von [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance)instanziiert wird.</span><span class="sxs-lookup"><span data-stu-id="ed882-107">The event object activates the publisher filter when the event class object is instantiated using [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span></span>
-   <span data-ttu-id="ed882-108">Sie können auch [**setpublisherfilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter)verwenden.</span><span class="sxs-lookup"><span data-stu-id="ed882-108">You can also use [**SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span></span> <span data-ttu-id="ed882-109">Wenn Sie diese Methode auswählen, kann die Schnittstelle jedoch nicht in die Warteschlange eingereiht werden und kann daher nicht das Ereignis Objekt mit dem com+-Dienst in der Warteschlange für die Warteschlange zwischen dem Verleger und dem Ereignis Klassenobjekt verwenden.</span><span class="sxs-lookup"><span data-stu-id="ed882-109">However, if you choose this method, the interface is not queuable and therefore cannot use the event object with the COM+ queued components service between the publisher and the event class object.</span></span> <span data-ttu-id="ed882-110">Weitere Informationen zur Verwendung des Dienstanbieter für die Warteschlange mit com+-Ereignissen finden Sie unter [Verwenden von COM+-Ereignissen mit COM+-Komponenten in der Warteschlange](using-com--events-with-com--queued-components.md).</span><span class="sxs-lookup"><span data-stu-id="ed882-110">For additional information about using the queued components service with COM+ Events, see [Using COM+ Events with COM+ Queued Components](using-com--events-with-com--queued-components.md).</span></span>

<span data-ttu-id="ed882-111">Ein Ereignis kann über ein oder mehrere Filter Objekte oder gar keine verfügen.</span><span class="sxs-lookup"><span data-stu-id="ed882-111">An event can have one or more filter objects or none at all.</span></span> <span data-ttu-id="ed882-112">Die Verleger Filter Objekte müssen entweder [**ipublisherfilter**](/windows/desktop/api/EventSys/nn-eventsys-ipublisherfilter) oder [**imultiinterfacepublisherfilter**](/windows/desktop/api/EventSys/nn-eventsys-imultiinterfacepublisherfilter)unterstützen, je nachdem, ob Sie über eine einzelne auslöserschnittstelle oder mehrere auslösenden Schnittstellen für das Ereignis Klassenobjekt verfügen.</span><span class="sxs-lookup"><span data-stu-id="ed882-112">The publisher filter objects must support either [**IPublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-ipublisherfilter) or [**IMultiInterfacePublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-imultiinterfacepublisherfilter), depending on whether you have a single firing interface or multiple firing interfaces on the event class object.</span></span> <span data-ttu-id="ed882-113">Die **ipublisherfilter** -Schnittstelle und die **imultiinterfacepublisherfilter** -Schnittstelle geben beide eine **Initialize** -Methode an.</span><span class="sxs-lookup"><span data-stu-id="ed882-113">The **IPublisherFilter** and **IMultiInterfacePublisherFilter** interfaces both specify an **Initialize** method.</span></span> <span data-ttu-id="ed882-114">Die **Initialize** -Methode wird direkt nach dem Erstellen des Filter Objekts vom Ereignis Klassenobjekt aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="ed882-114">The **Initialize** method is called by the event class object immediately after creating the filter object.</span></span>

<span data-ttu-id="ed882-115">Com+-Ereignisse versuchen, zwei Methoden für den Filter aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="ed882-115">COM+ Events tries to invoke two methods on the filter.</span></span> <span data-ttu-id="ed882-116">Zuerst wird [**ipublisherfilter::P**](/windows/desktop/api/EventSys/nf-eventsys-ipublisherfilter-preparetofire) Analyse Trigger aufgerufen und ein [**ifiringcontrol**](/windows/desktop/api/EventSys/nn-eventsys-ifiringcontrol) -Schnittstellen Zeiger an den Filter übergibt.</span><span class="sxs-lookup"><span data-stu-id="ed882-116">First it calls [**IPublisherFilter::PrepareToFire**](/windows/desktop/api/EventSys/nf-eventsys-ipublisherfilter-preparetofire) and passes an [**IFiringControl**](/windows/desktop/api/EventSys/nn-eventsys-ifiringcontrol) interface pointer to the filter.</span></span> <span data-ttu-id="ed882-117">Anschließend wird das Filter Objekt für die Ereignis Schnittstelle abgefragt.</span><span class="sxs-lookup"><span data-stu-id="ed882-117">Then it queries the filter object for the event interface.</span></span> <span data-ttu-id="ed882-118">Wenn der Filter die Ereignis Schnittstelle unterstützt, ruft er eine Methode dafür auf.</span><span class="sxs-lookup"><span data-stu-id="ed882-118">If the filter supports the event interface, it invokes a method on it.</span></span> <span data-ttu-id="ed882-119">Dies ermöglicht den Zugriff auf die Verleger Parameter für ein Ereignis.</span><span class="sxs-lookup"><span data-stu-id="ed882-119">This provides access to the publisher parameters for an event.</span></span> <span data-ttu-id="ed882-120">Der Filter kann diese Parameter verwenden, um zu bestimmen, welche Abonnements ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="ed882-120">The filter can use these parameters to determine which subscriptions to fire.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ed882-121">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ed882-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ed882-122">Filtern von Ereignissen in com+</span><span class="sxs-lookup"><span data-stu-id="ed882-122">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> </dl>

 

 
