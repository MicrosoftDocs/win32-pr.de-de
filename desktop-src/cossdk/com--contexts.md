---
description: Für konfigurierte Komponenten, die in com+-Anwendungen ausgeführt werden, sind Kontexte die Grundlage, auf der com+-Dienste bereitgestellt werden.
ms.assetid: 62a0bef2-c3c2-4a60-a5d1-6c038958e13e
title: Com+-Kontexte
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f0ae1228f89797f9124e817db07f11a23dbec12
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104393181"
---
# <a name="com-contexts"></a><span data-ttu-id="ca9cd-103">Com+-Kontexte</span><span class="sxs-lookup"><span data-stu-id="ca9cd-103">COM+ Contexts</span></span>

<span data-ttu-id="ca9cd-104">Für konfigurierte Komponenten, die in com+-Anwendungen ausgeführt werden, sind *Kontexte* die Grundlage, auf der com+-Dienste bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-104">For configured components running within COM+ applications, *contexts* are the foundation on which COM+ services are provided.</span></span> <span data-ttu-id="ca9cd-105">In com+ wird ein Kontext als Satz von Lauf Zeiteigenschaften definiert, die einem oder mehreren COM-Objekten zugeordnet sind, die für die Bereitstellung von Diensten für diese Objekte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-105">In COM+, a context is defined as set of run-time properties associated with one or more COM objects that are used to provide services for those objects.</span></span>

<span data-ttu-id="ca9cd-106">In com+ wird jedes COM-Objekt genau einem Kontext zugeordnet, während es ausgeführt wird (d. h. zwischen seiner Aktivierung und Deaktivierung), und jeder Kontext befindet sich in genau einem com-Apartment.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-106">In COM+, every COM object is associated with precisely one context as it runs (that is, between its activation and deactivation), and every context resides within precisely one COM apartment.</span></span> <span data-ttu-id="ca9cd-107">Mehrere Objekte können innerhalb desselben Kontexts ausgeführt werden, und mehrere Kontexte können sich im selben Apartment befinden.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-107">Multiple objects can run within the same context, and multiple contexts can reside within the same apartment.</span></span> <span data-ttu-id="ca9cd-108">Wird initialisiert, wenn ein Objekt aktiviert wird. Kontexteigenschaften, wie z. b. Sicherheitskontext Eigenschaften, stellen die Lauf Zeitanforderungen eines Objekts dar.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-108">Initialized when an object is activated, context properties, such as security context properties, represent the run-time needs of an object.</span></span>

> [!Note]  
> <span data-ttu-id="ca9cd-109">Für nicht konfigurierte Komponenten, die keine COM+-Dienste verwenden, wird der Kontext größtenteils ignoriert.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-109">For unconfigured components that do not use COM+ services, the context is, for the most part, ignored.</span></span>

 

<span data-ttu-id="ca9cd-110">Com+ verwendet Kontexteigenschaften als Grundlage für die Bereitstellung von Lauf Zeit Diensten.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-110">COM+ uses context properties as the basis for providing run-time services.</span></span> <span data-ttu-id="ca9cd-111">Diese Eigenschaften enthalten den Status, der bestimmt, wie die Ausführungsumgebung Dienste für Objekte innerhalb des Kontexts ausführt.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-111">These properties hold state that determines how the execution environment performs services for objects within the context.</span></span> <span data-ttu-id="ca9cd-112">In einigen Fällen können Sie direkt mit den Kontexteigenschaften eines Objekts interagieren, um einen Zustand anzugeben, der für einen Dienst relevant ist, der für das Objekt bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-112">In some cases, you can interact directly with an object's context properties to indicate some state relevant to a service being provided for the object.</span></span> <span data-ttu-id="ca9cd-113">Dies wäre z. b. der Fall, wenn ein Objekt, das an einer automatischen Transaktion teilnimmt, das Ergebnis der Transaktion abwählt.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-113">For example, you would do this when an object that is participating in an automatic transaction votes on the outcome of the transaction.</span></span>

<span data-ttu-id="ca9cd-114">Eine ausführliche Erläuterung der com-Grundlage dieser Konzepte finden Sie unter [Prozesse, Threads und Apartments](/windows/desktop/com/processes--threads--and-apartments).</span><span class="sxs-lookup"><span data-stu-id="ca9cd-114">For a detailed discussion of the COM foundation of these concepts, see [Processes, Threads, and Apartments](/windows/desktop/com/processes--threads--and-apartments).</span></span>

## <a name="programmatic-interaction-with-context-properties"></a><span data-ttu-id="ca9cd-115">Programmgesteuerte Interaktion mit Kontexteigenschaften</span><span class="sxs-lookup"><span data-stu-id="ca9cd-115">Programmatic Interaction with Context Properties</span></span>

<span data-ttu-id="ca9cd-116">Jeder Kontext verfügt über ein zugeordnetes [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) -Objekt, mit dem seine Eigenschaften nachverfolgt werden.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-116">Each context has an associated [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) object that keeps track of its properties.</span></span> <span data-ttu-id="ca9cd-117">Sie können auf **ObjectContext** zugreifen, indem Sie die [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-117">You can access **ObjectContext** by calling the [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) function.</span></span> <span data-ttu-id="ca9cd-118">Nachdem Sie auf **ObjectContext** zugegriffen haben, können Sie Methoden für die [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) -Schnittstelle aufrufen, die Sie zum Bearbeiten von Kontexteigenschaften verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-118">After you have accessed **ObjectContext**, you can call methods on the [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) interface it exposes to manipulate context properties.</span></span>

<span data-ttu-id="ca9cd-119">Wenn Sie z. [**b. IObjectContext:: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) aufrufen, wirkt sich das Transaktions Konsistenz Bit auf "konsistent" und die [JIT-Aktivierung](com--just-in-time-activation.md) auf "Done" in dem Kontext aus, der dem Objekt zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-119">For example, calling [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) has the effect of setting the transaction consistency bit to "consistent" and the [JIT-activation](com--just-in-time-activation.md) done bit to "done" on the context associated with the object.</span></span> <span data-ttu-id="ca9cd-120">"Konsistent" signalisiert com+, dass für die Transaktion ein Commit ausgeführt wird, und "Done" gibt an, dass das Objekt für die Deaktivierung bereit ist, wenn die Methode zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-120">"Consistent" signals to COM+ that you vote to commit the transaction, and "done" indicates that your object is ready to be deactivated when the method returns.</span></span>

<span data-ttu-id="ca9cd-121">Zusätzlich zu [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext)sind andere spezialisierte Schnittstellen, die Zugriff auf Kontexteigenschaften bereitstellen, [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate)und [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span><span class="sxs-lookup"><span data-stu-id="ca9cd-121">In addition to [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext), other specialized interfaces providing access to context properties are [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate), and [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span></span> <span data-ttu-id="ca9cd-122">Zu einem bestimmten Block greift [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) auch auf Kontexteigenschaften zu.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-122">To a certain extent, [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) also accesses context properties.</span></span> <span data-ttu-id="ca9cd-123">Sie können [**igetsecuritycallcontext:: getsecuritycallcontext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) zum Abrufen von **ISecurityCallContext** verwenden.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-123">You can use [**IGetSecurityCallContext::GetSecurityCallContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) to obtain **ISecurityCallContext**.</span></span>

## <a name="understanding-activation-and-interception"></a><span data-ttu-id="ca9cd-124">Grundlegendes zu Aktivierung und Abfang</span><span class="sxs-lookup"><span data-stu-id="ca9cd-124">Understanding Activation and Interception</span></span>

<span data-ttu-id="ca9cd-125">Im Allgemeinen müssen Sie den Kontext nur so betrachten, dass er eine Reihe von Eigenschaften darstellt, von denen Sie einige Eigenschaften festlegen oder die Sie für die Bereitstellung von COM+-Diensten für Ihre Komponenten verwenden können.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-125">Generally, you need to think about context only to the extent that it represents a number of properties, some of which you can set or get, that are used to provide COM+ services for your components.</span></span> <span data-ttu-id="ca9cd-126">In einigen Fällen müssen Sie jedoch möglicherweise die folgenden beiden miteinander verknüpften Facetten von Kontexten ausführlicher in Erwägung gezogen werden:</span><span class="sxs-lookup"><span data-stu-id="ca9cd-126">In some circumstances, however, you might need to consider the following two interrelated facets of contexts in greater detail:</span></span>

-   <span data-ttu-id="ca9cd-127">[Kontext Aktivierung](context-activation.md)oder die Initialisierung eines Objekts in einem geeigneten Kontext.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-127">[Context activation](context-activation.md), or the initialization of an object in an appropriate context.</span></span>
-   <span data-ttu-id="ca9cd-128">[Abfang](interception-of-cross-context-calls.md)Vorgänge oder Aktionen, die com+ bei Aufrufen über eine Kontext Grenze hinweg durchführt.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-128">[Interception](interception-of-cross-context-calls.md), or what COM+ does on calls across a context boundary.</span></span>

## <a name="relation-to-mts-context-wrappers"></a><span data-ttu-id="ca9cd-129">Beziehung zu MTS-Kontext Wrapper</span><span class="sxs-lookup"><span data-stu-id="ca9cd-129">Relation to MTS Context Wrappers</span></span>

<span data-ttu-id="ca9cd-130">Kontexte ersetzen die MTS-Kontext Wrapper.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-130">Contexts effectively replace the MTS context wrappers.</span></span> <span data-ttu-id="ca9cd-131">Der Zweck der Bereitstellung – das Bereitstellen automatischer Dienste durch das Abfangen von Erstellungs Anforderungen – ist nun eine integrierte Funktion von com+.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-131">The purpose they served—providing automatic services by trapping creation requests—is now an integrated feature of COM+.</span></span> <span data-ttu-id="ca9cd-132">Folglich ist es nicht mehr erforderlich, die [**saferef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) -Funktion zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-132">As a result, you no longer need to use the [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) function.</span></span> <span data-ttu-id="ca9cd-133">In MTS wurde **saferef** verwendet, um einen Verweis auf Ihr Objekt zu erhalten, das außerhalb des Kontext Wrappers übermittelt werden konnte.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-133">In MTS, **SafeRef** was used to obtain a reference to your object which could be passed outside of its context wrapper.</span></span> <span data-ttu-id="ca9cd-134">In com+ ist dies unnötig. normale Objekt Verweise (**diese** Zeiger) funktionieren.</span><span class="sxs-lookup"><span data-stu-id="ca9cd-134">In COM+, this is unnecessary; normal object references (**this** pointers) work.</span></span>

 

 
