---
description: Das Transaction-Attribut ist eine deklarative Eigenschaft, die Transaktionen für den Komponenten Entwickler automatisch verwaltet. Durch Festlegen dieses Attributs entfällt die Notwendigkeit, explizite Transaktionssteuer Elemente in der Komponente zu verwenden.
ms.assetid: ea0e4d7e-2598-4a42-993c-58815f2fa138
title: Konfigurieren von Transaktionen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b57f27d47836193dc5d23c44e3344cb2a81d5984
ms.sourcegitcommit: bf526e267d3991892733bdd229c66d5365cf244a
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/05/2021
ms.locfileid: "104562750"
---
# <a name="configuring-transactions"></a><span data-ttu-id="1e2ad-104">Konfigurieren von Transaktionen</span><span class="sxs-lookup"><span data-stu-id="1e2ad-104">Configuring Transactions</span></span>

<span data-ttu-id="1e2ad-105">Das *Transaction-Attribut* ist eine deklarative Eigenschaft, die Transaktionen für den Komponenten Entwickler automatisch verwaltet.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-105">The *transaction attribute* is a declarative property that automatically manages transactions for the component developer.</span></span> <span data-ttu-id="1e2ad-106">Durch Festlegen dieses Attributs entfällt die Notwendigkeit, explizite Transaktionssteuer Elemente in der Komponente zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-106">By setting this attribute, you eliminate the need to use explicit transaction controls in your component.</span></span>

<span data-ttu-id="1e2ad-107">Com+ verwendet das Transaktions Attribut der Komponente, um den Typ des Transaktions Schutzes zu ermitteln, der für jedes aktivierter Objekt erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-107">COM+ uses the component's transaction attribute to determine the type of transaction protection required for each object it activates.</span></span> <span data-ttu-id="1e2ad-108">Abhängig von der Anforderung kann ein Objekt die Transaktion des Aufrufers freigeben, eine neue Transaktion anfordern oder ohne Transaktions Schutz arbeiten.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-108">Depending on its requirement, an object can share its caller's transaction, require a new transaction, or operate without transaction protection.</span></span>

<span data-ttu-id="1e2ad-109">Com+ bietet die folgenden Transaktions Attributwerte:</span><span class="sxs-lookup"><span data-stu-id="1e2ad-109">COM+ provides the following transaction attribute values:</span></span>

<dl> <dt>

<span data-ttu-id="1e2ad-110"><span id="Disabled"></span><span id="disabled"></span><span id="DISABLED"></span>Deaktiviert</span><span class="sxs-lookup"><span data-stu-id="1e2ad-110"><span id="Disabled"></span><span id="disabled"></span><span id="DISABLED"></span>Disabled</span></span>
</dt> <dd>

<span data-ttu-id="1e2ad-111">Im Allgemeinen sollten Sie diesen Attribut Wert nur festlegen, wenn Sie sicher sind, dass die Komponente niemals auf einen Ressourcen-Manager zugreift.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-111">In general, you should set this attribute value only when you are sure that the component never accesses a resource manager.</span></span> <span data-ttu-id="1e2ad-112">Wenn Sie das Transaktions Attribut deaktivieren, ignoriert com+ die Transaktions Anforderungen der Komponente bei der Bestimmung der Kontext Platzierung des Objekts.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-112">When you disable the transaction attribute, COM+ ignores the transactional requirements of the component in determining context placement of the object.</span></span> <span data-ttu-id="1e2ad-113">Folglich kann das Objekt den Kontext (und die Transaktion) seines Aufrufers freigeben.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-113">As a result, the object can share its caller's context (and transaction).</span></span> <span data-ttu-id="1e2ad-114">Wenn Sie eine COM-Komponente zu com+ migrieren, müssen Sie das Transaktions Attribut deaktivieren, damit das gleiche Transaktionsverhalten wie die nicht konfigurierte COM-Komponente erhalten bleibt.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-114">When migrating a COM component to COM+, you must disable the transaction attribute to maintain the same transactional behavior as the unconfigured COM component.</span></span>

> [!Note]  
> <span data-ttu-id="1e2ad-115">Eine nicht *konfigurierte Komponente* ist eine COM-Komponente, die nicht in einer COM+-Anwendung installiert wurde.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-115">An *unconfigured component* is a COM component that has not been installed in a COM+ application.</span></span>

 

</dd> <dt>

<span data-ttu-id="1e2ad-116"><span id="Not_Supported"></span><span id="not_supported"></span><span id="NOT_SUPPORTED"></span>Nicht unterstützt</span><span class="sxs-lookup"><span data-stu-id="1e2ad-116"><span id="Not_Supported"></span><span id="not_supported"></span><span id="NOT_SUPPORTED"></span>Not Supported</span></span>
</dt> <dd>

<span data-ttu-id="1e2ad-117">Wenn Sie diesen Attribut Wert festlegen, stellt com+ sicher, dass jedes von der Komponente erstellte Objekt nie an einer Transaktion teilnimmt, unabhängig vom Transaktionsstatus seines Aufrufers.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-117">When you set this attribute value, COM+ ensures that any object created from the component never participates in a transaction, regardless of the transactional status of its caller.</span></span> <span data-ttu-id="1e2ad-118">Wenn Sie diesen Wert deklarieren, stellen Sie sicher, dass ein Objekt nicht in der Transaktion des Aufrufers Stimmen und keine eigene Transaktion starten kann.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-118">By declaring this value, you ensure that an object does not vote in its caller's transaction nor can it begin a transaction of its own.</span></span> <span data-ttu-id="1e2ad-119">Nicht unterstützt ist der Standardwert für alle Komponenten.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-119">Not Supported is the default value for all components.</span></span>

</dd> <dt>

<span data-ttu-id="1e2ad-120"><span id="Supported"></span><span id="supported"></span><span id="SUPPORTED"></span>Unterstützt</span><span class="sxs-lookup"><span data-stu-id="1e2ad-120"><span id="Supported"></span><span id="supported"></span><span id="SUPPORTED"></span>Supported</span></span>
</dt> <dd>

<span data-ttu-id="1e2ad-121">Wenn Sie diesen Attribut Wert festlegen, stellt com+ sicher, dass jedes von der Komponente erstellte Objekt an einer Transaktion teilnimmt, wenn eine solche vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-121">When you set this attribute value, COM+ ensures that any object created from the component participates in a transaction if one exists.</span></span> <span data-ttu-id="1e2ad-122">Sie deklarieren diesen Wert, wenn ein Objekt in der Transaktion des Aufrufers freigegeben werden soll, ohne dass eine eigene Transaktion erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-122">You declare this value when you want an object to share in its caller's transaction without requiring a transaction of its own.</span></span>

</dd> <dt>

<span data-ttu-id="1e2ad-123"><span id="Required"></span><span id="required"></span><span id="REQUIRED"></span>Erforderlich</span><span class="sxs-lookup"><span data-stu-id="1e2ad-123"><span id="Required"></span><span id="required"></span><span id="REQUIRED"></span>Required</span></span>
</dt> <dd>

<span data-ttu-id="1e2ad-124">Wenn Sie diesen Attribut Wert festlegen, stellt com+ sicher, dass jedes von der Komponente erstellte Objekt transaktional ist.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-124">When you set this attribute value, COM+ ensures that any object created from the component is transactional.</span></span> <span data-ttu-id="1e2ad-125">Wenn com+ ein Objekt mit der erforderlichen Einstellung aktiviert, prüft es den Transaktionsstatus des Aufrufers.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-125">When COM+ activates an object with the Required setting, it looks at the transactional status of its caller.</span></span> <span data-ttu-id="1e2ad-126">Wenn der Aufrufer über eine Transaktion verfügt, ist das neue-Objekt in der aktuellen Transaktion enthalten.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-126">If the caller has a transaction, the new object is included in the current transaction.</span></span> <span data-ttu-id="1e2ad-127">Andernfalls startet com+ eine Transaktion, sodass das neue Objekt zum Stamm der Transaktion wird.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-127">Otherwise, COM+ begins a transaction, making the new object the root of the transaction.</span></span> <span data-ttu-id="1e2ad-128">Dies ist die bevorzugte Einstellung für eine Komponente, die Ressourcen Aktivitäten ausführt, da Sie den Transaktions Schutz für diese Aktivitäten bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-128">This is the preferred setting for a component that performs resource activities because it helps provide transaction protection for those activities.</span></span>

</dd> <dt>

<span data-ttu-id="1e2ad-129"><span id="Requires_New"></span><span id="requires_new"></span><span id="REQUIRES_NEW"></span>Erfordert neu</span><span class="sxs-lookup"><span data-stu-id="1e2ad-129"><span id="Requires_New"></span><span id="requires_new"></span><span id="REQUIRES_NEW"></span>Requires New</span></span>
</dt> <dd>

<span data-ttu-id="1e2ad-130">Wenn Sie diesen Attribut Wert festlegen, stellt com+ sicher, dass alle Objekte, die von der Komponente erstellt werden, an einer neuen Transaktion als Stamm der Transaktion teilnehmen müssen, unabhängig vom Transaktionsstatus des Aufrufers.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-130">When you set this attribute value, COM+ ensures that any objects created from the component must participate in a new transaction as the root of the transaction, regardless of the transactional status of the caller.</span></span> <span data-ttu-id="1e2ad-131">Com+ initiiert automatisch eine neue Transaktion, die sich von der Transaktion des Aufrufers unterscheidet.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-131">COM+ automatically initiates a new transaction that is distinct from the caller's transaction.</span></span>

> [!Note]  
> <span data-ttu-id="1e2ad-132">Com+ unterstützt keine netsted Transactions.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-132">COM+ does not support nested transactions.</span></span> <span data-ttu-id="1e2ad-133">Wenn ein Transaktions Objekt eine andere Komponente aufruft, die als erforderlich markiert ist, erstellt com+ eine unabhängige transaktionale Grenze für das neu aktivierte Objekt.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-133">When one transactional object calls another component marked as Requires New, COM+ creates an independent transactional boundary for the newly activated object.</span></span> <span data-ttu-id="1e2ad-134">Die zweite Transaktion kann die erste Transaktion nicht beeinflussen, es sei denn, die erste Transaktion notiert explizit die Ergebnisse der zweiten Transaktion und ändert Ihre Stimme auf der Grundlage dieser Ergebnisse.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-134">The second transaction cannot affect the first transaction unless the first transaction explicitly notes the results of the second transaction and modifies its vote based on those results.</span></span>

 

</dd> </dl>

## <a name="transaction-attribute-dependencies"></a><span data-ttu-id="1e2ad-135">Transaktions Attribut Abhängigkeiten</span><span class="sxs-lookup"><span data-stu-id="1e2ad-135">Transaction Attribute Dependencies</span></span>

<span data-ttu-id="1e2ad-136">In der folgenden Tabelle werden die Merkmale der einzelnen com+-Transaktions Attributwerte angezeigt, einschließlich der Auswirkung des Werts auf die Transaktionseigenschaften.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-136">The following table shows the characteristics of each COM+ transaction attribute value, including the value's effect on transaction characteristics.</span></span> <span data-ttu-id="1e2ad-137">Com+ erzwingt die [JIT-Aktivierung](com--just-in-time-activation.md) und- [Synchronisierung](com--synchronization.md) für alle Transaktions Komponenten.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-137">COM+ enforces [JIT activation](com--just-in-time-activation.md) and [Synchronization](com--synchronization.md) for all transaction components.</span></span>



| <span data-ttu-id="1e2ad-138">Attributwert</span><span class="sxs-lookup"><span data-stu-id="1e2ad-138">Attribute Value</span></span>          | <span data-ttu-id="1e2ad-139">Neue Transaktion</span><span class="sxs-lookup"><span data-stu-id="1e2ad-139">New Transaction</span></span>   | <span data-ttu-id="1e2ad-140">Client Transaktion</span><span class="sxs-lookup"><span data-stu-id="1e2ad-140">Client's Transaction</span></span>                 | <span data-ttu-id="1e2ad-141">Transaktions Stamm</span><span class="sxs-lookup"><span data-stu-id="1e2ad-141">Transaction Root</span></span>                        | <span data-ttu-id="1e2ad-142">JIT-Aktivierung</span><span class="sxs-lookup"><span data-stu-id="1e2ad-142">JIT Activation</span></span>      | <span data-ttu-id="1e2ad-143">Synchronization</span><span class="sxs-lookup"><span data-stu-id="1e2ad-143">Synchronization</span></span>     |
|--------------------------|-------------------|--------------------------------------|-----------------------------------------|---------------------|---------------------|
| <span data-ttu-id="1e2ad-144">Disabled</span><span class="sxs-lookup"><span data-stu-id="1e2ad-144">Disabled</span></span><br/>      | <span data-ttu-id="1e2ad-145">Nie</span><span class="sxs-lookup"><span data-stu-id="1e2ad-145">Never</span></span><br/>  | <span data-ttu-id="1e2ad-146">Vielleicht</span><span class="sxs-lookup"><span data-stu-id="1e2ad-146">Maybe</span></span><br/>                     | <span data-ttu-id="1e2ad-147">Nie</span><span class="sxs-lookup"><span data-stu-id="1e2ad-147">Never</span></span><br/>                        | <span data-ttu-id="1e2ad-148">Optional</span><span class="sxs-lookup"><span data-stu-id="1e2ad-148">Optional</span></span><br/> | <span data-ttu-id="1e2ad-149">Optional</span><span class="sxs-lookup"><span data-stu-id="1e2ad-149">Optional</span></span><br/> |
| <span data-ttu-id="1e2ad-150">Nicht unterstützt</span><span class="sxs-lookup"><span data-stu-id="1e2ad-150">Not Supported</span></span><br/> | <span data-ttu-id="1e2ad-151">Nie</span><span class="sxs-lookup"><span data-stu-id="1e2ad-151">Never</span></span><br/>  | <span data-ttu-id="1e2ad-152">Nie</span><span class="sxs-lookup"><span data-stu-id="1e2ad-152">Never</span></span><br/>                     | <span data-ttu-id="1e2ad-153">Nie</span><span class="sxs-lookup"><span data-stu-id="1e2ad-153">Never</span></span><br/>                        | <span data-ttu-id="1e2ad-154">Optional</span><span class="sxs-lookup"><span data-stu-id="1e2ad-154">Optional</span></span><br/> | <span data-ttu-id="1e2ad-155">Optional</span><span class="sxs-lookup"><span data-stu-id="1e2ad-155">Optional</span></span><br/> |
| <span data-ttu-id="1e2ad-156">Unterstützt</span><span class="sxs-lookup"><span data-stu-id="1e2ad-156">Supported</span></span><br/>     | <span data-ttu-id="1e2ad-157">Nie</span><span class="sxs-lookup"><span data-stu-id="1e2ad-157">Never</span></span><br/>  | <span data-ttu-id="1e2ad-158">Wenn der Client über eine Transaktion verfügt</span><span class="sxs-lookup"><span data-stu-id="1e2ad-158">If client has transaction</span></span><br/> | <span data-ttu-id="1e2ad-159">Nie</span><span class="sxs-lookup"><span data-stu-id="1e2ad-159">Never</span></span><br/>                        | <span data-ttu-id="1e2ad-160">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="1e2ad-160">Required</span></span><br/> | <span data-ttu-id="1e2ad-161">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="1e2ad-161">Required</span></span><br/> |
| <span data-ttu-id="1e2ad-162">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="1e2ad-162">Required</span></span><br/>      | <span data-ttu-id="1e2ad-163">Vielleicht</span><span class="sxs-lookup"><span data-stu-id="1e2ad-163">Maybe</span></span><br/>  | <span data-ttu-id="1e2ad-164">Wenn der Client über eine Transaktion verfügt</span><span class="sxs-lookup"><span data-stu-id="1e2ad-164">If client has transaction</span></span><br/> | <span data-ttu-id="1e2ad-165">Wenn der Client keine Transaktion hat</span><span class="sxs-lookup"><span data-stu-id="1e2ad-165">If client has no transaction</span></span><br/> | <span data-ttu-id="1e2ad-166">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="1e2ad-166">Required</span></span><br/> | <span data-ttu-id="1e2ad-167">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="1e2ad-167">Required</span></span><br/> |
| <span data-ttu-id="1e2ad-168">Requires New</span><span class="sxs-lookup"><span data-stu-id="1e2ad-168">Requires New</span></span><br/>  | <span data-ttu-id="1e2ad-169">Always</span><span class="sxs-lookup"><span data-stu-id="1e2ad-169">Always</span></span><br/> | <span data-ttu-id="1e2ad-170">Nie</span><span class="sxs-lookup"><span data-stu-id="1e2ad-170">Never</span></span><br/>                     | <span data-ttu-id="1e2ad-171">Always</span><span class="sxs-lookup"><span data-stu-id="1e2ad-171">Always</span></span><br/>                       | <span data-ttu-id="1e2ad-172">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="1e2ad-172">Required</span></span><br/> | <span data-ttu-id="1e2ad-173">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="1e2ad-173">Required</span></span><br/> |



 

## <a name="transaction-boundaries"></a><span data-ttu-id="1e2ad-174">Transaktionsgrenzen</span><span class="sxs-lookup"><span data-stu-id="1e2ad-174">Transaction Boundaries</span></span>

<span data-ttu-id="1e2ad-175">Eine Transaktion verfügt über einen Anfang, ein Ende und tritt genau einmal auf.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-175">A transaction has a beginning, an end, and occurs exactly once.</span></span> <span data-ttu-id="1e2ad-176">Während der Ausführung kann eine Transaktion für eine Ressource, z. b. eine Datenbank oder Warteschlange, Aufrufe ausführen, um eine oder mehrere Tasks auszuführen.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-176">During its execution, a transaction may call on a resource, such as a database or queue, to accomplish one or more tasks.</span></span> <span data-ttu-id="1e2ad-177">Jede Ressource fällt in die *Transaktionsgrenze*.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-177">Each resource falls within the *transaction boundary*.</span></span> <span data-ttu-id="1e2ad-178">Alle Ressourcen innerhalb einer Transaktionsgrenze, die mehrere Prozess-und Computer Grenzen umfassen können, haben eine einzelne Transaktion gemeinsam.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-178">All resources within a transaction boundary, which can span multiple process and computer boundaries, share a single transaction.</span></span> <span data-ttu-id="1e2ad-179">Die Verwaltung von Konsistenz über diese Prozess-und Computer Grenzen hinweg ist wichtig.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-179">Managing consistency across these process and computer boundaries is important.</span></span>

<span data-ttu-id="1e2ad-180">Com+ gewährleistet die Konsistenz durch die automatische Verwaltung der Transaktionsgrenzen, basierend auf dem Wert des Transaktions Attributs, das Sie für die einzelnen Komponenten festgelegt haben.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-180">COM+ ensures consistency by managing transaction boundaries automatically, based on the value of the transaction attribute that you set for each component.</span></span> <span data-ttu-id="1e2ad-181">Eine COM+-Transaktion fließt automatisch zu den Objekten, die für die Teilnahme an einer Transaktion angewiesen sind, und umgeht Objekte, die außerhalb einer Transaktion ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-181">A COM+ transaction automatically flows to objects instructed to participate in a transaction and bypasses objects instructed to execute outside a transaction.</span></span> <span data-ttu-id="1e2ad-182">Com+ unterstützt keine netsted Transactions.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-182">COM+ does not support nested transactions.</span></span> <span data-ttu-id="1e2ad-183">Stattdessen sind com+-Transaktionen eindeutig und kurzlebig.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-183">Instead, COM+ transactions are distinct and short-lived.</span></span>

<span data-ttu-id="1e2ad-184">Das erste Objekt in einer Transaktionsgrenze ist für die Transaktion spezifisch und wird als Stamm *Objekt* der Transaktion bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-184">The first object in a transaction boundary is special to the transaction and is called the *root object* of the transaction.</span></span> <span data-ttu-id="1e2ad-185">Es darf nur ein Stamm Objekt in einer Transaktion vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-185">There can be only one root object in a transaction.</span></span> <span data-ttu-id="1e2ad-186">Alle anderen Objekte in der transaktionalen Hierarchie unter dem Root-Objekt werden als *innere Objekte* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-186">All other objects in the transactional hierarchy under the root object are called *interior objects*.</span></span>

## <a name="mapping-transactions"></a><span data-ttu-id="1e2ad-187">Zuordnung von Transaktionen</span><span class="sxs-lookup"><span data-stu-id="1e2ad-187">Mapping Transactions</span></span>

<span data-ttu-id="1e2ad-188">Eine Möglichkeit, um sicherzustellen, dass ein Objekt in der richtigen Transaktionsgrenze enthalten ist, ist das Zuordnen der Transaktionen, bevor Sie mit dem Schreiben der Komponenten beginnen.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-188">One way to ensure that an object is included in the correct transaction boundary is to map your transactions before you start writing your components.</span></span> <span data-ttu-id="1e2ad-189">Durch die Zuordnung von Transaktionen können Sie die beste Einstellung für jede Komponente ermitteln, die Sie schreiben.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-189">By mapping transactions, you can determine the best setting for each component you write.</span></span> <span data-ttu-id="1e2ad-190">Wenn Sie mehr darüber erfahren, wie Ihre Komponenten verwendet werden sollen, desto einfacher ist es, den richtigen Transaktions Attribut Wert auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-190">The more certain you are about how your components are to be used, the easier it is to select the correct transaction attribute value.</span></span>

<span data-ttu-id="1e2ad-191">Zur Laufzeit prüft com+ das Transaction-Attribut, um zu bestimmen, ob ein Objekt der Stamm einer neuen Transaktion, in einer vorhandenen Transaktion erstellt oder als nicht transaktionales Objekt erstellt werden soll.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-191">At run time, COM+ looks at the transaction attribute to determine whether an object should be the root of a new transaction, be created in an existing transaction, or be created as a non-transactional object.</span></span>

<span data-ttu-id="1e2ad-192">Die folgende Abbildung zeigt eine mögliche Transaktions Zuordnung.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-192">The following illustration shows a possible transaction mapping.</span></span> <span data-ttu-id="1e2ad-193">In der Abbildung erstellt der Client das Objekt 1, für das eine Transaktion erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-193">In the illustration, the client creates Object  1, which requires a transaction.</span></span> <span data-ttu-id="1e2ad-194">Da keine Transaktion vorhanden ist, erstellt COM+ Transaktion 1 und platziert Objekt 1 darin als Stamm Objekt.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-194">Because no transaction exists, COM+ creates Transaction 1 and places Object 1 in it as the root object.</span></span> <span data-ttu-id="1e2ad-195">Objekt 1 erstellt Objekt 2, das Transaktionen unterstützt und daher in Transaktion 1 platziert wird.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-195">Object 1 creates Object 2, which supports transactions and is therefore placed in Transaction 1.</span></span> <span data-ttu-id="1e2ad-196">Objekt 2 erstellt Objekt 3, das keine Transaktionen unterstützt und daher außerhalb aller Transaktionen platziert wird.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-196">Object 2 creates Object 3, which does not support transactions and therefore is placed outside all transactions.</span></span> <span data-ttu-id="1e2ad-197">Objekt 2 erstellt außerdem das Objekt 4, das eine Transaktion erfordert und daher in Transaktion 1 platziert wird.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-197">Object 2 also creates Object 4, which requires a transaction and is therefore placed in Transaction  1.</span></span> <span data-ttu-id="1e2ad-198">Objekt 3 erstellt Objekt 5, das Transaktionen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-198">Object 3 creates Object 5, which supports transactions.</span></span> <span data-ttu-id="1e2ad-199">Da Objekt 5 jedoch von einem Objekt erstellt wird, das in einer Transaktion nicht vorhanden ist, wird es auch außerhalb aller Transaktionen platziert.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-199">However, because Object 5 is created by an object that does not exist within a transaction, it also is placed outside all transactions.</span></span> <span data-ttu-id="1e2ad-200">Objekt 4 erstellt Objekt 6, das eine neue Transaktion erfordert, sodass COM+ Transaktion 2 erstellt und Objekt 6 darin als Stamm Objekt platziert.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-200">Object 4 creates Object 6, which requires a new transaction, so COM+ creates Transaction 2 and places Object 6 in it as the root object.</span></span> <span data-ttu-id="1e2ad-201">Objekt 6 erstellt das Objekt 7, das Transaktionen unterstützt und daher in Transaktion 2 platziert wird.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-201">Object 6 creates Object 7, which supports transactions and is therefore placed in Transaction 2.</span></span>

![Diagramm, das eine Client Interaktion mit Transaktion 1 und Transaktion 2 zeigt.](images/fc7e2d03-94c2-40d9-a79b-1e05ca31dd80.png)

<span data-ttu-id="1e2ad-203">Die obige Abbildung zeigt zwei mögliche Problembereiche.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-203">The preceding illustration shows two potential problem areas.</span></span> <span data-ttu-id="1e2ad-204">Zuerst wird der Großteil der Arbeit zwischen zwei unterschiedlichen Transaktionen aufgeteilt.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-204">First, the majority of work is split between two distinct transactions.</span></span> <span data-ttu-id="1e2ad-205">Wenn Transaktion 1 fehlschlägt, nachdem Objekt 4 Objekt 6 erstellt hat, wird Transaktion 2 durch das Ergebnis von Transaktion 1 nicht beeinträchtigt.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-205">If Transaction 1 fails after Object 4 creates Object 6, Transaction 2 runs unaffected by the outcome of Transaction 1.</span></span> <span data-ttu-id="1e2ad-206">Wenn dieses Ergebnis unbeabsichtigt ist, können Sie die Vorgänge beider Transaktionen in einer einzigen Transaktion durchführen, indem Sie das Transaktions Attribut von Objekt 6 in erforderlich ändern.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-206">If this outcome is unintended, you might prefer to fold the operations of both transactions into a single transaction, which you can accomplish by changing the transaction attribute of Object  6 to Required.</span></span>

<span data-ttu-id="1e2ad-207">Die Mapping-Abbildung zeigt auch, dass Objekt 3 und Objekt 5 nicht transaktional sind und vollständig außerhalb des Bereichs der Transaktionen 1 und 2 ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-207">The mapping illustration also shows that Object 3 and Object 5 are non-transactional, running completely outside the scope of Transactions 1 and 2.</span></span> <span data-ttu-id="1e2ad-208">Wenn Objekt 5 persistente Daten aktualisiert, empfiehlt es sich, den nicht transaktionalen Status zu überdenken.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-208">If Object 5 updates persistent data, you might want to reconsider its non-transactional status.</span></span> <span data-ttu-id="1e2ad-209">Objekt 5 kann in eine Transaktion eingefügt werden, indem das Transaktions Attribut in required geändert wird.</span><span class="sxs-lookup"><span data-stu-id="1e2ad-209">Object 5 can be placed within a transaction by changing its transaction attribute to Required.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1e2ad-210">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1e2ad-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1e2ad-211">Festlegen des Transaktions Attributs</span><span class="sxs-lookup"><span data-stu-id="1e2ad-211">Setting the Transaction Attribute</span></span>](setting-the-transaction-attribute.md)
</dt> </dl>

 

 




