---
description: In com+ wird jedes COM-Objekt mit einem zugeordneten Kontext erstellt.
ms.assetid: e5602af2-5852-4c34-a792-6742e90b7d41
title: Kontext Aktivierung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a652615d6c1288887085c857817e32e3a3b4081c
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104127149"
---
# <a name="context-activation"></a><span data-ttu-id="32daf-103">Kontext Aktivierung</span><span class="sxs-lookup"><span data-stu-id="32daf-103">Context Activation</span></span>

<span data-ttu-id="32daf-104">In com+ wird jedes COM-Objekt mit einem zugeordneten Kontext erstellt.</span><span class="sxs-lookup"><span data-stu-id="32daf-104">In COM+, every COM object is created with an associated context.</span></span> <span data-ttu-id="32daf-105">Dies bedeutet, dass entweder ein neuer Kontext erstellt und initialisiert werden muss oder ein entsprechender vorhandener Kontext verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="32daf-105">This means that either a new context must be created and initialized or an appropriate existing context is used.</span></span> <span data-ttu-id="32daf-106">Dieser Prozess wird als *Aktivierung* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="32daf-106">This process is known as *activation*.</span></span> <span data-ttu-id="32daf-107">In com+ wird ein Objekt entweder in einem eigenen Kontext oder in dessen Ersteller (ein Objekt, das die Aktivierung des Objekts angefordert hat – z. b. durch Aufrufen von [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance)) aktiviert.</span><span class="sxs-lookup"><span data-stu-id="32daf-107">In COM+, an object is activated either in its own context or in that of its creator (an object that has requested that the object be activated—for example, by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance)).</span></span>

<span data-ttu-id="32daf-108">In einigen Fällen, wie z. b. beim [Objekt Pooling](com--object-pooling.md), wird ein Objekt aktiviert, ohne dass es von Grund auf neu erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="32daf-108">In some circumstances, such as with [object pooling](com--object-pooling.md), an object is activated without being created from scratch.</span></span> <span data-ttu-id="32daf-109">In diesem Fall wird eine laufende Instanz innerhalb eines Kontexts aktiviert.</span><span class="sxs-lookup"><span data-stu-id="32daf-109">In this case, a running instance is activated within a context.</span></span> <span data-ttu-id="32daf-110">Während der Lebensdauer kann Sie in unterschiedlichen Kontexten wiederholt aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="32daf-110">Over its lifetime, it may be repeatedly activated in different contexts.</span></span>

<span data-ttu-id="32daf-111">Der grundlegende Mechanismus ist in beiden Fällen identisch – ein Objekt ist einem Kontext zugeordnet, und dieser Kontext wird ordnungsgemäß initialisiert, um die Lauf Zeitanforderungen des Objekts darzustellen.</span><span class="sxs-lookup"><span data-stu-id="32daf-111">The basic mechanism is the same in either case—an object is associated with a context and that context is properly initialized to represent the run-time needs of the object.</span></span>

## <a name="flowing-of-context-properties"></a><span data-ttu-id="32daf-112">Fluss von Kontexteigenschaften</span><span class="sxs-lookup"><span data-stu-id="32daf-112">Flowing of Context Properties</span></span>

<span data-ttu-id="32daf-113">Wenn ein Objekt als Antwort auf eine Erstellungs Anforderung von einem anderen Objekt aktiviert wird, muss com+ zwischen Ihnen vermitteln, um das Downstream-Objekt ordnungsgemäß zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="32daf-113">When an object is being activated in response to a creation request from another object, COM+ needs to mediate between them to properly activate the downstream object.</span></span> <span data-ttu-id="32daf-114">Com+ muss den Kontext des Aufrufers mit der Konfiguration der aufgerufenen Komponente vergleichen und dann entscheiden, wo die Downstreamkomponente aktiviert werden soll und wie deren Kontexteigenschaften initialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="32daf-114">COM+ has to compare the context of the caller with the configuration of the called component and then decide where to activate the downstream component and how to initialize its context properties.</span></span>

<span data-ttu-id="32daf-115">Um die Konfiguration der Komponente zu ermitteln, sucht com+ Sie in der com+-Klassen Registrierungsdatenbank, die für extrem schnelle Lauf Zeit Suchvorgänge optimiert ist.</span><span class="sxs-lookup"><span data-stu-id="32daf-115">To discover the component's configuration, COM+ looks it up in the COM+ class registration database, which is optimized for extremely fast run-time lookups.</span></span> <span data-ttu-id="32daf-116">(Dies wird dadurch bestimmt, wie Sie eine Komponente bei der Installation in einer COM+-Anwendung konfiguriert haben.) Die Konfiguration der Komponente wird dann anhand des Status der Kontexteigenschaften des Aufrufers überprüft.</span><span class="sxs-lookup"><span data-stu-id="32daf-116">(This is determined by how you configured a component when installing it into a COM+ application.) The component's configuration is then examined against the state of the caller's context properties.</span></span>

<span data-ttu-id="32daf-117">In einigen Fällen ist die Konfiguration mit dem Kontext des Aufrufers konsistent, und die Komponente kann im Kontext des Aufrufers aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="32daf-117">In some cases, the configuration is consistent with the context of the caller and the component can be activated within the caller's context.</span></span> <span data-ttu-id="32daf-118">Dies ist nur möglich, wenn der Kontext des Aufrufers alle Lauf Zeitanforderungen des neuen Objekts erfüllt.</span><span class="sxs-lookup"><span data-stu-id="32daf-118">This can happen only if the caller's context satisfies all the run-time requirements of the new object.</span></span>

<span data-ttu-id="32daf-119">Wenn die Downstreamkomponente nicht innerhalb des Aufrufers des Aufrufers aktiviert werden kann, wird Sie in einem eigenen Kontext in einem entsprechenden Apartment aktiviert.</span><span class="sxs-lookup"><span data-stu-id="32daf-119">When the downstream component cannot be activated within the caller's context, it is activated in its own context in an appropriate apartment.</span></span> <span data-ttu-id="32daf-120">Wenn dies auftritt, können bestimmte Kontexteigenschaften vom Aufrufer zum aufgerufenen weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="32daf-120">When this occurs, certain context properties may flow from caller to callee.</span></span> <span data-ttu-id="32daf-121">Wenn der Aufrufer z. b. einer Transaktion zugeordnet ist und der aufgerufene Transaktionen unterstützt, erhält das neue-Objekt seinen eigenen Kontext (für die Stimme in der Transaktion, er muss über ein eigenes konsistentes Flag verfügen) und erbt die Transaktions-ID und die Aktivitäts-ID des Aufrufers (die sich innerhalb derselben Transaktion und Synchronisierungs Domäne befinden).</span><span class="sxs-lookup"><span data-stu-id="32daf-121">For example, if the caller is associated with a transaction and the callee supports transactions, the new object gets its own context (to vote in the transaction, it needs to have its own consistent flag) and inherits the caller's transaction ID and activity ID (which reside within the same transaction and synchronization domain).</span></span>

## <a name="ignored-context-properties"></a><span data-ttu-id="32daf-122">Ignorierte Kontexteigenschaften</span><span class="sxs-lookup"><span data-stu-id="32daf-122">Ignored Context Properties</span></span>

<span data-ttu-id="32daf-123">Abhängig von der Konfiguration einer Komponente können einige Kontexteigenschaften keine Rolle spielen, um zu bestimmen, ob Sie im Kontext des Erstellers oder in Ihrem eigenen Kontext aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="32daf-123">Depending on how a component is configured, some context properties may play no role in determining whether it is activated in the creator's context or its own context.</span></span> <span data-ttu-id="32daf-124">Beispielsweise werden die Einstellungen deaktivierte Transaktionen und Synchronisierung deaktiviert, was darauf hinweist, dass eine Transaktion oder Synchronisierungs Domäne vorhanden ist, bei der Aktivierung der Komponente keine Rolle spielen.</span><span class="sxs-lookup"><span data-stu-id="32daf-124">For example, the Transactions Disabled and Synchronization Disabled settings, indicating the presence of a transaction or a synchronization domain, will play no role whatsoever in the component's activation.</span></span> <span data-ttu-id="32daf-125">Diese Eigenschaften werden grundsätzlich ignoriert, wenn der Kontext übertragen wird.</span><span class="sxs-lookup"><span data-stu-id="32daf-125">These properties are fundamentally ignored when context is flowed.</span></span> <span data-ttu-id="32daf-126">Wenn eine Komponente nur die Zugriffs Überprüfung auf Prozessebene verwendet, wird die zugehörige Sicherheitskontext Eigenschaft ignoriert – die Sicherheitskonfiguration der Komponente spielt nie eine Rolle bei der Aktivierung.</span><span class="sxs-lookup"><span data-stu-id="32daf-126">Or if a component uses only process-level access checking, its security context property is ignored—the component's security configuration will never play a role in its activation.</span></span>

## <a name="forcing-activation-in-the-callers-context"></a><span data-ttu-id="32daf-127">Erzwingen der Aktivierung im Kontext des Aufrufers</span><span class="sxs-lookup"><span data-stu-id="32daf-127">Forcing Activation in the Caller's Context</span></span>

<span data-ttu-id="32daf-128">Unter bestimmten Umständen möchten Sie möglicherweise, dass ein Objekt nur im Kontext seines Aufrufers aktiviert wird – das heißt, es wird nie in seinem eigenen Kontext aktiviert.</span><span class="sxs-lookup"><span data-stu-id="32daf-128">In some circumstances, you might want an object to be activated only in its caller's context—that is, never activated in its own context.</span></span> <span data-ttu-id="32daf-129">Beispielsweise können Sie das Verhalten des Objekts steuern, wenn es über eine Kontext Grenze aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="32daf-129">For example, you might want to control the object's behavior when it's called across a context boundary.</span></span>

<span data-ttu-id="32daf-130">Mithilfe des Verwaltungs Programms Komponenten Dienste können Sie sicherstellen, dass ein Objekt nicht in einem eigenen Kontext aktiviert werden kann, indem Sie die **Kontext Option muss in** Aufrufer aktivieren auf der Registerkarte **Aktivierung** der Seite Komponenten **Eigenschaften** auswählen.</span><span class="sxs-lookup"><span data-stu-id="32daf-130">You can ensure that an object cannot be activated in its own context by selecting the **Must be activated in callers context** option on the **Activation** tab of the component **Properties** page, using the Component Services administrative tool.</span></span> <span data-ttu-id="32daf-131">(Eine Schritt-für-Schritt-Anleitung finden Sie [unter Erzwingen der Aktivierung im Kontext des Aufrufers](enforcing-activation-in-the-caller-s-context.md) .) Wenn Sie diese Option auswählen und das Objekt nicht im Kontext des Aufrufers aktiviert werden kann, schlägt [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) fehl, und es wird ein Co \_ E- \_ Versuch \_ zur \_ Erstellung \_ außerhalb des \_ Client \_ Kontexts zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="32daf-131">(See [Enforcing Activation in the Caller's Context](enforcing-activation-in-the-caller-s-context.md) for step-by-step instructions.) When you select this option, if the object cannot be activated in the caller's context, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) fails, returning CO\_E\_ATTEMPT\_TO\_CREATE\_OUTSIDE\_CLIENT\_CONTEXT.</span></span>

## <a name="default-context"></a><span data-ttu-id="32daf-132">Standardkontext</span><span class="sxs-lookup"><span data-stu-id="32daf-132">Default Context</span></span>

<span data-ttu-id="32daf-133">Standard Kontexte können nicht konfigurierte Komponenten unterstützt werden, d. –. com-Komponenten, die nicht in com+-Anwendungen installiert sind und nicht in der com+-Klassen Registrierungsdatenbank registriert sind.</span><span class="sxs-lookup"><span data-stu-id="32daf-133">Default contexts exist to support unconfigured components—that is, COM components not installed in COM+ applications and not registered in the COM+ class registration database.</span></span> <span data-ttu-id="32daf-134">Wenn nicht konfigurierte Komponenten über ein kompatibles Threading Modell verfügen, werden Sie im Kontext des Aufrufers aktiviert.</span><span class="sxs-lookup"><span data-stu-id="32daf-134">If unconfigured components have a compatible threading model, they are activated in the caller's context.</span></span> <span data-ttu-id="32daf-135">Andernfalls werden Sie in einem Standardkontext im entsprechenden Apartment aktiviert.</span><span class="sxs-lookup"><span data-stu-id="32daf-135">Otherwise, they are activated in a default context in the appropriate apartment.</span></span> <span data-ttu-id="32daf-136">Jedes Apartment verfügt über einen Standardkontext zur Unterstützung von COM-Objekten, die keine COM+-Dienste verwenden.</span><span class="sxs-lookup"><span data-stu-id="32daf-136">Each apartment has a default context to support COM objects that do not use COM+ services.</span></span>

## <a name="hooking-activation"></a><span data-ttu-id="32daf-137">Aktivieren der Aktivierung</span><span class="sxs-lookup"><span data-stu-id="32daf-137">Hooking Activation</span></span>

<span data-ttu-id="32daf-138">Durch Implementieren von [**IObjectControl::**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) Activation und [**IObjectControl::D eaktivierung**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate)können Sie die Aktivierung und Deaktivierung verknüpfen, um eine spezielle Initialisierung im neuen Kontext auszuführen.</span><span class="sxs-lookup"><span data-stu-id="32daf-138">By implementing [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) and [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate), you can hook activation and deactivation together to perform special initialization in the new context.</span></span> <span data-ttu-id="32daf-139">Diese Methoden werden von com+ an bestimmten Punkten im Lebenszyklus eines Objekts aufgerufen, wenn das Objekt für die Verwendung der JIT-Aktivierung oder des Objekt Pooling konfiguriert ist.</span><span class="sxs-lookup"><span data-stu-id="32daf-139">These methods are called by COM+ at certain points in an object's lifecycle, when the object is configured to use JIT-activation or object pooling.</span></span> <span data-ttu-id="32daf-140">Ausführlichere Informationen finden Sie unter [com+ Just-in-Time-Aktivierung](com--just-in-time-activation.md) und [com+-Objekt Pooling](com--object-pooling.md) .</span><span class="sxs-lookup"><span data-stu-id="32daf-140">See [COM+ Just-in-Time Activation](com--just-in-time-activation.md) and [COM+ Object Pooling](com--object-pooling.md) for more detail.</span></span>

## <a name="related-topics"></a><span data-ttu-id="32daf-141">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="32daf-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="32daf-142">Abfangen von Kontext übergreifenden aufrufen</span><span class="sxs-lookup"><span data-stu-id="32daf-142">Interception of Cross-Context Calls</span></span>](interception-of-cross-context-calls.md)
</dt> </dl>

 

 
