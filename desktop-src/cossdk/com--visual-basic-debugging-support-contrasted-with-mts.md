---
description: Com+-Visual Basic Debugunterstützung im Vergleich zu MTS
ms.assetid: aa012f88-1f88-4c7f-b774-82b9e29da5e9
title: Com+-Visual Basic Debugunterstützung im Vergleich zu MTS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 038b29bbc6fbe5c8375f91f0006b85940f00b944
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106343608"
---
# <a name="com-visual-basic-debugging-support-contrasted-with-mts"></a><span data-ttu-id="9ef2e-103">Com+-Visual Basic Debugunterstützung im Vergleich zu MTS</span><span class="sxs-lookup"><span data-stu-id="9ef2e-103">COM+ Visual Basic Debugging Support Contrasted with MTS</span></span>

<span data-ttu-id="9ef2e-104">Durch com+ werden mehrere Einschränkungen beim Debuggen mit Microsoft Visual Basic 6,0 und MTS entfernt oder reduziert.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-104">COM+ removes or reduces several limitations of debugging with Microsoft Visual Basic 6.0 and MTS.</span></span> <span data-ttu-id="9ef2e-105">In der folgenden Liste werden die Änderungen zusammengefasst, die Sie mit com+ erwarten können:</span><span class="sxs-lookup"><span data-stu-id="9ef2e-105">The following list summarizes changes you can expect with COM+:</span></span>

-   <span data-ttu-id="9ef2e-106">Debuggen mehrerer Komponenten – in com+ können Sie Szenarios Debuggen, bei denen ein Client, der in einer Instanz der IDE ausgeführt wird, Aufrufe an eine beliebige Anzahl von DLLs ausführt, die in einer anderen als Projektgruppe ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-106">Debugging multiple components—In COM+, you can debug scenarios in which a client running in one instance of the IDE makes calls to any number of DLLs running in another as a project group.</span></span> <span data-ttu-id="9ef2e-107">Die Objekte in den gruppierten DLL-Projekten können einander beliebig aufzurufen, wobei der Kontext nach Bedarf fließt.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-107">The objects in the grouped DLL projects can call each other arbitrarily, flowing context as needed.</span></span> <span data-ttu-id="9ef2e-108">Dies funktioniert natürlich auch, wenn sich die DLLs und der Client in derselben Projektgruppe in derselben Instanz der IDE befinden.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-108">Of course, this also works when the DLLs and the client are in the same project group in the same instance of the IDE.</span></span>

-   <span data-ttu-id="9ef2e-109">Debuggrenzen bei Klassen \_ Initialisierungs-und Beendigungs \_ Ereignissen – mit com+ können Sie Code in der Klasse \_ initialisieren und \_ Beenden Ereignisse einer com+-Anwendungs Komponente einfügen, auch wenn dieser Code versucht, auf das Objekt oder das zugehörige Kontext Objekt zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-109">Debugging Limitations on Class\_Initialize and Class\_Terminate Events—With COM+, you can put code in the Class\_Initialize and Class\_Terminate events of a COM+ application component even if that code attempts to access the object or its corresponding context object.</span></span> <span data-ttu-id="9ef2e-110">Haltepunkte können dort festgelegt und Uhren verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-110">You can set breakpoints there and use watches.</span></span> <span data-ttu-id="9ef2e-111">Sie können auch Breakpoints im Class-Ereignis für die \_ Beendigung festlegen.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-111">You can also set breakpoints in the Class\_Terminate event.</span></span>

    <span data-ttu-id="9ef2e-112">Obwohl Sie nicht mehr als Problem Umgehung benötigt wird, können Sie die [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) -Schnittstelle implementieren und deren Aktivierungs- [**und**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) [**Deaktivierungs**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) Methoden verwenden, wenn Sie beim Starten und Herunterfahren der Komponente Code ausführen müssen.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-112">Although it is no longer needed as a workaround, you can still implement the [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) interface and use its [**Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) and [**Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) methods if you need to execute code during startup and shutdown of your component.</span></span> <span data-ttu-id="9ef2e-113">Sie können jetzt auch Haltepunkte für die Methoden " **Deaktivieren** " oder " [**CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) " in den Code einfügen.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-113">You can also now put breakpoints in code for the **Deactivate** or [**CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) methods.</span></span>

-   <span data-ttu-id="9ef2e-114">Überwachen von MTS-Objekten – mit com+ können Sie Überwachungen für Objektvariablen hinzufügen, die von com+ zurückgegeben werden, einschließlich Rückgabewerte der Methoden " [**saferef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef)", " [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext)" und " [**IObjectContext:: kreateinstance**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-createinstance) ".</span><span class="sxs-lookup"><span data-stu-id="9ef2e-114">Watching MTS Objects—With COM+, you can add watches for object variables returned by COM+, including return values from the [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef), [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext), and [**IObjectContext::CreateInstance**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-createinstance) methods.</span></span>

-   <span data-ttu-id="9ef2e-115">Höhere Stabilität bei Komponenten Fehlern – in com+ wird ein Komponenten Fehler nicht mehr immer beendet Visual Basic (die im selben Prozess wie die Komponente mit debuggt ausgeführt wird).</span><span class="sxs-lookup"><span data-stu-id="9ef2e-115">Increased stability when components fail—In COM+, a component failure will no longer always stop Visual Basic (which runs in the same process as the debugged component).</span></span> <span data-ttu-id="9ef2e-116">Beispielsweise können Sie mit der Unterstützung für Just-in-time (JIT)-Reaktivierungs Fehler jetzt den Objekt Kontext beim Debuggen überprüfen.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-116">For example, support for just-in-time (JIT) reactivation failures now allows you to look at the object context while debugging.</span></span>

-   <span data-ttu-id="9ef2e-117">Der Debugger kann die von com+ – freigegebenen Objekte reaktivieren, wie bei MTS, Visual Basic 6,0 COM+-Objekte reaktivieren, während Sie einen Einzelschritt über einen Client debuggen.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-117">Debugger may reactivate objects released by COM+—As with MTS, Visual Basic 6.0 may reactivate COM+ objects while you are debugging single-step through a client.</span></span> <span data-ttu-id="9ef2e-118">Aufgrund der Art und Weise, wie Visual Basic 6,0 Informationen zu Objekten entdeckt, ist dies das erwartete Verhalten.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-118">Because of the way that Visual Basic 6.0 discovers information about objects, this is expected behavior.</span></span> <span data-ttu-id="9ef2e-119">Beachten Sie z. B. folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="9ef2e-119">For example, consider the following code:</span></span>

    ``` syntax
    Dim obj As Object
    Set obj = CreateObject("MyApp.MyClass")
    obj.Test  'Call the user-defined subroutine named Test.
    Set obj = Nothing
    ```

    <span data-ttu-id="9ef2e-120">Wenn die obj. Die Test Methode ruft [**IObjectContext:: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete)auf, com+ gibt obj umgehend aus dem Arbeitsspeicher frei, aber obj wurde noch nicht auf "Nothing" festgelegt.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-120">If the obj.Test method calls [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete), COM+ immediately frees obj from memory, but obj has not yet been set to Nothing.</span></span> <span data-ttu-id="9ef2e-121">Wenn obj. Wenn der Test zurückgegeben wird, ruft der Visual Basic Debugger [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) für obj für die [**IProvideClassInfo**](/windows/desktop/api/ocidl/nn-ocidl-iprovideclassinfo) -Schnittstelle auf.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-121">When obj.Test returns, the Visual Basic debugger calls [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on obj for the [**IProvideClassInfo**](/windows/desktop/api/ocidl/nn-ocidl-iprovideclassinfo) interface.</span></span> <span data-ttu-id="9ef2e-122">Der Kontext Wrapper, der obj zugeordnet ist, erstellt eine neue Instanz von MyApp. MyClass, um den **QueryInterface** -Aufrufe zu bedienen.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-122">The context wrapper associated with obj creates a new instance of MyApp.MyClass to service the **QueryInterface** call.</span></span> <span data-ttu-id="9ef2e-123">Daher wird dieses nicht initialisierte Objekt im Debugger nach obj angezeigt. Der Test hat zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-123">As a result, you will see this uninitialized object in the debugger after obj.Test has returned.</span></span> <span data-ttu-id="9ef2e-124">Dieses Objekt wird nur im Debugger angezeigt und wird von der nachfolgenden Anweisung entfernt, um obj auf "Nothing" festzulegen.</span><span class="sxs-lookup"><span data-stu-id="9ef2e-124">This object appears only in the debugger and is removed by the subsequent instruction to set obj to Nothing.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9ef2e-125">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="9ef2e-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9ef2e-126">Debuggen kompilierter Visual Basic Komponenten</span><span class="sxs-lookup"><span data-stu-id="9ef2e-126">Debugging Compiled Visual Basic Components</span></span>](debugging-compiled-visual-basic-components.md)
</dt> <dt>

[<span data-ttu-id="9ef2e-127">Debuggen in der Visual Basic IDE</span><span class="sxs-lookup"><span data-stu-id="9ef2e-127">Debugging in the Visual Basic IDE</span></span>](debugging-in-the-visual-basic-ide.md)
</dt> </dl>

 

 
