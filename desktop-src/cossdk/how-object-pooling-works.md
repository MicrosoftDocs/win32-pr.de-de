---
description: Wenn Sie eine Komponente so konfigurieren, dass Sie in einem Pool zusammengefasst wird, verwaltet com+ Instanzen, die für jeden Client aktiviert werden können, der die Komponente anfordert. Alle Anforderungen zur Objekt Erstellung werden über den Pool-Manager verarbeitet.
ms.assetid: 34978b50-cd20-42fd-ad46-410190478ef8
title: Funktionsweise des Objekt Pooling
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f78784fc0e5362c14ceb598b404976c6ca494a19
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106346227"
---
# <a name="how-object-pooling-works"></a><span data-ttu-id="f0e83-104">Funktionsweise des Objekt Pooling</span><span class="sxs-lookup"><span data-stu-id="f0e83-104">How Object Pooling Works</span></span>

<span data-ttu-id="f0e83-105">Wenn Sie eine Komponente so konfigurieren, dass Sie in einem Pool zusammengefasst wird, verwaltet com+ Instanzen, die für jeden Client aktiviert werden können, der die Komponente anfordert.</span><span class="sxs-lookup"><span data-stu-id="f0e83-105">When you configure a component to be pooled, COM+ will maintain instances of it in a pool, ready to be activated for any client requesting the component.</span></span> <span data-ttu-id="f0e83-106">Alle Anforderungen zur Objekt Erstellung werden über den Pool-Manager verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="f0e83-106">Any object creation requests will be handled through the pool manager.</span></span>

<span data-ttu-id="f0e83-107">Pools werden pro Komponente konfiguriert und verwaltet.</span><span class="sxs-lookup"><span data-stu-id="f0e83-107">Pools are configured and maintained on a per-component basis.</span></span> <span data-ttu-id="f0e83-108">Ein Pool besteht aus homogenen Objekten, die dieselbe CLSID gemeinsam verwenden.</span><span class="sxs-lookup"><span data-stu-id="f0e83-108">A pool consists of homogeneous objects that share the same CLSID.</span></span> <span data-ttu-id="f0e83-109">Die einzige Ausnahme ist bei Transaktions Objekten, bei denen unter Pools verwaltet werden, die Objekte enthalten, die Transaktions Affinität aufweisen, während eine Transaktion aussteht.</span><span class="sxs-lookup"><span data-stu-id="f0e83-109">The only exception is for transactional objects, for which subpools are maintained containing objects that have transaction affinity while a transaction is pending.</span></span>

<span data-ttu-id="f0e83-110">Wenn die Anwendung gestartet wird, wird der Pool auf die minimale Ebene aufgefüllt, die Sie administrativ angegeben haben, solange die Objekt Erstellung erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="f0e83-110">When the application starts, the pool will be populated up to the minimum level that you have administratively specified, as long as object creation succeeds.</span></span> <span data-ttu-id="f0e83-111">Wenn Client Anforderungen für die Komponente eingehen, werden Sie bei der ersten bereitgestellten Basis aus dem Pool erfüllt.</span><span class="sxs-lookup"><span data-stu-id="f0e83-111">As client requests for the component come in, they are satisfied on a first-come first-served basis from the pool.</span></span> <span data-ttu-id="f0e83-112">Wenn keine in einem Pool zusammengefassten Objekte verfügbar sind und sich der Pool noch nicht auf der angegebenen maximalen Ebene befindet, wird ein neues Objekt erstellt und für den Client aktiviert.</span><span class="sxs-lookup"><span data-stu-id="f0e83-112">If no pooled objects are available and the pool is not yet at its specified maximum level, a new object is created and activated for the client.</span></span>

<span data-ttu-id="f0e83-113">Wenn die maximale Ebene des Pools erreicht wird, werden Client Anforderungen in die Warteschlange eingereiht und empfangen das erste verfügbare Objekt aus dem Pool.</span><span class="sxs-lookup"><span data-stu-id="f0e83-113">When the pool reaches its maximum level, client requests are queued and will receive the first available object from the pool.</span></span> <span data-ttu-id="f0e83-114">Die Anzahl der Objekte, einschließlich aktivierter und deaktivierter Objekte, überschreitet niemals den maximalen poolwert.</span><span class="sxs-lookup"><span data-stu-id="f0e83-114">The number of objects, including both activated and deactivated, will never exceed the maximum pool value.</span></span> <span data-ttu-id="f0e83-115">Bei Objekt Erstellungs Anforderungen tritt nach einem administrativ angegebenen Zeitraum ein Timeout auf, sodass Sie steuern können, wie lange Clients auf die Objekt Erstellung warten werden.</span><span class="sxs-lookup"><span data-stu-id="f0e83-115">Object creation requests will time out after an administratively specified period so that you can control how long clients will wait for object creation.</span></span> <span data-ttu-id="f0e83-116">Nach einem Timeout Fehler erhält der Client den Fehler E \_ Timeout von [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span><span class="sxs-lookup"><span data-stu-id="f0e83-116">Upon a time-out failure, the client will get back the error E\_TIMEOUT from [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span></span>

<span data-ttu-id="f0e83-117">Nach Möglichkeit versucht com+, ein Objekt wieder zu verwenden, nachdem es von einem Client freigegeben wurde, bis der Pool seine maximale Stufe erreicht hat.</span><span class="sxs-lookup"><span data-stu-id="f0e83-117">Whenever possible, COM+ will attempt to reuse an object after a client releases it, until the pool reaches its maximum level.</span></span> <span data-ttu-id="f0e83-118">Das Objekt ist für die Überwachung seines Zustands zuständig, um zu bestimmen, ob es wieder verwendet werden kann, und sollte einen entsprechenden Wert für [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled)zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="f0e83-118">The object is responsible for monitoring its state to determine whether it can be reused and should return an appropriate value for [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled).</span></span>

<span data-ttu-id="f0e83-119">Wenn ein in einem Pool zusammengestelltes Objekt erstellt wird, wird es in ein größeres Objekt aggregiert, das die Lebensdauer des Objekts verwaltet.</span><span class="sxs-lookup"><span data-stu-id="f0e83-119">When a pooled object is created, it is aggregated into a larger object that will manage the object's lifetime.</span></span> <span data-ttu-id="f0e83-120">Das äußere Objekt ruft Methoden für [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) zu den entsprechenden Zeitpunkten im Lebenszyklus des Objekts wie folgt auf:</span><span class="sxs-lookup"><span data-stu-id="f0e83-120">The outer object calls methods on [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) at appropriate times in the object's life cycle, as follows:</span></span>

-   <span data-ttu-id="f0e83-121">Die [**Aktivierungs**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) Methode wird immer dann aufgerufen, wenn das Objekt an einen Client zurückgegeben wird, der in einem bestimmten Kontext aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="f0e83-121">The [**Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) method is called whenever the object is returned to a client, activated in a specific context.</span></span>
-   <span data-ttu-id="f0e83-122">Die [**Deaktivierungs Methode wird**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) immer dann aufgerufen, wenn ein Objekt vom Client freigegeben wird, oder im Fall eines JIT-aktivierten Objekts, wenn es deaktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="f0e83-122">The [**Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) method is called whenever an object is released by the client or, in the case of a JIT-activated object, when it is deactivated.</span></span>
-   <span data-ttu-id="f0e83-123">Die [**CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) -Methode wird immer dann aufgerufen, wenn ein Objekt an den allgemeinen Pool zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f0e83-123">The [**CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) method is called whenever an object is to be returned to the general pool.</span></span> <span data-ttu-id="f0e83-124">Wenn das-Objekt erkennt, dass sich eine wiederverwendbare Ressource in einem ungültigen Zustand befindet, sollte für diese Methode **false** zurückgegeben werden, und der Pool-Manager verwirft das-Objekt.</span><span class="sxs-lookup"><span data-stu-id="f0e83-124">If the object detects that some reusable resource is in a bad state, it should return **FALSE** for this method and the pool manager will discard the object.</span></span>

<span data-ttu-id="f0e83-125">Ein Objekt muss [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol)nicht unbedingt implementieren.</span><span class="sxs-lookup"><span data-stu-id="f0e83-125">An object does not necessarily need to implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span></span> <span data-ttu-id="f0e83-126">Wenn dies nicht der Fall ist, werden die Instanzen immer wieder verwendet, bis die maximale Pool Ebene erreicht wird.</span><span class="sxs-lookup"><span data-stu-id="f0e83-126">If it does not, instances will always be reused, until the pool maximum level is reached.</span></span>

<span data-ttu-id="f0e83-127">Ausführliche Informationen zum Konfigurieren von Komponenten, die in einem Pool zusammengefasst werden sollen, finden Sie unter [Konfigurieren einer zu poolenden Komponente](configuring-a-component-to-be-pooled.md).</span><span class="sxs-lookup"><span data-stu-id="f0e83-127">For details about how to configure components to be pooled, see [Configuring a Component to Be Pooled](configuring-a-component-to-be-pooled.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="f0e83-128">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="f0e83-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f0e83-129">Com+-objektkonstruktorzeichenfolgen</span><span class="sxs-lookup"><span data-stu-id="f0e83-129">COM+ Object Constructor Strings</span></span>](com--object-constructor-strings.md)
</dt> <dt>

[<span data-ttu-id="f0e83-130">Steuern der Objekt Lebensdauer und des Zustands</span><span class="sxs-lookup"><span data-stu-id="f0e83-130">Controlling Object Lifetime and State</span></span>](controlling-object-lifetime-and-state.md)
</dt> <dt>

[<span data-ttu-id="f0e83-131">Verbessern der Leistung durch Objekt Pooling</span><span class="sxs-lookup"><span data-stu-id="f0e83-131">Improving Performance with Object Pooling</span></span>](improving-performance-with-object-pooling.md)
</dt> <dt>

[<span data-ttu-id="f0e83-132">Pooling von transaktionalen Objekten</span><span class="sxs-lookup"><span data-stu-id="f0e83-132">Pooling Transactional Objects</span></span>](pooling-transactional-objects.md)
</dt> <dt>

[<span data-ttu-id="f0e83-133">Anforderungen für in einem Pool Bare Objekte</span><span class="sxs-lookup"><span data-stu-id="f0e83-133">Requirements for Poolable Objects</span></span>](requirements-for-poolable-objects.md)
</dt> </dl>

 

 
