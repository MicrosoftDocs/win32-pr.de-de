---
description: Die CRM-Infrastruktur stellt eine Reihe von Schnittstellen bereit, die zum Überwachen der CRMs innerhalb einer bestimmten Serveranwendung verwendet werden können.
ms.assetid: b8f40c91-001b-4003-b377-57a918988100
title: Com+ CRM-Überwachungsschnittstellen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c893040c46810c980c647cbacdc808200e8d5f5e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104214093"
---
# <a name="com-crm-monitoring-interfaces"></a><span data-ttu-id="9c86e-103">Com+ CRM-Überwachungsschnittstellen</span><span class="sxs-lookup"><span data-stu-id="9c86e-103">COM+ CRM Monitoring Interfaces</span></span>

<span data-ttu-id="9c86e-104">Die CRM-Infrastruktur stellt eine Reihe von Schnittstellen bereit, die zum Überwachen der CRMs innerhalb einer bestimmten Serveranwendung verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="9c86e-104">The CRM infrastructure provides a set of interfaces that can be used for monitoring the CRMs within a particular server application.</span></span> <span data-ttu-id="9c86e-105">Um auf die Überwachungsschnittstellen zuzugreifen, muss eine Komponente, die in der Serveranwendung ausgeführt wird, zunächst einen spezialisierten CRM-Clerk erstellen, der als CRM-Wiederherstellungs Clerk bezeichnet</span><span class="sxs-lookup"><span data-stu-id="9c86e-105">To access the monitoring interfaces, a component running within the server application must first create a specialized CRM clerk called the CRM recovery clerk.</span></span>

<span data-ttu-id="9c86e-106">Bei der normalen Verwendung von CRMs wird erwartet, dass Transaktionen kurzlebig sind, sodass CRM-Worker und CRM-Kompensatoren für einen kurzen Zeitraum (in der Regel nur wenige Sekunden) vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="9c86e-106">In normal use of CRMs, transactions are expected to be short-lived, and hence CRM Workers and CRM Compensators exist for a brief period of time, typically only a few seconds at most.</span></span> <span data-ttu-id="9c86e-107">Die Überwachungsschnittstellen dienen daher zum Erstellen einer Momentaufnahme des Status der ausgeführten CRMs zu einem bestimmten Zeitpunkt.</span><span class="sxs-lookup"><span data-stu-id="9c86e-107">The monitoring interfaces are therefore designed to give a snapshot of the state of the executing CRMs at a particular point in time.</span></span> <span data-ttu-id="9c86e-108">Wenn bei einem der CRMs Probleme auftreten, können die Überwachungsschnittstellen auf dem problematischen CRM verwendet werden, um die Protokolldaten Sätze zu überprüfen und ggf. die Transaktion abzubrechen.</span><span class="sxs-lookup"><span data-stu-id="9c86e-108">If any of the CRMs are having problems, the monitoring interfaces can be used to zero in on the troublesome CRM, to inspect its log records and to abort its transaction if required.</span></span>

<span data-ttu-id="9c86e-109">Im folgenden finden Sie die drei CRM-Überwachungsschnittstellen und Beschreibungen ihrer Funktionsweise.</span><span class="sxs-lookup"><span data-stu-id="9c86e-109">Following are the three CRM monitoring interfaces and descriptions of how they work.</span></span>



| <span data-ttu-id="9c86e-110">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="9c86e-110">Interface</span></span>                                                         | <span data-ttu-id="9c86e-111">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="9c86e-111">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9c86e-112">**Icrmmonitor**</span><span class="sxs-lookup"><span data-stu-id="9c86e-112">**ICrmMonitor**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitor)<br/>                     | <span data-ttu-id="9c86e-113">Mithilfe von [**icrmmonitor:: getclerert**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-getclerks)kann eine Momentaufnahme der aktuellen Gruppe aktiver CRM-clerker innerhalb der Serveranwendung abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="9c86e-113">Using [**ICrmMonitor::GetClerks**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-getclerks), a snapshot can be obtained of the current set of active CRM clerks within the server application.</span></span> <span data-ttu-id="9c86e-114">Hierdurch kann ein bestimmtes CRM Clerk-Sammlungsobjekt, das von Interesse ist, gefunden und abgefragt werden, einschließlich des aktuellen Zustands der Transaktion und der Protokolldaten Sätze, die vom CRM geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="9c86e-114">From this, a particular CRM clerk collection object of interest can be located and queried, including the current state of its transaction and the log records written by the CRM.</span></span><br/> <span data-ttu-id="9c86e-115">Wenn das Überwachungs Tool festgestellt hat, welches Clerk von Interesse ist, ruft es [**icrmmonitor:: holdclerk**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-holdclerk) auf, um eine [**icrmmonitorlogrecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) -Schnittstelle für diesen bestimmten Clerk zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="9c86e-115">When the monitoring tool has determined which clerk is of interest, it calls [**ICrmMonitor::HoldClerk**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-holdclerk) to get an [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) interface on that particular clerk.</span></span> <span data-ttu-id="9c86e-116">An diesem Punkt hält das Überwachungs Tool einen Verweis auf diesen Clerk, und wenn die Transaktion abgeschlossen ist, wird der Clerk im Arbeitsspeicher gehalten und erst freigegeben, wenn das Überwachungs Tool fertiggestellt ist.</span><span class="sxs-lookup"><span data-stu-id="9c86e-116">At this point, the monitoring tool is holding a reference to that clerk, and if the transaction completes, the clerk is held in memory and is not released until the monitoring tool is done.</span></span><br/>                                                                                                                                                                                                    |
| [<span data-ttu-id="9c86e-117">**Icrmmonitorclerchs**</span><span class="sxs-lookup"><span data-stu-id="9c86e-117">**ICrmMonitorClerks**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorclerks)<br/>         | <span data-ttu-id="9c86e-118">Mithilfe dieser Schnittstelle kann das clerkauflistungsobjekt nach Informationen über den Zustand der clerkauflistung zu dem Zeitpunkt durchsucht werden, an dem Sie abgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="9c86e-118">Using this interface, the clerk collection object can be browsed for information about the state of the clerk collection at the moment it was obtained.</span></span> <span data-ttu-id="9c86e-119">Zu diesen Informationen zählen die Anzahl der Clerks, die ProgID des CRM-Kompensierungs Elements, die vom Clerk verwendet wurde, die Beschreibung, die zum Zeitpunkt der Registrierung des CRM-Compensators (mit [**icrmlogcontrol:: RegisterCompensator**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-registercompensator)), die Transaktions-ID der Arbeitseinheit und die Aktivitäts-ID bereitgestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="9c86e-119">This information includes the number of clerks, the ProgID of the CRM Compensator used by the clerk, the description provided at the time the CRM Compensator was registered (using [**ICrmLogControl::RegisterCompensator**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-registercompensator)), the transaction unit-of-work ID, and the activity ID.</span></span> <span data-ttu-id="9c86e-120">Einzelne Clerks werden auch durch eine "Clerk instance CLSID" eindeutig identifiziert, bei der es sich nicht um eine COM-CLSID handelt, die in der üblichen Bedeutung des Begriffs ist, aber einfach eine eindeutige GUID ist, die diesen bestimmten Clerk für seine Lebensdauer identifiziert.</span><span class="sxs-lookup"><span data-stu-id="9c86e-120">Individual clerks are also uniquely identified by a "clerk instance CLSID," which is not a COM CLSID in the usual sense of the term but simply a unique GUID that identifies this particular clerk for its lifetime.</span></span><br/>                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="9c86e-121">**Icrmmonitorlogrecords**</span><span class="sxs-lookup"><span data-stu-id="9c86e-121">**ICrmMonitorLogRecords**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords)<br/> | <span data-ttu-id="9c86e-122">Diese Schnittstelle kann verwendet werden, um den aktuellen Status der Transaktion abzufragen, um herauszufinden, wie viele Protokolldaten Sätze dieser CRM-Clerk geschrieben hat, und um die eigentlichen Protokolldaten Satz Daten zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="9c86e-122">This interface can be used to query the current state of the transaction, to find out how many log records this CRM clerk has written, and to get the actual log record data.</span></span> <span data-ttu-id="9c86e-123">Die Protokolldaten Sätze werden von der [**icrmmonitorlogrecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) -Schnittstelle im gleichen Format bereitgestellt, das Sie ursprünglich geschrieben haben (mithilfe von [**icrmlogcontrol**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol)).</span><span class="sxs-lookup"><span data-stu-id="9c86e-123">The log records are provided from the [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) interface in the same format that they were originally written (using [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol)).</span></span> <span data-ttu-id="9c86e-124">Außerdem kann **icrmmonitorlogrecords** optional implementiert werden, um die Protokolldaten Sätze in das sichtbare Format zu konvertieren, sodass Sie mit einem generischen Überwachungs Tool angezeigt werden können.</span><span class="sxs-lookup"><span data-stu-id="9c86e-124">In addition, **ICrmMonitorLogRecords** can be optionally implemented to convert the log records to viewable format so they can be presented using a generic monitoring tool.</span></span><br/> <span data-ttu-id="9c86e-125">Da [**icrmmonitorlogrecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) direkt auf dem CRM-Clerk implementiert ist, können Sie [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) für [**icrmlogcontrol**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) (auch auf dem CRM-Clerk implementiert) implementieren.</span><span class="sxs-lookup"><span data-stu-id="9c86e-125">Because [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) is implemented directly on the CRM clerk, you can [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) (also implemented on the CRM clerk).</span></span> <span data-ttu-id="9c86e-126">Dies kann dann verwendet werden, um die Transaktion bei Bedarf direkt abzubrechen ([**icrmlogcontrol:: forcetransaktiontoabort**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-forcetransactiontoabort)).</span><span class="sxs-lookup"><span data-stu-id="9c86e-126">This can then be used to directly abort the transaction if required ([**ICrmLogControl::ForceTransactionToAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-forcetransactiontoabort)).</span></span><br/> |



 

## <a name="related-topics"></a><span data-ttu-id="9c86e-127">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="9c86e-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9c86e-128">Kompensierende com+-Ressourcen-Manager Konzepte</span><span class="sxs-lookup"><span data-stu-id="9c86e-128">COM+ Compensating Resource Manager Concepts</span></span>](com--compensating-resource-manager-concepts.md)
</dt> </dl>

 

