---
description: Übergeben von Objekten als Parameter
ms.assetid: 174847c8-4545-4f61-ae13-42bdec1405e7
title: Übergeben von Objekten als Parameter
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a58e012138bc65cec481f714ac216bb8227fb924
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104524043"
---
# <a name="passing-objects-as-parameters"></a><span data-ttu-id="c44e9-103">Übergeben von Objekten als Parameter</span><span class="sxs-lookup"><span data-stu-id="c44e9-103">Passing Objects as Parameters</span></span>

<span data-ttu-id="c44e9-104">Der Dienst "com+-Warteschlangen Komponenten" ermöglicht keine Warteschlangen für jede vorhandene COM-Komponente.</span><span class="sxs-lookup"><span data-stu-id="c44e9-104">The COM+ queued components service does not enable queuing for every existing COM component.</span></span> <span data-ttu-id="c44e9-105">Es gibt Einschränkungen für die Typen von Methoden, die in die Warteschlange eingereiht werden können.</span><span class="sxs-lookup"><span data-stu-id="c44e9-105">There are restrictions on the types of methods that can be queued.</span></span> <span data-ttu-id="c44e9-106">Aufgrund von Messaging Einschränkungen müssen Methoden den folgenden Regeln entsprechen:</span><span class="sxs-lookup"><span data-stu-id="c44e9-106">Because of messaging constraints, methods must adhere to the following rules:</span></span>

-   <span data-ttu-id="c44e9-107">Sie müssen nur Eingabeparameter enthalten.</span><span class="sxs-lookup"><span data-stu-id="c44e9-107">They must contain input parameters only.</span></span>
-   <span data-ttu-id="c44e9-108">Sie müssen kein anwendungsspezifisches Ergebnis zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="c44e9-108">They must return no application-specific result.</span></span>

<span data-ttu-id="c44e9-109">Außerdem gibt es Einschränkungen hinsichtlich der Typen von Eingabe Parametern, die an eine in der Warteschlange eingereihte Komponente weitergegeben werden können.</span><span class="sxs-lookup"><span data-stu-id="c44e9-109">Additionally, there are restrictions on the types of input parameters that can be passed to a queued component.</span></span> <span data-ttu-id="c44e9-110">Zur Laufzeit verpackt der Dienst für in der Warteschlange befindliche Komponenten die Argumente auf dem Client und übergibt Sie mithilfe [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85))an die Serverkomponente.</span><span class="sxs-lookup"><span data-stu-id="c44e9-110">At run time, the queued components service packages the arguments at the client and passes them to the server component by using [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span></span> <span data-ttu-id="c44e9-111">Einfache Typen, z. b. ganze Zahlen und boolesche Werte, können problemlos gemarshallt werden – komplexere Typen können ohne Hilfe nicht gemarshallt werden.</span><span class="sxs-lookup"><span data-stu-id="c44e9-111">Simple types, such as integers and Booleans, can be marshaled easily—more complex types cannot be marshaled without help.</span></span>

<span data-ttu-id="c44e9-112">Wenn ein Objekt über den Methoden Aufrufder in der Warteschlange befindlichen Komponente als Parameter übergeben wird, übergibt der Client das Objekt an den Recorder.</span><span class="sxs-lookup"><span data-stu-id="c44e9-112">In the case of passing an object through a queued component's method call as a parameter, the client passes the object to the recorder.</span></span> <span data-ttu-id="c44e9-113">Die Aufzeichnung Marshalls das Objekt in eine Message Queuing Nachricht und übergibt sie an den Listener.</span><span class="sxs-lookup"><span data-stu-id="c44e9-113">The recorder marshals the object into a Message Queuing message and passes it to the listener.</span></span> <span data-ttu-id="c44e9-114">Nachdem der Listener die Nachricht übernommen und an den Player weitergeleitet hat, muss der Spieler das Objekt neu installieren, um es an den vom Client angegebenen Methoden Befehl zu verteilen.</span><span class="sxs-lookup"><span data-stu-id="c44e9-114">After the listener picks up the message and passes it to the player, the player must reinstantiate the object to dispatch it to the method call specified by the client.</span></span> <span data-ttu-id="c44e9-115">Basierend auf der Lebensdauer des Clients und des Servers in einer in der Warteschlange befindlichen Umgebung besteht die Auswirkung darauf, dass diese Objekte nach Wert marshallt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c44e9-115">Based on the lifetimes of the client and server in a queued environment, the implication is that these objects must be able to marshal by value.</span></span> <span data-ttu-id="c44e9-116">Da com+ keine Pass-by-Value-Semantik für com-Standardobjekte bereitstellt, benötigen der Recorder und der Player Hilfe von der Komponente, um das Objekt zu Mars Hallen und das Objekt zu entsperren.</span><span class="sxs-lookup"><span data-stu-id="c44e9-116">Because COM+ does not provide pass-by-value semantics for standard COM objects, the recorder and player need help from the component to marshal and unmarshal the object.</span></span>

<span data-ttu-id="c44e9-117">Objekt Verweise, die [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) unterstützen, können als Parameter für Methodenaufrufe von in der Warteschlange befindlichen Komponenten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="c44e9-117">Object references that support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) can be used as parameters to method calls on queued components.</span></span> <span data-ttu-id="c44e9-118">Das Objekt kann keine Annahmen darüber machen, wann es neu installiert wird.</span><span class="sxs-lookup"><span data-stu-id="c44e9-118">The object cannot make assumptions about when it will be reinstantiated.</span></span> <span data-ttu-id="c44e9-119">Beispielsweise ist der Server möglicherweise nicht verfügbar, oder die Serverkomponente wird erst später am Tag gestartet.</span><span class="sxs-lookup"><span data-stu-id="c44e9-119">For example, the server may be unavailable or the server component may not be started until later in the day.</span></span> <span data-ttu-id="c44e9-120">Bei Objekten, die **IPersistStream** nicht unterstützen, wird ein Fehler zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="c44e9-120">Objects that do not support **IPersistStream** will return an error.</span></span>

## <a name="visual-basic-persistable-objects"></a><span data-ttu-id="c44e9-121">Visual Basic Persistable-Objekte</span><span class="sxs-lookup"><span data-stu-id="c44e9-121">Visual Basic Persistable Objects</span></span>

<span data-ttu-id="c44e9-122">Microsoft Visual Basic 6 ermöglicht das Erstellen persierbarer Objekte.</span><span class="sxs-lookup"><span data-stu-id="c44e9-122">Microsoft Visual Basic 6 allows persistable objects to be created.</span></span> <span data-ttu-id="c44e9-123">Diese Objekte unterstützen [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) und können als Parameter an in die Warteschlange eingereihte Komponenten Methodenaufrufe übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="c44e9-123">These objects support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) and can be passed as parameters to queued component method calls.</span></span> <span data-ttu-id="c44e9-124">Bevor ein Visual Basic Objekt an eine in der Warteschlange eingereihte Komponente weitergeleitet werden kann, muss das persistbare Objekt initialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="c44e9-124">Before a Visual Basic object can be passed to a queued component, the persistable object must be initialized.</span></span> <span data-ttu-id="c44e9-125">Dies kann auf eine der beiden folgenden Arten erfolgen:</span><span class="sxs-lookup"><span data-stu-id="c44e9-125">This can be done in one of the following two ways:</span></span>

-   <span data-ttu-id="c44e9-126">Wenn die Anwendung, die das persistbare Objekt erstellt, in Visual Basic geschrieben wird, verarbeitet die Visual Basic-Laufzeit die Objekt Initialisierung automatisch.</span><span class="sxs-lookup"><span data-stu-id="c44e9-126">If the application creating the persistable object is written in Visual Basic, the Visual Basic runtime handles the object initialization automatically.</span></span>
-   <span data-ttu-id="c44e9-127">Wenn die Anwendung, die das Visual Basic permanenten-Objekt erstellt, in einer anderen Sprache als Visual Basic geschrieben wird, z. b. Microsoft Visual C++, muss die Anwendung die Komponente explizit initialisieren, indem die [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) -Schnittstelle des permanenten Objekts abgefragt oder die [**IPersistStreamInit:: InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)-Methode oder die [**IPersistStream:: Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) -Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="c44e9-127">If the application that creates the Visual Basic persistable object is written in a language other than Visual Basic, such as Microsoft Visual C++, the application must explicitly initialize the component by either querying for the persistable object's [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) interface or calling the [**IPersistStreamInit::InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew), or [**IPersistStream::Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) method.</span></span>

## <a name="ado-recordsets-and-ole-db-rowsets"></a><span data-ttu-id="c44e9-128">ADO-Recordsets und OLE DB-Rowsets</span><span class="sxs-lookup"><span data-stu-id="c44e9-128">ADO Recordsets and OLE DB Rowsets</span></span>

<span data-ttu-id="c44e9-129">Durch die Übergabe von ADO- **Recordset** -oder OLE DB-Rowsetobjekten zwischen Komponenten kann eine Komponente die Ergebnisse der von einer anderen Komponente ausgeführten Abfragen verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="c44e9-129">Passing ADO **Recordset** or OLE DB rowset objects between components allows one component to process the results of queries executed by another component.</span></span> <span data-ttu-id="c44e9-130">Dies ist hilfreich, wenn Sie eine Anwendung auf mehreren Computern bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="c44e9-130">This is helpful when deploying an application across multiple computers.</span></span> <span data-ttu-id="c44e9-131">**Recordset** -und Rowsetobjekte können als Methoden Parameter an Komponenten in der Warteschlange mit den folgenden Einschränkungen übermittelt werden:</span><span class="sxs-lookup"><span data-stu-id="c44e9-131">**Recordset** and rowset objects can be passed as method parameters to queued components, with the following restrictions:</span></span>

-   <span data-ttu-id="c44e9-132">Server seitige **Recordset** -Objekte können nicht mithilfe von [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream)gemarshallt werden.</span><span class="sxs-lookup"><span data-stu-id="c44e9-132">Server-side **Recordset** objects cannot be marshaled using [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span></span> <span data-ttu-id="c44e9-133">Nur Client seitige Recordsetobjekte können als Parameter an einen in der Warteschlange eingereihten Komponenten Methoden aufgerufen werden. </span><span class="sxs-lookup"><span data-stu-id="c44e9-133">Only client-side **Recordset** objects can be passed as parameters to a queued component method call.</span></span>
-   <span data-ttu-id="c44e9-134">Wenn Sie direkt mit OLE DB arbeiten, muss das OLE DB-Rowset als Client seitiges Rowset definiert werden.</span><span class="sxs-lookup"><span data-stu-id="c44e9-134">If you work directly with OLE DB, the OLE DB rowset must be defined as a client-side rowset.</span></span>

 

 
