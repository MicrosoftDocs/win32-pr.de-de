---
description: Festlegen der konsistenten und done-Flags
ms.assetid: d9b6096d-f93c-4f8e-a4d9-ea8309b35f0f
title: Festlegen der konsistenten und done-Flags
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fd45d457828a222ce7f4ccbdc0080001b0f0b55f
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104483022"
---
# <a name="setting-the-consistent-and-done-flags"></a><span data-ttu-id="f5d3c-103">Festlegen der konsistenten und done-Flags</span><span class="sxs-lookup"><span data-stu-id="f5d3c-103">Setting the Consistent and Done Flags</span></span>

<span data-ttu-id="f5d3c-104">Sie legen die konsistenten und done-Flags fest, indem Sie Methoden für die [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) -oder die [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate) -Schnittstelle aufrufen.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-104">You set the consistent and done flags by invoking methods on either the [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) or the [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate) interfaces.</span></span> <span data-ttu-id="f5d3c-105">Die von diesen beiden Schnittstellen verwendeten Strategien unterscheiden sich erheblich.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-105">The strategies used by these two interfaces differ significantly.</span></span> <span data-ttu-id="f5d3c-106">**IObjectContext** verfügt über vier Methoden, die die konsistenten und done-Flags in eindeutigen Kombinationen zusammenbinden, während **IContextState** über zwei Methoden verfügt, die es Ihnen ermöglichen, jedes Flag unabhängig festzulegen.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-106">**IObjectContext** has four methods that bind the consistent and done flags together in unique combinations, while **IContextState** has two methods that allow you to set each flag independently.</span></span> <span data-ttu-id="f5d3c-107">Die Methoden von **IObjectContext** werden auch über das [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) -Objekt verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-107">The methods of **IObjectContext** are also exposed through the [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) object.</span></span>

<span data-ttu-id="f5d3c-108">Zum unabhängigen Steuern der einzelnen Flags bietet [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate) eine Methode, um das konsistente Flag auf true oder false festzulegen, und eine Methode, um das done-Flag auf true oder false festzulegen.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-108">For independent control of each flag, [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate) provides a method to set the consistent flag to True or False and a method to set the done flag to True or False.</span></span> <span data-ttu-id="f5d3c-109">Diese Methoden sind [**setmytransaktionvote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) bzw. [**setDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn).</span><span class="sxs-lookup"><span data-stu-id="f5d3c-109">These methods are [**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) and [**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn), respectively.</span></span> <span data-ttu-id="f5d3c-110">Die **IContextState** -Schnittstelle enthält auch Methoden zum Abrufen des aktuellen Werts der einzelnen Flags.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-110">The **IContextState** interface also includes methods to retrieve the current value of each flag.</span></span>

<span data-ttu-id="f5d3c-111">Wenn Sie den [**setmytransaktionvote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) -Methoden Wert auf txcommit festlegen, überprüft com+, ob eine Transaktion vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-111">When you set the [**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) method value to TxCommit, COM+ verifies the presence of a transaction.</span></span> <span data-ttu-id="f5d3c-112">Wenn com+ keine Transaktion erkennt, wird ein Fehler generiert, den Sie in einer Protokolldatei erfassen können.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-112">If COM+ does not detect a transaction, it generates an error that you can capture in a log file.</span></span> <span data-ttu-id="f5d3c-113">Nehmen wir beispielsweise an, dass jemand versehentlich das Transaktions Attribut Ihrer Komponente so konfiguriert, dass es nicht unterstützt wird</span><span class="sxs-lookup"><span data-stu-id="f5d3c-113">For example, suppose someone inadvertently configures your component's transaction attribute to Not Supported but you expected it to be set to Required.</span></span> <span data-ttu-id="f5d3c-114">Durch Festlegen von **setmytransaction Vote** = txcommit können Sie den Konflikt identifizieren und Maßnahmen ergreifen.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-114">By setting **SetMyTransactionVote** = TxCommit, you can identify the conflict and take action.</span></span>

<span data-ttu-id="f5d3c-115">In der folgenden Tabelle werden die Methodenaufrufe beschrieben, die verwendet werden können, um die konsistenten und done-Flags festzulegen.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-115">The following table describes the method calls that can be used to set the consistent and done flags.</span></span>



| <span data-ttu-id="f5d3c-116">Konsistentes Flag</span><span class="sxs-lookup"><span data-stu-id="f5d3c-116">Consistent flag</span></span>  | <span data-ttu-id="f5d3c-117">Done-Flag</span><span class="sxs-lookup"><span data-stu-id="f5d3c-117">Done flag</span></span>        | <span data-ttu-id="f5d3c-118">IObjectContext-Methode</span><span class="sxs-lookup"><span data-stu-id="f5d3c-118">IObjectContext method</span></span>                                            | <span data-ttu-id="f5d3c-119">IContextState-Methoden</span><span class="sxs-lookup"><span data-stu-id="f5d3c-119">IContextState methods</span></span>                                                                                                                                                                                    |
|------------------|------------------|------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f5d3c-120">Richtig</span><span class="sxs-lookup"><span data-stu-id="f5d3c-120">True</span></span><br/>  | <span data-ttu-id="f5d3c-121">False</span><span class="sxs-lookup"><span data-stu-id="f5d3c-121">False</span></span><br/> | [<span data-ttu-id="f5d3c-122">**EnableCommit**</span><span class="sxs-lookup"><span data-stu-id="f5d3c-122">**EnableCommit**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-enablecommit)<br/>   | <span data-ttu-id="f5d3c-123">[**Setmytransaktionvote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txvote* = txcommit</span><span class="sxs-lookup"><span data-stu-id="f5d3c-123">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxCommit</span></span> <br/> <span data-ttu-id="f5d3c-124">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeaktivieren* = false</span><span class="sxs-lookup"><span data-stu-id="f5d3c-124">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = False</span></span><br/> |
| <span data-ttu-id="f5d3c-125">False</span><span class="sxs-lookup"><span data-stu-id="f5d3c-125">False</span></span><br/> | <span data-ttu-id="f5d3c-126">False</span><span class="sxs-lookup"><span data-stu-id="f5d3c-126">False</span></span><br/> | [<span data-ttu-id="f5d3c-127">**DisableCommit**</span><span class="sxs-lookup"><span data-stu-id="f5d3c-127">**DisableCommit**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-disablecommit)<br/> | <span data-ttu-id="f5d3c-128">[**Setmytransaktionvote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txvote* = txabort</span><span class="sxs-lookup"><span data-stu-id="f5d3c-128">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxAbort</span></span> <br/> <span data-ttu-id="f5d3c-129">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeaktivieren* = false</span><span class="sxs-lookup"><span data-stu-id="f5d3c-129">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = False</span></span><br/>  |
| <span data-ttu-id="f5d3c-130">False</span><span class="sxs-lookup"><span data-stu-id="f5d3c-130">False</span></span><br/> | <span data-ttu-id="f5d3c-131">True</span><span class="sxs-lookup"><span data-stu-id="f5d3c-131">True</span></span><br/>  | [<span data-ttu-id="f5d3c-132">**SetAbort**</span><span class="sxs-lookup"><span data-stu-id="f5d3c-132">**SetAbort**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort)<br/>           | <span data-ttu-id="f5d3c-133">[**Setmytransaktionvote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txvote* = txabort</span><span class="sxs-lookup"><span data-stu-id="f5d3c-133">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxAbort</span></span> <br/> <span data-ttu-id="f5d3c-134">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeaktivieren* = true</span><span class="sxs-lookup"><span data-stu-id="f5d3c-134">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = True</span></span><br/>   |
| <span data-ttu-id="f5d3c-135">True</span><span class="sxs-lookup"><span data-stu-id="f5d3c-135">True</span></span><br/>  | <span data-ttu-id="f5d3c-136">True</span><span class="sxs-lookup"><span data-stu-id="f5d3c-136">True</span></span><br/>  | [<span data-ttu-id="f5d3c-137">**SetComplete**</span><span class="sxs-lookup"><span data-stu-id="f5d3c-137">**SetComplete**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete)<br/>     | <span data-ttu-id="f5d3c-138">[**Setmytransaktionvote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txvote* = txcommit</span><span class="sxs-lookup"><span data-stu-id="f5d3c-138">[**SetMyTransactionVote**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setmytransactionvote) *txVote* = TxCommit</span></span> <br/><span data-ttu-id="f5d3c-139">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeaktivieren* = true</span><span class="sxs-lookup"><span data-stu-id="f5d3c-139">[**SetDeactivateOnReturn**](/windows/desktop/api/ComSvcs/nf-comsvcs-icontextstate-setdeactivateonreturn) *bDeactivate* = True</span></span>              |



 

> [!Note]  
> <span data-ttu-id="f5d3c-140">Die Auto-done-Eigenschaft, die auf Methoden Ebene festgelegt wird, kann sich darauf auswirken, wie die konsistenten und done-Flags festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="f5d3c-140">The auto-done property, which is set at the method level, can affect how the consistent and done flags are set.</span></span> <span data-ttu-id="f5d3c-141">Weitere Informationen zur Eigenschaft automatisch abgeschlossen finden Sie unter Aktivieren der [automatischen Ausführung für eine Methode](enabling-auto-done-for-a-method.md) und [Festlegen des done-Bits](setting-the-done-bit.md).</span><span class="sxs-lookup"><span data-stu-id="f5d3c-141">For more information regarding the auto-done property, see [Enabling Auto-Done for a Method](enabling-auto-done-for-a-method.md) and [Setting the Done Bit](setting-the-done-bit.md).</span></span>

 

 

 




