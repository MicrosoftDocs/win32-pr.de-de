---
description: Der Just-in-time (JIT)-Aktivierungs Dienst ermöglicht com+, ein Objekt zu deaktivieren, während ein Client weiterhin einen aktiven Verweis auf das Objekt enthält.
ms.assetid: dbc7b257-8506-42c8-8a78-3474c6d4f4b6
title: Konzepte für die Just-in-Time-Aktivierung in com+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6c942bfeb342ea305083e0c7d7ebdea2fe96bf24
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106344597"
---
# <a name="com-just-in-time-activation-concepts"></a><span data-ttu-id="25d70-103">Konzepte für die Just-in-Time-Aktivierung in com+</span><span class="sxs-lookup"><span data-stu-id="25d70-103">COM+ Just-in-Time Activation Concepts</span></span>

<span data-ttu-id="25d70-104">Der Just-in-time (JIT)-Aktivierungs Dienst ermöglicht com+, ein Objekt zu deaktivieren, während ein Client weiterhin einen aktiven Verweis auf das Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="25d70-104">The just-in-time (JIT) activation service enables COM+ to deactivate an object while a client still holds an active reference to that object.</span></span> <span data-ttu-id="25d70-105">Wenn der Client das nächste Mal eine Methode für das Objekt aufruft, die für den Client weiterhin aktiv sein soll, wird das Objekt vom com+-JIT-Aktivierungs Dienst auf dem Client, Just-in-Time, erneut transparent auf dem Client aktiviert.</span><span class="sxs-lookup"><span data-stu-id="25d70-105">The next time the client calls a method on the object, which the client believes to be still active, the COM+ JIT activation service reactivates the object transparently to the client, just in time.</span></span>

<span data-ttu-id="25d70-106">Der Hauptvorteil bei der Verwendung der com + JIT-Aktivierung besteht darin, dass Sie es Clients ermöglichen können, Verweise auf Objekte so lange zu speichern, wie Sie Sie benötigen, ohne notwendigerweise wertvolle Server Ressourcen wie z. b. Arbeitsspeicher zu binden.</span><span class="sxs-lookup"><span data-stu-id="25d70-106">The main advantage of using COM + JIT activation is that you can enable clients to hold references to objects for as long as they need them, without necessarily tying up valuable server resources such as memory.</span></span> <span data-ttu-id="25d70-107">Weitere wichtige Vorteile sind folgende:</span><span class="sxs-lookup"><span data-stu-id="25d70-107">Other important benefits include the following:</span></span>

-   <span data-ttu-id="25d70-108">Durch die Verwendung des com+-JIT-Aktivierungs Dienstanbieter wird das Programmiermodell für den Client erheblich vereinfacht, da der Client nicht mehr über die Verwendung kostspieliger Server Objekte und Server Ressourcen nachzudenken.</span><span class="sxs-lookup"><span data-stu-id="25d70-108">Using the COM+ JIT activation service greatly simplifies the programming model for the client because the client doesn't have to think about how it uses expensive server objects and server resources.</span></span> <span data-ttu-id="25d70-109">Ohne die JIT-Aktivierung können Clients einen erheblichen Nachteil verursachen, wenn Sie häufig-Objekte aufzurufen und freigeben müssen.</span><span class="sxs-lookup"><span data-stu-id="25d70-109">Without JIT activation, clients can incur a significant penalty when they frequently need to call and release objects.</span></span>
    > [!Note]  
    > <span data-ttu-id="25d70-110">Sie können diesen Leistungsvorteil weiter verfeinern, indem Sie den [com+-objektpoolingdienst](com--object-pooling.md) verwenden.</span><span class="sxs-lookup"><span data-stu-id="25d70-110">You can refine this performance benefit further by using the [COM+ Object Pooling](com--object-pooling.md) service.</span></span> <span data-ttu-id="25d70-111">Durch das Pooling von JIT-aktivierten Objekten können Sie die Objekt Reaktivierung für Clients erheblich beschleunigen, während Sie die Ressourcen wieder verwenden, die Sie möglicherweise aufrechterhalten. so können Sie genau steuern, wie viel Arbeitsspeicher von einem bestimmten Objekt auf dem Server verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="25d70-111">By pooling JIT-activated objects, you can greatly speed object reactivation for clients while reusing whatever resources they might be holding, giving you more precise control over how much memory is used by a given object on the server.</span></span> <span data-ttu-id="25d70-112">Weitere Details finden Sie unter [Object Pooling und com+ JIT Activation](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="25d70-112">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

     

-   <span data-ttu-id="25d70-113">Bei verteilten Anwendungen ist ein kostspieliger Netzwerkroundtrip erforderlich, um jedes Objekt zu erstellen, und je weiter der Client vom Server entfernt wird, desto höher sind die Kosten für das Aktivieren und Marshalling des Server Objekts, das Öffnen des Kanals und das Einrichten des Proxys und Stubs.</span><span class="sxs-lookup"><span data-stu-id="25d70-113">With distributed applications, an expensive network round-trip is required for the creation of every object, and the farther the client is from the server, the greater the costs of activating and marshaling the server object, opening the channel, and setting up the proxy and stub.</span></span> <span data-ttu-id="25d70-114">Mit dem com+-JIT-Aktivierungs Dienst können Sie die Häufigkeit der Objekt Erstellung minimieren, um die Leistung Ihrer Anwendung erheblich zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="25d70-114">By using the COM+ JIT activation service, you can minimize the frequency of object creation to significantly improve the performance of your application.</span></span>
-   <span data-ttu-id="25d70-115">Wenn Sie die com+-JIT-Aktivierung verwenden, um die Objekte zu aktivieren, auf denen Clients langlebige Verweise enthalten, die jedoch nicht zwangsläufig immer verwendet werden, ist der Server Arbeitsspeicher nicht immer gebunden, damit diese Objekte aktiv bleiben.</span><span class="sxs-lookup"><span data-stu-id="25d70-115">When you use COM+ JIT activation to activate those objects to which clients hold long-lived references but which they aren't necessarily using all the time, server memory is not always tied up keeping those objects alive.</span></span> <span data-ttu-id="25d70-116">Dies kann die Skalierbarkeit Ihrer Anwendung erheblich erhöhen.</span><span class="sxs-lookup"><span data-stu-id="25d70-116">This can significantly increase the scalability of your application.</span></span> <span data-ttu-id="25d70-117">Der einzige Leistungs Treffer, den Clients sehen, ist die Zeit, die com+ benötigt, um das Objekt zu reaktivieren, normalerweise nur geringfügig länger, als es benötigt, um Speicherplatz für das Objekt zuzuweisen, und wesentlich kleiner als die Netzwerkroundtrips für die Remote Objekt Erstellung.</span><span class="sxs-lookup"><span data-stu-id="25d70-117">The only performance hit that clients see is the time it takes COM+ to reactivate the object, usually just marginally more time than it takes to allocate memory for the object and substantially less than the network round-trip for remote object creation.</span></span>

## <a name="enabling-com-jit-activation"></a><span data-ttu-id="25d70-118">Aktivieren der com+-JIT-Aktivierung</span><span class="sxs-lookup"><span data-stu-id="25d70-118">Enabling COM+ JIT Activation</span></span>

<span data-ttu-id="25d70-119">Sie können den com+-JIT-Aktivierungs Dienst für eine Komponente aktivieren, indem Sie entweder das Verwaltungs Programmkomponenten Dienste oder die Verwaltungsfunktionen verwenden.</span><span class="sxs-lookup"><span data-stu-id="25d70-119">You can enable the COM+ JIT activation service for a component by using either the Component Services administrative tool or the Administrative functions.</span></span> <span data-ttu-id="25d70-120">Weitere Informationen hierzu finden Sie unter [Aktivieren der JIT-Aktivierung für eine Komponente](enabling-jit-activation-for-a-component.md).</span><span class="sxs-lookup"><span data-stu-id="25d70-120">For details about how to do this, see [Enabling JIT Activation for a Component](enabling-jit-activation-for-a-component.md).</span></span>

<span data-ttu-id="25d70-121">Die com+-JIT-Aktivierung kann mit anderen COM+-Diensten interagieren, z. b. wie folgt:</span><span class="sxs-lookup"><span data-stu-id="25d70-121">COM+ JIT activation can interact with other COM+ services, such as the following:</span></span>

-   <span data-ttu-id="25d70-122">Wenn für Ihre Komponente Transaktionen erforderlich sind, ist die JIT-Aktivierung automatisch aktiviert.</span><span class="sxs-lookup"><span data-stu-id="25d70-122">When your component requires transactions, JIT activation is automatically enabled for it.</span></span> <span data-ttu-id="25d70-123">Ausführlichere Informationen finden [Sie unter Transaktionen und com+-JIT-Aktivierung](transactions-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="25d70-123">For greater detail, see [Transactions and COM+ JIT Activation](transactions-and-com--jit-activation.md).</span></span>
-   <span data-ttu-id="25d70-124">Wenn die Komponente für die JIT-Aktivierung aktiviert ist, wird die Synchronisierung automatisch auf Required festgelegt.</span><span class="sxs-lookup"><span data-stu-id="25d70-124">When your component is enabled for JIT activation, synchronization is automatically set to required.</span></span> <span data-ttu-id="25d70-125">Dies bedeutet Folgendes: Wenn zwei Clients gleichzeitig eine JIT-aktivierte Komponente aufzurufen und ein Methodenaufrufe für eine von Ihnen zurückgibt, wodurch das Objekt deaktiviert wird, bleibt das andere nicht gestrandet.</span><span class="sxs-lookup"><span data-stu-id="25d70-125">This means that if two clients simultaneously call a JIT-activated component and a method call for one of them returns, causing the object to be deactivated, the other is not left stranded.</span></span>

## <a name="how-deactivation-is-triggered"></a><span data-ttu-id="25d70-126">Auslösen der decoaktivierung</span><span class="sxs-lookup"><span data-stu-id="25d70-126">How Deactivation Is Triggered</span></span>

<span data-ttu-id="25d70-127">Com+ deaktiviert ein Objekt basierend auf dem Status des doneness-Bits im Objekt Kontext.</span><span class="sxs-lookup"><span data-stu-id="25d70-127">COM+ deactivates an object based on the status of the doneness bit on the object context.</span></span> <span data-ttu-id="25d70-128">Das-Objekt kann dieses Bit verwenden, um zu signalisieren, ob es abgeschlossen ist – d. h., es kann während eines bestimmten Methoden Aufrufes deaktiviert werden –.</span><span class="sxs-lookup"><span data-stu-id="25d70-128">Your object can use this bit to signal whether it is done—that is, ready to be deactivated—during a given method call.</span></span> <span data-ttu-id="25d70-129">Weitere Informationen finden Sie unter [Festlegen des done-Bits](setting-the-done-bit.md).</span><span class="sxs-lookup"><span data-stu-id="25d70-129">For more information, see [Setting the Done Bit](setting-the-done-bit.md).</span></span>

## <a name="using-the-auto-done-property"></a><span data-ttu-id="25d70-130">Verwenden der Auto-done-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="25d70-130">Using the Auto-Done Property</span></span>

<span data-ttu-id="25d70-131">Mithilfe des Verwaltungs Programms Komponenten Dienste können Sie eine Methode so konfigurieren, dass das Objekt bei der Rückgabe der Methode automatisch deaktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="25d70-131">Using the Component Services administrative tool, you can configure a method such that the object is automatically deactivated on method return.</span></span> <span data-ttu-id="25d70-132">(Informationen zum Festlegen dieser Eigenschaft finden Sie unter [Aktivieren der automatischen Ausführung für eine Methode](enabling-auto-done-for-a-method.md) .) Wenn Sie diese Option auswählen, können Sie die sich wiederholenden Methodenaufrufe für die Abstimmung in Transaktionen vermeiden.</span><span class="sxs-lookup"><span data-stu-id="25d70-132">(See [Enabling Auto-Done for a Method](enabling-auto-done-for-a-method.md) for instructions about how to set this property.) By selecting this option, you can eliminate the repetitive method calls for voting in transactions.</span></span> <span data-ttu-id="25d70-133">Da die Standardeinstellung für das Konsistenz Bit true ist, wenn Sie das done-Bit ebenfalls in true geändert haben und keine Aktion zum Ändern dieser Einstellungen durchführen, wird [**IObjectContext:: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) automatisch aufgerufen, nachdem die-Methode zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="25d70-133">Because the default setting for the consistency bit is True, if you have changed the done bit to True as well and you take no action to change these settings, [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) is called automatically after the method returns.</span></span>

<span data-ttu-id="25d70-134">Es gibt jedoch einen Nachteil für dieses Verhalten: com+ prüft das HRESULT, das von der Methode zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="25d70-134">However, there is one caveat to this behavior: COM+ will examine the HRESULT that the method returns.</span></span> <span data-ttu-id="25d70-135">Wenn dieses HRESULT einen Fehler anzeigt, wird das Konsistenz Bit auf false festgelegt, und das Ergebnis ist das gleiche wie, wenn Sie [**IObjectContext:: SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort)aufgerufen hätten.</span><span class="sxs-lookup"><span data-stu-id="25d70-135">If that HRESULT indicates failure, the consistency bit is set to False and the result is the same as if you had called [**IObjectContext::SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

<span data-ttu-id="25d70-136">Zusammenfassend gilt: Wenn Sie für eine Methode "automatisch abgeschlossen" auswählen und keine Aktion zum Festlegen von Bits ausführen und ein HRESULT (HR) zurückgegeben wird, gilt Folgendes:</span><span class="sxs-lookup"><span data-stu-id="25d70-136">To summarize, if you select auto-done for a method and don't take any action to set any bits, and if an HRESULT(hr) is returned, the following applies:</span></span>

-   <span data-ttu-id="25d70-137">Wenn erfolgreich (HR) ist, ist es so, als ob Sie [**SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete)aufgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="25d70-137">If SUCCEEDS(hr), it is as though you called [**SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).</span></span>
-   <span data-ttu-id="25d70-138">Wenn ein Fehler aufgetreten ist, ist dies so [**, als ob**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort)Sie "" "" "" "</span><span class="sxs-lookup"><span data-stu-id="25d70-138">If FAILED(hr), it is as though you called [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

## <a name="using-iobjectcontrol-to-manage-object-activation-and-deactivation"></a><span data-ttu-id="25d70-139">Verwenden von IObjectControl zum Verwalten der Objekt Aktivierung und-Aktivierung</span><span class="sxs-lookup"><span data-stu-id="25d70-139">Using IObjectControl to Manage Object Activation and Deactivation</span></span>

<span data-ttu-id="25d70-140">Sie können die [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) -Schnittstelle implementieren, sodass die com+-Laufzeit die Aktivierung und erneute Aktivierung der Objekte automatisch verwaltet.</span><span class="sxs-lookup"><span data-stu-id="25d70-140">You can implement the [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) interface so that the COM+ runtime automatically manages deactivation and reactivation for your objects.</span></span> <span data-ttu-id="25d70-141">Wenn ein Objekt diese Schnittstelle implementiert, ruft com+ [**IObjectControl::D ereaktivierung**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) auf, wenn das Objekt deaktiviert wird, und [**IObjectControl:: Aktivierung**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) , wenn es reaktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="25d70-141">When an object implements this interface, COM+ calls [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) when it deactivates the object and [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) when it reactivates it.</span></span> <span data-ttu-id="25d70-142">Diese Methoden ermöglichen die automatische kontextinitialisierung bei der Objekt Aktivierung und beim Bereinigung des Zustands bei der Deaktivierung.</span><span class="sxs-lookup"><span data-stu-id="25d70-142">These methods enable automatic context initialization on object activation and cleanup of state on deactivation.</span></span>

<span data-ttu-id="25d70-143">Wenn Sie Objekte mit der com+-JIT-Aktivierung bündeln, wird dringend empfohlen, [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol)zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="25d70-143">If you are pooling objects that use COM+ JIT activation, it is highly recommended that you implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span></span> <span data-ttu-id="25d70-144">Weitere Details finden Sie unter [Object Pooling und com+ JIT Activation](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="25d70-144">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

## <a name="statelessness-and-jit-activation"></a><span data-ttu-id="25d70-145">Status losigkeit und JIT-Aktivierung</span><span class="sxs-lookup"><span data-stu-id="25d70-145">Statelessness and JIT Activation</span></span>

<span data-ttu-id="25d70-146">Transaktionale Objekte sind notwendigerweise zustandslos, da Sie den Zustand nicht über eine Transaktionsgrenze hinweg freigeben können.</span><span class="sxs-lookup"><span data-stu-id="25d70-146">Transactional objects are necessarily stateless because you cannot share state across a transaction boundary.</span></span> <span data-ttu-id="25d70-147">Daher verwenden Sie die JIT-Aktivierung nur dann, wenn das Objekt keinen Zustand enthält, der bei der Aktivierung verloren gehen würde. andernfalls verstoßen Sie gegen die Isolation der Transaktionen.</span><span class="sxs-lookup"><span data-stu-id="25d70-147">Therefore, you would use JIT activation only when your object holds no state that would be lost on deactivation; otherwise, you violate the isolation of the transactions.</span></span> <span data-ttu-id="25d70-148">Aufgrund der natürlichen Verwendungs Muster von transaktionalen Objekten – Sie führen einige Arbeitseinheiten aus und geben das Objekt frei, wenn die Transaktion ein Commit oder abbricht – JIT-Aktivierung und automatische Transaktionen sind eng miteinander verknüpft.</span><span class="sxs-lookup"><span data-stu-id="25d70-148">Due to the natural use patterns of transactional objects—they do some unit of work and release the object when the transaction commits or aborts—JIT activation and automatic transactions are closely related.</span></span> <span data-ttu-id="25d70-149">Durch das Konfigurieren eines Objekts, das Transaktionen erfordert, wird die com+-JIT-Aktivierung automatisch</span><span class="sxs-lookup"><span data-stu-id="25d70-149">Configuring an object to require transactions enables COM+ JIT activation automatically.</span></span>

## <a name="related-topics"></a><span data-ttu-id="25d70-150">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="25d70-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="25d70-151">Com+-Just-in-Time-Aktivierungs Tasks</span><span class="sxs-lookup"><span data-stu-id="25d70-151">COM+ Just-in-Time Activation Tasks</span></span>](com--just-in-time-activation-tasks.md)
</dt> <dt>

[<span data-ttu-id="25d70-152">Objekt Pooling und com+-JIT-Aktivierung</span><span class="sxs-lookup"><span data-stu-id="25d70-152">Object Pooling and COM+ JIT Activation</span></span>](object-pooling-and-com--jit-activation.md)
</dt> <dt>

[<span data-ttu-id="25d70-153">Transaktionen und com+-JIT-Aktivierung</span><span class="sxs-lookup"><span data-stu-id="25d70-153">Transactions and COM+ JIT Activation</span></span>](transactions-and-com--jit-activation.md)
</dt> </dl>

 

 



