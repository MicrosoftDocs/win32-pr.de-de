---
description: Persistente Client-Side Fehler
ms.assetid: f991db71-8319-414d-8a25-2d02bc7c8b51
title: Persistente Client-Side Fehler
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 25d303e712257d62e4ae42497cb4463e782cfbb8
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104393106"
---
# <a name="persistent-client-side-failures"></a><span data-ttu-id="6941c-103">Persistente Client-Side Fehler</span><span class="sxs-lookup"><span data-stu-id="6941c-103">Persistent Client-Side Failures</span></span>

<span data-ttu-id="6941c-104">In einigen Fällen kann [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)) eine Nachricht in die Ziel Warteschlange verschieben.</span><span class="sxs-lookup"><span data-stu-id="6941c-104">In some cases, [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)) can move a message to the destination queue.</span></span> <span data-ttu-id="6941c-105">Wenn z. b. die Warteschlangen Zugriffs Steuerung nicht zulässt, dass die Nachricht vom Client auf den Server verschoben wird, wird die problematische Nachricht in die Client seitige Warteschlange für unzustellbare Nachrichten verschoben.</span><span class="sxs-lookup"><span data-stu-id="6941c-105">For example, if the queue access controls do not permit the message to be moved from client to server, the offending message is moved to the client-side dead letter queue.</span></span> <span data-ttu-id="6941c-106">In diesem Fall kann der in der Warteschlange befindliche Komponenten Dienst eine Ausnahme Klasse einer Komponente zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="6941c-106">When this occurs, the COM+ queued components service allows an exception class to be associated with a component.</span></span> <span data-ttu-id="6941c-107">Um die Ausnahme Klasse der Komponente zuzuordnen, verwenden Sie die Registerkarte **erweitert** auf der Seite Komponenteneigenschaften des Verwaltungs Tools Komponenten Dienste.</span><span class="sxs-lookup"><span data-stu-id="6941c-107">To associate the exception class with the component, use the **Advanced** tab in the component properties page of the Component Services administration tool.</span></span> <span data-ttu-id="6941c-108">Sie können die Ausnahme Klasse auch Programm gesteuert zuordnen, indem Sie das Attribut "exceptionclass Catalog Component" der com+-Verwaltungsfunktionen verwenden.</span><span class="sxs-lookup"><span data-stu-id="6941c-108">You can also associate the exception class programmatically, by using the ExceptionClass catalog component attribute of the COM+ Administrative functions.</span></span>

<span data-ttu-id="6941c-109">Die Exception-Klasse wird entweder als ProgID oder als CLSID einer Komponente definiert, die [**IPlaybackControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iplaybackcontrol)implementiert.</span><span class="sxs-lookup"><span data-stu-id="6941c-109">The exception class is defined as either the ProgID or the CLSID of a component implementing [**IPlaybackControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iplaybackcontrol).</span></span> <span data-ttu-id="6941c-110">Der Dienst für in der Warteschlange befindliche Komponenten verfügt über eine Warteschlange für unzustellbare Nachrichten, die die XACT-Warteschlange</span><span class="sxs-lookup"><span data-stu-id="6941c-110">The queued components service has a dead letter queue monitor that scans the Xact dead letter queue.</span></span> <span data-ttu-id="6941c-111">Wenn eine Nachricht in der Warteschlange vorhanden ist, instanziiert der Monitor für unzustellbare Nachrichten den Ausnahmehandler, der der Zielkomponente zugeordnet ist, und ruft [**IPlaybackControl:: FinalClientRetry**](/windows/desktop/api/ComSvcs/nf-comsvcs-iplaybackcontrol-finalclientretry)auf, was darauf hinweist, dass ein Client seitiger, nicht BEHEB barer Fehler aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="6941c-111">If there is a message on the queue, the dead letter queue monitor instantiates the exception handler associated with the target component and calls [**IPlaybackControl::FinalClientRetry**](/windows/desktop/api/ComSvcs/nf-comsvcs-iplaybackcontrol-finalclientretry), indicating that there has been a client-side, unrecoverable error.</span></span>

<span data-ttu-id="6941c-112">Zusätzlich zu [**IPlaybackControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iplaybackcontrol)sollte der Ausnahmehandler denselben Satz von Schnittstellen implementieren wie die Serverkomponente, für die er Ausnahmen behandelt.</span><span class="sxs-lookup"><span data-stu-id="6941c-112">In addition to [**IPlaybackControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iplaybackcontrol), the exception handler should implement the same set of interfaces as the server component for which it is handling exceptions.</span></span> <span data-ttu-id="6941c-113">Wenn [**IPlaybackControl:: FinalClientRetry**](/windows/desktop/api/ComSvcs/nf-comsvcs-iplaybackcontrol-finalclientretry) aufgerufen wird, gibt die Laufzeit der in der Warteschlange befindlichen Komponenten die fehlerhafte Nachricht an den Ausnahmehandler zurück.</span><span class="sxs-lookup"><span data-stu-id="6941c-113">When [**IPlaybackControl::FinalClientRetry**](/windows/desktop/api/ComSvcs/nf-comsvcs-iplaybackcontrol-finalclientretry) is called, the queued components run-time plays back the failing message to the exception handler.</span></span> <span data-ttu-id="6941c-114">Dies ermöglicht es dem Ausnahmehandler, ein alternatives Verhalten für Nachrichten zu implementieren, die nicht auf den Server verschoben werden können, z. –. durch das Erstellen einer kompensierenden Transaktion.</span><span class="sxs-lookup"><span data-stu-id="6941c-114">This allows the exception handler to implement an alternative behavior for messages that cannot be moved to the server—for example, by generating a compensating transaction.</span></span>

<span data-ttu-id="6941c-115">Wenn der Ausnahmehandler alle wiedergegebenen Methodenaufrufe abschließt, wird die Nachricht aus der Warteschlange für unzustellbare Nachrichten von XACT entfernt und verworfen.</span><span class="sxs-lookup"><span data-stu-id="6941c-115">If the exception handler completes all the method calls played back, the message is removed from the Xact dead letter queue and is dismissed.</span></span> <span data-ttu-id="6941c-116">Wenn der Ausnahmehandler jedoch die Nachricht abbricht, indem er einen Fehlerstatus von einem der Methodenaufrufe zurückgibt, wird die Nachricht an die XACT-Warteschlange für unzustellbare Nachrichten zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6941c-116">If, however, the exception handler aborts the message by returning a failure status from one of the method calls, the message is returned to the Xact dead letter queue.</span></span> <span data-ttu-id="6941c-117">Die folgende Abfolge von Ereignissen zeigt, wie Client seitige Ausnahmen behandelt werden:</span><span class="sxs-lookup"><span data-stu-id="6941c-117">The following sequence of events shows how client-side exceptions are handled:</span></span>

1.  <span data-ttu-id="6941c-118">Message Queuing kann keine Nachricht an den Server übermitteln und die Nachricht in die Warteschlange für unzustellbare Nachrichten von XACT versetzen.</span><span class="sxs-lookup"><span data-stu-id="6941c-118">Message Queuing fails to deliver a message to the server and puts the message onto the Xact dead letter queue.</span></span>
2.  <span data-ttu-id="6941c-119">Der Warteschlangen Listener für unzustellbare Nachrichten (dlql) sucht eine Nachricht in der Warteschlange für unzustellbare Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="6941c-119">The dead letter queue listener (DLQL) finds a message on the Xact dead letter queue.</span></span>
3.  <span data-ttu-id="6941c-120">Der dlql Ruft die CLSID der Zielkomponente aus der Nachricht ab und überprüft, ob eine Ausnahme Klasse besteht.</span><span class="sxs-lookup"><span data-stu-id="6941c-120">The DLQL retrieves the target component CLSID from the message and checks for an exception class.</span></span>
4.  <span data-ttu-id="6941c-121">Dlql instanziiert die Exception-Klasse.</span><span class="sxs-lookup"><span data-stu-id="6941c-121">The DLQL instantiates the exception class.</span></span>
5.  <span data-ttu-id="6941c-122">Die dlql-Abfragen für [**IPlaybackControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iplaybackcontrol) für die Exception-Klasse.</span><span class="sxs-lookup"><span data-stu-id="6941c-122">The DLQL queries for [**IPlaybackControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iplaybackcontrol) for the exception class.</span></span>
6.  <span data-ttu-id="6941c-123">Dlql Ruft die [**IPlaybackControl:: FinalClientRetry**](/windows/desktop/api/ComSvcs/nf-comsvcs-iplaybackcontrol-finalclientretry) -Methode in der Ausnahme Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="6941c-123">The DLQL calls the [**IPlaybackControl::FinalClientRetry**](/windows/desktop/api/ComSvcs/nf-comsvcs-iplaybackcontrol-finalclientretry) method in the exception class.</span></span>
7.  <span data-ttu-id="6941c-124">Dlql gibt alle Eigenschafts-und Methodenaufrufe von der Nachricht an die Exception-Klasse zurück.</span><span class="sxs-lookup"><span data-stu-id="6941c-124">The DLQL plays back all property and method calls from the message to the exception class.</span></span>
8.  <span data-ttu-id="6941c-125">Der dlql löscht die Nachricht, wenn der Ausnahmehandler die Transaktion erfolgreich abgeschlossen hat.</span><span class="sxs-lookup"><span data-stu-id="6941c-125">The DLQL deletes the message if the exception handler completes the transaction successfully.</span></span> <span data-ttu-id="6941c-126">Der Ausnahmehandler gibt möglicherweise [**IObjectContext:: abtabort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort)aus, und die Nachricht verbleibt in der Warteschlange für unzustellbare Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="6941c-126">The exception handler may issue [**IObjectContext::SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort), and the message will remain on the dead letter queue.</span></span>

<span data-ttu-id="6941c-127">Wenn einer der vorangegangenen Schritte fehlschlägt, wird die Nachricht in der Warteschlange für unzustellbare Nachrichten von XACT belassen.</span><span class="sxs-lookup"><span data-stu-id="6941c-127">If any of the preceding steps fail, the message is left on the Xact dead letter queue.</span></span>

<span data-ttu-id="6941c-128">Beim Start liest dlql jede Nachricht in der Message Queuing Transaktions Warteschlange für unzustellbare Nachrichten und instanziiert die Exception-Klasse für jede Nachricht in der Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="6941c-128">When started, the DLQL reads each message on the Message Queuing transactional dead letter queue and instantiates the exception class for each queued components message.</span></span> <span data-ttu-id="6941c-129">Nach dem Durchlaufen der Warteschlange wartet Sie auf neue Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="6941c-129">After one pass through the queue, it waits for new messages.</span></span> <span data-ttu-id="6941c-130">Anschließend werden alle neuen Warteschlangen Nachrichten für unzustellbare Nachrichten verarbeitet, sobald sie eintreffen.</span><span class="sxs-lookup"><span data-stu-id="6941c-130">It then processes each new dead letter queue message as it arrives.</span></span>

<span data-ttu-id="6941c-131">Wenn Sie in den hier beschriebenen Prozess eingreifen müssen oder eine nicht verarbeitbare Nachricht aus der letzten ruhenden Warteschlange verschieben müssen, verwenden Sie das Hilfsprogramm Nachrichten Verschiebung.</span><span class="sxs-lookup"><span data-stu-id="6941c-131">If you need to intervene in the process described here or if you need to move a poison message out of its final resting queue, use the message mover utility.</span></span> <span data-ttu-id="6941c-132">Weitere Informationen zum Hilfsprogramm für den Nachrichten Verschiebungsvorgang finden Sie unter [Behandeln von Fehlern](handling-errors-in-queued-components.md).</span><span class="sxs-lookup"><span data-stu-id="6941c-132">For more information on the message mover utility, see [Handling Errors](handling-errors-in-queued-components.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="6941c-133">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="6941c-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6941c-134">Client seitige Fehler</span><span class="sxs-lookup"><span data-stu-id="6941c-134">Client-Side Errors</span></span>](client-side-errors.md)
</dt> <dt>

[<span data-ttu-id="6941c-135">Server seitige Fehler</span><span class="sxs-lookup"><span data-stu-id="6941c-135">Server-Side Errors</span></span>](server-side-errors.md)
</dt> </dl>

 

 



