---
description: In Poolable-Objekten müssen bestimmte Anforderungen erfüllt werden, damit eine einzelne Objektinstanz von mehreren Clients verwendet werden kann.
ms.assetid: 2cd4211e-be12-4197-8b43-5cb9f2321016
title: Anforderungen für in einem Pool Bare Objekte
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78d6834210f180ad8b514b51b6926b5cd30714fd
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103958354"
---
# <a name="requirements-for-poolable-objects"></a><span data-ttu-id="5fd22-103">Anforderungen für in einem Pool Bare Objekte</span><span class="sxs-lookup"><span data-stu-id="5fd22-103">Requirements for Poolable Objects</span></span>

<span data-ttu-id="5fd22-104">In Poolable-Objekten müssen bestimmte Anforderungen erfüllt werden, damit eine einzelne Objektinstanz von mehreren Clients verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="5fd22-104">Poolable objects must meet certain requirements to enable a single object instance to be used by multiple clients.</span></span>

## <a name="stateless"></a><span data-ttu-id="5fd22-105">Zustandslos</span><span class="sxs-lookup"><span data-stu-id="5fd22-105">Stateless</span></span>

<span data-ttu-id="5fd22-106">Um Sicherheit, Konsistenz und Isolation zu gewährleisten, sollten in einem Pool einsetzbare Objekte keinen Client spezifischen Zustand vom Client zum Client aufweisen.</span><span class="sxs-lookup"><span data-stu-id="5fd22-106">To maintain security, consistency, and isolation, poolable objects should hold no client-specific state from client to client.</span></span> <span data-ttu-id="5fd22-107">Sie können jeden Client Status mithilfe von [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol)verwalten, eine kontextspezifische Initialisierung mit [**IObjectControl:: Aktivierung**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) durchführen und einen beliebigen Client Zustand mit [**IObjectControl::D eaktivierungs**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate)bereinigen.</span><span class="sxs-lookup"><span data-stu-id="5fd22-107">You can manage any per-client state by using [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), performing context-specific initialization with [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) and cleaning up any client state with [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate).</span></span> <span data-ttu-id="5fd22-108">Weitere Details finden Sie unter [Steuern der Objekt Lebensdauer und des Zustands](controlling-object-lifetime-and-state.md).</span><span class="sxs-lookup"><span data-stu-id="5fd22-108">For more detail, see [Controlling Object Lifetime and State](controlling-object-lifetime-and-state.md).</span></span>

## <a name="no-thread-affinity"></a><span data-ttu-id="5fd22-109">Keine Thread Affinität</span><span class="sxs-lookup"><span data-stu-id="5fd22-109">No Thread Affinity</span></span>

<span data-ttu-id="5fd22-110">Poolable-Objekte können nicht an einen bestimmten Thread gebunden werden. Andernfalls könnte die Leistung möglicherweise katastrophal sein.</span><span class="sxs-lookup"><span data-stu-id="5fd22-110">Poolable objects cannot be bound to a particular thread; otherwise, performance could be potentially disastrous.</span></span> <span data-ttu-id="5fd22-111">Aus diesem Grund können Pool fähige Objekte nicht für die Durchführung im Apartment Modell gekennzeichnet werden. Sie müssen im Multithread-Apartment oder im neutralen Apartment ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="5fd22-111">For this reason, poolable objects cannot be marked to run in the apartment model; they must run in the multithreaded apartment or the neutral apartment.</span></span> <span data-ttu-id="5fd22-112">Außerdem sollten in einem Pool einsetzbare Objekte keinen lokalen Thread Speicher verwenden, und Sie sollten nicht den frei Thread-Mars Haller aggregieren.</span><span class="sxs-lookup"><span data-stu-id="5fd22-112">In addition, poolable objects should not use thread local storage nor should they aggregate the free-threaded marshaler.</span></span> <span data-ttu-id="5fd22-113">Weitere Details zum Threading in com+ finden Sie unter [com+-Threading Modelle](com--threading-models.md).</span><span class="sxs-lookup"><span data-stu-id="5fd22-113">For more detail about threading in COM+, see [COM+ Threading Models](com--threading-models.md).</span></span>

> [!Note]  
> <span data-ttu-id="5fd22-114">Mit den Entwicklungsumgebungen Microsoft Visual Basic 6,0 und früher können nur Apartment Modellkomponenten erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="5fd22-114">The Microsoft Visual Basic 6.0 and earlier development environments can create only apartment model components.</span></span> <span data-ttu-id="5fd22-115">In Visual Basic .net können Komponenten jedoch in einem Pool zusammengefasst werden.</span><span class="sxs-lookup"><span data-stu-id="5fd22-115">However, in Visual Basic .NET, components can be pooled.</span></span>

 

## <a name="aggregatable"></a><span data-ttu-id="5fd22-116">Aggregierbar</span><span class="sxs-lookup"><span data-stu-id="5fd22-116">Aggregatable</span></span>

<span data-ttu-id="5fd22-117">In Poolable-Objekten müssen Aggregationen unterstützt werden, d. –. Sie müssen die Erstellung unterstützen, indem [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) mit einem *pUnkOuter* -Argument ungleich NULL aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="5fd22-117">Poolable objects must support aggregation—that is, they must support being created by invoking [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) with a non-NULL *pUnkOuter* argument.</span></span> <span data-ttu-id="5fd22-118">Wenn com+ ein in einem Pool zusammengefasster Objekt aktiviert, wird ein Aggregat erstellt, um die Lebensdauer des gepoolten Objekts zu verwalten und Methoden für [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol)aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="5fd22-118">When COM+ activates a pooled object, it creates an aggregate to manage the lifetime of the pooled object and to call methods on [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span></span> <span data-ttu-id="5fd22-119">Ausführliche Informationen zum Schreiben von aggregierbare-Objekten finden Sie unter [Aggregation](/windows/desktop/com/aggregation).</span><span class="sxs-lookup"><span data-stu-id="5fd22-119">For details on writing aggregatable objects, see [Aggregation](/windows/desktop/com/aggregation).</span></span>

## <a name="transactional-components"></a><span data-ttu-id="5fd22-120">Transaktionale Komponenten</span><span class="sxs-lookup"><span data-stu-id="5fd22-120">Transactional Components</span></span>

<span data-ttu-id="5fd22-121">In Poolable-Objekten, die an Transaktionen teilnehmen, müssen verwaltete Ressourcen manuell eingetragen werden.</span><span class="sxs-lookup"><span data-stu-id="5fd22-121">Poolable objects that participate in transactions must manually enlist managed resources.</span></span> <span data-ttu-id="5fd22-122">Wenn Ihr Objekt eine verwaltete Ressource (z. b. eine Datenbankverbindung) enthält, ist es für den Ressourcen-Manager nicht möglich, sich automatisch in eine Transaktion einzutragen, wenn das Objekt im angegebenen Kontext aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="5fd22-122">While it is pooled, if your object holds a managed resource such as a database connection, there will be no way for the resource manager to automatically enlist in a transaction when the object is activated in given context.</span></span> <span data-ttu-id="5fd22-123">Daher muss das-Objekt selbst die Logik zum Erkennen der Transaktion, das Ausschalten der automatischen Eintragung des Ressourcen-Managers und das manuelle eintragen der darin befindlichen Ressourcen verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="5fd22-123">Therefore, the object itself must handle the logic of detecting the transaction, turning off the resource manager's auto-enlistment and manually enlisting any resources that it holds.</span></span> <span data-ttu-id="5fd22-124">Außerdem sollte ein transaktionales, in einem Pool zusammengefasste Objekt den aktuellen Zustand seiner Ressourcen in den Parameterwerten von [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled)widerspiegeln.</span><span class="sxs-lookup"><span data-stu-id="5fd22-124">In addition, a transactional pooled object should reflect the current state of its resources in the parameter values of [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled).</span></span> <span data-ttu-id="5fd22-125">Weitere Details finden Sie unter [Pooling von transaktionalen Objekten](pooling-transactional-objects.md).</span><span class="sxs-lookup"><span data-stu-id="5fd22-125">For more detail, see [Pooling Transactional Objects](pooling-transactional-objects.md).</span></span>

## <a name="implement-iobjectcontrol-to-manage-the-object-lifetime"></a><span data-ttu-id="5fd22-126">Implementieren von IObjectControl zum Verwalten der Objekt Lebensdauer</span><span class="sxs-lookup"><span data-stu-id="5fd22-126">Implement IObjectControl to Manage the Object Lifetime</span></span>

<span data-ttu-id="5fd22-127">In Poolable-Objekten sollte [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol)implementiert werden, obwohl dies nicht zwingend erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="5fd22-127">Poolable objects should implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), although it is not strictly necessary to do so.</span></span> <span data-ttu-id="5fd22-128">Transaktionale Komponenten, die in einem Pool zusammengefasst sind, müssen jedoch **IObjectControl** implementieren.</span><span class="sxs-lookup"><span data-stu-id="5fd22-128">Transactional components that are pooled, however, must implement **IObjectControl**.</span></span> <span data-ttu-id="5fd22-129">Diese Komponenten sollten den Zustand der Ressourcen überwachen, die Sie enthalten, und angeben, wann Sie nicht wieder verwendet werden können. Wenn [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) den Wert "false" zurückgibt, wird eine Transaktion beendet.</span><span class="sxs-lookup"><span data-stu-id="5fd22-129">These components should monitor the state of the resources they hold and indicate when they can't be reused; when [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) returns false, it will doom a transaction.</span></span> <span data-ttu-id="5fd22-130">Weitere Details finden Sie unter [Steuern der Objekt Lebensdauer und des Zustands](controlling-object-lifetime-and-state.md).</span><span class="sxs-lookup"><span data-stu-id="5fd22-130">For more detail, see [Controlling Object Lifetime and State](controlling-object-lifetime-and-state.md).</span></span>

## <a name="language-restrictions"></a><span data-ttu-id="5fd22-131">Spracheinschränkungen</span><span class="sxs-lookup"><span data-stu-id="5fd22-131">Language Restrictions</span></span>

<span data-ttu-id="5fd22-132">Komponenten, die mit Microsoft Visual Basic 6,0 und früher entwickelt wurden, können nicht in einem Pool zusammengefasst werden, da diese Komponenten Apartment Modell Thread sind.</span><span class="sxs-lookup"><span data-stu-id="5fd22-132">Components developed using Microsoft Visual Basic 6.0 and earlier cannot be pooled because these components will be apartment-model threaded.</span></span> <span data-ttu-id="5fd22-133">In Visual Basic .net können Komponenten jedoch in einem Pool zusammengefasst werden.</span><span class="sxs-lookup"><span data-stu-id="5fd22-133">However, in Visual Basic .NET, components can be pooled.</span></span>

## <a name="legacy-components"></a><span data-ttu-id="5fd22-134">Legacykomponenten</span><span class="sxs-lookup"><span data-stu-id="5fd22-134">Legacy Components</span></span>

<span data-ttu-id="5fd22-135">Solange Sie nicht transaktional sind und den entsprechenden Voraussetzungen entsprechen, können Komponenten in einem Pool zusammengefasst werden, auch wenn Sie nicht speziell mit den Pooling-Funktionen geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="5fd22-135">As long as they are non-transactional and conform to the appropriate preceding requirements, components can be pooled even if they were not specifically written with pooling capability in mind.</span></span> <span data-ttu-id="5fd22-136">Das Implementieren von [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol)ist nicht erforderlich. eine Komponente, die dies nicht einfach macht, wird nicht an der Verwaltung Ihrer Lebensdauer beteiligt sein.</span><span class="sxs-lookup"><span data-stu-id="5fd22-136">It is not necessary to implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol); a component that does not do so simply won't participate in managing its lifetime.</span></span> <span data-ttu-id="5fd22-137">Wenn [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) nicht implementiert ist, wird das Objekt weiterhin wieder verwendet, bis der Pool die maximale Größe erreicht.</span><span class="sxs-lookup"><span data-stu-id="5fd22-137">If [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) is not implemented, the object will continue to be reused until the pool attains maximum size.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5fd22-138">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="5fd22-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5fd22-139">Com+-objektkonstruktorzeichenfolgen</span><span class="sxs-lookup"><span data-stu-id="5fd22-139">COM+ Object Constructor Strings</span></span>](com--object-constructor-strings.md)
</dt> <dt>

[<span data-ttu-id="5fd22-140">Steuern der Objekt Lebensdauer und des Zustands</span><span class="sxs-lookup"><span data-stu-id="5fd22-140">Controlling Object Lifetime and State</span></span>](controlling-object-lifetime-and-state.md)
</dt> <dt>

[<span data-ttu-id="5fd22-141">Funktionsweise des Objekt Pooling</span><span class="sxs-lookup"><span data-stu-id="5fd22-141">How Object Pooling Works</span></span>](how-object-pooling-works.md)
</dt> <dt>

[<span data-ttu-id="5fd22-142">Verbessern der Leistung durch Objekt Pooling</span><span class="sxs-lookup"><span data-stu-id="5fd22-142">Improving Performance with Object Pooling</span></span>](improving-performance-with-object-pooling.md)
</dt> <dt>

[<span data-ttu-id="5fd22-143">Pooling von transaktionalen Objekten</span><span class="sxs-lookup"><span data-stu-id="5fd22-143">Pooling Transactional Objects</span></span>](pooling-transactional-objects.md)
</dt> </dl>

 

 
