---
description: Anwendungskomponenten verwenden den com+-Ressourcen Verteiler, um auf freigegebene, nicht dauerhafte Zustandsinformationen zuzugreifen und diese zu verwalten, z. b. Verbindungen zwischen Komponenten und einem bestimmten Ressourcen-Manager.
ms.assetid: 252c7180-61b1-485d-883d-36bf77357a29
title: Konzepte des com+-Ressourcen Verteilers
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f0fcf281d6d7b8ed0e087b6d77e4d686e28e1fa
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103748065"
---
# <a name="com-resource-dispenser-concepts"></a><span data-ttu-id="1b892-103">Konzepte des com+-Ressourcen Verteilers</span><span class="sxs-lookup"><span data-stu-id="1b892-103">COM+ Resource Dispenser Concepts</span></span>

<span data-ttu-id="1b892-104">Anwendungskomponenten verwenden den com+-Ressourcen Verteiler, um auf freigegebene, nicht dauerhafte Zustandsinformationen zuzugreifen und diese zu verwalten, z. b. Verbindungen zwischen Komponenten und einem bestimmten Ressourcen-Manager.</span><span class="sxs-lookup"><span data-stu-id="1b892-104">Application components use the COM+ resource dispenser to access and manage shared, nondurable state information, such as connections between components and a given resource manager.</span></span> <span data-ttu-id="1b892-105">Zur Laufzeit werden dynamische Ressourcenpools, wie z. b. Datenbankverbindungen, Netzwerkverbindungen, Verbindungen zu Warteschlangen, Threads, Objekte und Speicherblöcke, dem Ressourcen Verteiler zur Verfügung gestellt.</span><span class="sxs-lookup"><span data-stu-id="1b892-105">At runtime, dynamic pools of resources, such as database connections, network connections, connections to queues, threads, objects, and memory blocks, are made available to the resource dispenser.</span></span> <span data-ttu-id="1b892-106">Beim Anwendungsprozess wird eine hohe Leistung erzielt, indem eine Mindestanzahl häufig verwendeter Ressourcen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="1b892-106">The application process achieves high performance by using a minimum number of frequently used resources.</span></span> <span data-ttu-id="1b892-107">Der Ressourcen Verteiler kann auch Transaktionen und die Zusammenstellung automatisieren.</span><span class="sxs-lookup"><span data-stu-id="1b892-107">The resource dispenser can also automate transactions and reclamation.</span></span> <span data-ttu-id="1b892-108">(Weitere Informationen zu dieser Funktion finden Sie unter [Automatische Ressourcenrückgewinnung](automatic-resource-reclamation.md) .)</span><span class="sxs-lookup"><span data-stu-id="1b892-108">(See [Automatic Resource Reclamation](automatic-resource-reclamation.md) for more information about this feature.)</span></span>

> [!Note]  
> <span data-ttu-id="1b892-109">Eine *Ressource* ist alles, was ein Ressourcen Spender erstellt.</span><span class="sxs-lookup"><span data-stu-id="1b892-109">A *resource* is anything a resource dispenser creates.</span></span> <span data-ttu-id="1b892-110">Eine Verbindung mit einem Ressourcen-Manager ist beispielsweise eine gemeinsame Ressource.</span><span class="sxs-lookup"><span data-stu-id="1b892-110">For example, a connection to a resource manager is a common resource.</span></span> <span data-ttu-id="1b892-111">Ressourcen befinden sich im Arbeitsspeicher des Ressourcen Verteilers und werden niemals in den Dispenser-Manager kopiert.</span><span class="sxs-lookup"><span data-stu-id="1b892-111">Resources reside in the resource dispenser's memory and are never copied to the dispenser manager.</span></span> <span data-ttu-id="1b892-112">Eine Ressource ist nur durch ein undurchsichtiges handle (**RESID**) bekannt und kann möglicherweise Transaktionen ausführen.</span><span class="sxs-lookup"><span data-stu-id="1b892-112">A resource is known only by an opaque handle (**RESID**) and may or may not be capable of performing transactions.</span></span> <span data-ttu-id="1b892-113">Obwohl es sich bei den verwalteten Ressourcen oft um Verbindungen mit einer Komponente handelt, die einen permanenten Zustand verwaltet, sind die Verbindungen selbst nicht dauerhaft.</span><span class="sxs-lookup"><span data-stu-id="1b892-113">Although the resources managed might often be connections to a component managing a durable state, the connections themselves are not durable.</span></span> <span data-ttu-id="1b892-114">Ein Ressourcen Spender verwendet häufig einen zugehörigen Ressourcen-Manager, um den permanenten Zustand beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="1b892-114">A resource dispenser often uses a related resource manager to retain the durable state.</span></span>

 

<span data-ttu-id="1b892-115">Die Architektur des com+-Ressourcen Dispenser-Systems besteht aus Ressourcen Spendern und einem Dispenser-Manager.</span><span class="sxs-lookup"><span data-stu-id="1b892-115">Architecturally, the COM+ resource dispenser system consists of resource dispensers and a dispenser manager.</span></span> <span data-ttu-id="1b892-116">Ressourcen Spender sind vom Benutzer bereitgestellte Komponenten, die Anwendungen einfache Schnittstellen für freigegebene Ressourcen bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="1b892-116">Resource dispensers are user-supplied components that provide applications with simple interfaces to shared resources.</span></span> <span data-ttu-id="1b892-117">Der Dispenser Manager ist eine von com+ bereitgestellte Komponente, die die Aktivitäten der verschiedenen Ressourcen Spender koordiniert.</span><span class="sxs-lookup"><span data-stu-id="1b892-117">The dispenser manager is a component provided by COM+ that coordinates the activities of the various resource dispensers.</span></span>

<span data-ttu-id="1b892-118">Ein Ressourcen Verteiler ist eine DLL-Komponente (Dynamic-Link Library), die mindestens zwei Schnittstellen bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="1b892-118">A resource dispenser is a dynamic-link library (DLL) component that provides at least two interfaces.</span></span> <span data-ttu-id="1b892-119">Der erste [**idispenser-Treiber**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver)stellt dem Dispenser-Manager grundlegende Informationen zum Erstellen, zerstören und eintragen der von ihm verwalteten Ressourcen bereit.</span><span class="sxs-lookup"><span data-stu-id="1b892-119">The first, [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver), provides the dispenser manager with basic information on how to create, destroy, and enlist the resources it manages.</span></span> <span data-ttu-id="1b892-120">Die zweite ist für die Anwendungen verfügbar und kann eine COM-Schnittstelle oder ein Satz von Schnittstellen oder eine Anwendungsprogrammierschnittstelle (Application Programming Interface, API) sein, mit der eine Komponente über eine Import Bibliothek verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="1b892-120">The second is exposed to the applications and can be a COM interface or set of interfaces or can be an application programming interface (API) to which a component is linked via an import library.</span></span> <span data-ttu-id="1b892-121">Eine Anwendung kann einen beliebigen Ressourcen Verteiler abrufen, der wiederum eine beliebige API für die Anwendung anbieten kann.</span><span class="sxs-lookup"><span data-stu-id="1b892-121">An application can call any resource dispenser, which in turn may offer any API to the application.</span></span> <span data-ttu-id="1b892-122">Wenn der Ressourcen Verteiler eine Automatisierungskomponente ist, kann von Microsoft Visual Basic darauf zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="1b892-122">If the resource dispenser is an Automation component, it can be accessed from Microsoft Visual Basic.</span></span> <span data-ttu-id="1b892-123">Ein Ressourcen Verteiler wird instanziiert, wenn eine Anwendungs Komponente darauf verweist.</span><span class="sxs-lookup"><span data-stu-id="1b892-123">A resource dispenser is instantiated when an application component refers to it.</span></span>

<span data-ttu-id="1b892-124">Der von com+ bereitgestellte Dispenser-Manager verfolgt Ressourcen Spender und Koordinaten zwischen diesen.</span><span class="sxs-lookup"><span data-stu-id="1b892-124">The dispenser manager provided by COM+ tracks resource dispensers and coordinates among them.</span></span> <span data-ttu-id="1b892-125">Es werden zwei Schnittstellen implementiert: [**idispenser Server Manager**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispensermanager) und [**ihälter**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span><span class="sxs-lookup"><span data-stu-id="1b892-125">It implements two interfaces: [**IDispenserManager**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispensermanager) and [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span></span> <span data-ttu-id="1b892-126">Ressourcen Spender registrieren sich selbst mithilfe der **idispenser Server Manager** -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="1b892-126">resource dispensers register themselves using the **IDispenserManager** interface.</span></span> <span data-ttu-id="1b892-127">Der Dispenser-Manager gibt Ihnen dann einen Zeiger auf eine **ihälter** , die Sie verwenden, um den Dispenser-Manager über ihre Aktivitäten zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="1b892-127">The dispenser manager then gives them a pointer to an **IHolder** that they use to notify the dispenser manager of their activities.</span></span>

<span data-ttu-id="1b892-128">Ein transaktionaler Ressourcen Verteiler muss in eine Distributed Transaction Coordinator Transaktion (DTC) eingetragen werden.</span><span class="sxs-lookup"><span data-stu-id="1b892-128">A transactional resource dispenser must enlist in a Distributed Transaction Coordinator (DTC) transaction.</span></span> <span data-ttu-id="1b892-129">Dies impliziert die Verwendung eines internen oder externen Ressourcen-Managers (für den Ressourcen Verteiler), der OLE-Transaktionen-kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="1b892-129">This implies use of either an internal or an external (to the resource dispenser) resource manager that is OLE transactions-compliant.</span></span>

> [!Note]  
> <span data-ttu-id="1b892-130">Das COM+-Programmiermodell umfasst *deklarative Transaktionen*, die den Schutz der von einem Anwendungs Objekt ausgeführten Arbeit während ihrer Lebensdauer erleichtern.</span><span class="sxs-lookup"><span data-stu-id="1b892-130">The COM+ programming model includes *declarative transactions*, which help protect the work performed by an application object during its lifetime.</span></span> <span data-ttu-id="1b892-131">Wenn ein Anwendungs Objekt einen com+-Ressourcen Verteiler verwendet, ist die ausgeführten Aufgaben automatisch transaktional. Das heißt, die Komponente muss Transaktionen nicht explizit deklarieren.</span><span class="sxs-lookup"><span data-stu-id="1b892-131">When an application object uses a COM+ resource dispenser, the work it performs is automatically transactional; that is, the component doesn't have to explicitly declare transactions.</span></span> <span data-ttu-id="1b892-132">Diese Transaktionen werden in der OLE Transactions-Spezifikation definiert, die vom DTC implementiert und im Auftrag des Anwendungs Objekts durch com+ initiiert wird.</span><span class="sxs-lookup"><span data-stu-id="1b892-132">These transactions are defined in the OLE Transactions specification, implemented by the DTC, and initiated on behalf of the application object by COM+.</span></span> <span data-ttu-id="1b892-133">Weitere Informationen finden Sie im DTC-Entwicklungs Handbuch.</span><span class="sxs-lookup"><span data-stu-id="1b892-133">See the DTC Development Guide for more information.</span></span>

 

<span data-ttu-id="1b892-134">Ressourcen müssen nicht transaktional sein.</span><span class="sxs-lookup"><span data-stu-id="1b892-134">Resources need not be transactional.</span></span> <span data-ttu-id="1b892-135">Ein Ressourcen Verteiler, der nicht transaktionale Ressourcen eingibt, kann dennoch eine hohe Leistung erzielen, da Anwendungs Objekte auf einen freigegebenen Pool dieser Ressourcen zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="1b892-135">A resource dispenser that pools non-transactional resources can still achieve high performance by allowing application objects to access a shared pool of these resources.</span></span> <span data-ttu-id="1b892-136">Diese Art von Ressourcen Verteiler gibt den Wert " \_ false" aus der [**idispenser Server Driver:: enlistresource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) -Methode zurück. Dies bedeutet, dass der Ressourcen Verteiler die Ressource nicht eingetragen hat, da die Ressource nicht transaktional ist.</span><span class="sxs-lookup"><span data-stu-id="1b892-136">This type of resource dispenser returns S\_FALSE from the [**IDispenserDriver::EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) method, which means that the resource dispenser did not enlist the resource because the resource is not transactional.</span></span>

<span data-ttu-id="1b892-137">Der Ressourcen Verteiler kann auch unabhängig von com+ funktionieren und bietet nur Funktionen für das Ressourcen Pooling.</span><span class="sxs-lookup"><span data-stu-id="1b892-137">The resource dispenser can also function independently of COM+, providing only resource pooling capabilities.</span></span> <span data-ttu-id="1b892-138">Wenn ein Ressourcen Verteiler z. b. eine API (z. b. ODBC) verfügbar macht, kann der Ressourcen Verteiler eine DLL sein, auf die die Anwendung über eine Import Bibliothek (oder die [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) -Funktion und die [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) -Funktion) zugreift.</span><span class="sxs-lookup"><span data-stu-id="1b892-138">For example, if a resource dispenser exposes an API (such as ODBC), the resource dispenser might be a DLL that is accessed by the application through an import library (or using the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) and [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) functions).</span></span> <span data-ttu-id="1b892-139">Ein Ressourcen Verteiler kann auch eine COM-Komponente sein, auf die eine Anwendung durch Aufrufen von [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance)zugreift.</span><span class="sxs-lookup"><span data-stu-id="1b892-139">A resource dispenser might also be a COM component that an application accesses by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span></span> <span data-ttu-id="1b892-140">Ohne com+ kann die [**enlistresource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) -Methode eines Ressourcen Verteilers nie aufgerufen werden, da der Dispenser-Manager keine Kenntnis von der aktuellen Komponenten Transaktion hat.</span><span class="sxs-lookup"><span data-stu-id="1b892-140">Without COM+, a resource dispenser's [**EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) method can never be called because the dispenser manager has no knowledge of the current component transaction.</span></span>

<span data-ttu-id="1b892-141">Beim Start muss sich eine ressourcendispenser-dll beim Dispenser-Manager registrieren.</span><span class="sxs-lookup"><span data-stu-id="1b892-141">On startup, a resource dispenser DLL must register itself with the dispenser manager.</span></span> <span data-ttu-id="1b892-142">Der Dispenser Manager ist die steuernde Führungskraft, die das Laden und Entladen von Ressourcen Spendern verwaltet, den COM+-Kontext bereitstellt und den Inventur Statistik-Manager steuert.</span><span class="sxs-lookup"><span data-stu-id="1b892-142">The dispenser manager is the controlling executive that manages the loading and unloading of resource dispensers, provides the COM+ context, and controls the inventory statistics manager.</span></span> <span data-ttu-id="1b892-143">(Weitere Informationen finden Sie unter [com+-Dispenser-Manager](com--dispenser-manager.md).) Der Ressourcen Spender ruft zuerst die [**getdispenser Server Manager**](/windows/desktop/api/MtxDM/nf-mtxdm-getdispensermanager) -Funktion auf und ruft dann die [**idispenser Server Manager:: registerdispenser**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispensermanager-registerdispenser) -Methode auf und übergibt dabei den [**idispenser Server Driver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver) -Zeiger, den der Ressourcen Spender implementiert.</span><span class="sxs-lookup"><span data-stu-id="1b892-143">(For more information, see [COM+ Dispenser Manager](com--dispenser-manager.md).) The resource dispenser first calls the [**GetDispenserManager**](/windows/desktop/api/MtxDM/nf-mtxdm-getdispensermanager) function and then calls the [**IDispenserManager::RegisterDispenser**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispensermanager-registerdispenser) method, passing the [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver) pointer that the resource dispenser implements.</span></span> <span data-ttu-id="1b892-144">Dieser Rückruf gibt einen Verweis auf [**ihälter**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder)zurück.</span><span class="sxs-lookup"><span data-stu-id="1b892-144">This call returns a reference to [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span></span>

<span data-ttu-id="1b892-145">Zum Herunterfahren Ruft ein Ressourcen Spender [**ihälter:: Close**](/windows/desktop/api/ComSvcs/nf-comsvcs-iholder-close)auf.</span><span class="sxs-lookup"><span data-stu-id="1b892-145">To shut down, a resource dispenser calls [**IHolder::Close**](/windows/desktop/api/ComSvcs/nf-comsvcs-iholder-close).</span></span> <span data-ttu-id="1b892-146">Um sicherzustellen, dass das Herunterfahren des Pakets ordnungsgemäß ausgeführt wird, muss ein Ressourcen Verteiler in der Lage sein, die Situation zu behandeln, in der Anrufe weiterhin von Geschäftsobjekten eingehen, nachdem com+ den Dispenser zum Herunterfahren aufgefordert</span><span class="sxs-lookup"><span data-stu-id="1b892-146">To ensure a clean package shutdown, a resource dispenser must be able to handle the situation when calls continue to arrive from business objects after COM+ has asked the dispenser to shut down.</span></span>

<span data-ttu-id="1b892-147">Die folgenden Themen in diesem Abschnitt enthalten ausführlichere Informationen über den com+-Ressourcen Verteiler Dienst:</span><span class="sxs-lookup"><span data-stu-id="1b892-147">The following topics in this section provide more detailed information about the COM+ resource dispenser service:</span></span>

-   [<span data-ttu-id="1b892-148">Com+-Dispenser-Manager</span><span class="sxs-lookup"><span data-stu-id="1b892-148">COM+ Dispenser Manager</span></span>](com--dispenser-manager.md)
-   [<span data-ttu-id="1b892-149">Com+-ressourcendispenser-Thread Typen</span><span class="sxs-lookup"><span data-stu-id="1b892-149">COM+ Resource Dispenser Thread Types</span></span>](com--resource-dispenser-thread-types.md)
-   [<span data-ttu-id="1b892-150">In einem Pool zusammengefasste Ressourcen Zustände für com+-Ressourcen Spender verfügbar</span><span class="sxs-lookup"><span data-stu-id="1b892-150">Pooled Resource States Available to COM+ Resource Dispenser</span></span>](pooled-resource-states-available-to-com--resource-dispenser.md)
-   [<span data-ttu-id="1b892-151">Eintragen einer Ressource in eine Transaktion</span><span class="sxs-lookup"><span data-stu-id="1b892-151">Enlisting a Resource in a Transaction</span></span>](enlisting-a-resource-in-a-transaction.md)
-   [<span data-ttu-id="1b892-152">Ressourcen Zuordnungs Prozess Ressourcen Verteiler</span><span class="sxs-lookup"><span data-stu-id="1b892-152">Resource Dispenser Resource Allocation Process</span></span>](resource-dispenser-resource-allocation-process.md)
-   [<span data-ttu-id="1b892-153">Nachverfolgen nicht zugewiesener Ressourcen</span><span class="sxs-lookup"><span data-stu-id="1b892-153">Tracking Non-Allocated Resources</span></span>](tracking-non-allocated-resources.md)
-   [<span data-ttu-id="1b892-154">Automatische Ressourcenrückgewinnung</span><span class="sxs-lookup"><span data-stu-id="1b892-154">Automatic Resource Reclamation</span></span>](automatic-resource-reclamation.md)
-   [<span data-ttu-id="1b892-155">In com+-ressourcendispenser-Schnittstellen verwendete Typen</span><span class="sxs-lookup"><span data-stu-id="1b892-155">Types Used in COM+ Resource Dispenser Interfaces</span></span>](types-used-in-com--resource-dispenser-interfaces.md)
-   [<span data-ttu-id="1b892-156">Com+-Ressourcen Verteiler Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="1b892-156">COM+ Resource Dispenser Interfaces</span></span>](com--resource-dispenser-interfaces.md)

## <a name="related-topics"></a><span data-ttu-id="1b892-157">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1b892-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1b892-158">Aufgaben des com+-Ressourcen Verteilers</span><span class="sxs-lookup"><span data-stu-id="1b892-158">COM+ Resource Dispenser Tasks</span></span>](com--resource-dispenser-tasks.md)
</dt> </dl>

 

 
