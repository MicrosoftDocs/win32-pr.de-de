---
description: In einigen Fällen muss eine Serveranwendung eine Client Identität für Ressourcen bereitstellen, auf die Sie im Auftrag des Clients zugreift, in der Regel, um Zugriffs Überprüfungen oder Authentifizierung für die Client Identität auszuführen.
ms.assetid: fd75eb54-eefe-411f-a7aa-0bc8628f8778
title: Client Identitätswechsel und Delegierung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7557dcde4cadf559dd8e116cf4e7bece4221aaae
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106342604"
---
# <a name="client-impersonation-and-delegation"></a><span data-ttu-id="ffdc2-103">Client Identitätswechsel und Delegierung</span><span class="sxs-lookup"><span data-stu-id="ffdc2-103">Client Impersonation and Delegation</span></span>

<span data-ttu-id="ffdc2-104">In einigen Fällen muss eine Serveranwendung eine Client Identität für Ressourcen präsentieren, auf die Sie im Auftrag des Clients zugreift, in der Regel, um Zugriffs Überprüfungen oder Authentifizierung für die Identität des Clients durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-104">In some circumstances, a server application needs to present a client's identity to resources it accesses on the client's behalf, usually to cause access checks or authentication to be performed against the client's identity.</span></span> <span data-ttu-id="ffdc2-105">Der Server kann zu einem gewissen Grad unter der Identität des Clients agieren – eine Aktion, die als Identität des Clients angenommen wird.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-105">To a certain extent, the server can act under the client's identity—an action referred to as impersonating the client.</span></span>

<span data-ttu-id="ffdc2-106">Identitäts *Wechsel ist die* Fähigkeit eines Threads, in einem anderen Sicherheitskontext als dem Prozess auszuführen, der den Thread besitzt.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-106">*Impersonation* is the ability of a thread to execute in a security context different from that of the process owning the thread.</span></span> <span data-ttu-id="ffdc2-107">Der Server Thread verwendet ein Zugriffs Token, das die Anmelde Informationen des Clients darstellt, und damit kann er auf Ressourcen zugreifen, auf die der Client zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-107">The server thread uses an access token representing the client's credentials, and with this, it can access resources that the client can access.</span></span>

<span data-ttu-id="ffdc2-108">Durch die Verwendung des Identitäts Wechsels wird sichergestellt, dass der Server genau den Funktionsumfang des Clients erledigen kann.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-108">Using impersonation ensures that the server can do precisely what the client can do.</span></span> <span data-ttu-id="ffdc2-109">Der Zugriff auf Ressourcen kann entweder eingeschränkt oder erweitert werden, je nachdem, welche Berechtigung der Client hat.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-109">Access to resources may be either restricted or expanded, depending on what the client has permission to do.</span></span>

<span data-ttu-id="ffdc2-110">Sie können festlegen, dass ein Server beim Herstellen einer Verbindung mit einer Datenbank die Identität eines Clients annimmt, damit die Datenbank den Client für sich selbst authentifizieren und autorisieren kann.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-110">You might choose to have a server impersonate a client when connecting to a database so that the database can authenticate and authorize the client for itself.</span></span> <span data-ttu-id="ffdc2-111">Oder wenn Ihre Anwendung auf Dateien zugreift, die durch eine Sicherheits Beschreibung geschützt sind, und der Client autorisierten Zugriff auf Informationen in diesen Dateien erhalten soll, kann die Anwendung vor dem Zugriff auf die Dateien die Identität des Clients annehmen.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-111">Or, if your application accesses files that are protected with a security descriptor and to enable the client to obtain authorized access to information in these files, the application can impersonate the client before accessing the files.</span></span>

## <a name="how-to-implement-impersonation"></a><span data-ttu-id="ffdc2-112">Implementieren des Identitäts Wechsels</span><span class="sxs-lookup"><span data-stu-id="ffdc2-112">How to Implement Impersonation</span></span>

<span data-ttu-id="ffdc2-113">Für den Identitätswechsel sind sowohl der Client als auch der Server erforderlich (in einigen Fällen auch Systemadministratoren).</span><span class="sxs-lookup"><span data-stu-id="ffdc2-113">Impersonation requires participation by both client and server (and, in some cases, system administrators).</span></span> <span data-ttu-id="ffdc2-114">Der Client muss seine Bereitschaft angeben, die Identität des Servers zu gestatten, und der Server muss die Identität des Clients explizit übernehmen.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-114">The client must indicate its willingness to let the server use its identity, and the server must explicitly assume the client's identity programmatically.</span></span> <span data-ttu-id="ffdc2-115">Weitere Informationen finden Sie in den Themen [Client seitige Anforderungen für](client-side-requirements-for-impersonation.md) Identitätswechsel und [Server seitige Anforderungen für](server-side-requirements-for-impersonation.md)Identitätswechsel.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-115">For details, see the topics [Client-Side Requirements for Impersonation](client-side-requirements-for-impersonation.md) and [Server-Side Requirements for Impersonation](server-side-requirements-for-impersonation.md).</span></span>

## <a name="administrative-requirements-for-delegate-level-impersonation"></a><span data-ttu-id="ffdc2-116">Administrative Anforderungen für Delegate-Level Identitätswechsel</span><span class="sxs-lookup"><span data-stu-id="ffdc2-116">Administrative Requirements for Delegate-Level Impersonation</span></span>

<span data-ttu-id="ffdc2-117">Um die leistungsfähigste Form des Identitäts Wechsels effektiv nutzen zu *können, müssen* die Client-und Server Benutzerkonten im Active Directory-Dienst ordnungsgemäß konfiguriert werden, um dies zu unterstützen (zusätzlich zur Client Zertifizierungsstelle zum Durchführen eines Identitäts Wechsels auf delegatebene):</span><span class="sxs-lookup"><span data-stu-id="ffdc2-117">To effectively use the most powerful form of impersonation, *delegation*, which is the impersonation of clients over the network, the client and server user accounts must be properly configured in the Active Directory Service to support it (in addition to the client granting authority to do delegate-level impersonation), as follows:</span></span>

-   <span data-ttu-id="ffdc2-118">Die Server Identität muss im Active Directory-Dienst als "vertrauenswürdig für die Delegierung" gekennzeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-118">The server identity must be marked as "Trusted for delegation" in the Active Directory Service.</span></span>
-   <span data-ttu-id="ffdc2-119">Die Client Identität darf nicht als "Konto ist vertraulich und kann nicht delegiert werden" im Active Directory-Dienst gekennzeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-119">The client identity must not be marked as "Account is sensitive and cannot be delegated" in the Active Directory Service.</span></span>

<span data-ttu-id="ffdc2-120">Mit diesen Konfigurations Features erhält der Domänen Administrator ein hohes Maß an Kontrolle über die Delegierung. Dies ist wünschenswert, da die Vertrauenswürdigkeit (und damit das Sicherheitsrisiko) berücksichtigt wird.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-120">These configuration features give the domain administrator a high degree of control over delegation, which is desirable, given how much trust (and hence security risk) is involved.</span></span> <span data-ttu-id="ffdc2-121">Weitere Informationen zur Delegierung finden Sie unter [Delegierung und](/windows/desktop/com/delegation-and-impersonation)Identitätswechsel.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-121">For more detail about delegation, see [Delegation and Impersonation](/windows/desktop/com/delegation-and-impersonation).</span></span>

## <a name="cloaking"></a><span data-ttu-id="ffdc2-122">Cloaking</span><span class="sxs-lookup"><span data-stu-id="ffdc2-122">Cloaking</span></span>

<span data-ttu-id="ffdc2-123">Zusammen mit der Zertifizierungsstelle, die ein Client einem Server über die Identitätswechsel Ebene zuweist, bestimmt die tokenfähigkeit des Servers größtenteils, wie sich der Identitätswechsel verhält.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-123">Along with the authority a client grants a server through the impersonation level, the server's cloaking capability largely determines how impersonation will behave.</span></span> <span data-ttu-id="ffdc2-124">Das Cloaking wirkt sich darauf aus, welche Identität vom Server tatsächlich angezeigt wird, wenn er Aufrufe im Auftrag des Clients durchführt – seinen eigenen oder den des Clients.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-124">Cloaking affects what identity is actually presented by the server when it makes calls on the client's behalf—its own or the client's.</span></span> <span data-ttu-id="ffdc2-125">Weitere Informationen finden Sie unter [Cloaking](cloaking.md).</span><span class="sxs-lookup"><span data-stu-id="ffdc2-125">For details, see [Cloaking](cloaking.md).</span></span>

## <a name="performance-implications"></a><span data-ttu-id="ffdc2-126">Folgen für die Leistung</span><span class="sxs-lookup"><span data-stu-id="ffdc2-126">Performance Implications</span></span>

<span data-ttu-id="ffdc2-127">Der Identitätswechsel kann sich erheblich auf die Leistung und Skalierung auswirken.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-127">Impersonation can significantly affect performance and scaling.</span></span> <span data-ttu-id="ffdc2-128">Es ist in der Regel günstiger, bei einem-Rückruf die Identität eines Clients anzunehmen, als den-Befehl direkt auszuführen.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-128">It is generally more expensive to impersonate a client on a call than to make the call directly.</span></span> <span data-ttu-id="ffdc2-129">Im folgenden sind einige der zu berücksichtigenden Aspekte aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="ffdc2-129">Following are some of the issues to consider:</span></span>

-   <span data-ttu-id="ffdc2-130">Der Rechenaufwand bei der Übergabe der Identität in komplizierten Mustern, insbesondere, wenn das dynamische Cloaking aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-130">The computational overhead of passing around identity in complicated patterns, particularly if dynamic cloaking is enabled.</span></span>
-   <span data-ttu-id="ffdc2-131">Die allgemeine Komplexität der Erzwingung einer redundanten Sicherheitsüberprüfung an zahlreichen Stellen statt nur zentral in der mittleren Ebene.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-131">The general complexity of enforcing redundant security checking in numerous places, instead of just centrally in the middle tier.</span></span>
-   <span data-ttu-id="ffdc2-132">Ressourcen, wie z. b. Datenbankverbindungen, die beim Öffnen des Identitäts Wechsels für einen Client nicht mehr verwendet werden können, können nicht über mehrere Clients hinweg wieder verwendet werden – ein sehr großer</span><span class="sxs-lookup"><span data-stu-id="ffdc2-132">Resources such as database connections, when opened impersonating a client, cannot be reused across multiple clients—a very large roadblock to scaling well.</span></span>

<span data-ttu-id="ffdc2-133">Manchmal besteht die einzige wirksame Lösung für ein Problem darin, den Identitätswechsel zu verwenden, diese Entscheidung sollte jedoch sorgfältig abgewogen werden.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-133">Sometimes the only effective solution to a problem is to use impersonation, but this decision should be carefully weighed.</span></span> <span data-ttu-id="ffdc2-134">Weitere Informationen zu diesen Problemen finden Sie unter [mehrstufige Anwendungssicherheit](multi-tier-application-security.md).</span><span class="sxs-lookup"><span data-stu-id="ffdc2-134">For a further discussion of these issues, see [Multi-Tier Application Security](multi-tier-application-security.md).</span></span>

## <a name="queued-components"></a><span data-ttu-id="ffdc2-135">Komponenten in der Warteschlange</span><span class="sxs-lookup"><span data-stu-id="ffdc2-135">Queued Components</span></span>

<span data-ttu-id="ffdc2-136">In der [Warteschlange befindliche Komponenten](com--queued-components.md) unterstützen keinen Identitätswechsel.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-136">[Queued components](com--queued-components.md) do not support impersonation.</span></span> <span data-ttu-id="ffdc2-137">Wenn ein Client einen in die Warteschlange eingereihten Objekte aufruft, wird der-Befehl tatsächlich an die Aufzeichnung gerichtet, die ihn als Teil einer Nachricht an den Server verpackt.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-137">When a client makes a call to a queued object, the call is actually made to the recorder, which packages it as part of a message to the server.</span></span> <span data-ttu-id="ffdc2-138">Der Listener liest die Nachricht dann aus der Warteschlange und übergibt sie an den Player, der die tatsächliche Serverkomponente aufruft und denselben Methodenaufruf ausführt.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-138">The listener then reads the message from the queue and passes it to the player, which invokes the actual server component and makes the same method call.</span></span> <span data-ttu-id="ffdc2-139">Wenn der Server den-Befehl empfängt, ist das ursprüngliche Client Token über den Identitätswechsel nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-139">As such, when the server receives the call, the original client token is unavailable via impersonation.</span></span> <span data-ttu-id="ffdc2-140">Die rollenbasierte Sicherheit wird jedoch weiterhin angewendet, und die programmgesteuerte Sicherheit mithilfe der [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) -Schnittstelle funktioniert.</span><span class="sxs-lookup"><span data-stu-id="ffdc2-140">Role-based security still applies, however, and programmatic security using the [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) interface will work.</span></span> <span data-ttu-id="ffdc2-141">Weitere Informationen finden Sie unter Sicherheit in der [Warteschlangen Sicherheit](queued-components-security.md).</span><span class="sxs-lookup"><span data-stu-id="ffdc2-141">For details, see [Queued Components Security](queued-components-security.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="ffdc2-142">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ffdc2-142">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ffdc2-143">Clientauthentifizierung</span><span class="sxs-lookup"><span data-stu-id="ffdc2-143">Client Authentication</span></span>](client-authentication.md)
</dt> <dt>

[<span data-ttu-id="ffdc2-144">Sicherheit der Bibliothek Anwendungen</span><span class="sxs-lookup"><span data-stu-id="ffdc2-144">Library Application Security</span></span>](library-application-security.md)
</dt> <dt>

[<span data-ttu-id="ffdc2-145">Multi-Tier-Anwendungssicherheit</span><span class="sxs-lookup"><span data-stu-id="ffdc2-145">Multi-Tier Application Security</span></span>](multi-tier-application-security.md)
</dt> <dt>

[<span data-ttu-id="ffdc2-146">Sicherheit für programmgesteuerte Komponenten</span><span class="sxs-lookup"><span data-stu-id="ffdc2-146">Programmatic Component Security</span></span>](programmatic-component-security.md)
</dt> <dt>

[<span data-ttu-id="ffdc2-147">Rollenbasierte Sicherheitsverwaltung</span><span class="sxs-lookup"><span data-stu-id="ffdc2-147">Role-Based Security Administration</span></span>](role-based-security-administration.md)
</dt> <dt>

[<span data-ttu-id="ffdc2-148">Verwenden der Richtlinie für Software Einschränkung in com+</span><span class="sxs-lookup"><span data-stu-id="ffdc2-148">Using the Software Restriction Policy in COM+</span></span>](using-the-software-restriction-policy-in-com-.md)
</dt> </dl>

 

 
