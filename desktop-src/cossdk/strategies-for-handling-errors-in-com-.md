---
description: In diesem Thema werden verschiedene Fehlerbehandlungsstrategien beschrieben, die bei der Entwicklung von Komponenten für com+ zu berücksichtigen sind.
ms.assetid: 1ae5875b-8085-44f2-9071-c2a5d7543ac1
title: Strategien für die Behandlung von Fehlern in com+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 91ca64546683fa45ac8df3bcb47534d8de482798
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106344353"
---
# <a name="strategies-for-handling-errors-in-com"></a><span data-ttu-id="ec955-103">Strategien für die Behandlung von Fehlern in com+</span><span class="sxs-lookup"><span data-stu-id="ec955-103">Strategies for Handling Errors in COM+</span></span>

<span data-ttu-id="ec955-104">In diesem Thema werden verschiedene Fehlerbehandlungsstrategien beschrieben, die bei der Entwicklung von Komponenten für com+ zu berücksichtigen sind.</span><span class="sxs-lookup"><span data-stu-id="ec955-104">This topic identifies several error-handling strategies to keep in mind as you develop components for COM+.</span></span>

-   <span data-ttu-id="ec955-105">**Gibt einen HRESULT-Wert für alle Methoden in allen Komponenten Schnittstellen zurück.**</span><span class="sxs-lookup"><span data-stu-id="ec955-105">**Return an HRESULT value for all methods in all component interfaces.**</span></span>  <span data-ttu-id="ec955-106">Com+ verwendet **HRESULT** -Werte zum Melden von Fehlern beim Ausführen von Funktionsaufrufen oder Schnittstellen Methoden aufrufen.</span><span class="sxs-lookup"><span data-stu-id="ec955-106">COM+ uses **HRESULT** values to report on any errors in making function calls or interface method calls.</span></span> <span data-ttu-id="ec955-107">Ein **HRESULT** gibt an, ob eine Methode erfolgreich war oder fehlgeschlagen ist, und identifiziert die dem Fehler zugeordnete Funktion, wie z. b. RPC, Win32 oder ITF für Schnittstellen spezifische Fehler.</span><span class="sxs-lookup"><span data-stu-id="ec955-107">An **HRESULT** indicates whether a method succeeded or failed and identifies the facility associated with the error, such as RPC, WIN32, or ITF for interface-specific errors.</span></span> <span data-ttu-id="ec955-108">Außerdem stellen System-APIs eine Suche von einem **HRESULT** in eine Zeichenfolge bereit, die den Fehlerzustand beschreibt.</span><span class="sxs-lookup"><span data-stu-id="ec955-108">Also, system APIs provide a lookup from an **HRESULT** to a string that describes the error condition.</span></span> <span data-ttu-id="ec955-109">Die Verwendung von Methoden, die **HRESULT** -Werte zurückgeben, ist für gut geschriebene Komponenten von grundlegender Bedeutung und für den Debugprozess unerlässlich.</span><span class="sxs-lookup"><span data-stu-id="ec955-109">Using methods that return **HRESULT** values are fundamental to well-written components and are essential to the debugging process.</span></span> <span data-ttu-id="ec955-110">Microsoft Visual Basic definiert automatisch jede Methode mit einem **HRESULT** als Rückgabe.</span><span class="sxs-lookup"><span data-stu-id="ec955-110">Microsoft Visual Basic automatically defines each method with an **HRESULT** as a return.</span></span> <span data-ttu-id="ec955-111">In Microsoft Visual C++ müssen Sie explizit ein **HRESULT** zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="ec955-111">In Microsoft Visual C++, you must explicitly return an **HRESULT**.</span></span> <span data-ttu-id="ec955-112">Weitere Informationen zu HRESULTs finden Sie unter [Struktur von com-Fehler Codes](/windows/desktop/com/structure-of-com-error-codes).</span><span class="sxs-lookup"><span data-stu-id="ec955-112">For additional information on HRESULTs, see [Structure of COM Error Codes](/windows/desktop/com/structure-of-com-error-codes).</span></span>
-   <span data-ttu-id="ec955-113">**Initiieren Sie das errorInfo-Sammlungsobjekt auf beliebige Weise, die Ihr Entwicklungs Tool bereitstellt.**</span><span class="sxs-lookup"><span data-stu-id="ec955-113">**Initiate the ErrorInfo collection object by whatever means your development tool provides.**</span></span> <span data-ttu-id="ec955-114">[**ErrorInfo**](errorinfo.md) -Auflistungs Objekte werden häufig als com-Ausnahmen bezeichnet, da Sie zulassen, dass ein Objekt Rich-Error-Informationen an seinen Aufrufer übergibt (oder auswirft), auch über Apartment Grenzen</span><span class="sxs-lookup"><span data-stu-id="ec955-114">[**ErrorInfo**](errorinfo.md) collection objects are often called COM exceptions because they allow an object to pass (or throw) rich error information to its caller, even across apartment boundaries.</span></span> <span data-ttu-id="ec955-115">Der Wert dieses generischen Fehler Objekts ist, dass es ein HRESULT ergänzt und den Typ der Fehlerinformationen erweitert, die Sie an einen Aufrufer zurückgeben können.</span><span class="sxs-lookup"><span data-stu-id="ec955-115">The value of this generic error object is that it supplements an HRESULT, extending the type of error information that you can return to a caller.</span></span> <span data-ttu-id="ec955-116">Jedes **errorInfo** -Sammlungsobjekt gibt eine Kontext Beschreibung, die Quelle des Fehlers und den Schnittstellen Bezeichner der Methode zurück, die den Fehler verursacht hat.</span><span class="sxs-lookup"><span data-stu-id="ec955-116">Each **ErrorInfo** collection object returns a contextual description, the source of the error, and the interface identifier of the method that originated the error.</span></span> <span data-ttu-id="ec955-117">Sie können auch Zeiger auf einen Eintrag in einer Hilfedatei einschließen.</span><span class="sxs-lookup"><span data-stu-id="ec955-117">You can also include pointers to an entry in a help file.</span></span> <span data-ttu-id="ec955-118">Automation stellt drei Schnittstellen zur Verwaltung des Fehler Objekts bereit.</span><span class="sxs-lookup"><span data-stu-id="ec955-118">Automation provides three interfaces to manage the error object.</span></span> <span data-ttu-id="ec955-119">Die Komponente muss die **ISupportErrorInfo** -Automatisierungsschnittstelle implementieren, um die Unterstützung für die **errorInfo** -Auflistung ankündigen zu können.</span><span class="sxs-lookup"><span data-stu-id="ec955-119">Your component must implement the **ISupportErrorInfo** Automation interface to advertise its support for the **ErrorInfo** collection.</span></span> <span data-ttu-id="ec955-120">Wenn ein Fehler auftritt, wird von der Komponente die **ikreateerrorinfo** -Automatisierungsschnittstelle verwendet, um ein Fehler Objekt zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="ec955-120">When an error occurs, the component uses the **ICreateErrorInfo** Automation interface to initialize an error object.</span></span> <span data-ttu-id="ec955-121">Nachdem der Aufrufer das HRESULT überprüft und ermittelt hat, dass der Methodenaufruf fehlgeschlagen ist, fragt er das Objekt ab, um festzustellen, ob es die **errorInfo** -Auflistung unterstützt</span><span class="sxs-lookup"><span data-stu-id="ec955-121">After the caller inspects the HRESULT and finds that the method call failed, it queries the object to see whether it supports the **ErrorInfo** collection.</span></span> <span data-ttu-id="ec955-122">Wenn dies der Fall ist, verwendet der Aufrufer die **IErrorInfo** -Automatisierungsschnittstelle zum Abrufen der Fehlerinformationen.</span><span class="sxs-lookup"><span data-stu-id="ec955-122">If it does, the caller uses the **IErrorInfo** Automation interface to retrieve the error information.</span></span> <span data-ttu-id="ec955-123">Visual Basic Programmierer haben einfachen Zugriff auf das **errorInfo** -Sammlungsobjekt, das über das Err-Objekt verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="ec955-123">Visual Basic programmers have easy access to the **ErrorInfo** collection object, which is exposed through the Err object.</span></span> <span data-ttu-id="ec955-124">Sie können Fehler mit der Err raise-Funktion und Fehler mit der **On Error** -Anweisung erfassen.</span><span class="sxs-lookup"><span data-stu-id="ec955-124">You can raise errors with the Err Raise function and catch errors with the **On Error** statement.</span></span> <span data-ttu-id="ec955-125">Die Visual Basic Lauf Zeit Ebene übernimmt die Zuordnung für Sie.</span><span class="sxs-lookup"><span data-stu-id="ec955-125">The Visual Basic run-time layer takes care of the mapping for you.</span></span> <span data-ttu-id="ec955-126">Wenn Sie die Visual C++ COM-Compilerunterstützung verwenden, können Sie die \_ com-Fehler Klasse "Raise" verwenden, \_ \_ um einen Fehler zu melden, und die \_ com- \_ Fehler Klasse zum Abrufen von Fehlerinformationen.</span><span class="sxs-lookup"><span data-stu-id="ec955-126">If you are using the Visual C++ COM compiler support, you can use the \_com\_raise\_error class to report an error and the \_com\_error class to retrieve error information.</span></span> <span data-ttu-id="ec955-127">Com+ gibt herkömmliche C++-Ausnahmen nicht als erweiterte **IErrorInfo** -Informationen weiter.</span><span class="sxs-lookup"><span data-stu-id="ec955-127">COM+ will not propagate traditional C++ exceptions as extended **IErrorInfo** information.</span></span> <span data-ttu-id="ec955-128">Weitere Informationen zum **errorInfo** -Sammlungsobjekt finden Sie unter "Fehlerbehandlung" im Automatisierungs Handbuch.</span><span class="sxs-lookup"><span data-stu-id="ec955-128">For additional information on the **ErrorInfo** collection object, see "Error Handling" in the Automation guide.</span></span>
    > [!Note]  
    > <span data-ttu-id="ec955-129">COM erfordert, dass alle [**errorInfo**](errorinfo.md) -Auflistungs Objekte nach Wert marshallt werden. Dies impliziert, dass Komponenten, die die **IErrorInfo** -Automatisierungsschnittstelle implementieren, auch die [**IMarshal**](/windows/desktop/api/objidl/nn-objidl-imarshal) -Schnittstelle implementieren und</span><span class="sxs-lookup"><span data-stu-id="ec955-129">COM requires that all [**ErrorInfo**](errorinfo.md) collection objects marshal by value, implying that components that implement the **IErrorInfo** Automation interface must also implement and support the [**IMarshal**](/windows/desktop/api/objidl/nn-objidl-imarshal) interface.</span></span> <span data-ttu-id="ec955-130">Die Implementierung der **IMarshal** -Schnittstelle muss das Marshalling als Wert für die Komponente unterstützen.</span><span class="sxs-lookup"><span data-stu-id="ec955-130">The **IMarshal** interface implementation must support marshal by value for the component.</span></span>

     

-   <span data-ttu-id="ec955-131">**Verwenden Sie Transaktionen, um freigegebene Ressourcen Fehler zu verwalten.**</span><span class="sxs-lookup"><span data-stu-id="ec955-131">**Use transactions to manage shared resource failures.**</span></span> <span data-ttu-id="ec955-132">Automatische Transaktionen können den Fehler Behandlungs Code erheblich reduzieren, den Sie bei der Verwendung von Zustands verwalteten Ressourcen-Managern schreiben müssen.</span><span class="sxs-lookup"><span data-stu-id="ec955-132">Automatic transactions can significantly reduce the amount of error-handling code you must write when using state-managed resource managers.</span></span> <span data-ttu-id="ec955-133">Transaktionen führen jedoch nicht dazu, dass die Fehlerbehandlung vollständig durchzuführen ist.</span><span class="sxs-lookup"><span data-stu-id="ec955-133">However, transactions do not eliminate the need for error handling altogether.</span></span> <span data-ttu-id="ec955-134">Sie müssen weiterhin Fehlercodes aus den Schnittstellen Methoden zurückgeben und diese Fehlercodes innerhalb des Aufrufers überprüfen, um unnötige Arbeit für eine nicht ordnungsgemäß erforderliche Transaktion zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="ec955-134">You still need to return error codes from your interface methods and check those error codes within the caller to avoid doing unnecessary work for a doomed transaction.</span></span> <span data-ttu-id="ec955-135">Weitere Informationen zum Kombinieren der Fehlerbehandlung bei der Transaktionsverarbeitung finden Sie unter [beschleunigen von Transaktionen durch Benachrichtigen des Stamm Objekts](speeding-transactions-by-notifying-the-root-object.md).</span><span class="sxs-lookup"><span data-stu-id="ec955-135">For additional information about combining error handling with transaction processing, see [Speeding Transactions by Notifying the Root Object](speeding-transactions-by-notifying-the-root-object.md).</span></span>
-   <span data-ttu-id="ec955-136">**Fehler werden explizit ausgegeben.**</span><span class="sxs-lookup"><span data-stu-id="ec955-136">**Raise errors explicitly.**</span></span> <span data-ttu-id="ec955-137">Vermeiden Sie, dass Fehlerinformationen ein Objekt verlassen, es sei denn, das Objekt löst den Fehler explizit aus.</span><span class="sxs-lookup"><span data-stu-id="ec955-137">Avoid letting error information leave an object unless the object explicitly raises the error.</span></span> <span data-ttu-id="ec955-138">Fangen Sie alle Tool generierten Fehler ab, und behandeln Sie Sie im Komponenten Code.</span><span class="sxs-lookup"><span data-stu-id="ec955-138">Catch all tool-generated errors and handle them in your component code.</span></span> <span data-ttu-id="ec955-139">Schließen Sie zumindest einen Standard Handler ein, um unerwartete Fehler auf konsistente Weise zu melden.</span><span class="sxs-lookup"><span data-stu-id="ec955-139">At the very least, include a standard handler to report unexpected errors in a consistent manner.</span></span>
-   <span data-ttu-id="ec955-140">**Verwenden Sie den \_ Bereich für die Einrichtung von Fehler, um Schnittstellen spezifische Fehler zu melden.**</span><span class="sxs-lookup"><span data-stu-id="ec955-140">**Use the FACILITY\_ITF range of errors to report interface-specific errors.**</span></span> <span data-ttu-id="ec955-141">Schnittstellen spezifische Fehler sollten sich in der Einrichtung im \_ Bereich von Fehlern zwischen 0x0200 und 0xFFFF befinden.</span><span class="sxs-lookup"><span data-stu-id="ec955-141">Interface-specific errors should be in the FACILITY\_ITF range of errors, between 0x0200 and 0xFFFF.</span></span> <span data-ttu-id="ec955-142">Sie können einen benutzerdefinierten Fehlercode in Visual Basic als Offset von vbObjectError definieren.</span><span class="sxs-lookup"><span data-stu-id="ec955-142">You can define a custom error code in Visual Basic as an offset from vbObjectError.</span></span> <span data-ttu-id="ec955-143">Verwenden Sie das \_ Makro Make HRESULT in C++, um einen schnittstellenspezifischen Fehlercode einzuführen, wie im folgenden Beispiel gezeigt:</span><span class="sxs-lookup"><span data-stu-id="ec955-143">Use the MAKE\_HRESULT macro in C++ to introduce an interface-specific error code, as shown in the following example:</span></span>

    ``` syntax
    const HRESULT ERROR_NUMBER = MAKE_HRESULT (SEVERITY_ERROR, FACILITY_ITF, 10);
    ```

## <a name="related-topics"></a><span data-ttu-id="ec955-144">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ec955-144">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ec955-145">Fehler Isolation und FailFast-Richtlinie</span><span class="sxs-lookup"><span data-stu-id="ec955-145">Fault Isolation and Failfast Policy</span></span>](fault-isolation-and-failfast-policy.md)
</dt> <dt>

[<span data-ttu-id="ec955-146">Ermitteln der Fehlerquelle</span><span class="sxs-lookup"><span data-stu-id="ec955-146">Finding the Source of an Error</span></span>](finding-the-source-of-an-error.md)
</dt> <dt>

[<span data-ttu-id="ec955-147">Ändern der Rückgabewerte durch com+</span><span class="sxs-lookup"><span data-stu-id="ec955-147">How COM+ Modifies Return Values</span></span>](how-com--modifies-return-values.md)
</dt> <dt>

[<span data-ttu-id="ec955-148">Interpretieren von Fehler Codes</span><span class="sxs-lookup"><span data-stu-id="ec955-148">Interpreting Error Codes</span></span>](interpreting-error-codes.md)
</dt> <dt>

[<span data-ttu-id="ec955-149">Problembehandlung</span><span class="sxs-lookup"><span data-stu-id="ec955-149">Troubleshooting</span></span>](troubleshooting.md)
</dt> </dl>

 

 
