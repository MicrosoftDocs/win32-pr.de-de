---
title: Asynchrone Verbund Dateien
description: Asynchrone Verbund Dateien, die vom System bereitgestellte Implementierung des asynchronen Speichers, ermöglichen das effiziente herunterladen von Verbund Dateien aus dem Internet im allgemeinen und im Internet.
ms.assetid: 6cad074e-07a8-434f-a402-e29cb66a1a18
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 04de2162b50283b12bc8deed6ec908d92e7584d7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104390794"
---
# <a name="asynchronous-compound-files"></a><span data-ttu-id="04644-103">Asynchrone Verbund Dateien</span><span class="sxs-lookup"><span data-stu-id="04644-103">Asynchronous Compound Files</span></span>

<span data-ttu-id="04644-104">Asynchrone Verbund Dateien, die vom System bereitgestellte Implementierung des asynchronen Speichers, ermöglichen das effiziente herunterladen von Verbund Dateien aus dem Internet im allgemeinen und im Internet.</span><span class="sxs-lookup"><span data-stu-id="04644-104">Asynchronous Compound Files, the system-provided implementation of asynchronous storage, enables the efficient downloading of compound files from the Internet in general and the Web in particular.</span></span> <span data-ttu-id="04644-105">Die grundlegende Architektur von asynchronen Verbund Dateien ist im folgenden Diagramm dargestellt.</span><span class="sxs-lookup"><span data-stu-id="04644-105">The basic architecture of Asynchronous Compound Files is shown in the following diagram.</span></span>

![grundlegende Architektur für asynchrone Verbund Dateien](images/asy-stor.png)

<span data-ttu-id="04644-107">Die asynchrone Implementierung der Verbund Dateien kann mit neuen asynchronen monikertypen funktionieren, die Internet Protokolle verstehen und an ein Objekt gebunden werden können, das durch eine URL identifiziert wird.</span><span class="sxs-lookup"><span data-stu-id="04644-107">The Asynchronous Compound Files implementation can work with new asynchronous moniker types that understand Internet protocols and can bind to an object identified by a URL.</span></span> <span data-ttu-id="04644-108">Ein solcher Moniker würde einen asynchronen [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -oder [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Zeiger aus dem Aufruf von [**IMoniker:: bindesstorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage)des Clients zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="04644-108">Such a moniker would return an asynchronous [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) or [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) pointer from the client's call to [**IMoniker::BindToStorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage).</span></span>

<span data-ttu-id="04644-109">Verbund Dateien werden im Allgemeinen auf einem Bytearray-Objekt implementiert, einer Abstraktion einer Datei, die die Daten eines Objekts als flatbytearray darstellt.</span><span class="sxs-lookup"><span data-stu-id="04644-109">Compound Files in general are implemented on top of a byte array object, an abstraction of a file that represents an object's data as a flat byte array.</span></span> <span data-ttu-id="04644-110">Das Bytearray-Objekt macht seine Funktionalität über die [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) -Schnittstelle verfügbar.</span><span class="sxs-lookup"><span data-stu-id="04644-110">The byte array object exposes its functionality through the [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) interface.</span></span> <span data-ttu-id="04644-111">Wenn ein Bytearray eine nicht blockierende asynchrone Speicherung unterstützt, wird E \_ bis zur Implementierung der Verbund Datei zurückgegeben, wodurch der Fehler wiederum an den Aufrufer weitergegeben wird.</span><span class="sxs-lookup"><span data-stu-id="04644-111">If a byte array supports nonblocking asynchronous storage, it returns E\_PENDING to the compound-file implementation, which in turn propagates the error back to the caller.</span></span>

<span data-ttu-id="04644-112">Um die während eines Downloads verfügbaren Daten nachzuverfolgen, macht ein Bytearray, das den asynchronen Speicher unterstützt, die [**ifilllockbytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) -Schnittstelle für ein Wrapper Objekt verfügbar, das speziell für diesen Zweck vom System bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="04644-112">To keep track of the data available during a download, a byte array that supports asynchronous storage exposes the [**IFillLockBytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) interface on a wrapper object provided by the system specifically for this purpose.</span></span> <span data-ttu-id="04644-113">Der von einem asynchronen Moniker bereitgestellte Downloadcode ruft diese Schnittstelle auf, um das Bytearray asynchron auszufüllen, da Daten verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="04644-113">The downloading code provided by an asynchronous moniker calls this interface to fill the byte array asynchronously, as data is available.</span></span> <span data-ttu-id="04644-114">Das Wrapper Objekt macht auch eine **ILockBytes** -Schnittstelle verfügbar, die die asynchrone Implementierung von Verbund Dateien zum Lesen und Schreiben von Daten aus und in das Array verwendet.</span><span class="sxs-lookup"><span data-stu-id="04644-114">The wrapper object also exposes an **ILockBytes** interface, which the Asynchronous Compound Files implementation uses to read and write data from and to the array.</span></span>

<span data-ttu-id="04644-115">Asynchrone Speicher-und Streamobjekte stellen einen Verbindungspunkt für die [**iprogressnotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) -Schnittstelle bereit, die durch den Downloadcode des asynchronen Monikers implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="04644-115">Asynchronous storage and stream objects provide a connection point for the [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) interface, which is implemented by the asynchronous moniker's downloading code.</span></span> <span data-ttu-id="04644-116">Die Implementierung der asynchronen Verbund Dateien ruft **iprogressnotify** auf, um dem Download Programminformationen zum Status des Downloadvorgangs bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="04644-116">The Asynchronous Compound Files implementation calls **IProgressNotify** to provide the downloader with information about the status of the downloading operation.</span></span>

 

 