---
title: IPropertySetStorage-NTFS-Datei System Implementierung
description: Die NTFS-Version 5,0 bietet eine Implementierung von IPropertySetStorage für Dateien auf einem NTFS-Volume, wenn die Dateien selbst keine Verbund Dateien sind.
ms.assetid: cd7290bb-bb4e-4dea-9bf6-2e1fdd0ebae8
keywords:
- IPropertySetStorage-Schnittstellen-STG, Implementierungen, NTFS-Dateisystem
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9b0d647b9cb804376a9efeb687b1524585ee938d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "106339491"
---
# <a name="ipropertysetstorage-ntfs-file-system-implementation"></a><span data-ttu-id="ef3a4-104">IPropertySetStorage-NTFS-Datei System Implementierung</span><span class="sxs-lookup"><span data-stu-id="ef3a4-104">IPropertySetStorage-NTFS File System Implementation</span></span>

<span data-ttu-id="ef3a4-105">Die NTFS-Version 5,0 bietet eine Implementierung von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) für Dateien auf einem NTFS-Volume, wenn die Dateien selbst keine Verbund Dateien sind.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-105">NTFS version 5.0 provides an implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) for files on an NTFS volume when the files themselves are not compound files.</span></span> <span data-ttu-id="ef3a4-106">Die NTFS-Implementierung entspricht der [Implementierung der Verbund Datei](ipropertysetstorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="ef3a4-106">The NTFS implementation is equivalent to the [compound file implementation](ipropertysetstorage-compound-file-implementation.md).</span></span> <span data-ttu-id="ef3a4-107">Weitere Informationen zu Ausnahmen finden Sie unter "Hinweise".</span><span class="sxs-lookup"><span data-stu-id="ef3a4-107">For more information about exceptions, see Remarks.</span></span>

<span data-ttu-id="ef3a4-108">**So erhalten Sie einen Zeiger auf die NTFS-Implementierung von IPropertySetStorage**</span><span class="sxs-lookup"><span data-stu-id="ef3a4-108">**To get a pointer to the NTFS implementation of IPropertySetStorage**</span></span>

1.  <span data-ttu-id="ef3a4-109">Rufen Sie [**stgforatestorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) auf, und geben Sie die **stgfmt- \_ Datei** im *grfFlags* -Parameter an, um eine neue Datei zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-109">Call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) and specify **STGFMT\_FILE** in the *grfFlags* parameter to create a new file.</span></span>
2.  <span data-ttu-id="ef3a4-110">Aufrufen [**von stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) und angeben der stgfmt-oder **stgfmt \_** -Enumerationswerte im *grfFlags* -Parameter, um eine vorhandene Datei zu öffnen. **\_**</span><span class="sxs-lookup"><span data-stu-id="ef3a4-110">Call [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) and specify either the **STGFMT\_FILE** or **STGFMT\_ANY** enumeration value in the *grfFlags* parameter to open an existing file.</span></span>

<span data-ttu-id="ef3a4-111">Allerdings können Sie die NTFS-Implementierung von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) nicht für eine Verbund Datei abrufen.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-111">However, you cannot obtain the NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) for a compound file.</span></span> <span data-ttu-id="ef3a4-112">Beim Öffnen einer Verbund Datei mit [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage)führt die Angabe des **stgfmt- \_ datumenumerationswerts** zu einem Fehler.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-112">When opening a compound file with [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage), specifying the **STGFMT\_FILE** enumeration value results in an error.</span></span>

<span data-ttu-id="ef3a4-113">Außerdem können einfache Eigenschaften Sätze nicht transaktiv sein.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-113">Also, simple property sets cannot be transacted.</span></span> <span data-ttu-id="ef3a4-114">Das heißt, Sie können **STGM- \_ Transaktionen** nicht im *grfMode* -Parameter der [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) -Methode und [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) -Methode angeben, es sei denn, Sie geben auch **propsetflag \_ nonsimple** im *grfFlags* -Parameter an.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-114">That is, you cannot specify **STGM\_TRANSACTED** in the *grfmode* parameter of the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) and [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) methods unless you also specify **PROPSETFLAG\_NONSIMPLE** in the *grfFlags* parameter.</span></span> <span data-ttu-id="ef3a4-115">Das Eigenschaften Satz-Speicher Objekt selbst unterstützt keine Transaktionsverarbeitung.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-115">The property set storage object itself does not support transaction processing.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="ef3a4-116">Verwendungs Zeitpunkt</span><span class="sxs-lookup"><span data-stu-id="ef3a4-116">When to Use</span></span>

<span data-ttu-id="ef3a4-117">Rufen Sie die [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Methoden auf, um Eigenschaften Sätze im aktuellen NTFS-Eigenschaften Satz Speicher zu erstellen, zu öffnen oder zu löschen.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-117">Call the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) methods to create, open, or delete property sets in the current NTFS property set storage.</span></span> <span data-ttu-id="ef3a4-118">Es gibt auch eine Methode, [**IPropertySetStorage:: Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), die einen Zeiger auf einen Enumerator bereitstellt, der zum Auflisten der Eigenschaften Sätze im Speicher verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-118">There is also a method, [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), that supplies a pointer to an enumerator that can be used to enumerate the property sets in the storage.</span></span>

## <a name="compatibility"></a><span data-ttu-id="ef3a4-119">Kompatibilität</span><span class="sxs-lookup"><span data-stu-id="ef3a4-119">Compatibility</span></span>

<span data-ttu-id="ef3a4-120">Die NTFS-Implementierungen von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) und [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) sind ab Windows 2000 verfügbar.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-120">The NTFS implementations of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) are available starting with Windows 2000.</span></span> <span data-ttu-id="ef3a4-121">Frühere Versionen können nicht auf diese Eigenschaften Sätze zugreifen.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-121">Earlier versions cannot access these property sets.</span></span>

<span data-ttu-id="ef3a4-122">Die NTFS-Implementierung speichert Eigenschaften Sätze in alternativen Streams einer NTFS-Datei.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-122">The NTFS implementation stores property sets in alternate streams of an NTFS file.</span></span> <span data-ttu-id="ef3a4-123">Die alternativen Streams müssen kopiert werden, wenn die Hauptdatei kopiert wird.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-123">The alternate streams must be copied when the main file is copied.</span></span>

> [!Caution]  
> <span data-ttu-id="ef3a4-124">Nicht alle Dateisysteme unterstützen solche Streams.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-124">Not all file systems support such streams.</span></span> <span data-ttu-id="ef3a4-125">Wenn eine NTFS-Datei mit Eigenschafts Sätzen in ein FAT-Volume kopiert wird, werden nur die Daten in der Datei kopiert. der Eigenschaften Satz geht verloren.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-125">If an NTFS file with property sets is copied to a FAT volume, only the data in the file is copied; the property set is lost.</span></span> <span data-ttu-id="ef3a4-126">In diesem Fall gibt die [**CopyFile**](/windows/desktop/api/winbase/nf-winbase-copyfile) -Funktion keinen Fehler zurück.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-126">The [**CopyFile**](/windows/desktop/api/winbase/nf-winbase-copyfile) function does not return an error in this case.</span></span>

 

> [!Caution]  
> <span data-ttu-id="ef3a4-127">Wenn es sich bei dem Computer, der die Dateikopie ausführt, nicht um einen Computer handelt, der unter Windows 2000 oder höher ausgeführt wird, können die Eigenschaften Sätze verloren gehen</span><span class="sxs-lookup"><span data-stu-id="ef3a4-127">If the computer performing the file copy is not a computer running on Windows 2000 or later, the property sets may be lost.</span></span> <span data-ttu-id="ef3a4-128">Wenn beispielsweise ein Computer, auf dem das Betriebssystem Windows 95 ausgeführt wird, eine NTFS-Datei kopiert, geht der Eigenschaften Satz verloren, auch wenn sich die Zieldatei ebenfalls auf einem NTFS-Volume befindet.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-128">For example, if a computer running on Windows 95 operating system copies an NTFS file, the property set is lost even if the destination file is also on an NTFS volume.</span></span>

 

## <a name="methods"></a><span data-ttu-id="ef3a4-129">Methoden</span><span class="sxs-lookup"><span data-stu-id="ef3a4-129">Methods</span></span>

<span data-ttu-id="ef3a4-130">Die NTFS-Dateisystem Implementierung von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) unterstützt die folgenden Methoden.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-130">The NTFS file system implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) supports the following methods.</span></span>

<dl> <dt>

<span data-ttu-id="ef3a4-131"><span id="IPropertySetStorage__Create"></span><span id="ipropertysetstorage__create"></span><span id="IPROPERTYSETSTORAGE__CREATE"></span>[**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)</span><span class="sxs-lookup"><span data-stu-id="ef3a4-131"><span id="IPropertySetStorage__Create"></span><span id="ipropertysetstorage__create"></span><span id="IPROPERTYSETSTORAGE__CREATE"></span>[**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)</span></span>
</dt> <dd>

<span data-ttu-id="ef3a4-132">Erstellt eine neue Eigenschaft, die im aktuellen NTFS-Dateispeicher festgelegt ist, und stellt bei der Rückgabe einen Schnittstellen Zeiger auf die Implementierung der NTFS-Datei [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) bereit.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-132">Creates a new property set in the current NTFS file storage and, on return, supplies an interface pointer to the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) NTFS file implementation.</span></span> <span data-ttu-id="ef3a4-133">Der im *GRF Mode* -Parameter angegebene Freigabe Modus muss " **STGM- \_ Freigabe \_ exklusiv**" lauten.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-133">The sharing mode specified in the *grfmode* parameter must be **STGM\_SHARE\_EXCLUSIVE**.</span></span>

</dd> <dt>

<span data-ttu-id="ef3a4-134"><span id="IPropertySetStorage__Open"></span><span id="ipropertysetstorage__open"></span><span id="IPROPERTYSETSTORAGE__OPEN"></span>[**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)</span><span class="sxs-lookup"><span data-stu-id="ef3a4-134"><span id="IPropertySetStorage__Open"></span><span id="ipropertysetstorage__open"></span><span id="IPROPERTYSETSTORAGE__OPEN"></span>[**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)</span></span>
</dt> <dd>

<span data-ttu-id="ef3a4-135">Öffnet eine vorhandene Eigenschaft, die im aktuellen Eigenschaften Speicher festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-135">Opens an existing property set in the current property storage.</span></span> <span data-ttu-id="ef3a4-136">Bei der Rückgabe stellt Sie einen Schnittstellen Zeiger auf die NTFS-Datei Implementierung von [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)bereit.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-136">On return, it supplies an interface pointer to the NTFS file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage).</span></span> <span data-ttu-id="ef3a4-137">Der im *GRF Mode* -Parameter angegebene Freigabe Modus muss " **STGM- \_ Freigabe \_ exklusiv**" lauten.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-137">The sharing mode specified in the *grfmode* parameter must be **STGM\_SHARE\_EXCLUSIVE**.</span></span>

</dd> <dt>

<span data-ttu-id="ef3a4-138"><span id="IPropertySetStorage__Delete"></span><span id="ipropertysetstorage__delete"></span><span id="IPROPERTYSETSTORAGE__DELETE"></span>[**IPropertySetStorage::D Elete**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-delete)</span><span class="sxs-lookup"><span data-stu-id="ef3a4-138"><span id="IPropertySetStorage__Delete"></span><span id="ipropertysetstorage__delete"></span><span id="IPROPERTYSETSTORAGE__DELETE"></span>[**IPropertySetStorage::Delete**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-delete)</span></span>
</dt> <dd>

<span data-ttu-id="ef3a4-139">Löscht eine Eigenschaft, die im aktuellen Eigenschaften Speicher festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-139">Deletes a property set in the current property storage.</span></span>

</dd> <dt>

<span data-ttu-id="ef3a4-140"><span id="IPropertySetStorage__Enum"></span><span id="ipropertysetstorage__enum"></span><span id="IPROPERTYSETSTORAGE__ENUM"></span>[**IPropertySetStorage:: Aufzählung**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum)</span><span class="sxs-lookup"><span data-stu-id="ef3a4-140"><span id="IPropertySetStorage__Enum"></span><span id="ipropertysetstorage__enum"></span><span id="IPROPERTYSETSTORAGE__ENUM"></span>[**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="ef3a4-141">Erstellt ein-Objekt, das zum Aufzählen von [**Status-setstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) -Strukturen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-141">Creates an object used to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures.</span></span> <span data-ttu-id="ef3a4-142">Jede **Status-setstg** -Struktur stellt Daten zu einem einzelnen Eigenschaften Satz bereit.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-142">Each **STATPROPSETSTG** structure provides data about a single property set.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="ef3a4-143">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="ef3a4-143">Remarks</span></span>

<span data-ttu-id="ef3a4-144">Die NTFS-Implementierungen von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) und [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) speichern Eigenschaften Sätze in einer Datei, ohne den Inhalt dieser Datei zu beeinträchtigen.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-144">The NTFS implementations of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) store property sets in a file without affecting the contents of that file.</span></span> <span data-ttu-id="ef3a4-145">Wenn Sie z. b. in einer HTML-Datei mit dem Namen Default.htm einen Eigenschaften Satz erstellen, wird diese Datei weiterhin ordnungsgemäß in einem Webbrowser angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-145">For example, if you create a property set in an HTML file named Default.htm, that file still displays properly in a Web browser.</span></span> <span data-ttu-id="ef3a4-146">Das heißt, dass Änderungen an einer Datei, die diese beiden Schnittstellen verwendet, nicht erkennbar sind, wenn Sie [**mit der Funktion**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) "-Funktion" auf eine Datei zugreifen.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-146">That is, changes to a file using these two interfaces are undetectable when accessing a file with the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

<span data-ttu-id="ef3a4-147">Die NTFS-Implementierung von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) bietet eine sichere Implementierung, wenn Sie zum Schreiben von Eigenschaften Sätzen in eine Datei auf einem Volume der NTFS-Version 5,0 verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-147">The NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) provides a safe implementation when used to write property sets to a file on an NTFS version 5.0 volume.</span></span> <span data-ttu-id="ef3a4-148">Solche Eigenschaften Sätze können von der Implementierung auch im Falle eines Systemfehlers nicht beschädigt werden.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-148">Such property sets cannot be corrupted by the implementation even in the event of a system failure.</span></span> <span data-ttu-id="ef3a4-149">Wenn beispielsweise die Leistung eines Systems während eines Aufrufens von [**IPropertyStorage:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) fehlschlägt, während der Eigenschaften Satz auf den Datenträger geleert wird, bleibt der Eigenschaften Satz nie in einem Zwischenzustand.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-149">For example, if the power to a system fails during a call to [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) while the property set is flushed to the disk, the property set is never left in an intermediate state.</span></span> <span data-ttu-id="ef3a4-150">Die vorherige Version des Eigenschaften Satzes bleibt bestehen, oder alle Updates werden gespeichert.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-150">Either the previous version of the property set remains or all of the updates are saved.</span></span>

<span data-ttu-id="ef3a4-151">Die NTFS-Implementierung von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) unterscheidet sich wie folgt von der Implementierung der Verbund Datei:</span><span class="sxs-lookup"><span data-stu-id="ef3a4-151">The NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) differs from the compound file implementation in the following ways:</span></span>

-   <span data-ttu-id="ef3a4-152">Eine von der [**ienumstatus propsetstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) -Schnittstelle erhaltene " [**Status-setstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) "-Struktur enthält einen **CLSID** -Member, dessen Wert immer NULL (**CLSID \_ null**) ist.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-152">A [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure obtained from the [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface contains a **clsid** member whose value is always zero (**CLSID\_NULL**).</span></span> <span data-ttu-id="ef3a4-153">Bei der Implementierung der Verbund Datei wird der richtige **CLSID** -Member für nicht-einfach zurückgegeben (siehe [Speicher-und Streamobjekte für Eigenschaften](storage-vs--stream-for-a-property-set.md)Sätze).</span><span class="sxs-lookup"><span data-stu-id="ef3a4-153">With the compound file implementation, the correct **clsid** member is returned for non-simple (see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md)) property sets.</span></span>
-   <span data-ttu-id="ef3a4-154">Wenn Sie eine NTFS-Implementierung des [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Schnittstellen Zeigers mithilfe der [**stgforatestorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) -oder [**stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) -Funktion abrufen, muss der *GRF Mode* -Parameter denselben Regeln wie für die Implementierung der Verbund Datei entsprechen.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-154">When obtaining an NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface pointer using the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, the *grfmode* parameter must follow the same rules as for the compound file implementation.</span></span>

    <span data-ttu-id="ef3a4-155">Außerdem dürfen die folgenden Flags nicht verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="ef3a4-155">In addition, the following flags may not be used:</span></span>

    <span data-ttu-id="ef3a4-156">**STGM \_ Einfach**, **STGM \_ transaktiv**, **STGM \_ Convert**, **STGM \_ Priority** und **STGM \_ deleteonrelease**.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-156">**STGM\_SIMPLE**, **STGM\_TRANSACTED**, **STGM\_CONVERT**, **STGM\_PRIORITY**, and **STGM\_DELETEONRELEASE**.</span></span>

-   <span data-ttu-id="ef3a4-157">Wenn eine NTFS- [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Schnittstelle von den Funktionen " [**stganatestorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) " oder " [**stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) " abgerufen wird, gelten die Freigabe Modi hauptsächlich für andere Instanzen dieser Schnittstelle und nicht für Instanzen des Öffnens der Datei.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-157">When an NTFS [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface is obtained by the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) functions, the sharing modes primarily apply to other instances of that interface, and not to instances of opening the file itself.</span></span> <span data-ttu-id="ef3a4-158">Wenn z. b. eine NTFS- **IPropertySetStorage** -Schnittstelle durch Aufrufen der Funktion " **stgopenstorageex** " geöffnet wird und der *grfMode* -Parameter auf " **STGM \_ infowrite \| STGM- \_ Freigabe \_ exklusiv**" festgelegt ist, kann die Datei mit der [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) -Funktion geöffnet werden.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-158">For example, if an NTFS **IPropertySetStorage** interface is opened by calling the **StgOpenStorageEx** function, with the *grfmode* parameter set to **STGM\_READWRITE\|STGM\_SHARE\_EXCLUSIVE**, it is possible to open the file with the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

    <span data-ttu-id="ef3a4-159">Solche gleichzeitigen Instanzen, die diese Schnittstelle öffnen, unterliegen den folgenden Einschränkungen: der Parameter " *dwsharemode* " in [**der Funktion "**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) Funktion" muss das **\_ \_ leseflag für die Dateifreigabe** angeben, und der *dwaccess* -Parameter darf das Flag " **Delete** " nicht angeben.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-159">Such simultaneous instances of opening this interface are subject to the following constraints: the *dwShareMode* parameter in the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function must specify the **FILE\_SHARE\_READ** flag, and the *dwAccess* parameter must not specify the **DELETE** flag.</span></span> <span data-ttu-id="ef3a4-160">Außerdem dürfen die Funktionen " [**DeleteFile**](/windows/desktop/api/fileapi/nf-fileapi-deletefilea) " und " [**muvefile**](/windows/desktop/api/winbase/nf-winbase-movefile) " nicht für eine Datei aufgerufen werden, für die diese Eigenschaften Satz Schnittstellen geöffnet sind, da diese Funktionen den **Lösch** Zugriff auf die Datei erfordern.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-160">Also, the [**DeleteFile**](/windows/desktop/api/fileapi/nf-fileapi-deletefilea) and [**MoveFile**](/windows/desktop/api/winbase/nf-winbase-movefile) functions must not be called on a file for which these property set interfaces are open, as these functions require **DELETE** access to the file.</span></span>

-   <span data-ttu-id="ef3a4-161">Wenn eine NTFS- [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Methode als schreibgeschützt geöffnet wird und die Datei zurzeit keine Eigenschaften Sätze hat, wird die Datei vom zurückgegebenen Objekt nicht tatsächlich geöffnet.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-161">If an NTFS [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) method is opened as read-only, and the file currently has no property sets, the object returned will not actually hold open the file.</span></span> <span data-ttu-id="ef3a4-162">Folglich sind andere Öffnungen dieser Datei erfolgreich, auch wenn der Freigabe Modus des ursprünglichen Öffnungs Vorgangs diese andernfalls ablehnen würde.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-162">Consequently, other openings of that file will succeed, even if the sharing mode of the original open operation would otherwise reject it.</span></span>

    <span data-ttu-id="ef3a4-163">Beispiel Wenn eine NTFS- [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Klasse im Modus **STGM-Lese-und-Freigabe- \_ \| \_ Freigabe \_ exklusiv** geöffnet ist, und die Datei keine Eigenschaften Sätze hat, ist es möglich, die Datei " **STGM-Lese \_ schreiben \| STGM- \_ Freigabe \_ exklusiv**" gleichzeitig zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="ef3a4-163">Example; if an NTFS [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is opened in the mode **STGM\_READ\|STGM\_SHARE\_EXCLUSIVE**, and the file has no property sets, it will be possible to simultaneously open the file **STGM\_READWRITE\|STGM\_SHARE\_EXCLUSIVE**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ef3a4-164">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ef3a4-164">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ef3a4-165">IPropertyStorage-NTFS-Datei System Implementierung</span><span class="sxs-lookup"><span data-stu-id="ef3a4-165">IPropertyStorage-NTFS File System Implementation</span></span>](ipropertystorage-ntfs-file-system-implementation.md)
</dt> <dt>

[<span data-ttu-id="ef3a4-166">**IPropertySetStorage**</span><span class="sxs-lookup"><span data-stu-id="ef3a4-166">**IPropertySetStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)
</dt> <dt>

[<span data-ttu-id="ef3a4-167">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="ef3a4-167">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="ef3a4-168">**IStorage:: enumelements**</span><span class="sxs-lookup"><span data-stu-id="ef3a4-168">**IStorage::EnumElements**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements)
</dt> <dt>

[<span data-ttu-id="ef3a4-169">**Propsetflag-Konstanten**</span><span class="sxs-lookup"><span data-stu-id="ef3a4-169">**PROPSETFLAG Constants**</span></span>](propsetflag-constants.md)
</dt> <dt>

[<span data-ttu-id="ef3a4-170">**Status-setstg**</span><span class="sxs-lookup"><span data-stu-id="ef3a4-170">**STATPROPSETSTG**</span></span>](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)
</dt> </dl>

 

 