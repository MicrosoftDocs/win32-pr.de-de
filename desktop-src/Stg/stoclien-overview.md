---
title: Übersicht über stoclien
description: Das stoclien-Beispiel veranschaulicht, wie der Client strukturierte Speicher verwendet und wie er eine Serverkomponente anweist, diesen Speicher zu verwenden.
ms.assetid: 1f540e0f-2189-4f45-aad3-9b4b56732907
keywords:
- Übersicht über stoclien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee37f6f84cf981bda637abbd96ff8e8f0314d8ee
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "106338567"
---
# <a name="stoclien-overview"></a><span data-ttu-id="d5b9e-104">Übersicht über stoclien</span><span class="sxs-lookup"><span data-stu-id="d5b9e-104">StoClien Overview</span></span>

## <a name="purpose"></a><span data-ttu-id="d5b9e-105">Zweck</span><span class="sxs-lookup"><span data-stu-id="d5b9e-105">Purpose</span></span>

<span data-ttu-id="d5b9e-106">Der Hauptschwerpunkt des [stoclien](structured-storage-client-sample--stoclien-.md) -Beispiels ist, wie der Client strukturierte Speicher verwendet und wie er eine Serverkomponente anweist, diesen Speicher zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-106">The principal focus of the [StoClien](structured-storage-client-sample--stoclien-.md) sample is how the client uses structured storage and how it instructs a server component to use this storage.</span></span> <span data-ttu-id="d5b9e-107">Das stoclien-Beispiel veranschaulicht ein Programmiermodell strukturierter Speicherdienste.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-107">The StoClien sample demonstrates a programming model of structured storage services.</span></span>

## <a name="functionality"></a><span data-ttu-id="d5b9e-108">Funktionalität</span><span class="sxs-lookup"><span data-stu-id="d5b9e-108">Functionality</span></span>

<span data-ttu-id="d5b9e-109">Die [stoclien](structured-storage-client-sample--stoclien-.md) -Funktionalität ähnelt den "Scribble"-Beispielen in einigen Versionen von Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-109">The [StoClien](structured-storage-client-sample--stoclien-.md) functionality is similar to the "scribble" samples in some versions of Microsoft Visual C++.</span></span> <span data-ttu-id="d5b9e-110">Der Unterschied zwischen dem stoclien-Beispiel und dem [stoservicesbeispiel](structured-storage-server-sample--stoserve-.md) ist eine interne Architektur, die auf der com-Technologie basiert.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-110">The difference between the StoClien sample and the [StoServe](structured-storage-server-sample--stoserve-.md) sample is an internal architecture based on COM technology.</span></span> <span data-ttu-id="d5b9e-111">Zwischen com-Client und com-Server wird eine deutliche Unterscheidung der Architektur beibehalten.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-111">A clear architectural distinction is kept between COM client and COM server.</span></span>

<span data-ttu-id="d5b9e-112">[Stoclien](structured-storage-client-sample--stoclien-.md) lädt und speichert seine Zeichnungen in der strukturierten Speicherung von com-Verbund Dateien.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-112">[StoClien](structured-storage-client-sample--stoclien-.md) loads and saves its drawings in the structured storage of COM compound files.</span></span>

<span data-ttu-id="d5b9e-113">Das [stoclien](structured-storage-client-sample--stoclien-.md) -Beispiel erstellt und verwendet das Verbindungs fähige copaper-com-Objekt, das als CLSID- \_ dllpaper-Komponente auf dem [stoservice](structured-storage-server-sample--stoserve-.md) -Server bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-113">The [StoClien](structured-storage-client-sample--stoclien-.md) sample creates and uses the connectable COPaper COM object that is provided as the CLSID\_DllPaper component in the [StoServe](structured-storage-server-sample--stoserve-.md) server.</span></span> <span data-ttu-id="d5b9e-114">Der stoclien-Client erstellt ein copaper-Objekt und steuert es über die iPaper-Schnittstelle, die das Objekt verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-114">The StoClien client creates a COPaper object and controls it through the IPaper interface that the object exposes.</span></span> <span data-ttu-id="d5b9e-115">Stoclien ruft Zeichnungsdaten vom Benutzer ab und stellt Sie grafisch in einem von ihm verwalteten Fenster dar.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-115">StoClien obtains drawing data from the user and graphically represents it in a window that it manages.</span></span> <span data-ttu-id="d5b9e-116">Stoclien verwendet die copaper iPaper-Schnittstelle zum Speichern der Zeichnungsdaten im copaper und zum Weiterleiten von Dateispeicher Vorgängen an diese Daten.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-116">StoClien uses the COPaper IPaper interface to save the drawing data in COPaper and to direct file storage operations on this data.</span></span>

<span data-ttu-id="d5b9e-117">Ein copaper com-Objekt kapselt nur den serverbasierten Speicher der Zeichnungs Papier Daten: auf der Serverseite wird kein grafisches GUI-Verhalten (Graphical User Interface) bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-117">A COPaper COM object encapsulates only the server-based storage of the drawing paper data: No graphical user interface (GUI) behavior is provided on the server side.</span></span> <span data-ttu-id="d5b9e-118">Das gesamte GUI-Verhalten ist im Client isoliert.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-118">All GUI behavior is isolated in the client.</span></span> <span data-ttu-id="d5b9e-119">Die Daten Verwaltungs-und Speicherfunktionen von copaper-Objekten sind nur über eine benutzerdefinierte COM-Schnittstelle (iPaper) verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-119">The data management and storage features of COPaper objects are available only through an COM custom interface, IPaper.</span></span>

<span data-ttu-id="d5b9e-120">[Stoclien](structured-storage-client-sample--stoclien-.md) arbeitet mit dem copaper zusammen, um die kopierdaten zu laden und zu speichern.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-120">[StoClien](structured-storage-client-sample--stoclien-.md) cooperates with the COPaper to load and save the COPaper drawing data.</span></span> <span data-ttu-id="d5b9e-121">Stoclien erhält eine [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Schnittstelle für das Speicher Objekt in einer Verbund Datei.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-121">StoClien obtains an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface for the storage object in a compound file.</span></span> <span data-ttu-id="d5b9e-122">In den Lade-und Speicher Vorgängen übergibt stoclien einen Zeiger an die **IStorage** -Schnittstelle auf dem Server.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-122">In its load and save operations, StoClien passes a pointer to the **IStorage** interface to COPaper in the server.</span></span> <span data-ttu-id="d5b9e-123">Copaper verwendet den bereitgestellten **IStorage** , um Streams im Speicher zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-123">COPaper uses the provided **IStorage** to create streams in the storage.</span></span> <span data-ttu-id="d5b9e-124">Copaper kann dann die standardmäßige [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -Schnittstelle verwenden, um die von ihr verwalteten Zeichnungsdaten zu lesen und zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-124">COPaper can then use the standard [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interface for reading and writing the drawing data it manages.</span></span>

<span data-ttu-id="d5b9e-125">Copaper verwaltet nur die Zeichnungsdaten; Es führt keine GUI-Aktionen aus.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-125">COPaper only manages the drawing data; it performs no GUI actions.</span></span> <span data-ttu-id="d5b9e-126">[Stoclien](structured-storage-client-sample--stoclien-.md) stellt die GUI für die Zeichnungsanwendung bereit.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-126">[StoClien](structured-storage-client-sample--stoclien-.md) provides the GUI for the drawing application.</span></span> <span data-ttu-id="d5b9e-127">Dies wird in einem zentralen cguipaper C++-Objekt gekapselt.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-127">It encapsulates this in a central CGuiPaper C++ object.</span></span>

<span data-ttu-id="d5b9e-128">[Stoclien](structured-storage-client-sample--stoclien-.md) implementiert auch die benutzerdefinierte ipapersink-Schnittstelle in einem copapersink-com-Objekt und verbindet diese Schnittstelle mit einem entsprechenden Verbindungspunkt im Server-copaper-Objekt.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-128">[StoClien](structured-storage-client-sample--stoclien-.md) also implements the custom IPaperSink interface in a COPaperSink COM object and connects this interface to an appropriate connection point in the server COPaper object.</span></span> <span data-ttu-id="d5b9e-129">Copaper verwendet die verbundene ipapersink-Schnittstelle, um Benachrichtigungen zurück an stoclien zu senden.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-129">COPaper uses the connected IPaperSink interface to send notifications back to StoClien.</span></span> <span data-ttu-id="d5b9e-130">Das normale GUI-Neuzeichnen der copaper-Zeichnungsdaten erfolgt in stoclien mithilfe der kopierbaren Verbindungs fähigen-Objekttechnologie.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-130">The normal GUI repainting of the COPaper drawing data is done in StoClien using the COPaper connectable object technology.</span></span>

<span data-ttu-id="d5b9e-131">[Stoclien](structured-storage-client-sample--stoclien-.md) ist eine Anwendung, die Sie direkt oder über das Eingabe Aufforderungs Fenster ausführen können.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-131">[StoClien](structured-storage-client-sample--stoclien-.md) is an application that you can execute directly in the normal manner or from the command prompt window.</span></span> <span data-ttu-id="d5b9e-132">Stoclien akzeptiert einen optionalen Dateinamen Parameter in der Befehlszeile.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-132">StoClien accepts an optional file name parameter on the command line.</span></span>

<span data-ttu-id="d5b9e-133">Im folgenden Beispiel ist Drawing. PAP eine Verbund Datei, die eine mit dllpaper kompatible strukturierte Speicherung von Zeichnungsdaten enthält.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-133">In the following example, Drawing.pap is a compound file containing DllPaper-compatible structured storage of drawing data.</span></span> <span data-ttu-id="d5b9e-134">Wenn kein Befehlszeilen-Dateiname-Parameter angegeben ist, wird von [stoclien](structured-storage-client-sample--stoclien-.md) der Standard Dateiname stoclien. PAP verwendet, und es wird versucht, das Verzeichnis im gleichen Verzeichnis wie das ausführende Stoclien.exe zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-134">If no command line file name parameter is specified, [StoClien](structured-storage-client-sample--stoclien-.md) uses the default file name Stoclien.pap and attempts to open it in the same directory as the executing Stoclien.exe.</span></span>

<span data-ttu-id="d5b9e-135">**Stoclien c: \\ Zeichnungen \\ Drawing. PAP**</span><span class="sxs-lookup"><span data-stu-id="d5b9e-135">**StoClien c:\\drawings\\drawing.pap**</span></span>

## <a name="support-information"></a><span data-ttu-id="d5b9e-136">Supportinformationen</span><span class="sxs-lookup"><span data-stu-id="d5b9e-136">Support Information</span></span>

<span data-ttu-id="d5b9e-137">Weitere Informationen, funktionale Beschreibungen und ein Code-Tutorial für [stoclien](structured-storage-client-sample--stoclien-.md)finden Sie im Abschnitt Code Tour in Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-137">For more information, functional descriptions and a code tutorial for [StoClien](structured-storage-client-sample--stoclien-.md), see the Code Tour section in Stoclien.htm.</span></span> <span data-ttu-id="d5b9e-138">Weitere Informationen zum externen Benutzer Vorgang von stoclien finden Sie in den Abschnitten zu Verwendung und Betrieb in Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-138">For more information about the external user operation of StoClien, see the Usage and Operation sections in Stoclien.htm.</span></span> <span data-ttu-id="d5b9e-139">Um Stoclient.htm zu lesen, führen Sie Tutorial.exe im haupttutorial-Verzeichnis aus, und klicken Sie in der Tabelle mit Lektionen auf die stoclien-Lektion.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-139">To read Stoclient.htm, run Tutorial.exe in the main tutorial directory and click the StoClien lesson in the table of lessons.</span></span> <span data-ttu-id="d5b9e-140">Sie können auch auf Stoclien.htm klicken, nachdem Sie das haupttutorial Verzeichnis in Windows-Explorer gefunden haben.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-140">Alternatively, click Stoclien.htm after locating the main tutorial directory in Windows Explorer.</span></span> <span data-ttu-id="d5b9e-141">Weitere Informationen zur Funktionsweise von [**stoservice**](structured-storage-server-sample--stoserve-.md) und zur Bereitstellung der zugehörigen Dienste für stoclien finden Sie unter Stoserve.htm im haupttutorial Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-141">For more information about how [**StoServe**](structured-storage-server-sample--stoserve-.md) works and exposes its services to StoClien, see Stoserve.htm in the main tutorial directory.</span></span> <span data-ttu-id="d5b9e-142">Beachten Sie, dass Sie die Stoserve.dll vor dem Erstellen von stoclien erstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-142">Be aware that you must build the Stoserve.dll before building StoClien.</span></span> <span data-ttu-id="d5b9e-143">Das Makefile für [**stoservice**](structured-storage-server-sample--stoserve-.md) registriert diesen Server in der Systemregistrierung. Daher müssen Sie [**stoservice**](structured-storage-server-sample--stoserve-.md) erstellen, bevor Sie versuchen, stoclien auszuführen.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-143">The makefile for [**StoServe**](structured-storage-server-sample--stoserve-.md) registers that server in the system registry, so you must build [**StoServe**](structured-storage-server-sample--stoserve-.md) before attempting to run StoClien.</span></span>

<span data-ttu-id="d5b9e-144">Weitere Informationen zum Einrichten eines Systems zum Erstellen und Testen der Codebeispiele in dieser com-tutorialreihe finden Sie unter [Erstellen von Beispielen](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-144">For more information about setting up a system to build and test the code samples in this COM Tutorial series, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="d5b9e-145">Das angegebene Makefile-Element (Makefile) ist Microsoft NMAKE-kompatibel.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-145">The supplied makefile (MAKEFILE) is Microsoft NMAKE-compatible.</span></span> <span data-ttu-id="d5b9e-146">Wenn Sie einen Debugbuild erstellen möchten, geben Sie im Eingabe Aufforderungs Fenster den Befehl NMAKE aus.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-146">To create a debug build, issue the NMAKE command in the command prompt window.</span></span>

<span data-ttu-id="d5b9e-147">Zur einfacheren Verwendung wird für jedes Beispiel eine Projektdatei bereitgestellt, die in Microsoft Visual Studio verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-147">For convenience, a project file is provided for each sample for use in Microsoft Visual Studio.</span></span> <span data-ttu-id="d5b9e-148">Um das Projekt für das [stoclien](structured-storage-client-sample--stoclien-.md) -Beispiel zu laden, führen Sie Visual Studio wie folgt an der Eingabeaufforderung im Beispiel Verzeichnis aus:</span><span class="sxs-lookup"><span data-stu-id="d5b9e-148">To load the project for the [StoClien](structured-storage-client-sample--stoclien-.md) sample, run Visual Studio at the command prompt in the sample directory as follows:</span></span>

<span data-ttu-id="d5b9e-149">Msdev-stoclien. DSP</span><span class="sxs-lookup"><span data-stu-id="d5b9e-149">MSDEV STOCLIEN.DSP</span></span>

<span data-ttu-id="d5b9e-150">Sie können auch auf die Datei stoclient. DSP in Windows-Explorer doppelklicken, um ein Beispiel Projekt in Visual Studio zu laden.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-150">You can also double-click the Stoclient.dsp file in Windows Explorer to load a sample project into Visual Studio.</span></span> <span data-ttu-id="d5b9e-151">In Visual Studio können Sie die C++-Klassen der Beispiel Quelle durchsuchen und im Allgemeinen die anderen edit-compile-Debug-Vorgänge durchführen.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-151">In Visual Studio, you can browse the C++ classes of the sample source and generally perform the other edit-compile-debug operations.</span></span> <span data-ttu-id="d5b9e-152">Beachten Sie, dass die Kompilierung dieser Beispiele in Visual Studio als Teil des Server-SDK die ordnungsgemäße Einstellung von Verzeichnis Pfaden in Visual Studio erfordert.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-152">Be aware that, as part of the Server SDK, the compilation of these samples from within Visual Studio requires the proper setting of directory paths in Visual Studio.</span></span> <span data-ttu-id="d5b9e-153">Weitere Informationen finden Sie unter [Erstellen von Beispielen](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-153">For more information, see [How to Build Samples](how-to-build-samples.md).</span></span>

## <a name="remarks"></a><span data-ttu-id="d5b9e-154">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="d5b9e-154">Remarks</span></span>

<span data-ttu-id="d5b9e-155">Das Client Beispiel und andere verwandte Beispiele müssen kompiliert werden, bevor Sie den Client ausführen können.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-155">The client sample and other related samples must be compiled before you can run the client.</span></span> <span data-ttu-id="d5b9e-156">Weitere Informationen zum Erstellen der Beispiele finden Sie unter [Erstellen von Beispielen](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="d5b9e-156">For more information about building the samples, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="d5b9e-157">Wenn Sie die entsprechenden Beispiele erstellt haben, ist Stoclien.exe die ausführbare Client Datei für dieses Beispiel.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-157">If you have built the appropriate samples, Stoclien.exe is the client executable to run for this sample.</span></span>

<span data-ttu-id="d5b9e-158">Die Stoclien.exe-Anwendung stellt die Benutzeroberfläche für dieses Tutorial bereit.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-158">The Stoclien.exe application provides the user interface for this tutorial.</span></span> <span data-ttu-id="d5b9e-159">Er führt die zugeordneten, aber unabhängigen Stoserve.dll aus, um die Client-und Server Verwendung von com-strukturiertem Speicher in Verbund Dateien zu veranschaulichen.</span><span class="sxs-lookup"><span data-stu-id="d5b9e-159">It exercises the associated, but independent, Stoserve.dll to demonstrate both client and server use of COM structured storage in compound files.</span></span>

 

 




