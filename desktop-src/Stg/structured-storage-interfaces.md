---
title: Strukturierte Speicher Schnittstellen
description: Strukturierte Speicherdienste sind in drei Kategorien von Schnittstellen organisiert.
ms.assetid: a4281f07-eae4-4bcb-8d16-b6c0bd3c5b21
keywords:
- Strukturierte Speicher Schnittstellen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0010a0d4dec4908111c8a5bb939f795f0a2b2eb3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "106339499"
---
# <a name="structured-storage-interfaces"></a><span data-ttu-id="486b0-104">Strukturierte Speicher Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="486b0-104">Structured Storage Interfaces</span></span>

<span data-ttu-id="486b0-105">Strukturierte Speicherdienste sind in drei Kategorien von [Schnittstellen](interfaces.md)organisiert.</span><span class="sxs-lookup"><span data-stu-id="486b0-105">Structured Storage services are organized into three categories of [interfaces](interfaces.md).</span></span> <span data-ttu-id="486b0-106">Jede Gruppe stellt einen aufeinander folgenden Grad der Dereferenzierung oder Abstraktion zwischen einer Verbund Datei, den darin enthaltenen Objekten und den physischen Medien dar, auf denen diese einzelnen Komponenten gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="486b0-106">Each set represents a successive level of indirection or abstraction between a compound file, the objects it contains, and the physical media in which these individual components are stored.</span></span>

<span data-ttu-id="486b0-107">Die erste Kategorie der Schnittstellen besteht aus [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream)und [**irootstorage**](/windows/desktop/api/Objidl/nn-objidl-irootstorage).</span><span class="sxs-lookup"><span data-stu-id="486b0-107">The first category of interfaces consists of [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), and [**IRootStorage**](/windows/desktop/api/Objidl/nn-objidl-irootstorage).</span></span> <span data-ttu-id="486b0-108">Die ersten beiden Schnittstellen definieren, wie Objekte in einer Verbund Datei gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="486b0-108">The first two interfaces define how objects are stored within a compound file.</span></span> <span data-ttu-id="486b0-109">Diese Schnittstellen stellen Methoden zum Öffnen von Speicherelementen, zum Commit und zum Zurücksetzen von Änderungen, zum Kopieren und Verschieben von Elementen sowie zum Lesen und Schreiben von Streams bereit.</span><span class="sxs-lookup"><span data-stu-id="486b0-109">These interfaces provide methods for opening storage elements, committing and reverting changes, copying and moving elements, and reading and writing streams.</span></span> <span data-ttu-id="486b0-110">Diese Schnittstellen erkennen nicht die systemeigenen Datenformate der einzelnen Objekte und verfügen daher über keine Methoden zum Speichern dieser Objekte in einem persistenten Speicher.</span><span class="sxs-lookup"><span data-stu-id="486b0-110">These interfaces do not recognize the native data formats of the individual objects and therefore have no methods for saving those objects to persistent storage.</span></span> <span data-ttu-id="486b0-111">Die **irootstorage** -Schnittstelle verfügt über eine einzelne Methode zum Zuordnen eines Verbund Dokuments zu einem zugrunde liegenden Dateisystem Namen.</span><span class="sxs-lookup"><span data-stu-id="486b0-111">The **IRootStorage** interface has a single method for associating a compound document with an underlying file system name.</span></span> <span data-ttu-id="486b0-112">Clients müssen diese Schnittstellen für Ihre Verbund Dateien implementieren.</span><span class="sxs-lookup"><span data-stu-id="486b0-112">Clients must implement these interfaces for their compound files.</span></span>

<span data-ttu-id="486b0-113">Die zweite Kategorie von Schnittstellen besteht aus den [**ipersistent**](/windows/win32/api/objidl/nn-objidl-ipersist) -Schnittstellen, die von Objekten implementiert werden, um die persistenten Daten zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="486b0-113">The second category of interfaces consists of the [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist) interfaces, which objects implement to manage their persistent data.</span></span> <span data-ttu-id="486b0-114">Diese Schnittstellen stellen Methoden zum Lesen der Datenformate einzelner Objekte bereit und wissen daher, wie Sie gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="486b0-114">These interfaces provide methods to read the data formats of individual objects and therefore know how to store them.</span></span> <span data-ttu-id="486b0-115">-Objekte sind für die Implementierung dieser Schnittstellen verantwortlich, da Clients die systemeigenen Datenformate ihrer in der Liste eingefügten Objekte nicht kennen.</span><span class="sxs-lookup"><span data-stu-id="486b0-115">Objects are responsible for implementing these interfaces because clients do not know the native data formats of their nested objects.</span></span> <span data-ttu-id="486b0-116">Diese Schnittstellen haben jedoch keine Kenntnis von bestimmten physischen Speichermedien.</span><span class="sxs-lookup"><span data-stu-id="486b0-116">These interfaces, however, have no knowledge of specific physical storage media.</span></span>

<span data-ttu-id="486b0-117">Eine dritte Kategorie besteht aus einer einzelnen Schnittstelle, [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes), die Methoden zum Schreiben von Dateien auf bestimmte physische Medien, wie z. b. eine Festplatte oder ein Bandlaufwerk, bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="486b0-117">A third category consists of a single interface, [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes), which provides methods for writing files to specific physical media, such as a hard disk or tape drive.</span></span> <span data-ttu-id="486b0-118">Die meisten Anwendungen implementieren jedoch die **ILockBytes** -Schnittstelle nicht, da com bereits Implementierungen für die beiden häufigsten Situationen bereitstellt, bei denen es sich um eine dateibasierte Implementierung und eine speicherbasierte Implementierung handelt.</span><span class="sxs-lookup"><span data-stu-id="486b0-118">However, most applications will not implement the **ILockBytes** interface because COM already provides implementations for the two most common situations, which are File-based implementation and Memory-based implementation.</span></span> <span data-ttu-id="486b0-119">Das Verbund Dateispeicher-Objekt ruft die **ILockBytes** -Methoden auf, die Sie nicht direkt in der-Implementierung aufrufen.</span><span class="sxs-lookup"><span data-stu-id="486b0-119">The compound file storage object calls the **ILockBytes** methods you do not call them directly in the implementation.</span></span>

## <a name="compound-file-implementation-limits"></a><span data-ttu-id="486b0-120">Implementierungs Limits für Verbund Dateien</span><span class="sxs-lookup"><span data-stu-id="486b0-120">Compound File Implementation Limits</span></span>

<span data-ttu-id="486b0-121">Die com-Implementierung der strukturierten Speicherarchitektur wird als *Verbund Dateien* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="486b0-121">The COM implementation of Structured Storage architecture is called *compound files*.</span></span> <span data-ttu-id="486b0-122">Speicher Objekte, wie in Verbund Dateien implementiert, enthalten eine Implementierung der Schnittstellen [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) und [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) .</span><span class="sxs-lookup"><span data-stu-id="486b0-122">Storage objects, as implemented in compound files, include an implementation of the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interfaces.</span></span>

<span data-ttu-id="486b0-123">Zeiger auf die Implementierung dieser Schnittstellen in Verbund Dateien werden durch Aufrufen der [**stgcreatestorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) -Funktion zum Erstellen eines neuen Verbund Datei Objekts oder [**stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) zum Öffnen einer zuvor erstellten Verbund Datei abgerufen.</span><span class="sxs-lookup"><span data-stu-id="486b0-123">Pointers to the compound file implementation of these interfaces are acquired by calling the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) function to create a new compound file object, or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file.</span></span>

<span data-ttu-id="486b0-124">Eine alternative Methode zum Abrufen eines Zeigers auf die Implementierung dieser Schnittstellen für die Verbund Datei ist das Aufrufen der älteren und eingeschränkteren [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) -oder [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="486b0-124">An alternative method for acquiring a pointer to the compound file implementation of these interfaces is by calling the older and more limited [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) or [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) function.</span></span> <span data-ttu-id="486b0-125">Alle vier Funktionen werden als Implementierungen von Verbund Dateien behandelt.</span><span class="sxs-lookup"><span data-stu-id="486b0-125">All four functions are treated as compound file implementations.</span></span>

<span data-ttu-id="486b0-126">Die Implementierung der Verbund Datei kann so konfiguriert werden, dass Sie 512-oder 4096-Byte-Sektoren verwendet, wie in der [**stgoptions**](/windows/win32/api/coml2api/ns-coml2api-stgoptions) -Struktur definiert.</span><span class="sxs-lookup"><span data-stu-id="486b0-126">The compound file implementation can be configured to use 512 or 4096 byte sectors, as defined in the [**STGOPTIONS**](/windows/win32/api/coml2api/ns-coml2api-stgoptions) structure.</span></span>

<span data-ttu-id="486b0-127">Die Verbund Datei Implementierung von Verbund Dateien unterliegt den folgenden Implementierungs Einschränkungen.</span><span class="sxs-lookup"><span data-stu-id="486b0-127">The compound file implementation of compound files is subject to the following implementation constraints.</span></span>



| <span data-ttu-id="486b0-128">Begrenzung</span><span class="sxs-lookup"><span data-stu-id="486b0-128">Limit</span></span>                                           | <span data-ttu-id="486b0-129">Verbund Datei</span><span class="sxs-lookup"><span data-stu-id="486b0-129">Compound file</span></span>                                                                                                                                                                      |
|-------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="486b0-130">Dateigrößen Limits:</span><span class="sxs-lookup"><span data-stu-id="486b0-130">File size limits:</span></span>                               | <span data-ttu-id="486b0-131">512:2 Gigabyte (GB) 4096: bis zu Dateisystem Limits</span><span class="sxs-lookup"><span data-stu-id="486b0-131">512: 2 gigabytes (GB) 4096: Up to file system limits</span></span><br/>                                                                                                                    |
| <span data-ttu-id="486b0-132">Maximale Heap Größe, die für geöffnete Elemente erforderlich ist:</span><span class="sxs-lookup"><span data-stu-id="486b0-132">Maximum heap size required for open elements:</span></span>   | <span data-ttu-id="486b0-133">512:4 Megabyte (MB) 4096: Grenzwerte für den virtuellen Arbeitsspeicher</span><span class="sxs-lookup"><span data-stu-id="486b0-133">512: 4 megabytes (MB) 4096: Up to virtual memory limits</span></span><br/>                                                                                                                 |
| <span data-ttu-id="486b0-134">Gleichzeitiges root wird geöffnet (öffnet dieselbe Datei):</span><span class="sxs-lookup"><span data-stu-id="486b0-134">Concurrent root opens (opens of the same file):</span></span> | <span data-ttu-id="486b0-135">Wenn "STGM \_ Read" und "STGM \_ Freigabe \_ Deny Write" \_ festgelegt sind, werden die Limits durch die Dateisystem Limits vorgegeben.</span><span class="sxs-lookup"><span data-stu-id="486b0-135">If STGM\_READ and STGM\_SHARE\_DENY\_WRITE are specified, limits are dictated by the file-system limits.</span></span> <span data-ttu-id="486b0-136">Andernfalls gibt es eine Beschränkung von 20 gleichzeitigen Stamm Öffne der gleichen Datei.</span><span class="sxs-lookup"><span data-stu-id="486b0-136">Otherwise, there is a limit of 20 concurrent root opens of the same file.</span></span> |
| <span data-ttu-id="486b0-137">Anzahl von Elementen in einer Datei:</span><span class="sxs-lookup"><span data-stu-id="486b0-137">Number of elements in a file:</span></span>                   | <span data-ttu-id="486b0-138">512: unbegrenzt, aber die Leistung kann beeinträchtigt werden, wenn die Anzahl der Elemente in der Tausender 4096: unbegrenzt liegt.</span><span class="sxs-lookup"><span data-stu-id="486b0-138">512: Unlimited, but performance may degrade if elements number in the thousands 4096: Unlimited</span></span><br/>                                                                         |



 

<span data-ttu-id="486b0-139">Aufgrund der 4-MB-Heap Größenbeschränkung ist die Anzahl offener Elemente im transaktiven Modus in der Regel auf mehrere tausend Elemente beschränkt.</span><span class="sxs-lookup"><span data-stu-id="486b0-139">Due to the 4-MB heap-size limit, the number of open elements in transacted mode is typically limited to several thousand elements.</span></span>

 

