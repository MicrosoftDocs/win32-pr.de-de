---
title: Funktionsweise der asynchronen Bindung und Speicherung
description: Der asynchrone Speicher erweitert die strukturierte com-Speicher Spezifikation, um das Herunterladen von Speicher Objekten bei Netzwerken mit hoher Latenz und langsamen Verbindungen wie dem Internet zu unterstützen.
ms.assetid: 891152c3-5abd-45e4-a7bb-0aac23262b03
keywords:
- Funktionsweise der asynchronen Bindung und Speicherung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 626e8c7a55b667e158de42b3c88a17315b5e41ad
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104390487"
---
# <a name="how-asynchronous-binding-and-storage-work"></a><span data-ttu-id="466a9-104">Funktionsweise der asynchronen Bindung und Speicherung</span><span class="sxs-lookup"><span data-stu-id="466a9-104">How Asynchronous Binding and Storage Work</span></span>

<span data-ttu-id="466a9-105">Der asynchrone Speicher erweitert die strukturierte com-Speicher Spezifikation, um das Herunterladen von Speicher Objekten bei Netzwerken mit hoher Latenz und langsamen Verbindungen wie dem Internet zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="466a9-105">Asynchronous storage enhances the COM structured storage specification to support downloading of storage objects on high-latency, slow-link networks such as the Internet.</span></span> <span data-ttu-id="466a9-106">Der asynchrone Speicher kann zusammen mit asynchronen Monikern verwendet werden, um ein umfassendes asynchrones Bindungsverhalten bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="466a9-106">Asynchronous storage works together with asynchronous monikers to provide complete asynchronous binding behavior.</span></span>

## <a name="document-object-embedded-in-a-web-page"></a><span data-ttu-id="466a9-107">Dokument Objekt, eingebettet in eine Webseite</span><span class="sxs-lookup"><span data-stu-id="466a9-107">Document object embedded in a Web page</span></span>

<span data-ttu-id="466a9-108">Wenn ein Benutzer auf einen Link klickt, der ein Dokument darstellt, das auf einer Webseite eingebettet ist, treten die folgenden Ereignisse auf:</span><span class="sxs-lookup"><span data-stu-id="466a9-108">When a user clicks a link representing a document embedded in a Web page, the following events occur:</span></span>

1.  <span data-ttu-id="466a9-109">Der Browser Ruft die [**mkparser-DisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) -Funktion auf und übergibt die Link-URL.</span><span class="sxs-lookup"><span data-stu-id="466a9-109">The browser calls the [**MkParseDisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) function, passing the link URL.</span></span>
2.  <span data-ttu-id="466a9-110">[**Mkparser-DisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) analysiert die URL, erstellt einen entsprechenden asynchronen Moniker und gibt einen Zeiger auf die [**IMoniker**](/windows/win32/api/objidl/nn-objidl-imoniker) -Schnittstelle des Monikers zurück.</span><span class="sxs-lookup"><span data-stu-id="466a9-110">[**MkParseDisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) parses the URL, creates a corresponding asynchronous moniker, and returns a pointer to the moniker's [**IMoniker**](/windows/win32/api/objidl/nn-objidl-imoniker) interface.</span></span>
3.  <span data-ttu-id="466a9-111">Der Browser ruft [**isasyncmoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775110(v=vs.85)) auf, um zu bestimmen, ob der Moniker asynchron ist, erstellt einen Bindungs Kontext, registriert die [**ibindstatus-Callback**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775060(v=vs.85)) -Schnittstelle beim Bindungs Kontext nur, wenn der Moniker asynchron ist, und ruft [**IMoniker:: bindjeobject**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtoobject)auf und übergibt den Bindungs Kontext.</span><span class="sxs-lookup"><span data-stu-id="466a9-111">The browser calls [**IsAsyncMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775110(v=vs.85)) to determine if the moniker is asynchronous, creates a bind context, registers the [**IBindStatusCallback**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775060(v=vs.85)) interface with the bind context, only if the moniker is asynchronous, and calls [**IMoniker::BindToObject**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtoobject), passing the bind context.</span></span>
4.  <span data-ttu-id="466a9-112">Der Moniker bindet an das-Objekt und fragt ihn nach der [**ipersistmoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)) -Schnittstelle ab, die angibt, ob das Objekt asynchrone Bindungen und Speicher unterstützt.</span><span class="sxs-lookup"><span data-stu-id="466a9-112">The moniker binds to the object and queries it for the [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)) interface, which indicates whether the object supports asynchronous binding and storage.</span></span> <span data-ttu-id="466a9-113">Wenn das Objekt einen Zeiger auf **ipersistmoniker** zurückgibt:</span><span class="sxs-lookup"><span data-stu-id="466a9-113">If the object returns a pointer to **IPersistMoniker**:</span></span>

    1.  <span data-ttu-id="466a9-114">Der URL-Moniker ruft [**ipersistmoniker:: Load**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775044(v=vs.85))auf und übergibt seinen eigenen [**IMoniker**](/windows/win32/api/objidl/nn-objidl-imoniker) -Zeiger an das-Objekt.</span><span class="sxs-lookup"><span data-stu-id="466a9-114">The URL moniker calls [**IPersistMoniker::Load**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775044(v=vs.85)), passing its own [**IMoniker**](/windows/win32/api/objidl/nn-objidl-imoniker) pointer to the object.</span></span>
    2.  <span data-ttu-id="466a9-115">Das-Objekt ändert den Bindungs Kontext, wählt, ob er einen blockierenden oder nicht blockierenden Speicher benötigt, registriert seinen eigenen [**ibindstatus-Rückruf**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775060(v=vs.85)) und ruft [**IMoniker:: bindesstorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage) für den Zeiger auf, der über [**ipersistmoniker:: Load**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775044(v=vs.85))empfangen wurde.</span><span class="sxs-lookup"><span data-stu-id="466a9-115">The object modifies the bind context, chooses whether it wants a blocking or nonblocking storage, registers its own [**IBindStatusCallback**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775060(v=vs.85)) and calls [**IMoniker::BindToStorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage) on the pointer it received through [**IPersistMoniker::Load**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775044(v=vs.85)).</span></span>
    3.  <span data-ttu-id="466a9-116">Der Moniker erstellt einen asynchronen Speicher, behält einen Verweis auf die [**ifilllockbytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) -Schnittstelle des Wrapper Objekts bei, registriert die [**iprogressnotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) -Schnittstelle im Stamm Speicher und ruft [**IPersistStorage:: Load**](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)auf und übergibt dabei den [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Zeiger des asynchronen Speichers.</span><span class="sxs-lookup"><span data-stu-id="466a9-116">The moniker creates an asynchronous storage, keeps a reference to the wrapper object's [**IFillLockBytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) interface, registers the [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) interface on the root storage, and calls [**IPersistStorage::Load**](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load), passing the asynchronous storage's [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) pointer.</span></span> <span data-ttu-id="466a9-117">Beim Eintreffen von Daten (in einem Hintergrund Thread) ruft der Moniker **ifilllockbytes** auf, um die [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) in der temporären Datei auszufüllen.</span><span class="sxs-lookup"><span data-stu-id="466a9-117">As data arrives (on a background thread) the moniker calls **IFillLockBytes** to fill the [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) on the temp file.</span></span>
    4.  <span data-ttu-id="466a9-118">Das-Objekt liest Daten aus dem Speicher und gibt von [**ipersistmoniker:: Load**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775044(v=vs.85)) zurück, wenn ausreichend Daten empfangen wurden, um sich selbst zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="466a9-118">The object reads data from the storage and returns from [**IPersistMoniker::Load**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775044(v=vs.85)) when it has received sufficient data to consider itself initialized.</span></span> <span data-ttu-id="466a9-119">Wenn das Objekt versucht, Daten zu lesen, die noch nicht heruntergeladen wurden, empfängt das Download Programm eine Benachrichtigung über [**iprogressnotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify).</span><span class="sxs-lookup"><span data-stu-id="466a9-119">If the object attempts to read data that has not yet been downloaded, the downloader receives a notification on [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify).</span></span> <span data-ttu-id="466a9-120">Innerhalb der [**iprogressnotify:: OnProgress**](/windows/win32/api/objidl/nf-objidl-iprogressnotify-onprogress) -Methode blockiert der Download Thread entweder in einer modalen Nachrichten Schleife oder bewirkt, dass der asynchrone Speicher "E Pending" zurückgibt \_ , je nachdem, ob das Objekt einen blockierenden oder nicht blockierenden Speicher angefordert hat.</span><span class="sxs-lookup"><span data-stu-id="466a9-120">Inside the [**IProgressNotify::OnProgress**](/windows/win32/api/objidl/nf-objidl-iprogressnotify-onprogress) method, the downloading thread either blocks in a modal message loop, or causes the asynchronous storage to return E\_PENDING, depending on whether the object has requested a blocking or nonblocking storage.</span></span>

5.  <span data-ttu-id="466a9-121">Wenn das Objekt [**ipersistmoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))nicht implementiert, fragt der Moniker [**IPersistStorage**](/windows/win32/api/objidl/nn-objidl-ipersiststorage)ab, was darauf hinweist, dass der persistente Zustand des Objekts in einem Speicher Objekt gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="466a9-121">If the object does not implement [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)), the moniker queries for [**IPersistStorage**](/windows/win32/api/objidl/nn-objidl-ipersiststorage), which indicates that the object's persistent state is stored in a storage object.</span></span> <span data-ttu-id="466a9-122">Wenn das Objekt einen Zeiger auf **IPersistStorage** zurückgibt:</span><span class="sxs-lookup"><span data-stu-id="466a9-122">If the object returns a pointer to **IPersistStorage**:</span></span>

    1.  <span data-ttu-id="466a9-123">Der Moniker ruft [**IMoniker:: BindToStorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage) auf sich selbst, das eine blockierende [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Anforderung anfordert (da das Objekt nicht asynchron unterstützt wird), erstellt einen asynchronen Speicher, behält einen Verweis auf die [**ifilllockbytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) -Schnittstelle des Wrapper Objekts, registriert die [**iprogressnotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) **-Schnitt** Stelle im Stamm Speicher und ruft [**IPersistStorage:**](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)</span><span class="sxs-lookup"><span data-stu-id="466a9-123">The Moniker calls [**IMoniker::BindToStorage**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtostorage) on itself, requesting a blocking [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) (because the object is not asynchronous-aware), creates an asynchronous storage, keeps a reference to the wrapper object's [**IFillLockBytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) interface, registers the [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify) interface on the root storage, and calls [**IPersistStorage::Load**](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load), passing the asynchronous storage's **IStorage** pointer.</span></span> <span data-ttu-id="466a9-124">Beim Eintreffen von Daten (in einem Hintergrund Thread) ruft der Moniker [**ifilllockbytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) auf, um die [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) in der temporären Datei auszufüllen.</span><span class="sxs-lookup"><span data-stu-id="466a9-124">As data arrives (on a background thread) the moniker calls [**IFillLockBytes**](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes) to fill the [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes) on the temporary file.</span></span>
    2.  <span data-ttu-id="466a9-125">Das-Objekt liest Daten aus dem Speicher und gibt von [**IPersistStorage:: Load**](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) zurück, wenn genügend Daten für die Initialisierung gefunden wurden.</span><span class="sxs-lookup"><span data-stu-id="466a9-125">The object reads data from storage and returns from [**IPersistStorage::Load**](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) when it has received sufficient data to consider itself initialized.</span></span> <span data-ttu-id="466a9-126">Wenn das Objekt versucht, Daten zu lesen, die noch nicht heruntergeladen wurden, erhält es eine Benachrichtigung über [**iprogressnotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify).</span><span class="sxs-lookup"><span data-stu-id="466a9-126">If the object attempts to read data that has not yet been downloaded, it receives a notification on [**IProgressNotify**](/windows/win32/api/objidl/nn-objidl-iprogressnotify).</span></span> <span data-ttu-id="466a9-127">Innerhalb der [**iprogressnotify:: OnProgress**](/windows/win32/api/objidl/nf-objidl-iprogressnotify-onprogress) -Methode blockiert der Download Thread immer in einer modalen Nachrichten Schleife.</span><span class="sxs-lookup"><span data-stu-id="466a9-127">Inside the [**IProgressNotify::OnProgress**](/windows/win32/api/objidl/nf-objidl-iprogressnotify-onprogress) method, the downloading thread always blocks in a modal message loop.</span></span>

6.  <span data-ttu-id="466a9-128">Unabhängig davon, ob der Download synchron oder asynchron ist, gibt der Moniker von [**IMoniker:: bindtoken Object**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtoobject)zurück, und der Browser empfängt das initialisierte Objekt, das er angefordert hat.</span><span class="sxs-lookup"><span data-stu-id="466a9-128">Regardless of whether the download is synchronous or asynchronous, the moniker returns from [**IMoniker::BindToObject**](/windows/win32/api/objidl/nf-objidl-imoniker-bindtoobject), and the browser receives the initialized object it requested.</span></span>
7.  <span data-ttu-id="466a9-129">Der Browser fragt [**IOleObject**](/windows/win32/api/oleidl/nn-oleidl-ioleobject) ab und hostet das Objekt als Dokument Objekt.</span><span class="sxs-lookup"><span data-stu-id="466a9-129">The browser queries for [**IOleObject**](/windows/win32/api/oleidl/nn-oleidl-ioleobject) and hosts the object as a Document Object.</span></span> <span data-ttu-id="466a9-130">(An diesem Punkt wird das Objekt möglicherweise nicht vollständig initialisiert, aber genug, um etwas Nützliches anzuzeigen. in diesem Fall wird das Herunterladen im Hintergrund fortgesetzt.)</span><span class="sxs-lookup"><span data-stu-id="466a9-130">(At this point the object may not be initialized completely, but enough to display something useful, in which case downloading continues in the background.)</span></span>

 

 