---
title: Erstellen und Ausführen von "stoclien Sample"
description: Stoclien arbeitet in Zusammenarbeit mit einem copaper-Objekt in einem com-Server zusammen, um eine permanente Speicherung von Zeichnungen in com-Verbund Dateien zu erzielen.
ms.assetid: bf622104-10dd-4649-88f0-e2bfb15289b1
keywords:
- Erstellen und Ausführen von "stoclien Sample"
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f00274293c05e21e660dc8e9448ca95946cab8a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "106342048"
---
# <a name="create-and-run-stoclien-sample"></a><span data-ttu-id="dab34-104">Erstellen und Ausführen von "stoclien Sample"</span><span class="sxs-lookup"><span data-stu-id="dab34-104">Create and Run StoClien Sample</span></span>

<span data-ttu-id="dab34-105">**Stoclien** arbeitet in Zusammenarbeit mit einem copaper-Objekt in einem com-Server zusammen, um eine permanente Speicherung von Zeichnungen in com-Verbund Dateien zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="dab34-105">**StoClien** works in cooperation with a COPaper object in a COM server to achieve persistent storage of drawings in COM compound files.</span></span> <span data-ttu-id="dab34-106">Weitere Informationen zur copaper-Verwendung von Streams in der Verbund Datei, die für copaper von **stoclien** bereitgestellt wird, finden Sie unter [**stoservice**](structured-storage-server-sample--stoserve-.md) Sample and STOSERVE.HTM.</span><span class="sxs-lookup"><span data-stu-id="dab34-106">For more information about COPaper's use of streams in the compound file provided to COPaper by **StoClien**, see [**StoServe**](structured-storage-server-sample--stoserve-.md) sample and STOSERVE.HTM.</span></span> <span data-ttu-id="dab34-107">Die Erstellung des copaper und seine iPaper-Schnittstelle werden ebenfalls im **stoservice** -Beispiel behandelt.</span><span class="sxs-lookup"><span data-stu-id="dab34-107">COPaper's construction and its IPaper interface are also covered in the **StoServe** sample.</span></span>

## <a name="code-tour"></a><span data-ttu-id="dab34-108">Codetour</span><span class="sxs-lookup"><span data-stu-id="dab34-108">Code Tour</span></span>

<span data-ttu-id="dab34-109">Die wichtigsten Themen, die in dieser codetour behandelt werden, sind:</span><span class="sxs-lookup"><span data-stu-id="dab34-109">The major topics covered in this code tour are:</span></span>

-   <span data-ttu-id="dab34-110">Wie **cguipaper** das GUI-Verhalten von **stoclien** Electronic Drawing Paper kapselt</span><span class="sxs-lookup"><span data-stu-id="dab34-110">How **CGuiPaper** encapsulates the GUI behavior of **StoClien**'s electronic drawing paper</span></span>
-   <span data-ttu-id="dab34-111">Erfassen und anzeigen interaktiver Zeichnungs Aktivitäten durch **stoclien**</span><span class="sxs-lookup"><span data-stu-id="dab34-111">How **StoClien** captures and displays interactive drawing activity</span></span>
-   <span data-ttu-id="dab34-112">Verwendung von copaper durch das **cguipaper** -Objekt zum Aufzeichnen von Zeichnungsdaten</span><span class="sxs-lookup"><span data-stu-id="dab34-112">How the **CGuiPaper** object uses COPaper to record drawing data</span></span>
-   <span data-ttu-id="dab34-113">Verwendung einer ipapersink-Verbindung beim Neuzeichnen</span><span class="sxs-lookup"><span data-stu-id="dab34-113">How an IPaperSink connection is used in repainting</span></span>
-   <span data-ttu-id="dab34-114">Verwendung der strukturierten Speicherung in Verbund Dateien durch cpapfile-Methoden zum **Laden** und **Speichern**</span><span class="sxs-lookup"><span data-stu-id="dab34-114">How the CPapFile **Load** and **Save** methods use the structured storage in compound files</span></span>

<span data-ttu-id="dab34-115">Da die **cguiball** -Klasse, die in den Beispielen Freclien und in der-Klasse verwendet wird, das Verhalten eines Sprung-Balls gekapselt hat, verwendet **stoclien** eine **cguipaper** C++-Klasse, um das Daten-und GUI-Verhalten von elektronischen Zeichnungs Papier zu kapseln.</span><span class="sxs-lookup"><span data-stu-id="dab34-115">As the **CGuiBall** class used in the FRECLIEN and CONCLIEN samples encapsulated the behavior of a bouncing ball, **StoClien** uses a **CGuiPaper** C++ class to encapsulate the data and GUI behavior of electronic drawing paper.</span></span>

<span data-ttu-id="dab34-116">In der folgenden Tabelle sind die für das **stoclien** -Beispiel relevanten Dateien aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="dab34-116">The following table lists the files pertinent to the **StoClien** sample.</span></span>



| <span data-ttu-id="dab34-117">Dateien</span><span class="sxs-lookup"><span data-stu-id="dab34-117">Files</span></span>        | <span data-ttu-id="dab34-118">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="dab34-118">Description</span></span>                                                                                                                      |
|--------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="dab34-119">STOCLIEN.TXT</span><span class="sxs-lookup"><span data-stu-id="dab34-119">STOCLIEN.TXT</span></span> | <span data-ttu-id="dab34-120">Kurze Beispiel Beschreibung.</span><span class="sxs-lookup"><span data-stu-id="dab34-120">Short sample description.</span></span>                                                                                                        |
| <span data-ttu-id="dab34-121">Makefile</span><span class="sxs-lookup"><span data-stu-id="dab34-121">MAKEFILE</span></span>     | <span data-ttu-id="dab34-122">Das generische Makefile zum Entwickeln des Code Beispiels.</span><span class="sxs-lookup"><span data-stu-id="dab34-122">The generic makefile for building the code sample.</span></span>                                                                               |
| <span data-ttu-id="dab34-123">Stoclien. Micha</span><span class="sxs-lookup"><span data-stu-id="dab34-123">STOCLIEN.H</span></span>   | <span data-ttu-id="dab34-124">Die Includedatei für die **stoclien** -Anwendung.</span><span class="sxs-lookup"><span data-stu-id="dab34-124">The include file for the **StoClien** application.</span></span> <span data-ttu-id="dab34-125">Enthält Klassen Deklarationen, Funktionsprototypen und Ressourcen Bezeichner.</span><span class="sxs-lookup"><span data-stu-id="dab34-125">Contains class declarations, function prototypes, and resource identifiers.</span></span>   |
| <span data-ttu-id="dab34-126">Stoclien. CPP</span><span class="sxs-lookup"><span data-stu-id="dab34-126">STOCLIEN.CPP</span></span> | <span data-ttu-id="dab34-127">Die Haupt Implementierungs Datei für STOCLIEN.EXE.</span><span class="sxs-lookup"><span data-stu-id="dab34-127">The main implementation file for STOCLIEN.EXE.</span></span> <span data-ttu-id="dab34-128">Hat die Implementierung von winmain und CMainWindow sowie die Haupt Menü Verteilung.</span><span class="sxs-lookup"><span data-stu-id="dab34-128">Has WinMain and CMainWindow implementation, as well as the main menu dispatching.</span></span> |
| <span data-ttu-id="dab34-129">Stoclien. RC</span><span class="sxs-lookup"><span data-stu-id="dab34-129">STOCLIEN.RC</span></span>  | <span data-ttu-id="dab34-130">Die Anwendungs Ressourcen-Definitionsdatei.</span><span class="sxs-lookup"><span data-stu-id="dab34-130">The application resource definition file.</span></span>                                                                                        |
| <span data-ttu-id="dab34-131">Stoclien. ICO</span><span class="sxs-lookup"><span data-stu-id="dab34-131">STOCLIEN.ICO</span></span> | <span data-ttu-id="dab34-132">Die Anwendungssymbol Ressource.</span><span class="sxs-lookup"><span data-stu-id="dab34-132">The application icon resource.</span></span>                                                                                                   |
| <span data-ttu-id="dab34-133">Stoclien. PAP</span><span class="sxs-lookup"><span data-stu-id="dab34-133">STOCLIEN.PAP</span></span> | <span data-ttu-id="dab34-134">Eine standardmäßige Papier Zeichnungs Datei für die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="dab34-134">A default paper drawing file for the application.</span></span>                                                                                |
| <span data-ttu-id="dab34-135">Stift. CUR</span><span class="sxs-lookup"><span data-stu-id="dab34-135">PENCIL.CUR</span></span>   | <span data-ttu-id="dab34-136">Ein Stift Bild für den Client Fenster Cursor.</span><span class="sxs-lookup"><span data-stu-id="dab34-136">A pencil image for the client window cursor.</span></span>                                                                                     |
| <span data-ttu-id="dab34-137">Körper. Micha</span><span class="sxs-lookup"><span data-stu-id="dab34-137">SINK.H</span></span>       | <span data-ttu-id="dab34-138">Die Klassen Deklaration für die copapersink-com-Objektklasse.</span><span class="sxs-lookup"><span data-stu-id="dab34-138">The class declaration for the COPaperSink COM object class.</span></span>                                                                      |
| <span data-ttu-id="dab34-139">Körper. CPP</span><span class="sxs-lookup"><span data-stu-id="dab34-139">SINK.CPP</span></span>     | <span data-ttu-id="dab34-140">Implementierungs Datei für die copapersink-com-Objektklasse.</span><span class="sxs-lookup"><span data-stu-id="dab34-140">Implementation file for the COPaperSink COM object class.</span></span>                                                                        |
| <span data-ttu-id="dab34-141">Papfile. Micha</span><span class="sxs-lookup"><span data-stu-id="dab34-141">PAPFILE.H</span></span>    | <span data-ttu-id="dab34-142">Die Klassen Deklaration für die **cpapfile** C++-Klasse.</span><span class="sxs-lookup"><span data-stu-id="dab34-142">The class declaration for the **CPapFile** C++ class.</span></span>                                                                            |
| <span data-ttu-id="dab34-143">Papfile. CPP</span><span class="sxs-lookup"><span data-stu-id="dab34-143">PAPFILE.CPP</span></span>  | <span data-ttu-id="dab34-144">Implementierungs Datei für die **cpapfile** C++-Klasse.</span><span class="sxs-lookup"><span data-stu-id="dab34-144">Implementation file for the **CPapFile** C++ class.</span></span>                                                                              |
| <span data-ttu-id="dab34-145">Guipaper. Micha</span><span class="sxs-lookup"><span data-stu-id="dab34-145">GUIPAPER.H</span></span>   | <span data-ttu-id="dab34-146">Die Klassen Deklaration für die **cguipaper** C++-Klasse.</span><span class="sxs-lookup"><span data-stu-id="dab34-146">The class declaration for the **CGuiPaper** C++ class.</span></span>                                                                           |
| <span data-ttu-id="dab34-147">Guipaper. CPP</span><span class="sxs-lookup"><span data-stu-id="dab34-147">GUIPAPER.CPP</span></span> | <span data-ttu-id="dab34-148">Implementierungs Datei für die **cguipaper** C++-Klasse.</span><span class="sxs-lookup"><span data-stu-id="dab34-148">Implementation file for the **CGuiPaper** C++ class.</span></span>                                                                             |
| <span data-ttu-id="dab34-149">Stoclien. DSP</span><span class="sxs-lookup"><span data-stu-id="dab34-149">STOCLIEN.DSP</span></span> | <span data-ttu-id="dab34-150">Microsoft Visual Studio Projektdatei.</span><span class="sxs-lookup"><span data-stu-id="dab34-150">Microsoft Visual Studio Project file.</span></span>                                                                                            |



 

## <a name="compound-files"></a><span data-ttu-id="dab34-151">Verbunddateien</span><span class="sxs-lookup"><span data-stu-id="dab34-151">Compound Files</span></span>

<span data-ttu-id="dab34-152">**Stoclien** basiert auf copaper, um Zeichnungsdaten aufzuzeichnen.</span><span class="sxs-lookup"><span data-stu-id="dab34-152">**StoClien** relies on COPaper to record drawing data.</span></span> <span data-ttu-id="dab34-153">Außerdem wird copaper zum Speichern der Daten in einer Verbund Datei unterstützt.</span><span class="sxs-lookup"><span data-stu-id="dab34-153">It also relies on COPaper to store the data in a compound file.</span></span> <span data-ttu-id="dab34-154">Bei einer typischen Arbeitsabteilung zwischen com-Client und Server teilt **stoclien** jedoch einen Teil der Verantwortung für den Dateispeicher.</span><span class="sxs-lookup"><span data-stu-id="dab34-154">However, in a typical division of labor between COM client and server, **StoClien** shares part of the responsibility for file storage.</span></span> <span data-ttu-id="dab34-155">Diese Arbeitsabteilung ist in com-Anwendungen wichtig, bei denen der Client ein Container ist und der Server ein eingebettetes Objekt ist.</span><span class="sxs-lookup"><span data-stu-id="dab34-155">This division of labor is important in COM applications where the client is a container and the server is an embedded object.</span></span> <span data-ttu-id="dab34-156">Bei dieser Anordnung ist der Client dafür verantwortlich, eine strukturierte Speicherdatei zu erstellen oder zu öffnen, während das Server Objekt dafür verantwortlich ist, diesen Speicher für seine eigenen Datenspeicher Zwecke zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="dab34-156">In this arrangement, the client is responsible for creating or opening a structured storage file, while the server object is responsible for using that storage for its own data storage purposes.</span></span> <span data-ttu-id="dab34-157">Dies kann dazu führen, dass das Server Objekt substorages im Speicher erstellt, das ihm zugewiesen ist.</span><span class="sxs-lookup"><span data-stu-id="dab34-157">This may involve the server object creating substorages in the storage that is given to it.</span></span> <span data-ttu-id="dab34-158">Dies umfasst in der Regel das Server Objekt, das Streamobjekte im Speicher erstellt.</span><span class="sxs-lookup"><span data-stu-id="dab34-158">It usually involves the server object creating stream objects in the storage.</span></span> <span data-ttu-id="dab34-159">Die Verwendung von speicherstreams durch copaper wird im **stoclien** -Beispiel ausführlich erläutert.</span><span class="sxs-lookup"><span data-stu-id="dab34-159">COPaper's use of storage streams is detailed in the **StoClien** sample.</span></span>

<span data-ttu-id="dab34-160">Die [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Schnittstelle wird sowohl vom Client als auch vom Server Objekt zum Ausführen von Datei Vorgängen verwendet.</span><span class="sxs-lookup"><span data-stu-id="dab34-160">The [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is used by both client and server object to perform file operations.</span></span> <span data-ttu-id="dab34-161">Die Implementierung der Verbund Dateien der strukturierten Speicherarchitektur wird verwendet.</span><span class="sxs-lookup"><span data-stu-id="dab34-161">The compound files implementation of the Structured Storage architecture is used.</span></span> <span data-ttu-id="dab34-162">Standard Dienstfunktionen werden für Vorgänge in Verbund Dateien verwendet.</span><span class="sxs-lookup"><span data-stu-id="dab34-162">Standard service functions are used for operations on compound files.</span></span> <span data-ttu-id="dab34-163">Beispielsweise erstellt die [**stgkreatedocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) -Funktion anfänglich eine Verbund Datei und gibt einen **IStorage** -Zeiger zurück, der zum Bearbeiten der Datei verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="dab34-163">For example, the [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) function initially creates a compound file and passes back an **IStorage** pointer that can be used to manipulate the file.</span></span> <span data-ttu-id="dab34-164">Diese bestimmte Funktion wird in **stoclien** aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="dab34-164">This particular function is called in **StoClien**.</span></span> <span data-ttu-id="dab34-165">Die von ihr abzurufende **IStorage** -Schnittstelle wird als Parameter an copaper übergeben, um Sie zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="dab34-165">The **IStorage** interface it obtains is passed as a parameter to COPaper for its use.</span></span> <span data-ttu-id="dab34-166">Das copaper-Objekt erstellt oder öffnet keine Verbund Dateien eigenständig: es verwendet die **IStorage** -und [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -Schnittstellen, um in Verbund Dateien zu arbeiten, die ihm übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="dab34-166">The COPaper object does not create or open compound files on its own: It uses the **IStorage** and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces to work in compound files that are given to it.</span></span>

<span data-ttu-id="dab34-167">Diese [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -und [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -Schnittstellen sind nicht in **stoclien** oder **stoservice** implementiert.</span><span class="sxs-lookup"><span data-stu-id="dab34-167">These [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces are not implemented within **StoClien** or **StoServe**.</span></span> <span data-ttu-id="dab34-168">Sie werden innerhalb der com-Bibliotheken implementiert.</span><span class="sxs-lookup"><span data-stu-id="dab34-168">They are implemented within the COM libraries.</span></span> <span data-ttu-id="dab34-169">Wenn ein Zeiger auf eine dieser Schnittstellen abgerufen wird, werden die zugehörigen Methoden im Wesentlichen als eine Gruppe von Diensten für eine Verbund Datei verwendet.</span><span class="sxs-lookup"><span data-stu-id="dab34-169">When a pointer to one of these interfaces is obtained, their methods are essentially used as a set of services to operate on a compound file.</span></span>

 

 




