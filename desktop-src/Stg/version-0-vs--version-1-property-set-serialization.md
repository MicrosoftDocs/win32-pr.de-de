---
title: Eigenschaftensetserialisierung
description: Es gibt zwei Versionen des Eigenschaften Satz-Serialisierungsformats.
ms.assetid: 10544118-5e80-47e2-b75b-c1a43be15b2e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49c635728e169cdddb20437323a49a18496b3459
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104209276"
---
# <a name="property-set-serialization"></a><span data-ttu-id="c936b-103">Eigenschaftensetserialisierung</span><span class="sxs-lookup"><span data-stu-id="c936b-103">Property Set Serialization</span></span>

<span data-ttu-id="c936b-104">Es gibt zwei Versionen des Eigenschaften Satz-Serialisierungsformats.</span><span class="sxs-lookup"><span data-stu-id="c936b-104">There are two versions of the property set serialization format.</span></span> <span data-ttu-id="c936b-105">Die ursprüngliche Spezifikation beschreibt Version 0 des Formats.</span><span class="sxs-lookup"><span data-stu-id="c936b-105">The original specification describes version 0 of the format.</span></span> <span data-ttu-id="c936b-106">Weitere Informationen finden Sie unter [Format Version](format-version.md) .</span><span class="sxs-lookup"><span data-stu-id="c936b-106">See [Format Version](format-version.md) for more information.</span></span> <span data-ttu-id="c936b-107">In Version 1 wird die ursprüngliche Version erweitert.</span><span class="sxs-lookup"><span data-stu-id="c936b-107">Version 1 extends the original version.</span></span> <span data-ttu-id="c936b-108">Alle Eigenschaften Sätze der Version 0 sind als Eigenschaften Sätze der Version 1 gültig.</span><span class="sxs-lookup"><span data-stu-id="c936b-108">All version 0 property sets are valid as version 1 property sets.</span></span> <span data-ttu-id="c936b-109">Das Feld **Format Version** in der Kopfzeile eines serialisierten Eigenschaften Satzes gibt die Version an.</span><span class="sxs-lookup"><span data-stu-id="c936b-109">The **Format Version** field in the header of a serialized property set indicates the version.</span></span>

<span data-ttu-id="c936b-110">In den folgenden Elementen werden die Unterschiede zwischen den Eigenschaften Satz-Serialisierungsformaten der Versionen 0 und Version 1 identifiziert.</span><span class="sxs-lookup"><span data-stu-id="c936b-110">The following items identify the differences between version 0 and version 1 property set serialization formats.</span></span>

-   <span data-ttu-id="c936b-111">Unterstützung für neue **VarType** -Werte.</span><span class="sxs-lookup"><span data-stu-id="c936b-111">Support for new **VARTYPE** values.</span></span> <span data-ttu-id="c936b-112">Weitere Informationen zu **VarType** -Werten und deren Verwendung finden Sie im Thema [IDispatch-Datentypen und-Strukturen]( /previous-versions/ms221600(v=vs.100)) und die [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="c936b-112">For more information about **VARTYPE** values and how to use them, see the topic [IDispatch Data Types and Structures]( /previous-versions/ms221600(v=vs.100)) and the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

    <span data-ttu-id="c936b-113">Die folgenden **VarType** -Werte werden in den Eigenschaften Sätzen der Version 0 nicht unterstützt, werden jedoch in Version 1 unterstützt:</span><span class="sxs-lookup"><span data-stu-id="c936b-113">The following **VARTYPE** values are not supported in version 0 property sets, but are supported in version 1:</span></span>

    <span data-ttu-id="c936b-114">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="c936b-114">VT\_I1</span></span>

    <span data-ttu-id="c936b-115">VT \_ Vector \| VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="c936b-115">VT\_VECTOR \| VT\_I1</span></span>

    <span data-ttu-id="c936b-116">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="c936b-116">VT\_INT</span></span>

    <span data-ttu-id="c936b-117">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="c936b-117">VT\_UINT</span></span>

    <span data-ttu-id="c936b-118">VT ( \_ dezimal)</span><span class="sxs-lookup"><span data-stu-id="c936b-118">VT\_DECIMAL</span></span>

    <span data-ttu-id="c936b-119">Außerdem können SAFEARRAYs in einem Eigenschaften Satz serialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="c936b-119">Additionally, SafeArrays can be serialized in a property set.</span></span> <span data-ttu-id="c936b-120">Das vorhanden sein eines SAFEARRAY wird durch das VT- \_ Array Bit in Kombination mit einem **or** -Vorgang und den Array Elementen im **VT** -Member der [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) -Struktur angegeben.</span><span class="sxs-lookup"><span data-stu-id="c936b-120">The presence of a SafeArray is indicated by the VT\_ARRAY bit combined, using an **OR** operation, with the array elements in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span> <span data-ttu-id="c936b-121">Ein SafeArray von 4-Byte-Ganzzahlen mit Vorzeichen weist z. b. den Typ "VT \_ array \| VT I4" auf \_ .</span><span class="sxs-lookup"><span data-stu-id="c936b-121">For example, a SafeArray of 4-byte signed integers has a type of VT\_ARRAY \| VT\_I4.</span></span>

    <span data-ttu-id="c936b-122">Die folgenden Elementtypen sind für ein SAFEARRAY in einem serialisierten Eigenschaften Satz gültig:</span><span class="sxs-lookup"><span data-stu-id="c936b-122">The following element types are valid for a SafeArray in a serialized property set:</span></span>



|             |          |             |           |
|-------------|----------|-------------|-----------|
| <span data-ttu-id="c936b-123">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="c936b-123">VT\_I1</span></span>      | <span data-ttu-id="c936b-124">VT \_ UI1</span><span class="sxs-lookup"><span data-stu-id="c936b-124">VT\_UI1</span></span>  | <span data-ttu-id="c936b-125">VT \_ I2</span><span class="sxs-lookup"><span data-stu-id="c936b-125">VT\_I2</span></span>      | <span data-ttu-id="c936b-126">VT \_ UI2</span><span class="sxs-lookup"><span data-stu-id="c936b-126">VT\_UI2</span></span>   |
| <span data-ttu-id="c936b-127">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="c936b-127">VT\_I4</span></span>      | <span data-ttu-id="c936b-128">VT \_ UI4</span><span class="sxs-lookup"><span data-stu-id="c936b-128">VT\_UI4</span></span>  | <span data-ttu-id="c936b-129">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="c936b-129">VT\_INT</span></span>     | <span data-ttu-id="c936b-130">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="c936b-130">VT\_UINT</span></span>  |
| <span data-ttu-id="c936b-131">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="c936b-131">VT\_R4</span></span>      | <span data-ttu-id="c936b-132">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="c936b-132">VT\_R8</span></span>   | <span data-ttu-id="c936b-133">VT- \_ CY</span><span class="sxs-lookup"><span data-stu-id="c936b-133">VT\_CY</span></span>      | <span data-ttu-id="c936b-134">VT- \_ Datum</span><span class="sxs-lookup"><span data-stu-id="c936b-134">VT\_DATE</span></span>  |
| <span data-ttu-id="c936b-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="c936b-135">VT\_BSTR</span></span>    | <span data-ttu-id="c936b-136">VT \_ bool</span><span class="sxs-lookup"><span data-stu-id="c936b-136">VT\_BOOL</span></span> | <span data-ttu-id="c936b-137">VT ( \_ dezimal)</span><span class="sxs-lookup"><span data-stu-id="c936b-137">VT\_DECIMAL</span></span> | <span data-ttu-id="c936b-138">VT- \_ Fehler</span><span class="sxs-lookup"><span data-stu-id="c936b-138">VT\_ERROR</span></span> |
| <span data-ttu-id="c936b-139">VT- \_ Variante</span><span class="sxs-lookup"><span data-stu-id="c936b-139">VT\_VARIANT</span></span> |          |             |           |



 

<span data-ttu-id="c936b-140">Wenn der \_ Datentyp VT Variant angegeben ist, weist dies darauf hin, dass das SAFEARRAY selbst [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) -Strukturen enthält.</span><span class="sxs-lookup"><span data-stu-id="c936b-140">When the VT\_VARIANT data type is specified, it indicates that the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="c936b-141">Die Typen für diese Elemente müssen aus der vorangehenden Liste bestehen, mit dem Unterschied, dass Sie keine geschposteten VT-Typen enthalten können \_ .</span><span class="sxs-lookup"><span data-stu-id="c936b-141">The types for these elements must be from the preceding list, except they cannot contain nested VT\_VARIANT types.</span></span>

<span data-ttu-id="c936b-142">Beachten Sie, dass Implementierungen von [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) in der Lage sein müssen, ordnungsgemäß wiederherzustellen, indem ein Fehler zurückgegeben wird, wenn ein neuer Typ gefunden wird. beispielsweise varenumerationstypen.</span><span class="sxs-lookup"><span data-stu-id="c936b-142">Note that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) must be able to recover gracefully by returning an error when a new type is encountered; for example, VARENUM types.</span></span>

-   <span data-ttu-id="c936b-143">Die Groß-/Kleinschreibung beachten</span><span class="sxs-lookup"><span data-stu-id="c936b-143">Case sensitive property names.</span></span> <span data-ttu-id="c936b-144">Eigenschaftsnamen, z. b. die in der [**IPropertyStorage:: schreitepropertynames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) -Methode angegebenen, unterliegen in den Eigenschaften Sätzen der Version 0 nicht zwischen Groß-und Kleinschreibung.</span><span class="sxs-lookup"><span data-stu-id="c936b-144">Property names, for example those specified in the [**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) method, are not case sensitive in version 0 property sets.</span></span> <span data-ttu-id="c936b-145">In Eigenschaften Sätzen der Version 1 kann für Eigenschaftsnamen die Groß-/Kleinschreibung beachtet werden, abhängig vom Wert der neuen Behavior-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="c936b-145">In version 1 property sets, property names can be case-sensitive depending on the value of the new Behavior property.</span></span>

    <span data-ttu-id="c936b-146">Die Behavior-Eigenschaft ist die eigen [schafts-ID 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) mit dem Typ VT \_ UI4.</span><span class="sxs-lookup"><span data-stu-id="c936b-146">The Behavior property is [Property ID 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) with a type of VT\_UI4.</span></span> <span data-ttu-id="c936b-147">Wenn das niedrigste Bit dieses Werts festgelegt ist, wird bei den Eigenschaften Satz Namen die Groß-/Kleinschreibung beachtet.</span><span class="sxs-lookup"><span data-stu-id="c936b-147">If the lowest bit of this value is set, the property set names are case sensitive.</span></span> <span data-ttu-id="c936b-148">Legen Sie das Flag propsetflag \_ für die Groß-/Kleinschreibung \_ im *grfFlags* -Parameter der [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) -Methode fest, um einen Eigenschaften Satz mit Berücksichtigung von Groß-/Kleinschreibung</span><span class="sxs-lookup"><span data-stu-id="c936b-148">Set the PROPSETFLAG\_CASE\_SENSITIVE flag in the *grfFlags* parameter of the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method to specify a case-sensitive property set.</span></span>

-   <span data-ttu-id="c936b-149">Lange Eigenschaftsnamen.</span><span class="sxs-lookup"><span data-stu-id="c936b-149">Long property names.</span></span> <span data-ttu-id="c936b-150">Eigenschaftsnamen für Eigenschaften Sätze der Version 0 müssen kleiner oder gleich 256 Zeichen (einschließlich des Zeichen folgen Abschluss Zeichens) für Eigenschaften Sätze in der Unicode-Codepage sein.</span><span class="sxs-lookup"><span data-stu-id="c936b-150">Property names for version 0 property sets must be less than or equal to 256 characters, including the string terminator, for property sets in the Unicode code page.</span></span> <span data-ttu-id="c936b-151">Wenn Sie sich nicht auf der Unicode-Codepage befinden, müssen Sie weniger als 256 Bytes aufweisen.</span><span class="sxs-lookup"><span data-stu-id="c936b-151">If not in the Unicode code page, they must be less than 256 bytes.</span></span> <span data-ttu-id="c936b-152">Die Eigenschaften Sätze der Version 1 können auf der anderen Seite Eigenschaftsnamen mit unbegrenzter Länge aufweisen, obwohl Sie weiterhin durch die Gesamtgröße des Eigenschaften Satzes von 256 Kilobyte (KB) beschränkt sind.</span><span class="sxs-lookup"><span data-stu-id="c936b-152">Version 1 property sets, on the other hand, can have property names of unlimited length, although they are still limited by the overall property set size limit of 256 kilobytes (KB).</span></span>

<span data-ttu-id="c936b-153">Es wird empfohlen, dass Implementierungen von [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) standardmäßig Standardeigenschaften Sätze von Version 0 erstellen und verwalten.</span><span class="sxs-lookup"><span data-stu-id="c936b-153">It is recommended that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) create and maintain version 0 property sets by default.</span></span> <span data-ttu-id="c936b-154">Wenn ein Aufrufer anschließend eine bestimmte Funktion für das Format Version 1 anfordert, sollte die Version des Eigenschaften Satzes nur dann aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="c936b-154">If a caller subsequently requests a feature specific to the version 1 format, only then should the version of the property set be updated.</span></span> <span data-ttu-id="c936b-155">Wenn z. b. eine Eigenschaft vom Typ "VT \_ Array" geschrieben wird oder wenn ein Name für eine lange Eigenschaft geschrieben wird, sollte die Implementierung das Eigenschaften Satz Format auf Version 1 aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="c936b-155">For example, if a property of type VT\_ARRAY is written or if a long property name is written, then the implementation should update the property set format to version 1.</span></span> <span data-ttu-id="c936b-156">Eine Ausnahme von dieser Richtlinie tritt auf, wenn der Wert "propsetflag \_ Case \_ sensitive Enumeration" im [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)-Befehl angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="c936b-156">One exception to this guideline occurs if the PROPSETFLAG\_CASE\_SENSITIVE enumeration value is specified in the call to [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="c936b-157">In diesem Fall muss der Eigenschaften Satz als Eigenschaften Satz der Version 1 erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="c936b-157">In this case, the property set must be created as a version 1 property set.</span></span>

 

 