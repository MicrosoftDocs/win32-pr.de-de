---
title: Unterschiede zwischen eigenständigen Implementierungen und Implementierungen von Verbund Dateien
description: Die eigenständige Implementierung der Eigenschaften Satz Schnittstellen und die Implementierung der Verbund Datei unterscheiden sich in gewisser Weise.
ms.assetid: 650d4759-a58a-47a4-922d-5757e356cf56
keywords:
- IPropertyStorage-Klasse "STG", Implementierungen
- "\"IPropertyStorage\", \"unctd STG\", Implementierungen, Unterschiede"
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 988f8a9cfdaca0a131bedf98cd8ff10ae8b89525
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "103855947"
---
# <a name="differences-between-stand-alone-and-compound-file-implementations"></a><span data-ttu-id="56c14-105">Unterschiede zwischen eigenständigen Implementierungen und Implementierungen von Verbund Dateien</span><span class="sxs-lookup"><span data-stu-id="56c14-105">Differences between Stand-alone and Compound File Implementations</span></span>

<span data-ttu-id="56c14-106">Die eigenständige Implementierung der Eigenschaften Satz Schnittstellen und die Implementierung der Verbund Datei unterscheiden sich in gewisser Weise.</span><span class="sxs-lookup"><span data-stu-id="56c14-106">The stand-alone implementation of the property set interfaces and the compound file implementation differ in some ways.</span></span> <span data-ttu-id="56c14-107">In der Implementierung der Verbund Datei von Stream, Speicher, Eigenschaften Satz Speicher und Eigenschaften Speicher Objekten werden die verschiedenen Schnittstellen untereinander koordiniert, da Sie eine gemeinsame Implementierung gemeinsam verwenden.</span><span class="sxs-lookup"><span data-stu-id="56c14-107">In the compound-file implementation of stream, storage, property set storage, and property storage objects, the various interfaces coordinate with each another because they share a common implementation.</span></span> <span data-ttu-id="56c14-108">In der eigenständigen Implementierung sind die Schnittstellen Implementierungen unterschiedlich.</span><span class="sxs-lookup"><span data-stu-id="56c14-108">In the stand-alone implementation, the interface implementations are distinct.</span></span>

<span data-ttu-id="56c14-109">Folglich behandelt die Implementierung von Verbund Dateien Parallelitäts Probleme und synchronisiert das Eigenschaften Satz Objekt mit dem Speicher-oder Streamobjekt.</span><span class="sxs-lookup"><span data-stu-id="56c14-109">As a result, the compound-file implementation handles concurrency issues and synchronizes the property set object with the storage or stream object.</span></span> <span data-ttu-id="56c14-110">Bei der eigenständigen Implementierung ist der Client für die Behandlung von Parallelitäts-und Synchronisierungs Problemen zwischen dem Speicher-oder Streamobjekt und dem Eigenschaften Satz verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="56c14-110">With the stand-alone implementation, the client is responsible for handling concurrency and synchronization issues between the storage or stream object and the property set.</span></span> <span data-ttu-id="56c14-111">Ein Client kann diese Anforderungen erfüllen, indem er zwei einfache Regeln folgt.</span><span class="sxs-lookup"><span data-stu-id="56c14-111">A client can meet these requirements by following two simple rules.</span></span> <span data-ttu-id="56c14-112">Manipulieren Sie zunächst nie einen Eigenschaften Satz mithilfe der zugehörigen Datenstrom-oder Speicher Schnittstellen, während ein Eigenschafts Speicher Objekt geöffnet ist.</span><span class="sxs-lookup"><span data-stu-id="56c14-112">First, never manipulate a property set using its stream or storage interfaces while a property storage object is open on it.</span></span> <span data-ttu-id="56c14-113">Rufen Sie dann immer **Commit** für ein Eigenschaften Speicher Objekt auf, bevor Sie **CopyTo**-, **muveelementto**-oder **Commit** für ein Vorgänger Speicher Objekt aufrufen.</span><span class="sxs-lookup"><span data-stu-id="56c14-113">Second, always call **Commit** on a property storage object before calling **CopyTo**, **MoveElementTo**, or **Commit** on an ancestor storage object.</span></span> <span data-ttu-id="56c14-114">Insbesondere die folgenden Elemente erfordern eine Client Aufmerksamkeit:</span><span class="sxs-lookup"><span data-stu-id="56c14-114">Specifically, the following items require client attention:</span></span>

-   <span data-ttu-id="56c14-115">In der Implementierung der Verbund Datei bietet ein einzelner Mechanismus Parallelitäts Schutz für das Speicher Objekt und die zugehörigen Eigenschaften Satz Objekte.</span><span class="sxs-lookup"><span data-stu-id="56c14-115">In the compound-file implementation, a single mechanism provides concurrency protection for the storage object and its associated property set objects.</span></span> <span data-ttu-id="56c14-116">In der eigenständigen Implementierung ist die Implementierung des Speicher Objekts jedoch von der Implementierung der-Eigenschaften Menge getrennt, und jede stellt eigene Parallelitäts Mechanismen bereit.</span><span class="sxs-lookup"><span data-stu-id="56c14-116">However, in the stand-alone implementation, the storage object implementation is separate from the property set implementation and each provides its own concurrency mechanisms.</span></span> <span data-ttu-id="56c14-117">Daher ist der Client in der eigenständigen Implementierung für die Aufrechterhaltung des Parallelitäts Schutzes zwischen den beiden Implementierungen durch einen Mechanismus des gegenseitigen Ausschlusses verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="56c14-117">Thus, in the stand-alone implementation, the client is responsible for maintaining concurrency protection between the two implementations through a mechanism of mutual exclusion.</span></span>
-   <span data-ttu-id="56c14-118">In der Implementierung der Verbund Datei werden Änderungen an Eigenschafts Sätzen in einem Eigenschafts Satz Cache gepuffert.</span><span class="sxs-lookup"><span data-stu-id="56c14-118">In the compound file implementation, changes to property sets are buffered in a property-set cache.</span></span> <span data-ttu-id="56c14-119">Wenn dann die [**IStorage:: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) -Methode für das Speicher Objekt aufgerufen wird, leert die Implementierung der Verbund Dateien automatisch die Eigenschaften Satzänderungen aus dem Eigenschaften Satz Puffer, bevor ein Commit für das Speicher Objekt ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="56c14-119">Then, when the [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) method is called on the storage object, the compound files implementation automatically flushes the property-set changes from the property-set buffer before the storage object is committed.</span></span> <span data-ttu-id="56c14-120">Folglich werden die Eigenschaften Satzänderungen als Teil der Transaktion, für die ein Commit ausgeführt wird, sichtbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="56c14-120">Thus, the property-set changes are made visible as part of the transaction being committed.</span></span>

    <span data-ttu-id="56c14-121">In der eigenständigen Implementierung muss der Client den Eigenschafts Satz Puffer explizit leeren, indem er [**IPropertyStorage:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) anruft, bevor die [**IStorage:: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) -Methode für den Speicher aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="56c14-121">In the stand-alone implementation, the client must explicitly flush the property-set buffer by calling [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) before calling the [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) method on the storage.</span></span> <span data-ttu-id="56c14-122">Alternativ kann der Client den neuen propsetflag- \_ Wert in der eigenständigen Implementierung verwenden, um direkt in den Eigenschaften Satz zu schreiben, anstatt Änderungen am internen Puffer des Eigenschaften Satzes zwischenzuspeichern.</span><span class="sxs-lookup"><span data-stu-id="56c14-122">Alternatively, the client can use the new PROPSETFLAG\_UNBUFFERED value in the stand-alone implementation to write directly to the property set instead of caching changes to the property set's internal buffer.</span></span> <span data-ttu-id="56c14-123">Wenn propsetflag \_ nicht gepuffert wird, werden die Zuständigkeiten des Clients automatisch erfüllt.</span><span class="sxs-lookup"><span data-stu-id="56c14-123">If PROPSETFLAG\_UNBUFFERED is used, the client's responsibilities are automatically met.</span></span> <span data-ttu-id="56c14-124">Der nicht gepufferte Wert propsetflag wird von der Implementierung der Verbund Datei nicht unterstützt \_ .</span><span class="sxs-lookup"><span data-stu-id="56c14-124">The compound file implementation does not support the PROPSETFLAG\_UNBUFFERED value.</span></span> <span data-ttu-id="56c14-125">Weitere Informationen finden Sie unter [**propsetflag-Konstanten**](propsetflag-constants.md).</span><span class="sxs-lookup"><span data-stu-id="56c14-125">For more information, see [**PROPSETFLAG Constants**](propsetflag-constants.md).</span></span>

-   <span data-ttu-id="56c14-126">Wie bei transaktiven Storages aktualisiert die Implementierung der Verbund Datei den Eigenschaften Satz, indem er den internen Puffer leert, bevor er einen [**IStorage:: CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto) -oder [**IStorage:: muveelementto**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto)-Befehl aufruft.</span><span class="sxs-lookup"><span data-stu-id="56c14-126">As with transacted storages, the compound file implementation updates the property set by flushing its internal buffer before executing a call to [**IStorage::CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto) or [**IStorage::MoveElementTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto).</span></span> <span data-ttu-id="56c14-127">Folglich werden Änderungen am Eigenschaften Satz im kopierten oder verschostellten Speicher Element widergespiegelt.</span><span class="sxs-lookup"><span data-stu-id="56c14-127">Thus, changes to the property set are reflected in the copied or moved storage element.</span></span>

    <span data-ttu-id="56c14-128">In der eigenständigen Implementierung muss der-Client den Eigenschafts Satz Puffer explizit leeren, indem er [**IPropertyStorage:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) vor dem Aufrufen von [**IStorage:: CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto) oder [**IStorage::-Element to**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto)aufruft.</span><span class="sxs-lookup"><span data-stu-id="56c14-128">In the stand-alone implementation, the client must explicitly flush the property set buffer by calling [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) before calling [**IStorage::CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto) or [**IStorage::MoveElementTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto).</span></span> <span data-ttu-id="56c14-129">Alternativ kann der Client den \_ nicht gepufferten Wert New propsetflag verwenden, um direkt in den Eigenschaften Satz zu schreiben, anstatt Änderungen am Eigenschaften Satz Puffer zwischenzuspeichern.</span><span class="sxs-lookup"><span data-stu-id="56c14-129">Alternatively, the client can use the new PROPSETFLAG\_UNBUFFERED value to write directly to the property set instead of caching changes to the property set buffer.</span></span> <span data-ttu-id="56c14-130">Weitere Informationen finden Sie unter [**propsetflag-Konstanten**](propsetflag-constants.md).</span><span class="sxs-lookup"><span data-stu-id="56c14-130">For more information, see [**PROPSETFLAG Constants**](propsetflag-constants.md).</span></span>

 

 




