---
title: Überlegungen zur Eigenschaften Speicherung
description: IPropertyStorage-Lesegeräte Lesevorgänge wie viele der im rgpspec-Array angegebenen Eigenschaften, wie Sie im Eigenschaften Satz enthalten sind.
ms.assetid: 7540966f-a3b2-46c9-9e04-b15133a517eb
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2aad6aabf8b22a7c01f91a090136e6cc8156c791
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "106339887"
---
# <a name="property-storage-considerations"></a><span data-ttu-id="059e8-103">Überlegungen zur Eigenschaften Speicherung</span><span class="sxs-lookup"><span data-stu-id="059e8-103">Property Storage Considerations</span></span>

<span data-ttu-id="059e8-104">[**IPropertyStorage:: Read Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) liest, wie viele der im *rgpspec* -Array angegebenen Eigenschaften wie im Eigenschaften Satz enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="059e8-104">[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) reads as many of the properties specified in the *rgpspec* array as are found in the property set.</span></span> <span data-ttu-id="059e8-105">Solange eine der angeforderten Eigenschaften gelesen wird, ist eine Anforderung zum Abrufen einer Eigenschaft, die nicht vorhanden ist, kein Fehler.</span><span class="sxs-lookup"><span data-stu-id="059e8-105">As long as any of the properties requested is read, a request to retrieve a property that does not exist is not an error.</span></span> <span data-ttu-id="059e8-106">Stattdessen muss dies dazu führen, \_ dass für diese Eigenschaft bei Rückgabe "VT Empty" in das *rgvar* -Array geschrieben wird \[ \] .</span><span class="sxs-lookup"><span data-stu-id="059e8-106">Instead, this must cause VT\_EMPTY to be written for that property to the *rgvar*\[\] array on return.</span></span> <span data-ttu-id="059e8-107">Wenn keine der angeforderten Eigenschaften vorhanden ist, sollte die Methode "S false" zurückgeben \_ und \_ in jeder [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant)"VT Empty" festlegen.</span><span class="sxs-lookup"><span data-stu-id="059e8-107">When none of the requested properties exist, the method should return S\_FALSE, and set VT\_EMPTY in each [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span></span> <span data-ttu-id="059e8-108">Wenn ein anderer Fehler zurückgegeben wird, werden keine Eigenschaftswerte abgerufen, und der Aufrufer muss sich nicht darum kümmern, Sie freizugeben.</span><span class="sxs-lookup"><span data-stu-id="059e8-108">If any other error is returned, no property values are retrieved, and the caller need not worry about releasing them.</span></span>

<span data-ttu-id="059e8-109">Der *rgpspec* -Parameter ist ein Array von [**PROPSPEC**](/windows/win32/api/propidlbase/ns-propidlbase-propspec) -Strukturen, die für jede Eigenschaft entweder ihren Eigenschafts Bezeichner oder, wenn eine zugewiesen ist, einen Zeichen folgen Bezeichner angeben.</span><span class="sxs-lookup"><span data-stu-id="059e8-109">The *rgpspec* parameter is an array of [**PROPSPEC**](/windows/win32/api/propidlbase/ns-propidlbase-propspec) structures, which specify for each property either its property identifier or, if one is assigned, a string identifier.</span></span> <span data-ttu-id="059e8-110">Sie können eine Zeichenfolge einem Eigenschaften Bezeichner zuordnen, indem Sie [**IPropertyStorage:: Beschreib tepropertynames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="059e8-110">You can map a string to a property identifier by calling [**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames).</span></span> <span data-ttu-id="059e8-111">Die Verwendung von Eigenschafts bezeichgern ist jedoch wahrscheinlich wesentlich effizienter als die Verwendung von Zeichen folgen.</span><span class="sxs-lookup"><span data-stu-id="059e8-111">The use of property identifiers is, however, likely to be significantly more efficient than the use of strings.</span></span>

<span data-ttu-id="059e8-112">Eigenschaften, die durch den Zeichen folgen Namen (prspec \_ LPWSTR) angefordert werden, werden für Eigenschafts Bezeichner (IDs), wie Sie im aktuellen Eigenschaften Satz angegeben sind (und entsprechend dem aktuellen System Gebiets Schema), als nicht sensibel zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="059e8-112">Properties that are requested by string name (PRSPEC\_LPWSTR) are mapped case-insensitively to property identifiers (IDs) as they are specified in the current property set (and according to the current system locale).</span></span>

<span data-ttu-id="059e8-113">Wenn der Eigenschaftentyp VT \_ LPSTR ist und die Eigenschaft aus einem ANSI-Eigenschaften Satz gelesen wird, d. h. die Codepage für den Eigenschaften Satz wird auf einen anderen Wert als Unicode festgelegt, verwendet der Wert der Eigenschaft dieselbe Codepage wie der Eigenschaften Satz.</span><span class="sxs-lookup"><span data-stu-id="059e8-113">When the property type is VT\_LPSTR and the property is read from an ANSI property set, that is, the code page for the property set is set to something other than Unicode, the value of the property uses the same code page as the property set.</span></span> <span data-ttu-id="059e8-114">Wenn eine VT \_ LPSTR-Eigenschaft aus einem Unicode-Eigenschaften Satz gelesen wird, verwendet der Wert der-Eigenschaft die aktuelle Standard-ANSI-Codepage des Systems, d. h. die Codepage, die von der **GetACP-** Funktion zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="059e8-114">When a VT\_LPSTR property is read from a Unicode property set, the value of the property uses the system's current default ANSI code page, that is, the code page returned from the **GetACP** function.</span></span>

<span data-ttu-id="059e8-115">Eine [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant), mit Ausnahme derer, die Zeiger auf Streams und Storages sind, wird als einfaches **PROPVARIANT** bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="059e8-115">A [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant), except for those that are pointers to streams and storages, is called a simple **PROPVARIANT**.</span></span> <span data-ttu-id="059e8-116">Diese einfachen **PROPVARIANT**-e empfangen Daten nach Wert, sodass ein Aufruf von [**IPropertyStorage:: infomultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) eine Kopie der Daten bereitstellt, die der Aufrufer dann besitzt.</span><span class="sxs-lookup"><span data-stu-id="059e8-116">These simple **PROPVARIANT** s receive data by value, so a call to [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) supplies a copy of the data that the caller then owns.</span></span> <span data-ttu-id="059e8-117">Um diese Eigenschaften zu erstellen oder zu aktualisieren, rufen Sie [**IPropertyStorage:: Write-Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)auf.</span><span class="sxs-lookup"><span data-stu-id="059e8-117">To create or update these properties, call [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span></span>

<span data-ttu-id="059e8-118">Im Gegensatz dazu sind die Variant-Typen VT \_ -Stream, VT \_ -Stream \_ -Objekt, VT \_ -Speicher und VT \_ \_ -gespeicherte Objekte nicht einfache Eigenschaften, denn anstelle eines Werts wird von der Methode ein Zeiger auf die festgestellte Schnittstelle abgerufen, von der die Daten dann gelesen werden können.</span><span class="sxs-lookup"><span data-stu-id="059e8-118">In contrast, the variant types VT\_STREAM, VT\_STREAMED\_OBJECT, VT\_STORAGE, and VT\_STORED\_OBJECT are non-simple properties, because rather than supplying a value, the method retrieves a pointer to the indicated interface, from which the data can then be read.</span></span> <span data-ttu-id="059e8-119">Diese Typen ermöglichen es, große Mengen von Informationen über eine einzelne Eigenschaft zu speichern.</span><span class="sxs-lookup"><span data-stu-id="059e8-119">These types permit the storage of large amounts of information through a single property.</span></span> <span data-ttu-id="059e8-120">Es gibt mehrere Probleme, die bei der Verwendung nicht einfacher Eigenschaften auftreten können.</span><span class="sxs-lookup"><span data-stu-id="059e8-120">There are several issues that arise in using nonsimple properties.</span></span>

<span data-ttu-id="059e8-121">Um diese Eigenschaften zu erstellen, wie für die anderen Eigenschaften, rufen Sie [**IPropertyStorage:: Write-Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)auf.</span><span class="sxs-lookup"><span data-stu-id="059e8-121">To create these properties, as for the other properties, call [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span></span> <span data-ttu-id="059e8-122">Anstatt dieselbe Methode zum Aktualisieren aufzurufen, ist es effizienter, zuerst [**IPropertyStorage:: Read Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) aufzurufen, um den Schnittstellen Zeiger auf den Stream oder Speicher zu erhalten, und dann Daten mithilfe der [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -oder [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Methoden zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="059e8-122">Rather than calling the same method to update, however, it is more efficient to first call [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) to get the interface pointer to the stream or storage, then write data using the [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) or [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) methods.</span></span> <span data-ttu-id="059e8-123">Ein Stream oder Speicher, der über eine Eigenschaft geöffnet wird, wird immer im direkten Modus geöffnet, sodass keine zusätzliche Ebene der untergeordneten Transaktion eingeführt wird.</span><span class="sxs-lookup"><span data-stu-id="059e8-123">A stream or storage opened through a property is always opened in direct mode, so an additional level of nested transaction is not introduced.</span></span> <span data-ttu-id="059e8-124">Es kann jedoch sein, dass nach wie vor eine Transaktion für die Eigenschaft als Ganzes festgelegt wird, je nachdem, wie Sie mithilfe von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)geöffnet oder erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="059e8-124">There may, however, still be a transaction on the property set as a whole, depending on how it was opened or created through [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage).</span></span> <span data-ttu-id="059e8-125">Außerdem werden die Tags für den Zugriffs-und Freigabemodus, die beim Öffnen oder Erstellen des Eigenschaften Satzes angegeben werden, an Eigenschaften basierte Streams oder Storages weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="059e8-125">Further, the access and share mode tags specified when the property set is opened or created, are passed to property-based streams or storages.</span></span>

<span data-ttu-id="059e8-126">Die Lebensdauer von Eigenschaften basierten Datenstrom-oder Speicher Zeigern, obwohl theoretisch unabhängig von ihren zugeordneten [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) -und [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Zeigern tatsächlich von Ihnen abhängig ist.</span><span class="sxs-lookup"><span data-stu-id="059e8-126">The lifetimes of property-based stream or storage pointers, although theoretically independent of their associated [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) pointers, in fact, effectively depend on them.</span></span> <span data-ttu-id="059e8-127">Die Daten, die durch den Stream oder Speicher sichtbar sind, beziehen sich auf die Transaktion im Eigenschaften Speicher Objekt, aus dem Sie abgerufen wird, ebenso wie bei einem Speicher Objekt (unterstützender [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage)) mit enthaltenen Datenstrom-und Speicher untergeordneten Objekten.</span><span class="sxs-lookup"><span data-stu-id="059e8-127">The data visible through the stream or storage is related to the transaction on the property storage object from which it is retrieved, just as for a storage object (supporting [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage)) with contained stream and storage sub-objects.</span></span> <span data-ttu-id="059e8-128">Wenn die Transaktion für das übergeordnete Objekt abgebrochen wird, sind vorhandene [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -und **IStorage** -Zeiger, die diesem Objekt untergeordnet sind, nicht mehr zugänglich.</span><span class="sxs-lookup"><span data-stu-id="059e8-128">If the transaction on the parent object is aborted, existing [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) and **IStorage** pointers subordinate to that object are no longer accessible.</span></span> <span data-ttu-id="059e8-129">Da **IPropertyStorage** die einzige Schnittstelle für das Eigenschaften Speicher Objekt ist, wird die nützliche Lebensdauer der enthaltenen **IStream** -und **IStorage** -Zeiger durch die Lebensdauer der **IPropertyStorage** -Schnittstelle begrenzt.</span><span class="sxs-lookup"><span data-stu-id="059e8-129">Because **IPropertyStorage** is the only interface on the property storage object, the useful lifetime of the contained **IStream** and **IStorage** pointers is bounded by the lifetime of the **IPropertyStorage** interface.</span></span>

<span data-ttu-id="059e8-130">Die Implementierung muss auch die Situation behandeln, in der dieselbe Stream-oder Speicher Wert Eigenschaft mehrmals durch dieselbe Instanz der [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) -Schnittstelle angefordert wird.</span><span class="sxs-lookup"><span data-stu-id="059e8-130">The implementation must also deal with the situation where the same stream- or storage-valued property is requested multiple times through the same [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface instance.</span></span> <span data-ttu-id="059e8-131">Beispielsweise ist in der Implementierung der com-Verbund Datei der offene Vorgang abhängig davon, ob die Eigenschaft bereits geöffnet ist, erfolgreich oder fehlerhaft.</span><span class="sxs-lookup"><span data-stu-id="059e8-131">For example, in the COM compound file implementation, the open will succeed or fail depending on whether or not the property is already open.</span></span>

<span data-ttu-id="059e8-132">Ein weiteres Problem besteht darin, dass mehrere im transaktiven Modus geöffnet werden.</span><span class="sxs-lookup"><span data-stu-id="059e8-132">Another issue is multiple opens in transacted mode.</span></span> <span data-ttu-id="059e8-133">Das Ergebnis hängt von der Isolationsstufe ab, die durch einen Aufruf von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Methoden (entweder die [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) -Methode oder die [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) -Methode über die STGM-Flags) zum Zeitpunkt des Öffnens des Eigenschaften Speichers angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="059e8-133">The result depends on the isolation level that was specified through a call to [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) methods, (either the [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) or [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method, through the STGM flags) at the time that the property storage was opened.</span></span>

<span data-ttu-id="059e8-134">Wenn der aufzurufende Befehl zum Öffnen des Eigenschaften Satzes Lese-/Schreibzugriff angibt, werden [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -und [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream)-Wert-Eigenschaften immer mit Lese-/Schreibzugriff geöffnet.</span><span class="sxs-lookup"><span data-stu-id="059e8-134">If the call to open the property set specifies read-write access, [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream)-valued properties are always opened with read-write access.</span></span> <span data-ttu-id="059e8-135">Daten können dann über diese Schnittstellen geschrieben werden, wobei der Wert der Eigenschaft geändert wird. Dies ist die effizienteste Methode, um diese Eigenschaften zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="059e8-135">Data can then be written through these interfaces, changing the value of the property, which is the most efficient way to update these properties.</span></span> <span data-ttu-id="059e8-136">Der Eigenschafts Wert selbst weist keine zusätzliche Transaktions Schachtelungs Ebene auf, sodass Änderungen im Eigenschaften Speicher Objekt unter der Transaktion (sofern vorhanden) festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="059e8-136">The property value itself does not have an additional level of transaction nesting, so changes are scoped under the transaction (if any) on the property storage object.</span></span>

## <a name="storage-and-stream-properties"></a><span data-ttu-id="059e8-137">Speicher-und streameigenschaften</span><span class="sxs-lookup"><span data-stu-id="059e8-137">Storage and Stream Properties</span></span>

<span data-ttu-id="059e8-138">Um einen Stream oder ein Speicher Objekt in einen Eigenschaften Satz zu schreiben, muss der Eigenschaften Satz als nicht einfach erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="059e8-138">To write a stream or storage object to a property set, the property set must have been created as nonsimple.</span></span> <span data-ttu-id="059e8-139">Weitere Informationen zu einfachen und nicht einfachen Eigenschafts Sätzen finden Sie im Abschnitt [Speicher-und Streamobjekte für einen Eigenschaften Satz](storage-vs--stream-for-a-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="059e8-139">For more information on simple and nonsimple property sets, see the section titled [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span> <span data-ttu-id="059e8-140">Die folgenden Eigenschafts Typen, die im Feld *VT* der *rgvar* -Array Elemente angegeben sind, sind Stream-oder Speichertypen: VT \_ Stream, VT \_ Storage, VT- \_ Streaming- \_ Objekt, \_ gespeichertes VT- \_ Objekt.</span><span class="sxs-lookup"><span data-stu-id="059e8-140">The following property types, as specified in the *vt* field of the *rgvar* array elements, are stream or storage types: VT\_STREAM, VT\_STORAGE, VT\_STREAMED\_OBJECT, VT\_STORED\_OBJECT.</span></span>

<span data-ttu-id="059e8-141">Um einen Stream oder ein Speicher Objekt als Eigenschaft in einem nicht einfachen Eigenschaften Satz zu schreiben, nennen Sie [**IPropertyStorage:: Write-Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span><span class="sxs-lookup"><span data-stu-id="059e8-141">To write a stream or storage object as a property in a non-simple property set, call [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span></span> <span data-ttu-id="059e8-142">Obwohl Sie diese Methode auch zum Aktualisieren einfacher Eigenschaften aufzurufen, ist es keine effiziente Möglichkeit, Stream-und Speicher Objekte in einem Eigenschaften Satz zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="059e8-142">While you would also call this method to update simple properties, it is not an efficient way to update stream and storage objects in a property set.</span></span> <span data-ttu-id="059e8-143">Dies liegt daran, dass durch das Aktualisieren einer dieser Eigenschaften durch einen Aufrufe von " **Write-Multiple** " im Eigenschaften Speicher Objekt eine Kopie der eingehenden Daten erstellt wird und die [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -oder [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -Zeiger nicht über die Dauer dieses Aufrufes hinaus aufbewahrt werden.</span><span class="sxs-lookup"><span data-stu-id="059e8-143">This is because updating one of these properties through a call to **WriteMultiple** creates in the property storage object a copy of the passed-in data, and the [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) pointers are not retained beyond the duration of this call.</span></span> <span data-ttu-id="059e8-144">Es ist in der Regel effizienter, Stream-oder Speicher Objekte direkt zu aktualisieren, indem zuerst [**IPropertyStorage:: Read Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) aufgerufen wird, um den Schnittstellen Zeiger auf den Stream oder den Speicher zu erhalten, und dann Daten über die **IStream** -oder **IStorage** -Methode zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="059e8-144">It is usually more efficient to update stream or storage objects directly by first calling [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) to get the interface pointer to the stream or storage, then writing data through the **IStream** or **IStorage** methods.</span></span>

<span data-ttu-id="059e8-145">Beispielsweise können Sie [**IPropertyStorage:: Write-Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) aufrufen, um einen **null** -Stream oder ein Speicher Objekt zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="059e8-145">For example, you can call [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) to write a **NULL** stream or storage object.</span></span> <span data-ttu-id="059e8-146">Die-Implementierung erstellt dann ein leeres-Objekt im Eigenschaften Satz.</span><span class="sxs-lookup"><span data-stu-id="059e8-146">The implementation will then create an empty object in the property set.</span></span> <span data-ttu-id="059e8-147">Sie können dann durch Aufrufen von [**IPropertyStorage:: Read Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)Zugriff auf dieses Objekt erhalten.</span><span class="sxs-lookup"><span data-stu-id="059e8-147">You can then get access to this object by calling [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span></span> <span data-ttu-id="059e8-148">Wenn Sie mit dem Aktualisieren dieses Objekts fertig sind, müssen Sie es nicht in den Eigenschaften Satz schreiben, da die Updates direkt in den Eigenschaften Satz überlaufen wurden.</span><span class="sxs-lookup"><span data-stu-id="059e8-148">When you finish updating this object you need not write it to the property set, as your updates were going directly into the property set.</span></span>

<span data-ttu-id="059e8-149">Ein Stream oder Speicher, der über eine Eigenschaft geöffnet wird, wird immer im direkten Modus geöffnet, sodass keine zusätzliche Ebene der untergeordneten Transaktion eingeführt wird.</span><span class="sxs-lookup"><span data-stu-id="059e8-149">A stream or storage opened through a property is always opened in direct mode, so an additional level of nested transaction is not introduced.</span></span> <span data-ttu-id="059e8-150">Möglicherweise gibt es eine Transaktion für die Eigenschaft, die als Ganzes festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="059e8-150">There still may be a transaction on the property set as a whole.</span></span> <span data-ttu-id="059e8-151">(Z. b. Wenn [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) durch Aufrufen von [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) mit dem STGM \_ abgerufen wurde. Ein transaktives Flag, das im *grsmode* -Parameter festgelegt ist.) Außerdem wird ein Eigenschaften basierter Stream oder Speicher, sofern möglich, im Lese-/Schreibmodus geöffnet, wenn der Modus für den Eigenschaften Satz angegeben wird. Andernfalls wird der Lesemodus verwendet.</span><span class="sxs-lookup"><span data-stu-id="059e8-151">(For example, if the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) was obtained by calling [**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) with the STGM\_TRANSACTED flag set in the *grfmode* parameter.) Further, a property-based stream or storage is opened in read-write mode, if possible, given the mode on the property set; otherwise, read mode is used.</span></span>

<span data-ttu-id="059e8-152">Wie bereits erwähnt, wird eine Kopie des-Objekts erstellt, wenn ein Stream-oder Speicher Objekt in einen Eigenschaften Satz geschrieben wird, der mit der " [**Write Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) "-Methode festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="059e8-152">As mentioned earlier, when a stream or storage object is written to a property set with the [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) method, a copy of the object is made.</span></span> <span data-ttu-id="059e8-153">Wenn eine solche Kopie für ein Streamobjekt erstellt wird, wird der Kopiervorgang an der aktuellen Suchposition der Quelle gestartet.</span><span class="sxs-lookup"><span data-stu-id="059e8-153">When such a copy is made on a stream object, the copy operation starts at the current seek position of the source.</span></span> <span data-ttu-id="059e8-154">Die Suchposition ist bei einem Fehler nicht definiert, aber bei Erfolg befindet Sie sich am Ende des Streams. der Seek-Zeiger wird nicht an seiner ursprünglichen Position wieder hergestellt.</span><span class="sxs-lookup"><span data-stu-id="059e8-154">The seek position is undefined on failure, but on success it is at the end of the stream; the seek pointer is not restored to its original position.</span></span>

<span data-ttu-id="059e8-155">Wenn ein Datenstrom oder eine Speicher Eigenschaft aus einem Eigenschaften Satz gelesen wurde **, der mit** "read [**Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)" festgelegt wurde, bleibt weiterhin geöffnet, und für dieselbe Eigenschaft wird ein nachfolgende Aufrufe von " [**Write Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) " durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="059e8-155">If a stream or storage property has been read from a property set with [**ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple), is still held open, and a subsequent call to [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) for the same property is made, the **WriteMultiple** operation will succeed.</span></span> <span data-ttu-id="059e8-156">Die zuvor geöffnete Stream-oder Storage-Eigenschaft wird in den Zustand "wieder hergestellt" versetzt (bei allen Aufrufen an Sie wird "STG E-Fehler zurückgesetzt" zurückgegeben \_ \_ ).</span><span class="sxs-lookup"><span data-stu-id="059e8-156">The previously opened stream or storage property is placed in the reverted state (all calls to it will return STG\_E\_REVERTED error).</span></span>

<span data-ttu-id="059e8-157">Wenn die [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) -Methode einen Fehler zurückgibt, wenn ein Array von Eigenschaften geschrieben wird, oder auch einzelne nicht einfache Eigenschaften, ist die tatsächlich geschriebene Datenmenge nicht definiert.</span><span class="sxs-lookup"><span data-stu-id="059e8-157">If the [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) method returns an error when writing an array of properties, or even individual non-simple properties, the amount of data actually written is undefined.</span></span>

## <a name="reference-properties"></a><span data-ttu-id="059e8-158">Verweiseigenschaften</span><span class="sxs-lookup"><span data-stu-id="059e8-158">Reference Properties</span></span>

<span data-ttu-id="059e8-159">Wenn eine angegebene [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) -Struktur das VT- \_ ByRef-Flag in das **VT** -Element einschließt, ist die zugehörige Eigenschaft eine Verweis Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="059e8-159">If a specified [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure includes the VT\_BYREF flag in its **vt** member, the associated property is a reference property.</span></span> <span data-ttu-id="059e8-160">Eine Verweis Eigenschaft wird automatisch dereferenziert, bevor der Wert in den Eigenschaften Satz geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="059e8-160">A reference property is automatically dereferenced before writing the value to the property set.</span></span> <span data-ttu-id="059e8-161">Wenn der **VT** -Member der **PROPVARIANT** -Struktur beispielsweise einen Wert vom Typ VT \_ ByRef \| VT I4 angibt \_ , ist der tatsächlich geschriebene Wert ein VT \_ I4-Typ.</span><span class="sxs-lookup"><span data-stu-id="059e8-161">For example, if the **vt** member of the **PROPVARIANT** structure specifies a value of type VT\_BYREF \| VT\_I4, the actual value written is a VT\_I4 type.</span></span> <span data-ttu-id="059e8-162">Bei einem nachfolgenden Aufrufen der [**IPropertyStorage:: Read Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) -Methode wird ein Wert als VT I4 zurückgegeben \_ .</span><span class="sxs-lookup"><span data-stu-id="059e8-162">A subsequent call to the [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) method returns a value as VT\_I4.</span></span> <span data-ttu-id="059e8-163">Die Verwendung von Verweis Eigenschaften ähnelt dem Aufrufen der [variantcopyind](/windows/win32/api/oleauto/nf-oleauto-variantcopyind) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="059e8-163">Using reference properties is similar to calling the [VariantCopyInd](/windows/win32/api/oleauto/nf-oleauto-variantcopyind) function.</span></span> <span data-ttu-id="059e8-164">[Variantcopyind](/windows/win32/api/oleauto/nf-oleauto-variantcopyind) gibt die Ziel Variante frei und erstellt eine Kopie der Quelle VARIANTARG. dabei wird die erforderliche Dereferenzierung durchgeführt, wenn die Quelle als VT- \_ ByRef angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="059e8-164">[VariantCopyInd](/windows/win32/api/oleauto/nf-oleauto-variantcopyind) frees the destination variant and makes a copy of the source VARIANTARG, performing the necessary indirection if the source is specified to be VT\_BYREF.</span></span> <span data-ttu-id="059e8-165">Diese Funktion ist nützlich, wenn eine Kopie einer Variante benötigt wird, und um sicherzustellen, dass es sich nicht um VT- \_ ByRef handelt, z. b. bei der Handhabung von Argumenten in einer Implementierung von [**IDispatch:: Aufrufen**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke).</span><span class="sxs-lookup"><span data-stu-id="059e8-165">This function is useful when a copy of a variant is needed, and to guarantee that it is not VT\_BYREF, for example when handling arguments in an implementation of [**IDispatch::Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke).</span></span>

## <a name="notes-to-callers"></a><span data-ttu-id="059e8-166">Hinweise für Aufrufer</span><span class="sxs-lookup"><span data-stu-id="059e8-166">Notes to Callers</span></span>

<span data-ttu-id="059e8-167">Es wird empfohlen, dass Eigenschaften Sätze als Unicode erstellt werden, indem das propsetflag- \_ ANSI-Flag nicht im *grfFlags* -Parameter von [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="059e8-167">It is recommended that property sets be created as Unicode, by not setting the PROPSETFLAG\_ANSI flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="059e8-168">Es wird außerdem empfohlen, die Verwendung von VT \_ LPSTR-Werten zu vermeiden und \_ stattdessen VT LPWSTR-Werte zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="059e8-168">It is also recommended that you avoid using VT\_LPSTR values, and use VT\_LPWSTR values instead.</span></span> <span data-ttu-id="059e8-169">Wenn die Eigenschafts Satz-Codepage Unicode ist, \_ werden VT LPSTR-Zeichen folgen Werte bei der Speicherung in Unicode konvertiert und beim Abrufen zu Multibytezeichen-Zeichen folgen Werten zurück.</span><span class="sxs-lookup"><span data-stu-id="059e8-169">When the property set code page is Unicode, VT\_LPSTR string values are converted to Unicode when stored, and back to multibyte string values when retrieved.</span></span> <span data-ttu-id="059e8-170">Wenn die Codepage des Eigenschaften Satzes nicht Unicode ist, werden Eigenschaftsnamen, VT \_ BSTR-Zeichen folgen und nicht einfache Eigenschaftswerte in Multibytezeichen-Zeichen folgen konvertiert, wenn Sie gespeichert werden, und beim Abrufen wieder in Unicode konvertiert, wobei alle die aktuelle System-ANSI-Codepage verwenden.</span><span class="sxs-lookup"><span data-stu-id="059e8-170">When the code page of the property set is not Unicode, property names, VT\_BSTR strings, and non-simple property values are converted to multibyte strings when stored, and converted back to Unicode when retrieved, all using the current system ANSI code page.</span></span>

## <a name="notes-to-implementers"></a><span data-ttu-id="059e8-171">Hinweise für Ausführende</span><span class="sxs-lookup"><span data-stu-id="059e8-171">Notes to Implementers</span></span>

<span data-ttu-id="059e8-172">Wenn Sie einen Eigenschafts Bezeichner zuordnen, kann die Implementierung alle Werte auswählen, die derzeit nicht in der Eigenschaft für einen Eigenschafts Bezeichner verwendet werden, solange Sie nicht 0 oder 1 oder größer als 0x80000000 ist, die alle reservierte Werte sind.</span><span class="sxs-lookup"><span data-stu-id="059e8-172">When allocating a property identifier, the implementation can choose any value not currently in use in the property set for a property identifier, as long as it is not 0 or 1 or greater than 0x80000000, all of which are reserved values.</span></span> <span data-ttu-id="059e8-173">Der Parameter " *propidnamefirst* " legt einen minimalen Wert für Eigenschaften Bezeichner innerhalb des Satzes fest und muss größer als 1 und kleiner als 0x80000000 sein.</span><span class="sxs-lookup"><span data-stu-id="059e8-173">The *propidNameFirst* parameter establishes a minimum value for property identifiers within the set, and must be greater than 1 and less than 0x80000000.</span></span> <span data-ttu-id="059e8-174">Siehe den Abschnitt "Hinweise" oben.</span><span class="sxs-lookup"><span data-stu-id="059e8-174">See Remarks section above.</span></span>

## <a name="related-topics"></a><span data-ttu-id="059e8-175">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="059e8-175">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="059e8-176">IPropertyStorage-Implementierung der Verbund Datei</span><span class="sxs-lookup"><span data-stu-id="059e8-176">IPropertyStorage-Compound File Implementation</span></span>](ipropertystorage-compound-file-implementation.md)
</dt> <dt>

[<span data-ttu-id="059e8-177">IPropertyStorage-NTFS-Datei System Implementierung</span><span class="sxs-lookup"><span data-stu-id="059e8-177">IPropertyStorage-NTFS File System Implementation</span></span>](ipropertystorage-ntfs-file-system-implementation.md)
</dt> <dt>

[<span data-ttu-id="059e8-178">IPropertyStorage-eigenständige Implementierung</span><span class="sxs-lookup"><span data-stu-id="059e8-178">IPropertyStorage-Stand-alone Implementation</span></span>](ipropertystorage-stand-alone-implementation.md)
</dt> </dl>

 

 