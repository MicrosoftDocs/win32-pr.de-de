---
title: Speichern von Eigenschafts Sätzen
description: Anwendungen können einige der Zustandsdaten Ihrer Dokumente verfügbar machen, damit andere Anwendungen diese Daten finden und lesen können.
ms.assetid: 2e0b5f6c-da1d-47f2-a50d-1ac7f2f0c45d
keywords:
- Speichern von Eigenschaften Sätzen strukturierter Speicher
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60710b84b52fcc709f8ba3ad1e930d6f5a50a4cd
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "103855596"
---
# <a name="storing-property-sets"></a><span data-ttu-id="f6407-104">Speichern von Eigenschafts Sätzen</span><span class="sxs-lookup"><span data-stu-id="f6407-104">Storing Property Sets</span></span>

<span data-ttu-id="f6407-105">Anwendungen können einige der Zustandsdaten Ihrer Dokumente verfügbar machen, damit andere Anwendungen diese Daten finden und lesen können.</span><span class="sxs-lookup"><span data-stu-id="f6407-105">Applications can expose some of the state data of their documents so that other applications can locate and read that data.</span></span> <span data-ttu-id="f6407-106">Einige Beispiele sind ein Eigenschaften Satz, der den Autor, den Titel und die Schlüsselwörter eines Dokuments beschreibt, das mit einem Textverarbeitungs Tool erstellt wurde, oder die Liste der in einem Dokument verwendeten Schriftarten.</span><span class="sxs-lookup"><span data-stu-id="f6407-106">Some examples are a property set describing the author, title, and keywords of a document created with a word processor, or the list of fonts used in a document.</span></span> <span data-ttu-id="f6407-107">Diese Funktion ist nicht auf Dokumente beschränkt. Sie kann auch für eingebettete Objekte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f6407-107">This facility is not restricted to documents; it can also be used on embedded objects.</span></span> <span data-ttu-id="f6407-108">Im Allgemeinen sollte der Zugriff auf Eigenschaften Sätze über die Schnittstellen [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) und [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) erfolgen, aber in diesem Abschnitt wird die zuvor empfohlene Vorgehensweise beschrieben.</span><span class="sxs-lookup"><span data-stu-id="f6407-108">Generally, access to property sets should be through the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces, but this section describes the previously recommended way.</span></span>

> [!Note]  
> <span data-ttu-id="f6407-109">Wenn Sie einen internen Eigenschaften Satz für Ihre Anwendung speichern, sollten Sie die folgenden Richtlinien möglicherweise nicht verwenden.</span><span class="sxs-lookup"><span data-stu-id="f6407-109">If storing a property set that is internal to your application, you may not want to use the following guidelines.</span></span> <span data-ttu-id="f6407-110">Befolgen Sie diese Richtlinien, um die Eigenschaften für andere Anwendungen verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="f6407-110">To expose your property set to other applications, follow these guidelines.</span></span>

 

<span data-ttu-id="f6407-111">**So speichern Sie einen Eigenschaften Satz in einer Verbund Datei**</span><span class="sxs-lookup"><span data-stu-id="f6407-111">**To store a property set in a compound file**</span></span>

1.  <span data-ttu-id="f6407-112">Erstellen Sie eine [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -oder [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -Instanz auf derselben Ebene der Speicherstruktur wie Ihre Datenströme.</span><span class="sxs-lookup"><span data-stu-id="f6407-112">Create an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instance in the same level of the storage structure as its data streams.</span></span> <span data-ttu-id="f6407-113">Befolgen Sie den Namen Ihrer **IStorage** -oder **IStream** -Instanz mit " \\ 005".</span><span class="sxs-lookup"><span data-stu-id="f6407-113">Follow the name of your **IStorage** or **IStream** instance with "\\005."</span></span> <span data-ttu-id="f6407-114">Datenstrom-und Speicher Namen, die mit 0x05 beginnen, sind für allgemeine Eigenschaften Sätze reserviert, die von Anwendungen gemeinsam verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="f6407-114">Stream and storage names that begin with 0x05 are reserved for common property sets that can be shared among applications.</span></span> <span data-ttu-id="f6407-115">Außerdem sind Datenströme, die mit diesem Wert beginnen, auf 256 KB beschränkt.</span><span class="sxs-lookup"><span data-stu-id="f6407-115">Also, streams beginning with that value are limited to 256 KB.</span></span> <span data-ttu-id="f6407-116">Die Namen können entweder aus veröffentlichten Namen und Formaten ausgewählt werden, oder indem Sie die Eigenschaft Set a fmtid zuweisen und den Namen von der fmtid gemäß den in den [Benennungs Konventionen für Speicher Objekte](storage-object-naming-conventions.md)beschriebenen Konventionen ableiten.</span><span class="sxs-lookup"><span data-stu-id="f6407-116">The names can be selected from either published names and formats, or by assigning the property set a FMTID and deriving the name from the FMTID according to the conventions described in [Storage Object Naming Conventions](storage-object-naming-conventions.md).</span></span>
2.  <span data-ttu-id="f6407-117">Ein Eigenschaften Satz kann in einer einzelnen [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -Instanz oder in einer [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Instanz gespeichert werden, die mehrere Streams und Speicher enthält.</span><span class="sxs-lookup"><span data-stu-id="f6407-117">A property set may be stored in a single [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instance or in an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) instance containing multiple streams and storages.</span></span> <span data-ttu-id="f6407-118">Bei einer **IStorage** -Instanz ist der enthaltene Stream mit dem Namen "Content" der primäre Stream mit Eigenschafts Werten, wobei einige Werte Namen anderer Streams oder Speicher Instanzen im Speicher für diesen Eigenschaften Satz sein können.</span><span class="sxs-lookup"><span data-stu-id="f6407-118">In the case of an **IStorage** instance, the contained stream named Contents is the primary stream containing property values, where some values may be names of other streams or storage instances within the storage for this property set.</span></span>
3.  <span data-ttu-id="f6407-119">Geben Sie die CLSID der Objektklasse an, die den programmgesteuerten Zugriff auf die Eigenschaftswerte anzeigen oder bereitstellen kann.</span><span class="sxs-lookup"><span data-stu-id="f6407-119">Specify the CLSID of the object class that can display or provide programmatic access to the property values.</span></span> <span data-ttu-id="f6407-120">Wenn keine solche Klasse vorhanden ist, sollte die CLSID auf den Format Bezeichner des Eigenschaften Satzes festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="f6407-120">If there is no such class, the CLSID should be set to the format identifier of the property set.</span></span> <span data-ttu-id="f6407-121">Legen Sie für einen Eigenschaften Satz, der eine [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Instanz verwendet, entweder die CLSID der **IStorage** -Instanz auf die gleiche fest, die im Inhaltsstream gespeichert ist, oder auf **CLSID \_ null**. der Wert in einer neu erstellten **IStorage** -Instanz.</span><span class="sxs-lookup"><span data-stu-id="f6407-121">For a property set that uses an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) instance, either set the CLSID of the **IStorage** instance to be the same as that stored in the Contents stream or to **CLSID\_NULL**; the value in a newly created **IStorage** instance.</span></span>
4.  <span data-ttu-id="f6407-122">Sie haben die Möglichkeit, anzeigbare Namen anzugeben, die den Inhalt des Wörterbuchs bilden.</span><span class="sxs-lookup"><span data-stu-id="f6407-122">You have the option of specifying displayable names that form the contents of the dictionary.</span></span>

<span data-ttu-id="f6407-123">Einige Anwendungen können nur Implementierungen von Eigenschafts Sätzen lesen, die als [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) -Instanzen gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="f6407-123">Some applications can read only implementations of property sets stored as [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instances.</span></span> <span data-ttu-id="f6407-124">Anwendungen sollten so geschrieben werden, dass ein Eigenschaften Satz in einer [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -oder **IStream** -Instanz gespeichert werden kann, es sei denn, die Definition der Eigenschaften Menge ist anderweitig angegeben.</span><span class="sxs-lookup"><span data-stu-id="f6407-124">Applications should be written to expect that a property set may be stored in either an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or **IStream** instance, unless the property set definition indicates otherwise.</span></span> <span data-ttu-id="f6407-125">Beispielsweise gibt die Eigenschaft Festlegung der Zusammenfassungs Informationen an, dass Sie nur in einer benannten **IStream** -Instanz gespeichert werden kann.</span><span class="sxs-lookup"><span data-stu-id="f6407-125">For example, the Summary Information property set definition states that it can only be stored in a named **IStream** instance.</span></span> <span data-ttu-id="f6407-126">Wenn Sie nach einem Eigenschaften Satz suchen und nicht wissen, ob es sich um einen Speicher-oder Datenstrom handelt, suchen Sie zuerst nach einer **IStream** -Instanz mit dem Namen der Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="f6407-126">In cases where you are searching for a property set and do not know whether it is a storage or stream, look for an **IStream** instance with your property set name first.</span></span> <span data-ttu-id="f6407-127">Wenn dies nicht möglich ist, suchen Sie nach einer **IStorage** -Instanz.</span><span class="sxs-lookup"><span data-stu-id="f6407-127">If that fails, look for an **IStorage** instance.</span></span>

<span data-ttu-id="f6407-128">Um das Speichern von Eigenschafts Sätzen in einer [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Implementierung besser zu verstehen, stellen Sie sich vor, dass es eine Klasse von Anwendungen gibt, die Informationen zu Tieren</span><span class="sxs-lookup"><span data-stu-id="f6407-128">To better understand storing property sets in an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) implementation, suppose there is a class of applications that edit information about animals.</span></span> <span data-ttu-id="f6407-129">Zuerst wird eine CLSID (CLSID \_ animalapp) für diese Gruppe von Anwendungen definiert, sodass Sie angeben können, dass Sie Eigenschafts Sätze verstehen, die tierische Informationen (**fmtid \_ animalinfo**) enthalten, und andere, die medizinische Informationen (**fmtid \_ medicalinfo**) enthalten.</span><span class="sxs-lookup"><span data-stu-id="f6407-129">First, a CLSID (CLSID\_AnimalApp) is defined for this set of applications, so they can indicate that they understand property sets that contain animal information (**FMTID\_AnimalInfo**), and others that contain medical information (**FMTID\_MedicalInfo**).</span></span>

``` syntax
IStorage (File): "C:\OLE\REVO.DOC" 
  IStorage: "\005AnimalInfo", CLSID = CLSID_AnimalApp 
    IStream: "Contents" 
      WORD wByteOrder, WORD wFmtVersion, DWORD dwOSVer, 
      CLSID CLSID_AnimalApp, DWORD cSections... 
      ... 
      FMTID = FMTID_AnimalInfo 
      Property: Type = PID_ANIMALTYPE, Type = VT_LPWSTR, 
              Value = L"Dog" 
      Property: Type = PID_ANIMALNAME, Type = VT_LPWSTR, 
              Value = L"Revo" 
      Property: Type = PID_MEDICALHISTORY, Type = VT_STREAMED_OBJECT, 
              Value = "MedicalInfo" 
      ... 
    IStream: "MedicalInfo" 
      WORD wByteOrder, WORD wFmtVersion, DWORD dwOSVer, 
      CLSID CLSID_AnimalApp, DWORD cSections... 
      ... 
      FMTID = CLSID_MedicalInfo 
      Property: Type = PID_VETNAME, Type = VT_LPWSTR, 
              Value = L"Dr. Woof" 
      Property: Type = PID_LASTEXAM, Type = VT_DATE, Value = ...
```

<span data-ttu-id="f6407-130">Beachten Sie, dass die CLSID der [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Schnittstelle und beide Eigenschafts Sätze **CLSID \_ animalapp** sind.</span><span class="sxs-lookup"><span data-stu-id="f6407-130">Be aware that the CLSID of the [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface and both property sets is **CLSID\_AnimalApp**.</span></span> <span data-ttu-id="f6407-131">Dies identifiziert alle Anwendungen, die den programmgesteuerten Zugriff auf diese Eigenschaften Sätze anzeigen und/oder bereitstellen können.</span><span class="sxs-lookup"><span data-stu-id="f6407-131">This identifies any application that can display and/or provide programmatic access to these property sets.</span></span> <span data-ttu-id="f6407-132">Jede Anwendung kann die Daten in den Eigenschaften Sätzen (dem Punkt hinter Eigenschafts Sätzen) lesen, aber nur Anwendungen, die mit dem Klassen Bezeichner der CLSID \_ animalapp identifiziert werden, können die Bedeutung der Daten in den Eigenschaften Sätzen verstehen.</span><span class="sxs-lookup"><span data-stu-id="f6407-132">Any application can read the data within the property sets (the point behind property sets), but only applications identified with the class identifier of CLSID\_AnimalApp can understand the meaning of the data in the property sets.</span></span>

 

 




