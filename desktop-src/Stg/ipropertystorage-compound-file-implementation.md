---
title: Implementierung der IPropertyStorage-Compound Datei
description: Die com-Implementierung der strukturierten Speicherarchitektur wird als Verbund Dateien bezeichnet.
ms.assetid: c4b4f313-de58-44f2-8ce1-a07cc187d8ca
keywords:
- IPropertyStorage-Schnittstellen-STG, Implementierungen, Verbund Datei
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03d927b0145077f12e5ba508ca65554ca33633a3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "103858319"
---
# <a name="ipropertystorage-compound-file-implementation"></a><span data-ttu-id="4752b-104">Implementierung der IPropertyStorage-Compound Datei</span><span class="sxs-lookup"><span data-stu-id="4752b-104">IPropertyStorage-Compound File Implementation</span></span>

<span data-ttu-id="4752b-105">Die com-Implementierung der strukturierten Speicherarchitektur wird als [Verbund Dateien](istorage-compound-file-implementation.md)bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="4752b-105">The COM implementation of the Structured Storage architecture is called [compound files](istorage-compound-file-implementation.md).</span></span> <span data-ttu-id="4752b-106">Speicher Objekte, die in Verbund Dateien implementiert werden, beinhalten eine Implementierung von [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), die Schnittstelle, die einen einzelnen permanenten Eigenschaften Satz verwaltet, und [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), die Schnittstelle, die Gruppen von persistenten Eigenschaften Sätzen verwaltet.</span><span class="sxs-lookup"><span data-stu-id="4752b-106">Storage objects as implemented in compound files include an implementation of both [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), the interface that manages a single persistent property set, and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), the interface that manages groups of persistent property sets.</span></span> <span data-ttu-id="4752b-107">Weitere Informationen zur **IPropertyStorage** -Schnittstelle finden Sie unter Überlegungen zu **IPropertyStorage** und [Eigenschaften Speicher](property-storage-considerations.md).</span><span class="sxs-lookup"><span data-stu-id="4752b-107">For more information about the **IPropertyStorage** interface, see **IPropertyStorage** and [Property Storage Considerations](property-storage-considerations.md).</span></span>

<span data-ttu-id="4752b-108">Rufen Sie zum Abrufen eines Zeigers auf die Implementierung der Verbund Datei von [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) [**stgfoatestorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) auf, um ein neues Verbund Datei Objekt zu erstellen, oder [**stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) , um ein zuvor erstelltes Verbund Datei Objekt zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="4752b-108">To get a pointer to the compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) to create a new compound file object or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file object.</span></span> <span data-ttu-id="4752b-109">Im Fall von **stgkreatestorageex** sollte der *stgfmt* -Parameter auf stgfmt Storage festgelegt werden \_ .</span><span class="sxs-lookup"><span data-stu-id="4752b-109">In the case of **StgCreateStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE.</span></span> <span data-ttu-id="4752b-110">Im Fall von " **stgopenstorageex**" sollte der *stgfmt* -Parameter auf "stgfmt \_ Storage" oder "stgfmt any" festgelegt werden \_ .</span><span class="sxs-lookup"><span data-stu-id="4752b-110">In the case of **StgOpenStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE or STGFMT\_ANY.</span></span> <span data-ttu-id="4752b-111">In beiden Fällen sollte der *riid* -Parameter auf IID \_ IPropertySetStorage festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="4752b-111">In both cases, the *riid* parameter should be set to IID\_IPropertySetStorage.</span></span> <span data-ttu-id="4752b-112">Beide Funktionen stellen einen Zeiger auf die [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Schnittstelle des Objekts bereit.</span><span class="sxs-lookup"><span data-stu-id="4752b-112">Both functions supply a pointer to the object [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span> <span data-ttu-id="4752b-113">Wenn Sie entweder die [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) -oder [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) -Methode dieser Schnittstelle aufrufen, erhalten Sie einen Zeiger auf die **IPropertyStorage** -Schnittstelle, die Sie verwenden können, um beliebige Methoden aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="4752b-113">By calling either the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) or [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method of that interface, you will get a pointer to the **IPropertyStorage** interface, which you can use to call any of its methods.</span></span>

<span data-ttu-id="4752b-114">Eine alternative Möglichkeit, einen Zeiger auf die Implementierung der Verbund Datei von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) zu erhalten, besteht darin, die älteren Funktionen " [**stgforatedocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) " und " [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) " aufzurufen oder einen *riid* -Parameter von IID \_ IStorage für die Funktion " [**stganatestorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) " oder " [**stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) " anzugeben.</span><span class="sxs-lookup"><span data-stu-id="4752b-114">An alternative way to get a pointer to the compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is to call the older [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) and [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) functions, or to specify an *riid* parameter of IID\_IStorage to the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function.</span></span> <span data-ttu-id="4752b-115">In beiden Fällen wird ein Zeiger auf die [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Schnittstelle des Objekts zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="4752b-115">In either case, a pointer to the object's [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is returned.</span></span> <span data-ttu-id="4752b-116">Mit permanenten Eigenschaften Sätzen können Sie [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) für die **IPropertySetStorage** -Schnittstelle aufrufen und dabei den Header definierten Namen für den Schnittstellen Bezeichner (IID) \_ IPropertySetStorage angeben.</span><span class="sxs-lookup"><span data-stu-id="4752b-116">With persistent property sets, call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the **IPropertySetStorage** interface, specifying the header-defined name for the interface identifier (IID) IID\_IPropertySetStorage.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="4752b-117">Verwendungs Zeitpunkt</span><span class="sxs-lookup"><span data-stu-id="4752b-117">When to Use</span></span>

<span data-ttu-id="4752b-118">Verwenden Sie [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) , um Eigenschaften innerhalb eines einzelnen Eigenschaften Satzes zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="4752b-118">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) to manage properties within a single property set.</span></span> <span data-ttu-id="4752b-119">Die Methoden unterstützen das Lesen, schreiben und Löschen von Eigenschaften und den optionalen Zeichen folgen Namen, die Eigenschafts Bezeichnernamen zugeordnet werden können.</span><span class="sxs-lookup"><span data-stu-id="4752b-119">Its methods support reading, writing, and deleting both properties and the optional string names that can be associated with property identifiers.</span></span> <span data-ttu-id="4752b-120">Andere Methoden unterstützen die standardcommit-und Wiederherstellungs Speichervorgänge.</span><span class="sxs-lookup"><span data-stu-id="4752b-120">Other methods support the standard commit and revert storage operations.</span></span> <span data-ttu-id="4752b-121">Es gibt auch eine-Methode, die es Ihnen ermöglicht, Zeiten festzulegen, die dem Eigenschaften Speicher zugeordnet sind, und einen anderen, der die Zuweisung einer CLSID zulässt, die verwendet werden kann, um anderen Code, z. b. Benutzeroberflächen Code, mit dem Eigenschaften Satz zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="4752b-121">There is also a method that enables you to set times associated with the property storage, and another that permits the assignment of a CLSID that can be used to associate other code, such as user interface code, with the property set.</span></span> <span data-ttu-id="4752b-122">Der Aufruf der [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) -Methode liefert einen Zeiger auf die Implementierung der Verbund Datei von [**ienumstatus propstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), mit der Sie die Eigenschaften in der Menge auflisten können.</span><span class="sxs-lookup"><span data-stu-id="4752b-122">Calling the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method supplies a pointer to the compound file implementation of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), which allows you to enumerate the properties in the set.</span></span>

> [!Note]  
> <span data-ttu-id="4752b-123">Wenn Sie einen Zeiger auf [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) abrufen, indem Sie [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**stgcreatestorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) oder [**stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) in einem Speicher für eine Eigenschaft im einfachen Modus aufrufen, entsprechen die **IPropertyStorage** -Methoden den Regeln von Datenströmen im einfachen Modus.</span><span class="sxs-lookup"><span data-stu-id="4752b-123">If you obtain a pointer to [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) by calling [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) on a simple-mode property set storage, the **IPropertyStorage** methods adhere to the rules of simple-mode streams.</span></span> <span data-ttu-id="4752b-124">Der Eigenschaften Satz Speicher ist der einfache Modus, wenn er für eine Datei abgerufen wurde, die mit dem "STGM Simple"-Flag erstellt oder geöffnet wurde \_ .</span><span class="sxs-lookup"><span data-stu-id="4752b-124">The property set storage is simple mode if it was obtained for a file that was created or opened with the STGM\_SIMPLE flag.</span></span> <span data-ttu-id="4752b-125">In diesem Fall ist es nicht immer möglich, den zugrunde liegenden Stream zu vergrößern, und es ist nicht möglich, vorhandene Eigenschaften durch größere Eigenschaften zu ersetzen.</span><span class="sxs-lookup"><span data-stu-id="4752b-125">In this case, it is not always possible to make the underlying stream larger and it is not possible to replace existing properties with larger properties.</span></span> <span data-ttu-id="4752b-126">Weitere Informationen finden Sie unter [IPropertySetStorage-Verbund Datei Implementierung](ipropertysetstorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="4752b-126">For more information, see [IPropertySetStorage-Compound File Implementation](ipropertysetstorage-compound-file-implementation.md).</span></span>

 

## <a name="ipropertystorage-and-caching"></a><span data-ttu-id="4752b-127">IPropertyStorage und Caching</span><span class="sxs-lookup"><span data-stu-id="4752b-127">IPropertyStorage and Caching</span></span>

<span data-ttu-id="4752b-128">Die Implementierung der Verbund Datei von [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) speichert geöffnete Eigenschaften Sätze im Speicher zwischen, um die Leistung zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="4752b-128">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) caches open property sets in memory in order to improve performance.</span></span> <span data-ttu-id="4752b-129">Folglich werden Änderungen an einem Eigenschaften Satz erst dann in die Verbund Datei geschrieben, wenn die [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) -oder **Release** -Methoden (Last Reference) aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="4752b-129">As a result, changes to a property set are not written to the compound file until the [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or **Release** (last reference) methods are called.</span></span>

## <a name="simple-mode-property-sets"></a><span data-ttu-id="4752b-130">Eigenschafts Gruppen im einfachen Modus</span><span class="sxs-lookup"><span data-stu-id="4752b-130">Simple Mode Property Sets</span></span>

<span data-ttu-id="4752b-131">Ein Eigenschaften Speicher Objekt befindet sich im einfachen Modus, wenn es aus einem Eigenschaften Satz-Speicher Objekt im einfachen Modus erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="4752b-131">A property storage object is in simple mode if it is created from a simple mode property set storage object.</span></span> <span data-ttu-id="4752b-132">Beispielsweise würde sich ein Eigenschaften Satz-Speicher Objekt im einfachen Modus befinden, wenn es aus der [**stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) -Funktion abgerufen wurde, wobei das einfache STGM- \_ Flag im *GRF Mode* -Parameter festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="4752b-132">For example, a property set storage object would be in simple mode if it were obtained from the [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, with the STGM\_SIMPLE flag set in the *grfMode* parameter.</span></span> <span data-ttu-id="4752b-133">Beachten Sie, dass der "einfache Modus" nicht mit "einfachen Eigenschaften Sätzen" verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="4752b-133">Note that "simple mode" is unrelated to "simple property sets".</span></span> <span data-ttu-id="4752b-134">Ein Eigenschaften Satz ist einfach, wenn er durch Aufrufen von [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) erstellt wird, wobei das \_ nicht einfache Flag propsetflag im *grfFlags* -Parameter festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="4752b-134">A property set is simple if it is created by calling [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) with the PROPSETFLAG\_NONSIMPLE flag set in the *grfFlags* parameter.</span></span> <span data-ttu-id="4752b-135">Weitere Informationen zu einfachen und nicht einfachen Eigenschafts Sätzen finden Sie unter [Speicher-und Streamobjekte für einen Eigenschaften Satz](storage-vs--stream-for-a-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="4752b-135">For more information about simple and nonsimple property sets, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span>

<span data-ttu-id="4752b-136">Wenn ein Eigenschaften Speicher Objekt für den einfachen Modus erstellt wird, gibt es keine Einschränkungen hinsichtlich der Verwendung.</span><span class="sxs-lookup"><span data-stu-id="4752b-136">When a simple mode property storage object is created, there are no restrictions on its use.</span></span> <span data-ttu-id="4752b-137">Wenn ein vorhandenes Speicher Objekt für eine Eigenschaft im einfachen Modus geöffnet wird, kann das zugrunde liegende Streamobjekt, das den Eigenschaften Satz speichert, nicht vergrößert werden.</span><span class="sxs-lookup"><span data-stu-id="4752b-137">When an existing simple-mode property storage object is opened, the underlying stream object that stores the property set cannot be grown.</span></span> <span data-ttu-id="4752b-138">Folglich ist es nicht immer möglich, ein solches Eigenschafts Speicher Objekt zu ändern, wenn die Änderung einen größeren Stream erfordert.</span><span class="sxs-lookup"><span data-stu-id="4752b-138">Consequently, it is not always possible to modify such a property storage object if the change requires a larger stream.</span></span>

## <a name="property-set-formats"></a><span data-ttu-id="4752b-139">Eigenschaften Satz Formate</span><span class="sxs-lookup"><span data-stu-id="4752b-139">Property Set Formats</span></span>

<span data-ttu-id="4752b-140">Die Implementierung der Verbund Datei von [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) unterstützt sowohl Version 0 als auch die Eigenschaften Satz-Serialisierungsformate der Version 1.</span><span class="sxs-lookup"><span data-stu-id="4752b-140">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports both the version 0 and the version 1 property set serialization formats.</span></span> <span data-ttu-id="4752b-141">Das Format Version 1 wird auf Computern unter Windows 2000 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4752b-141">The version 1 format is supported on computers running on Windows 2000.</span></span> <span data-ttu-id="4752b-142">Weitere Informationen finden Sie unter [Eigenschaften Satz-Serialisierung](version-0-vs--version-1-property-set-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="4752b-142">For more information, see [Property Set Serialization](version-0-vs--version-1-property-set-serialization.md).</span></span> <span data-ttu-id="4752b-143">Eigenschafts Sätze werden im Format Version 0 erstellt und bleiben in diesem Format, es sei denn, es werden neue Funktionen angefordert.</span><span class="sxs-lookup"><span data-stu-id="4752b-143">Property sets are created in version 0 format and remain in that format unless new features are requested.</span></span> <span data-ttu-id="4752b-144">Wenn dies der Fall ist, wird das Format auf Version 1 aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="4752b-144">When that occurs, the format is updated to version 1.</span></span>

<span data-ttu-id="4752b-145">Wenn z. b. ein Eigenschaften Satz mit dem Standardflag propsetflag erstellt wird \_ , ist sein Format Version 0.</span><span class="sxs-lookup"><span data-stu-id="4752b-145">For example, if a property set is created with the PROPSETFLAG\_DEFAULT flag, its format is version 0.</span></span> <span data-ttu-id="4752b-146">Solange die Eigenschaften Typen, die dem Format Version 0 entsprechen, in diesen Eigenschaften Satz geschrieben und daraus gelesen werden, verbleibt der Eigenschaften Satz im Format Version 0.</span><span class="sxs-lookup"><span data-stu-id="4752b-146">As long as property types that conform to the version 0 format are written to and read from that property set, the property set remains in version 0 format.</span></span> <span data-ttu-id="4752b-147">Wenn ein Eigenschaftentyp der Version 1 in den Eigenschaften Satz geschrieben wird, wird der Eigenschaften Satz automatisch auf Version 1 aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="4752b-147">If a version 1 property type is written to the property set, the property set is automatically updated to version 1.</span></span> <span data-ttu-id="4752b-148">Anschließend kann dieser Eigenschaften Satz nicht mehr von Implementierungen gelesen werden, die nur Version 0 erkennen.</span><span class="sxs-lookup"><span data-stu-id="4752b-148">Subsequently, that property set can no longer be read by implementations that recognize only version 0.</span></span>

## <a name="ipropertystorage-and-variant-types"></a><span data-ttu-id="4752b-149">IPropertyStorage-und Variant-Typen</span><span class="sxs-lookup"><span data-stu-id="4752b-149">IPropertyStorage and Variant Types</span></span>

<span data-ttu-id="4752b-150">Die Implementierung der Verbund Datei von [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) unterstützt nicht die Variant-Typen VT \_ unknown oder VT \_ Dispatch im **VT** -Member der [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="4752b-150">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) does not support the variant types VT\_UNKNOWN or VT\_DISPATCH in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="4752b-151">In der folgenden Tabelle sind Variant-Typen aufgeführt, die in einem SafeArray unterstützt werden. Das heißt, diese Werte können mit dem VT- \_ Array im **VT** -Member der [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) -Struktur kombiniert werden.</span><span class="sxs-lookup"><span data-stu-id="4752b-151">The following table lists variant types that are supported within a SafeArray; that is, these values can be combined with VT\_ARRAY in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>



<span data-ttu-id="4752b-152">In SAFEARRAY Unterstützte Variant-Typen durch die Implementierung der Verbund Datei von IPropertyStorage</span><span class="sxs-lookup"><span data-stu-id="4752b-152">Variant types supported within SafeArray by compound file implementation of IPropertyStorage</span></span>

<span data-ttu-id="4752b-153">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="4752b-153">VT\_I1</span></span>

<span data-ttu-id="4752b-154">VT \_ UI1</span><span class="sxs-lookup"><span data-stu-id="4752b-154">VT\_UI1</span></span>

<span data-ttu-id="4752b-155">VT \_ I2</span><span class="sxs-lookup"><span data-stu-id="4752b-155">VT\_I2</span></span>

<span data-ttu-id="4752b-156">VT \_ UI2</span><span class="sxs-lookup"><span data-stu-id="4752b-156">VT\_UI2</span></span>

<span data-ttu-id="4752b-157">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="4752b-157">VT\_I4</span></span>

<span data-ttu-id="4752b-158">VT \_ UI4</span><span class="sxs-lookup"><span data-stu-id="4752b-158">VT\_UI4</span></span>

<span data-ttu-id="4752b-159">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="4752b-159">VT\_INT</span></span>

<span data-ttu-id="4752b-160">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="4752b-160">VT\_UINT</span></span>

<span data-ttu-id="4752b-161">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="4752b-161">VT\_R4</span></span>

<span data-ttu-id="4752b-162">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="4752b-162">VT\_R8</span></span>

<span data-ttu-id="4752b-163">VT- \_ CY</span><span class="sxs-lookup"><span data-stu-id="4752b-163">VT\_CY</span></span>

<span data-ttu-id="4752b-164">VT- \_ Datum</span><span class="sxs-lookup"><span data-stu-id="4752b-164">VT\_DATE</span></span>

<span data-ttu-id="4752b-165">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="4752b-165">VT\_BSTR</span></span>

<span data-ttu-id="4752b-166">VT \_ bool</span><span class="sxs-lookup"><span data-stu-id="4752b-166">VT\_BOOL</span></span>

<span data-ttu-id="4752b-167">VT ( \_ dezimal)</span><span class="sxs-lookup"><span data-stu-id="4752b-167">VT\_DECIMAL</span></span>

<span data-ttu-id="4752b-168">VT- \_ Fehler</span><span class="sxs-lookup"><span data-stu-id="4752b-168">VT\_ERROR</span></span>

<span data-ttu-id="4752b-169">VT- \_ Variante</span><span class="sxs-lookup"><span data-stu-id="4752b-169">VT\_VARIANT</span></span>

 



 

<span data-ttu-id="4752b-170">Wenn die VT- \_ Variante mit dem VT-Array kombiniert wird \_ , enthält das SAFEARRAY selbst [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) -Strukturen.</span><span class="sxs-lookup"><span data-stu-id="4752b-170">When VT\_VARIANT is combined with VT\_ARRAY, the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="4752b-171">Allerdings müssen die Typen dieser Elemente aus der vorangehenden Liste entnommen werden, können nicht als VT \_ -Variant verwendet werden und dürfen keine VT- \_ Vektor-, VT \_ Array-oder VT- \_ ByRef-Indikatoren enthalten.</span><span class="sxs-lookup"><span data-stu-id="4752b-171">However, the types of these elements must be taken from the preceding list, cannot be VT\_VARIANT, and cannot include the VT\_VECTOR, VT\_ARRAY, or VT\_BYREF indicators.</span></span>

## <a name="ipropertystorage-methods"></a><span data-ttu-id="4752b-172">IPropertyStorage-Methoden</span><span class="sxs-lookup"><span data-stu-id="4752b-172">IPropertyStorage Methods</span></span>

<span data-ttu-id="4752b-173">Die Implementierung der Verbund Datei von [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) unterstützt die folgenden Methoden:</span><span class="sxs-lookup"><span data-stu-id="4752b-173">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports the following methods:</span></span>

<dl> <dt>

<span data-ttu-id="4752b-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage:: Read Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span><span class="sxs-lookup"><span data-stu-id="4752b-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-175">Liest die im *rgpspec* -Array angegebenen Eigenschaften und liefert die Werte aller gültigen Eigenschaften im *rgvar* -Array von propvarianten.</span><span class="sxs-lookup"><span data-stu-id="4752b-175">Reads the properties specified in the *rgpspec* array and supplies the values of all valid properties in the *rgvar* array of PROPVARIANTs.</span></span> <span data-ttu-id="4752b-176">In der Implementierung der com-Verbund Datei führen doppelte Eigenschaften Bezeichner, die auf Stream-oder Speichertypen verweisen, zu mehreren Aufrufen von [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) oder [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) , und der Erfolg oder Misserfolg von "read **Multiple** " hängt von der Fähigkeit der zugrunde liegenden Speicher Implementierung ab, Öffnungsvorgänge gemeinsam zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="4752b-176">In the COM compound file implementation, duplicate property identifiers that refer to stream or storage types result in multiple calls to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) and the success or failure of **ReadMultiple** depends on the underlying storage implementation's ability to share opening operations.</span></span> <span data-ttu-id="4752b-177">Da in einer Verbund Datei STGM- \_ Freigabe \_ exklusiv erzwungen wird, können mehrere offene Versuche fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="4752b-177">Because in a compound file STGM\_SHARE\_EXCLUSIVE is forced, multiple open attempts will fail.</span></span> <span data-ttu-id="4752b-178">Das gleichzeitige Öffnen desselben Speicher Objekts aus demselben übergeordneten Speicher wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4752b-178">Opening the same storage object more than once from the same parent storage is not supported.</span></span> <span data-ttu-id="4752b-179">Das Flag "STGM- \_ Freigabe \_ exklusiv" muss angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="4752b-179">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>

<span data-ttu-id="4752b-180">Um einen Thread sicheren Vorgang sicherzustellen, wenn dieselbe Stream-oder Speicher Wert Eigenschaft mehrmals durch denselben [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) -Zeiger in der Implementierung der com-Verbund Datei angefordert wird, wird der Öffnungsvorgang in Abhängigkeit davon, ob die Eigenschaft bereits geöffnet ist und ob das zugrunde liegende Dateisystem mehrere Neustarts eines Streams oder Speichers verarbeitet, erfolgreich ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="4752b-180">In addition, to ensure thread-safe operation if the same stream- or storage-valued property is requested several times through the same [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) pointer in the COM compound file implementation, the open operation will succeed or fail depending on whether the property is already open and whether the underlying file system handles multiple openings of a stream or storage.</span></span> <span data-ttu-id="4752b-181">Folglich führt der Read **Multiple** -Vorgang für eine Stream-oder Speicher Wert-Eigenschaft immer zu einem Aufrufen von [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)oder [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), der den Zugriff (STGM- \_ Lese schreiben usw.) und freigabeflags (STGM \_ -Freigabe \_ exklusiv usw.) für das Öffnen oder Erstellen des ursprünglichen Eigenschaften Satzes übergibt.</span><span class="sxs-lookup"><span data-stu-id="4752b-181">Thus, the **ReadMultiple** operation on a stream- or storage-valued property always results in a call to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream), or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), which passes the access (STGM\_READWRITE, and so forth) and share flags (STGM\_SHARE\_EXCLUSIVE, and so on) specified when the original property set was opened or created.</span></span>

<span data-ttu-id="4752b-182">Wenn die Methode fehlschlägt, sind die in *rgvar* geschriebenen Werte nicht \[ \] definiert.</span><span class="sxs-lookup"><span data-stu-id="4752b-182">If the method fails, the values written to *rgvar*\[\] are undefined.</span></span> <span data-ttu-id="4752b-183">Wenn einige Stream-oder Speicher Wert Eigenschaften erfolgreich geöffnet werden, aber vor dem Abschluss der Ausführung ein Fehler auftritt, sollten diese vor der Rückgabe der-Methode freigegeben werden.</span><span class="sxs-lookup"><span data-stu-id="4752b-183">If some stream- or storage-valued properties are opened successfully but an error occurs before execution is complete, these should be released before the method returns.</span></span>

</dd> <dt>

<span data-ttu-id="4752b-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage:: Write Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span><span class="sxs-lookup"><span data-stu-id="4752b-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-185">Schreibt die im *rgpspec* \[ \] -Array angegebenen Eigenschaften und weist Ihnen die in *rgvar* angegebenen [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) -Tags und-Werte zu \[ \] .</span><span class="sxs-lookup"><span data-stu-id="4752b-185">Writes the properties specified in the *rgpspec*\[\] array, assigning them the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) tags and values specified in *rgvar*\[\].</span></span> <span data-ttu-id="4752b-186">Eigenschaften, die bereits vorhanden sind, werden die angegebenen **PROPVARIANT** -Werte zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="4752b-186">Properties that already exist are assigned the specified **PROPVARIANT** values.</span></span> <span data-ttu-id="4752b-187">Eigenschaften, die derzeit nicht vorhanden sind, werden erstellt.</span><span class="sxs-lookup"><span data-stu-id="4752b-187">Properties that do not currently exist are created.</span></span>

</dd> <dt>

<span data-ttu-id="4752b-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::D eletemultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span><span class="sxs-lookup"><span data-stu-id="4752b-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-189">Löscht die in der *rgpspec* angegebenen Eigenschaften \[ \] .</span><span class="sxs-lookup"><span data-stu-id="4752b-189">Deletes the properties specified in the *rgpspec*\[\].</span></span>

</dd> <dt>

<span data-ttu-id="4752b-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage:: Read PropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span><span class="sxs-lookup"><span data-stu-id="4752b-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-191">Liest vorhandene Zeichen folgen Namen, die den im *rgpropid* -Array angegebenen Eigenschaften-IDs zugeordnet sind \[ \] .</span><span class="sxs-lookup"><span data-stu-id="4752b-191">Reads existing string names associated with the property IDs specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="4752b-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage:: Beschreib tepropertynames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span><span class="sxs-lookup"><span data-stu-id="4752b-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-193">Weist den im *rgpropid* -Array angegebenen Eigenschaften-IDs Zeichen folgen Namen zu, die im *rglpwstrinname* -Array angegeben sind.</span><span class="sxs-lookup"><span data-stu-id="4752b-193">Assigns string names specified in the *rglpwstrName* array to property IDs specified in the *rgpropid* array.</span></span>

</dd> <dt>

<span data-ttu-id="4752b-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::D eletepropertynames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span><span class="sxs-lookup"><span data-stu-id="4752b-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::DeletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-195">Löscht Eigenschaftsnamen für die im *rgpropid* -Array angegebenen Eigenschaften \[ \] .</span><span class="sxs-lookup"><span data-stu-id="4752b-195">Deletes property names for the properties specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="4752b-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage:: setClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span><span class="sxs-lookup"><span data-stu-id="4752b-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-197">Legt die **CLSID** des Eigenschaften Satz-Streams fest.</span><span class="sxs-lookup"><span data-stu-id="4752b-197">Sets the **CLSID** of the property set stream.</span></span> <span data-ttu-id="4752b-198">In der Implementierung der Verbund Datei wird durch Festlegen der CLSID für einen nicht einfachen Eigenschaften Satz (einer, der Speicher-oder streamwerteigenschaften enthalten kann, wie in [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)beschrieben, auch die CLSID für den zugrunde liegenden unter Speicher festgelegt, sodass Sie durch einen Aufrufen von [**IStorage:: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat)abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="4752b-198">In the compound file implementation, setting the CLSID on a nonsimple property set (one that can legally contain storage- or stream-valued properties, as described in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) also sets the CLSID on the underlying substorage so that it can be obtained through a call to [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span></span>

</dd> <dt>

<span data-ttu-id="4752b-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span><span class="sxs-lookup"><span data-stu-id="4752b-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-200">Bei einfachen und nicht einfachen Eigenschafts Sätzen leert das Image für den Eigenschaften Satz Speicher in den zugrunde liegenden Speicher.</span><span class="sxs-lookup"><span data-stu-id="4752b-200">For both simple and nonsimple property sets, flushes the property set memory image to the underlying storage.</span></span> <span data-ttu-id="4752b-201">Außerdem führt diese Methode für nicht einfache Eigenschaften Sätze im Transaktionsmodus einen Commit (z. b. [**IStorage:: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) für den Speicher aus, der den Eigenschaften Satz enthält.</span><span class="sxs-lookup"><span data-stu-id="4752b-201">In addition, for nonsimple transacted-mode property sets, this method performs a commit (as in [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) on the storage which contains the property set.</span></span>

</dd> <dt>

<span data-ttu-id="4752b-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage:: Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span><span class="sxs-lookup"><span data-stu-id="4752b-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage::Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-203">Nur für nicht einfache Eigenschaften Sätze Ruft die [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) -Methode des zugrunde liegenden Speichers auf und öffnet den "Content"-Stream erneut.</span><span class="sxs-lookup"><span data-stu-id="4752b-203">For nonsimple property sets only, calls the [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) method of the underlying storage and reopens the 'contents' stream.</span></span> <span data-ttu-id="4752b-204">Bei einfachen Eigenschaften Sätzen gibt diese Schnittstelle immer \_ OK zurück.</span><span class="sxs-lookup"><span data-stu-id="4752b-204">For simple property sets, this interface always returns S\_OK.</span></span> <span data-ttu-id="4752b-205">Nicht einfache Eigenschaften Sätze sind solche, die mit dem nonsimple-Flag propsetflag \_ in der [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) -Methode erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="4752b-205">Nonsimple property sets are those which were created using the PROPSETFLAG\_NONSIMPLE flag in the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method.</span></span> <span data-ttu-id="4752b-206">Weitere Informationen finden Sie unter [Speichern und Streamen von Objekten für einen Eigenschaften Satz](storage-vs--stream-for-a-property-set.md) .</span><span class="sxs-lookup"><span data-stu-id="4752b-206">For more information, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md) .</span></span>

</dd> <dt>

<span data-ttu-id="4752b-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage:: Aufzählung**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span><span class="sxs-lookup"><span data-stu-id="4752b-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-208">Erstellt eine Instanz von [**ienumstatus propstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), deren Methoden aufgerufen werden können, um die [**Status**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) Wert-Strukturen aufzulisten, die Informationen zu den einzelnen Eigenschaften im Satz bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="4752b-208">Constructs an instance of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), the methods of which can be called to enumerate the [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures that provide information about each of the properties in the set.</span></span> <span data-ttu-id="4752b-209">Diese Implementierung erstellt ein Array, in das der gesamte Eigenschaften Satz gelesen wird und der freigegeben werden kann, wenn **ienumstatus propstg:: Clone** aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="4752b-209">This implementation creates an array into which the entire property set is read and which can be shared when **IEnumSTATPROPSTG::Clone** is called.</span></span> <span data-ttu-id="4752b-210">Änderungen am Eigenschaften Satz werden in einer geöffneten **ienumstatupropstg** -Instanz nicht widergespiegelt.</span><span class="sxs-lookup"><span data-stu-id="4752b-210">Changes to the property set are not reflected in an open **IEnumSTATPROPSTG** instance.</span></span> <span data-ttu-id="4752b-211">Um solche Änderungen anzuzeigen, muss eine neue Instanz dieses Enumerators erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="4752b-211">To see such changes, a new instance of this enumerator must be constructed.</span></span>

</dd> <dt>

<span data-ttu-id="4752b-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage:: stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span><span class="sxs-lookup"><span data-stu-id="4752b-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-213">Füllt die Member einer Status- [**setstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) -Struktur aus, die Daten über die als Ganzes festgelegte Eigenschaft enthält.</span><span class="sxs-lookup"><span data-stu-id="4752b-213">Fills in the members of a [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure, which contains data about the property set as a whole.</span></span> <span data-ttu-id="4752b-214">Stellt bei der Rückgabe einen Zeiger auf die-Struktur bereit.</span><span class="sxs-lookup"><span data-stu-id="4752b-214">On return, supplies a pointer to the structure.</span></span> <span data-ttu-id="4752b-215">Bei nicht einfachen Speicher Sätzen ruft diese Implementierung [**IStorage:: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (oder [**IStream:: stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) auf, um die Uhrzeiten aus dem zugrunde liegenden Speicher oder Stream zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="4752b-215">For nonsimple storage sets, this implementation calls [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (or [**IStream::Stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) to get the times from the underlying storage or stream.</span></span> <span data-ttu-id="4752b-216">Für einfache Speicher Sätze werden keine Zeiten beibehalten.</span><span class="sxs-lookup"><span data-stu-id="4752b-216">For simple storage sets, no times are maintained.</span></span>

</dd> <dt>

<span data-ttu-id="4752b-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage:: settimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span><span class="sxs-lookup"><span data-stu-id="4752b-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span></span>
</dt> <dd>

<span data-ttu-id="4752b-218">Für nicht einfache Eigenschaften Sätze legt die vom zugrunde liegenden Speicher unterstützten Zeiten fest.</span><span class="sxs-lookup"><span data-stu-id="4752b-218">For nonsimple property sets only, sets the times supported by the underlying storage.</span></span> <span data-ttu-id="4752b-219">Die Implementierung der Verbund Dateispeicherung unterstützt alle drei: Änderungen, Zugriffe und Erstellung.</span><span class="sxs-lookup"><span data-stu-id="4752b-219">The compound file storage implementation supports all three: modification, access, and creation.</span></span> <span data-ttu-id="4752b-220">Diese Implementierung von [**settimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) Ruft die [**IStorage:: setelementtimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) -Methode des zugrunde liegenden Speichers auf, um diese Zeiten abzurufen.</span><span class="sxs-lookup"><span data-stu-id="4752b-220">This implementation of [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) calls the [**IStorage::SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) method of the underlying storage to retrieve these times.</span></span>

</dd> </dl>

## <a name="related-topics"></a><span data-ttu-id="4752b-221">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="4752b-221">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4752b-222">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="4752b-222">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="4752b-223">**IStorage::/telementtimes**</span><span class="sxs-lookup"><span data-stu-id="4752b-223">**IStorage::SetElementTimes**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)
</dt> </dl>

 

 