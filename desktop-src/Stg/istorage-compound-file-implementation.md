---
title: Implementierung der IStorage-Compound Datei
description: Die Implementierung der Verbund Datei von IStorage ermöglicht Ihnen das Erstellen und Verwalten von substorages und Streams innerhalb eines Speicher Objekts, das sich in einem Verbund Datei Objekt befindet.
ms.assetid: 2a2253f6-d3d3-403e-a9ba-53a541c7a31e
keywords:
- IStorage-STG, Implementierung von Verbund Dateien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8bf37b24a7c68bbe357d99f94e666bfcb613c472
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "106338071"
---
# <a name="istorage-compound-file-implementation"></a><span data-ttu-id="1032c-104">Implementierung der IStorage-Compound Datei</span><span class="sxs-lookup"><span data-stu-id="1032c-104">IStorage-Compound File Implementation</span></span>

<span data-ttu-id="1032c-105">Die Implementierung der Verbund Datei von [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) ermöglicht Ihnen das Erstellen und Verwalten von substorages und Streams innerhalb eines Speicher Objekts, das sich in einem Verbund Datei Objekt befindet.</span><span class="sxs-lookup"><span data-stu-id="1032c-105">The compound file implementation of [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) allows you to create and manage substorages and streams within a storage object residing in a compound file object.</span></span> <span data-ttu-id="1032c-106">Um ein Verbund Datei Objekt zu erstellen und einen **IStorage** -Zeiger abzurufen, rufen Sie die API-Funktion [**stgkreatestorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex)auf.</span><span class="sxs-lookup"><span data-stu-id="1032c-106">To create a compound file object and get an **IStorage** pointer, call the API function [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex).</span></span> <span data-ttu-id="1032c-107">Um ein vorhandenes Verbund Datei Objekt zu öffnen und dessen Stamm- **IStorage** -Zeiger abzurufen, nennen Sie [**stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex).</span><span class="sxs-lookup"><span data-stu-id="1032c-107">To open an existing compound file object and get its root **IStorage** pointer, call [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex).</span></span>

<span data-ttu-id="1032c-108">Anwendungen, die Verbund Speicher verwenden, müssen in den HKEY \_ -Klassen " \_ root \\ systemfileassociations" registriert sein und ihre eigenen Eigenschaften Handler bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="1032c-108">Applications that use compound storage should be registered in HKEY\_CLASSES\_ROOT\\SystemFileAssociations and should provide their own property handlers.</span></span> <span data-ttu-id="1032c-109">Weitere Informationen finden Sie im Abschnitt "Registrieren von Verben und anderen Datei Zuordnungs Informationen" unter [Anwendungs Registrierung](/windows/desktop/shell/app-registration).</span><span class="sxs-lookup"><span data-stu-id="1032c-109">For more information, see the "Registering Verbs and Other File Association Information" section of [Application Registration](/windows/desktop/shell/app-registration).</span></span>

## <a name="when-to-use"></a><span data-ttu-id="1032c-110">Verwendungs Zeitpunkt</span><span class="sxs-lookup"><span data-stu-id="1032c-110">When to Use</span></span>

<span data-ttu-id="1032c-111">Die meisten Anwendungen verwenden diese Implementierung, um Speicher und Streams zu erstellen und zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="1032c-111">Most applications use this implementation to create and manage storages and streams.</span></span>

## <a name="methods"></a><span data-ttu-id="1032c-112">Methoden</span><span class="sxs-lookup"><span data-stu-id="1032c-112">Methods</span></span>

<dl> <dt>

<span data-ttu-id="1032c-113"><span id="IStorage__CreateStream"></span><span id="istorage__createstream"></span><span id="ISTORAGE__CREATESTREAM"></span>[**IStorage:: kreatestream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream)</span><span class="sxs-lookup"><span data-stu-id="1032c-113"><span id="IStorage__CreateStream"></span><span id="istorage__createstream"></span><span id="ISTORAGE__CREATESTREAM"></span>[**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-114">Erstellt und öffnet ein Stream-Objekt mit dem angegebenen Namen, das in diesem Speicher Objekt enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="1032c-114">Creates and opens a stream object with the specified name contained in this storage object.</span></span> <span data-ttu-id="1032c-115">Der Name darf nicht länger als 31 Zeichen sein (ohne das Zeichen folgen Abschluss Zeichen).</span><span class="sxs-lookup"><span data-stu-id="1032c-115">The name must not exceed 31 characters in length (not including the string terminator).</span></span> <span data-ttu-id="1032c-116">Die Zeichen 000 bis 01f, welche als erste Zeichen des Namens des Datenstroms/Speichers dienen, sind durch die OLE für die Benutzung reserviert.</span><span class="sxs-lookup"><span data-stu-id="1032c-116">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="1032c-117">Dies ist eine Verbunddateieinschränkung, keine strukturierte Speichereinschränkung.</span><span class="sxs-lookup"><span data-stu-id="1032c-117">This is a compound file restriction, not a structured storage restriction.</span></span> <span data-ttu-id="1032c-118">Die von com bereitgestellte Verbund Datei Implementierung der [**IStorage:: foratestream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) -Methode unterstützt nicht die folgenden Verhaltensweisen:</span><span class="sxs-lookup"><span data-stu-id="1032c-118">The COM-provided compound file implementation of the [**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) method does not support the following behaviors:</span></span>

-   <span data-ttu-id="1032c-119">Das STGM \_ deleteonrelease-Flag wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1032c-119">The STGM\_DELETEONRELEASE flag is not supported.</span></span>
-   <span data-ttu-id="1032c-120">Der transaktive Modus (STGM \_ transaktive) wird für Streamobjekte nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1032c-120">Transacted mode (STGM\_TRANSACTED) is not supported for stream objects.</span></span>
-   <span data-ttu-id="1032c-121">Das gleichzeitige Öffnen desselben Streams aus demselben Speicher wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1032c-121">Opening the same stream more than once from the same storage is not supported.</span></span> <span data-ttu-id="1032c-122">Das STGM \_ \_ -Freigabe exklusive Freigabe Modus-Flag muss im *GRF Mode* -Parameter angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="1032c-122">The STGM\_SHARE\_EXCLUSIVE sharing-mode flag must be specified in the *grfMode* parameter.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-123"><span id="IStorage__OpenStream"></span><span id="istorage__openstream"></span><span id="ISTORAGE__OPENSTREAM"></span>[**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)</span><span class="sxs-lookup"><span data-stu-id="1032c-123"><span id="IStorage__OpenStream"></span><span id="istorage__openstream"></span><span id="ISTORAGE__OPENSTREAM"></span>[**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-124">Öffnet ein vorhandenes Stream-Objekt in diesem Speicher Objekt unter Verwendung der Zugriffs Modi, die im *GRF Mode* -Parameter angegeben sind.</span><span class="sxs-lookup"><span data-stu-id="1032c-124">Opens an existing stream object within this storage object using the access modes specified in the *grfMode* parameter.</span></span> <span data-ttu-id="1032c-125">Die Zeichen 000 bis 01f, welche als erste Zeichen des Namens des Datenstroms/Speichers dienen, sind durch die OLE für die Benutzung reserviert.</span><span class="sxs-lookup"><span data-stu-id="1032c-125">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="1032c-126">Dies ist eine Verbunddateieinschränkung, keine strukturierte Speichereinschränkung.</span><span class="sxs-lookup"><span data-stu-id="1032c-126">This is a compound file restriction, not a structured storage restriction.</span></span> <span data-ttu-id="1032c-127">Die von com bereitgestellte Verbund Datei Implementierung der [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) -Methode unterstützt das folgende Verhalten nicht:</span><span class="sxs-lookup"><span data-stu-id="1032c-127">The COM-provided compound file implementation of the [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) method does not support the following behavior:</span></span>

-   <span data-ttu-id="1032c-128">Das STGM \_ deleteonrelease-Flag.</span><span class="sxs-lookup"><span data-stu-id="1032c-128">The STGM\_DELETEONRELEASE flag.</span></span>
-   <span data-ttu-id="1032c-129">Transaktiver Modus (STGM \_ transaktiv) für Streamobjekte.</span><span class="sxs-lookup"><span data-stu-id="1032c-129">Transacted mode (STGM\_TRANSACTED) for stream objects.</span></span>
-   <span data-ttu-id="1032c-130">Der gleiche Stream wird mehr als einmal aus demselben Speicher geöffnet.</span><span class="sxs-lookup"><span data-stu-id="1032c-130">Opening the same stream more than once from the same storage.</span></span> <span data-ttu-id="1032c-131">Das Flag "STGM- \_ Freigabe \_ exklusiv" muss angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="1032c-131">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-132"><span id="IStorage__CreateStorage"></span><span id="istorage__createstorage"></span><span id="ISTORAGE__CREATESTORAGE"></span>[**IStorage:: foratestorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage)</span><span class="sxs-lookup"><span data-stu-id="1032c-132"><span id="IStorage__CreateStorage"></span><span id="istorage__createstorage"></span><span id="ISTORAGE__CREATESTORAGE"></span>[**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-133">Erstellt und öffnet ein neues Speicher Objekt mit dem angegebenen Namen im angegebenen Zugriffsmodus.</span><span class="sxs-lookup"><span data-stu-id="1032c-133">Creates and opens a new storage object with the specified name in the specified access mode.</span></span> <span data-ttu-id="1032c-134">Der Name darf nicht länger als 31 Zeichen sein (ohne das Zeichen folgen Abschluss Zeichen).</span><span class="sxs-lookup"><span data-stu-id="1032c-134">The name must not exceed 31 characters in length (not including the string terminator).</span></span> <span data-ttu-id="1032c-135">Die Zeichen 000 bis 01f, welche als erste Zeichen des Namens des Datenstroms/Speichers dienen, sind durch die OLE für die Benutzung reserviert.</span><span class="sxs-lookup"><span data-stu-id="1032c-135">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="1032c-136">Dies ist eine Verbunddateieinschränkung, keine strukturierte Speichereinschränkung.</span><span class="sxs-lookup"><span data-stu-id="1032c-136">This is a compound file restriction, not a structured storage restriction.</span></span> <span data-ttu-id="1032c-137">Die von com bereitgestellte Verbund Datei Implementierung der [**IStorage:: foratestorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage) -Methode unterstützt das folgende Verhalten nicht:</span><span class="sxs-lookup"><span data-stu-id="1032c-137">The COM-provided compound file implementation of the [**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage) method does not support the following behavior:</span></span>

-   <span data-ttu-id="1032c-138">Das STGM- \_ Prioritäts Kennzeichen für nicht Stamm-Storages.</span><span class="sxs-lookup"><span data-stu-id="1032c-138">The STGM\_PRIORITY flag for nonroot storages.</span></span>
-   <span data-ttu-id="1032c-139">Das gleiche Speicher Objekt wird mehr als einmal aus demselben übergeordneten Speicher geöffnet.</span><span class="sxs-lookup"><span data-stu-id="1032c-139">Opening the same storage object more than once from the same parent storage.</span></span> <span data-ttu-id="1032c-140">Das Flag "STGM- \_ Freigabe \_ exklusiv" muss angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="1032c-140">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>
-   <span data-ttu-id="1032c-141">Das STGM \_ deleteonrelease-Flag.</span><span class="sxs-lookup"><span data-stu-id="1032c-141">The STGM\_DELETEONRELEASE flag.</span></span> <span data-ttu-id="1032c-142">Wenn dieses Flag angegeben wird, gibt die Funktion STG \_ E \_ invalidflag zurück.</span><span class="sxs-lookup"><span data-stu-id="1032c-142">If this flag is specified, the function returns STG\_E\_INVALIDFLAG.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-143"><span id="IStorage__OpenStorage"></span><span id="istorage__openstorage"></span><span id="ISTORAGE__OPENSTORAGE"></span>[**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage)</span><span class="sxs-lookup"><span data-stu-id="1032c-143"><span id="IStorage__OpenStorage"></span><span id="istorage__openstorage"></span><span id="ISTORAGE__OPENSTORAGE"></span>[**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-144">Öffnet ein vorhandenes Speicher Objekt mit dem angegebenen Namen im angegebenen Zugriffsmodus.</span><span class="sxs-lookup"><span data-stu-id="1032c-144">Opens an existing storage object with the specified name in the specified access mode.</span></span> <span data-ttu-id="1032c-145">Die Zeichen 000 bis 01f, welche als erste Zeichen des Namens des Datenstroms/Speichers dienen, sind durch die OLE für die Benutzung reserviert.</span><span class="sxs-lookup"><span data-stu-id="1032c-145">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="1032c-146">Dies ist eine Verbunddateieinschränkung, keine strukturierte Speichereinschränkung.</span><span class="sxs-lookup"><span data-stu-id="1032c-146">This is a compound file restriction, not a structured storage restriction.</span></span> <span data-ttu-id="1032c-147">Die von com bereitgestellte Verbund Datei Implementierung der [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) -Methode unterstützt das folgende Verhalten nicht:</span><span class="sxs-lookup"><span data-stu-id="1032c-147">The COM-provided compound file implementation of the [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) method does not support the following behavior:</span></span>

-   <span data-ttu-id="1032c-148">Das STGM- \_ Prioritäts Kennzeichen für nicht Stamm-Storages.</span><span class="sxs-lookup"><span data-stu-id="1032c-148">The STGM\_PRIORITY flag for nonroot storages.</span></span>
-   <span data-ttu-id="1032c-149">Das gleiche Speicher Objekt wird mehr als einmal aus demselben übergeordneten Speicher geöffnet.</span><span class="sxs-lookup"><span data-stu-id="1032c-149">Opening the same storage object more than once from the same parent storage.</span></span> <span data-ttu-id="1032c-150">Das Flag "STGM- \_ Freigabe \_ exklusiv" muss angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="1032c-150">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>
-   <span data-ttu-id="1032c-151">Das STGM \_ deleteonrelease-Flag.</span><span class="sxs-lookup"><span data-stu-id="1032c-151">The STGM\_DELETEONRELEASE flag.</span></span> <span data-ttu-id="1032c-152">Wenn dieses Flag angegeben wird, gibt die Funktion "STG \_ E \_ invalidfunction" zurück.</span><span class="sxs-lookup"><span data-stu-id="1032c-152">If this flag is specified, the function returns STG\_E\_INVALIDFUNCTION.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-153"><span id="IStorage__CopyTo"></span><span id="istorage__copyto"></span><span id="ISTORAGE__COPYTO"></span>[**IStorage:: CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto)</span><span class="sxs-lookup"><span data-stu-id="1032c-153"><span id="IStorage__CopyTo"></span><span id="istorage__copyto"></span><span id="ISTORAGE__COPYTO"></span>[**IStorage::CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-154">Kopiert nur die substorages und Streams dieses geöffneten Speicher Objekts in ein anderes Speicher Objekt.</span><span class="sxs-lookup"><span data-stu-id="1032c-154">Copies only the substorages and streams of this open storage object into another storage object.</span></span> <span data-ttu-id="1032c-155">Der *rgiidexclude* -Parameter kann auf IID IStream festgelegt werden, \_ um nur substorages zu kopieren, oder auf IID \_ IStorage, um nur Streams zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="1032c-155">The *rgiidExclude* parameter can be set to IID\_IStream to copy only substorages, or to IID\_IStorage to copy only streams.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-156"><span id="IStorage__MoveElementTo"></span><span id="istorage__moveelementto"></span><span id="ISTORAGE__MOVEELEMENTTO"></span>[**IStorage:: muveelementto**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto)</span><span class="sxs-lookup"><span data-stu-id="1032c-156"><span id="IStorage__MoveElementTo"></span><span id="istorage__moveelementto"></span><span id="ISTORAGE__MOVEELEMENTTO"></span>[**IStorage::MoveElementTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-157">Kopiert oder verschiebt einen unter Speicher oder Stream von diesem Speicher Objekt in ein anderes Speicher Objekt.</span><span class="sxs-lookup"><span data-stu-id="1032c-157">Copies or moves a substorage or stream from this storage object to another storage object.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-158"><span id="IStorage__Commit"></span><span id="istorage__commit"></span><span id="ISTORAGE__COMMIT"></span>[**IStorage:: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)</span><span class="sxs-lookup"><span data-stu-id="1032c-158"><span id="IStorage__Commit"></span><span id="istorage__commit"></span><span id="ISTORAGE__COMMIT"></span>[**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-159">Stellt sicher, dass alle Änderungen, die an einem im Transaktionsmodus geöffneten Speicher Objekt vorgenommen werden, im übergeordneten Speicher widergespiegelt werden. bei einem Stamm Speicher werden die Änderungen im eigentlichen Gerät widergespiegelt. beispielsweise eine Datei auf dem Datenträger.</span><span class="sxs-lookup"><span data-stu-id="1032c-159">Ensures that any changes made to a storage object open in transacted mode are reflected in the parent storage; for a root storage, reflects the changes in the actual device; for example, a file on disk.</span></span> <span data-ttu-id="1032c-160">Für ein im direkten Modus geöffnetes Stamm Speicher Objekt hat diese Methode keine Auswirkung, außer wenn alle Speicherpuffer auf den Datenträger geleert werden.</span><span class="sxs-lookup"><span data-stu-id="1032c-160">For a root storage object opened in direct mode, this method has no effect except to flush all memory buffers to the disk.</span></span> <span data-ttu-id="1032c-161">Bei nicht stammenden Speicher Objekten im direkten Modus hat diese Methode keine Auswirkungen.</span><span class="sxs-lookup"><span data-stu-id="1032c-161">For nonroot storage objects in direct mode, this method has no effect.</span></span>

<span data-ttu-id="1032c-162">Die von com bereitgestellte Verbund Datei Implementierung verwendet einen Zweiphasencommit-Prozess, es sei denn, das Überschreiben von "stgc" \_ ist im *GRF commitflags* -Parameter angegeben</span><span class="sxs-lookup"><span data-stu-id="1032c-162">The COM-provided compound files implementation uses a two-phase commit process unless STGC\_OVERWRITE is specified in the *grfCommitFlags* parameter.</span></span> <span data-ttu-id="1032c-163">Dieser zweistufige Prozess stellt die Stabilität von Daten sicher, falls der Commitvorgang fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="1032c-163">This two-phase process ensures the robustness of data, in case the commit operation fails.</span></span> <span data-ttu-id="1032c-164">Zuerst werden alle neuen Daten in den nicht verwendeten Speicherplatz in der zugrunde liegenden Datei geschrieben.</span><span class="sxs-lookup"><span data-stu-id="1032c-164">First, all new data is written to unused space in the underlying file.</span></span> <span data-ttu-id="1032c-165">Bei Bedarf wird der Datei neuer Speicherplatz zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="1032c-165">If necessary, new space is allocated to the file.</span></span> <span data-ttu-id="1032c-166">Nachdem dieser Schritt abgeschlossen wurde, wird eine Tabelle in der Datei mithilfe eines Schreibvorgangs mit einem einzelnen Sektor aktualisiert, um anzugeben, dass die neuen Daten anstelle der alten verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="1032c-166">After this step has been completed, a table in the file is updated using a single-sector write operation to indicate that the new data is to be used in place of the old.</span></span> <span data-ttu-id="1032c-167">Die alten Daten werden zu freiem Speicherplatz, der beim nächsten Commitvorgang verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="1032c-167">The old data becomes free space to be used at the next commit operation.</span></span> <span data-ttu-id="1032c-168">Folglich sind die alten Daten verfügbar und können wieder hergestellt werden, wenn ein Fehler beim Ausführen eines Commits für Änderungen auftritt.</span><span class="sxs-lookup"><span data-stu-id="1032c-168">Thus, the old data is available and can be restored if an error occurs when committing changes.</span></span> <span data-ttu-id="1032c-169">Wenn stgc-über \_ Schreiben angegeben ist, wird ein einzelner Phasen-Commit-Vorgang verwendet.</span><span class="sxs-lookup"><span data-stu-id="1032c-169">If STGC\_OVERWRITE is specified, a single phase commit operation is used.</span></span> <span data-ttu-id="1032c-170">Weitere Informationen über transaktive modusflags finden Sie unter [**stgc**](/windows/win32/api/wtypes/ne-wtypes-stgc) -Enumeration.</span><span class="sxs-lookup"><span data-stu-id="1032c-170">For more information about transacted mode flags, see [**STGC**](/windows/win32/api/wtypes/ne-wtypes-stgc) enumeration.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-171"><span id="IStorage__Revert"></span><span id="istorage__revert"></span><span id="ISTORAGE__REVERT"></span>[**IStorage:: Revert**](/windows/desktop/api/Objidl/nf-objidl-istorage-revert)</span><span class="sxs-lookup"><span data-stu-id="1032c-171"><span id="IStorage__Revert"></span><span id="istorage__revert"></span><span id="ISTORAGE__REVERT"></span>[**IStorage::Revert**](/windows/desktop/api/Objidl/nf-objidl-istorage-revert)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-172">Verwirft alle Änderungen, die seit dem letzten Commitvorgang an dem Speicher Objekt vorgenommen wurden.</span><span class="sxs-lookup"><span data-stu-id="1032c-172">Discards all changes that have been made to the storage object since the last commit operation.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-173"><span id="IStorage__EnumElements"></span><span id="istorage__enumelements"></span><span id="ISTORAGE__ENUMELEMENTS"></span>[**IStorage:: enumelements**](/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements)</span><span class="sxs-lookup"><span data-stu-id="1032c-173"><span id="IStorage__EnumElements"></span><span id="istorage__enumelements"></span><span id="ISTORAGE__ENUMELEMENTS"></span>[**IStorage::EnumElements**](/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-174">Erstellt und Ruft einen Zeiger auf ein Enumeratorobjekt ab, das verwendet werden kann, um die Speicher-und Streamobjekte aufzulisten, die in diesem Speicher Objekt enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="1032c-174">Creates and retrieves a pointer to an enumerator object that can be used to enumerate the storage and stream objects contained within this storage object.</span></span> <span data-ttu-id="1032c-175">Die von com bereitgestellte Verbund Datei Implementierung erstellt eine Momentaufnahme dieser Informationen.</span><span class="sxs-lookup"><span data-stu-id="1032c-175">The COM-provided compound file implementation takes a snapshot of that information.</span></span> <span data-ttu-id="1032c-176">Folglich werden Änderungen an Streams und Speicher nicht im Enumerator widergespiegelt, bis ein neuer Enumerator abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="1032c-176">Therefore, changes to the streams and storages are not reflected in the enumerator until a new enumerator is obtained.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-177"><span id="IStorage__DestroyElement"></span><span id="istorage__destroyelement"></span><span id="ISTORAGE__DESTROYELEMENT"></span>[**IStorage::D estroyelement**](/windows/desktop/api/Objidl/nf-objidl-istorage-destroyelement)</span><span class="sxs-lookup"><span data-stu-id="1032c-177"><span id="IStorage__DestroyElement"></span><span id="istorage__destroyelement"></span><span id="ISTORAGE__DESTROYELEMENT"></span>[**IStorage::DestroyElement**](/windows/desktop/api/Objidl/nf-objidl-istorage-destroyelement)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-178">Entfernt das angegebene Element (unter Speicher oder Stream) aus diesem Speicher Objekt.</span><span class="sxs-lookup"><span data-stu-id="1032c-178">Removes the specified element (substorage or stream) from this storage object.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-179"><span id="IStorage__RenameElement"></span><span id="istorage__renameelement"></span><span id="ISTORAGE__RENAMEELEMENT"></span>[**IStorage:: renameelement**](/windows/desktop/api/Objidl/nf-objidl-istorage-renameelement)</span><span class="sxs-lookup"><span data-stu-id="1032c-179"><span id="IStorage__RenameElement"></span><span id="istorage__renameelement"></span><span id="ISTORAGE__RENAMEELEMENT"></span>[**IStorage::RenameElement**](/windows/desktop/api/Objidl/nf-objidl-istorage-renameelement)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-180">Benennt den angegebenen unter Speicher oder Stream in diesem Speicher Objekt um.</span><span class="sxs-lookup"><span data-stu-id="1032c-180">Renames the specified substorage or stream in this storage object.</span></span> <span data-ttu-id="1032c-181">Die Zeichen 000 bis 01f, welche als erste Zeichen des Namens des Datenstroms/Speichers dienen, sind durch die OLE für die Benutzung reserviert.</span><span class="sxs-lookup"><span data-stu-id="1032c-181">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="1032c-182">Dies ist eine Verbunddateieinschränkung, keine strukturierte Speichereinschränkung.</span><span class="sxs-lookup"><span data-stu-id="1032c-182">This is a compound file restriction, not a structured storage restriction.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-183"><span id="IStorage__SetElementTimes"></span><span id="istorage__setelementtimes"></span><span id="ISTORAGE__SETELEMENTTIMES"></span>[**IStorage::/telementtimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)</span><span class="sxs-lookup"><span data-stu-id="1032c-183"><span id="IStorage__SetElementTimes"></span><span id="istorage__setelementtimes"></span><span id="ISTORAGE__SETELEMENTTIMES"></span>[**IStorage::SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-184">Legt die Änderungs-, Zugriffs-und Erstellungs Zeiten für das angegebene Speicher Element fest.</span><span class="sxs-lookup"><span data-stu-id="1032c-184">Sets the modification, access, and creation times of the specified storage element.</span></span> <span data-ttu-id="1032c-185">Die von com bereitgestellte Verbund Datei Implementierung behält Änderungs-und Änderungs Zeiten für interne Speicher Objekte bei.</span><span class="sxs-lookup"><span data-stu-id="1032c-185">The COM-provided compound-file implementation maintains modification and change times for internal storage objects.</span></span> <span data-ttu-id="1032c-186">Stamm Speicher Objekte unterstützen alle Vorgänge, die vom zugrunde liegenden Dateisystem (oder von [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes)) unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="1032c-186">Root storage objects support whatever is supported by the underlying file system (or by [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes)).</span></span> <span data-ttu-id="1032c-187">Die Implementierung der Verbund Datei behält keine Zeitstempel für interne Streams bei.</span><span class="sxs-lookup"><span data-stu-id="1032c-187">The compound file implementation does not maintain any time stamps for internal streams.</span></span> <span data-ttu-id="1032c-188">Nicht unterstützte Zeitstempel werden als 0 (null) gemeldet, sodass der Aufrufer die Unterstützung testen kann.</span><span class="sxs-lookup"><span data-stu-id="1032c-188">Unsupported time stamps are reported as zero, which allows the caller to test for support.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-189"><span id="IStorage__SetClass"></span><span id="istorage__setclass"></span><span id="ISTORAGE__SETCLASS"></span>[**IStorage:: setClass**](/windows/desktop/api/Objidl/nf-objidl-istorage-setclass)</span><span class="sxs-lookup"><span data-stu-id="1032c-189"><span id="IStorage__SetClass"></span><span id="istorage__setclass"></span><span id="ISTORAGE__SETCLASS"></span>[**IStorage::SetClass**](/windows/desktop/api/Objidl/nf-objidl-istorage-setclass)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-190">Weist diesem Speicher Objekt die angegebene CLSID zu.</span><span class="sxs-lookup"><span data-stu-id="1032c-190">Assigns the specified CLSID to this storage object.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-191"><span id="IStorage__SetStateBits"></span><span id="istorage__setstatebits"></span><span id="ISTORAGE__SETSTATEBITS"></span>[**IStorage:: SetStateBits**](/windows/desktop/api/Objidl/nf-objidl-istorage-setstatebits)</span><span class="sxs-lookup"><span data-stu-id="1032c-191"><span id="IStorage__SetStateBits"></span><span id="istorage__setstatebits"></span><span id="ISTORAGE__SETSTATEBITS"></span>[**IStorage::SetStateBits**](/windows/desktop/api/Objidl/nf-objidl-istorage-setstatebits)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-192">Speichert bis zu 32 Bits Zustandsinformationen in diesem Speicher Objekt.</span><span class="sxs-lookup"><span data-stu-id="1032c-192">Stores up to 32 bits of state information in this storage object.</span></span> <span data-ttu-id="1032c-193">Der von dieser Methode festgelegte Status ist nur für die externe Verwendung vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="1032c-193">The state set by this method is for external use only.</span></span> <span data-ttu-id="1032c-194">Die von com bereitgestellte Verbund Datei Implementierung führt keine Aktionen aus, die auf dem Status basieren.</span><span class="sxs-lookup"><span data-stu-id="1032c-194">The COM-provided compound file implementation does not perform any action based on the state.</span></span>

</dd> <dt>

<span data-ttu-id="1032c-195"><span id="IStorage__Stat"></span><span id="istorage__stat"></span><span id="ISTORAGE__STAT"></span>[**IStorage:: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat)</span><span class="sxs-lookup"><span data-stu-id="1032c-195"><span id="IStorage__Stat"></span><span id="istorage__stat"></span><span id="ISTORAGE__STAT"></span>[**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat)</span></span>
</dt> <dd>

<span data-ttu-id="1032c-196">Ruft die [**Statuslisten**](/windows/win32/api/objidl/ns-objidl-statstg) Struktur für dieses geöffnete Speicher Objekt ab.</span><span class="sxs-lookup"><span data-stu-id="1032c-196">Retrieves the [**STATSTG**](/windows/win32/api/objidl/ns-objidl-statstg) structure for this open storage object.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="1032c-197">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="1032c-197">Remarks</span></span>

<span data-ttu-id="1032c-198">Wenn das Speicher Objekt im einfachen Modus geöffnet wird, ist die Verwendung der oben genannten Methoden eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="1032c-198">If the storage object is opened in simple mode, use of the above methods is restricted.</span></span> <span data-ttu-id="1032c-199">Ein Speicher befindet sich im einfachen Modus, wenn er mit dem einfachen STGM-Element geöffnet wird, das \_ im *GRF Mode* -Parameter der [**stgforatestorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) -oder [**stgopenstorageex**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) -Funktion angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="1032c-199">A storage is in simple mode if it is opened with the STGM\_SIMPLE element specified in the *grfMode* parameter of the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function.</span></span> <span data-ttu-id="1032c-200">Weitere Informationen zu Storages im einfachen Modus finden Sie unter [**STGM-Konstanten**](stgm-constants.md).</span><span class="sxs-lookup"><span data-stu-id="1032c-200">For more information about simple-mode storages, see [**STGM Constants**](stgm-constants.md).</span></span> <span data-ttu-id="1032c-201">Wenn das Speicher Objekt im einfachen Modus von der **stganatestorageex** -Funktion abgerufen wurde, kann die Methode [**"Methode"**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) aufgerufen werden, aber die [**OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) -Methode kann nicht ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="1032c-201">If the simple-mode storage object was obtained from the **StgCreateStorageEx** function, then the [**CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) method can be called but the [**OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) method cannot.</span></span> <span data-ttu-id="1032c-202">Wenn das Speicher Objekt im einfachen Modus von der **stgopenstorageex** -Funktion abgerufen wurde, kann die **OpenStream** -Methode aufgerufen werden **, die Methode "Methode"** kann jedoch nicht ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="1032c-202">If the simple mode storage object was obtained from the **StgOpenStorageEx** function, then the **OpenStream** method can be called but the **CreateStream** method cannot.</span></span>

<span data-ttu-id="1032c-203">Wenn ein Speicher Objekt im einfachen Modus zum Erstellen eines Streams verwendet wird, beträgt die Mindestgröße dieses Streams in der Regel 4096 Bytes.</span><span class="sxs-lookup"><span data-stu-id="1032c-203">When a simple-mode storage object is used to create a stream, the minimum size of that stream typically is 4096 bytes.</span></span> <span data-ttu-id="1032c-204">Wenn weniger Daten in den Stream geschrieben werden, wird die Größe auf 4096 Bytes aufgerundet.</span><span class="sxs-lookup"><span data-stu-id="1032c-204">If less data is written to the stream, the size is rounded up to 4096 bytes.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1032c-205">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1032c-205">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1032c-206">Implementierungs Limits für Verbund Dateien</span><span class="sxs-lookup"><span data-stu-id="1032c-206">Compound File Implementation Limits</span></span>](structured-storage-interfaces.md)
</dt> <dt>

[<span data-ttu-id="1032c-207">**Ifilllockbytes**</span><span class="sxs-lookup"><span data-stu-id="1032c-207">**IFillLockBytes**</span></span>](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes)
</dt> <dt>

[<span data-ttu-id="1032c-208">**ILockBytes**</span><span class="sxs-lookup"><span data-stu-id="1032c-208">**ILockBytes**</span></span>](/windows/desktop/api/Objidl/nn-objidl-ilockbytes)
</dt> <dt>

[<span data-ttu-id="1032c-209">**Irootstorage**</span><span class="sxs-lookup"><span data-stu-id="1032c-209">**IRootStorage**</span></span>](/windows/desktop/api/Objidl/nn-objidl-irootstorage)
</dt> <dt>

[<span data-ttu-id="1032c-210">**IStorage**</span><span class="sxs-lookup"><span data-stu-id="1032c-210">**IStorage**</span></span>](/windows/desktop/api/Objidl/nn-objidl-istorage)
</dt> <dt>

[<span data-ttu-id="1032c-211">**IStream**</span><span class="sxs-lookup"><span data-stu-id="1032c-211">**IStream**</span></span>](/windows/desktop/api/Objidl/nn-objidl-istream)
</dt> <dt>

[<span data-ttu-id="1032c-212">**Stgkreatedocfile**</span><span class="sxs-lookup"><span data-stu-id="1032c-212">**StgCreateDocfile**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile)
</dt> <dt>

[<span data-ttu-id="1032c-213">**Stgkreatestorageex**</span><span class="sxs-lookup"><span data-stu-id="1032c-213">**StgCreateStorageEx**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex)
</dt> <dt>

[<span data-ttu-id="1032c-214">**StgOpenStorage**</span><span class="sxs-lookup"><span data-stu-id="1032c-214">**StgOpenStorage**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage)
</dt> <dt>

[<span data-ttu-id="1032c-215">**Stgopenstorageex**</span><span class="sxs-lookup"><span data-stu-id="1032c-215">**StgOpenStorageEx**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex)
</dt> </dl>

 

 