---
title: Ipapersink-Methoden
description: Copaper macht die IConnectionPointContainer-Schnittstelle verfügbar, damit Clients eine Verbindung mit copaper herstellen können, um Benachrichtigungen über bestimmte Ereignisse zu empfangen, die in copaper auftreten.
ms.assetid: 2466c721-b275-4dbc-a604-2d5e6a29d6a1
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ac8dee615b278c5214ad1efa3c10d22759620103
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104209310"
---
# <a name="ipapersink-methods"></a><span data-ttu-id="41514-103">Ipapersink-Methoden</span><span class="sxs-lookup"><span data-stu-id="41514-103">IPaperSink Methods</span></span>

<span data-ttu-id="41514-104">Copaper macht die [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) -Schnittstelle verfügbar, damit Clients eine Verbindung mit copaper herstellen können, um Benachrichtigungen über bestimmte Ereignisse zu empfangen, die in copaper auftreten.</span><span class="sxs-lookup"><span data-stu-id="41514-104">COPaper exposes the [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) interface so clients can connect to COPaper in order to receive notifications of specified events that occur in COPaper.</span></span> <span data-ttu-id="41514-105">Wenn Sie diese Schnittstelle verfügbar machen, wird copaper zu einem Verbindungs fähigen Objekt.</span><span class="sxs-lookup"><span data-stu-id="41514-105">By exposing this interface, COPaper becomes a connectable object.</span></span> <span data-ttu-id="41514-106">Ein Client kann [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) für diese Schnittstelle aufzurufen und zum Abrufen der Verbindungspunkte des Objekts verwenden.</span><span class="sxs-lookup"><span data-stu-id="41514-106">A client can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for this interface and use it to obtain the object's connection points.</span></span> <span data-ttu-id="41514-107">Die Client Teilnahme an diesem Schema wird im zugehörigen **stoclien** -Beispiel behandelt.</span><span class="sxs-lookup"><span data-stu-id="41514-107">The client participation in this scheme is covered in the associated **StoClien** sample.</span></span>

<span data-ttu-id="41514-108">Im Grunde implementiert der Client, was als Senke bezeichnet wird, in Form eines Sink-Objekts mit einer Sink-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="41514-108">Basically, the client implements what is called a sink in the form of a sink object with a sink interface.</span></span> <span data-ttu-id="41514-109">Die Senke-Schnittstelle empfängt ausgehende Ereignis Benachrichtigungs Aufrufe von copaper, nachdem die Senke ordnungsgemäß vom Client mit einer copaper-Instanz verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="41514-109">The sink interface receives outgoing event notification calls from COPaper after the sink is properly connected by the client to a COPaper instance.</span></span> <span data-ttu-id="41514-110">Der Client stellt die Verbindung mithilfe eines Verbindungspunkt Objekts her, das von copaper verwaltet wird.</span><span class="sxs-lookup"><span data-stu-id="41514-110">The client makes the connection by using a connection point object that is managed by COPaper.</span></span> <span data-ttu-id="41514-111">Es können zahlreiche Verbindungspunkte auf einem einzelnen Verbindungs fähigen COM-Objekt vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="41514-111">There can be numerous connection points on a single connectable COM object.</span></span> <span data-ttu-id="41514-112">Im **stoservice** -Beispiel verfügt copaper nur über einen Verbindungspunkt, der das Zeichnen von Papier Ereignissen behandelt.</span><span class="sxs-lookup"><span data-stu-id="41514-112">In the **StoServe** sample, COPaper has only one connection point, which handles drawing paper events.</span></span>

<span data-ttu-id="41514-113">Eine beliebige Anzahl von Clients kann eine Verbindung mit einem einzelnen Verbindungspunkt herstellen.</span><span class="sxs-lookup"><span data-stu-id="41514-113">Any number of clients can connect to a single connection point.</span></span> <span data-ttu-id="41514-114">Der \_ Verbindungspunkt für den Verbindungspunkt von Verbindungspunkt in copaper verwaltet eine Gruppe von Verbindungen, die zur Laufzeit dynamisch wachsen können.</span><span class="sxs-lookup"><span data-stu-id="41514-114">The CONNPOINT\_PAPERSINK connection point in COPaper maintains a group of connections that can grow dynamically at run time.</span></span> <span data-ttu-id="41514-115">Die vollständigen Details zur Unterstützung von Verbindungs fähigen-Objekten in copaper sind in Dateien Connect programmiert. H und Connect. Cpp und wird hier nicht behandelt.</span><span class="sxs-lookup"><span data-stu-id="41514-115">The full details on COPaper's connectable object support is coded in files CONNECT.H and CONNECT.CPP and will not be covered here.</span></span> <span data-ttu-id="41514-116">Die Konstruktion ähnelt sehr der untersuchten Codebeispiele.</span><span class="sxs-lookup"><span data-stu-id="41514-116">The construction is very similar to what was studied in the CONSERVE code sample.</span></span>

<span data-ttu-id="41514-117">Der **stoclien** -Client implementiert geeignete Sink-Objekte für die Verbindungspunkte, die er in copaper finden soll.</span><span class="sxs-lookup"><span data-stu-id="41514-117">The **StoClien** client implements appropriate sink objects for the connection points it expects to find in COPaper.</span></span> <span data-ttu-id="41514-118">Im Zusammenhang mit copaper macht das von **stoclien** implementierte wichtige Sink-Objekt die **ipapersink** -Schnittstelle verfügbar.</span><span class="sxs-lookup"><span data-stu-id="41514-118">From the context of COPaper, the important sink object that **StoClien** implements exposes the **IPaperSink** interface.</span></span> <span data-ttu-id="41514-119">Dies ist die ausgehende Schnittstelle, die von copaper verwendet wird, um **stoclien** verschiedener Ereignisse in copaper zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="41514-119">This is the outgoing interface used by COPaper to notify **StoClien** of various events in COPaper.</span></span>

<span data-ttu-id="41514-120">Im folgenden finden Sie eine Zusammenfassung der Methoden in **itaschen Sink** von iPaper. H im nicht gleich geordneten \\ Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="41514-120">Here is a summary of the methods in **IPaperSink** from IPAPER.H in the \\INC sibling directory.</span></span>



| <span data-ttu-id="41514-121">Methode</span><span class="sxs-lookup"><span data-stu-id="41514-121">Method</span></span>   | <span data-ttu-id="41514-122">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="41514-122">Description</span></span>                                                   |
|----------|---------------------------------------------------------------|
| <span data-ttu-id="41514-123">Gesperrt</span><span class="sxs-lookup"><span data-stu-id="41514-123">Locked</span></span>   | <span data-ttu-id="41514-124">Ein Client hat das Papier übernommen und gesperrt.</span><span class="sxs-lookup"><span data-stu-id="41514-124">A client has taken control of and locked the paper.</span></span>           |
| <span data-ttu-id="41514-125">Sperre aufgehoben</span><span class="sxs-lookup"><span data-stu-id="41514-125">Unlocked</span></span> | <span data-ttu-id="41514-126">Ein Client hat die Kontrolle über das Papier aufgegeben.</span><span class="sxs-lookup"><span data-stu-id="41514-126">A client has relinquished control of the paper.</span></span>               |
| <span data-ttu-id="41514-127">Geladen</span><span class="sxs-lookup"><span data-stu-id="41514-127">Loaded</span></span>   | <span data-ttu-id="41514-128">Ein Client hat Papier Inhalt aus seiner eigenen Verbund Datei geladen.</span><span class="sxs-lookup"><span data-stu-id="41514-128">A client has loaded paper content from its own compound file.</span></span> |
| <span data-ttu-id="41514-129">Gespeichert</span><span class="sxs-lookup"><span data-stu-id="41514-129">Saved</span></span>    | <span data-ttu-id="41514-130">Ein Client hat Papier Inhalt in seiner eigenen Verbund Datei gespeichert.</span><span class="sxs-lookup"><span data-stu-id="41514-130">A client has saved paper content to its own compound file.</span></span>    |
| <span data-ttu-id="41514-131">Inkstart</span><span class="sxs-lookup"><span data-stu-id="41514-131">InkStart</span></span> | <span data-ttu-id="41514-132">Ein Client hat eine Color Ink-Zeichnungs Sequenz in das Papier gestartet.</span><span class="sxs-lookup"><span data-stu-id="41514-132">A client started a color ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="41514-133">Inkdraw</span><span class="sxs-lookup"><span data-stu-id="41514-133">InkDraw</span></span>  | <span data-ttu-id="41514-134">Ein Client legt frei Hand Datenpunkte auf der Papieroberfläche ab.</span><span class="sxs-lookup"><span data-stu-id="41514-134">A client is putting ink data points on the paper surface.</span></span>     |
| <span data-ttu-id="41514-135">Inkstopps</span><span class="sxs-lookup"><span data-stu-id="41514-135">InkStop</span></span>  | <span data-ttu-id="41514-136">Ein Client hat seine frei Hand Zeichnungs Sequenz in das Papier angehalten.</span><span class="sxs-lookup"><span data-stu-id="41514-136">A client has stopped its ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="41514-137">Löschen</span><span class="sxs-lookup"><span data-stu-id="41514-137">Erased</span></span>   | <span data-ttu-id="41514-138">Ein Client hat alle frei Hand Daten aus dem Papier gelöscht.</span><span class="sxs-lookup"><span data-stu-id="41514-138">A client has erased all ink data from the paper.</span></span>              |
| <span data-ttu-id="41514-139">Geändert</span><span class="sxs-lookup"><span data-stu-id="41514-139">Resized</span></span>  | <span data-ttu-id="41514-140">Ein Client hat die Größe des Papiers geändert.</span><span class="sxs-lookup"><span data-stu-id="41514-140">A client has resized the paper.</span></span>                               |



 

<span data-ttu-id="41514-141">Diese Methoden sind größtenteils selbsterklärend.</span><span class="sxs-lookup"><span data-stu-id="41514-141">These methods are largely self-explanatory.</span></span> <span data-ttu-id="41514-142">Obwohl die Senke alle diese Methoden auf irgendeine Weise implementieren muss, werden viele als Stubs implementiert und nicht in den **stoservice**- / **stoclien** -Beispielen verwendet.</span><span class="sxs-lookup"><span data-stu-id="41514-142">Although the sink must implement all these methods in some fashion, many are implemented as stubs and are not used in the **StoServe**/**StoClien** samples.</span></span>

<span data-ttu-id="41514-143">Eine wichtige Methode, die in diesen Beispielen verwendet wird, ist die geladene Methode.</span><span class="sxs-lookup"><span data-stu-id="41514-143">An important method used in these samples is the Loaded method.</span></span> <span data-ttu-id="41514-144">Wenn copaper vom Client darüber informiert wird, dass eine neue Zeichnung aus einer Datei geladen werden soll, muss der Client benachrichtigt werden, wenn die neuen Daten geladen werden.</span><span class="sxs-lookup"><span data-stu-id="41514-144">When COPaper is told by the client to load a new drawing from file, it needs a way to notify the client when the new data is loaded.</span></span> <span data-ttu-id="41514-145">Zu diesem Zweck ruft copaper **itaschen Sink:: Loaded** in der Client Senke auf.</span><span class="sxs-lookup"><span data-stu-id="41514-145">To do this, COPaper Calls **IPaperSink::Loaded** on the client sink.</span></span> <span data-ttu-id="41514-146">Der Client kann dann [**iPaper:: Redraw**](ipaper--redraw.md) aufrufen, um anzufordern, dass copaper die neuen Daten an den Client zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="41514-146">The client can then call [**IPaper::Redraw**](ipaper--redraw.md) to request that COPaper play back the new data to the client.</span></span> <span data-ttu-id="41514-147">Redraw bewirkt, dass die geladene Zeichnung in der Anzeige des Clients neu gezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="41514-147">Redraw causes the loaded drawing in the client's display to be repainted.</span></span> <span data-ttu-id="41514-148">Wenn die Auslastung abgeschlossen ist, wird die neu geladene Zeichnung automatisch in dem vom Client bereitgestellten Fenster angezeigt.</span><span class="sxs-lookup"><span data-stu-id="41514-148">When the load is completed, the newly loaded drawing is displayed automatically in the window provided by the client.</span></span>

<span data-ttu-id="41514-149">Ausführliche Informationen über die Konnektivität dieser iPaper-Methode zu **itaschen Sink** finden Sie unter [**iPaper:: Redraw**](ipaper--redraw.md) .</span><span class="sxs-lookup"><span data-stu-id="41514-149">See [**IPaper::Redraw**](ipaper--redraw.md) for complete information of this IPaper method's connectivity to **IPaperSink**.</span></span>

<span data-ttu-id="41514-150">Die **ipapersink** -Methoden **inkstart**, **inkdraw** und **inkstation** werden verwendet, um einzelne frei Hand Datenpakete an den Client zurückzusenden.</span><span class="sxs-lookup"><span data-stu-id="41514-150">The **IPaperSink** methods **InkStart**, **InkDraw**, and **InkStop** are used to send individual ink data packets back to the client.</span></span> <span data-ttu-id="41514-151">Beim Empfang zeichnet der Client diese in der Anzeige auf die gleiche Weise wie bei der ursprünglichen Übermittlung an copaper.</span><span class="sxs-lookup"><span data-stu-id="41514-151">On reception, the client paints them in its display in the same manner as when it originally sent them to COPaper.</span></span> <span data-ttu-id="41514-152">Die obige Logik ist allgemein genug, um für mehrere Clients zuzulassen, die alle an demselben Verbindungspunkt für den Verbindungspunkt von Verbindungs Punkten lauschen \_ .</span><span class="sxs-lookup"><span data-stu-id="41514-152">The above logic is general enough to allow for multiple clients that are all listening on the same CONNPOINT\_PAPERSINK connection point.</span></span> <span data-ttu-id="41514-153">Wenn eine gemeinsame copaper-Instanz von diesen Clients gemeinsam genutzt wurde, können alle diese zeichnen, indem eine Verbindung mit diesem Verbindungspunkt hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="41514-153">If a common COPaper instance was shared by these clients, they could all display the same drawing by connecting to this connection point.</span></span>

 

 