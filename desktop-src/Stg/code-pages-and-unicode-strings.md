---
title: Codepages und Unicode-Zeichen folgen
description: Ein weiterer Aspekt bei der Implementierung von IPropertySetStorage ist, wie Unicode-Eigenschaftsnamen in der Eigenschaften-ID 0 (dem Eigenschaften Namen Wörterbuch) gespeichert werden, das keine Unicode-Zeichen folgen verwendet.
ms.assetid: 830c90c9-d2a5-4ecf-8cb6-9950ed5320bf
keywords:
- Codepages und Unicode-Zeichen folgen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 508d508ec21e7e763a683e534cf485ebbeec018d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104309400"
---
# <a name="code-pages-and-unicode-strings"></a><span data-ttu-id="928fb-104">Codepages und Unicode-Zeichen folgen</span><span class="sxs-lookup"><span data-stu-id="928fb-104">Code Pages and Unicode Strings</span></span>

<span data-ttu-id="928fb-105">Ein weiterer Aspekt bei der Implementierung von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) ist, wie Unicode-Eigenschaftsnamen in der Eigenschaften-ID 0 (dem Eigenschaften Namen Wörterbuch) gespeichert werden, das keine Unicode-Zeichen folgen verwendet.</span><span class="sxs-lookup"><span data-stu-id="928fb-105">Another consideration in implementing [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is how Unicode property names are stored in the property ID 0 (the property name dictionary), which does not use Unicode strings.</span></span>

<span data-ttu-id="928fb-106">Unicode hat offiziell den Codepage-Wert 1200.</span><span class="sxs-lookup"><span data-stu-id="928fb-106">Unicode officially has a code page value of 1200.</span></span> <span data-ttu-id="928fb-107">Verwenden Sie zum Speichern von Unicode-Werten im Eigenschaften Namen Wörterbuch den Codepage-Wert 1200 für den gesamten Eigenschaften Satz (in der Eigen schafts-ID 1), der durch das Fehlen des **\_ ANSI-Flags propsetflag** in [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="928fb-107">To store Unicode values in the property name dictionary, use a code page value of 1200 for the whole property set (in property ID 1), specified by the absence of the **PROPSETFLAG\_ANSI** flag in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="928fb-108">Beachten Sie, dass dies den Nebeneffekt hat, dass alle Zeichen folgen Werte in der in Unicode festgelegten Eigenschaft gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="928fb-108">Be aware that this has the side effect of storing all string values in the property set in Unicode.</span></span> <span data-ttu-id="928fb-109">Bei allen Codepages ist die am Anfang eines **VT \_ LPSTR** gefundene Anzahl eine Byte Anzahl und keine Zeichen Anzahl.</span><span class="sxs-lookup"><span data-stu-id="928fb-109">In all code pages, the count found at the start of a **VT\_LPSTR** is a byte count, not a character count.</span></span> <span data-ttu-id="928fb-110">Dies ist erforderlich, um die Kompatibilität mit früheren Versionen zu gewährleisten.</span><span class="sxs-lookup"><span data-stu-id="928fb-110">This is necessary to provide for compatibility with earlier-version clients.</span></span>

<span data-ttu-id="928fb-111">Die Implementierung der Verbund Datei von [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) erstellt alle neuen Eigenschaften Sätze vollständig entweder in Unicode (Codepage 1200) oder auf der aktuellen System-ANSI-Codepage.</span><span class="sxs-lookup"><span data-stu-id="928fb-111">The compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) creates all new property sets completely either in Unicode (code page 1200) or in the current system ANSI code page.</span></span> <span data-ttu-id="928fb-112">Dies wird dadurch gesteuert, dass das **propsetflag- \_ ANSI** -Flag im *grfFlags* -Parameter von [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)fehlt oder vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="928fb-112">This is controlled by the absence or presence of the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span>

<span data-ttu-id="928fb-113">Erstellen und öffnen Sie Eigenschaften Sätze als Unicode.</span><span class="sxs-lookup"><span data-stu-id="928fb-113">Create and open property sets as Unicode.</span></span> <span data-ttu-id="928fb-114">Um dies zu implementieren, legen Sie das **propsetflag- \_ ANSI** -Flag nicht im *grfFlags* -Parameter von [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)fest.</span><span class="sxs-lookup"><span data-stu-id="928fb-114">To implement this, do not set the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="928fb-115">Vermeiden Sie die Verwendung von **VT \_ LPSTR** -Werten, und verwenden Sie stattdessen **VT \_ LPWSTR** -Werte.</span><span class="sxs-lookup"><span data-stu-id="928fb-115">Avoid using **VT\_LPSTR** values, and instead use **VT\_LPWSTR** values.</span></span> <span data-ttu-id="928fb-116">Wenn die Codepage der Eigenschaft auf Unicode festgelegt ist, werden **VT \_ LPSTR** -Zeichen folgen Werte bei der Speicherung in Unicode konvertiert und beim Abrufen wieder in Multibytezeichen-Zeichen folgen Werte konvertiert.</span><span class="sxs-lookup"><span data-stu-id="928fb-116">When the code page of the property set is Unicode, **VT\_LPSTR** string values are converted to Unicode when stored, and back to multibyte string values when retrieved.</span></span>

<span data-ttu-id="928fb-117">Wenn Sie das **propsetflag- \_ ANSI** -Flag wie durch einen [**IPropertyStorage:: stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) -aufrufen gemeldet festlegen, wird reflektiert, ob die zugrunde liegende Codepage oder nicht Unicode ist.</span><span class="sxs-lookup"><span data-stu-id="928fb-117">Setting the **PROPSETFLAG\_ANSI** flag as reported through a call to [**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) reflects whether the underlying code page is or is not Unicode.</span></span> <span data-ttu-id="928fb-118">Beachten Sie, dass die eigen schafts-ID 1 explizit gelesen werden kann, um die Codepage zu erlernen.</span><span class="sxs-lookup"><span data-stu-id="928fb-118">Be aware that Property ID 1 can be explicitly read to learn the code page.</span></span>

<span data-ttu-id="928fb-119">Sie können auf die Eigenschaften-ID 1 zugreifen, indem Sie [**IPropertyStorage:: Read Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="928fb-119">You can access Property ID 1 through a call to [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span></span> <span data-ttu-id="928fb-120">Sie ist jedoch schreibgeschützt und kann nicht mit " [**Write-Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)" aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="928fb-120">However, it is read-only, and may not be updated with [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span></span> <span data-ttu-id="928fb-121">Außerdem wird es möglicherweise nicht mit [**deletemultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)gelöscht.</span><span class="sxs-lookup"><span data-stu-id="928fb-121">Furthermore, it may not be deleted with [**DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple).</span></span>

 

 




