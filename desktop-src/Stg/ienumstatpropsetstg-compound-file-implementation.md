---
title: Implementierung der IEnumSTATPROPSETSTG-Compound Datei
description: Die Implementierung der Verbund Datei der ienumstatus propsetstg-Schnittstelle wird verwendet, um ein Array von Statuswert-Strukturen aufzuzählen, die statistische Eigenschaften Daten enthalten.
ms.assetid: 1ce36e40-518c-411b-be5a-835a2dd0995e
keywords:
- Ienumstatus propsetstg-STG, Implementierung von Verbund Dateien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9566af1a1956b3a951a996b6198f4a3161680042
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104315333"
---
# <a name="ienumstatpropsetstg-compound-file-implementation"></a><span data-ttu-id="f129e-104">Implementierung der IEnumSTATPROPSETSTG-Compound Datei</span><span class="sxs-lookup"><span data-stu-id="f129e-104">IEnumSTATPROPSETSTG-Compound File Implementation</span></span>

<span data-ttu-id="f129e-105">Die Implementierung der Verbund Datei der [**ienumstatus propsetstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) -Schnittstelle wird verwendet, um ein Array von [**Status**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) Wert-Strukturen aufzuzählen, die statistische Eigenschaften Daten enthalten.</span><span class="sxs-lookup"><span data-stu-id="f129e-105">The compound file implementation of the [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface is used to enumerate an array of [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures that contain statistical property data.</span></span> <span data-ttu-id="f129e-106">Die [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Implementierung verwaltet die statistischen Daten und ist einem aktuellen Verbund Datei-Speicher Objekt zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="f129e-106">The [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) implementation manages the statistical data and is associated with a current compound file storage object.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="f129e-107">Verwendungs Zeitpunkt</span><span class="sxs-lookup"><span data-stu-id="f129e-107">When to Use</span></span>

<span data-ttu-id="f129e-108">Aufrufen der Methoden von [**ienumstatus propsetstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) zum Auflisten von [**Status-setstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) -Strukturen, von denen jede Daten zu einem der Eigenschaften Sätze bereitstellt, die dem Verbund Dateispeicher Objekt zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="f129e-108">Call the methods of [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures, each of which provide data about one of the property sets associated with the compound file storage object.</span></span>

## <a name="remarks"></a><span data-ttu-id="f129e-109">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="f129e-109">Remarks</span></span>

<dl> <dt>

<span data-ttu-id="f129e-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**Ienumstatus propsetstg:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span><span class="sxs-lookup"><span data-stu-id="f129e-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span></span>
</dt> <dd>

<span data-ttu-id="f129e-111">Ruft das nächste oder mehrere [**Status setstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) -Strukturen ab (die Zahl wird durch den *celt* -Parameter angegeben).</span><span class="sxs-lookup"><span data-stu-id="f129e-111">Gets the next one or more [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures (the number is specified by the *celt* parameter).</span></span> <span data-ttu-id="f129e-112">Die durch einen Aufrufen der Implementierung der Verbund Datei von [**ienumstatus propsetstg:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) bereitgestellten " **Status-setstg** "-Elemente befolgen die folgenden Regeln:</span><span class="sxs-lookup"><span data-stu-id="f129e-112">The **STATPROPSETSTG** elements provided through a call to the compound file implementation of [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) follow these rules:</span></span>

-   <span data-ttu-id="f129e-113">Wenn [**ienumstatus propsetstg:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) nicht die Angabe von "Status-setstg. fmtid" bieten, werden Nullen in dieses Element geschrieben.</span><span class="sxs-lookup"><span data-stu-id="f129e-113">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.fmtid, zeros are written to that member.</span></span> <span data-ttu-id="f129e-114">Dies tritt auf, wenn der Eigenschaften Satz keinen vordefinierten Namen hat (z. b. \\ 005summaryinformation) und kein gültiger Wert ist.</span><span class="sxs-lookup"><span data-stu-id="f129e-114">This occurs when the property set does not have a predefined name (such as \\005SummaryInformation) and is not a legal value.</span></span>
-   <span data-ttu-id="f129e-115">Der Satz "documentsummaryinformation" und der benutzerdefinierte Eigenschaften Satz sind "Special", da er möglicherweise zwei Eigenschaften Satz Abschnitte hat.</span><span class="sxs-lookup"><span data-stu-id="f129e-115">The DocumentSummaryInformation and UserDefined property set is special, in that it may have two property set sections.</span></span> <span data-ttu-id="f129e-116">Dieser Eigenschaften Satz wird im Abschnitt [documentsummaryinformation und UserDefined-Eigenschaften Sätze](the-documentsummaryinformation-and-userdefined-property-sets.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="f129e-116">This property set is described in the section [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span> <span data-ttu-id="f129e-117">Der zweite Abschnitt wird als User-Defined Eigenschaften bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="f129e-117">The second section is referred to as the User-Defined Properties.</span></span> <span data-ttu-id="f129e-118">Jeder Abschnitt wird mit einem eindeutigen Format Bezeichner (fmtid) identifiziert.</span><span class="sxs-lookup"><span data-stu-id="f129e-118">Each section is identified with a unique format identifier (FMTID).</span></span> <span data-ttu-id="f129e-119">Wenn [**IPropertySetStorage:: Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) zum Auflisten von Eigenschafts Sätzen verwendet wird, wird der User-Defined-Eigenschaften Satz nicht aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="f129e-119">When [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) is used to enumerate property sets, the User-Defined property set will not be enumerated.</span></span>

> [!Note]  
> <span data-ttu-id="f129e-120">Wenn Sie immer einen Eigenschaften Satz mithilfe von [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)erstellen, dann wird, da für den Speicher Namen eine "Zeichen-GUID" erstellt wird, [**ienumstatus propsetstg:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) eine nicht 0 (null), gültige fmtid für den Eigenschaften Satz " \[ Status-setstg. fmtid" zurückgegeben \] .</span><span class="sxs-lookup"><span data-stu-id="f129e-120">If you always create a property set using [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), then, because a "Character GUID" is created for the storage name, [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) will return a nonzero, valid FMTID for the property set \[STATPROPSETSTG.fmtid\].</span></span>

 

-   <span data-ttu-id="f129e-121">Der Status propsetstg. grfFlags reflektiert nicht notwendigerweise, ob der Eigenschaften Satz ANSI ist oder nicht.</span><span class="sxs-lookup"><span data-stu-id="f129e-121">The STATPROPSETSTG.grfFlags member does not necessarily reflect whether the property set is ANSI or not.</span></span> <span data-ttu-id="f129e-122">Wenn propsetflag \_ ANSI festgelegt ist, ist der Eigenschaften Satz definitiv ANSI.</span><span class="sxs-lookup"><span data-stu-id="f129e-122">If PROPSETFLAG\_ANSI is set, the property set is definitely ANSI.</span></span> <span data-ttu-id="f129e-123">Wenn propsetflag \_ ANSI eindeutig ist, kann der Eigenschaften Satz entweder Unicode oder nicht-Unicode sein, weil es nicht möglich ist, zu erkennen, ob es sich um ANSI handelt, ohne es zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="f129e-123">If PROPSETFLAG\_ANSI is clear, the property set could be either Unicode or non-Unicode, because it is not possible to tell whether it is ANSI without opening it.</span></span>
-   <span data-ttu-id="f129e-124">Der statpropsetstg. grfFlags-Member gibt an, ob der Eigenschaften Satz einfach ist, sodass die Einstellung des nonsimple-Flags propsetflag \_ immer gültig ist.</span><span class="sxs-lookup"><span data-stu-id="f129e-124">The STATPROPSETSTG.grfFlags member does reflect whether the property set is simple or not, so the setting of the PROPSETFLAG\_NONSIMPLE flag is always valid.</span></span>
-   <span data-ttu-id="f129e-125">Wenn [**ienumstatupropsetstg:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) die Angabe von "Status-setstg. CLSID" nicht bereitstellen kann, werden alle Nullen (CLSID \_ null) festgelegt.</span><span class="sxs-lookup"><span data-stu-id="f129e-125">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.clsid, it is set to all zeroes (CLSID\_NULL).</span></span> <span data-ttu-id="f129e-126">In der Implementierung der com-Verbund Datei tritt dieser Fehler auf, wenn der Eigenschaften Satz einfach ist (das nonsimple-Flag propsetflag \_ ist nicht festgelegt) oder nicht einfach ist, aber die CLSID nicht explizit festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="f129e-126">In the COM compound file implementation, this occurs when the property set is simple (the PROPSETFLAG\_NONSIMPLE flag is not set), or is nonsimple, but the CLSID was not explicitly set.</span></span> <span data-ttu-id="f129e-127">Bei nicht einfachen Eigenschafts Sätzen ist die empfangene CLSID die von der zugrunde liegenden [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage)-Klasse erhaltene CLSID.</span><span class="sxs-lookup"><span data-stu-id="f129e-127">For nonsimple property sets, the CLSID that is received is the one that is maintained by the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage).</span></span>
-   <span data-ttu-id="f129e-128">Wenn [**ienumstatus propsetstg:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) die Zeitfelder \[ **ctime**, **mtime** und **atime** nicht bereitstellen kann \] , wird jede nicht unterstützte Zeit auf Nullen festgelegt.</span><span class="sxs-lookup"><span data-stu-id="f129e-128">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide the time fields \[**ctime**, **mtime**, **atime**\], each non-supported time will be set to zeroes.</span></span> <span data-ttu-id="f129e-129">In der Implementierung der com-Verbund Datei ist das Abrufen dieser Werte davon abhängig, dass Sie von der zugrunde liegenden [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Implementierung abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="f129e-129">In the COM compound file implementation, getting these values depends on retrieving them from the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) implementation.</span></span>

</dd> <dt>

<span data-ttu-id="f129e-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**Ienumstatus propsetstg:: Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="f129e-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG::Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="f129e-131">Überspringt die Anzahl der in *celt* angegebenen Elemente.</span><span class="sxs-lookup"><span data-stu-id="f129e-131">Skips the number of elements specified in *celt*.</span></span> <span data-ttu-id="f129e-132">Gibt "s OK" zurück \_ , wenn die angegebene Anzahl von Elementen übersprungen wird, gibt "false" zurück, \_ Wenn weniger Elemente als angefordert übersprungen werden.</span><span class="sxs-lookup"><span data-stu-id="f129e-132">Returns S\_OK if the specified number of elements are skipped, returns S\_FALSE if fewer elements than requested are skipped.</span></span> <span data-ttu-id="f129e-133">In jedem anderen Fall wird der entsprechende Fehler zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="f129e-133">In any other case, returns the appropriate error.</span></span>

</dd> <dt>

<span data-ttu-id="f129e-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**Ienumstatus propsetstg:: Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="f129e-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG::Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="f129e-135">Legt den Cursor auf den Anfang der Enumeration fest.</span><span class="sxs-lookup"><span data-stu-id="f129e-135">Sets the cursor to the beginning of the enumeration.</span></span> <span data-ttu-id="f129e-136">Wenn erfolgreich, wird S OK zurückgegeben; \_ andernfalls wird STG \_ E \_ InvalidHandle zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="f129e-136">If successful, returns S\_OK, otherwise, returns STG\_E\_INVALIDHANDLE.</span></span>

</dd> <dt>

<span data-ttu-id="f129e-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**Ienumstatus propsetstg:: Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="f129e-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG::Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="f129e-138">Kopiert den aktuellen Enumerationszustand dieses Enumerators.</span><span class="sxs-lookup"><span data-stu-id="f129e-138">Copies the current enumeration state of this enumerator.</span></span>

</dd> </dl>

 

 