---
title: Leistungsmerkmale
description: Ein Aufrufen der com-Verbund Datei Implementierung der IPropertySetStorage-Schnittstelle zum Erstellen eines Eigenschafts Satzes bewirkt, dass entweder ein Stream oder ein Speicher durch einen IStorage-Erstellungs-oder IStorage-Vorgang erstellt wird.
ms.assetid: 7773e649-19a4-4df2-84ed-027d73283140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8597862602a367ed93a3d6e5e0bcac76035c337a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "103948891"
---
# <a name="performance-characteristics"></a><span data-ttu-id="c5c8e-103">Leistungsmerkmale</span><span class="sxs-lookup"><span data-stu-id="c5c8e-103">Performance Characteristics</span></span>

<span data-ttu-id="c5c8e-104">Ein Aufrufen der com-Verbund Datei Implementierung der [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) -Schnittstelle zum Erstellen eines Eigenschafts Satzes bewirkt, dass entweder ein Stream oder ein Speicher durch einen [**IStorage:: foratestream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) -oder [**IStorage:: anatestorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage)-Anforderungstyp erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-104">A call to the COM compound file implementation of the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to create a property set causes either a stream or storage to be created through a call to [**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) or [**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span></span> <span data-ttu-id="c5c8e-105">Ein Standardeigenschaften Satz wird im Arbeitsspeicher erstellt, aber nicht auf den Datenträger geleert.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-105">A default property set is created in memory, but not flushed to disk.</span></span> <span data-ttu-id="c5c8e-106">Wenn ein [**IPropertyStorage:: Write-Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)-Befehl aufgerufen wird, wird dieser innerhalb des Puffers verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-106">When there is a call to [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), it operates within the buffer.</span></span>

<span data-ttu-id="c5c8e-107">Wenn ein Eigenschaften Satz geöffnet ist, wird [IStorage:: OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) oder [IStorage:: OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) verwendet.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-107">When a property set is opened, [IStorage::OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [IStorage::OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) is used.</span></span> <span data-ttu-id="c5c8e-108">Der gesamte Eigenschaften Satz-Stream wird in zusammenhängenden Speicher gelesen.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-108">The entire property set stream is read into contiguous memory.</span></span> <span data-ttu-id="c5c8e-109">[**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) -Vorgänge werden dann ausgeführt, indem der Speicherpuffer gelesen wird.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-109">[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) operations then operate by reading the memory buffer.</span></span> <span data-ttu-id="c5c8e-110">Daher ist der erste Zugriff in Bezug auf die zeitaufwendig (aufgrund von Datenträger Lesevorgängen). nachfolgende Zugriffe sind jedoch sehr effizient.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-110">Therefore, the first access is expensive in terms of time (because of disk reads) but subsequent accesses are very efficient.</span></span> <span data-ttu-id="c5c8e-111">Schreibvorgänge können etwas teurer sein, da SetSize-Vorgänge für den zugrunde liegenden Stream möglicherweise erforderlich sind, um sicherzustellen, dass der Speicherplatz verfügbar ist, wenn Daten hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-111">Writes may be slightly more expensive because SetSize operations on the underlying stream may be required to guarantee that disk space is available if data is added.</span></span>

<span data-ttu-id="c5c8e-112">Es wird nicht sichergestellt, ob [**IPropertyStorage:: Write-Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) Updates leert.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-112">No guarantees are made as to whether [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) will flush updates.</span></span> <span data-ttu-id="c5c8e-113">Im Allgemeinen sollte der Client davon ausgehen, dass **IPropertyStorage:: schreitemultiple** nur den im Arbeitsspeicher Puffer aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-113">In general, the client should assume that **IPropertyStorage::WriteMultiple** only updates the in memory buffer.</span></span> <span data-ttu-id="c5c8e-114">Zum leeren von Daten muss [**IPropertyStorage:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) oder [**IUnknown:: Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (letzte Version) aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-114">To flush data, [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or [**IUnknown::Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (last release) should be called.</span></span>

<span data-ttu-id="c5c8e-115">Dieser Entwurf bedeutet, dass " [**schreitemultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) " erfolgreich sein kann, aber die Daten nicht wirklich dauerhaft geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-115">This design means that [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) may succeed but the data is not actually persistently written.</span></span>

> [!Note]  
> <span data-ttu-id="c5c8e-116">Diese Größe des Eigenschaften Satz-Streams darf 256 KB nicht überschreiten.</span><span class="sxs-lookup"><span data-stu-id="c5c8e-116">This size of the property set stream cannot exceed 256K bytes.</span></span>

 

 

 