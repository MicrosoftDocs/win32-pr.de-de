---
title: Verwalten von Eigenschaften
description: Jede Eigenschaft besteht aus einem Eigenschafts Bezeichner (innerhalb des Eigenschaften Satzes eindeutig), einem Variant-Typ (VT oder VarType), der den Typ eines Werts darstellt, und dem Wert selbst.
ms.assetid: d220ecb4-b014-4ac9-a636-9a493187cc87
keywords:
- Strukturierter Speicher, Verwendung, Verwalten von Eigenschaften
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 10dd78a1f8a8484090728dba6fe149840e940461
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "103858318"
---
# <a name="managing-properties"></a><span data-ttu-id="f8b64-104">Verwalten von Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="f8b64-104">Managing Properties</span></span>

<span data-ttu-id="f8b64-105">Jede Eigenschaft besteht aus einem *Eigenschafts Bezeichner* (innerhalb des Eigenschaften Satzes eindeutig), einem *Variant-Typ (VT oder VarType)* , der den Typ eines Werts darstellt, und dem *Wert* selbst.</span><span class="sxs-lookup"><span data-stu-id="f8b64-105">Every property consists of a *property identifier* (unique within its property set), a *variant type (VT or VarType) tag* that represents the type of a value, and the *value* itself.</span></span> <span data-ttu-id="f8b64-106">Das Variant Type-Tag beschreibt die Darstellung der Daten im-Wert.</span><span class="sxs-lookup"><span data-stu-id="f8b64-106">The variant type tag describes the representation of the data in the value.</span></span> <span data-ttu-id="f8b64-107">Außerdem kann einer Eigenschaft ein *Zeichen folgen Name* zugewiesen werden, der zum Identifizieren der Eigenschaft verwendet werden kann, anstatt den erforderlichen numerischen Eigenschaften Bezeichner (ID) zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="f8b64-107">In addition, a property may also be assigned a *string name* that can be used to identify the property, rather than using the required numerical property identifier (ID).</span></span> <span data-ttu-id="f8b64-108">Zum Erstellen und Verwalten von Eigenschaften definiert com die [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="f8b64-108">To create and manage properties, COM defines the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface.</span></span>

<span data-ttu-id="f8b64-109">Die [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) -Schnittstelle enthält Methoden zum Lesen und Schreiben von Arrays von Eigenschaften-oder Eigenschaftsnamen.</span><span class="sxs-lookup"><span data-stu-id="f8b64-109">The [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface includes methods to read and write arrays of either properties or property names.</span></span> <span data-ttu-id="f8b64-110">Die-Schnittstelle enthält [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) -und [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) -Methoden, die [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) -Methoden gleichen Namens ähneln.</span><span class="sxs-lookup"><span data-stu-id="f8b64-110">The interface includes [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) and [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) methods that are similar to [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) methods of the same name.</span></span> <span data-ttu-id="f8b64-111">Es gibt Hilfsmethoden, mit denen Sie den Klassen Bezeichner (CLSID) des Eigenschaften Satzes festlegen, die dem Satz zugeordneten Zeiten festlegen und Statistiken zum Eigenschaften Satz erhalten.</span><span class="sxs-lookup"><span data-stu-id="f8b64-111">There are utility methods that allow you to set the class identifier (CLSID) of the property set, set the times associated with the set, and get statistics about the property set.</span></span> <span data-ttu-id="f8b64-112">Schließlich erstellt die [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) -Methode einen Enumerator und gibt einen Zeiger auf die zugehörige [**ienumstatus propstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) -Schnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="f8b64-112">Finally, the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method creates an enumerator and returns a pointer to its [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) interface.</span></span> <span data-ttu-id="f8b64-113">Sie können die Methoden dieser Schnittstelle aufrufen, um die [**Status propstg**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) -Strukturen für Ihr Objekt aufzulisten, das Informationen zu allen Eigenschaften im aktuellen Eigenschaften Satz bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="f8b64-113">You can call the methods of this interface to enumerate [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures on your object, which will provide information about all of the properties in the current property set.</span></span>

<span data-ttu-id="f8b64-114">Im folgenden finden Sie ein Beispiel für die Darstellung von Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="f8b64-114">The following is an example of how properties are represented.</span></span> <span data-ttu-id="f8b64-115">Wenn eine bestimmte Eigenschaft in einem Eigenschaften Satz den wissenschaftlichen Namen eines Tieres enthält, könnte dieser Name als NULL-terminierte Zeichenfolge gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="f8b64-115">If a specific property in a property set holds an animal's scientific name, that name could be stored as a zero-terminated string.</span></span> <span data-ttu-id="f8b64-116">Zusammen mit dem Namen wird ein Typindikator gespeichert, um anzugeben, dass der Wert eine NULL-terminierte Zeichenfolge ist.</span><span class="sxs-lookup"><span data-stu-id="f8b64-116">Stored along with the name would be a type indicator to indicate that the value is a zero-terminated string.</span></span> <span data-ttu-id="f8b64-117">Diese Eigenschaften können folgende Merkmale aufweisen:</span><span class="sxs-lookup"><span data-stu-id="f8b64-117">These properties might have the following characteristics:</span></span>



| <span data-ttu-id="f8b64-118">Eigenschafts-ID</span><span class="sxs-lookup"><span data-stu-id="f8b64-118">Property ID</span></span> | <span data-ttu-id="f8b64-119">Zeichen folgen Bezeichner</span><span class="sxs-lookup"><span data-stu-id="f8b64-119">String identifier</span></span> | <span data-ttu-id="f8b64-120">Typindikator</span><span class="sxs-lookup"><span data-stu-id="f8b64-120">Type indicator</span></span> | <span data-ttu-id="f8b64-121">Dargestellter Wert</span><span class="sxs-lookup"><span data-stu-id="f8b64-121">Value represented</span></span>              |
|-------------|-------------------|----------------|--------------------------------|
| <span data-ttu-id="f8b64-122">02</span><span class="sxs-lookup"><span data-stu-id="f8b64-122">02</span></span>          | <span data-ttu-id="f8b64-123">PID \_ animalname</span><span class="sxs-lookup"><span data-stu-id="f8b64-123">PID\_ANIMALNAME</span></span>   | <span data-ttu-id="f8b64-124">VT \_ LPWSTR</span><span class="sxs-lookup"><span data-stu-id="f8b64-124">VT\_LPWSTR</span></span>     | <span data-ttu-id="f8b64-125">NULL terminierte Unicode-Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="f8b64-125">Zero-terminated Unicode string</span></span> |
| <span data-ttu-id="f8b64-126">03</span><span class="sxs-lookup"><span data-stu-id="f8b64-126">03</span></span>          | <span data-ttu-id="f8b64-127">PID- \_ legcount</span><span class="sxs-lookup"><span data-stu-id="f8b64-127">PID\_LEGCOUNT</span></span>     | <span data-ttu-id="f8b64-128">VT \_ I2</span><span class="sxs-lookup"><span data-stu-id="f8b64-128">VT\_I2</span></span>         | <span data-ttu-id="f8b64-129">WORD</span><span class="sxs-lookup"><span data-stu-id="f8b64-129">WORD</span></span>                           |



 

<span data-ttu-id="f8b64-130">Jede Anwendung, die das Eigenschafts Satz Format erkennt – identifiziert Sie mithilfe ihrer Format-ID (fmtid) – kann die-Eigenschaft mit dem Bezeichner "PID \_ animalname" untersuchen, feststellen, dass es sich um eine NULL terminierte Zeichenfolge handelt, und den Wert lesen und schreiben.</span><span class="sxs-lookup"><span data-stu-id="f8b64-130">Any application that recognizes the property set format—identifying it through its format identifier (FMTID)—can look at the property with an identifier of PID\_ANIMALNAME, determine that it is a zero-terminated string, and read and write the value.</span></span> <span data-ttu-id="f8b64-131">Obwohl die Anwendung [**IPropertyStorage:: Read Multiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) aufrufen kann, um einen oder alle Eigenschaften Sätze zu lesen (nachdem zunächst ein Zeiger abgerufen wurde), muss die Anwendung wissen, wie der Eigenschaften Satz interpretiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="f8b64-131">Although the application can call [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) to read any or all of a property set (having first obtained a pointer), the application must know how to interpret the property set.</span></span>

<span data-ttu-id="f8b64-132">Ein Eigenschafts Wert wird durch Eigenschaften Schnittstellen als Instanz des [**typpropvariant**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant)-Objekts übermittelt.</span><span class="sxs-lookup"><span data-stu-id="f8b64-132">A property value is passed through property interfaces as an instance of the type [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span></span>

<span data-ttu-id="f8b64-133">Es ist wichtig, zwischen diesen gespeicherten (permanenten) Eigenschaften und Lauf Zeiteigenschaften zu unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="f8b64-133">It is important to distinguish between these stored (persistent) properties, and run-time properties.</span></span> <span data-ttu-id="f8b64-134">Variant-Type-Wert Konstanten haben Namen, die mit VT beginnen \_ .</span><span class="sxs-lookup"><span data-stu-id="f8b64-134">Variant-type value constants have names beginning with VT\_.</span></span> <span data-ttu-id="f8b64-135">Der Satz gültiger PROPVARIANT ist jedoch nicht vollständig gleichwertig mit dem Satz von Varianten, die in Automation-und ActiveX-Steuerelementen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f8b64-135">The set of valid PROPVARIANTs is, however, not entirely equivalent to the set of VARIANTs used in Automation and ActiveX controls.</span></span>

<span data-ttu-id="f8b64-136">Der einzige Unterschied zwischen den beiden-Strukturen ist der zulässige Satz von VT \_ -Tags (Variant Type/VarType) in jedem.</span><span class="sxs-lookup"><span data-stu-id="f8b64-136">The only difference between the two structures is the allowable set of VT\_ (Variant Type / VarType) tags in each.</span></span> <span data-ttu-id="f8b64-137">Wenn ein bestimmter Eigenschaftentyp sowohl in einem Variant-als auch in einem PROPVARIANT-Typ verwendet werden kann, weist das Type-Tag (der VT- \_ Wert) immer einen identischen Wert auf.</span><span class="sxs-lookup"><span data-stu-id="f8b64-137">Where a certain property type can be used in both a VARIANT and a PROPVARIANT, the type tag (the VT\_ value) always has an identical value.</span></span> <span data-ttu-id="f8b64-138">Außerdem ist für einen bestimmten VT \_ -Wert die in-Memory-Darstellung, die in Varianten und propvarianten verwendet wird, identisch.</span><span class="sxs-lookup"><span data-stu-id="f8b64-138">Further, for a given VT\_ value, the in-memory representation used in VARIANTs and PROPVARIANTs is identical.</span></span> <span data-ttu-id="f8b64-139">Diese Vorgehensweise ermöglicht es dem Typsystem, unzulässige typtags abzufangen, während gleichzeitig einem erfahrenen Client ermöglicht wird, ggf. eine Zeiger Umwandlung zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="f8b64-139">Taken all together, this approach allows the type system to catch disallowed type tags, while at the same time allowing a knowledgeable client to implement a pointer cast when appropriate.</span></span>

<span data-ttu-id="f8b64-140">Weitere Informationen finden Sie im folgenden Abschnitt [Überlegungen zum Eigenschaften Speicher](property-storage-considerations.md).</span><span class="sxs-lookup"><span data-stu-id="f8b64-140">For more information, see the following section, [Property Storage Considerations](property-storage-considerations.md).</span></span>

 

 