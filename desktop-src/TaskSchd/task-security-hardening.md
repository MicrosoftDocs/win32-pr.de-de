---
title: Sicherheitshärtung der Aufgabe
description: Mithilfe der Funktion zum Sichern von Tasks können Aufgaben Besitzer ihre Aufgaben mit mindestens erforderlichen Berechtigungen ausführen.
ms.assetid: ba03add5-aa05-4bef-baec-684ca17363bd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ab70679d605a9ad56c6d26116245ae17d41a7a1
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104206778"
---
# <a name="task-security-hardening"></a><span data-ttu-id="7be17-103">Sicherheitshärtung der Aufgabe</span><span class="sxs-lookup"><span data-stu-id="7be17-103">Task Security Hardening</span></span>

<span data-ttu-id="7be17-104">Mithilfe der Funktion zum Sichern von Tasks können Aufgaben Besitzer ihre Aufgaben mit mindestens erforderlichen Berechtigungen ausführen.</span><span class="sxs-lookup"><span data-stu-id="7be17-104">Using the tasks security hardening feature will allow task owners to run their tasks with minimum required privileges.</span></span> <span data-ttu-id="7be17-105">Beachten Sie, dass diese Funktion standardmäßig aktiviert ist und die Aufgaben Besitzer weitere Anpassungen vornehmen können, indem Sie das Array Task Process Token Security Identifier Type und Task required-Berechtigungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="7be17-105">Note that this feature is enabled by default and task owners can make further adjustments by using the task process token security identifier type and task required privileges array.</span></span>

## <a name="task-process-token-sid-type-and-task-required-privileges-array"></a><span data-ttu-id="7be17-106">Task Prozess Token SID-Typ und Task erforderliches Berechtigungs Array</span><span class="sxs-lookup"><span data-stu-id="7be17-106">Task Process Token SID Type and Task Required Privileges Array</span></span>

<span data-ttu-id="7be17-107">Durch die Angabe von **processtokensidtype** auf der Aufgaben Definitions Ebene können Aufgaben Besitzer einen Task Prozess anfordern, der mit dem SID-Typ "None" oder dem "uneingeschränkten" SID-Typ ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="7be17-107">Specifying **ProcessTokenSidType** at the task definition level allows task owners to request a task process to run with the "none" SID type or the "unrestricted" SID type.</span></span> <span data-ttu-id="7be17-108">Wenn das Feld in der Aufgabendefinition vorhanden ist, stellt die Überprüfung sicher, dass die Aufgabe UserID den Namen oder die entsprechende SID-Zeichenfolge für eines der integrierten Dienst Konten des Betriebssystems enthält: "Netzwerkdienst" oder "lokaler Dienst".</span><span class="sxs-lookup"><span data-stu-id="7be17-108">If the field is present in task definition, validation ensures that task UserId contains the name or the corresponding SID string for one of those operating system built-in service accounts: "NETWORK SERVICE" or "LOCAL SERVICE".</span></span>

<span data-ttu-id="7be17-109">Der SID-Typ "None" bedeutet, dass der Task in einem Prozess ausgeführt wird, der keine Prozess Token-sid enthält (es werden keine Änderungen an der Liste der prozesstokengruppen vorgenommen).</span><span class="sxs-lookup"><span data-stu-id="7be17-109">The SID type "none" means that the task runs in a process that does not contain a process token SID (no changes will be made to the process token groups list).</span></span> <span data-ttu-id="7be17-110">Die Task Prinzipal Konto-sid (LocalService/NetworkService) in diesem Fall hat vollen Zugriff auf das Prozess Token.</span><span class="sxs-lookup"><span data-stu-id="7be17-110">The task principal account SID (LocalService/NetworkService) in that case has full access to the process token.</span></span>

<span data-ttu-id="7be17-111">Der "uneingeschränkte" SID-Typ bedeutet, dass eine Task-sid vom vollständigen Aufgaben Pfad abgeleitet wird und der Liste der prozesstokengruppen hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="7be17-111">The "unrestricted" SID type means that a task SID will be derived from the full task path and will be added to the process token groups list.</span></span> <span data-ttu-id="7be17-112">Beispiel: \\ Microsoft \\ Windows \\ RAC \\ RacTask, das im lokalen Dienst Konto ausgeführt wird, wird die Task-sid von dem Namen Microsoft-Windows-RAC-RACTask abgeleitet, wobei ein "-" ein \\ \\ Ungültiges Benutzernamens Zeichen ist.</span><span class="sxs-lookup"><span data-stu-id="7be17-112">For example, the \\Microsoft\\Windows\\RAC\\RACTask which runs in the Local Service account, the task SID is derived from the name Microsoft-Windows-RAC-RACTask where a "-" is substituted for a "\\" since "\\" is an invalid user name character.</span></span> <span data-ttu-id="7be17-113">Der bekannte Gruppenname für die Task-sid wäre "NT Task \\ <modified full task path> " (Domain Name \\ username Format).</span><span class="sxs-lookup"><span data-stu-id="7be17-113">The well known group name for the task SID would be "NT TASK\\<modified full task path>" (domainname\\username format).</span></span> <span data-ttu-id="7be17-114">Die standardmäßige Zugriffs Steuerungs Liste (DACL) des Prozess Tokens wird ebenfalls geändert, um die vollständige Kontrolle über die Task-sid und die SID des lokalen Systems zu ermöglichen, und die Lese Steuerung für die Task Prinzipal Konto-SID.</span><span class="sxs-lookup"><span data-stu-id="7be17-114">The process token default discretionary access control list (DACL) will also be modified to allow full control for the task SID and local system SID only and read control to the task principal account SID.</span></span> <span data-ttu-id="7be17-115">"schtasks.exe/showsid/TN <full task path> " zeigt die Task-SID an, die dem Task entspricht.</span><span class="sxs-lookup"><span data-stu-id="7be17-115">"schtasks.exe /showsid /tn <full task path>" will show the task SID that is corresponding to the task.</span></span>

<span data-ttu-id="7be17-116">Wenn eine nicht-com-Task Aktion gestartet wird, protokolliert die Planungs-Engine das Aufgaben Prinzipal Konto, ruft das Prozess Token ab und fragt die Liste der Berechtigungen ab, die das Token besitzt, und vergleicht dann mit der in "Requirements dprivileges" angegebenen Berechtigungs Liste.</span><span class="sxs-lookup"><span data-stu-id="7be17-116">When a non-COM task action starts up, the scheduling engine logs on the task principal account, gets the process token and queries the list of privileges that the token has and then compares that with the privileges list specified in RequiredPrivileges.</span></span> <span data-ttu-id="7be17-117">Wenn keine Berechtigung in der letzteren angegeben ist, wird diese als "SE- \_ Berechtigung entfernt" markiert \_ .</span><span class="sxs-lookup"><span data-stu-id="7be17-117">If a privilege is not specified in the latter, then that is marked as SE\_PRIVILEGE\_REMOVED.</span></span> <span data-ttu-id="7be17-118">Die ausführbare Aktion wird dann mit dem sich ergebenden Tokenhandle mithilfe der-API von "API" gestartet.</span><span class="sxs-lookup"><span data-stu-id="7be17-118">The executable action will then be started with the resulting token handle by using the CreateProcessAsUser API.</span></span>

<span data-ttu-id="7be17-119">Wenn eine com-Task Aktion gestartet wird, muss Sie durch den taskhost.exe Prozess aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="7be17-119">When a COM task action starts up, it must be activated by the taskhost.exe process.</span></span> <span data-ttu-id="7be17-120">Die Planungs-Engine fragt den Kontext Block der einzelnen laufenden taskhost.exe mit demselben Konto wie die Startaufgabe ab.</span><span class="sxs-lookup"><span data-stu-id="7be17-120">The scheduling engine queries the context block of each running taskhost.exe with the same account as the starting task.</span></span> <span data-ttu-id="7be17-121">Wenn festgestellt wird, dass ein Host Prozess mit einer übergeordneten Menge von Berechtigungen gestartet wurde, die der Start Task benötigt, wird dieser Task in diesem Prozess gehostet.</span><span class="sxs-lookup"><span data-stu-id="7be17-121">If it finds that a host process was started with a superset of privileges that the starting task needs, then that task gets hosted in that process.</span></span> <span data-ttu-id="7be17-122">Wenn ein solcher Prozess nicht gefunden wird, werden die Härtungs Informationen aller Aufgaben, die in den TasksHosts unter dem Aufgaben Prinzipal Konto ausgeführt werden, mit der angegebenen "Requirements dprivileges"-Maske kombiniert und eine neue Instanz von taskhost.exe gestartet.</span><span class="sxs-lookup"><span data-stu-id="7be17-122">If it does not find such a process, it combines the hardening info of all the tasks that are running in the taskhosts under the task principal account with the specified RequiredPrivileges mask and then starts up a new instance of taskhost.exe.</span></span>

<span data-ttu-id="7be17-123">Wenn "Requirements dprivileges" in der Aufgabendefinition nicht vorhanden ist, werden die Standard Berechtigungen des Aufgaben Prinzipal Kontos ohne die "SeImpersonatePrivilege"-Berechtigung für den Task Prozess verwendet.</span><span class="sxs-lookup"><span data-stu-id="7be17-123">If RequiredPrivileges is not present in the task definition, the default privileges of task principal account without the SeImpersonatePrivilege will be used for task process.</span></span> <span data-ttu-id="7be17-124">Wenn **processtokensidtype** in der Aufgabendefinition nicht vorhanden ist, wird "uneingeschränkt" als Standard verwendet.</span><span class="sxs-lookup"><span data-stu-id="7be17-124">If **ProcessTokenSidType** is not present in the task definition, "unrestricted" is used as the default.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7be17-125">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="7be17-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7be17-126">Aufgaben Registrierungsinformationen</span><span class="sxs-lookup"><span data-stu-id="7be17-126">Task Registration Information</span></span>](task-registration-information.md)
</dt> <dt>

[<span data-ttu-id="7be17-127">Informationen zum Taskplaner</span><span class="sxs-lookup"><span data-stu-id="7be17-127">About The Task Scheduler</span></span>](about-the-task-scheduler.md)
</dt> <dt>

[<span data-ttu-id="7be17-128">Sicherheits Kontexte für Tasks</span><span class="sxs-lookup"><span data-stu-id="7be17-128">Security Contexts for Tasks</span></span>](security-contexts-for-running-tasks.md)
</dt> </dl>

 

 




