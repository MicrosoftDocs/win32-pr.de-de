---
title: Verarbeiten der Suchergebnisse
description: Nach dem ersten Aufrufen von IDirectorySearch GetFirstRow oder IDirectorySearch GetNextRow werden entweder die \_ Zeilen "OK", "s" \_ oder "Fehler" \_ \_ zurückgegeben.
ms.assetid: 3a84f394-a256-4815-901c-eaaae3d54b75
ms.tgt_platform: multiple
keywords:
- Die Suchergebnisse werden verarbeitet.
- Active Directory, suchen, Verarbeiten von Suchergebnissen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 732128438162f5ee8f6fe75bb4d2ce53e0d43070
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "106342335"
---
# <a name="processing-the-search-results"></a><span data-ttu-id="9b386-105">Verarbeiten der Suchergebnisse</span><span class="sxs-lookup"><span data-stu-id="9b386-105">Processing the Search Results</span></span>

<span data-ttu-id="9b386-106">Nach dem ersten Aufrufen von [**IDirectorySearch:: GetFirstRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getfirstrow) oder [**IDirectorySearch:: GetNextRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextrow)werden entweder die **\_ \_ \_ Zeilen**" **\_ OK**", "s" oder "Fehler" zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9b386-106">After the first call to [**IDirectorySearch::GetFirstRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getfirstrow) or [**IDirectorySearch::GetNextRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextrow), either **S\_OK**, **S\_ADS\_NOMORE\_ROWS**, or an error result is returned.</span></span>

<span data-ttu-id="9b386-107">Wenn der Rückgabewert **S \_ ADS \_ nomore- \_ Zeilen** ist, wurden keine weiteren Objekte gefunden, die mit dem Filter übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="9b386-107">If the return value is **S\_ADS\_NOMORE\_ROWS**, no more objects matching the filter were found.</span></span> <span data-ttu-id="9b386-108">Wenn ein Fehler Ergebnis zurückgegeben wird, ist die Abfrage fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="9b386-108">If an error result is returned, the query failed.</span></span> <span data-ttu-id="9b386-109">In beiden Fällen ist es nicht erforderlich, die Zeilen im Ergebnis zu verarbeiten, da nichts zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="9b386-109">In both cases, you are not required to process the rows in the result because nothing was returned.</span></span>

<span data-ttu-id="9b386-110">Wenn **S \_ OK** zurückgegeben wird, wurde eine Zeile abgerufen.</span><span class="sxs-lookup"><span data-stu-id="9b386-110">If **S\_OK** is returned, a row has been retrieved.</span></span> <span data-ttu-id="9b386-111">Sie können die Spalten nach Namen mithilfe von [**idirector ysearch:: GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn)analysieren.</span><span class="sxs-lookup"><span data-stu-id="9b386-111">You can parse the columns by name using [**IDirectorySearch::GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn).</span></span> <span data-ttu-id="9b386-112">Der Name ist der **ldapDisplayName** des Attributs in der Spalte.</span><span class="sxs-lookup"><span data-stu-id="9b386-112">The name is the **lDAPDisplayName** of the attribute in the column.</span></span> <span data-ttu-id="9b386-113">Der Satz aller Spalten wurde durch den pattributenames-Parameter der [**IDirectorySearch:: ExecuteSearch**](/windows/desktop/api/iads/nf-iads-idirectorysearch-executesearch) -Methode definiert.</span><span class="sxs-lookup"><span data-stu-id="9b386-113">The set of all columns was defined by the pAttributeNames parameter of the [**IDirectorySearch::ExecuteSearch**](/windows/desktop/api/iads/nf-iads-idirectorysearch-executesearch) method.</span></span> <span data-ttu-id="9b386-114">Wenn **null** angegeben wurde, ist der Satz aller Spalten die Vereinigung aller Eigenschaften, die für alle zurückgegebenen Objekte gefunden wurden.</span><span class="sxs-lookup"><span data-stu-id="9b386-114">If **NULL** was specified, the set of all columns is the union of all properties found for all the objects returned.</span></span> <span data-ttu-id="9b386-115">Um die gesamte Gruppe von Spalten zu lesen, die für ein Objekt zurückgegeben werden, verwenden Sie [**IDirectorySearch:: getnextcolumnname**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextcolumnname) , um die einzelnen Spalten zu durchlaufen, und verwenden Sie den zurückgegebenen Spaltennamen, um **IDirectorySearch:: GetColumn** aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="9b386-115">To read the entire set of columns returned for an object, use the [**IDirectorySearch::GetNextColumnName**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextcolumnname) to iterate each column, and use the column name returned to call **IDirectorySearch::GetColumn**.</span></span>

<span data-ttu-id="9b386-116">Die [**IDirectorySearch:: GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn) -Methode gibt eine [**ADS- \_ Such \_ Spalten**](/windows/desktop/api/iads/ns-iads-ads_search_column) Struktur zurück, die den Attributnamen, den Typ des Attributs, die Anzahl der Werte und einen Zeiger auf ein Array von [**ADSVALUE**](/windows/desktop/api/iads/ns-iads-adsvalue) -Strukturen enthält, die die Werte enthalten.</span><span class="sxs-lookup"><span data-stu-id="9b386-116">The [**IDirectorySearch::GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn) method returns an [**ADS\_SEARCH\_COLUMN**](/windows/desktop/api/iads/ns-iads-ads_search_column) structure that contains the attribute name, the type of the attribute, count of values, and a pointer to an array of [**ADSVALUE**](/windows/desktop/api/iads/ns-iads-adsvalue) structures that contain the values.</span></span> <span data-ttu-id="9b386-117">Sie können die **ADSVALUE** -Strukturen durchlaufen, um die Werte für die von der Spalte zurückgegebene Eigenschaft zu lesen.</span><span class="sxs-lookup"><span data-stu-id="9b386-117">You can loop through the **ADSVALUE** structures to read the values for the property returned by the column.</span></span> <span data-ttu-id="9b386-118">Sie müssen den entsprechenden Member der **ADSVALUE** -Struktur basierend auf dem vom **dwadstype** -Member der **ADS- \_ Such \_ Spalten** Struktur angegebenen [**adstype**](/windows/win32/api/iads/ne-iads-adstypeenum) lesen (oder dem **dwType** -Member der **ADSVALUE** -Struktur).</span><span class="sxs-lookup"><span data-stu-id="9b386-118">You must read the appropriate member of the **ADSVALUE** structure based on the [**ADSTYPE**](/windows/win32/api/iads/ne-iads-adstypeenum) specified by the **dwADsType** member of the **ADS\_SEARCH\_COLUMN** structure (or the **dwType** member of the **ADSVALUE** structure).</span></span> <span data-ttu-id="9b386-119">Wenn **dwadstype** beispielsweise eine **adstype- \_ Ganzzahl** ist, würden Sie das **ganzzahlige** Element jeder **ADSVALUE** -Struktur lesen.</span><span class="sxs-lookup"><span data-stu-id="9b386-119">For example, if **dwADsType** was **ADSTYPE\_INTEGER**, you would read the **Integer** member of each **ADSVALUE** structure.</span></span>

<span data-ttu-id="9b386-120">Weitere Informationen und ein Codebeispiel finden Sie unter [Beispielcode für die Suche nach Benutzern](example-code-for-searching-for-users.md).</span><span class="sxs-lookup"><span data-stu-id="9b386-120">For more information and a code example, see [Example Code for Searching for Users](example-code-for-searching-for-users.md).</span></span>

 

 