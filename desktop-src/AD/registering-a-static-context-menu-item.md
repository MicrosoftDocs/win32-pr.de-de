---
title: Registrieren eines statischen Kontextmenü Elements
description: In diesem Thema wird beschrieben, wie ein statisches Kontextmenü Element registriert wird, das für Active Directory Objekte
ms.assetid: ed945812-3adb-4058-bdb6-8d9d34468265
ms.tgt_platform: multiple
keywords:
- Registrieren eines statischen Kontextmenü Elements AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 89e3ee5336061ca296e2c94f8907ebd385610494
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "106338655"
---
# <a name="registering-a-static-context-menu-item"></a><span data-ttu-id="06a51-104">Registrieren eines statischen Kontextmenü Elements</span><span class="sxs-lookup"><span data-stu-id="06a51-104">Registering a Static Context Menu Item</span></span>

<span data-ttu-id="06a51-105">Die MMC-Snap-Ins "Verwaltung" von Active Directory Domain Services und der Windows-Shell bieten einen Mechanismus zum Hinzufügen eines Elements zum Kontextmenü, das für Objekte in Active Directory Domain Services angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="06a51-105">The administrative MMC snap-ins of Active Directory Domain Services and the Windows shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.</span></span> <span data-ttu-id="06a51-106">Das Kontextmenü kann eine beliebige Datei aufrufen, die mit der [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) -API gestartet werden kann, z. b. eine Anwendungs-oder Webseiten-URL.</span><span class="sxs-lookup"><span data-stu-id="06a51-106">The context menu can invoke any file that can be started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="06a51-107">Registrieren bei Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="06a51-107">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="06a51-108">Die Registrierung der Kontextmenüerweiterung ist spezifisch für ein Gebiets Schema.</span><span class="sxs-lookup"><span data-stu-id="06a51-108">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="06a51-109">Wenn die Kontextmenüerweiterung auf alle Gebiets Schemas angewendet wird, muss Sie in allen Gebiets Schema-subcontainern im Container "Display Specifiers" im Objektklasse " [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) " registriert werden.</span><span class="sxs-lookup"><span data-stu-id="06a51-109">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="06a51-110">Wenn die Kontextmenüerweiterung für ein bestimmtes Gebiets Schema lokalisiert wird, muss Sie im **displaySpecifier** -Objekt in diesem Gebiets Schema-unter Container registriert werden.</span><span class="sxs-lookup"><span data-stu-id="06a51-110">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale subcontainer.</span></span> <span data-ttu-id="06a51-111">Weitere Informationen über die Anzeige spezifischere Container und Gebiets Schemas finden Sie unter [Anzeigen von Bezeichner](display-specifiers.md) und [displaySpecifier-Containern](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="06a51-111">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="06a51-112">Es gibt zwei anzeigespezifiziererattribute, unter denen ein statisches Kontextmenü Element unter, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) und [**shellcontextmenu**](/windows/desktop/ADSchema/a-shellcontextmenu)registriert werden kann.</span><span class="sxs-lookup"><span data-stu-id="06a51-112">There are two display specifier attributes that a static context menu item can be registered under, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="06a51-113">Das [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) -Attribut identifiziert Verwaltungs Kontextmenüs, die in den administrativen Snap-Ins Active Directory Domain Services angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="06a51-113">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in the administrative snap-ins of Active Directory Domain Services.</span></span> <span data-ttu-id="06a51-114">Das Kontextmenü wird angezeigt, wenn der Benutzer das Kontextmenü für Objekte der entsprechenden Klasse in einem der MMC-Snap-Ins "Verwaltung" anzeigt.</span><span class="sxs-lookup"><span data-stu-id="06a51-114">The context menu appears when the user displays the context menu for objects of the appropriate class in one of the administrative MMC snap-ins.</span></span>

<span data-ttu-id="06a51-115">Das [**shellcontextmenu**](/windows/desktop/ADSchema/a-shellcontextmenu) -Attribut identifiziert Endbenutzer-Kontextmenüs, die in der Windows-Shell angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="06a51-115">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="06a51-116">Das Kontextmenü wird angezeigt, wenn der Benutzer das Kontextmenü für Objekte der entsprechenden Klasse im Windows-Explorer anzeigt.</span><span class="sxs-lookup"><span data-stu-id="06a51-116">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="06a51-117">Ab Windows Server 2003 werden von der Windows-Shell keine Objekte mehr aus Active Directory Domain Services angezeigt.</span><span class="sxs-lookup"><span data-stu-id="06a51-117">Beginning with Windows Server 2003, the Windows shell no longer displays objects that are from Active Directory Domain Services.</span></span>

<span data-ttu-id="06a51-118">Alle diese Attribute sind mehr wertig.</span><span class="sxs-lookup"><span data-stu-id="06a51-118">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="06a51-119">Wenn Sie ein statisches Kontextmenü Element registrieren, benötigen die Werte für die Attribute " [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) " und " [**shellcontextmenu**](/windows/desktop/ADSchema/a-shellcontextmenu) " das folgende Format.</span><span class="sxs-lookup"><span data-stu-id="06a51-119">When registering a static context menu item, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<menu text>,<command>
```



<span data-ttu-id="06a51-120">" &lt; Order Number &gt; " ist eine nicht signierte Zahl, die die Position des Elements im Kontextmenü darstellt.</span><span class="sxs-lookup"><span data-stu-id="06a51-120">The "&lt;order number&gt;" is an unsigned number that represents the item's position in the context menu.</span></span> <span data-ttu-id="06a51-121">Wenn ein Kontextmenü angezeigt wird, werden die Werte mithilfe eines Vergleichs der "Order Number"-Werte der einzelnen Werte sortiert &lt; &gt; .</span><span class="sxs-lookup"><span data-stu-id="06a51-121">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="06a51-122">Wenn mehr als ein Wert dieselbe " &lt; Bestellnummer" aufweist &gt; , werden diese Kontextmenü Erweiterungen in der Reihenfolge geladen, in der Sie vom Active Directory Server gelesen werden.</span><span class="sxs-lookup"><span data-stu-id="06a51-122">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="06a51-123">Verwenden Sie nach Möglichkeit eine nicht vorhandene " &lt; Bestellnummer &gt; ", d. h. eine, die nicht von anderen Werten in der-Eigenschaft verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="06a51-123">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="06a51-124">Es gibt keine vorgeschriebene Anfangsposition, und Lücken sind in der Sequenz " &lt; Order Number &gt; " zulässig.</span><span class="sxs-lookup"><span data-stu-id="06a51-124">There is no prescribed starting position, and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="06a51-125">Der " &lt; Menütext &gt; " ist die Zeichenfolge, die im Kontextmenü angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="06a51-125">The "&lt;menu text&gt;" is the string displayed in the context menu.</span></span> <span data-ttu-id="06a51-126">Der " &lt; Menütext &gt; " kann ein "&"-Zeichen enthalten, das dem Tastenkombinationen für das Menü Element vorangestellt ist.</span><span class="sxs-lookup"><span data-stu-id="06a51-126">The "&lt;menu text&gt;" can include one "&" character that precedes the keyboard shortcut character for the menu item.</span></span> <span data-ttu-id="06a51-127">Dadurch wird das vorangegangene Zeichen unterstrichen.</span><span class="sxs-lookup"><span data-stu-id="06a51-127">This will cause the preceded character to be underlined.</span></span> <span data-ttu-id="06a51-128">Wenn z. b. der " &lt; Menütext" " &gt; &Datei" ist, wird der Menütext als "file" angezeigt, das "f" wird unterstrichen, und "f" ist die Tastenkombination für das Menü Element.</span><span class="sxs-lookup"><span data-stu-id="06a51-128">For example, if the "&lt;menu text&gt;" is "&File", the menu text will be displayed as "File", the "F" will be underlined and "F" will be the keyboard shortcut for the menu item.</span></span>

<span data-ttu-id="06a51-129">Der &lt; Befehl "Command &gt; " ist das Programm oder die Datei, die vom Snap-in ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="06a51-129">The "&lt;command&gt;" is the program or file executed by the snap-in.</span></span> <span data-ttu-id="06a51-130">Entweder muss der vollständige Pfad angegeben werden, oder die Datei muss in der Computer Pfad-Umgebungsvariablen vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="06a51-130">Either the full path must be specified or the file must exist in the computer path environment variable.</span></span> <span data-ttu-id="06a51-131">Die Datei wird mit der [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) -Funktion aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="06a51-131">The file is invoked using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) function.</span></span> <span data-ttu-id="06a51-132">Der &lt; Befehl "Command &gt; " kann keine zusätzlichen Parameter enthalten, z. b. Notepad.exe Myfile.txt.</span><span class="sxs-lookup"><span data-stu-id="06a51-132">The "&lt;command&gt;" cannot contain additional parameters, for example, Notepad.exe Myfile.txt.</span></span> <span data-ttu-id="06a51-133">Da **ShellExecute** verwendet wird, können alle Dateien oder Adressen, die an **ShellExecute** übermittelt werden können, für " &lt; Command" verwendet werden &gt; .</span><span class="sxs-lookup"><span data-stu-id="06a51-133">Because **ShellExecute** is used, any file or address that can be passed to **ShellExecute** can be used for "&lt;command&gt;".</span></span> <span data-ttu-id="06a51-134">Wenn "Command" z. b. &lt; &gt; "d: \\file.txt" enthält, wird "d: \\file.txt" mit der Anwendung geöffnet, die mit der Erweiterung ". txt" verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="06a51-134">For example, if "&lt;command&gt;" contains "d:\\file.txt", d:\\file.txt will be opened with the application associated with the .txt extension.</span></span> <span data-ttu-id="06a51-135">Wenn " &lt; Command &gt; " "" enthält https://www.fabrikam.com , wird auch der Standard Webbrowser geöffnet, und die angegebene Webseite wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="06a51-135">Likewise, if "&lt;command&gt;" contains "https://www.fabrikam.com", the default web browser is opened and will display the specified webpage.</span></span> <span data-ttu-id="06a51-136">Pfade und Anwendungsnamen mit Leerzeichen sind zulässig.</span><span class="sxs-lookup"><span data-stu-id="06a51-136">Paths and application names with spaces are allowed.</span></span> <span data-ttu-id="06a51-137">Wenn " &lt; Command &gt; " eine Anwendung ist, werden der ADsPath und die Klasse des ausgewählten Objekts als Befehlszeilenargumente, getrennt durch ein Leerzeichen, übermittelt.</span><span class="sxs-lookup"><span data-stu-id="06a51-137">If "&lt;command&gt;" is an application, the selected object's ADsPath and class are passed as command line arguments, separated by a space.</span></span>

<span data-ttu-id="06a51-138">In der Windows-Shell werden Kontextmenü Elemente mit Mehrfachauswahl unterstützt.</span><span class="sxs-lookup"><span data-stu-id="06a51-138">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="06a51-139">In diesem Fall &lt; &gt; wird für jedes ausgewählte Objekt der Befehl "Command" aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="06a51-139">In this case, the "&lt;command&gt;" is invoked for each selected object.</span></span> <span data-ttu-id="06a51-140">In Active Directory Domain Services ' Administrative Snap-Ins ' werden statische Kontextmenü Elemente mit Mehrfachauswahl nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="06a51-140">In Active Directory Domain Services' administrative snap-ins, multiple-selection static context menu items are not supported.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="06a51-141">Bei der Windows-Shell werden Anzeige spezifiziererdaten bei der Benutzeranmeldung abgerufen und für die Benutzersitzung zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="06a51-141">For the Windows shell, display specifier data is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="06a51-142">Bei den administrativen Snap-Ins werden die Anzeige spezifiziererdaten abgerufen, wenn das Snap-In geladen und für die Dauer des Prozesses zwischengespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="06a51-142">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="06a51-143">Bei der Windows-Shell bedeutet dies, dass Änderungen an Anzeige spezifiken wirksam werden, nachdem sich ein Benutzer ab-und wieder anmeldet.</span><span class="sxs-lookup"><span data-stu-id="06a51-143">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="06a51-144">Bei den administrativen Snap-Ins werden die Änderungen wirksam, wenn das Snap-in oder die Konsolen Datei erneut geladen wird. Das heißt, wenn Sie eine neue Instanz der Konsolen Datei oder eine neue Mmc.exe Instanz starten und das Snap-in hinzufügen, wird die aktuelle Anzeige spezifiziererdaten abgerufen.</span><span class="sxs-lookup"><span data-stu-id="06a51-144">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded; that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="06a51-145">Weitere Informationen und ein Codebeispiel finden Sie unter [Beispielcode für die Installation eines statischen Kontextmenü Elements](example-code-for-installing-a-static-context-menu-item.md).</span><span class="sxs-lookup"><span data-stu-id="06a51-145">For more information, and a code example, see [Example Code for Installing a Static Context Menu Item](example-code-for-installing-a-static-context-menu-item.md).</span></span>

 

 