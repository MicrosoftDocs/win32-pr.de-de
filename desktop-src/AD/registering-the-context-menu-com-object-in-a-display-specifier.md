---
title: Registrieren des Kontextmenü-com-Objekts in einem Anzeigespezifizierer
description: In diesem Thema werden die Registrierungsschlüssel erläutert, die zum Registrieren eines COM-Objekts für das Kontextmenü geändert werden müssen.
ms.assetid: 389bc249-4849-4763-9d1b-b35598a51050
ms.tgt_platform: multiple
keywords:
- Registrieren des Kontextmenü-com-Objekts in einem Anzeigespezifizierer
- Kontextmenü-com-Objekt AD, registrieren
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 62ae30c1a60a1a0bc5a8ec388a3578ab13829c95
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "104038737"
---
# <a name="registering-the-context-menu-com-object-in-a-display-specifier"></a><span data-ttu-id="15227-105">Registrieren des Kontextmenü-com-Objekts in einem Anzeigespezifizierer</span><span class="sxs-lookup"><span data-stu-id="15227-105">Registering the Context Menu COM Object in a Display Specifier</span></span>

<span data-ttu-id="15227-106">Wenn Sie com zum Erstellen einer Kontextmenü-Erweiterungs-DLL für einen Active Directory Verzeichnisdienst verwenden, muss die Erweiterung bei der Windows-Registrierung registriert und Active Directory Domain Services werden, um die Active Directory Verwaltungs-MMC-Snap-Ins und die Windows-Shell der Erweiterung zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="15227-106">When you use COM to create a context menu extension DLL for an Active Directory directory service, the extension must be registered with the Windows registry and Active Directory Domain Services to notify the Active Directory administrative MMC snap-ins and the Windows shell of the extension.</span></span>

## <a name="registering-in-the-windows-registry"></a><span data-ttu-id="15227-107">Registrieren in der Windows-Registrierung</span><span class="sxs-lookup"><span data-stu-id="15227-107">Registering in the Windows Registry</span></span>

<span data-ttu-id="15227-108">Wie alle com-Server muss eine Kontextmenüerweiterung in der Registrierung registriert werden.</span><span class="sxs-lookup"><span data-stu-id="15227-108">Like all COM servers, a context menu extension must be registered in the registry.</span></span> <span data-ttu-id="15227-109">Die Erweiterung wird unter dem folgenden Schlüssel registriert.</span><span class="sxs-lookup"><span data-stu-id="15227-109">The extension is registered under the following key.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      <clsid>
```

<span data-ttu-id="15227-110">*<clsid>* die Zeichen folgen Darstellung der CLSID, die von der [**stringfromclsid**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) -Funktion erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="15227-110">*<clsid>* is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span> <span data-ttu-id="15227-111">Unter dem *<clsid>* Schlüssel gibt es einen **InProcServer32** -Schlüssel, der das-Objekt als 32-Bit-in-proc-Server identifiziert.</span><span class="sxs-lookup"><span data-stu-id="15227-111">Under the *<clsid>* key, there is an **InProcServer32** key that identifies the object as a 32-bit in-proc server.</span></span> <span data-ttu-id="15227-112">Unter der **InProcServer32** -Taste wird der Speicherort der dll im Standardwert angegeben, und das Threading Modell wird im **ThreadingModel** -Wert angegeben.</span><span class="sxs-lookup"><span data-stu-id="15227-112">Under the **InProcServer32** key, the location of the DLL is specified in the default value and the threading model is specified in the **ThreadingModel** value.</span></span> <span data-ttu-id="15227-113">Alle Kontextmenü Erweiterungen müssen das Threading Modell "Apartment" verwenden.</span><span class="sxs-lookup"><span data-stu-id="15227-113">All context menu extension must use the "Apartment" threading model.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="15227-114">Registrieren bei Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="15227-114">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="15227-115">Die Registrierung der Kontextmenüerweiterung ist spezifisch für ein Gebiets Schema.</span><span class="sxs-lookup"><span data-stu-id="15227-115">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="15227-116">Wenn die Kontextmenüerweiterung auf alle Gebiets Schemas angewendet wird, muss Sie in allen Gebiets Schema-subcontainern im Container "Display Specifiers" im Objektklasse " [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) " registriert werden.</span><span class="sxs-lookup"><span data-stu-id="15227-116">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="15227-117">Wenn die Kontextmenüerweiterung für ein bestimmtes Gebiets Schema lokalisiert wird, muss Sie im **displaySpecifier** -Objekt im unter Container dieses Gebiets Schemas registriert werden.</span><span class="sxs-lookup"><span data-stu-id="15227-117">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale's subcontainer.</span></span> <span data-ttu-id="15227-118">Weitere Informationen über die Anzeige spezifischere Container und Gebiets Schemas finden Sie unter [Anzeigen von Bezeichner](display-specifiers.md) und [displaySpecifier-Containern](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="15227-118">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="15227-119">Es gibt zwei anzeigespezifiziererattribute, unter denen ein Kontextmenü-Erweiterungs Element registriert werden kann.</span><span class="sxs-lookup"><span data-stu-id="15227-119">There are two display specifier attributes that a context menu extension item can be registered under.</span></span> <span data-ttu-id="15227-120">Dies sind " [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) " und " [**shellcontextmenu**](/windows/desktop/ADSchema/a-shellcontextmenu)".</span><span class="sxs-lookup"><span data-stu-id="15227-120">These are [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="15227-121">Das [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) -Attribut identifiziert Verwaltungs Kontextmenüs, die in Active Directory administrativen Snap-Ins angezeigt werden. Das Kontextmenü wird angezeigt, wenn der Benutzer das Kontextmenü für Objekte der entsprechenden Klasse in einem der Active Directory-Verwaltungs-MMC-Snap-Ins anzeigt.</span><span class="sxs-lookup"><span data-stu-id="15227-121">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in Active Directory administrative snap-ins. The context menu appears when the user displays the context menu for objects of the appropriate class in one of the Active Directory administrative MMC snap-ins.</span></span>

<span data-ttu-id="15227-122">Das [**shellcontextmenu**](/windows/desktop/ADSchema/a-shellcontextmenu) -Attribut identifiziert Endbenutzer-Kontextmenüs, die in der Windows-Shell angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="15227-122">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="15227-123">Das Kontextmenü wird angezeigt, wenn der Benutzer das Kontextmenü für Objekte der entsprechenden Klasse im Windows-Explorer anzeigt.</span><span class="sxs-lookup"><span data-stu-id="15227-123">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="15227-124">Ab Windows Server 2003 zeigt die Windows-Shell keine Objekte Active Directory Domain Services mehr an.</span><span class="sxs-lookup"><span data-stu-id="15227-124">Beginning with Windows Server 2003, the Windows shell no longer displays objects of Active Directory Domain Services.</span></span>

<span data-ttu-id="15227-125">Alle diese Attribute sind mehr wertig.</span><span class="sxs-lookup"><span data-stu-id="15227-125">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="15227-126">Beim Registrieren einer Kontextmenüerweiterung benötigen die Werte für die Attribute " [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) " und " [**shellcontextmenu**](/windows/desktop/ADSchema/a-shellcontextmenu) " das folgende Format.</span><span class="sxs-lookup"><span data-stu-id="15227-126">When registering a context menu extension, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<clsid>
```



<span data-ttu-id="15227-127">" &lt; Order Number &gt; " ist eine nicht signierte Zahl, die die Position des Elements im Kontextmenü darstellt.</span><span class="sxs-lookup"><span data-stu-id="15227-127">The "&lt;order number&gt;" is an unsigned number that represents the item position in the context menu.</span></span> <span data-ttu-id="15227-128">Wenn ein Kontextmenü angezeigt wird, werden die Werte mithilfe eines Vergleichs der "Order Number"-Werte der einzelnen Werte sortiert &lt; &gt; .</span><span class="sxs-lookup"><span data-stu-id="15227-128">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="15227-129">Wenn mehr als ein Wert dieselbe " &lt; Bestellnummer" aufweist &gt; , werden diese Kontextmenü Erweiterungen in der Reihenfolge geladen, in der Sie vom Active Directory Server gelesen werden.</span><span class="sxs-lookup"><span data-stu-id="15227-129">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="15227-130">Verwenden Sie nach Möglichkeit eine nicht vorhandene " &lt; Bestellnummer &gt; ", d. h. eine, die nicht von anderen Werten in der-Eigenschaft verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="15227-130">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="15227-131">In der &lt; Sequenz "Order Number" sind keine vorgeschriebenen Startpositionen und Lücken zulässig &gt; .</span><span class="sxs-lookup"><span data-stu-id="15227-131">There is no prescribed starting position and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="15227-132">Die " &lt; CLSID &gt; " ist die Zeichen folgen Darstellung der CLSID, die von der [**stringfromclsid**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) -Funktion erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="15227-132">The "&lt;clsid&gt;" is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>

<span data-ttu-id="15227-133">In der Windows-Shell werden Kontextmenü Elemente mit Mehrfachauswahl unterstützt.</span><span class="sxs-lookup"><span data-stu-id="15227-133">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="15227-134">In diesem Fall wird die Kontextmenüerweiterung für jedes ausgewählte Objekt aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="15227-134">In this case, the context menu extension is invoked for each selected object.</span></span> <span data-ttu-id="15227-135">In Active Directory administrativen Snap-Ins werden auch Mehrfachauswahl-Kontextmenü Erweiterungs Elemente unterstützt.</span><span class="sxs-lookup"><span data-stu-id="15227-135">In Active Directory administrative snap-ins, multiple-selection context menu extension items are also supported.</span></span> <span data-ttu-id="15227-136">In diesem Fall enthält die [**dsobjectnames**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) -Struktur für jedes ausgewählte Verzeichnis Objekt eine [**dsobject**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="15227-136">In this case, the [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) structure will contain a [**DSOBJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structure for each directory object selected.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="15227-137">Bei der Windows-Shell werden Anzeige spezifiziererinformationen bei der Benutzeranmeldung abgerufen und für die Benutzersitzung zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="15227-137">For the Windows shell, display specifier information is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="15227-138">Bei den administrativen Snap-Ins werden die Anzeige spezifiziererdaten abgerufen, wenn das Snap-In geladen und für die Dauer des Prozesses zwischengespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="15227-138">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="15227-139">Bei der Windows-Shell bedeutet dies, dass Änderungen an Anzeige spezifiken wirksam werden, nachdem sich ein Benutzer ab-und wieder anmeldet.</span><span class="sxs-lookup"><span data-stu-id="15227-139">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="15227-140">Bei den administrativen Snap-Ins werden die Änderungen wirksam, wenn das Snap-in oder die Konsolen Datei erneut geladen wird. das heißt, wenn Sie eine neue Instanz der Konsolen Datei oder eine neue Mmc.exe Instanz starten und das Snap-in hinzufügen, werden die aktuellen anzeigespezifiziererdaten abgerufen.</span><span class="sxs-lookup"><span data-stu-id="15227-140">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded, that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="15227-141">Weitere Informationen und ein Codebeispiel für die Implementierung einer Kontextmenüerweiterung finden Sie unter [Beispielcode für die Implementierung des Kontextmenü-com-Objekts](example-code-for-implementation-of-the-context-menu-com-object.md).</span><span class="sxs-lookup"><span data-stu-id="15227-141">For more information, and a code example of how to implement a context menu extension, see [Example Code for Implementation of the Context Menu COM Object](example-code-for-implementation-of-the-context-menu-com-object.md).</span></span>

 

 