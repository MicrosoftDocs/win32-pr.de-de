---
title: Debuggen einer Active Directory-Erweiterung
description: Die in diesem Thema dokumentierten Erweiterungen für das Microsoft Active Directory Directory-Dienst-Eigenschaften Blatt, das Kontextmenü und den Objekterstellungs-Assistenten werden als com-in-proc-Server implementiert.
ms.assetid: 8c280084-fd2f-4d34-a119-d4e925a68a5c
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fc8d9646f4ccc2e8c740a81ddb48422881744f5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "104038776"
---
# <a name="debugging-an-active-directory-extension"></a><span data-ttu-id="fba0b-103">Debuggen einer Active Directory-Erweiterung</span><span class="sxs-lookup"><span data-stu-id="fba0b-103">Debugging an Active Directory Extension</span></span>

<span data-ttu-id="fba0b-104">Die in diesem Thema dokumentierten Erweiterungen für das Microsoft Active Directory Directory-Dienst-Eigenschaften Blatt, das Kontextmenü und den Objekterstellungs-Assistenten werden als com-in-proc-Server implementiert.</span><span class="sxs-lookup"><span data-stu-id="fba0b-104">The Microsoft Active Directory directory service property sheet, context menu, and object creation wizard extensions documented in this topic are implemented as COM in-proc servers.</span></span> <span data-ttu-id="fba0b-105">Das heißt, jede Erweiterung ist eine DLL, die im Kontext des Host Prozesses ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="fba0b-105">That is, each extension is a DLL that runs in the context of the host process.</span></span> <span data-ttu-id="fba0b-106">Um die Erweiterung zu debuggen, ist es erforderlich, die Erweiterung einer Anwendung zuzuordnen und die Anwendung in einem Debugger auszuführen.</span><span class="sxs-lookup"><span data-stu-id="fba0b-106">To debug the extension, it is necessary to associate the extension with an application and run the application in a debugger.</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-windows-shell"></a><span data-ttu-id="fba0b-107">Debuggen Active Directory in der Windows-Shell angezeigten Erweiterungen</span><span class="sxs-lookup"><span data-stu-id="fba0b-107">Debugging Active Directory Extensions Displayed in the Windows Shell</span></span>

<span data-ttu-id="fba0b-108">Active Directory Erweiterungen, die in der Windows-Shell angezeigt werden, werden im Kontext des Explorer.exe Prozesses geladen.</span><span class="sxs-lookup"><span data-stu-id="fba0b-108">Active Directory extensions displayed in the Windows shell are loaded in the context of the Explorer.exe process.</span></span> <span data-ttu-id="fba0b-109">Diese Erweiterungen können wie eine standardshellerweiterung deentschlbelt werden.</span><span class="sxs-lookup"><span data-stu-id="fba0b-109">These extensions can be debugged like a standard shell extension.</span></span> <span data-ttu-id="fba0b-110">Weitere Informationen zum Debuggen von Shellerweiterungen finden Sie unter [Debuggen mit der Shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="fba0b-110">For more information about debugging shell extensions, see [Debugging with the Shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-active-directory-mmc-snap-ins"></a><span data-ttu-id="fba0b-111">Debuggen Active Directory Erweiterungen, die im Active Directory MMC angezeigt werden Snap-Ins</span><span class="sxs-lookup"><span data-stu-id="fba0b-111">Debugging Active Directory Extensions Displayed in the Active Directory MMC Snap-Ins</span></span>

<span data-ttu-id="fba0b-112">Active Directory Erweiterungen, die im Active Directory Verwaltungs-MMC-Snap-Ins angezeigt werden, werden im Kontext der Microsoft Management Console geladen.</span><span class="sxs-lookup"><span data-stu-id="fba0b-112">Active Directory extensions displayed in the Active Directory administrative MMC snap-ins are loaded in the context of the Microsoft Management Console.</span></span> <span data-ttu-id="fba0b-113">Um eine Erweiterung zu debuggen, suchen Sie Mmc.exe auf dem lokalen System, und legen Sie fest, dass der Debugger diese als Anwendung für das Debugging verwendet.</span><span class="sxs-lookup"><span data-stu-id="fba0b-113">To debug an extension, locate Mmc.exe on the local system and set the debugger to use this as the application for debugging.</span></span> <span data-ttu-id="fba0b-114">Auf den meisten Systemen befindet sich Mmc.exe im Windows-System Verzeichnis, z. b. "C: \\ Winnt \\ system32".</span><span class="sxs-lookup"><span data-stu-id="fba0b-114">On most systems, Mmc.exe is located in the Windows system directory, for example, C:\\WINNT\\System32.</span></span> <span data-ttu-id="fba0b-115">Abhängig vom Debugger müssen Sie die Erweiterungs-DLL möglicherweise so festlegen, dass Sie auch vom Debugger geladen wird.</span><span class="sxs-lookup"><span data-stu-id="fba0b-115">Depending on the debugger, you may or may not have to set the extension DLL to also be loaded by the debugger.</span></span> <span data-ttu-id="fba0b-116">Viele Debugger ermöglichen auch das Anfügen des Debugger an einen laufenden MMC-Prozess.</span><span class="sxs-lookup"><span data-stu-id="fba0b-116">Many debuggers also allow you to attach the debugger to a running MMC process.</span></span> <span data-ttu-id="fba0b-117">Weitere Informationen finden Sie im Benutzerhandbuch für den Debugger.</span><span class="sxs-lookup"><span data-stu-id="fba0b-117">For more information, see your debugger User's Guide.</span></span>

<span data-ttu-id="fba0b-118">Es kann praktisch sein, dass die MMC ein bestimmtes Snap-in automatisch lädt.</span><span class="sxs-lookup"><span data-stu-id="fba0b-118">It can be convenient to have MMC automatically load a specific snap-in.</span></span> <span data-ttu-id="fba0b-119">Legen Sie zu diesem Zweck die Anwendungs Argumente auf den Pfad und den Dateinamen einer MSC-Datei fest.</span><span class="sxs-lookup"><span data-stu-id="fba0b-119">To do this, set the application arguments to the path and file name of an MSC file.</span></span> <span data-ttu-id="fba0b-120">Dabei kann es sich entweder um eine vom System installierte MSC-Datei oder eine von Ihnen erstellte Datei handeln.</span><span class="sxs-lookup"><span data-stu-id="fba0b-120">This can either be a system-installed MSC file or one you create.</span></span> <span data-ttu-id="fba0b-121">Eine MSC-Datei kann erstellt werden, indem Sie die folgenden Schritte ausführen.</span><span class="sxs-lookup"><span data-stu-id="fba0b-121">An MSC file can be created by following these steps.</span></span>

1.  <span data-ttu-id="fba0b-122">Führen Sie Mmc.exe aus.</span><span class="sxs-lookup"><span data-stu-id="fba0b-122">Run Mmc.exe.</span></span>
2.  <span data-ttu-id="fba0b-123">Laden Sie das gewünschte Snap-in, indem Sie  -  im MMC-Menü Datei auf **Snap-in hinzufügen/entfernen** auswählen, und wählen Sie das gewünschte Snap-in aus.</span><span class="sxs-lookup"><span data-stu-id="fba0b-123">Load the desired snap-in by selecting **File** - **Add/Remove Snap-in...** in the MMC menu and select the desired snap-in.</span></span>
3.  <span data-ttu-id="fba0b-124">Speichern Sie die MSC-Datei, indem Sie im MMC-Menü **Datei**  -  **Speichern unter...** auswählen.</span><span class="sxs-lookup"><span data-stu-id="fba0b-124">Save the MSC file by selecting **File** - **Save As...** in the MMC menu.</span></span>

<span data-ttu-id="fba0b-125">Wenn Sie keine Start-MSC-Datei festlegen, müssen Sie das gewünschte Snap-in manuell laden, wenn Sie die Anwendung im Debugger ausführen.</span><span class="sxs-lookup"><span data-stu-id="fba0b-125">If you do not set a start-up MSC file, you must manually load the desired snap-in when you run the application in the debugger.</span></span>

<span data-ttu-id="fba0b-126">Wenn die Host Anwendung im Debugger ausgeführt wird, zeigt der Debugger möglicherweise eine Warnmeldung an, die besagt, dass die ausgestellte Anwendung keine Debugsymbole enthält.</span><span class="sxs-lookup"><span data-stu-id="fba0b-126">When the host application is run in the debugger, the debugger may display a warning message stating that the application being run does not contain any debug symbols.</span></span> <span data-ttu-id="fba0b-127">Dies ist zu erwarten und kann sicher ignoriert werden, da Sie die dll tatsächlich Debuggen, nicht die Host Anwendung.</span><span class="sxs-lookup"><span data-stu-id="fba0b-127">This is expected and can safely be ignored because you are actually debugging the DLL, not the host application.</span></span>

<span data-ttu-id="fba0b-128">In den meisten Fällen wird die Erweiterung erst aufgerufen, wenn der Benutzer eine Aktion ausführt, die bewirkt, dass die Erweiterung geladen und initialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="fba0b-128">In most cases, the extension will not be called until the user performs some action that causes the extension to be loaded and initialized.</span></span> <span data-ttu-id="fba0b-129">Wenn Sie z. b. eine Kontextmenüerweiterung Debuggen, die für Benutzer Objekte angezeigt wird, wird die Erweiterung erst geladen, wenn das Kontextmenü für ein Benutzerobjekt zum ersten Mal angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="fba0b-129">For example, if you are debugging a context menu extension displayed for user objects, the extension will not load until the first time the context menu for a user object is displayed.</span></span>

<span data-ttu-id="fba0b-130">Sie sollten jetzt in der Lage sein, Breakpoints festzulegen und die Debugausgabe anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="fba0b-130">You should now be able to set breakpoints and view debug output.</span></span> <span data-ttu-id="fba0b-131">Wenn die Erweiterung nicht geladen werden kann, legen Sie in der [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) -Funktion der Erweiterung einen Haltepunkt fest.</span><span class="sxs-lookup"><span data-stu-id="fba0b-131">If the extension does not appear to load, set a breakpoint in the extension's [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) function.</span></span> <span data-ttu-id="fba0b-132">Wenn **DllGetClassObject** nicht aufgerufen wird, ist die Erweiterung wahrscheinlich nicht ordnungsgemäß registriert.</span><span class="sxs-lookup"><span data-stu-id="fba0b-132">If **DllGetClassObject** is not called, the extension is probably not registered correctly.</span></span>

<span data-ttu-id="fba0b-133">Wenn das Debuggen beendet ist, beenden Sie MMC, und der Debugger sollte normal entladen werden.</span><span class="sxs-lookup"><span data-stu-id="fba0b-133">When the debug is complete, exit MMC and the debugger should unload normally.</span></span>

 

 