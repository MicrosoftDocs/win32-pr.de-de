---
title: Abrufen von Änderungen mithilfe des Dirsync-Steuer Elements
description: Die Active Directory Directory-Synchronisierung (Dirsync) ist eine LDAP-Server Erweiterung, die es einer Anwendung ermöglicht, eine Verzeichnis Partition nach Objekten zu durchsuchen, die sich seit einem früheren Zustand geändert haben.
ms.assetid: f77caeb3-bfc9-4ae6-8d1d-73f4ee554336
ms.tgt_platform: multiple
keywords:
- Abrufen von Änderungen mithilfe des DirSync-Steuerelement-AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c3d105757d39bc25bd10df21ab68c4d1d1202be
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724472"
---
# <a name="polling-for-changes-using-the-dirsync-control"></a><span data-ttu-id="9ea8d-104">Abrufen von Änderungen mithilfe des Dirsync-Steuer Elements</span><span class="sxs-lookup"><span data-stu-id="9ea8d-104">Polling for Changes Using the DirSync Control</span></span>

<span data-ttu-id="9ea8d-105">Die Active Directory Directory-Synchronisierung (Dirsync) ist eine LDAP-Server Erweiterung, die es einer Anwendung ermöglicht, eine Verzeichnis Partition nach Objekten zu durchsuchen, die sich seit einem früheren Zustand geändert haben.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-105">Active Directory directory synchronization (DirSync) control is an LDAP server extension that enables an application to search an directory partition for objects that have changed since a previous state.</span></span>

<span data-ttu-id="9ea8d-106">Verwenden Sie das DirSync-Steuerelement über ADSI, indem Sie die Such Einstellung **ADS \_ searchpref \_ Dirsync** bei Verwendung von [**idirector ysearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch)angeben.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-106">Use the DirSync control through ADSI by specifying the **ADS\_SEARCHPREF\_DIRSYNC** search preference when using [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span></span> <span data-ttu-id="9ea8d-107">Weitere Informationen und ein Codebeispiel finden Sie unter [Beispielcode mit ADS \_ searchpref \_ Dirsync](example-code-using-ads-searchpref-dirsync.md).</span><span class="sxs-lookup"><span data-stu-id="9ea8d-107">For more information and a code example, see [Example Code Using ADS\_SEARCHPREF\_DIRSYNC](example-code-using-ads-searchpref-dirsync.md).</span></span> <span data-ttu-id="9ea8d-108">Sie können auch eine Dirsync-Suche mit der LDAP-API durchführen.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-108">You can also perform a DirSync search using the LDAP API.</span></span> <span data-ttu-id="9ea8d-109">Im folgenden wird die ADSI-Implementierung beschrieben. die meisten davon gelten auch für die direkte Verwendung von LDAP, außer wie am Ende dieses Themas erläutert.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-109">The following describes the ADSI implementation, most of which also applies to using LDAP directly, except as discussed at the end of this topic.</span></span>

<span data-ttu-id="9ea8d-110">Wenn Sie eine Dirsync-Suche durchführen, übergeben Sie ein Anbieter spezifisches Datenelement (Cookie), das den Verzeichnis Zustand zum Zeitpunkt der vorherigen Dirsync-Suche identifiziert.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-110">When you perform a DirSync search, you pass in a provider-specific data element (cookie) that identifies the directory state at the time of the previous DirSync search.</span></span> <span data-ttu-id="9ea8d-111">Bei der ersten Suche übergeben Sie ein NULL-Cookie, und die Suche gibt alle Objekte zurück, die dem Filter entsprechen.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-111">For the first search, you pass in a null cookie, and the search returns all objects that match the filter.</span></span> <span data-ttu-id="9ea8d-112">Die Suche gibt auch ein gültiges Cookie zurück.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-112">The search also returns a valid cookie.</span></span> <span data-ttu-id="9ea8d-113">Speichern Sie das Cookie im gleichen Speicher, den Sie mit dem Active Directory-Server synchronisieren.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-113">Store the cookie in the same storage that you are synchronizing with the Active Directory server.</span></span> <span data-ttu-id="9ea8d-114">Bei nachfolgenden Such Vorgängen wird das Cookie aus dem Speicher abgeraten und mit der Such Anforderung übergeben.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-114">On subsequent searches, get the cookie from storage and pass it with the search request.</span></span> <span data-ttu-id="9ea8d-115">Die Suchergebnisse enthalten jetzt nur die Objekte und Attribute, die sich seit dem vorherigen Zustand, der durch das Cookie identifiziert wurde, geändert haben.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-115">The search results now include only the objects and attributes that have changed since the previous state identified by the cookie.</span></span> <span data-ttu-id="9ea8d-116">Die Suche gibt auch ein neues Cookie zurück, das für die nächste Suche gespeichert werden soll.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-116">The search also returns a new cookie to store for the next search.</span></span>

<span data-ttu-id="9ea8d-117">In der folgenden Tabelle werden die Suchparameter aufgelistet, die von der Client Such Anforderung angegeben werden können.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-117">The following table lists search parameters that the client search request can specify.</span></span>



| <span data-ttu-id="9ea8d-118">Parameter</span><span class="sxs-lookup"><span data-stu-id="9ea8d-118">Parameter</span></span>          | <span data-ttu-id="9ea8d-119">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="9ea8d-119">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9ea8d-120">Basis der Suche</span><span class="sxs-lookup"><span data-stu-id="9ea8d-120">Base of the search</span></span> | <span data-ttu-id="9ea8d-121">Die Basis einer Dirsync-Suche muss der Stamm einer Verzeichnis Partition sein, bei der es sich um eine Domänen Partition, die Konfigurations Partition oder die Schema Partition handeln kann.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-121">The base of a DirSync search must be the root of a directory partition, which can be a domain partition, the configuration partition, or the schema partition.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="9ea8d-122">Bereich</span><span class="sxs-lookup"><span data-stu-id="9ea8d-122">Scope</span></span>              | <span data-ttu-id="9ea8d-123">Der Gültigkeitsbereich einer Dirsync-Suche muss eine **Werbe \_ Bereichs \_ Unterstruktur** sein, d. h. die gesamte Unterstruktur der Partition.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-123">The scope of a DirSync search must be **ADS\_SCOPE\_SUBTREE**, that is, the entire subtree of the partition.</span></span> <span data-ttu-id="9ea8d-124">Beachten Sie, dass die Teilstruktur bei einer Suche nach einer Domänen Partition die Köpfe, aber nicht den Inhalt der Konfigurations-und Schema Partitionen enthält.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-124">Be aware that for a search of a domain partition, the subtree includes the heads, but not the contents, of the configuration and schema partitions.</span></span> <span data-ttu-id="9ea8d-125">Um Änderungen in einem kleineren Bereich abzurufen, verwenden Sie anstelle von DirSync die Methode "nicht **geändert** ".</span><span class="sxs-lookup"><span data-stu-id="9ea8d-125">To poll for changes in a smaller scope, use the **USNChanged** technique instead of DirSync.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="9ea8d-126">Filter</span><span class="sxs-lookup"><span data-stu-id="9ea8d-126">Filter</span></span>             | <span data-ttu-id="9ea8d-127">Sie können einen beliebigen gültigen Suchfilter angeben.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-127">You can specify any valid search filter.</span></span> <span data-ttu-id="9ea8d-128">Bei einer ersten Suche mit einem NULL-Cookie enthalten die Ergebnisse alle Objekte, die dem Filter entsprechen.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-128">For an initial search with a null cookie, the results include all objects that match the filter.</span></span> <span data-ttu-id="9ea8d-129">Bei nachfolgenden Such Vorgängen mit einem gültigen Cookie enthalten die Suchergebnisse nur Daten für Objekte, die dem Filter entsprechen und sich seit dem durch das Cookie festgelegten Status geändert haben.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-129">For subsequent searches with a valid cookie, the search results include data only for objects that match the filter and have changed since the state indicated by the cookie.</span></span> <span data-ttu-id="9ea8d-130">Weitere Informationen zu Suchfiltern finden Sie unter [Erstellen eines Abfrage Filters](creating-a-query-filter.md).</span><span class="sxs-lookup"><span data-stu-id="9ea8d-130">For more information about search filters, see [Creating a Query Filter](creating-a-query-filter.md).</span></span>                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="9ea8d-131">Attribute</span><span class="sxs-lookup"><span data-stu-id="9ea8d-131">Attributes</span></span>         | <span data-ttu-id="9ea8d-132">Sie können eine Liste von Attributen angeben, die zurückgegeben werden sollen, wenn eine Änderung auftritt.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-132">You can specify a list of attributes to be returned when a change occurs.</span></span> <span data-ttu-id="9ea8d-133">Für jedes Objekt enthalten die anfänglichen Ergebnisse alle angeforderten Attribute, die für das Objekt festgelegt wurden.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-133">For each object, the initial results include all the requested attributes set on the object.</span></span> <span data-ttu-id="9ea8d-134">Nachfolgende Suchergebnisse enthalten nur die angegebenen Attribute, die geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-134">Subsequent search results include only the specified attributes that have changed.</span></span> <span data-ttu-id="9ea8d-135">Unveränderte Attribute sind nicht in den Suchergebnissen enthalten.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-135">Unchanged attributes are not included in the search results.</span></span> <span data-ttu-id="9ea8d-136">In der ADSI-Implementierung enthalten die Suchergebnisse immer die **objectGUID** und **instanceType** jedes Objekts.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-136">In the ADSI implementation, the search results always include the **objectGUID** and **instanceType** of each object.</span></span> <span data-ttu-id="9ea8d-137">Außerdem fungiert die angegebene Attribut Liste als zusätzlicher Filter: in den ersten Suchergebnissen sind nur Objekte enthalten, für die mindestens eines der angegebenen Attribute festgelegt ist. bei nachfolgenden Such Vorgängen werden nur Objekte angezeigt, für die ein oder mehrere Attribute geändert wurden (hinzugefügte oder gelöschte Werte).</span><span class="sxs-lookup"><span data-stu-id="9ea8d-137">Also, the specified attribute list acts as an additional filter: the initial search results include only objects that have at least one of the specified attributes set; subsequent searches include only objects on which one or more of the attributes have changed (values added or deleted).</span></span> |



 

<span data-ttu-id="9ea8d-138">Beachten Sie auch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="9ea8d-138">Also, be aware that:</span></span>

-   <span data-ttu-id="9ea8d-139">Bei inkrementellen suchen empfiehlt es sich, an denselben Domänen Controller (DC) zu binden, der in der vorherigen Suche verwendet wurde, d. h. an den Domänen Controller, der das Cookie generiert hat.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-139">For incremental searches, the best practice is to bind to the same domain controller (DC) used in the previous search, that is, the DC that generated the cookie.</span></span> <span data-ttu-id="9ea8d-140">Wenn derselbe DC nicht verfügbar ist, warten Sie, bis er ist, oder binden Sie an einen neuen Domänen Controller, und führen Sie eine vollständige Synchronisierung durch.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-140">If the same DC is unavailable, either wait until it is, or bind to a new DC and perform a full synchronization.</span></span> <span data-ttu-id="9ea8d-141">Speichern Sie den DNS-Namen des Domänen Controllers im sekundären Speicher mit dem Cookie.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-141">Store the DNS name of the DC in the secondary storage with the cookie.</span></span>

    <span data-ttu-id="9ea8d-142">Sie können ein von einem Domänen Controller generiertes Cookie an einen anderen Domänen Controller übergeben, der ein Replikat derselben Verzeichnis Partition hostet.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-142">You can pass a cookie generated by one DC to a different DC hosting a replica of the same directory partition.</span></span> <span data-ttu-id="9ea8d-143">Es ist nicht möglich, dass ein Client Änderungen durch Verwendung eines Cookies von einem Domänen Controller auf einem anderen DC verpasst.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-143">There is no chance that a client will miss changes by using a cookie from one DC on another DC.</span></span> <span data-ttu-id="9ea8d-144">Es ist jedoch möglich, dass die Suchergebnisse des neuen Domänen Controllers gemeldete Änderungen des alten Domänen Controllers einschließen. in einigen Fällen gibt der neue DC möglicherweise alle Objekte und Attribute zurück, wie bei einer vollständigen Synchronisierung.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-144">However, it is possible that the search results from the new DC may include reported changes by the old DC; in some cases, the new DC may return all objects and attributes, as with a full synchronization.</span></span> <span data-ttu-id="9ea8d-145">Der Client sollte seine Datenbank lediglich mit den gemeldeten Suchergebnissen für einen beliebigen Dirsync-Befehl konsistent machen, d. h., alle inkrementellen Ergebnisse werden so behandelt, als wären Sie der aktuelle Zustand.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-145">The client should just make its database consistent with reported search results for any given DirSync call, that is, handle all incremental results as if they were the latest state.</span></span> <span data-ttu-id="9ea8d-146">Es spielt keine Rolle, ob Sie die Änderung schon vor oder nach einem früheren Zustand erkannt haben, da sich die wiederholten inkrementellen Synchronisierung bei Konsistenz annähern.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-146">It does not matter whether you have seen the change before or are even going back to a previous state because repeated incremental synchronizations will converge on consistency.</span></span>

-   <span data-ttu-id="9ea8d-147">Wenn ein Objekt umbenannt oder verschoben wird, sind seine untergeordneten Objekte, sofern vorhanden, nicht in den Suchergebnissen enthalten, auch wenn sich die Distinguished Names der untergeordneten Objekte geändert haben.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-147">When an object is renamed or moved, its child objects, if any, are not included in the search results, even though the distinguished names of the child objects have changed.</span></span> <span data-ttu-id="9ea8d-148">Ebenso, wenn ein vererbbarer ACE in einem Objekt Sicherheits Deskriptor geändert wird, sind die untergeordneten Objekte des-Objekts nicht in den Suchergebnissen enthalten, auch wenn sich die Sicherheits Deskriptoren der untergeordneten-Objekte geändert haben.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-148">Similarly, when an inheritable ACE is modified in an object security-descriptor, the child objects of the object are not included in the search results, even though the security-descriptors of the child objects have changed.</span></span>
-   <span data-ttu-id="9ea8d-149">Verwenden Sie das **objectGUID** -Attribut, um die nach verfolgten Objekte zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-149">Use the **objectGUID** attribute to identify the tracked objects.</span></span> <span data-ttu-id="9ea8d-150">Die **objectGUID** jedes Objekts bleibt unverändert, unabhängig davon, wo das Objekt innerhalb der Gesamtstruktur verschoben wird.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-150">The **objectGUID** of each object remains unchanged regardless of where the object is moved within the forest.</span></span>
-   <span data-ttu-id="9ea8d-151">Beachten Sie, dass die Suchergebnisse einer Dirsync-Suche den Zustand der Objekte auf einem Replikat der Verzeichnis Partition zum Zeitpunkt der Suche angeben.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-151">Be aware that the search results of a DirSync search indicate the state of the objects on a replica of the directory partition at the time of the search.</span></span> <span data-ttu-id="9ea8d-152">Dies bedeutet, dass Änderungen an anderen DCS nicht eingeschlossen werden, wenn Sie nicht auf den Ziel-DC repliziert wurden.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-152">This means that changes made on other DCs will not be included if they have not been replicated to the target DC.</span></span> <span data-ttu-id="9ea8d-153">Dies bedeutet auch, dass sich die Attribute eines Objekts seit der vorherigen Dirsync-Suche mehrmals geändert haben können. bei der Suche wird jedoch nur der endgültige Zustand angezeigt, nicht die Abfolge der Änderungen.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-153">It also means that an object's attributes may have changed several times since the previous DirSync search, but the search will show only the final state, not the sequence of changes.</span></span>
-   <span data-ttu-id="9ea8d-154">In der ADSI-Implementierung muss die Anwendung das Cookie als nicht transparent behandeln und keine Annahmen über die interne Organisation oder den Wert machen.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-154">In the ADSI implementation, the application must handle the cookie as opaque and not make any assumptions about its internal organization or value.</span></span>
-   <span data-ttu-id="9ea8d-155">Beachten Sie, dass der Client das Cookie, die Cookie-Länge und den DNS-Namen des Domänen Controllers im gleichen Speicher speichert, der die synchronisierten Objektdaten enthält.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-155">Be aware that the client stores the cookie, cookie length, and DNS name of the DC in the same storage that contains the synchronized object data.</span></span> <span data-ttu-id="9ea8d-156">Dadurch wird sichergestellt, dass das Cookie und andere Parameter mit den Objektdaten synchron bleiben, wenn der Speicher jemals aus einer Sicherung wieder hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-156">This ensures that the cookie and other parameters remain in sync with the object data if the storage is ever restored from a backup.</span></span>
-   <span data-ttu-id="9ea8d-157">Um das für das DirSync-Steuerelement erstellte Attribut " [**arguid**](/windows/desktop/ADSchema/a-parentguid) " abzurufen, muss auch das [**namens**](/windows/desktop/ADSchema/a-name) Attribut angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-157">To retrieve the [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) attribute, which is constructed for the DirSync control, it is also necessary to request the [**name**](/windows/desktop/ADSchema/a-name) attribute.</span></span>

<span data-ttu-id="9ea8d-158">Um das DirSync-Steuerelement zu verwenden, muss dem Aufrufer im Stamm der überwachten Partition das Recht "Verzeichnis Get Changes" zugewiesen sein.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-158">To use the DirSync control, caller must have the "directory get changes" right assigned on the root of the partition being monitored.</span></span> <span data-ttu-id="9ea8d-159">Dieses Recht wird standardmäßig den Konten "Administrator" und "LocalSystem" auf Domänen Controllern zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-159">By default, this right is assigned to the Administrator and LocalSystem accounts on domain controllers.</span></span> <span data-ttu-id="9ea8d-160">Der Aufrufer muss auch über das Zugriffsrecht " [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) Extended Control" verfügen.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-160">The caller must also have the [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) extended control access right.</span></span> <span data-ttu-id="9ea8d-161">Weitere Informationen zum Implementieren eines Mechanismus zur Änderungs Nachverfolgung für Anwendungen, die unter einem Konto ausgeführt werden müssen, das nicht über dieses Recht verfügt, finden Sie unter Abrufen [von Änderungen mithilfe von "US-nchanged](polling-for-changes-using-usnchanged.md)".</span><span class="sxs-lookup"><span data-stu-id="9ea8d-161">For more information about implementing a change-tracking mechanism for applications that must run under an account that does not have this right, see [Polling for Changes Using USNChanged](polling-for-changes-using-usnchanged.md).</span></span> <span data-ttu-id="9ea8d-162">Weitere Informationen zu Berechtigungen finden Sie unter [Berechtigungen](/windows/desktop/SecAuthZ/privileges).</span><span class="sxs-lookup"><span data-stu-id="9ea8d-162">For more information about privileges, see [Privileges](/windows/desktop/SecAuthZ/privileges).</span></span>

## <a name="retrieving-deleted-objects-with-a-dirsync-search"></a><span data-ttu-id="9ea8d-163">Abrufen von gelöschten Objekten mit einer Dirsync-Suche</span><span class="sxs-lookup"><span data-stu-id="9ea8d-163">Retrieving Deleted Objects With a DirSync Search</span></span>

<span data-ttu-id="9ea8d-164">Die **\_ \_ Dirsync-Suchergebnisse von ADS searchpref** enthalten automatisch gelöschte Objekte (Tombstones), die dem angegebenen Suchfilter entsprechen.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-164">The **ADS\_SEARCHPREF\_DIRSYNC** search results automatically include deleted objects (tombstones) that match the specified search filter.</span></span> <span data-ttu-id="9ea8d-165">Ein Suchfilter, der mit einem Objekt verglichen wird, wenn es aktiv ist, stimmt jedoch möglicherweise nicht mit dem Objekt ab, nachdem es gelöscht wurde.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-165">However, a search filter that will match an object when it is live may not match the object after it is deleted.</span></span> <span data-ttu-id="9ea8d-166">Dies liegt daran, dass Tombstones nur eine Teilmenge der Attribute beibehalten, die für das ursprüngliche Objekt vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-166">This is because tombstones retain only a subset of the attributes present on the original object.</span></span> <span data-ttu-id="9ea8d-167">Beispielsweise verwenden Sie in der Regel den folgenden Filter für Benutzer Objekte.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-167">For example, you would typically use the following filter for user objects.</span></span>


```C++
(&(objectClass=user)(objectCategory=person))
```



<span data-ttu-id="9ea8d-168">Das **objectCategory** -Attribut wird entfernt, wenn ein Objekt gelöscht wird. Daher stimmt der Filter oben nicht mit den Tombstone-Objekten aus.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-168">The **objectCategory** attribute is removed when an object is deleted, so the filter above would not match any tombstone objects.</span></span> <span data-ttu-id="9ea8d-169">Umgekehrt wird das **objectClass** -Attribut in Tombstone-Objekten aufbewahrt, sodass ein Filter von "(objectClass = User)" gelöschten Benutzer Objekten entspricht.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-169">Conversely, the **objectClass** attribute is retained on tombstone objects, so a filter of "(objectClass=user)" would match deleted user objects.</span></span>

<span data-ttu-id="9ea8d-170">Die Attribut Liste, die Sie mit einer Dirsync-Suche angeben, fungiert auch als Filter. die Suchergebnisse enthalten nur Objekte, bei denen mindestens eines der angegebenen Attribute seit der vorherigen Dirsync-Suche geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-170">The attribute list that you specify with a DirSync search also acts as a filter; search results include only objects on which one or more of the specified attributes have changed since the previous DirSync search.</span></span> <span data-ttu-id="9ea8d-171">Wenn die Attribut Liste keine Attribute enthält, die auf Tombstones aufbewahrt werden, enthalten die Suchergebnisse keine Tombstones.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-171">If the attribute list does not include any attributes that are retained on tombstones, the search results will not include tombstones.</span></span> <span data-ttu-id="9ea8d-172">Um dies zu behandeln, fordern Sie alle Attribute an, indem Sie eine NULL-Attribut Liste angeben. Sie können auch das **isDeleted** -Attribut anfordern und für alle Tombstones auf " **true** " festlegen.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-172">To handle this, request all attributes by specifying a null attribute list; or you can request the **isDeleted** attribute, set to **TRUE** on all tombstones.</span></span> <span data-ttu-id="9ea8d-173">Bei Tombstone-Attributen ist das 0x8-Bit im **searchFlags** -Attribut der **attributeSchema** -Definition festgelegt.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-173">Tombstone attributes have the 0x8 bit set in the **searchFlags** attribute of the **attributeSchema** definition.</span></span>

<span data-ttu-id="9ea8d-174">Weitere Informationen finden Sie unter [Abrufen von gelöschten Objekten](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="9ea8d-174">For more information, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>

## <a name="ldap-implementation-of-the-dirsync-control"></a><span data-ttu-id="9ea8d-175">LDAP-Implementierung des Dirsync-Steuer Elements</span><span class="sxs-lookup"><span data-stu-id="9ea8d-175">LDAP Implementation of the DirSync Control</span></span>

<span data-ttu-id="9ea8d-176">Sie können auch eine Dirsync-Suche durchführen, indem Sie die LDAP-API mit dem [LDAP- \_ Server \_ Dirsync \_ OID](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) -Steuerelement verwenden.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-176">You can also perform a DirSync search by using the LDAP API with the [LDAP\_SERVER\_DIRSYNC\_OID](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) control.</span></span> <span data-ttu-id="9ea8d-177">Wenn Sie die LDAP-API verwenden, geben Sie auch die [ \_ \_ Erweiterte \_ DN- \_ OID des LDAP-Servers](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) und LDAP-Server mit [ \_ \_ \_ gelöschten \_ OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) -Steuerelementen anzeigen</span><span class="sxs-lookup"><span data-stu-id="9ea8d-177">If you use the LDAP API, also specify the [LDAP\_SERVER\_EXTENDED\_DN\_OID](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) and [LDAP\_SERVER\_SHOW\_DELETED\_OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) controls.</span></span> <span data-ttu-id="9ea8d-178">Das \_ \_ Erweiterte DN-OID des LDAP-Servers \_ \_ bewirkt, dass eine LDAP-Suche eine erweiterte Form des Distinguished Name zurückgibt, die **objectGUID** und **objectSID** für Sicherheits Prinzipal Objekte wie z. b. Benutzer, Gruppen und Computer enthält.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-178">The LDAP\_SERVER\_EXTENDED\_DN\_OID control causes an LDAP search to return an extended form of the distinguished name that includes the **objectGUID** and **objectSID** for security principal objects such as users, groups, and computers.</span></span> <span data-ttu-id="9ea8d-179">Der LDAP- \_ Server " \_ \_ gelöschtes OID" anzeigen \_ bewirkt, dass die Suchergebnisse Daten für gelöschte Objekte enthalten.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-179">The LDAP\_SERVER\_SHOW\_DELETED\_OID control causes the search results to include data for deleted objects.</span></span> <span data-ttu-id="9ea8d-180">Beachten Sie, dass diese Steuerelemente automatisch in der ADSI-Implementierung enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="9ea8d-180">Be aware that these controls are automatically included in the ADSI implementation.</span></span>

 

 