---
title: Verzeichnis Objektauswahl
description: Mit dem Dialogfeld Verzeichnis Objektauswahl kann ein Benutzer ein oder mehrere Objekte aus dem globalen Katalog, einer Domäne oder einem Computer oder einer Arbeitsgruppe auswählen.
ms.assetid: 5b3e5d71-afd2-49db-b3a2-f9a49f0b2b3a
ms.tgt_platform: multiple
keywords:
- Verzeichnis Objektauswahl (AD)
- Objektauswahl anzeigen
- Objekte AD, Objektauswahl
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24f6ba7fd053aa8ab3245bf72c693f0a887aa983
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "104038767"
---
# <a name="directory-object-picker"></a><span data-ttu-id="de993-106">Verzeichnis Objektauswahl</span><span class="sxs-lookup"><span data-stu-id="de993-106">Directory Object Picker</span></span>

<span data-ttu-id="de993-107">Mit dem Dialogfeld Verzeichnis Objektauswahl kann ein Benutzer ein oder mehrere Objekte aus dem globalen Katalog, einer Domäne oder einem Computer oder einer Arbeitsgruppe auswählen.</span><span class="sxs-lookup"><span data-stu-id="de993-107">The directory object picker dialog box enables a user to select one or more objects from either the global catalog, a domain or computer, or a workgroup.</span></span> <span data-ttu-id="de993-108">Zu den Objekttypen, aus denen ein Benutzer auswählen kann, gehören Benutzer-, Kontakt-, Gruppen-und Computer Objekte.</span><span class="sxs-lookup"><span data-stu-id="de993-108">The object types from which a user can select include user, contact, group, and computer objects.</span></span> <span data-ttu-id="de993-109">Weitere Informationen zu Active Directory Domain Services finden Sie unter [Active Directory Domain Services](active-directory-domain-services.md).</span><span class="sxs-lookup"><span data-stu-id="de993-109">For more information about Active Directory Domain Services, see [Active Directory Domain Services](active-directory-domain-services.md).</span></span>

<span data-ttu-id="de993-110">So zeigen Sie das Dialogfeld "Objektauswahl" an:</span><span class="sxs-lookup"><span data-stu-id="de993-110">To display an object picker dialog box:</span></span>

1.  <span data-ttu-id="de993-111">Rufen Sie die Funktion [**cokreateinstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) oder [**cokreateinstanceex**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) auf, um eine Instanz der [**idsobjectpicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) -Schnittstelle zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="de993-111">Call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) function to create an instance of the [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) interface.</span></span>
2.  <span data-ttu-id="de993-112">Aufrufen der [**idsobjectpicker:: Initialisieren**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) -Methode, um das Dialogfeld zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="de993-112">Call the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method to initialize the dialog box.</span></span>
3.  <span data-ttu-id="de993-113">Aufrufen der [**idsobjectpicker:: invokedialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) -Methode, um das Dialogfeld anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="de993-113">Call the [**IDsObjectPicker::InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) method to display the dialog box.</span></span>
4.  <span data-ttu-id="de993-114">Rufen Sie die [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) -Methode der [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Instanz auf, die vom Dialogfeld Objektauswahl zurückgegeben wird, um die [**cfstr \_ DSOP \_ DS- \_ Auswahl \_ Listen**](cfstr-dsop-ds-selection-list.md) Daten abzurufen.</span><span class="sxs-lookup"><span data-stu-id="de993-114">Call the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method of the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) instance returned by the object picker dialog box to retrieve the [**CFSTR\_DSOP\_DS\_SELECTION\_LIST**](cfstr-dsop-ds-selection-list.md) data.</span></span> <span data-ttu-id="de993-115">Das Format der **cfstr \_ DSOP \_ DS- \_ Auswahl \_ Liste** in der Zwischenablage bietet einen **HGLOBAL** , der eine [**DS- \_ Auswahl \_ Listen**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) Struktur enthält.</span><span class="sxs-lookup"><span data-stu-id="de993-115">The **CFSTR\_DSOP\_DS\_SELECTION\_LIST** clipboard format provides an **HGLOBAL** that contains a [**DS\_SELECTION\_LIST**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) structure.</span></span> <span data-ttu-id="de993-116">Die Struktur der **DS- \_ Auswahl \_ Liste** enthält Daten zu den Elementen, die im Dialogfeld Objektauswahl ausgewählt wurden.</span><span class="sxs-lookup"><span data-stu-id="de993-116">The **DS\_SELECTION\_LIST** structure contains data about the items selected in the object picker dialog box.</span></span>

<span data-ttu-id="de993-117">Wenn die Sicherheits-ID (SID) für ein Objekt erforderlich ist, sollte diese direkt von der Objektauswahl angefordert werden, indem das **objectSID** -Attribut der Liste der Attribute hinzugefügt wird, die für das ausgewählte Objekt abgerufen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="de993-117">If the Security Identifier (SID) is required for an object, this should be requested directly from the object picker by adding the **objectSID** attribute to the list of attributes to retrieve for the selected object.</span></span> <span data-ttu-id="de993-118">Es wird nicht empfohlen, den zurückgegebenen Objektnamen an die Funktion [**lsalookupnames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) oder [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) zu übergeben, da die Namenssuche redundant ist und in einigen Fällen möglicherweise fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="de993-118">Passing the returned object name to the [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) or [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) function is not recommended because the name lookup will be redundant and may fail in some cases.</span></span>

<span data-ttu-id="de993-119">Wenn ein Verweis auf ausgewählte Objekte gespeichert wird, sollte der Distinguished Name nicht gespeichert werden, da das Objekt möglicherweise verschoben, umbenannt oder aufgrund von Gebiets Schema unterschieden geändert werden kann.</span><span class="sxs-lookup"><span data-stu-id="de993-119">If a reference to any selected objects will be saved, the distinguished name should not be saved because the object may move, get renamed, or may change due to locale differences.</span></span> <span data-ttu-id="de993-120">Für Sicherheits Prinzipale sollte die **objectSID** für das Objekt angefordert und sicher gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="de993-120">For security principals, the **objectSID** should be requested for the object and securely saved.</span></span> <span data-ttu-id="de993-121">Wenn der Name des Sicherheits Prinzipals später benötigt wird, kann er mit der [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) -Funktion abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="de993-121">If the name of the security principal is needed later, it can be retrieved with the [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) function.</span></span> <span data-ttu-id="de993-122">Für alle anderen Objekte muss die **objectGUID** angefordert und gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="de993-122">For all other objects, the **objectGUID** should be requested and saved.</span></span>

## <a name="initialization"></a><span data-ttu-id="de993-123">Initialisierung</span><span class="sxs-lookup"><span data-stu-id="de993-123">Initialization</span></span>

<span data-ttu-id="de993-124">Wenn das Dialogfeld Objektauswahl initialisiert wird, wird ein Satz von Bereichs Typen und Filtern angegeben.</span><span class="sxs-lookup"><span data-stu-id="de993-124">When the object picker dialog box is initialized, a set of scope types and filters is specified.</span></span> <span data-ttu-id="de993-125">Die angegebenen Bereichs Typen bestimmen z. b. die Standorte, Domänen oder Computer, von denen aus die Benutzer Objekte auswählen können.</span><span class="sxs-lookup"><span data-stu-id="de993-125">The specified scope types determine the locations, domains or computers for example, from which a user can select objects.</span></span> <span data-ttu-id="de993-126">Die Filter bestimmen die Objekttypen, die ein Benutzer aus einem bestimmten Bereichstyp auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="de993-126">The filters determine the types of objects that a user can select from a given scope type.</span></span> <span data-ttu-id="de993-127">Weitere Informationen finden Sie weiter unten im Abschnitt Bereiche und Filter.</span><span class="sxs-lookup"><span data-stu-id="de993-127">For more information, see the Scopes and Filters section below.</span></span>

<span data-ttu-id="de993-128">Standardmäßig kann ein Benutzer ein einzelnes Objekt im Dialogfeld Verzeichnis Objektauswahl auswählen.</span><span class="sxs-lookup"><span data-stu-id="de993-128">By default, a user can select a single object in the directory object picker dialog box.</span></span> <span data-ttu-id="de993-129">Wenn Sie mehrere Auswahlen aktivieren möchten, legen **Sie das DSOP- \_ Flag \_ MultiSelect** -Flag im **floptions** -Member der [**DSOP \_ Init \_ Info**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) -Struktur fest, wenn das Dialogfeld initialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="de993-129">To enable multiple selections, set the **DSOP\_FLAG\_MULTISELECT** flag in the **flOptions** member of the [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure when the dialog box initialized.</span></span>

## <a name="scopes-and-filters"></a><span data-ttu-id="de993-130">Bereiche und Filter</span><span class="sxs-lookup"><span data-stu-id="de993-130">Scopes and Filters</span></span>

<span data-ttu-id="de993-131">Die Dropdown Liste **Suchen in** enthält die Bereiche, aus denen ein Benutzer Objekte auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="de993-131">The **Look in** drop-down list contains the scopes from which a user can select objects.</span></span> <span data-ttu-id="de993-132">Ein Bereich ist eine Domäne, ein Computer, eine Arbeitsgruppe oder ein globaler Katalog, in der Daten zu einem Satz verfügbarer Objekte gespeichert werden und der Zugriff darauf ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="de993-132">A scope is a domain, computer, workgroup, or global catalog that stores data about, and provides access to, a set of available objects.</span></span> <span data-ttu-id="de993-133">Die Einträge in der Bereichs Liste hängen von den Bereichs Typen und dem Bereitstellungs Zielcomputer ab, der beim letzten Aufruf der [**idsobjectpicker:: Initialisieren**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) -Methode aufgerufen wurde, um das Dialogfeld Objektauswahl zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="de993-133">The entries in the scope list depend on the scope types and the target computer specified when the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method was last called to initialize the object picker dialog box.</span></span>

<span data-ttu-id="de993-134">Ein Bereichstyp ist eine generische Kategorie von Bereichen, z. b. alle Domänen in dem Unternehmen, zu denen der Zielcomputer gehört, oder der globale Katalog für das Unternehmen des Ziel Computers oder der Zielcomputer.</span><span class="sxs-lookup"><span data-stu-id="de993-134">A scope type is a generic category of scopes, such as all domains in the enterprise to which the target computer belongs, or the global catalog for the target computer's enterprise, or the target computer itself.</span></span> <span data-ttu-id="de993-135">Im Dialogfeld wird für jeden angegebenen Bereichstyp der Kontext des Bereitstellungs Ziel Computers verwendet, um die Einträge in der Bereichs Liste zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="de993-135">For each specified scope type, the dialog box uses the context of the target computer to determine the scope list entries.</span></span>

<span data-ttu-id="de993-136">Die [**idsobjectpicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) -Methode verwendet einen Zeiger auf eine [**DSOP- \_ Init- \_ Informations**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) Struktur, die ein Array von [**DSOP-Scope- \_ \_ Init \_ Info**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) -Strukturen enthält.</span><span class="sxs-lookup"><span data-stu-id="de993-136">The [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method takes a pointer to a [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure that contains an array of [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structures.</span></span> <span data-ttu-id="de993-137">Jeder Eintrag im **DSOP \_ Scope \_ Init \_ Info** -Array gibt einen oder mehrere Bereichs Typen sowie anwendbare Filter und andere Attribute an.</span><span class="sxs-lookup"><span data-stu-id="de993-137">Each entry in the **DSOP\_SCOPE\_INIT\_INFO** array specifies one or more scope types as well as applicable filters and other attributes.</span></span> <span data-ttu-id="de993-138">Die Filter bestimmen die Objekttypen, z. b. Benutzer, Gruppen, Kontakte und Computer, die der Benutzer aus einem bestimmten Bereichstyp auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="de993-138">The filters determine the types of objects, such as users, groups, contacts, and computers, that the user can select from a given scope type.</span></span> <span data-ttu-id="de993-139">Wenn der Benutzer einen Bereich aus der Liste auswählt, wendet das Dialogfeld die Filter für diesen Bereichstyp an, um eine Liste von Objekten anzuzeigen, aus denen der Benutzer auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="de993-139">When the user selects a scope from the list, the dialog box applies the filters for that scope type to display a list of objects from which the user can select.</span></span>

<span data-ttu-id="de993-140">Jede [**DSOP- \_ Bereich- \_ Init \_ Info**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) -Struktur enthält eine [**DSOP- \_ \_ Filterflags**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) -Struktur, die die Filter für diesen Bereichstyp angibt.</span><span class="sxs-lookup"><span data-stu-id="de993-140">Each [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structure contains a [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure that specifies the filters for that scope type.</span></span> <span data-ttu-id="de993-141">Die **DSOP \_ - \_ Filterflags** -Struktur unterscheidet zwischen den Bereichen auf der Ebene und der untergeordneten Ebene:</span><span class="sxs-lookup"><span data-stu-id="de993-141">The **DSOP\_FILTER\_FLAGS** structure distinguishes between up-level and down-level scopes:</span></span>

-   <span data-ttu-id="de993-142">Ein Bereich auf der Ebene ist ein globaler Katalog oder eine Domäne, die den ADSI [LDAP-Anbieter](/windows/desktop/ADSI/adsi-ldap-provider)unterstützt.</span><span class="sxs-lookup"><span data-stu-id="de993-142">An up-level scope is a global catalog or a domain that supports the ADSI [LDAP provider](/windows/desktop/ADSI/adsi-ldap-provider).</span></span>
-   <span data-ttu-id="de993-143">Ein Bereich auf der Ebene umfasst Arbeitsgruppen und alle einzelnen Computer.</span><span class="sxs-lookup"><span data-stu-id="de993-143">A down-level scope includes workgroups and all individual computers.</span></span> <span data-ttu-id="de993-144">Im Dialogfeld wird der ADSI WinNT-Anbieter verwendet, um auf einen downlevelbereich zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="de993-144">The dialog box uses the ADSI WinNT provider to access a down-level scope.</span></span>

<span data-ttu-id="de993-145">Es gibt zwei Sätze von Filterflags, die für die Verwendung in der [**DSOP- \_ \_ Filterflags**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) -Struktur definiert sind: eine für upebenenbereiche und eine für Bereiche mit untergeordneten Ebenen.</span><span class="sxs-lookup"><span data-stu-id="de993-145">There are two sets of filter flags defined for use in the [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure: one for up-level scopes and one for down-level scopes.</span></span> <span data-ttu-id="de993-146">Der **Uplevel** -Member der **DSOP \_ - \_ Filterflags** -Struktur ist eine [**DSOP- \_ Uplevel- \_ \_ Filterflags**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) -Struktur, die die Filter für upebenenbereiche angibt.</span><span class="sxs-lookup"><span data-stu-id="de993-146">The **Uplevel** member of the **DSOP\_FILTER\_FLAGS** structure is a [**DSOP\_UPLEVEL\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) structure that specifies the filters for up-level scopes.</span></span> <span data-ttu-id="de993-147">Der **fldownlevel** -Member der **DSOP \_ - \_ Filterflags** -Struktur ist ein Satz von Flags, die die Filter für downlevelbereiche angeben.</span><span class="sxs-lookup"><span data-stu-id="de993-147">The **flDownlevel** member of the **DSOP\_FILTER\_FLAGS** structure is a set of flags that specify the filters for down-level scopes.</span></span>

 

 