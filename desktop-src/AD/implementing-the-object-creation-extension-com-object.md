---
title: Implementieren des COM-Objekts für die Objekt Erstellungs Erweiterung
description: Eine Objekt Erstellungs Erweiterung ist ein COM-Objekt, das als in-proc-Server implementiert wird. Sowohl primäre als auch sekundäre Objekt Erstellungs Erweiterungen müssen die idsadminnewobjext-Schnittstelle implementieren.
ms.assetid: 0a8ed0ed-9dcb-4373-b549-7da3f3d9f641
ms.tgt_platform: multiple
keywords:
- Implementieren der Objekt Erstellungs Erweiterung com-Objekt AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 05c1a9da94caa300c1277cf6f6030357ca9d573d
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "104038749"
---
# <a name="implementing-the-object-creation-extension-com-object"></a><span data-ttu-id="d45ef-105">Implementieren des COM-Objekts für die Objekt Erstellungs Erweiterung</span><span class="sxs-lookup"><span data-stu-id="d45ef-105">Implementing the Object Creation Extension COM Object</span></span>

<span data-ttu-id="d45ef-106">Eine Objekt Erstellungs Erweiterung ist ein COM-Objekt, das als in-proc-Server implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="d45ef-106">An object creation extension is a COM object implemented as an in-proc server.</span></span> <span data-ttu-id="d45ef-107">Sowohl primäre als auch sekundäre Objekt Erstellungs Erweiterungen müssen die [**idsadminnewobjext**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobjext) -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="d45ef-107">Both primary and secondary object creation extensions must implement the [**IDsAdminNewObjExt**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobjext) interface.</span></span>

## <a name="implementing-idsadminnewobjext"></a><span data-ttu-id="d45ef-108">Implementieren von idsadminnewobjext</span><span class="sxs-lookup"><span data-stu-id="d45ef-108">Implementing IDsAdminNewObjExt</span></span>

<span data-ttu-id="d45ef-109">Beim Erstellen des Objekterstellungs-Assistenten wird jede Erweiterung zum Erstellen von Objekten initialisiert, indem die [**idsadminnewobjext:: Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-initialize) -Methode der Erweiterung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="d45ef-109">When the object creation wizard is created, it initializes each object creation extension by calling the extension's [**IDsAdminNewObjExt::Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-initialize) method.</span></span> <span data-ttu-id="d45ef-110">Die **Initialize** -Methode stellt der Erweiterung Informationen über den Container zur Verfügung, in dem das Objekt erstellt wird, den Klassennamen des neuen Objekts und Informationen zum Assistenten selbst.</span><span class="sxs-lookup"><span data-stu-id="d45ef-110">The **Initialize** method supplies the extension with information about the container the object is being created in, the class name of the new object and information about the wizard itself.</span></span> <span data-ttu-id="d45ef-111">Wenn der Objekterstellungs-Assistent gestartet wird, um ein neues-Objekt aus einem vorhandenen-Objekt zu erstellen, ist der *padscopysource* -Parameter nicht **null**.</span><span class="sxs-lookup"><span data-stu-id="d45ef-111">If the object creation wizard is started to create a new object from an existing object, the *pADsCopySource* parameter will not be **NULL**.</span></span> <span data-ttu-id="d45ef-112">In diesem Fall sollte die Erweiterung versuchen, so viele Daten wie möglich aus dem Objekt abzurufen, das kopiert wird.</span><span class="sxs-lookup"><span data-stu-id="d45ef-112">In this case, the extension should attempt to obtain as much data from the object being copied as is feasible.</span></span>

<span data-ttu-id="d45ef-113">Nachdem die Erweiterung initialisiert wurde, wird die [**idsadminnewobjext:: addPages**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-addpages) -Methode aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="d45ef-113">After the extension is initialized, the [**IDsAdminNewObjExt::AddPages**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-addpages) method is called.</span></span> <span data-ttu-id="d45ef-114">Die Erweiterung muss dem Assistenten während dieser Methode die Seite oder Seiten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d45ef-114">The extension must add the page or pages to the wizard during this method.</span></span> <span data-ttu-id="d45ef-115">Eine Assistenten Seite wird erstellt, indem Sie eine [**PROPSHEETPAGE**](/windows/win32/api/prsht/ns-prsht-propsheetpagea_v2) -Struktur ausfüllen und diese Struktur dann an [**die Funktion "**](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) die Funktion" "von" |</span><span class="sxs-lookup"><span data-stu-id="d45ef-115">A wizard page is created by filling in a [**PROPSHEETPAGE**](/windows/win32/api/prsht/ns-prsht-propsheetpagea_v2) structure and then passing this structure to the [**CreatePropertySheetPage**](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) function.</span></span> <span data-ttu-id="d45ef-116">Die Seite wird dann durch Aufrufen der Rückruffunktion, die an **addPages** im *lpfnaddpage* -Parameter übergeben wird, dem Assistenten hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d45ef-116">The page is then added to the wizard by calling the callback function that is passed to **AddPages** in the *lpfnAddPage* parameter.</span></span>

<span data-ttu-id="d45ef-117">Vor dem Anzeigen der Erweiterungs Seite wird " [**idsadminnewobjext::**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-setobject) Server" aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="d45ef-117">Before the extension page is displayed, [**IDsAdminNewObjExt::SetObject**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-setobject) is called.</span></span> <span data-ttu-id="d45ef-118">Dadurch wird der Erweiterung ein [**IADs**](/windows/desktop/api/iads/nn-iads-iads) -Schnittstellen Zeiger für das Objekt bereitstellt, das erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="d45ef-118">This supplies the extension with an [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface pointer for the object being created.</span></span>

<span data-ttu-id="d45ef-119">Während die Seite des Assistenten angezeigt wird, sollte die Seite alle erforderlichen Assistenten Benachrichtigungs Meldungen wie z. b. " [**PSN \_ SETACTIVE**](../controls/psn-setactive.md) " und " [**PSN" \_ Next**](../controls/psn-wiznext.md)behandeln und darauf reagieren.</span><span class="sxs-lookup"><span data-stu-id="d45ef-119">While the wizard page is displayed, the page should handle and respond to any necessary wizard notification messages, such as [**PSN\_SETACTIVE**](../controls/psn-setactive.md) and [**PSN\_WIZNEXT**](../controls/psn-wiznext.md).</span></span>

<span data-ttu-id="d45ef-120">Wenn der Benutzer alle Assistenten Seiten abschließt, zeigt der Assistent eine Seite "Fertigstellen" an, die eine Zusammenfassung der eingegebenen Daten bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="d45ef-120">When the user completes all of the wizard pages, the wizard will display a "Finish" page that provides a summary of the data entered.</span></span> <span data-ttu-id="d45ef-121">Der Assistent ruft diese Daten ab, indem er die [**idsadminnewobjext:: getsummaryinfo**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-getsummaryinfo) -Methode für jede der Erweiterungen aufruft.</span><span class="sxs-lookup"><span data-stu-id="d45ef-121">The wizard obtains this data by calling the [**IDsAdminNewObjExt::GetSummaryInfo**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-getsummaryinfo) method for each of the extensions.</span></span> <span data-ttu-id="d45ef-122">Die **getsummaryinfo** -Methode stellt ein **BSTR** bereit, das die Textdaten enthält, die auf der Seite "Fertigstellen" angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="d45ef-122">The **GetSummaryInfo** method provides a **BSTR** that contains the text data displayed in the "Finish" page.</span></span> <span data-ttu-id="d45ef-123">Eine Objekt Erstellungs Erweiterung muss keine Zusammenfassungs Daten bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d45ef-123">An object creation extension does not have to supply summary data.</span></span> <span data-ttu-id="d45ef-124">In diesem Fall sollte **getsummaryinfo** **E \_ notimpl** zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="d45ef-124">In this case, **GetSummaryInfo** should return **E\_NOTIMPL**.</span></span> <span data-ttu-id="d45ef-125">**Getsummaryinfo** wird nur einmal für jede Erweiterung aufgerufen, nicht für jede Seite. wenn die Objekt Erstellungs Erweiterung also mehr als eine Seite hinzufügt, muss die Erweiterung die Zusammenfassungs Daten in einer Zeichenfolge kombinieren.</span><span class="sxs-lookup"><span data-stu-id="d45ef-125">**GetSummaryInfo** is only called one time for each extension, not per page, so if the object creation extension adds more than one page, the extension must combine the summary data into one string.</span></span>

<span data-ttu-id="d45ef-126">Wenn der Benutzer auf der Seite "Fertigstellen" auf die Schaltfläche **Fertig** stellen klickt, ruft der Assistent jede der [**idsadminnewobjext:: schreitedata**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-writedata) -Methoden der Erweiterung mit dem **DSA \_ newobj \_ ctx- \_ vorCOMMIT** -Kontext auf.</span><span class="sxs-lookup"><span data-stu-id="d45ef-126">When the user clicks the **Finish** button in the "Finish" page, the wizard calls each of the extension's [**IDsAdminNewObjExt::WriteData**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-writedata) methods with the **DSA\_NEWOBJ\_CTX\_PRECOMMIT** context.</span></span> <span data-ttu-id="d45ef-127">Wenn dies auftritt, sollte die Erweiterung die gesammelten Daten mithilfe der [**IADs::P UT**](/windows/desktop/api/iads/nf-iads-iads-put) -Methode oder der [**IADs::P utex**](/windows/desktop/api/iads/nf-iads-iads-putex) -Methode in die entsprechenden Eigenschaften schreiben.</span><span class="sxs-lookup"><span data-stu-id="d45ef-127">When this occurs, the extension should write the gathered data into the appropriate properties using the [**IADs::Put**](/windows/desktop/api/iads/nf-iads-iads-put) or [**IADs::PutEx**](/windows/desktop/api/iads/nf-iads-iads-putex) method.</span></span> <span data-ttu-id="d45ef-128">Die [**IADs**](/windows/desktop/api/iads/nn-iads-iads) -Schnittstelle wird der Erweiterung in der [**idsadminnewobjext::**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-setobject) Server-Methode bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="d45ef-128">The [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface is provided to the extension in the [**IDsAdminNewObjExt::SetObject**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-setobject) method.</span></span> <span data-ttu-id="d45ef-129">Die Erweiterung sollte die zwischengespeicherten Eigenschaften nicht durch Aufrufen von " [**IADs:: abtinfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo)" ausführen.</span><span class="sxs-lookup"><span data-stu-id="d45ef-129">The extension should not commit the cached properties by calling [**IADs::SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo).</span></span> <span data-ttu-id="d45ef-130">Wenn alle Eigenschaften geschrieben wurden, führt die primäre Objekt Erstellungs Erweiterung einen Commit für die Änderungen durch Aufrufen von **IADs:: SetInfo** durch.</span><span class="sxs-lookup"><span data-stu-id="d45ef-130">When all of the properties have been written, the primary object creation extension commits the changes by calling **IADs::SetInfo**.</span></span> <span data-ttu-id="d45ef-131">Dies wird im folgenden ausführlicher erläutert.</span><span class="sxs-lookup"><span data-stu-id="d45ef-131">This is discussed in more detail below.</span></span>

<span data-ttu-id="d45ef-132">Wenn ein Fehler auftritt, wird die Erweiterung über den Fehler benachrichtigt, und während des Vorgangs ist Sie aufgetreten, als die [**idsadminnewobjext:: OnError**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-onerror) -Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="d45ef-132">If an error occurs, the extension will be notified of the error and during which operation it occurred when the [**IDsAdminNewObjExt::OnError**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-onerror) method is called.</span></span>

## <a name="implementing-a-primary-object-creation-wizard"></a><span data-ttu-id="d45ef-133">Implementieren eines primären Objekterstellungs-Assistenten</span><span class="sxs-lookup"><span data-stu-id="d45ef-133">Implementing a Primary Object Creation Wizard</span></span>

<span data-ttu-id="d45ef-134">Die Implementierung eines Assistenten für die Erstellung von primären Objekten ist mit dem Assistenten für die Erstellung sekundärer Objekte identisch, mit dem Unterschied, dass ein primärer Objekterstellungs-Assistent einige weitere Schritte</span><span class="sxs-lookup"><span data-stu-id="d45ef-134">The implementation of a primary object creation wizard is identical to a secondary object creation wizard, except that a primary object creation wizard must perform a few more steps.</span></span>

<span data-ttu-id="d45ef-135">Bevor die erste Seite verworfen wird, muss der Objekterstellungs-Assistent das temporäre Verzeichnis Objekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="d45ef-135">Prior to the first page being dismissed, the object creation wizard must create the temporary directory object.</span></span> <span data-ttu-id="d45ef-136">Um dies zu erreichen, müssen Sie die [**idsadminnewobjprimarysite:: kreatenew**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjprimarysite-createnew) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="d45ef-136">To do this, call the [**IDsAdminNewObjPrimarySite::CreateNew**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjprimarysite-createnew) method.</span></span> <span data-ttu-id="d45ef-137">Ein Zeiger auf die [**idsadminnewobjprimarysite**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobjprimarysite) -Schnittstelle wird durch Aufrufen von " [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) " mit **IID " \_ idsadminnewobjprimarysite** " in der Schnittstelle " [**idsadminnewobj**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobj) " abgerufen, die an " [**idsadminnewobjext:: Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-initialize)" übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="d45ef-137">A pointer to the [**IDsAdminNewObjPrimarySite**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobjprimarysite) interface is obtained by calling [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) with **IID\_IDsAdminNewObjPrimarySite** on the [**IDsAdminNewObj**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobj) interface that is passed to [**IDsAdminNewObjExt::Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-initialize).</span></span> <span data-ttu-id="d45ef-138">Die **kreatenew** -Methode erstellt ein neues temporäres Objekt und ruft [**idsadminnewobjext:: SetObject**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-setobject) für jede Erweiterung auf.</span><span class="sxs-lookup"><span data-stu-id="d45ef-138">The **CreateNew** method creates a new temporary object and calls [**IDsAdminNewObjExt::SetObject**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-setobject) for each extension.</span></span>

<span data-ttu-id="d45ef-139">Wenn ein Objekterstellungs-Assistent mehr als eine Seite enthält, implementiert das System eine Seite "Fertigstellen", auf der eine Zusammenfassung der zu speichernden Objektinformationen angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="d45ef-139">When an object creation wizard contains more than one page, the system implements a "Finish" page that displays a summary of the object information to be saved.</span></span> <span data-ttu-id="d45ef-140">Wenn Sie auf die Schaltfläche **Fertig** stellen auf der Seite "Fertigstellen" klicken, ruft das System jede der [**idsadminnewobjext:: schreitedata**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-writedata) -Methode der Objekt Erstellungs Erweiterung auf und führt dann ein Commit für das temporäre Objekt in den persistenten Speicher aus.</span><span class="sxs-lookup"><span data-stu-id="d45ef-140">When the **Finish** button on the "Finish" page is clicked, the system will call each of the object creation extension's [**IDsAdminNewObjExt::WriteData**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjext-writedata) method and then commit the temporary object to persistent memory.</span></span> <span data-ttu-id="d45ef-141">Wenn der Objekterstellungs-Assistent jedoch nur eine Seite enthält, enthält die Seite die Schaltflächen **OK** und **Abbrechen** anstelle der Schaltflächen **zurück**, **weiter** und **Abbrechen** , die normalerweise in einem Assistenten gefunden werden, und es wird keine Seite "Fertigstellen" bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="d45ef-141">If, however, the object creation wizard only contains one page, the page will have **OK** and **Cancel** buttons instead of the **Back**, **Next** and **Cancel** buttons normally found in a wizard and no "Finish" page is provided.</span></span> <span data-ttu-id="d45ef-142">Aus diesem Grund muss ein Erweiterungs-Assistent für eine Einzelseiten-Objekt Erstellung [**idsadminnewobjprimarysite:: Commit**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjprimarysite-commit) zum Ausführen der Schreib-und Speichervorgänge aufruft.</span><span class="sxs-lookup"><span data-stu-id="d45ef-142">Because of this, a single-page object creation extension wizard must call [**IDsAdminNewObjPrimarySite::Commit**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjprimarysite-commit) to perform the write and save operations.</span></span> <span data-ttu-id="d45ef-143">Eine einseitige Erweiterung für das primäre Objekt Erstellungs Erweiterung sollte " **Commit** " als Antwort auf die " [**PSN \_ witzfinish**](../controls/psn-wizfinish.md) "-Benachrichtigung aufruft.</span><span class="sxs-lookup"><span data-stu-id="d45ef-143">A single-page primary object creation extension should call **Commit** in response to the [**PSN\_WIZFINISH**](../controls/psn-wizfinish.md) notification.</span></span>

<span data-ttu-id="d45ef-144">Da andere Erweiterungen zum Erstellen von Objekten dem Assistenten Seiten hinzufügen können, weiß die primäre Objekt Erstellungs Erweiterung möglicherweise nicht, ob im Assistenten mehr als eine Seite vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="d45ef-144">Because other object creation extensions can add pages to the wizard, the primary object creation extension may not know if there is more than one page in the wizard.</span></span> <span data-ttu-id="d45ef-145">Dies ist aus zwei Gründen kein Problem: Wenn das System z. b. die Seite "Fertigstellen" implementiert, empfängt die primäre Objekt Erstellungs Erweiterung die " [**PSN- \_ dernext**](../controls/psn-wiznext.md) "-Benachrichtigung anstelle der " **PSN- \_ weiter** -Benachrichtigung".</span><span class="sxs-lookup"><span data-stu-id="d45ef-145">This is not an issue for two reasons: First, if the system implements the "Finish" page, the primary object creation extension will receive the [**PSN\_WIZNEXT**](../controls/psn-wiznext.md) notification instead of the **PSN\_WIZNEXT** notification.</span></span> <span data-ttu-id="d45ef-146">Im zweiten Fall schlägt [**Commit**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjprimarysite-commit) unnötig fehl, wenn der Assistent mehr als eine Seite enthält.</span><span class="sxs-lookup"><span data-stu-id="d45ef-146">Second, [**Commit**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnewobjprimarysite-commit) will fail harmlessly if the wizard contains more than one page.</span></span>

 

 