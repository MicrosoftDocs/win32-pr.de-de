---
title: Auflisten von Benutzern
description: Anders als Windows NT 4,0-Domänen können Windows 2000-Benutzer in einem beliebigen Container oder einer Organisationseinheit (OE) in einer Domäne und im Stammverzeichnis der Domäne abgelegt werden.
ms.assetid: 4a35af7a-f43b-4cf9-a030-77f6c2518ae7
ms.tgt_platform: multiple
keywords:
- Auflisten von Benutzern anzeigen
- Benutzer AD, Auflisten eines Benutzers
- Active Directory, verwenden von Benutzern, Auflisten eines Benutzers
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e922d92f4313ed0238ff068f7ae1c0fbf693d497
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "106340695"
---
# <a name="enumerating-users"></a><span data-ttu-id="3e593-106">Auflisten von Benutzern</span><span class="sxs-lookup"><span data-stu-id="3e593-106">Enumerating Users</span></span>

<span data-ttu-id="3e593-107">Anders als Windows NT 4,0-Domänen können Windows 2000-Benutzer in einem beliebigen Container oder einer Organisationseinheit (OE) in einer Domäne und im Stammverzeichnis der Domäne abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="3e593-107">Unlike Windows NT 4.0 domains, Windows 2000 users can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="3e593-108">Dies bedeutet, dass sich Benutzer an zahlreichen Orten in der Verzeichnishierarchie befinden können.</span><span class="sxs-lookup"><span data-stu-id="3e593-108">This means that users can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="3e593-109">Daher haben Sie zwei Möglichkeiten zum Auflisten von Benutzern:</span><span class="sxs-lookup"><span data-stu-id="3e593-109">Therefore, you have two choices for enumerating users:</span></span>

-   <span data-ttu-id="3e593-110">Listet die Benutzer auf, die direkt in einem Container, in einer Organisationseinheit oder im Stammverzeichnis der Domäne enthalten sind:</span><span class="sxs-lookup"><span data-stu-id="3e593-110">Enumerate the users directly contained in a container, OU, or at the root of the domain:</span></span>

    <span data-ttu-id="3e593-111">Binden Sie explizit an das Container Objekt, das die Benutzer enthält, die Sie aufzählen möchten, legen Sie mithilfe der [**IADsContainer. Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) -Eigenschaft einen Filter mit "User" als Klasse fest, und verwenden Sie die [**IADsContainer:: get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) -Methode, um die Benutzer Objekte aufzuzählen.</span><span class="sxs-lookup"><span data-stu-id="3e593-111">Explicitly bind to the container object that contains the users you are interested in enumerating, set a filter containing "user" as the class using the [**IADsContainer.Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the user objects.</span></span>

    <span data-ttu-id="3e593-112">Dieses Verfahren kann zum Auflisten von Benutzern verwendet werden, die direkt in einem Container-oder OU-Objekt enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="3e593-112">This technique can be used to enumerate users that are directly contained in a container or OU object.</span></span> <span data-ttu-id="3e593-113">Wenn der Container andere Container enthält, die potenziell andere Benutzer enthalten können, müssen Sie eine Bindung an diese Container durchlaufen und die Benutzer in diesen Containern rekursiv auflisten.</span><span class="sxs-lookup"><span data-stu-id="3e593-113">If the container contains other containers that can potentially contain other users, you must bind to those containers and recursively enumerate the users on those containers.</span></span> <span data-ttu-id="3e593-114">Wenn es nicht erforderlich ist, dass Sie die Benutzer Objekte bearbeiten und nur bestimmte Eigenschaften lesen müssen, verwenden Sie die in Option 2 beschriebene Deep-Suche.</span><span class="sxs-lookup"><span data-stu-id="3e593-114">If it is not required that you manipulate the user objects, and only need to read specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="3e593-115">Da die Enumeration Zeiger auf ADSI COM-Objekte zurückgibt, die die einzelnen Benutzer Objekte darstellen, können Sie [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) zum Abrufen von [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser)und [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) -Schnittstellen Zeigern auf das User-Objekt abrufen.</span><span class="sxs-lookup"><span data-stu-id="3e593-115">Because enumeration returns pointers to ADSI COM objects representing each user object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the user object.</span></span> <span data-ttu-id="3e593-116">Dies bedeutet, dass Sie Schnittstellen Zeiger auf jedes enumerationsbenutzerobjekt in einem Container erhalten können, ohne explizit eine Bindung an jedes Benutzerobjekt durchführen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="3e593-116">This means you can get interface pointers to each enumerated user object in a container without having to explicitly bind to each user object.</span></span> <span data-ttu-id="3e593-117">Zum Ausführen von Vorgängen für alle Benutzer, die sich direkt in einem Container befinden, vermeidet die Enumeration die Bindung an jeden Benutzer, um **IADs** oder **IADsUser** -Methoden aufrufen zu können.</span><span class="sxs-lookup"><span data-stu-id="3e593-117">To perform operations on all the users directly within a container, enumeration avoids having to bind to each user in order to call **IADs** or **IADsUser** methods.</span></span> <span data-ttu-id="3e593-118">Um bestimmte Eigenschaften von Benutzern abzurufen, verwenden Sie [**idirectoriysearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) , wie in Option 2 beschrieben.</span><span class="sxs-lookup"><span data-stu-id="3e593-118">To retrieve specific properties from users, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in option 2.</span></span>

-   <span data-ttu-id="3e593-119">Führen Sie eine Tiefe Suche nach (& (objectClass = User) (objectCategory = Person)) aus, um alle Benutzer in einer Struktur zu finden:</span><span class="sxs-lookup"><span data-stu-id="3e593-119">Perform a deep search for (&(objectClass=user)(objectCategory=person)) to find all users in a tree:</span></span>

    <span data-ttu-id="3e593-120">Binden Sie zunächst an das Container Objekt, in dem die Suche beginnen soll.</span><span class="sxs-lookup"><span data-stu-id="3e593-120">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="3e593-121">Wenn Sie z. b. alle Benutzer in einer Domäne suchen möchten, binden Sie die Bindung an den Stamm der Domäne ein. um alle Benutzer in der Gesamtstruktur zu suchen, binden Sie an den globalen Katalog, und suchen Sie aus dem Stammverzeichnis der GC.</span><span class="sxs-lookup"><span data-stu-id="3e593-121">For example, to find all users in a domain, bind to root of the domain; to find all users in the forest, bind to the global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="3e593-122">Verwenden Sie dann [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) zum Abfragen mithilfe eines Suchfilters, der (& (objectClass = User) (objectCategory = Person)) und der Such Einstellung der \_ Unterstruktur des ADS-Bereichs enthält \_ .</span><span class="sxs-lookup"><span data-stu-id="3e593-122">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter containing (&(objectClass=user)(objectCategory=person)) and search preference of ADS\_SCOPE\_SUBTREE.</span></span>

    <span data-ttu-id="3e593-123">Sie können eine Suche mit einer Such Einstellung von ADS \_ Scope \_ onelevel durchführen, um die Suche auf den direkten Inhalt des Container Objekts zu beschränken, an das Sie gebunden sind.</span><span class="sxs-lookup"><span data-stu-id="3e593-123">You can perform a search with a search preference of ADS\_SCOPE\_ONELEVEL to limit the search to the direct contents of the container object that you bound to.</span></span>

    <span data-ttu-id="3e593-124">[**Idirector ysearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) ruft nur die Werte spezifischer Eigenschaften von Benutzern ab.</span><span class="sxs-lookup"><span data-stu-id="3e593-124">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from users.</span></span> <span data-ttu-id="3e593-125">Um Werte abzurufen, verwenden Sie **idirector ysearch**.</span><span class="sxs-lookup"><span data-stu-id="3e593-125">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="3e593-126">Um die von einer Suche zurückgegebenen Benutzer Objekte zu bearbeiten, d. h., Sie möchten [**IADs**](/windows/desktop/api/iads/nn-iads-iads) oder [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) -Methoden verwenden, müssen Sie Sie explizit binden.</span><span class="sxs-lookup"><span data-stu-id="3e593-126">To manipulate the user objects returned from a search, that is, you want to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) methods, you must explicitly bind to them.</span></span> <span data-ttu-id="3e593-127">Geben Sie zu diesem Zweck "Distinguished **shedname** " als eine der Eigenschaften an, die von der Suche zurückgegeben werden sollen, und verwenden Sie die zurückgegebenen Distinguished Names zum Binden an jeden Benutzer, der in der Suche zurückgegeben</span><span class="sxs-lookup"><span data-stu-id="3e593-127">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each user returned in the search.</span></span>

    <span data-ttu-id="3e593-128">Es werden nur bestimmte Eigenschaften abgerufen.</span><span class="sxs-lookup"><span data-stu-id="3e593-128">Only specific properties are retrieved.</span></span> <span data-ttu-id="3e593-129">Sie können nicht alle Attribute abrufen, ohne explizit alle möglichen Attribute der Benutzerklasse anzugeben.</span><span class="sxs-lookup"><span data-stu-id="3e593-129">You cannot retrieve all attributes without explicitly specifying every possible attribute of the user class.</span></span>

 

 