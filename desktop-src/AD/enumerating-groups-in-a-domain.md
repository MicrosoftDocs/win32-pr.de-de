---
title: Auflisten von Gruppen in einer Domäne
description: Gruppen können in einem beliebigen Container oder einer Organisationseinheit (OE) in einer Domäne und im Stammverzeichnis der Domäne abgelegt werden.
ms.assetid: 7f9d3c90-b6f4-4bfa-960f-58f380aa487c
ms.tgt_platform: multiple
keywords:
- Auflisten von Gruppen in einer Domänen-AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3586b8c6d261c769cabe56def2aa9396a58fa3a5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724561"
---
# <a name="enumerating-groups-in-a-domain"></a><span data-ttu-id="b6f9a-104">Auflisten von Gruppen in einer Domäne</span><span class="sxs-lookup"><span data-stu-id="b6f9a-104">Enumerating Groups in a Domain</span></span>

<span data-ttu-id="b6f9a-105">Gruppen können in einem beliebigen Container oder einer Organisationseinheit (OE) in einer Domäne und im Stammverzeichnis der Domäne abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-105">Groups can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="b6f9a-106">Dies bedeutet, dass sich Gruppen an verschiedenen Speicherorten in der Verzeichnishierarchie befinden können.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-106">This means that groups can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="b6f9a-107">Daher haben Sie zwei Möglichkeiten zum Auflisten von Gruppen:</span><span class="sxs-lookup"><span data-stu-id="b6f9a-107">Therefore, you have two choices for enumerating groups:</span></span>

1.  <span data-ttu-id="b6f9a-108">Listet die Gruppen auf, die direkt in einem Container, in einer Organisationseinheit oder im Stammverzeichnis der Domäne enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-108">Enumerate the groups directly contained in a container, OU, or at the root of the domain.</span></span>

    <span data-ttu-id="b6f9a-109">Binden Sie explizit an das Container Objekt, das die aufzuzählenden Gruppen enthält, legen Sie mithilfe der [**IADsContainer. Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) -Eigenschaft einen Filter fest, der "Groups" als Klasse enthält, und verwenden Sie die [**IADsContainer:: get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) -Methode, um die Gruppen Objekte aufzuzählen.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-109">Explicitly bind to the container object that contains the groups to enumerate, set a filter that contains "groups" as the class using the [**IADsContainer.Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the group objects.</span></span>

    <span data-ttu-id="b6f9a-110">Diese Technik listet Gruppen auf, die direkt in einem Container-oder OU-Objekt enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-110">This technique enumerates groups contained directly in a container or OU object.</span></span> <span data-ttu-id="b6f9a-111">Wenn der Container andere Container enthält, die potenziell andere Gruppen enthalten können, müssen Sie eine Bindung an diese Container durchlaufen und die Gruppen für diese Container rekursiv aufzählen.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-111">If the container contains other containers that can potentially contain other groups, you must bind to those containers and recursively enumerate the groups on those containers.</span></span> <span data-ttu-id="b6f9a-112">Wenn Sie die Gruppen Objekte und schreibgeschützte Eigenschaften bearbeiten möchten, verwenden Sie die in Option 2 beschriebene Tiefe Suche.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-112">To manipulate the group objects and read only specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="b6f9a-113">Da die Enumeration Zeiger auf ADSI COM-Objekte zurückgibt, die die einzelnen Gruppen Objekte darstellen, können Sie [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) zum Abrufen von [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup)und [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) -Schnittstellen Zeigern auf das Group-Objekt abrufen. Das heißt, Sie können Schnittstellen Zeiger auf jedes enumerierte Gruppen Objekt in einem Container aufrufen, ohne explizit eine Bindung an jedes Group-Objekt durchführen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-113">Because enumeration returns pointers to ADSI COM objects representing each group object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the group object; that is, you can get interface pointers to each enumerated group object in a container without having to explicitly bind to each group object.</span></span> <span data-ttu-id="b6f9a-114">Zum Ausführen von Vorgängen für alle Gruppen direkt innerhalb eines Containers erfordert die Enumeration keine Bindung an jede Gruppe, um **IADs** oder **IADsGroup** -Methoden aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-114">To perform operations on all the groups directly within a container, enumeration does not require binding to each group in order to call **IADs** or **IADsGroup** methods.</span></span> <span data-ttu-id="b6f9a-115">Um bestimmte Eigenschaften aus Gruppen abzurufen, verwenden Sie [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) , wie in der zweiten Option beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-115">To retrieve specific properties from groups, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in the second option.</span></span>

    <span data-ttu-id="b6f9a-116">Eine Ausnahme hiervon tritt auf, wenn Sie versuchen, eine Gruppe aufzulisten, die Mitglieder mit bekannten Sicherheits Prinzipalen ist, z. b. "alle", "authentifizierte Benutzer", "Batch" usw.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-116">An exception to this occurs when you attempt to enumerate a group that contains members that are wellKnown security principals, such as Everyone, Authenticated users, BATCH, and so on.</span></span> <span data-ttu-id="b6f9a-117">Da Sie keine Bindung an diese Objekttypen haben, werden Sie nicht aufgelistet, wenn Sie Gruppen im WinNT-Bereich auflisten, auch wenn Sie möglicherweise gebunden werden, da bestimmte IADs-Methoden wie Class, ADsPath und Name beim Aufruf für Enumerationsmember korrekte Ergebnisse zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-117">Because you cannot bind to these types of objects, they are not listed when you enumerate groups in the WinNT scope, even though it may appear to bind, because certain IADs methods such as Class, ADsPath, and Name return correct results when invoked on enumerated members.</span></span>

2.  <span data-ttu-id="b6f9a-118">Führen Sie eine Tiefe Suche nach "objectCategory = Group" durch, um alle Gruppen in einer Struktur zu finden.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-118">Perform a deep search for "objectCategory=group" to find all groups in a tree.</span></span>

    <span data-ttu-id="b6f9a-119">Binden Sie zunächst an das Container Objekt, in dem die Suche beginnen soll.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-119">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="b6f9a-120">Um z. b. alle Gruppen in einer Domäne zu suchen, binden Sie an den Stamm der Domäne. Wenn Sie alle Gruppen in der Gesamtstruktur suchen möchten, binden Sie Sie an den globalen Katalog, und suchen Sie aus dem Stammverzeichnis der GC.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-120">For example, to find all groups in a domain, bind to root of the domain; to find all groups in the forest, bind to global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="b6f9a-121">Verwenden Sie dann [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) , um mithilfe eines Suchfilters, der (objectCategory = Group) enthält, und der Such Einstellung der **ADS- \_ Bereichs \_ Teilstruktur** eine Abfrage durchführen.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-121">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter that contains (objectCategory=group) and search preference of **ADS\_SCOPE\_SUBTREE**.</span></span>

    > [!Note]  
    > <span data-ttu-id="b6f9a-122">Sie können eine Suche mit einer Such Einstellung von **ADS \_ Scope \_ onelevel** durchführen, um die Suche auf den direkten Inhalt des Container Objekts zu beschränken, an das Sie gebunden sind.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-122">You can perform a search with a search preference of **ADS\_SCOPE\_ONELEVEL** to limit the search to the direct contents of the container object that you bound to.</span></span>

     

    <span data-ttu-id="b6f9a-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) ruft nur die Werte spezifischer Eigenschaften aus Gruppen ab.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from groups.</span></span> <span data-ttu-id="b6f9a-124">Um Werte abzurufen, verwenden Sie **idirector ysearch**.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-124">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="b6f9a-125">Um die von einer Suche zurückgegebenen Gruppen Objekte zu bearbeiten, d. h., um [**IADs**](/windows/desktop/api/iads/nn-iads-iads) oder [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) -Methoden zu verwenden, binden Sie explizit an Sie.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-125">To manipulate the group objects returned from a search, that is, to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) methods, explicitly bind to them.</span></span> <span data-ttu-id="b6f9a-126">Geben Sie zu diesem Zweck "Distinguished **shedname** " als eine der Eigenschaften an, die von der Suche zurückgegeben werden sollen, und verwenden Sie die zurückgegebenen Distinguished Names zum Binden an jede in der Suche zurückgegebene Gruppe.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-126">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each group returned in the search.</span></span>

    <span data-ttu-id="b6f9a-127">Es werden nur bestimmte Eigenschaften abgerufen.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-127">Only specific properties are retrieved.</span></span> <span data-ttu-id="b6f9a-128">Sie können nicht alle Attribute abrufen, ohne explizit alle möglichen Attribute der Group-Klasse anzugeben.</span><span class="sxs-lookup"><span data-stu-id="b6f9a-128">You cannot retrieve all attributes without explicitly specifying every possible attribute of the group class.</span></span>

 

 