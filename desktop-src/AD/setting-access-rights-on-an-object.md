---
title: Festlegen von Zugriffsrechten für ein Objekt
description: In diesem Thema wird beschrieben, wie ein ACE für ein Zugriffsrecht erstellt und dieser ACE für die DACL eines Objekts festgelegt wird.
ms.assetid: c0b45709-4652-46c7-8d52-44076802d109
ms.tgt_platform: multiple
keywords:
- Festlegen von Zugriffsrechten für ein Objekt
- Objekte AD, Festlegen von Zugriffsrechten für ein Objekt
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2bcf54de381dab2af1dab4ea44654fb0a5682f06
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "104472468"
---
# <a name="setting-access-rights-on-an-object"></a><span data-ttu-id="a2503-105">Festlegen von Zugriffsrechten für ein Objekt</span><span class="sxs-lookup"><span data-stu-id="a2503-105">Setting Access Rights on an Object</span></span>

<span data-ttu-id="a2503-106">Bei Verwendung der ADSI-COM-Objekte [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (Sicherheits Beschreibung), [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (DACLs und SACLs) und [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) zum Hinzufügen eines ACE zu einer ACL nehmen Sie Änderungen an der **ntSecurityDescriptor** -Eigenschaft des angegebenen Objekts im Eigenschafts Cache vor.</span><span class="sxs-lookup"><span data-stu-id="a2503-106">When using the ADSI COM objects [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (security descriptor), [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (DACLs and SACLs), and [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) to add an ACE to a ACL, you are making changes to the **nTSecurityDescriptor** property of the specified object in the property cache.</span></span> <span data-ttu-id="a2503-107">Dies bedeutet, dass Put-Methoden für die Objekte, die den neuen ACE enthalten, und die [**IADs. SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) -Methode aufgerufen werden müssen, um die aktualisierte Sicherheits Beschreibung aus dem Eigenschafts Cache in das Verzeichnis zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="a2503-107">This means put methods on the objects that contain the new ACE and the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method must be called in order to write the updated security descriptor to the directory from the property cache.</span></span>

<span data-ttu-id="a2503-108">Weitere Informationen und ein Codebeispiel, in dem ein ACE für ein Objekt in Active Directory Domain Services festgelegt wird, finden Sie unter [Beispielcode für das Festlegen eines ACE für ein Verzeichnis Objekt](example-code-for-setting-an-ace-on-a-directory-object.md).</span><span class="sxs-lookup"><span data-stu-id="a2503-108">For more information and a code example that sets an ACE on an object in Active Directory Domain Services, see [Example Code for Setting an ACE on a Directory Object](example-code-for-setting-an-ace-on-a-directory-object.md).</span></span>

<span data-ttu-id="a2503-109">Verwenden Sie den folgenden allgemeinen Prozess, um einen ACE für ein Zugriffsrecht zu erstellen und diesen ACE für die DACL eines Objekts festzulegen.</span><span class="sxs-lookup"><span data-stu-id="a2503-109">Use the following general process to create an ACE for an access right and setting that ACE on the DACL of an object.</span></span>

1.  <span data-ttu-id="a2503-110">Einen [**IADs**](/windows/desktop/api/iads/nn-iads-iads) -Schnittstellen Zeiger auf das-Objekt zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a2503-110">Get an [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface pointer to the object.</span></span>
2.  <span data-ttu-id="a2503-111">Verwenden Sie die [**IADs. Get**](/windows/desktop/api/iads/nf-iads-iads-get) -Methode, um die Sicherheits Beschreibung des-Objekts zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a2503-111">Use the [**IADs.Get**](/windows/desktop/api/iads/nf-iads-iads-get) method to get the security descriptor of the object.</span></span> <span data-ttu-id="a2503-112">Der Name der Eigenschaft, die die Sicherheits Beschreibung enthält, ist **ntSecurityDescriptor**.</span><span class="sxs-lookup"><span data-stu-id="a2503-112">The name of the property containing the security descriptor is **nTSecurityDescriptor**.</span></span> <span data-ttu-id="a2503-113">Die-Eigenschaft wird als [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) zurückgegeben, die einen [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) -Zeiger enthält (das **VT** -Element ist **VT \_ Dispatch**).</span><span class="sxs-lookup"><span data-stu-id="a2503-113">The property will be returned as a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) containing an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer (the **vt** member is **VT\_DISPATCH**).</span></span> <span data-ttu-id="a2503-114">Aufrufen von **QueryInterface** für diesen **IDispatch** -Zeiger, um eine [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) -Schnittstelle zu erhalten, mit der die Methoden für diese Schnittstelle für den Zugriff auf die ACL der Sicherheits Beschreibung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a2503-114">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) interface to use the methods on that interface to access the security descriptor's ACL.</span></span>
3.  <span data-ttu-id="a2503-115">Verwenden Sie die Eigenschaft [**IADsSecurityDescriptor. diskretionaryacl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) , um die DACL zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a2503-115">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to get the DACL.</span></span> <span data-ttu-id="a2503-116">Die-Methode gibt einen [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) -Zeiger zurück.</span><span class="sxs-lookup"><span data-stu-id="a2503-116">The method returns an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="a2503-117">Ruft **QueryInterface** für diesen **IDispatch** -Zeiger auf, um eine [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) -Schnittstelle zu erhalten, mit der die Methoden für diese Schnittstelle für den Zugriff auf die einzelnen ACEs in der ACL verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a2503-117">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) interface to use the methods on that interface to access the individual ACEs in the ACL.</span></span>
4.  <span data-ttu-id="a2503-118">Verwenden Sie [**cokreateinstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) , um das ADSI COM-Objekt für den neuen ACE zu erstellen, und rufen Sie einen [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) -Schnittstellen Zeiger auf dieses Objekt ab.</span><span class="sxs-lookup"><span data-stu-id="a2503-118">Use [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to create the ADSI COM object for the new ACE and get an [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface pointer to that object.</span></span> <span data-ttu-id="a2503-119">Beachten Sie, dass die Klassen-ID CLSID \_ AccessControlEntry ist.</span><span class="sxs-lookup"><span data-stu-id="a2503-119">Be aware that the class ID is CLSID\_AccessControlEntry.</span></span>
5.  <span data-ttu-id="a2503-120">Legen Sie die Eigenschaften des ACE mithilfe der [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) -Methoden fest:</span><span class="sxs-lookup"><span data-stu-id="a2503-120">Set the properties of the ACE using the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) methods:</span></span>

    1.  <span data-ttu-id="a2503-121">Verwenden Sie [**IADsAccessControlEntry::p \_ UT**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) -Vertrauens nehmer, um den Treuhänder festzulegen, für den dieser ACE gilt.</span><span class="sxs-lookup"><span data-stu-id="a2503-121">Use [**IADsAccessControlEntry::put\_Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) to set the trustee to whom this ACE applies.</span></span> <span data-ttu-id="a2503-122">Der Vertrauens nehmer ist ein Benutzer, eine Gruppe oder ein anderer Sicherheits Prinzipal.</span><span class="sxs-lookup"><span data-stu-id="a2503-122">The trustee is a user, group, or other security principal.</span></span> <span data-ttu-id="a2503-123">Die Anwendung sollte den Wert aus der entsprechenden Eigenschaft aus dem Benutzer-oder Gruppen Objekt des Vertrauens nehmers verwenden, auf den Sie den ACE anwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="a2503-123">Your application should use the value from the appropriate property from the user or group object of the trustee to which you want to apply the ACE.</span></span> <span data-ttu-id="a2503-124">Der Vertrauens nehmer ist als **BSTR** angegeben und kann die folgenden Formen annehmen:</span><span class="sxs-lookup"><span data-stu-id="a2503-124">The trustee is specified as a **BSTR** and can take the following forms:</span></span>
        -   <span data-ttu-id="a2503-125">Das Domänen Konto (der Anmelde Name, das in einer früheren Version von Windows NT verwendet wurde) im Format " <domain> \\ <user account> ", wobei " &lt; Domäne &gt; " der Name der Windows NT-Domäne mit dem Benutzer und " &lt; Benutzerkonto &gt; " ist die **sAMAccountName** -Eigenschaft des angegebenen Benutzers.</span><span class="sxs-lookup"><span data-stu-id="a2503-125">Domain account (the logon name used in a previous version of Windows NT) of the form "<domain>\\<user account>" where "&lt;domain&gt;" is the name of the Windows NT domain that contains the user and "&lt;user account&gt;" is the **sAMAccountName** property of the specified user.</span></span> <span data-ttu-id="a2503-126">Beispiel: "Fabrikam \\ JeffSmith".</span><span class="sxs-lookup"><span data-stu-id="a2503-126">For example: "fabrikam\\jeffsmith".</span></span>
        -   <span data-ttu-id="a2503-127">Ein bekannter Sicherheits Prinzipal, der besondere Identitäten darstellt, die vom Windows NT-Sicherheitssystem definiert werden, wie z. b. "alle", "Lokales System", "Prinzipal selbst", "authentifizierter Benutzer", "Ersteller</span><span class="sxs-lookup"><span data-stu-id="a2503-127">Well-known security principal that represents special identities defined by the Windows NT security system, such as everyone, local system, principal self, authenticated user, creator owner, and so on.</span></span> <span data-ttu-id="a2503-128">Die-Objekte, die die bekannten Sicherheits Prinzipale darstellen, werden im Container für bekannte Sicherheits Prinzipale unterhalb des Konfigurations Containers gespeichert.</span><span class="sxs-lookup"><span data-stu-id="a2503-128">The objects representing the well-known security principals are stored in the Well Known Security Principals container beneath the Configuration container.</span></span> <span data-ttu-id="a2503-129">Beispielsweise anonyme Anmeldung.</span><span class="sxs-lookup"><span data-stu-id="a2503-129">For example, anonymous logon.</span></span>
        -   <span data-ttu-id="a2503-130">Integrierte Gruppe, die die integrierten Benutzergruppen darstellt, die vom Windows NT-Sicherheitssystem definiert werden.</span><span class="sxs-lookup"><span data-stu-id="a2503-130">Built-in group that represent the built-in user groups defined by the Windows NT security system.</span></span> <span data-ttu-id="a2503-131">Sie hat die Form "Builtin \\ <group name> ", wobei " &lt; Gruppenname &gt; " der Name der integrierten Benutzergruppe ist.</span><span class="sxs-lookup"><span data-stu-id="a2503-131">It has the form "BUILTIN\\<group name>" where "&lt;group name&gt;" is the name of the built-in user group.</span></span> <span data-ttu-id="a2503-132">Die Objekte, die die integrierten Gruppen darstellen, werden im Container "Builtin" unterhalb des Domänen Containers gespeichert.</span><span class="sxs-lookup"><span data-stu-id="a2503-132">The objects representing the built-in groups are stored in the Builtin container beneath the domain container.</span></span> <span data-ttu-id="a2503-133">Beispiel: "Builtin \\ Administrators".</span><span class="sxs-lookup"><span data-stu-id="a2503-133">For example, "BUILTIN\\Administrators".</span></span>
        -   <span data-ttu-id="a2503-134">SID (Zeichen folgen Format) des angegebenen Benutzers, bei dem es sich um die **objectSID** -Eigenschaft des angegebenen Benutzers handelt.</span><span class="sxs-lookup"><span data-stu-id="a2503-134">SID (string format) of the specified user, which is the **objectSID** property of the specified user.</span></span> <span data-ttu-id="a2503-135">Sie können in ein Zeichen folgen Formular konvertieren, indem Sie die [**convertsidtstringsid**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) -Funktion in der Win32-Sicherheits-API verwenden.</span><span class="sxs-lookup"><span data-stu-id="a2503-135">You can convert to string form using the [**ConvertSidToStringSid**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) function in the Win32 Security API.</span></span> <span data-ttu-id="a2503-136">Beispiel: "S-1-5-32-548".</span><span class="sxs-lookup"><span data-stu-id="a2503-136">For example: "S-1-5-32-548".</span></span>
    2.  <span data-ttu-id="a2503-137">Verwenden Sie die [**IADsAccessControlEntry. AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) -Eigenschaft, um die Maske festzulegen, die das Zugriffsrecht angibt.</span><span class="sxs-lookup"><span data-stu-id="a2503-137">Use the [**IADsAccessControlEntry.AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to set the mask that specifies the access right.</span></span> <span data-ttu-id="a2503-138">Die [**AD \_ Rights \_ enum**](/windows/win32/api/iads/ne-iads-ads_rights_enum) -Enumeration gibt die Zugriffsrechte an, die Sie für ein Verzeichnis Objekt festlegen können.</span><span class="sxs-lookup"><span data-stu-id="a2503-138">The [**ADS\_RIGHTS\_ENUM**](/windows/win32/api/iads/ne-iads-ads_rights_enum) enumeration specifies the access rights you can set on a directory object.</span></span>
    3.  <span data-ttu-id="a2503-139">Verwenden Sie die [**IADsAccessControlEntry. AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) -Eigenschaft, um anzugeben, ob die von **AccessMask** festgelegten Zugriffsrechte zugelassen oder verweigert werden.</span><span class="sxs-lookup"><span data-stu-id="a2503-139">Use the [**IADsAccessControlEntry.AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether to allow or deny the access rights set by **AccessMask**.</span></span> <span data-ttu-id="a2503-140">Bei Standard rechten kann es sich um den Zugriff auf den Zugriff auf die Zugriffsberechtigung für den Benutzer oder den Zugriff auf den **\_ \_ Zugriff \_ auf ADS** **\_ \_ \_**</span><span class="sxs-lookup"><span data-stu-id="a2503-140">For standard rights, this can be **ADS\_ACETYPE\_ACCESS\_ALLOWED** or **ADS\_ACETYPE\_ACCESS\_DENIED**.</span></span> <span data-ttu-id="a2503-141">Verwenden Sie für objektspezifische Rechte (Rechte, die für einen bestimmten Teil eines Objekts oder für einen bestimmten Objekttyp gelten) das Objekt " **ADS- \_ AceType- \_ Zugriff \_ zugelassen \_** " oder " **ADS- \_ AceType- \_ \_ \_ Objekt verweigert**".</span><span class="sxs-lookup"><span data-stu-id="a2503-141">For object-specific rights (rights that apply to a specific part of an object or to a specific type of object), use **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT**.</span></span> <span data-ttu-id="a2503-142">Die ADS-Aufzählungs- [**\_ AceType \_**](/windows/win32/api/iads/ne-iads-ads_acetype_enum) -Enumeration gibt die Zugriffs Typen an, die Sie für einen ACE festlegen können.</span><span class="sxs-lookup"><span data-stu-id="a2503-142">The [**ADS\_ACETYPE\_ENUM**](/windows/win32/api/iads/ne-iads-ads_acetype_enum) enumeration specifies the access types you can set on an ACE.</span></span>
    4.  <span data-ttu-id="a2503-143">Verwenden Sie die Eigenschaft [**IADsAccessControlEntry. AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) , um anzugeben, ob andere Container oder Objekte unterhalb des angegebenen Objekts den ACE erben können.</span><span class="sxs-lookup"><span data-stu-id="a2503-143">Use the [**IADsAccessControlEntry.AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether other containers or objects beneath the specified object can inherit the ACE.</span></span> <span data-ttu-id="a2503-144">Die Enumeration " [**ADS \_ aceflag \_ enum**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum) " gibt die Vererbungs Flags an, die Sie für einen ACE festlegen können.</span><span class="sxs-lookup"><span data-stu-id="a2503-144">The [**ADS\_ACEFLAG\_ENUM**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum) enumeration specifies the inheritance flags you can set on an ACE.</span></span>
    5.  <span data-ttu-id="a2503-145">Verwenden Sie die Eigenschaft [**IADsAccessControlEntry. Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) , um anzugeben, ob das Recht für einen bestimmten Teil des Objekts, einen vererbten Objekttyp oder beides gilt.</span><span class="sxs-lookup"><span data-stu-id="a2503-145">Use the [**IADsAccessControlEntry.Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether the right applies to a specific part of the object, an inherited object type, or both.</span></span>
    6.  <span data-ttu-id="a2503-146">Wenn **Flags** auf **ADS Flag- \_ \_ \_ Objekttyp \_ vorhanden** festgelegt ist, legen Sie die [**IADsAccessControlEntry. ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) -Eigenschaft o fest, und geben Sie eine Zeichenfolge mit der GUID der Objektklasse an (für **ADS \_ right \_ DS \_ Create \_ Child** or **ADS \_ right \_ DS \_ Delete \_ Child**), Property, Property Set, validierte Write oder Extended right, auf die der ACE angewendet</span><span class="sxs-lookup"><span data-stu-id="a2503-146">If **Flags** is set to **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property o specify a string containing the GUID of the object class (for **ADS\_RIGHT\_DS\_CREATE\_CHILD** or **ADS\_RIGHT\_DS\_DELETE\_CHILD**), property, property set, validated write, or extended right that the ACE applies to.</span></span> <span data-ttu-id="a2503-147">Die GUID muss als Zeichenfolge der Form angegeben werden, die von der [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) -Funktion in der com-Bibliothek erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="a2503-147">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>
    7.  <span data-ttu-id="a2503-148">Legen Sie die [**IADsAccessControlEntry. eritedobjecttype**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) -Eigenschaft auf fest, um eine Zeichenfolge anzugeben, die die GUID der geerbten Objektklasse enthält, auf die der ACE angewendet wird, wenn **Flags** auf ADS festgelegt sind **\_ \_ \_ \_ \_**.</span><span class="sxs-lookup"><span data-stu-id="a2503-148">If **Flags** is set to **ADS\_FLAG\_INHERITED\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.InheritedObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify a string that contains the GUID of the inherited object class that the ACE applies to.</span></span> <span data-ttu-id="a2503-149">Die GUID muss als Zeichenfolge der Form angegeben werden, die von der [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) -Funktion in der com-Bibliothek erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="a2503-149">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>

6.  <span data-ttu-id="a2503-150">Verwenden Sie die **QueryInterface** -Methode für das [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) -Objekt, um einen [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) -Zeiger zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a2503-150">Use the **QueryInterface** method on the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) object to get an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="a2503-151">Die [**IADsAccessControlList. addace**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) -Methode erfordert einen **IDispatch** -Schnittstellen Zeiger auf den ACE.</span><span class="sxs-lookup"><span data-stu-id="a2503-151">The [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) method requires an **IDispatch** interface pointer to the ACE.</span></span>
7.  <span data-ttu-id="a2503-152">Verwenden Sie [**IADsAccessControlList. addace**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) , um den neuen ACE der DACL hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="a2503-152">Use [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) to add the new ACE to the DACL.</span></span> <span data-ttu-id="a2503-153">Beachten Sie, dass sich die Reihenfolge der ACEs innerhalb der ACL auf die Auswertung des Zugriffs auf das Objekt auswirken kann.</span><span class="sxs-lookup"><span data-stu-id="a2503-153">Be aware that the order of the ACEs within the ACL can affect the evaluation of access to the object.</span></span> <span data-ttu-id="a2503-154">Der richtige Zugriff auf das Objekt erfordert möglicherweise, dass Sie eine neue ACL erstellen, die ACEs aus der vorhandenen ACL in der richtigen Reihenfolge der neuen ACL hinzufügen und dann die vorhandene ACL in der Sicherheits Beschreibung durch die neue ACL ersetzen.</span><span class="sxs-lookup"><span data-stu-id="a2503-154">The correct access to the object may require you to create an new ACL, add the ACEs from the existing ACL in the correct order to the new ACL, and then replace the existing ACL in the security descriptor with the new ACL.</span></span> <span data-ttu-id="a2503-155">Weitere Informationen finden Sie unter [Reihenfolge von ACEs in einer DACL](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl).</span><span class="sxs-lookup"><span data-stu-id="a2503-155">For more information, see [Order of ACEs in a DACL](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl).</span></span>
8.  <span data-ttu-id="a2503-156">Verwenden Sie die Eigenschaft [**IADsSecurityDescriptor. diskretionaryacl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) , um die DACL mit dem neuen ACE in die Sicherheits Beschreibung zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="a2503-156">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to write the DACL containing the new ACE to the security descriptor.</span></span> <span data-ttu-id="a2503-157">Weitere Informationen zu DACLs finden Sie unter [null-DACLs und leere DACLs](null-dacls-and-empty-dacls.md).</span><span class="sxs-lookup"><span data-stu-id="a2503-157">For more information about DACLs, see [Null DACLs and Empty DACLs](null-dacls-and-empty-dacls.md).</span></span>
9.  <span data-ttu-id="a2503-158">Verwenden Sie die [**IADs. Put**](/windows/desktop/api/iads/nf-iads-iads-put) -Methode, um die Sicherheits Beschreibung in die **ntSecurityDescriptor** -Eigenschaft des Objekts in den Eigenschaften Cache zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="a2503-158">Use the [**IADs.Put**](/windows/desktop/api/iads/nf-iads-iads-put) method to write the security descriptor to the object's **nTSecurityDescriptor** property to the property cache.</span></span>
10. <span data-ttu-id="a2503-159">Verwenden Sie die [**IADs. SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) -Methode, um die-Eigenschaft für das Objekt im Verzeichnis zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="a2503-159">Use the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method to update the property on the object in the directory.</span></span>

 

 