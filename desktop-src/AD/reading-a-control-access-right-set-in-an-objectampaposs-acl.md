---
title: Lesen eines Steuerelement Zugriffsrechts, das in der ACL eines Objekts festgelegt ist
description: Die Eigenschaften der IADsAccessControlEntry-Schnittstelle werden verwendet, um Steuerungs Zugriffsrechte zu erteilen oder zu verweigern.
ms.assetid: 2c6fef91-990e-4954-9aff-c9ec72d13972
ms.tgt_platform: multiple
keywords:
- Lesen eines Steuerelement Zugriffsrechts, das in der ACL eines Objekts festgelegt ist Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4877c96a95fc94095c79ad129e8a07b1c786abe1
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "104038741"
---
# <a name="reading-a-control-access-right-set-in-an-objects-acl"></a><span data-ttu-id="d91a4-104">Lesen eines Steuerelement Zugriffsrechts, das in der ACL eines Objekts festgelegt ist</span><span class="sxs-lookup"><span data-stu-id="d91a4-104">Reading a Control Access Right Set in an Object's ACL</span></span>

<span data-ttu-id="d91a4-105">Mit ADSI lesen Sie einen Steuerungs Zugriffsrechten ACE genauso wie jeden anderen ACE in einer ACL.</span><span class="sxs-lookup"><span data-stu-id="d91a4-105">Using ADSI, you read a control access right ACE just as you would any other ACE in an ACL.</span></span> <span data-ttu-id="d91a4-106">Beachten Sie, dass Sie auch die Win32-Sicherheits-APIs zum Lesen von ACLs für Verzeichnisobjekte verwenden können.</span><span class="sxs-lookup"><span data-stu-id="d91a4-106">Be aware that you can also use the Win32 security APIs to read ACLs on directory objects.</span></span> <span data-ttu-id="d91a4-107">Steuerungs Zugriffsrechte verwenden jedoch die Eigenschaften der [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) -Schnittstelle auf eine Weise, die für das erteilen und Verweigern von Steuerungs Zugriffsrechten spezifisch ist:</span><span class="sxs-lookup"><span data-stu-id="d91a4-107">However, control access rights use the properties of the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface in a manner that is specific to granting and denying control access rights:</span></span>

-   <span data-ttu-id="d91a4-108">[**AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) muss ADS mit dem **\_ rechten \_ DS- \_ Steuerungs \_ Zugriff** enthalten.</span><span class="sxs-lookup"><span data-stu-id="d91a4-108">[**AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) must contain **ADS\_RIGHT\_DS\_CONTROL\_ACCESS**.</span></span>
-   <span data-ttu-id="d91a4-109">Der [**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) -Wert ist ein Anzeige Kennzeichen- **\_ \_ \_ Objekttyp \_**.</span><span class="sxs-lookup"><span data-stu-id="d91a4-109">[**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) value is **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**.</span></span>
-   <span data-ttu-id="d91a4-110">[**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) ist die Zeichen folgen Form des **rightsguid** -Attributs des Zugriffsrechts für das Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="d91a4-110">[**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) is the string form of the **rightsGUID** attribute of the control access right.</span></span> <span data-ttu-id="d91a4-111">Das Zeichen folgen Format der GUID ist dasselbe Zeichen folgen Format wie die [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) -com-Bibliotheksfunktion.</span><span class="sxs-lookup"><span data-stu-id="d91a4-111">The string format of the GUID is the same string format as the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) COM Library function.</span></span>
-   <span data-ttu-id="d91a4-112">Der [**AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) ist entweder **ADS \_ AceType \_ Access \_ Allowed \_ Object** , um dem Vertrauens nehmer den Zugriff auf das Zugriffsrecht für den Vertrauens nehmer und das Zugriff auf das **\_ \_ Zugriffs \_ Verweigerungs \_ Objekt** für den Vertrauens nehmer zu verweigern</span><span class="sxs-lookup"><span data-stu-id="d91a4-112">[**AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) is either **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** to grant the trustee the control access right or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT** to deny the trustee the control access right.</span></span>
-   <span data-ttu-id="d91a4-113">Der Vertrauens [**nehmer ist der**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) Sicherheits Prinzipal. Dies ist der Benutzer, die Gruppe, der Computer usw., auf den der ACE angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="d91a4-113">[**Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) is the security principal; that is the user, group, computer, and so on, to which the ACE applies.</span></span>

<span data-ttu-id="d91a4-114">Verwenden Sie das folgende Verfahren zum Lesen eines ACE für ein ADSI-Objekt.</span><span class="sxs-lookup"><span data-stu-id="d91a4-114">Use the following procedure to read an ACE for an ADSI object.</span></span> <span data-ttu-id="d91a4-115">Das folgende Verfahren gilt für C-und C++-Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="d91a4-115">The following procedure applies to C and C++ applications.</span></span>

<span data-ttu-id="d91a4-116">**So lesen Sie einen ACE für ein ADSI-Objekt**</span><span class="sxs-lookup"><span data-stu-id="d91a4-116">**To read an ACE for an ADSI object**</span></span>

1.  <span data-ttu-id="d91a4-117">Einen [**IADs**](/windows/desktop/api/iads/nn-iads-iads) -Schnittstellen Zeiger auf das-Objekt zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="d91a4-117">Get an [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface pointer to the object.</span></span>
2.  <span data-ttu-id="d91a4-118">Verwenden Sie die [**IADs:: Get**](/windows/desktop/api/iads/nf-iads-iads-get) -Methode, um die Sicherheits Beschreibung des-Objekts zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="d91a4-118">Use the [**IADs::Get**](/windows/desktop/api/iads/nf-iads-iads-get) method to get the security descriptor of the object.</span></span> <span data-ttu-id="d91a4-119">Der Name der Eigenschaft, die die Sicherheits Beschreibung enthält, ist "ntSecurityDescriptor".</span><span class="sxs-lookup"><span data-stu-id="d91a4-119">The name of the property that contains the security descriptor is "nTSecurityDescriptor".</span></span> <span data-ttu-id="d91a4-120">Die-Eigenschaft wird als **Variant** zurückgegeben, der einen [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) -Zeiger enthält.</span><span class="sxs-lookup"><span data-stu-id="d91a4-120">The property will be returned as a **VARIANT** that contains an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="d91a4-121">Beachten Sie, dass das **VT** -Element **VT \_ Dispatch** ist.</span><span class="sxs-lookup"><span data-stu-id="d91a4-121">Be aware that the **vt** member is **VT\_DISPATCH**.</span></span> <span data-ttu-id="d91a4-122">Aufrufen von **QueryInterface** für diesen **IDispatch** -Zeiger zum Abrufen einer [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) -Schnittstelle, um die Methoden für diese Schnittstelle für den Zugriff auf die Sicherheits Deskriptor-ACL zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="d91a4-122">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) interface to use the methods on that interface to access the security descriptor ACL.</span></span>
3.  <span data-ttu-id="d91a4-123">Verwenden Sie die [**IADsSecurityDescriptor:: get \_ diskretionaryacl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) -Methode, um die ACL zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="d91a4-123">Use the [**IADsSecurityDescriptor::get\_DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) method to get the ACL.</span></span> <span data-ttu-id="d91a4-124">Die-Methode gibt einen [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) -Zeiger zurück.</span><span class="sxs-lookup"><span data-stu-id="d91a4-124">The method returns an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="d91a4-125">Ruft **QueryInterface** für diesen **IDispatch** -Zeiger auf, um eine [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) -Schnittstelle zu erhalten, mit der die Methoden für diese Schnittstelle für den Zugriff auf die einzelnen ACEs in der ACL verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d91a4-125">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) interface to use the methods on that interface to access the individual ACEs in the ACL.</span></span>
4.  <span data-ttu-id="d91a4-126">Verwenden Sie die [**IADsAccessControlList:: get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-get__newenum) -Methode, um die ACEs aufzulisten.</span><span class="sxs-lookup"><span data-stu-id="d91a4-126">Use the [**IADsAccessControlList::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-get__newenum) method to enumerate the ACEs.</span></span> <span data-ttu-id="d91a4-127">Die Methode gibt einen [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) -Zeiger zurück.</span><span class="sxs-lookup"><span data-stu-id="d91a4-127">The method returns an [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) pointer.</span></span> <span data-ttu-id="d91a4-128">Ruft **QueryInterface** für diesen **IUnknown** -Zeiger auf, um eine [**IEnumVARIANT**](/windows/win32/api/oaidl/nn-oaidl-ienumvariant) -Schnittstelle zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="d91a4-128">Call **QueryInterface** on that **IUnknown** pointer to get an [**IEnumVARIANT**](/windows/win32/api/oaidl/nn-oaidl-ienumvariant) interface.</span></span>
5.  <span data-ttu-id="d91a4-129">Verwenden Sie die [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) -Methode, um die ACEs in der ACL aufzuzählen.</span><span class="sxs-lookup"><span data-stu-id="d91a4-129">Use the [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) method to enumerate the ACEs in the ACL.</span></span> <span data-ttu-id="d91a4-130">Die-Eigenschaft wird als **Variant** zurückgegeben, der einen [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) -Zeiger enthält.</span><span class="sxs-lookup"><span data-stu-id="d91a4-130">The property is returned as a **VARIANT** that contains an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="d91a4-131">Beachten Sie, dass das **VT** -Element **VT \_ Dispatch** ist.</span><span class="sxs-lookup"><span data-stu-id="d91a4-131">Be aware that the **vt** member is **VT\_DISPATCH**.</span></span> <span data-ttu-id="d91a4-132">Ruft **QueryInterface** für diesen **IDispatch** -Zeiger auf, um eine [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) -Schnittstelle zum Lesen des ACE abzurufen.</span><span class="sxs-lookup"><span data-stu-id="d91a4-132">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface to read the ACE.</span></span>
6.  <span data-ttu-id="d91a4-133">Aufrufen der [**IADsAccessControlEntry:: get \_ AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) -Methode, um die **AccessMask** abzurufen und zu überprüfen, ob der **AccessMask** -Wert für das ADS-Zugriffs Flag für das **\_ \_ Zugriffsrecht DS- \_ Steuer \_** Element</span><span class="sxs-lookup"><span data-stu-id="d91a4-133">Call the [**IADsAccessControlEntry::get\_AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the **AccessMask** and verify that the **AccessMask** value for the **ADS\_RIGHT\_DS\_CONTROL\_ACCESS** flag.</span></span> <span data-ttu-id="d91a4-134">Wenn Sie über dieses Flag verfügt, enthält der ACE ein Zugriffsrecht für das Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="d91a4-134">If it has this flag, the ACE contains a control access right.</span></span>
7.  <span data-ttu-id="d91a4-135">Ruft die [**IADsAccessControlEntry:: get \_ Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) -Methode auf, um das Flag für den Objekttyp zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="d91a4-135">Call the [**IADsAccessControlEntry::get\_Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the flag for the object type.</span></span>
8.  <span data-ttu-id="d91a4-136">Überprüfen Sie die [**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) für **ADS \_ Flag- \_ \_ Objekttyp \_ vorhanden** Flag.</span><span class="sxs-lookup"><span data-stu-id="d91a4-136">Check [**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) value for **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT** flag.</span></span> <span data-ttu-id="d91a4-137">Wenn **Flags** auf **ADS Flag- \_ \_ \_ Objekttyp \_ vorhanden** festgelegt ist, müssen Sie die **IADsAccessControlEntry:: get \_ ObjectType** -Methode aufrufen, um eine Zeichenfolge abzurufen, die die rightsguid des Steuerelement Zugriffsrechts enthält, für das der ACE gilt.</span><span class="sxs-lookup"><span data-stu-id="d91a4-137">If **Flags** is set to **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**, call the **IADsAccessControlEntry::get\_ObjectType** method to get a string that contains the rightsGUID of the control access right that the ACE applies to.</span></span>
9.  <span data-ttu-id="d91a4-138">Wenden Sie die [**IADsAccessControlEntry:: get \_ AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) -Methode an, um den ACE-Typ abzurufen.</span><span class="sxs-lookup"><span data-stu-id="d91a4-138">Call the [**IADsAccessControlEntry::get\_AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the ACE type.</span></span> <span data-ttu-id="d91a4-139">Der Typ ist ein ADS-AceType-Objekt, das auf das **\_ \_ \_ zulässige \_ Objekt** zugreifen kann, um dem Vertrauens nehmer das Zugriffsrecht für den Zugriff auf das Zugriffsrecht zu gewähren oder das Zugriff auf das **\_ \_ Zugriffs \_ \_** Recht "ADS</span><span class="sxs-lookup"><span data-stu-id="d91a4-139">The type will be an **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** to grant the trustee the control access right or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT** to deny the control access right.</span></span>
10. <span data-ttu-id="d91a4-140">Wenden Sie die Methode [**IADsAccessControlEntry:: get \_ Treuhänder**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) an, um den Sicherheits Prinzipal abzurufen. Hierbei handelt es sich um Benutzer, Gruppen, Computer usw., auf die der ACE angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="d91a4-140">Call the [**IADsAccessControlEntry::get\_Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the security principal; that is user, group, computer, and so on to which the ACE applies.</span></span>
11. <span data-ttu-id="d91a4-141">Wenn Sie die Zeichen folgen [**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) und **Treuhänder** abgeschlossen haben, verwenden Sie [**SysFreeString**](/windows/win32/api/oleauto/nf-oleauto-sysfreestring) , um den Arbeitsspeicher für diese Zeichen folgen freizugeben.</span><span class="sxs-lookup"><span data-stu-id="d91a4-141">When finished with the [**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) and **Trustee** strings, use [**SysFreeString**](/windows/win32/api/oleauto/nf-oleauto-sysfreestring) to free the memory for those strings.</span></span>
12. <span data-ttu-id="d91a4-142">Wenn Sie mit den Schnittstellen fertig sind, müssen Sie **Release** zum Dekrement oder Release aller Schnittstellen Verweise aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="d91a4-142">When finished with the interfaces, call **Release** to decrement or release all the interface references.</span></span>

 

 