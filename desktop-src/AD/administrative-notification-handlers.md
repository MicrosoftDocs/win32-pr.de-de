---
title: Verwaltung von Benachrichtigungs Handlern
description: Das MMC-Snap-in "Microsoft Active Directory-Benutzer und-Computer" bietet einen Mechanismus, mit dem Komponenten Benachrichtigungen empfangen können, wenn der Benutzer die Eigenschaften eines Objekts mithilfe des-Snap-Ins löscht, umbenannt, verschiebt oder ändert.
ms.assetid: 49dbb995-c760-4fac-a72f-d5d94afb63c7
ms.tgt_platform: multiple
keywords:
- Verwaltungs Benachrichtigungs Handler AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: baa6f48f8b56ab8e4a1d64d0fe15543bfee6c09e
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "103858159"
---
# <a name="administrative-notification-handlers"></a><span data-ttu-id="82bba-104">Verwaltung von Benachrichtigungs Handlern</span><span class="sxs-lookup"><span data-stu-id="82bba-104">Administrative Notification Handlers</span></span>

<span data-ttu-id="82bba-105">Das MMC-Snap-in "Microsoft Active Directory-Benutzer und-Computer" bietet einen Mechanismus, mit dem Komponenten Benachrichtigungen empfangen können, wenn der Benutzer die Eigenschaften eines Objekts mithilfe des-Snap-Ins löscht, umbenannt, verschiebt oder ändert.</span><span class="sxs-lookup"><span data-stu-id="82bba-105">The Microsoft Active Directory Users and Computers MMC snap-in provides a mechanism to enable components to receive notifications when the user deletes, renames, moves, or changes the properties of an object using the snap-in.</span></span> <span data-ttu-id="82bba-106">Die Komponente, die Benachrichtigungen empfängt, wird als "Benachrichtigungs Handler" bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="82bba-106">The component that receives the notifications is known as a "notification handler".</span></span>

<span data-ttu-id="82bba-107">Dies ist nützlich, wenn mehrere Objekte miteinander verknüpft sind und innerhalb desselben Containers vorhanden sein müssen.</span><span class="sxs-lookup"><span data-stu-id="82bba-107">This is useful when multiple objects are linked together and must exist within the same container.</span></span> <span data-ttu-id="82bba-108">Wenn eines der verknüpften Objekte verschoben wird, wird eine Benachrichtigung an den Benachrichtigungs Handler übermittelt, und der Benachrichtigungs Handler kann die anderen verknüpften Objekte in denselben Ordner verschieben.</span><span class="sxs-lookup"><span data-stu-id="82bba-108">If one of the linked objects is moved, a notification is supplied to the notification handler and the notification handler can move the other linked objects to the same folder.</span></span>

<span data-ttu-id="82bba-109">Wenn einer der Vorgänge ausgeführt wird und mindestens ein Benachrichtigungs Handler installiert ist, zeigt das Snap-in "Benutzer und Computer" ein Bestätigungs Dialogfeld an, in dem die Benachrichtigungs Handler und ein Kontrollkästchen für jeden Handler aufgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="82bba-109">When one of the operations is performed and one or more notification handlers is installed, the Users and Computers snap-in will display a confirmation dialog box that lists the notification handlers and a check box for each handler.</span></span> <span data-ttu-id="82bba-110">Wenn das Kontrollkästchen für einen Handler aktiviert ist, wird der Handler benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="82bba-110">If the check box for a handler is selected, the handler is notified.</span></span> <span data-ttu-id="82bba-111">Wenn das Kontrollkästchen nicht aktiviert ist, wird der Handler nicht benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="82bba-111">If the check box is not selected, the handler is not notified.</span></span>

## <a name="implementing-a-notification-handler"></a><span data-ttu-id="82bba-112">Implementieren eines Benachrichtigungs Handlers</span><span class="sxs-lookup"><span data-stu-id="82bba-112">Implementing a Notification Handler</span></span>

<span data-ttu-id="82bba-113">Ein Benachrichtigungs Handler ist ein COM-Objekt, das als in-proc-Server implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="82bba-113">A notification handler is a COM object implemented as an in-proc server.</span></span> <span data-ttu-id="82bba-114">Der Benachrichtigungs Handler muss die [**idsadminnotifyhandler**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="82bba-114">The notification handler must implement the [**IDsAdminNotifyHandler**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) interface.</span></span>

<span data-ttu-id="82bba-115">Wenn ein Ereignis auftritt, das eine Benachrichtigung auslöst, listet das Snap-in "Benutzer und Computer" die registrierten Benachrichtigungs Handler auf und erstellt jeden mithilfe der CLSID für den Handler.</span><span class="sxs-lookup"><span data-stu-id="82bba-115">When an event occurs that will cause a notification, the Users and Computers snap-in enumerates the registered notification handlers and creates each one using the CLSID for the handler.</span></span> <span data-ttu-id="82bba-116">Nachdem der Handler erstellt wurde, ruft das Snap-in die [**idsadminnotifyhandler:: Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="82bba-116">After the handler is created, the snap-in calls the [**IDsAdminNotifyHandler::Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) method.</span></span> <span data-ttu-id="82bba-117">Die **Initialize** -Methode liefert das-Snap-in mit den Ereignissen, die der Handler empfangen soll.</span><span class="sxs-lookup"><span data-stu-id="82bba-117">The **Initialize** method supplies the snap-in with the events the handler should receive.</span></span>

<span data-ttu-id="82bba-118">Wenn das Ereignis ein Ereignis ist, das an den Benachrichtigungs Handler gesendet werden soll, ruft das Snap-in die [**idsadminnotifyhandler:: begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="82bba-118">If the event is one that should be sent to the notification handler, the snap-in calls the [**IDsAdminNotifyHandler::Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method.</span></span> <span data-ttu-id="82bba-119">Die **Begin** -Methode stellt dem-Handler das-Ereignis, die Daten über das Objekt, in dem das Ereignis auftritt, und abhängig vom Ereignis die Daten über das Objekt bereit.</span><span class="sxs-lookup"><span data-stu-id="82bba-119">The **Begin** method provides the handler with the event occurring, data about the object that the event is occurring on and, depending on the event, data about what the object will become.</span></span> <span data-ttu-id="82bba-120">Die **Begin** -Methode stellt außerdem das-Snap-in mit dem Text bereit, der für den Handler im Bestätigungs Dialogfeld angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="82bba-120">The **Begin** method also provides the snap-in with the text that should be displayed for the handler in the confirmation dialog box.</span></span>

<span data-ttu-id="82bba-121">Wenn die [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) -Methode für jeden Handler aufgerufen wurde, zeigt das Snap-in das Bestätigungs Dialogfeld an.</span><span class="sxs-lookup"><span data-stu-id="82bba-121">When the [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method for each handler has been called, the snap-in displays the confirmation dialog box.</span></span> <span data-ttu-id="82bba-122">Das Bestätigungs Dialogfeld fordert den Benutzer auf, auszuwählen, welche Handler die Benachrichtigung erhalten sollen.</span><span class="sxs-lookup"><span data-stu-id="82bba-122">The confirmation dialog box prompts the user to select which handlers will receive the notification.</span></span> <span data-ttu-id="82bba-123">Wenn der Benutzer im Bestätigungs Dialogfeld die Schaltfläche **kein** Push drückt, wird keiner der Handler benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="82bba-123">If the user presses the **No** push button in the confirmation dialog, none of the handlers are notified.</span></span> <span data-ttu-id="82bba-124">Wenn der Benutzer die Schaltfläche " **Ja** " drückt, erhält jeder der im Bestätigungs Dialogfeld ausgewählten Handler die Benachrichtigung.</span><span class="sxs-lookup"><span data-stu-id="82bba-124">If the user presses the **Yes** push button, each of the handlers selected in the confirmation dialog box receive the notification.</span></span> <span data-ttu-id="82bba-125">Das Snap-in sendet die Benachrichtigung an den Handler, indem die [**idsadminnotifyhandler:: notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) -Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="82bba-125">The snap-in sends the notification to the handler by calling the [**IDsAdminNotifyHandler::Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method.</span></span>

<span data-ttu-id="82bba-126">Nachdem alle Handler benachrichtigt wurden, ruft das Snap-in die [**idsadminnotifyhandler:: End**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="82bba-126">After all of the handlers have been notified, the snap-in calls the [**IDsAdminNotifyHandler::End**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) method.</span></span> <span data-ttu-id="82bba-127">Die **End** -Methode wird immer aufgerufen, auch wenn die [**Benachrichtigungs**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) Methode nicht aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="82bba-127">The **End** method is always called, even if the [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method is not called.</span></span>

## <a name="registering-a-notification-handler-in-the-windows-registry"></a><span data-ttu-id="82bba-128">Registrieren eines Benachrichtigungs Handlers in der Windows-Registrierung</span><span class="sxs-lookup"><span data-stu-id="82bba-128">Registering a Notification Handler in the Windows Registry</span></span>

<span data-ttu-id="82bba-129">Wie bei allen com-Servern muss ein Benachrichtigungs Handler in der Windows-Registrierung registriert werden.</span><span class="sxs-lookup"><span data-stu-id="82bba-129">Like all COM servers, a notification handler must be registered in the Windows registry.</span></span> <span data-ttu-id="82bba-130">Der Handler ist unter folgendem Schlüssel registriert:</span><span class="sxs-lookup"><span data-stu-id="82bba-130">The handler is registered under the following key:</span></span>


```C++
HKEY_CLASSES_ROOT - CLSID - <CLSID>
```



<span data-ttu-id="82bba-131">**<CLSID>** die Zeichen folgen Darstellung der CLSID, die von der [**stringfromclsid**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) -Funktion erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="82bba-131">**<CLSID>** is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span> <span data-ttu-id="82bba-132">Unter dem **<CLSID>** Schlüssel gibt es einen **InProcServer32** -Schlüssel, der das-Objekt als 32-Bit-in-proc-Server identifiziert.</span><span class="sxs-lookup"><span data-stu-id="82bba-132">Under the **<CLSID>** key, there is an **InProcServer32** key that identifies the object as a 32-bit in-proc server.</span></span> <span data-ttu-id="82bba-133">Unter der **InProcServer32** -Taste wird der Speicherort der dll im Standardwert angegeben, und das Threading Modell wird im **ThreadingModel** -Wert angegeben.</span><span class="sxs-lookup"><span data-stu-id="82bba-133">Under the **InProcServer32** key, the location of the DLL is specified in the default value and the threading model is specified in the **ThreadingModel** value.</span></span> <span data-ttu-id="82bba-134">Alle Benachrichtigungs Handler müssen das **Apartment** Thread Modell verwenden.</span><span class="sxs-lookup"><span data-stu-id="82bba-134">All notification handlers must use the **Apartment** threading model.</span></span>

## <a name="registering-a-notification-handler-with-an-active-directory-server"></a><span data-ttu-id="82bba-135">Registrieren eines Benachrichtigungs Handlers bei einem Active Directory Server</span><span class="sxs-lookup"><span data-stu-id="82bba-135">Registering a Notification Handler with an Active Directory Server</span></span>

<span data-ttu-id="82bba-136">Innerhalb Active Directory Domain Services ist die Benachrichtigung des Benachrichtigungs Handlers für ein einzelnes Gebiets Schema spezifisch.</span><span class="sxs-lookup"><span data-stu-id="82bba-136">Within Active Directory Domain Services, notification handler registration is specific to one locale.</span></span> <span data-ttu-id="82bba-137">Wenn der Benachrichtigungs Handler auf alle Gebiets Schemas angewendet wird, muss er im **displaySpecifier** -Objekt in allen Gebiets Schema-subcontainern im Display Specifiers-Container registriert werden.</span><span class="sxs-lookup"><span data-stu-id="82bba-137">If the notification handler applies to all locales, it must be registered in the **displaySpecifier** object in all of the locale subcontainers in the DisplaySpecifiers container.</span></span> <span data-ttu-id="82bba-138">Wenn der Benachrichtigungs Handler für ein bestimmtes Gebiets Schema lokalisiert ist, wird er im **displaySpecifier** -Objekt im unter Container dieses Gebiets Schemas registriert.</span><span class="sxs-lookup"><span data-stu-id="82bba-138">If the notification handler is localized for a certain locale, it is registered in the **displaySpecifier** object in that locale's subcontainer.</span></span> <span data-ttu-id="82bba-139">Weitere Informationen über den displayspecifieres-Container und die Gebiets Schemas finden Sie unter [anzeigen](display-specifiers.md) von Bezeichner und [displaySpecifier-Containern](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="82bba-139">For more information about the DisplaySpecifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="82bba-140">Benachrichtigungs Handler werden unter dem **dsuiadminnotification** -Attribut im Container " **DS-UI-Default-Settings** " registriert.</span><span class="sxs-lookup"><span data-stu-id="82bba-140">Notification handlers are registered under the **dsUIAdminNotification** attribute in the **DS-UI-Default-Settings** container.</span></span> <span data-ttu-id="82bba-141">Dies ist ein mehr wertiger Unicode-Zeichen folgen Wert, bei dem jeder Wert das folgende Format erfordert:</span><span class="sxs-lookup"><span data-stu-id="82bba-141">This a multi-valued Unicode string value where each value requires the following format:</span></span>


```C++
<order number>,<CLSID>
```



<span data-ttu-id="82bba-142">" &lt; Order Number &gt; " ist eine nicht signierte Zahl, die die Position des Handlers im Bestätigungs Dialogfeld darstellt.</span><span class="sxs-lookup"><span data-stu-id="82bba-142">The "&lt;order number&gt;" is an unsigned number that represents the position of the handler in the confirmation dialog.</span></span> <span data-ttu-id="82bba-143">Wenn das Bestätigungs Dialogfeld angezeigt wird, werden die Werte mithilfe eines Vergleichs der "Order Number"-Werte der einzelnen Werte sortiert &lt; &gt; .</span><span class="sxs-lookup"><span data-stu-id="82bba-143">When the confirmation dialog is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="82bba-144">Wenn mehr als ein Wert dieselbe " &lt; Bestellnummer" aufweist &gt; , werden diese Handler in der Reihenfolge angezeigt, in der Sie vom Active Directory Server gelesen werden.</span><span class="sxs-lookup"><span data-stu-id="82bba-144">If more than one value has the same "&lt;order number&gt;", those handlers are displayed in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="82bba-145">Eine nicht vorhandene, d. h. eine, die nicht von anderen Werten in der-Eigenschaft verwendet wird, &lt; &gt; sollte nach Möglichkeit verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="82bba-145">A non-existing, that is, one not used by other values in the property, "&lt;order number&gt;" should be used if possible.</span></span> <span data-ttu-id="82bba-146">Es gibt keine vorgeschriebene Anfangsposition, und es können Lücken in der &lt; Sequenz "Order Number" angezeigt werden &gt; .</span><span class="sxs-lookup"><span data-stu-id="82bba-146">There is no prescribed starting position, and gaps can appear in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="82bba-147">Die " &lt; CLSID &gt; " ist die Zeichen folgen Darstellung der CLSID, die von der [**stringfromclsid**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) -Funktion erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="82bba-147">The "&lt;CLSID&gt;" is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>

 

 