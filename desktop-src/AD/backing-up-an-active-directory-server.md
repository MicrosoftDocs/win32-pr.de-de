---
title: Sichern eines Active Directory Servers
description: Eine Active Directory Server-Sicherung erfordert, dass Sie die Datenbank und die Transaktionsprotokolle sichern. Dieses Thema enthält eine exemplarische Vorgehensweise, wie eine Sicherungs Anwendung den Active Directory Directory-Dienst sichert.
ms.assetid: 250b2f40-6d43-4aa5-a588-b0cd4839828d
ms.tgt_platform: multiple
keywords:
- Sichern Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5affde952ee543afe1bb9b794cce074a74382aa7
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104036263"
---
# <a name="backing-up-an-active-directory-server"></a><span data-ttu-id="7ee47-105">Sichern eines Active Directory Servers</span><span class="sxs-lookup"><span data-stu-id="7ee47-105">Backing Up an Active Directory Server</span></span>

<span data-ttu-id="7ee47-106">Eine Active Directory Server-Sicherung erfordert, dass Sie die Datenbank und die Transaktionsprotokolle sichern.</span><span class="sxs-lookup"><span data-stu-id="7ee47-106">An Active Directory server backup requires you to back up the database and the transaction logs.</span></span> <span data-ttu-id="7ee47-107">Dieses Thema enthält eine exemplarische Vorgehensweise, wie eine Sicherungs Anwendung den Active Directory Directory-Dienst sichert.</span><span class="sxs-lookup"><span data-stu-id="7ee47-107">This topic provides a walkthrough of how a backup application backs up the Active Directory directory service.</span></span>

<span data-ttu-id="7ee47-108">Der Aufrufer dieser Sicherungsfunktionen muss über die Berechtigung " **SE \_ Backup \_ Name** " verfügen.</span><span class="sxs-lookup"><span data-stu-id="7ee47-108">The caller of these backup functions must have the **SE\_BACKUP\_NAME** privilege.</span></span> <span data-ttu-id="7ee47-109">Sie können die [**dssetauthidentity**](dssetauthidentity.md) -Funktion verwenden, um den Sicherheitskontext festzulegen, unter dem die Funktionen zum Sichern und Wiederherstellen von Verzeichnissen aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="7ee47-109">You can use the [**DsSetAuthIdentity**](dssetauthidentity.md) function to set the security context under which the directory backup/restore functions are called.</span></span>

<span data-ttu-id="7ee47-110">**Führen Sie die folgenden Schritte aus, um einen Active Directory Server zu sichern:**</span><span class="sxs-lookup"><span data-stu-id="7ee47-110">**To backup an Active Directory server, perform the following steps**</span></span>

1.  <span data-ttu-id="7ee47-111">Ruft die [**dsisntdsonline**](dsisntdsonline.md) -Funktion auf, um zu bestimmen, ob Active Directory Domain Services ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="7ee47-111">Call the [**DsIsNTDSOnline**](dsisntdsonline.md) function to determine if Active Directory Domain Services are running.</span></span>
2.  <span data-ttu-id="7ee47-112">Wenn Active Directory Domain Services ausgeführt werden, wird die [**dsbackupprepare**](dsbackupprepare.md) -Funktion aufgerufen, um ein Sicherungs Kontext Handle zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="7ee47-112">If Active Directory Domain Services are running, call the [**DsBackupPrepare**](dsbackupprepare.md) function to initialize a backup context handle.</span></span> <span data-ttu-id="7ee47-113">Wenn Active Directory Domain Services nicht ausgeführt werden, kann es nicht gesichert werden, und die Sicherungs Anwendung muss den Sicherungs Vorgang nicht ausführen.</span><span class="sxs-lookup"><span data-stu-id="7ee47-113">If Active Directory Domain Services are not running, it cannot be backed up and the backup application must fail the backup operation.</span></span>
3.  <span data-ttu-id="7ee47-114">Aufrufen der [**dsbackupgetdatabasenames**](dsbackupgetdatabasenames.md) -Funktion, um eine Liste der zu sichernden Dateien abzurufen.</span><span class="sxs-lookup"><span data-stu-id="7ee47-114">Call the [**DsBackupGetDatabaseNames**](dsbackupgetdatabasenames.md) function to get a list of files to back up.</span></span> <span data-ttu-id="7ee47-115">Um den von dieser Funktion zurückgegebenen Arbeitsspeicher freizugeben, nennen Sie die Funktion [**dsbackupfree**](dsbackupfree.md) .</span><span class="sxs-lookup"><span data-stu-id="7ee47-115">To release the memory returned by this function, call the [**DsBackupFree**](dsbackupfree.md) function.</span></span>
4.  <span data-ttu-id="7ee47-116">Rufen Sie für jeden Namen in der zurückgegebenen Liste der Dateien die [**dsbackupopenfile**](dsbackupopenfile.md) -Funktion auf, gefolgt von wiederholten Aufrufen der [**dsbackupread**](dsbackupread.md) -Funktion, bis die gesamte Datei gelesen wurde.</span><span class="sxs-lookup"><span data-stu-id="7ee47-116">For each name in the returned list of files, call the [**DsBackupOpenFile**](dsbackupopenfile.md) function followed by repeated calls to the [**DsBackupRead**](dsbackupread.md) function until the entire file has been read.</span></span> <span data-ttu-id="7ee47-117">Wenn Sie mit dem Lesen der Datei fertig sind, müssen Sie die Funktion [**dsbackupclose**](dsbackupclose.md) zum Schließen der Datei abrufen.</span><span class="sxs-lookup"><span data-stu-id="7ee47-117">When you have finished reading the file, call the [**DsBackupClose**](dsbackupclose.md) function to close it.</span></span>
5.  <span data-ttu-id="7ee47-118">Nachdem alle Datenbankdateien gesichert wurden, können Sie die Funktion [**dsbackupgetbackuplogs**](dsbackupgetbackuplogs.md) aufrufen, um eine Liste der Transaktionsprotokolle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="7ee47-118">After all database files are backed up, call the [**DsBackupGetBackupLogs**](dsbackupgetbackuplogs.md) function to get a list of transaction logs.</span></span> <span data-ttu-id="7ee47-119">Diese Liste wird genau wie die Liste der Datenbankdateien behandelt.</span><span class="sxs-lookup"><span data-stu-id="7ee47-119">This list is handled just like the list of database files.</span></span>
6.  <span data-ttu-id="7ee47-120">Wenn Sie die Sicherung des Transaktions Protokolls abgeschlossen haben, können Sie die [**dsbackuptruneurelogs**](dsbackuptruncatelogs.md) -Funktion zum Löschen sämtlicher zugesicherter Transaktionsprotokolle, die gesichert wurden, löschen.</span><span class="sxs-lookup"><span data-stu-id="7ee47-120">When you have finished backing up the transaction log, call the [**DsBackupTruncateLogs**](dsbackuptruncatelogs.md) function to delete all committed transaction logs that were backed up.</span></span>
7.  <span data-ttu-id="7ee47-121">Speichern Sie den Inhalt des Ablauf Tokens, das von der [**dsbackupprepare**](dsbackupprepare.md) -Funktion bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="7ee47-121">Save the contents of the expiry token provided by the [**DsBackupPrepare**](dsbackupprepare.md) function.</span></span> <span data-ttu-id="7ee47-122">Dies kann in einer Datei oder einem anderen persistenten Speicher gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="7ee47-122">This can be saved in a file or some other persistent memory.</span></span> <span data-ttu-id="7ee47-123">Dieses Token muss an die [**dsrestoreprepare**](dsrestoreprepare.md) -Funktion übergeben werden, um einen Wiederherstellungs Vorgang zu initiieren.</span><span class="sxs-lookup"><span data-stu-id="7ee47-123">This token must be passed to the [**DsRestorePrepare**](dsrestoreprepare.md) function to initiate a restore operation.</span></span>
8.  <span data-ttu-id="7ee47-124">Gibt den Arbeitsspeicher für das Ablauf Token frei, indem der tokenzeiger an die [**dsbackupfree**](dsbackupfree.md) -Funktion übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="7ee47-124">Free the memory for the expiry token by passing the token pointer to the [**DsBackupFree**](dsbackupfree.md) function.</span></span>
9.  <span data-ttu-id="7ee47-125">Zum Schluss wird die [**dsbackupend**](dsbackupend.md) -Funktion aufgerufen, um alle dem Sicherungs Kontext Handle zugeordneten Ressourcen freizugeben.</span><span class="sxs-lookup"><span data-stu-id="7ee47-125">Finally, call the [**DsBackupEnd**](dsbackupend.md) function to release all resources associated with the backup context handle.</span></span>

 

 




