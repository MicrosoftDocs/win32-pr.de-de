---
title: Eigenschaften Blätter für das Active Directory von Benutzern und Computern
description: Das MMC-Snap-in "Active Directory-Benutzer und-Computer" ist darauf ausgelegt, ein Eigenschaften Blatt für verschiedene Objekte auf einem Active Directory Server anzuzeigen.
ms.assetid: 38032d89-9549-475c-90aa-dac5cfe11084
ms.tgt_platform: multiple
keywords:
- Eigenschaften Blätter für Active Directory Benutzer und Computer anzeigen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30ea24f34e86f21af178e975852accb667bb69e4
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/17/2020
ms.locfileid: "103724665"
---
# <a name="active-directory-users-and-computers-property-sheets"></a><span data-ttu-id="dd66b-104">Eigenschaften Blätter für das Active Directory von Benutzern und Computern</span><span class="sxs-lookup"><span data-stu-id="dd66b-104">Active Directory Users and Computers Property Sheets</span></span>

<span data-ttu-id="dd66b-105">Das MMC-Snap-in "Active Directory-Benutzer und-Computer" ist darauf ausgelegt, ein Eigenschaften Blatt für verschiedene Objekte auf einem Active Directory Server anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-105">The Active Directory Users and Computers MMC snap-in is designed to display a property sheet for various objects in an Active Directory server.</span></span> <span data-ttu-id="dd66b-106">Das Eigenschaften Blatt enthält eine oder mehrere Seiten, die zum Anzeigen und Ändern von Objektdaten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="dd66b-106">The property sheet contains one or more pages that are used to view and modify object data.</span></span> <span data-ttu-id="dd66b-107">Für unterschiedliche Objekttypen werden unterschiedliche Seiten Sätze angezeigt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-107">Different object types have different sets of pages displayed for them.</span></span> <span data-ttu-id="dd66b-108">Das MMC-Snap-in "Active Directory-Benutzer und-Computer" ermöglicht Drittanbietern auch das Hinzufügen benutzerdefinierter Seiten zum Eigenschaften Blatt für einen bestimmten Objekttyp.</span><span class="sxs-lookup"><span data-stu-id="dd66b-108">The Active Directory Users and Computers MMC snap-in also enables third party vendors to add custom pages to the property sheet for a specific type of object.</span></span> <span data-ttu-id="dd66b-109">Weitere Informationen finden Sie unter [Eigenschaften Seiten für die Verwendung mit Anzeige spezifiken](property-pages-for-use-with-display-specifiers.md).</span><span class="sxs-lookup"><span data-stu-id="dd66b-109">For more information, see [Property Pages for Use with Display Specifiers](property-pages-for-use-with-display-specifiers.md).</span></span>

<span data-ttu-id="dd66b-110">Einige Anwendungen, außer dem MMC-Snap-in "Active Directory-Benutzer und-Computer", müssen dem Benutzer die Möglichkeit bieten, Attribute für ein Objekt in einem Active Directory Server anzuzeigen und zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="dd66b-110">Some applications, other than the Active Directory Users and Computers MMC snap-in, must provide the user with the ability view and edit attributes for an object in an Active Directory server.</span></span> <span data-ttu-id="dd66b-111">Die Anwendung könnte eigene Eigenschaften Blätter implementieren, aber es ist besser, eine konsistente Benutzeroberfläche bereitzustellen, um Verwirrung und Lernzeit zu reduzieren.</span><span class="sxs-lookup"><span data-stu-id="dd66b-111">The application could implement its own property sheets, but it is better to offer a consistent user interface to reduce confusion and learning time.</span></span> <span data-ttu-id="dd66b-112">Glücklicherweise ermöglicht das MMC-Snap-in "Active Directory-Benutzer und-Computer" allen OLE-COM-Anwendungen, ein Eigenschaften Blatt für ein Objekt anzuzeigen, das mit dem Eigenschaften Blatt identisch ist, das vom MMC-Snap-in "Active Directory-Benutzer und-Computer" für dasselbe Objekt angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="dd66b-112">Fortunately, the Active Directory Users and Computers MMC snap-in allows any OLE COM application to display a property sheet for an object that is identical to the property sheet that would be displayed by the Active Directory Users and Computers MMC snap-in for the same object.</span></span>

<span data-ttu-id="dd66b-113">Weitere Informationen und ein Codebeispiel, in dem ein Eigenschaften Blatt für Active Directory Benutzer und Computer gehostet wird, finden Sie im Beispiel propsheethost im Platform Software Development Kit (SDK).</span><span class="sxs-lookup"><span data-stu-id="dd66b-113">For more information and a code example that hosts an Active Directory Users and Computers property sheet, see the PropSheetHost sample in the Platform Software Development Kit (SDK).</span></span>

## <a name="developer-audience"></a><span data-ttu-id="dd66b-114">Entwicklerzielgruppe</span><span class="sxs-lookup"><span data-stu-id="dd66b-114">Developer Audience</span></span>

<span data-ttu-id="dd66b-115">In dieser Dokumentation wird davon ausgegangen, dass der Reader mit der com-Operation und-Komponentenentwicklung mit C++ vertraut ist.</span><span class="sxs-lookup"><span data-stu-id="dd66b-115">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="dd66b-116">Derzeit ist es nicht möglich, eine Active Directory Eigenschaften Blatt Erweiterung mit Visual Basic zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-116">Currently, it is not possible to create an Active Directory property sheet extension using Visual Basic.</span></span>

## <a name="hosting-an-active-directory-users-and-computers-property-sheet"></a><span data-ttu-id="dd66b-117">Eigenschaften Blatt "Active Directory-Benutzer und-Computer" wird gehostet</span><span class="sxs-lookup"><span data-stu-id="dd66b-117">Hosting an Active Directory Users and Computers Property Sheet</span></span>

<span data-ttu-id="dd66b-118">**So zeigen Sie ein Eigenschaften Blatt für ein Objekt in einem Active Directory Server an**</span><span class="sxs-lookup"><span data-stu-id="dd66b-118">**To display a property sheet for an object in an Active Directory server**</span></span>

1.  <span data-ttu-id="dd66b-119">Erstellen Sie ein Fenster, das zum Verarbeiten von Nachrichten verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="dd66b-119">Create a window that can be used to process messages.</span></span> <span data-ttu-id="dd66b-120">Dabei kann es sich um ein vorhandenes oder ein spezielles Fenster handeln.</span><span class="sxs-lookup"><span data-stu-id="dd66b-120">This can be an existing window or a special purpose window.</span></span> <span data-ttu-id="dd66b-121">Dies wird als ausgeblendetes *Fenster* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="dd66b-121">This is known as the *hidden window*.</span></span>
2.  <span data-ttu-id="dd66b-122">Erstellen Sie ein OLE-COM-Objekt, das von [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="dd66b-122">Create an OLE COM object that is derived from [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span></span> <span data-ttu-id="dd66b-123">Dieses Datenobjekt muss die folgenden Datenformate unterstützen:</span><span class="sxs-lookup"><span data-stu-id="dd66b-123">This data object must support the following data formats:</span></span>

    -   <span data-ttu-id="dd66b-124">[**Cfstr \_ Dsobjectnames**](cfstr-dsobjectnames.md) dieses Datenformat enthält einen [**dsobjectnames**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) -Wert, der das Objekt identifiziert, für das das Eigenschaften Blatt gilt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-124">[**CFSTR\_DSOBJECTNAMES**](cfstr-dsobjectnames.md) This data format contains a [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) that identifies the object that the property sheet applies to.</span></span> <span data-ttu-id="dd66b-125">Beim Hosting eines Eigenschaften Blatts werden die signifikanteren Member der **dsobjectnames** -Struktur in der folgenden Liste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-125">When hosting a property sheet, the more significant members of the **DSOBJECTNAMES** structure are shown in the following list.</span></span>

        <span data-ttu-id="dd66b-126">**clsidnamespace** Bleiben.</span><span class="sxs-lookup"><span data-stu-id="dd66b-126">**clsidNamespace** Reserved.</span></span> <span data-ttu-id="dd66b-127">Legen Sie dies für die Anwendung hier auf eine GUID fest, wenn Sie in Zukunft verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="dd66b-127">Set this to a GUID for your application here in case that it is used in the future.</span></span>
        
        <span data-ttu-id="dd66b-128">**aobjects** Enthält ein Array von [**dsboject**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) -Strukturen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-128">**aObjects** Contains an array of [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structures.</span></span> <span data-ttu-id="dd66b-129">Jede **dsboject** -Struktur stellt ein einzelnes Verzeichnis Objekt dar.</span><span class="sxs-lookup"><span data-stu-id="dd66b-129">Each **DSBOJECT** structure represents a single directory object.</span></span> <span data-ttu-id="dd66b-130">Der Member **cItems** enthält die Anzahl der Elemente im Array.</span><span class="sxs-lookup"><span data-stu-id="dd66b-130">The **cItems** member contains the number of elements in the array.</span></span> <span data-ttu-id="dd66b-131">Es wird nur das erste Objekt in diesem Array verwendet.</span><span class="sxs-lookup"><span data-stu-id="dd66b-131">Only the first object in this array is used.</span></span> <span data-ttu-id="dd66b-132">Andere Objekte werden ignoriert.</span><span class="sxs-lookup"><span data-stu-id="dd66b-132">Other objects are ignored.</span></span>

    -   <span data-ttu-id="dd66b-133">[**Cfstr \_ Dsdisplayspecoptions**](cfstr-ds-display-spec-options.md) dieses Datenformat enthält eine [**dsdisplayspecoptions**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) -Struktur, die Daten enthält, die von den Eigenschaften Seiten verwendet werden, z. b. den Speicherort der Eigenschaften Seiten, den Server und die Anmelde Informationen, die verwendet werden sollen, usw.</span><span class="sxs-lookup"><span data-stu-id="dd66b-133">[**CFSTR\_DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) This data format contains a [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) structure that contains data that will be used by the property pages, such as where to load the property pages from, the server and credentials to use, and so on.</span></span> <span data-ttu-id="dd66b-134">In der folgenden Liste sind die signifikanteren Member der **dsdisplayspecoptions** -Elemente aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-134">The more significant members of the **DSDISPLAYSPECOPTIONS** are shown in the following list.</span></span>

        <span data-ttu-id="dd66b-135">**offmentattribprefix** Die Attribut Präfix Zeichenfolge bestimmt, wo die Liste der Eigenschaften Seiten abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="dd66b-135">**offsetAttribPrefix** The attribute prefix string determines where the list of property pages is obtained.</span></span> <span data-ttu-id="dd66b-136">Diese muss eine der folgenden Zeichen folgen enthalten.</span><span class="sxs-lookup"><span data-stu-id="dd66b-136">This must contain one of the following strings.</span></span>

        

        | <span data-ttu-id="dd66b-137">Präfix-Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="dd66b-137">Attribute prefix string</span></span> | <span data-ttu-id="dd66b-138">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="dd66b-138">Description</span></span>                                              |
        |-------------------------|----------------------------------------------------------------------------------------------------------------------|
        | <span data-ttu-id="dd66b-139">Administrator</span><span class="sxs-lookup"><span data-stu-id="dd66b-139">"admin"</span></span><br/>      | <span data-ttu-id="dd66b-140">Die Eigenschaften Seiten werden aus dem Attribut [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) geladen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-140">The property pages are loaded from the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) attribute.</span></span><br/> |
        | <span data-ttu-id="dd66b-141">schel</span><span class="sxs-lookup"><span data-stu-id="dd66b-141">"shell"</span></span><br/>      | <span data-ttu-id="dd66b-142">Die Eigenschaften Seiten werden aus dem [**shellpropertypages**](/windows/desktop/ADSchema/a-shellpropertypages) -Attribut geladen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-142">The property pages are loaded from the [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute.</span></span><br/> |

        


    -   <span data-ttu-id="dd66b-143">[**Cfstr \_ DS \_ propsheetconfig**](cfstr-ds-propsheetconfig.md) dieses Datenformat enthält eine [**propsheetcfg**](propsheetcfg.md) -Struktur, die Eigenschaften Blatt-Hostdaten enthält.</span><span class="sxs-lookup"><span data-stu-id="dd66b-143">[**CFSTR\_DS\_PROPSHEETCONFIG**](cfstr-ds-propsheetconfig.md) This data format contains a [**PROPSHEETCFG**](propsheetcfg.md) structure that contains property sheet host data.</span></span> <span data-ttu-id="dd66b-144">Beim Hosting eines Eigenschaften Blatts enthalten die signifikanteren Member der **propsheetcfg** -Struktur die in der folgenden Liste dargestellten Daten.</span><span class="sxs-lookup"><span data-stu-id="dd66b-144">When hosting a property sheet, the more significant members of the **PROPSHEETCFG** structure contain the data shown in the following list.</span></span>

        <span data-ttu-id="dd66b-145">**lnotifyhandle** Muss 0 (null) sein.</span><span class="sxs-lookup"><span data-stu-id="dd66b-145">**lNotifyHandle** Must be zero.</span></span>
        <span data-ttu-id="dd66b-146">**hwndparametrisheet**  Enthält das Handle des Fensters zum Empfangen von " [**WM \_ adsprop \_ Notify \_ Change**](wm-adsprop-notify-change.md) Messages", wenn etwas auf einer der Seiten geändert wird und angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="dd66b-146">**hwndParentSheet**  Contains the handle of the window to receive [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) messages when something in one of the pages changes and is applied.</span></span> <span data-ttu-id="dd66b-147">Kann **null** sein, wenn diese Nachricht nicht gewünscht ist.</span><span class="sxs-lookup"><span data-stu-id="dd66b-147">Can be **NULL** if this message is not desired.</span></span>

        <span data-ttu-id="dd66b-148">**hwndhidden** Enthält das Handle des Fensters zum Empfangen der [**WM- \_ DSA- \_ Blatt \_ Erstellung \_ Benachrichtigen**](wm-dsa-sheet-create-notify.md) und [**WM-DSA- \_ \_ Blatt \_ Close \_ Notify**](wm-dsa-sheet-close-notify.md) Messages.</span><span class="sxs-lookup"><span data-stu-id="dd66b-148">**hwndHidden** Contains the handle of the window to receive [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) and [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) messages.</span></span> <span data-ttu-id="dd66b-149">Legen Sie diese Einstellung auf das Handle des ausgeblendeten Fensters fest.</span><span class="sxs-lookup"><span data-stu-id="dd66b-149">Set this to the handle of your hidden window.</span></span>

        <span data-ttu-id="dd66b-150">**wparamsheetclose** Enthält einen von der Anwendung definierten Bezeichner, der in der *wParam* in der [**WM-DSA-Tabelle " \_ \_ \_ Close \_ Notify**](wm-dsa-sheet-close-notify.md) Message" zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="dd66b-150">**wParamSheetClose** Contains an application-defined identifier that is returned in the *wParam* in the [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="dd66b-151">Wenn dieser Member 0 (null) ist, wird das WM-DSA-Blatt "Nachricht **\_ \_ \_ Schließen \_** " nicht im verborgenen Fenster gepostet.</span><span class="sxs-lookup"><span data-stu-id="dd66b-151">If this member is zero, the **WM\_DSA\_SHEET\_CLOSE\_NOTIFY** message will not be posted to the hidden window.</span></span>


3.  <span data-ttu-id="dd66b-152">Erstellen Sie eine Instanz des [**CLSID \_ dspropertypages**](guids-of-user-interface-elements.md) -Objekts, und rufen Sie die [**ishellextinit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) -Schnittstelle für das Objekt ab.</span><span class="sxs-lookup"><span data-stu-id="dd66b-152">Create an instance of the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and obtain the [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface for the object.</span></span> <span data-ttu-id="dd66b-153">Es ist auch möglich, das Verhalten des **CLSID-Objekts \_ dspropertypages** zu duplizieren.</span><span class="sxs-lookup"><span data-stu-id="dd66b-153">It is also possible to duplicate the behavior of the **CLSID\_DsPropertyPages** object.</span></span> <span data-ttu-id="dd66b-154">Weitere Informationen finden Sie unter Duplizieren des Verhaltens des CLSID \_ dspropertypages-Objekts.</span><span class="sxs-lookup"><span data-stu-id="dd66b-154">For more information, see Duplicating the Behavior of the CLSID\_DsPropertyPages Object.</span></span>
4.  <span data-ttu-id="dd66b-155">Initialisieren Sie das [**CLSID \_ dspropertypages**](guids-of-user-interface-elements.md) -Objekt, indem Sie die [**ishellextinit:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-155">Initialize the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object by calling the [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method.</span></span> <span data-ttu-id="dd66b-156">Die Parameter *pidlfolder* und *hkeyprogid* werden in dieser Methode nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="dd66b-156">The *pidlFolder* and *hkeyProgID* parameters are not used in this method.</span></span> <span data-ttu-id="dd66b-157">Der *pdtobj* -Parameter ist der Zeiger auf das Datenobjekt, das in Schritt 2 erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="dd66b-157">The *pdtobj* parameter is the pointer to the data object created in Step 2.</span></span> <span data-ttu-id="dd66b-158">Wenn die **ishellextinit:: Initialize** -Methode aufgerufen wird, speichert das **CLSID \_ dspropertypages** -Objekt einen Verweis auf das Datenobjekt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-158">When the **IShellExtInit::Initialize** method is called, the **CLSID\_DsPropertyPages** object will save a reference to the data object.</span></span>
5.  <span data-ttu-id="dd66b-159">Rufen Sie die [**ishellpropsheetext**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) -Schnittstelle für das [**CLSID \_ dspropertypages**](guids-of-user-interface-elements.md) -Objekt ab, und rufen Sie die [**ishellpropsheetext:: addPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="dd66b-159">Obtain the [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface for the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and call the [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method.</span></span> <span data-ttu-id="dd66b-160">Der *lpfnaddpage* -Parameter ist die Adresse einer Rückruffunktion, die Sie implementieren müssen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-160">The *lpfnAddPage* parameter is the address of a callback function that you must implement.</span></span> <span data-ttu-id="dd66b-161">Das Format dieser Funktion ist unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-161">The format of this function is shown below.</span></span> <span data-ttu-id="dd66b-162">Wenn die Rückruffunktion als Member einer C++-Klasse deklariert ist, muss die Rückruffunktion als **statisch** deklariert werden.</span><span class="sxs-lookup"><span data-stu-id="dd66b-162">If the callback function is declared as a member of a C++ class, the callback function must be declared as **static**.</span></span> <span data-ttu-id="dd66b-163">Der *LPARAM* -Parameter ist ein von der Anwendung definierter Wert, der zum Identifizieren des Objekts verwendet werden kann, das die Rückruffunktion implementiert.</span><span class="sxs-lookup"><span data-stu-id="dd66b-163">The *lParam* parameter is an application-defined value that can be used to identify the object that implements the callback function.</span></span> <span data-ttu-id="dd66b-164">Wenn die **ishellpropsheetext:: addPages** -Methode aufgerufen wird, ruft das **CLSID \_ dspropertypages** -Objekt die Daten aus dem Datenobjekt ab und listet die Eigenschaften Seiten auf, die für die Objekt Anzeige spezifiers registriert sind.</span><span class="sxs-lookup"><span data-stu-id="dd66b-164">When the **IShellPropSheetExt::AddPages** method is called, the **CLSID\_DsPropertyPages** object will obtain the data from the data object and enumerate the property pages registered for the object display specifiers.</span></span> <span data-ttu-id="dd66b-165">Das **CLSID \_ dspropertypages** -Objekt zählt dann die Eigenschaften Seiten Objekte auf, wobei die **ishellpropsheetext:: addPages** -Methode jedes Objekts aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="dd66b-165">The **CLSID\_DsPropertyPages** object will then enumerate the property page objects, calling each object's **IShellPropSheetExt::AddPages** method.</span></span>

    ```C++
    BOOL CALLBACK AddPagesCallback(HPROPSHEETPAGE, LPARAM)
    ```

    

6.  <span data-ttu-id="dd66b-166">Jede Seite, die von den Eigenschaften Seiten Objekten hinzugefügt wird, führt dazu, dass die Rückruffunktion mit dem Handle auf der Eigenschaften Seite und dem von der Anwendung definierten Wert aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="dd66b-166">Each page added by the property page objects will result in your callback function being called with the handle to the property page and the application-defined value.</span></span> <span data-ttu-id="dd66b-167">Die Rückruffunktion muss jeden bestandenen Eigenschaften Seiten Handle speichern.</span><span class="sxs-lookup"><span data-stu-id="dd66b-167">Your callback function must store each property page handle that is passed.</span></span> <span data-ttu-id="dd66b-168">Wenn die [**ishellpropsheetext:: addPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) -Methode des [**CLSID \_ dspropertypages**](guids-of-user-interface-elements.md) -Objekts zurückgibt, wurden alle Seiten über Ihre Rückruffunktion hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-168">When the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method returns, all pages will have been added via your callback function.</span></span>
7.  <span data-ttu-id="dd66b-169">Füllen Sie eine [**propsheetheiader**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) -Struktur aus, um das Eigenschaften Blatt anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-169">Fill in a [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) structure to display the property sheet.</span></span> <span data-ttu-id="dd66b-170">Der **phpage** -Member erhält einen Zeiger auf ein Array von Seiten Handles, die von ihrer Rückruffunktion erfasst wurden.</span><span class="sxs-lookup"><span data-stu-id="dd66b-170">The **phpage** member receives a pointer to an array of page handles that were collected by your callback function.</span></span> <span data-ttu-id="dd66b-171">Der **npages** -Member empfängt die Anzahl der Seiten im Seiten Handle-Array.</span><span class="sxs-lookup"><span data-stu-id="dd66b-171">The **nPages** member receives the number of pages in the page handle array.</span></span>
8.  <span data-ttu-id="dd66b-172">Zeigen Sie das Eigenschaften Blatt durch Aufrufen der [**PropertySheet**](/windows/win32/api/prsht/nf-prsht-propertysheeta) -Funktion an.</span><span class="sxs-lookup"><span data-stu-id="dd66b-172">Display the property sheet by calling the [**PropertySheet**](/windows/win32/api/prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="dd66b-173">Wenn die Daten auf einer beliebigen Seite geändert werden und auf die Schaltflächen **OK** oder **anwenden** geklickt wird, erhält das Fenster, das durch das **hwndparametsheet** -Element der [**propsheetcfg**](propsheetcfg.md) -Struktur identifiziert wird, eine " [**WM \_ adsprop \_ Notify \_ Change**](wm-adsprop-notify-change.md) Message".</span><span class="sxs-lookup"><span data-stu-id="dd66b-173">If the data in any page is changed and the **OK** or **Apply** buttons are clicked, the window identified by the **hwndParentSheet** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) message.</span></span> <span data-ttu-id="dd66b-174">Bei dieser Nachricht handelt es sich um eine reine Benachrichtigung, die keine bestimmte Aktion erfordert.</span><span class="sxs-lookup"><span data-stu-id="dd66b-174">This message is strictly a notification and requires no specific action.</span></span>

<span data-ttu-id="dd66b-175">Wenn die Seite geschlossen wird, erhält das Fenster, das durch das **hwndhidden** -Element der [**propsheetcfg**](propsheetcfg.md) -Struktur identifiziert wird, eine Meldung zum [**\_ \_ \_ Schließen \_**](wm-dsa-sheet-close-notify.md) der "WM-DSA".</span><span class="sxs-lookup"><span data-stu-id="dd66b-175">When the page is closed, the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="dd66b-176">Bei dieser Nachricht handelt es sich um eine reine Benachrichtigung, und es muss keine bestimmte Aktion ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="dd66b-176">This message is strictly a notification and requires no specific action to be performed.</span></span>

<span data-ttu-id="dd66b-177">In einigen Fällen muss für die vorhandenen Eigenschaften Blätter ein sekundäres Eigenschaften Blatt angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="dd66b-177">In some cases, the existing property sheets will need to display a secondary property sheet.</span></span> <span data-ttu-id="dd66b-178">Wenn Sie z. b. das Eigenschaften Blatt für ein Benutzerobjekt anzeigen und das **Mitglied der** Seite auswählen, wird eine Liste der Gruppen angezeigt, in denen der Benutzer Mitglied ist.</span><span class="sxs-lookup"><span data-stu-id="dd66b-178">For example, if you display the property sheet for a user object and select the **Member Of** page, a list of groups that the user is a member of will be displayed.</span></span> <span data-ttu-id="dd66b-179">Wenn Sie auf eine dieser Gruppen in der Liste doppelklicken, wird das Eigenschaften Blatt für diese Gruppe angezeigt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-179">If you double-click one of these groups in the list, the property sheet for that group will be displayed.</span></span> <span data-ttu-id="dd66b-180">Auf dem primären Eigenschaften Blatt wird das sekundäre Blatt nicht allein angezeigt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-180">The primary property sheet does not display the secondary sheet by itself.</span></span> <span data-ttu-id="dd66b-181">Sie fordert an, dass der Host das sekundäre Blatt anzeigt, indem er ein [**WM- \_ DSA- \_ Blatt \_ Create \_ Notify**](wm-dsa-sheet-create-notify.md) Message an das Fenster sendet, das vom **hwndhidden** -Member der [**propsheetcfg**](propsheetcfg.md) -Struktur identifiziert wird.</span><span class="sxs-lookup"><span data-stu-id="dd66b-181">It requests that the host display the secondary sheet by sending a [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) message to the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure.</span></span> <span data-ttu-id="dd66b-182">Der *wParam* des **WM- \_ DSA- \_ Blatts \_ Create \_ Notify** Message ist ein Zeiger auf eine [**DSA sec- \_ \_ Seiten \_**](dsa-sec-page-info.md) Informationsstruktur, die Informationen über das sekundäre Eigenschaften Blatt und das Objekt enthält, das es darstellt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-182">The *wParam* of the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message is a pointer to a [**DSA\_SEC\_PAGE\_INFO**](dsa-sec-page-info.md) structure that contains information about the secondary property sheet and the object that it represents.</span></span> <span data-ttu-id="dd66b-183">Als Antwort auf diese Nachricht muss der Eigenschaften Blatt Host das sekundäre Eigenschaften Blatt auf die gleiche Weise wie oben dargestellt anzeigen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-183">In response to this message, the property sheet host must display the secondary property sheet in the same manner as shown above.</span></span> <span data-ttu-id="dd66b-184">Nach der Verarbeitung des **WM- \_ DSA- \_ Blatts \_ Create \_ Notify** Message muss der Nachrichtenempfänger die **DSA sec- \_ \_ Seiten \_ Informations** Struktur freigeben, indem er den *wParam* -Wert an die [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) -Funktion übergibt.</span><span class="sxs-lookup"><span data-stu-id="dd66b-184">After processing the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message, the message receiver must free the **DSA\_SEC\_PAGE\_INFO** structure by passing the *wParam* value to the [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) function.</span></span>

## <a name="duplicating-the-behavior-of-the-clsid_dspropertypages-object"></a><span data-ttu-id="dd66b-185">Duplizieren des Verhaltens des CLSID- \_ dspropertypages-Objekts</span><span class="sxs-lookup"><span data-stu-id="dd66b-185">Duplicating the Behavior of the CLSID\_DsPropertyPages Object</span></span>

<span data-ttu-id="dd66b-186">**So duplizieren Sie das Verhalten des CLSID- \_ dspropertypages-Objekts**</span><span class="sxs-lookup"><span data-stu-id="dd66b-186">**To duplicate the behavior of the CLSID\_DsPropertyPages object**</span></span>

1.  <span data-ttu-id="dd66b-187">Zählen Sie die Werte im Attribut [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) oder [**shellpropertypages**](/windows/desktop/ADSchema/a-shellpropertypages) für den Anzeigespezifizierer für die Objektklasse auf.</span><span class="sxs-lookup"><span data-stu-id="dd66b-187">Enumerate the values in the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) or [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute for the display specifier for the object class.</span></span> <span data-ttu-id="dd66b-188">Jeder Wert ist eine Zeichenfolge, die eine Zahl gefolgt von einem Komma enthält, gefolgt von der Zeichen folgen Darstellung des Klassen Bezeichners der Erweiterung der Eigenschaften Seite.</span><span class="sxs-lookup"><span data-stu-id="dd66b-188">Each value is a string that contains a number, followed by a comma, followed by the string representation of the class identifier of the property page extension.</span></span> <span data-ttu-id="dd66b-189">Weitere Informationen zum Format der Eigenschaften Seiten Anzeige spezifiziererwerte finden Sie unter [Registrieren des COM-Objekts der Eigenschaften Seite in einem Anzeigespezifizierer](registering-the-property-page-com-object-in-a-display-specifier.md).</span><span class="sxs-lookup"><span data-stu-id="dd66b-189">For more information about the format of the property pages display specifier values, see [Registering the Property Page COM Object in a Display Specifier](registering-the-property-page-com-object-in-a-display-specifier.md).</span></span>
2.  <span data-ttu-id="dd66b-190">Konvertieren Sie jede Klassen-Bezeichnerzeichenfolge mithilfe der [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) -Funktion in eine **CLSID** .</span><span class="sxs-lookup"><span data-stu-id="dd66b-190">Convert each class identifier string into a **CLSID** using the [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>
3.  <span data-ttu-id="dd66b-191">Sortieren Sie die Bezeichner der Erweiterungs Klasse nach der Zahl, die den einzelnen Klassen-ID-Zeichen folgen im Attribut Wert vorangestellt ist.</span><span class="sxs-lookup"><span data-stu-id="dd66b-191">Sort the extension class identifiers by the number that precedes each class identifier string in the attribute value.</span></span> <span data-ttu-id="dd66b-192">Wenn zwei Zahlen identisch sind, Sortieren Sie die Klassen Bezeichner in der Reihenfolge, in der die Attributwerte vom Active Directory Server abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="dd66b-192">If two numbers are identical, sort the class identifiers in the order that the attribute values are obtained from the Active Directory server.</span></span>
4.  <span data-ttu-id="dd66b-193">Listet die Erweiterungs Klassen Bezeichner auf und erstellt eine Instanz der einzelnen Erweiterungen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-193">Enumerate the extension class identifiers, creating an instance of each extension.</span></span>
5.  <span data-ttu-id="dd66b-194">Nennen Sie für jede Erweiterung in der oben aufgeführten Reihenfolge die [**ishellextinit:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) -Erweiterung mit denselben Informationen, die Sie in Schritt 4 des Eigenschaften Blatts zum Hosting eines Active Directory Benutzer und Computers beschrieben haben.</span><span class="sxs-lookup"><span data-stu-id="dd66b-194">For each extension, in the order sorted above, call the extension's [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) with the same information described in Step 4 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>
6.  <span data-ttu-id="dd66b-195">Nennen Sie für jede Erweiterung in der oben aufgeführten Reihenfolge die [**ishellpropsheetext:: addPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) der Erweiterung mit denselben Informationen, die Sie in Schritt 5 des Eigenschaften Blatts zum Hosting eines Active Directory Benutzer und Computers beschrieben haben.</span><span class="sxs-lookup"><span data-stu-id="dd66b-195">For each extension, in the order sorted above, call the extension's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) with the same information described in Step 5 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>

<span data-ttu-id="dd66b-196">Verwenden Sie nach Möglichkeit das [**CLSID- \_ dspropertypages**](guids-of-user-interface-elements.md) -Objekt, um die Seiten zu erstellen, anstatt dies manuell zu tun.</span><span class="sxs-lookup"><span data-stu-id="dd66b-196">If possible, use the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object to create the pages rather than do this manually.</span></span> <span data-ttu-id="dd66b-197">Die **CLSID- \_ dspropertypages** wurde optimiert und behandelt Fehlerfälle ordnungsgemäß, z. b. Wenn für das aktuelle Gebiets Schema kein Anzeigespezifizierer verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="dd66b-197">The **CLSID\_DsPropertyPages** has been optimized and will correctly handle failure cases, such as when no display specifier is available for the current locale.</span></span> <span data-ttu-id="dd66b-198">Außerdem kann sich das **CLSID- \_ dspropertypages** -Objekt in Zukunft ändern. Dies bedeutet, dass ihre Eigenschaften Blätter möglicherweise nicht genau mit den Eigenschaften des MMC-Snap-Ins "Active Directory Benutzer und Computer" übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="dd66b-198">Also, the **CLSID\_DsPropertyPages** object may change in the future, which means your property sheets may not exactly match those displayed by the Active Directory Users and Computers MMC snap-in.</span></span>

## <a name="special-programming-elements"></a><span data-ttu-id="dd66b-199">Besondere Programmier Elemente</span><span class="sxs-lookup"><span data-stu-id="dd66b-199">Special Programming Elements</span></span>

<span data-ttu-id="dd66b-200">Derzeit sind die folgenden Programmier Elemente nicht in einer veröffentlichten Header Datei definiert.</span><span class="sxs-lookup"><span data-stu-id="dd66b-200">Currently, the following programming elements are not defined in a published header file.</span></span> <span data-ttu-id="dd66b-201">Wenn Sie diese Elemente verwenden möchten, müssen Sie Sie im exakten Format definieren, das auf der jeweiligen Verweisseite angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="dd66b-201">To use these elements, you must define them yourself in the exact format shown in the particular reference page.</span></span>

-   [<span data-ttu-id="dd66b-202">**cfstr \_ DS \_ propsheetconfig**</span><span class="sxs-lookup"><span data-stu-id="dd66b-202">**CFSTR\_DS\_PROPSHEETCONFIG**</span></span>](cfstr-ds-propsheetconfig.md)
-   [<span data-ttu-id="dd66b-203">**Propsheetcfg**</span><span class="sxs-lookup"><span data-stu-id="dd66b-203">**PROPSHEETCFG**</span></span>](propsheetcfg.md)
-   [<span data-ttu-id="dd66b-204">**WM- \_ DSA- \_ Blatt " \_ Schließen \_ "**</span><span class="sxs-lookup"><span data-stu-id="dd66b-204">**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**</span></span>](wm-dsa-sheet-close-notify.md)
-   [<span data-ttu-id="dd66b-205">**WM \_ - \_ Blatt "DSA \_ Erstellen \_ "**</span><span class="sxs-lookup"><span data-stu-id="dd66b-205">**WM\_DSA\_SHEET\_CREATE\_NOTIFY**</span></span>](wm-dsa-sheet-create-notify.md)
-   [<span data-ttu-id="dd66b-206">**\_ \_ Seite \_ Informationen zu DSA sec**</span><span class="sxs-lookup"><span data-stu-id="dd66b-206">**DSA\_SEC\_PAGE\_INFO**</span></span>](dsa-sec-page-info.md)

## <a name="example-code"></a><span data-ttu-id="dd66b-207">Beispielcode</span><span class="sxs-lookup"><span data-stu-id="dd66b-207">Example Code</span></span>

<span data-ttu-id="dd66b-208">Im folgenden C++-Codebeispiel wird eine sichere Möglichkeit zum Definieren dieser Elemente veranschaulicht, die weiterhin funktionieren, auch wenn diese Elemente in Zukunft in einer veröffentlichten Header Datei definiert sind.</span><span class="sxs-lookup"><span data-stu-id="dd66b-208">The following C++ code example shows a safe way to define these elements that will continue to work even if these elements are defined in a published header file in the future.</span></span>


```C++
#ifndef CFSTR_DS_PROPSHEETCONFIG
    #define CFSTR_DS_PROPSHEETCONFIG_W L"DsPropSheetCfgClipFormat"
    #define CFSTR_DS_PROPSHEETCONFIG_A "DsPropSheetCfgClipFormat"

    #ifdef UNICODE
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_W
    #else
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_A
    #endif //UNICODE
#endif //CFSTR_DS_PROPSHEETCONFIG


#ifndef WM_ADSPROP_SHEET_CREATE
    #define WM_ADSPROP_SHEET_CREATE (WM_USER + 1108)
#endif


#ifndef WM_DSA_SHEET_CREATE_NOTIFY
    #define WM_DSA_SHEET_CREATE_NOTIFY (WM_USER + 6)
#endif


#ifndef WM_DSA_SHEET_CLOSE_NOTIFY
    #define WM_DSA_SHEET_CLOSE_NOTIFY (WM_USER + 5) 
#endif


#ifndef DSA_SEC_PAGE_INFO
    typedef struct _DSA_SEC_PAGE_INFO
    {
        HWND    hwndParentSheet;
        DWORD   offsetTitle;
        DSOBJECTNAMES dsObjectNames;
    } DSA_SEC_PAGE_INFO, *PDSA_SEC_PAGE_INFO;
#endif //DSA_SEC_PAGE_INFO

#ifndef PROPSHEETCFG
    typedef struct _PROPSHEETCFG
    {  
        LONG_PTR lNotifyHandle;  
        HWND hwndParentSheet;  
        HWND hwndHidden;  
        WPARAM wParamSheetClose;
    } PROPSHEETCFG, *PPROPSHEETCFG;
#endif //PROPSHEETCFG
```



 

