---
title: Sprachleiste (Textdienste)
description: Sprachleiste
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- Textdienstframework (TSF), Sprachleiste
- TSF (Textdienstframework),Sprachleiste
- Textdienste, Sprachleiste
- Sprachleiste
- Textdienstframework (TSF), Schaltflächen
- TSF (Textdienstframework),Schaltflächen
- Textdienste, Schaltflächen
- Textdienstframework (TSF),Menüs
- TSF (Textdienstframework),Menüs
- Textdienste, Menüs
- Schaltflächenstile
- Menüschaltflächen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e3c4359c6753f5d96613435f9501036f1d5f317
ms.sourcegitcommit: 8ebcf6cd36f67f8bcf78e76ae8923d65b8995c8a
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/05/2021
ms.locfileid: "111524444"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="2b8fc-115">Sprachleiste (Textdienste)</span><span class="sxs-lookup"><span data-stu-id="2b8fc-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="2b8fc-116">Implementieren des Sprachleistenobjekts</span><span class="sxs-lookup"><span data-stu-id="2b8fc-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="2b8fc-117">Um das Hinzufügen eines Elements zur Sprachleiste zu unterstützen, muss ein Textdienst ein Objekt implementieren, das die [ITfSource-Schnittstelle](/windows/desktop/api/msctf/nn-msctf-itfsource) und eines der [ITfLangBarItem-Steuerelementelemente](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) unterstützt.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="2b8fc-118">Wenn das Element installiert ist, installiert die Sprachleiste eine [ITfLangBarItemSink-Senke,](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) indem die [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) des Elements mit IID \_ ITfLangBarItemSink aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="2b8fc-119">Das Element verwendet die **ITfLangBarItemSink-Schnittstelle,** um die Sprachleiste über Änderungen zu benachrichtigen, z. B. wenn das Element ausgeblendet, angezeigt, aktiviert oder deaktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="2b8fc-120">Vier Typen von Sprachleistenelementen können installiert werden, und jede der erforderlichen Schnittstellen wird aus **ITfLangBarItem** erstellt.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="2b8fc-121">Im Folgenden sind mögliche **ITfLangBarItem-Steuerelementelemente** enthalten.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|   <span data-ttu-id="2b8fc-122">Element</span><span class="sxs-lookup"><span data-stu-id="2b8fc-122">Element</span></span>            |    <span data-ttu-id="2b8fc-123">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="2b8fc-123">Description</span></span>                                                                                                                                                                               |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2b8fc-124">Schaltfläche</span><span class="sxs-lookup"><span data-stu-id="2b8fc-124">Button</span></span>        | <span data-ttu-id="2b8fc-125">Eine Sprachleistenschaltfläche fungiert als Befehlsschaltfläche, Umschaltfläche oder menü auf der Sprachleiste.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-125">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="2b8fc-126">Das -Objekt muss die ITfLangBarItemButton-Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-126">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="2b8fc-127">Ballon</span><span class="sxs-lookup"><span data-stu-id="2b8fc-127">Balloon</span></span>       | <span data-ttu-id="2b8fc-128">Ein Sprachleistensprechblasen fungiert als Popupbenachrichtigung auf der Sprachleiste.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-128">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="2b8fc-129">Das -Objekt muss die ITfLangBarItemBalloon-Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-129">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="2b8fc-130">Bitmap</span><span class="sxs-lookup"><span data-stu-id="2b8fc-130">Bitmap</span></span>        | <span data-ttu-id="2b8fc-131">Eine Sprachleistenbitmap fungiert als statisches Element auf der Sprachleiste, das eine Bitmap anzeigt.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-131">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="2b8fc-132">Das -Objekt muss die ITfLangBarItemBitmap-Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-132">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="2b8fc-133">Bitmapschaltfläche</span><span class="sxs-lookup"><span data-stu-id="2b8fc-133">Bitmap Button</span></span> | <span data-ttu-id="2b8fc-134">Eine Sprachleisten-Bitmapschaltfläche fungiert als Schaltflächenelement auf der Sprachleiste, das Text und eine Bitmap anzeigt.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-134">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="2b8fc-135">Das -Objekt muss die ITfLangBarItemBitmapButton-Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-135">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="2b8fc-136">Schaltflächenstile</span><span class="sxs-lookup"><span data-stu-id="2b8fc-136">Button Styles</span></span>

<span data-ttu-id="2b8fc-137">Ein Schaltflächenelement kann wie jedes der folgenden elemente funktionieren.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-137">A button element can function as any of the following.</span></span> <span data-ttu-id="2b8fc-138">Die Funktion des Schaltflächenelements wird durch die Flags bestimmt, die im **dwStyle-Member** der [TF \_ LANGBARITEMINFO-Struktur](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) in der [ITfLangBarItem::GetInfo-Methode](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-138">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|    <span data-ttu-id="2b8fc-139">Element</span><span class="sxs-lookup"><span data-stu-id="2b8fc-139">Element</span></span>           |    <span data-ttu-id="2b8fc-140">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="2b8fc-140">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2b8fc-141">Schaltfläche</span><span class="sxs-lookup"><span data-stu-id="2b8fc-141">Button</span></span>        | <span data-ttu-id="2b8fc-142">Die Schaltfläche fungiert als Standardbefehlsschaltfläche.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-142">The button functions as a standard command button.</span></span> <span data-ttu-id="2b8fc-143">Dieser Schaltflächenstil wird durch den \_ TF LBI \_ STYLE \_ BTN \_ BUTTON-Stil identifiziert.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-143">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="2b8fc-144">ITfLangBarItemButton::OnClick wird aufgerufen, wenn auf das Element geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-144">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="2b8fc-145">ITfLangBarItemButton::InitMenu und ITfLangBarItemButton::OnMenuSelect werden nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-145">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="2b8fc-146">Umschaltfläche</span><span class="sxs-lookup"><span data-stu-id="2b8fc-146">Toggle Button</span></span> | <span data-ttu-id="2b8fc-147">Die Schaltfläche fungiert als Ein-/Ausschalten-Steuerelement, das einen angeklickten Zustand beibehalten kann, ähnlich wie ein Kontrollkästchen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-147">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="2b8fc-148">Dieser Schaltflächenstil wird durch den \_ TF LBI \_ STYLE \_ BTN \_ TOGGLE-Stil identifiziert.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-148">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="2b8fc-149">ITfLangBarItemButton::OnClick wird aufgerufen, wenn auf das Element geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-149">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="2b8fc-150">ITfLangBarItemButton::InitMenu und ITfLangBarItemButton::OnMenuSelect werden nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-150">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="2b8fc-151">Menü</span><span class="sxs-lookup"><span data-stu-id="2b8fc-151">Menu</span></span>          | <span data-ttu-id="2b8fc-152">Die Schaltfläche fungiert als Dropdownmenü.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-152">The button functions as a drop-down menu.</span></span> <span data-ttu-id="2b8fc-153">Dieser Schaltflächenstil wird durch den \_ \_ \_ BTN-MENÜstil des TF-LBI-Stils \_ identifiziert.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-153">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="2b8fc-154">ITfLangBarItemButton::InitMenu wird aufgerufen, wenn auf die Schaltfläche geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-154">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="2b8fc-155">Wenn der Benutzer ein Element im Menü auswählt, ruft die Sprachleiste ITfLangBarItemButton::OnMenuSelect mit dem Bezeichner des ausgewählten Menüelements auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-155">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="2b8fc-156">ITfLangBarItemButton::OnClickis wird nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-156">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="2b8fc-157">Implementieren einer Menüschaltfläche</span><span class="sxs-lookup"><span data-stu-id="2b8fc-157">Implementing a Menu Button</span></span>

<span data-ttu-id="2b8fc-158">Wenn der Benutzer auf eine Menüschaltfläche klickt, ruft die Sprachleiste [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu)auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-158">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="2b8fc-159">Das Element fügt dem Menü Elemente mithilfe der [ITfMenu-Schnittstelle](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) hinzu, die an InitMenu übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-159">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="2b8fc-160">Um dem Menü ein Untermenü hinzuzufügen, rufen Sie [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) mit TF \_ LBMENUF \_ SUBMENU auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-160">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="2b8fc-161">Wenn dies erfolgt ist, wird im *ppMenu-Parameter* von AddMenuItem ein neues **ITfMenu-Objekt** zurückgegeben, das das Untermenü darstellt.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-161">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="2b8fc-162">Dieses neue Menüobjekt wird zum Hinzufügen von Elementen zum Untermenü verwendet.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-162">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="2b8fc-163">Wenn der Benutzer ein Element im Menü auswählt, ruft die Sprachleiste [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) mit dem Bezeichner des ausgewählten Menüelements auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-163">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="2b8fc-164">Hinzufügen von Elementen zur Sprachleiste</span><span class="sxs-lookup"><span data-stu-id="2b8fc-164">Adding Items to the Language Bar</span></span>

<span data-ttu-id="2b8fc-165">Ein Textdienst sollte seine Elemente der Sprachleiste hinzufügen, wenn seine [ITfTextInputProcessor::Activate-Methode](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) aufgerufen wird, und diese entfernen, wenn [ITfTextInputProcessor::D eactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-165">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="2b8fc-166">Um der Sprachleiste ein Element hinzuzufügen, ruft der Textdienst eine [ITfLangBarItemMgr-Schnittstelle](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) ab, indem er ITfThreadMgr::QueryInterface mit IID \_ ITfLangBarItemMgr aufruft.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-166">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="2b8fc-167">Der Textdienst ruft dann [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) mit dem Zeiger auf das Sprachleistenelementobjekt auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-167">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="2b8fc-168">Der Textdienst muss das Element entfernen, wenn es deaktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-168">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="2b8fc-169">Der Textdienst verwendet entweder die gleiche **ITfLangBarItemMgr-Schnittstelle,** die zum Hinzufügen der Elemente verwendet wird, oder ruft eine andere Instanz der Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-169">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="2b8fc-170">Der Textdienst ruft dann [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) mit dem Schnittstellenzeiger des zu entfernende Elements auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-170">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="2b8fc-171">Erweitern von Systemsprachleistenelementen</span><span class="sxs-lookup"><span data-stu-id="2b8fc-171">Extending System Language Bar Items</span></span>

<span data-ttu-id="2b8fc-172">TSF bietet die Möglichkeit, vorhandenen Sprachleistenmenüs Menüelemente hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-172">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="2b8fc-173">Dadurch kann ein Textdienst Elemente zum Menü eines anderen Textdiensts hinzufügen, ohne der Symbolleiste eine separate Schaltfläche hinzufügen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-173">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="2b8fc-174">Dadurch können die Menüelemente auch in logische Gruppen organisiert werden.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-174">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="2b8fc-175">Beispielsweise kann ein Textdienst, der dem Standard-Sprachtextdienst zusätzliche Features bietet, Elemente zum Sprachtextdienstmenü hinzufügen, anstatt eine eigene Menüschaltfläche der obersten Ebene hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-175">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="2b8fc-176">Ein Textdienst stellt eine Sprachleisten-Menüerweiterung bereit, indem ein -Objekt implementiert wird, das die [ITfSystemLangBarItemSink-Schnittstelle](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) unterstützt.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-176">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="2b8fc-177">Diese Schnittstelle funktioniert genau wie die [ITfLangBarItemButton-Schnittstelle](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) für eine Menüschaltfläche.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-177">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="2b8fc-178">Wenn das Menü angezeigt wird, ruft der erweiterte Textdienst [ITfSystemLangBarItemSink::InitMenu auf.](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu)</span><span class="sxs-lookup"><span data-stu-id="2b8fc-178">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="2b8fc-179">Die Erweiterung fügt dem Menü Elemente mithilfe der [ITfMenu-Schnittstelle](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) hinzu, die an **InitMenu** übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-179">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="2b8fc-180">Wenn der Benutzer ein von der Erweiterung hinzugefügtes Element auswählt, ruft der erweiterte Textdienst [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) mit dem Bezeichner des ausgewählten Menüelements auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-180">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="2b8fc-181">Um eine Sprachleisten-Menüerweiterung zu installieren, schließt der Textdienst die folgenden Schritte ab.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-181">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="2b8fc-182">Rufen Sie die **ITfLangBarItem-Schnittstelle** für das zu erweiternde Element ab, indem [Sie ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) mit der **GUID** für das zu erweiternde Element aufrufen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-182">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="2b8fc-183">Rufen Sie die **ITfSource-Schnittstelle** für das zu erweiternde Element ab, indem Sie ITfLangBarItem::QueryInterface mit IID \_ ITfSource aufrufen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-183">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="2b8fc-184">Rufen Sie [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) mit IID \_ ITfSystemLangBarItemSink und dem Zeiger auf das **ITfSystemLangBarItemSink-Objekt** auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-184">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="2b8fc-185">Wenn ITfSource::AdviseSink fehlschlägt, unterstützt der Textdienst keine Menüerweiterungen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-185">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="2b8fc-186">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span><span class="sxs-lookup"><span data-stu-id="2b8fc-186">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="2b8fc-187">Unterstützen von Sprachleisten-Menüerweiterungen</span><span class="sxs-lookup"><span data-stu-id="2b8fc-187">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="2b8fc-188">Ein Textdienst kann anderen Textdiensten das Hinzufügen von Elementen zu den Sprachleistenmenüs wie oben gezeigt ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-188">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="2b8fc-189">Der Textdienst, der seine GUID veröffentlichen muss, damit das Element durch Aufrufen von [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem)abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-189">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="2b8fc-190">Um Menüerweiterungen zu unterstützen, muss der Textdienst die [ITfSource-Schnittstelle](/windows/desktop/api/msctf/nn-msctf-itfsource) unterstützen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-190">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="2b8fc-191">Die folgenden Schritte ermöglichen die Unterstützung für eine oder mehrere Menüerweiterungen.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-191">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="2b8fc-192">Wenn [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) mit IID \_ ITfSystemLangBarItemSink aufgerufen wird, muss der Textdienst die **ITfSystemLangBarItemSink-Schnittstelle** speichern und einen Cookiewert zurückgeben, der die Erweiterung identifiziert.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-192">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="2b8fc-193">Wenn [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) aufgerufen wird, ruft der Textdienst die [ITfSystemLangBarItemSink::InitMenu-Methode](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) der Erweiterung auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-193">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="2b8fc-194">Der Textdienst muss eine Möglichkeit implementieren, die von der Erweiterung hinzugefügten Menüelemente im Gegensatz zu den vom Textdienst selbst hinzugefügten Elementen zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-194">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="2b8fc-195">Wenn [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) mit einem Menüelementbezeichner aufgerufen wird, der zu einer Erweiterung gehört, ruft der Textdienst die **ITfSystemLangBarItemSink::OnMenuSelect-Methode** der Erweiterung auf.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-195">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="2b8fc-196">Wenn [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) mit dem entsprechenden Cookie aufgerufen wird, entfernt der Textdienst die Menüerweiterung.</span><span class="sxs-lookup"><span data-stu-id="2b8fc-196">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2b8fc-197">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="2b8fc-197">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2b8fc-198">Einrichten von Textdienstframework</span><span class="sxs-lookup"><span data-stu-id="2b8fc-198">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="2b8fc-199">Sprachleiste (Anwendungen)</span><span class="sxs-lookup"><span data-stu-id="2b8fc-199">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
