---
title: Sprach Leiste (Text Dienste)
description: Sprach Leiste
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- Text Services-Framework (TSF), sprach Leiste
- TSF (Text Dienst Framework), sprach Leiste
- Text Dienste, sprach Leiste
- sprach Leiste
- Text Dienst Framework (TSF), Schaltflächen
- TSF (Text Dienst Framework), Schaltflächen
- Text Dienste, Schaltflächen
- Text Dienste-Framework (TSF), Menüs
- TSF (Text Dienste-Framework), Menüs
- Text Dienste, Menüs
- Schaltflächenstile
- Menü Schaltflächen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c41d64a488406f6eefcff5fef6c11093af00bc5b
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/10/2020
ms.locfileid: "104391459"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="9f95a-115">Sprach Leiste (Text Dienste)</span><span class="sxs-lookup"><span data-stu-id="9f95a-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="9f95a-116">Implementieren des Language Bar-Objekts</span><span class="sxs-lookup"><span data-stu-id="9f95a-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="9f95a-117">Um das Hinzufügen eines Elements zur sprach Leiste zu unterstützen, muss ein Text Dienst ein Objekt implementieren, das die [itfsource](/windows/desktop/api/msctf/nn-msctf-itfsource) -Schnittstelle und eines der [itflangbaritem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) -Steuerelement Elemente unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9f95a-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="9f95a-118">Wenn das Element installiert ist, installiert die sprach Leiste eine [itflangbaritemsink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) -Senke, indem das [itfsource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) -Element des Elements mit IID \_ itflangbaritemsink aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="9f95a-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="9f95a-119">Das Element verwendet die **itflangbaritemsink** -Schnittstelle, um die sprach Leiste von Änderungen zu benachrichtigen, z. b. wenn das Element ausgeblendet, angezeigt, aktiviert oder deaktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="9f95a-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="9f95a-120">Es können vier Arten von sprach leisten Elementen installiert werden, und alle erforderlichen Schnittstellen werden aus **itslangbaritem** erstellt.</span><span class="sxs-lookup"><span data-stu-id="9f95a-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="9f95a-121">Im folgenden finden Sie mögliche **itslangbaritem** -Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="9f95a-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|               |                                                                                                                                                                                   |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9f95a-122">Schaltfläche</span><span class="sxs-lookup"><span data-stu-id="9f95a-122">Button</span></span>        | <span data-ttu-id="9f95a-123">Eine sprach leisten Schaltfläche dient als Befehls Schaltfläche, UMSCHALT Steuerelement oder Menü auf der sprach Leiste.</span><span class="sxs-lookup"><span data-stu-id="9f95a-123">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="9f95a-124">Das Objekt muss die itflangbaritembutton-Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-124">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="9f95a-125">Ballons</span><span class="sxs-lookup"><span data-stu-id="9f95a-125">Balloon</span></span>       | <span data-ttu-id="9f95a-126">Eine sprach leisten Sprechblase fungiert als Popup Benachrichtigung auf der sprach Leiste.</span><span class="sxs-lookup"><span data-stu-id="9f95a-126">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="9f95a-127">Das Objekt muss die Schnittstelle itbolangbaritemballoon unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-127">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="9f95a-128">Bitmap</span><span class="sxs-lookup"><span data-stu-id="9f95a-128">Bitmap</span></span>        | <span data-ttu-id="9f95a-129">Eine sprach leisten Bitmap fungiert als statisches Element auf der sprach Leiste, das eine Bitmap anzeigt.</span><span class="sxs-lookup"><span data-stu-id="9f95a-129">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="9f95a-130">Das Objekt muss die itblangbaritembitmap-Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-130">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="9f95a-131">Bitmap-Schaltfläche</span><span class="sxs-lookup"><span data-stu-id="9f95a-131">Bitmap Button</span></span> | <span data-ttu-id="9f95a-132">Eine Schaltfläche für eine sprach leisten-Bitmap fungiert als Schaltflächen Element auf der sprach Leiste, auf der Text und eine Bitmap angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="9f95a-132">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="9f95a-133">Das Objekt muss die itflangbaritembitmapbutton-Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-133">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="9f95a-134">Schaltflächenstile</span><span class="sxs-lookup"><span data-stu-id="9f95a-134">Button Styles</span></span>

<span data-ttu-id="9f95a-135">Ein Button-Element kann wie folgt funktionieren.</span><span class="sxs-lookup"><span data-stu-id="9f95a-135">A button element can function as any of the following.</span></span> <span data-ttu-id="9f95a-136">Die Funktion des Schaltflächen Elements wird durch die Flags bestimmt, die im **dwstyle** -Member der [tf \_ langbariteminfo](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) -Struktur in der [itflangbaritem:: GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) -Methode festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="9f95a-136">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|               |                                                                                                                                                                                                                                                                                                                                                                                      |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9f95a-137">Schaltfläche</span><span class="sxs-lookup"><span data-stu-id="9f95a-137">Button</span></span>        | <span data-ttu-id="9f95a-138">Die Schaltfläche dient als Standard Befehls Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="9f95a-138">The button functions as a standard command button.</span></span> <span data-ttu-id="9f95a-139">Dieser Schaltflächen Stil wird durch den Formatvorlagen Stil der TF-LBI-Formatvorlage identifiziert \_ \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="9f95a-139">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="9f95a-140">Itflangbaritembutton:: OnClick wird aufgerufen, wenn auf das Element geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="9f95a-140">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="9f95a-141">Itflangbaritembutton:: InitMenu und itflangbaritembutton:: onmenuselect werden nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="9f95a-141">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="9f95a-142">Umschaltfläche</span><span class="sxs-lookup"><span data-stu-id="9f95a-142">Toggle Button</span></span> | <span data-ttu-id="9f95a-143">Die Schaltfläche fungiert als UMSCHALT Steuerelement, das einen angeklickten Zustand beibehalten kann, ähnlich wie ein Kontrollkästchen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-143">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="9f95a-144">Dieser Schaltflächen Stil wird durch den TF \_ LBI- \_ Stil \_ BTN- \_ UMSCHALT Stil identifiziert.</span><span class="sxs-lookup"><span data-stu-id="9f95a-144">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="9f95a-145">Itflangbaritembutton:: OnClick wird aufgerufen, wenn auf das Element geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="9f95a-145">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="9f95a-146">Itflangbaritembutton:: InitMenu und itflangbaritembutton:: onmenuselect werden nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="9f95a-146">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="9f95a-147">Menü</span><span class="sxs-lookup"><span data-stu-id="9f95a-147">Menu</span></span>          | <span data-ttu-id="9f95a-148">Die Schaltfläche dient als Dropdown Menü.</span><span class="sxs-lookup"><span data-stu-id="9f95a-148">The button functions as a drop-down menu.</span></span> <span data-ttu-id="9f95a-149">Dieser Schaltflächen Stil wird durch den Menü Stil für den TF \_ LBI- \_ Stil \_ BTN identifiziert \_ .</span><span class="sxs-lookup"><span data-stu-id="9f95a-149">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="9f95a-150">Itflangbaritembutton:: InitMenu wird aufgerufen, wenn auf die Schaltfläche geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="9f95a-150">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="9f95a-151">Wenn der Benutzer ein Element im Menü auswählt, ruft die sprach Leiste itflangbaritembutton:: onmenuselect mit dem Bezeichner des ausgewählten Menü Elements auf.</span><span class="sxs-lookup"><span data-stu-id="9f95a-151">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="9f95a-152">Itflangbaritembutton:: onclickis wird nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="9f95a-152">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="9f95a-153">Implementieren einer Menü Schaltfläche</span><span class="sxs-lookup"><span data-stu-id="9f95a-153">Implementing a Menu Button</span></span>

<span data-ttu-id="9f95a-154">Wenn der Benutzer auf eine Menü Schaltfläche klickt, ruft die sprach Leiste [itflangbaritembutton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu)auf.</span><span class="sxs-lookup"><span data-stu-id="9f95a-154">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="9f95a-155">Das Element fügt dem Menü Elemente mithilfe der [itfmenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) -Schnittstelle hinzu, die an InitMenu übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="9f95a-155">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="9f95a-156">Um dem Menü ein Untermenü hinzuzufügen, nennen Sie [itfmenu:: addmenuitem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) mit dem \_ unter Menü TF lbmenuf \_ .</span><span class="sxs-lookup"><span data-stu-id="9f95a-156">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="9f95a-157">Wenn dies der Fall ist, wird ein neues **ITF Menu** -Objekt, das das Untermenü darstellt, im *ppmenu* -Parameter von addmenuitem zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9f95a-157">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="9f95a-158">Dieses neue Menü Objekt wird verwendet, um dem Untermenü Elemente hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-158">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="9f95a-159">Wenn der Benutzer ein Element im Menü auswählt, ruft die sprach Leiste [itflangbaritembutton:: onmenuselect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) mit dem Bezeichner des ausgewählten Menü Elements auf.</span><span class="sxs-lookup"><span data-stu-id="9f95a-159">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="9f95a-160">Hinzufügen von Elementen zur sprach Leiste</span><span class="sxs-lookup"><span data-stu-id="9f95a-160">Adding Items to the Language Bar</span></span>

<span data-ttu-id="9f95a-161">Ein Text Dienst sollte seine Elemente der sprach Leiste hinzufügen, wenn die [itftextinputprocessor:: Aktivierungs](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) -Methode aufgerufen wird, und Sie entfernt werden, wenn [itftextinputprocessor::D eaktivierung](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="9f95a-161">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="9f95a-162">Um der sprach Leiste ein Element hinzuzufügen, ruft der Text Dienst eine [itflangbaritemmgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) -Schnittstelle ab, indem ITfThreadMgr:: QueryInterface mit IID \_ itflangbaritemmgr aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="9f95a-162">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="9f95a-163">Der Text Dienst ruft dann [itflangbaritemmgr:: AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) mit dem Zeiger auf das sprach leisten Element-Objekt auf.</span><span class="sxs-lookup"><span data-stu-id="9f95a-163">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="9f95a-164">Der Text Dienst muss das Element entfernen, wenn es deaktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="9f95a-164">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="9f95a-165">Der Text Dienst verwendet die gleiche **itflangbaritemmgr** -Schnittstelle, die zum Hinzufügen der Elemente verwendet wird, oder ruft eine andere Instanz der Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="9f95a-165">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="9f95a-166">Der Text Dienst ruft dann [itflangbaritemmgr:: RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) mit dem Schnittstellen Zeiger des zu entfernenden Elements auf.</span><span class="sxs-lookup"><span data-stu-id="9f95a-166">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="9f95a-167">Erweitern von System sprach leisten Elementen</span><span class="sxs-lookup"><span data-stu-id="9f95a-167">Extending System Language Bar Items</span></span>

<span data-ttu-id="9f95a-168">TSF bietet die Möglichkeit, vorhandenen sprach leisten Menüs Menü Elemente hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-168">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="9f95a-169">Dadurch kann ein Text Dienst dem Menü eines anderen Text Dienstanbieter Elemente hinzufügen, ohne dass der Symbolleiste eine separate Schaltfläche hinzugefügt werden muss.</span><span class="sxs-lookup"><span data-stu-id="9f95a-169">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="9f95a-170">Dadurch können die Menü Elemente auch in logische Gruppen unterteilt werden.</span><span class="sxs-lookup"><span data-stu-id="9f95a-170">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="9f95a-171">Beispielsweise kann ein Text Dienst, der zusätzliche Funktionen für den Standard-sprach Text Dienst bereitstellt, dem sprach Text-Dienst Menü Elemente hinzufügen, anstatt seine eigene Menü Schaltfläche auf oberster Ebene hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-171">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="9f95a-172">Ein Text Dienst stellt eine sprach leisten-Menü Erweiterung bereit, indem er ein Objekt implementiert, das die [ITF systemlangbaritemsink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) -Schnittstelle unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9f95a-172">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="9f95a-173">Diese Schnittstelle funktioniert genau wie die [itflangbaritembutton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) -Schnittstelle für eine Menü Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="9f95a-173">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="9f95a-174">Wenn das Menü angezeigt wird, ruft der Text Dienst, der erweitert wird, [ITF systemlangbaritemsink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu)auf.</span><span class="sxs-lookup"><span data-stu-id="9f95a-174">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="9f95a-175">Die Erweiterung fügt dem Menü Elemente mithilfe der [itfmenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) -Schnittstelle hinzu, die an **InitMenu** übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="9f95a-175">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="9f95a-176">Wenn der Benutzer ein Element auswählt, das von der Erweiterung hinzugefügt wurde, ruft der Text Dienst, der erweitert wird, [ITF systemlangbaritemsink:: onmenuselect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) mit dem Bezeichner des ausgewählten Menü Elements auf.</span><span class="sxs-lookup"><span data-stu-id="9f95a-176">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="9f95a-177">Zum Installieren einer sprach leisten-Menü Erweiterung führt der Text Dienst die folgenden Schritte aus.</span><span class="sxs-lookup"><span data-stu-id="9f95a-177">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="9f95a-178">Rufen Sie die **itflangbaritem** -Schnittstelle für das Element ab, das Sie erweitern möchten, indem Sie [itflangbaritemmgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) mit der **GUID** für das Element aufrufen, das erweitert werden soll.</span><span class="sxs-lookup"><span data-stu-id="9f95a-178">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="9f95a-179">Rufen Sie die **itfsource** -Schnittstelle für das Element ab, das durch Aufrufen von itflangbaritem:: QueryInterface mit IID \_ itfsource erweitert werden soll.</span><span class="sxs-lookup"><span data-stu-id="9f95a-179">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="9f95a-180">Aufrufen von [itfsource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) mit IID \_ itfsystemlangbaritemsink und dem Zeiger auf das **itfsystemlangbaritemsink** -Objekt.</span><span class="sxs-lookup"><span data-stu-id="9f95a-180">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="9f95a-181">Wenn ITF Source:: AdviseSink fehlschlägt, unterstützt der Text Dienst keine Menü Erweiterungen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-181">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="9f95a-182">[ITF Source:: unadvisesink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITF Source:: AdviseSink**</span><span class="sxs-lookup"><span data-stu-id="9f95a-182">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="9f95a-183">Unterstützende sprach leisten-Menü Erweiterungen</span><span class="sxs-lookup"><span data-stu-id="9f95a-183">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="9f95a-184">Ein Text Dienst kann anderen Text Diensten das Hinzufügen von Elementen zu den sprach leisten Menüs ermöglichen, wie oben gezeigt.</span><span class="sxs-lookup"><span data-stu-id="9f95a-184">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="9f95a-185">Der Text Dienst, der seine GUID veröffentlichen muss, damit das Element durch Aufrufen von [itflangbaritemmgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem)abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="9f95a-185">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="9f95a-186">Um Menü Erweiterungen zu unterstützen, muss der Text Dienst die [itfsource](/windows/desktop/api/msctf/nn-msctf-itfsource) -Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-186">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="9f95a-187">Die folgenden Schritte ermöglichen die Unterstützung für eine oder mehrere Menü Erweiterungen.</span><span class="sxs-lookup"><span data-stu-id="9f95a-187">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="9f95a-188">Wenn [itfsource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) mit IID \_ itfsystemlangbaritemsink aufgerufen wird, muss der Text Dienst die **itfsystemlangbaritemsink** -Schnittstelle speichern und einen Cookie-Wert zurückgeben, der die Erweiterung identifiziert.</span><span class="sxs-lookup"><span data-stu-id="9f95a-188">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="9f95a-189">Wenn [itflangbaritembutton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) aufgerufen wird, ruft der Text Dienst die [itfsystemlangbaritemsink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) -Methode der Erweiterung auf.</span><span class="sxs-lookup"><span data-stu-id="9f95a-189">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="9f95a-190">Der Text Dienst muss eine Methode implementieren, um die von der Erweiterung hinzugefügten Menü Elemente im Gegensatz zu den Elementen, die durch den Text Dienst selbst hinzugefügt wurden, zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="9f95a-190">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="9f95a-191">Wenn [itflangbaritembutton:: onmenuselect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) mit einem Menü Element Bezeichner aufgerufen wird, der zu einer Erweiterung gehört, ruft der Text Dienst die **itfsystemlangbaritemsink:: onmenuselect** -Methode der Erweiterung auf.</span><span class="sxs-lookup"><span data-stu-id="9f95a-191">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="9f95a-192">Wenn [itfsource:: unadvisesink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) mit dem entsprechenden Cookie aufgerufen wird, entfernt der Text Dienst die Menü Erweiterung.</span><span class="sxs-lookup"><span data-stu-id="9f95a-192">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9f95a-193">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="9f95a-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9f95a-194">Einrichten des Text Dienst-Frameworks</span><span class="sxs-lookup"><span data-stu-id="9f95a-194">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="9f95a-195">Sprach Leiste (Anwendungen)</span><span class="sxs-lookup"><span data-stu-id="9f95a-195">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
