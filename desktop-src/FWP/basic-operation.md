---
title: WFP-Vorgang
description: Die Windows-Filter Plattform (WFP) führt ihre Aufgaben durch die Integration der folgenden grundlegenden Entitäts Ebenen, Filter, Shims und Callouts durch.
ms.assetid: bf88ace7-1160-434b-9be0-3f9db6aa2e87
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 44e7a7d38bd0de5b1f549e2187c414644bf68442
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "106338261"
---
# <a name="wfp-operation"></a><span data-ttu-id="66e90-103">WFP-Vorgang</span><span class="sxs-lookup"><span data-stu-id="66e90-103">WFP Operation</span></span>

<span data-ttu-id="66e90-104">Die Windows-Filter Plattform (WFP) führt ihre Aufgaben durch die Integration der folgenden grundlegenden Entitäten durch: *Ebenen*, *Filter*, *Shims* und *Legenden.*</span><span class="sxs-lookup"><span data-stu-id="66e90-104">Windows Filtering Platform (WFP) performs its tasks by integrating the following basic entities: *Layers*, *Filters*, *Shims*, and *Callouts*.</span></span>

## <a name="layers"></a><span data-ttu-id="66e90-105">Ebenen</span><span class="sxs-lookup"><span data-stu-id="66e90-105">Layers</span></span>

<span data-ttu-id="66e90-106">Eine *Ebene* ist ein Container, der von der Filter-Engine verwaltet wird, deren Funktion das Organisieren von Filtern in Sets vorsieht.</span><span class="sxs-lookup"><span data-stu-id="66e90-106">A *layer* is a container managed by the filter engine whose function is to organize filters into sets.</span></span> <span data-ttu-id="66e90-107">Eine Ebene ist kein Modul im Netzwerk Stapel.</span><span class="sxs-lookup"><span data-stu-id="66e90-107">A layer is not a module in the network stack.</span></span> <span data-ttu-id="66e90-108">Jede Ebene verfügt über ein Schema, das den Typ der Filter definiert, die dieser hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="66e90-108">Each layer has a schema that defines the type of filters that can be added to it.</span></span> <span data-ttu-id="66e90-109">Weitere Informationen finden Sie [unter Filterbedingungen, die auf jeder Filter Ebene verfügbar sind](filtering-conditions-available-at-each-filtering-layer.md) .</span><span class="sxs-lookup"><span data-stu-id="66e90-109">See [Filtering Conditions Available at Each Filtering Layer](filtering-conditions-available-at-each-filtering-layer.md) for more information.</span></span>

<span data-ttu-id="66e90-110">Ebenen können Unterebenen enthalten, um widersprüchliche Filteranforderungen zu verwalten, z. b. "Blockieren von TCP-Ports über 1024" und "Open Port 1080".</span><span class="sxs-lookup"><span data-stu-id="66e90-110">Layers may contain sub-layers to manage conflicting filter requirements such as "Block TCP ports above 1024" and "Open port 1080".</span></span> <span data-ttu-id="66e90-111">Die Regeln zum Verwalten von Filter Konflikten werden durch [Filter-Schiedsgerichtsbarkeit](filter-arbitration.md)bestimmt.</span><span class="sxs-lookup"><span data-stu-id="66e90-111">The rules for managing filtering conflicts are determined by [Filter Arbitration](filter-arbitration.md).</span></span>

<span data-ttu-id="66e90-112">WFP enthält eine Reihe [integrierter Unterebenen](management-filtering-sublayer-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="66e90-112">WFP contains a set of [built-in sub-layers](management-filtering-sublayer-identifiers.md).</span></span> <span data-ttu-id="66e90-113">Jede Ebene erbt alle integrierten Unterebenen.</span><span class="sxs-lookup"><span data-stu-id="66e90-113">Every layer inherits all the built-in sub-layers.</span></span> <span data-ttu-id="66e90-114">Benutzer können auch eigene untergeordnete Ebenen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="66e90-114">Users can also add their own sub-layers.</span></span>

<span data-ttu-id="66e90-115">Die Liste der Filter-Engine-Schichten finden Sie im Referenz Abschnitt [**Filtern von ebenenbezeichern**](management-filtering-layer-identifiers-.md).</span><span class="sxs-lookup"><span data-stu-id="66e90-115">The list of filter engine layers is provided in the reference section topic [**Filtering Layer Identifiers**](management-filtering-layer-identifiers-.md).</span></span>

## <a name="filters"></a><span data-ttu-id="66e90-116">Filter</span><span class="sxs-lookup"><span data-stu-id="66e90-116">Filters</span></span>

<span data-ttu-id="66e90-117">Ein *Filter* ist eine Regel, die mit eingehenden oder ausgehenden Paketen übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="66e90-117">A *filter* is a rule that is matched against incoming or outgoing packets.</span></span> <span data-ttu-id="66e90-118">Die Regel teilt der Filter-Engine mit, was mit dem Paket zu tun ist, einschließlich des aufrufungsmoduls für eine Tiefe Paket-oder Datenstrom Untersuchung.</span><span class="sxs-lookup"><span data-stu-id="66e90-118">The rule tells the filtering engine what to do with the packet, including to call a callout module for deep packet or stream inspection.</span></span> <span data-ttu-id="66e90-119">Ein Filter kann z. b. "Blockieren von Datenverkehr mit einem TCP-Port größer als 1024" oder "Aufrufe an IDs für nicht gesicherten Datenverkehr" angeben.</span><span class="sxs-lookup"><span data-stu-id="66e90-119">For example, a filter may specify "Block traffic with a TCP port greater than 1024" or "Call out to IDS for all traffic that is not secured."</span></span>

<span data-ttu-id="66e90-120">Ein Filter für die Start Zeit ist ein Filter, der zum Zeitpunkt der Startzeit erzwungen wird, sobald der TCP/IP-stapeltreiber (tcpip.sys) gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="66e90-120">A boot-time filter is a filter that is enforced at boot-time as soon as the TCP/IP stack driver (tcpip.sys) starts.</span></span> <span data-ttu-id="66e90-121">Ein Start Zeitfilter ist deaktiviert, wenn BFE gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="66e90-121">A boot-time filter is disabled when BFE starts.</span></span> <span data-ttu-id="66e90-122">Ein Filter wird als Start Zeit gekennzeichnet, indem das Flag "Boottime" für das [**fwpm- \_ \_ \_ filterflag**](/windows/desktop/api/Fwpmtypes/ns-fwpmtypes-fwpm_filter0) festgelegt wird, wenn [**FwpmFilterAdd0**](/windows/desktop/api/Fwpmu/nf-fwpmu-fwpmfilteradd0) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="66e90-122">A filter is marked as boot-time by setting the [**FWPM\_FILTER\_FLAG\_BOOTTIME**](/windows/desktop/api/Fwpmtypes/ns-fwpmtypes-fwpm_filter0) flag when [**FwpmFilterAdd0**](/windows/desktop/api/Fwpmu/nf-fwpmu-fwpmfilteradd0) is invoked.</span></span>

<span data-ttu-id="66e90-123">Ein Lauf Zeitfilter ist ein Filter, der nach dem Start von BFE erzwungen wird.</span><span class="sxs-lookup"><span data-stu-id="66e90-123">A run-time filter is a filter that is enforced after BFE starts.</span></span> <span data-ttu-id="66e90-124">Ein Lauf Zeitfilter kann abhängig von der Art der Erstellung statisch, dynamisch oder permanent sein.</span><span class="sxs-lookup"><span data-stu-id="66e90-124">A run-time filter can be static, dynamic, or persistent depending on the way it was created.</span></span> <span data-ttu-id="66e90-125">Weitere Informationen zu den verschiedenen Typen von Lauf Zeit Filtern und deren Lebensdauer finden Sie unter [Objekt Verwaltung](object-management.md) .</span><span class="sxs-lookup"><span data-stu-id="66e90-125">See [Object Management](object-management.md) for more information on the different types of run-time filters and their lifetime.</span></span>

## <a name="shims"></a><span data-ttu-id="66e90-126">Shims</span><span class="sxs-lookup"><span data-stu-id="66e90-126">Shims</span></span>

<span data-ttu-id="66e90-127">Ein *Shim* ist eine Kernelmoduskomponente, die Filter Entscheidungen durch die Klassifizierung der Filter-Engine-Ebenen ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="66e90-127">A *shim* is a kernel-mode component that makes filtering decisions by classifying against the filter engine layers.</span></span> <span data-ttu-id="66e90-128">Jedes Shim klassifiziert eine oder mehrere Ebenen.</span><span class="sxs-lookup"><span data-stu-id="66e90-128">Each shim classifies against one or more layers.</span></span> <span data-ttu-id="66e90-129">Beispielsweise klassifiziert das transportebenenmodul-Shim die eingehende Transportschicht, die ausgehende Transportschicht und die ALE Connect-und Receive-Accept Ebenen für das erste Paket eines Flows.</span><span class="sxs-lookup"><span data-stu-id="66e90-129">For example, the Transport Layer Module shim classifies against the Inbound Transport layer, the Outbound Transport layer, and the ALE Connect and Receive-Accept layers for the first packet of a flow.</span></span>

<span data-ttu-id="66e90-130">Da Pakete, Streams und Ereignisse den Netzwerk Stapel durchlaufen, analysieren die Shims diese, um die klassifizierbaren Bedingungen und Werte zu extrahieren, und dann die Filter-Engine aufzurufen, um Sie anhand der Filter in einer bestimmten Ebene auszuwerten.</span><span class="sxs-lookup"><span data-stu-id="66e90-130">As packets, streams, and events traverse the network stack, the shims parse them to extract the classifiable conditions and values, and then call into the filter engine to evaluate them against the filters in a given layer.</span></span> <span data-ttu-id="66e90-131">Die Filter-Engine kann eine oder mehrere Legenden als Teil der Klassifizierung aufrufen.</span><span class="sxs-lookup"><span data-stu-id="66e90-131">The filter engine may invoke one or more callouts as part of the classification.</span></span> <span data-ttu-id="66e90-132">Die Shims führen das eigentliche Löschen von Paketen, Streams und Ereignissen basierend auf dem Ergebnis der Klassifizierung durch, die von der Filter-Engine ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="66e90-132">The shims do the actual dropping of packets, streams, and events based on the result of the classification performed by the filter engine.</span></span>

## <a name="callouts"></a><span data-ttu-id="66e90-133">Aufrufe</span><span class="sxs-lookup"><span data-stu-id="66e90-133">Callouts</span></span>

<span data-ttu-id="66e90-134">Eine Legende ist eine Reihe von Funktionen *,* die von einem Treiber verfügbar gemacht und für die spezielle Filterung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="66e90-134">A *callout* is a set of functions exposed by a driver and used for specialized filtering.</span></span> <span data-ttu-id="66e90-135">Sie werden verwendet, um die Pakete zu analysieren und zu manipulieren, wie z. b. Viren Überprüfung, Überprüfung auf ungeeignete Inhalte durch die Überprüfung auf ungeeignete Inhalte, Paketdaten Analyse für Überwachungstools.</span><span class="sxs-lookup"><span data-stu-id="66e90-135">They are used to perform analysis and manipulation of the packets, such as virus scan, parental controls scan for inappropriate content, packet data parsing for monitoring tools.</span></span> <span data-ttu-id="66e90-136">Einige Legenden, wie z. b. der Network Address Translation (NAT)-Treiber, sind in das Betriebssystem integriert.</span><span class="sxs-lookup"><span data-stu-id="66e90-136">Some callouts, such as the Network Address Translation (NAT) driver, are built into the operating system.</span></span> <span data-ttu-id="66e90-137">Andere, wie z. b. eine HTTP-Steuerelement Legende oder das Angriffs Erkennungs System (ID), können von unabhängigen Softwareanbietern (ISVs) bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="66e90-137">Others, such as an HTTP Parental Control callout or the Intrusion Detection System (IDS) callout, can be provided by independent software vendors (ISVs).</span></span> <span data-ttu-id="66e90-138">Die Legenden Funktionen werden von der Filter-Engine aufgerufen, wenn ein entsprechender Legenden Filter auf einer bestimmten Ebene übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="66e90-138">The callout functions are invoked by the filter engine when a corresponding callout filter is matched at a given layer.</span></span>

<span data-ttu-id="66e90-139">Callouts können in jeder der Kernel Modus-WFP-Ebenen registriert werden.</span><span class="sxs-lookup"><span data-stu-id="66e90-139">Callouts can be registered at any of the kernel-mode WFP layers.</span></span> <span data-ttu-id="66e90-140">Callouts können eine Aktion ("blockieren", "zulassen") zurückgeben und beim Durchführen der streamüberprüfung "verzögern", "Weitere Daten benötigen", "Verbindung löschen") und den eingehenden und ausgehenden Netzwerk Datenverkehr ändern und sichern.</span><span class="sxs-lookup"><span data-stu-id="66e90-140">Callouts can return an action ("Block", "Permit", and, when performing stream inspection, "Defer", "Need more data", "Drop connection") and can modify and secure inbound and outbound network traffic.</span></span>

<span data-ttu-id="66e90-141">Sobald eine Legende bei der Filter-Engine registriert ist, kann Sie zu verarbeitende Netzwerk Datenverkehr empfangen.</span><span class="sxs-lookup"><span data-stu-id="66e90-141">Once a callout is registered with the filter engine, it can receive network traffic to process.</span></span> <span data-ttu-id="66e90-142">Der Datenverkehr kann abhängig von der Ebene Pakete, Streams oder Ereignisse sein.</span><span class="sxs-lookup"><span data-stu-id="66e90-142">The traffic may be packets, streams, or events depending on the layer.</span></span> <span data-ttu-id="66e90-143">Eine Anwendung oder ein Firewall-Agent bewirkt, dass Datenverkehr an eine Legende übermittelt wird, indem ein Filter hinzugefügt wird, dessen Aktion "Legenden" ist und dessen Legenden-ID der Bezeichner der Legende ist.</span><span class="sxs-lookup"><span data-stu-id="66e90-143">An application or firewall agent causes traffic to be passed to a callout by adding a filter whose action is "Callout" and whose callout ID is that callout's identifier.</span></span> <span data-ttu-id="66e90-144">Callouts können das Filtermodul anweisen, "Block" oder "zulassen" an das Shim zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="66e90-144">Callouts can instruct the filter engine to return "Block" or "Permit" to the shim.</span></span> <span data-ttu-id="66e90-145">Aufrufe können auch "Continue" zurückgeben, damit andere Filter das Paket verarbeiten können.</span><span class="sxs-lookup"><span data-stu-id="66e90-145">Callouts can also return "Continue" to allow other filters to process the packet.</span></span>

<span data-ttu-id="66e90-146">Mehrere Aufrufe können von einem Legenden Treiber verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="66e90-146">Multiple callouts may be exposed by one callout driver.</span></span>

<span data-ttu-id="66e90-147">Eine Legende muss hinzugefügt werden (mit [**FwpmCalloutAdd0**](/windows/desktop/api/Fwpmu/nf-fwpmu-fwpmcalloutadd0)) und (mit [fwpscallumgiester](/windows-hardware/drivers/ddi/_netvista/)) registriert werden, bevor Sie verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="66e90-147">A callout needs to be added (with [**FwpmCalloutAdd0**](/windows/desktop/api/Fwpmu/nf-fwpmu-fwpmcalloutadd0)) and registered (with [FwpsCalloutRegister](/windows-hardware/drivers/ddi/_netvista/)) before it can be used.</span></span> <span data-ttu-id="66e90-148">Vor der Erstellung von Filtern, die auf die Legende verweisen, ist ein Aufruf von **FwpmCalloutAdd0** erforderlich.</span><span class="sxs-lookup"><span data-stu-id="66e90-148">A call to **FwpmCalloutAdd0** is required before the creation of filters that reference the callout.</span></span> <span data-ttu-id="66e90-149">Ein Aufruf von fwpscallmysqgiester ist erforderlich, bevor WFP die Legende aufrufen kann, wenn die Legenden Filter abgeglichen werden.</span><span class="sxs-lookup"><span data-stu-id="66e90-149">A call to FwpsCalloutRegister is required before WFP can invoke the callout when the callout filters are matched.</span></span> <span data-ttu-id="66e90-150">Standardmäßig werden Filter, die auf Aufrufe verweisen, die hinzugefügt, aber noch nicht bei der Filter-Engine registriert wurden, als "Block Filter" behandelt.</span><span class="sxs-lookup"><span data-stu-id="66e90-150">By default filters that reference callouts that have been added but have not yet registered with the filter engine are treated as "Block" filters.</span></span> <span data-ttu-id="66e90-151">Die Reihenfolge, in der **FwpmCalloutAdd0** und fwpscallumgisteraufgerufen werden, spielt keine Rolle.</span><span class="sxs-lookup"><span data-stu-id="66e90-151">The order of calling **FwpmCalloutAdd0** and FwpsCalloutRegister does not matter.</span></span> <span data-ttu-id="66e90-152">Eine permanente Legende muss nur einmal hinzugefügt werden und muss jedes Mal registriert werden, wenn der Treiber, der die Legende implementiert, gestartet wird (z. b. nach einem Neustart).</span><span class="sxs-lookup"><span data-stu-id="66e90-152">A persistent callout needs to be added just once and needs to be registered every time the driver that implements the callout starts (for example, after a reboot).</span></span>

## <a name="classification"></a><span data-ttu-id="66e90-153">Klassifizierung</span><span class="sxs-lookup"><span data-stu-id="66e90-153">Classification</span></span>

<span data-ttu-id="66e90-154">Klassifizierung ist der Prozess, bei dem Filter auf den Netzwerk Datenverkehr (Paket, Stream oder Ereignis) angewendet werden, um das Ergebnis "zulassen" oder "blockieren" für diesen Datenverkehr zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="66e90-154">Classification is the process of applying filters to network traffic (packet, stream, or event) in order to determine a result of "Permit" or "Block" for that traffic.</span></span> <span data-ttu-id="66e90-155">Bei einem Paket, einem Stream oder einem Ereignis gibt es einen Klassifizierungs aufruppe pro Schicht.</span><span class="sxs-lookup"><span data-stu-id="66e90-155">For one packet, stream, or event there is one classification call per layer.</span></span>

<span data-ttu-id="66e90-156">Während der Klassifizierung werden die Eigenschaften (z. b. Quelladresse) des Pakets, Streams oder Ereignisses mit Filterbedingungen verglichen, die für Filter auf der Ebene festgelegt sind, auf der die Klassifizierung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="66e90-156">During classification, the properties (for example, source address) of the packet, stream, or event are compared with filter conditions set on filters at the layer where the classification is invoked.</span></span> <span data-ttu-id="66e90-157">Wenn Übereinstimmungen gefunden werden, wird der [Filter-Schiedsgerichts](filter-arbitration.md) ungsalgorithmus verwendet, um das Ergebnis des Klassifizierungs Vorgangs zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="66e90-157">When matches are found, the [Filter Arbitration](filter-arbitration.md) algorithm is used to determines the result of the classification process.</span></span>

<span data-ttu-id="66e90-158">Eine Klassifizierungs Anforderung wird von einem Shim ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="66e90-158">A classification request is triggered by a shim.</span></span>

<span data-ttu-id="66e90-159">Klassifizierungs Aktionen können wie folgt lauten:</span><span class="sxs-lookup"><span data-stu-id="66e90-159">Classification actions could be either:</span></span>

-   <span data-ttu-id="66e90-160">Zulassen</span><span class="sxs-lookup"><span data-stu-id="66e90-160">Permit</span></span>
-   <span data-ttu-id="66e90-161">Blockieren</span><span class="sxs-lookup"><span data-stu-id="66e90-161">Block</span></span>
-   <span data-ttu-id="66e90-162">Legende</span><span class="sxs-lookup"><span data-stu-id="66e90-162">Callout</span></span>
    -   <span data-ttu-id="66e90-163">Zulassen</span><span class="sxs-lookup"><span data-stu-id="66e90-163">Permit</span></span>
    -   <span data-ttu-id="66e90-164">Blockieren</span><span class="sxs-lookup"><span data-stu-id="66e90-164">Block</span></span>
    -   <span data-ttu-id="66e90-165">Weiter</span><span class="sxs-lookup"><span data-stu-id="66e90-165">Continue</span></span>
    -   <span data-ttu-id="66e90-166">Wickeln</span><span class="sxs-lookup"><span data-stu-id="66e90-166">Defer</span></span>
    -   <span data-ttu-id="66e90-167">Weitere Daten benötigen</span><span class="sxs-lookup"><span data-stu-id="66e90-167">Need more data</span></span>
    -   <span data-ttu-id="66e90-168">Verbindung löschen</span><span class="sxs-lookup"><span data-stu-id="66e90-168">Drop connection</span></span>

## <a name="wfp-operation"></a><span data-ttu-id="66e90-169">WFP-Vorgang</span><span class="sxs-lookup"><span data-stu-id="66e90-169">WFP Operation</span></span>

<span data-ttu-id="66e90-170">Sobald der TCP/IP-stapeltreiber (tcpip.sys) gestartet wird, erzwingt die kernelmodusfilter-Engine die Sicherheitsrichtlinie des Systems über Start Zeitfilter, sobald der TCP/IP-stapeltreiber () gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="66e90-170">At boot-time, as soon as the TCP/IP stack driver (tcpip.sys) starts, the kernel-mode filter engine enforces the security policy of the system through boot-time filters.</span></span>

<span data-ttu-id="66e90-171">Nachdem die Basis Filter-Engine (BFE) im Benutzermodus gestartet wurde, werden der Plattform persistente Filter hinzugefügt, die Start Zeitfilter sind deaktiviert, und Benachrichtigungen werden an die Legenden Treiber gesendet, die mithilfe von [FwpmBfeStateSubscribeChanges0](/windows-hardware/drivers/ddi/fwpmk/nf-fwpmk-fwpmbfestatesubscribechanges0)abonniert wurden.</span><span class="sxs-lookup"><span data-stu-id="66e90-171">Once the Base Filtering Engine (BFE) starts in user mode, persistent filters are added to the platform, boot-time filters are disabled, and notifications are sent to those callout drivers that subscribed using [FwpmBfeStateSubscribeChanges0](/windows-hardware/drivers/ddi/fwpmk/nf-fwpmk-fwpmbfestatesubscribechanges0).</span></span> <span data-ttu-id="66e90-172">Die Benachrichtigungen werden unmittelbar nach Abschluss der Initialisierung von BFE versendet.</span><span class="sxs-lookup"><span data-stu-id="66e90-172">The notifications are dispatched immediately after the BFE initialization is completed.</span></span> <span data-ttu-id="66e90-173">Die Plattform ist nun bereit für die Registrierung und das Hinzufügen von Lauf Zeit Objekten.</span><span class="sxs-lookup"><span data-stu-id="66e90-173">The platform is now ready for callouts to be registered and for run-time objects to be added.</span></span>

<span data-ttu-id="66e90-174">Die Umstellung von der Start Zeit auf persistente Filter kann auf einem langsamen Computer mehrere Sekunden oder sogar länger dauern.</span><span class="sxs-lookup"><span data-stu-id="66e90-174">The transition from boot-time to persistent filters could be several seconds, or even longer on a slow machine.</span></span> <span data-ttu-id="66e90-175">Er ist atomarisch. Wenn ein Anbieter also sowohl über einen Startzeit als auch über einen persistenten Filter verfügt, wird nie ein Fenster angezeigt, wenn keines der beiden Optionen wirksam ist.</span><span class="sxs-lookup"><span data-stu-id="66e90-175">It is atomic, so if a provider has both a boot-time and a persistent filter, there will never be a window when neither is in effect.</span></span>

<span data-ttu-id="66e90-176">Nach dem Start von BFE können Lauf Zeitfilter durch Firewall-Agents oder durch benutzerdefinierte Firewalllösungen hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="66e90-176">After BFE starts, run-time filters can be added by firewall agents, or by custom firewall solutions.</span></span> <span data-ttu-id="66e90-177">BFE verarbeitet diese Filter und sendet Sie zur Erzwingung an die entsprechende Filter-Engine-Schicht.</span><span class="sxs-lookup"><span data-stu-id="66e90-177">BFE processes these filters and sends them to the appropriate filter engine layer for enforcement.</span></span> <span data-ttu-id="66e90-178">BFE akzeptiert auch Authentifizierungs Einstellungen und sendet diese Einstellungen an die IPSec-Schlüssel für die Schlüssel Erstellung (IKE/AuthIP).</span><span class="sxs-lookup"><span data-stu-id="66e90-178">BFE also accepts authentication settings and sends these settings to the IPsec keying modules (IKE/AuthIP).</span></span> <span data-ttu-id="66e90-179">Weitere Informationen finden Sie unter [IPSec-Konfiguration](ipsec-configuration.md) .</span><span class="sxs-lookup"><span data-stu-id="66e90-179">See [IPsec Configuration](ipsec-configuration.md) for more information.</span></span>

<span data-ttu-id="66e90-180">Filter und Authentifizierungs Einstellungen können jederzeit über die RPC-Schnittstelle, die von den BFE verfügbar gemacht wird, im System hinzugefügt, entfernt oder geändert werden.</span><span class="sxs-lookup"><span data-stu-id="66e90-180">At any time, filters and authentication settings can be added, removed or changed in the system through the RPC interface exposed by the BFE.</span></span> <span data-ttu-id="66e90-181">Unterebenen und Legenden Module können ebenfalls hinzugefügt oder entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="66e90-181">Sub-layers and callout modules can likewise be added or removed.</span></span>

<span data-ttu-id="66e90-182">Datenfluss:</span><span class="sxs-lookup"><span data-stu-id="66e90-182">Data flow:</span></span>

1.  <span data-ttu-id="66e90-183">Ein Paket wird in den Netzwerk Stapel integriert.</span><span class="sxs-lookup"><span data-stu-id="66e90-183">A packet comes into the network stack.</span></span>
2.  <span data-ttu-id="66e90-184">Der Netzwerk Stapel findet und Ruft einen Shim auf.</span><span class="sxs-lookup"><span data-stu-id="66e90-184">The network stack finds and calls a shim.</span></span>
3.  <span data-ttu-id="66e90-185">Der Shim ruft den Klassifizierungsprozess auf einer bestimmten Ebene auf.</span><span class="sxs-lookup"><span data-stu-id="66e90-185">The shim invokes the classification process at a particular layer.</span></span>
4.  <span data-ttu-id="66e90-186">Während der Klassifizierung werden Filter abgeglichen, und die resultierende Aktion wird durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="66e90-186">During classification, filters are matched and the resultant action is taken.</span></span> <span data-ttu-id="66e90-187">(Siehe [Filter-Schiedsgerichtsbarkeit](filter-arbitration.md).)</span><span class="sxs-lookup"><span data-stu-id="66e90-187">(See [Filter Arbitration](filter-arbitration.md).)</span></span>
5.  <span data-ttu-id="66e90-188">Wenn beim Klassifizierungsprozess alle Legenden Filter abgeglichen werden, werden die entsprechenden Legenden aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="66e90-188">If any callout filters are matched during the classification process, the corresponding callouts are invoked.</span></span>
6.  <span data-ttu-id="66e90-189">Der Shim agiert bei der abschließenden Filter Entscheidung (z. b. beim Ablegen des Pakets).</span><span class="sxs-lookup"><span data-stu-id="66e90-189">The shim acts on the final filtering decision (for example, drop the packet).</span></span>

<span data-ttu-id="66e90-190">Der ausgehende Datenfluss folgt einem ähnlichen Muster.</span><span class="sxs-lookup"><span data-stu-id="66e90-190">Outbound data flow follows a similar pattern.</span></span>

<span data-ttu-id="66e90-191">In den folgenden Themen wird der WFP-Vorgang ausführlicher beschrieben.</span><span class="sxs-lookup"><span data-stu-id="66e90-191">The following topics further describe the operation of the WFP.</span></span>

-   [<span data-ttu-id="66e90-192">TCP-paketflows</span><span class="sxs-lookup"><span data-stu-id="66e90-192">TCP Packet Flows</span></span>](tcp-packet-flows.md)
-   [<span data-ttu-id="66e90-193">UDP-paketflows</span><span class="sxs-lookup"><span data-stu-id="66e90-193">UDP Packet Flows</span></span>](udp-packet-flows.md)
-   [<span data-ttu-id="66e90-194">Filterung Filtern</span><span class="sxs-lookup"><span data-stu-id="66e90-194">Filter Arbitration</span></span>](filter-arbitration.md)

## <a name="related-topics"></a><span data-ttu-id="66e90-195">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="66e90-195">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="66e90-196">Objektmodell</span><span class="sxs-lookup"><span data-stu-id="66e90-196">Object Model</span></span>](object-model.md)
</dt> <dt>

[<span data-ttu-id="66e90-197">Objekt Verwaltung</span><span class="sxs-lookup"><span data-stu-id="66e90-197">Object Management</span></span>](object-management.md)
</dt> </dl>

 

 