---
description: In Windows 7 bietet die Windows-Multimedia-Systemsteuerung Mmsys.cpl eine neue Registerkarte für die Kommunikation.
ms.assetid: bec2127d-fb82-436d-beee-d43e8fef5c35
title: Verwenden eines kommunikationsgeräts
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93f677245e650cf11c71c879b2c26d3183ff4a0b
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103861291"
---
# <a name="using-a-communication-device"></a><span data-ttu-id="1e2ba-103">Verwenden eines kommunikationsgeräts</span><span class="sxs-lookup"><span data-stu-id="1e2ba-103">Using a Communication Device</span></span>

<span data-ttu-id="1e2ba-104">In Windows 7 bietet die Windows-Multimedia-Systemsteuerung Mmsys.cpl eine neue Registerkarte für die **Kommunikation** . Diese Registerkarte enthält Optionen, mit denen Benutzeroptionen festlegen können, die definieren, wie das System ein *Kommunikationsgerät* verwaltet.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-104">In Windows 7, the Windows multimedia control panel, Mmsys.cpl, provides a new **Communications** tab. This tab contains options that enables a user to set options that defines how the system manages a *communication device*.</span></span> <span data-ttu-id="1e2ba-105">Ein Kommunikationsgerät wird hauptsächlich zum platzieren oder empfangen von Telefon anrufen auf dem Computer verwendet.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-105">A communication device is used primarily for placing or receiving telephone calls on the computer.</span></span> <span data-ttu-id="1e2ba-106">Bei einem Computer, der nur über ein renderinggerät (Sprecher) und ein Erfassungsgerät (Mikrofon) verfügt, fungieren diese Audiogeräte auch als Standard Kommunikationsgeräte.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-106">For a computer that has only one rendering device (speaker) and one capture device (microphone), these audio devices also act as the default communication devices.</span></span> <span data-ttu-id="1e2ba-107">Wenn ein Benutzer ein neues Gerät (z. b. ein USB-Headset) verbindet, führt das System eine automatische Geräte Rollen Erkennung durch, indem er die vom OEM aufgefüllten Konfigurationseinstellungen prüft.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-107">When a user connects a new device, such as a USB headset, the system performs automatic device role detection by looking up the configuration settings that are populated by the OEM.</span></span> <span data-ttu-id="1e2ba-108">Wenn das System festlegt, dass ein Gerät für die Kommunikation am besten geeignet ist, weist das System dem Gerät die **eCommunications** -Rolle zu.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-108">If the system determines a device to be best suited for communication purposes, the system assigns the **eCommunications** role to the device.</span></span> <span data-ttu-id="1e2ba-109">Für diese Geräte bietet das Windows 7-Mmsys.cpl die Option **Standard Kommunikationsgerät** , mit dem Benutzer ein Kommunikationsgerät für audiorendering (**Wiedergabe** Registerkarte) und Audioerfassung **(Register** Karte) auswählen können.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-109">For these devices, the Windows 7 Mmsys.cpl provides the option **Default Communication Device** that enables a user to select a communication device each for audio rendering (**Playback** tab) and audio capturing (**Recording** tab).</span></span> <span data-ttu-id="1e2ba-110">Das System führt die automatische Rollen Erkennung aus, legt jedoch kein bestimmtes Gerät für die Kommunikation fest.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-110">The system performs automatic role detection but does not set a particular device to be used for communications.</span></span> <span data-ttu-id="1e2ba-111">Dies muss vom Benutzer vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-111">This must be done by the user.</span></span> <span data-ttu-id="1e2ba-112">Mit der neuen **eCommunications** -Rolle kann eine Anwendung zwischen einem Gerät, das vom Benutzer für die Verarbeitung von Telefon anrufen ausgewählt wird, und einem Gerät unterscheiden, das als multimediategerät (Musikwiedergabe) verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-112">The new **eCommunications** role lets an application distinguish between a device that is chosen by the user for handling phone calls and a device to be used as a multimedia device (music playback).</span></span> <span data-ttu-id="1e2ba-113">Wenn der Benutzer z. b. über ein Headset und einen Redner verfügt, der mit dem Computer verbunden ist, weist das System die Rolle " **econsole** " dem Redner und der **eCommunications** -Rolle dem Headset zu.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-113">For example, if the user has a headset and a speaker connected to the computer, the system assigns the **eConsole** role to the speaker and the **eCommunications** role to the headset.</span></span> <span data-ttu-id="1e2ba-114">Nachdem der Benutzer das als Kommunikationsgerät zu verwendende Headset ausgewählt hat, können Sie zum Entwickeln einer Kommunikationsanwendung speziell auf das Headset abzielen, um einen Audiostream zu rendern.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-114">After the user selects the headset to be used as the communication device, to develop a communication application, you can target the headset specifically for rendering an audio stream.</span></span> <span data-ttu-id="1e2ba-115">Eine Anwendung, mit der der Benutzer die vom System zugewiesene Geräte Rolle nicht ändern kann.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-115">An application the user cannot change the device role assigned by the system.</span></span> <span data-ttu-id="1e2ba-116">Weitere Informationen zu Geräte Rollen finden Sie unter [Geräte Rollen](device-roles.md).</span><span class="sxs-lookup"><span data-stu-id="1e2ba-116">For more information about device roles, see [Device Roles](device-roles.md).</span></span>

<span data-ttu-id="1e2ba-117">Kommunikationsanwendungen, wie z. b. VoIP-und Unified Communication-Anwendungen, platzieren und empfangen Telefonanrufe über einen Computer.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-117">Communication applications, such as VoIP and Unified Communication applications, place and receive phone calls through a computer.</span></span> <span data-ttu-id="1e2ba-118">Beispielsweise kann eine VoIP-Anwendung einen Stream, der die Benachrichtigung über den Ring enthält, an den Endpunkt eines kommunikationsgeräts zuweisen, das zum Rendern von Audiodatenströmen festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-118">For example, a VoIP application might assign a stream that contains the ring-in notification to the endpoint of a communication device set for rendering audio streams.</span></span> <span data-ttu-id="1e2ba-119">Außerdem öffnet die Anwendung möglicherweise die Spracheingabe-und-Ausgabedaten Ströme auf den Geräten zum Erfassen und Rendern von Endpunkten, die als Kommunikationsgeräte festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-119">In addition, the application might open the voice input and output streams on the capture and rendering endpoint devices that are set as communication devices.</span></span>

<span data-ttu-id="1e2ba-120">Wenn Sie Kommunikationsfunktionen in Ihre Anwendungen integrieren möchten, können Sie Folgendes verwenden:</span><span class="sxs-lookup"><span data-stu-id="1e2ba-120">To integrate communication capabilities into your applications, you can use:</span></span>

-   <span data-ttu-id="1e2ba-121">[Mmdevice-API](mmdevice-api.md)–, um einen Verweis auf den Endpunkt des kommunikationsgeräts zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-121">[MMDevice API](mmdevice-api.md)—to get a reference to the endpoint of the communication device.</span></span>
-   <span data-ttu-id="1e2ba-122">[WASAPI](wasapi.md)– zum Rendering und Erfassen von Audiodatenströmen über das Kommunikationsgerät.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-122">[WASAPI](wasapi.md)—to render and capture audio streams through the communication device.</span></span> <span data-ttu-id="1e2ba-123">Das Betriebssystem betrachtet den in einem Kommunikationsgerät geöffneten Stream als einen *Kommunikationsstream*.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-123">The operating system considers the stream opened on a communication device to be a *communication stream*.</span></span>

<span data-ttu-id="1e2ba-124">Die Kommunikationsanwendung listet Geräte auf und stellt die streamverwaltung für einen Kommunikationsstream (Rendering-oder Aufzeichnungsdaten Strom) auf die gleiche Weise bereit wie einen nicht-Kommunikationsstream mithilfe der Kerndatei-APIs.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-124">The communication application enumerates devices and provides stream management for a communication stream (rendering or capture) stream in the same manner as it would manage a non-communication stream by using the Core Audio APIs.</span></span>

<span data-ttu-id="1e2ba-125">Eine der Features, die Sie in Ihre Kommunikationsanwendung integrieren können, ist das *ducken* oder die Daten *Strom Dämpfung*.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-125">One of the features that you can integrate in your communication application is *ducking* or *stream attenuation*.</span></span> <span data-ttu-id="1e2ba-126">Dieses Verhalten definiert, was mit anderen Sounds geschehen muss, wenn ein Kommunikationsstream geöffnet wird, z. b. Wenn ein Telefonanruf auf dem Kommunikationsgerät empfangen wird.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-126">This behavior defines what must happen to other sounds when a communication stream is opened, such as when a phone call is received on the communication device.</span></span> <span data-ttu-id="1e2ba-127">Abhängig von der Auswahl des Benutzers kann das System das audiovolume des nicht-Kommunikationsstreams entweder stumm oder niedriger sein.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-127">The system might mute or lower the audio volume of the non-communication stream depending on the user's choice.</span></span> <span data-ttu-id="1e2ba-128">Das Audiosystem generiert Ducking-Ereignisse, wenn ein Kommunikationsstream zum Rendern oder Erfassen von Streams geöffnet oder geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-128">The audio system generates ducking events when a communication stream is opened or closed for rendering or capturing streams.</span></span> <span data-ttu-id="1e2ba-129">Standardmäßig bietet das Betriebssystem ein Standardmäßiges Ducking.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-129">By default, the operating system provides a default ducking experience.</span></span> <span data-ttu-id="1e2ba-130">Eine Medien Anwendung kann das Standardverhalten ersetzen und diese Ereignisse selbst behandeln, um eine angepasste Ducking-Darstellung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-130">A media application can replace the default behavior and handle these events itself to provide a customized ducking experience.</span></span>

<span data-ttu-id="1e2ba-131">In den folgenden Abschnitten wird beschrieben, wie Sie mit den Kerncode-APIs eine benutzerdefinierte Ducking-Funktion bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-131">The following sections describe how to use Core Audio APIs to provide a custom ducking experience.</span></span>

-   [<span data-ttu-id="1e2ba-132">Standardmäßiges ducken</span><span class="sxs-lookup"><span data-stu-id="1e2ba-132">Default Ducking Experience</span></span>](stream-attenuation.md)
-   [<span data-ttu-id="1e2ba-133">Deaktivieren der Standardeinstellung für das ducken</span><span class="sxs-lookup"><span data-stu-id="1e2ba-133">Disabling the Default Ducking Experience</span></span>](disabling-the-ducking-experience.md)
-   [<span data-ttu-id="1e2ba-134">Bereitstellen eines benutzerdefinierten Ducking-Verhaltens</span><span class="sxs-lookup"><span data-stu-id="1e2ba-134">Providing a Custom Ducking Behavior</span></span>](providing-a-custom-ducking-experience.md)
-   [<span data-ttu-id="1e2ba-135">Implementierungs Überlegungen für Ducking-Benachrichtigungen</span><span class="sxs-lookup"><span data-stu-id="1e2ba-135">Implementation Considerations for Ducking Notifications</span></span>](handling-audio-ducking-events-from-communication-devices.md)
-   [<span data-ttu-id="1e2ba-136">Erhalten von Ducking-Ereignissen</span><span class="sxs-lookup"><span data-stu-id="1e2ba-136">Getting Ducking Events</span></span>](getting-ducking-events-from-a-communication-device.md)

### <a name="getting-a-reference-to-the-communication-device-endpoint"></a><span data-ttu-id="1e2ba-137">Beziehen eines Verweises auf den Kommunikationsgeräte Endpunkt</span><span class="sxs-lookup"><span data-stu-id="1e2ba-137">Getting a Reference to the Communication Device Endpoint</span></span>

<span data-ttu-id="1e2ba-138">Um das Kommunikationsgerät verwenden zu können, muss ein direkter WASAPI-Client die Geräte mit dem Geräte Enumerator auflisten.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-138">To use the communication device, a direct WASAPI client must enumerate the devices by using the device enumerator.</span></span> <span data-ttu-id="1e2ba-139">Rufen Sie einen Verweis auf den Endpunkt des Standard kommunikationsgeräts ab, indem Sie [**immdeviceenumerator:: getdefaultaudioendpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-139">Get a reference to the endpoint of the default communication device by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="1e2ba-140">In diesem-Befehl muss die Anwendung **eCommunications** im *Role* -Parameter angeben, um die Geräte Enumeration auf Kommunikationsgeräte zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-140">In this call, the application must specify **eCommunications** in the *Role* parameter to restrict the device enumeration to communication devices.</span></span> <span data-ttu-id="1e2ba-141">Nachdem Sie einen Verweis auf den Geräte Endpunkt für das Gerät erhalten haben, können Sie die Dienste, für die der Endpunkt festgelegt ist, durch Aufrufen von " [**immdevice:: Aktivierungs**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate)" aktivieren.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-141">After you get a reference to the device endpoint for the device, you can activate the services that are scoped for the endpoint by calling [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate).</span></span> <span data-ttu-id="1e2ba-142">Beispielsweise können Sie die **IID \_ iaudioclient** -Dienst-ID übergeben, um ein audioclientobjekt zu aktivieren und für die streamverwaltung zu verwenden, den **IID \_ iaudioendpointvolume** -Bezeichner, um Zugriff auf die volumesteuerelemente des Kommunikationsgeräte Endpunkts zu erhalten, oder den **IID \_ iaudiosessionmanager** -Bezeichner, um den Sitzungs-Manager zu aktivieren</span><span class="sxs-lookup"><span data-stu-id="1e2ba-142">For example, you can pass the **IID\_IAudioClient** service identifier to activate an audio client object and use it for stream management, the **IID\_IAudioEndpointVolume** identifier to get access to the volume controls of the communication device endpoint, or the **IID\_IAudioSessionManager** identifier to activate the session manager that enables you to interact with the policy engine of the endpoint.</span></span> <span data-ttu-id="1e2ba-143">Informationen zu Streamvorgängen finden Sie unter [Stream Management](stream-management.md).</span><span class="sxs-lookup"><span data-stu-id="1e2ba-143">For information about stream operations, see [Stream Management](stream-management.md).</span></span>

<span data-ttu-id="1e2ba-144">Mithilfe der [**immdevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) -Referenz können Sie auch auf den Eigenschaften Speicher für den Geräte Endpunkt zugreifen.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-144">By using the [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) reference, you can also access the property store for the device endpoint.</span></span> <span data-ttu-id="1e2ba-145">Diese Eigenschaftswerte (z. b. Anzeige Name und Herstellername) werden vom OEM aufgefüllt und ermöglichen es einer Anwendung, die Merkmale eines kommunikationsgeräts zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-145">These property values, such as device friendly name and manufacturer name, are populated by the OEM and enable an application to determine the characteristics of a communication device.</span></span> <span data-ttu-id="1e2ba-146">Weitere Informationen finden Sie unter [Geräteeigenschaften](device-properties.md).</span><span class="sxs-lookup"><span data-stu-id="1e2ba-146">For more information, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="1e2ba-147">Der folgende Beispielcode ruft einen Verweis auf den Endpunkt des Standard kommunikationsgeräts zum Rendern eines Audiostreams ab.</span><span class="sxs-lookup"><span data-stu-id="1e2ba-147">The following example code gets a reference to the endpoint of the default communication device for rendering an audio stream.</span></span>


```C++
IMMDevice *defaultDevice = NULL;

hr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL,
            CLSCTX_INPROC_SERVER, 
            __uuidof(IMMDeviceEnumerator), 
            (LPVOID *)&deviceEnumerator);

hr = deviceEnumerator->GetDefaultAudioEndpoint(eRender, 
            eCommunications, &defaultDevice);
```



## <a name="related-topics"></a><span data-ttu-id="1e2ba-148">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1e2ba-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1e2ba-149">Datenstrom Verwaltung</span><span class="sxs-lookup"><span data-stu-id="1e2ba-149">Stream Management</span></span>](stream-management.md)
</dt> </dl>

 

 



