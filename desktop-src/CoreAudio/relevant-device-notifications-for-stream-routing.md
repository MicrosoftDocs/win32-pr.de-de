---
description: In Windows 7 implementieren allgemeine Plattform-APIs, die kernaudio-APIs verwenden, wie Media Foundation-, DirectSound-und Wave-APIs, das Streaming-Routing Feature, indem Sie den Datenstrom Wechsel von einem vorhandenen Gerät zu einem neuen standardaudioendpunkt verarbeiten.
ms.assetid: caf831bb-b8de-467f-bdb4-f9f8991dc7a8
title: Relevante Benachrichtigungen für das Datenstrom Routing
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ef3d253ce2ec5d6e3bef025a33233a9d377ca44b
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104126893"
---
# <a name="relevant-notifications-for-stream-routing"></a><span data-ttu-id="da4b5-103">Relevante Benachrichtigungen für das Datenstrom Routing</span><span class="sxs-lookup"><span data-stu-id="da4b5-103">Relevant Notifications for Stream Routing</span></span>

<span data-ttu-id="da4b5-104">In Windows 7 implementieren allgemeine Plattform-APIs, die kernaudio-APIs verwenden, wie Media Foundation-, DirectSound-und Wave-APIs, das Streaming-Routing Feature, indem Sie den Datenstrom Wechsel von einem vorhandenen Gerät zu einem neuen standardaudioendpunkt verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="da4b5-104">In Windows 7, high-level platform APIs that use Core Audio APIs, such as Media Foundation, DirectSound, and Wave APIs, implement the stream routing feature by handling stream switching from an existing device to a new default audio endpoint.</span></span> <span data-ttu-id="da4b5-105">Medienanwendungen, die diese APIs verwenden, verwenden das Datenstrom-Routing Verhalten ohne Änderungen an der Quelle.</span><span class="sxs-lookup"><span data-stu-id="da4b5-105">Media applications that use these APIs use the stream routing behavior without any modifications to the source.</span></span> <span data-ttu-id="da4b5-106">Direkte WASAPI-Clients können die Benachrichtigungen verwenden, die von den kernaudiokomponenten gesendet werden, und die streamweiterleitungs Funktion implementieren.</span><span class="sxs-lookup"><span data-stu-id="da4b5-106">Direct WASAPI clients can use the notifications sent by Core Audio components and implement the stream routing feature.</span></span>

<span data-ttu-id="da4b5-107">Zum Implementieren der streamweiterleitungs-Funktion muss ein Client auf zwei Arten von Ereignissen lauschen: Geräte Änderungs Benachrichtigungen und Sitzungs Trennungs Benachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="da4b5-107">To implement the stream routing feature, a client must listen for two types of events: device change notifications and session disconnect notifications.</span></span> <span data-ttu-id="da4b5-108">In der Implementierung der APIs auf hoher Ebene werden diese Ereignisse für Standardgeräte Endpunkte gesendet, die durch den Aufruf von [**immdeviceenumerator:: getdefaultaudioendpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint)erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="da4b5-108">In the implementation provided by the high-level APIs, these events are sent for default device endpoints created by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="da4b5-109">Weitere Informationen finden Sie unter [Getting the Device Endpoint for Stream Routing](getting-the-default-device-endpoint-for-stream-routing.md).</span><span class="sxs-lookup"><span data-stu-id="da4b5-109">For more information, see [Getting the Device Endpoint for Stream Routing](getting-the-default-device-endpoint-for-stream-routing.md).</span></span>

<span data-ttu-id="da4b5-110">Die mmdeviceapi der kernaudiokomponente übermittelt Benachrichtigungs Rückrufe, wenn Audiogeräte hinzugefügt, entfernt oder geändert werden.</span><span class="sxs-lookup"><span data-stu-id="da4b5-110">The Core Audio component MMDeviceAPI delivers notification callbacks when audio devices are added, removed, or modified.</span></span> <span data-ttu-id="da4b5-111">Die Änderungen an der Format-und Audiositzung werden über WASAPI als Ereignisse gemeldet.</span><span class="sxs-lookup"><span data-stu-id="da4b5-111">The format and audio session changes are reported as events through WASAPI.</span></span>

## <a name="device-change-notifications"></a><span data-ttu-id="da4b5-112">Geräte Änderungs Benachrichtigungen</span><span class="sxs-lookup"><span data-stu-id="da4b5-112">Device Change Notifications</span></span>

<span data-ttu-id="da4b5-113">Mmdeviceapi löst Ereignisse aus, wenn Audiogeräte hinzugefügt, entfernt oder geändert werden.</span><span class="sxs-lookup"><span data-stu-id="da4b5-113">MMDeviceAPI raises events when audio devices are added, removed, or modified.</span></span> <span data-ttu-id="da4b5-114">Wenn der Client Stream-Routing Funktionen bereitstellen soll, muss er die [**immnotificationclient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) -Schnittstelle implementieren und seine Implementierung bei mmdeviceapi registrieren.</span><span class="sxs-lookup"><span data-stu-id="da4b5-114">If the client is to provide stream routing functionality, it must implement the [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) interface and register its implementation with MMDeviceAPI.</span></span>

<span data-ttu-id="da4b5-115">Um Benachrichtigungen über Geräteänderungen zu erhalten, muss der Client die folgenden Aufgaben ausführen:</span><span class="sxs-lookup"><span data-stu-id="da4b5-115">To get device change notifications, the client must perform the following tasks:</span></span>

-   <span data-ttu-id="da4b5-116">Implementieren Sie die [**immnotificationclient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) -Schnittstelle zum Verarbeiten von Benachrichtigungen über Geräteänderungen, die von mmdeviceapi gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="da4b5-116">Implement the [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) interface to handle device change notifications sent by MMDeviceAPI.</span></span>
-   <span data-ttu-id="da4b5-117">Registrieren Sie die [**immnotificationclient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) -Implementierung mit mmdeviceapi, indem Sie die [**immdeviceenumerator:: registerendpointnotificationcallback**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-registerendpointnotificationcallback) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="da4b5-117">Register the [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) implementation with MMDeviceAPI by calling the [**IMMDeviceEnumerator::RegisterEndpointNotificationCallback**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-registerendpointnotificationcallback) method.</span></span>

<span data-ttu-id="da4b5-118">Nachdem die Implementierung dieser Schnittstellen durch den Client registriert wurde, empfängt der Client Benachrichtigungen in Form von Rückrufe über die Methoden dieser Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="da4b5-118">After the client's implementation of these interfaces is registered, the client receives notifications in the form of callbacks through the methods of these interfaces.</span></span> <span data-ttu-id="da4b5-119">[**Immnotificationclient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) -Methoden werden von mmdeviceapi aufgerufen, wenn Sie Ereignisse auf Endpunkt Ebene auslöst (Änderungen am Endpunkt Zustand, neue Endpunkt-Ankünfte, Endpunkt Löschungen, standardend Punkt Änderungen und Änderungen an Endpunkt Eigenschaften).</span><span class="sxs-lookup"><span data-stu-id="da4b5-119">[**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) methods are called by MMDeviceAPI when it raises endpoint-level events (endpoint state changes, new endpoint arrivals, endpoint deletions, default endpoint changes, and endpoint property changes).</span></span>

<span data-ttu-id="da4b5-120">Wenn der Client Datenstrom Routing für das Standardgerät bereitstellen möchte, muss der Client das Verhalten der Geräte Änderung implementieren, wenn er die Benachrichtigung über den " [**immnotificationclient:: ondefaultdevicechanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) "-Rückruf empfängt.</span><span class="sxs-lookup"><span data-stu-id="da4b5-120">If the client wants to provide stream routing for the default device, the client must implement the device change behavior when it receives the notification through the [**IMMNotificationClient::OnDefaultDeviceChanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) callback.</span></span>

## <a name="audio-session-change-notifications"></a><span data-ttu-id="da4b5-121">Benachrichtigungen zu Änderungen an audiositzungen</span><span class="sxs-lookup"><span data-stu-id="da4b5-121">Audio Session Change Notifications</span></span>

<span data-ttu-id="da4b5-122">Änderungen an der Audiositzung und Formatänderungen werden als audiositzungsereignisse über WASAPI gemeldet.</span><span class="sxs-lookup"><span data-stu-id="da4b5-122">Audio session changes and format changes are reported as audio session events through WASAPI.</span></span> <span data-ttu-id="da4b5-123">Ein WASAPI-Client implementiert die [**iaudiosessionevents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) -Schnittstelle und registriert die Implementierung bei WASAPI.</span><span class="sxs-lookup"><span data-stu-id="da4b5-123">A WASAPI client implements the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interface and registers the implementation with WASAPI.</span></span>

<span data-ttu-id="da4b5-124">Der Client muss die folgenden Aufgaben ausführen, um Benachrichtigungen über Änderungen der Audiositzung zu erhalten:</span><span class="sxs-lookup"><span data-stu-id="da4b5-124">To get audio session change notifications, the client must perform the following tasks:</span></span>

-   <span data-ttu-id="da4b5-125">Implementieren Sie die [**iaudiosessionevents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) -Schnittstelle zum Verarbeiten von Format Änderungs Benachrichtigungen, die von WASAPI gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="da4b5-125">Implement the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interface to handle format change notifications sent by WASAPI.</span></span>
-   <span data-ttu-id="da4b5-126">Registrieren Sie die [**iaudiosessionevents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) -Implementierung mit WASAPI, indem Sie die [**iaudiosessioncontrol:: registeraudiosessionnotification**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessioncontrol-registeraudiosessionnotification) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="da4b5-126">Register the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) implementation with WASAPI by calling the [**IAudioSessionControl::RegisterAudioSessionNotification**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessioncontrol-registeraudiosessionnotification) method.</span></span>

<span data-ttu-id="da4b5-127">[**Iaudiosessionevents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) -Methoden werden von WASAPI aufgerufen, wenn Änderungen an der Audiositzung auftreten.</span><span class="sxs-lookup"><span data-stu-id="da4b5-127">[**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) methods are called by WASAPI when audio session changes occur.</span></span> <span data-ttu-id="da4b5-128">Diese Ereignisse werden ausgelöst, wenn sich der Anzeige Name, der Symbol Pfad, das Volume, der Gruppierungs Parameter oder der Status der Sitzung ändert.</span><span class="sxs-lookup"><span data-stu-id="da4b5-128">These events are raised when the session's display name, icon path, volume, grouping parameter, or state changes.</span></span>

<span data-ttu-id="da4b5-129">Zum Implementieren der streamweiterleitungs-Funktion muss der Client auf die Benachrichtigung Sitzungs getrennt warten.</span><span class="sxs-lookup"><span data-stu-id="da4b5-129">To implement the stream routing feature, the client must wait for the session-disconnect notification.</span></span> <span data-ttu-id="da4b5-130">Wenn eine Audiositzung getrennt oder das Format eines Geräts geändert wird, sendet WASAPI die Client Benachrichtigungen in Form von Rückrufen über [**iaudiosessionevents:: onsessiongetrennte**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected).</span><span class="sxs-lookup"><span data-stu-id="da4b5-130">When an audio session is disconnected or a device's format is changed, WASAPI sends the client notifications in the form of callbacks through [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected).</span></span> <span data-ttu-id="da4b5-131">Mit der disverbindungsbenachrichtigung sendet WASAPI außerdem einen Wert, der angibt, warum die Sitzung getrennt wurde.</span><span class="sxs-lookup"><span data-stu-id="da4b5-131">With the disconnection notification, WASAPI also sends a value that indicates why the session was disconnected.</span></span> <span data-ttu-id="da4b5-132">Dies kann verschiedene Ursachen haben, z. b. wenn das Gerät entfernt wurde, der Server angehalten wurde und so weiter.</span><span class="sxs-lookup"><span data-stu-id="da4b5-132">This can occur for several reasons, such as the device was removed, the server stopped, and so on.</span></span> <span data-ttu-id="da4b5-133">Eine umfassende Liste der Gründe finden Sie unter der in audiopolicy. h definierten Enumeration **audiosessiondisconnecverrat** .</span><span class="sxs-lookup"><span data-stu-id="da4b5-133">For the complete list of reasons, see the **AudioSessionDisconnectReason** enumeration defined in AudioPolicy.h.</span></span> <span data-ttu-id="da4b5-134">Wenn das Standardgerät geändert wird, muss der Client auf die Benachrichtigungen warten (sofern noch nicht geschehen), die mit einem **disconnecwerondeviceremoval** -Wert verknüpft sind.</span><span class="sxs-lookup"><span data-stu-id="da4b5-134">If the default device changes, the client must wait for the notifications (if they have not already been received) that are accompanied with a **DisconnectReasonDeviceRemoval** value.</span></span> <span data-ttu-id="da4b5-135">Als Reaktion auf solche Benachrichtigungen kann der Client den Datenstrom auf dem neuen Standardgerät erneut öffnen.</span><span class="sxs-lookup"><span data-stu-id="da4b5-135">In response to such notifications, the client might reopen the stream on the new default device.</span></span>

<span data-ttu-id="da4b5-136">Da alle diese Vorgänge asynchron sind, kann die Reihenfolge, in der die Anwendung Benachrichtigungen empfängt, nicht vorhergesagt werden.</span><span class="sxs-lookup"><span data-stu-id="da4b5-136">Because all of these operations are asychronous, the order in which the application receives notifications cannnot be predicted.</span></span> <span data-ttu-id="da4b5-137">In der Regel erhält die Anwendung jedoch den Wert **audiosessiondisconnect** vor der Standard Benachrichtigung für Geräteänderungen.</span><span class="sxs-lookup"><span data-stu-id="da4b5-137">However, typically, the application receives **AudioSessionDisconnect** value before the default device change notification.</span></span>

### <a name="format-change-notifications"></a><span data-ttu-id="da4b5-138">Formatieren von Änderungs Benachrichtigungen</span><span class="sxs-lookup"><span data-stu-id="da4b5-138">Format Change Notifications</span></span>

<span data-ttu-id="da4b5-139">Audioformatänderungen treten auf, wenn das Format des Streams geändert wird.</span><span class="sxs-lookup"><span data-stu-id="da4b5-139">Audio format changes occur when the format of the stream changes.</span></span> <span data-ttu-id="da4b5-140">Dies kann vorkommen, **Wenn der Benutzer in der System** Steuerung ein neues Format auswählt oder wenn das neue Standardgerät ein neues Format unterstützt (z. b. "HDMI" oder bestimmte professionelle Audioschnittstellen mit manueller Anpassung der Stichprobenrate).</span><span class="sxs-lookup"><span data-stu-id="da4b5-140">This can occur when the user selects a new format in the **Sound** control panel or the new default device supports a new format (for example, HDMI or certain professional audio interfaces with a manual sample-rate adjustment).</span></span> <span data-ttu-id="da4b5-141">Um den Client über diese Art von Formatänderungen zu benachrichtigen, sendet WASAPI eine Sitzungs Benachrichtigung durch die registrierte Implementierung von [**iaudiosessionevents:: onsessiondisconnect**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected) mit dem **Trennungsgrund von disconnecationonformatchanged**.</span><span class="sxs-lookup"><span data-stu-id="da4b5-141">To notify the client about these types of format changes, WASAPI sends a session notification by the registered implementation of [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected) with a disconnect reason of **DisconnectReasonFormatChanged**.</span></span> <span data-ttu-id="da4b5-142">Der Client kann die Benachrichtigung verarbeiten, indem er den Stream im neuen Format erneut öffnet.</span><span class="sxs-lookup"><span data-stu-id="da4b5-142">The client can handle the notification by reopening the stream in the new format.</span></span>

## <a name="related-topics"></a><span data-ttu-id="da4b5-143">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="da4b5-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="da4b5-144">Informationen über die mmdevice-API</span><span class="sxs-lookup"><span data-stu-id="da4b5-144">About MMDevice API</span></span>](mmdevice-api.md)
</dt> <dt>

[<span data-ttu-id="da4b5-145">Informationen zu WASAPI</span><span class="sxs-lookup"><span data-stu-id="da4b5-145">About WASAPI</span></span>](wasapi.md)
</dt> <dt>

[<span data-ttu-id="da4b5-146">Streamrouting</span><span class="sxs-lookup"><span data-stu-id="da4b5-146">Stream Routing</span></span>](stream-routing.md)
</dt> </dl>

 

 



