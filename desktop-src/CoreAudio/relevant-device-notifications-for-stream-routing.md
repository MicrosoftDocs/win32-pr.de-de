---
description: Erfahren Sie mehr über Benachrichtigungen für das Streamrouting. APIs implementieren Streamrouting, indem sie den Datenstromwechsel zu einem neuen Standardaudioendpunkt behandeln.
ms.assetid: caf831bb-b8de-467f-bdb4-f9f8991dc7a8
title: Relevante Benachrichtigungen für das Streamrouting
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d1a843c1d8b5cfd740ada5049cb9428e7745072d
ms.sourcegitcommit: 51ef825fb48f15e1aa30e8795988f10dc2b2155c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/14/2021
ms.locfileid: "112068526"
---
# <a name="relevant-notifications-for-stream-routing"></a><span data-ttu-id="2e371-104">Relevante Benachrichtigungen für das Streamrouting</span><span class="sxs-lookup"><span data-stu-id="2e371-104">Relevant Notifications for Stream Routing</span></span>

<span data-ttu-id="2e371-105">In Windows 7 implementieren plattformübergreifende APIs, die Core Audio-APIs wie Media Foundation-, DirectSound- und Wave-APIs verwenden, das Streamroutingfeature, indem sie den Streamwechsel von einem vorhandenen Gerät zu einem neuen Standardaudioendpunkt behandeln.</span><span class="sxs-lookup"><span data-stu-id="2e371-105">In Windows 7, high-level platform APIs that use Core Audio APIs, such as Media Foundation, DirectSound, and Wave APIs, implement the stream routing feature by handling stream switching from an existing device to a new default audio endpoint.</span></span> <span data-ttu-id="2e371-106">Medienanwendungen, die diese APIs verwenden, verwenden das Streamroutingverhalten ohne Änderungen an der Quelle.</span><span class="sxs-lookup"><span data-stu-id="2e371-106">Media applications that use these APIs use the stream routing behavior without any modifications to the source.</span></span> <span data-ttu-id="2e371-107">Direkte WASAPI-Clients können die von Core Audio-Komponenten gesendeten Benachrichtigungen verwenden und das Streamroutingfeature implementieren.</span><span class="sxs-lookup"><span data-stu-id="2e371-107">Direct WASAPI clients can use the notifications sent by Core Audio components and implement the stream routing feature.</span></span>

<span data-ttu-id="2e371-108">Um das Streamroutingfeature zu implementieren, muss ein Client auf zwei Arten von Ereignissen lauschen: Geräteänderungsbenachrichtigungen und Sitzungstrennungsbenachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="2e371-108">To implement the stream routing feature, a client must listen for two types of events: device change notifications and session disconnect notifications.</span></span> <span data-ttu-id="2e371-109">In der von den apIs auf hoher Ebene bereitgestellten Implementierung werden diese Ereignisse für Standardgeräteendpunkte gesendet, die durch Aufrufen von [**IMMDeviceEnumerator::GetDefaultAudioEndpoint erstellt werden.**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint)</span><span class="sxs-lookup"><span data-stu-id="2e371-109">In the implementation provided by the high-level APIs, these events are sent for default device endpoints created by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="2e371-110">Weitere Informationen finden Sie unter [Abrufen des Geräteendpunkts für das Streamrouting.](getting-the-default-device-endpoint-for-stream-routing.md)</span><span class="sxs-lookup"><span data-stu-id="2e371-110">For more information, see [Getting the Device Endpoint for Stream Routing](getting-the-default-device-endpoint-for-stream-routing.md).</span></span>

<span data-ttu-id="2e371-111">Die Core Audio-Komponente MMDeviceAPI stellt Benachrichtigungsrückrufe zur Verfügung, wenn Audiogeräte hinzugefügt, entfernt oder geändert werden.</span><span class="sxs-lookup"><span data-stu-id="2e371-111">The Core Audio component MMDeviceAPI delivers notification callbacks when audio devices are added, removed, or modified.</span></span> <span data-ttu-id="2e371-112">Die Format- und Audiositzungsänderungen werden über WASAPI als Ereignisse gemeldet.</span><span class="sxs-lookup"><span data-stu-id="2e371-112">The format and audio session changes are reported as events through WASAPI.</span></span>

## <a name="device-change-notifications"></a><span data-ttu-id="2e371-113">Geräteänderungsbenachrichtigungen</span><span class="sxs-lookup"><span data-stu-id="2e371-113">Device Change Notifications</span></span>

<span data-ttu-id="2e371-114">MMDeviceAPI löst Ereignisse aus, wenn Audiogeräte hinzugefügt, entfernt oder geändert werden.</span><span class="sxs-lookup"><span data-stu-id="2e371-114">MMDeviceAPI raises events when audio devices are added, removed, or modified.</span></span> <span data-ttu-id="2e371-115">Wenn der Client Datenstromroutingfunktionen bereitstellen soll, muss er die [**IMMNotificationClient-Schnittstelle**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) implementieren und seine Implementierung bei MMDeviceAPI registrieren.</span><span class="sxs-lookup"><span data-stu-id="2e371-115">If the client is to provide stream routing functionality, it must implement the [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) interface and register its implementation with MMDeviceAPI.</span></span>

<span data-ttu-id="2e371-116">Um Geräteänderungsbenachrichtigungen zu erhalten, muss der Client die folgenden Aufgaben ausführen:</span><span class="sxs-lookup"><span data-stu-id="2e371-116">To get device change notifications, the client must perform the following tasks:</span></span>

-   <span data-ttu-id="2e371-117">Implementieren Sie die [**IMMNotificationClient-Schnittstelle,**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) um von MMDeviceAPI gesendete Geräteänderungsbenachrichtigungen zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="2e371-117">Implement the [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) interface to handle device change notifications sent by MMDeviceAPI.</span></span>
-   <span data-ttu-id="2e371-118">Registrieren Sie [**die IMMNotificationClient-Implementierung**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) bei MMDeviceAPI, indem Sie die [**IMMDeviceEnumerator::RegisterEndpointNotificationCallback-Methode**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-registerendpointnotificationcallback) aufrufen.</span><span class="sxs-lookup"><span data-stu-id="2e371-118">Register the [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) implementation with MMDeviceAPI by calling the [**IMMDeviceEnumerator::RegisterEndpointNotificationCallback**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-registerendpointnotificationcallback) method.</span></span>

<span data-ttu-id="2e371-119">Nachdem die Implementierung dieser Schnittstellen durch den Client registriert wurde, empfängt der Client Benachrichtigungen in Form von Rückrufen über die Methoden dieser Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="2e371-119">After the client's implementation of these interfaces is registered, the client receives notifications in the form of callbacks through the methods of these interfaces.</span></span> <span data-ttu-id="2e371-120">[**IMMNotificationClient-Methoden**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) werden von MMDeviceAPI aufgerufen, wenn ereignisse auf Endpunktebene (Endpunktstatusänderungen, neue Endpunktankömmungen, Endpunktlöschungen, Standardendpunktänderungen und Änderungen der Endpunkteigenschaft) aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="2e371-120">[**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) methods are called by MMDeviceAPI when it raises endpoint-level events (endpoint state changes, new endpoint arrivals, endpoint deletions, default endpoint changes, and endpoint property changes).</span></span>

<span data-ttu-id="2e371-121">Wenn der Client Streamrouting für das Standardgerät bereitstellen möchte, muss der Client das Verhalten der Geräteänderung implementieren, wenn er die Benachrichtigung über den [**IMMNotificationClient::OnDefaultDeviceChanged-Rückruf**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) empfängt.</span><span class="sxs-lookup"><span data-stu-id="2e371-121">If the client wants to provide stream routing for the default device, the client must implement the device change behavior when it receives the notification through the [**IMMNotificationClient::OnDefaultDeviceChanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) callback.</span></span>

## <a name="audio-session-change-notifications"></a><span data-ttu-id="2e371-122">Änderungsbenachrichtigungen für Audiositzung</span><span class="sxs-lookup"><span data-stu-id="2e371-122">Audio Session Change Notifications</span></span>

<span data-ttu-id="2e371-123">Audiositzungsänderungen und Formatänderungen werden über WASAPI als Audiositzungsereignisse gemeldet.</span><span class="sxs-lookup"><span data-stu-id="2e371-123">Audio session changes and format changes are reported as audio session events through WASAPI.</span></span> <span data-ttu-id="2e371-124">Ein WASAPI-Client implementiert die [**IAudioSessionEvents-Schnittstelle**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) und registriert die Implementierung bei WASAPI.</span><span class="sxs-lookup"><span data-stu-id="2e371-124">A WASAPI client implements the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interface and registers the implementation with WASAPI.</span></span>

<span data-ttu-id="2e371-125">Um Änderungsbenachrichtigungen für Audiositzung zu erhalten, muss der Client die folgenden Aufgaben ausführen:</span><span class="sxs-lookup"><span data-stu-id="2e371-125">To get audio session change notifications, the client must perform the following tasks:</span></span>

-   <span data-ttu-id="2e371-126">Implementieren Sie die [**IAudioSessionEvents-Schnittstelle,**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) um von WASAPI gesendete Formatänderungsbenachrichtigungen zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="2e371-126">Implement the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interface to handle format change notifications sent by WASAPI.</span></span>
-   <span data-ttu-id="2e371-127">Registrieren Sie [**die IAudioSessionEvents-Implementierung**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) bei WASAPI, indem Sie die [**IAudioSessionControl::RegisterAudioSessionNotification-Methode**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessioncontrol-registeraudiosessionnotification) aufrufen.</span><span class="sxs-lookup"><span data-stu-id="2e371-127">Register the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) implementation with WASAPI by calling the [**IAudioSessionControl::RegisterAudioSessionNotification**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessioncontrol-registeraudiosessionnotification) method.</span></span>

<span data-ttu-id="2e371-128">[**IAudioSessionEvents-Methoden**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) werden von WASAPI aufgerufen, wenn Audiositzungsänderungen auftreten.</span><span class="sxs-lookup"><span data-stu-id="2e371-128">[**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) methods are called by WASAPI when audio session changes occur.</span></span> <span data-ttu-id="2e371-129">Diese Ereignisse werden ausgelöst, wenn sich der Anzeigename, der Symbolpfad, das Volume, der Gruppierungsparameter oder der Zustand der Sitzung ändern.</span><span class="sxs-lookup"><span data-stu-id="2e371-129">These events are raised when the session's display name, icon path, volume, grouping parameter, or state changes.</span></span>

<span data-ttu-id="2e371-130">Um das Streamroutingfeature zu implementieren, muss der Client auf die Benachrichtigung zur Trennung der Sitzungstrennung warten.</span><span class="sxs-lookup"><span data-stu-id="2e371-130">To implement the stream routing feature, the client must wait for the session-disconnect notification.</span></span> <span data-ttu-id="2e371-131">Wenn eine Audiositzung getrennt wird oder das Format eines Geräts geändert wird, sendet WASAPI die Clientbenachrichtigungen in Form von Rückrufen über [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected).</span><span class="sxs-lookup"><span data-stu-id="2e371-131">When an audio session is disconnected or a device's format is changed, WASAPI sends the client notifications in the form of callbacks through [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected).</span></span> <span data-ttu-id="2e371-132">Mit der Trennungsbenachrichtigung sendet WASAPI auch einen Wert, der angibt, warum die Sitzung getrennt wurde.</span><span class="sxs-lookup"><span data-stu-id="2e371-132">With the disconnection notification, WASAPI also sends a value that indicates why the session was disconnected.</span></span> <span data-ttu-id="2e371-133">Dies kann aus verschiedenen Gründen auftreten, z. B. weil das Gerät entfernt wurde, der Server beendet wurde und so weiter.</span><span class="sxs-lookup"><span data-stu-id="2e371-133">This can occur for several reasons, such as the device was removed, the server stopped, and so on.</span></span> <span data-ttu-id="2e371-134">Die vollständige Liste der Gründe finden Sie in der in AudioPolicy.h definierten **AudioSessionDisconnectReason-Enumeration.**</span><span class="sxs-lookup"><span data-stu-id="2e371-134">For the complete list of reasons, see the **AudioSessionDisconnectReason** enumeration defined in AudioPolicy.h.</span></span> <span data-ttu-id="2e371-135">Wenn sich das Standardgerät ändert, muss der Client auf die Benachrichtigungen warten (sofern sie noch nicht empfangen wurden), die mit einem **DisconnectReasonDeviceRemoval-Wert** begleitet werden.</span><span class="sxs-lookup"><span data-stu-id="2e371-135">If the default device changes, the client must wait for the notifications (if they have not already been received) that are accompanied with a **DisconnectReasonDeviceRemoval** value.</span></span> <span data-ttu-id="2e371-136">Als Reaktion auf solche Benachrichtigungen kann der Client den Stream auf dem neuen Standardgerät erneut öffnen.</span><span class="sxs-lookup"><span data-stu-id="2e371-136">In response to such notifications, the client might reopen the stream on the new default device.</span></span>

<span data-ttu-id="2e371-137">Da alle diese Vorgänge achron sind, kann die Reihenfolge, in der die Anwendung Benachrichtigungen empfängt, nicht vorhergesagt werden.</span><span class="sxs-lookup"><span data-stu-id="2e371-137">Because all of these operations are asychronous, the order in which the application receives notifications cannnot be predicted.</span></span> <span data-ttu-id="2e371-138">In der Regel empfängt die Anwendung jedoch den **Wert AudioSessionDisconnect,** bevor die Standardbenachrichtigung zur Geräteänderung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="2e371-138">However, typically, the application receives **AudioSessionDisconnect** value before the default device change notification.</span></span>

### <a name="format-change-notifications"></a><span data-ttu-id="2e371-139">Formatänderungsbenachrichtigungen</span><span class="sxs-lookup"><span data-stu-id="2e371-139">Format Change Notifications</span></span>

<span data-ttu-id="2e371-140">Änderungen des Audioformats treten auf, wenn sich das Format des Streams ändert.</span><span class="sxs-lookup"><span data-stu-id="2e371-140">Audio format changes occur when the format of the stream changes.</span></span> <span data-ttu-id="2e371-141">Dies kann auftreten, wenn der Benutzer  ein neues Format in der Sound-Systemsteuerung auswählt oder das neue Standardgerät ein neues Format unterstützt (z. B. EINE oder bestimmte professionelle Audioschnittstellen mit einer manuellen Anpassung der Abtastrate).</span><span class="sxs-lookup"><span data-stu-id="2e371-141">This can occur when the user selects a new format in the **Sound** control panel or the new default device supports a new format (for example, HDMI or certain professional audio interfaces with a manual sample-rate adjustment).</span></span> <span data-ttu-id="2e371-142">Um den Client über diese Arten von Formatänderungen zu benachrichtigen, sendet WASAPI eine Sitzungsbenachrichtigung durch die registrierte Implementierung von [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected) mit dem Trennungsgrund **DisconnectReasonFormatChanged**.</span><span class="sxs-lookup"><span data-stu-id="2e371-142">To notify the client about these types of format changes, WASAPI sends a session notification by the registered implementation of [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected) with a disconnect reason of **DisconnectReasonFormatChanged**.</span></span> <span data-ttu-id="2e371-143">Der Client kann die Benachrichtigung verarbeiten, indem er den Stream im neuen Format erneut öffnet.</span><span class="sxs-lookup"><span data-stu-id="2e371-143">The client can handle the notification by reopening the stream in the new format.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2e371-144">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="2e371-144">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2e371-145">Informationen zur MMDevice-API</span><span class="sxs-lookup"><span data-stu-id="2e371-145">About MMDevice API</span></span>](mmdevice-api.md)
</dt> <dt>

[<span data-ttu-id="2e371-146">Informationen zu WASAPI</span><span class="sxs-lookup"><span data-stu-id="2e371-146">About WASAPI</span></span>](wasapi.md)
</dt> <dt>

[<span data-ttu-id="2e371-147">Streamrouting</span><span class="sxs-lookup"><span data-stu-id="2e371-147">Stream Routing</span></span>](stream-routing.md)
</dt> </dl>

 

 



