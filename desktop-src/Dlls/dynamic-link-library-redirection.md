---
description: Anwendungen können von einer bestimmten Version einer freigegebenen DLL abhängen und beginnen mit einem Fehler, wenn eine andere Anwendung mit einer neueren oder einer älteren Version derselben DLL installiert wird.
ms.assetid: 3b426b6c-1ad5-43b9-81ea-5e6d3c6588c8
title: Umleitung der Dynamic-Link Bibliothek
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b575d566231058cca13c10a067a3c2e20078073
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106350523"
---
# <a name="dynamic-link-library-redirection"></a><span data-ttu-id="5ebf2-103">Umleitung der Dynamic-Link Bibliothek</span><span class="sxs-lookup"><span data-stu-id="5ebf2-103">Dynamic-Link Library Redirection</span></span>

<span data-ttu-id="5ebf2-104">Anwendungen können von einer bestimmten Version einer freigegebenen DLL abhängen und beginnen mit einem Fehler, wenn eine andere Anwendung mit einer neueren oder einer älteren Version derselben DLL installiert wird.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-104">Applications can depend on a specific version of a shared DLL and start to fail if another application is installed with a newer or older version of the same DLL.</span></span> <span data-ttu-id="5ebf2-105">Es gibt zwei Möglichkeiten, um sicherzustellen, dass Ihre Anwendung die richtige dll verwendet: DLL-Umleitung und parallele Komponenten.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-105">There are two ways to ensure that your application uses the correct DLL: DLL redirection and side-by-side components.</span></span> <span data-ttu-id="5ebf2-106">Entwickler und Administratoren sollten die DLL-Umleitung für vorhandene Anwendungen verwenden, da keine Änderungen an der Anwendung erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-106">Developers and administrators should use DLL redirection for existing applications, because it does not require any changes to the application.</span></span> <span data-ttu-id="5ebf2-107">Wenn Sie eine neue Anwendung erstellen oder eine Anwendung aktualisieren und Ihre Anwendung vor möglichen Problemen isolieren möchten, erstellen Sie eine parallele [Komponente](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="5ebf2-107">If you are creating a new application or updating an application and want to isolate your application from potential problems, create a [side-by-side component](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

<span data-ttu-id="5ebf2-108">Um die DLL-Umleitung Computer weit zu aktivieren, müssen Sie einen neuen Registrierungsschlüssel erstellen.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-108">To enable DLL redirection machine-wide, you must create a new registry key.</span></span> <span data-ttu-id="5ebf2-109">Erstellen Sie einen neuen DWORD-Schlüssel namens " **devoverrideenable** " unter **HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options** , und legen Sie ihn auf 1 fest.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-109">Create a new DWORD key called **DevOverrideEnable** at **HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options** and set it to 1.</span></span> <span data-ttu-id="5ebf2-110">Danach müssen Sie den Computer neu starten, um die Auswirkungen anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-110">After this, you must restart your computer to see the effects.</span></span>

<span data-ttu-id="5ebf2-111">Um die DLL-Umleitung zu verwenden, erstellen Sie eine *Umleitungs Datei* für die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-111">To use DLL redirection, create a *redirection file* for your application.</span></span> <span data-ttu-id="5ebf2-112">Die Umleitungs Datei muss wie folgt benannt werden: *App- \_ Name*. local.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-112">The redirection file must be named as follows: *App\_name*.local.</span></span> <span data-ttu-id="5ebf2-113">Wenn der Anwendungsname beispielsweise Editor.exe ist, sollte die Umleitungs Datei Editor.exe. local benannt werden.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-113">For example, if the application name is Editor.exe, the redirection file should be named Editor.exe.local.</span></span> <span data-ttu-id="5ebf2-114">Sie müssen die lokale Datei im Anwendungsverzeichnis installieren.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-114">You must install the .local file in the application directory.</span></span> <span data-ttu-id="5ebf2-115">Außerdem müssen Sie die DLLs im Anwendungsverzeichnis installieren.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-115">You must also install the DLLs in the application directory.</span></span>

<span data-ttu-id="5ebf2-116">Der Inhalt einer Umleitungs Datei wird ignoriert, aber das vorhanden sein bewirkt, dass Windows das Anwendungsverzeichnis beim Laden einer DLL zuerst überprüft, unabhängig von dem Pfad, der für [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) oder [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-116">The contents of a redirection file are ignored, but its presence causes Windows to check the application directory first whenever it loads a DLL, regardless of the path specified to [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="5ebf2-117">Wenn die dll nicht im Anwendungsverzeichnis gefunden wird, verwenden diese Funktionen ihre übliche Such Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-117">If the DLL is not found in the application directory, then these functions use their usual search order.</span></span> <span data-ttu-id="5ebf2-118">Beispiel: Wenn die Anwendung c: \\ myapp \\myapp.exe **LoadLibrary** mit folgendem Pfad aufruft:</span><span class="sxs-lookup"><span data-stu-id="5ebf2-118">For example, if the application c:\\myapp\\myapp.exe calls **LoadLibrary** using the following path:</span></span>

<span data-ttu-id="5ebf2-119">c: \\ Programmdateien: \\ \\ System \\mydll.dll</span><span class="sxs-lookup"><span data-stu-id="5ebf2-119">c:\\program files\\common files\\system\\mydll.dll</span></span>

<span data-ttu-id="5ebf2-120">Wenn sowohl c: \\ myapp \\myapp.exe. local als auch c: \\ myapp \\mydll.dll vorhanden ist, lädt [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) c: \\ myapp \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-120">And, if both c:\\myapp\\myapp.exe.local and c:\\myapp\\mydll.dll exist, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\mydll.dll.</span></span> <span data-ttu-id="5ebf2-121">Andernfalls lädt " **LoadLibrary** " das \\ \\ Systemmydll.dll "Systemdateien Common Files" \\ \\ .</span><span class="sxs-lookup"><span data-stu-id="5ebf2-121">Otherwise, **LoadLibrary** loads c:\\program files\\common files\\system\\mydll.dll.</span></span>

<span data-ttu-id="5ebf2-122">Wenn ein Verzeichnis mit dem Namen c: \\ myapp \\myapp.exe. local vorhanden ist und mydll.dll enthält, lädt [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) Alternativ c: \\ myapp \\myapp.exe. local \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-122">Alternatively, if a directory named c:\\myapp\\myapp.exe.local exists and contains mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\myapp.exe.local\\mydll.dll.</span></span>

<span data-ttu-id="5ebf2-123">Wenn die Anwendung über ein Manifest verfügt, werden alle lokalen Dateien ignoriert.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-123">If the application has a manifest, then any .local files are ignored.</span></span>

<span data-ttu-id="5ebf2-124">Wenn Sie die DLL-Umleitung verwenden und die Anwendung keinen Zugriff auf alle Laufwerke und Verzeichnisse in der Such Reihenfolge hat, beendet [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) die Suche, sobald der Zugriff verweigert wird.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-124">If you are using DLL redirection and the application does not have access to all drives and directories in the search order, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) stops searching as soon as access is denied.</span></span> <span data-ttu-id="5ebf2-125">(Wenn Sie keine DLL-Umleitung verwenden, überspringt **LoadLibrary** Verzeichnisse, auf die nicht zugegriffen werden kann, und setzt dann die Suche fort.)</span><span class="sxs-lookup"><span data-stu-id="5ebf2-125">(If you are not using DLL redirection, **LoadLibrary** skips directories that it cannot access and then continues searching.)</span></span>

<span data-ttu-id="5ebf2-126">Es empfiehlt sich, die Anwendungs-DLLs im gleichen Verzeichnis zu installieren, in dem auch die Anwendung enthalten ist, auch wenn Sie keine DLL-Umleitung verwenden.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-126">It is good practice to install application DLLs in the same directory that contains the application, even if you are not using DLL redirection.</span></span> <span data-ttu-id="5ebf2-127">Dadurch wird sichergestellt, dass das Installieren der Anwendung keine anderen Kopien der dll überschreibt und dazu führt, dass andere Anwendungen fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-127">This ensures that installing the application does not overwrite other copies of the DLL and cause other applications to fail.</span></span> <span data-ttu-id="5ebf2-128">Wenn Sie diese bewährte Vorgehensweise befolgen, überschreiben andere Anwendungen die Kopie der dll nicht und bewirken, dass Ihre Anwendung fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="5ebf2-128">Also, if you follow this good practice, other applications do not overwrite your copy of the DLL and cause your application to fail.</span></span>

 

 
