---
description: Anwendungen können den Speicherort steuern, von dem eine DLL geladen wird, indem Sie einen vollständigen Pfad oder einen anderen Mechanismus, z. b. ein Manifest, angeben. Wenn diese Methoden nicht verwendet werden, sucht das System zur Ladezeit nach der dll, wie in diesem Thema beschrieben.
ms.assetid: 44228cf2-6306-466c-8f16-f513cd3ba8b5
title: Dynamic Link Library-Suchreihenfolge
ms.topic: article
ms.date: 09/11/2020
ms.custom: contperf-fy21q1
ms.openlocfilehash: 928cf9030e24c91145ae95e1eed680017bf68533
ms.sourcegitcommit: f374b50b37160b683da16b59ac9340282a8f50a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/04/2021
ms.locfileid: "104520331"
---
# <a name="dynamic-link-library-search-order"></a><span data-ttu-id="da673-104">Dynamic Link Library-Suchreihenfolge</span><span class="sxs-lookup"><span data-stu-id="da673-104">Dynamic-Link Library Search Order</span></span>

<span data-ttu-id="da673-105">Ein System kann mehrere Versionen derselben DLL (Dynamic Link Library) enthalten.</span><span class="sxs-lookup"><span data-stu-id="da673-105">A system can contain multiple versions of the same dynamic-link library (DLL).</span></span> <span data-ttu-id="da673-106">Anwendungen können den Speicherort steuern, von dem eine DLL geladen wird, indem Sie einen vollständigen Pfad oder einen anderen Mechanismus, z. b. ein Manifest, angeben.</span><span class="sxs-lookup"><span data-stu-id="da673-106">Applications can control the location from which a DLL is loaded by specifying a full path or using another mechanism such as a manifest.</span></span> <span data-ttu-id="da673-107">Wenn diese Methoden nicht verwendet werden, sucht das System zur Ladezeit nach der dll, wie in diesem Thema beschrieben.</span><span class="sxs-lookup"><span data-stu-id="da673-107">If these methods are not used, the system searches for the DLL at load time as described in this topic.</span></span>

-   [<span data-ttu-id="da673-108">Faktoren, die die Suche beeinflussen</span><span class="sxs-lookup"><span data-stu-id="da673-108">Factors That Affect Searching</span></span>](#factors-that-affect-searching)
-   [<span data-ttu-id="da673-109">Such Reihenfolge für UWP-apps</span><span class="sxs-lookup"><span data-stu-id="da673-109">Search Order for UWP Apps</span></span>](#search-order-for-uwp-apps)
    -   [<span data-ttu-id="da673-110">Standard Such Reihenfolge für UWP-apps</span><span class="sxs-lookup"><span data-stu-id="da673-110">Standard Search Order for UWP Apps</span></span>](#standard-search-order-for-uwp-apps)
    -   [<span data-ttu-id="da673-111">Alternative Such Reihenfolge für UWP-apps</span><span class="sxs-lookup"><span data-stu-id="da673-111">Alternate Search Order for UWP Apps</span></span>](#alternate-search-order-for-uwp-apps)
-   [<span data-ttu-id="da673-112">Such Reihenfolge für Desktop Anwendungen</span><span class="sxs-lookup"><span data-stu-id="da673-112">Search Order for Desktop Applications</span></span>](#search-order-for-desktop-applications)
    -   [<span data-ttu-id="da673-113">Standard Such Reihenfolge für Desktop Anwendungen</span><span class="sxs-lookup"><span data-stu-id="da673-113">Standard Search Order for Desktop Applications</span></span>](#standard-search-order-for-desktop-applications)
    -   [<span data-ttu-id="da673-114">Alternative Such Reihenfolge für Desktop Anwendungen</span><span class="sxs-lookup"><span data-stu-id="da673-114">Alternate Search Order for Desktop Applications</span></span>](#alternate-search-order-for-desktop-applications)
    -   [<span data-ttu-id="da673-115">Such Reihenfolge mithilfe von **\_ \_ Suchflags der Lade Bibliothek**</span><span class="sxs-lookup"><span data-stu-id="da673-115">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>](/windows)
-   [<span data-ttu-id="da673-116">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="da673-116">Related topics</span></span>](#related-topics)

## <a name="factors-that-affect-searching"></a><span data-ttu-id="da673-117">Faktoren, die die Suche beeinflussen</span><span class="sxs-lookup"><span data-stu-id="da673-117">Factors That Affect Searching</span></span>

<span data-ttu-id="da673-118">Die folgenden Faktoren beeinflussen, ob das System nach einer DLL sucht:</span><span class="sxs-lookup"><span data-stu-id="da673-118">The following factors affect whether the system searches for a DLL:</span></span>

-   <span data-ttu-id="da673-119">Wenn eine DLL mit dem gleichen Modulnamen bereits in den Arbeitsspeicher geladen wurde, prüft das System nur die Umleitung und ein Manifest vor der Auflösung in die geladene DLL, unabhängig davon, in welchem Verzeichnis es sich befindet.</span><span class="sxs-lookup"><span data-stu-id="da673-119">If a DLL with the same module name is already loaded in memory, the system checks only for redirection and a manifest before resolving to the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="da673-120">Das System sucht nicht nach der dll.</span><span class="sxs-lookup"><span data-stu-id="da673-120">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="da673-121">Wenn die dll in der Liste der bekannten DLLs für die Windows-Version enthalten ist, in der die Anwendung ausgeführt wird, verwendet das System die Kopie der bekannten dll (sofern vorhanden), anstatt nach der dll zu suchen.</span><span class="sxs-lookup"><span data-stu-id="da673-121">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any) instead of searching for the DLL.</span></span> <span data-ttu-id="da673-122">Eine Liste bekannter DLLs auf dem aktuellen System finden Sie unter dem folgenden Registrierungsschlüssel: **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="da673-122">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>
-   <span data-ttu-id="da673-123">Wenn eine DLL Abhängigkeiten aufweist, sucht das System nach den abhängigen DLLs, als wären Sie nur mit den Modulnamen geladen worden.</span><span class="sxs-lookup"><span data-stu-id="da673-123">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="da673-124">Dies gilt auch, wenn die erste dll durch Angabe eines vollständigen Pfads geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="da673-124">This is true even if the first DLL was loaded by specifying a full path.</span></span>

## <a name="search-order-for-uwp-apps"></a><span data-ttu-id="da673-125">Such Reihenfolge für UWP-apps</span><span class="sxs-lookup"><span data-stu-id="da673-125">Search Order for UWP apps</span></span>

<span data-ttu-id="da673-126">Wenn eine UWP-App für Windows 10 (oder eine Store-App für Windows 8. x) ein Paket Modul durch Aufrufen der [**loadpackagedlibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) -Funktion lädt, muss sich die dll im Paket Abhängigkeits Diagramm des Prozesses befinden.</span><span class="sxs-lookup"><span data-stu-id="da673-126">When a UWP app for Windows 10 (or a Store app for Windows 8.x) loads a packaged module by calling the [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) function, the DLL must be in the package dependency graph of the process.</span></span> <span data-ttu-id="da673-127">Weitere Informationen finden Sie unter **loadpackagedlibrary**.</span><span class="sxs-lookup"><span data-stu-id="da673-127">For more information, see **LoadPackagedLibrary**.</span></span> <span data-ttu-id="da673-128">Wenn eine UWP-App ein Modul auf andere Weise lädt und keinen vollständigen Pfad angibt, sucht das System zur Ladezeit nach der dll und den zugehörigen Abhängigkeiten, wie in diesem Abschnitt beschrieben.</span><span class="sxs-lookup"><span data-stu-id="da673-128">When a UWP app loads a module by other means and does not specify a full path, the system searches for the DLL and its dependencies at load time as described in this section.</span></span>

<span data-ttu-id="da673-129">Bevor das System nach einer DLL sucht, wird Folgendes überprüft:</span><span class="sxs-lookup"><span data-stu-id="da673-129">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="da673-130">Wenn eine DLL mit dem gleichen Modulnamen bereits in den Arbeitsspeicher geladen wurde, verwendet das System die geladene DLL, unabhängig davon, in welchem Verzeichnis Sie sich befindet.</span><span class="sxs-lookup"><span data-stu-id="da673-130">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="da673-131">Das System sucht nicht nach der dll.</span><span class="sxs-lookup"><span data-stu-id="da673-131">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="da673-132">Wenn die dll in der Liste der bekannten DLLs für die Version von Windows enthalten ist, in der die Anwendung ausgeführt wird, verwendet das System die Kopie der bekannten dll (und ggf. die abhängigen DLLs der bekannten dll).</span><span class="sxs-lookup"><span data-stu-id="da673-132">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="da673-133">Das System sucht nicht nach der dll.</span><span class="sxs-lookup"><span data-stu-id="da673-133">The system does not search for the DLL.</span></span> <span data-ttu-id="da673-134">Eine Liste bekannter DLLs auf dem aktuellen System finden Sie unter dem folgenden Registrierungsschlüssel: **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="da673-134">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="da673-135">Wenn das System nach einem Modul oder seinen Abhängigkeiten suchen muss, verwendet es immer die Such Reihenfolge für UWP-apps, auch wenn eine Abhängigkeit nicht UWP-app-Code ist.</span><span class="sxs-lookup"><span data-stu-id="da673-135">If the system must search for a module or its dependencies, it always uses the search order for UWP apps even if a dependency is not UWP app code.</span></span>

### <a name="standard-search-order-for-uwp-apps"></a><span data-ttu-id="da673-136">Standard Such Reihenfolge für UWP-apps</span><span class="sxs-lookup"><span data-stu-id="da673-136">Standard Search Order for UWP apps</span></span>

<span data-ttu-id="da673-137">Wenn das Modul nicht bereits geladen ist oder in der Liste bekannter DLLs vorhanden ist, durchsucht das System diese Speicherorte in dieser Reihenfolge:</span><span class="sxs-lookup"><span data-stu-id="da673-137">If the module is not already loaded or on the list of known DLLs, the system searches these locations in this order:</span></span>

1.  <span data-ttu-id="da673-138">Das Paket Abhängigkeits Diagramm des Prozesses.</span><span class="sxs-lookup"><span data-stu-id="da673-138">The package dependency graph of the process.</span></span> <span data-ttu-id="da673-139">Dabei handelt es sich um das Paket der Anwendung und alle Abhängigkeiten, die `<PackageDependency>` im `<Dependencies>` -Abschnitt des Paket Manifests der Anwendung angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="da673-139">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="da673-140">Abhängigkeiten werden in der Reihenfolge durchsucht, in der Sie im Manifest angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="da673-140">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="da673-141">Das Verzeichnis, aus dem der aufrufende Prozess geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="da673-141">The directory the calling process was loaded from.</span></span>
3.  <span data-ttu-id="da673-142">Das System Verzeichnis (% systemroot% \\ system32).</span><span class="sxs-lookup"><span data-stu-id="da673-142">The system directory (%SystemRoot%\\system32).</span></span>

<span data-ttu-id="da673-143">Wenn eine DLL Abhängigkeiten aufweist, sucht das System nach den abhängigen DLLs, als wären Sie nur mit den Modulnamen geladen worden.</span><span class="sxs-lookup"><span data-stu-id="da673-143">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="da673-144">Dies gilt auch, wenn die erste dll durch Angabe eines vollständigen Pfads geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="da673-144">This is true even if the first DLL was loaded by specifying a full path.</span></span>

### <a name="alternate-search-order-for-uwp-apps"></a><span data-ttu-id="da673-145">Alternative Such Reihenfolge für UWP-apps</span><span class="sxs-lookup"><span data-stu-id="da673-145">Alternate Search Order for UWP apps</span></span>

<span data-ttu-id="da673-146">Wenn ein Modul die Standard Such Reihenfolge durch Aufrufen der [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) -Funktion mit der **Last \_ mit dem \_ geänderten \_ \_ Suchpfad** ändert, durchsucht das System das Verzeichnis, aus dem das angegebene Modul geladen wurde, anstelle des Verzeichnisses des aufrufenden Prozesses.</span><span class="sxs-lookup"><span data-stu-id="da673-146">If a module changes the standard search order by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**, the system searches the directory the specified module was loaded from instead of the directory of the calling process.</span></span> <span data-ttu-id="da673-147">Das System durchsucht diese Speicherorte in dieser Reihenfolge:</span><span class="sxs-lookup"><span data-stu-id="da673-147">The system searches these locations in this order:</span></span>

1.  <span data-ttu-id="da673-148">Das Paket Abhängigkeits Diagramm des Prozesses.</span><span class="sxs-lookup"><span data-stu-id="da673-148">The package dependency graph of the process.</span></span> <span data-ttu-id="da673-149">Dabei handelt es sich um das Paket der Anwendung und alle Abhängigkeiten, die `<PackageDependency>` im `<Dependencies>` -Abschnitt des Paket Manifests der Anwendung angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="da673-149">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="da673-150">Abhängigkeiten werden in der Reihenfolge durchsucht, in der Sie im Manifest angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="da673-150">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="da673-151">Das Verzeichnis, aus dem das angegebene Modul geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="da673-151">The directory the specified module was loaded from.</span></span>
3.  <span data-ttu-id="da673-152">Das System Verzeichnis (% systemroot% \\ system32).</span><span class="sxs-lookup"><span data-stu-id="da673-152">The system directory (%SystemRoot%\\system32).</span></span>

## <a name="search-order-for-desktop-applications"></a><span data-ttu-id="da673-153">Such Reihenfolge für Desktop Anwendungen</span><span class="sxs-lookup"><span data-stu-id="da673-153">Search Order for Desktop Applications</span></span>

<span data-ttu-id="da673-154">Desktop Anwendungen können den Speicherort steuern, von dem eine DLL geladen wird, indem Sie einen vollständigen Pfad, mithilfe der [dll-Umleitung](dynamic-link-library-redirection.md)oder mithilfe eines [Manifests](/windows/desktop/SbsCs/manifests)angeben.</span><span class="sxs-lookup"><span data-stu-id="da673-154">Desktop applications can control the location from which a DLL is loaded by specifying a full path, using [DLL redirection](dynamic-link-library-redirection.md), or by using a [manifest](/windows/desktop/SbsCs/manifests).</span></span> <span data-ttu-id="da673-155">Wenn keine dieser Methoden verwendet wird, sucht das System zur Ladezeit nach der dll, wie in diesem Abschnitt beschrieben.</span><span class="sxs-lookup"><span data-stu-id="da673-155">If none of these methods are used, the system searches for the DLL at load time as described in this section.</span></span>

<span data-ttu-id="da673-156">Bevor das System nach einer DLL sucht, wird Folgendes überprüft:</span><span class="sxs-lookup"><span data-stu-id="da673-156">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="da673-157">Wenn eine DLL mit dem gleichen Modulnamen bereits in den Arbeitsspeicher geladen wurde, verwendet das System die geladene DLL, unabhängig davon, in welchem Verzeichnis Sie sich befindet.</span><span class="sxs-lookup"><span data-stu-id="da673-157">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="da673-158">Das System sucht nicht nach der dll.</span><span class="sxs-lookup"><span data-stu-id="da673-158">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="da673-159">Wenn die dll in der Liste der bekannten DLLs für die Version von Windows enthalten ist, in der die Anwendung ausgeführt wird, verwendet das System die Kopie der bekannten dll (und ggf. die abhängigen DLLs der bekannten dll).</span><span class="sxs-lookup"><span data-stu-id="da673-159">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="da673-160">Das System sucht nicht nach der dll.</span><span class="sxs-lookup"><span data-stu-id="da673-160">The system does not search for the DLL.</span></span> <span data-ttu-id="da673-161">Eine Liste bekannter DLLs auf dem aktuellen System finden Sie unter dem folgenden Registrierungsschlüssel: **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="da673-161">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="da673-162">Wenn eine DLL Abhängigkeiten aufweist, sucht das System nach den abhängigen DLLs, als wären Sie nur mit den Modulnamen geladen worden.</span><span class="sxs-lookup"><span data-stu-id="da673-162">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="da673-163">Dies gilt auch, wenn die erste dll durch Angabe eines vollständigen Pfads geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="da673-163">This is true even if the first DLL was loaded by specifying a full path.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="da673-164">Wenn ein Angreifer die Kontrolle über eines der Verzeichnisse erhält, die durchsucht werden, kann er eine bösartige Kopie der dll in diesem Verzeichnis platzieren.</span><span class="sxs-lookup"><span data-stu-id="da673-164">If an attacker gains control of one of the directories that is searched, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="da673-165">Weitere Möglichkeiten, solche Angriffe zu verhindern, finden Sie unter [Dynamic-Link Library Security](dynamic-link-library-security.md).</span><span class="sxs-lookup"><span data-stu-id="da673-165">For ways to help prevent such attacks, see [Dynamic-Link Library Security](dynamic-link-library-security.md).</span></span>

### <a name="standard-search-order-for-desktop-applications"></a><span data-ttu-id="da673-166">Standard Such Reihenfolge für Desktop Anwendungen</span><span class="sxs-lookup"><span data-stu-id="da673-166">Standard Search Order for Desktop Applications</span></span>

<span data-ttu-id="da673-167">Die vom System verwendete DLL-Standard Such Reihenfolge hängt davon ab, ob der sichere DLL-Suchmodus aktiviert oder deaktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="da673-167">The standard DLL search order used by the system depends on whether safe DLL search mode is enabled or disabled.</span></span> <span data-ttu-id="da673-168">Der sichere DLL-Suchmodus platziert das aktuelle Verzeichnis des Benutzers später in der Such Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="da673-168">Safe DLL search mode places the user's current directory later in the search order.</span></span>

<span data-ttu-id="da673-169">Der sichere DLL-Suchmodus ist standardmäßig aktiviert.</span><span class="sxs-lookup"><span data-stu-id="da673-169">Safe DLL search mode is enabled by default.</span></span> <span data-ttu-id="da673-170">Um dieses Feature zu deaktivieren, erstellen Sie den Registrierungs Wert **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager** \\ **SafeDllSearchMode** , und legen Sie ihn auf 0 fest.</span><span class="sxs-lookup"><span data-stu-id="da673-170">To disable this feature, create the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value and set it to 0.</span></span> <span data-ttu-id="da673-171">Durch Aufrufen der [**setdlldirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) -Funktion wird **SafeDllSearchMode** deaktiviert, während sich das angegebene Verzeichnis im Suchpfad befindet, und die Such Reihenfolge ändert, wie in diesem Thema beschrieben.</span><span class="sxs-lookup"><span data-stu-id="da673-171">Calling the [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) function effectively disables **SafeDllSearchMode** while the specified directory is in the search path and changes the search order as described in this topic.</span></span>

<span data-ttu-id="da673-172">Wenn **SafeDllSearchMode** aktiviert ist, lautet die Such Reihenfolge wie folgt:</span><span class="sxs-lookup"><span data-stu-id="da673-172">If **SafeDllSearchMode** is enabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="da673-173">Das Verzeichnis, in dem die Anwendung geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="da673-173">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="da673-174">Das Systemverzeichnis</span><span class="sxs-lookup"><span data-stu-id="da673-174">The system directory.</span></span> <span data-ttu-id="da673-175">Verwenden Sie die [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-175">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="da673-176">Das 16-Bit-System Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-176">The 16-bit system directory.</span></span> <span data-ttu-id="da673-177">Es gibt keine Funktion, die den Pfad dieses Verzeichnisses erhält, sondern durchsucht wird.</span><span class="sxs-lookup"><span data-stu-id="da673-177">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="da673-178">Das Windows-Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-178">The Windows directory.</span></span> <span data-ttu-id="da673-179">Verwenden Sie die [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-179">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="da673-180">Das aktuelle Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-180">The current directory.</span></span>
6.  <span data-ttu-id="da673-181">Die Verzeichnisse, die in der PATH-Umgebungsvariablen aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="da673-181">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="da673-182">Beachten Sie, dass dies nicht den pro Anwendung-Pfad enthält, der durch den Registrierungsschlüssel für **App-Pfade** angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="da673-182">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="da673-183">Der Schlüssel für die **App-Pfade** wird beim Berechnen des dll-Suchpfades nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="da673-183">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="da673-184">Wenn **SafeDllSearchMode** deaktiviert ist, lautet die Such Reihenfolge wie folgt:</span><span class="sxs-lookup"><span data-stu-id="da673-184">If **SafeDllSearchMode** is disabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="da673-185">Das Verzeichnis, in dem die Anwendung geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="da673-185">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="da673-186">Das aktuelle Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-186">The current directory.</span></span>
3.  <span data-ttu-id="da673-187">Das Systemverzeichnis</span><span class="sxs-lookup"><span data-stu-id="da673-187">The system directory.</span></span> <span data-ttu-id="da673-188">Verwenden Sie die [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-188">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="da673-189">Das 16-Bit-System Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-189">The 16-bit system directory.</span></span> <span data-ttu-id="da673-190">Es gibt keine Funktion, die den Pfad dieses Verzeichnisses erhält, sondern durchsucht wird.</span><span class="sxs-lookup"><span data-stu-id="da673-190">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="da673-191">Das Windows-Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-191">The Windows directory.</span></span> <span data-ttu-id="da673-192">Verwenden Sie die [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-192">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="da673-193">Die Verzeichnisse, die in der PATH-Umgebungsvariablen aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="da673-193">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="da673-194">Beachten Sie, dass dies nicht den pro Anwendung-Pfad enthält, der durch den Registrierungsschlüssel für **App-Pfade** angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="da673-194">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="da673-195">Der Schlüssel für die **App-Pfade** wird beim Berechnen des dll-Suchpfades nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="da673-195">The **App Paths** key is not used when computing the DLL search path.</span></span>

### <a name="alternate-search-order-for-desktop-applications"></a><span data-ttu-id="da673-196">Alternative Such Reihenfolge für Desktop Anwendungen</span><span class="sxs-lookup"><span data-stu-id="da673-196">Alternate Search Order for Desktop Applications</span></span>

<span data-ttu-id="da673-197">Die vom System verwendete Standard Such Reihenfolge kann durch Aufrufen der [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) -Funktion mit der **Last \_ mit dem \_ geänderten \_ \_ Suchpfad** geändert werden.</span><span class="sxs-lookup"><span data-stu-id="da673-197">The standard search order used by the system can be changed by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**.</span></span> <span data-ttu-id="da673-198">Die Standard Such Reihenfolge kann auch durch Aufrufen der Funktion [**setdlldirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) geändert werden.</span><span class="sxs-lookup"><span data-stu-id="da673-198">The standard search order can also be changed by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span>

> [!NOTE]
> <span data-ttu-id="da673-199">Die Standard Such Reihenfolge des Prozesses wird auch durch Aufrufen der [**setdlldirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) -Funktion im übergeordneten Prozess vor dem Start des aktuellen Prozesses beeinträchtigt.</span><span class="sxs-lookup"><span data-stu-id="da673-199">The standard search order of the process will also be affected by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function in the parent process before start of the current process.</span></span>

<span data-ttu-id="da673-200">Wenn Sie eine Alternative Suchstrategie angeben, wird das Verhalten so lange fortgesetzt, bis alle zugehörigen ausführbaren Module gefunden wurden.</span><span class="sxs-lookup"><span data-stu-id="da673-200">If you specify an alternate search strategy, its behavior continues until all associated executable modules have been located.</span></span> <span data-ttu-id="da673-201">Nachdem das System mit der Verarbeitung der dll-Initialisierungs Routinen begonnen hat, stellt das System die Standard Suchstrategie wieder her.</span><span class="sxs-lookup"><span data-stu-id="da673-201">After the system starts processing DLL initialization routines, the system reverts to the standard search strategy.</span></span>

<span data-ttu-id="da673-202">Die [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) -Funktion unterstützt eine Alternative Such Reihenfolge, wenn der-Befehl **Load \_ mit einem \_ geänderten \_ \_ Suchpfad** angibt und der *lpFileName* -Parameter einen absoluten Pfad angibt.</span><span class="sxs-lookup"><span data-stu-id="da673-202">The [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function supports an alternate search order if the call specifies **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** and the *lpFileName* parameter specifies an absolute path.</span></span>

<span data-ttu-id="da673-203">Beachten Sie, dass die Standard Suchstrategie und die Alternative Suchstrategie, die von [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) mit **Load \_ mit dem \_ geänderten \_ \_ Suchpfad** festgelegt wird, sich in nur eine Weise unterscheiden: die Standardsuche beginnt im Verzeichnis der aufrufenden Anwendung, und die Alternative Suche beginnt im Verzeichnis des ausführbaren Moduls, das **LoadLibraryEx** lädt.</span><span class="sxs-lookup"><span data-stu-id="da673-203">Note that the standard search strategy and the alternate search strategy specified by [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** differ in just one way: The standard search begins in the calling application's directory, and the alternate search begins in the directory of the executable module that **LoadLibraryEx** is loading.</span></span>

<span data-ttu-id="da673-204">Wenn **SafeDllSearchMode** aktiviert ist, lautet die Alternative Such Reihenfolge wie folgt:</span><span class="sxs-lookup"><span data-stu-id="da673-204">If **SafeDllSearchMode** is enabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="da673-205">Das von *lpFileName* angegebene Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-205">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="da673-206">Das Systemverzeichnis</span><span class="sxs-lookup"><span data-stu-id="da673-206">The system directory.</span></span> <span data-ttu-id="da673-207">Verwenden Sie die [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-207">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="da673-208">Das 16-Bit-System Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-208">The 16-bit system directory.</span></span> <span data-ttu-id="da673-209">Es gibt keine Funktion, die den Pfad dieses Verzeichnisses erhält, sondern durchsucht wird.</span><span class="sxs-lookup"><span data-stu-id="da673-209">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="da673-210">Das Windows-Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-210">The Windows directory.</span></span> <span data-ttu-id="da673-211">Verwenden Sie die [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-211">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="da673-212">Das aktuelle Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-212">The current directory.</span></span>
6.  <span data-ttu-id="da673-213">Die Verzeichnisse, die in der PATH-Umgebungsvariablen aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="da673-213">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="da673-214">Beachten Sie, dass dies nicht den pro Anwendung-Pfad enthält, der durch den Registrierungsschlüssel für **App-Pfade** angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="da673-214">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="da673-215">Der Schlüssel für die **App-Pfade** wird beim Berechnen des dll-Suchpfades nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="da673-215">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="da673-216">Wenn **SafeDllSearchMode** deaktiviert ist, sieht die Alternative Such Reihenfolge wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="da673-216">If **SafeDllSearchMode** is disabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="da673-217">Das von *lpFileName* angegebene Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-217">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="da673-218">Das aktuelle Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-218">The current directory.</span></span>
3.  <span data-ttu-id="da673-219">Das Systemverzeichnis</span><span class="sxs-lookup"><span data-stu-id="da673-219">The system directory.</span></span> <span data-ttu-id="da673-220">Verwenden Sie die [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-220">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="da673-221">Das 16-Bit-System Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-221">The 16-bit system directory.</span></span> <span data-ttu-id="da673-222">Es gibt keine Funktion, die den Pfad dieses Verzeichnisses erhält, sondern durchsucht wird.</span><span class="sxs-lookup"><span data-stu-id="da673-222">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="da673-223">Das Windows-Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-223">The Windows directory.</span></span> <span data-ttu-id="da673-224">Verwenden Sie die [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-224">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="da673-225">Die Verzeichnisse, die in der PATH-Umgebungsvariablen aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="da673-225">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="da673-226">Beachten Sie, dass dies nicht den pro Anwendung-Pfad enthält, der durch den Registrierungsschlüssel für **App-Pfade** angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="da673-226">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="da673-227">Der Schlüssel für die **App-Pfade** wird beim Berechnen des dll-Suchpfades nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="da673-227">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="da673-228">Die [**setdlldirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) -Funktion unterstützt eine Alternative Such Reihenfolge, wenn der *lppathname* -Parameter einen Pfad angibt.</span><span class="sxs-lookup"><span data-stu-id="da673-228">The [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function supports an alternate search order if the *lpPathName* parameter specifies a path.</span></span> <span data-ttu-id="da673-229">Die Alternative Such Reihenfolge lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="da673-229">The alternate search order is as follows:</span></span>

1.  <span data-ttu-id="da673-230">Das Verzeichnis, in dem die Anwendung geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="da673-230">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="da673-231">Das Verzeichnis, das durch den *lppathname* -Parameter von [**setdlldirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="da673-231">The directory specified by the *lpPathName* parameter of [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span></span>
3.  <span data-ttu-id="da673-232">Das Systemverzeichnis</span><span class="sxs-lookup"><span data-stu-id="da673-232">The system directory.</span></span> <span data-ttu-id="da673-233">Verwenden Sie die [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-233">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span> <span data-ttu-id="da673-234">Der Name dieses Verzeichnisses lautet "System32".</span><span class="sxs-lookup"><span data-stu-id="da673-234">The name of this directory is System32.</span></span>
4.  <span data-ttu-id="da673-235">Das 16-Bit-System Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-235">The 16-bit system directory.</span></span> <span data-ttu-id="da673-236">Es gibt keine Funktion, die den Pfad dieses Verzeichnisses erhält, sondern durchsucht wird.</span><span class="sxs-lookup"><span data-stu-id="da673-236">There is no function that obtains the path of this directory, but it is searched.</span></span> <span data-ttu-id="da673-237">Der Name dieses Verzeichnisses ist System.</span><span class="sxs-lookup"><span data-stu-id="da673-237">The name of this directory is System.</span></span>
5.  <span data-ttu-id="da673-238">Das Windows-Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="da673-238">The Windows directory.</span></span> <span data-ttu-id="da673-239">Verwenden Sie die [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) -Funktion, um den Pfad zu diesem Verzeichnis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="da673-239">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="da673-240">Die Verzeichnisse, die in der PATH-Umgebungsvariablen aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="da673-240">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="da673-241">Beachten Sie, dass dies nicht den pro Anwendung-Pfad enthält, der durch den Registrierungsschlüssel für **App-Pfade** angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="da673-241">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="da673-242">Der Schlüssel für die **App-Pfade** wird beim Berechnen des dll-Suchpfades nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="da673-242">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="da673-243">Wenn der *lppathname* -Parameter eine leere Zeichenfolge ist, wird das aktuelle Verzeichnis aus der Such Reihenfolge entfernt.</span><span class="sxs-lookup"><span data-stu-id="da673-243">If the *lpPathName* parameter is an empty string, the call removes the current directory from the search order.</span></span>

<span data-ttu-id="da673-244">[**Setdlldirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) deaktiviert den sicheren DLL-Suchmodus, während sich das angegebene Verzeichnis im Suchpfad befindet.</span><span class="sxs-lookup"><span data-stu-id="da673-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) effectively disables safe DLL search mode while the specified directory is in the search path.</span></span> <span data-ttu-id="da673-245">Um den sicheren DLL-Suchmodus basierend auf dem Registrierungs Wert **SafeDllSearchMode** wiederherzustellen und das aktuelle Verzeichnis in der Such Reihenfolge wiederherzustellen, müssen Sie **setdlldirectory** mit *lppathname* als NULL aufrufen.</span><span class="sxs-lookup"><span data-stu-id="da673-245">To restore safe DLL search mode based on the **SafeDllSearchMode** registry value and restore the current directory to the search order, call **SetDllDirectory** with *lpPathName* as NULL.</span></span>

### <a name="search-order-using-load_library_search-flags"></a><span data-ttu-id="da673-246">Such Reihenfolge mithilfe von **\_ \_ Suchflags der Lade Bibliothek**</span><span class="sxs-lookup"><span data-stu-id="da673-246">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>

<span data-ttu-id="da673-247">Eine Anwendung kann eine Such Reihenfolge mithilfe eines oder mehrerer **\_ \_ Suchflags für die Auslastungs Bibliothek** mit der [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) -Funktion angeben.</span><span class="sxs-lookup"><span data-stu-id="da673-247">An application can specify a search order by using one or more **LOAD\_LIBRARY\_SEARCH** flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function.</span></span> <span data-ttu-id="da673-248">Eine Anwendung kann auch **Load \_ Library- \_ Suchflags** mit der [**setdefaultdlldirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) -Funktion verwenden, um eine DLL-Such Reihenfolge für einen Prozess einzurichten.</span><span class="sxs-lookup"><span data-stu-id="da673-248">An application can also use **LOAD\_LIBRARY\_SEARCH** flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process.</span></span> <span data-ttu-id="da673-249">Die Anwendung kann zusätzliche Verzeichnisse für die Such Reihenfolge der Prozess-DLL mithilfe der [**adddlldirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) -Funktion oder der [**setdlldirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) -Funktion angeben.</span><span class="sxs-lookup"><span data-stu-id="da673-249">The application can specify additional directories for the process DLL search order by using the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions.</span></span>

<span data-ttu-id="da673-250">Die Verzeichnisse, die durchsucht werden, richten sich nach den Flags, die mit [**setdefaultdlldirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) oder [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="da673-250">The directories that are searched depend on the flags specified with [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="da673-251">Wenn mehr als ein Flag verwendet wird, werden die entsprechenden Verzeichnisse in der folgenden Reihenfolge durchsucht:</span><span class="sxs-lookup"><span data-stu-id="da673-251">If more than one flag is used, the corresponding directories are searched in the following order:</span></span>

1.  <span data-ttu-id="da673-252">Das Verzeichnis, das die dll enthält (**Laden der \_ Bibliotheks \_ Suche \_ dll \_ Load \_ dir**).</span><span class="sxs-lookup"><span data-stu-id="da673-252">The directory that contains the DLL (**LOAD\_LIBRARY\_SEARCH\_DLL\_LOAD\_DIR**).</span></span> <span data-ttu-id="da673-253">Dieses Verzeichnis wird nur nach Abhängigkeiten der zu ladenden DLL durchsucht.</span><span class="sxs-lookup"><span data-stu-id="da673-253">This directory is searched only for dependencies of the DLL to be loaded.</span></span>
2.  <span data-ttu-id="da673-254">Das Anwendungsverzeichnis (**Anwendungsverzeichnis der \_ Bibliotheks \_ Suche \_ \_ Laden**).</span><span class="sxs-lookup"><span data-stu-id="da673-254">The application directory (**LOAD\_LIBRARY\_SEARCH\_APPLICATION\_DIR**).</span></span>
3.  <span data-ttu-id="da673-255">Pfade, die explizit mit der [**adddlldirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) -Funktion hinzugefügt wurden (**Load \_ Library \_ Search \_ User \_ dirs**) oder die Funktion " [**setdlldirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) ".</span><span class="sxs-lookup"><span data-stu-id="da673-255">Paths explicitly added with the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) function (**LOAD\_LIBRARY\_SEARCH\_USER\_DIRS**) or the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span> <span data-ttu-id="da673-256">Wenn mehr als ein Pfad hinzugefügt wurde, ist die Reihenfolge, in der die Pfade durchsucht werden, nicht angegeben.</span><span class="sxs-lookup"><span data-stu-id="da673-256">If more than one path has been added, the order in which the paths are searched is unspecified.</span></span>
4.  <span data-ttu-id="da673-257">Das System Verzeichnis (**Laden der \_ Bibliotheks \_ Suche \_ system32**).</span><span class="sxs-lookup"><span data-stu-id="da673-257">The System directory (**LOAD\_LIBRARY\_SEARCH\_SYSTEM32**).</span></span>

<span data-ttu-id="da673-258">Wenn die Anwendung [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) nicht mit einem **\_ \_ Suchflags für die Auslastungs Bibliothek** aufruft oder eine DLL-Such Reihenfolge für den Prozess festlegt, sucht das System entweder mithilfe der Standard Such Reihenfolge oder der alternativen Such Reihenfolge nach DLLs.</span><span class="sxs-lookup"><span data-stu-id="da673-258">If the application does not call [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with any **LOAD\_LIBRARY\_SEARCH** flags or establish a DLL search order for the process, the system searches for DLLs using either the standard search order or the alternate search order.</span></span>

## <a name="related-topics"></a><span data-ttu-id="da673-259">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="da673-259">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="da673-260">**Adddlldirectory**</span><span class="sxs-lookup"><span data-stu-id="da673-260">**AddDllDirectory**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory)
</dt> <dt>

[<span data-ttu-id="da673-261">Anwendungs Registrierung</span><span class="sxs-lookup"><span data-stu-id="da673-261">Application Registration</span></span>](/windows/desktop/shell/app-registration)
</dt> <dt>

[<span data-ttu-id="da673-262">Umleitung von Dynamic Link Library</span><span class="sxs-lookup"><span data-stu-id="da673-262">Dynamic-Link Library Redirection</span></span>](dynamic-link-library-redirection.md)
</dt> <dt>

[<span data-ttu-id="da673-263">Dynamic Link Library-Sicherheit</span><span class="sxs-lookup"><span data-stu-id="da673-263">Dynamic-Link Library Security</span></span>](dynamic-link-library-security.md)
</dt> <dt>

[<span data-ttu-id="da673-264">**LoadLibrary**</span><span class="sxs-lookup"><span data-stu-id="da673-264">**LoadLibrary**</span></span>](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)
</dt> <dt>

[<span data-ttu-id="da673-265">**LoadLibraryEx**</span><span class="sxs-lookup"><span data-stu-id="da673-265">**LoadLibraryEx**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)
</dt> <dt>

[<span data-ttu-id="da673-266">**LoadPackagedLibrary**</span><span class="sxs-lookup"><span data-stu-id="da673-266">**LoadPackagedLibrary**</span></span>](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary)
</dt> <dt>

[<span data-ttu-id="da673-267">**Setdefaultdlldirectories**</span><span class="sxs-lookup"><span data-stu-id="da673-267">**SetDefaultDllDirectories**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories)
</dt> <dt>

[<span data-ttu-id="da673-268">**Setdlldirectory**</span><span class="sxs-lookup"><span data-stu-id="da673-268">**SetDllDirectory**</span></span>](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)
</dt> <dt>

[<span data-ttu-id="da673-269">Parallele Komponenten</span><span class="sxs-lookup"><span data-stu-id="da673-269">Side-by-side Components</span></span>](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal)
</dt> </dl>

 

 