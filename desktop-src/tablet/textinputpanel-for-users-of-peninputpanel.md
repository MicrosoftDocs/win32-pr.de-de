---
description: Das Release von Windows Vista enthält ein neues Programmierbarkeitsobjekt für den Tablet PC-Eingabebereich, das eine neue Reihe von Möglichkeiten bietet, wie eine Anwendung den Eingabebereich verwenden und mit ihm interagieren kann.
ms.assetid: 539f41d3-5fb8-4e20-99ba-0d5af1f0cc54
title: TextInputPanel für Benutzer von PenInputPanel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9fd75fddb929dfd9e0e783aefc0d3f57743d23d5c35f23c845a9745660512f52
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/11/2021
ms.locfileid: "119222177"
---
# <a name="textinputpanel-for-users-of-peninputpanel"></a>TextInputPanel für Benutzer von PenInputPanel

Das Release von Windows Vista enthält ein neues Programmierbarkeitsobjekt für den Tablet PC-Eingabebereich, das eine neue Reihe von Möglichkeiten bietet, wie eine Anwendung den Eingabebereich verwenden und mit ihm interagieren kann. Zum ersten Mal können Anwendungsentwickler das In-Place-Eingabebereichssymbol so positionieren, dass es mit einem Textfeld ins Spiel steht, oder es in der Ecke einer Kundeneingabeoberfläche platzieren, um Zugriff auf einen alternativen Eingabemodus zu bieten. Entwickler haben die gleiche Kontrolle über die Positionierung, sobald das Eingabebereichssymbol in den Eingabebereich In-Place wurde. Dadurch kann sichergestellt werden, dass sich der In-Place-Eingabebereich nie mit wichtigen Benutzeroberflächenelementen im Layout einer Anwendung überschneidet oder sogar die Benutzeroberfläche einer Anwendung umflowen kann, um Platz für den In-Place-Eingabebereich zu schaffen und ihn dann im reservierten Bereich zu platzieren. Das neue Programmierbarkeitsmodell bietet jedoch Unterstützung für mehr als nur die Positionierung. Entwickler können jedoch auch den Eingabebereich, den Korrekturmodus und viele andere Eigenschaften des Eingabebereichs anpassen, um die Texteingabeerfahrung in einer Anwendung anzupassen. Schließlich ist es für eine Anwendung zum ersten Mal möglich, die Benutzereingabe zusätzlich zum erkannten Text zu empfangen, der Texteinfügungen aus dem Eingabebereich zugeordnet ist. Dies ermöglicht neue Anwendungsszenarien, einschließlich Ink in Änderungsnachverfolgungsprotokollen und ermöglicht Benutzern das Bearbeiten oder Anzeigen von Ink in der Anwendung. Diese neuen Programmierbarkeitsfeatures sind das direkte Ergebnis des Feedbacks, das Microsoft zur Entwicklergeschichte des Eingabebereichs erhalten hat, und stellen den ersten Schritt in Richtung einer engeren Integration von Anwendungen und des Eingabebereichs dar.

Um dieses angereicherte Programmierbarkeitsmodell für den Eingabebereich zur Verfügung zu stellen, wird der vorhandene Mechanismus für die programmgesteuerte Interaktion mit dem Eingabebereich, das [**PenInputPanel-Objekt,**](peninputpanel-class.md) veraltet und durch das neue [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) ersetzt. Das **TextInputPanel-Objekt** stellt nicht nur neue Programmierbarkeitsfeatures bereit, sondern bietet auch fast alle programmgesteuerten Funktionen des **PenInputPanel-Objekts.** Das **TextInputPanel-Objekt** ist sowohl in Windows Vista als auch im Windows Vista Software Developer Kit enthalten. Das **TextInputPanel-Objekt** ist nur mit dem Windows Vista-Eingabebereich kompatibel und kann nicht mit dem Windows XP Service Pack 2 oder einem älteren Eingabebereich verwendet werden. Anwendungen, die zuvor für die Verwendung des **PenInputPanel-Objekts** geschrieben wurden, funktionieren weiterhin mit dem Eingabebereich von Windows Vista. Beim Schreiben neuer Tablet-Anwendungen wird Entwicklern jedoch dringend empfohlen, das neue **TextInputPanel-Objekt** anstelle des veralteten **PenInputPanel-Objekts zu** verwenden.

Jede der Programmierbarkeitsoptionen des [**TextInputPanel-Objekts**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) kann pro Textfeld angewendet werden. Dies erfolgt durch Anfügen einer Instanz des **TextInputPanel-Objekts** mithilfe der [**AttachedEditWindow-Eigenschaft.**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_attachededitwindow) Die -Eigenschaft sollte auf den Fensterhandpunkt für das Textfeld festgelegt werden.

> [!Note]  
> : Einige der unten beschriebenen Eigenschaften und Methoden gelten, wenn sich der Eingabebereich im in-place-Interaktionsmodus befindet und nicht, wenn sich der Eingabebereich im unverankerten oder angedockten Interaktionsmodus befindet. Der Direktinteraktionsmodus ist das Verhalten des Eingabebereichs, bei dem das Platzieren des Fokus in einem bearbeitbaren Feld bewirkt, dass das Eingabebereichssymbol neben dem Feld angezeigt wird, und das Tippen auf das Eingabebereichssymbol bewirkt, dass der Eingabebereich erweitert wird. Die Methoden und Eigenschaften, die nur angewendet werden, wenn sich der Eingabebereich im in-place-Interaktionsmodus befindet, enthalten alle "InPlace" im Methoden- oder Eigenschaftennamen.

 

## <a name="control-of-input-panel-icon-and-input-panel-visibility"></a>Steuerung des Eingabebereichssymbols und der Sichtbarkeit des Eingabebereichs

Der erste Aspekt des Eingabebereichs, über den Anwendungsentwickler in Windows Vista mehr Kontrolle haben, ist die Sichtbarkeit. Mithilfe [**des TextInputPanel-Objekts**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) können Sie die Sichtbarkeit des Eingabebereichs In-Place auf drei Arten steuern. Mit einer Kombination aus Eigenschaften und Methoden kann eine Anwendung bestimmen, ob der In-Place-Eingabebereich angezeigt wird, wann der In-Place-Eingabebereich angezeigt wird und ob er zuerst als Eingabebereichssymbol oder sofort erweitert angezeigt wird. Indem diese Techniken zum Steuern der Sichtbarkeit mit den im nächsten Abschnitt erläuterten Techniken zum Steuern der Positionierung kombiniert werden, ist es für Anwendungsentwickler möglich, benutzerdefinierte Startpunkte und benutzerdefinierte Arbeitsabläufe mithilfe des In-Place-Eingabebereichs in einer Anwendung zu erstellen.

> [!Note]  
> Die in diesem Abschnitt erläuterten Eigenschaften und Methoden gelten nur, wenn sich der Eingabebereich im In-Place befindet.

 

Im Grunde genommen ist es möglich, zu verhindern, dass der In-Place-Eingabebereich und das Eingabebereichssymbol jemals angezeigt werden, indem Sie die [**InPlaceVisibleOnFocus-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplacevisibleonfocus) auf **FALSE festlegen.** Wenn sie auf **TRUE festgelegt** wird, wird sie auf den Standard des Systems zurückverwendet, der nach Möglichkeit angezeigt wird, vorausgesetzt, sie wurde nicht vom Benutzer oder Gruppenrichtlinie. Diese Option ist nützlich für Anwendungen, die benutzerdefinierte Texteingabelösungen als Alternative zum Eingabebereich enthalten.

Zweitens kann ein Entwickler durch Festlegen der [**DefaultInPlaceState-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) angeben, welcher in-place-Zustand gemäß angabe der [**InPlaceState-Enumeration**](/windows/win32/api/peninputpanel/ne-peninputpanel-inplacestate) der In-Place-Eingabebereich in angezeigt wird, wenn der Fokus in einem Textfeld platziert wird. Die Standardeinstellung des Systems ist, dass der In-Place-Eingabebereich im Hoverzustand angezeigt wird, es sei denn, der Eingabebereich ist bereits im erweiterten Zustand sichtbar. In diesem Fall bleibt der Eingabebereich erweitert. Das Festlegen der **DefaultInPlaceState-Eigenschaft** auf **InPlaceState \_ Expanded** bewirkt, dass der In-Place-Eingabebereich immer erweitert angezeigt wird, anstatt dass das Eingabebereichssymbol zuerst angezeigt wird und der Benutzer dann auf das Eingabebereichssymbol tippen muss, bevor der Eingabebereich erweitert wird. Die anderen beiden Optionen sind **InPlaceState \_ Auto**, das Standardverhalten des Systems, und **InPlaceState \_ HoverTarget,** wodurch immer das Eingabebereichssymbol angezeigt wird. Die Möglichkeit anzugeben, dass In-Place Eingabebereich immer erweitert angezeigt wird, ist neu mit dem [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) und nicht mit dem [**PenInputPanel-Objekt**](peninputpanel-class.md) möglich. Die folgende Abbildung zeigt das symbol In-Place Eingabebereich und erweiterte Zustände des Panels.

![Symbol für den in-place-Eingabebereich und erweiterte Zustände](images/8ce866b6-9a45-499f-a3d1-95a1d34d6402.jpg)

Zusätzlich zur Möglichkeit, den zustandsbehauptenden Zustand zu steuern, ist es auch möglich, dass ein Entwickler den in einem bestimmten Moment bestehenden Zustand durch Abrufen der [**CurrentInPlaceState-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) bestimmt. **CurrentInPlaceState** ist gleich [**DefaultInPlaceState,**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) wenn der Eingabebereich nicht sichtbar ist, es sei denn, **DefaultInPlaceState** ist **InPlaceState \_ Auto.** In diesem Fall wird **CurrentInPlaceState** zu **InPlaceState \_ HoverTarget.** Die [**InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  /  [**InPlaceVisibilityChanged-Ereignisse**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged) können verwendet werden, um den Sichtbarkeitszustand des In-Place Eingabebereichs nachverfolgung zu behalten.

Schließlich kann ein Entwickler erzwingen, dass In-Place Eingabebereich mithilfe der [**SetInPlaceVisibility-Methode aus-**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) oder einblendet. Wenn der Entwickler zuvor die [**DefaultInPlaceState-Eigenschaft festgelegt**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) hat, wird der Eingabebereich im angegebenen Zustand angezeigt, wenn die Eingabe erzwungen wird. Eine Anwendung darf den In-Place-Eingabebereich nur ausblenden oder anzeigen, wenn sich der Fokus derzeit im Fenster befindet, an das das [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) angefügt ist, und wenn der Benutzer den Eingabebereich nicht in einem anderen Interaktionsmodus geöffnet hat, z. B. angedockt oder unverankert. Die Möglichkeit, zu erzwingen, In-Place Eingabebereich auszublenden oder einblenden, ist auch neu mit dem **TextInputPanel-Objekt** und nicht mit dem [**PenInputPanel-Objekt**](peninputpanel-class.md) möglich.

Diese Optionen bieten Anwendungsentwicklern eine fein abgrenzende Kontrolle darüber, wann In-Place Eingabebereich und in welchem Zustand angezeigt wird. Durch Anpassen des standardbasierten Zustands und Steuern der direkt sichtbaren Sichtbarkeit unabhängig von Fokusänderungen kann ein Anwendungsentwickler einen benutzerdefinierten Arbeitsfluss erstellen, wenn der Eingabebereich auf Anwendungseinstellungen oder Benutzereingaben in einer Anwendung reagiert.

## <a name="absolute-positioning-of-input-panel-icon-and-input-panel"></a>Absolute Positionierung des Eingabebereichssymbols und des Eingabebereichs

Das überzeugendste neue Feature im [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) ist möglicherweise die absolute Positionierung des In-Place Eingabebereichs. Mit dieser neuen Funktion kann ein Anwendungsentwickler sicherstellen, dass sich der In-Place-Eingabebereich nicht mit einem oder mehr wichtigen visuellen Elementen in einem Anwendungslayout überschneidet. Mit dem [**PenInputPanel-Objekt**](peninputpanel-class.md) war es möglich, den In-Place-Eingabebereich relativ zu einem Textfeld basierend auf einem Offset zu positionieren. Der Eingabebereich passt sich jedoch weiterhin so an, dass er auf dem Bildschirm bleibt. Zum ersten Mal in Vista kann eine Anwendung den In-Place-Eingabebereich mithilfe von Bildschirmkoordinaten an einer absoluten Position positionieren. Darüber hinaus bleibt der Anwendungsentwickler für die Beibehaltung des Eingabebereichs auf dem Bildschirm verantwortlich. Dadurch wird die Wahrscheinlichkeit beseitigt, dass sich der Eingabebereich automatisch und scheinbar zufällig neu positioniert.

> [!Note]  
> Die in diesem Abschnitt erläuterten Eigenschaften und Methoden gelten nur, wenn sich der Eingabebereich im In-Place befindet.

 

Die beiden primären Methoden, die für die absolute Positionierung In-Place Eingabebereichs erforderlich sind, sind [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) und [**SetInPlaceHoverTargetPosition.**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition) Der erste wird verwendet, um den Speicherort des In-Place-Eingabebereichs anzugeben, und der zweite wird verwendet, um die Position des Eingabebereichssymbols für den Eingabebereich In-Place anzugeben. Wenn eine Anwendung nur den Speicherort des Eingabebereichssymbols und nicht den Speicherort des In-Place-Eingabebereichs festlegen soll, wird der In-Place-Eingabebereich an dem vom System festgelegten Standardspeicherort angezeigt. Wenn eine Anwendung den Eingabebereich In-Place, aber nicht das Eingabebereichssymbol neu positioniert, wird das Eingabebereichssymbol am Standardspeicherort angezeigt. Die Position wird in Bildschirmkoordinaten angegeben. Der tatsächliche Punkt, der positioniert wird, ist die obere linke Ecke des Eingabebereichssymbols oder des Eingabebereichs ohne erweitertes Korrekturkämm. Wenn das Korrektur comb erweitert wird, ändert sich der positionierte Punkt nicht. (Siehe Abbildung 2 unten) Es gibt keine Einschränkung, an welchen Stellen der In-Place-Eingabebereich und das In-Place-Eingabebereichssymbol platziert werden können, und es liegt in der Verantwortung der Anwendungen, die diese Methoden aufrufen, sie auf dem Bildschirm zu halten. Beide Methoden sind synchron, was bedeutet, dass die Positionierung erfolgt, bevor die Methode zurückgegeben wird. Wenn der Eingabebereich bereits im unverankerten oder angedockten Interaktionsmodus geöffnet ist, schlägt der Versuch fehl, den In-Place-Eingabebereich oder das symbol In-Place-Eingabebereich zu positionieren. Darüber hinaus führen die Methoden zu einem Fehler, wenn das an das [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) angefügte Fenster derzeit keinen Fokus hat.

Ein Aufruf von [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) oder [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition) führt nicht automatisch dazu, dass der In-Place-Eingabebereich oder das Eingabebereichssymbol angezeigt wird. Er legt einfach die Position für das nächste Mal fest, wenn sie angezeigt werden. Der [**Aufruf von SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) kann verwendet werden, um zu erzwingen, dass sie sofort anzeigen.

![Messungen des in-place-Eingabebereichs](images/0c67a77a-5d2f-489f-9357-b8a168d024d3.jpg)

Beim Positionieren des In-Place Eingabebereichs kann es ein wenig schwierig sein, zu berechnen, ob er vom Bildschirm aus geht. Um diesen Prozess zu vereinfachen, gibt es mehrere Eigenschaften des [**TextInputPanel-Objekts,**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) die zur Vereinfachung dieses Prozesses verwendet werden können. Zusammen können diese Eigenschaften und das Ereignis verwendet werden, um die genaue Größe des Eingabebereichs In-Place in allen Zustände zu bestimmen:

-   [**InPlaceBoundingRectangle:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle)Diese Eigenschaft stellt das umgebundene Rechteck für den In-Place-Eingabebereich zur Auswahl, wenn der größte Eingabebereich für die aktuelle Eingabesprache angezeigt wird. Wenn das Schreib- oder Zeichenpad für den größten Eingabebereich bestimmt wird, wird die Höhe der Schaltfläche Einfügen eingeschlossen. Sie enthält nicht die Höhe des Korrektur comb. Wenn der In-Place-Eingabebereich automatisch zunimmt, wird [**das InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging)  /  [**InPlaceSizeChanged-Ereignispaar**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged) ausgelöst, und der Wert dieser Eigenschaft wird aktualisiert, um den zusätzlichen Schreibbereich oder die Schreibzeile einzuaufnahme.
-   [**PopUpCorrectionHeight:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_popupcorrectionheight)Diese Eigenschaft gibt die Höhe des Korrektur comb nach dem Einfügen an, wenn es über dem Eingabebereich positioniert ist. Um die vollständige Höhe des In-Place-Eingabebereichs mit dem nach dem Einfügen angezeigten Korrektur comb zu erhalten, fügen Sie die Höhe des [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) dem **PopUpCorrectionHeight** hinzu.

Als einfachere Alternative zum Festlegen der absoluten Position des In-Place-Eingabebereichs und des Eingabebereichssymbols kann eine Anwendung einfach angeben, ob der In-Place-Eingabebereich standardmäßig über oder unter einem Texteingabefeld angezeigt wird. Auf diese Weise ist es möglich, sich überlappende Elemente im Anwendungslayout auf lose kontrollierte Weise zu vermeiden. Hierzu legt die Anwendung [**PreferredInPlaceDirection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_preferredinplacedirection) auf **InPlaceDirection \_ Bottom** oder **InPlaceDirection \_ Top fest.** Die -Eigenschaft ist eine Einstellung, da der In-Place-Eingabebereich die von der Anwendung festgelegten Einstellungen überschreibt, wenn dies erforderlich ist, um den Eingabebereich auf dem Bildschirm zu halten. Die Standardeinstellung des Systems besteht in der Position In-Place Eingabebereichs unterhalb eines Textfelds, sofern möglich, und andernfalls, um es darüber zu positionieren. Wenn Sie **PreferredInPlaceDirection auf** **InPlaceDirection \_ festlegen,** wird die Standardeinstellung des Systems wiederhergestellt.

Zusammen bieten die Eigenschaften, Methoden und Ereignisse des [**TextInputPanel-Objekts**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) Entwicklern die erforderliche Kontrolle über den In-Place-Eingabebereich, um den In-Place-Eingabebereich und das Eingabebereichssymbol in einem Anwendungslayout so zu positionieren, dass sie den Layoutfluss nicht unterbrechen und in einigen Fällen integriert erscheinen. Diese neue Steuerungsebene ist ein großer Vorteil beim Design von Tablet-Anwendungen.

## <a name="access-to-the-three-input-panel-areas-writing-pad-character-pad-and-keyboard"></a>Zugriff auf die drei Eingabebereichsbereiche: Schreibpad, Zeichenpad und Tastatur

Der Eingabebereich verfügt über drei Eingabebereiche: Schreibpad, Zeichenpad und Tastatur. Mithilfe [**des TextInputPanel-Objekts**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) kann eine Anwendung den Standardeingabebereich angeben, der dem Benutzer angezeigt wird, wenn der Eingabebereich geöffnet wird. Der Hauptgrund dafür ist, dass eine Anwendung den Eingabebereich mit dem Eingabetyp eines bestimmten Felds koppelt. Beispielsweise eignet sich das Schreibpad wahrscheinlich am besten zum Ausfüllen eines Kommentarfelds, aber die Tastatur ist möglicherweise bequemer für die Eingabe einer Produktseriennummer, die sowohl Zahlen als auch Buchstaben enthält. Um den Standardeingabebereich anzugeben, legt eine Anwendung die [**DefaultInputArea-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) auf einen der drei Eingabebereiche fest, wie von der [**PanelInputArea-Enumeration**](/windows/win32/api/peninputpanel/ne-peninputpanel-panelinputarea) definiert. Die folgende Abbildung zeigt die drei Eingabebereiche.

![Eingabebereich für Schreib-, Zeichen- und Tastatureingabe](images/3f1e3d03-88b9-478c-b12d-00d341bc8d5c.jpg)

Der Standardeingabebereich des Systems ist das Schreibpad für Englisch, Französisch, Deutsch, Spanisch, Italienisch, Portugiesisch, Niederländisch und alle anderen lateinischen Eingabesprachen. Für die ostasiatischen Eingabesprachen, einschließlich Japanisch, Chinesisch und Koreanisch, ist der Standardeingabebereich das Zeichenpad. Wenn der Benutzer jedoch den Eingabebereich ändert, überschreibt er den Standardeingabebereich für die aktuelle Eingabesprache und wird als neuer Standardwert für diese Eingabesprache gespeichert. Die Tastatur ist der Standardeingabebereich für Kennwortfelder, unabhängig von der Eingabesprache, es sei denn, die Kennwortsicherheit wurde vom Benutzer oder der Gruppenrichtlinie deaktiviert. In allen Fällen überschreibt das Festlegen des Standardeingabebereichsbereichs programmgesteuert die Systemeinstellung, es sei denn, das aktuelle Feld ist ein Kennwortfeld, oder die Handschrifterkennung für die aktuelle Eingabesprache unterstützt den programmgesteuert ausgewählten Eingabebereich nicht. Wenn Sie [**die DefaultInputArea-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) auf **InPlaceDirection \_ Auto festlegen,** werden die Standardeinstellungen des Systems wiederhergestellt.

Unabhängig davon, ob der Standardeingabebereich programmgesteuert festgelegt wurde, hat der Benutzer die Möglichkeit, den aktuellen Eingabebereich zu ändern, sobald der Eingabebereich geöffnet ist. Nachdem der Benutzer den aktuellen Eingabebereich geändert hat, wird die Benutzerauswahl beibehalten, bis der Eingabebereich geschlossen wird oder der Benutzer die Auswahl erneut ändert. Nachdem der Eingabebereich geschlossen und erneut geöffnet wurde, wird der standardmäßige Eingabebereich programmgesteuert erneut angezeigt.

Da sich der aktuelle Eingabebereichsbereich möglicherweise vom Standardeingabebereichsbereich unterscheidet, kann eine Anwendung die [**CurrentInputArea-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea) abfragen, um zu bestimmen, welcher Eingabebereich derzeit sichtbar ist. Wenn der Eingabebereich derzeit nicht sichtbar ist, entspricht der aktuelle Eingabebereich dem Standardeingabebereich. Die **CurrentInputArea-Eigenschaft** ist nie gleich **PanelInputArea \_ Auto.** Wenn [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) gleich **PanelInputArea \_ Auto** ist, entspricht **CurrentInputArea** dem letzten angezeigten Eingabebereich oder dem Systemstandard für die aktuelle Eingabesprache, wenn der Eingabebereich nie angezeigt wurde.

Der Hauptunterschied zwischen der Unterstützung des Eingabebereichs im [**PenInputPanel-Objekt**](peninputpanel-class.md) und dem [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) besteht darin, dass die Anwendung jetzt die Möglichkeit hat, den Standardeingabebereich zusätzlich zum Schreibpad und der Tastatur auf das Zeichenpad festzulegen.

Mithilfe der oben genannten Eigenschaften kann eine Anwendung den Eingabebereich des Eingabebereichs steuern, der in verschiedenen Feldern angezeigt wird, und die Texteingabeerfahrung des Benutzers optimieren. Darüber hinaus kann die Anwendung das Bewusstsein für den aktuellen Eingabebereich aufrechterhalten und bedingte Entscheidungen darüber treffen, welcher Eingabebereich am besten für die aktuelle Benutzeraufgabe geeignet ist.

## <a name="detailed-information-about-input-panels-interaction-mode"></a>Ausführliche Informationen zum Interaktionsmodus des Eingabebereichs

Zusätzlich zur Erkennung des aktuellen Eingabebereichs des Eingabebereichs ist es auch möglich, den aktuellen Interaktionsmodus zu erkennen: "In-Place", "Docked" oder "Floating". Es kann wichtig sein, dass die Anwendung den aktuellen Interaktionsmodus kennt, um zu verstehen, wie der Benutzer mit der Anwendung interagiert, oder weil einige Methoden und Eigenschaften des [**TextInputPanel-Objekts**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) nur für den In-Place Interaktionsmodus gelten. Beispielsweise werden in der Anwendung vorhandene Benutzeroberflächenelemente neu geschaltet, und anschließend wird der In-Place Eingabebereich über einen leeren Bereich in den Benutzeroberflächen positioniert, um sicherzustellen, dass der aktuelle Interaktionsmodus vorhanden ist, bevor Anpassungen vorgenommen werden.

![Eingabebereichsmodi "docked", "floating" und "in pace"](images/98c8e96b-99b2-477a-9843-33b1fae7e75b.jpg)

Die [**CurrentInteractionMode-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinteractionmode) des [**TextInputPanel-Objekts**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) speichert den aktuellen Interaktionsmodus, wie vom Benutzer ausgewählt. Die möglichen Modi werden von der [**InteractionMode-Enumeration**](/windows/win32/api/peninputpanel/ne-peninputpanel-interactionmode) wie folgt definiert:

**InteractionMode \_ InPlace:** Im In-Place Interaktionsmodus wird der Eingabebereich neben dem Texteingabefeld angezeigt, das derzeit den Fokus besitzt. Standardmäßig wird das In-Place Eingabebereichssymbol angezeigt, wenn eine Einfügemarke in einem Texteingabefeld platziert wird. Wenn Sie auf das Eingabebereichssymbol tippen, wird der Eingabebereich erweitert. Der In-Place Eingabebereich ist nur sichtbar, wenn sich eine Einfügemarke in einem bearbeitbaren Feld befindet.

InteractionMode \_ Floating: Der Unverankerte Interaktionsmodus ähnelt dem InPlace-Interaktionsmodus, mit der Ausnahme, dass er nicht an eine Einfügemarke gebunden ist. Der Floating Input Panel wird geöffnet, indem Sie auf die Registerkarte Eingabebereich tippen, die standardmäßig am linken Rand des Bildschirms angezeigt wird. Sowohl der Unverankerte Eingabebereich als auch die Registerkarte Eingabebereich können vom Benutzer gezogen und neu positioniert werden. Im Gleitkommamodus werden die Positionierung und das Steuerelement des Eingabebereichs vollständig dem Benutzer überlassen.

InteractionMode \_ DockedTop: Im Docked-Top Interaktionsmodus wird der Eingabebereich oben auf dem Bildschirm angezeigt, und die Größe des aktiven Desktops wird geändert, sodass sich der Eingabebereich nicht mit anderen Fenstern oder Benutzeroberflächenelementen überschneidet. Im andockten Modus kann der Eingabebereich nicht gezogen oder verschoben werden.

InteractionMode \_ DockedBottom: Der Docked-Bottom Interaktionsmodus entspricht dem Docked-Top Modus, mit ausnahme des Eingabebereichs, der unten auf dem Bildschirm angezeigt wird.

Wenn der Eingabebereich nicht angezeigt wird, ist der aktuelle Interaktionsmodus "In-Place".

Das Veröffentlichen des aktuellen Interaktionsmodells ist eine weitere Möglichkeit, mit der das [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) mehr Informationen zum Status des Eingabebereichs bereitstellt, als in jeder vorherigen Version verfügbar war.

## <a name="detailed-information-about-input-panels-correction-mode"></a>Ausführliche Informationen zum Korrekturmodus des Eingabebereichs

Der letzte Aspekt des Eingabebereichs, den das [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) Ihnen detaillierte Informationen über und die Steuerung von bietet, ist der Korrekturmodus. Wenn Sie den Korrekturmodus kennen, können Anwendungen die aktuelle Größe des Eingabebereichs bestimmen. Die Steuerung, wie die Korrektur nach der Einfügung in einer Anwendung erweitert wird, ist eine Möglichkeit, die Korrektur in einer Anwendung anzupassen.

Es gibt zwei grundlegende Modi, in denen das Korrekturknaufzeichen angezeigt werden kann: Voreinfügung und Nacheinfügung. Das Voreinfügungskorrektur-Komma wird verwendet, um Text vor dem Einfügen in eine Anwendung zu korrigieren. Sie wird aktiviert, indem Sie auf den ausstehenden Text tippen, der unterhalb der Baseline im Schreibpad als Benutzerinks angezeigt wird. Das Nacheinfügungskorrektur-Comb wird verwendet, um Text zu korrigieren, nachdem er in eine Anwendung eingefügt wurde. Sie wird aktiviert, indem sie die Einfügemarke in einfügt oder zuvor eingefügten Text auswählt. Über die beiden grundlegenden Modi hinaus gibt es mehrere Variationen dazu, wie das Nacheinfügungskorrektur-Komma angezeigt werden kann. Zuerst kann er entweder oberhalb oder unterhalb des Eingabebereichs und dann reduziert oder erweitert angezeigt werden. Im reduzierten Zustand zeigt der Nacheinfügungskorrektur-Komma nur eine Liste von Alternativen an. Im erweiterten Zustand enthält er sowohl die Alternativen als auch einen Bereich zum erneuten Schreiben des Worts.

![Korrektur des Eingabebereichs "Comb", "Pre" und "Post Insert"](images/6cc627de-fc15-4721-9f6a-7e1517d9e650.jpg)

Mit [**der CurrentCorrectionMode-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode) kann eine Anwendung die aktuelle Konfiguration des Korrektur-Comb bestimmen. Die möglichen Werte dieser Eigenschaft, wie von den [**CorrectionMode-Enumerationen**](/windows/win32/api/peninputpanel/ne-peninputpanel-correctionmode) definiert, sind: **NotVisible**, **PreInsertion**, **PostInsertionCollapsed** und **PostInsertionExpanded**. Wenn kein Eingabebereich oder Korrektur-Comb angezeigt wird, ist **CurrentCorrectionMode** **NotVisible.**

Standardmäßig zeigt das System das Nacheinfügungskorrektur-Komma erweitert an, wenn den richtigen Text auswählt, und zeigt ihn reduziert an, wenn die Einfügemarke in korrektierbarem Text platziert wird. Eine Anwendung kann angeben, wo der Comb nach der Einfügungskorrektur immer erweitert angezeigt werden soll, indem die [**ExpandPostInsertionCorrection-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_expandpostinsertioncorrection) auf **TRUE** festgelegt wird. Der Standardwert des Systems ist **FALSE.** Wenn die **ExpandPostInsertionCorrection-Eigenschaft** in Verbindung mit der [**IHandWrittenTextInsertion-Schnittstelle**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) verwendet wird, kann ein Anwendungsentwickler Anwendungen kostengünstige Korrekturunterstützung hinzufügen, die sie nicht automatisch erhalten würde.

Das Nachverfolgen und Steuern des Korrekturzustands des Eingabebereichs ist eines der vielen neuen Features des [**TextInputPanel-Objekts,**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) die eine strengere Integration des Eingabebereichs und der Anwendung ermöglichen.

## <a name="event-notification-before-and-after-the-event-occurs"></a>Ereignisbenachrichtigung vor und nach dem Auftreten des Ereignisses

Ein weiterer Aspekt der Programmierbarkeit des Eingabebereichs, der im [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) erheblich verbessert wird, ist das Ereignismodell. Anstatt jetzt nur Ereignisse zu auslösen, die eine Änderung des Zustands des Eingabebereichs signalisieren, nachdem die Änderung aufgetreten ist, werden vor und nach der Änderung separate Ereignisse gesendet. Ereignisse, die den Beginn eines Ereignisses signalisieren, enthalten aktuelle Tense-Verben wie "Changing" oder "Inserting", während Ereignisse, die den Abschluss eines Ereignisses signalisieren, frühere Tense-Verben wie "Changed" oder "Inserted" enthalten.

Dieses Ereignismodell ermöglicht es einer Anwendung, vor oder während des Auftretens auf eine Änderung zu reagieren. Der Eingabebereich wird daran gehindert, mit einer Änderung fortzufahren oder nach der Änderung fortzufahren, bis die Ereignishandler für alle Ereignisse abgeschlossen sind. Diese Ereignisse sind synchron, und auf diese Weise kann eine Anwendung eine Änderung verzögern, bis die Reaktion abgeschlossen ist. Die Zeit, in der ein Ereignishandler den Eingabebereich ausführt, kann für den Benutzer jedoch nicht mehr zugänglich sein und möglicherweise hängen bleiben. Daher ist es wichtig, dass der Ereignishandler gut funktioniert. Es ist jedoch nicht möglich, dass eine Anwendung ein Ereignis verhindert oder abbricht. Alle Ereignisparameter sind schreibgeschützt. Im Folgenden finden Sie eine Beschreibung der sechs Ereignispaare des [**TextInputPanel-Objekts:**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel)

-   [**InPlaceStateChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanging)  /  [**InPlaceStateChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanged)Benachrichtigung, dass der zustandsbehindende Zustand gerade von "Hover" zu "Erweitert" wechselt oder umgekehrt. Parameter sind der neue und der alte zustandsbetreffende Zustand. Wird mit einer Änderung des Werts der [**CurrentInPlaceState-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) vertauscht.
-   [**InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging)  /  [**InPlaceSizeChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged)Wird angegeben, wenn sich die Größe des In-Place Eingabebereichs aufgrund einer Änderung der Benutzergröße, der automatischen Vergrößerung oder einer Änderung des Eingabebereichs ändert oder geändert wird. Parameter sind das neue und das alte umgrenzende Rechteck. Schlägt mit einer Änderung des Werts der [**InPlaceBoundingRectangle-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) ein.
-   [**InputAreaChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanging)  /  [**InputAreaChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanged)Gibt an, wann sich der Eingabebereich des Eingabebereichs ändert oder sich von in den anderen der drei möglichen Eingabebereiche geändert hat: Schreibpad, Zeichenpad oder Tastatur. Parameter sind der neue und der alte Eingabebereich. Fällt mit einer Änderung des Werts der [**CurrentInputArea-Eigenschaft**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea) zusammen
-   [**CorrectionModeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanging)  /  [**CorrectionModeChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanged)Benachrichtigung, dass sich der Korrekturmodus ändert oder geändert wird. Mögliche Korrekturmodi sind: nicht sichtbar, Voreinfügung, Nacheinfügung reduziert und Nacheinfügung erweitert. Parameter sind der neue und der alte Korrekturmodus. Entspricht einer Änderung des Werts der [**CurrentCorrectionMode-Eigenschaft.**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode)
-   [**InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  /  [**InPlaceVisibilityChanged:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged)Gibt an, wann sich die Sichtbarkeit des In-Place Eingabebereichs ändert oder geändert wird. Parameter sind die neue und die alte Sichtbarkeit. Eine neue Sichtbarkeit von **FALSE** bedeutet, dass der In-Place Eingabebereich nicht geöffnet ist, aber nicht verhindert, dass der Eingabebereich im Unverankerten oder docked-Interaktionsmodus sichtbar ist.
-   [**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting)  /  [**TextInserted:**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted)Gibt an, wann Text eingefügt oder aus dem Eingabebereich eingefügt wurde. Parameter ist ein Array von [**InkDisp-Objekten,**](inkdisp-class.md) die jeweils eine Zeile der Ink- und Text enthalten, aus denen die Einfügung besteht. Weitere Informationen zu diesem Ereignis finden Sie im nächsten Abschnitt.

Diese Ereignisse bieten Anwendungen wichtige Informationen zu Änderungen im Eingabebereich und ermöglichen es ihnen, entsprechend zu reagieren. Auch hier stellt die Änderung des Eingabebereich-Ereignismodells einen Schritt hin zu einer besseren Interaktion zwischen Anwendungen und dem Eingabebereich dar.

## <a name="support-for-collecting-the-ink-and-text-entered-in-input-panel"></a>Unterstützung für das Erfassen von Ink- und Texteingaben im Eingabebereich

Nicht zuletzt ist ein sehr leistungsfähiges neues Feature des [**TextInputPanel-Objekts**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) die Möglichkeit, das Freihandobjekt für Text, der über den Eingabebereich eingegeben wird, aus dem Eingabebereich abzurufen, wenn der Text in eine Anwendung eingefügt wird. Dies war ein häufig angefordertes Feature für die Änderungsnachverfolgung und Datensatzaufwahrung. Außerdem können Anwendungen die Ink in ihrer Benutzeroberfläche entweder als statisches Element oder mit einer benutzerdefinierten Benutzeroberfläche verwenden.

Um das [**InkDisp-Objekt**](inkdisp-class.md) für Text zu empfangen, der über den Eingabebereich eingegeben wird, muss sich eine Anwendung registrieren, um die vom [**TextInputPanel-Objekt**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) generierten [**TextInserting-**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting) oder [**TextInserted-Ereignisse**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted) zu empfangen. Das **TextInserting-Ereignis** wird unmittelbar vor dem Einfügen von Text aus dem Eingabebereich in eine Anwendung ausgelöst, und der Text wird erst eingefügt, wenn alle Ereignishandler abgeschlossen sind. Das **TextInserted-Ereignis** wird unmittelbar nach dem Einfügen des Tests ausgelöst. Der einzige Parameter für das **TextInserting-** und **das TextInserted-Ereignis** ist ein Array von **InkDisp-Objekten,** das ein **InkDisp-Objekt** für jede aus dem Eingabebereich eingefügte Textzeile enthält. Hinweis: Der Eingabebereich ist während der Ausführung der Ereignishandler inaktiv und kann für den Benutzer hängen bleiben. Daher ist es wichtig, diese Ereignishandler einfach zu gestalten und sicherzustellen, dass sie schnell ausgeführt werden. Darüber hinaus sollte eine Anwendung keinen Handler für dieses Ereignis erstellen, es sei denn, sie hat eine bestimmte Verwendung für die Informationen, da dafür Leistungskosten entstehen. Der Eingabebereich marshallt die Ink-Daten nur, wenn eine Anwendung die Daten anfordert. Andernfalls kann der Eingabebereich diesen kostspieligen Vorgang überspringen. Die Parameter der Ereignisse **TextInserting** und **TextInserted** sind schreibgeschützt. Das bedeutet, dass Anwendungen eingefügten Text nicht ändern können, bevor er in die Anwendung eingefügt wird.

Die Möglichkeiten, was Anwendungen mit dieser neuen Funktionalität tun können, sind umfangreich und können nicht einfacher zu verwenden sein. Die Erfassung erkannten Texts und Freihandeingaben, die über den Eingabebereich eingegeben wurden, durch Anwendungen zuzulassen, ist eine weitere Möglichkeit, wie die Entwicklerstory des Eingabebereichs in Windows Vista verbessert wird.

## <a name="conclusion"></a>Zusammenfassung

Insgesamt wurde die Programmierbarkeit des Tablet PC-Eingabebereichs durch die Einführung des [**TextInputPanel-Objekts**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) in Windows Vista erheblich verbessert. Mit dem **TextInputPanel-Objekt** haben Anwendungsentwickler mehr Kontrolle und weitere Informationen zum Zustandseingabebereich in der vorherigen Version. Daher wird Anwendungsentwicklern, die neue Tablet PC-Anwendungen erstellen oder vorhandene Anwendungen aktualisieren, dringend empfohlen, anstelle des jetzt veralteten [**PenInputPanel-Objekts das TextInputPanel-Objekt**](peninputpanel-class.md) zu verwenden.  Darüber hinaus ermöglichen die Unterstützung neuer Features wie die absolute Positionierung des Eingabebereichs und des Eingabebereichssymbols sowie die Möglichkeit, dass die Anwendung über den Eingabebereich eingegebenen Erkennungstext und Ink empfangen kann, neue Anwendungsfunktionen und -szenarien. Die Einbeziehung dieser Features und mehrerer anderer Funktionen ist eine direkte Reaktion auf Entwicklerfeedback und markiert die ersten Schritte zur vollständigen Integration des Eingabebereichs in Tablet PC-Anwendungen. Letztendlich ist die Erweiterung der Tablet PC-Anwendungsfunktionalität sowohl für Anwendungsentwickler als auch für die Tablet PC-Plattform ein großer Gewinn.

 

 



