---
description: Der Eingabebereich des Microsoft Tablet PCs ist ein leistungsfähiges Tool zum Eingeben von Hand schriftlichem Text mit einem Stift und zum Korrigieren von Text ohne Tastatur.
ms.assetid: c45ac1b5-7713-4bcb-a130-4692cff99aa2
title: Aktivieren der Text Korrektur für benutzerdefinierte frei Hand Sammler
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb4dee4c7dfee1489cd002848c496be41f73d953
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104567048"
---
# <a name="enabling-text-correction-for-custom-ink-collectors"></a><span data-ttu-id="4b083-103">Aktivieren der Text Korrektur für benutzerdefinierte frei Hand Sammler</span><span class="sxs-lookup"><span data-stu-id="4b083-103">Enabling Text Correction for Custom Ink Collectors</span></span>

<span data-ttu-id="4b083-104">Der Eingabebereich des Microsoft Tablet PCs ist ein leistungsfähiges Tool zum Eingeben von Hand schriftlichem Text mit einem Stift und zum Korrigieren von Text ohne Tastatur.</span><span class="sxs-lookup"><span data-stu-id="4b083-104">Microsoft Tablet PC Input Panel is a powerful tool for entering handwritten text with a pen and correcting text without the use of a keyboard.</span></span> <span data-ttu-id="4b083-105">Wenn Sie den Eingabebereich verwenden, gibt ein Benutzer Text von der Handschrift in die Eingabe Flächen des Eingabe Bereichs ein, was bewirkt, dass der Eingabebereich die Handschrift des Benutzers als Text erkennt.</span><span class="sxs-lookup"><span data-stu-id="4b083-105">When using Input Panel, a user enters text by handwriting onto Input Panel's inking surfaces, which causes Input Panel to recognize the user's handwriting as text.</span></span> <span data-ttu-id="4b083-106">Nachdem der Text erkannt wurde, tippt der Benutzer in den Eingabebereich einfügen, um den Text in eine Anwendung oder ein Dokument einzufügen.</span><span class="sxs-lookup"><span data-stu-id="4b083-106">Once the text has been recognized, the user taps Insert on Input Panel to insert the text into an application or document.</span></span> <span data-ttu-id="4b083-107">Vor dem Einfügen des Texts hat ein Benutzer Zugriff auf eine Reihe von Korrektur Tools im Eingabebereich.</span><span class="sxs-lookup"><span data-stu-id="4b083-107">Prior to inserting the text, a user has access to a set of correction tools in Input Panel.</span></span> <span data-ttu-id="4b083-108">Dazu zählen die Auswahl eines alternativen Erkennungs Ergebnisses, die Möglichkeit zum Umschreiben eines einzelnen Zeichens oder sogar das grundlegende Wort zum Neuschreiben.</span><span class="sxs-lookup"><span data-stu-id="4b083-108">These include the selection of an alternative recognition result, the ability to rewrite a single character, or even to scratch-out the entire word and rewrite.</span></span> <span data-ttu-id="4b083-109">Diese Korrektur Tools ermöglichen es Benutzern, Erkennungs Fehler und menschliche Fehler zu korrigieren.</span><span class="sxs-lookup"><span data-stu-id="4b083-109">These correction tools enable a user to correct both recognition errors and human errors.</span></span>

<span data-ttu-id="4b083-110">Sobald der mit dem Eingabebereich eingegebene Text im Dokument enthalten ist, haben die Benutzer Zugriff auf dieselbe Korrektur Funktionalität, die vor dem Einfügen in Windows- [Text Dienste-Framework](/windows/desktop/TSF/text-services-framework)-basierte und Text Dienste-aktivierte Anwendungen verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="4b083-110">Once the text entered using Input Panel is in the document, users have access to the same correction functionality that is available prior to insertion in Windows [Text Services Framework](/windows/desktop/TSF/text-services-framework)-based and Text Services-enabled applications.</span></span> <span data-ttu-id="4b083-111">Ab Microsoft Windows XP Service Pack 2 Tablet PC Edition sind alle Rich-Edit-Anwendungen standardmäßig Text Dienste-aktiviert, und ab Windows Vista sind HTML-Anwendungen standardmäßig Text Dienste-aktiviert.</span><span class="sxs-lookup"><span data-stu-id="4b083-111">Starting in Microsoft Windows XP Service Pack 2 Tablet PC Edition all Rich Edit applications are Text Services-enabled by default, and starting in Windows Vista, HTML applications are Text Services-enabled by default.</span></span> <span data-ttu-id="4b083-112">Die Korrektur in Dokumenten ist nur in Text Dienst basierten und aktivierten Anwendungen verfügbar. Dies liegt daran, dass der Eingabebereich vom Text Dienst abhängig ist, um zugehörige Texteigenschaften zu speichern, einschließlich frei Hand Objekten und Erkennungs Alternativen, um die Korrektur in Dokumenten zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="4b083-112">In-document correction is only available in Text Service based and enabled applications; this is because Input Panel is dependent on Text Service's capability to store associated text properties, including ink objects and recognition alternates, in order to provide in-document correction.</span></span>

![Tablet PC-Eingabebereich mit Textkorrektur](images/a0dced5e-16de-410b-965f-5d97d297cee5.jpg)

<span data-ttu-id="4b083-114">Es gibt jedoch zahlreiche Szenarios, darunter das Korrigieren der Spracherkennung oder das Korrigieren von typisiertem Text, der nicht mit dem Text Eintrag über den Eingabebereich beginnt, in dem die Dokument Korrektur jedoch für Tablet PC-Benutzer äußerst nützlich sein kann.</span><span class="sxs-lookup"><span data-stu-id="4b083-114">There are, however, numerous scenarios, including correcting speech recognition or correcting typed text on the go, that do not start with text entry using Input Panel but in which in-document correction can be extremely useful for Tablet PC users.</span></span> <span data-ttu-id="4b083-115">Ein gutes Beispiel hierfür sind Anwendungen, die benutzerdefinierte Textflächen zum Eingeben von Text mithilfe eines Stifts bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="4b083-115">A prime example is in applications that provide custom inking surfaces for entering text using a pen.</span></span> <span data-ttu-id="4b083-116">Benutzerdefinierte Erfassungs Oberflächen sind eine hervorragend Möglichkeit für Anwendungen, speziell für die Text Eintrags Aufgaben der einzelnen Anwendungen individuell angepasste Funktionen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="4b083-116">Custom inking surfaces are a great way for applications to provide uniquely tailored functionality specific to the text entry tasks of each application.</span></span> <span data-ttu-id="4b083-117">Außerdem stellen benutzerdefinierte Freihand-Oberflächen eine vollständig integrierte Tablet PC-Benutzeroberfläche bereit. Dadurch wird deutlich, dass der Stift ein erstklassiges Eingabegerät in Anwendungen ist, die diese enthalten.</span><span class="sxs-lookup"><span data-stu-id="4b083-117">Additionally, custom inking surfaces provide a fully integrated Tablet PC user experience, which makes it clear the pen is a first class input device in applications that contain them.</span></span> <span data-ttu-id="4b083-118">Anwendungen, die benutzerdefinierte Erstellungs Oberflächen bereitstellen, können jedoch möglicherweise nicht die gleiche Ebene der Korrektur Unterstützung bereitstellen, die im Eingabebereich der Dokumenten Korrektur verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="4b083-118">However, applications that provide custom inking surfaces may not allow or may not be able to provide the same level of correction support that is available from Input Panel in-document correction.</span></span>

![benutzerdefinierter Ink-Collector](images/b6797b12-dda6-44c4-87f4-570fe0c23f3a.jpg)

<span data-ttu-id="4b083-120">Auf Text Services basierende oder aktivierte Anwendungen, in denen die Korrektur von Text, der nicht über den Eingabebereich eingegeben wurde, hilfreich ist, können die [**ihandwrite-textinsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) -API ([Microsoft. TextInput. handschreittentextinsertion](/previous-versions/ms573516(v=vs.100)) -API) von Eingabe Bereichen in verwaltetem Code verwendet werden, um die Korrektur in Dokumenten für Text zu aktivieren</span><span class="sxs-lookup"><span data-stu-id="4b083-120">Text Services based or enabled applications in which in-document correction is useful for correction of text not entered using Input Panel are able to use Input Panel's [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API ([Microsoft.TextInput.HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100)) class in managed code)to enable in-document correction for text entered by other means.</span></span> <span data-ttu-id="4b083-121">Auf diese Weise können Anwendungen eine leistungsstarke Korrektur Unterstützung für Ihre benutzerdefinierten Erfassungs Oberflächen oder andere Texteingabe Szenarios hinzufügen und ihre Tablet PC-Texteingabe Story aufrunden.</span><span class="sxs-lookup"><span data-stu-id="4b083-121">In this way, applications can cheaply add powerful correction support to their custom inking surfaces or other text entry scenarios, and round out their Tablet PC text entry story.</span></span> <span data-ttu-id="4b083-122">Der Eingabebereich der ihandschreibtextinsertion-API ist als Teil des Windows Vista-Betriebssystems und als Teil des Tablet Platform SDK, Version 1,9 oder höher, enthalten.</span><span class="sxs-lookup"><span data-stu-id="4b083-122">The Input Panel IHandWrittenTextInsertion API is included as part of the Windows Vista operating system and as part of the Tablet Platform SDK version 1.9 or newer.</span></span> <span data-ttu-id="4b083-123">Sowohl eine .net-als auch eine COM-basierte Version der API sind enthalten.</span><span class="sxs-lookup"><span data-stu-id="4b083-123">Both a .NET and COM based version of the API are included.</span></span> <span data-ttu-id="4b083-124">Das Aktivieren der Dokumenten Korrektur für Text, der nicht über den Eingabebereich eingegeben wurde, wird unter Windows Vista und höher unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4b083-124">Enabling in-document correction for text not entered using Input Panel is supported on Windows Vista and newer.</span></span> <span data-ttu-id="4b083-125">Die Korrektur in Dokumenten ist nur für lateinische Sprachen verfügbar, und es kann kein Zeichen außerhalb des lateinischen Zeichensatzes angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="4b083-125">In-document correction is only available for Latin languages and is unable to display any character outside the Latin character set.</span></span>

## <a name="how-to-use-the-handwrittentextinsertion-api-in-an-application"></a><span data-ttu-id="4b083-126">Verwenden der handschreibtextinsertion-API in einer Anwendung</span><span class="sxs-lookup"><span data-stu-id="4b083-126">How to Use the HandwrittenTextInsertion API in an Application</span></span>

<span data-ttu-id="4b083-127">Die erforderlichen Änderungen an einer Anwendung, um den Eingabebereich in die Dokument Korrektur für Text zu integrieren, der nicht über den Eingabebereich eingegeben wurde, und die [**ihandwrite-textinsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) -API zu verwenden, sind unkompliziert.</span><span class="sxs-lookup"><span data-stu-id="4b083-127">The required changes to an application in order to integrate Input Panel in-document correction for text not entered using Input Panel and using the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API are straightforward.</span></span> <span data-ttu-id="4b083-128">Der benutzerdefinierte Text Eintrags Code der Anwendung bleibt mit Ausnahme des letzten Schritts unverändert.</span><span class="sxs-lookup"><span data-stu-id="4b083-128">All of the application's custom text entry code remains unchanged except for the last step.</span></span> <span data-ttu-id="4b083-129">An dem Punkt, an dem Text, der mithilfe einer benutzerdefinierten Aufnahme Oberfläche eingegeben wurde, Spracherkennung oder andere Mittel in einem Textfeld für Text Dienste aktiviert angezeigt wird, sendet die Anwendung den Text an die **ihandschreifttextinsertion** -Schnittstelle, anstatt Sie direkt an das Textfeld zu senden.</span><span class="sxs-lookup"><span data-stu-id="4b083-129">At the point at which text entered using a custom inking surface, speech recognition, or other means is to be displayed in a text services enabled text field, the application sends the text to the **IHandWrittenTextInsertion** interface instead of sending it directly to the text field.</span></span> <span data-ttu-id="4b083-130">Die Programmierbarkeits Komponente des Eingabe Bereichs behandelt dann das Einfügen des Texts in das Textfeld und den Text Dienste-Unterstützungs Speicher.</span><span class="sxs-lookup"><span data-stu-id="4b083-130">The Input Panel programmability component then handles inserting the text into both the text field and the Text Services backing-store.</span></span> <span data-ttu-id="4b083-131">Beim Hinzufügen des Texts zum Text Dienste-Unterstützungs Speicher behandelt die Programmierbarkeits Komponente des Eingabe Bereichs das Festlegen der Texteigenschaften, die für den Eingabebereich erforderlich sind, damit die Dokument gesteuerte Korrektur für diesen Text aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="4b083-131">When adding the text to the Text Services backing-store, the Input Panel programmability component handles setting the text properties that are required by Input Panel for in-document correction to be enabled for that text.</span></span>

<span data-ttu-id="4b083-132">Der folgende Abschnitt führt Sie ausführlich durch diesen Prozess für eine C++-Anwendung, die die com-Version der [**ihandwrite-textinsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) -API verwendet.</span><span class="sxs-lookup"><span data-stu-id="4b083-132">The following section walks through this process in detail for a C++ application using the COM version of the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API.</span></span> <span data-ttu-id="4b083-133">Die Schritte für die Verwendung der .NET Framework Version der API in C sind \# für die Verwendung der com-Version in C++ unterschiedlich.</span><span class="sxs-lookup"><span data-stu-id="4b083-133">There are notes anywhere the steps for using the .NET Framework version of the API in C\# differ for the using COM version in C++.</span></span> <span data-ttu-id="4b083-134">Die verwaltete **handschreibtextinsertion** -API enthält eine einzelne com-Schnittstelle, **ihandschreibtextinsertion**.</span><span class="sxs-lookup"><span data-stu-id="4b083-134">The managed **HandwrittenTextInsertion** API includes a single COM interface, **IHandwrittenTextInsertion**.</span></span> <span data-ttu-id="4b083-135">Die Definition für diese Schnittstelle befindet sich in "cuinputpanel. h" und "cuinputpanel \_ i.c.</span><span class="sxs-lookup"><span data-stu-id="4b083-135">The definition for this interface is located in PenInputPanel.h and PenInputPanel\_i.c.</span></span>

<span data-ttu-id="4b083-136">Zuerst sollte die Anwendung die [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion verwenden, um eine Instanz von [**ihandwrittentextinsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) mit der Klassen-ID **CLSID \_ HandwrittenTextInsertion** zu entwickeln.</span><span class="sxs-lookup"><span data-stu-id="4b083-136">First, the application should use the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function to produce an instance of [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) with class id **CLSID\_HandwrittenTextInsertion**.</span></span> <span data-ttu-id="4b083-137">Beachten Sie, dass die Erstellung eines **CLSID- \_ handschreibtextinsertion** -Objekts erst erfolgreich ist, nachdem ein Fenster erstellt und der Fokus festgestellt wurde, denn bis zu diesem Zeitpunkt wird der Text Dienste-Unterstützungs Speicher nicht aktiviert.</span><span class="sxs-lookup"><span data-stu-id="4b083-137">Note that the creation of a **CLSID\_HandwrittenTextInsertion** object will succeed only after a window is created and given focus, because until then the Text Services backing-store is not activated.</span></span> <span data-ttu-id="4b083-138">Wenn tiptsf.dll nicht auf dem System vorhanden ist, schlägt die **cokreateinstance** -Funktion fehl und gibt **RegDB \_ E \_ classnotreg** zurück, was bedeutet, dass der Eingabebereich in-Document-Korrektur auf dem System nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="4b083-138">Additionally, if tiptsf.dll is not present on the system, the **CoCreateInstance** function fails and returns **REGDB\_E\_CLASSNOTREG**, indicating that Input Panel in-document correction is not supported on the system.</span></span> <span data-ttu-id="4b083-139">An diesem Punkt sollte die Anwendung fortfahren, ohne zu versuchen, den Eingabebereich in der Dokument Korrektur zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="4b083-139">At this point the application should proceed without trying to enable Input Panel in-document correction.</span></span> <span data-ttu-id="4b083-140">Der Anwendungscode, der das Einfügen von Text in ein Textfeld verarbeitet, muss auf die Instanz von **handschreideptextinsertion** zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="4b083-140">The instance of **HandwrittenTextInsertion** must be accessible from the application's code that handles inserting text into a text field.</span></span>

> [!Note]  
> <span data-ttu-id="4b083-141">Beim Arbeiten mit der .NET Framework Version der API sollte die Anwendung eine using-Anweisung hinzufügen, um den Zugriff auf den [Microsoft. Ink. TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) -Namespace zuzulassen und das Objekt dann direkt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="4b083-141">When working with the .NET Framework version of the API, the application should add a using statement to allow access to the [Microsoft.Ink.TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) namespace and then create the object directly.</span></span>

 

<span data-ttu-id="4b083-142">Zweitens muss der Code der Anwendung, der für das Einfügen von Text in ein Textfeld zuständig ist, so geändert werden, dass er keinen Text mehr direkt in ein Textfeld einfügt, sondern eine oder die andere der beiden Einfügemethoden von [**ihandschreittentextinsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion)aufruft.</span><span class="sxs-lookup"><span data-stu-id="4b083-142">Second, the application's code that is responsible for inserting text into a text field must be altered so that it no longer inserts text into a text field directly, but calls one or the other of [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion)'s two insertion methods instead.</span></span> <span data-ttu-id="4b083-143">Ob die Anwendungen festlegen, dass [**insertrecognitionresultsarray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) oder [**insertrecognitionresults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) aufgerufen werden sollen, hängt davon ab, ob die Anwendung über die Erkennungs Alternativen für den als Array gespeicherten Text oder als [**iinkrecognitionresult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) -Objekt verfügt.</span><span class="sxs-lookup"><span data-stu-id="4b083-143">Whether the applications should choose to call [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) or [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) depends on whether the application has the recognition alternates for the text stored as an array or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) object.</span></span>

> [!Note]  
> <span data-ttu-id="4b083-144">Beim Arbeiten in verwaltetem Code ist das zugehörige Erkennungs Objekt, das von insertrecognitionresultsarray verwendet wird, "Erkennungs [Ergebnis](/previous-versions/ms552537(v=vs.100))".</span><span class="sxs-lookup"><span data-stu-id="4b083-144">When working in managed code, the corresponding recognition object consumed by InsertRecognitionResultsArray is [RecognitionResult](/previous-versions/ms552537(v=vs.100)).</span></span> <span data-ttu-id="4b083-145">Beide Methoden verwenden die folgenden drei Parameter:</span><span class="sxs-lookup"><span data-stu-id="4b083-145">Both methods consume the following three parameters:</span></span>

 

-   <span data-ttu-id="4b083-146">*Alternativen* Ist eine zweidimensionale Auflistung von Zeichen folgen, die entweder als Array von Arrays oder als [**iinkrecognitionresult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) -Objekt (oder [Erkennungs Ergebnis](/previous-versions/ms552537(v=vs.100))) gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="4b083-146">*alternates* Is a two dimensional collection of strings, stored either as an array of arrays or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (or [RecognitionResult](/previous-versions/ms552537(v=vs.100))) object.</span></span> <span data-ttu-id="4b083-147">Wenn die Alternativen als Array von Arrays gespeichert werden, sollte Sie als sicherer Array Zeiger weitergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="4b083-147">If the alternates are stored as an array of arrays, then it should be passed as a safe array pointer.</span></span> <span data-ttu-id="4b083-148">Jeder Eintrag im Array der obersten Ebene ist eine Liste von Alternativen für ein einzelnes Wort in der Einfügung.</span><span class="sxs-lookup"><span data-stu-id="4b083-148">Each entry in the top level array is a list of alternates for a single word in the insertion.</span></span> <span data-ttu-id="4b083-149">Der Eintrag an Position Zero in den Unterarrays von Alternativen ist der Text, der in das Textfeld eingefügt wird.</span><span class="sxs-lookup"><span data-stu-id="4b083-149">The entry at position zero in the sub-arrays of alternates is the text that is inserted into the text field.</span></span> <span data-ttu-id="4b083-150">Die zusätzlichen alternativen (Indizes 1 bis n in jedem Unterarray) werden im Text Dienste-Unterstützungs Speicher gespeichert und dem Benutzer als Teil der in-Document-Korrektur als Auswahl angeboten.</span><span class="sxs-lookup"><span data-stu-id="4b083-150">The additional alternates (indices 1 through n in each sub-array) are stored in the Text Services backing-store and offered to the user as choices as part of in-document correction.</span></span> <span data-ttu-id="4b083-151">Wenn keine alternativen enthalten sind, wird für den Benutzer anstelle der Liste der alternativen "kein Vorschlag" angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4b083-151">If alternates are not included, then the user sees 'No suggestion' in place of the list of alternates.</span></span> <span data-ttu-id="4b083-152">Wenn eine Einfügung mehrere Wörter mit Leerzeichen enthält, muss jedes Leerzeichen als Eintrag in das Array der obersten Ebene eingeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="4b083-152">If an insertion contains multiple words with spaces between them, then each space must be included as an entry in the top level array.</span></span>
-   <span data-ttu-id="4b083-153">*Sprache* Die [LCID](/previous-versions/ms221397(v=vs.71)) der Eingabe Sprache, die dem Text entspricht, der *im Parameter "Parameters* " enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="4b083-153">*language* The Input Language [LCID](/previous-versions/ms221397(v=vs.71)) that corresponds to the text contained in the *alternates* parameter.</span></span> <span data-ttu-id="4b083-154">In dem Fall, in dem der Inhalt von *Alternativen* durch eine Handschrift oder Spracherkennung generiert wurde, ist dies auch die Eigenschaft [**Languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) , die der verwendeten Erkennungsfunktion zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="4b083-154">In the case in which the contents of *alternates* was generated by a handwriting or speech recognizer, this is also the [**Languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) property associated with the recognizer used.</span></span>
-   <span data-ttu-id="4b083-155">*flatticecontainsautospacinginformation* Ein Flag, das angibt, ob der im *Parameter "Parameters* " enthaltene Text von einer Erkennung mit aktiviertem automatischem Abstand generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="4b083-155">*fLatticeContainsAutoSpacingInformation* A flag indicating whether the text contained in the *alternates* parameter was generated by a recognizer with auto-spacing enabled.</span></span> <span data-ttu-id="4b083-156">Wenn der automatische Abstand aktiviert war, sollte das-Flag auf **true** festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="4b083-156">If auto-spacing was enabled, then the flag should be set to **TRUE**.</span></span> <span data-ttu-id="4b083-157">Wenn der automatische Abstand deaktiviert wurde, sollte das Flag auf **false** festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="4b083-157">If auto-spacing was disabled, then the flag should be set to **FALSE**.</span></span> <span data-ttu-id="4b083-158">In dem Fall, in dem der Inhalt von *Alternativen* von einer Erkennung generiert wurde, die keine automatische Abstände unterstützt, oder die nicht von einer Erkennung generiert wurde, sollte das Flag auf **false** festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="4b083-158">In the case in which the contents of *alternates* was generated by a recognizer that does not support auto-spacing, or was not generated by a recognizer at all, then the flag should be set to **FALSE**.</span></span>

<span data-ttu-id="4b083-159">Das Programmierbarkeits Modell des Eingabe Bereichs kann den Text im Dokument oder in der Anwendung von der Position der System Einfügemarke einfügen.</span><span class="sxs-lookup"><span data-stu-id="4b083-159">Input Panel's programmability model is able to insert the text in the document or application from the position of the system caret.</span></span>

<span data-ttu-id="4b083-160">Beide Methoden geben " **S \_ OK** " zurück, wenn das Einfügen erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="4b083-160">Both methods return **S\_OK** if the insertion succeeds.</span></span> <span data-ttu-id="4b083-161">Sie geben **e \_ nointerface** zurück, wenn die Anwendung nicht auf Text Services basiert oder aktiviert ist, und **e \_ invalidArg** , wenn die *Alternativen* nicht ordnungsgemäß formatiert oder nicht zugänglich sind.</span><span class="sxs-lookup"><span data-stu-id="4b083-161">They return **E\_NOINTERFACE** if the application is not Text Services based or enabled, and **E\_INVALIDARG** if *alternates* is improperly formatted or inaccessible.</span></span> <span data-ttu-id="4b083-162">Sie können auch **e \_ ouesfmemory** zurückgeben, wenn auf dem System nicht genügend Arbeitsspeicher verfügbar ist, oder **e \_ schlägt fehl** , wenn ein schwerwiegender Fehler auftritt, z. b. wenn das Text Dienst-Framework nicht aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="4b083-162">They may also return **E\_OUTOFMEMORY** if there is not enough memory available on the system, or **E\_FAIL** after a catastrophic failure such as the Text Services Framework not being enabled.</span></span>

### <a name="conclusion"></a><span data-ttu-id="4b083-163">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="4b083-163">Conclusion</span></span>

<span data-ttu-id="4b083-164">Das Aktivieren des Eingabe Bereichs in der Dokument Korrektur für Text, der nicht über den Eingabebereich eingegeben wurde, ist eine kostengünstige und einfache Möglichkeit für eine auf Text Services basierende oder aktivierte Anwendung, eine benutzerdefinierte Bindung oder Eingabemethode durch leistungsstarke, auf Stift basierende Korrekturfunktionen zu ergänzen.</span><span class="sxs-lookup"><span data-stu-id="4b083-164">Enabling Input Panel in-document correction for text not entered using Input Panel is a cheap and easy way for a Text Services based or enabled application to supplement a custom inking or input method with powerful pen-based correction functionality.</span></span> <span data-ttu-id="4b083-165">Bei Windows Vista sind alle Rich-Edit-und-Anwendungen-Anwendungen Text Dienste aktiviert.</span><span class="sxs-lookup"><span data-stu-id="4b083-165">On Windows Vista, all Rich Edit and Trident applications are Text Services enabled.</span></span> <span data-ttu-id="4b083-166">Obwohl integrierte Erfassungs Oberflächen eine gute Option zum Hinzufügen eines benutzerdefinierten Tablet PC-Benutzer Erlebnisses zu einer Anwendung sind, unterstützen Sie nur die Hälfte des Text Eintrags, wenn Sie keine Korrekturfunktionen enthalten.</span><span class="sxs-lookup"><span data-stu-id="4b083-166">While integrated inking surfaces are a great option for adding a custom Tablet PC user experience to an application, they only support half of text entry if they do not include correction capabilities.</span></span> <span data-ttu-id="4b083-167">Die Korrektur in Dokumenten bietet Benutzern die andere Hälfte der Story, indem Sie die Möglichkeit zum Austauschen einer Auswahl für eine Erkennungs Alternative oder zum Umschreiben eines Teils oder der gesamten Auswahl hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="4b083-167">In-document correction provides users with the other half of the story by adding the ability to swap a selection for a recognition alternate, or to rewrite part or all of the selection.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4b083-168">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="4b083-168">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4b083-169">Programmieren des Text Eingabe Panels</span><span class="sxs-lookup"><span data-stu-id="4b083-169">Programming the Text Input Panel</span></span>](programming-the-text-input-panel.md)
</dt> </dl>

 

 
