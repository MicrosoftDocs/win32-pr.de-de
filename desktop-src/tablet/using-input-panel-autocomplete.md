---
description: In Windows Vista integriert der Tablet PC-Eingabebereich neue Auto Vervollständigen-Funktionen, die es ermöglichen, dass die Auto Vervollständigen-Liste einer Anwendung in Echtzeit aktualisiert wird, da die frei Hand Eingabe eines Benutzers im Eingabebereich erkannt wird.
ms.assetid: 0f01f546-f76b-4c61-a204-2a06079a374a
title: Verwenden des Auto Vervollständigen-Eingabe Bereichs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c9e7f108631eb2723b71bf8ed919c17a0eabff5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104128993"
---
# <a name="using-input-panel-autocomplete"></a><span data-ttu-id="17708-103">Verwenden des Auto Vervollständigen-Eingabe Bereichs</span><span class="sxs-lookup"><span data-stu-id="17708-103">Using Input Panel AutoComplete</span></span>

<span data-ttu-id="17708-104">In Windows Vista integriert der Tablet PC-Eingabebereich neue Auto Vervollständigen-Funktionen, die es ermöglichen, dass die Auto Vervollständigen-Liste einer Anwendung in Echtzeit aktualisiert wird, da die frei Hand Eingabe eines Benutzers im Eingabebereich erkannt wird.</span><span class="sxs-lookup"><span data-stu-id="17708-104">In Windows Vista, Tablet PC Input Panel integrates new Autocomplete capabilities that enable an application's Autocomplete list to update in real time as a user's ink is recognized in Input Panel.</span></span> <span data-ttu-id="17708-105">Außerdem ist die Auto Vervollständigen-Liste der Anwendung an einem geeigneten Speicherort für Benutzer des Eingabe Bereichs positioniert.</span><span class="sxs-lookup"><span data-stu-id="17708-105">Additionally, the application's Autocomplete list is positioned in a convenient location for users of Input Panel.</span></span> <span data-ttu-id="17708-106">Ohne die automatische Vervollständigung des Eingabe Bereichs ist die Verwendung von Auto Vervollständigen-Funktionen mit dem Eingabebereich ein schwieriger Prozess, bei dem Benutzer jeweils ein Zeichen einfügen und den Eingabebereich verschieben müssen, um auf Auto Vervollständigen-Vorschläge zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="17708-106">Without Input Panel Autocomplete, using Autocomplete features with Input Panel is a difficult process, requiring users to insert one character at a time and move Input Panel in order to access Autocomplete suggestions.</span></span> <span data-ttu-id="17708-107">Mit der-Integration ist AutoComplete ein leistungsfähiges Tool für Tablet PC-Benutzer, das beschleunigt und die einfache Eingabe von Text mit dem Eingabebereich erhöht.</span><span class="sxs-lookup"><span data-stu-id="17708-107">With integration, Autocomplete is a powerful tool for Tablet PC users that speeds up and increases the ease of entering text with Input Panel.</span></span>

![Eingabebereich mit Internet Explorer-Liste "Auto Vervollständigen"](images/9e769482-543a-4e29-b274-8f19ae10250d.jpg)

<span data-ttu-id="17708-109">Es gibt drei Möglichkeiten, wie eine Anwendung die Auto Vervollständigen-Integration in den Eingabebereich nutzen kann.</span><span class="sxs-lookup"><span data-stu-id="17708-109">There are three options for how an application can take advantage of Input Panel Autocomplete integration.</span></span> <span data-ttu-id="17708-110">Anwendungen, die eine Auto Vervollständigen-Funktionalität enthalten, die mithilfe von Shell AutoComplete (über die [**iautocomplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) -Schnittstelle) oder .NET Framework Auto vervollständigen (über die [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) -Enumeration) erstellt wurde, erhalten die automatische Vervollständigung im Eingabebereich ohne Codeänderungen.</span><span class="sxs-lookup"><span data-stu-id="17708-110">Applications that contain Autocomplete functionality built using Shell Autocomplete (through the [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) interface) or .NET Framework Autocomplete (through the [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) Enumeration) receive Input Panel Autocomplete integration without the need for code changes.</span></span> <span data-ttu-id="17708-111">Anwendungen, die benutzerdefinierte AutoComplete-Textfelder enthalten, können den Eingabebereich der AutoComplete-API verwenden, um die gleiche Funktionalität zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="17708-111">Applications that include custom Autocomplete text fields can use the Input Panel Autocomplete API to get the same functionality.</span></span>

<span data-ttu-id="17708-112">In allen Fällen können Sie diese Änderungen an der Auto Vervollständigen-Liste der Anwendung vornehmen, ohne die Benutzeroberfläche oder Vorhersage Logik zu duplizieren oder zu ändern, die von einer Anwendung verwendet wird, um eine Auto Vervollständigen-Liste zu generieren.</span><span class="sxs-lookup"><span data-stu-id="17708-112">In all cases, you can make these modifications to the application's Autocomplete list without duplicating or modifying the UI or prediction logic used by an application to generate an Autocomplete list.</span></span> <span data-ttu-id="17708-113">Die Auto Vervollständigen-Liste wird von der Anwendung weiterhin als Besitzer gezeichnet, und die Inhalte der Auto Vervollständigen-Liste sind identisch, wenn der Text direkt in das Bearbeitungsfeld eingegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="17708-113">The Autocomplete list continues to be owner drawn by the application and the contents of the Autocomplete list are the same as if the text were typed directly into the edit field.</span></span>

<span data-ttu-id="17708-114">Die Auto Vervollständigen-Integration im Eingabebereich wird unter dem Betriebssystem Windows Vista oder höheren Versionen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="17708-114">Input Panel Autocomplete integration is supported on the Windows Vista operating system or later versions.</span></span> <span data-ttu-id="17708-115">Die Auto Vervollständigen-Integration in den Eingabebereich ist ab Windows Vista in Shell AutoComplete integriert, und in Windows Forms Entwicklung ab .NET Framework, Version 3,0.</span><span class="sxs-lookup"><span data-stu-id="17708-115">Input Panel Autocomplete integration is built into Shell Autocomplete starting with Windows Vista and into Windows Forms development starting with .NET Framework version 3.0.</span></span> <span data-ttu-id="17708-116">Während sowohl [**iautocomplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) als auch [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) unter früheren Versionen von Windows ausgeführt werden, wird die automatische vollständige Integration des Eingabe Bereichs in Microsoft Windows XP Tablet PC Edition oder früheren Betriebssystemen nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="17708-116">While [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) and [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) both run on earlier versions of Windows, Input Panel Autocomplete integration is not supported on Microsoft Windows XP Tablet PC Edition or earlier operating systems.</span></span> <span data-ttu-id="17708-117">Wenn Sie in früheren Versionen von Tablet PC den Eingabebereich Auto Vervollständigen ausführen, werden die Anwendungen auf das Verhalten vor der Integration zurückgesetzt.</span><span class="sxs-lookup"><span data-stu-id="17708-117">If you run Input Panel Autocomplete on earlier versions of Tablet PC, applications revert to the pre-integration behavior.</span></span>

## <a name="reasons-to-integrate-application-autocomplete-lists-with-input-panel"></a><span data-ttu-id="17708-118">Gründe für das Integrieren von AutoComplete-Anwendungs Listen in den Eingabebereich</span><span class="sxs-lookup"><span data-stu-id="17708-118">Reasons to Integrate Application Autocomplete Lists with Input Panel</span></span>

<span data-ttu-id="17708-119">Durch die Integration der Auto Vervollständigen-Liste einer Anwendung können Benutzer, die Text in ein Textfeld eingeben, das eine Auto Vervollständigen-Funktionalität einschließt, die maximale Benutzerfreundlichkeit und Geschwindigkeit der Eingabe ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="17708-119">Integration of an application's Autocomplete list enables the maximum ease and speed of input for users who are entering text into a text field that includes Autocomplete functionality.</span></span> <span data-ttu-id="17708-120">Darüber hinaus wird eine Anwendung, die die Auto Vervollständigen-Integration in den Eingabebereich einschließt, sofort so angezeigt, als ob Sie mit dem Tablet PC entwickelt wurde, sodass die Anwendung für Tablet PC-Benutzer ansprechender wird.</span><span class="sxs-lookup"><span data-stu-id="17708-120">Furthermore, an application that includes Input Panel Autocomplete integration immediately appears as if it were developed with the Tablet PC in mind, making the application more appealing to Tablet PC users.</span></span>

### <a name="how-input-panel-and-autocomplete-list-interact-without-integration"></a><span data-ttu-id="17708-121">Interagieren der Eingabe Panel-und Auto Vervollständigen-Liste ohne Integration</span><span class="sxs-lookup"><span data-stu-id="17708-121">How Input Panel and Autocomplete List Interact without Integration</span></span>

<span data-ttu-id="17708-122">Verwenden des Eingabe Bereichs zum Eingeben von Text in ein Textfeld, das eine Auto Vervollständigen-Liste enthält, jedoch nicht in den Eingabebereich integriert ist:</span><span class="sxs-lookup"><span data-stu-id="17708-122">Using Input Panel to enter text into a text field that includes an Autocomplete list but that is not integrated with Input Panel:</span></span>

1.  <span data-ttu-id="17708-123">Der Benutzer legt den Fokus in das Textfeld und öffnet den Eingabebereich.</span><span class="sxs-lookup"><span data-stu-id="17708-123">The user places focus in the text field and opens Input Panel.</span></span>
2.  <span data-ttu-id="17708-124">Der Benutzer schreibt ein oder zwei Zeichen.</span><span class="sxs-lookup"><span data-stu-id="17708-124">The user writes one or two characters.</span></span>
3.  <span data-ttu-id="17708-125">Der Benutzer tippt auf **Insert**.</span><span class="sxs-lookup"><span data-stu-id="17708-125">The user taps **Insert**.</span></span> <span data-ttu-id="17708-126">Der Eingabebereich gibt den Text in das Textfeld der Anwendung ein.</span><span class="sxs-lookup"><span data-stu-id="17708-126">Input Panel enters the text into the application's text field.</span></span> <span data-ttu-id="17708-127">Die Auto Vervollständigen-Liste der Anwendung wird angezeigt und ist im Eingabebereich wahrscheinlich teilweise oder vollständig verdeckt.</span><span class="sxs-lookup"><span data-stu-id="17708-127">The application's Autocomplete list appears and is most likely partially or completely obscured by Input Panel.</span></span>
4.  <span data-ttu-id="17708-128">Der Benutzer zieht den Eingabebereich ein, um die Auto Vervollständigen-Liste der Anwendung zu erkennen.</span><span class="sxs-lookup"><span data-stu-id="17708-128">The user drags Input Panel to uncover the application's Autocomplete list.</span></span>
5.  <span data-ttu-id="17708-129">Wenn Sie davon ausgehen, dass der richtige Eintrag in der Liste Auto Vervollständigen enthalten ist, kann der Benutzer jetzt diesen Eintrag auswählen. Andernfalls muss der Benutzer die Schritte 2 und 3 wiederholen.</span><span class="sxs-lookup"><span data-stu-id="17708-129">Assuming the correct entry is included in the Autocomplete list, the user can now select that entry; otherwise the user must repeat steps 2 and 3.</span></span>

<span data-ttu-id="17708-130">Dies ist eindeutig ein mühsamer Prozess.</span><span class="sxs-lookup"><span data-stu-id="17708-130">This is clearly a cumbersome process.</span></span> <span data-ttu-id="17708-131">Die Erwartungen der Benutzer, wie eine Auto Vervollständigen-Liste funktionieren sollte, sind gestrichelt, und ihre Fähigkeit zum Ausführen von Aufgaben ist beeinträchtigt.</span><span class="sxs-lookup"><span data-stu-id="17708-131">The user's expectations of how an Autocomplete list should work are dashed, and their ability to perform tasks suffers.</span></span>

### <a name="how-input-panel-and-autocomplete-list-interaction-improves-with-integration"></a><span data-ttu-id="17708-132">Verbesserung der Eingabe Panel-und Auto Vervollständigen-Listen Interaktion durch Integration</span><span class="sxs-lookup"><span data-stu-id="17708-132">How Input Panel and Autocomplete List Interaction Improves with Integration</span></span>

<span data-ttu-id="17708-133">Verwenden des Eingabe Bereichs zum Eingeben von Text in ein Textfeld, das eine Auto Vervollständigen-Liste enthält, die in den Eingabebereich integriert ist:</span><span class="sxs-lookup"><span data-stu-id="17708-133">Using Input Panel to enter text into a text field that includes an Autocomplete list that is integrated with Input Panel:</span></span>

1.  <span data-ttu-id="17708-134">Der Benutzer legt den Fokus in das Textfeld und öffnet den Eingabebereich.</span><span class="sxs-lookup"><span data-stu-id="17708-134">The user places focus in the text field and opens Input Panel.</span></span>
2.  <span data-ttu-id="17708-135">Der Benutzer schreibt ein oder zwei Zeichen.</span><span class="sxs-lookup"><span data-stu-id="17708-135">The user writes one or two characters.</span></span> <span data-ttu-id="17708-136">Die Auto Vervollständigen-Liste der Anwendung wird direkt oberhalb oder direkt unterhalb des Eingabe Panels angezeigt, wenn der Benutzer Text schreibt.</span><span class="sxs-lookup"><span data-stu-id="17708-136">The application's Autocomplete list appears directly above or directly below Input Panel as the user writes text.</span></span>
3.  <span data-ttu-id="17708-137">Der Benutzer wählt den Eintrag aus der Auto Vervollständigen-Liste aus. der Eintrag wird direkt in das Textfeld der Anwendung eingefügt, oder der Benutzer wiederholt Schritt 2, bis der richtige Eintrag angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="17708-137">The user selects the entry from the Autocomplete list; the entry is inserted directly into the application's text field, or the user repeats step 2 until the correct entry appears.</span></span>

<span data-ttu-id="17708-138">Aufgrund der Integration wird die Auto Vervollständigen-Liste angezeigt und aktualisiert, während der Benutzer im Eingabebereich schreibt.</span><span class="sxs-lookup"><span data-stu-id="17708-138">Due to the integration, the Autocomplete list appears and updates while the user is writing in Input Panel.</span></span> <span data-ttu-id="17708-139">Außerdem ist die Liste so positioniert, dass Sie für den Benutzer praktisch ist, während Sie schreiben und nicht durch Eingabebereich verdeckt werden.</span><span class="sxs-lookup"><span data-stu-id="17708-139">Additionally, the list is positioned so that it is both convenient for the user to access while writing and not obscured by Input Panel.</span></span> <span data-ttu-id="17708-140">Wenn der Benutzer schließlich ein Element aus einer Auto Vervollständigen-Liste auswählt, wird das Element direkt in das Texteingabefeld der Anwendung eingefügt, sodass der Benutzer den Schritt des Fügens von Text aus dem Eingabebereich umgehen kann.</span><span class="sxs-lookup"><span data-stu-id="17708-140">Lastly, when the user selects an item from an Autocomplete list the item is inserted directly into the application's text entry field, thus enabling the user to bypass the step of inserting text from Input Panel.</span></span>

![Eingabebereich mit Outlook Express Auto Vervollständigen-Liste](images/ba59a513-e538-4092-89a6-6d691424dc3d.jpg)

## <a name="standard-autocomplete-components-that-include-input-panel-autocomplete-integration"></a><span data-ttu-id="17708-142">Standard mäßige Auto Vervollständigen-Komponenten, die die automatische Vervollständigung im Eingabebereich einschließen</span><span class="sxs-lookup"><span data-stu-id="17708-142">Standard Autocomplete Components that include Input Panel Autocomplete Integration</span></span>

<span data-ttu-id="17708-143">Sowohl [**iautocomplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) als auch [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) enthalten integrierte Integration des Eingabe Bereichs Auto vervollständigen.</span><span class="sxs-lookup"><span data-stu-id="17708-143">Both [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) and [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) include built-in integration of Input Panel Autocomplete.</span></span> <span data-ttu-id="17708-144">Anwendungen, die eine dieser standardmäßigen Auto Vervollständigen-Komponenten verwenden, können die Funktion "Auto Vervollständigen" für den Eingabebereich nutzen, ohne dass zusätzliche Arbeit erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="17708-144">Applications using either of these standard Autocomplete components can take advantage of Input Panel Autocomplete functionality with little to no additional work.</span></span> <span data-ttu-id="17708-145">Während der Eingabebereich Auto Vervollständigen nur unter Windows Vista oder neuen Versionen des Windows-Betriebssystems unterstützt wird, erhalten Anwendungen, die vor der Veröffentlichung von Windows Vista mithilfe von **iautocomplete** erstellt wurden, bei Ausführung unter Windows Vista automatisch die automatische Vervollständigung des Eingabe Bereichs.</span><span class="sxs-lookup"><span data-stu-id="17708-145">Additionally, while Input Panel Autocomplete is only supported on Windows Vista or new versions of the Windows operating system, applications that were built using **IAutoComplete** prior to the release of Windows Vista get Input Panel Autocomplete integration automatically when run on Windows Vista.</span></span> <span data-ttu-id="17708-146">Die folgenden Abschnitte enthalten weitere Informationen zu den spezifischen **iautocomplete** -und AutoCompleteMode-Elementen, die die Auto Vervollständigen-Integration im Eingabebereich einschließen.</span><span class="sxs-lookup"><span data-stu-id="17708-146">The following sections contain more information about the specific **IAutoComplete** and AutoCompleteMode elements that include Input Panel Autocomplete integration.</span></span>

### <a name="shell-autocomplete-with-input-panel-autocomplete-integration"></a><span data-ttu-id="17708-147">Shell Auto Vervollständigen mit Eingabebereich Auto Vervollständigen-Integration</span><span class="sxs-lookup"><span data-stu-id="17708-147">Shell Autocomplete with Input Panel Autocomplete Integration</span></span>

<span data-ttu-id="17708-148">Anwendungen, die [**iautocomplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) verwenden, erhalten die Auto Vervollständigen-Integration für den Eingabebereich kostenlos.</span><span class="sxs-lookup"><span data-stu-id="17708-148">Applications that use [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) get Input Panel Autocomplete integration for free.</span></span> <span data-ttu-id="17708-149">Obwohl die Auto Vervollständigen-APIs für die Shell in Windows 2000 weiter integriert sind, wird die Auto Vervollständigen-Integration im Eingabebereich nur unter Windows Vista und neueren Versionen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="17708-149">While the Shell Autocomplete APIs are included in Windows 2000 onward, Input Panel Autocomplete integration is only support on Windows Vista and newer versions.</span></span> <span data-ttu-id="17708-150">Anwendungen, die vor der Veröffentlichung von Windows Vista erstellt wurden und die **iautocomplete** verwenden, erhalten bei Ausführung unter Windows Vista automatisch die automatische Vervollständigung im Eingabebereich.</span><span class="sxs-lookup"><span data-stu-id="17708-150">However, applications built prior to the release of Windows Vista that use **IAutoComplete** automatically get Input Panel Autocomplete integration when run on Windows Vista.</span></span>

<span data-ttu-id="17708-151">Um die Auto Vervollständigen-Funktion auf diese Weise nutzen zu können, müssen Sie das Auto Vervollständigen-Objekt (**CLSID \_ Auto Vervollständigen**) verwenden.</span><span class="sxs-lookup"><span data-stu-id="17708-151">In order to take advantage of Tablet Autocomplete in this way, you must use the autocomplete object (**CLSID\_Autocomplete**).</span></span> <span data-ttu-id="17708-152">Wenn Sie die automatische Vervollständigung für URLs oder Dateinamen bereitstellen möchten, verwenden Sie die Funktion " [**SHAutoComplete**](/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete) ", um das Objekt "Auto Vervollständigen" zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="17708-152">If you wish to provide autocomplete functionality for URLs or file names, use the [**SHAutoComplete**](/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete) function to create the autocomplete object.</span></span>

<span data-ttu-id="17708-153">Zusätzlich zu [**iautocomplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete)können Sie [**IAutoComplete2**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete2) oder [**iautocompletedropdown**](/windows/win32/api/shobjidl/nn-shobjidl-iautocompletedropdown)s direkt implementieren und die Auto Vervollständigen-Integration automatisch im Eingabebereich erhalten.</span><span class="sxs-lookup"><span data-stu-id="17708-153">In addition to [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete), you can implement [**IAutoComplete2**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete2) or [**IAutoCompleteDropDown**](/windows/win32/api/shobjidl/nn-shobjidl-iautocompletedropdown)s directly and still get Input Panel Autocomplete integration automatically.</span></span>

### <a name="input-panel-autocomplete-integration-with-net-framework-applications"></a><span data-ttu-id="17708-154">Eingabebereich der Auto Vervollständigen-Integration in .NET Framework Anwendungen</span><span class="sxs-lookup"><span data-stu-id="17708-154">Input Panel Autocomplete Integration with .NET Framework Applications</span></span>

<span data-ttu-id="17708-155">Ab .NET Framework 3,0 enthalten Windows Forms Textfelder autocomplete.</span><span class="sxs-lookup"><span data-stu-id="17708-155">Starting in .NET Framework 3.0, Windows Forms textboxes include Autocomplete.</span></span> <span data-ttu-id="17708-156">Windows Forms Textfeld Auto Vervollständigen basiert auf Shell autocomplete. Dies bedeutet, dass auch die automatische Vervollständigung in den Eingabebereich integriert ist.</span><span class="sxs-lookup"><span data-stu-id="17708-156">Windows Forms textbox Autocomplete is built on top of Shell Autocomplete, which means Input Panel Autocomplete integration is built in, too.</span></span> <span data-ttu-id="17708-157">.NET Framework 3,0 wird bei Windows-Editionen vor Windows Vista unterstützt.</span><span class="sxs-lookup"><span data-stu-id="17708-157">.NET Framework 3.0 is supported down level on Windows editions released prior to Windows Vista.</span></span> <span data-ttu-id="17708-158">Da jedoch die Auto Vervollständigen-Integration im Eingabebereich nur unter Windows Vista oder höheren Versionen unterstützt wird, funktioniert die automatische Vervollständigung im Eingabebereich nur in einer .NET Framework 3,0-Anwendung, wenn Sie unter Windows Vista oder höheren Versionen installiert wird.</span><span class="sxs-lookup"><span data-stu-id="17708-158">However, because Input Panel Autocomplete integration is only supported on Windows Vista or later versions, Input Panel Autocomplete integration only works in a .NET Framework 3.0 application when it is installed on Windows Vista or later versions.</span></span>

<span data-ttu-id="17708-159">Anwendungen, die die Auto Vervollständigen-Integration im Eingabebereich in .NET Framework 3,0 nutzen möchten, müssen ein Windows Forms [Textfeld](/dotnet/api/system.windows.forms.textbox?view=netcore-3.1) mit aktivierter [AutoCompleteMode](/dotnet/api/system.windows.forms.textbox.autocompletemode?view=netcore-3.1) -Eigenschaft verwenden.</span><span class="sxs-lookup"><span data-stu-id="17708-159">Applications wishing to take advantage of Input Panel Autocomplete integration in .NET Framework 3.0 must use a Windows Forms [TextBox](/dotnet/api/system.windows.forms.textbox?view=netcore-3.1) with the [AutoCompleteMode](/dotnet/api/system.windows.forms.textbox.autocompletemode?view=netcore-3.1) property enabled.</span></span> <span data-ttu-id="17708-160">Sie müssen keine weiteren Schritte durchführen, um die automatische Vervollständigung von Windows Forms Auto Vervollständigen zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="17708-160">You need not do any additional work beyond getting Windows Forms Autocomplete to work to take advantage of Input Panel Autocomplete integration.</span></span>

## <a name="using-input-panel-autocomplete-apis-directly"></a><span data-ttu-id="17708-161">Direktes Verwenden von AutoComplete-APIs für den Eingabebereich</span><span class="sxs-lookup"><span data-stu-id="17708-161">Using Input Panel Autocomplete APIs Directly</span></span>

<span data-ttu-id="17708-162">Entwickler benutzerdefinierter Auto Vervollständigen-Textfelder müssen direkt mit dem Eingabebereich der AutoComplete-APIs arbeiten, um die verbesserte Texteingabe zu erhalten, die durch die automatische Vervollständigung durch den Eingabebereich in Ihren Anwendungen ermöglicht wird.</span><span class="sxs-lookup"><span data-stu-id="17708-162">Developers of custom Autocomplete textboxes need to work with the Input Panel Autocomplete APIs directly in order to get the improved text input experience that Input Panel Autocomplete integration enables in their applications.</span></span> <span data-ttu-id="17708-163">Die Auto Vervollständigen-APIs für den Eingabebereich sind als Teil des Windows Vista-Betriebssystems und als Teil des Tablet Platform SDK, Version 1,9 oder höher, enthalten.</span><span class="sxs-lookup"><span data-stu-id="17708-163">The Input Panel Autocomplete APIs are included as part of the Windows Vista operating system and as part of the Tablet Platform SDK version 1.9 or later.</span></span> <span data-ttu-id="17708-164">Die Auto Vervollständigen-Schnittstellen für den Eingabebereich sind COM-basierte Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="17708-164">The Input Panel Autocomplete interfaces are COM-based interfaces.</span></span>

<span data-ttu-id="17708-165">Im folgenden Abschnitt wird beschrieben, wie Sie diese Schnittstellen im Detail für eine C++-Anwendung arbeiten.</span><span class="sxs-lookup"><span data-stu-id="17708-165">The following section describes working these interfaces in detail for a C++ application.</span></span> <span data-ttu-id="17708-166">Diese COM-Schnittstellen können jedoch in den meisten Sprachen (einschließlich C) \# durch die Verwendung von COM-Interop implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="17708-166">However, these COM interfaces can be implemented in most languages, including C\#, through the use of COM Interop.</span></span>

<span data-ttu-id="17708-167">Um die automatische Vervollständigung im Eingabebereich in ein benutzerdefiniertes Textfeld für die automatische Vervollständigung zu implementieren, sind die beiden erforderlichen Schnittstellen die [**itipaudecompleteprovider-Schnittstelle**](itipautocompleteprovider.md) und die [**itipaudecompleteclient-Schnittstelle**](itipautocompleteclient.md).</span><span class="sxs-lookup"><span data-stu-id="17708-167">In order to implement Input Panel Autocomplete integration in a custom Autocomplete text box, the two required interfaces are the [**ITipAutocompleteProvider Interface**](itipautocompleteprovider.md) and the [**ITipAutocompleteClient Interface**](itipautocompleteclient.md).</span></span> <span data-ttu-id="17708-168">Die Definitionen für diese Schnittstellen finden Sie unter tipaudecomplete. h und tipaudecomplete \_ i.c.</span><span class="sxs-lookup"><span data-stu-id="17708-168">The definitions for these interfaces are found in TipAutoComplete.h and TipAutoComplete\_i.c.</span></span>

<span data-ttu-id="17708-169">Zuerst muss eine Anwendung eine Auto Vervollständigen-Anbieter Klasse definieren und instanziieren, die [**itipaudecompleteprovider**](itipautocompleteprovider.md) für jedes Texteingabefeld implementiert, das eine Auto Vervollständigen-Liste enthält.</span><span class="sxs-lookup"><span data-stu-id="17708-169">First, an application must define and instantiate an Autocomplete provider class, which implements [**ITipAutocompleteProvider**](itipautocompleteprovider.md) for each text entry field that includes an Autocomplete list.</span></span> <span data-ttu-id="17708-170">Diese Klasse verwaltet die Anwendungsseite der AutoComplete-Integration.</span><span class="sxs-lookup"><span data-stu-id="17708-170">This class manages the application's side of the Autocomplete integration.</span></span> <span data-ttu-id="17708-171">Alle Auto Vervollständigen-Anforderungen aus dem Eingabebereich werden vom Auto Vervollständigen-Client an die Anwendung über den Auto Vervollständigen-Anbieter der Anwendung gestellt.</span><span class="sxs-lookup"><span data-stu-id="17708-171">All Autocomplete requests from Input Panel are made from the Autocomplete client to the application via the application's Autocomplete provider.</span></span> <span data-ttu-id="17708-172">Der AutoComplete-Anbieter der Anwendung muss sowohl auf das HWND für die Auto Vervollständigen-Liste der Anwendung als auch auf den hwind für das zugehörige Texteingabefeld zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="17708-172">The application's Autocomplete provider must have access to both the HWND for the application's Autocomplete list and the HWIND for the associated text entry field.</span></span> <span data-ttu-id="17708-173">Außerdem müssen die folgenden Methoden von **itipaudecompleteprovider** implementiert werden:</span><span class="sxs-lookup"><span data-stu-id="17708-173">Additionally, the following methods of **ITipAutocompleteProvider** must be implemented:</span></span>

-   <span data-ttu-id="17708-174">[**Itipaudecompleteprovider:: updatependingtext-Methode**](itipautocompleteprovider-updatependingtext.md): Diese Methode wird vom AutoComplete-Client verwendet, um die Anwendung über den Text zu benachrichtigen, den ein Benutzer in den Eingabebereich geschrieben hat.</span><span class="sxs-lookup"><span data-stu-id="17708-174">[**ITipAutocompleteProvider::UpdatePendingText Method**](itipautocompleteprovider-updatependingtext.md): This method is used by the Autocomplete client to notify the application of the text a user has written into Input Panel.</span></span> <span data-ttu-id="17708-175">Beim Empfang dieser Benachrichtigung ist der Anbieter dafür verantwortlich, eine Auto Vervollständigen-Liste zu generieren, als ob der Text in das Texteingabefeld der Anwendung eingegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="17708-175">Upon receiving this notification, the provider is responsible for generating an Autocomplete list as if the text had been typed into the application's text entry field.</span></span> <span data-ttu-id="17708-176">Die Zeichenfolge, die an den AutoComplete-Anbieter über die **itipaudecompleteprovider:: updatependingtext-Methode** übergeben wird, enthält nur den Text, der sich derzeit im Eingabebereich befindet.</span><span class="sxs-lookup"><span data-stu-id="17708-176">The string pass to the Autocomplete provider by means of **ITipAutocompleteProvider::UpdatePendingText Method** only includes the text currently in Input Panel.</span></span> <span data-ttu-id="17708-177">Wenn also zusätzlicher Text im Feld Texteingabe vorhanden ist, liegt es in der Verantwortung des Anbieters, ihn ordnungsgemäß an den vom Client gesendeten Text anzufügen.</span><span class="sxs-lookup"><span data-stu-id="17708-177">Therefore, if there is additional text in the text entry field, it is the responsibility of the provider to properly append it to the text sent by the client.</span></span> <span data-ttu-id="17708-178">Die String Pass by **itipautocompleteprovider:: updatependingtext-Methode** sollte als Ersatz für die aktuelle Auswahl im Feld behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="17708-178">The string pass by **ITipAutocompleteProvider::UpdatePendingText Method** should be treated as a replacement for the current selection in the field.</span></span> <span data-ttu-id="17708-179">Wenn keine aktuelle Auswahl vorhanden ist, sollte diese an der Position der aktuellen Einfügemarke platziert werden.</span><span class="sxs-lookup"><span data-stu-id="17708-179">If there is no current selection, it should be placed at the position of the current insertion point.</span></span> <span data-ttu-id="17708-180">Nachdem die Auto Vervollständigen-Liste generiert wurde, sollte der Anbieter die [**itipaudecompleteprovider:: Show-Methode**](itipautocompleteprovider-show.md) aufrufen **, um die** Auto Vervollständigen-Liste anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="17708-180">Once the Autocomplete list is generated, the provider should call the [**ITipAutocompleteProvider::Show Method**](itipautocompleteprovider-show.md) passing in **TRUE** to display the Autocomplete list.</span></span> <span data-ttu-id="17708-181">Die Anwendung sollte keine Aufrufe von **updatependingtext** Zwischenspeichern, sondern jeden zusätzlichen Aufruf von **updatependingtext** als Abbruch des vorherigen Aufrufs behandeln, um zu vermeiden, dass eine veraltete Auto Vervollständigen-Listen Benutzeroberfläche blinkt. Der folgende Beispielcode veranschaulicht diese Vorgehensweisen.</span><span class="sxs-lookup"><span data-stu-id="17708-181">The application should not cache calls to **UpdatePendingText** but rather treat each additional call to **UpdatePendingText** as a cancellation of the previous call to avoid flashing an out-of-date Autocomplete list UI.The following example code illustrates these practices.</span></span>

    ```C++
    HRESULT SampleProvider::UpdatePendingText(BSTR bstrPendingText)
    {
       //Discard previously cached pending text from Input Panel
       m_bstrPending.Empty();
        //Store the new pending text from Input Panel as m_bstrPending
    m_bstrPending = bstrPendingText;

        //Get the text from the field in two chunks. The characters to
    //the left of the selection and the characters to the right.
    CComBSTR bstrLeftContext = //Text to the left of the selection
            CComBSTR bstrRightContext = //Text to the right of the selection

    //Discard previously cached complete text
        m_bstrCompleteText.Empty();
        //Append to the field text from the left of the selection
        //the text from Input Panel and then append to that
        //the field text to the right of the selection
        m_bstrCompleteText.Append(bstrLeftContext);
        m_bstrCompleteText.Append(m_bstrPending);
        m_bstrCompleteText.Append(bstrRigtContext);

        //Update the app's AC list based on m_bstrCompleteText
        //...

        //Show the updated AC list by calling the provider's Show method
       Show(true);
       return S_OK;
    }
    ```

    

-   <span data-ttu-id="17708-182">[**Itipaudecompleteprovider:: Show-Methode**](itipautocompleteprovider-show.md): Diese Methode wird von [**updatependingtext**](itipautocompleteprovider-updatependingtext.md)aufgerufen, kann aber auch jederzeit vom AutoComplete-Client aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="17708-182">[**ITipAutocompleteProvider::Show Method**](itipautocompleteprovider-show.md): This method is called from [**UpdatePendingText**](itipautocompleteprovider-updatependingtext.md), but also can be called by the Autocomplete client at anytime.</span></span> <span data-ttu-id="17708-183">Nach Erhalt dieses Aufrufes muss der Auto Vervollständigen-Anbieter den Auto Vervollständigen-Anbieter wie durch den-Parameter angegeben ausblenden oder anzeigen.</span><span class="sxs-lookup"><span data-stu-id="17708-183">Upon receiving this call, the Autocomplete provider must hide or show the Autocomplete provider as indicated by the parameter.</span></span> <span data-ttu-id="17708-184">Vor der Anzeige der Auto Vervollständigen-Liste wird vom Auto Vervollständigen-Anbieter erwartet, dass er den AutoComplete-Client über die Position der Auto Vervollständigen-Liste abschließt.</span><span class="sxs-lookup"><span data-stu-id="17708-184">Prior to showing the Autocomplete list the Autocomplete provider is expected to consult the Autocomplete client about where to position the Autocomplete list.</span></span> <span data-ttu-id="17708-185">Weitere Informationen zum Positionieren der Auto Vervollständigen-Liste finden Sie weiter unten in diesem Artikel.</span><span class="sxs-lookup"><span data-stu-id="17708-185">More information about positioning the Autocomplete list appears later in this article.</span></span>

<span data-ttu-id="17708-186">Als nächstes sollte die Anwendung die Active Template Library (ATL)- [**cokreateinstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion verwenden, um eine Instanz der [**itipautocompleteclient-Schnittstelle**](itipautocompleteclient.md) mit der Klassen-ID **CLSID \_ tipautocompleteclient** als Prozess interner Server zu entwickeln und den Anbieter dann beim Client zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="17708-186">Next, the application should use the Active Template Library (ATL) [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function to produce an instance of the [**ITipAutocompleteClient Interface**](itipautocompleteclient.md) with class id **CLSID\_TipAutoCompleteClient** as an in-process server, and then register the provider with the client.</span></span> <span data-ttu-id="17708-187">Die Methode "AutoComplete Client [**itipaudecompleteclient:: adviseprovider**](itipautocompleteclient-adviseprovider.md) " registriert den Anbieter beim Client, damit der Client das Auto Vervollständigen-Anbieter Objekt der Anwendung abrufen kann.</span><span class="sxs-lookup"><span data-stu-id="17708-187">The Autocomplete client [**ITipAutocompleteClient::AdviseProvider Method**](itipautocompleteclient-adviseprovider.md) registers the provider with the client to enable the client to call the application's Autocomplete provider object.</span></span> <span data-ttu-id="17708-188">Wenn tiptsf.dll im System nicht vorhanden ist, schlägt die **cokreateinzustance** -Funktion fehl und gibt **RegDB \_ E \_ classnotreg** zurück.</span><span class="sxs-lookup"><span data-stu-id="17708-188">If tiptsf.dll is not present on the system, the **CoCreateInstance** function fails and returns **REGDB\_E\_CLASSNOTREG**.</span></span> <span data-ttu-id="17708-189">An diesem Punkt kann die Anwendung das [**itipaubucompleteprovider**](itipautocompleteprovider.md) -Objekt verwerfen und fortfahren, als ob der Eingabebereich nicht vorhanden ist, da es nicht auf einem solchen System vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="17708-189">At this point the application can discard its [**ITipAutocompleteProvider**](itipautocompleteprovider.md) object and proceed as if Input Panel does not exist, because it does not on such a system.</span></span>

<span data-ttu-id="17708-190">Die Anwendung kann eine Instanz von [**itipaudecompleteclient**](itipautocompleteclient.md) oder eine Instanz pro Textfeld erstellen.</span><span class="sxs-lookup"><span data-stu-id="17708-190">The application can choose to create one instance of [**ITipAutocompleteClient**](itipautocompleteclient.md) or one instance per text field.</span></span> <span data-ttu-id="17708-191">Die erste Option erfordert, dass der Anbieter bei jeder Änderung des Fokus nicht registriert und registriert wird.</span><span class="sxs-lookup"><span data-stu-id="17708-191">The first option requires the provider to be unregistered and registered each time the focus is changed.</span></span> <span data-ttu-id="17708-192">Weitere Informationen zum Aufheben der Registrierung des Auto Vervollständigen-Anbieters finden Sie weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="17708-192">More information about unregistering the Autocomplete provider appears later in this topic.</span></span>

<span data-ttu-id="17708-193">Bei der Positionierung der Auto Vervollständigen-Liste, die zwischen dem AutoComplete-Anbieter (Anwendung) und dem AutoComplete-Client (Eingabebereich) koordiniert werden muss, sind mehrere Schritte erforderlich.</span><span class="sxs-lookup"><span data-stu-id="17708-193">There are several steps involved in positioning the Autocomplete list that must be coordinated between the Autocomplete provider (application) and the Autocomplete client (Input Panel).</span></span> <span data-ttu-id="17708-194">Bevor die Auto Vervollständigen-Liste angezeigt wird, entweder aufgrund eines Aufrufes der [**Show**](itipautocompleteprovider-show.md) -Methode des Auto Vervollständigen-Anbieters oder aufgrund der Eingabe von Text über die Tastatur durch den Benutzer, muss der Anbieter den Client über die Position der Auto Vervollständigen-Liste informieren.</span><span class="sxs-lookup"><span data-stu-id="17708-194">Before the Autocomplete list is shown, either as a result of a call to the Autocomplete provider's [**Show**](itipautocompleteprovider-show.md) method or due to the user entering text using the keyboard, the provider is required to consult the client about where to position the Autocomplete list.</span></span> <span data-ttu-id="17708-195">Der Anbieter sollte die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="17708-195">The provider should take the following steps:</span></span>

-   <span data-ttu-id="17708-196">Verwenden Sie die [**itipautocompleteclient:: requestshowui-Methode**](itipautocompleteclient-requestshowui.md) des AutoComplete-Clients, um zu bestimmen, ob der Eingabebereich bereit ist, die Auto Vervollständigen-Liste zu sehen.</span><span class="sxs-lookup"><span data-stu-id="17708-196">Use the Autocomplete client's [**ITipAutocompleteClient::RequestShowUI Method**](itipautocompleteclient-requestshowui.md) to determine whether Input Panel is ready to have the Autocomplete list shown.</span></span> <span data-ttu-id="17708-197">**Requestshowui** übernimmt den *HWND* -Parameter, der das HWND für das Auto Vervollständigen-Listenfenster ist, und die Methode gibt **true** oder **false** zurück, um anzugeben, ob es sich um den Zustand handelt, in dem die Auto Vervollständigen-Liste angezeigt werden kann.</span><span class="sxs-lookup"><span data-stu-id="17708-197">**RequestShowUI** takes the *HWND* parameter that is the HWND for the Autocomplete list window, and the method returns **TRUE** or **FALSE** to indicate if it is the state in which the Autocomplete list can be shown.</span></span> <span data-ttu-id="17708-198">Wenn der Client **false** zurückgibt, sollte der Anbieter nicht versuchen, die Auto Vervollständigen-Liste anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="17708-198">If the client returns **FALSE**, the provider should not attempt to show the Autocomplete list.</span></span>
-   <span data-ttu-id="17708-199">Aufrufen von [**requestshowui**](itipautocompleteclient-requestshowui.md) , um das Popup Fenster Handle für die automatische Vervollständigung festzulegen, bevor Sie die [**itipautocompleteclient::P referredrects-Methode**](itipautocompleteclient-preferredrects.md)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="17708-199">Call [**RequestShowUI**](itipautocompleteclient-requestshowui.md) to set the popup Autocomplete list window handle before you call the [**ITipAutocompleteClient::PreferredRects Method**](itipautocompleteclient-preferredrects.md).</span></span> <span data-ttu-id="17708-200">Wenn dies nicht der Fall ist, wird beim Aufrufen von " **preferredrects**" ein **E \_ invalidArg** -Fehler ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="17708-200">Failure to do so will cause an **E\_INVALIDARG** error when calling **PreferredRects**.</span></span>
-   <span data-ttu-id="17708-201">Wenn [**requestshowui**](itipautocompleteclient-requestshowui.md) **true** zurückgibt, sollte der Anbieter das standardmäßige Bildschirm Koordinaten Rechteck der Auto Vervollständigen-Liste basierend auf dem Speicherort des Texteingabe Felds berechnen und dann die [**itipautocompleteclient::P referredrects-Methode**](itipautocompleteclient-preferredrects.md)des AutoComplete-Clients aufrufen.</span><span class="sxs-lookup"><span data-stu-id="17708-201">If [**RequestShowUI**](itipautocompleteclient-requestshowui.md) returns **TRUE**, the provider should calculate the default screen coordinate rectangle of the Autocomplete list based on the location of the text entry field, and then call the Autocomplete client's [**ITipAutocompleteClient::PreferredRects Method**](itipautocompleteclient-preferredrects.md).</span></span> <span data-ttu-id="17708-202">Dies ermöglicht dem AutoComplete-Client das Anpassen des Rechtecks, um die Auto Vervollständigen-Liste mit dem Eingabebereich zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="17708-202">This allows the Autocomplete client to adjust the rectangle to avoid the Autocomplete list overlapping with Input Panel.</span></span> <span data-ttu-id="17708-203">Die **preferredrects** -Methode benötigt vier Parameter:</span><span class="sxs-lookup"><span data-stu-id="17708-203">The **PreferredRects** method takes four parameters:</span></span>

    -   <span data-ttu-id="17708-204">Rect *rcaclist*: das standardmäßige Bildschirm Koordinaten Rechteck der Auto Vervollständigen-Liste.</span><span class="sxs-lookup"><span data-stu-id="17708-204">RECT *rcACList*: The default screen coordinate rectangle of the Autocomplete list.</span></span>
    -   <span data-ttu-id="17708-205">Rect *rcfield*: das Bildschirm Koordinaten Rechteck des entsprechenden Texteingabe Felds.</span><span class="sxs-lookup"><span data-stu-id="17708-205">RECT *rcField*: The screen coordinate rectangle of the corresponding text entry field.</span></span>
    -   <span data-ttu-id="17708-206">Rect *\* prcmodifiedaclist*: das angepasste Bildschirm Koordinaten Rechteck für den Auto Vervollständigen</span><span class="sxs-lookup"><span data-stu-id="17708-206">RECT *\*prcModifiedACList*: The adjusted screen coordinate rectangle for the Autocomplete</span></span>
    -   <span data-ttu-id="17708-207">Bool *\* pfshowover*: dieser Parameter gibt dem Anbieter an, ob das Rechteck *prcmodifiedaclist* die Auto Vervollständigen-Liste oberhalb oder unterhalb des Eingabe Bereichs positioniert.</span><span class="sxs-lookup"><span data-stu-id="17708-207">BOOL *\*pfShowAbove*: This parameter indicates to the provider whether the *prcModifiedACList* rectangle positions the Autocomplete list above or below Input Panel.</span></span> <span data-ttu-id="17708-208">Die Anwendung kann diese Informationen verwenden, um Benutzeroberflächen Elemente, wie z. b. Zieh Punkte und Bild Lauf leisten, ordnungsgemäß zu zeichnen</span><span class="sxs-lookup"><span data-stu-id="17708-208">The application can use this information to correctly draw UI elements such as resize handles and scroll bars.</span></span> <span data-ttu-id="17708-209">Der Anbieter sollte anfänglich in der Richtung übergeben werden, dass die Auto Vervollständigen-Liste in Bezug auf das Texteingabefeld von *rcaclist* positioniert wird.</span><span class="sxs-lookup"><span data-stu-id="17708-209">The provider should initially pass in the direction that the Autocomplete list would be positioned relative to the text entry field by *rcACList*.</span></span> <span data-ttu-id="17708-210">" *Pfshowon* " wird vom Client nicht geändert, wenn " *prcmodifiedaclist* " auf " *rcaclist*" festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="17708-210">The client does not change *pfShowAbove* if it sets *prcModifiedACList* equal to *rcACList*.</span></span>

    <span data-ttu-id="17708-211">Verwenden Sie die Rückgabewerte der Argumente *prcmodifiedaclist* und *pfshowover* Out, um das Fenster Auto Vervollständigen-Liste zu positionieren und anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="17708-211">Use the return values of the *prcModifiedACList* and *pfShowAbove* out arguments to position and show the Autocomplete list window.</span></span> <span data-ttu-id="17708-212">Wenn der Eingabebereich nicht verwendet wird, gibt [**requestshowui**](itipautocompleteclient-requestshowui.md) immer **true** zurück, und *prcmodifiedaclist* ist immer identisch mit *rcaclist*.</span><span class="sxs-lookup"><span data-stu-id="17708-212">If Input Panel is not in use, [**RequestShowUI**](itipautocompleteclient-requestshowui.md) always returns **TRUE** and *prcModifiedACList* is always the same as *rcACList*.</span></span> <span data-ttu-id="17708-213">*pfshowon* ist ebenfalls unverändert. das Ergebnis ist, dass die Aufrufe keine Auswirkung auf das Verhalten der Anwendung haben.</span><span class="sxs-lookup"><span data-stu-id="17708-213">*pfShowAbove* is also unchanged, the result being that the calls have no affect on the application behavior.</span></span> <span data-ttu-id="17708-214">Der folgende Beispielcode veranschaulicht diese Vorgehensweisen.</span><span class="sxs-lookup"><span data-stu-id="17708-214">The following example code illustrates these practices.</span></span>


```C++
HRESULT SampleProvider::Show(BOOL fShow)
{
    //Ask the AC client if it is OK to show the Autocomplete list.
    BOOL fAllowShowing = FALSE;
    m_spACClient->RequestShowUI(m_hWndList, &fAllowShowing);

    if (fShow && fAllowingShowing)
        {
            // Create the parameters required to call PreferredRects
            RECT rcField = //Rectangle for app's text field
            RECT rcACList = //Default rectangle for app's AC list
            RECT rcModifiedACList = {0, 0, 0, 0};
            BOOL fShowAbove = TRUE;

//Ask the AC client to modify the position of the AC list
m_spACClient->PreferredRects(&rcACList, &rcField,
&rcModifiedACList, &fShowAbove);

            //Show the Autocomplete UI at the modified preferred rectangle
            //from rcModifiedACList and the directional info provide by
//fShowAbove
            //...
        }
    else
        {
        //Hide the Autocomplete list and clean up
        //...
        }
    return S_OK;
}
```



<span data-ttu-id="17708-215">Wenn der Benutzer ein Element in der Liste AutoComplete auswählt, muss der Anbieter die [**itipaudecompleteclient:: userselection-Methode**](itipautocompleteclient-userselection.md) des Clients zusätzlich zum Einfügen des ausgewählten Element Texts in das Texteingabefeld aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="17708-215">When the user selects an item in the Autocomplete list, the provider needs to call the client's [**ITipAutocompleteClient::UserSelection Method**](itipautocompleteclient-userselection.md) in addition to inserting the selected item text into the text entry field.</span></span> <span data-ttu-id="17708-216">Der Eingabebereich verwendet diese Benachrichtigung, um den verbleibenden Text zu verwerfen, der noch nicht aus dem Eingabebereich eingefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="17708-216">Input Panel uses this notification to discard all remaining text that has not yet been inserted from Input Panel.</span></span>

<span data-ttu-id="17708-217">Wenn der Anbieter nicht mehr benötigt wird, sollte die Verknüpfung des Anbieters mit dem Auto Vervollständigen-Client aufgehoben werden, indem die [**itipautocompleteclient:: unadviseprovider-Methode**](itipautocompleteclient-unadviseprovider.md) des AutoComplete-Clients aufgerufen wird, um die Registrierung des Anbieters aufzuheben.</span><span class="sxs-lookup"><span data-stu-id="17708-217">Finally, when the provider is no longer necessary, the provider should be unlinked from the Autocomplete client by calling the Autocomplete client's [**ITipAutocompleteClient::UnadviseProvider Method**](itipautocompleteclient-unadviseprovider.md) to unregister the provider.</span></span> <span data-ttu-id="17708-218">Die Registrierung des Anbieters muss aus zwei Gründen aufgehoben werden: da das Texteingabefeld, mit dem der Anbieter verknüpft ist, zerstört wurde, oder weil die Anwendung nur einen Auto Vervollständigen-Client anstelle eines pro-Texteingabe Felds erstellt.</span><span class="sxs-lookup"><span data-stu-id="17708-218">The provider may need to be unregistered for one of two reasons: because the text entry field the provider is associated with has been destroyed, or because the application chooses to create only one Autocomplete client, instead of one per text entry field.</span></span> <span data-ttu-id="17708-219">In dieser Instanz muss die Registrierung des Anbieters jedes Mal aufgehoben werden, wenn der Fokus aus dem Textfeld gewechselt wird.</span><span class="sxs-lookup"><span data-stu-id="17708-219">In this instance the provider must be unregistered every time that focus is switched away from the text field.</span></span>

## <a name="conclusion"></a><span data-ttu-id="17708-220">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="17708-220">Conclusion</span></span>

<span data-ttu-id="17708-221">Die Auto Vervollständigen-Integration im Eingabebereich ist ein leistungsfähiges Tool zur Verbesserung der Benutzer Leistung in Windows-Anwendungen, die Auto Vervollständigen-Listen auf Tablet PCs enthalten.</span><span class="sxs-lookup"><span data-stu-id="17708-221">Input Panel Autocomplete integration is a powerful tool for improving the user experience in Windows applications that include Autocomplete lists on Tablet PCs.</span></span> <span data-ttu-id="17708-222">Ohne Integration müssen Benutzer im Eingabebereich ein mühsames Verfahren zum Einfügen von Text ein Zeichen nacheinander durchlaufen und den Eingabebereich neu positionieren, um AutoComplete zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="17708-222">Without integration, Input Panel users are required to go through a tedious process of inserting text one character at a time and repositioning Input Panel in order to use Autocomplete.</span></span> <span data-ttu-id="17708-223">Mit der-Integration werden AutoComplete-Listen an einem geeigneten Speicherort angezeigt, wenn Benutzer im Eingabebereich frei Hand Eingaben haben, wodurch die Geschwindigkeit und die einfache Texteingabe erhöht werden.</span><span class="sxs-lookup"><span data-stu-id="17708-223">With integration, Autocomplete lists appear in a convenient location as users ink in Input Panel, increasing both the speed and the ease of text entry.</span></span> <span data-ttu-id="17708-224">In Anwendungen, die eine Auto Vervollständigen-Funktionalität enthalten, die auf der Shell Auto vervollständigen oder .NET Framework 3,0 AutoComplete basiert, ist die automatische Vervollständigung im Eingabebereich eine kostenlose und überzeugende Funktion.</span><span class="sxs-lookup"><span data-stu-id="17708-224">In applications that include Autocomplete functionality built on top of Shell Autocomplete or .NET Framework 3.0 Autocomplete, Input Panel Autocomplete integration is a free and compelling feature.</span></span> <span data-ttu-id="17708-225">Außerdem wird ein einfacher Satz von COM-basierten Schnittstellen bereitgestellt, um die gleiche integrierte Benutzeroberfläche für Anwendungen zu ermöglichen, die benutzerdefinierte AutoComplete-Steuerelemente verwenden.</span><span class="sxs-lookup"><span data-stu-id="17708-225">Furthermore, a simple set of COM-based interfaces are provided to enable the same integrated experience for applications that choose to use custom Autocomplete controls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="17708-226">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="17708-226">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="17708-227">Verweis auf Text Eingabe Panel</span><span class="sxs-lookup"><span data-stu-id="17708-227">Text Input Panel Reference</span></span>](text-input-panel-reference.md)
</dt> </dl>

 

 
