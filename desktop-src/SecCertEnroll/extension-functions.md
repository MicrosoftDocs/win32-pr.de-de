---
description: Das X. 509 Version 3-Zertifikat Format identifiziert mehrere Erweiterungen, die einem Zertifikat hinzugefügt werden können, um erweiterte Informationen zur Schlüssel Verwendung, zu Zertifikat Richtlinien und-Einschränkungen, zu alternativen namens Formularen und mehr bereitzustellen.
ms.assetid: d53107b7-a153-41cf-9876-1d28aaf99816
title: Erweiterungsfunktionen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4bc490c8763a00fae9e7fb1e8a702ff87e2c18fd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106357932"
---
# <a name="extension-functions"></a><span data-ttu-id="feac6-103">Erweiterungsfunktionen</span><span class="sxs-lookup"><span data-stu-id="feac6-103">Extension Functions</span></span>

<span data-ttu-id="feac6-104">Das [*X. 509*](/windows/desktop/SecGloss/x-gly) Version 3-Zertifikat Format identifiziert mehrere Erweiterungen, die einem Zertifikat hinzugefügt werden können, um erweiterte Informationen zur Schlüssel Verwendung, zu Zertifikat Richtlinien und-Einschränkungen, zu alternativen namens Formularen und mehr bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="feac6-104">The [*X.509*](/windows/desktop/SecGloss/x-gly) version 3 certificate format identifies multiple extensions that can be added to a certificate to provide enhanced information about key usage, certificate policies and constraints, alternative name forms, and more.</span></span>

<span data-ttu-id="feac6-105">CertEnroll.dll implementiert die folgenden Schnittstellen zum Verwalten von Zertifikat Erweiterungen:</span><span class="sxs-lookup"><span data-stu-id="feac6-105">CertEnroll.dll implements the following interfaces to manage certificate extensions:</span></span>

-   [<span data-ttu-id="feac6-106">**IX509Extension**</span><span class="sxs-lookup"><span data-stu-id="feac6-106">**IX509Extension**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension)
-   [<span data-ttu-id="feac6-107">**IX509Extensions**</span><span class="sxs-lookup"><span data-stu-id="feac6-107">**IX509Extensions**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)
-   [<span data-ttu-id="feac6-108">**IX509ExtensionAlternativeNames**</span><span class="sxs-lookup"><span data-stu-id="feac6-108">**IX509ExtensionAlternativeNames**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionalternativenames)
-   [<span data-ttu-id="feac6-109">**IX509ExtensionAuthorityKeyIdentifier**</span><span class="sxs-lookup"><span data-stu-id="feac6-109">**IX509ExtensionAuthorityKeyIdentifier**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionauthoritykeyidentifier)
-   [<span data-ttu-id="feac6-110">**IX509ExtensionBasicConstraints**</span><span class="sxs-lookup"><span data-stu-id="feac6-110">**IX509ExtensionBasicConstraints**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionbasicconstraints)
-   [<span data-ttu-id="feac6-111">**IX509ExtensionCertificatePolicies**</span><span class="sxs-lookup"><span data-stu-id="feac6-111">**IX509ExtensionCertificatePolicies**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensioncertificatepolicies)
-   [<span data-ttu-id="feac6-112">**IX509ExtensionEnhancedKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="feac6-112">**IX509ExtensionEnhancedKeyUsage**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionenhancedkeyusage)
-   [<span data-ttu-id="feac6-113">**IX509ExtensionKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="feac6-113">**IX509ExtensionKeyUsage**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage)
-   [<span data-ttu-id="feac6-114">**IX509ExtensionMSApplicationPolicies**</span><span class="sxs-lookup"><span data-stu-id="feac6-114">**IX509ExtensionMSApplicationPolicies**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionmsapplicationpolicies)
-   [<span data-ttu-id="feac6-115">**IX509ExtensionSmimeCapabilities**</span><span class="sxs-lookup"><span data-stu-id="feac6-115">**IX509ExtensionSmimeCapabilities**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities)
-   [<span data-ttu-id="feac6-116">**IX509ExtensionSubjectKeyIdentifier**</span><span class="sxs-lookup"><span data-stu-id="feac6-116">**IX509ExtensionSubjectKeyIdentifier**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier)
-   [<span data-ttu-id="feac6-117">**IX509ExtensionTemplate**</span><span class="sxs-lookup"><span data-stu-id="feac6-117">**IX509ExtensionTemplate**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate)
-   [<span data-ttu-id="feac6-118">**IX509ExtensionTemplateName**</span><span class="sxs-lookup"><span data-stu-id="feac6-118">**IX509ExtensionTemplateName**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename)

<span data-ttu-id="feac6-119">In den folgenden Abschnitten wird eine Funktion erläutert, die von Xenroll.dll zum Verwalten von Zertifikat Erweiterungen exportiert wird.</span><span class="sxs-lookup"><span data-stu-id="feac6-119">Each of the following sections discusses a function exported by Xenroll.dll to manage certificate extensions.</span></span> <span data-ttu-id="feac6-120">Außerdem wird in jedem Abschnitt erläutert, wie CertEnroll.dll verwendet wird, um die Funktion zu ersetzen, oder es wird angegeben, dass keine Zuordnung zwischen den beiden Bibliotheken besteht:</span><span class="sxs-lookup"><span data-stu-id="feac6-120">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="feac6-121">Addcerttypeer-equestwstr</span><span class="sxs-lookup"><span data-stu-id="feac6-121">AddCertTypeToRequestWStr</span></span>](#addcerttypetorequestwstr)
-   [<span data-ttu-id="feac6-122">Addcerttypeer-equestwstrex</span><span class="sxs-lookup"><span data-stu-id="feac6-122">AddCertTypeToRequestWStrEx</span></span>](#addcerttypetorequestwstrex)
-   [<span data-ttu-id="feac6-123">Addextensionstorequest</span><span class="sxs-lookup"><span data-stu-id="feac6-123">AddExtensionsToRequest</span></span>](#addextensionstorequest)
-   [<span data-ttu-id="feac6-124">addextensiontor equestwstr</span><span class="sxs-lookup"><span data-stu-id="feac6-124">addExtensionToRequestWStr</span></span>](#addextensiontorequestwstr)
-   [<span data-ttu-id="feac6-125">Enablesmime-Funktionen</span><span class="sxs-lookup"><span data-stu-id="feac6-125">EnableSMIMECapabilities</span></span>](#enablesmimecapabilities)
-   [<span data-ttu-id="feac6-126">Includecosubjetkeyid</span><span class="sxs-lookup"><span data-stu-id="feac6-126">IncludeSubjectKeyID</span></span>](#includesubjectkeyid)
-   [<span data-ttu-id="feac6-127">Redie Text Tensions</span><span class="sxs-lookup"><span data-stu-id="feac6-127">resetExtensions</span></span>](#resetextensions)
-   [<span data-ttu-id="feac6-128">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="feac6-128">Related topics</span></span>](#related-topics)

## <a name="addcerttypetorequestwstr"></a><span data-ttu-id="feac6-129">Addcerttypeer-equestwstr</span><span class="sxs-lookup"><span data-stu-id="feac6-129">AddCertTypeToRequestWStr</span></span>

<span data-ttu-id="feac6-130">Die [**addcerttypeer equestwstr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr) -Funktion in Xenroll.dll fügt einer Anforderung eine Zertifikat Vorlage namens hinzu.</span><span class="sxs-lookup"><span data-stu-id="feac6-130">The [**AddCertTypeToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr) function in Xenroll.dll adds a certificate template, by name, to a request.</span></span>

<span data-ttu-id="feac6-131">Wenn Sie CertEnroll.dll verwenden, ist die bevorzugte Methode zum Einbinden einer Vorlage in eine Zertifikat Anforderung die Verwendung der [**initializefromtemplatename**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromtemplatename) -Methode für ein PKCS \# 10-oder [\* PKCS-Anforderungs Objekt oder die [**initializefrominnerrequesttemplatename**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-initializefrominnerrequesttemplatename) -Methode für eine CMC-Anforderung.</span><span class="sxs-lookup"><span data-stu-id="feac6-131">Using CertEnroll.dll, the preferred method to incorporate a template into a certificate request is to use the [**InitializeFromTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromtemplatename) method on a PKCS\#10 or [\*PKCS ) request object or the [**InitializeFromInnerRequestTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-initializefrominnerrequesttemplatename) method on a CMC request.</span></span>

<span data-ttu-id="feac6-132">Wenn eine bestimmte Vorlage nicht auf dem Client verfügbar ist, aber von der Zertifizierungsstelle ( [*Certification Authority*](/windows/desktop/SecGloss/c-gly) , ca) verstanden werden soll, können Sie die [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) -Schnittstelle verwenden, um eine Version 1-Vorlage hinzuzufügen, oder Sie können die [**IX509ExtensionTemplate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate) -Schnittstelle verwenden, um einer Zertifikat Anforderung eine Vorlage der Version 2 hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="feac6-132">If a specific template is not available on the client but is expected to be understood by the [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA), you can use the [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) interface to add a version 1 template or you can use the [**IX509ExtensionTemplate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate) interface to add a version 2 template to a certificate request.</span></span> <span data-ttu-id="feac6-133">Um z. b. eine Vorlage der Version 1 hinzuzufügen, führen Sie die folgenden Aktionen aus:</span><span class="sxs-lookup"><span data-stu-id="feac6-133">For example, to add a version 1 template, perform the following actions:</span></span>

1.  <span data-ttu-id="feac6-134">Erstellen Sie ein [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) -Objekt.</span><span class="sxs-lookup"><span data-stu-id="feac6-134">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="feac6-135">Erstellen Sie ein [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) -Objekt, und rufen Sie die [**initializeencode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensiontemplatename-initializeencode) -Methode auf, wobei Sie den Vorlagen Namen angeben.</span><span class="sxs-lookup"><span data-stu-id="feac6-135">Create an [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensiontemplatename-initializeencode) method, specifying the template name.</span></span>
3.  <span data-ttu-id="feac6-136">Fügen Sie die erstellte Erweiterung der [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) -Auflistung hinzu, indem Sie die [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="feac6-136">Add the extension created to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>
4.  <span data-ttu-id="feac6-137">Erstellen Sie ein [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) -Objekt, und rufen Sie die [**initializeencode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) -Methode auf, wobei Sie die [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) -Auflistung bei Eingabe angeben</span><span class="sxs-lookup"><span data-stu-id="feac6-137">Create an [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) method, specifying the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection on input.</span></span>
5.  <span data-ttu-id="feac6-138">Rufen Sie ein [**icryptattributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) -Sammlungsobjekt ab, indem Sie die [**cryptattributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) -Eigenschaft für ein vorhandenes [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) -oder [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) Request-Objekt aufrufen.</span><span class="sxs-lookup"><span data-stu-id="feac6-138">Retrieve an [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) collection object by calling the [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) property on an existing [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) or [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) request object.</span></span>

## <a name="addcerttypetorequestwstrex"></a><span data-ttu-id="feac6-139">Addcerttypeer-equestwstrex</span><span class="sxs-lookup"><span data-stu-id="feac6-139">AddCertTypeToRequestWStrEx</span></span>

<span data-ttu-id="feac6-140">Die [**addcerttypeer equestwstrex**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex) -Funktion in Xenroll.dll fügt eine Zertifikat Vorlage anhand des Namens, des Objekt Bezeichners und der Version einer Anforderung hinzu.</span><span class="sxs-lookup"><span data-stu-id="feac6-140">The [**AddCertTypeToRequestWStrEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex) function in Xenroll.dll adds a certificate template to a request by name, object identifier, and version.</span></span>

<span data-ttu-id="feac6-141">Informationen zum Verwenden von CertEnroll.dll zum Einbinden von Vorlagen Informationen in eine Anforderung finden Sie unter addcerttypeer-equestwstr.</span><span class="sxs-lookup"><span data-stu-id="feac6-141">For information about how to use CertEnroll.dll to incorporate template information in a request, see AddCertTypeToRequestWStr.</span></span>

## <a name="addextensionstorequest"></a><span data-ttu-id="feac6-142">Addextensionstorequest</span><span class="sxs-lookup"><span data-stu-id="feac6-142">AddExtensionsToRequest</span></span>

<span data-ttu-id="feac6-143">Die [**addextensionstorequest**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addextensionstorequest) -Funktion in Xenroll.dll fügt einer Anforderung eine Auflistung von Erweiterungen hinzu.</span><span class="sxs-lookup"><span data-stu-id="feac6-143">The [**AddExtensionsToRequest**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addextensionstorequest) function in Xenroll.dll adds a collection of extensions to a request.</span></span>

<span data-ttu-id="feac6-144">In CertEnroll.dll werden Erweiterungen zur Attribute-Auflistung einer CMC-oder PKCS 10-Anforderung hinzugefügt \# .</span><span class="sxs-lookup"><span data-stu-id="feac6-144">In CertEnroll.dll, extensions are added to the attributes collection of a CMC or a PKCS \#10 request.</span></span> <span data-ttu-id="feac6-145">Um Erweiterungen hinzuzufügen, führen Sie die folgenden Aktionen aus:</span><span class="sxs-lookup"><span data-stu-id="feac6-145">To add extensions, perform the following actions:</span></span>

1.  <span data-ttu-id="feac6-146">Erstellen Sie ein [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) -Objekt.</span><span class="sxs-lookup"><span data-stu-id="feac6-146">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="feac6-147">Erstellen Sie ein [**IX509Extension**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension) -Objekt, und rufen Sie die [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extension-initialize) -Methode auf, um eine Erweiterung von einem Objekt Bezeichner und einem Erweiterungs Wert zu erstellen, oder verwenden Sie eine der zuvor aufgelisteten Schnittstellen, um eine der allgemeineren Erweiterungen zu definieren.</span><span class="sxs-lookup"><span data-stu-id="feac6-147">Create an [**IX509Extension**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension) object and call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extension-initialize) method to create an extension from an object identifier and extension value or use any of the interfaces listed earlier to define one of the more common extensions.</span></span>
3.  <span data-ttu-id="feac6-148">Fügen Sie alle neuen Erweiterungen, die im vorherigen Schritt erstellt wurden, der [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) -Auflistung hinzu, indem [**Sie die Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="feac6-148">Add each new extension created in the preceding step to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>

## <a name="addextensiontorequestwstr"></a><span data-ttu-id="feac6-149">addextensiontor equestwstr</span><span class="sxs-lookup"><span data-stu-id="feac6-149">addExtensionToRequestWStr</span></span>

<span data-ttu-id="feac6-150">Die [**addextensiontorequestwstr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr) -Funktion in Xenroll.dll fügt der Anforderung eine bestimmte Erweiterung hinzu.</span><span class="sxs-lookup"><span data-stu-id="feac6-150">The [**addExtensionToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr) function in Xenroll.dll adds a specific extension to the request.</span></span>

<span data-ttu-id="feac6-151">In CertEnroll.dll muss eine bestimmte Erweiterung definiert und einer Erweiterungs Auflistung hinzugefügt werden, bevor die Erweiterungs Sammlung der Attribut Auflistung einer SMTP-oder PKCS 10-Anforderung hinzugefügt wird \# .</span><span class="sxs-lookup"><span data-stu-id="feac6-151">In CertEnroll.dll, a specific extension must be defined and added to an extensions collection before the extension collection is added to the attributes collection of a CMC or a PKCS \#10 request.</span></span> <span data-ttu-id="feac6-152">Weitere Informationen finden Sie in der obigen Beschreibung von addextensionstorequest.</span><span class="sxs-lookup"><span data-stu-id="feac6-152">For more information see the AddExtensionsToRequest discussion above.</span></span>

## <a name="enablesmimecapabilities"></a><span data-ttu-id="feac6-153">Enablesmime-Funktionen</span><span class="sxs-lookup"><span data-stu-id="feac6-153">EnableSMIMECapabilities</span></span>

<span data-ttu-id="feac6-154">Mit der [**enablesmimefunctions**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_enablesmimecapabilities) -Funktion in Xenroll.dll wird ein boolescher Wert angegeben oder abgerufen, der angibt, ob die **smimefunctions** -Erweiterung der Anforderung hinzugefügt werden soll.</span><span class="sxs-lookup"><span data-stu-id="feac6-154">The [**EnableSMIMECapabilities**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_enablesmimecapabilities) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to add the **SMIMECapabilities** extension to the request.</span></span>

<span data-ttu-id="feac6-155">Sie können die [**smimefunktionen**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_smimecapabilities) -Eigenschaft des [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) -Objekts zum automatischen Hinzufügen eines [**IX509ExtensionSmimeCapabilities**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities) -Objekts zur Anforderung vor der Codierung aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="feac6-155">You can call the [**SmimeCapabilities**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_smimecapabilities) property on the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object to automatically add an [**IX509ExtensionSmimeCapabilities**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities) object to the request before encoding.</span></span>

## <a name="includesubjectkeyid"></a><span data-ttu-id="feac6-156">Includecosubjetkeyid</span><span class="sxs-lookup"><span data-stu-id="feac6-156">IncludeSubjectKeyID</span></span>

<span data-ttu-id="feac6-157">Die [**includesubjetkeyid**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_includesubjectkeyid) -Funktion in Xenroll.dll gibt einen booleschen Wert an oder ruft ihn ab, der angibt, ob die " **subjetkeyidentifier** "-Erweiterung der Anforderung hinzugefügt werden soll.</span><span class="sxs-lookup"><span data-stu-id="feac6-157">The [**IncludeSubjectKeyID**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_includesubjectkeyid) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to add the **SubjectKeyIdentifier** extension to the request.</span></span>

<span data-ttu-id="feac6-158">Standardmäßig wird die " **subjetkeyidentifier** "-Erweiterung erstellt, wenn das [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) Request-Objekt initialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="feac6-158">By default, the **SubjectKeyIdentifier** extension is created when the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) request object is initialized.</span></span> <span data-ttu-id="feac6-159">Sie können dieses Verhalten überschreiben, indem Sie die [**suppressoids**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_suppressoids) -Eigenschaft aufrufen.</span><span class="sxs-lookup"><span data-stu-id="feac6-159">You can override this behavior by calling the [**SuppressOids**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_suppressoids) property.</span></span>

<span data-ttu-id="feac6-160">Wenn Sie über ein [*öffentliches/privates Schlüsselpaar*](/windows/desktop/SecGloss/p-gly)verfügen, können Sie auch die [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) -Schnittstelle in CertEnroll.dll verwenden, um einer Zertifikat Anforderung eine " **subjetkeyidentifier** "-Erweiterung hinzuzufügen, indem Sie die folgenden Aktionen ausführen:</span><span class="sxs-lookup"><span data-stu-id="feac6-160">If you have a [*public/private key pair*](/windows/desktop/SecGloss/p-gly), you can also use the [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) interface in CertEnroll.dll to add a **SubjectKeyIdentifier** extension to a certificate request by performing the following actions:</span></span>

1.  <span data-ttu-id="feac6-161">Erstellen Sie ein [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) -Objekt.</span><span class="sxs-lookup"><span data-stu-id="feac6-161">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="feac6-162">Erstellen Sie ein [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) -Objekt, und rufen Sie die [**initializeencode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensionsubjectkeyidentifier-initializeencode) -Methode auf, und geben Sie eine Zeichenfolge mit dem Bezeichner</span><span class="sxs-lookup"><span data-stu-id="feac6-162">Create an [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensionsubjectkeyidentifier-initializeencode) method, specifying a string that contains the identifier.</span></span> <span data-ttu-id="feac6-163">In der Regel handelt es sich hierbei um einen 20-Byte-SHA-1-Hash des [*öffentlichen Schlüssels*](/windows/desktop/SecGloss/p-gly) , der im Zertifizierungsstellen-Signaturzertifikat enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="feac6-163">Typically, this is a 20-byte SHA-1 hash of the [*public key*](/windows/desktop/SecGloss/p-gly) contained in the CA signing certificate.</span></span>
3.  <span data-ttu-id="feac6-164">Fügen Sie die erstellte Erweiterung der [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) -Auflistung hinzu, indem Sie die [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="feac6-164">Add the extension created to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>
4.  <span data-ttu-id="feac6-165">Erstellen Sie ein [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) -Objekt, und rufen Sie die [**initializeencode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) -Methode auf, wobei Sie die [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) -Auflistung bei Eingabe angeben</span><span class="sxs-lookup"><span data-stu-id="feac6-165">Create an [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) method, specifying the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection on input.</span></span>
5.  <span data-ttu-id="feac6-166">Rufen Sie ein [**icryptattributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) -Sammlungsobjekt ab, indem Sie die [**cryptattributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) -Eigenschaft für ein vorhandenes [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) -oder [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) Request-Objekt aufrufen.</span><span class="sxs-lookup"><span data-stu-id="feac6-166">Retrieve an [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) collection object by calling the [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) property on an existing [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) or [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) request object.</span></span>

## <a name="resetextensions"></a><span data-ttu-id="feac6-167">Redie Text Tensions</span><span class="sxs-lookup"><span data-stu-id="feac6-167">resetExtensions</span></span>

<span data-ttu-id="feac6-168">Die [**resettextensions**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-resetextensions) -Funktion in Xenroll.dll entfernt die Erweiterungs Sammlung aus der Anforderung.</span><span class="sxs-lookup"><span data-stu-id="feac6-168">The [**resetExtensions**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-resetextensions) function in Xenroll.dll removes the extension collection from the request.</span></span>

<span data-ttu-id="feac6-169">Um eine Erweiterung aus einer Anforderung nach Indexnummer mithilfe CertEnroll.dll zu entfernen, müssen Sie die [**Remove**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-remove) -Methode für die [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) -Auflistung verwenden.</span><span class="sxs-lookup"><span data-stu-id="feac6-169">To remove an extension from a request by index number using CertEnroll.dll, call the [**Remove**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-remove) method on the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection.</span></span> <span data-ttu-id="feac6-170">Um alle Attribute aus einer Anforderung zu entfernen, müssen Sie die [**Clear**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-clear) -Methode aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="feac6-170">To remove all attributes from a request, call the [**Clear**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-clear) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="feac6-171">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="feac6-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="feac6-172">Zuordnung von Xenroll.dll zu CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="feac6-172">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="feac6-173">**Icryptattributes**</span><span class="sxs-lookup"><span data-stu-id="feac6-173">**ICryptAttributes**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes)
</dt> <dt>

[<span data-ttu-id="feac6-174">**IX509Extension**</span><span class="sxs-lookup"><span data-stu-id="feac6-174">**IX509Extension**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension)
</dt> <dt>

[<span data-ttu-id="feac6-175">**IX509Extensions**</span><span class="sxs-lookup"><span data-stu-id="feac6-175">**IX509Extensions**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)
</dt> </dl>

 

 
