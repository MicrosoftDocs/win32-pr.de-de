---
description: Erstellt eine benutzerdefinierte PKCS \# 10-Anforderung, übergibt sie an eine eigenständige Zertifizierungsstelle (Certification Authority, ca) und installiert das ausgegebene Zertifikat im Zertifikat Speicher.
ms.assetid: dcb69d7e-457e-457b-9eea-15676ed710aa
title: enrollCustomPKCS10
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 86ad95f483d4bc82136865e94a70ad46e90e1c24
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106359891"
---
# <a name="enrollcustompkcs10"></a><span data-ttu-id="a14fa-103">enrollCustomPKCS10</span><span class="sxs-lookup"><span data-stu-id="a14fa-103">enrollCustomPKCS10</span></span>

<span data-ttu-id="a14fa-104">Das enrollCustomPKCS10-Beispiel erstellt eine benutzerdefinierte PKCS \# 10-Anforderung, sendet Sie an eine eigenständige Zertifizierungsstelle (Certification Authority, ca) und installiert das ausgegebene Zertifikat im Zertifikat Speicher.</span><span class="sxs-lookup"><span data-stu-id="a14fa-104">The enrollCustomPKCS10 sample creates a custom PKCS \#10 request, submits it to a stand-alone certification authority (CA), and installs the issued certificate in the certificate store.</span></span> <span data-ttu-id="a14fa-105">Eine eigenständige Zertifizierungsstelle erfordert keine Active Directory und verwendet keine Vorlagen.</span><span class="sxs-lookup"><span data-stu-id="a14fa-105">A stand-alone CA does not require Active Directory and does not use templates.</span></span>

## <a name="location"></a><span data-ttu-id="a14fa-106">Standort</span><span class="sxs-lookup"><span data-stu-id="a14fa-106">Location</span></span>

<span data-ttu-id="a14fa-107">Wenn Sie das Microsoft Windows Software Development Kit (SDK) installieren, wird das Beispiel standardmäßig im Ordner *% Program Files%* \\ Microsoft SDKs \\ Windows \\ v 7.0 \\ Samples \\ Security \\ X509 Certificate Einschreibung \\ VC \\ enrollCustomPKCS10 installiert.</span><span class="sxs-lookup"><span data-stu-id="a14fa-107">When you install the Microsoft Windows Software Development Kit (SDK), the sample is installed, by default, in the *%ProgramFiles%*\\Microsoft SDKs\\Windows\\v7.0\\Samples\\Security\\X509 Certificate Enrollment\\VC\\enrollCustomPKCS10 folder.</span></span>

## <a name="discussion"></a><span data-ttu-id="a14fa-108">Diskussion</span><span class="sxs-lookup"><span data-stu-id="a14fa-108">Discussion</span></span>

<span data-ttu-id="a14fa-109">Das enrollCustomPKCS10-Beispiel:</span><span class="sxs-lookup"><span data-stu-id="a14fa-109">The enrollCustomPKCS10 sample:</span></span>

1.  <span data-ttu-id="a14fa-110">Verarbeitet die Befehlszeilenargumente.</span><span class="sxs-lookup"><span data-stu-id="a14fa-110">Processes the command line arguments.</span></span> <span data-ttu-id="a14fa-111">Die Befehlszeile muss den Antragsteller Namen des X. 500-Zertifikats, den e-Mail-Namen (RFC822) und eine EKU-Objekt Kennung (Enhanced Key Usage, EKU) enthalten.</span><span class="sxs-lookup"><span data-stu-id="a14fa-111">The command line should contain the X.500 certificate subject name, the email (RFC822) name, and an Enhanced Key Usage (EKU) object identifier (OID).</span></span> <span data-ttu-id="a14fa-112">Sie können z. b. die folgenden Argumente angeben, die registriert werden sollen *user1@example.com* :</span><span class="sxs-lookup"><span data-stu-id="a14fa-112">For example, you can specify the following arguments to enroll *user1@example.com*:</span></span>
    -   <span data-ttu-id="a14fa-113">Antragsteller Name: "*CN = user1, DC = example, DC = com*"</span><span class="sxs-lookup"><span data-stu-id="a14fa-113">Subject name: "*CN=user1,DC=example,DC=com*"</span></span>
    -   <span data-ttu-id="a14fa-114">RFC822 Name: *user1@example.com*</span><span class="sxs-lookup"><span data-stu-id="a14fa-114">RFC822 name: *user1@example.com*</span></span>
    -   <span data-ttu-id="a14fa-115">Clientauthentifizierungs-EKU-OID: 1.3.6.1.5.5.7.3.2</span><span class="sxs-lookup"><span data-stu-id="a14fa-115">Client authentication EKU OID: 1.3.6.1.5.5.7.3.2</span></span>
2.  <span data-ttu-id="a14fa-116">Erstellt ein [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) -Objekt und initialisiert es für den Endbenutzer, indem der **contextUser** -Wert der [**X509CertificateEnrollmentContext**](/windows/desktop/api/CertEnroll/ne-certenroll-x509certificateenrollmentcontext) -Enumeration angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="a14fa-116">Creates an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object and initializes it for the end user by specifying the **ContextUser** value of the [**X509CertificateEnrollmentContext**](/windows/desktop/api/CertEnroll/ne-certenroll-x509certificateenrollmentcontext) enumeration.</span></span>
3.  <span data-ttu-id="a14fa-117">Erstellt ein [**IX500DistinguishedName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix500distinguishedname) -Objekt, verwendet das-Objekt, um den Betreffnamen in ein Bytearray zu codieren, und fügt das Array dem PKCS \# 10-Anforderungs Objekt hinzu.</span><span class="sxs-lookup"><span data-stu-id="a14fa-117">Creates an [**IX500DistinguishedName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix500distinguishedname) object, uses the object to encode the subject name to a byte array, and adds the array to the PKCS \#10 request object.</span></span>
4.  <span data-ttu-id="a14fa-118">Erstellt ein [**iobjectid**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid) -Objekt, initialisiert es mithilfe der in der Befehlszeile angegebenen EKU-Objekt Kennung (OID), erstellt eine [**iobjectids**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectids) -Auflistung, fügt das neue **iobjectid** -Objekt (EKU) der Auflistung hinzu, verwendet die-Auflistung, um ein [**IX509ExtensionEnhancedKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionenhancedkeyusage) -Objekt zu initialisieren, und fügt dieses-Objekt der Anforderung hinzu.</span><span class="sxs-lookup"><span data-stu-id="a14fa-118">Creates an [**IObjectId**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid) object, initializes it by using the EKU object identifier (OID) specified on the command line, creates an [**IObjectIds**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectids) collection, adds the new **IObjectId** (EKU) object to the collection, uses the collection to initialize an [**IX509ExtensionEnhancedKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionenhancedkeyusage) object and adds this object to the request.</span></span>
5.  <span data-ttu-id="a14fa-119">Erstellt ein [**ialternativename**](/windows/desktop/api/CertEnroll/nn-certenroll-ialternativename) -Objekt, initialisiert es mit dem in der Befehlszeile angegebenen RFC822-Namen, erstellt eine [**ialternativenames**](/windows/desktop/api/CertEnroll/nn-certenroll-ialternativenames) -Auflistung, fügt das neue **ialternativename** (RFC822 Name)-Objekt der-Auflistung hinzu, erstellt ein [**IX509ExtensionAlternativeNames**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionalternativenames) -Objekt und fügt dieses-Objekt der Anforderung hinzu.</span><span class="sxs-lookup"><span data-stu-id="a14fa-119">Creates an [**IAlternativeName**](/windows/desktop/api/CertEnroll/nn-certenroll-ialternativename) object, initializes it by using the RFC822 name specified on the command line, Creates an [**IAlternativeNames**](/windows/desktop/api/CertEnroll/nn-certenroll-ialternativenames) collection, adds the new **IAlternativeName** (RFC822 name ) object to the collection, creates an [**IX509ExtensionAlternativeNames**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionalternativenames) object and adds this object to the request.</span></span>
6.  <span data-ttu-id="a14fa-120">Erstellt ein [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) -Objekt, initialisiert es mit dem [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) -Objekt und ruft eine Zeichenfolge ab, die eine Base64-codierte Anforderung enthält.</span><span class="sxs-lookup"><span data-stu-id="a14fa-120">Creates an [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object, initializes it by using the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object, and retrieves a string that contains a base64-encoded request.</span></span>
7.  <span data-ttu-id="a14fa-121">Erstellt ein [**ICertConfig**](/windows/desktop/api/certcli/nn-certcli-icertconfig) -Objekt und verwendet es, um eine Zeichenfolge abzurufen, die die Zertifizierungsstellen Konfiguration enthält.</span><span class="sxs-lookup"><span data-stu-id="a14fa-121">Creates an [**ICertConfig**](/windows/desktop/api/certcli/nn-certcli-icertconfig) object and uses it to retrieve a string that contains the CA configuration.</span></span>
8.  <span data-ttu-id="a14fa-122">Erstellt ein CryptoAPI [**ICertRequest2**](/windows/desktop/api/certcli/nn-certcli-icertrequest2) -Objekt und verwendet es sowie die Zeichen folgen, die die Zertifizierungsstellen Konfiguration enthalten, und die Zertifikat Anforderung zum übermitteln der Anforderung an die Zertifizierungsstelle.</span><span class="sxs-lookup"><span data-stu-id="a14fa-122">Creates a CryptoAPI [**ICertRequest2**](/windows/desktop/api/certcli/nn-certcli-icertrequest2) object and uses it plus the strings that contain the CA configuration and the certificate request to submit the request to the CA.</span></span>
9.  <span data-ttu-id="a14fa-123">Überprüft den Übermittlungs Status und installiert das Zertifikat im Zertifikat Speicher, wenn die Registrierung erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="a14fa-123">Checks the submission status and, if enrollment is successful, installs the certificate to the certificate store.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a14fa-124">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="a14fa-124">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a14fa-125">PKCS \# 10-Anforderung</span><span class="sxs-lookup"><span data-stu-id="a14fa-125">PKCS \#10 Request</span></span>](pkcs--10-request.md)
</dt> <dt>

[<span data-ttu-id="a14fa-126">Verwenden der enthaltenen Beispiele</span><span class="sxs-lookup"><span data-stu-id="a14fa-126">Using the Included Samples</span></span>](using-the-included-samples.md)
</dt> </dl>

 

 
