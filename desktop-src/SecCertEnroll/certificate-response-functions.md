---
description: Implementiert die IX509Enrollment-Schnittstelle.
ms.assetid: bcf5c2f0-b99f-4de5-83f4-44f17dc31cd4
title: Funktionen für Zertifikat Antworten
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 15eec71d0493fa4961988b86db0397d0fd516508
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106347476"
---
# <a name="certificate-response-functions"></a><span data-ttu-id="1eec6-103">Funktionen für Zertifikat Antworten</span><span class="sxs-lookup"><span data-stu-id="1eec6-103">Certificate Response Functions</span></span>

<span data-ttu-id="1eec6-104">CertEnroll.dll implementiert die [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) -Schnittstelle, um eine Client Zertifikat Anforderung zu senden und die Antwort von einer Zertifizierungsstelle ( [*Certification Authority*](/windows/desktop/SecGloss/c-gly) , ca) zu installieren.</span><span class="sxs-lookup"><span data-stu-id="1eec6-104">CertEnroll.dll implements the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) interface to submit a client certificate request and install the response from a [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA).</span></span>

<span data-ttu-id="1eec6-105">Der Registrierungsvorgang kann die folgenden drei Szenarien erfüllen:</span><span class="sxs-lookup"><span data-stu-id="1eec6-105">The enrollment process can accommodate the following three scenarios:</span></span>

<dl> <span data-ttu-id="1eec6-106">Out-of-Band-Registrierung</span><span class="sxs-lookup"><span data-stu-id="1eec6-106">Out-of-band enrollment</span></span>

1.  <span data-ttu-id="1eec6-107">Ruft eine beliebige Initialisierungs Methode auf, die vom [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) -Objekt implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="1eec6-107">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="1eec6-108">Rufen Sie die Methode " [**kreaterequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) " auf, um die Anforderung abzurufen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-108">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="1eec6-109">Senden Sie die Anforderung out-of-Band (manuell oder mithilfe eines anderen Prozesses).</span><span class="sxs-lookup"><span data-stu-id="1eec6-109">Submit the request out of band (manually or by using some other process).</span></span>
4.  <span data-ttu-id="1eec6-110">Empfangen Sie die Antwort von einer Zertifizierungsstelle.</span><span class="sxs-lookup"><span data-stu-id="1eec6-110">Receive the response from a CA.</span></span>
5.  <span data-ttu-id="1eec6-111">Nennen Sie die [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) -Methode.</span><span class="sxs-lookup"><span data-stu-id="1eec6-111">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

  
<span data-ttu-id="1eec6-112">Automatische Registrierung</span><span class="sxs-lookup"><span data-stu-id="1eec6-112">Automatic enrollment</span></span>

1.  <span data-ttu-id="1eec6-113">Ruft eine beliebige Initialisierungs Methode auf, die vom [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) -Objekt implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="1eec6-113">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="1eec6-114">Ruft die [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="1eec6-114">Call the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method.</span></span>

  
<span data-ttu-id="1eec6-115">Verzögerte Registrierung</span><span class="sxs-lookup"><span data-stu-id="1eec6-115">Delayed enrollment</span></span>

1.  <span data-ttu-id="1eec6-116">Ruft eine beliebige Initialisierungs Methode auf, die vom [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) -Objekt implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="1eec6-116">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="1eec6-117">Rufen Sie die Methode " [**kreaterequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) " auf, um die Anforderung abzurufen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-117">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="1eec6-118">Speichern Sie die Anforderung, bis Sie bereit sind, Sie zu senden.</span><span class="sxs-lookup"><span data-stu-id="1eec6-118">Store the request until you are ready to submit it.</span></span>
4.  <span data-ttu-id="1eec6-119">Wenn Sie zur Registrierung bereit sind, können Sie die [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) -Methode zum erneuten Initialisieren des anmeldungsobjekts aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-119">When you are ready to enroll, call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) method to reinitialize the enrollment object.</span></span>
5.  <span data-ttu-id="1eec6-120">Ruft die [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) -Methode auf, wenn die Zertifizierungsstelle ein Zertifikat zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="1eec6-120">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method when the CA returns a certificate.</span></span>

  
</dl>

<span data-ttu-id="1eec6-121">Während des Registrierungsvorgangs können Sie die [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) -Eigenschaft für das [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) -Objekt aufrufen, um einen-Registrierungs Registrierungs [**Status**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) -Enumerationswert abzurufen, der angibt, ob die Registrierung erfolgreich war, aussteht, abgebrochen wurde, ein Fehler generiert wurde oder verweigert wurde.</span><span class="sxs-lookup"><span data-stu-id="1eec6-121">During the enrollment process, you can call the [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve an [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) enumeration value that identifies whether enrollment succeeded, is pending, was skipped, generated an error, or was denied.</span></span>

<span data-ttu-id="1eec6-122">In den folgenden Abschnitten wird eine Funktion identifiziert, die von Xenroll.dll exportiert wird, um eine Zertifikat Antwort von einer Zertifizierungsstelle zu installieren.</span><span class="sxs-lookup"><span data-stu-id="1eec6-122">Each of the following sections identifies a function exported by Xenroll.dll to install a certificate response from a CA.</span></span> <span data-ttu-id="1eec6-123">Außerdem wird in jedem Abschnitt erläutert, wie CertEnroll.dll verwendet wird, um die Funktion zu ersetzen, oder es wird angegeben, dass keine Zuordnung zwischen den beiden Bibliotheken besteht:</span><span class="sxs-lookup"><span data-stu-id="1eec6-123">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="1eec6-124">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="1eec6-124">acceptFilePKCS7WStr</span></span>](#acceptfilepkcs7wstr)
-   [<span data-ttu-id="1eec6-125">Accept-fileresponabwstr</span><span class="sxs-lookup"><span data-stu-id="1eec6-125">acceptFileResponseWStr</span></span>](#acceptfileresponsewstr)
-   [<span data-ttu-id="1eec6-126">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="1eec6-126">acceptPKCS7Blob</span></span>](#acceptpkcs7blob)
-   [<span data-ttu-id="1eec6-127">akzeptresponseeblob</span><span class="sxs-lookup"><span data-stu-id="1eec6-127">acceptResponseBlob</span></span>](#acceptresponseblob)
-   [<span data-ttu-id="1eec6-128">getcertcontextfromfileresponabwstr</span><span class="sxs-lookup"><span data-stu-id="1eec6-128">getCertContextFromFileResponseWStr</span></span>](#getcertcontextfromfileresponsewstr)
-   [<span data-ttu-id="1eec6-129">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="1eec6-129">getCertContextFromPKCS7</span></span>](#getcertcontextfrompkcs7)
-   [<span data-ttu-id="1eec6-130">getcertcontextfromresponse-BLOB</span><span class="sxs-lookup"><span data-stu-id="1eec6-130">getCertContextFromResponseBlob</span></span>](#getcertcontextfromresponseblob)
-   [<span data-ttu-id="1eec6-131">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="1eec6-131">InstallPKCS7Blob</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="1eec6-132">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="1eec6-132">InstallPKCS7BlobEx</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="1eec6-133">Spcdateinamewstr</span><span class="sxs-lookup"><span data-stu-id="1eec6-133">SPCFileNameWStr</span></span>](#spcfilenamewstr)
-   [<span data-ttu-id="1eec6-134">"Schreibcertto"</span><span class="sxs-lookup"><span data-stu-id="1eec6-134">WriteCertToCSP</span></span>](#writecerttocsp)
-   [<span data-ttu-id="1eec6-135">"Schreibcerttouserds"</span><span class="sxs-lookup"><span data-stu-id="1eec6-135">WriteCertToUserDS</span></span>](#writecerttouserds)
-   [<span data-ttu-id="1eec6-136">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1eec6-136">Related topics</span></span>](#related-topics)

## <a name="acceptfilepkcs7wstr"></a><span data-ttu-id="1eec6-137">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="1eec6-137">acceptFilePKCS7WStr</span></span>

<span data-ttu-id="1eec6-138">Die [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) -Funktion in Xenroll.dll installiert eine [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly) -Antwort aus einer Datei.</span><span class="sxs-lookup"><span data-stu-id="1eec6-138">The [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) function in Xenroll.dll installs a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) response from a file.</span></span>

<span data-ttu-id="1eec6-139">Die CertEnroll.dll Bibliothek implementiert nicht direkt Funktionen zum Installieren einer PKCS \# 7-Zertifikats Antwort aus einer Datei.</span><span class="sxs-lookup"><span data-stu-id="1eec6-139">The CertEnroll.dll library does not directly implement functionality to install a PKCS \#7 certificate response from a file.</span></span> <span data-ttu-id="1eec6-140">Sie können jedoch eine benutzerdefinierte Funktion erstellen, um die Datei Daten in ein Bytearray zu lesen und [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) zum Installieren der Antwort aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-140">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the response.</span></span>

<span data-ttu-id="1eec6-141">Wenn Sie für den ersten Parameter von [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)den Wert **allownooutstandingrequest** der [**installresponserestrictionflags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) -Enumeration angeben, ist ein dummyzertifikat nicht vorhanden. Dadurch können Sie ein Zertifikat installieren, ohne zuerst " [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) " oder " [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)" aufrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-141">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="1eec6-142">Wenn Sie ein Zertifikat jedoch mithilfe eines Webskripts installieren, muss im Anforderungs Speicher ein dummyzertifikat vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="1eec6-142">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="1eec6-143">Daher müssen Sie für den ersten Parameter " **allownone** " angeben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-143">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptfileresponsewstr"></a><span data-ttu-id="1eec6-144">Accept-fileresponabwstr</span><span class="sxs-lookup"><span data-stu-id="1eec6-144">acceptFileResponseWStr</span></span>

<span data-ttu-id="1eec6-145">Mit der Funktion " [**Accept-fileresponabwstr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) " in Xenroll.dll wird eine PKCS \# 7-oder CMC-Zertifikats Antwort aus einer Datei installiert.</span><span class="sxs-lookup"><span data-stu-id="1eec6-145">The [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response from a file.</span></span>

<span data-ttu-id="1eec6-146">Die CertEnroll.dll Bibliothek implementiert die Funktionalität nicht direkt, um eine Zertifikat Antwort aus einer Datei zu installieren.</span><span class="sxs-lookup"><span data-stu-id="1eec6-146">The CertEnroll.dll library does not directly implement functionality to install a certificate response from a file.</span></span> <span data-ttu-id="1eec6-147">Sie können jedoch eine benutzerdefinierte Funktion erstellen, um die Datei Daten in ein Bytearray zu lesen und [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) zum Installieren der PKCS 7-oder der CMC-Antwort aufzurufen \# .</span><span class="sxs-lookup"><span data-stu-id="1eec6-147">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="1eec6-148">Wenn Sie für den ersten Parameter von [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)den Wert **allownooutstandingrequest** der [**installresponserestrictionflags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) -Enumeration angeben, ist ein dummyzertifikat nicht vorhanden. Dadurch können Sie ein Zertifikat installieren, ohne zuerst " [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) " oder " [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)" aufrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-148">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="1eec6-149">Wenn Sie ein Zertifikat jedoch mithilfe eines Webskripts installieren, muss im Anforderungs Speicher ein dummyzertifikat vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="1eec6-149">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="1eec6-150">Daher müssen Sie für den ersten Parameter " **allownone** " angeben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-150">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptpkcs7blob"></a><span data-ttu-id="1eec6-151">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="1eec6-151">acceptPKCS7Blob</span></span>

<span data-ttu-id="1eec6-152">Die [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) -Funktion in Xenroll.dll installiert eine PKCS 7-Antwort, die \# in einem Bytearray enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="1eec6-152">The [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response contained in a byte array.</span></span>

<span data-ttu-id="1eec6-153">Sie können " [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) " zum Installieren einer PKCS \# 7-Nachricht anrufen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-153">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 message.</span></span> <span data-ttu-id="1eec6-154">Wenn Sie für den ersten Parameter von " [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)" den Wert " **allownooutstandingrequest** " der [**installresponserestrictionflags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) -Enumeration angeben, ist ein dummyzertifikat nicht vorhanden. Dadurch können Sie die PKCS 7-Antwort installieren, \# ohne zuerst " [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) " oder " [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)" aufrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-154">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the PKCS \#7 response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="1eec6-155">Wenn Sie ein Zertifikat jedoch mithilfe eines Webskripts installieren, muss im Anforderungs Speicher ein dummyzertifikat vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="1eec6-155">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="1eec6-156">Daher müssen Sie für den ersten Parameter " **allownone** " angeben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-156">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptresponseblob"></a><span data-ttu-id="1eec6-157">akzeptresponseeblob</span><span class="sxs-lookup"><span data-stu-id="1eec6-157">acceptResponseBlob</span></span>

<span data-ttu-id="1eec6-158">Die Funktion " [**Accept trespontarblob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) " in Xenroll.dll installiert eine PKCS \# 7-oder CMC-Zertifikats Antwort, die in einem Bytearray enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="1eec6-158">The [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response contained in a byte array.</span></span>

<span data-ttu-id="1eec6-159">Sie können " [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) " anrufen, um eine PKCS 7-oder eine CMC-Antwort zu installieren \# .</span><span class="sxs-lookup"><span data-stu-id="1eec6-159">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="1eec6-160">Wenn Sie für den ersten Parameter von [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)den Wert **allownooutstandingrequest** der [**installresponserestrictionflags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) -Enumeration angeben, ist ein dummyzertifikat nicht vorhanden. Dadurch können Sie die Antwort installieren, ohne zuerst " [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) " oder " [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)" aufrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-160">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="1eec6-161">Wenn Sie ein Zertifikat jedoch mithilfe eines Webskripts installieren, muss im Anforderungs Speicher ein dummyzertifikat vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="1eec6-161">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="1eec6-162">Daher müssen Sie für den ersten Parameter " **allownone** " angeben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-162">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfromfileresponsewstr"></a><span data-ttu-id="1eec6-163">getcertcontextfromfileresponabwstr</span><span class="sxs-lookup"><span data-stu-id="1eec6-163">getCertContextFromFileResponseWStr</span></span>

<span data-ttu-id="1eec6-164">Die [**getcertcontextfromfileresponcwstr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) -Funktion in Xenroll.dll ruft das Client Zertifikat aus einer Datei ab.</span><span class="sxs-lookup"><span data-stu-id="1eec6-164">The [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) function in Xenroll.dll retrieves the client certificate from a file.</span></span>

<span data-ttu-id="1eec6-165">Die CertEnroll.dll Bibliothek implementiert die Funktionalität zum Abrufen eines Zertifikats aus einer in einer Datei gespeicherten Zertifizierungsstellen Antwort nicht direkt.</span><span class="sxs-lookup"><span data-stu-id="1eec6-165">The CertEnroll.dll library does not directly implement functionality to retrieve a certificate from a CA response saved in a file.</span></span> <span data-ttu-id="1eec6-166">Sie können jedoch eine benutzerdefinierte Funktion erstellen, um die Datei Daten in ein Bytearray zu lesen, und [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) aufrufen, um die PKCS \# 7-oder die CMC-Antwort zu installieren, und die [**Zertifikat**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) Eigenschaft aufrufen, um das Zertifikat abzurufen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-166">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response, and call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property to retrieve the certificate.</span></span>

<span data-ttu-id="1eec6-167">Wenn Sie für den ersten Parameter von [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)den Wert **allownooutstandingrequest** der [**installresponserestrictionflags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) -Enumeration angeben, ist ein dummyzertifikat nicht vorhanden. Dadurch können Sie ein Zertifikat installieren, ohne zuerst " [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) " oder " [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)" aufrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-167">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="1eec6-168">Wenn Sie ein Zertifikat jedoch mithilfe eines Webskripts installieren, muss im Anforderungs Speicher ein dummyzertifikat vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="1eec6-168">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="1eec6-169">Daher müssen Sie für den ersten Parameter " **allownone** " angeben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-169">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfrompkcs7"></a><span data-ttu-id="1eec6-170">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="1eec6-170">getCertContextFromPKCS7</span></span>

<span data-ttu-id="1eec6-171">Die [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) -Funktion in Xenroll.dll ruft das Client Zertifikat aus einer PKCS \# 7-Antwort ab.</span><span class="sxs-lookup"><span data-stu-id="1eec6-171">The [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) function in Xenroll.dll retrieves the client certificate from a PKCS \#7 response.</span></span>

<span data-ttu-id="1eec6-172">Sie können die [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) -Eigenschaft für das [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) -Objekt aufrufen, um ein Zertifikat abzurufen, nachdem Sie die Methode [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) oder [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) aufgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-172">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="getcertcontextfromresponseblob"></a><span data-ttu-id="1eec6-173">getcertcontextfromresponse-BLOB</span><span class="sxs-lookup"><span data-stu-id="1eec6-173">getCertContextFromResponseBlob</span></span>

<span data-ttu-id="1eec6-174">Die [**getcertcontextfromresponcblob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) -Funktion in Xenroll.dll ruft ein Client Zertifikat von einer PKCS \# 7-oder CMC-Antwort ab.</span><span class="sxs-lookup"><span data-stu-id="1eec6-174">The [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) function in Xenroll.dll retrieves a client certificate from a PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="1eec6-175">Sie können die [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) -Eigenschaft für das [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) -Objekt aufrufen, um ein Zertifikat abzurufen, nachdem Sie die Methode [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) oder [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) aufgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-175">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="installpkcs7blob"></a><span data-ttu-id="1eec6-176">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="1eec6-176">InstallPKCS7Blob</span></span>

<span data-ttu-id="1eec6-177">Mit der [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) -Funktion in Xenroll.dll wird eine PKCS \# 7-Antwort installiert.</span><span class="sxs-lookup"><span data-stu-id="1eec6-177">The [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response.</span></span>

<span data-ttu-id="1eec6-178">Sie können " [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) " anrufen, um eine PKCS 7-oder eine CMC-Antwort zu installieren \# .</span><span class="sxs-lookup"><span data-stu-id="1eec6-178">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="1eec6-179">Wenn Sie für den ersten Parameter von [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)den Wert **allownooutstandingrequest** der [**installresponserestrictionflags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) -Enumeration angeben, ist ein dummyzertifikat nicht vorhanden. Dadurch können Sie die Antwort installieren, ohne zuerst " [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) " oder " [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)" aufrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-179">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="1eec6-180">Wenn Sie ein Zertifikat jedoch mithilfe eines Webskripts installieren, muss im Anforderungs Speicher ein dummyzertifikat vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="1eec6-180">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="1eec6-181">Daher müssen Sie für den ersten Parameter " **allownone** " angeben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-181">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="installpkcs7blobex"></a><span data-ttu-id="1eec6-182">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="1eec6-182">InstallPKCS7BlobEx</span></span>

<span data-ttu-id="1eec6-183">Mit der [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) -Funktion in Xenroll.dll wird eine PKCS \# 7-Antwort installiert, und die Anzahl der installierten Zertifikate wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-183">The [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) function in Xenroll.dll installs a PKCS \#7 response and returns the number of certificates installed.</span></span>

<span data-ttu-id="1eec6-184">Sie können " [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) " anrufen, um eine PKCS 7-oder eine CMC-Antwort zu installieren \# .</span><span class="sxs-lookup"><span data-stu-id="1eec6-184">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="1eec6-185">Wenn Sie für den ersten Parameter von [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)den Wert **allownooutstandingrequest** der [**installresponserestrictionflags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) -Enumeration angeben, ist ein dummyzertifikat nicht vorhanden. Dadurch können Sie die Antwort installieren, ohne zuerst " [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) " oder " [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)" aufrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="1eec6-185">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="1eec6-186">Wenn Sie ein Zertifikat jedoch mithilfe eines Webskripts installieren, muss im Anforderungs Speicher ein dummyzertifikat vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="1eec6-186">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="1eec6-187">Daher müssen Sie für den ersten Parameter " **allownone** " angeben.</span><span class="sxs-lookup"><span data-stu-id="1eec6-187">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="spcfilenamewstr"></a><span data-ttu-id="1eec6-188">Spcdateinamewstr</span><span class="sxs-lookup"><span data-stu-id="1eec6-188">SPCFileNameWStr</span></span>

<span data-ttu-id="1eec6-189">Die [**spcfileamewstr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) -Funktion in Xenroll.dll gibt den Namen der Datei an, in der die Zertifikats Antwort gespeichert werden soll, oder ruft ihn ab.</span><span class="sxs-lookup"><span data-stu-id="1eec6-189">The [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) function in Xenroll.dll specifies or retrieves the name of the file in which to save the certificate response.</span></span> <span data-ttu-id="1eec6-190">Die CertEnroll.dll Bibliothek implementiert keine Funktionen, mit denen Sie ein Zertifikat in eine bestimmte Datei kopieren können.</span><span class="sxs-lookup"><span data-stu-id="1eec6-190">The CertEnroll.dll library does not implement functionality that enables you to copy a certificate to a specific file.</span></span> <span data-ttu-id="1eec6-191">Bei der Registrierung wird die Zertifikatskette automatisch in Dateien in den entsprechenden speichern installiert.</span><span class="sxs-lookup"><span data-stu-id="1eec6-191">The enrollment process automatically installs the certificate chain into files in the appropriate stores.</span></span>

## <a name="writecerttocsp"></a><span data-ttu-id="1eec6-192">"Schreibcertto"</span><span class="sxs-lookup"><span data-stu-id="1eec6-192">WriteCertToCSP</span></span>

<span data-ttu-id="1eec6-193">Die Funktion " [**Write-certtocsp**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) " in Xenroll.dll gibt einen booleschen Wert an oder ruft ihn ab, der angibt, ob ein Zertifikat in einen [*Kryptografiedienstanbieter (kryptografischen Service Provider*](/windows/desktop/SecGloss/c-gly) , CSP) geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="1eec6-193">The [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be written to a [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP).</span></span> <span data-ttu-id="1eec6-194">Wenn diese Funktion aufgerufen wird, ist der Anbieter in der Regel eine [*Smartcard*](/windows/desktop/SecGloss/s-gly).</span><span class="sxs-lookup"><span data-stu-id="1eec6-194">Typically, if this function is called, the provider is a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>

<span data-ttu-id="1eec6-195">Wenn ein Client in CertEnroll.dll die [**Registrierungsmethode aufruft**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) , um eine Anforderung für ein Smartcardzertifikat zu senden, und ein Zertifikat ausgestellt wird, wird das Zertifikat bei der [**Anmeldung**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) automatisch auf der Smartcard installiert, vorausgesetzt, dass die Karte im Reader installiert ist.</span><span class="sxs-lookup"><span data-stu-id="1eec6-195">In CertEnroll.dll, when a client calls the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method to submit a request for a smart card certificate and a certificate is issued, [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) automatically installs the certificate on the smart card, assuming that the card is installed in the reader.</span></span> <span data-ttu-id="1eec6-196">Die [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) -Methode schreibt das Zertifikat auch automatisch auf die Smartcard.</span><span class="sxs-lookup"><span data-stu-id="1eec6-196">The [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method also automatically writes the certificate to the smart card.</span></span>

## <a name="writecerttouserds"></a><span data-ttu-id="1eec6-197">"Schreibcerttouserds"</span><span class="sxs-lookup"><span data-stu-id="1eec6-197">WriteCertToUserDS</span></span>

<span data-ttu-id="1eec6-198">Die Funktion " [**schreitecerttouserds**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) " in Xenroll.dll gibt einen booleschen Wert an, der angibt, ob ein Zertifikat im Active Directory Speicher gespeichert werden soll, oder ruft ihn ab.</span><span class="sxs-lookup"><span data-stu-id="1eec6-198">The [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be saved in the Active Directory store.</span></span> <span data-ttu-id="1eec6-199">Die CertEnroll.dll Bibliothek implementiert keine Funktionen, mit denen Sie einen Speicher angeben können, in den ein Zertifikat kopiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="1eec6-199">The CertEnroll.dll library does not implement functionality that enables you to specify a store to copy a certificate to.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1eec6-200">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1eec6-200">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1eec6-201">Zuordnung von Xenroll.dll zu CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="1eec6-201">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="1eec6-202">**IX509Enrollment**</span><span class="sxs-lookup"><span data-stu-id="1eec6-202">**IX509Enrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)
</dt> </dl>

 

 
