---
description: 'Weitere Informationen finden Sie unter: Index Schlüssel'
title: Index Schlüssel
TOCTitle: Index Key
ms:assetid: 104bdb1c-71ac-44f4-bbda-c553131aaad4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269188(v=EXCHG.10)
ms:contentKeyID: 32765491
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: eff0812f363fa83d133ab087140d415d8e2dbad3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104553283"
---
# <a name="index-key"></a><span data-ttu-id="28040-103">Index Schlüssel</span><span class="sxs-lookup"><span data-stu-id="28040-103">Index Key</span></span>


<span data-ttu-id="28040-104">_**Gilt für:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="28040-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="index-key"></a><span data-ttu-id="28040-105">Index Schlüssel</span><span class="sxs-lookup"><span data-stu-id="28040-105">Index Key</span></span>

<span data-ttu-id="28040-106">Ein Index wird für Daten in der Tabelle mit [jetkreateindex](./jetcreateindex-function.md) erstellt, oder es können mehrere Indizes gleichzeitig mit [JetCreateIndex2](./jetcreateindex2-function.md) erstellt werden, wobei die [JET_INDEXCREATE](./jet-indexcreate-structure.md) Struktur verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="28040-106">An index is created over data in the table with [JetCreateIndex](./jetcreateindex-function.md) or multiple indexes may be created simultaneously with [JetCreateIndex2](./jetcreateindex2-function.md) using the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="28040-107">Der Index wird in Form eines Spalten Arrays in der Rangfolge definiert.</span><span class="sxs-lookup"><span data-stu-id="28040-107">The index is defined in terms of an array of columns, in precedence order.</span></span> <span data-ttu-id="28040-108">Dieses Spalten Array wird auch als Index Schlüssel bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="28040-108">This array of columns is also called the index key.</span></span> <span data-ttu-id="28040-109">Der Index Schlüssel kann als primärer Index definiert werden, wenn die JET_bitIndexPrimary-Option im *grbit* -Parameter von [jetkreateindex](./jetcreateindex-function.md) oder [JET_INDEXCREATE](./jet-indexcreate-structure.md)festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="28040-109">The index key may be defined as the primary index when the JET_bitIndexPrimary option is set in the *grbit* parameter of [JetCreateIndex](./jetcreateindex-function.md) or [JET_INDEXCREATE](./jet-indexcreate-structure.md).</span></span> <span data-ttu-id="28040-110">Der Index Schlüssel ist eine NULL-terminierte Zeichenfolge von mit NULL endenden Token, wie im folgenden Beispiel gezeigt:</span><span class="sxs-lookup"><span data-stu-id="28040-110">The index key is a null terminated string of null terminated tokens as shown in the following example:</span></span>

<span data-ttu-id="28040-111">\+Col1 \\ 0-Col2 \\ 0 + Col3 \\ 0 \\ 0</span><span class="sxs-lookup"><span data-stu-id="28040-111">\+Col1\\0-Col2\\0+Col3\\0\\0</span></span>

<span data-ttu-id="28040-112">Der Schlüssel im Beispiel kann verwendet werden, um einen Index über drei Spalten in der Tabelle zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="28040-112">The key in the example may be used to create an index over three columns in the table.</span></span> <span data-ttu-id="28040-113">Jede im Index angegebene Spalte wird als "Index Segment" oder "Schlüssel Spalte" bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="28040-113">Each column specified in the index is referred to as the "index segment" or "key column".</span></span> <span data-ttu-id="28040-114">Das Index Segment kann in Bezug auf den Bestell Beitrag entweder aufsteigend oder absteigend sein.</span><span class="sxs-lookup"><span data-stu-id="28040-114">The index segment may be either ascending or descending in terms of its ordering contribution.</span></span> <span data-ttu-id="28040-115">Im obigen Beispiel ist der Name der ersten Spalte im Index col1.</span><span class="sxs-lookup"><span data-stu-id="28040-115">In the example above, the name of the first column in the index is Col1.</span></span> <span data-ttu-id="28040-116">+ Gibt an, dass col1 in aufsteigender Reihenfolge indiziert wird.</span><span class="sxs-lookup"><span data-stu-id="28040-116">The + indicates that Col1 is indexed in ascending order.</span></span> <span data-ttu-id="28040-117">– Before Col2 gibt an, dass die Indizierung in absteigender Reihenfolge erfolgt.</span><span class="sxs-lookup"><span data-stu-id="28040-117">The – before Col2 indicates that it is indexed in descending order.</span></span>

<span data-ttu-id="28040-118">Wenn im Index bedingte Spalten vorhanden sind, wird die [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) Struktur verwendet, um anzugeben, wie Sie indiziert werden.</span><span class="sxs-lookup"><span data-stu-id="28040-118">When conditional columns are present in the index, the [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) structure is used to indicate how they are indexed.</span></span> <span data-ttu-id="28040-119">Eine bedingte Spalte kann verwendet werden, um das vorhanden sein oder Fehlen eines Index Eintrags in einem Index auf der Grundlage des Werts in der entsprechenden Bedingungs Spalte zu steuern, ohne dass sich dies auf die Sortierreihenfolge des Indexes auswirkt.</span><span class="sxs-lookup"><span data-stu-id="28040-119">A conditional column may be used to control the presence or absence of an index entry in an index based on the value in the corresponding conditional column without affecting the sort order of the index.</span></span> <span data-ttu-id="28040-120">Eine bedingte Spalte kann einen Index Eintrag aus dem Index einschließen oder ausschließen, wenn der Wert dieser Bedingungs Spalte für den entsprechenden Datensatz NULL ist.</span><span class="sxs-lookup"><span data-stu-id="28040-120">A conditional column may include or exclude an index entry from the index if the value of that conditional column is NULL for the corresponding record.</span></span>

<span data-ttu-id="28040-121">Standardmäßig wird die maximale Größe des Index Schlüssels durch die JET_cbKeyMost Konstante angegeben, bei der es sich immer um 255 Bytes normalisierter Daten (Bytes der Daten einschließlich des Indizierungs Aufwands) handelt.</span><span class="sxs-lookup"><span data-stu-id="28040-121">By default, the maximum size of the index key is given by the JET_cbKeyMost constant which has always been 255 bytes of normalized data (bytes of data including the indexing overhead).</span></span> <span data-ttu-id="28040-122">Ab Windows Vista kann die maximale Größe des Index Schlüssels mit der [JET_INDEXCREATE](./jet-indexcreate-structure.md) Struktur festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="28040-122">Starting with Windows Vista, the maximum size of the index key can be set with the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="28040-123">Die maximale Größe des Index Schlüssels entspricht der Größe der Datenbankseite.</span><span class="sxs-lookup"><span data-stu-id="28040-123">The maximum size of the index key corresponds to the database page size.</span></span> <span data-ttu-id="28040-124">Um eine benutzerdefinierte maximale Schlüsselgröße zu aktivieren, geben Sie die Jet_bitIndexKeyMost-Option im grbits-Member von [JET_INDEXCREATE](./jet-indexcreate-structure.md)an, und legen Sie den **cbkeymost** -Member auf einen der folgenden Werte fest:</span><span class="sxs-lookup"><span data-stu-id="28040-124">To enable a custom maximum key size, specify the Jet_bitIndexKeyMost option in the grbits member of [JET_INDEXCREATE](./jet-indexcreate-structure.md), and set the **cbKeyMost** member to one of the following values:</span></span>

  - <span data-ttu-id="28040-125">JET_cbKeyMost2KBytePage: Wenn die Größe der Datenbankseite 2048 Bytes beträgt, kann die maximale Index Schlüsselgröße zwischen mindestens 255 Bytes und maximal 500 Byte betragen.</span><span class="sxs-lookup"><span data-stu-id="28040-125">JET_cbKeyMost2KBytePage: When the database page size is 2048 bytes, the maximum index key size can be between 255 bytes minimum, and 500 bytes maximum.</span></span>

  - <span data-ttu-id="28040-126">JET_cbKeyMost4KBytePage: Wenn die Größe der Datenbankseite 4096 Bytes beträgt, kann die maximale Index Schlüsselgröße zwischen mindestens 255 Bytes und maximal 1000 Byte betragen.</span><span class="sxs-lookup"><span data-stu-id="28040-126">JET_cbKeyMost4KBytePage: When the database page size is 4096 bytes, the maximum index key size can be between 255 bytes minimum, and 1000 bytes maximum.</span></span>

  - <span data-ttu-id="28040-127">JET_cbKeyMost8KBytePage: Wenn die Größe der Datenbankseite 8196 Bytes beträgt, kann die maximale Index Schlüsselgröße zwischen mindestens 255 Bytes und maximal 2000 Byte betragen.</span><span class="sxs-lookup"><span data-stu-id="28040-127">JET_cbKeyMost8KBytePage: When the database page size is 8196 bytes, the maximum index key size can be between 255 bytes minimum, and 2000 bytes maximum.</span></span>

<span data-ttu-id="28040-128">Das Beispiel in der Abbildung unten zeigt eine Tabelle mit Mitarbeiter Informationen.</span><span class="sxs-lookup"><span data-stu-id="28040-128">The example in the diagram below shows a table containing employee information.</span></span> <span data-ttu-id="28040-129">Die Tabelle enthält 6 Spalten, von denen jedes ein bestimmtes Employee-Attribut definiert.</span><span class="sxs-lookup"><span data-stu-id="28040-129">The table has 6 columns, each defining a specific employee attribute.</span></span> <span data-ttu-id="28040-130">Ein Datensatz in der Tabelle enthält Werte für einen Mitarbeiter, z. b. den Mitarbeiter Namen in Spalte 1 und die Mitarbeiter-ID in Spalte 2.</span><span class="sxs-lookup"><span data-stu-id="28040-130">A record in the table contains values for an employee, such as the employee name in column 1 and employee ID in column 2.</span></span> <span data-ttu-id="28040-131">Ein primärer Index, der für diese Tabelle erstellt wird, ordnet die Daten zuerst nach dem Mitarbeiter Namen und der Mitarbeiter-ID an.</span><span class="sxs-lookup"><span data-stu-id="28040-131">A primary index created for this table organizes the data according to the employee name first, and the employee ID second.</span></span> <span data-ttu-id="28040-132">Sowohl Name als auch ID werden in aufsteigender Reihenfolge indiziert.</span><span class="sxs-lookup"><span data-stu-id="28040-132">Both name and ID are indexed in ascending order.</span></span> <span data-ttu-id="28040-133">Beispielsweise wird ein Datensatz mit dem Namen Johnson und Employee ID 12345 vor einem Datensatz mit dem Mitarbeiter Namen Jones und der ID 10000 aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="28040-133">For example, a record containing the name Johnson and employee ID 12345 will be listed before of a record with an employee name Jones and an ID of 10000.</span></span> <span data-ttu-id="28040-134">Alle Datensätze für Jones werden in der Tabelle mit ihren Mitarbeiter-IDs in aufsteigender Reihenfolge gespeichert, wie in der Tabelle dargestellt.</span><span class="sxs-lookup"><span data-stu-id="28040-134">All the records for Jones are stored together in the table, with their employee IDs in ascending order as shown in the table.</span></span>

<span data-ttu-id="28040-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span><span class="sxs-lookup"><span data-stu-id="28040-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span></span>

<span data-ttu-id="28040-136">Der Schlüssel im primären Index muss eindeutig sein, aber die Schlüssel im sekundären Index können Duplikate sein.</span><span class="sxs-lookup"><span data-stu-id="28040-136">The key in the primary index must be unique, but the keys in the secondary index can be duplicates.</span></span> <span data-ttu-id="28040-137">Wenn ein Index z. b. mit dem Nachnamen erstellt wird und in der Datenbank zwei Personen mit Stevens vorhanden sind, gibt ESE einen Jet_errKeyDuplicate Fehler von [jetupdate](./jetupdate-function.md) oder [JetUpdate2](./jetupdate2-function.md)zurück, wenn die Anwendung versucht, den zweiten "Stevens" einzufügen.</span><span class="sxs-lookup"><span data-stu-id="28040-137">For example, if an index is created over last name, and there are two people with Stevens in the database, ESE returns a Jet_errKeyDuplicate error from [JetUpdate](./jetupdate-function.md) or [JetUpdate2](./jetupdate2-function.md), when the application attempts to insert the second "Stevens".</span></span> <span data-ttu-id="28040-138">Wenn der tatsächliche Schlüssel größer als die maximale Schlüsselgröße ist, wird der Schlüssel abgeschnitten.</span><span class="sxs-lookup"><span data-stu-id="28040-138">When the actual key is larger than the maximum key size, the key is truncated.</span></span> <span data-ttu-id="28040-139">Das Durchsuchen und Eindeutigkeit der Schlüssel abkürzen wirkt sich auf die Verwendung durch die Anwendung aus.</span><span class="sxs-lookup"><span data-stu-id="28040-139">Key truncation effects searching and uniqueness and should be managed by the application.</span></span> <span data-ttu-id="28040-140">Wenn z. b. "Stevens" und "Stevenson" in einem Index über den Nachnamen gespeichert wurden und die maximale Schlüsselgröße zu klein ist, um den "on"-Teil von "Stevenson" zu speichern, würde die Schlüssel abkürzen dazu führen, dass "Stevens" und "Stevenson" dupliziert werden, auch wenn dies nicht der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="28040-140">For example, if "Stevens" and "Stevenson" were stored in an index over last name and the max key size were too small to store the "on" portion of "Stevenson" then key truncation would result in the database engine declaring that "Stevens" and "Stevenson" are duplicates even though they are not.</span></span> <span data-ttu-id="28040-141">Die Anwendung muss so vorbereitet sein, dass Sie Fälle wie diese während der Suche und Aktualisierung verarbeitet, wenn die Index Definition und die von ihr indizierenden Spaltenwerte so lauten, dass die Schlüssel Abschneiden eine Möglichkeit ist.</span><span class="sxs-lookup"><span data-stu-id="28040-141">The application must be prepared to handle cases like this during search and update if the index definition and the column values it indexes are such that key truncation is a possibility.</span></span> <span data-ttu-id="28040-142">Ab Windows Vista können Anwendungen die Jet_bitIndexDisallowTruncation Option in [JET_INDEXCREATE](./jet-indexcreate-structure.md) oder [jetmakekey](./jetmakekey-function.md)angeben.</span><span class="sxs-lookup"><span data-stu-id="28040-142">Starting in Windows Vista, applications can specify the Jet_bitIndexDisallowTruncation option in [JET_INDEXCREATE](./jet-indexcreate-structure.md) or [JetMakeKey](./jetmakekey-function.md).</span></span> <span data-ttu-id="28040-143">Die Angabe dieses Flags führt dazu, dass ein Update des Indexes, das zu einem abgeschnittene Schlüssel führt, mit JET_errKeyTruncated fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="28040-143">Specifying this flag will cause any update to the index that would result in a truncated key to fail with JET_errKeyTruncated.</span></span> <span data-ttu-id="28040-144">Andernfalls werden Schlüssel automatisch abgeschnitten.</span><span class="sxs-lookup"><span data-stu-id="28040-144">Otherwise, keys will be silently truncated.</span></span> <span data-ttu-id="28040-145">Dadurch kann die Anwendung ohne Bedenken für die Artefakte funktionieren, die durch zuvor beschriebene Schlüssel abkürzen verursacht wurden.</span><span class="sxs-lookup"><span data-stu-id="28040-145">This will allow the application to function without concern for the artifacts caused by key truncation that were previously described.</span></span>
