---
description: 'Weitere Informationen finden Sie hier: Transaktionen (Windows-Ereignisse)'
title: Transaktionen (Windows-Ereignisse)
TOCTitle: Transactions
ms:assetid: 1ceb362c-1efe-439b-b10a-016c8a54f27b
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269197(v=EXCHG.10)
ms:contentKeyID: 32765500
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 90b5b566f5ff961ce7b0ae3725f580e1f39c041d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104346958"
---
# <a name="transactions-windows-events"></a><span data-ttu-id="f4fbd-103">Transaktionen (Windows-Ereignisse)</span><span class="sxs-lookup"><span data-stu-id="f4fbd-103">Transactions (Windows Events)</span></span>


<span data-ttu-id="f4fbd-104">_**Gilt für:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="f4fbd-104">_**Applies to:** Windows�| Windows Server_</span></span>

## <a name="transactions"></a><span data-ttu-id="f4fbd-105">Transaktionen</span><span class="sxs-lookup"><span data-stu-id="f4fbd-105">Transactions</span></span>

<span data-ttu-id="f4fbd-106">ESE-Transaktionen sind logische Verarbeitungseinheiten, mit denen gesteuert wird, wie eine Anwendung Zeilen in der Datenbank sieht und bearbeitet.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-106">ESE transactions are logical units of processing that control how an application sees and manipulates rows in the database.</span></span> <span data-ttu-id="f4fbd-107">Die Anwendung kann Transaktions Speicherpunkte verwenden, um zu bestimmen, ob ein bestimmter Satz von Änderungen an der Datenbank beibehalten oder verworfen werden soll.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-107">Your application can use transaction save points to determine whether to keep or discard a particular set of changes to the database.</span></span> <span data-ttu-id="f4fbd-108">Alle Transaktionen in ESE sind atomarisch, konsistent, isoliert und dauerhaft (ACID), wie im folgenden beschrieben:</span><span class="sxs-lookup"><span data-stu-id="f4fbd-108">All transactions in ESE are atomic, consistent, isolated, and durable (ACID) as described below:</span></span>

  - <span data-ttu-id="f4fbd-109">**Atomarisch:** Alle Updates in der Transaktion werden entweder in der Datenbank angezeigt, oder Sie werden verworfen.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-109">**Atomic:** All the updates in the transaction either appear in the database or they are discarded.</span></span>

<!-- end list -->

  - <span data-ttu-id="f4fbd-110">**Konsistent:** Die Datenbank wird immer in einem gültigen Zustand gestartet und endet immer mit einem anderen rechtlichen Zustand.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-110">**Consistent:** The database will always start in a legal state and will always end in another legal state.</span></span> <span data-ttu-id="f4fbd-111">Bei ESE-Anwendungen steuert die Datenbank-Engine einige einfache Einschränkungen, z. b. die Eindeutigkeit eines eindeutigen Indexes, aber die Anwendung selbst definiert fast alle anderen Aspekte der Bedeutung, die für die Datenbank in einem rechtlichen Zustand vorliegen.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-111">For ESE applications, the database engine will control some simple constraints, for example uniqueness of a unique index, but the application itself will define almost all other aspects of what it means for the database to be in a legal state.</span></span>

<!-- end list -->

  - <span data-ttu-id="f4fbd-112">**Isolation:** Transaktionen werden von Updates durch andere Sitzungen isoliert.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-112">**Isolation:** Transactions are isolated from updates by other sessions.</span></span> <span data-ttu-id="f4fbd-113">Eine Transaktion erhält nie einen partiellen Satz von Änderungen, die von einer anderen Transaktion vorgenommen wurden.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-113">A transaction will never see a partial set of changes made by another transaction.</span></span>

<!-- end list -->

  - <span data-ttu-id="f4fbd-114">Permanent **:** Nachdem die Datenbank-Engine bestätigt hat, dass für eine Transaktion ein Commit ausgeführt wurde, werden die Änderungen in der Datenbank persistent gespeichert.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-114">**Durable:** After the database engine acknowledges that a transaction has been committed, its changes are persistent in the database.</span></span> <span data-ttu-id="f4fbd-115">Die Dauerhaftigkeit einer Transaktion kann aus Leistungsgründen optional aufgehoben werden.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-115">The durability of a transaction may be optionally waived for performance reasons.</span></span>

<span data-ttu-id="f4fbd-116">Transaktionen werden innerhalb der Grenzen der Aufrufe von [jetbegintransaction](./jetbegintransaction-function.md) und [jetcommittransaction](./jetcommittransaction-function.md) oder [jetrollback](./jetrollback-function.md)durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-116">Transactions are performed within the bounds of the calls to [JetBeginTransaction](./jetbegintransaction-function.md) and [JetCommitTransaction](./jetcommittransaction-function.md) or [JetRollback](./jetrollback-function.md).</span></span> <span data-ttu-id="f4fbd-117">Wenn die Anwendung in die Transaktion eintritt, wird die Datenbank bei der Instanz fixiert, wenn die Transaktion beginnt.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-117">When the application enters the transaction, the database appears frozen at the instance in time that the transaction begins.</span></span> <span data-ttu-id="f4fbd-118">Dies wird als Momentaufnahme Isolation bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-118">This is called snapshot isolation.</span></span> <span data-ttu-id="f4fbd-119">Wenn die Transaktion durch Aufrufen von [jetrollback](./jetrollback-function.md)beendet wird, wird keiner der Vorgänge, die in der Transaktion ausgeführt werden, an die Datenbank übertragen.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-119">If the transaction is terminated by calling [JetRollback](./jetrollback-function.md), none of the operations performed in the transaction are committed to the database.</span></span> <span data-ttu-id="f4fbd-120">Wenn der Prozess oder der Computer abstürzt, bevor [jetcommittransaction](./jetcommittransaction-function.md) aufgerufen wird, entspricht er dem Aufruf von [jetrollback](./jetrollback-function.md).</span><span class="sxs-lookup"><span data-stu-id="f4fbd-120">If the process or the machine crashes before [JetCommitTransaction](./jetcommittransaction-function.md) is called, it is the same as calling [JetRollback](./jetrollback-function.md).</span></span>

<span data-ttu-id="f4fbd-121">Diese Prozedur zeigt, wie Sie eine Transaktion starten und ausführen, die Daten in einer-Datenbank liest und aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-121">This procedure shows how to start and commit a transaction that reads and updates data in a database.</span></span>

### <a name="to-start-and-commit-a-transaction"></a><span data-ttu-id="f4fbd-122">So starten Sie eine Transaktion und commitden Commit</span><span class="sxs-lookup"><span data-stu-id="f4fbd-122">To start and commit a transaction</span></span>

1.  <span data-ttu-id="f4fbd-123">Aufrufen von [jetbegintransaction](./jetbegintransaction-function.md) oder [JetBeginTransaction2](./jetbegintransaction2-function.md) mit der Sitzungs-ID, um die Transaktion zu starten.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-123">Call [JetBeginTransaction](./jetbegintransaction-function.md) or [JetBeginTransaction2](./jetbegintransaction2-function.md) with the session ID to start the transaction.</span></span>

2.  <span data-ttu-id="f4fbd-124">Bewegen Sie den Cursor in den gewünschten Datensatz, indem Sie [jetmove](./jetmove-function.md) mit JET_MoveFirst aufrufen, die im Parameter " *cRow* " angegeben sind.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-124">Move the cursor to the desired record by calling [JetMove](./jetmove-function.md) with JET_MoveFirst specified in the *cRow* parameter.</span></span> <span data-ttu-id="f4fbd-125">Weitere Informationen zum Verschieben des Cursors finden Sie im Thema [Indizierung in der Tabelle](./indexing-in-the-table.md) .</span><span class="sxs-lookup"><span data-stu-id="f4fbd-125">For more information on how to move the cursor, see the [Indexing in the Table](./indexing-in-the-table.md) topic.</span></span>

3.  <span data-ttu-id="f4fbd-126">Rufen Sie [jetgettablecolumninfo](./jetgettablecolumninfo-function.md) für den aktuellen Datensatz mit JET_ColInfo im *infolevel* -Parameter fest, um die Spalten-ID für die Spalte abzurufen.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-126">Call [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md) on the current record with JET_ColInfo specified in the *InfoLevel* parameter to retrieve the column ID for the column.</span></span> <span data-ttu-id="f4fbd-127">Die Spalten-ID wird in der [JET_COLUMNDEF](./jet-columndef-structure.md) Struktur zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-127">The column ID is returned in the [JET_COLUMNDEF](./jet-columndef-structure.md) structure.</span></span>

4.  <span data-ttu-id="f4fbd-128">Aufrufen von [jetsetcolumn](./jetsetcolumn-function.md) mit der Sitzungs-ID, der Tabellen-ID und der Spalten-ID der aktualisierten Spalte.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-128">Call [JetSetColumn](./jetsetcolumn-function.md) with the session ID, table ID, and column ID of the column that is updated.</span></span> <span data-ttu-id="f4fbd-129">Die Spaltendaten sind im *pvData* -Parameter enthalten.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-129">The column data is contained in the *pvData* parameter.</span></span>

5.  <span data-ttu-id="f4fbd-130">Ruft [jetcommittransaction](./jetcommittransaction-function.md) auf, um die Transaktion an die Datenbank zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-130">Call [JetCommitTransaction](./jetcommittransaction-function.md) to commit the transaction to the database.</span></span>

<span data-ttu-id="f4fbd-131">Die Art und Weise, in der ein ESE-Datenbankmodul die Momentaufnahme Isolation implementiert, hat einige wichtige Unterschiede zu herkömmlichen relationalen Daten Bank Isolations-</span><span class="sxs-lookup"><span data-stu-id="f4fbd-131">The way in which an ESE database engine implements snapshot isolation has some important differences from traditional relational database isolation and locking models.</span></span> <span data-ttu-id="f4fbd-132">Wenn eine Transaktion eine Zeile liest, kann Sie immer auf die Zeile zugreifen, ohne dass ein Fehler auftritt oder darauf gewartet wird, dass andere Sitzungen eine Sperre freigeben.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-132">When a transaction reads a row, it can always access the row without failing or waiting for other sessions to release a lock.</span></span> <span data-ttu-id="f4fbd-133">Wenn eine Transaktion versucht, eine Zeile zu aktualisieren, wird Sie erfolgreich ausgeführt, wenn Sie die erste Sitzung zum Aktualisieren dieser Zeile ist, d. h., der erste Writer gewinnt.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-133">When a transaction attempts to update a row, it will succeed if it is the first session to update that row, that is the first writer wins.</span></span> <span data-ttu-id="f4fbd-134">Wenn die Sitzung nicht der erste Writer ist, wird Sie sofort mit einem Fehler beim Schreiben eines Konflikts fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-134">If the session is not the first writer then it will immediately fail with a write conflict error.</span></span> <span data-ttu-id="f4fbd-135">Die Sitzung muss dann die Transaktion abbrechen, (in der Regel über eine zufällige Verzögerung) warten, bis die andere Transaktion einen Commit für die Änderungen durchführen und dann die Transaktion wiederholen.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-135">The session must then abort its transaction, wait (usually via a random delay), for the other transaction to commit its changes, and then retry the transaction.</span></span> <span data-ttu-id="f4fbd-136">Die Datenbank-Engine führt nicht automatisch dazu, dass die Sitzung wartet, bis die Aktualisierung der anderen Transaktion abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-136">The database engine will not automatically cause that session to wait until the other transaction has finished its update.</span></span> <span data-ttu-id="f4fbd-137">Normalerweise testet eine Transaktion, ob eine Zeile innerhalb des [jetupdate](./jetupdate-function.md) -Aufrufes aktualisiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-137">Usually, a transaction will test if it can update a row inside of the [JetUpdate](./jetupdate-function.md) call.</span></span> <span data-ttu-id="f4fbd-138">Wenn die Zeile für das Update nicht gesperrt werden kann, schlägt [jetupdate](./jetupdate-function.md) mit JET_errWriteConflict fehl.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-138">If it cannot lock the row for update then [JetUpdate](./jetupdate-function.md) will fail with JET_errWriteConflict.</span></span>

<span data-ttu-id="f4fbd-139">Sitzungen sind auf einen Thread ab dem Zeitpunkt beschränkt, zu dem die Transaktion mit dem Ende der Transaktion beginnt.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-139">Sessions are limited to one thread from the time the transaction starts to the end of the transaction.</span></span> <span data-ttu-id="f4fbd-140">Es wird empfohlen, alle Update-und Abruf Vorgänge in einer Transaktion durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-140">It is recommended that all update and retrieve operations be performed in a transaction.</span></span> <span data-ttu-id="f4fbd-141">ESE unterstützt auch Schema Änderungen wie das Erstellen von Tabellen und das Hinzufügen von Spalten innerhalb der Transaktion.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-141">ESE also supports schema modifications such as creating tables and adding columns inside the transaction.</span></span> <span data-ttu-id="f4fbd-142">Sowohl Update-als auch Schema Änderungen können in der gleichen Transaktion ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-142">Both update and schema modifications can be performed in the same transaction.</span></span> <span data-ttu-id="f4fbd-143">Nachdem die Transaktion mit [jetcommittransaction](./jetcommittransaction-function.md)abgeschlossen wurde, wird das Update in der Transaktionsprotokoll Datei protokolliert.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-143">After the transaction completes with [JetCommitTransaction](./jetcommittransaction-function.md), the update is logged in the transaction log file.</span></span> <span data-ttu-id="f4fbd-144">Diese Dateien können verwendet werden, um einen logisch konsistenten Zustand zu gewährleisten, wenn eine unerwartete Beendigung des Prozesses oder das Herunterfahren des Systems auftritt.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-144">These files can be used to maintain a logically consistent state in the event of an unexpected process termination or system shutdown.</span></span>

<span data-ttu-id="f4fbd-145">Transaktionen können bis zu 7 Ebenen geschachtelt werden, wobei die Aufrufe von [jetbegintransaction](./jetbegintransaction-function.md) und [jetcommittransaction](./jetcommittransaction-function.md) oder [jetrollback](./jetrollback-function.md) ineinander geschachtelt sind.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-145">Transactions may be nested up to 7 levels with matching calls to [JetBeginTransaction](./jetbegintransaction-function.md) and [JetCommitTransaction](./jetcommittransaction-function.md) or [JetRollback](./jetrollback-function.md) nested within each other.</span></span> <span data-ttu-id="f4fbd-146">Dadurch kann die Anwendung einen Teil der Transaktion zurücksetzen, ohne dass die gesamte Transaktion zurückgesetzt werden muss.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-146">This allows the application to rollback a part of the transaction without having to back out of the entire transaction.</span></span> <span data-ttu-id="f4fbd-147">Der von [jetcommittransaction eingefügte pecommittransaction](./jetcommittransaction-function.md) -Befehl bedeutet, dass diese Verarbeitungs Ebene abgeschlossen ist. die Transaktion wird jedoch erst dann an die Datenbank übergeben, wenn der äußerste Anrufe den Commit der Transaktion mit [jetcommittransaction](./jetcommittransaction-function.md)durchläuft.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-147">The nested call to [JetCommitTransaction](./jetcommittransaction-function.md) signifies that this level of processing is complete; however, the transaction is not committed to the database until the outer most call to commit the transaction with [JetCommitTransaction](./jetcommittransaction-function.md).</span></span>

<span data-ttu-id="f4fbd-148">Escrow-Update Spalten können gleichzeitig durch mehrere Sitzungen aktualisiert werden, ohne dass Jet_errWriteConflict fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-148">Escrow update columns can be updated concurrently by multiple sessions without failing with Jet_errWriteConflict.</span></span> <span data-ttu-id="f4fbd-149">Die [jetescrowupdate](./jetescrowupdate-function.md) -Funktion kann nur für hinterlegte Spalten, Spalten, die mit Jet_bitColumnEscrowUpdate erstellt wurden, aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="f4fbd-149">The [JetEscrowUpdate](./jetescrowupdate-function.md) function may only be called on escrow columns, columns that were created with Jet_bitColumnEscrowUpdate.</span></span>
