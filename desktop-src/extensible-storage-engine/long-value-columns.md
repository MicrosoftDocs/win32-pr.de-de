---
description: Weitere Informationen zu Spalten mit langen Werten
title: Lange Wert Spalten
TOCTitle: Long Value Columns
ms:assetid: 0690f9d3-1a58-4e53-92e1-213630fc88f4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269179(v=EXCHG.10)
ms:contentKeyID: 32765482
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: bb5618227d49de9e246adf69868a3cb2dc498dca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104041636"
---
# <a name="long-value-columns"></a><span data-ttu-id="4682b-103">Lange Wert Spalten</span><span class="sxs-lookup"><span data-stu-id="4682b-103">Long Value Columns</span></span>


<span data-ttu-id="4682b-104">_**Gilt für:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="4682b-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="long-value-columns"></a><span data-ttu-id="4682b-105">Lange Wert Spalten</span><span class="sxs-lookup"><span data-stu-id="4682b-105">Long Value Columns</span></span>

<span data-ttu-id="4682b-106">Die ESE-Spaltentypen JET_coltypLongText und JET_coltypLongBinary werden als Long-Wert-Spaltentypen bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="4682b-106">The ESE column types JET_coltypLongText and JET_coltypLongBinary are called long value column types.</span></span> <span data-ttu-id="4682b-107">Diese Spalten sind große Zeichen folgen und große binäre Objekte, die in separaten B +-Strukturen vom primären Index abgelegt werden können.</span><span class="sxs-lookup"><span data-stu-id="4682b-107">These columns are large string and large binary objects that may be stored in separate B+ trees away from the primary index.</span></span> <span data-ttu-id="4682b-108">Wenn lange Werte vom primären Datensatz getrennt gespeichert werden, werden Sie intern auf eine lange Wert-ID (LID) und einen Byte Offset (und als Datenstrom) zugegriffen.</span><span class="sxs-lookup"><span data-stu-id="4682b-108">When long values are stored separate from the primary record, they are internally keyed on a long value ID (LID) and byte offset and accessed as a stream.</span></span> <span data-ttu-id="4682b-109">Lange Wert Spalten werden der Tabelle im " [jetaddcolumn](./jetaddcolumn-function.md) "-Befehl hinzugefügt, wobei der **colttmember** der [JET_COLUMNDEF](./jet-columndef-structure.md) -Struktur entweder auf "JET_coltypLongText" oder "JET_coltypLongBinary" festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="4682b-109">Long value columns are added to the table in the call to [JetAddColumn](./jetaddcolumn-function.md) with the **coltyp** member of the [JET_COLUMNDEF](./jet-columndef-structure.md) structure set to either JET_coltypLongText or JET_coltypLongBinary.</span></span> <span data-ttu-id="4682b-110">Die maximal zulässige Größe für einen langen Text-oder Long-Binär Spaltenwert ist 2 GB-1.</span><span class="sxs-lookup"><span data-stu-id="4682b-110">The maximum size of a Long Text or Long Binary column value is 2 GB -1.</span></span>

<span data-ttu-id="4682b-111">ESE unterstützt Anfüge-, Byte Bereichs Überschreibungs-und Mengen Größen Vorgänge für Spalten mit langen Werten, um effiziente Streamimplementierungen für diese Spaltentypen zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="4682b-111">ESE supports append, byte range overwrite, and set size operations for long value columns to support efficient stream implementations on these column types.</span></span> <span data-ttu-id="4682b-112">Lange Wertdaten werden standardmäßig in einer separaten B +-Struktur gespeichert, wenn Sie größer als 1024 Byte ist, oder wenn der Datensatz nicht auf eine einzelne Datenbankseite passt, wenn die langen Wertdaten im Datensatz gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="4682b-112">By default, long value data is stored in a separate B+ tree if it is larger than 1024 bytes, or if the record does not fit on a single database page when the long value data is stored in the record.</span></span> <span data-ttu-id="4682b-113">Die Anwendung hat die Möglichkeit, das Standardverhalten zu überschreiben, indem Optionen zum Speichern von Long-Wert-Daten im Datensatz (JET_bitSetIntrinsicLV) festgelegt werden oder die Speicherung in der separaten B +-Struktur (JET_bitSetIntrinsicLV) erzwungen wird.</span><span class="sxs-lookup"><span data-stu-id="4682b-113">The application has the option to override the default behavior by setting options to store long value data in the record (JET_bitSetIntrinsicLV) or to force them to be stored in the separate B+ tree (JET_bitSetIntrinsicLV).</span></span> <span data-ttu-id="4682b-114">Diese Werte werden im *grbit* -Parameter in [jetsetcolumn](./jetsetcolumn-function.md)festgelegt, oder das **grbit** -Element [JET_SETCOLUMN](./jet-setcolumn-structure.md) im Aufrufen von [jetsetcolumns](./jetsetcolumns-function.md) wie folgt verwendet:</span><span class="sxs-lookup"><span data-stu-id="4682b-114">These values are set in the *grbit* parameter in [JetSetColumn](./jetsetcolumn-function.md), or the **grbit** member [JET_SETCOLUMN](./jet-setcolumn-structure.md) used in the call to [JetSetColumns](./jetsetcolumns-function.md) as follows:</span></span>

  - <span data-ttu-id="4682b-115">Anfügen: (JET_bitSetAppendLV)</span><span class="sxs-lookup"><span data-stu-id="4682b-115">Append: (JET_bitSetAppendLV)</span></span>

  - <span data-ttu-id="4682b-116">Byte Bereichs Überschreibung: (JET_bitSetOverwriteLV)</span><span class="sxs-lookup"><span data-stu-id="4682b-116">Byte Range Overwrite: (JET_bitSetOverwriteLV)</span></span>

  - <span data-ttu-id="4682b-117">Größe festlegen: (JET_bitSetSizeLV)</span><span class="sxs-lookup"><span data-stu-id="4682b-117">Set Size: (JET_bitSetSizeLV)</span></span>

  - <span data-ttu-id="4682b-118">Separate erzwingen: (JET_bitSetSeparateLV)</span><span class="sxs-lookup"><span data-stu-id="4682b-118">Force Separate: (JET_bitSetSeparateLV)</span></span>

  - <span data-ttu-id="4682b-119">In Datensatz speichern: (JET_bitSetIntrinsicLV)</span><span class="sxs-lookup"><span data-stu-id="4682b-119">Store In Record: (JET_bitSetIntrinsicLV)</span></span>

<span data-ttu-id="4682b-120">Die Long-Wert-Daten werden festgelegt, indem der Offset im Long Value-BLOB und die Länge der Long Value-Daten im BLOB angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="4682b-120">The long value data is set by indicating the offset into the long value blob, and the length of the long value data in the blob.</span></span> <span data-ttu-id="4682b-121">Der Offset zum Long Value-BLOB wird im **iblongvalue** -Member von [JET_SETINFO](./jet-setinfo-structure.md) -Struktur (für [jetsetcolumn](./jetsetcolumn-function.md)) oder dem **iblongvalue** -Member der [JET_SETCOLUMN](./jet-setcolumn-structure.md) -Struktur (für [jetsetcolumns](./jetsetcolumns-function.md)) festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4682b-121">The offset to the long value blob is set in the **ibLongValue** member of [JET_SETINFO](./jet-setinfo-structure.md) structure (for [JetSetColumn](./jetsetcolumn-function.md)) or the **ibLongValue** member of the [JET_SETCOLUMN](./jet-setcolumn-structure.md) structure (for [JetSetColumns](./jetsetcolumns-function.md)).</span></span> <span data-ttu-id="4682b-122">Der **pvData** -Member von [JET_SETCOLUMN](./jet-setcolumn-structure.md)und der *pvData* -Parameter im-Befehl von [jetsetcolumn](./jetsetcolumn-function.md) enthalten die Long-Wertdaten.</span><span class="sxs-lookup"><span data-stu-id="4682b-122">The **pvData** member of [JET_SETCOLUMN](./jet-setcolumn-structure.md), and *pvData* parameter in the call to [JetSetColumn](./jetsetcolumn-function.md) contains the long value data.</span></span> <span data-ttu-id="4682b-123">Aktualisierungen an Spalten mit langen Werten müssen innerhalb einer Transaktion ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="4682b-123">Updates to long value columns must be performed inside a transaction.</span></span>

<span data-ttu-id="4682b-124">Die langen Wertdaten werden immer in einer separaten Tabelle gespeichert, wenn die Anwendung die JET_bitSetSeparateLV oder JET_bitSetIntrinsicLV festlegt; andernfalls wird Sie heuristisch beschlossen.</span><span class="sxs-lookup"><span data-stu-id="4682b-124">The long value data is always stored in a separate table is when the application sets the JET_bitSetSeparateLV or JET_bitSetIntrinsicLV, otherwise it is heuristically decided.</span></span> <span data-ttu-id="4682b-125">ESE speichert den Long-Wert getrennt, wenn er größer als 1024 Byte ist oder wenn der Datensatz nicht auf eine einzelne Datenbankseite passt, wenn er im Datensatz gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="4682b-125">ESE stores the long value separated if it is larger than 1024 bytes or if the record would not fit on a single database page if stored in record.</span></span>

<span data-ttu-id="4682b-126">Im folgenden Diagramm werden die in einer separaten Tabelle gespeicherten Long-Value-Daten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4682b-126">The following diagram shows the long value data stored in separate table.</span></span> <span data-ttu-id="4682b-127">Wenn ein Long-Wert außerhalb des Datensatzes gespeichert wird, wird eine neue Long-Wert-ID erstellt, um auf ihren Wert zu verweisen.</span><span class="sxs-lookup"><span data-stu-id="4682b-127">When a long value is stored outside the record, a new long valued ID is created to refer to its value.</span></span> <span data-ttu-id="4682b-128">Dadurch können mehrere Datensätze auf denselben Spaltenwert verweisen.</span><span class="sxs-lookup"><span data-stu-id="4682b-128">This allows multiple records to refer to the same column value.</span></span> <span data-ttu-id="4682b-129">Verweis Zähler auf die Daten werden angehoben, wenn mehr als ein Datensatz in den Daten auf die gleichen Long-Wert-Daten verweist.</span><span class="sxs-lookup"><span data-stu-id="4682b-129">Reference counts to the data are increased if more than one record in the data points to the same long value data.</span></span>

<span data-ttu-id="4682b-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span><span class="sxs-lookup"><span data-stu-id="4682b-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span></span>

<span data-ttu-id="4682b-131">ESE unterstützt auch eine Single Instance Store-Funktion, mit der mehrere Datensätze auf dasselbe große binäre Objekt verweisen können, so als ob jeder Datensatz über eine eigene Kopie der Informationen verfügt. Dadurch werden doppelte Kopien der Spaltenwert Daten vermieden.</span><span class="sxs-lookup"><span data-stu-id="4682b-131">ESE also supports a single instance store feature that allows multiple records to reference the same large binary object as though each record had its own copy of the information; thus avoiding duplicate copies of the column value data.</span></span> <span data-ttu-id="4682b-132">Diese Funktion ist im Befehl [jetprepareupdate](./jetprepareupdate-function.md) mit der Option JET_prepInsertCopy im *prep* -Parameter aktiviert.</span><span class="sxs-lookup"><span data-stu-id="4682b-132">This feature is enabled in the call to [JetPrepareUpdate](./jetprepareupdate-function.md) with the JET_prepInsertCopy option set in the *prep* parameter.</span></span>
