---
description: In diesem Thema wird erläutert, wie eine Anwendung mithilfe der Peer Gruppierungs-APIs eine Verbindung mit einer Peer Gruppe herstellt.
ms.assetid: 56fa28d8-3b3a-4cd5-8448-c8c4ce8d0b2c
title: Vorgehensweise beim Herstellen einer Verbindung mit einer Peer Gruppe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d5bb3f41342573742e634a6e7ebce283188f3ffd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106358903"
---
# <a name="how-to-connect-to-a-peer-group"></a><span data-ttu-id="e27bc-103">Vorgehensweise beim Herstellen einer Verbindung mit einer Peer Gruppe</span><span class="sxs-lookup"><span data-stu-id="e27bc-103">How to Connect to a Peer Group</span></span>

<span data-ttu-id="e27bc-104">In diesem Thema wird erläutert, wie eine Anwendung mithilfe der Peer Gruppierungs-APIs eine Verbindung mit einer Peer Gruppe herstellt.</span><span class="sxs-lookup"><span data-stu-id="e27bc-104">This topic discusses how an application connects to a peer group using the Peer Grouping APIs.</span></span>

## <a name="joining-a-peer-group"></a><span data-ttu-id="e27bc-105">Beitreten zu einer Peer Gruppe</span><span class="sxs-lookup"><span data-stu-id="e27bc-105">Joining a Peer Group</span></span>

<span data-ttu-id="e27bc-106">Wenn Sie einer Peer Gruppe beitreten möchten, nennen Sie [**peergroupjoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin), und übergeben Sie dabei den Identitäts Namen des Peers und die Einladung (und einen optionalen PNRP-cloudnamen, wenn der cloudName in der Einladung mehrdeutig ist).</span><span class="sxs-lookup"><span data-stu-id="e27bc-106">To join a peer group, call [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin), passing in the identity name of the peer and the invitation (and an optional PNRP cloud name, if the cloud name in the invitation is ambiguous).</span></span>

<span data-ttu-id="e27bc-107">Wenn der Vorgang erfolgreich ist, gibt [**peergroupjoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin) ein Handle für die Peer Gruppe zurück.</span><span class="sxs-lookup"><span data-stu-id="e27bc-107">If successful, [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin) returns a handle to the peer group.</span></span>

<span data-ttu-id="e27bc-108">Wenn der Peer zuvor der Peer Gruppe beigetreten ist und dann das Handle geschlossen hat, sollte die Peer Gruppe durch Aufrufen von [**peergroupopen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) und übergeben des Namens der Peer Gruppe erneut geöffnet werden.</span><span class="sxs-lookup"><span data-stu-id="e27bc-108">If the peer has previously joined the peer group and then closed the handle, the peer group should be reopened by calling [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) and passing in the name of the peer group.</span></span> <span data-ttu-id="e27bc-109">Dieser Rückruf gibt ein neues Peer Gruppen Handle zurück.</span><span class="sxs-lookup"><span data-stu-id="e27bc-109">This call returns a new peer group handle.</span></span>

<span data-ttu-id="e27bc-110">Nachdem die Peer Gruppe erfolgreich verknüpft wurde, kann der Peer eine direkte Verbindung mit der Peer Gruppe herstellen und mit der Interaktion beginnen, indem [**peergroupconnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="e27bc-110">Once the peer group is successfully joined, the peer may connect directly to the peer group and begin interacting by calling [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect).</span></span> <span data-ttu-id="e27bc-111">Nachdem die Verbindung hergestellt wurde, wird der Peer als "Online" betrachtet.</span><span class="sxs-lookup"><span data-stu-id="e27bc-111">After connecting, the peer is considered to be "online".</span></span>

<span data-ttu-id="e27bc-112">Wenn eine Anwendung zu diesem Zeitpunkt nicht mit der Gruppe interagiert, kann Sie "Offline" bleiben.</span><span class="sxs-lookup"><span data-stu-id="e27bc-112">If an application will not interact with the group at the time, it can remain "offline".</span></span> <span data-ttu-id="e27bc-113">Wenn die Teilnahme an einer späteren Instanz direkt an der Peer Gruppe teilnimmt, wird Sie durch einen nachfolgenden [**peergroupconnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) -Befehl online geschaltet.</span><span class="sxs-lookup"><span data-stu-id="e27bc-113">If it chooses to participate directly in the peer group at a later instance, a subsequent call to [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) will bring it online.</span></span> <span data-ttu-id="e27bc-114">Nachdem ein Peer der Peer Gruppe beigetreten ist, muss er mindestens einmal eine Verbindung herstellen, bevor er Datensätze in der Peer Gruppe veröffentlichen kann.</span><span class="sxs-lookup"><span data-stu-id="e27bc-114">After a peer has joined the peer group, it must connect at least once before it will be able to publish records to the peer group.</span></span>

## <a name="opening-a-peer-group-without-connecting-offline"></a><span data-ttu-id="e27bc-115">Öffnen einer Peer Gruppe ohne Verbindung (offline)</span><span class="sxs-lookup"><span data-stu-id="e27bc-115">Opening a Peer Group Without Connecting (Offline)</span></span>

<span data-ttu-id="e27bc-116">Häufig möchten Sie, dass eine Anwendung eine Verbindung mit einer Peer Gruppe herstellt, Sie jedoch nicht direkt daran beteiligt, Daten Satz Aktualisierungen empfängt und veröffentlicht, aber keine Daten Nachrichten sendet oder empfängt.</span><span class="sxs-lookup"><span data-stu-id="e27bc-116">Often, you may wish to have an application connect to a peer group but not directly participate it, receiving and publishing record updates but not sending or receiving data messages.</span></span> <span data-ttu-id="e27bc-117">Eine Anwendung befindet sich unmittelbar nach dem Aufrufen von " [**Peer groupcreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate)", " [**Peer GroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin)" oder " [**Peer groupopen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) " in diesem Status "Offline".</span><span class="sxs-lookup"><span data-stu-id="e27bc-117">An application is in this "offline" state immediately after [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin), or [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) have been called.</span></span>

<span data-ttu-id="e27bc-118">Eine Offline Anwendung kann jederzeit online geschaltet werden, indem " [**Peer groupconnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect)" aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="e27bc-118">An offline application can go online at any time by calling [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect).</span></span> <span data-ttu-id="e27bc-119">Nachdem die Verbindung hergestellt wurde, kann eine Peer Gruppe erst offline geschaltet werden, wenn alle anderen Anwendungen, die dieser Identität zugeordnet sind und die diese Gruppe freigeben, ebenfalls über geschlossene Verbindungen verfügen.</span><span class="sxs-lookup"><span data-stu-id="e27bc-119">Once connected, a peer group cannot go offline until all other applications associated with this identity and sharing this group have closed connections to it as well.</span></span>

<span data-ttu-id="e27bc-120">Eine Peer Gruppe ist eine freigegebene Ressource mit der gleichen Peer Gruppe, die für mehrere Anwendungen verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="e27bc-120">A peer group is a shared resource, with the same peer group available to multiple applications.</span></span> <span data-ttu-id="e27bc-121">Wenn mehr als eine Anwendung für die gleiche Identität und den Windows-Benutzer dieselbe Peer Gruppe verwendet, nutzen Sie auch die gleiche zugrunde liegende Datenbank und die gleichen Verbindungen (Nachbar und direkt).</span><span class="sxs-lookup"><span data-stu-id="e27bc-121">If more than one application for the same identity and Windows user is using the same peer group, they also share the same underlying database and connections (neighbor and direct).</span></span> <span data-ttu-id="e27bc-122">Wenn eine dieser Anwendungen [**peergroupconnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect)aufruft, stellen alle anderen Anwendungen für diese Identität bzw. diesen Benutzer, die an der Gruppe teilnehmen, auch eine Verbindung mit der Gruppe her.</span><span class="sxs-lookup"><span data-stu-id="e27bc-122">If any one of these applications calls [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect), all of the other applications for this identity/user participating in the group also connect to the group.</span></span> <span data-ttu-id="e27bc-123">Wenn ein Datensatz von einer Anwendung hinzugefügt wird, während die Gruppe offline ist, können andere Anwendungen Sie sehen.</span><span class="sxs-lookup"><span data-stu-id="e27bc-123">If a record is added by one application while the group is offline, other applications are also be able to see it.</span></span> <span data-ttu-id="e27bc-124">Daher muss eine Anwendung jederzeit online geschaltet werden können.</span><span class="sxs-lookup"><span data-stu-id="e27bc-124">As a result, an application must be ready to go online at any time.</span></span>

## <a name="connecting-to-a-peer-group-online"></a><span data-ttu-id="e27bc-125">Herstellen einer Verbindung mit einer Peer Gruppe (Online)</span><span class="sxs-lookup"><span data-stu-id="e27bc-125">Connecting to a Peer Group (Online)</span></span>

<span data-ttu-id="e27bc-126">Um mit der Teilnahme an einer Gruppe zu beginnen, können Sie [**peergroupconnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) aufrufen, nachdem Sie die Gruppe erstellt, beitreten oder geöffnet haben.</span><span class="sxs-lookup"><span data-stu-id="e27bc-126">To begin participating in a group, call [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) after creating, joining, or opening the group.</span></span> <span data-ttu-id="e27bc-127">In diesem Zustand können direkte Verbindungen mit anderen Peers geöffnet werden, die an derselben Gruppe teilnehmen, indem [**peergroupopendirectconnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="e27bc-127">In this state, direct connections can be opened with other peers participating in the same group by calling [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection).</span></span>

<span data-ttu-id="e27bc-128">Um zu ermitteln, ob bei einem Verbindungsversuch ein Fehler aufgetreten ist, registrieren Sie sich für das Ereignis Verbindungsfehler bei der Peer \_ Gruppe \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="e27bc-128">To detect if a connection attempt has failed, register for the PEER\_GROUP\_EVENT\_CONNECTION\_FAILED event.</span></span> <span data-ttu-id="e27bc-129">Dieses Ereignis wird ausgelöst, wenn die Gruppierungs Infrastruktur keinen anderen Member finden kann, mit dem eine Verbindung hergestellt werden kann, oder wenn die Verbindung fehlschlägt, bevor die Gruppen Datenbank synchronisiert wird und keine andere Verbindung hergestellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="e27bc-129">This event is raised if the grouping infrastructure cannot find another member to connect to, or if the connection fails before the group database is synchronized and another connection cannot be established.</span></span>

<span data-ttu-id="e27bc-130">Obwohl mehrere Anwendungen, die auf dem Peer ausgeführt werden und an derselben Gruppe mit der gleichen Peer Identität beteiligt sind, möglicherweise offline sind, führt ein Aufrufen von [**peergroupconnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) durch eine der Anwendungen dazu, dass alle Anwendungen online werden.</span><span class="sxs-lookup"><span data-stu-id="e27bc-130">Although multiple applications executing on the peer and participating in the same group with the same peer identity may be offline, a call to [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) by any one of the applications results in all of the applications becoming online.</span></span>

<span data-ttu-id="e27bc-131">Wenn eine Anwendung auf dem Peer eine Verbindung mit der Gruppe hergestellt hat, sind auch alle anderen Anwendungen, die [**peergroupjoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin) oder [**peergroupopen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) aufrufen, sofort verbunden.</span><span class="sxs-lookup"><span data-stu-id="e27bc-131">Also, if one application on the peer has connected to the group, any other applications that call [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin) or [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen) are immediately connected as well.</span></span> <span data-ttu-id="e27bc-132">Wenn eine Anwendung " [**Peer groupclose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose)" aufruft, wird das Handle nur für diese Anwendung geschlossen.</span><span class="sxs-lookup"><span data-stu-id="e27bc-132">If an application calls [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), the handle is closed for only that application.</span></span> <span data-ttu-id="e27bc-133">Folglich gibt ein nachfolgende Aufrufen von **peergroupopen** durch die Anwendung ein neues Gruppen Handle zurück, und die Anwendung wird sofort online geschaltet, wenn andere Anwendungen, die an derselben Gruppe teilnehmen, weiterhin verbunden sind.</span><span class="sxs-lookup"><span data-stu-id="e27bc-133">Thus, a subsequent call to **PeerGroupOpen** by the application returns a new group handle, and the application is brought online immediately if any other applications participating in the same group are still connected.</span></span>

## <a name="sending-and-receiving-data"></a><span data-ttu-id="e27bc-134">Senden und empfangen von Daten</span><span class="sxs-lookup"><span data-stu-id="e27bc-134">Sending and Receiving Data</span></span>

<span data-ttu-id="e27bc-135">Zum Senden und empfangen von Daten zwischen bestimmten Mitglieds Knoten in der Gruppe müssen Direktverbindungen mit den Mitgliedern hergestellt werden, mit denen Sie interagieren möchten.</span><span class="sxs-lookup"><span data-stu-id="e27bc-135">To send and receive data between specific member nodes in the group, direct connections must be established with those members you intend to interact with.</span></span> <span data-ttu-id="e27bc-136">Das Einrichten einer direkten Verbindung ist ein asynchroner [**peergroupopendirectconnection-Peering**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection)und übergibt das Handle für eine verbundene Gruppe sowie die Identität des Peers innerhalb der Gruppe, mit der Sie eine Verbindung herstellen möchten.</span><span class="sxs-lookup"><span data-stu-id="e27bc-136">Establishing a direct connection is an asynchronous call to [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection), passing in the handle for a connected group as well as the identity of the peer within the group you wish to connect to.</span></span> <span data-ttu-id="e27bc-137">Diese Methode gibt eine Verbindungs-ID zurück.</span><span class="sxs-lookup"><span data-stu-id="e27bc-137">This method will return a connection ID.</span></span> <span data-ttu-id="e27bc-138">Wenn der-Vorgang erfolgreich ist, \_ \_ wird auf dem Peer ein Ereignis für eine Peer Gruppen Ereignis- \_ direkte \_ Verbindung ausgelöst, wobei die Verbindungs-ID überprüft wird.</span><span class="sxs-lookup"><span data-stu-id="e27bc-138">If the call is successful, a PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION event is raised on the peer, validating the connection ID.</span></span>

<span data-ttu-id="e27bc-139">Um direkte Verbindungen von anderen Online Peers zu empfangen, registrieren Sie sich \_ \_ \_ \_ mit einem [**peergroupregisterevent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent)-Ereignis für das Peer Group Event Direct Connection-Ereignis.</span><span class="sxs-lookup"><span data-stu-id="e27bc-139">To receive direct connections from other online peers, register for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION event with a call to [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span></span>

<span data-ttu-id="e27bc-140">Sobald eine direkte Verbindung hergestellt wurde, kann die Anwendung mit dem Senden von Daten mit Aufrufen von " [**Peer Group Data**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata)" beginnen und dabei die gültige Verbindungs-ID übergeben.</span><span class="sxs-lookup"><span data-stu-id="e27bc-140">Once a direct connection has been successfully established, the application can begin sending data with calls to [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata), passing the valid connection ID.</span></span> <span data-ttu-id="e27bc-141">Die Reihenfolge von mehrteiligen Datenübertragungen wird von " **Peer Group**" verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="e27bc-141">The ordering of multipart data transmissions is handled by **PeerGroupSendData**.</span></span> <span data-ttu-id="e27bc-142">Anwendungen sollten jedoch einen ordnungsgemäßen Protokollstapel implementieren, um die nicht transparenten Daten zu verarbeiten, die von diesem API-Befehl zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="e27bc-142">However, applications should implement a proper protocol stack for handling the opaque data returned by this API call.</span></span>

<span data-ttu-id="e27bc-143">Um Daten über eine direkte Verbindung zu empfangen, muss sich die Anwendung \_ \_ \_ \_ mit [**peergroupregisterevent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent)für das Ereignis eingehende Daten der Peer Gruppe registrieren.</span><span class="sxs-lookup"><span data-stu-id="e27bc-143">To receive data over a direct connection, the application must register for the PEER\_GROUP\_EVENT\_INCOMING\_DATA event with [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span></span> <span data-ttu-id="e27bc-144">Der Ereignishandler ist für das Abrufen und Anordnen der nicht transparenten Daten und die Übergabe an die Anwendung zuständig.</span><span class="sxs-lookup"><span data-stu-id="e27bc-144">The event handler is responsible for obtaining and ordering the opaque data, and passing it to the application.</span></span> <span data-ttu-id="e27bc-145">Diese Daten werden innerhalb des Ereignis Handlers abgerufen, indem " [**Peer groupgeteventdata**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) " mit dem Handle für die registrierten Ereignisse aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="e27bc-145">This data is obtained within the event handler by calling [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) with the handle to the registered events.</span></span>

<span data-ttu-id="e27bc-146">Eine direkte Verbindung wird geschlossen, indem [**peergroupclosedirectconnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) aufgerufen und die Verbindungs-ID übergeben wird, die durch einen vorherigen Aufruf von [**peergroupopendirectconnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) abgerufen oder in den Ereignisdaten für die \_ \_ \_ direkte Verbindung mit der Peer-Ereignis Gruppe empfangen wurde \_ .</span><span class="sxs-lookup"><span data-stu-id="e27bc-146">A direct connection is closed by calling [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) and passing in the connection ID obtained by a previous call to [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) or received in the event data for PEER\_EVENT\_GROUP\_DIRECT\_CONNECTION.</span></span>

 

 



