---
title: Verwenden der Server-API der Windows-Bereitstellungsdienste
description: In Umgebungen, in denen die Standardlösung für Windows-Bereitstellungs Dienste (Windows Deployment Services, WDS) nicht verwendet werden kann, macht der WDS-Server eine API verfügbar, die Entwicklern das Schreiben von Plug-ins, die als Anbieter bezeichnet werden, zum Verarbeiten von PXE-Anforderungen (Preboot Execution Environment
ms.assetid: 5e25654a-33c6-4c0f-acc3-e938d1f4a4e7
keywords:
- Windows-Bereitstellungs Dienste Windows-Bereitstellungs Dienste, verwenden der Server-API
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d3634dffa73eddc9b5db92be6bc807cccbc5248f
ms.sourcegitcommit: c2a1c4314550ea9bd202d28adfcc7bfe6180932f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/11/2020
ms.locfileid: "103724257"
---
# <a name="using-the-windows-deployment-services-server-api"></a><span data-ttu-id="e677d-104">Verwenden der Server-API der Windows-Bereitstellungsdienste</span><span class="sxs-lookup"><span data-stu-id="e677d-104">Using the Windows Deployment Services Server API</span></span>

<span data-ttu-id="e677d-105">In Umgebungen, in denen die Standardlösung für Windows-Bereitstellungs Dienste (Windows Deployment Services, WDS) nicht verwendet werden kann, macht der WDS-Server eine API verfügbar, die Entwicklern das Schreiben von Plug-ins, die als Anbieter bezeichnet werden, zum Verarbeiten von PXE-Anforderungen (Preboot Execution Environment</span><span class="sxs-lookup"><span data-stu-id="e677d-105">In environments where the standard Windows Deployment Services (WDS) solution cannot be used, the WDS server exposes an API that enables developers to write plug-ins, referred to as providers, to handle preboot execution environment (PXE) requests.</span></span> <span data-ttu-id="e677d-106">Entwickler sollten die folgenden Richtlinien befolgen, wenn Sie PXE-Anbieter für WDS schreiben.</span><span class="sxs-lookup"><span data-stu-id="e677d-106">Developers should adhere to the following guidelines when writing PXE providers for WDS.</span></span>

## <a name="install-the-wds-role-on-the-server"></a><span data-ttu-id="e677d-107">Installieren der WDS-Rolle auf dem Server</span><span class="sxs-lookup"><span data-stu-id="e677d-107">Install the WDS Role on the Server</span></span>

-   <span data-ttu-id="e677d-108">Bei den Windows-Bereitstellungs Diensten (Windows Deployment Services, WDS) handelt es sich um die überarbeitete Version der Remoteinstallations Dienste (Remote Installation Services, RIS). Sie benötigen die WDS-Server Rolle, um den WDS</span><span class="sxs-lookup"><span data-stu-id="e677d-108">Windows Deployment Services (WDS) is the revised version of Remote Installation Services (RIS), you will need the WDS server role to implement the WDS PXE server and providers.</span></span>
-   <span data-ttu-id="e677d-109">WDS ersetzt RIS als Standardkomponente ab Windows Server 2008 und Windows Server 2003 mit Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="e677d-109">WDS replaces RIS as the standard component starting with Windows Server 2008 and Windows Server 2003 with Service Pack 2 (SP2).</span></span>
-   <span data-ttu-id="e677d-110">Sie müssen den RIS-Server auf WDS unter Windows Server 2003 mit Service Pack 1 (SP1) aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="e677d-110">You must update the RIS server to WDS on Windows Server 2003 with Service Pack 1 (SP1).</span></span> <span data-ttu-id="e677d-111">Sie können die WDS-Server Rolle mit dem [Windows Automated Installation Kit (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333)installieren.</span><span class="sxs-lookup"><span data-stu-id="e677d-111">You can install the WDS server role with the [Windows Automated Installation Kit (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span></span>

## <a name="register-providers"></a><span data-ttu-id="e677d-112">Anbieter registrieren</span><span class="sxs-lookup"><span data-stu-id="e677d-112">Register Providers</span></span>

-   <span data-ttu-id="e677d-113">Registrieren Sie die Anbieter-DLL (Dynamic Link Library) während der Installation, und fügen Sie den Anbieter in die geordnete Liste registrierter Anbieter ein.</span><span class="sxs-lookup"><span data-stu-id="e677d-113">Register the provider dynamic-link library (DLL) during its installation and insert the provider into the ordered list of registered providers.</span></span>
    > [!Note]  
    > <span data-ttu-id="e677d-114">Wenn Sie einen neuen oder geänderten Anbieter installieren, müssen Sie den WDS-PXE-Dienst neu starten, damit die Änderungen wirksam werden.</span><span class="sxs-lookup"><span data-stu-id="e677d-114">When you install a new or modified provider, you will need to restart WDS PXE service for the changes to take effect.</span></span>

     

-   <span data-ttu-id="e677d-115">Verwenden Sie die [**pxeproviderregister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister) -Funktion, um den Anbieter zu registrieren und der Liste hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="e677d-115">Use the [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister) function to register the provider and add it to the list.</span></span> <span data-ttu-id="e677d-116">Verwenden Sie die [**pxeproviderunregister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderunregister) -Funktion, um die Registrierung eines registrierten Anbieters aufzuheben und aus der Liste zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="e677d-116">Use the [**PxeProviderUnRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderunregister) function to unregister a registered provider and remove it from the list.</span></span>
-   <span data-ttu-id="e677d-117">Geben Sie die Reihenfolge des Anbieters in der geordneten Liste an.</span><span class="sxs-lookup"><span data-stu-id="e677d-117">Specify the sequence of the provider in the ordered list.</span></span> <span data-ttu-id="e677d-118">Der Index eines Anbieters in der Liste kann nicht garantiert werden, weil ein anderer Anbieter möglicherweise später registriert wird.</span><span class="sxs-lookup"><span data-stu-id="e677d-118">The index of a provider in the list cannot be guaranteed because another provider may later be registered before it.</span></span> <span data-ttu-id="e677d-119">Um den Anbieter vor oder nach einem anderen registrierten Anbieter in der Liste einzufügen, verwenden Sie zunächst die [**pxeproviderqueryindex**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderqueryindex) -Funktion, um den Index des registrierten Anbieters zu erhalten, und registrieren Sie dann den neuen Anbieter, während Sie einen größeren oder kleineren Indexwert angeben.</span><span class="sxs-lookup"><span data-stu-id="e677d-119">To insert the provider in the list before or after another registered provider, first use the [**PxeProviderQueryIndex**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderqueryindex) function to get the index of the registered provider and then register the new provider while specifying a larger or smaller index value.</span></span>
-   <span data-ttu-id="e677d-120">Bei der Installation können Anbieter Konfigurationsinformationen unter dem Registrierungsschlüssel gespeichert werden, der zurückgegeben wird, wenn der Anbieter registriert wird.</span><span class="sxs-lookup"><span data-stu-id="e677d-120">The installation can store provider configuration information under the registry key returned when the provider is registered.</span></span> <span data-ttu-id="e677d-121">Die Adresse des Registrierungsschlüssels wird vom *phproviderkey* von [**pxeproviderregister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister)empfangen.</span><span class="sxs-lookup"><span data-stu-id="e677d-121">The address of the registry key is received by the *phProviderKey* of [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister).</span></span> <span data-ttu-id="e677d-122">Der Anbieter erhält ein Handle für denselben Schlüssel wie der *hproviderkey* -Parameter für seinen [*pxeproviderinitialize*](pxeproviderinitialize.md) -Rückruf.</span><span class="sxs-lookup"><span data-stu-id="e677d-122">The provider receives a handle to this same key as the *hProviderKey* parameter to its [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span> <span data-ttu-id="e677d-123">Der Anbieter sollte die Adresse dieses Schlüssels speichern.</span><span class="sxs-lookup"><span data-stu-id="e677d-123">The provider should store the address of this key.</span></span>
-   <span data-ttu-id="e677d-124">Installieren Sie immer die Anbieter-DLL (Dynamic-Link Library) im Ordner "Programme" des Servers.</span><span class="sxs-lookup"><span data-stu-id="e677d-124">Always install the provider dynamic-link library (DLL) in the server's Program Files folder.</span></span>

## <a name="initialize"></a><span data-ttu-id="e677d-125">Initialisieren</span><span class="sxs-lookup"><span data-stu-id="e677d-125">Initialize</span></span>

-   <span data-ttu-id="e677d-126">Fügen Sie eine DLL ein, die die [*pxeproviderinitialize*](pxeproviderinitialize.md) -Rückruffunktion in den Anbieter exportiert.</span><span class="sxs-lookup"><span data-stu-id="e677d-126">Include a DLL that exports the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback function in the provider.</span></span> <span data-ttu-id="e677d-127">Jeder Anbieter erfordert einen *pxeproviderinitialize* -Rückruf.</span><span class="sxs-lookup"><span data-stu-id="e677d-127">Every provider requires a *PxeProviderInitialize* callback.</span></span> <span data-ttu-id="e677d-128">Wenn WDS einen Anbieter lädt, ruft er die *pxeproviderinitialize* -Funktion des Anbieters auf und übergibt ein Handle an denselben Schlüssel, der zum Speichern der Konfigurationsinformationen während der Anbieter Registrierung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="e677d-128">When WDS loads a provider, it calls the provider's *PxeProviderInitialize* function and passes a handle to the same key that is used to store configuration information during provider registration.</span></span>
-   <span data-ttu-id="e677d-129">Wenn der [*pxeproviderinitialize*](pxeproviderinitialize.md) -Rückruf zurückkehrt und erfolgreich ist, sollte der Anbieter vollständig initialisiert und bereit für die Verarbeitung von Anforderungen sein.</span><span class="sxs-lookup"><span data-stu-id="e677d-129">When the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback returns and is successful, the provider should be fully initialized and ready to process requests.</span></span>
-   <span data-ttu-id="e677d-130">Registrieren Sie bei der Verarbeitung der [*pxeproviderinitialize*](pxeproviderinitialize.md) -Funktion jeden Rückruf im Anbieter.</span><span class="sxs-lookup"><span data-stu-id="e677d-130">Register every callback in the provider during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) function.</span></span> <span data-ttu-id="e677d-131">Rückrufe sollten bei der [**pxeregistercallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) -Funktion registriert werden.</span><span class="sxs-lookup"><span data-stu-id="e677d-131">Callbacks should be registered with the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function.</span></span>
-   <span data-ttu-id="e677d-132">Initialisieren Sie alle internen Ressourcen des Anbieters innerhalb der Verarbeitung der [*pxeproviderinitialize*](pxeproviderinitialize.md) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="e677d-132">Initialize all the provider's internal resources within the processing of its [*PxeProviderInitialize*](pxeproviderinitialize.md) function.</span></span>

## <a name="shutdown"></a><span data-ttu-id="e677d-133">Shutdown</span><span class="sxs-lookup"><span data-stu-id="e677d-133">Shutdown</span></span>

-   <span data-ttu-id="e677d-134">Implementieren Sie den [*pxeprovidershutdown*](pxeprovidershutdown.md) -Rückruf.</span><span class="sxs-lookup"><span data-stu-id="e677d-134">Implement the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback.</span></span> <span data-ttu-id="e677d-135">Jeder Anbieter muss über einen *pxeprovidershutdown*-Rückruf verfügen.</span><span class="sxs-lookup"><span data-stu-id="e677d-135">Every provider is required to have a *PxeProviderShutdown* callback.</span></span>
-   <span data-ttu-id="e677d-136">Die [*pxeprovidershutdown*](pxeprovidershutdown.md) -Rückruffunktion sollte den Anbieter vollständig Herunterfahren und alle zugehörigen Ressourcen freigeben.</span><span class="sxs-lookup"><span data-stu-id="e677d-136">The [*PxeProviderShutdown*](pxeprovidershutdown.md) callback function should fully shut down the provider and release all its resources.</span></span>
-   <span data-ttu-id="e677d-137">Nachdem der [*pxeprovidershutdown*](pxeprovidershutdown.md) -Rückruf zurückgegeben wurde, ist das an die [*pxeproviderinitialize*](pxeproviderinitialize.md) -Funktion weiter gegebene *hprovider* -Handle nicht mehr gültig und sollte nicht zum Abrufen von WDS verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e677d-137">After the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback returns, the *hProvider* handle passed to the [*PxeProviderInitialize*](pxeproviderinitialize.md) function is no longer valid and should not be used to call WDS.</span></span>
-   <span data-ttu-id="e677d-138">Registrieren Sie den [*pxeprovidershutdown*](pxeprovidershutdown.md) -Rückruf durch Aufrufen der [**pxeregistercallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) -Funktion mit dem Herunterfahren des **PXE- \_ Rückrufs \_** während der Verarbeitung des [*pxeproviderinitialize*](pxeproviderinitialize.md) -Rückrufs.</span><span class="sxs-lookup"><span data-stu-id="e677d-138">Register the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_SHUTDOWN** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span> <span data-ttu-id="e677d-139">Rufen Sie den *pxeprovidershutdown* -Rückruf nicht auf, wenn die *pxeproviderinitialize* -Funktion fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="e677d-139">Do not call the *PxeProviderShutdown* callback if the *PxeProviderInitialize* function fails.</span></span>

## <a name="handle-request-packet"></a><span data-ttu-id="e677d-140">Anforderungspaket verarbeiten</span><span class="sxs-lookup"><span data-stu-id="e677d-140">Handle Request Packet</span></span>

<span data-ttu-id="e677d-141">Implementieren Sie den [*pxeproviderrecvrequest*](pxeproviderrecvrequest.md) -Rückruf für den Anbieter.</span><span class="sxs-lookup"><span data-stu-id="e677d-141">Implement the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback for the provider.</span></span> <span data-ttu-id="e677d-142">Jeder Anbieter muss über einen *pxeproviderrecvrequest* -Rückruf verfügen.</span><span class="sxs-lookup"><span data-stu-id="e677d-142">Every provider is required to have a *PxeProviderRecvRequest* callback.</span></span> <span data-ttu-id="e677d-143">Wenn WDS eine Anforderung empfängt, ruft er den *pxeproviderrecvrequest* -Rückruf für den ersten Anbieter in der Liste registrierter Anbieter auf.</span><span class="sxs-lookup"><span data-stu-id="e677d-143">When WDS receives a request, it calls the *PxeProviderRecvRequest* callback for the first provider in the registered provider list.</span></span>

-   <span data-ttu-id="e677d-144">Wenn der Anbieter diese Anforderung synchron verarbeitet, sollte die [*pxeproviderrecvrequest*](pxeproviderrecvrequest.md) -Funktion den Wert **Fehler \_ erfolgreich** zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="e677d-144">If the provider will process this request synchronously, the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) function should return a value of **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="e677d-145">Nur dann, wenn der Anbieter diese Anforderung asynchron verarbeitet, sollte der *pxeproviderrecvrequest* -Rückruf die Fehler-e/a **\_ \_ Ausstehend** zurückgeben und die [**pxeasyncrecvdone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) -Funktion aufzurufen, wenn die Anforderung verarbeitet wurde.</span><span class="sxs-lookup"><span data-stu-id="e677d-145">If and only if the provider will process this request asynchronously, the *PxeProviderRecvRequest* callback should return **ERROR\_IO\_PENDING** and call the [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) function when the request has been processed.</span></span>
-   <span data-ttu-id="e677d-146">Der [*pxeproviderrecvrequest*](pxeproviderrecvrequest.md) -Rückruf und die [**pxeasyncrecvdone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) -Funktion gibt die Adresse einer **PXE- \_ Start \_ Aktions** -Aufzählung zurück, die die vom Anbieter zum Verarbeiten der Anforderung ausgeführte Aktion beschreibt.</span><span class="sxs-lookup"><span data-stu-id="e677d-146">The [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback and the [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) function returns the address of a **PXE\_BOOT\_ACTION** enum that describes the action taken by the provider to handle the request.</span></span>

    <span data-ttu-id="e677d-147">Es gibt vier Möglichkeiten für einen Anbieter, eine Anforderung zu verarbeiten:</span><span class="sxs-lookup"><span data-stu-id="e677d-147">There are four ways for a provider to handle a request:</span></span>

    -   <span data-ttu-id="e677d-148">Der Anbieter antwortet dem Client mit einem Standard-DHCP-Antwortpaket, das einen Pfad zum Netzwerkstart Programm enthält.</span><span class="sxs-lookup"><span data-stu-id="e677d-148">The provider replies to the client with a standard DHCP response packet that contains a path to the Network Boot Program.</span></span> <span data-ttu-id="e677d-149">Das Zurückgeben des **PXE \_ BA- \_ NBP** -Werts für die Enumeration bedeutet, dass der Anbieter das Anforderungspaket erfolgreich verarbeitet und die Anforderung durch das Senden eines Antwort Pakets durch Aufrufen der Funktionen [**pxepacketallocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) und [**pxesendreply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) abgeschlossen hat.</span><span class="sxs-lookup"><span data-stu-id="e677d-149">Returning the **PXE\_BA\_NBP** value for the enum means that the provider has successfully processed the request packet and completed the request by sending a response packet by calling the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) and [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) functions.</span></span>
    -   <span data-ttu-id="e677d-150">Der Anbieter antwortet dem Client mit einem benutzerdefinierten Antwortpaket, das nicht DHCP entspricht.</span><span class="sxs-lookup"><span data-stu-id="e677d-150">The provider replies to the client with a custom response packet that does not conform to DHCP.</span></span> <span data-ttu-id="e677d-151">Das Zurückgeben des **\_ \_ benutzerdefinierten PXE BA** -Werts für die Enumeration bedeutet, dass der Anbieter das Anforderungspaket erfolgreich verarbeitet und die Anforderung durch das Senden eines benutzerdefinierten Antwort Pakets durch Aufrufen der Funktionen [**pxepacketallocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) und [**pxesendreply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) abgeschlossen hat.</span><span class="sxs-lookup"><span data-stu-id="e677d-151">Returning the **PXE\_BA\_CUSTOM** value for the enum means that the provider has successfully processed the request packet and completed the request by sending a custom response packet by calling the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) and [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) functions.</span></span>
    -   <span data-ttu-id="e677d-152">Der Anbieter bestimmt, dass die Anforderung ignoriert werden soll.</span><span class="sxs-lookup"><span data-stu-id="e677d-152">The provider determines the request should be ignored.</span></span> <span data-ttu-id="e677d-153">Durch die Rückgabe des **PXE \_ BA- \_ ignorierwerts** für die Enumeration hat der Anbieter alle Ressourcen freigegeben, die der Anforderung zugeordnet sind, und die Anforderung wird nicht an den nächsten Anbieter in der Liste der registrierten Anbieter übergeben.</span><span class="sxs-lookup"><span data-stu-id="e677d-153">Returning the **PXE\_BA\_IGNORE** value for the enum means the provider has released all resources associated with the request and the request is not passed to the next provider in the list of registered providers.</span></span> <span data-ttu-id="e677d-154">Anbieter können diese Option verwenden, wenn Sie feststellen, dass ein Anforderungspaket ungültig ist.</span><span class="sxs-lookup"><span data-stu-id="e677d-154">Providers may use this option if they detect that a request packet is invalid.</span></span>
    -   <span data-ttu-id="e677d-155">Der Anbieter lehnt die Dienst Anforderung ab.</span><span class="sxs-lookup"><span data-stu-id="e677d-155">The provider declines to service the request.</span></span> <span data-ttu-id="e677d-156">Die Rückgabe des **PXE \_ BA- \_ Ablehnungs** Werts für die Enumeration weist das System an, die Anforderung an den nächsten Anbieter in der Liste der registrierten Anbieter zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="e677d-156">Returning the **PXE\_BA\_REJECT** value for the enum instructs the system to pass the request to the next provider in the list of registered providers.</span></span> <span data-ttu-id="e677d-157">Wenn dies der letzte Anbieter in der Liste wäre, werden alle der Anforderung zugeordneten Ressourcen freigegeben, und die Anforderung wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="e677d-157">If this were the last provider in the list, this releases all resources associated with the request and the request is ignored.</span></span>
    -   <span data-ttu-id="e677d-158">Registrieren Sie den [*pxeproviderrecvrequest*](pxeproviderrecvrequest.md) -Rückruf durch Aufrufen der [**pxeregistercallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) -Funktion mit **PXE \_ Callback \_ recv \_ Request** während der Verarbeitung des [*pxeproviderinitialize*](pxeproviderinitialize.md) -Rückrufs.</span><span class="sxs-lookup"><span data-stu-id="e677d-158">Register the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_RECV\_REQUEST** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span>

## <a name="generate-response-packet"></a><span data-ttu-id="e677d-159">Antwortpaket generieren</span><span class="sxs-lookup"><span data-stu-id="e677d-159">Generate Response Packet</span></span>

-   <span data-ttu-id="e677d-160">Verwenden Sie die API zum Schreiben von Anbietern, um die DHCP-Anforderung zu verarbeiten und Antwort Pakete zu generieren.</span><span class="sxs-lookup"><span data-stu-id="e677d-160">Use the API to write providers to handle DHCP request and generate response packets.</span></span>
-   <span data-ttu-id="e677d-161">Die [**pxeprovidersetattribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) -Funktion gibt die Attribute an, die vom Anbieter zum Filtern von Paketen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e677d-161">The [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) function specifies the attributes used by the provider to filter packets.</span></span> <span data-ttu-id="e677d-162">Die Attribute des Anbieters können so angegeben werden, dass der Anbieter alle Pakete sieht, der Anbieter nur DHCP-Pakete erkennt oder der Anbieter nur DHCP-Pakete erkennt, die die DHCP-Anbieter Klassen-Bezeichneroption (60) als "PXEClient" angeben.</span><span class="sxs-lookup"><span data-stu-id="e677d-162">The attributes of the provider can be specified so that the provider see all packets, the provider sees only DHCP packets, or the provider sees only DHCP packets that specify the DHCP Vendor Class Identifier option (60) as "PXEClient".</span></span>
-   <span data-ttu-id="e677d-163">Die [**pxedhcpisvalid**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpisvalid) -Funktion überprüft, ob ein Paket ein gültiges DHCP-Paket ist.</span><span class="sxs-lookup"><span data-stu-id="e677d-163">The [**PxeDhcpIsValid**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpisvalid) function checks that a packet is a valid DHCP packet.</span></span> <span data-ttu-id="e677d-164">Anbieter können die **pxedhcpisvalid** -Funktion verwenden, um zu überprüfen, ob ein Paket vom Client ein DHCP-Paket ist, wenn der Filtersatz mit der [**pxeprovidersetattribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) -Funktion auf den Empfang aller Pakete festgelegt ist, um zu bestimmen, ob ein bestimmtes Paket ein gültiges DHCP-Paket ist.</span><span class="sxs-lookup"><span data-stu-id="e677d-164">Providers can use the **PxeDhcpIsValid** function to check whether a packet from the client is a DHCP packet when the filter set with the [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) function is set to receive all packets to determine if a specified packet is a valid DHCP packet.</span></span>
-   <span data-ttu-id="e677d-165">Die [**pxedhcpinitialize**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpinitialize) -Funktion initialisiert ein Antwortpaket als DHCP-Antwortpaket, das auf den Informationen in einem Paket basiert, das vom Client empfangen wurde.</span><span class="sxs-lookup"><span data-stu-id="e677d-165">The [**PxeDhcpInitialize**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpinitialize) function initializes a response packet as a DHCP reply packet that is based on the information in a packet received from the client.</span></span> <span data-ttu-id="e677d-166">Die [*pxeproviderinitialize*](pxeproviderinitialize.md) -Funktion nimmt die Adresse eines gültigen DHCP-Pakets an, das vom Client im [*pxeproviderrecvrequest*](pxeproviderrecvrequest.md) -Rückruf empfangen wurde.</span><span class="sxs-lookup"><span data-stu-id="e677d-166">The [*PxeProviderInitialize*](pxeproviderinitialize.md) function takes the address of a valid DHCP packet received from the client in the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback.</span></span> <span data-ttu-id="e677d-167">Die **pxedhcpinitialize** -Funktion nimmt einen Zeiger auf ein Antwortpaket an, das der [**pxepacketallocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) -Funktion zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="e677d-167">The **PxeDhcpInitialize** function takes a pointer to a reply packet allocated with the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) function.</span></span>
-   <span data-ttu-id="e677d-168">Die [**pxedhcpgetoptionvalue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetoptionvalue) -Funktion Ruft einen Optionswert aus einem DHCP-Paket ab.</span><span class="sxs-lookup"><span data-stu-id="e677d-168">The [**PxeDhcpGetOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetoptionvalue) function retrieves an option value from a DHCP packet.</span></span> <span data-ttu-id="e677d-169">Die [**pxedhcpgetvendoroptionvalue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetvendoroptionvalue) -Funktion Ruft einen Optionswert aus dem herstellerspezifischen Informationsfeld (43) eines DHCP-Pakets ab.</span><span class="sxs-lookup"><span data-stu-id="e677d-169">The [**PxeDhcpGetVendorOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetvendoroptionvalue) function retrieves an option value from the Vendor Specific Information field (43) of a DHCP packet.</span></span>
-   <span data-ttu-id="e677d-170">Der Anbieter kann dann das Antwortpaket mit Informationen auffüllen und die [**pxesendreply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) -Funktion verwenden, um das Antwortpaket an den Client zu senden.</span><span class="sxs-lookup"><span data-stu-id="e677d-170">The provider can then populate the reply packet with information and use the [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) function to send the reply packet to the client.</span></span> <span data-ttu-id="e677d-171">Die [**pxedhcpappdoption**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpappendoption) -Funktion fügt eine DHCP-Option an das Antwortpaket an.</span><span class="sxs-lookup"><span data-stu-id="e677d-171">The [**PxeDhcpAppendOption**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpappendoption) function appends a DHCP option to the reply packet.</span></span>
-   <span data-ttu-id="e677d-172">Ein Anbieter, der auf Client Anforderungen durch das Senden eines Pakets antwortet, muss das Antwortpaket mithilfe der [**pxepacketallocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) -Funktion zuordnen.</span><span class="sxs-lookup"><span data-stu-id="e677d-172">A provider that replies to client requests by sending a packet must allocate the response packet using the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) function.</span></span> <span data-ttu-id="e677d-173">Der Anbieter kann dann das Antwortpaket mit Informationen auffüllen und die [**pxesendreply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) -Funktion verwenden, um das Antwortpaket an den Client zu senden.</span><span class="sxs-lookup"><span data-stu-id="e677d-173">The provider can then populate the reply packet with information and use the [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) function to send the reply packet to the client.</span></span>
-   <span data-ttu-id="e677d-174">Wenn der zugeordnete Arbeitsspeicher nicht mehr benötigt wird, sollte der Anbieter ihn mithilfe der [**pxepacketfree**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketfree) -Funktion freigeben.</span><span class="sxs-lookup"><span data-stu-id="e677d-174">When the allocated memory is no longer needed, the provider should release it using the [**PxePacketFree**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketfree) function.</span></span>

## <a name="enumerate-registered-providers"></a><span data-ttu-id="e677d-175">Registrierte Anbieter aufzählen</span><span class="sxs-lookup"><span data-stu-id="e677d-175">Enumerate Registered Providers</span></span>

-   <span data-ttu-id="e677d-176">Verwenden Sie die-API zum Schreiben von Anbietern, die andere registrierte Anbieter in der Liste aufzählen und überprüfen.</span><span class="sxs-lookup"><span data-stu-id="e677d-176">Use the API to write providers that enumerate and check other registered providers in the list.</span></span>
-   <span data-ttu-id="e677d-177">Die [**pxegetserverinfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxegetserverinfo) -Funktion gibt Informationen über den PXE-Server zurück.</span><span class="sxs-lookup"><span data-stu-id="e677d-177">The [**PxeGetServerInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxegetserverinfo) function returns information about the PXE server.</span></span> <span data-ttu-id="e677d-178">Die **pxegetserverinfo** -Funktion gibt einen **booleschen** Wert zurück, der angibt, ob die Ablauf Verfolgung für den Server aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="e677d-178">The **PxeGetServerInfo** function returns a **BOOL** that indicates whether tracing is enabled for the server.</span></span> <span data-ttu-id="e677d-179">**True** gibt an, dass die Ablauf Verfolgung aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="e677d-179">**TRUE** indicates that tracing is enabled.</span></span>
-   <span data-ttu-id="e677d-180">Die [**pxeproviderenumfirst**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumfirst) -Funktion startet eine enumerationof-Anbieter in der Liste registrierter Anbieter.</span><span class="sxs-lookup"><span data-stu-id="e677d-180">The [**PxeProviderEnumFirst**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumfirst) function starts an enumerationof providers in the registered provider list.</span></span> <span data-ttu-id="e677d-181">Die **pxeproviderenumfirst** -Funktion startet die-Enumeration und gibt die Adresse des Handles zurück, das beim Aufrufen der [**pxeproviderenumnext**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumnext) -Funktion verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="e677d-181">The **PxeProviderEnumFirst** function starts the enumeration and returns the address of the handle that should be used when calling the [**PxeProviderEnumNext**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumnext) function.</span></span> <span data-ttu-id="e677d-182">Die **pxeproviderenumnext** -Funktion gibt eine [**PXE- \_ Anbieter**](/windows/win32/api/wdspxe/ns-wdspxe-pxe_provider) Struktur zurück, die die Informationen zum Anbieter enthält.</span><span class="sxs-lookup"><span data-stu-id="e677d-182">The **PxeProviderEnumNext** function returns a [**PXE\_PROVIDER**](/windows/win32/api/wdspxe/ns-wdspxe-pxe_provider) structure containing the information about the provider.</span></span> <span data-ttu-id="e677d-183">Die [**pxeproviderfreone FO**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderfreeinfo) -Funktion gibt den Arbeitsspeicher frei, der der **PXE- \_ Anbieter** Struktur von der **pxeproviderenumnext** -Funktion zugeordnet wurde.</span><span class="sxs-lookup"><span data-stu-id="e677d-183">The [**PxeProviderFreeInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderfreeinfo) function frees the memory that has been allocated for the **PXE\_PROVIDER** structure by the **PxeProviderEnumNext** function.</span></span> <span data-ttu-id="e677d-184">Die [**pxeproviderenumclose**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumclose) -Funktion schließt die Enumeration von Anbietern in der Liste der registrierten Anbieter.</span><span class="sxs-lookup"><span data-stu-id="e677d-184">The [**PxeProviderEnumClose**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumclose) function closes the enumeration of providers in the registered providers list.</span></span>

## <a name="handle-service-control-codes"></a><span data-ttu-id="e677d-185">Verarbeiten von Dienst Steuerungs Codes</span><span class="sxs-lookup"><span data-stu-id="e677d-185">Handle Service Control Codes</span></span>

-   <span data-ttu-id="e677d-186">Wenn eine Dienst Steuerungs Meldung empfangen wird, ruft WDS den [*pxeproviderservicecontrol*](pxeproviderservicecontrol.md) -Rückruf auf.</span><span class="sxs-lookup"><span data-stu-id="e677d-186">When a service control message is received, WDS calls the [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback.</span></span>
-   <span data-ttu-id="e677d-187">Der Anbieter kann eine [*pxeproviderservicecontrol*](pxeproviderservicecontrol.md) -Rückruffunktion definieren, um Dienst Steuerungs Meldungen zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="e677d-187">The provider can define a [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback function to handle service control messages.</span></span>
-   <span data-ttu-id="e677d-188">Registrieren Sie den [*pxeproviderservicecontrol*](pxeproviderservicecontrol.md) -Rückruf durch Aufrufen der [**pxeregistercallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) -Funktion mit dem **PXE- \_ Rückruf \_ Dienst- \_ Steuer** Element während der Verarbeitung des [*pxeproviderinitialize*](pxeproviderinitialize.md) -Rückrufs.</span><span class="sxs-lookup"><span data-stu-id="e677d-188">Register the [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_SERVICE\_CONTROL** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span>

## <a name="add-trace-entries-to-pxe-log"></a><span data-ttu-id="e677d-189">Ablauf Verfolgungs Einträge zum PXE-Protokoll hinzufügen</span><span class="sxs-lookup"><span data-stu-id="e677d-189">Add Trace Entries to PXE Log</span></span>

-   <span data-ttu-id="e677d-190">Die [**pxetrace**](/windows/win32/api/WdsPxe/nf-wdspxe-pxetrace) -Funktion fügt dem PXE-Protokoll einen Ablauf Verfolgungs Eintrag hinzu.</span><span class="sxs-lookup"><span data-stu-id="e677d-190">The [**PxeTrace**](/windows/win32/api/WdsPxe/nf-wdspxe-pxetrace) function adds a trace entry to the PXE log.</span></span> <span data-ttu-id="e677d-191">Wdspxe bietet eine Ablauf Verfolgung, die Administratoren bei der Problembehandlung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e677d-191">WDSPXE provides tracing to help administrators in troubleshooting.</span></span> <span data-ttu-id="e677d-192">Anbieter können Ablauf Verfolgungs Einträge verschiedener Schweregrade protokollieren.</span><span class="sxs-lookup"><span data-stu-id="e677d-192">Providers can log trace entries of different severity levels.</span></span> <span data-ttu-id="e677d-193">Die Administratoren können wdspxe so konfigurieren, dass nur Einträge für bestimmte Schweregrade protokolliert werden.</span><span class="sxs-lookup"><span data-stu-id="e677d-193">The administrators can configure WDSPXE to only log entries for certain severity levels.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e677d-194">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="e677d-194">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e677d-195">Informationen zur API für die Windows-Bereitstellungs Dienste</span><span class="sxs-lookup"><span data-stu-id="e677d-195">About the Windows Deployment Services API</span></span>](about-the-windows-deployment-services-api.md)
</dt> <dt>

[<span data-ttu-id="e677d-196">Verwenden der Client-API der Windows-Bereitstellungsdienste</span><span class="sxs-lookup"><span data-stu-id="e677d-196">Using the Windows Deployment Services Client API</span></span>](using-the-windows-deployment-services-client-api.md)
</dt> </dl>

 

 




