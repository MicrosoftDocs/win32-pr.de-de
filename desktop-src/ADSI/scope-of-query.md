---
title: Abfrage Bereich
description: Der Gültigkeitsbereich einer Abfrage wird durch das Objekt bestimmt, an das die Bindung erfolgen soll.
ms.assetid: 7ece8599-8a4b-45a1-95f4-a4180052f245
ms.tgt_platform: multiple
keywords:
- Bereich der Abfrage-ADSI
- Abfragen von ADSI, Bereich
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dac51fc261cb418db0018acd996c248766896a25
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "103707386"
---
# <a name="scope-of-query"></a><span data-ttu-id="ecb18-105">Abfrage Bereich</span><span class="sxs-lookup"><span data-stu-id="ecb18-105">Scope of Query</span></span>

<span data-ttu-id="ecb18-106">Der Gültigkeitsbereich einer Abfrage wird durch das Objekt bestimmt, an das die Bindung erfolgen soll.</span><span class="sxs-lookup"><span data-stu-id="ecb18-106">The scope of a query is determined by the object to which you bind.</span></span> <span data-ttu-id="ecb18-107">Wenn Sie nicht sicher sind, wo sich das Objekt im Unternehmen befindet, müssen Sie so weit wie möglich eine Suche durchführen.</span><span class="sxs-lookup"><span data-stu-id="ecb18-107">If you are unsure where the object is located within the enterprise then you will need to do as wide a search as possible.</span></span> <span data-ttu-id="ecb18-108">Wenn Sie jedoch wissen, dass das Objekt in einer bestimmten Domäne enthalten ist, z. b. in der Domäne, mit der der Benutzer verbunden ist, oder in einer bestimmten Gruppe (z. b. in der Gruppe "Manager"), sollten Sie den Suchbereich so festlegen, dass er die Umstände widerspiegelt.</span><span class="sxs-lookup"><span data-stu-id="ecb18-108">However, if you know that the object will be contained within a specific domain, such as the domain that the user is connected to, or within a specific group, such as the Managers group, then you should set the scope of the search to reflect the circumstance.</span></span> <span data-ttu-id="ecb18-109">Um die optimale Leistung zu erzielen, sollten Sie versuchen, den Bereich als Ziel für die kleinste Anzahl möglicher Objekte zu suchen.</span><span class="sxs-lookup"><span data-stu-id="ecb18-109">For the best performance, you should try to target the scope to search the smallest number of objects possible.</span></span>

<span data-ttu-id="ecb18-110">Wenn Sie nicht sicher sind, wo sich ein Objekt im Unternehmen befinden wird, können Sie eine Bindung an den globalen Katalog Dienst herstellen.</span><span class="sxs-lookup"><span data-stu-id="ecb18-110">When you are not sure where an object will be located in the enterprise, you can bind to the global catalog service.</span></span> <span data-ttu-id="ecb18-111">Der globale Katalog Dienst enthält eine Liste aller Objekte im Verzeichnis und eine kleine Teilmenge der Attribute jedes Objekts.</span><span class="sxs-lookup"><span data-stu-id="ecb18-111">The global catalog service contains a list of every object in the directory and a small subset of each object's attributes.</span></span> <span data-ttu-id="ecb18-112">Nachdem Sie das Objekt im globalen Katalog gefunden haben, können Sie seinen Distinguished Name aus dem globalen Katalog abrufen und zum Binden an das-Objekt verwenden, um andere Vorgänge auszuführen.</span><span class="sxs-lookup"><span data-stu-id="ecb18-112">After you find the object in the global catalog, you can retrieve its distinguished name from the global catalog and use it to bind to the object to perform other operations.</span></span>

<span data-ttu-id="ecb18-113">Nachdem Sie entschieden haben, an welches Objekt die Bindung erfolgen soll, können Sie die Abfrage auf einen der folgenden Bereiche beschränken: eine Basis Abfrage, eine Abfrage auf einer einzelnen Ebene oder eine Unterstruktur Suche, wie in der folgenden Abbildung dargestellt.</span><span class="sxs-lookup"><span data-stu-id="ecb18-113">After you decide which object to bind to, you can further restrict the query to one of the following scopes: a base query, a one-level query, or a subtree search, as shown in the following illustration.</span></span>

![Objekte im Stammverzeichnis einer Suche nach einer Basis-, einer-oder Unterstruktur Suche](images/netds6.png)

## <a name="base"></a><span data-ttu-id="ecb18-115">Basis</span><span class="sxs-lookup"><span data-stu-id="ecb18-115">Base</span></span>

<span data-ttu-id="ecb18-116">Eine Basis Abfrage beschränkt die Suche auf das Basisobjekt.</span><span class="sxs-lookup"><span data-stu-id="ecb18-116">A base query limits the search to only the base object.</span></span> <span data-ttu-id="ecb18-117">Die maximale Anzahl von zurückgegebenen Objekten ist immer 1.</span><span class="sxs-lookup"><span data-stu-id="ecb18-117">The maximum number of objects returned is always one.</span></span> <span data-ttu-id="ecb18-118">Diese Suche kann verwendet werden, um zu überprüfen, ob ein Objekt vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="ecb18-118">This search can be used to verify the existence of an object.</span></span> <span data-ttu-id="ecb18-119">Wenn Sie z. b. über den Distinguished Name eines Objekts verfügen und das vorhanden sein des Objekts basierend auf dem Pfad überprüfen müssen, können Sie eine Suche auf einer einzelnen Ebene verwenden.</span><span class="sxs-lookup"><span data-stu-id="ecb18-119">For example, if you have an object's distinguished name and you must verify the object's existence based on the path, you can use a one-level search.</span></span> <span data-ttu-id="ecb18-120">Wenn die Suche fehlschlägt, können Sie davon ausgehen, dass das Objekt möglicherweise umbenannt oder an einen anderen Speicherort verschoben wurde oder dass ihnen falsche Daten über das Objekt übergeben wurden.</span><span class="sxs-lookup"><span data-stu-id="ecb18-120">If the search fails, you can assume that the object may have been renamed or moved to a different location, or that you were given incorrect data about the object.</span></span> <span data-ttu-id="ecb18-121">Beachten Sie, dass Sie die GUID anstelle des Distinguished Name speichern sollten, wenn Sie ein Objekt überprüfen möchten.</span><span class="sxs-lookup"><span data-stu-id="ecb18-121">Be aware that you should store the GUID instead of the distinguished name if you want to revisit an object.</span></span> <span data-ttu-id="ecb18-122">Dadurch kann das Objekt in der Verzeichnishierarchie umbenannt oder verschoben werden, ohne den beibehaltenen Link zu unterbrechen.</span><span class="sxs-lookup"><span data-stu-id="ecb18-122">This allows the object to be renamed or moved in the directory hierarchy without breaking the persisted link.</span></span>

## <a name="one-level"></a><span data-ttu-id="ecb18-123">Eine Ebene</span><span class="sxs-lookup"><span data-stu-id="ecb18-123">One Level</span></span>

<span data-ttu-id="ecb18-124">Eine einstufige Suche ist auf die unmittelbaren untergeordneten Elemente eines Basis Objekts beschränkt, schließt jedoch das Basisobjekt selbst aus.</span><span class="sxs-lookup"><span data-stu-id="ecb18-124">A one-level search is restricted to the immediate children of a base object, but excludes the base object itself.</span></span> <span data-ttu-id="ecb18-125">Mit dieser Einstellung kann eine gezielte Suche nach unmittelbar untergeordneten Objekten eines übergeordneten Objekts durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ecb18-125">This setting can perform a targeted search for immediate child objects of a parent object.</span></span> <span data-ttu-id="ecb18-126">Wenn Sie z. b. über ein übergeordnetes Objekt mit dem Namen P1 verfügen und seine unmittelbaren untergeordneten Elemente: C1, C2, C3 sind, sollten Sie bei der Auswertung der Kriterien in einer einstufigen Suche, C1, C2 und C3 enthalten sein, aber P1 wäre nicht Teil der Suche.</span><span class="sxs-lookup"><span data-stu-id="ecb18-126">For example, if you have a parent object called P1, and its immediate children are: C1, C2, C3, then in a one-level search, C1, C2, and C3 should be included when evaluating the criteria, but P1 would not be part of the search.</span></span> <span data-ttu-id="ecb18-127">Eine einstufige Suche kann verwendet werden, um alle untergeordneten Elemente eines Objekts aufzulisten.</span><span class="sxs-lookup"><span data-stu-id="ecb18-127">A one-level search can be used to enumerate all children of an object.</span></span> <span data-ttu-id="ecb18-128">Tatsächlich übersetzt die [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) -Enumeration bei manchen ADSI-Anbietern in eine Suche auf einer Ebene.</span><span class="sxs-lookup"><span data-stu-id="ecb18-128">In fact, in some ADSI providers, [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) enumeration translates to a one-level search.</span></span>

## <a name="subtree"></a><span data-ttu-id="ecb18-129">Unterstruktur</span><span class="sxs-lookup"><span data-stu-id="ecb18-129">Subtree</span></span>

<span data-ttu-id="ecb18-130">Eine Unterstruktur Suche, auch als Deep Search bezeichnet, umfasst alle Objekte unterhalb des Basis Objekts, ausgenommen das Basisobjekt selbst.</span><span class="sxs-lookup"><span data-stu-id="ecb18-130">A subtree search, also known as a deep search, includes all the objects beneath the base object, excluding the base object itself.</span></span> <span data-ttu-id="ecb18-131">Diese Suche kann Verweise auf andere Server generieren.</span><span class="sxs-lookup"><span data-stu-id="ecb18-131">This search may generate referrals to other servers.</span></span> <span data-ttu-id="ecb18-132">Diese Suche hat den größten Bereich und gibt möglicherweise ein großes Resultset zurück.</span><span class="sxs-lookup"><span data-stu-id="ecb18-132">This search has the greatest scope and may return a large result set.</span></span> <span data-ttu-id="ecb18-133">Suchen Sie nach Möglichkeit nach mindestens einem indizierten Attribut, und legen Sie die Einstellungen für den Verweis fest (Weitere Informationen finden Sie unter [Leistung und Verarbeitung großer Resultsets](performance-and-handling-large-result-sets.md)), um die Suchanforderungen zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="ecb18-133">If possible, search on at least one indexed attribute and set the referrals settings (for more information, see [Performance and Handling Large Result Sets](performance-and-handling-large-result-sets.md)) to match your search requirements.</span></span> <span data-ttu-id="ecb18-134">Außerdem wird empfohlen, dass die Ergebnisse einer Unterstruktur Suche asynchron und per Pager ausgeführt werden, um den Server Mehraufwand und die Effektivität des Netzwerks zu verringern.</span><span class="sxs-lookup"><span data-stu-id="ecb18-134">It is also suggested that the results of a subtree search be performed asynchronously and paged to reduce the server overhead and network effectiveness.</span></span> <span data-ttu-id="ecb18-135">Eine Unterstruktur Suche wird normalerweise verwendet, um Objekte für einen bestimmten Bereich zu durchsuchen.</span><span class="sxs-lookup"><span data-stu-id="ecb18-135">A subtree search is normally used to search objects for a given scope.</span></span> <span data-ttu-id="ecb18-136">Suchen Sie beispielsweise nach allen Benutzern mit Konten, die innerhalb von 30 Tagen oder weniger abläuft.</span><span class="sxs-lookup"><span data-stu-id="ecb18-136">For example, search for all users with accounts that will expire in 30 days or less.</span></span>

 

 




