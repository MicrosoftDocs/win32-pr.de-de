---
title: Festlegen und Ändern von Benutzer Kennwörtern mit dem LDAP-Anbieter
description: Verwenden Sie die IADsUser. SetPassword-Methode, um ein Benutzer Kennwort festzulegen.
ms.assetid: da3d9861-dd04-406c-9356-db1e4ff0eebc
ms.tgt_platform: multiple
keywords:
- LDAP-Anbieter-ADSI, Benutzerobjekt, Festlegen von Kenn Wörtern
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5488146de271ac1108a904cd85163fad9d7dd205
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104316443"
---
# <a name="setting-and-changing-user-passwords-with-the-ldap-provider"></a><span data-ttu-id="fbec9-104">Festlegen und Ändern von Benutzer Kennwörtern mit dem LDAP-Anbieter</span><span class="sxs-lookup"><span data-stu-id="fbec9-104">Setting and Changing User Passwords with the LDAP Provider</span></span>

<span data-ttu-id="fbec9-105">Verwenden Sie die [**IADsUser. SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) -Methode, um ein Benutzer Kennwort festzulegen.</span><span class="sxs-lookup"><span data-stu-id="fbec9-105">To a set a user password, use the [**IADsUser.SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) method.</span></span>

<span data-ttu-id="fbec9-106">Der LDAP-Anbieter für Active Directory verwendet einen von drei Prozessen, um das Kennwort festzulegen (LDAP-Verzeichnisse von Drittanbietern, z. b. iPlanet verwenden diesen Prozess zur Kenn Wort Authentifizierung nicht).</span><span class="sxs-lookup"><span data-stu-id="fbec9-106">The LDAP provider for Active Directory uses one of three processes to set the password (third-party LDAP directories such as iPlanet do not use this password authentication process).</span></span> <span data-ttu-id="fbec9-107">Die Methode kann je nach Netzwerkkonfiguration variieren.</span><span class="sxs-lookup"><span data-stu-id="fbec9-107">The method may vary according to the network configuration.</span></span> <span data-ttu-id="fbec9-108">Die Methoden zum Festlegen des Kennworts treten in der folgenden Reihenfolge auf:</span><span class="sxs-lookup"><span data-stu-id="fbec9-108">The set password methods occur in the following order:</span></span>

-   <span data-ttu-id="fbec9-109">Zuerst versucht der LDAP-Anbieter, LDAP über eine 128-Bit-SSL-Verbindung zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="fbec9-109">First, the LDAP provider attempts to use LDAP over a 128-bit SSL connection.</span></span> <span data-ttu-id="fbec9-110">Damit LDAP-SSL erfolgreich ausgeführt werden kann, muss auf dem LDAP-Server das geeignete Server Authentifizierungszertifikat installiert sein, und die Clients, auf denen der ADSI-Code ausgeführt wird, müssen der Zertifizierungsstelle vertrauen, die diese Zertifikate</span><span class="sxs-lookup"><span data-stu-id="fbec9-110">For LDAP SSL to operate successfully, the LDAP server must have the appropriate server authentication certificate installed and the clients running the ADSI code must trust the authority that issued those certificates.</span></span> <span data-ttu-id="fbec9-111">Sowohl der Server als auch der Client müssen die 128-Bit-Verschlüsselung unterstützen.</span><span class="sxs-lookup"><span data-stu-id="fbec9-111">Both the server and the client must support 128-bit encryption.</span></span>
-   <span data-ttu-id="fbec9-112">Zweitens: Wenn die SSL-Verbindung nicht erfolgreich ist, versucht der LDAP-Anbieter, Kerberos zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="fbec9-112">Second, if the SSL connection is unsuccessful, the LDAP provider attempts to use Kerberos.</span></span> <span data-ttu-id="fbec9-113">Unter Windows 2000 unterstützt Kerberos möglicherweise keine Gesamtstruktur übergreifende Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="fbec9-113">On Windows 2000, Kerberos may not support cross-forest authentication.</span></span> <span data-ttu-id="fbec9-114">Spätere Erweiterungen für Kerberos unterstützen die Gesamtstruktur übergreifende Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="fbec9-114">Later enhancements to Kerberos support cross-forest authentication.</span></span>
-   <span data-ttu-id="fbec9-115">Drittens, wenn Kerberos nicht erfolgreich ist, versucht der LDAP-Anbieter, einen [**nettusersetinfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) -API-aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="fbec9-115">Third, if Kerberos is unsuccessful, the LDAP provider attempts a [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) API call.</span></span> <span data-ttu-id="fbec9-116">In früheren Versionen hieß ADSI " **netusersetinfo** " im Sicherheitskontext, in dem der Thread ausgeführt wurde, und nicht der Sicherheitskontext, der im Aufruf von [**iadsopendsobject. opendsobject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) oder [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject)angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="fbec9-116">In previous releases, ADSI called **NetUserSetInfo** in the security context in which the thread was running, and not the security context specified in the call to [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span></span> <span data-ttu-id="fbec9-117">In späteren Versionen wurde dies geändert, sodass der ADSI LDAP-Anbieter die Identität des im **opendsobject** -Aufruf angegebenen Benutzers annimmt, wenn er **netusersetinfo** aufruft.</span><span class="sxs-lookup"><span data-stu-id="fbec9-117">In later releases, this was changed so that the ADSI LDAP provider would impersonate the user specified in the **OpenDSObject** call when it calls **NetUserSetInfo**.</span></span>

<span data-ttu-id="fbec9-118">Verwenden Sie die [**IADsUser. ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) -Methode, um ein Benutzer Kennwort zu ändern.</span><span class="sxs-lookup"><span data-stu-id="fbec9-118">To change a user password, use the [**IADsUser.ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) method.</span></span> <span data-ttu-id="fbec9-119">Wie bei [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword)kann diese Methode mehrere Prozesse verwenden, um das Kennwort zu ändern.</span><span class="sxs-lookup"><span data-stu-id="fbec9-119">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), this method can use multiple processes to change the password.</span></span> <span data-ttu-id="fbec9-120">Die Methode zum Ändern von Kenn Wörtern erfolgt in der folgenden Reihenfolge:</span><span class="sxs-lookup"><span data-stu-id="fbec9-120">The change password methods occur in the following order:</span></span>

-   <span data-ttu-id="fbec9-121">Zuerst versucht der LDAP-Anbieter, LDAP über eine 128-Bit-SSL-Verbindung zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="fbec9-121">First, the LDAP provider tries to use LDAP over a 128-bit SSL connection.</span></span>
-   <span data-ttu-id="fbec9-122">Zweitens: Wenn die 128-SSL-Verbindung nicht hergestellt werden kann, versucht der LDAP-Anbieter, einen [**nettuserchangepassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) -API-Befehl zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="fbec9-122">Second, if the 128-SSL connection is unsuccessful, the LDAP provider tries a [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) API call.</span></span> <span data-ttu-id="fbec9-123">Wie bei [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword)nimmt der ADSI LDAP-Anbieter in früheren Versionen die Identität der Benutzer Anmelde Informationen an, die mithilfe der [**iadsopendsobject. opendsobject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) -Methode oder der [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) -Funktion weitergegeben wurden.</span><span class="sxs-lookup"><span data-stu-id="fbec9-123">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), in earlier releases, the ADSI LDAP provider impersonates the user credentials passed using the [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) method or the [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) function.</span></span>

 

 