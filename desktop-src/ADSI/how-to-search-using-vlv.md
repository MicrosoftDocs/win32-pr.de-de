---
title: Suchen mit VLV
description: Active Directory unterstützt VLV-Suchen (Virtual List View). Diese Art von Suche ist speziell für große Resultsets konzipiert und ermöglicht es einer Anwendung, eine Teilmenge von Tausenden von Einträgen anzuzeigen, ohne jeden Eintrag tatsächlich abrufen zu müssen.
ms.assetid: fea04190-0846-4b62-99f4-7d8fb35fd510
ms.tgt_platform: multiple
keywords:
- Suchen mit VLV
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f4a24250c8e54ccb7917f86b193152c62810b93
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "103949119"
---
# <a name="how-to-search-using-vlv"></a><span data-ttu-id="5a989-105">Suchen mit VLV</span><span class="sxs-lookup"><span data-stu-id="5a989-105">How to Search Using VLV</span></span>

<span data-ttu-id="5a989-106">Active Directory unterstützt VLV-Suchen (Virtual List View).</span><span class="sxs-lookup"><span data-stu-id="5a989-106">Active Directory supports virtual list view (VLV) searches.</span></span> <span data-ttu-id="5a989-107">Diese Art von Suche ist speziell für große Resultsets konzipiert und ermöglicht es einer Anwendung, eine Teilmenge von Tausenden von Einträgen anzuzeigen, ohne jeden Eintrag tatsächlich abrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="5a989-107">This style of search is specifically designed for large result sets and enables an application to display a subset of thousands of entries without actually having to retrieve every entry.</span></span>

<span data-ttu-id="5a989-108">Es gibt zwei unterschiedliche Möglichkeiten, wie eine VLV-Suche verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="5a989-108">There are two distinct ways that a VLV search can be used.</span></span> <span data-ttu-id="5a989-109">Der erste besteht darin, die Attribute für bestimmte Einträge auf Grundlage eines numerischen Offsets abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-109">The first is to retrieve the attributes for particular entries based on a numeric offset.</span></span> <span data-ttu-id="5a989-110">Diese Methode ist nützlich, wenn Suchergebnisse als Reaktion auf einen scrollvorgang abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-110">This method is useful when retrieving search results in response to a scrolling operation.</span></span>

<span data-ttu-id="5a989-111">Die zweite Möglichkeit, VLV-Suchen zu verwenden, besteht darin, nach einem Teil oder allen Textattributen zu suchen und nur die Ergebnisse der Suche anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="5a989-111">The second way to use VLV searches is to search for part or all of a textual attribute and only display the results of the search.</span></span> <span data-ttu-id="5a989-112">Ein Beispiel für die Verwendung dieses Adressbuchs ist.</span><span class="sxs-lookup"><span data-stu-id="5a989-112">An example usage of this is an address book.</span></span> <span data-ttu-id="5a989-113">Wenn der Benutzer ein "s" eingibt, kann die Anwendung eine VLV-Suche verwenden, um nach Einträgen zu suchen, die einen gemeinsamen Namen aufweisen, der mit "s" beginnt.</span><span class="sxs-lookup"><span data-stu-id="5a989-113">If the user types an "s", then the application can use a VLV search to search for entries that have a common-name that begins with "s".</span></span> <span data-ttu-id="5a989-114">Wenn der Benutzer dann dem "s" ein "m" hinzufügt, kann die Anwendung eine andere VLV-Suche verwenden, um nach Einträgen zu suchen, die einen gemeinsamen Namen aufweisen, der mit "SM" beginnt.</span><span class="sxs-lookup"><span data-stu-id="5a989-114">If the user then adds an "m" to the "s", the application can use another VLV search to search for entries that have a common-name that begins with "sm".</span></span>

<span data-ttu-id="5a989-115">Um eine VLV-Suche auszuführen, weisen Sie ADSI an, das VLV-Steuerelement zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="5a989-115">To perform a VLV search, instruct ADSI to use the VLV control.</span></span> <span data-ttu-id="5a989-116">Rufen Sie dazu die [**IDirectorySearch:: setsearchpreference**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-setsearchpreference) -Methode mit einer Suchoption " **ADS \_ searchpref \_ VLV** " mit einem **adstype \_ Prov- \_ spezifischen** Wert auf.</span><span class="sxs-lookup"><span data-stu-id="5a989-116">To do this, call the [**IDirectorySearch::SetSearchPreference**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-setsearchpreference) method with an **ADS\_SEARCHPREF\_VLV** search option with an **ADSTYPE\_PROV\_SPECIFIC** value.</span></span> <span data-ttu-id="5a989-117">Der **spezifische adstype \_ Prov \_** -Wert ist ein Zeiger auf eine [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur, die Daten über die Suche enthält.</span><span class="sxs-lookup"><span data-stu-id="5a989-117">The **ADSTYPE\_PROV\_SPECIFIC** value is a pointer to an [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure that contains data about the search.</span></span> <span data-ttu-id="5a989-118">Die [**getvlvitemcount**](example-code-for-using-a-vlv-search.md) -Beispiel Funktion zeigt, wie beide Sucheinstellungen festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-118">The [**GetVLVItemCount**](example-code-for-using-a-vlv-search.md) example function shows how to set both of these search preferences.</span></span>

<span data-ttu-id="5a989-119">Bei allen VLV-Such Vorgängen muss die serverseitige Ergebnis Sortierung verwendet werden. Dies erfolgt durch Festlegen der Sortierung " **ADS \_ searchpref" \_ \_ für** die Suche.</span><span class="sxs-lookup"><span data-stu-id="5a989-119">All VLV searches must use server-side result sorting, which is performed by setting the **ADS\_SEARCHPREF\_SORT\_ON** search preference.</span></span> <span data-ttu-id="5a989-120">Weitere Informationen zur Sortierung **\_ \_ \_ von ADS searchpref** nach Such Vorgängen finden Sie unter [Sortieren der Suchergebnisse mit idirector ysearch](sorting-the-search-results-with-idirectorysearch.md).</span><span class="sxs-lookup"><span data-stu-id="5a989-120">For more information about the **ADS\_SEARCHPREF\_SORT\_ON** search preference, see [Sorting the Search Results with IDirectorySearch](sorting-the-search-results-with-idirectorysearch.md).</span></span>

<span data-ttu-id="5a989-121">Wenn eine VLV-Suche durchgeführt wird, wird eine bestimmte Menge von Metadaten über die Suche in einer Spalte zurückgegeben, die durch Aufrufen von [**idirector ysearch:: GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) mit dem Antwort Bezeichner **ADS \_ VLV \_** abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="5a989-121">When a VLV search is performed, a certain amount of metadata about the search is returned in a column that is retrieved by calling [**IDirectorySearch::GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) with the **ADS\_VLV\_RESPONSE** identifier.</span></span> <span data-ttu-id="5a989-122">Diese Daten sind in einer [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur enthalten.</span><span class="sxs-lookup"><span data-stu-id="5a989-122">This data is contained in an [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure.</span></span> <span data-ttu-id="5a989-123">Besonders wichtig sind die Member **dwcontentcount** und **lpcontextid** .</span><span class="sxs-lookup"><span data-stu-id="5a989-123">Of particular importance are the **dwContentCount** and **lpContextID** members.</span></span> <span data-ttu-id="5a989-124">Das **dwcontentcount** -Element enthält die Anzahl der Ergebnisse, die den VLV-Suchkriterien entsprechen.</span><span class="sxs-lookup"><span data-stu-id="5a989-124">The **dwContentCount** member will contain the number of results that meet the VLV search criteria.</span></span> <span data-ttu-id="5a989-125">Dieser Wert kann als Schätzung der Gesamtzahl der Elemente verwendet werden, die für eine Suche dieses Typs zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-125">This value can be used as an estimate of the total number of items that would be returned for a search of that type.</span></span> <span data-ttu-id="5a989-126">Der **lpcontextid** -Member enthält einen Server definierten Wert, der an die nächste Suche übergeben werden kann, um die Suche zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="5a989-126">The **lpContextID** member contains a server-defined value that can be passed to the next search to identify the search.</span></span> <span data-ttu-id="5a989-127">Die Verwendung von **lpcontextid** kann die Suchleistung verbessern.</span><span class="sxs-lookup"><span data-stu-id="5a989-127">Using the **lpContextID** can enhance the search performance.</span></span> <span data-ttu-id="5a989-128">Beachten Sie, dass **lpcontextid** ein Server definierter Wert ist und seine Länge im **dwcontextidlength** -Element enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="5a989-128">Be aware that the **lpContextID** is a server-defined value and its length is contained in the **dwContextIDLength** member.</span></span> <span data-ttu-id="5a989-129">Dieser Puffer wird freigegeben, wenn die [**IDirectorySearch:: freecolumschlag**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-freecolumn) -Methode aufgerufen wird. Daher muss der Aufrufer einen Puffer der entsprechenden Größe zuordnen und den Inhalt des Puffers zwischen den Such Vorgängen kopieren und speichern.</span><span class="sxs-lookup"><span data-stu-id="5a989-129">This buffer is freed when the [**IDirectorySearch::FreeColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-freecolumn) method is called, so the caller must allocate a buffer of the appropriate size and copy and save the contents of the buffer between searches.</span></span>

<span data-ttu-id="5a989-130">Weitere Informationen zum LDAP-VLV-Steuerelement finden Sie unter [Suchen mit dem LDAP-VLV-Steuer](/previous-versions/windows/desktop/ldap/searching-with-the-ldap-vlv-control)Element.</span><span class="sxs-lookup"><span data-stu-id="5a989-130">For more information about the LDAP VLV control, see [Searching with the LDAP VLV Control](/previous-versions/windows/desktop/ldap/searching-with-the-ldap-vlv-control).</span></span>

<span data-ttu-id="5a989-131">Weitere Informationen finden Sie unter</span><span class="sxs-lookup"><span data-stu-id="5a989-131">For more information, see:</span></span>

-   <span data-ttu-id="5a989-132">Abrufen der Anzahl von Elementen</span><span class="sxs-lookup"><span data-stu-id="5a989-132">Obtaining the Number of Items</span></span>
-   <span data-ttu-id="5a989-133">Suchen nach Offset</span><span class="sxs-lookup"><span data-stu-id="5a989-133">Searching by Offset</span></span>
-   <span data-ttu-id="5a989-134">Suchen nach Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="5a989-134">Searching by String</span></span>
-   [<span data-ttu-id="5a989-135">Beispiel Code für die Verwendung einer VLV-Suche</span><span class="sxs-lookup"><span data-stu-id="5a989-135">Example Code for Using a VLV Search</span></span>](example-code-for-using-a-vlv-search.md)

## <a name="obtaining-the-number-of-items"></a><span data-ttu-id="5a989-136">Abrufen der Anzahl von Elementen</span><span class="sxs-lookup"><span data-stu-id="5a989-136">Obtaining the Number of Items</span></span>

<span data-ttu-id="5a989-137">**Führen Sie die folgenden Schritte aus, um eine Schätzung der Anzahl der Elemente zu erhalten, die für eine bestimmte Suche zurückgegeben werden.**</span><span class="sxs-lookup"><span data-stu-id="5a989-137">**To obtain an estimate of the number of items that will be returned for a particular search, perform the following steps.**</span></span>

1.  <span data-ttu-id="5a989-138">Füllen Sie eine [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur mit allen NULL-oder **null** -Werten aus.</span><span class="sxs-lookup"><span data-stu-id="5a989-138">Fill an [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure with all zero or **NULL** values.</span></span>
2.  <span data-ttu-id="5a989-139">Füllen Sie eine Werbung mit der [**\_ searchpref- \_ Info**](/windows/desktop/api/Iads/ns-iads-ads_searchpref_info) mit den folgenden Werten aus.</span><span class="sxs-lookup"><span data-stu-id="5a989-139">Fill an [**ADS\_SEARCHPREF\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_searchpref_info) with the following values.</span></span>

    -   <span data-ttu-id="5a989-140">Legen Sie den **dwsearchpref** -Member auf **ADS \_ searchpref \_ VLV** fest.</span><span class="sxs-lookup"><span data-stu-id="5a989-140">Set the **dwSearchPref** member to **ADS\_SEARCHPREF\_VLV**.</span></span>
    -   <span data-ttu-id="5a989-141">Legen Sie den **vValue. dwType** -Member auf **adstype \_ Prov \_ Specific** fest.</span><span class="sxs-lookup"><span data-stu-id="5a989-141">Set the **vValue.dwType** member to **ADSTYPE\_PROV\_SPECIFIC**.</span></span>
    -   <span data-ttu-id="5a989-142">Legen Sie den **vValue. ProviderSpecific. dwLength** -Member auf die Größe der [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur fest.</span><span class="sxs-lookup"><span data-stu-id="5a989-142">Set the **vValue.ProviderSpecific.dwLength** member to the size of the [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure.</span></span>
    -   <span data-ttu-id="5a989-143">Legen Sie den **vValue. ProviderSpecific. lpValue** -Member auf die Adresse der [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur aus Schritt 1 fest.</span><span class="sxs-lookup"><span data-stu-id="5a989-143">Set the **vValue.ProviderSpecific.lpValue** member to the address of the [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure from Step 1.</span></span>

3.  <span data-ttu-id="5a989-144">Füllen Sie eine [**ADS \_ SortKey**](/windows/desktop/api/Iads/ns-iads-ads_sortkey) -Struktur aus, wie in [Sortieren der Suchergebnisse mit IDirectorySearch](sorting-the-search-results-with-idirectorysearch.md) zum Sortieren nach dem gewünschten Attribut gezeigt.</span><span class="sxs-lookup"><span data-stu-id="5a989-144">Fill an [**ADS\_SORTKEY**](/windows/desktop/api/Iads/ns-iads-ads_sortkey) structure as shown in [Sorting the Search Results with IDirectorySearch](sorting-the-search-results-with-idirectorysearch.md) to sort on the desired attribute.</span></span>
4.  <span data-ttu-id="5a989-145">Füllen Sie eine weitere Werbung mithilfe von [**\_ searchpref- \_ Informationen**](/windows/desktop/api/Iads/ns-iads-ads_searchpref_info) aus, um die [**ADS \_ SortKey**](/windows/desktop/api/Iads/ns-iads-ads_sortkey) -Struktur den Sucheinstellungen hinzuzufügen, wie unter [Sortieren der Suchergebnisse mit IDirectorySearch](sorting-the-search-results-with-idirectorysearch.md)gezeigt.</span><span class="sxs-lookup"><span data-stu-id="5a989-145">Fill another [**ADS\_SEARCHPREF\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_searchpref_info) to add the [**ADS\_SORTKEY**](/windows/desktop/api/Iads/ns-iads-ads_sortkey) structure to the search preferences as shown in [Sorting the Search Results with IDirectorySearch](sorting-the-search-results-with-idirectorysearch.md).</span></span>
5.  <span data-ttu-id="5a989-146">Fügen Sie alle anderen gewünschten Sucheinstellungen hinzu, und nennen Sie [**IDirectorySearch:: setsearchpreference**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-setsearchpreference) , um die Sucheinstellungen festzulegen.</span><span class="sxs-lookup"><span data-stu-id="5a989-146">Add any other desired search preferences and call [**IDirectorySearch::SetSearchPreference**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-setsearchpreference) to set the search preferences.</span></span>
6.  <span data-ttu-id="5a989-147">Führen Sie die Suche mit [**idirector ysearch:: ExecuteSearch**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-executesearch)durch.</span><span class="sxs-lookup"><span data-stu-id="5a989-147">Perform the search with [**IDirectorySearch::ExecuteSearch**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-executesearch).</span></span>
7.  <span data-ttu-id="5a989-148">Rufen Sie die erste Zeile der Ergebnisse ab, indem Sie [**IDirectorySearch:: GetFirstRow**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getfirstrow)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-148">Get the first row of results by calling [**IDirectorySearch::GetFirstRow**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getfirstrow).</span></span>
8.  <span data-ttu-id="5a989-149">Rufen Sie [**IDirectorySearch:: GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) mit **ADS \_ VLV \_ Response** auf, um die VLV-Such Metadaten abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-149">Call [**IDirectorySearch::GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) with **ADS\_VLV\_RESPONSE** to obtain the VLV search metadata.</span></span>
9.  <span data-ttu-id="5a989-150">Wandeln Sie die **padsvalues->ProviderSpecific. lpValue** der [**ADS- \_ Such \_ Spalten**](/windows/desktop/api/Iads/ns-iads-ads_search_column) Struktur in einen [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur Zeiger um.</span><span class="sxs-lookup"><span data-stu-id="5a989-150">Cast the **pADsValues->ProviderSpecific.lpValue** of the [**ADS\_SEARCH\_COLUMN**](/windows/desktop/api/Iads/ns-iads-ads_search_column) structure to an [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure pointer.</span></span> <span data-ttu-id="5a989-151">Der **dwcontentcount** -Member dieser **ADS \_ VLV** -Struktur enthält die ungefähre Anzahl von Elementen, die durch eine Suche dieses Typs zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-151">The **dwContentCount** member of this **ADS\_VLV** structure contains the approximate number of items that would be returned by a search of that type.</span></span>
10. <span data-ttu-id="5a989-152">Wenn andere VLV-Suchen desselben Typs durchgeführt werden, erstellen Sie eine Kopie der **lpcontextid** -Daten, und bewahren Sie Sie für die nächste VLV-Suche auf.</span><span class="sxs-lookup"><span data-stu-id="5a989-152">If other VLV searches of the same type will be performed, make a copy of the **lpContextID** data and preserve it for the next VLV search.</span></span>

<span data-ttu-id="5a989-153">Die [**getvlvitemcount**](example-code-for-using-a-vlv-search.md) -Beispiel Funktion zeigt, wie dies funktioniert.</span><span class="sxs-lookup"><span data-stu-id="5a989-153">The [**GetVLVItemCount**](example-code-for-using-a-vlv-search.md) example function shows how to do this.</span></span>

## <a name="searching-by-offset"></a><span data-ttu-id="5a989-154">Suchen nach Offset</span><span class="sxs-lookup"><span data-stu-id="5a989-154">Searching by Offset</span></span>

<span data-ttu-id="5a989-155">VLV sucht so schnell, dass es möglich ist, anhand eines numerischen Offsets nach einem bestimmten Ergebnis zu suchen.</span><span class="sxs-lookup"><span data-stu-id="5a989-155">One thing that makes VLV searches so quick is that it is possible to search for a specific result by a numerical offset.</span></span> <span data-ttu-id="5a989-156">Wenn beispielsweise eine Suche dazu führt, dass 10.000 Elemente zurückgegeben werden, ermöglicht eine VLV-Suche das Abrufen der Informationen für ungefähr das 4072nd-Element, ohne alle Elemente vor dem fraglichen Element abrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="5a989-156">For example, if a search would result in 10,000 items being returned, a VLV search makes it possible to obtain the information for approximately the 4072nd item without having to retrieve all of the items before the item in question.</span></span>

<span data-ttu-id="5a989-157">Offsets werden als Verhältnis zwischen Offset und Inhalts Anzahl angegeben.</span><span class="sxs-lookup"><span data-stu-id="5a989-157">Offsets are specified as a ratio between the offset and the content count.</span></span> <span data-ttu-id="5a989-158">Die Verhältnisse sind nützlich, da der Server möglicherweise keine genaue Schätzung der Anzahl der Einträge in der Liste hat oder die Listengröße geändert wird, wenn der Benutzer Sie durchsucht.</span><span class="sxs-lookup"><span data-stu-id="5a989-158">Ratios are useful because the server may not have an accurate estimate of the number of entries that exist in the list or the list size may be changing during the time the user is browsing it.</span></span> <span data-ttu-id="5a989-159">Da Sie den Anfang und das Ende der Liste angeben müssen, können Sie einen geschätzten Wert für die Anzahl von Inhalten in der ersten Such Anforderung zusammen mit einem Offset-Wert verwenden.</span><span class="sxs-lookup"><span data-stu-id="5a989-159">Because you must indicate the beginning and end of the list, you can use an estimated value for the content count in the first search request, along with an offset value.</span></span> <span data-ttu-id="5a989-160">Der Server verwendet diese Daten, um die entsprechenden Offsets in der Liste basierend auf der Idee der Inhalts Anzahl zu berechnen, die in der Antwort an den Client über den **dwcontentcount** -Member der [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="5a989-160">The server uses this data to compute the corresponding offsets within the list, based on its idea of content count, which is sent in its response to the client through the **dwContentCount** member of the [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure.</span></span> <span data-ttu-id="5a989-161">Wenn Sie z. b. die Listengröße auf 3000 und den Offset auf den Listeneintrag 1500 festlegen möchten, legen Sie **dwcontentcount** auf 3000 und **dwOffset** auf 1500 fest.</span><span class="sxs-lookup"><span data-stu-id="5a989-161">For example, if you estimate the list size to be 3000, and you want the offset to be list entry 1500, you would set **dwContentCount** to 3000 and **dwOffset** to 1500.</span></span> <span data-ttu-id="5a989-162">Wenn der Server die tatsächliche Listengröße auf 4500 schätzt, berechnet er den Offset auf 2250 und gibt die neuen Schätzwerte in **dwcontentcount** und **dwOffset** zurück.</span><span class="sxs-lookup"><span data-stu-id="5a989-162">If the server estimates the actual list size to be 4500, it will recalculate the offset to 2250, and return the new estimates in **dwContentCount** and **dwOffset**.</span></span>

> [!Note]
>
> <span data-ttu-id="5a989-163">Alle numerischen Werte in einer VLV-Suche sind Näherungen und sollten nicht für absolute Werte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-163">All of the numeric values in a VLV search are approximations and should not be used for absolute values.</span></span> <span data-ttu-id="5a989-164">Wenn Sie z. b. eine VLV-Suche für das 50. Element in einer Ration von 100 ausgeben, ist es nicht garantiert, dass Sie das exakte mittlere Element erhalten.</span><span class="sxs-lookup"><span data-stu-id="5a989-164">For example, if you issue a VLV search for the 50th item in a ration of 100, you are not guaranteed to get the exact middle item.</span></span>
>
> <span data-ttu-id="5a989-165">**Führen Sie die folgenden Schritte aus, um ein bestimmtes Element nach Offset zu suchen.**</span><span class="sxs-lookup"><span data-stu-id="5a989-165">**To search for a particular item by offset, perform the following steps.**</span></span>
>
> 1.  <span data-ttu-id="5a989-166">Füllen Sie eine [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur mit den folgenden Werten aus.</span><span class="sxs-lookup"><span data-stu-id="5a989-166">Fill an [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure with the following values.</span></span> <span data-ttu-id="5a989-167">Zusätzliche Member der Struktur sollten auf NULL oder **null** festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-167">Additional members of the structure should be set to zero or **NULL**.</span></span>
>
>     -   <span data-ttu-id="5a989-168">Legen Sie den **dwcontentcount** -Member auf den maximalen Wert für das Verhältnis der abzurufenden Elemente fest.</span><span class="sxs-lookup"><span data-stu-id="5a989-168">Set the **dwContentCount** member to the maximum value of the ratio of items to retrieve.</span></span>
>     -   <span data-ttu-id="5a989-169">Legen Sie den **dwOffset** -Member auf das Verhältnis (relativ zu **dwcontentcount**) der Elemente fest, die abgerufen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="5a989-169">Set the **dwOffset** member to the ratio, relative to **dwContentCount**, of the item or items to retrieve.</span></span>
>     -   <span data-ttu-id="5a989-170">Legen Sie den **lpcontextid** -Member auf die Adresse der Kopie des Kontext-ID-Puffers und **dwcontextidlength** auf die Länge des Kontext-ID-Puffers in Bytes fest.</span><span class="sxs-lookup"><span data-stu-id="5a989-170">Set the **lpContextID** member to the address of the copy of the context ID buffer and the **dwContextIDLength** to the length, in bytes, of the context ID buffer.</span></span> <span data-ttu-id="5a989-171">Wenn keine Kontext-ID gespeichert wurde, müssen beide Member 0 (null) oder **null** sein.</span><span class="sxs-lookup"><span data-stu-id="5a989-171">If no context ID has been saved, both of the these members should be zero or **NULL**.</span></span>
>
> 2.  <span data-ttu-id="5a989-172">Legen Sie die Sucheinstellungen fest, wie in den Schritten 2 bis 5 der Prozedur Abrufen der Anzahl von Elementen dargestellt.</span><span class="sxs-lookup"><span data-stu-id="5a989-172">Set the search preferences as shown in Steps 2 through 5 of the Obtaining the Number of Items procedure.</span></span>
> 3.  <span data-ttu-id="5a989-173">Führen Sie die Suche mit [**idirector ysearch:: ExecuteSearch**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-executesearch)durch.</span><span class="sxs-lookup"><span data-stu-id="5a989-173">Perform the search with [**IDirectorySearch::ExecuteSearch**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-executesearch).</span></span>
> 4.  <span data-ttu-id="5a989-174">Rufen Sie die erste Zeile der Ergebnisse ab, indem Sie [**IDirectorySearch:: GetFirstRow**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getfirstrow)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-174">Get the first row of results by calling [**IDirectorySearch::GetFirstRow**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getfirstrow).</span></span>
> 5.  <span data-ttu-id="5a989-175">Rufen Sie [**IDirectorySearch:: GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) mit dem Namen des abzurufenden Attributs auf, um die eigentlichen Daten für das angeforderte Element abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-175">Call [**IDirectorySearch::GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) with the name of the attribute to retrieve to get the actual data for the requested item.</span></span>
> 6.  <span data-ttu-id="5a989-176">Rufen Sie [**IDirectorySearch:: GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) mit **ADS \_ VLV \_ Response** auf, um die VLV-Such Metadaten abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-176">Call [**IDirectorySearch::GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) with **ADS\_VLV\_RESPONSE** to obtain the VLV search metadata.</span></span>
> 7.  <span data-ttu-id="5a989-177">Wandeln Sie die **padsvalues->ProviderSpecific. lpValue** der [**ADS- \_ Such \_ Spalten**](/windows/desktop/api/Iads/ns-iads-ads_search_column) Struktur in einen [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur Zeiger um.</span><span class="sxs-lookup"><span data-stu-id="5a989-177">Cast the **pADsValues->ProviderSpecific.lpValue** of the [**ADS\_SEARCH\_COLUMN**](/windows/desktop/api/Iads/ns-iads-ads_search_column) structure to an [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure pointer.</span></span>
> 8.  <span data-ttu-id="5a989-178">Erstellen Sie eine Kopie der **lpcontextid** -Daten, und bewahren Sie Sie für die nächste VLV-Suche auf.</span><span class="sxs-lookup"><span data-stu-id="5a989-178">Make a copy of the **lpContextID** data and preserve it for the next VLV search.</span></span>

 

<span data-ttu-id="5a989-179">Die Funktion [**getvlvitemtext**](example-code-for-using-a-vlv-search.md) Example zeigt, wie dies funktioniert.</span><span class="sxs-lookup"><span data-stu-id="5a989-179">The [**GetVLVItemText**](example-code-for-using-a-vlv-search.md) example function shows how to do this.</span></span>

<span data-ttu-id="5a989-180">Es ist auch möglich, mehrere Daten Zeilen mit einem einzelnen Suchvorgang abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-180">It is also possible to retrieve more than one row of data with a single search call.</span></span> <span data-ttu-id="5a989-181">Dies erfolgt in Schritt 1, indem die **dwbeforecount** -und **dwaftercount** -Elemente der [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur entsprechend festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-181">This is done in Step 1 by setting the **dwBeforeCount** and **dwAfterCount** members of the [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure appropriately.</span></span> <span data-ttu-id="5a989-182">Das **dwbeforecount** -Element enthält die Anzahl der Elemente, die in der Liste vor dem fraglichen Element angezeigt werden, und das **dwaftercount** -Element enthält die Anzahl der Elemente, die nach dem fraglichen Element in der Liste angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-182">The **dwBeforeCount** member contains the number of items that appear in the list prior to the item in question and the **dwAfterCount** member contains the number of items that appear in the list after to the item in question.</span></span> <span data-ttu-id="5a989-183">Beide Zahlen schließen das Element selbst aus. Wenn Sie also **dwbeforecount** auf 10 und **dwaftercount** auf 10 festlegen, werden insgesamt 21 Elemente zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="5a989-183">Both of these counts exclude the item itself, so setting **dwBeforeCount** to 10 and **dwAfterCount** to 10 will result in a total of 21 items returned.</span></span> <span data-ttu-id="5a989-184">Diese Option ermöglicht das Zwischenspeichern der Suchergebnisse auf Clientseite.</span><span class="sxs-lookup"><span data-stu-id="5a989-184">This option enables caching the search results on the client side.</span></span>

## <a name="searching-by-string"></a><span data-ttu-id="5a989-185">Suchen nach Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="5a989-185">Searching by String</span></span>

<span data-ttu-id="5a989-186">Es ist auch möglich, eine VLV-Suche zu verwenden, um Elemente zu suchen, die ein Zeichen folgen Attribut aufweisen, dessen Wert ganz oder teilweise mit einer Zeichenfolge übereinstimmt, ohne alle Elemente abrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="5a989-186">It is also possible to use a VLV search to find items that have a string attribute whose value matches all or part of a string without having to retrieve all items.</span></span> <span data-ttu-id="5a989-187">Die Zeichen folgen Entsprechungen werden für das in der [**ADS \_ SortKey**](/windows/desktop/api/Iads/ns-iads-ads_sortkey) -Struktur der **ADS \_ searchpref- \_ Sortierung \_** nach der Such Einstellung angegebene Attribut ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="5a989-187">The string matching is performed against the attribute specified in the [**ADS\_SORTKEY**](/windows/desktop/api/Iads/ns-iads-ads_sortkey) structure of the **ADS\_SEARCHPREF\_SORT\_ON** search preference.</span></span>

<span data-ttu-id="5a989-188">**Führen Sie die folgenden Schritte aus, um nach einem bestimmten Element durch eine Zeichenfolge zu suchen.**</span><span class="sxs-lookup"><span data-stu-id="5a989-188">**To search for a particular item by string, perform the following steps.**</span></span>

1.  <span data-ttu-id="5a989-189">Füllen Sie eine [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur mit den folgenden Werten aus.</span><span class="sxs-lookup"><span data-stu-id="5a989-189">Fill an [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure with the following values.</span></span> <span data-ttu-id="5a989-190">Zusätzliche Member der Struktur sollten auf NULL oder **null** festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-190">Additional members of the structure should be set to zero or **NULL**.</span></span>

    -   <span data-ttu-id="5a989-191">Legen Sie das **psztarget** -Element auf einen Zeiger auf eine NULL-terminierte Zeichenfolge fest, die die zu suchende Zeichenfolge enthält.</span><span class="sxs-lookup"><span data-stu-id="5a989-191">Set the **pszTarget** member to a pointer to a NULL-terminated string that contains the string to search for.</span></span>
    -   <span data-ttu-id="5a989-192">Legen Sie den **lpcontextid** -Member auf die Adresse der Kopie des Kontext-ID-Puffers und **dwcontextidlength** auf die Länge des Kontext-ID-Puffers in Bytes fest.</span><span class="sxs-lookup"><span data-stu-id="5a989-192">Set the **lpContextID** member to the address of the copy of the context ID buffer and the **dwContextIDLength** to the length, in bytes, of the context ID buffer.</span></span> <span data-ttu-id="5a989-193">Wenn keine Kontext-ID gespeichert wurde, müssen beide Member 0 (null) oder **null** sein.</span><span class="sxs-lookup"><span data-stu-id="5a989-193">If no context ID has been saved, both of the these members should be zero or **NULL**.</span></span>

2.  <span data-ttu-id="5a989-194">Legen Sie die Sucheinstellungen fest, wie in den Schritten 2 bis 5 der Prozedur Abrufen der Anzahl von Elementen dargestellt.</span><span class="sxs-lookup"><span data-stu-id="5a989-194">Set the search preferences as shown in Steps 2 through 5 of the Obtaining the Number of Items procedure.</span></span>
3.  <span data-ttu-id="5a989-195">Führen Sie die Suche mit [**idirector ysearch:: ExecuteSearch**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-executesearch)durch.</span><span class="sxs-lookup"><span data-stu-id="5a989-195">Perform the search with [**IDirectorySearch::ExecuteSearch**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-executesearch).</span></span>
4.  <span data-ttu-id="5a989-196">Rufen Sie die erste Zeile der Ergebnisse ab, indem Sie [**IDirectorySearch:: GetFirstRow**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getfirstrow)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-196">Get the first row of results by calling [**IDirectorySearch::GetFirstRow**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getfirstrow).</span></span>
5.  <span data-ttu-id="5a989-197">Rufen Sie [**IDirectorySearch:: GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) mit dem Namen des abzurufenden Attributs auf, um die eigentlichen Daten für das angeforderte Element abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-197">Call [**IDirectorySearch::GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) with the name of the attribute to retrieve to get the actual data for the requested item.</span></span>
6.  <span data-ttu-id="5a989-198">Rufen Sie [**IDirectorySearch:: GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) mit **ADS \_ VLV \_ Response** auf, um die VLV-Such Metadaten abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-198">Call [**IDirectorySearch::GetColumn**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-getcolumn) with **ADS\_VLV\_RESPONSE** to obtain the VLV search metadata.</span></span>
7.  <span data-ttu-id="5a989-199">Wandeln Sie die **padsvalues->ProviderSpecific. lpValue** der [**ADS- \_ Such \_ Spalten**](/windows/desktop/api/Iads/ns-iads-ads_search_column) Struktur in einen [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur Zeiger um.</span><span class="sxs-lookup"><span data-stu-id="5a989-199">Cast the **pADsValues->ProviderSpecific.lpValue** of the [**ADS\_SEARCH\_COLUMN**](/windows/desktop/api/Iads/ns-iads-ads_search_column) structure to an [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure pointer.</span></span>
8.  <span data-ttu-id="5a989-200">Erstellen Sie eine Kopie der **lpcontextid** -Daten, und bewahren Sie Sie für die nächste VLV-Suche auf.</span><span class="sxs-lookup"><span data-stu-id="5a989-200">Make a copy of the **lpContextID** data and preserve it for the next VLV search.</span></span> <span data-ttu-id="5a989-201">Wenn dies erforderlich ist, enthält der **dwOffset** -Member den 1-basierten Index des ersten Elements, dessen Zeichen folgen Attribut mit dem in **psztarget** angegebenen Wert beginnt.</span><span class="sxs-lookup"><span data-stu-id="5a989-201">If required, the **dwOffset** member contains the one-based index of the first item whose string attribute begins with the value specified in **pszTarget**.</span></span>

<span data-ttu-id="5a989-202">Die [**getvlvitemsbystring**](example-code-for-using-a-vlv-search.md) -Beispiel Funktion zeigt, wie dies funktioniert.</span><span class="sxs-lookup"><span data-stu-id="5a989-202">The [**GetVLVItemsByString**](example-code-for-using-a-vlv-search.md) example function shows how to do this.</span></span>

<span data-ttu-id="5a989-203">Ähnlich wie bei der Suche nach Index ist es auch möglich, mehrere Daten Zeilen mit einem einzelnen Suchvorgang abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5a989-203">Similarly to searching by index, it is also possible to retrieve more than one row of data with a single search call.</span></span> <span data-ttu-id="5a989-204">Dies erfolgt auf die gleiche Weise, indem die **dwbeforecount** -und **dwaftercount** -Elemente der [**ADS \_ VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) -Struktur entsprechend festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="5a989-204">This is accomplished in the same manner by setting the **dwBeforeCount** and **dwAfterCount** members of the [**ADS\_VLV**](/windows/desktop/api/Iads/ns-iads-ads_vlv) structure appropriately.</span></span>

 

 