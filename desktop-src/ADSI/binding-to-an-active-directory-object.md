---
title: Binden an ein Active Directory Objekt
description: Die gängigste Methode, eine Bindung an ein Active Directory Objekt herzustellen, besteht darin, die GetObject-Funktion zwischen einem ADSI-Client und einem ADSI-Anbieter zu verwenden.
ms.assetid: d278ea26-2fd5-4343-8d87-ff85515325fb
ms.tgt_platform: multiple
keywords:
- Binden an ein Active Directory Objekt ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 59992dbc88c00be6306dec24523ec4e030d4a516
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "103858467"
---
# <a name="binding-to-an-active-directory-object"></a><span data-ttu-id="70373-104">Binden an ein Active Directory Objekt</span><span class="sxs-lookup"><span data-stu-id="70373-104">Binding to an Active Directory Object</span></span>

<span data-ttu-id="70373-105">Die gängigste Methode, eine Bindung an ein Active Directory Objekt herzustellen, besteht darin, die **GetObject** -Funktion zwischen einem ADSI-Client und einem ADSI-Anbieter zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="70373-105">The most common way to bind to an Active Directory object is to use the **GetObject** function between an ADSI client and an ADSI provider.</span></span> <span data-ttu-id="70373-106">Dies ist auch die einfachste Möglichkeit, um anzuzeigen, wie die Anbieter Komponente Anforderungen empfängt und verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="70373-106">This is also the easiest way to show how the provider component receives and services requests.</span></span> <span data-ttu-id="70373-107">Sowohl die ADSI-API-Funktion [**ADsGetObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsgetobject) als auch die Visual Basic-Funktion " **GetObject** " führen die gleichen Schritte für die Bindung aus.</span><span class="sxs-lookup"><span data-stu-id="70373-107">Both the ADSI API function [**ADsGetObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsgetobject) or the Visual Basic function **GetObject** follow the same steps for binding.</span></span>

<span data-ttu-id="70373-108">Nehmen Sie für dieses Beispiel an, dass der ADSI-Client eine ADSI Viewer-Anwendung ist, die den ADsPath "Sample://Seattle/Redmond/Shelly" von der zugehörigen Benutzeroberfläche erhalten hat (1).</span><span class="sxs-lookup"><span data-stu-id="70373-108">For this example, assume the ADSI client is an ADSI viewer application that has received the ADsPath "Sample://Seattle/Redmond/Shelly" from its user interface (1).</span></span> <span data-ttu-id="70373-109">In der folgenden Abbildung wird die Abfolge der Ereignisse durch Nummerieren der Fluss Pfeile ausführlich erläutert.</span><span class="sxs-lookup"><span data-stu-id="70373-109">The following figure details the sequence of events by numbering the flow arrows.</span></span>

![Ausführliche Ansicht der ADSI-Komponenten](images/dscsex.png)

<span data-ttu-id="70373-111">In der obigen Abbildung initiiert der Client die Anforderung eines Schnittstellen Zeigers auf dem Active Directory Objekt, das durch den ADsPath "Sample://Seattle/Redmond/Shelly" aus ADSI Services (2) dargestellt wird.</span><span class="sxs-lookup"><span data-stu-id="70373-111">In the preceding figure, the client initiates the request for an interface pointer on the Active Directory object represented by the ADsPath "Sample://Seattle/Redmond/Shelly" from ADSI services (2).</span></span> <span data-ttu-id="70373-112">Während der Initialisierung hat die Dienst Software eine Tabelle installierter Anbieter Programm-IDs (ProgIDs) aus der Registrierung ("LDAP:", "Sample:", "Winnt:" usw.) aufgefüllt und mit den passenden **CLSID**-Werten gekoppelt, die das entsprechende Softwaremodul identifizieren.</span><span class="sxs-lookup"><span data-stu-id="70373-112">During initialization, the services software populated a table of installed provider programmatic identifiers (ProgIDs) from the registry ("LDAP:","Sample:", "WinNT:", and so on) and paired them with the matching **CLSID** s which identify the appropriate software module.</span></span>

<span data-ttu-id="70373-113">Der ADSI-Server überprüft, ob die ProgID, in diesem Fall "Sample:", im ADsPath vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="70373-113">The ADSI server verifies that the ProgID, in this case "Sample:", exists in the ADsPath.</span></span> <span data-ttu-id="70373-114">Anschließend wird ein Bindungs Kontext erstellt, um weitere Verweise auf dieses Objekt zu optimieren, und die Standard-com-Funktion " [**mkparamesedisplayname**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) " wird aufgerufen, um einen com-Moniker zu erstellen, der verwendet werden kann, um das Objekt zu suchen und zu binden, das den Benutzer "Shelly" darstellt.</span><span class="sxs-lookup"><span data-stu-id="70373-114">It then creates a bind context to optimize further references to this object, and calls the standard COM function [**MkParseDisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) to create a COM moniker that can be used to find and bind to the object that represents the user "Shelly".</span></span>

<span data-ttu-id="70373-115">Im folgenden Abschnitt sind die Dateinamen des Beispiel Quellcodes der Anbieter Komponente ggf. in Klammern eingeschlossen.</span><span class="sxs-lookup"><span data-stu-id="70373-115">In the following section, the file names of the example provider component source code are included in parentheses where appropriate.</span></span>

<span data-ttu-id="70373-116">Wie bei anderen com-Server Implementierungen prüft " [**mkparser-Display Name**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) " die ProgID und sucht die richtige **CLSID** in der Registrierung (3), um den entsprechenden vom Anbieter bereitgestellten klassenfactorycode (cprovcf. cpp) in der entsprechenden Anbieter Implementierung (4) zu finden.</span><span class="sxs-lookup"><span data-stu-id="70373-116">As in other COM server implementations, [**MkParseDisplayName**](/windows/win32/api/objbase/nf-objbase-mkparsedisplayname) examines the ProgID, and looks up the proper **CLSID** in the registry (3) to find the corresponding provider-supplied class factory code (Cprovcf.cpp) in the appropriate provider implementation (4).</span></span> <span data-ttu-id="70373-117">Dieser Code erstellt ein ursprüngliches Objekt der obersten Ebene, das die [**icsedisplayname::P arsedisplayname**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) -Methode (cprov. cpp) implementiert.</span><span class="sxs-lookup"><span data-stu-id="70373-117">This code creates an initial top-level object that implements the [**IParseDisplayName::ParseDisplayName**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) method (Cprov.cpp).</span></span> <span data-ttu-id="70373-118">Die Implementierung von " **Parser Name** " des Anbieters löst den Pfad im eigenen Namespace des Anbieters auf.</span><span class="sxs-lookup"><span data-stu-id="70373-118">The provider's implementation of **ParseDisplayName** resolves the path in the provider's own namespace.</span></span> <span data-ttu-id="70373-119">Dadurch wird AdsObject schließlich aufgerufen und der mit der Anbieter Komponente (Parse. cpp) bereitgestellte Parser aufgerufen, um zu überprüfen, ob der ADsPath für diesen Namespace syntaktisch richtig ist.</span><span class="sxs-lookup"><span data-stu-id="70373-119">This eventually calls ADsObject and invokes the parser supplied with the provider component (Parse.cpp) to verify that the ADsPath is syntactically correct for this namespace.</span></span>

<span data-ttu-id="70373-120">**GetObject**, das in getobj. cpp definiert ist, bestimmt dann, ob das angeforderte Objekt ein Namespace Objekt, ein Schema Objekt oder ein anderer Objekttyp ist.</span><span class="sxs-lookup"><span data-stu-id="70373-120">**GetObject**, that is defined in Getobj.cpp, then determines if the object requested is a namespace object, a schema object, or some other type of object.</span></span> <span data-ttu-id="70373-121">Wenn einer der ersten beiden ist, wird dieser Typ von Schema Klassenobjekt erstellt und der entsprechende Schnittstellen Zeiger abgerufen.</span><span class="sxs-lookup"><span data-stu-id="70373-121">If either of the first two, that type of schema class object is created and the appropriate interface pointer retrieved.</span></span> <span data-ttu-id="70373-122">Andernfalls wird der Beispiel Verzeichnispfad aus dem ADsPath erstellt (z. b. " \\ Seattle \\ Redmond \\ Shelly", aber in einem anderen Verzeichnisdienst muss Sie " \\ OU = Seattle \\ OU = Redmond \\ CN = Shelly" lauten, und die Steuerung wird an sampledsopenobject weitergeleitet, das das Objekt im Beispiel Datenspeicher öffnet und seinen Objekttyp (in diesem Fall "Benutzer") abruft.</span><span class="sxs-lookup"><span data-stu-id="70373-122">Otherwise the Sample directory path is created from the ADsPath (for example, "\\Seattle\\Redmond\\Shelly", but in a different directory service it might have had to be "\\OU=Seattle\\OU=Redmond\\CN=Shelly") and control passes to SampleDSOpenObject which opens the object in the example data storage and also retrieves its object type (in this case, "User") (5).</span></span>

<span data-ttu-id="70373-123">Nachdem die Daten gesammelt wurden, wird ein neues-Objekt erstellt (6), um das durch den ADsPath beschriebene Element darzustellen, und ein Zeiger auf die [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) -Schnittstelle für dieses Objekt wird abgerufen.</span><span class="sxs-lookup"><span data-stu-id="70373-123">With the data gathered, a new object is created (6) to represent the item described by the ADsPath, and a pointer to the [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface on that object is retrieved.</span></span> <span data-ttu-id="70373-124">In diesem Fall wird ein generisches Active Directory Objekt erstellt, das die **IUnknown** -und [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) -Methode (cgenobj. cpp, Core. cpp) unterstützt.</span><span class="sxs-lookup"><span data-stu-id="70373-124">In this case, a generic Active Directory object is created that supports the **IUnknown** and [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) methods (Cgenobj.cpp, Core.cpp).</span></span> <span data-ttu-id="70373-125">Die csampledsgenobject:: zuordnungsegenobject-Routine liest die Typbibliotheks Daten, um die richtigen dispatcheinträge für diese neuen Objekte zu erstellen, um [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="70373-125">The CSampleDSGenObject::AllocateGenObject routine reads the type library data to create the proper dispatch entries for these new objects in order to support [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span></span>

<span data-ttu-id="70373-126">Wenn Sie diesen Schnittstellen Zeiger in einen Moniker einschließen, wird die resolvepathname (cprov. cpp)-Funktion abgeschlossen und der Anzeige Name analysiert.</span><span class="sxs-lookup"><span data-stu-id="70373-126">Wrapping this interface pointer into a moniker completes the ResolvePathName (Cprov.cpp) function and parses the display name.</span></span>

<span data-ttu-id="70373-127">Alle COM-Objekte, die während dieses Prozesses erstellt werden, werden aus Leistungsgründen zwischengespeichert und über den Bindungs Kontext verwaltet.</span><span class="sxs-lookup"><span data-stu-id="70373-127">All the COM objects created during this process are cached for performance reasons and managed through the binding context.</span></span> <span data-ttu-id="70373-128">Dies verbessert die Leistung für andere Vorgänge auf demselben Objekt, das direkt auf die Monikerbindung folgt.</span><span class="sxs-lookup"><span data-stu-id="70373-128">This improves performance for other operations on the same object that immediately follows the moniker binding.</span></span>

<span data-ttu-id="70373-129">Dieses wohlgeformte Active Directory Objekt wird nun für den für den anfänglichen [**ADsGetObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsgetobject) -Befehl angeforderten Schnittstellen Bezeichner abgefragt, und ein Zeiger auf diese Schnittstelle wird abgerufen (7) und über den ADSI-Server an den Client zurückgegeben (8&9).</span><span class="sxs-lookup"><span data-stu-id="70373-129">This well-formed Active Directory object is now queried for the interface identifier requested for the initial [**ADsGetObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsgetobject) call and a pointer to that interface is retrieved (7) and passed back through the ADSI server to the client (8&9).</span></span> <span data-ttu-id="70373-130">Von diesem Zeitpunkt an arbeitet der Client direkt mit der Anbieter Komponente über die Schnittstellen Methoden, bis die anfängliche Anforderung erfüllt ist (10).</span><span class="sxs-lookup"><span data-stu-id="70373-130">From then on, the client works directly with the provider component through the interface methods until the initial request is satisfied (10).</span></span>

<span data-ttu-id="70373-131">Außerdem verwenden Anforderungen für Objektdaten vom Client normalerweise die Form von Anforderungen für das Abrufen und Einfügen von Eigenschaften, die alle durch die Anbieter Implementierung eines Eigenschafts Caches (Crequi. cpp) optimiert werden.</span><span class="sxs-lookup"><span data-stu-id="70373-131">Furthermore, requests for object data from the client usually take the form of requests for property gets and puts, all of which are optimized through the provider implementation of a property cache (Cprops.cpp).</span></span> <span data-ttu-id="70373-132">Intelligent packen und entpacken von Daten (häufig einschließlich kopieren und Freigeben von Strukturen und Zeichen folgen) zwischen den nativen Datentypen im Betriebssystem der Beispiel Anbieter Komponente [](/windows/win32/api/oaidl/ns-oaidl-variant) und dem von ADSI unterstützten Automatisierungstyp für die Automatisierung findet statt, bevor die Eigenschaften in den Cache (smpoper. cpp) geladen werden.</span><span class="sxs-lookup"><span data-stu-id="70373-132">Intelligently packing and unpacking data, often including copying and freeing structures and strings, between the native data types on the example provider component's operating system and the Automation [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) type supported by ADSI takes place before the properties are loaded into the cache (Smpoper.cpp).</span></span>

<span data-ttu-id="70373-133">Die Beispiel Anbieter Komponente ist so konzipiert, dass die tatsächlichen Aufrufe an das Betriebssystem logisch von der Anbieter Komponente isoliert sind. Dadurch wird Software erstellt, die für mehr als ein Betriebssystem (regdsapi. cpp) portabel ist.</span><span class="sxs-lookup"><span data-stu-id="70373-133">The example provider component is designed so that the actual calls to the operating system are logically isolated from the provider component, creating software portable to more than one operating system (RegDSAPI.cpp).</span></span>

 

 