---
title: Code Übersicht
description: Die folgende Abbildung stellt eine konzeptionelle Darstellung der Code Blöcke dar, die zum Implementieren der ADSI-Beispiel Anbieter Komponente erforderlich sind.
ms.assetid: b353c2d9-ef86-4e4c-ac00-4756fc9ec57d
ms.tgt_platform: multiple
keywords:
- Code Übersicht AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e99a4974ac97488fc051ea80dbde7a8a83fa329e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104039610"
---
# <a name="code-overview"></a><span data-ttu-id="83ce8-104">Code Übersicht</span><span class="sxs-lookup"><span data-stu-id="83ce8-104">Code Overview</span></span>

<span data-ttu-id="83ce8-105">Die folgende Abbildung stellt eine konzeptionelle Darstellung der Code Blöcke dar, die zum Implementieren der ADSI-Beispiel Anbieter Komponente erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="83ce8-105">The following figure is a conceptual representation of the blocks of code necessary to implement the ADSI example provider component.</span></span> <span data-ttu-id="83ce8-106">Jeder Abschnitt wird in der folgenden Abbildung beschrieben.</span><span class="sxs-lookup"><span data-stu-id="83ce8-106">Each section is described in the following figure.</span></span> <span data-ttu-id="83ce8-107">Erfahrene com-Programmierer können dies als geeignete Übersicht über die Beispiel Anbieter Komponente feststellen.</span><span class="sxs-lookup"><span data-stu-id="83ce8-107">Experienced COM programmers may find this is to be a suitable overview of the example provider component.</span></span> <span data-ttu-id="83ce8-108">Weitere Informationen finden Sie unter [Code Details](code-details.md).</span><span class="sxs-lookup"><span data-stu-id="83ce8-108">For more information, see [Code Details](code-details.md).</span></span>

![Beispiel Anbieter Implementierung](images/dssmco.png)

<span data-ttu-id="83ce8-110">Die folgenden nummerierten Elemente entsprechen Block Elementen in der Abbildung.</span><span class="sxs-lookup"><span data-stu-id="83ce8-110">The following numbered items correspond to block elements in the figure.</span></span>

1.  <span data-ttu-id="83ce8-111">Laden der dll (LibMain. cpp, GUID. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-111">Loading the DLL (Libmain.cpp, Guid.cpp).</span></span> <span data-ttu-id="83ce8-112">Der Einstiegspunkt für die dll.</span><span class="sxs-lookup"><span data-stu-id="83ce8-112">The entry point for the DLL.</span></span> <span data-ttu-id="83ce8-113">Klassenfactorydefinitionen statischer Objekt Definitionen für die beiden Anbieter Objekte: GUID. cpp enthält die CLSID-Definitionen für die Implementierungen der verschiedenen Beispiel Anbieter-Komponenten Objekte.</span><span class="sxs-lookup"><span data-stu-id="83ce8-113">Class factory static object definitions for the two provider objects: Guid.cpp contains the CLSID definitions for the implementations of the various Example provider component objects.</span></span>
2.  <span data-ttu-id="83ce8-114">Anbieterobjektklassenfactory und Erstellungs Code (cprovcf. cpp, cprov. cpp, stdfact. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-114">Provider object class factory and creation code (Cprovcf.cpp, Cprov.cpp, Stdfact.cpp).</span></span> <span data-ttu-id="83ce8-115">Das Provider-Objekt ist das Objekt, das [**iparamesedisplayname**](/windows/win32/api/oleidl/nn-oleidl-iparsedisplayname) während der monikerbindungsvorgänge unterstützt, wie in suchen und binden in der Beispiel Anbieter Komponente erläutert.</span><span class="sxs-lookup"><span data-stu-id="83ce8-115">The provider object is the object that supports [**IParseDisplayName**](/windows/win32/api/oleidl/nn-oleidl-iparsedisplayname) during the moniker binding operations as discussed in Finding and Binding in the Example Provider Component.</span></span>
3.  <span data-ttu-id="83ce8-116">Binden an ein Objekt (getobj. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-116">Binding to an object (Getobj.cpp).</span></span> <span data-ttu-id="83ce8-117">Mit diesem Code wird der Parser aufgerufen, um zu überprüfen, ob der angegebene ADsPath syntaktisch korrekt ist, und dann alle notwendigen Zuordnungs Vorgänge vom ADsPath zum systemeigenen Verzeichnisdienst Pfad für das als Active Directory Objekt erstellte Element durchführt.</span><span class="sxs-lookup"><span data-stu-id="83ce8-117">This code calls the parser to check that the given ADsPath is syntactically correct, and then performs any necessary mapping from the ADsPath to the native directory service path for the item being created as an Active Directory object.</span></span> <span data-ttu-id="83ce8-118">Er sucht nach der Schema Definition für diesen Objekttyp und füllt die obligatorischen Eigenschaften aus.</span><span class="sxs-lookup"><span data-stu-id="83ce8-118">It looks up the schema definition for this type of object and fills in the mandatory properties.</span></span> <span data-ttu-id="83ce8-119">Nachdem Sie das Active Directory-Objekt erstellt haben, wird ein Schnittstellen Zeiger auf [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) für den Aufrufer abgerufen.</span><span class="sxs-lookup"><span data-stu-id="83ce8-119">After creating the Active Directory object, an interface pointer to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) is retrieved for the caller.</span></span>
4.  <span data-ttu-id="83ce8-120">Parser für den Anbieter Namespace (Parse. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-120">Parser for the provider namespace (Parse.cpp).</span></span> <span data-ttu-id="83ce8-121">Dies ist der Code, der von Element 3 aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="83ce8-121">This is the code invoked by item 3.</span></span> <span data-ttu-id="83ce8-122">Der Parser überprüft, ob die Übergabe der ADsPath-Zeichenfolge für einen eigenen Namespace syntaktisch korrekt ist.</span><span class="sxs-lookup"><span data-stu-id="83ce8-122">The parser verifies that the ADsPath string passed in is syntactically correct for its own namespace.</span></span>
5.  <span data-ttu-id="83ce8-123">Klassenfactory, Erstellung und Enumeration für das Namespace-Objekt (cnamcf. cpp, cnamesp. cpp, cenumns. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-123">Class factory, creation, and enumeration for the namespace object (Cnamcf.cpp, Cnamesp.cpp, Cenumns.cpp).</span></span> <span data-ttu-id="83ce8-124">Das Namespace-Objekt ist ein Container Objekt, das aufgelistet werden kann, um alle Stamm Knoten Objekte für diesen Namespace zu suchen.</span><span class="sxs-lookup"><span data-stu-id="83ce8-124">The namespace object is a container object that can be enumerated to find all the root node objects for this namespace.</span></span>
6.  <span data-ttu-id="83ce8-125">Klassenfactory und Erstellungs Code für ein generisches Active Directory Objekt und eine Klassenfactory, den Erstellungs-und Enumerationscode für ein generisches ADS-Container Objekt (cgenobj. cpp, cenumubj. cpp, Common. cpp, Core. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-125">Class factory and creation code for a generic Active Directory object, and class factory, creation and enumeration code for a generic ADs container object (Cgenobj.cpp, Cenumobj.cpp, Common.cpp, Core.cpp).</span></span> <span data-ttu-id="83ce8-126">Dieser Code wird ausgeführt, wenn ein Active Directory Objekt erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="83ce8-126">This code is executed when an Active Directory object is created.</span></span>
7.  <span data-ttu-id="83ce8-127">Filtern und Auflisten von Varianten (cenumvar. cpp, Object. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-127">Filtering and enumerating VARIANTs (Cenumvar.cpp, Object.cpp).</span></span> <span data-ttu-id="83ce8-128">Wenn eine Auflistung von Variant-Elementen eines einzelnen Typs innerhalb von ADSI verwaltet wird, wird dieser Code verwendet.</span><span class="sxs-lookup"><span data-stu-id="83ce8-128">When a collection of VARIANT elements of a single type are managed in within ADSI, this code is used.</span></span>
8.  <span data-ttu-id="83ce8-129">Globals (Globals. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-129">Globals (Globals.cpp).</span></span> <span data-ttu-id="83ce8-130">Namespace Schlüsselwörter, Syntax Mapping-Strukturen aus nativen Datenformaten zum Variant-Typ ADS Automation sind hier definiert.</span><span class="sxs-lookup"><span data-stu-id="83ce8-130">Namespace keywords, syntax mapping structures from native data formats to the ADs Automation VARIANT type are all defined here.</span></span>
9.  <span data-ttu-id="83ce8-131">Marshalling/Marshalling von Daten ("Pack. cpp", "Property. cpp", "smpoper. cpp").</span><span class="sxs-lookup"><span data-stu-id="83ce8-131">Marshaling/unmarshaling data (Pack.cpp, Property.cpp, Smpoper.cpp).</span></span> <span data-ttu-id="83ce8-132">Die Konvertierung von systemeigenen Datenformaten in den unterstützten Satz von Automatisierungs Varianten Typen tritt auf, wenn die Eigenschaften eines Objekts in den Eigenschafts Cache geladen werden.</span><span class="sxs-lookup"><span data-stu-id="83ce8-132">Conversion from native data formats to the supported set of Automation VARIANT types occurs when properties of an object are loaded into the property cache.</span></span> <span data-ttu-id="83ce8-133">Es muss eine andere spezielle Verarbeitung für Daten ausgeführt werden, wenn Strukturen mit Zeigern kopiert, gelöscht oder in den Arbeitsspeicher verschoben werden.</span><span class="sxs-lookup"><span data-stu-id="83ce8-133">Other special handling for data must be performed when structures with pointers are copied, deleted, or moved in memory.</span></span>
10. <span data-ttu-id="83ce8-134">Eigenschafts Cache (c-Eigenschaften. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-134">Property cache (Cprops.cpp).</span></span> <span data-ttu-id="83ce8-135">Caching-Eigenschaften sind ein Feature der ADSI-Umgebung.</span><span class="sxs-lookup"><span data-stu-id="83ce8-135">Caching properties is a feature of the ADSI environment.</span></span> <span data-ttu-id="83ce8-136">Die [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo), [**IADs:: GetInfoEx**](/windows/desktop/api/Iads/nf-iads-iads-getinfoex)-Methode und die [**IADs:: abtinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) -Methode agieren auf den Eigenschaften Cache.</span><span class="sxs-lookup"><span data-stu-id="83ce8-136">The [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo), [**IADs::GetInfoEx**](/windows/desktop/api/Iads/nf-iads-iads-getinfoex), and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) methods act on the property cache.</span></span>
11. <span data-ttu-id="83ce8-137">Speicherverwaltung (Memory. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-137">Memory management (Memory.cpp).</span></span> <span data-ttu-id="83ce8-138">Die Verwendung eines Satzes von Speicherfunktionen zum Zuordnen und Freigeben von Arbeitsspeicher ermöglicht der Beispiel Anbieter Komponente, die Speicherauslastung zu verfolgen und Speicher Verluste zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="83ce8-138">Using one set of memory functions to allocate and free memory allows the example provider component to track memory use and stop memory leaks.</span></span>
12. <span data-ttu-id="83ce8-139">Schema Objekte und Verwaltung (cschobj. cpp, cprpobj. cpp, cclsobj. cpp, cenumsch. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-139">Schema objects and management (Cschobj.cpp, Cprpobj.cpp, Cclsobj.cpp, Cenumsch.cpp).</span></span> <span data-ttu-id="83ce8-140">Dies schließt Routinen zum Erstellen, verwalten und Auflisten der Schema Objekte ein.</span><span class="sxs-lookup"><span data-stu-id="83ce8-140">This includes routines to create, manage, and enumerate the schema objects.</span></span> <span data-ttu-id="83ce8-141">Dies schließt Schema Klassen Objekte, Eigenschafts Objekte und Syntax Objekte ein und kann nicht nur das Schema Klassen-Container Objekt auflisten.</span><span class="sxs-lookup"><span data-stu-id="83ce8-141">This includes schema class objects, property objects, and syntax objects, in addition to being able to enumerate the schema class container object.</span></span>
13. <span data-ttu-id="83ce8-142">Betriebssystemspezifische Aufrufe (regdsapi. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-142">Operating-system specific calls (RegDSAPI.cpp).</span></span> <span data-ttu-id="83ce8-143">Dies schließt alle Aufrufe ein, die auf das systemeigene Betriebssystem verweisen.</span><span class="sxs-lookup"><span data-stu-id="83ce8-143">This includes all calls that reference the native operating system.</span></span> <span data-ttu-id="83ce8-144">Neben anderen Funktionen umfassen Sie auch Funktionen zum Öffnen, schließen, lesen und Ändern von Objekten sowie zum Zugreifen auf das Schema und die Eigenschafts Daten.</span><span class="sxs-lookup"><span data-stu-id="83ce8-144">Among other functions, they include functions opening, closing, reading, and modifying objects as well as those accessing the schema and property data.</span></span> <span data-ttu-id="83ce8-145">Die Beispiel Anbieter Komponente wurde zum Simulieren einer Verzeichnishierarchie mithilfe der Registrierung durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="83ce8-145">The example provider component happened to simulate a directory hierarchy by using the registry.</span></span> <span data-ttu-id="83ce8-146">Nur Funktionsnamen sollten für einen anbienerwriter von Interesse sein.</span><span class="sxs-lookup"><span data-stu-id="83ce8-146">Only function names should be of much interest to a provider writer.</span></span>
14. <span data-ttu-id="83ce8-147">[**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) -Implementierung (cdispmgr. cpp).</span><span class="sxs-lookup"><span data-stu-id="83ce8-147">[**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) implementation (Cdispmgr.cpp).</span></span> <span data-ttu-id="83ce8-148">Dieser Code greift auf die Typbibliotheks Daten zu, damit Schnittstellen Methoden in einer Automatisierungs kompatiblen Weise aufgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="83ce8-148">This code accesses the type library data to allow interface methods to be invoked in an Automation-compatible way.</span></span>

 

 