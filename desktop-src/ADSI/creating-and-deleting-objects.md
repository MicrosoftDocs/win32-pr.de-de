---
title: Erstellen und Löschen von Objekten
description: Mit ADSI werden Objekte mithilfe der IADsContainer-Schnittstelle oder der IDirectoryObject-Schnittstelle erstellt und gelöscht.
ms.assetid: 4d1f7ac5-48d3-4ea9-91e4-0cd4bb2ec9f8
ms.tgt_platform: multiple
keywords:
- Erstellen und Löschen von Objekten ADSI
- ADSI, erstellen und Löschen von Objekten
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4730c4cc6a95ad37bfd3953474d3d488fcf05abb
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104474236"
---
# <a name="creating-and-deleting-objects"></a><span data-ttu-id="481ed-105">Erstellen und Löschen von Objekten</span><span class="sxs-lookup"><span data-stu-id="481ed-105">Creating and Deleting Objects</span></span>

<span data-ttu-id="481ed-106">Mit ADSI werden Objekte mithilfe der [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) -Schnittstelle oder der [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) -Schnittstelle erstellt und gelöscht.</span><span class="sxs-lookup"><span data-stu-id="481ed-106">With ADSI, objects are created and deleted using either the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) or [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>

## <a name="creating-an-object-with-iadscontainer"></a><span data-ttu-id="481ed-107">Erstellen eines Objekts mit IADsContainer</span><span class="sxs-lookup"><span data-stu-id="481ed-107">Creating an Object with IADsContainer</span></span>

<span data-ttu-id="481ed-108">**So erstellen Sie ein Objekt mit der IADsContainer-Schnittstelle**</span><span class="sxs-lookup"><span data-stu-id="481ed-108">**To create an object with the IADsContainer interface**</span></span>

1.  <span data-ttu-id="481ed-109">Binden Sie an den Container, der das zu erstellende Objekt enthalten soll, und rufen Sie die [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) -Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="481ed-109">Bind to the container that will contain the object to be created and obtain the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span>
2.  <span data-ttu-id="481ed-110">Verwenden Sie die [**IADsContainer. Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) -Methode, um ein neues-Objekt im Container zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="481ed-110">Use the [**IADsContainer.Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method to create a new object in the container.</span></span>
3.  <span data-ttu-id="481ed-111">Legen Sie die Werte für alle erforderlichen Attribute für das-Objekt mithilfe der [**IADs. Put**](/windows/desktop/api/Iads/nf-iads-iads-put) -oder [**IADs. PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) -Methode fest.</span><span class="sxs-lookup"><span data-stu-id="481ed-111">Set the values for all of the required attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span> <span data-ttu-id="481ed-112">Die zum Erstellen eines Objekts erforderlichen Attribute hängen vom Verzeichnisdienst und dem Objekttyp ab, der erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="481ed-112">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="481ed-113">Weitere Informationen zum Erstellen von Active Directory Objekten finden Sie unter [Erstellen und Löschen von Active Directory Objekten](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="481ed-113">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="481ed-114">Legen Sie die Werte für alle gewünschten optionalen Attribute für das-Objekt mithilfe der [**IADs. Put**](/windows/desktop/api/Iads/nf-iads-iads-put) -oder [**IADs. PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) -Methode fest.</span><span class="sxs-lookup"><span data-stu-id="481ed-114">Set the values for all of the desired optional attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span>
5.  <span data-ttu-id="481ed-115">Ruft die [**IADs. SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) -Methode auf, um ein Commit für das Objekt und seine Attribute durchzusetzen.</span><span class="sxs-lookup"><span data-stu-id="481ed-115">Call the [**IADs.SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method to commit the object and its attributes.</span></span> <span data-ttu-id="481ed-116">Das neue-Objekt wird tatsächlich nicht im zugrunde liegenden Verzeichnisdienst erstellt, bis die **IADs. SetInfo** -Methode aufgerufen wird, um ein Commit für die Attribute durchzusetzen.</span><span class="sxs-lookup"><span data-stu-id="481ed-116">The new object is not actually created in the underlying directory service until the **IADs.SetInfo** method is called to commit the attributes.</span></span>

## <a name="creating-an-object-with-idirectoryobject"></a><span data-ttu-id="481ed-117">Erstellen eines Objekts mit IDirectoryObject</span><span class="sxs-lookup"><span data-stu-id="481ed-117">Creating an Object with IDirectoryObject</span></span>

<span data-ttu-id="481ed-118">**So erstellen Sie ein Objekt mit der IDirectoryObject-Schnittstelle**</span><span class="sxs-lookup"><span data-stu-id="481ed-118">**To create an object with the IDirectoryObject interface**</span></span>

1.  <span data-ttu-id="481ed-119">Binden Sie an den Container, der das zu erstellende Objekt enthalten soll, und rufen Sie die [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) -Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="481ed-119">Bind to the container that will contain the object to be created and obtain the [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>
2.  <span data-ttu-id="481ed-120">Ordnen Sie ein Array von [**ADS \_ attr \_ Info**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) -Strukturen zu, das eine Struktur für jedes Attribut enthält, das beim Erstellen des Objekts festgelegt werden soll.</span><span class="sxs-lookup"><span data-stu-id="481ed-120">Allocate an array of [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structures that contains one structure for each attribute to be set when the object is created.</span></span>
3.  <span data-ttu-id="481ed-121">Füllen Sie eine [**ADS \_ attr \_ Info**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) -Struktur für jedes erforderliche Attribut für das Objekt aus.</span><span class="sxs-lookup"><span data-stu-id="481ed-121">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each required attribute for the object.</span></span> <span data-ttu-id="481ed-122">Die zum Erstellen eines Objekts erforderlichen Attribute hängen vom Verzeichnisdienst und dem Objekttyp ab, der erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="481ed-122">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="481ed-123">Weitere Informationen zum Erstellen von Active Directory Objekten finden Sie unter [Erstellen und Löschen von Active Directory Objekten](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="481ed-123">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="481ed-124">Füllen Sie eine [**ADS \_ attr \_ Info**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) -Struktur für jedes optionale Attribut für das Objekt aus.</span><span class="sxs-lookup"><span data-stu-id="481ed-124">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each optional attribute for the object.</span></span>
5.  <span data-ttu-id="481ed-125">Verwenden Sie die [**IDirectoryObject:: kreatedsobject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) -Methode, um das Objekt im Container zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="481ed-125">Use the [**IDirectoryObject::CreateDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) method to create the object in the container.</span></span> <span data-ttu-id="481ed-126">Diese Methode führt auch ein Commit für das-Objekt an den zugrunde liegenden Verzeichnisdienst aus.</span><span class="sxs-lookup"><span data-stu-id="481ed-126">This method also commits the object to the underlying directory service.</span></span> <span data-ttu-id="481ed-127">Wenn das [**ADS- \_ \_ Info**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) -Array nicht alle erforderlichen Attribute für das-Objekt enthält, schlägt **IDirectoryObject:: deedsobject** fehl.</span><span class="sxs-lookup"><span data-stu-id="481ed-127">If the [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) array does not contain all of the required attributes for the object, **IDirectoryObject::CreateDSObject** will fail.</span></span>

## <a name="deleting-an-object"></a><span data-ttu-id="481ed-128">Löschen eines Objekts</span><span class="sxs-lookup"><span data-stu-id="481ed-128">Deleting an Object</span></span>

<span data-ttu-id="481ed-129">Zum Löschen eines Objekts verwenden Sie die [**IADsContainer::D Elete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) -Methode oder die [**IDirectoryObject::D eletedsobject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) -Methode.</span><span class="sxs-lookup"><span data-stu-id="481ed-129">To delete an object use the [**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) or the [**IDirectoryObject::DeleteDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) method.</span></span> <span data-ttu-id="481ed-130">Diese Methoden können nicht ausgeführt werden, wenn das gelöschte Objekt untergeordnete Objekte enthält.</span><span class="sxs-lookup"><span data-stu-id="481ed-130">These methods will fail if the deleted object contains any child objects.</span></span> <span data-ttu-id="481ed-131">Verwenden Sie die [**iadsdeleteops::D eleteobject**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) -Methode, um einen Container und alle untergeordneten Objekte des Containers zu löschen.</span><span class="sxs-lookup"><span data-stu-id="481ed-131">Use the [**IADsDeleteOps::DeleteObject**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) method to delete a container and all of the container's child objects.</span></span>

<span data-ttu-id="481ed-132">Was mit einem gelöschten Objekt passiert, hängt vom zugrunde liegenden Verzeichnisdienst ab.</span><span class="sxs-lookup"><span data-stu-id="481ed-132">What happens to a deleted object depends on the underlying directory service.</span></span> <span data-ttu-id="481ed-133">Weitere Informationen zum Löschen von Active Directory Objekten finden Sie unter [Erstellen und Löschen von Active Directory Objekten](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="481ed-133">For more information about deleting Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>

 

 