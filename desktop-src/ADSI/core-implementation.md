---
title: Core-Implementierung
description: 'Ein ADSI-Anbieter unterstützt die folgenden Features:'
ms.assetid: 39798237-a181-43b4-8441-ac711f923d4d
ms.tgt_platform: multiple
keywords:
- Core-Implementierung ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f62068bd77553f89e222422431811da1ef251ccd
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104039609"
---
# <a name="core-implementation"></a><span data-ttu-id="de990-104">Core-Implementierung</span><span class="sxs-lookup"><span data-stu-id="de990-104">Core Implementation</span></span>

<span data-ttu-id="de990-105">Ein ADSI-Anbieter unterstützt die folgenden Features:</span><span class="sxs-lookup"><span data-stu-id="de990-105">An ADSI provider supports the following features:</span></span>

-   <span data-ttu-id="de990-106">ADsPath-Zeichen folgen im com-und URL-Format.</span><span class="sxs-lookup"><span data-stu-id="de990-106">ADsPath strings in both COM and URL format.</span></span> <span data-ttu-id="de990-107">Definitionsgemäß können Sie ein Active Directory Objekt mithilfe eines ADsPath-Objekts abrufen.</span><span class="sxs-lookup"><span data-stu-id="de990-107">By definition, you can retrieve an Active Directory object using an ADsPath.</span></span> <span data-ttu-id="de990-108">Anbieter unterstützen die Syntax, die ihr Verzeichnisdienst erfordert, indem Sie die Implementierung von " **parameyname** " verwenden.</span><span class="sxs-lookup"><span data-stu-id="de990-108">Providers support the syntax that their directory service requires using the **ParseDisplayName** implementation.</span></span>
-   <span data-ttu-id="de990-109">Ein Namespace Objekt der obersten Ebene, das [**iparamesedisplayname::P arsedisplayname**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) und [**iadsopendsobject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject)unterstützt.</span><span class="sxs-lookup"><span data-stu-id="de990-109">A top-level Namespace object that supports [**IParseDisplayName::ParseDisplayName**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) and [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span></span> <span data-ttu-id="de990-110">Dieses Objekt enthält die Stamm Knoten für diesen Namespace.</span><span class="sxs-lookup"><span data-stu-id="de990-110">This object contains the root nodes for this namespace.</span></span> <span data-ttu-id="de990-111">Ein Teil der **parmendisplayname** -Implementierung muss einen Parser enthalten, der auf Syntax Fehler für einen eigenen Namespace prüft.</span><span class="sxs-lookup"><span data-stu-id="de990-111">Part of the **ParseDisplayName** implementation must include a parser that checks for syntax errors for its own namespace.</span></span> <span data-ttu-id="de990-112">Dieses Objekt muss auch [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) und **iadsopendsobject** unterstützen.</span><span class="sxs-lookup"><span data-stu-id="de990-112">This object must also support [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) and **IADsOpenDSObject**.</span></span>
-   <span data-ttu-id="de990-113">Die [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="de990-113">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface.</span></span> <span data-ttu-id="de990-114">Dies umfasst eine einfache Implementierung des Eigenschafts Caches über [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) und [**IADs:: abtinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span><span class="sxs-lookup"><span data-stu-id="de990-114">This includes a simple property cache implementation through [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span></span> <span data-ttu-id="de990-115">Vorgänge, bei denen Objekteigenschaften im Modus mit Zwischenspeicherung angezeigt oder festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="de990-115">Operations that get or set object properties occur in cached mode.</span></span> <span data-ttu-id="de990-116">Cache Werte werden in den zugrunde liegenden Verzeichnis Speicher geschrieben, während **IADs:: abfo**.</span><span class="sxs-lookup"><span data-stu-id="de990-116">Cache values are written to the underlying directory store during **IADs::SetInfo**.</span></span> <span data-ttu-id="de990-117">Eine ADSI-Methode wird jedoch nicht zwischengespeichert, sondern sofort ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="de990-117">An ADSI method, however, is not cached, but executes immediately.</span></span>
-   <span data-ttu-id="de990-118">Die [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist)-, [**iadspropertyentry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) -und [**iadspropertyvalue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) -Schnittstellen für den direkten Zugriff auf und das Auflisten der Eigenschaften im Eigenschaften Cache.</span><span class="sxs-lookup"><span data-stu-id="de990-118">The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) and [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) interfaces for directly accessing and enumerating the properties in the property cache.</span></span> <span data-ttu-id="de990-119">Für Verzeichnisdienste, die kein Schema verfügbar machen, können Sie mithilfe dieser Schnittstelle die Eigenschaften eines Objekts bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="de990-119">For directory services that do not expose a schema, this interface allows you to manipulate the properties of an object.</span></span>
-   <span data-ttu-id="de990-120">Die [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) -Schnittstelle für nicht-Automatisierungs Clients.</span><span class="sxs-lookup"><span data-stu-id="de990-120">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface for non-Automation clients.</span></span> <span data-ttu-id="de990-121">Dabei wird das Protokoll über das Netzwerk für maximale Leistung verwendet und der Eigenschafts Cache umgangen.</span><span class="sxs-lookup"><span data-stu-id="de990-121">This uses over-the-wire protocol for maximum performance and bypasses the property cache.</span></span>
-   <span data-ttu-id="de990-122">Die [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="de990-122">The [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span> <span data-ttu-id="de990-123">Jedes Active Directory Objekt verfügt über einen übergeordneten Container, der seine Lebensdauer steuert.</span><span class="sxs-lookup"><span data-stu-id="de990-123">Every Active Directory object has a parent container that controls its lifetime.</span></span> <span data-ttu-id="de990-124">Beachten Sie, dass sich [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) bei ADS-Container Objekten nur auf die Container Eigenschaften und nicht auf ihren Inhalt auswirkt.</span><span class="sxs-lookup"><span data-stu-id="de990-124">Be aware that for ADs container objects, [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) affects only the container properties and not its contents.</span></span> <span data-ttu-id="de990-125">SetInfo on ADS Container Objects wirkt sich nur auf die Container Eigenschaften aus und wirkt sich nicht auf neu erstellte Objekte oder Objekte aus, die bereits im Container vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="de990-125">SetInfo on ADs container objects affects only the container properties and does not affect newly created objects or objects that already exist within the container.</span></span>
-   <span data-ttu-id="de990-126">Die [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="de990-126">The [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="de990-127">Dies ist die Automatisierungsschnittstelle für Sprachen wie Visual Basic Scripting Edition, die keine Kompilierzeit Bindung verwenden.</span><span class="sxs-lookup"><span data-stu-id="de990-127">This is the Automation interface for languages like Visual Basic Scripting Edition, that do not use compile-time binding.</span></span> <span data-ttu-id="de990-128">Dabei handelt es sich um die Typbibliotheks Daten, die von einem Anbieter bereitgestellt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="de990-128">Related to this is the type library data that a provider must supply.</span></span> <span data-ttu-id="de990-129">Weitere Informationen finden Sie unter [Implementierungsprobleme bei ADSI-Anbietern](implementation-issues-for-adsi-providers.md).</span><span class="sxs-lookup"><span data-stu-id="de990-129">For more information, see [Implementation Issues for ADSI Providers](implementation-issues-for-adsi-providers.md).</span></span>
-   <span data-ttu-id="de990-130">Ein Container Objekt der Schema Klasse und die entsprechenden Syntax-, Eigenschafts-und Schema Klassen Objekte, die [**iadssyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**iadsproperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)und [**iadsclass**](/windows/desktop/api/Iads/nn-iads-iadsclass) unterstützen.</span><span class="sxs-lookup"><span data-stu-id="de990-130">A schema class container object and the appropriate syntax, property, and schema class objects that support [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) respectively.</span></span> <span data-ttu-id="de990-131">Jeder Stamm Knoten muss mindestens ein eigenes Schema Klassencontainer-Objekt enthalten.</span><span class="sxs-lookup"><span data-stu-id="de990-131">At a minimum, each root node must contain its own schema class container object.</span></span>
-   <span data-ttu-id="de990-132">Die [**iadsmembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) -Schnittstelle, wenn unterstützte Attribute Sammlungen von ADSI-Objekten sind, z. b. Sicherheitsgruppen.</span><span class="sxs-lookup"><span data-stu-id="de990-132">The [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) interface, if any supported attributes are collections of ADSI objects, such as security groups.</span></span>
-   <span data-ttu-id="de990-133">Die [**iadscollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) -Schnittstelle, wenn es sich bei allen unterstützten Attributen um Auflistungen desselben Verzeichnis Elementtyps mit [**iadscollection:: Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) -und [**iadscollection:: Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) -Funktion handelt.</span><span class="sxs-lookup"><span data-stu-id="de990-133">The [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) interface, if any supported attributes are collections of the same directory element type with [**IADsCollection::Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) and [**IADsCollection::Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) capability.</span></span>
-   <span data-ttu-id="de990-134">Die **IEnumXXXX** -Enumeration unterstützt alle spezifischen Enumeratorobjekte.</span><span class="sxs-lookup"><span data-stu-id="de990-134">The **IEnumXXXX** enumeration supports all specific enumerator objects.</span></span>
-   <span data-ttu-id="de990-135">Routinen, um die Syntax zuzuordnen und systemeigene Daten in den [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) -Datentyp zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="de990-135">Routines to map syntax and convert native data to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) data type.</span></span>
-   <span data-ttu-id="de990-136">Befolgen Sie die ADSI-Konventionen für vom Anbieter bereitgestellte ADSI-Objekte.</span><span class="sxs-lookup"><span data-stu-id="de990-136">Follow ADSI conventions for provider-supplied ADSI objects.</span></span> <span data-ttu-id="de990-137">Einschließen von Hilfedateien und Typbibliotheken, die die Schnittstelleneigenschaften und-Methoden dokumentieren.</span><span class="sxs-lookup"><span data-stu-id="de990-137">Include help files and type libraries documenting the interface properties and methods.</span></span>

<span data-ttu-id="de990-138">Wie bei jeder com-Implementierung müssen Aufrufe von [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) **e \_ nointerface** für nicht implementierte Schnittstellen zurückgeben, **e \_ notifimpl** für nicht implementierte Methoden von Schnittstellen, die anderweitig implementiert werden und die e ADS-Eigenschaft zurückgeben, die für nicht implementierte Eigenschaften **\_ \_ \_ nicht \_ unterstützt** wird.</span><span class="sxs-lookup"><span data-stu-id="de990-138">As with any COM implementation, calls to [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) must return **E\_NOINTERFACE** for unimplemented interfaces, **E\_NOTIMPL** for unimplemented methods of interfaces that are otherwise implemented and return **E\_ADS\_PROPERTY\_NOT\_SUPPORTED** for unimplemented properties.</span></span> <span data-ttu-id="de990-139">Weitere Informationen über duale Schnittstellen und deren Auswirkung auf die Eigenschaften Implementierung finden Sie unter [duale Schnittstellen](dual-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="de990-139">For more information about dual interfaces and how they affect property implementation, see [Dual Interfaces](dual-interfaces.md).</span></span>

 

 