---
title: ADSI-Schema Modell
description: Ein Schema ähnelt einem Wörterbuch darin, dass es die Definition aller Typen von Objekten enthält, die einem Verzeichnisdienst bekannt sind.
ms.assetid: 70561a11-1560-4b1c-a999-e2a7b2002ab0
ms.tgt_platform: multiple
keywords:
- ADSI-Schema Modell ADSI
- ADSI ADSI, Info, Schema
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 23eec9264ae2692952106802cc06cbad937a42a9
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "103949109"
---
# <a name="adsi-schema-model"></a><span data-ttu-id="18ddc-105">ADSI-Schema Modell</span><span class="sxs-lookup"><span data-stu-id="18ddc-105">ADSI Schema Model</span></span>

<span data-ttu-id="18ddc-106">Ein Schema ähnelt einem Wörterbuch darin, dass es die Definition aller Typen von Objekten enthält, die einem Verzeichnisdienst bekannt sind.</span><span class="sxs-lookup"><span data-stu-id="18ddc-106">A schema is similar to a dictionary in that it holds the definition of every type of object known to a directory service.</span></span> <span data-ttu-id="18ddc-107">ADSI-Client Anwendungen können ein Schema durchsuchen, um die Funktionen einer beliebigen ADSI-Implementierung zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="18ddc-107">ADSI client applications can browse through a schema to discover the features of any given ADSI implementation.</span></span> <span data-ttu-id="18ddc-108">Außerdem bietet ADSI Schema Verwaltungs Schnittstellen, die für die Kommunikation mit dem zugrunde liegenden Schema eines Verzeichnis Dienstanbieters verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="18ddc-108">In addition, ADSI supplies schema management interfaces that can be used to communicate with a directory service's underlying schema.</span></span>

<span data-ttu-id="18ddc-109">Einige Schemas sind erweiterbare und ADSI-Anbieter oder Drittanbieter können neue Schnittstellen oder zusätzliche Eigenschaften für vorhandene Schnittstellen dort veröffentlichen.</span><span class="sxs-lookup"><span data-stu-id="18ddc-109">Some schemas are extensible and ADSI providers or third-party suppliers may choose to publish new interfaces or additional properties for existing interfaces there.</span></span> <span data-ttu-id="18ddc-110">ADSI-Clients verwenden diese Daten, um zu bestimmen, welche Funktionen für die einzelnen Verzeichnisdienste unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="18ddc-110">ADSI clients use this data to determine what features are supported for each directory service.</span></span>

<span data-ttu-id="18ddc-111">Es gibt drei Arten von Schema Objekten: Klassen, Eigenschaften und Syntaxen, die jeweils die Schema Verwaltungs Schnittstellen [**iadsclass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**iadsproperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)und [**iadssyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax)unterstützen.</span><span class="sxs-lookup"><span data-stu-id="18ddc-111">There are three kinds of schema objects: classes, properties, and syntaxes, each respectively supporting the schema management interfaces [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span>

> [!Note]  
> <span data-ttu-id="18ddc-112">Die Klasse ist ein überladener Begriff.</span><span class="sxs-lookup"><span data-stu-id="18ddc-112">Class is an overloaded term.</span></span> <span data-ttu-id="18ddc-113">Es gibt C++-Klassen, Java-Klassen, com-Klassen und ADSI-Klassen.</span><span class="sxs-lookup"><span data-stu-id="18ddc-113">There are C++ classes, Java classes, COM classes, and ADSI classes.</span></span> <span data-ttu-id="18ddc-114">In diesem Dokument bezieht sich die Word-Klasse, sofern nicht anders qualifiziert, auf eine Kategorie oder einen Typ von Schema Objekten.</span><span class="sxs-lookup"><span data-stu-id="18ddc-114">In this document, the word class, unless otherwise qualified, refers to a category or type of schema object.</span></span>

 

<span data-ttu-id="18ddc-115">ADSI abstrahiert das Schema aller Verzeichnisdienste und platziert es in jedem Stamm Knoten der obersten Ebene im **Namespace** -Objekt.</span><span class="sxs-lookup"><span data-stu-id="18ddc-115">ADSI abstracts the schema of every directory service and places it in every top-level root node in the **Namespace** object.</span></span> <span data-ttu-id="18ddc-116">Um zu ermitteln, welche Klassen ein Verzeichnisdienst für einen bestimmten Stamm Knoten unterstützt, können Sie das Schema Objekt auflisten und eine Liste von Klassen Objekten, Eigenschafts Objekten und Syntax Objekten erhalten.</span><span class="sxs-lookup"><span data-stu-id="18ddc-116">To identify what classes a directory service supports on a given root-node, you enumerate the schema object and get a list of class objects, property objects, and syntax objects.</span></span> <span data-ttu-id="18ddc-117">Weitere Informationen finden Sie unter [Verwenden des ADSI-Schemas](using-the-adsi-schema.md).</span><span class="sxs-lookup"><span data-stu-id="18ddc-117">For more information, see [Using the ADSI Schema](using-the-adsi-schema.md).</span></span>

## <a name="adsi-ldap-provider-schema-cache"></a><span data-ttu-id="18ddc-118">Schema Cache des ADSI LDAP-Anbieters</span><span class="sxs-lookup"><span data-stu-id="18ddc-118">ADSI LDAP Provider Schema Cache</span></span>

<span data-ttu-id="18ddc-119">Der LDAP-Anbieter für ADSI versucht, Schema Daten auf dem lokalen Computer zwischenzuspeichern.</span><span class="sxs-lookup"><span data-stu-id="18ddc-119">The LDAP provider for ADSI attempts to cache schema data to the local computer.</span></span> <span data-ttu-id="18ddc-120">Ein unter Schema wird durch einen Distinguished Name identifiziert, der im [**subschemasubentry**](/windows/desktop/ADSchema/a-subschemasubentry) -Attribut gespeichert ist, das sich im Stammverzeichnis des Verzeichnisdienst Enterprise (RootDSE) befindet.</span><span class="sxs-lookup"><span data-stu-id="18ddc-120">A subschema is identified by a distinguished name stored in the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute located in the root of the directory service enterprise (rootDSE).</span></span> <span data-ttu-id="18ddc-121">Zusätzlich zur Bereitstellung der unter Schema Daten sollten LDAP-V3-Server ein [**modifytimestamp**](/windows/desktop/ADSchema/a-modifytimestamp) -Attribut verfügbar machen, mit dem bestimmt wird, wann das Schema zuletzt geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="18ddc-121">In addition to providing the subschema data, LDAP v3 servers should expose a [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute that is used to determine the last time the schema was modified.</span></span>

<span data-ttu-id="18ddc-122">Wenn ADSI zuerst eine Bindung an den LDAP-Server herstellt, ruft es die unter Schema Daten mithilfe des [**subschemasubentry**](/windows/desktop/ADSchema/a-subschemasubentry) -Attributs ab.</span><span class="sxs-lookup"><span data-stu-id="18ddc-122">When ADSI first binds to the LDAP server, it retrieves the subschema data using the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute.</span></span> <span data-ttu-id="18ddc-123">Wenn ADSI das unter Schema Objekt nicht finden kann, speichert es einen Zeiger auf die Daten in der Registrierung auf dem Computer, der eine Verbindung mit dem LDAP-Server herstellt.</span><span class="sxs-lookup"><span data-stu-id="18ddc-123">If ADSI succeeds in finding the subschema object, it stores a pointer to the data in the registry on the computer that is connecting to the LDAP server.</span></span> <span data-ttu-id="18ddc-124">Informationen dazu, wo diese Werte genau in der Registrierung gespeichert sind, finden Sie unter [ADSI und Benutzerkontensteuerung](adsi-and-uac.md).</span><span class="sxs-lookup"><span data-stu-id="18ddc-124">For information on exactly where these values are stored in the registry, see [ADSI and User Account Control](adsi-and-uac.md).</span></span>

<span data-ttu-id="18ddc-125">ADSI versucht dann, die Schema Daten zu verarbeiten und liest das [**modifytimestamp**](/windows/desktop/ADSchema/a-modifytimestamp) -Attribut.</span><span class="sxs-lookup"><span data-stu-id="18ddc-125">ADSI then attempts to process the schema data and reads the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="18ddc-126">Wenn das **modifytimestamp** -Attribut vorhanden ist und ADSI das Schema erfolgreich verarbeitet hat, schreibt ADSI das unter Schema auf den Datenträger und erstellt die beiden folgenden Registrierungs Werte unter dem Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="18ddc-126">If the **modifyTimeStamp** attribute exists and ADSI successfully processes the schema, ADSI writes the subschema to disk and creates the two following registry values under the key.</span></span> <span data-ttu-id="18ddc-127">Wenn die unter Schema Daten vorhanden sind, aber nicht verarbeitet werden können, werden keine dieser Registrierungs Werte erstellt:</span><span class="sxs-lookup"><span data-stu-id="18ddc-127">If the subschema data exists, but cannot be processed, neither of these registry values is created:</span></span>

-   <span data-ttu-id="18ddc-128">Ein **Uhrzeitwert** , der das [**modifytimestamp**](/windows/desktop/ADSchema/a-modifytimestamp) -Attribut enthält.</span><span class="sxs-lookup"><span data-stu-id="18ddc-128">A **Time** value, which contains the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="18ddc-129">Dieser Wert wird verwendet, um sicherzustellen, dass die Schema Daten aktuell sind, und verhindert das Konstante erneute Laden der Schema Daten.</span><span class="sxs-lookup"><span data-stu-id="18ddc-129">This value is used to ensure that the schema data is current and prevents the constant reloading of the schema data.</span></span>
-   <span data-ttu-id="18ddc-130">Ein **Dateiwert** , der den Pfad enthält, unter dem ADSI die Schema Daten im Dateisystem speichert.</span><span class="sxs-lookup"><span data-stu-id="18ddc-130">A **File** value, which contains the path to where ADSI stores the schema data in the file system.</span></span> <span data-ttu-id="18ddc-131">Standardmäßig speichert ADSI das unter Schema im Verzeichnis " <systemroot> \\ schcache" mit einem Dateinamen, der dem Namen des LDAP-Servers entspricht.</span><span class="sxs-lookup"><span data-stu-id="18ddc-131">By default, ADSI caches the subschema in the <systemroot>\\SchCache directory with a file name corresponding to the name of the LDAP server.</span></span>

<span data-ttu-id="18ddc-132">Wenn die unter Schema Daten verarbeitet werden können, aber kein [**modifytimestamp**](/windows/desktop/ADSchema/a-modifytimestamp) -Attribut verfügbar gemacht wird, werden die Schema Daten im Arbeitsspeicher zwischengespeichert, aber nicht auf den Datenträger geschrieben.</span><span class="sxs-lookup"><span data-stu-id="18ddc-132">If the subschema data can be processed, but no [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute is exposed, the schema data is cached in memory, but not written to disk.</span></span> <span data-ttu-id="18ddc-133">Wenn ein LDAP-V3-Server über ADSI auf dem lokalen Computer kontaktiert wurde und kein zwischengespeichertes unter Schema vorhanden ist, hat dies wahrscheinlich einen der folgenden Gründe:</span><span class="sxs-lookup"><span data-stu-id="18ddc-133">If an LDAP v3 server has been contacted through ADSI on the local computer and a cached subschema is not present, it is most likely for one of the following reasons:</span></span>

-   <span data-ttu-id="18ddc-134">Der Server hat die richtigen Eigenschaften nicht verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="18ddc-134">The server did not expose the correct properties.</span></span>
-   <span data-ttu-id="18ddc-135">ADSI konnte das Schema nicht verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="18ddc-135">ADSI was unable to process the schema.</span></span>
-   <span data-ttu-id="18ddc-136">ADSI konnte die Datei nicht in das Dateisystem schreiben.</span><span class="sxs-lookup"><span data-stu-id="18ddc-136">ADSI was unable to write the file to the file system.</span></span>

 

 