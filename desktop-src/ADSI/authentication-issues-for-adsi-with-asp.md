---
title: Authentifizierungs Probleme bei ADSI mit ASP
description: Abhängig von der Konfiguration Ihres Intranets können Authentifizierungs Probleme auftreten, wenn ADSI-Code auf einer ASP-Seite ausgeführt wird.
ms.assetid: 287e2e19-7da9-497b-bf46-595ff4755261
ms.tgt_platform: multiple
keywords:
- ADSI, ASP-Seiten, Authentifizierungs Probleme
- ADSI, Authentifizierung, ASP-Probleme
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423d1aa39006f89ca366423da9d135e00af45693
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730201"
---
# <a name="authentication-issues-for-adsi-with-asp"></a><span data-ttu-id="d40c4-105">Authentifizierungs Probleme bei ADSI mit ASP</span><span class="sxs-lookup"><span data-stu-id="d40c4-105">Authentication Issues for ADSI with ASP</span></span>

<span data-ttu-id="d40c4-106">Abhängig von der Konfiguration Ihres Intranets können Authentifizierungs Probleme auftreten, wenn ADSI-Code auf einer ASP-Seite ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d40c4-106">Depending on the configuration of your intranet, authentication issues may occur when ADSI code is run from an ASP page.</span></span>

<span data-ttu-id="d40c4-107">Die Authentifizierung für den Zugriff auf den Domänen Controller kann mithilfe der Delegierung angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="d40c4-107">Authentication to access the domain controller can be given using delegation.</span></span> <span data-ttu-id="d40c4-108">Durch die Delegierung kann ein Dienst als Benutzer fungieren, sodass er über diese Benutzer Anmelde Informationen auf eine Netzwerkressource zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="d40c4-108">Delegation permits a service to act as the user, so it can access a network resource using that user credentials.</span></span> <span data-ttu-id="d40c4-109">Wenn das Intranet dieser Konfiguration folgt, müssen Sie IIS für die Verwendung der Delegierung einrichten.</span><span class="sxs-lookup"><span data-stu-id="d40c4-109">If your intranet follows this configuration, you must set up IIS to use delegation.</span></span> <span data-ttu-id="d40c4-110">Legen Sie den IIS-Authentifizierungsmechanismus als anonym oder NTLM fest.</span><span class="sxs-lookup"><span data-stu-id="d40c4-110">Set the IIS Authentication mechanism as Anonymous or NTLM.</span></span> <span data-ttu-id="d40c4-111">Wenn Sie anonym auswählen, wird der Sicherheitskontext dem IUSR- \_ Computer Konto zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="d40c4-111">If you choose anonymous, your security context will be mapped to IUSR\_MACHINE account.</span></span> <span data-ttu-id="d40c4-112">Wenn Sie NTLM auswählen, ändert sich der Sicherheitskontext, je nachdem, welcher Benutzer sich bei Ihrer Website anmeldet.</span><span class="sxs-lookup"><span data-stu-id="d40c4-112">If you select NTLM, the security context will change, depending on which user logs on to your website.</span></span> <span data-ttu-id="d40c4-113">Weitere Informationen und Anweisungen zum Einrichten des IIS-Servers für die Delegierung finden Sie unter [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).</span><span class="sxs-lookup"><span data-stu-id="d40c4-113">For more information and instructions for setting up the IIS server for delegation, see [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).</span></span>

<span data-ttu-id="d40c4-114">Wenn Sie einen IIS-Server verwenden, der NT Challenge/Response verwendet, oder einen Browser Client, der Kerberos nicht unterstützt, wird die Doppel-Hop-Authentifizierung nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d40c4-114">If you are using a an IIS server that uses the NT challenge/response, or a browser client that does not support Kerberos, then double-hop authentication is not supported.</span></span> <span data-ttu-id="d40c4-115">Eine Double-Hop-Authentifizierung bedeutet, dass die Benutzer Anmelde Informationen vom Browser Client an den IIS-Server weitergegeben werden. Anschließend übergibt der IIS-Server die Anmelde Informationen an den Back-End-Server.</span><span class="sxs-lookup"><span data-stu-id="d40c4-115">Double-hop authentication means that the user credentials are passed from the browser client to the IIS server, and then the IIS server passes the credentials to the backend server.</span></span> <span data-ttu-id="d40c4-116">In dieser Situation können Sie eine der folgenden Lösungen verwenden, um den Zugriff auf das Verzeichnis von der ASP-Seite aus zuzulassen:</span><span class="sxs-lookup"><span data-stu-id="d40c4-116">In this situation, you can use one of the following solutions to allow access to the directory from the ASP page:</span></span>

-   <span data-ttu-id="d40c4-117">Verwenden Sie [**iadsopendsobject:: opendsobject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) oder [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) , um Anmelde Informationen an Active Directory zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="d40c4-117">Use [**IADsOpenDSObject::OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) to pass credentials to Active Directory.</span></span> <span data-ttu-id="d40c4-118">Die Webseite authentifiziert den verbundenen Benutzer mit dem IIS-Server.</span><span class="sxs-lookup"><span data-stu-id="d40c4-118">The webpage authenticates the connected user against the IIS server.</span></span> <span data-ttu-id="d40c4-119">Wenn der Benutzer authentifiziert wurde, kann die Webseite opendsobject oder ADsOpenObject verwenden, um einen Benutzernamen und ein Kennwort an den Verzeichnisdienst zu übergeben, um die Authentifizierung für den Back-End-Server zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="d40c4-119">When the user has been authenticated, the webpage can use OpenDSObject or ADsOpenObject to pass a user name and password to the directory service to obtain authentication to the backend server.</span></span> <span data-ttu-id="d40c4-120">Auf der Webseite kann dann auf Daten aus dem Verzeichnis zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="d40c4-120">The webpage can then access data from the directory.</span></span>
-   <span data-ttu-id="d40c4-121">Fügen Sie Ihren Code einem COM-Objekt hinzu, und platzieren Sie dieses Objekt in einer [com+-Anwendung](../cossdk/com--application-overview.md) (zuvor als MTS-Paket bezeichnet).</span><span class="sxs-lookup"><span data-stu-id="d40c4-121">Add your code to a COM object and put this object into a [COM+ application](../cossdk/com--application-overview.md) (previously called an MTS package).</span></span> <span data-ttu-id="d40c4-122">Die COM+-Anwendung kann dann als [Domänen Benutzerkonto](/windows/desktop/AD/domain-user-accounts)ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d40c4-122">The COM+ application can then be run as a [domain user account](/windows/desktop/AD/domain-user-accounts).</span></span>
-   <span data-ttu-id="d40c4-123">Verwenden Sie mehrere ASP-Seiten, bei denen eine Seite den Client authentifiziert und eine andere Seite Anmelde Informationen mithilfe der anonymen Authentifizierung für ein Domänen Benutzerkonto an das Verzeichnis übergibt.</span><span class="sxs-lookup"><span data-stu-id="d40c4-123">Use multiple ASP pages, where one page authenticates the client and another page passes credentials to the directory using anonymous authentication on a domain user account.</span></span>

<span data-ttu-id="d40c4-124">Diese Methoden umfassen das Authentifizieren des Webclients und das anschließende Ändern der Anmelde Informationen, wenn Sie sich an das Verzeichnis wenden, weil die Double-Hop-Authentifizierung mit denselben Anmelde Informationen nicht möglich ist.</span><span class="sxs-lookup"><span data-stu-id="d40c4-124">These methods involve authenticating the web client and then changing the credentials when contacting the directory because double-hop authentication, with the same credentials, is not possible.</span></span>

 

 