---
title: Suchen mit OLE DB
description: Für Automatisierungs Clients, die ActiveX Data Objects (ADO) und alle nicht-Automatisierungs Clients verwenden, liefert ADSI einen OLE DB-Anbieter, der eine Teilmenge von OLE DB Abfrageschnittstellen unterstützt.
ms.assetid: f4e48b60-82dd-4c39-879b-0bc8f40747d2
ms.tgt_platform: multiple
keywords:
- Suchen mit OLE DB ADSI
- fragt ADSI ab und sucht mit OLE DB
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 92b6b0c056a63174233271b9b059ebffa9d4d841
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730321"
---
# <a name="searching-with-ole-db"></a><span data-ttu-id="63522-105">Suchen mit OLE DB</span><span class="sxs-lookup"><span data-stu-id="63522-105">Searching with OLE DB</span></span>

<span data-ttu-id="63522-106">Für Automatisierungs Clients, die ActiveX Data Objects (ADO) und alle nicht-Automatisierungs Clients verwenden, liefert ADSI einen OLE DB-Anbieter, der eine Teilmenge von OLE DB Abfrageschnittstellen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="63522-106">For both Automation clients using ActiveX Data Objects (ADO) and all non-Automation clients, ADSI supplies an OLE DB provider that supports a subset of OLE DB query interfaces.</span></span> <span data-ttu-id="63522-107">Client Code, der bereits OLE DB-Schnittstellen für Abfragen verwendet, kann die gleichen Schnittstellen verwenden, um Verzeichnisdienste abzufragen.</span><span class="sxs-lookup"><span data-stu-id="63522-107">Client code that already uses OLE DB interfaces for queries can use the same interfaces to query directory services.</span></span>

<span data-ttu-id="63522-108">Unter der OLE DB-Implementierung wird ein Verzeichnisdienst als Datenquellen Objekt verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="63522-108">Under the OLE DB implementation, a directory service is exposed as a Data Source object.</span></span> <span data-ttu-id="63522-109">Datenquellen Objekte sind Factorys für Sitzungs Objekte und unterstützen [IDBInitialize](/previous-versions/windows/desktop/ms713706(v=vs.85)) zum Herstellen einer Verbindung mit dem Verzeichnis, [idbkreatesession](/previous-versions/windows/desktop/ms724076(v=vs.85)) zum Erstellen des Sitzungs Objekts, [IDBProperties](/previous-versions/windows/desktop/ms719607(v=vs.85)) zum Bereitstellen von Authentifizierungsdaten für den zugrunde liegenden Namespace und Bereitstellen des Abfrage Befehls und des [**ipersistent**](/windows/win32/api/objidl/nn-objidl-ipersist) zum Speichern der zum Erstellen des Datenquellen Objekts im zugrunde liegenden Verzeichnisdienst erforderlichen Daten.</span><span class="sxs-lookup"><span data-stu-id="63522-109">Data Source objects are factories for session objects and support [IDBInitialize](/previous-versions/windows/desktop/ms713706(v=vs.85)) to connect to the directory, [IDBCreateSession](/previous-versions/windows/desktop/ms724076(v=vs.85)) to create the session object, [IDBProperties](/previous-versions/windows/desktop/ms719607(v=vs.85)) to supply authentication data to the underlying namespace and supply the query command and [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist) to save the data necessary to create the data source object to the underlying directory service.</span></span>

<span data-ttu-id="63522-110">**So führen Sie eine Active Directory Abfrage mithilfe von aus OLE DB**</span><span class="sxs-lookup"><span data-stu-id="63522-110">**To perform an Active Directory query using OLE DB**</span></span>

1.  <span data-ttu-id="63522-111">Rufen Sie die [IDBInitialize](/previous-versions/windows/desktop/ms713706(v=vs.85)) -Schnittstelle vom OLE DB-Anbieter ab.</span><span class="sxs-lookup"><span data-stu-id="63522-111">Retrieve the [IDBInitialize](/previous-versions/windows/desktop/ms713706(v=vs.85)) interface from the OLE DB provider.</span></span> <span data-ttu-id="63522-112">Verwenden Sie im Fall von Active Directory den Klassen Bezeichner **CLSID \_ ADSDSOObject**.</span><span class="sxs-lookup"><span data-stu-id="63522-112">In the case of Active Directory, use the class identifier **CLSID\_ADsDSOObject**.</span></span>
2.  <span data-ttu-id="63522-113">Erstellen eines [DBPROP](/previous-versions/windows/desktop/ms717970(v=vs.85)) -Arrays mit Verbindungsdaten, die den Benutzernamen und das Kennwort angeben.</span><span class="sxs-lookup"><span data-stu-id="63522-113">Build a [DBPROP](/previous-versions/windows/desktop/ms717970(v=vs.85)) array of connection data specifying user name and password.</span></span>
3.  <span data-ttu-id="63522-114">Abfragen der [IDBInitialize](/previous-versions/windows/desktop/ms713706(v=vs.85)) -Schnittstelle, die in Schritt 1 für die [IDBProperties](/previous-versions/windows/desktop/ms719607(v=vs.85)) -Schnittstelle abgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="63522-114">Query the [IDBInitialize](/previous-versions/windows/desktop/ms713706(v=vs.85)) interface retrieved in Step 1 for the [IDBProperties](/previous-versions/windows/desktop/ms719607(v=vs.85)) interface.</span></span>
4.  <span data-ttu-id="63522-115">Nennen Sie die [IDBProperties:: SetProperties](/previous-versions/windows/desktop/ms723049(v=vs.85)) -Methode, und übergeben Sie das in Schritt 2 erstellte [DBPROP](/previous-versions/windows/desktop/ms717970(v=vs.85)) -Array.</span><span class="sxs-lookup"><span data-stu-id="63522-115">Call the [IDBProperties::SetProperties](/previous-versions/windows/desktop/ms723049(v=vs.85)) method passing in the [DBPROP](/previous-versions/windows/desktop/ms717970(v=vs.85)) array created in Step 2.</span></span>
5.  <span data-ttu-id="63522-116">Wenden Sie die [IDBInitialize:: Initialize](/previous-versions/windows/desktop/ms718026(v=vs.85)) -Methode an, um die Verbindung mit dem OLE DB-Anbieter herzustellen. Dabei handelt es sich um den Active Directory Anbieter, in diesem Fall.</span><span class="sxs-lookup"><span data-stu-id="63522-116">Call the [IDBInitialize::Initialize](/previous-versions/windows/desktop/ms718026(v=vs.85)) method to establish the connection to the OLE DB provider; that is the Active Directory provider, in this case.</span></span>
6.  <span data-ttu-id="63522-117">Fragen Sie die [IDBInitialize](/previous-versions/windows/desktop/ms713706(v=vs.85)) -Schnittstelle für die [idbkreatesession](/previous-versions/windows/desktop/ms724076(v=vs.85)) -Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="63522-117">Query the [IDBInitialize](/previous-versions/windows/desktop/ms713706(v=vs.85)) interface for the [IDBCreateSession](/previous-versions/windows/desktop/ms724076(v=vs.85)) interface.</span></span>
7.  <span data-ttu-id="63522-118">Aufrufen der [idbkreatesession:: | atesession](/previous-versions/windows/desktop/ms714942(v=vs.85)) -Methode, die eine neue Schnittstelle des Typs [idbkreatecommand](/previous-versions/windows/desktop/ms711625(v=vs.85))anfordert.</span><span class="sxs-lookup"><span data-stu-id="63522-118">Call the [IDBCreateSession::CreateSession](/previous-versions/windows/desktop/ms714942(v=vs.85)) method requesting a new interface of type [IDBCreateCommand](/previous-versions/windows/desktop/ms711625(v=vs.85)).</span></span>
8.  <span data-ttu-id="63522-119">Rufen Sie die [idbkreatecommand:: kreatecommand](/previous-versions/windows/desktop/ms709772(v=vs.85)) -Methode auf, um eine [ICommandText](/previous-versions/windows/desktop/ms714914(v=vs.85)) -Schnittstelle zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="63522-119">Call the [IDBCreateCommand::CreateCommand](/previous-versions/windows/desktop/ms709772(v=vs.85)) method to create an [ICommandText](/previous-versions/windows/desktop/ms714914(v=vs.85)) interface.</span></span>
9.  <span data-ttu-id="63522-120">Aufrufen der [ICommandText:: SetCommandText](/previous-versions/windows/desktop/ms709757(v=vs.85)) -Methode.</span><span class="sxs-lookup"><span data-stu-id="63522-120">Call the [ICommandText::SetCommandText](/previous-versions/windows/desktop/ms709757(v=vs.85)) method.</span></span> <span data-ttu-id="63522-121">Übergeben Sie den bevorzugten Dialekt und den eigentlichen Abfrage Befehls Text in diesem Dialekt.</span><span class="sxs-lookup"><span data-stu-id="63522-121">Pass in the preferred dialect and the actual query command text in that dialect.</span></span> <span data-ttu-id="63522-122">**DBGUID \_ ldapdialekt** oder **DBGUID \_ dbsql** kann als Dialekt verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="63522-122">Either **DBGUID\_LDAPDialect** or **DBGUID\_DBSQL** may be used as the dialect.</span></span>
10. <span data-ttu-id="63522-123">[Callicommand:: Execute](/previous-versions/windows/desktop/ms718095(v=vs.85)); eine [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) -Schnittstelle wird zurückgegeben, die die Schnittstelle zum Resultset ist.</span><span class="sxs-lookup"><span data-stu-id="63522-123">Call [ICommand::Execute](/previous-versions/windows/desktop/ms718095(v=vs.85)); an [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) interface is returned which is the interface to the result set.</span></span>
11. <span data-ttu-id="63522-124">Fragen Sie die [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) -Schnittstelle für die [IColumnsInfo](/previous-versions/windows/desktop/ms725401(v=vs.85)) -Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="63522-124">Query the [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) interface for the [IColumnsInfo](/previous-versions/windows/desktop/ms725401(v=vs.85)) interface.</span></span>
12. <span data-ttu-id="63522-125">Rufen Sie die [IColumnsInfo:: GetColumnInfo](/previous-versions/windows/desktop/ms722704(v=vs.85)) -Methode auf, um Spaltendaten zum Resultset abzurufen.</span><span class="sxs-lookup"><span data-stu-id="63522-125">Call the [IColumnsInfo::GetColumnInfo](/previous-versions/windows/desktop/ms722704(v=vs.85)) method to retrieve column data about the result set.</span></span>
13. <span data-ttu-id="63522-126">Auffüllen eines Arrays von [DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) -Strukturen, das dem OLE DB-Anbieter beschreibt, wie die Datentypen pro Spalte für den Anwendungscode verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="63522-126">Populate an array of [DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) structures, describing to the OLE DB provider how to expose the data types on a per-column basis to the application code.</span></span> <span data-ttu-id="63522-127">In diesem Schritt können Sie angeben, welcher Typ in einer bestimmten Spalte enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="63522-127">This step enables you to specify which TYPE is contained in a particular column.</span></span> <span data-ttu-id="63522-128">Außerdem werden die Offsets der Spalten relativ zur zurückgegebenen Zeile für spaltenweise festgelegt.</span><span class="sxs-lookup"><span data-stu-id="63522-128">Also the offsets of the columns, relative to the returned row, are set here on a column-by-column basis.</span></span>
14. <span data-ttu-id="63522-129">Fragen Sie die [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) -Schnittstelle für die [IAccessor](/previous-versions/windows/desktop/ms719672(v=vs.85)) -Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="63522-129">Query the [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) interface for the [IAccessor](/previous-versions/windows/desktop/ms719672(v=vs.85)) interface.</span></span>
15. <span data-ttu-id="63522-130">Aufrufen der [IAccessor:: deateaccessor](/previous-versions/windows/desktop/ms720969(v=vs.85)) -Methode, die ein Array von Accessorhandles zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="63522-130">Call the [IAccessor::CreateAccessor](/previous-versions/windows/desktop/ms720969(v=vs.85)) method, which returns an array of accessor handles.</span></span> <span data-ttu-id="63522-131">Dieses Array wird dann verwendet, um auf die Zeilen des Resultsets zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="63522-131">This array is then used to access the rows of the result set.</span></span>
16. <span data-ttu-id="63522-132">Wenden Sie [IRowset:: GetNextRows](/previous-versions/windows/desktop/ms709827(v=vs.85)) an, und übergeben Sie die Zeilen Handles und die Anzahl der abzurufenden Zeilen.</span><span class="sxs-lookup"><span data-stu-id="63522-132">Call [IRowset::GetNextRows](/previous-versions/windows/desktop/ms709827(v=vs.85)) passing in the row handles, and number of rows to get.</span></span>
17. <span data-ttu-id="63522-133">Aufrufen von [IRowset:: GetData](/previous-versions/windows/desktop/ms716988(v=vs.85)) , das ein Zeilen handle übergibt, aus dem in Schritt 16 zurückgegebenen Satz.</span><span class="sxs-lookup"><span data-stu-id="63522-133">Call [IRowset::GetData](/previous-versions/windows/desktop/ms716988(v=vs.85)) passing in a row handle, from the set returned in Step 16.</span></span> <span data-ttu-id="63522-134">Ein Rohdaten Zeiger auf die Zeile wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="63522-134">A raw pointer to the row is returned.</span></span>

<span data-ttu-id="63522-135">Weitere Informationen zur Suchfilter Syntax finden Sie unter [Syntax für Suchfilter](search-filter-syntax.md).</span><span class="sxs-lookup"><span data-stu-id="63522-135">For more information about the search filter syntax, see [Search Filter Syntax](search-filter-syntax.md).</span></span>

<span data-ttu-id="63522-136">Um die zurückgegebenen Daten der nicht verarbeiteten Zeilen zu lesen, verwenden Sie die in Schritt 13 erstellte [DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) -Struktur, um die Spalten Offsets in dem nicht verarbeiteten Datenzeiger zu berechnen, der in Schritt 17 zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="63522-136">To read the unprocessed row data returned, use the [DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) structure, created in Step 13, compute the column offsets in the unprocessed data pointer returned in Step 17.</span></span> <span data-ttu-id="63522-137">Lesen Sie den Status Teil der Spalte, um ein Abruf Ergebnis für diese Spalte zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="63522-137">Read the status portion of the column for a retrieval result on that column.</span></span>

<span data-ttu-id="63522-138">Weitere Informationen und ein Codebeispiel, das zeigt, wie Sie Active Directory mithilfe des ADSI OLE DB-Anbieters suchen, finden Sie unter [Beispielcode für die Verwendung OLE DB zum Durchsuchen von Active Directory](example-code-for-using-ole-db-to-search-active-directory.md).</span><span class="sxs-lookup"><span data-stu-id="63522-138">For more information and a code example that shows how to search Active Directory using the ADSI OLE DB provider, see [Example Code for Using OLE DB to Search Active Directory](example-code-for-using-ole-db-to-search-active-directory.md).</span></span>

 

 