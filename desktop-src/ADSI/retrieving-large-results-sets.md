---
title: Abrufen von großen Resultsets
description: Wenn die Möglichkeit besteht, dass das Resultset, das zurückgegeben wird, mehr als 1000 Elemente enthält, müssen Sie eine auslagerbare Suche verwenden.
ms.assetid: 1439d6b8-50dd-4d37-bcc9-dd0f63af865f
ms.tgt_platform: multiple
keywords:
- Abrufen von großen Resultsets ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78f8902d25010690953cfae8a03ff9e500b4ebda
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "106340402"
---
# <a name="retrieving-large-results-sets"></a><span data-ttu-id="f39eb-104">Abrufen von großen Resultsets</span><span class="sxs-lookup"><span data-stu-id="f39eb-104">Retrieving Large Results Sets</span></span>

<span data-ttu-id="f39eb-105">Wenn die Möglichkeit besteht, dass das Resultset, das zurückgegeben wird, mehr als 1000 Elemente enthält, müssen Sie eine auslagerbare Suche verwenden.</span><span class="sxs-lookup"><span data-stu-id="f39eb-105">When there is the possibility that the result set that will be returned will contain more than 1000 items, you must use a paged search.</span></span> <span data-ttu-id="f39eb-106">Suchen nach Active Directory, die ohne Paging ausgeführt werden, sind auf die Rückgabe von maximal den ersten 1000-Datensätzen beschränkt.</span><span class="sxs-lookup"><span data-stu-id="f39eb-106">Searches of Active Directory performed without paging are limited to returning a maximum of the first 1000 records.</span></span> <span data-ttu-id="f39eb-107">Bei einer seitenweise Suche wird das Resultset als einzelne Seiten dargestellt, die jeweils eine vorgegebene Anzahl von Ergebnis Einträgen enthalten.</span><span class="sxs-lookup"><span data-stu-id="f39eb-107">With a paged search, the result set is presented as individual pages, each containing a predetermined number of result entries.</span></span> <span data-ttu-id="f39eb-108">Bei dieser Art von Suche werden neue Seiten von Ergebnis Einträgen zurückgegeben, bis das Ende des Resultsets erreicht ist.</span><span class="sxs-lookup"><span data-stu-id="f39eb-108">With this type of search, new pages of result entries are returned until the end of the result set is reached.</span></span>

<span data-ttu-id="f39eb-109">Standardmäßig berechnet der Server, der auf eine Abfrage Anforderung antwortet, ein Resultset vollständig, bevor Daten zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="f39eb-109">By default, the server that responds to a query request completely calculates a result set before returning data.</span></span> <span data-ttu-id="f39eb-110">In einem großen Resultset erfordert dies den Server Arbeitsspeicher, wenn das Resultset abgerufen wird, und die Netzwerkbandbreite, wenn das große Ergebnis zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f39eb-110">In a large result set, this requires server memory as the result set is acquired, and network bandwidth when the large result is returned.</span></span> <span data-ttu-id="f39eb-111">Wenn Sie eine Seitengröße festlegen, kann der Server die Daten beim Erstellen der Seiten auf Seiten senden.</span><span class="sxs-lookup"><span data-stu-id="f39eb-111">Setting a page size allows the server to send the data in pages as the pages are being built.</span></span> <span data-ttu-id="f39eb-112">Der Client speichert dann diese Daten zwischen und stellt einen Cursor für den Code auf Anwendungsebene bereit.</span><span class="sxs-lookup"><span data-stu-id="f39eb-112">The client then caches this data and provides a cursor to the application level code.</span></span> <span data-ttu-id="f39eb-113">Paging wird festgelegt, indem definiert wird, wie viele Zeilen der Server berechnet, bevor die Daten über das Netzwerk an den Client zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="f39eb-113">Paging is set by defining how many rows the server calculates before the data is returned over the network to the client.</span></span>

<span data-ttu-id="f39eb-114">Das auslagerbare suchen bietet sowohl für den Client als auch den Server Vorteile.</span><span class="sxs-lookup"><span data-stu-id="f39eb-114">Paged searching offers benefits to both the client and the server.</span></span> <span data-ttu-id="f39eb-115">Beispielsweise kann der Client bei der Darstellung der Ergebnisse für Endbenutzer reaktionsfähiger sein.</span><span class="sxs-lookup"><span data-stu-id="f39eb-115">For example, the client can be more responsive in presenting the results to end users.</span></span> <span data-ttu-id="f39eb-116">Dies ist besonders für grafische Benutzeroberflächen Tools relevant, die Daten anzeigen können, während ein anderer Thread gleichzeitig weitere Daten vom Server empfängt.</span><span class="sxs-lookup"><span data-stu-id="f39eb-116">This is especially relevant for graphical user interface tools that can display data while another thread concurrently receives more data from the server.</span></span>

<span data-ttu-id="f39eb-117">Wenn Sie die Abfrage einrichten und eine Sortierreihenfolge für das Resultset angeben, muss der Server das Resultset vollständig berechnen, bevor die Daten an den Client zurückgegeben werden. Dies wirkt sich auf die Antwortzeit für die Abfrage aus.</span><span class="sxs-lookup"><span data-stu-id="f39eb-117">When you set up your query, if you specify a sort order for your result set, then the server must completely calculate the result set before returning the data to the client, which impacts the response time for the query.</span></span>

<span data-ttu-id="f39eb-118">Auf der Serverseite wird durch die seitenweise Suche der Vorgang skalierbar.</span><span class="sxs-lookup"><span data-stu-id="f39eb-118">On the server side, paged searching makes the operation scalable.</span></span> <span data-ttu-id="f39eb-119">Wenn z. b. 100 Clients Suchanforderungen gleichzeitig ausgeben und im Durchschnitt von jedem Client 200 Objekte zurückgegeben werden, muss der Server über genügend Arbeitsspeicher verfügen, um das gesamte Resultset von 20.000 Einträgen aufzunehmen, wenn die Seitengröße nicht angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="f39eb-119">For example, if one hundred clients issue search requests simultaneously and, on the average, each client is returned two hundred objects, if page size is not specified, the server must have sufficient memory to hold the complete result set of 20,000 entries.</span></span> <span data-ttu-id="f39eb-120">Wenn jeder Client beispielsweise eine Seitengröße von zehn Objekten angegeben hat, werden die Arbeitsspeicher Anforderungen auf dem Server um den Faktor 20 reduziert.</span><span class="sxs-lookup"><span data-stu-id="f39eb-120">Alternately, if each client specified a page size of ten objects, the memory requirements on the server would be reduced by a factor of 20.</span></span>

> [!Note]  
> <span data-ttu-id="f39eb-121">Nicht alle Verzeichnisdienste unterstützen auslagerbare Suchvorgänge.</span><span class="sxs-lookup"><span data-stu-id="f39eb-121">Not all directory services support paged searches.</span></span> <span data-ttu-id="f39eb-122">Active Directory implementiert die Architektur der Seitengröße.</span><span class="sxs-lookup"><span data-stu-id="f39eb-122">Active Directory implements page size architecture.</span></span>

 

<span data-ttu-id="f39eb-123">Viele Verzeichnisserver geben eine administrative Beschränkung für die maximale Anzahl von Objekten an, die zurückgegeben werden können, wenn ein Client die Seitengröße nicht angibt.</span><span class="sxs-lookup"><span data-stu-id="f39eb-123">Many directory servers specify an Administrative Limit for the maximum number of objects they can return if a client does not specify the page size.</span></span> <span data-ttu-id="f39eb-124">Wenn das Verwaltungs Limit erreicht ist, generiert ADSI den **Fehler \_ DS \_ Admin \_ Limit \_ überschritten** Win32.</span><span class="sxs-lookup"><span data-stu-id="f39eb-124">When the Administrative Limit is reached, ADSI generates the **ERROR\_DS\_ADMIN\_LIMIT\_EXCEEDED** Win32 error.</span></span>

<span data-ttu-id="f39eb-125">Auf der Clientseite ermöglicht eine seitenweise Suche einem Client, den Vorgang anzuhalten, während er noch ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="f39eb-125">On the client side, a paged search allows a client to stop the operation while it is still in progress.</span></span> <span data-ttu-id="f39eb-126">Im Gegensatz dazu wird der Client in einer nicht auslagerungssuche blockiert, bis die Daten vollständig zurückgegeben werden, oder es tritt ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="f39eb-126">By contrast, in a non-paged search, the client is blocked until the data is completely returned, or an error occurs.</span></span> <span data-ttu-id="f39eb-127">Dies kann sich auf die Netzwerkleistung auswirken, wenn sich das Resultset als größer erweist und mehr Zeit als erwartet dauert.</span><span class="sxs-lookup"><span data-stu-id="f39eb-127">This could impact network performance if the result set turns out to be larger and takes more time than expected.</span></span>

<span data-ttu-id="f39eb-128">Im Auftrag des Clients behandelt ADSI die Seitengröße transparent.</span><span class="sxs-lookup"><span data-stu-id="f39eb-128">On behalf of the client, ADSI handles the page size transparently.</span></span> <span data-ttu-id="f39eb-129">Der Client muss die Anzahl der aktuell ausgeführten Objekte nicht zählen.</span><span class="sxs-lookup"><span data-stu-id="f39eb-129">The client does not have to count the number of objects in progress.</span></span> <span data-ttu-id="f39eb-130">ADSI kapselt die Server Interaktion für den Client.</span><span class="sxs-lookup"><span data-stu-id="f39eb-130">ADSI encapsulates the server interaction for the client.</span></span> <span data-ttu-id="f39eb-131">Aus Sicht des Clients gibt die Suche ein umfassendes Resultset zurück.</span><span class="sxs-lookup"><span data-stu-id="f39eb-131">From the client perspective, the search returns a complete result set.</span></span>

<span data-ttu-id="f39eb-132">Weitere Informationen zur Verwendung der Such Timeout Option mit einer bestimmten Suchschnittstelle finden Sie unter:</span><span class="sxs-lookup"><span data-stu-id="f39eb-132">For more information about using the search time out option with a specific search interface, see:</span></span>

-   [<span data-ttu-id="f39eb-133">Paging mit idirector ysearch</span><span class="sxs-lookup"><span data-stu-id="f39eb-133">Paging with IDirectorySearch</span></span>](paging-with-idirectorysearch.md)
-   [<span data-ttu-id="f39eb-134">Suchen mit ActiveX Data Objects</span><span class="sxs-lookup"><span data-stu-id="f39eb-134">Searching with ActiveX Data Objects</span></span>](searching-with-activex-data-objects-ado.md)
-   [<span data-ttu-id="f39eb-135">Suchen mit OLE DB</span><span class="sxs-lookup"><span data-stu-id="f39eb-135">Searching with OLE DB</span></span>](searching-with-ole-db.md)

<span data-ttu-id="f39eb-136">Eine seitenweise Suche ist für Ihre Anwendung transparent, da ADSI automatisch weitere Ergebnisseiten abruft, bis das Ende des Resultsets oder das Ende des festgelegten Zeitraums erreicht ist.</span><span class="sxs-lookup"><span data-stu-id="f39eb-136">A paged search is transparent to your application because ADSI automatically continues to retrieve additional pages of results until it reaches the end of the result set or the end of the time limit that you set.</span></span> <span data-ttu-id="f39eb-137">Wenn Sie eine seitenweise Suche verwenden, wird die Seitengröße durch die Größenbeschränkung nicht überschrieben.</span><span class="sxs-lookup"><span data-stu-id="f39eb-137">When you use a paged search, the size limit does not override page size.</span></span> <span data-ttu-id="f39eb-138">Das Größenlimit kann nur verwendet werden, wenn Sie ein Resultset abrufen, das weniger als 1000 Einträge enthält.</span><span class="sxs-lookup"><span data-stu-id="f39eb-138">Size limit can only be used when you retrieve a result set that contains fewer than 1000 entries.</span></span>

 

 




