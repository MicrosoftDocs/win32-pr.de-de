---
title: ADSI-Erweiterungs Architektur
description: ADSI-Erweiterungen basieren auf dem com-Aggregations Modell mit mehreren Erweiterungen. Erweiterungen müssen allen com-Regeln entsprechen. Weitere Informationen finden Sie in der com-Spezifikation.
ms.assetid: 59e39273-1f66-4bdd-89ed-31947a268d1f
ms.tgt_platform: multiple
keywords:
- Erweiterungen ADSI, Erweiterungs Architektur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 377409f4b9ac36d72d6885e89860b9e6e680b103
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730288"
---
# <a name="adsi-extension-architecture"></a><span data-ttu-id="0072b-106">ADSI-Erweiterungs Architektur</span><span class="sxs-lookup"><span data-stu-id="0072b-106">ADSI Extension Architecture</span></span>

<span data-ttu-id="0072b-107">ADSI-Erweiterungen basieren auf dem com-Aggregations Modell mit mehreren Erweiterungen.</span><span class="sxs-lookup"><span data-stu-id="0072b-107">ADSI extensions are based on the COM aggregation model with several enhancements.</span></span> <span data-ttu-id="0072b-108">Erweiterungen müssen allen com-Regeln entsprechen.</span><span class="sxs-lookup"><span data-stu-id="0072b-108">Extensions must adhere to all COM rules.</span></span> <span data-ttu-id="0072b-109">Weitere Informationen finden Sie in der com-Spezifikation.</span><span class="sxs-lookup"><span data-stu-id="0072b-109">For more information, see the COM specification.</span></span>

<span data-ttu-id="0072b-110">Im folgenden finden Sie eine Überprüfung des com-Aggregations Modells.</span><span class="sxs-lookup"><span data-stu-id="0072b-110">Here is a review of the COM aggregation model.</span></span>

![com-Aggregations Modell](images/comagmod.png)

<span data-ttu-id="0072b-112">Ein Aggregat, das auch als Inneres Objekt bezeichnet wird, ist ein Objekt, das von einem Aggregator erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="0072b-112">An aggregate, also known as an inner object, is an object that an aggregator creates.</span></span> <span data-ttu-id="0072b-113">Das Erweiterungs Objekt ist ein Aggregat.</span><span class="sxs-lookup"><span data-stu-id="0072b-113">Your extension object is an aggregate.</span></span>

<span data-ttu-id="0072b-114">Ein Aggregator, auch als Äußeres Objekt bezeichnet, ist ein Objekt, das ein Aggregat erstellt.</span><span class="sxs-lookup"><span data-stu-id="0072b-114">An aggregator, also known as an outer object, is an object that creates an aggregate.</span></span> <span data-ttu-id="0072b-115">ADSI ist ein Aggregator.</span><span class="sxs-lookup"><span data-stu-id="0072b-115">ADSI is an aggregator.</span></span>

<span data-ttu-id="0072b-116">Das innere Objekt delegiert seine [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) an die **IUnknown** des Aggregators.</span><span class="sxs-lookup"><span data-stu-id="0072b-116">The inner object delegates its [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) to the aggregator's **IUnknown**.</span></span>

<span data-ttu-id="0072b-117">ADSI-Erweiterungen fügen die folgenden Erweiterungen zu com-Aggregationen hinzu, um die Anforderungen zu erfüllen:</span><span class="sxs-lookup"><span data-stu-id="0072b-117">ADSI extensions add the following enhancements to COM aggregation to satisfy its requirements:</span></span>

-   <span data-ttu-id="0072b-118">Ermöglicht jedem erweiterungswriter das Erweitern von ADSI-Objekten.</span><span class="sxs-lookup"><span data-stu-id="0072b-118">Enables each extension writer to extend ADSI objects.</span></span> <span data-ttu-id="0072b-119">Ein erweiterungswriter kann seine Erweiterung bei ADSI registrieren und nicht durch das vorhanden sein anderer Erweiterungen beeinträchtigt werden.</span><span class="sxs-lookup"><span data-stu-id="0072b-119">An extension writer can register its extension with ADSI and not be affected by the existence of other extensions.</span></span> <span data-ttu-id="0072b-120">Im com-Aggregations Modell muss der Aggregator über die CLSID des Aggregats verfügen.</span><span class="sxs-lookup"><span data-stu-id="0072b-120">In the COM aggregation model, the aggregator must have the aggregate's CLSID.</span></span> <span data-ttu-id="0072b-121">ADSI lockert diese Anforderung, indem er als Aggregator für alle Erweiterungen fungiert.</span><span class="sxs-lookup"><span data-stu-id="0072b-121">ADSI relaxes this requirement by making itself act as the aggregator for all extensions.</span></span> <span data-ttu-id="0072b-122">Daher befinden sich die Erweiterungen nicht auf derselben Ebene, anstatt eine Schicht von untergeordneten Komponenten zu bilden.</span><span class="sxs-lookup"><span data-stu-id="0072b-122">Therefore, instead of forming a layer of nested components, extensions are at the same level.</span></span>
-   <span data-ttu-id="0072b-123">Ermöglicht ein Objekt, ein IDispatch.</span><span class="sxs-lookup"><span data-stu-id="0072b-123">Allows one object, one IDispatch.</span></span> <span data-ttu-id="0072b-124">Automation-Unterstützung ist eines der wichtigsten Features von ADSI.</span><span class="sxs-lookup"><span data-stu-id="0072b-124">Automation support is one of the most important features of ADSI.</span></span> <span data-ttu-id="0072b-125">Automation-Unterstützung wird erzielt, da ADSI die [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) -Schnittstelle unterstützt.</span><span class="sxs-lookup"><span data-stu-id="0072b-125">Automation support is achieved because ADSI supports the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="0072b-126">Erweiterungs Schreiber wird empfohlen, die **IDispatch** -Schnittstelle zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="0072b-126">Extension writers are encouraged to support the **IDispatch** interface.</span></span> <span data-ttu-id="0072b-127">Es darf jedoch nur eine **IDispatch** -Schnittstelle für ein bestimmtes Objekt vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="0072b-127">However, there should be only one **IDispatch** interface on a given object.</span></span> <span data-ttu-id="0072b-128">ADSI integriert und sammelt die vielen **IDispatch** -Schnittstellen aus unterschiedlichen Erweiterungen und stellt Sie als eine konsistente **IDispatch** -Schnittstelle für den Automatisierungs Controller dar.</span><span class="sxs-lookup"><span data-stu-id="0072b-128">ADSI integrates and collects the many **IDispatch** interfaces from different extensions and presents them as one consistent **IDispatch** to the Automation controller.</span></span> <span data-ttu-id="0072b-129">Jede Erweiterung muss, wenn Sie aggregiert wird, Ihre **IDispatch** -Aufrufe an das von ADSI bereitgestellte **IDispatch** umleiten.</span><span class="sxs-lookup"><span data-stu-id="0072b-129">Each extension, when aggregated, must re-route its **IDispatch** calls to the **IDispatch** provided by ADSI.</span></span>

<span data-ttu-id="0072b-130">Diese Lösungen sind aufgrund der Dienste möglich, die der ADSI-Objekt-Manager bereitstellt, die sich auf jedem ADSI-Anbieter befinden.</span><span class="sxs-lookup"><span data-stu-id="0072b-130">All these solutions are possible because of services that the ADSI Object Manager provides, which reside on each ADSI provider.</span></span>

<span data-ttu-id="0072b-131">Die folgende Abbildung zeigt die Architektur des ADSI-Erweiterungs Modells.</span><span class="sxs-lookup"><span data-stu-id="0072b-131">The following figure shows the ADSI Extension Model architecture.</span></span>

![Architektur des ADSI-Erweiterungs Modells](images/adsiexmo.png)

<span data-ttu-id="0072b-133">ADSI unterstützt zwei Ebenen der Erweiterung:</span><span class="sxs-lookup"><span data-stu-id="0072b-133">ADSI supports two levels of extension:</span></span>

-   <span data-ttu-id="0072b-134">Unterstützung für frühe Bindung.</span><span class="sxs-lookup"><span data-stu-id="0072b-134">Early Binding Support.</span></span> <span data-ttu-id="0072b-135">Dies ist die erste Erweiterungs Ebene.</span><span class="sxs-lookup"><span data-stu-id="0072b-135">This is the first level of extension.</span></span> <span data-ttu-id="0072b-136">Eine Erweiterung muss die Registrierung unterstützen und neue Schnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="0072b-136">An extension must support registration and implement new interfaces.</span></span> <span data-ttu-id="0072b-137">Die Erweiterungs Consumer müssen Tools oder Skript Hosts verwenden, die eine frühe Bindung unterstützen, z. b. Visual C++ Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="0072b-137">The extension consumers must use tools or scripting hosts that support early binding, for example, Visual C++ , Visual Basic.</span></span>
-   <span data-ttu-id="0072b-138">Späterer Bindungs Support.</span><span class="sxs-lookup"><span data-stu-id="0072b-138">Late Binding Support.</span></span> <span data-ttu-id="0072b-139">Dies geschieht, wenn eine Erweiterung alle frühen Bindungs Anforderungen erfüllt und eine zusätzliche Schnittstelle ( [**iadsextension**](/windows/desktop/api/Iads/nn-iads-iadsextension)) implementiert.</span><span class="sxs-lookup"><span data-stu-id="0072b-139">This happens when an extension satisfies all early binding requirements, and implements an additional interface, [**IADsExtension**](/windows/desktop/api/Iads/nn-iads-iadsextension).</span></span> <span data-ttu-id="0072b-140">Erweiterungs Implementierer können jedes Tool verwenden, das als Automatisierungs Controller fungiert, wie z. b. den Windows Script Host, Active Server Seiten oder HTML mit VBScript.</span><span class="sxs-lookup"><span data-stu-id="0072b-140">Extension implementers can use any tool that operates as an Automation controller, such as the Windows Script Host, Active Server Pages, or HTML with VBScript.</span></span>

 

 