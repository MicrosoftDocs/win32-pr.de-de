---
title: Implementierungsprobleme bei ADSI-Anbietern
description: Implementierungsprobleme bei ADSI-Anbietern
ms.assetid: 0be772aa-e7d8-4d34-b55a-162abfb0bfd4
ms.tgt_platform: multiple
keywords:
- Implementierungsprobleme für ADSI-Anbieter ADSI
- Anbieter ADSI, implementieren
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4c362b04244580e448e7bb7bd78889e66db12fe
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104391023"
---
# <a name="implementation-issues-for-adsi-providers"></a><span data-ttu-id="37091-105">Implementierungsprobleme bei ADSI-Anbietern</span><span class="sxs-lookup"><span data-stu-id="37091-105">Implementation Issues for ADSI Providers</span></span>

<span data-ttu-id="37091-106">Implementieren Sie zum Implementieren von ADSI-Schnittstellen zuerst die COM-Schnittstelle [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span><span class="sxs-lookup"><span data-stu-id="37091-106">To implement ADSI interfaces, first implement the COM interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span></span> <span data-ttu-id="37091-107">Wenn Sie diese Schnittstelle als minimale Verwaltungsebene bereitstellen, stellen Sie Client Anwendungen das Steuerelement bereit, das für den Zugriff auf Verzeichnisobjekte direkt aus dem Verzeichnis und nicht über den ADSI-Cache benötigt wird. Dadurch wird die Netzwerkleistung optimiert.</span><span class="sxs-lookup"><span data-stu-id="37091-107">By providing this interface as a minimal overhead layer, you supply client applications the control required to access directory objects directly from the directory rather than through the ADSI cache, which optimizes network performance.</span></span> <span data-ttu-id="37091-108">Durch die Verwendung dieser Schnittstelle wird auch Ihre eigene Implementierung mit der höchsten Flexibilität bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="37091-108">Using this interface will also supply your own implementation with the most flexibility.</span></span>

<span data-ttu-id="37091-109">Implementieren Sie zweitens die grundlegenden ADSI-Schnittstellen, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**iadscollection**](/windows/desktop/api/Iads/nn-iads-iadscollection)und die [**iadspropertyvalue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue)-, [**iadspropertyentry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry)-, [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) -Eigenschaften Cache Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="37091-109">Second, implement the fundamental ADSI interfaces, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection), and the [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) property cache interfaces.</span></span> <span data-ttu-id="37091-110">[**IADsGroup**](/windows/desktop/api/Iads/nn-iads-iadsgroup) und [**iadsmembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) sind auch Schnittstellen, die häufig von der System Verwaltungssoftware abhängig sind.</span><span class="sxs-lookup"><span data-stu-id="37091-110">[**IADsGroup**](/windows/desktop/api/Iads/nn-iads-iadsgroup) and [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) are also interfaces in frequent demand by system administration software.</span></span>

<span data-ttu-id="37091-111">Implementieren Sie Drittens die Schema Verwaltungs Schnittstellen, wenn Ihr Verzeichnisdienst über ein zugrunde liegendes Schema verfügt: [**iadsclass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**iadsproperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**iadssyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span><span class="sxs-lookup"><span data-stu-id="37091-111">Third, implement the schema management interfaces if your directory service has an underlying schema: [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span> <span data-ttu-id="37091-112">Wenn kein zugrunde liegendes Schema vorhanden ist, verwenden Sie diese Schnittstellen, um die vom Verzeichnisdienst verwendeten Klassen und Eigenschaften zu abstrahieren.</span><span class="sxs-lookup"><span data-stu-id="37091-112">If there is no underlying schema, use these interfaces to abstract the classes and properties used by the directory service.</span></span> <span data-ttu-id="37091-113">Schemas können zum Veröffentlichen der Features Ihres Verzeichnis Dienstanbieter auf ADSI-Clients verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="37091-113">Schemas can be used to publish the features of your directory service to ADSI clients.</span></span>

## <a name="collections"></a><span data-ttu-id="37091-114">Sammlungen</span><span class="sxs-lookup"><span data-stu-id="37091-114">Collections</span></span>

<span data-ttu-id="37091-115">ADSI-Anbieter Komponenten können einem von drei Modellen zum Zwischenspeichern von Auflistungen während der Enumeration folgen.</span><span class="sxs-lookup"><span data-stu-id="37091-115">ADSI provider components can follow one of three models for caching collections during enumeration.</span></span> <span data-ttu-id="37091-116">Die Auswahl eines cachingmodells bestimmt das Verhalten von ADSI, wenn ein Objekt in einer Sammlung aus dem zugrunde liegenden Verzeichnisdienst außerhalb von ADSI gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="37091-116">The choice of a caching model determines the behavior of ADSI when an object in a collection is deleted from the underlying directory service external to ADSI.</span></span>

<span data-ttu-id="37091-117">Die cachingmodelle umfassen Folgendes:</span><span class="sxs-lookup"><span data-stu-id="37091-117">The caching models include:</span></span>

-   <span data-ttu-id="37091-118">Im Voraus zwischengespeicherte Sammlungen.</span><span class="sxs-lookup"><span data-stu-id="37091-118">Collections cached in advance.</span></span> <span data-ttu-id="37091-119">Die Auflistung von Objektinstanzen wird vollständig aus dem zugrunde liegenden Verzeichnisdienst abgerufen, wenn [**iadscollection:: get \_ \_ NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) aufgerufen wird, um ein neues Enumeratorobjekt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="37091-119">The collection of object instances is retrieved from the underlying directory service in its entirety when [**IADsCollection::get\_\_NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) is called to create a new enumerator object.</span></span> <span data-ttu-id="37091-120">Wenn das Quell Objekt für eine Active Directory Objektinstanz in der abgerufenen Sammlung aus dem zugrunde liegenden Verzeichnisdienst gelöscht wird, erkennt der Client den Löschvorgang erst, wenn ein [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) oder [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) auf die Auflistung zugreift.</span><span class="sxs-lookup"><span data-stu-id="37091-120">If the source object for an Active Directory object instance in the retrieved collection is deleted from the underlying directory service, the client does not recognize the deletion until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the collection.</span></span>
-   <span data-ttu-id="37091-121">Sammlungen werden inkrementell zwischengespeichert</span><span class="sxs-lookup"><span data-stu-id="37091-121">Collections incrementally cached.</span></span> <span data-ttu-id="37091-122">Die Auflistung wird von dem zugrunde liegenden Verzeichnisdienst ein Objekt zu einem Zeitpunkt abgerufen, wenn [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="37091-122">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="37091-123">[**IEnumVARIANT:: Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) kehrt zum Anfang der Auflistung im Cache zurück, und **IEnumVARIANT:: Next** gibt zwischengespeicherte Objekte zurück, bis das Ende des Caches erreicht ist. zu diesem Zeitpunkt werden neue Objekte aus dem zugrunde liegenden Speicher hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="37091-123">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the cache and **IEnumVARIANT::Next** will return cached objects until the end of the cache is reached, at which point new objects will be added from the underlying store.</span></span> <span data-ttu-id="37091-124">Wenn sich eine Active Directory Objektinstanz im Cache befindet, erkennt der Client den Löschvorgang vom zugrunde liegenden Verzeichnisdienst erst, wenn ein [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) -oder [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) -Versuch versucht, auf das Objekt zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="37091-124">When an Active Directory object instance is in the cache the client will not become aware of its deletion from the underlying directory service until an [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>
-   <span data-ttu-id="37091-125">Sammlungen werden nicht zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="37091-125">Collections not cached.</span></span> <span data-ttu-id="37091-126">Die Auflistung wird von dem zugrunde liegenden Verzeichnisdienst ein Objekt zu einem Zeitpunkt abgerufen, wenn [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="37091-126">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="37091-127">[**IEnumVARIANT:: Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) kehrt zum Anfang der Auflistung im zugrunde liegenden Speicher zurück.</span><span class="sxs-lookup"><span data-stu-id="37091-127">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the underlying store.</span></span> <span data-ttu-id="37091-128">**IEnumVARIANT:: Next** -und **IEnumVARIANT:: Reset** -Vorgänge können keine gelöschten Objekte abrufen, da die Objekte Bedarfs gesteuert vom zugrunde liegenden Verzeichnisdienst abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="37091-128">**IEnumVARIANT::Next** and **IEnumVARIANT::Reset** operations cannot retrieve deleted objects, because the objects are retrieved on-demand from the underlying directory service.</span></span> <span data-ttu-id="37091-129">Nur das aktuelle Objekt wird zwischengespeichert. Wenn das aktuelle-Objekt gelöscht wird, erkennt der Client seinen Löschvorgang nicht mehr vom zugrunde liegenden Verzeichnisdienst, bis ein [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) -oder [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) -Versuch versucht, auf das Objekt zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="37091-129">Only the current object is cached; if the current object is deleted, the client will not become aware of its deletion from the underlying directory service until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>

<span data-ttu-id="37091-130">Ungeachtet des cachingmodells sollten Sie beachten, dass die ADSI-Enumeration Active Directory Dienst Schnittstellen an den Aufrufer zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="37091-130">Regardless of the caching model, be aware that ADSI enumeration returns Active Directory service interfaces to the caller.</span></span> <span data-ttu-id="37091-131">Um den mehr Aufwand für das Abrufen eines neuen Schnittstellen Zeigers zu vermeiden, sollten ADSI-Anwendungen die zurückgegebenen Schnittstellen Zeiger für Objekte zwischenspeichern, die Sie bearbeiten möchten.</span><span class="sxs-lookup"><span data-stu-id="37091-131">To avoid the overhead of obtaining a new interface pointer, ADSI applications should cache the returned interface pointers for objects that they intend to manipulate.</span></span> <span data-ttu-id="37091-132">Beispielsweise kann eine Visual Basic Anwendung, die einen Container auflistet und ein Listenfeld mit Namen auffüllt, die Schnittstellen Zeiger Zwischenspeichern, die den Namen für die spätere Verwendung zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="37091-132">For example, a Visual Basic application that enumerates a container and populates a list box with names can cache the interface pointers associated with the names for later use.</span></span> <span data-ttu-id="37091-133">Diese Vorgehensweise bietet eine höhere Leistung als das Auffüllen des Listen Felds während der Enumeration und das Abrufen eines neuen Schnittstellen Zeigers, wenn der Benutzer eine Auswahl trifft.</span><span class="sxs-lookup"><span data-stu-id="37091-133">This approach will provide greater performance than populating the list box during enumeration and obtaining a new interface pointer when the user makes a selection.</span></span>

## <a name="about-dispatch-ids"></a><span data-ttu-id="37091-134">Informationen zu dispatchids</span><span class="sxs-lookup"><span data-stu-id="37091-134">About Dispatch IDs</span></span>

<span data-ttu-id="37091-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) ist eine von com definierte Automatisierungsschnittstelle für Controller, die keine COM-Schnittstellen direkt verwenden.</span><span class="sxs-lookup"><span data-stu-id="37091-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) is an Automation interface defined by COM for controllers that do not use COM interfaces directly.</span></span> <span data-ttu-id="37091-136">Der Zugriff auf ein Objekt über **IDispatch** wird namens gebunden oder spät gebundener Zugriff, da es zur Laufzeit ("spät") auftritt und Zeichen folgen Namen von Eigenschaften und Methoden verwendet, um Verweise aufzulösen ("Name").</span><span class="sxs-lookup"><span data-stu-id="37091-136">Accessing an object through **IDispatch** is called name-bound or late-bound access, because it occurs at run time ("late") and uses string names of properties and methods to resolve references ("name").</span></span> <span data-ttu-id="37091-137">Zur Laufzeit übergeben Clients den Zeichen folgen Namen der Eigenschaft oder Methode, die Sie aufrufen möchten, an die Methode [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)().</span><span class="sxs-lookup"><span data-stu-id="37091-137">At run time, clients pass the string name of the property or method they wish to call into the [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)() method.</span></span> <span data-ttu-id="37091-138">Wenn die Eigenschaft oder Methode für das Objekt vorhanden ist, wird der Dispatchbezeichner (DISPID) der entsprechenden Funktion abgerufen.</span><span class="sxs-lookup"><span data-stu-id="37091-138">If the property or method exists on the object, the dispatch identifier (dispID) of the corresponding function is retrieved.</span></span> <span data-ttu-id="37091-139">Die DISPID wird dann verwendet, um die Funktion über [**IDispatch:: Aufrufen**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)() auszuführen.</span><span class="sxs-lookup"><span data-stu-id="37091-139">The dispID is then used to execute the function through [**IDispatch::Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)().</span></span> <span data-ttu-id="37091-140">Mithilfe von **IDispatch** werden Eigenschaften und Methoden für die Schnittstellen, die von einem einzelnen-Objekt verfügbar gemacht werden, als flache Liste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="37091-140">Using **IDispatch**, properties and methods on the interfaces exposed by a single object appear as a flat list.</span></span> <span data-ttu-id="37091-141">Da der namens gebundene Zugriff zwei Funktionsaufrufe erfordert, ist er weniger effizient als die direkte Verwendung einer COM-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="37091-141">Because name-bound access requires two function calls, it is less efficient than using a COM interface directly.</span></span> <span data-ttu-id="37091-142">Clients wird empfohlen, die ADSI-COM-Schnittstellen für die Objekte zu verwenden, wenn die Leistung berücksichtigt wird.</span><span class="sxs-lookup"><span data-stu-id="37091-142">Clients are encouraged to use the ADSI COM interfaces on the objects when performance is a consideration.</span></span> <span data-ttu-id="37091-143">Erweiterte Automatisierungs Controller, wie z. b. Visual Basic 4,0, können andere COM-Schnittstellen sowie **IDispatch** aufrufen, wenn die Schnittstellen den Automatisierungs Einschränkungen für Datentypen und Parameter Übergabe entsprechen.</span><span class="sxs-lookup"><span data-stu-id="37091-143">Advanced Automation controllers such as Visual Basic 4.0 can call other COM interfaces as well as **IDispatch**, if the interfaces comply with the Automation constraints for data types and parameter passing.</span></span>

<span data-ttu-id="37091-144">ADSI-Anbieter generieren für jedes Active Directory Objekt dynamisch DispIds.</span><span class="sxs-lookup"><span data-stu-id="37091-144">ADSI providers generate dispIDs dynamically for each Active Directory object.</span></span> <span data-ttu-id="37091-145">Die DispIds, die über [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) für ein bestimmtes Objekt abgerufen werden, sind die generierten Werte, jedoch nicht die Werte, die in der IDL für das Objekt enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="37091-145">The dispIDs retrieved through [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) for a given object are the generated values, but not the values that are in the IDL for the object.</span></span> <span data-ttu-id="37091-146">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) -Benutzer müssen **GetIDsOfNames** aufrufen, um zur Laufzeit gültige DispIds zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="37091-146">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) users must call **GetIDsOfNames** to obtain valid dispIDs at run time.</span></span>

## <a name="type-information-and-type-libraries"></a><span data-ttu-id="37091-147">Typinformationen und Typbibliotheken</span><span class="sxs-lookup"><span data-stu-id="37091-147">Type Information and Type Libraries</span></span>

<span data-ttu-id="37091-148">Das ADSI SDK stellt eine Typbibliothek, activeds. tlb, bereit, die alle von ADSI unterstützten Standardschnittstellen dokumentiert.</span><span class="sxs-lookup"><span data-stu-id="37091-148">The ADSI SDK supplies a type library, Activeds.tlb, that documents all the standard interfaces supported by ADSI.</span></span> <span data-ttu-id="37091-149">Ein Anbieter muss eine ähnliche Typbibliothek für alle in activeds. tlb gefundenen Schnittstellen sowie alle zusätzlichen Typdaten für die Schnittstellen bereitstellen, die in der Anbieter Komponente implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="37091-149">A provider must supply a similar type library for all interfaces found in Activeds.tlb, plus any additional type data for the interfaces implemented within the provider component.</span></span>

<span data-ttu-id="37091-150">Im folgenden finden Sie ein Beispiel für einen IDL-Code.</span><span class="sxs-lookup"><span data-stu-id="37091-150">The following is an IDL code example.</span></span>

``` syntax
[ object, uuid(IID_IADsXYZ), oleautomation, dual ]
interface IADsXYZ: IDispatch
{
// Read-only properties.
[propget]
HRESULT AReadOnlyProp ([out, retval]BSTR *pbstrAReadOnlyProp);
 
// Read/write properties.
[propget]
HRESULT AReadWriteProp ([out, retval]long *plAReadWriteProp);
[propput]
HRESULT AReadWriteProp ([in]long lAReadWriteProp);
 
// Methods.
HRESULT AMethod ([in]DATE dateInParameter,
[out, retval]BSTR *pbstrReturnValue);
};
```

## <a name="thread-safety"></a><span data-ttu-id="37091-151">Threadsicherheit</span><span class="sxs-lookup"><span data-stu-id="37091-151">Thread Safety</span></span>

<span data-ttu-id="37091-152">In der Component Object Model (com) werden die folgenden drei Threading Modelle beschrieben.</span><span class="sxs-lookup"><span data-stu-id="37091-152">The Component Object Model (COM) describes the following three threading models.</span></span> <span data-ttu-id="37091-153">COM-Anwendungen geben an, welches Modell beim Initialisieren der com-Bibliothek verwendet wird, indem die [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) -und [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) -Funktionen verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="37091-153">COM applications indicate which model is in use when initializing the COM library using the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) and [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) functions:</span></span>

-   <span data-ttu-id="37091-154">Single Threading.</span><span class="sxs-lookup"><span data-stu-id="37091-154">Single threading.</span></span> <span data-ttu-id="37091-155">Das Single Thread-Modell geht davon aus, dass ein einzelner Ausführungs Thread in einem Prozess ausgeführt wird. dabei wird davon ausgegangen, dass com-Datenstrukturen in einem Prozess keine Zugriffsserialisierung</span><span class="sxs-lookup"><span data-stu-id="37091-155">The single threaded model assumes a single thread of execution in a process, further assuming that COM data structures in a process need no access serialization.</span></span>
-   <span data-ttu-id="37091-156">Apartment Threading.</span><span class="sxs-lookup"><span data-stu-id="37091-156">Apartment threading.</span></span> <span data-ttu-id="37091-157">Ein COM-Objekt ist dem Thread zugeordnet, der ihn erstellt hat.</span><span class="sxs-lookup"><span data-stu-id="37091-157">A COM object is associated with the thread that created it.</span></span> <span data-ttu-id="37091-158">Aufrufe eines Objekts in einem anderen Thread müssen von dem Thread ausgeführt werden, der das Objekt erstellt hat.</span><span class="sxs-lookup"><span data-stu-id="37091-158">Calls to an object on another thread must be executed by the thread that created that object.</span></span> <span data-ttu-id="37091-159">Um dies zu erreichen, ruft der Quell Thread einen Client Proxy auf, der den Methodenaufruf anordnet und ihn über die Win32-Nachrichten Warteschlange, die dem Zielthread zugeordnet ist, an eine Serverstub-Funktion im Zielthread übergibt.</span><span class="sxs-lookup"><span data-stu-id="37091-159">To accomplish this, the source thread invokes a client proxy which arranges the method call and delivers it to a server stub function in the destination thread through the Win32 message queue associated with the destination thread.</span></span>
-   <span data-ttu-id="37091-160">Kostenloses Threading.</span><span class="sxs-lookup"><span data-stu-id="37091-160">Free threading.</span></span> <span data-ttu-id="37091-161">Es wird davon ausgegangen, dass COM-Objekte Thread sicher sind.</span><span class="sxs-lookup"><span data-stu-id="37091-161">COM objects are assumed to be thread safe.</span></span> <span data-ttu-id="37091-162">Mehreren Threads wird der Zugriff auf jedes Objekt im Prozess gestattet, ohne dass eine Serialisierung erzwungen wird.</span><span class="sxs-lookup"><span data-stu-id="37091-162">Multiple threads are allowed access to any object in the process with no serialization imposed.</span></span>

<span data-ttu-id="37091-163">ADSI nimmt kein bestimmtes Threading Modell an.</span><span class="sxs-lookup"><span data-stu-id="37091-163">ADSI does not assume any particular threading model.</span></span> <span data-ttu-id="37091-164">Writer von Anbieter Komponenten sollten das kostenlose Threading Modell annehmen und die Konsistenz Ihrer internen Datenstrukturen gewährleisten, indem Sie Sie vor Thread unsicheren, d. h. nicht koordinierten Updates durch die Verwendung von Synchronisierungs Objekten, wie z. b. kritischen Abschnitten oder Semaphore, schützen.</span><span class="sxs-lookup"><span data-stu-id="37091-164">Writers of provider components should assume the free threading model and guarantee the consistency of their internal data structures by protecting them from thread-unsafe, that is, uncoordinated, updates through the use of synchronization objects such as critical sections or semaphores.</span></span>

## <a name="object-locking"></a><span data-ttu-id="37091-165">Objekt Sperrung</span><span class="sxs-lookup"><span data-stu-id="37091-165">Object Locking</span></span>

<span data-ttu-id="37091-166">ADSI erzwingt oder definiert kein Objekt Sperr Schema.</span><span class="sxs-lookup"><span data-stu-id="37091-166">ADSI does not impose or define an object-locking scheme.</span></span> <span data-ttu-id="37091-167">Anbieter für Namespaces, die die Zugriffsserialisierung mithilfe von Sperren unterstützen, können das zugrunde liegende Sperr Schema über anbieterspezifische Erweiterungen von ADSI verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="37091-167">Providers for namespaces that support access serialization using locking can expose the underlying locking scheme through provider-specific extensions to ADSI.</span></span>

## <a name="property-names-within-a-schema"></a><span data-ttu-id="37091-168">Eigenschaftsnamen innerhalb eines Schemas</span><span class="sxs-lookup"><span data-stu-id="37091-168">Property Names Within a Schema</span></span>

<span data-ttu-id="37091-169">ADSI stellt Eigenschaften als Eigenschafts Objekte innerhalb des ADSI-Schema Containers dar.</span><span class="sxs-lookup"><span data-stu-id="37091-169">ADSI represents properties as property objects within the ADSI schema container.</span></span> <span data-ttu-id="37091-170">Dies erfordert, dass Eigenschaftsnamen innerhalb der einzelnen Schema Container eindeutig sind.</span><span class="sxs-lookup"><span data-stu-id="37091-170">This requires that property names be unique within each schema container.</span></span> <span data-ttu-id="37091-171">Der Anbieter muss sicherstellen, dass keine Namenskollisionen vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="37091-171">The provider must ensure that there are no name collisions.</span></span>

## <a name="primary-interface"></a><span data-ttu-id="37091-172">Primäre Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="37091-172">Primary Interface</span></span>

<span data-ttu-id="37091-173">Wenn ein Anbieter nicht ermitteln kann, welche Schnittstelle als primäre Schnittstelle zurückgegeben werden soll, sollten **IID- \_ IADs** zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="37091-173">When a provider cannot identify which interface should be returned as the primary interface, **IID\_IADs** should be returned.</span></span> <span data-ttu-id="37091-174">Dies ermöglicht den namens gebundenen Zugriff auf alle Eigenschaften eines Objekts über [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) und die [**IADs:: Get**](/windows/desktop/api/Iads/nf-iads-iads-get)-, [**IADs:: Getex**](/windows/desktop/api/Iads/nf-iads-iads-getex)-, [**IADs::P UT**](/windows/desktop/api/Iads/nf-iads-iads-put)-und [**IADs::P utex**](/windows/desktop/api/Iads/nf-iads-iads-putex) -Methoden.</span><span class="sxs-lookup"><span data-stu-id="37091-174">This provides name-bound access to all properties of an object through [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) and the [**IADs::Get**](/windows/desktop/api/Iads/nf-iads-iads-get), [**IADs::GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex), [**IADs::Put**](/windows/desktop/api/Iads/nf-iads-iads-put), and [**IADs::PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) methods.</span></span>

 

 