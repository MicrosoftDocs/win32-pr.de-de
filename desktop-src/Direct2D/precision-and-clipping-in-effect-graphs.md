---
title: Genauigkeits-und numerische Clipping in Effekt Diagrammen
description: Anwendungen, die Effekte mithilfe von Direct2D renderingeffekte darstellen, müssen darauf achten, dass die gewünschte Qualität und Vorhersagbarkeit hinsichtlich der numerischen Genauigkeit erreicht wird.
ms.assetid: 6fd1d77f-e613-534f-3205-bad11fa24c30
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 90628661ec8cd3f16ff6a6149aecbb7e8be3e5a9
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104039446"
---
# <a name="precision-and-numerical-clipping-in-effect-graphs"></a><span data-ttu-id="1528d-103">Genauigkeits-und numerische Clipping in Effekt Diagrammen</span><span class="sxs-lookup"><span data-stu-id="1528d-103">Precision and numerical clipping in effect graphs</span></span>

<span data-ttu-id="1528d-104">Anwendungen, die Effekte mithilfe von Direct2D renderingeffekte darstellen, müssen darauf achten, dass die gewünschte Qualität und Vorhersagbarkeit hinsichtlich der numerischen Genauigkeit erreicht wird.</span><span class="sxs-lookup"><span data-stu-id="1528d-104">Applications that render effects using Direct2D must take care to achieve the desired level of quality and predictability with respect to numerical precision.</span></span> <span data-ttu-id="1528d-105">In diesem Thema werden bewährte Methoden und relevante Einstellungen in Direct2D beschrieben, die in folgenden Situationen nützlich sind:</span><span class="sxs-lookup"><span data-stu-id="1528d-105">This topic describes best practices and relevant settings in Direct2D which are useful if:</span></span>

-   <span data-ttu-id="1528d-106">Das Effekt Diagramm basiert auf hoher numerischer Genauigkeit oder Farben außerhalb des \[ Bereichs 0, 1 \] , und Sie möchten sicherstellen, dass diese stets verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="1528d-106">Your effect graph relies on high numerical precision or colors outside of the \[0, 1\] range, and you want to make sure these will always be available</span></span>
-   <span data-ttu-id="1528d-107">Oder das Effekt Diagramm basiert auf der Rendering-Implementierung, um zwischen Farben an den \[ Bereich 0, 1 zu binden \] , und Sie möchten sicherstellen, dass diese Klammer immer auftritt.</span><span class="sxs-lookup"><span data-stu-id="1528d-107">Or, your effect graph relies on the rendering implementation to clamp intermediate colors to the \[0, 1\] range, and you want to ensure this clamping always occurs</span></span>

<span data-ttu-id="1528d-108">Direct2D unterteilt häufig ein Effekt Diagramm in Abschnitte und rendert jeden Abschnitt in einem separaten Schritt.</span><span class="sxs-lookup"><span data-stu-id="1528d-108">Direct2D often divides an effect graph into sections, and renders each section in a separate step.</span></span> <span data-ttu-id="1528d-109">Die Ausgabe einiger Schritte kann in zwischengeschalteten Direct3D-Texturen gespeichert werden, die standardmäßig einen begrenzten numerischen Bereich und eine begrenzte Genauigkeit aufweisen.</span><span class="sxs-lookup"><span data-stu-id="1528d-109">The output of some steps may be stored in intermediate Direct3D textures which by default have limited numerical range and precision.</span></span> <span data-ttu-id="1528d-110">Direct2D gibt keine Garantie dafür, ob oder wo diese zwischen Texturen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="1528d-110">Direct2D makes no guarantees about if or where these intermediate textures are used.</span></span> <span data-ttu-id="1528d-111">Dieses Verhalten kann je nach GPU-und Windows-Versionen variieren.</span><span class="sxs-lookup"><span data-stu-id="1528d-111">This behavior may vary according to GPU capabilities as well as between Windows versions.</span></span>

<span data-ttu-id="1528d-112">In Windows 10 verwendet Direct2D aufgrund der Verwendung von Shader-Verknüpfungen weniger zwischen Texturen.</span><span class="sxs-lookup"><span data-stu-id="1528d-112">In Windows 10, Direct2D uses fewer intermediate textures due to its use of shader linking.</span></span> <span data-ttu-id="1528d-113">Direct2D kann daher unterschiedliche Ergebnisse mit Standardeinstellungen als in früheren Windows-Versionen liefern.</span><span class="sxs-lookup"><span data-stu-id="1528d-113">Direct2D may therefore produce different results with default settings than in prior Windows releases.</span></span> <span data-ttu-id="1528d-114">Dies wirkt sich in erster Linie auf Szenarien aus, in denen Shader-Verknüpfungen in einem Effekt Diagramm möglich sind. dieses Diagramm enthält auch Effekte, die erweiterte Ausgabe Farben erzeugen.</span><span class="sxs-lookup"><span data-stu-id="1528d-114">This primarily affects scenarios where shader linking is possible in an effect graph, and that graph also contains effects that produce extended-range output colors.</span></span>

## <a name="overview-of-effect-rendering-and-intermediates"></a><span data-ttu-id="1528d-115">Übersicht über das Rendern von Effekten und Vermittler</span><span class="sxs-lookup"><span data-stu-id="1528d-115">Overview of effect rendering and intermediates</span></span>

<span data-ttu-id="1528d-116">Um ein Effekt Diagramm zu rendereln, sucht Direct2D zuerst nach dem zugrunde liegenden Diagramm "Transformationen", bei dem eine Transformation ein in einem Effekt verwendeter Diagramm Knoten ist.</span><span class="sxs-lookup"><span data-stu-id="1528d-116">To render an effect graph, Direct2D first finds the underlying graph of “transforms,” where a transform is a graph node used within an effect.</span></span> <span data-ttu-id="1528d-117">Es gibt verschiedene Arten von Transformationen, einschließlich derjenigen, die Direct3D-Shader für Direct2D zur Verwendung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="1528d-117">There are different types of transforms, including those which provide Direct3D shaders for Direct2D to use.</span></span>

<span data-ttu-id="1528d-118">Beispielsweise kann Direct2D ein Effekt Diagramm wie folgt Rendering:</span><span class="sxs-lookup"><span data-stu-id="1528d-118">For example, Direct2D may render an effect graph as follows:</span></span>

![Effekt Diagramm mit zwischen Texturen](images/precision-and-clipping-1.png)

<span data-ttu-id="1528d-120">Direct2D sucht nach Möglichkeiten, die Anzahl zwischen Texturen zu reduzieren, die zum renderingeffekten verwendet werden. Diese Logik ist für Anwendungen nicht transparent.</span><span class="sxs-lookup"><span data-stu-id="1528d-120">Direct2D looks for opportunities to reduce the number intermediate textures used to render the effect graph; this logic is opaque to applications.</span></span> <span data-ttu-id="1528d-121">Das folgende Diagramm kann z. b. von Direct2D mit einem Direct3D Draw-Aufruf und ohne zwischen Texturen gerendert werden:</span><span class="sxs-lookup"><span data-stu-id="1528d-121">For example, the following graph can be rendered by Direct2D using one Direct3D draw call and no intermediate textures:</span></span>

![Effekt Diagramm ohne zwischen Strukturen](images/precision-and-clipping-2.png)

<span data-ttu-id="1528d-123">Vor Windows 10 verwendete Direct2D immer zwischen Texturen, wenn mehrere Pixel-Shader innerhalb desselben Effekt Diagramms verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="1528d-123">Prior to Windows 10, Direct2D would always use intermediate textures if multiple pixels shaders were used within the same effect graph.</span></span> <span data-ttu-id="1528d-124">Die meisten integrierten Effekte, die einfach Farb Werte anpassen (z. b. Helligkeit oder Sättigung), verwenden Pixel-Shader.</span><span class="sxs-lookup"><span data-stu-id="1528d-124">Most built-in effects that simply adjust color values (for example, Brightness or Saturation) do so using pixel shaders.</span></span>

<span data-ttu-id="1528d-125">In Windows 10 kann Direct2D nun vermeiden, dass in solchen Fällen zwischen Texturen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="1528d-125">In Windows 10, Direct2D may now avoid using intermediate textures in such cases.</span></span> <span data-ttu-id="1528d-126">Dies geschieht, indem angrenzende Pixel-Shader intern verknüpft werden.</span><span class="sxs-lookup"><span data-stu-id="1528d-126">It does this by internally linking adjacent pixel shaders.</span></span> <span data-ttu-id="1528d-127">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="1528d-127">For example:</span></span>

![Windows 10-Effekt Diagramm mit mehreren Pixel-Shadern und ohne zwischen Strukturen](images/precision-and-clipping-3.png)

<span data-ttu-id="1528d-129">Beachten Sie, dass nicht alle angrenzenden Pixel-Shader in einem Diagramm miteinander verknüpft werden können. aus diesem Grund ergeben nur bestimmte Diagramme unter Windows 10 eine andere Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="1528d-129">Note that not all adjacent pixel shaders in a graph may be linked together, and therefore only certain graphs will produce different output on Windows 10.</span></span> <span data-ttu-id="1528d-130">Ausführliche Informationen finden Sie unter [Effect Shader Linking](effect-shader-linking.md).</span><span class="sxs-lookup"><span data-stu-id="1528d-130">For full details see [Effect Shader Linking](effect-shader-linking.md).</span></span> <span data-ttu-id="1528d-131">Die wichtigsten Einschränkungen sind:</span><span class="sxs-lookup"><span data-stu-id="1528d-131">The primary restrictions are:</span></span>

-   <span data-ttu-id="1528d-132">Ein Effekt wird nicht mit Effekten verknüpft, die seine Ausgabe verbrauchen, wenn der erste Effekt als Eingabe mit mehreren Effekten verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="1528d-132">An effect will not be linked with effects consuming its output, if the first effect is connected as an input to multiple effects.</span></span>
-   <span data-ttu-id="1528d-133">Ein Effekt wird nicht mit einem Effekt als Eingabe verknüpft, wenn der erste Effekt seine Eingabe an einer anderen logischen Position als der Ausgabe ablegt.</span><span class="sxs-lookup"><span data-stu-id="1528d-133">An effect will not be linked with an effect set as its input, if the first effect samples its input at a different logical position than its output.</span></span> <span data-ttu-id="1528d-134">Beispielsweise kann ein Farb Matrix Effekt mit der Eingabe verknüpft werden, aber ein Vergleich ist nicht.</span><span class="sxs-lookup"><span data-stu-id="1528d-134">For example, a Color Matrix effect might be linked with its input, but a Convolution effect will not be.</span></span>

## <a name="built-in-effect-behavior"></a><span data-ttu-id="1528d-135">Verhalten integrierter Effekte</span><span class="sxs-lookup"><span data-stu-id="1528d-135">Built-in effect behavior</span></span>

<span data-ttu-id="1528d-136">Viele integrierte Effekte können Farben außerhalb von \[ 0, 1 \] Bereich im nicht multiplizierten Farbraum erzeugen, auch wenn sich Ihre Eingabe Farben in diesem Bereich befinden.</span><span class="sxs-lookup"><span data-stu-id="1528d-136">Many built-in effects may produce colors outside of the \[0, 1\] range in the unpremultiplied color space, even when their input colors are within that range.</span></span> <span data-ttu-id="1528d-137">Wenn dies geschieht, unterliegen diese Farben möglicherweise dem numerischen Clipping.</span><span class="sxs-lookup"><span data-stu-id="1528d-137">When this happens, such colors may be subject to numerical clipping.</span></span> <span data-ttu-id="1528d-138">Beachten Sie, dass es wichtig ist, den Farbbereich in einem nicht multiplizierten Bereich zu berücksichtigen, auch wenn integrierte Effekte in der Regel Farben in einem voraus multiplizierten Bereich erzeugen.</span><span class="sxs-lookup"><span data-stu-id="1528d-138">Note that it’s important to consider the color range in unpremultiplied space, even though built-in effects typically produce colors in premultiplied space.</span></span> <span data-ttu-id="1528d-139">Dadurch wird sichergestellt, dass die Farben innerhalb des Bereichs liegen, auch wenn Sie von anderen Effekten später nicht multipliziert werden.</span><span class="sxs-lookup"><span data-stu-id="1528d-139">This ensures that colors stay within range, even if other effects subsequently unpremultiply them.</span></span>

<span data-ttu-id="1528d-140">Einige der Effekte, die diese out-of-Range-Farben ausgeben können, bieten eine Eigenschaft "klamdungstyp".</span><span class="sxs-lookup"><span data-stu-id="1528d-140">Some of the effects which may emit these out-of-range colors offer a “ClampOutput” property.</span></span> <span data-ttu-id="1528d-141">Dazu gehören:</span><span class="sxs-lookup"><span data-stu-id="1528d-141">These include:</span></span>

-   [<span data-ttu-id="1528d-142">Farb Matrix</span><span class="sxs-lookup"><span data-stu-id="1528d-142">Color Matrix</span></span>](color-matrix.md)
-   [<span data-ttu-id="1528d-143">Arithmetischer zusammengesetzter</span><span class="sxs-lookup"><span data-stu-id="1528d-143">Arithmetic Composite</span></span>](arithmetic-composite.md)
-   [<span data-ttu-id="1528d-144">Convolve</span><span class="sxs-lookup"><span data-stu-id="1528d-144">Convolve</span></span>](convolve-matrix.md)
-   [<span data-ttu-id="1528d-145">Übertragungseffekte</span><span class="sxs-lookup"><span data-stu-id="1528d-145">Transfer effects</span></span>](built-in-effects.md)

<span data-ttu-id="1528d-146">Wenn die Eigenschaft "SetOutput" für diese Effekte auf true festgelegt wird, wird sichergestellt, dass unabhängig von Faktoren wie shaderverknüpfung ein konsistentes Ergebnis erzielt wird.</span><span class="sxs-lookup"><span data-stu-id="1528d-146">Setting the ClampOutput property to TRUE on these effects ensures a consistent result will be achieved regardless of factors such as shader linking.</span></span> <span data-ttu-id="1528d-147">Beachten Sie, dass im nicht multiplizierten Bereich eine Klammer auftritt.</span><span class="sxs-lookup"><span data-stu-id="1528d-147">Note that clamping occurs in unpremultiplied space.</span></span>

<span data-ttu-id="1528d-148">Andere integrierte Effekte können auch Ausgabe Farben erzeugen, die über den \[ Bereich von 0 bis 1 \] liegen, auch wenn sich die Farben Pixel (und ggf. "Color"-Eigenschaften) in diesem Bereich befinden.</span><span class="sxs-lookup"><span data-stu-id="1528d-148">Other built-in effects may also produce output colors beyond the \[0, 1\] range in unpremultiplied space, even when their colors pixels (and “Color” properties if any) are within that range.</span></span> <span data-ttu-id="1528d-149">Dazu gehören:</span><span class="sxs-lookup"><span data-stu-id="1528d-149">These include:</span></span>

-   <span data-ttu-id="1528d-150">[Transformieren und Skalieren von Effekten](built-in-effects.md) (wenn es sich bei der Interpolations Modus-Eigenschaft um eine kubische oder eine hochwertige</span><span class="sxs-lookup"><span data-stu-id="1528d-150">[Transforming and Scaling effects](built-in-effects.md) (When the Interpolation Mode property is Cubic or High Quality Cubic)</span></span>
-   [<span data-ttu-id="1528d-151">Beleuchtungseffekte</span><span class="sxs-lookup"><span data-stu-id="1528d-151">Lighting effects</span></span>](built-in-effects.md)
-   <span data-ttu-id="1528d-152">[Edge-Erkennung](edge-detection-effect.md) (wenn die Eigenschaft der Überlagerungs Ränder true ist)</span><span class="sxs-lookup"><span data-stu-id="1528d-152">[Edge detection](edge-detection-effect.md) (When the Overlay Edges property is TRUE)</span></span>
-   [<span data-ttu-id="1528d-153">Offenlegung</span><span class="sxs-lookup"><span data-stu-id="1528d-153">Exposure</span></span>](exposure-effect.md)
-   <span data-ttu-id="1528d-154">[Composite](composite.md) (wenn die Mode-Eigenschaft Plus ist)</span><span class="sxs-lookup"><span data-stu-id="1528d-154">[Composite](composite.md) (When the Mode property is Plus)</span></span>
-   [<span data-ttu-id="1528d-155">Temperatur und tint</span><span class="sxs-lookup"><span data-stu-id="1528d-155">Temperature and Tint</span></span>](temperature-and-tint-effect.md)
-   [<span data-ttu-id="1528d-156">Sepia</span><span class="sxs-lookup"><span data-stu-id="1528d-156">Sepia</span></span>](sepia-effect.md)
-   [<span data-ttu-id="1528d-157">Sättigung</span><span class="sxs-lookup"><span data-stu-id="1528d-157">Saturation</span></span>](saturation.md)

## <a name="forcing-numerical-clipping-within-an-effect-graph"></a><span data-ttu-id="1528d-158">Erzwingen des numerischen Clipping innerhalb eines Effekt Diagramms</span><span class="sxs-lookup"><span data-stu-id="1528d-158">Forcing numerical clipping within an effect graph</span></span>

<span data-ttu-id="1528d-159">Wenn Sie die oben aufgeführten Effekte verwenden, die nicht über eine Eigenschaft für die Eigenschaft "Eigenschaft" verfügen, sollten Anwendungen eine numerische Klammer erzwingen.</span><span class="sxs-lookup"><span data-stu-id="1528d-159">While using effects listed above which do not have a ClampOutput property, applications should consider forcing numerical clamping.</span></span> <span data-ttu-id="1528d-160">Dies kann durch Einfügen eines zusätzlichen Effekts in das Diagramm erreicht werden, das seine Pixel bindet.</span><span class="sxs-lookup"><span data-stu-id="1528d-160">This can be done by inserting an additional effect into the graph that clamps its pixels.</span></span> <span data-ttu-id="1528d-161">Ein Farb Matrix Effekt kann verwendet werden, wenn die Eigenschaft "SetOutput" auf "true" festgelegt ist und die Eigenschaft "ColorMatrix" als Standardwert (Pass-Through) belassen wird.</span><span class="sxs-lookup"><span data-stu-id="1528d-161">A Color Matrix effect may be used, with its ‘ClampOutput’ property set to TRUE and leaving the ‘ColorMatrix’ property as the default (pass-through) value.</span></span>

<span data-ttu-id="1528d-162">Eine zweite Möglichkeit, konsistente Ergebnisse zu erzielen, besteht darin, dass Direct2D zwischen Texturen verwenden, die eine höhere Genauigkeit aufweisen.</span><span class="sxs-lookup"><span data-stu-id="1528d-162">A second option to achieve consistent results is to request that Direct2D use intermediate textures which have greater precision.</span></span> <span data-ttu-id="1528d-163">Dies wird nachfolgend beschrieben.</span><span class="sxs-lookup"><span data-stu-id="1528d-163">This is described below.</span></span>

## <a name="controlling-precision-of-intermediate-textures"></a><span data-ttu-id="1528d-164">Steuern der Genauigkeit von zwischen Texturen</span><span class="sxs-lookup"><span data-stu-id="1528d-164">Controlling precision of intermediate textures</span></span>

<span data-ttu-id="1528d-165">Direct2D bietet einige Möglichkeiten, um die Genauigkeit eines Diagramms zu steuern.</span><span class="sxs-lookup"><span data-stu-id="1528d-165">Direct2D provides a few ways to control the precision of a graph.</span></span> <span data-ttu-id="1528d-166">Vor der Verwendung von Formaten mit hoher Genauigkeit in Direct2D müssen Anwendungen sicherstellen, dass Sie von der GPU ausreichend unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="1528d-166">Before using high precision formats in Direct2D, applications must ensure they are supported sufficiently by the GPU.</span></span> <span data-ttu-id="1528d-167">Um dies zu überprüfen, verwenden Sie [**ID2D1DeviceContext:: isbufferprecisionsupported**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-isbufferprecisionsupported).</span><span class="sxs-lookup"><span data-stu-id="1528d-167">To check this, use [**ID2D1DeviceContext::IsBufferPrecisionSupported**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-isbufferprecisionsupported).</span></span>

<span data-ttu-id="1528d-168">Anwendungen können mithilfe von Warp (Software Emulation) ein Direct3D-Gerät erstellen, um sicherzustellen, dass alle Puffer präzigmachen unabhängig von der eigentlichen GPU-Hardware auf dem Gerät unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="1528d-168">Applications may create a Direct3D device using WARP (software emulation) to guarantee that all buffer precisions are supported independent of the actual GPU hardware on the device.</span></span> <span data-ttu-id="1528d-169">Dies wird in Szenarien wie dem Anwenden von Effekten auf ein Foto beim Speichern auf einem Datenträger empfohlen.</span><span class="sxs-lookup"><span data-stu-id="1528d-169">This is recommended in scenarios such as applying effects to a photo while saving to disk.</span></span> <span data-ttu-id="1528d-170">Selbst wenn Direct2D Puffer Formate mit hoher Genauigkeit auf der GPU unterstützt, wird die Verwendung von Warp in diesem Szenario auf Featureebene 9. X-GPUs empfohlen, aufgrund der begrenzten Genauigkeit der shaderarithmetik und der Stichprobenentnahme für einige Low-Power-Mobil-GPUs.</span><span class="sxs-lookup"><span data-stu-id="1528d-170">Even if Direct2D supports high precision buffer formats on the GPU, using WARP is recommended in this scenario on feature level 9.X GPUs, due to the limited precision of shader arithmetic and sampling on some low-power mobile GPUs.</span></span>

<span data-ttu-id="1528d-171">In jedem Fall unten ist die angeforderte Genauigkeit tatsächlich die minimale Genauigkeit, die Direct2D verwenden wird.</span><span class="sxs-lookup"><span data-stu-id="1528d-171">In each case below, the requested precision is actually the minimum precision Direct2D will use.</span></span> <span data-ttu-id="1528d-172">Wenn keine Vermittler erforderlich sind, kann eine höhere Genauigkeit verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="1528d-172">Higher precision may be used if intermediates are not required.</span></span> <span data-ttu-id="1528d-173">Direct2D kann auch zwischen Texturen für verschiedene Teile desselben Diagramms oder für verschiedene Diagramme freigeben.</span><span class="sxs-lookup"><span data-stu-id="1528d-173">Direct2D may also share intermediate textures for different parts of the same graph or different graphs entirely.</span></span> <span data-ttu-id="1528d-174">In diesem Fall verwendet Direct2D die für alle Beteiligten Vorgänge angeforderte maximale Genauigkeit.</span><span class="sxs-lookup"><span data-stu-id="1528d-174">In this case Direct2D uses the maximum precision requested for all involved operations.</span></span>

### <a name="precision-selection-from-id2d1devicecontextsetrenderingcontrols"></a><span data-ttu-id="1528d-175">Genauigkeits Auswahl aus ID2D1DeviceContext:: "".</span><span class="sxs-lookup"><span data-stu-id="1528d-175">Precision selection from ID2D1DeviceContext::SetRenderingControls</span></span>

<span data-ttu-id="1528d-176">Die einfachste Methode, um die Genauigkeit von renderingkonventionen-zwischen Texturen zu steuern, ist die Verwendung von [**ID2D1DeviceContext:: abtrenderingcontrols**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-setrenderingcontrols(constd2d1_rendering_controls)).</span><span class="sxs-lookup"><span data-stu-id="1528d-176">The simplest way to control the precision of Direct2D’s intermediate textures is to use [**ID2D1DeviceContext::SetRenderingControls**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-setrenderingcontrols(constd2d1_rendering_controls)).</span></span> <span data-ttu-id="1528d-177">Dadurch wird die Genauigkeit aller zwischen Texturen gesteuert, solange eine Genauigkeit nicht auch manuell bei Effekten oder Transformationen festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="1528d-177">This controls the precision of all intermediate textures, as long as a precision is not also set manually on effects or transforms directly.</span></span>


```cpp
if (Device->IsBufferPrecisionSupported(D2D1_BUFFER_PRECISION_32BPC_FLOAT))
{
  // Get the current rendering controls
  D2D1_RENDERING_CONTROLS renderingControls = {};
  Context->GetRenderingControls(&renderingControls);

  // Switch the precision within the rendering controls and set it
  renderingControls.bufferPrecision = D2D1_BUFFER_PRECISION_32BPC_FLOAT;
  Context->SetRenderingControls(&renderingControls);
}
              
```



### <a name="precision-selection-from-inputs-and-render-targets"></a><span data-ttu-id="1528d-178">Genauigkeits Auswahl aus Eingaben und renderzielen</span><span class="sxs-lookup"><span data-stu-id="1528d-178">Precision selection from inputs and render targets</span></span>

<span data-ttu-id="1528d-179">Anwendungen können auch auf die Genauigkeit der Eingaben in einem Effekt Diagramm zurückgreifen, um die Genauigkeit von zwischen Texturen zu steuern.</span><span class="sxs-lookup"><span data-stu-id="1528d-179">Applications may also rely on the precision of the inputs to an effect graph to control the precision of intermediate textures.</span></span> <span data-ttu-id="1528d-180">Dies ist der Fall, wenn eine Puffer Genauigkeit nicht mithilfe von [**ID2D1DeviceContext:: setrenderingcontrols**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-setrenderingcontrols(constd2d1_rendering_controls))angegeben wird und nicht manuell bei Effekten und transformieren festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="1528d-180">This is true as long as a buffer precision is not specified using [**ID2D1DeviceContext::SetRenderingControls**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-setrenderingcontrols(constd2d1_rendering_controls)), and is not set manually on effects and transform directly.</span></span>

<span data-ttu-id="1528d-181">Die Genauigkeit der Eingaben in Effekte werden durch das Diagramm weitergegeben, um die Genauigkeit von downstreamzwischengängen auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="1528d-181">The precisions of inputs to effects are propagated through the graph to select the precision of downstream intermediates.</span></span> <span data-ttu-id="1528d-182">Wenn verschiedene Verzweigungen im Effekt Diagramm übereinstimmen, wird die höchste Genauigkeit der Eingaben verwendet.</span><span class="sxs-lookup"><span data-stu-id="1528d-182">Where different branches in the effect graph meet, the greatest precision of any input is used.</span></span>

<span data-ttu-id="1528d-183">Die Genauigkeit, die basierend auf einer Direct2D Bitmap ausgewählt wird, wird aus dem Pixel Format bestimmt.</span><span class="sxs-lookup"><span data-stu-id="1528d-183">The precision selected based on a Direct2D bitmap is determined from its pixel format.</span></span> <span data-ttu-id="1528d-184">Die für eine [**ID2D1ImageSource**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesource) ausgewählte Genauigkeit wird anhand des WIC-Pixel Formats der zugrunde liegenden IWICBitmapSource bestimmt, die zum Erstellen des **ID2D1ImageSource** verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="1528d-184">The precision selected for an [**ID2D1ImageSource**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesource) is determined from the WIC pixel format of the underlying IWICBitmapSource used to create the **ID2D1ImageSource**.</span></span> <span data-ttu-id="1528d-185">Beachten Sie, dass Direct2D nicht zulässt, dass Bildquellen mit WIC-Quellen erstellt werden, die nicht von Direct2D und der GPU unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="1528d-185">Note that Direct2D doesn’t allow image sources to be created with WIC sources using precisions unsupported by Direct2D and the GPU.</span></span>

<span data-ttu-id="1528d-186">Es ist möglich, dass Direct2D auf der Grundlage der Eingaben keinen Effekt auf eine Genauigkeit zuweist.</span><span class="sxs-lookup"><span data-stu-id="1528d-186">It is possible that Direct2D cannot assign an effect a precision based on its inputs.</span></span> <span data-ttu-id="1528d-187">Dies geschieht, wenn ein Effekt keine Eingaben aufweist oder wenn eine [**ID2D1CommandList**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1commandlist) verwendet wird, die keine bestimmte Genauigkeit aufweist.</span><span class="sxs-lookup"><span data-stu-id="1528d-187">This happens when an effect has no inputs, or when an [**ID2D1CommandList**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1commandlist) is used, which has no specific precision.</span></span> <span data-ttu-id="1528d-188">In diesem Fall wird die Genauigkeit von zwischen Texturen von der Bitmap bestimmt, die als Aktuelles Renderziel des Kontexts festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="1528d-188">In this case, the precision of intermediate textures is determined from the bitmap set as the context’s current render target.</span></span>

### <a name="precision-selection-directly-on-the-effect-and-transforms"></a><span data-ttu-id="1528d-189">Genauigkeits Auswahl direkt in den Effekten und Transformationen</span><span class="sxs-lookup"><span data-stu-id="1528d-189">Precision selection directly on the effect and transforms</span></span>

<span data-ttu-id="1528d-190">Die minimale Genauigkeit für zwischen Texturen kann auch an expliziten Positionen innerhalb eines Effekt Diagramms festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="1528d-190">The minimum precision for intermediate textures may also be set at explicit locations within an effect graph.</span></span> <span data-ttu-id="1528d-191">Dies wird nur für erweiterte Szenarien empfohlen.</span><span class="sxs-lookup"><span data-stu-id="1528d-191">This is only recommended for advanced scenarios.</span></span>

<span data-ttu-id="1528d-192">Die minimale Genauigkeit kann mit einer Eigenschaft eines Effekts wie folgt festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="1528d-192">The minimum precision may be set using a property on an effect as follows:</span></span>


```cpp
if (Device->IsBufferPrecisionSupported(D2D1_BUFFER_PRECISION_32BPC_FLOAT))
{
  hr = Effect->SetValue(D2D1_PROPERTY_PRECISION, D2D1_BUFFER_PRECISION_32BPC_FLOAT);
}
              
```



<span data-ttu-id="1528d-193">Innerhalb einer Effekt Implementierung kann die minimale Genauigkeit mit ID2D1RenderInfo:: setoutputprecision wie folgt festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="1528d-193">Within an effect implementation, the minimum precision may be set using ID2D1RenderInfo::SetOutputPrecision as follows:</span></span>


```cpp
if (EffectContext->IsBufferPrecisionSupported(D2D1_BUFFER_PRECISION_32BPC_FLOAT))
{
  hr = RenderInfo->SetOutputBuffer(
  D2D1_BUFFER_PRECISION_32BPC_FLOAT,
  D2D1_CHANNEL_DEPTH_4);
}
              
```



<span data-ttu-id="1528d-194">Beachten Sie, dass die Genauigkeit, die für einen Effekt festgelegt wird, im gleichen Effekt Diagramm an DOWNSTREAMEFFEKTE weitergegeben wird, sofern für diese DOWNSTREAMEFFEKTE keine andere Genauigkeit festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="1528d-194">Note that the precision set on an effect will propagate to downstream effects in the same effect graph, unless a different precision is set on those downstream effects.</span></span> <span data-ttu-id="1528d-195">Die Genauigkeit, die für eine Transformation innerhalb eines Effekts festgelegt wird, hat keine Auswirkung auf die Genauigkeit von downstreamtransformierknoten.</span><span class="sxs-lookup"><span data-stu-id="1528d-195">The precision set on a transform within an effect does not affect the precision for downstream transform nodes.</span></span>

<span data-ttu-id="1528d-196">Im folgenden finden Sie die vollständige rekursive Logik, die verwendet wird, um die minimale Genauigkeit eines zwischen Puffers zu bestimmen, der die Ausgabe eines bestimmten Transformations Knotens</span><span class="sxs-lookup"><span data-stu-id="1528d-196">Below is the full recursive logic used to determine the minimum precision for an intermediate buffer storing the output of a given transform node:</span></span>

![Logik für Zwischenpuffer-minimal Genauigkeit](images/precision-and-clipping-4.png)

 

 