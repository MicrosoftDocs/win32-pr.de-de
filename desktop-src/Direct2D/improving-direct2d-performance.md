---
title: Verbessern der Leistung von Direct2D-apps
description: Beschreibt Techniken zum Verbessern der Direct2D-Leistung.
ms.assetid: e6b02925-4e75-42b0-b0c4-00f1ddb85e46
keywords:
- Direct2D, Leistung
- Direct2D, Bitmaps
- Direct2D, Ressourcenverwendung
- Direct2D, Flush-Methode
- Direct2D, statischer Inhalt
- Leistung für Direct2D
- Bitmaps für Direct2D
- Direct2D, GDI-Interoperation
- Direct2D, Interoperabilität
- Interoperabilität, Direct2D
- Graphics Device Interface (GDI)
- GDI (Graphics Device Interface)
- Interoperabilität, Graphics Device Interface (GDI)
ms.topic: article
ms.date: 05/31/2018
ms.custom: seodec18
ms.openlocfilehash: 5a413b96e00514b64b3cf1b1ee451a84a9e9ff09
ms.sourcegitcommit: 6eb53540b8d882fd035d428567d7d1c5ec17042c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/12/2020
ms.locfileid: "104474589"
---
# <a name="improving-the-performance-of-direct2d-apps"></a><span data-ttu-id="aff34-116">Verbessern der Leistung von Direct2D-apps</span><span class="sxs-lookup"><span data-stu-id="aff34-116">Improving the performance of Direct2D apps</span></span>

<span data-ttu-id="aff34-117">Obwohl [Direct2D](./direct2d-portal.md) Hardware beschleunigt ist und für hohe Leistung vorgesehen ist, müssen Sie die Funktionen zum Maximieren des Durchsatzes ordnungsgemäß verwenden.</span><span class="sxs-lookup"><span data-stu-id="aff34-117">Although [Direct2D](./direct2d-portal.md) is hardware accelerated and is meant for high performance, you must use the features correctly to maximize throughput.</span></span> <span data-ttu-id="aff34-118">Die hier vorgestellten Verfahren sind von der Untersuchung allgemeiner Szenarien abgeleitet und gelten möglicherweise nicht für alle App-Szenarios.</span><span class="sxs-lookup"><span data-stu-id="aff34-118">The techniques we show here are derived from studying common scenarios and might not apply to all app scenarios.</span></span> <span data-ttu-id="aff34-119">Daher kann das genaue Verständnis des App-Verhaltens und der Leistungsziele helfen, die gewünschten Ergebnisse zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="aff34-119">Therefore, careful understanding of app behavior and performance goals can help achieve the results that you want.</span></span>

-   [<span data-ttu-id="aff34-120">Ressourcenauslastung</span><span class="sxs-lookup"><span data-stu-id="aff34-120">Resource usage</span></span>](#resource-usage)
    -   [<span data-ttu-id="aff34-121">Ressourcen wieder verwenden</span><span class="sxs-lookup"><span data-stu-id="aff34-121">Reuse resources</span></span>](#reuse-resources)
-   [<span data-ttu-id="aff34-122">Beschränken der Verwendung von Flush</span><span class="sxs-lookup"><span data-stu-id="aff34-122">Restrict the use of flush</span></span>](#restrict-the-use-of-flush)
-   [<span data-ttu-id="aff34-123">Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-123">Bitmaps</span></span>](#create-large-bitmaps)
    -   [<span data-ttu-id="aff34-124">Erstellen großer Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-124">Create large bitmaps</span></span>](#create-large-bitmaps)
    -   [<span data-ttu-id="aff34-125">Erstellen eines Atlas von Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-125">Create an atlas of bitmaps</span></span>](#create-an-atlas-of-bitmaps)
    -   [<span data-ttu-id="aff34-126">Erstellen von freigegebenen Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-126">Create shared bitmaps</span></span>](#create-shared-bitmaps)
    -   [<span data-ttu-id="aff34-127">Kopieren von Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-127">Copying bitmaps</span></span>](#copying-bitmaps)
-   [<span data-ttu-id="aff34-128">Kachelingbitmap über dashlover verwenden</span><span class="sxs-lookup"><span data-stu-id="aff34-128">Use tiled bitmap over dashing</span></span>](#use-tiled-bitmap-over-dashing)
-   [<span data-ttu-id="aff34-129">Allgemeine Richtlinien zum Rendern komplexer statischer Inhalte</span><span class="sxs-lookup"><span data-stu-id="aff34-129">General guidelines for rendering complex static content</span></span>](#general-guidelines-for-rendering-complex-static-content)
    -   [<span data-ttu-id="aff34-130">Vollständiges Szenen Caching mithilfe einer Farb Bitmap</span><span class="sxs-lookup"><span data-stu-id="aff34-130">Full scene caching using a color bitmap</span></span>](#full-scene-caching-using-a-color-bitmap)
    -   [<span data-ttu-id="aff34-131">Pro primitiver Zwischenspeicherung mithilfe einer A8-Bitmap und der fillopacitymask-Methode</span><span class="sxs-lookup"><span data-stu-id="aff34-131">Per primitive caching using an A8 bitmap and the FillOpacityMask method</span></span>](#per-primitive-caching-using-an-a8-bitmap-and-the-fillopacitymask-method)
-   [<span data-ttu-id="aff34-132">Pro primitiver Zwischenspeicherung mithilfe von Geometry-neueinrichtungen</span><span class="sxs-lookup"><span data-stu-id="aff34-132">Per-primitive caching using geometry realizations</span></span>](#per-primitive-caching-using-geometry-realizations)
-   [<span data-ttu-id="aff34-133">Geometrie Rendering</span><span class="sxs-lookup"><span data-stu-id="aff34-133">Geometry rendering</span></span>](#geometry-rendering)
    -   [<span data-ttu-id="aff34-134">Bestimmtes zeichnen-primitiv überzeichnen-Geometrie verwenden</span><span class="sxs-lookup"><span data-stu-id="aff34-134">Use specific draw primitive over draw geometry</span></span>](#use-specific-draw-primitive-over-draw-geometry)
    -   [<span data-ttu-id="aff34-135">Rendern statischer Geometrie</span><span class="sxs-lookup"><span data-stu-id="aff34-135">Rendering static geometry</span></span>](#rendering-static-geometry)
    -   [<span data-ttu-id="aff34-136">Verwenden eines Multithread-Geräte Kontexts</span><span class="sxs-lookup"><span data-stu-id="aff34-136">Use a multithreaded device context</span></span>](#use-a-multithreaded-device-context)
-   [<span data-ttu-id="aff34-137">Zeichnen von Text mit Direct2D</span><span class="sxs-lookup"><span data-stu-id="aff34-137">Drawing text with Direct2D</span></span>](#use-a-multithreaded-device-context)
    -   [<span data-ttu-id="aff34-138">Drawtextlayout im Vergleich zu DrawText</span><span class="sxs-lookup"><span data-stu-id="aff34-138">DrawTextLayout Vs. DrawText</span></span>](#drawtextlayout-vs-drawtext)
    -   [<span data-ttu-id="aff34-139">Auswählen des richtigen textrenderingmodus</span><span class="sxs-lookup"><span data-stu-id="aff34-139">Choosing the right text rendering mode</span></span>](#choosing-the-right-text-rendering-mode)
    -   [<span data-ttu-id="aff34-140">Zwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="aff34-140">Caching</span></span>](#full-scene-caching-using-a-color-bitmap)
-   [<span data-ttu-id="aff34-141">Clipping einer beliebigen Form</span><span class="sxs-lookup"><span data-stu-id="aff34-141">Clipping an arbitrary shape</span></span>](#clipping-an-arbitrary-shape)
    -   [<span data-ttu-id="aff34-142">Pushlayer in Windows 8</span><span class="sxs-lookup"><span data-stu-id="aff34-142">PushLayer in Windows 8</span></span>](#pushlayer-in-windows-8)
    -   [<span data-ttu-id="aff34-143">Achsen ausgerichtete Clips</span><span class="sxs-lookup"><span data-stu-id="aff34-143">Axis-aligned clips</span></span>](#axis-aligned-clips)
-   [<span data-ttu-id="aff34-144">DXGI-Interoperabilität: Vermeiden von häufigen Switches</span><span class="sxs-lookup"><span data-stu-id="aff34-144">DXGI interoperability: avoid frequent switches</span></span>](#dxgi-interoperability-avoid-frequent-switches)
-   [<span data-ttu-id="aff34-145">Erkennen Ihres Pixel Formats</span><span class="sxs-lookup"><span data-stu-id="aff34-145">Know Your Pixel Format</span></span>](#know-your-pixel-format)
-   [<span data-ttu-id="aff34-146">Komplexität der Szene</span><span class="sxs-lookup"><span data-stu-id="aff34-146">Scene Complexity</span></span>](#scene-complexity)
    -   [<span data-ttu-id="aff34-147">Verstehen der Komplexität von Szenen</span><span class="sxs-lookup"><span data-stu-id="aff34-147">Understand Scene Complexity</span></span>](#understand-scene-complexity)
-   [<span data-ttu-id="aff34-148">Verbessern der Leistung für Direct2D-Druck-apps</span><span class="sxs-lookup"><span data-stu-id="aff34-148">Improving performance for Direct2D printing apps</span></span>](#improving-performance-for-direct2d-printing-apps)
    -   [<span data-ttu-id="aff34-149">Festlegen der richtigen Eigenschaftswerte beim Erstellen des D2D-Druck Steuer Elements</span><span class="sxs-lookup"><span data-stu-id="aff34-149">Set the right property values when you create the D2D print control</span></span>](#set-the-right-property-values-when-you-create-the-d2d-print-control)
    -   [<span data-ttu-id="aff34-150">Vermeiden Sie die Verwendung bestimmter Direct2D-Zeichnungs Muster</span><span class="sxs-lookup"><span data-stu-id="aff34-150">Avoid using certain Direct2D drawing patterns</span></span>](#avoid-using-certain-direct2d-drawing-patterns)
    -   [<span data-ttu-id="aff34-151">Text direkt und auf einfache Weise zeichnen</span><span class="sxs-lookup"><span data-stu-id="aff34-151">Draw text in a direct and plain way</span></span>](#draw-text-in-a-direct-and-plain-way)
    -   [<span data-ttu-id="aff34-152">Nach Möglichkeit die ursprünglichen Bitmaps zeichnen</span><span class="sxs-lookup"><span data-stu-id="aff34-152">Draw the original bitmaps when possible</span></span>](#draw-the-original-bitmaps-when-possible)
-   [<span data-ttu-id="aff34-153">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="aff34-153">Conclusion</span></span>](#conclusion)

## <a name="resource-usage"></a><span data-ttu-id="aff34-154">Ressourcenauslastung</span><span class="sxs-lookup"><span data-stu-id="aff34-154">Resource usage</span></span>

<span data-ttu-id="aff34-155">Eine Ressource ist eine Zuordnung einer beliebigen Art, entweder in Video-oder System Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="aff34-155">A resource is an allocation of some kind, either in video or system memory.</span></span> <span data-ttu-id="aff34-156">Bitmaps und Pinsel sind Beispiele für Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="aff34-156">Bitmaps and brushes are examples of resources.</span></span>

<span data-ttu-id="aff34-157">In Direct2D können Ressourcen sowohl in der Software als auch in der Hardware erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-157">In Direct2D, resources can be created both in software and hardware.</span></span> <span data-ttu-id="aff34-158">Die Erstellung und Löschung von Ressourcen auf Hardware ist aufwändig, da Sie viel mehr Aufwand für die Kommunikation mit der Grafikkarte benötigen.</span><span class="sxs-lookup"><span data-stu-id="aff34-158">Resource creation and deletion on hardware are expensive operations because they require lots of overhead for communicating with the video card.</span></span> <span data-ttu-id="aff34-159">Sehen wir uns an, wie Direct2D Inhalt in ein Ziel rendert.</span><span class="sxs-lookup"><span data-stu-id="aff34-159">Let's see how Direct2D renders content to a target.</span></span>

<span data-ttu-id="aff34-160">In Direct2D werden alle renderingbefehle zwischen einem Aufrufen von [**beginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) und einem Aufrufen von [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw)eingeschlossen.</span><span class="sxs-lookup"><span data-stu-id="aff34-160">In Direct2D, all the rendering commands are enclosed between a call to [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) and a call to [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span></span> <span data-ttu-id="aff34-161">Diese Aufrufe werden an ein Renderziel durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="aff34-161">These calls are made to a render target.</span></span> <span data-ttu-id="aff34-162">Sie müssen die **beginDraw** -Methode aufrufen, bevor Sie Renderingvorgänge aufrufen.</span><span class="sxs-lookup"><span data-stu-id="aff34-162">You must call the **BeginDraw** method before you call rendering operations .</span></span> <span data-ttu-id="aff34-163">Nachdem Sie **beginDraw** aufgerufen haben, erstellt ein Kontext in der Regel einen Batch von renderingbefehlen, verzögert jedoch die Verarbeitung dieser Befehle, bis eine der folgenden Aussagen zutrifft:</span><span class="sxs-lookup"><span data-stu-id="aff34-163">After you call **BeginDraw** , a context typically builds up a batch of rendering commands, but delays processing of these commands until one of these statements is true:</span></span>

-   <span data-ttu-id="aff34-164">[**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw) ist aufgetreten.</span><span class="sxs-lookup"><span data-stu-id="aff34-164">[**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw) occurred.</span></span> <span data-ttu-id="aff34-165">Wenn **EndDraw** aufgerufen wird, bewirkt dies, dass alle Batch-Zeichnungsvorgänge ausgeführt werden und der Status des Vorgangs zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="aff34-165">When **EndDraw** is called, it causes any batched drawing operations to complete and returns the status of the operation.</span></span>
-   <span data-ttu-id="aff34-166">Sie führen einen expliziten aufrufungs Vorgang aus: die **Flush** -Methode [**bewirkt, dass**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush)der Batch verarbeitet wird und alle ausstehenden Befehle ausgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-166">You make an explicit call to [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush): The **Flush** method causes the batch to be processed and all pending commands to be issued.</span></span>
-   <span data-ttu-id="aff34-167">Der Puffer mit den renderingbefehlen ist voll.</span><span class="sxs-lookup"><span data-stu-id="aff34-167">The buffer holding the rendering commands is full.</span></span> <span data-ttu-id="aff34-168">Wenn dieser Puffer voll ist, bevor die beiden vorherigen Bedingungen erfüllt sind, werden die renderingbefehle geleert.</span><span class="sxs-lookup"><span data-stu-id="aff34-168">If this buffer becomes full before the previous two conditions are fulfilled, the rendering commands are flushed out.</span></span>

<span data-ttu-id="aff34-169">Bis die primitiven geleert werden, behält Direct2D interne Verweise auf entsprechende Ressourcen wie Bitmaps und Pinsel bei.</span><span class="sxs-lookup"><span data-stu-id="aff34-169">Until the primitives are flushed, Direct2D keeps internal references to corresponding resources like bitmaps and brushes.</span></span>

### <a name="reuse-resources"></a><span data-ttu-id="aff34-170">Ressourcen wieder verwenden</span><span class="sxs-lookup"><span data-stu-id="aff34-170">Reuse resources</span></span>

<span data-ttu-id="aff34-171">Wie bereits erwähnt, ist das Erstellen und Löschen von Ressourcen auf Hardwarekosten aufwendig.</span><span class="sxs-lookup"><span data-stu-id="aff34-171">As already mentioned, resource creation and deletion is expensive on hardware.</span></span> <span data-ttu-id="aff34-172">Verwenden Sie daher nach Möglichkeit Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="aff34-172">So reuse resources when possible.</span></span> <span data-ttu-id="aff34-173">Sehen Sie sich das Beispiel für die bitmaperstellung bei der Spieleentwicklung an.</span><span class="sxs-lookup"><span data-stu-id="aff34-173">Take the example of bitmap creation in game development.</span></span> <span data-ttu-id="aff34-174">Normalerweise werden Bitmaps, die eine Szene in einem Spiel bilden, gleichzeitig mit allen verschiedenen Variationen erstellt, die für das spätere Rendering von Frame-to-Frame-Funktionen erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="aff34-174">Usually, bitmaps that make up a scene in a game are all created at the same time with all the different variations that are required for later frame-to-frame rendering.</span></span> <span data-ttu-id="aff34-175">Zum Zeitpunkt des tatsächlichen Renderings und erneuten Renderings werden diese Bitmaps wieder verwendet, anstatt neu erstellt zu werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-175">At the time of actual scene rendering and re-rendering, these bitmaps are reused instead of re-created.</span></span>

> [!Note]  
> <span data-ttu-id="aff34-176">Ressourcen für den Fenstergrößen Änderung können nicht wieder verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-176">You can't reuse resources for the window resize operation.</span></span> <span data-ttu-id="aff34-177">Wenn die Größe eines Fensters geändert wird, müssen einige Skalierungs abhängige Ressourcen, wie z. b. kompatible Renderziele und möglicherweise einige ebenenressourcen, neu erstellt werden, da der Fensterinhalt neu gezeichnet werden muss.</span><span class="sxs-lookup"><span data-stu-id="aff34-177">When a window is resized, some scale-dependent resources such as compatible render targets and possibly some layer resources must be re-created because the window content has to be redrawn.</span></span> <span data-ttu-id="aff34-178">Dies kann wichtig sein, um die Gesamtqualität der gerenderten Szene beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="aff34-178">This can be important for maintaining the overall quality of the rendered scene.</span></span>

 

## <a name="restrict-the-use-of-flush"></a><span data-ttu-id="aff34-179">Beschränken der Verwendung von Flush</span><span class="sxs-lookup"><span data-stu-id="aff34-179">Restrict the use of flush</span></span>

<span data-ttu-id="aff34-180">Da die [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush) -Methode bewirkt, dass die Batch Rendering-Befehle verarbeitet werden, empfiehlt es sich, Sie nicht zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="aff34-180">Because the [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush) method causes the batched rendering commands to be processed, we recommend that you don't use it.</span></span> <span data-ttu-id="aff34-181">Bei den meisten gängigen Szenarien sollten Sie die Ressourcenverwaltung auf Direct2D überlassen.</span><span class="sxs-lookup"><span data-stu-id="aff34-181">For most common scenarios, leave resource management to Direct2D.</span></span>

## <a name="bitmaps"></a><span data-ttu-id="aff34-182">Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-182">Bitmaps</span></span>

<span data-ttu-id="aff34-183">Wie bereits erwähnt, sind das Erstellen und Löschen von Ressourcen sehr teure Vorgänge in der Hardware.</span><span class="sxs-lookup"><span data-stu-id="aff34-183">As mentioned earlier, resource creation and deletion are very expensive operations in hardware.</span></span> <span data-ttu-id="aff34-184">Eine Bitmap ist eine Art von Ressource, die häufig verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="aff34-184">A bitmap is a kind of resource that is used often.</span></span> <span data-ttu-id="aff34-185">Das Erstellen von Bitmaps auf der Grafikkarte ist aufwendig.</span><span class="sxs-lookup"><span data-stu-id="aff34-185">Creating bitmaps on the video card is expensive.</span></span> <span data-ttu-id="aff34-186">Mithilfe der Wiederverwendung können Sie die Anwendung schneller machen.</span><span class="sxs-lookup"><span data-stu-id="aff34-186">Reusing them can help make the application faster.</span></span>

### <a name="create-large-bitmaps"></a><span data-ttu-id="aff34-187">Erstellen großer Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-187">Create large bitmaps</span></span>

<span data-ttu-id="aff34-188">Grafikkarten verfügen in der Regel über eine Mindestgröße für die Speicher Belegung.</span><span class="sxs-lookup"><span data-stu-id="aff34-188">Video cards typically have a minimum memory allocation size.</span></span> <span data-ttu-id="aff34-189">Wenn eine Zuweisung angefordert wird, die kleiner als diese ist, wird eine Ressource dieser Mindestgröße zugeordnet, und der überschüssige Arbeitsspeicher wird verschwendet und ist für andere Dinge nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="aff34-189">If an allocation is requested that is smaller than this, a resource of this minimum size is allocated and the surplus memory is wasted and unavailable for other things.</span></span> <span data-ttu-id="aff34-190">Wenn Sie viele kleine Bitmaps benötigen, ist es besser, eine große Bitmap zuzuordnen und den gesamten kleinen Bitmapinhalt in dieser großen Bitmap zu speichern.</span><span class="sxs-lookup"><span data-stu-id="aff34-190">If you need many small bitmaps, a better technique is to allocate one large bitmap and store all the small bitmap contents in this large bitmap.</span></span> <span data-ttu-id="aff34-191">Dann kann das untergeordnete Element der größeren Bitmap gelesen werden, wenn die kleineren Bitmaps benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-191">Then subareas of the larger bitmap can be read where the smaller bitmaps are needed.</span></span> <span data-ttu-id="aff34-192">Häufig sollten Sie zwischen den kleinen Bitmaps Auffüll Zeichen (transparente schwarze Pixel) einschließen, um die Interaktion zwischen den kleineren Bildern während des Vorgangs zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="aff34-192">Often, you should include padding (transparent black pixels) in between the small bitmaps to avoid any interaction between the smaller images during operations.</span></span> <span data-ttu-id="aff34-193">Dies wird auch als *Atlas* bezeichnet und hat den Vorteil, dass der Aufwand der bitmaperstellung und die Arbeitsspeicher Verschwendung von kleinen bitmapzuordnungen verringert werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-193">This is also known as an *atlas*, and it has the benefit of reducing bitmap creation overhead and the memory waste of small bitmap allocations.</span></span> <span data-ttu-id="aff34-194">Es wird empfohlen, die meisten Bitmaps auf mindestens 64 KB beizubehalten und die Anzahl der Bitmaps, die kleiner als 4 KB sind, einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="aff34-194">We recommend that you keep most bitmaps to at least 64 KB and limit the number of bitmaps that are smaller than 4 KB.</span></span>

### <a name="create-an-atlas-of-bitmaps"></a><span data-ttu-id="aff34-195">Erstellen eines Atlas von Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-195">Create an atlas of bitmaps</span></span>

<span data-ttu-id="aff34-196">Es gibt einige gängige Szenarios, für die ein Bitmap-Atlas sehr gut geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="aff34-196">There are some common scenarios for which a bitmap atlas can serve very well.</span></span> <span data-ttu-id="aff34-197">Kleine Bitmaps können innerhalb einer großen Bitmap gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-197">Small bitmaps can be stored inside a large bitmap.</span></span> <span data-ttu-id="aff34-198">Diese kleinen Bitmaps können aus der größeren Bitmap herausgezogen werden, wenn Sie Sie durch Angabe des Ziel Rechtecks benötigen.</span><span class="sxs-lookup"><span data-stu-id="aff34-198">These small bitmaps can be pulled out of the larger bitmap when you need them by specifying the destination rectangle.</span></span> <span data-ttu-id="aff34-199">Beispielsweise muss eine Anwendung mehrere Symbole zeichnen.</span><span class="sxs-lookup"><span data-stu-id="aff34-199">For example, an application has to draw multiple icons.</span></span> <span data-ttu-id="aff34-200">Alle den Symbolen zugeordneten Bitmaps können im Vordergrund in eine große Bitmap geladen werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-200">All the bitmaps associated with the icons can be loaded into a large bitmap up front.</span></span> <span data-ttu-id="aff34-201">Und zur Renderingzeit können Sie aus der großen Bitmap abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-201">And at rendering time, they can be retrieved from the large bitmap.</span></span>

> [!Note]  
> <span data-ttu-id="aff34-202">Eine Direct2D-Bitmap, die im Videospeicher erstellt wurde, ist auf die maximale Bitmapgröße beschränkt, die vom Adapter unterstützt wird, auf dem Sie gespeichert ist.</span><span class="sxs-lookup"><span data-stu-id="aff34-202">A Direct2D bitmap created in video memory is limited to the maximum bitmap size supported by the adapter on which it is stored.</span></span> <span data-ttu-id="aff34-203">Das Erstellen einer Bitmap, die größer als ist, kann zu einem Fehler führen.</span><span class="sxs-lookup"><span data-stu-id="aff34-203">Creating a bitmap larger than that might result in an error.</span></span>

 

> [!Note]  
> <span data-ttu-id="aff34-204">Ab Windows 8 umfasst Direct2D einen Atlas- [Effekt](atlas.md) , der diesen Prozess vereinfachen kann.</span><span class="sxs-lookup"><span data-stu-id="aff34-204">Starting in Windows 8, Direct2D includes an [Atlas effect](atlas.md) that can make this process easier.</span></span>

 

### <a name="create-shared-bitmaps"></a><span data-ttu-id="aff34-205">Erstellen von freigegebenen Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-205">Create shared bitmaps</span></span>

<span data-ttu-id="aff34-206">Durch das Erstellen von freigegebenen Bitmaps können erweiterte Aufrufer Direct2D Bitmap-Objekte erstellen, die direkt durch ein vorhandenes, mit dem Renderziel kompatibles Objekt unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-206">Creating shared bitmaps enables advanced callers to create Direct2D bitmap objects that are backed directly by an existing object, already compatible with the render target.</span></span> <span data-ttu-id="aff34-207">Dadurch wird das Erstellen mehrerer Oberflächen vermieden, und der Leistungs Aufwand wird reduziert.</span><span class="sxs-lookup"><span data-stu-id="aff34-207">This avoids creating multiple surfaces and helps in reducing performance overhead.</span></span>

> [!Note]  
> <span data-ttu-id="aff34-208">Freigegebene Bitmaps sind in der Regel auf Software Ziele oder Ziele beschränkt, die mit DXGI interoperabel sind.</span><span class="sxs-lookup"><span data-stu-id="aff34-208">Shared bitmaps are usually limited to software targets or to targets interoperable with DXGI.</span></span> <span data-ttu-id="aff34-209">Verwenden Sie die Methoden "| [**atebitmapfromdxgisurface**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1_id2d1bitmap1))", " [**kreatebitmapfromwicbitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1))" und " [**foatesharedbitmap**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) " zum Erstellen von freigegebenen Bitmaps.</span><span class="sxs-lookup"><span data-stu-id="aff34-209">Use the [**CreateBitmapFromDxgiSurface**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1_id2d1bitmap1)), [**CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1)), and [**CreateSharedBitmap**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) methods to create shared bitmaps.</span></span>

 

### <a name="copying-bitmaps"></a><span data-ttu-id="aff34-210">Kopieren von Bitmaps</span><span class="sxs-lookup"><span data-stu-id="aff34-210">Copying bitmaps</span></span>

<span data-ttu-id="aff34-211">Das Erstellen einer DXGI-Oberfläche ist ein kostspieliger Vorgang, sodass Sie vorhandene Oberflächen wieder verwenden können.</span><span class="sxs-lookup"><span data-stu-id="aff34-211">Creating a DXGI surface is an expensive operation so reuse existing surfaces when you can.</span></span> <span data-ttu-id="aff34-212">Auch wenn eine Bitmap in der Software größtenteils das gewünschte Formular hat, mit Ausnahme eines kleinen Teils, ist es besser, diesen Teil zu aktualisieren, als die gesamte Bitmap zu lösen und alles neu zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="aff34-212">Even in software, if a bitmap is mostly in the form you want except for a small portion, it is better to update that portion than to throw the whole bitmap away and re-create everything.</span></span> <span data-ttu-id="aff34-213">Obwohl Sie die gleichen Ergebnisse mithilfe von "" mit "" "" mit "" "" mit "" [**"mit"**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) "mit" "auf das gleiche Ergebnis erzielen können, ist Rendering</span><span class="sxs-lookup"><span data-stu-id="aff34-213">Although you can use [**CreateCompatibleRenderTarget**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) to achieve the same results, rendering is generally a much more expensive operation than copying.</span></span> <span data-ttu-id="aff34-214">Der Grund hierfür ist, dass die Hardware zum Verbessern der Cache Lokalität nicht tatsächlich eine Bitmap in derselben Speicher Reihenfolge speichert, in der die Bitmap adressiert ist.</span><span class="sxs-lookup"><span data-stu-id="aff34-214">This is because, to improve cache locality, the hardware doesn't actually store a bitmap in the same memory order that the bitmap is addressed.</span></span> <span data-ttu-id="aff34-215">Stattdessen wird die Bitmap möglicherweise durch ein-und ausgeblendet.</span><span class="sxs-lookup"><span data-stu-id="aff34-215">Instead, the bitmap might be swizzled.</span></span> <span data-ttu-id="aff34-216">Die schwingenden Elemente werden von der CPU entweder durch den Treiber (der langsam und nur für untere Teile verwendet wird) oder durch den Speicher-Manager auf der GPU ausgeblendet.</span><span class="sxs-lookup"><span data-stu-id="aff34-216">The swizzling is hidden from the CPU either by the driver (which is slow and used only on lower-end parts), or by the memory manager on the GPU.</span></span> <span data-ttu-id="aff34-217">Aufgrund von Einschränkungen der Art und Weise, wie Daten beim Rendern in ein Renderziel geschrieben werden, werden Renderziele in der Regel nicht mit einem Drilldown oder einem Drilldown auf eine Weise, die weniger optimal ist als möglich, wenn Sie wissen, dass Sie nicht auf die Oberfläche gerendert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="aff34-217">Because of constraints on how data is written into a render target when rendering, render targets are typically either not swizzled, or swizzled in a way that is less optimal than can be achieved if you know that you never have to render to the surface.</span></span> <span data-ttu-id="aff34-218">Aus diesem Grund werden die [CopyFrom](/windows/desktop/api/d2d1/nn-d2d1-id2d1bitmap) - \* Methoden zum Kopieren von Rechtecke aus einer Quelle in die Direct2D-Bitmap bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="aff34-218">Therefore, the [CopyFrom](/windows/desktop/api/d2d1/nn-d2d1-id2d1bitmap)\* methods are provided for copying rectangles from a source to the Direct2D bitmap.</span></span>

<span data-ttu-id="aff34-219">CopyFrom kann in einer der drei folgenden Formen verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="aff34-219">CopyFrom can be used in any of its three forms:</span></span>

-   [<span data-ttu-id="aff34-220">**Copyfrombitmap**</span><span class="sxs-lookup"><span data-stu-id="aff34-220">**CopyFromBitmap**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrombitmap)
-   [<span data-ttu-id="aff34-221">**Copyfromrendertarget**</span><span class="sxs-lookup"><span data-stu-id="aff34-221">**CopyFromRenderTarget**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfromrendertarget)
-   [<span data-ttu-id="aff34-222">**Copyfrommemory**</span><span class="sxs-lookup"><span data-stu-id="aff34-222">**CopyFromMemory**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrommemory)

## <a name="use-tiled-bitmap-over-dashing"></a><span data-ttu-id="aff34-223">Kachelingbitmap über dashlover verwenden</span><span class="sxs-lookup"><span data-stu-id="aff34-223">Use tiled bitmap over dashing</span></span>

<span data-ttu-id="aff34-224">Das Rendern einer gestrichelten Linie ist aufgrund der hohen Qualität und Genauigkeit des zugrunde liegenden Algorithmus ein sehr aufwändiger Vorgang.</span><span class="sxs-lookup"><span data-stu-id="aff34-224">Rendering a dashed line is a very expensive operation because of the high quality and accuracy of the underlying algorithm.</span></span> <span data-ttu-id="aff34-225">In den meisten Fällen, in denen keine wiederholenden Geometrien beteiligt sind, kann der gleiche Effekt mithilfe von gekachelten Bitmaps schneller generiert werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-225">For most of the cases not involving rectilinear geometries, the same effect can be generated faster by using tiled bitmaps.</span></span>

## <a name="general-guidelines-for-rendering-complex-static-content"></a><span data-ttu-id="aff34-226">Allgemeine Richtlinien zum Rendern komplexer statischer Inhalte</span><span class="sxs-lookup"><span data-stu-id="aff34-226">General guidelines for rendering complex static content</span></span>

<span data-ttu-id="aff34-227">Zwischenspeichern von Inhalten, wenn Sie den gleichen Inhalts Frame über Frame darstellen, insbesondere, wenn die Szene Komplex ist.</span><span class="sxs-lookup"><span data-stu-id="aff34-227">Cache content if you render the same content frame over frame, especially when the scene is complex.</span></span>

<span data-ttu-id="aff34-228">Es gibt drei Verfahren zum Zwischenspeichern, die Sie verwenden können:</span><span class="sxs-lookup"><span data-stu-id="aff34-228">There are three caching techniques that you can use:</span></span>

-   <span data-ttu-id="aff34-229">Vollständiges Szenen Caching mithilfe einer Farb Bitmap.</span><span class="sxs-lookup"><span data-stu-id="aff34-229">Full scene caching using a color bitmap.</span></span>
-   <span data-ttu-id="aff34-230">Pro primitiver Zwischenspeicherung mithilfe einer A8-Bitmap und der [**fillopacitymask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-fillopacitymask(id2d1bitmap_id2d1brush_constd2d1_rect_f_constd2d1_rect_f)) -Methode.</span><span class="sxs-lookup"><span data-stu-id="aff34-230">Per primitive caching using an A8 bitmap and the [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-fillopacitymask(id2d1bitmap_id2d1brush_constd2d1_rect_f_constd2d1_rect_f)) method.</span></span>
-   <span data-ttu-id="aff34-231">Pro primitiver Zwischenspeicherung mithilfe von Geometry-Vorgängen.</span><span class="sxs-lookup"><span data-stu-id="aff34-231">Per-primitive caching using geometry realizations.</span></span>

<span data-ttu-id="aff34-232">Sehen wir uns diese Details genauer an.</span><span class="sxs-lookup"><span data-stu-id="aff34-232">Let's look at each of these in more detail.</span></span>

### <a name="full-scene-caching-using-a-color-bitmap"></a><span data-ttu-id="aff34-233">Vollständiges Szenen Caching mithilfe einer Farb Bitmap</span><span class="sxs-lookup"><span data-stu-id="aff34-233">Full scene caching using a color bitmap</span></span>

<span data-ttu-id="aff34-234">Wenn Sie statischen Inhalt in Szenarios wie Animation darstellen, erstellen Sie eine weitere vollfarbige Bitmap, anstatt Sie direkt in die Bildschirm Bitmap zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="aff34-234">When you render static content, in scenarios like animation, create another full color bitmap instead of writing directly to the screen bitmap.</span></span> <span data-ttu-id="aff34-235">Speichern Sie das aktuelle Ziel, legen Sie Ziel auf die zwischen Bitmap fest, und rendersie den statischen Inhalt.</span><span class="sxs-lookup"><span data-stu-id="aff34-235">Save the current target, set target to the intermediate bitmap, and render the static content.</span></span> <span data-ttu-id="aff34-236">Wechseln Sie dann zurück zur ursprünglichen Bildschirm Bitmap, und zeichnen Sie das zwischenbitmap darauf.</span><span class="sxs-lookup"><span data-stu-id="aff34-236">Then, switch back to the original screen bitmap and draw the intermediate bitmap on it.</span></span>

<span data-ttu-id="aff34-237">Hier sehen Sie ein Beispiel:</span><span class="sxs-lookup"><span data-stu-id="aff34-237">Here's an example:</span></span>


```C++
// Create a bitmap.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_B8G8R8A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &sceneBitmap);

// Preserve the pre-existing target.
ComPtr<ID2D1Image> oldTarget;
m_d2dContext->GetTarget(&oldTarget);

// Render static content to the sceneBitmap.
m_d2dContext->SetTarget(sceneBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Render sceneBitmap to oldTarget.
m_d2dContext->SetTarget(oldTarget.Get());
m_d2dContext->DrawBitmap(sceneBitmap.Get());
```



<span data-ttu-id="aff34-238">In diesem Beispiel werden zwischen Bitmaps zum Zwischenspeichern verwendet und die Bitmap gewechselt, auf die der Gerätekontext beim Rendern zeigt.</span><span class="sxs-lookup"><span data-stu-id="aff34-238">This example uses intermediate bitmaps for caching and switches the bitmap that the device context points to when it renders.</span></span> <span data-ttu-id="aff34-239">Dadurch wird vermieden, dass ein kompatibles Renderziel für denselben Zweck erstellt werden muss.</span><span class="sxs-lookup"><span data-stu-id="aff34-239">This avoids the need to create a compatible render target for the same purpose.</span></span>

### <a name="per-primitive-caching-using-an-a8-bitmap-and-the-fillopacitymask-method"></a><span data-ttu-id="aff34-240">Pro primitiver Zwischenspeicherung mithilfe einer A8-Bitmap und der fillopacitymask-Methode</span><span class="sxs-lookup"><span data-stu-id="aff34-240">Per primitive caching using an A8 bitmap and the FillOpacityMask method</span></span>

<span data-ttu-id="aff34-241">Wenn die vollständige Szene nicht statisch ist, aber aus Elementen wie Geometrie oder statischem Text besteht, können Sie eine pro primitiver zwischen Speicherungs Methode verwenden.</span><span class="sxs-lookup"><span data-stu-id="aff34-241">When the full scene is not static, but consists of elements like geometry or text that are static, you can use a per primitive caching technique.</span></span> <span data-ttu-id="aff34-242">Diese Methode behält die Antialiasing-Merkmale des primitiven bei, das zwischengespeichert wird, und funktioniert mit veränderlichen Pinseltypen.</span><span class="sxs-lookup"><span data-stu-id="aff34-242">This technique preserves the antialiasing characteristics of the primitive being cached and works with changing brush types.</span></span> <span data-ttu-id="aff34-243">Es wird eine A8-Bitmap verwendet, wobei A8 eine Art von Pixel Format ist, das einen Alphakanal mit 8 Bits darstellt.</span><span class="sxs-lookup"><span data-stu-id="aff34-243">It uses an A8 bitmap where A8 is a kind of pixel format which represents an alpha channel with 8 bits.</span></span> <span data-ttu-id="aff34-244">A8-Bitmaps sind nützlich zum Zeichnen von Geometrie und Text als Maske.</span><span class="sxs-lookup"><span data-stu-id="aff34-244">A8 bitmaps are useful for drawing geometry/text as a mask.</span></span> <span data-ttu-id="aff34-245">Wenn Sie die Deckkraft von statischem Inhalt ändern müssen, anstatt den eigentlichen Inhalt zu bearbeiten, können Sie die Deckkraft der Maske übersetzen, drehen, neigen oder skalieren.</span><span class="sxs-lookup"><span data-stu-id="aff34-245">When you must manipulate the opacity of static content , instead of manipulating the content itself, you can translate, rotate, skew, or scale the opacity of the mask.</span></span>

<span data-ttu-id="aff34-246">Hier sehen Sie ein Beispiel:</span><span class="sxs-lookup"><span data-stu-id="aff34-246">Here's an example:</span></span>


```C++
// Create an opacity bitmap.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &opacityBitmap);

// Preserve the pre-existing target.
ComPtr<ID2D1Image> oldTarget;
m_d2dContext->GetTarget(&oldTarget);

// Render to the opacityBitmap.
m_d2dContext->SetTarget(opacityBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Call the FillOpacityMask method
// Note: for this call to work correctly the anti alias mode must be D2D1_ANTIALIAS_MODE_ALIASED. 
m_d2dContext->SetTarget(oldTarget.Get());
m_d2dContext->FillOpacityMask(
    opacityBitmap.Get(),
    m_contentBrush().Get(),
    D2D1_OPACITY_MASK_CONTENT_GRAPHICS);
```



## <a name="per-primitive-caching-using-geometry-realizations"></a><span data-ttu-id="aff34-247">Pro primitiver Zwischenspeicherung mithilfe von Geometry-neueinrichtungen</span><span class="sxs-lookup"><span data-stu-id="aff34-247">Per-primitive caching using geometry realizations</span></span>

<span data-ttu-id="aff34-248">Eine weitere pro primitiver zwischen Speicherungs Technik, die als Geometry-Neuerstellung bezeichnet wird, bietet mehr Flexibilität beim Umgang mit Geometrie.</span><span class="sxs-lookup"><span data-stu-id="aff34-248">Another per-primitive caching technique, called geometry realizations, provides greater flexibility when dealing with geometry.</span></span> <span data-ttu-id="aff34-249">Wenn Sie ein-oder Antialiasing-Geometrien wiederholt zeichnen möchten, ist es schneller, Sie in Geometry-neueinformen zu konvertieren und die Neuerungen zu zeichnen, als Sie wiederholt die Geometrien selbst zeichnen.</span><span class="sxs-lookup"><span data-stu-id="aff34-249">When you want to repeatedly draw aliased or anti-aliased geometries, it is faster to convert them to geometry realizations and repeatedly draw the realizations than it is to repeatedly draw the geometries themselves.</span></span> <span data-ttu-id="aff34-250">Geometry-neustellungen verbrauchen in der Regel weniger Speicher als Deck Kraft Masken (insbesondere bei großen Geometrien), und Sie sind weniger sensibel bei Skalierungs Änderungen.</span><span class="sxs-lookup"><span data-stu-id="aff34-250">Geometry realizations also generally consume less memory than opacity masks (especially for large geometries), and they are less sensitive to changes in scale.</span></span> <span data-ttu-id="aff34-251">Weitere Informationen finden Sie unter [Übersicht über Geometry](geometry-realizations-overview.md)-neueinformationen.</span><span class="sxs-lookup"><span data-stu-id="aff34-251">For more information, see [Geometry Realizations Overview](geometry-realizations-overview.md).</span></span>

<span data-ttu-id="aff34-252">Hier sehen Sie ein Beispiel:</span><span class="sxs-lookup"><span data-stu-id="aff34-252">Here's an example:</span></span>


```C++
    // Compute a flattening tolerance based on the scales at which the realization will be used.
    float flatteningTolerance = D2D1::ComputeFlatteningTolerance(...);

    ComPtr<ID2D1GeometryRealization> geometryRealization;

    // Create realization of the filled interior of the geometry.
    m_d2dDeviceContext1->CreateFilledGeometryRealization(
        geometry.Get(),
        flatteningTolerance,
        &geometryRealization
        );

    // In your app's rendering code, draw the geometry realization with a brush.
    m_d2dDeviceContext1->BeginDraw();
    m_d2dDeviceContext1->DrawGeometryRealization(
        geometryRealization.Get(),
        m_brush.Get()
        );
    m_d2dDeviceContext1->EndDraw();
```



## <a name="geometry-rendering"></a><span data-ttu-id="aff34-253">Geometrie Rendering</span><span class="sxs-lookup"><span data-stu-id="aff34-253">Geometry rendering</span></span>

### <a name="use-specific-draw-primitive-over-draw-geometry"></a><span data-ttu-id="aff34-254">Bestimmtes zeichnen-primitiv überzeichnen-Geometrie verwenden</span><span class="sxs-lookup"><span data-stu-id="aff34-254">Use specific draw primitive over draw geometry</span></span>

<span data-ttu-id="aff34-255">Verwenden Sie spezifischere zeichnen *primitiver* Aufrufe wie [**drawrechteck**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawrectangle(constd2d1_rect_f__id2d1brush_float_id2d1strokestyle)) über generische [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry) -Aufrufe.</span><span class="sxs-lookup"><span data-stu-id="aff34-255">Use more specific draw *primitive* calls like [**DrawRectangle**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawrectangle(constd2d1_rect_f__id2d1brush_float_id2d1strokestyle)) over generic [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry) calls.</span></span> <span data-ttu-id="aff34-256">Dies liegt daran, dass die Geometrie mit **drawrechteck** bereits bekannt ist, sodass das Rendering schneller ist.</span><span class="sxs-lookup"><span data-stu-id="aff34-256">This is because with **DrawRectangle**, the geometry is already known so rendering is faster.</span></span>

### <a name="rendering-static-geometry"></a><span data-ttu-id="aff34-257">Rendern statischer Geometrie</span><span class="sxs-lookup"><span data-stu-id="aff34-257">Rendering static geometry</span></span>

<span data-ttu-id="aff34-258">In Szenarien, in denen die Geometrie statisch ist, verwenden Sie die oben erläuterten grundlegenden Caching-Techniken.</span><span class="sxs-lookup"><span data-stu-id="aff34-258">In scenarios where the geometry is static, use the per-primitive caching techniques explained above.</span></span> <span data-ttu-id="aff34-259">Durch Deck Kraft Masken und Geometrie-Real Messungen kann die renderinggeschwindigkeit von Szenen, die statische Geometrie enthalten, erheblich verbessert werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-259">Opacity masks and geometry realizations can greatly improve the rendering speed of scenes that contain static geometry..</span></span>

### <a name="use-a-multithreaded-device-context"></a><span data-ttu-id="aff34-260">Verwenden eines Multithread-Geräte Kontexts</span><span class="sxs-lookup"><span data-stu-id="aff34-260">Use a multithreaded device context</span></span>

<span data-ttu-id="aff34-261">Anwendungen, die eine beträchtliche Menge an komplexen geometrischen Inhalten darstellen, sollten beim Erstellen eines [Direct2D](./direct2d-portal.md) -Geräte Kontexts die [**D2D1-Gerätekontext Optionen das Flag zum Aktivieren von \_ \_ \_ \_ \_ \_ \_ multithreadoptimierungen aktivieren**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_device_context_options) .</span><span class="sxs-lookup"><span data-stu-id="aff34-261">Applications that expect to render significant amounts of complex geometric content should consider specifying the [**D2D1\_DEVICE\_CONTEXT\_OPTIONS\_ENABLE\_MULTI\_THREADED\_OPTIMIZATIONS**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_device_context_options) flag when creating a [Direct2D](./direct2d-portal.md) device context.</span></span> <span data-ttu-id="aff34-262">Wenn dieses Flag angegeben ist, verteilt Direct2D das Rendering auf alle logischen Kerne, die auf dem System vorhanden sind. Dies kann die Gesamt Renderingzeit erheblich verringern.</span><span class="sxs-lookup"><span data-stu-id="aff34-262">When this flag is specified, Direct2D will distribute rendering across all of the logical cores present on the system, which can significantly decrease overall rendering time.</span></span>

<span data-ttu-id="aff34-263">Hinweise:</span><span class="sxs-lookup"><span data-stu-id="aff34-263">Notes:</span></span>

-   <span data-ttu-id="aff34-264">Ab Windows 8.1 wirkt sich dieses Flag nur auf das Rendern von Pfad Geometrie aus.</span><span class="sxs-lookup"><span data-stu-id="aff34-264">As of Windows 8.1, this flag only affects path geometry rendering.</span></span> <span data-ttu-id="aff34-265">Es hat keine Auswirkung auf Szenen, die nur andere primitive Typen enthalten (z. b. Text, Bitmaps oder Geometrie-neueinrichtungen).</span><span class="sxs-lookup"><span data-stu-id="aff34-265">It has no impact on scenes containing only other primitive types (such as text, bitmaps, or geometry realizations).</span></span>
-   <span data-ttu-id="aff34-266">Dieses Flag hat auch keine Auswirkung auf das Rendering in Software (d. h. beim Rendern mit einem Warp Direct3D-Gerät).</span><span class="sxs-lookup"><span data-stu-id="aff34-266">This flag also has no impact when rendering in software (i.e. when rendering with a WARP Direct3D device).</span></span> <span data-ttu-id="aff34-267">Um das Multithreading von Software zu steuern, sollten Aufrufer \_ \_ \_ \_ \_ \_ beim Erstellen des Warp Direct3D-Geräts das Flag D3D11 Create Device Internal Threading Optimierungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="aff34-267">To control software multithreading, callers should use the D3D11\_CREATE\_DEVICE\_PREVENT\_INTERNAL\_THREADING\_OPTIMIZATIONS flag when creating the WARP Direct3D device.</span></span>
-   <span data-ttu-id="aff34-268">Wenn Sie dieses Flag angeben, kann das Workingset beim Rendering erhöht werden, und es können auch Thread Konflikte in Anwendungen erhöht werden, die die Multithreadverarbeitung bereits nutzen.</span><span class="sxs-lookup"><span data-stu-id="aff34-268">Specifying this flag can increase peak working set during rendering and can also increase thread contention in applications that already take advantage of multithreaded processing.</span></span>

## <a name="drawing-text-with-direct2d"></a><span data-ttu-id="aff34-269">Zeichnen von Text mit Direct2D</span><span class="sxs-lookup"><span data-stu-id="aff34-269">Drawing text with Direct2D</span></span>

<span data-ttu-id="aff34-270">Die Direct2D-Text Rendering-Funktionalität wird in zwei Teilen angeboten.</span><span class="sxs-lookup"><span data-stu-id="aff34-270">Direct2D text rendering functionality is offered in two parts.</span></span> <span data-ttu-id="aff34-271">Der erste Teil, der als [**ID2D1RenderTarget::D rawtext**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) -und [**ID2D1RenderTarget::D rawtextlayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) -Methode verfügbar gemacht wird, ermöglicht einem Aufrufer, entweder einen Zeichen folgen-und einen Formatierungs Parameter oder ein dwrite-Text Layout-Objekt für mehrere Formate zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="aff34-271">The first part, exposed as the [**ID2D1RenderTarget::DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) and [**ID2D1RenderTarget::DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) method, enables a caller to pass either a string and formatting parameters or a DWrite text layout object for multiple formats.</span></span> <span data-ttu-id="aff34-272">Dies sollte für die meisten Aufrufer geeignet sein.</span><span class="sxs-lookup"><span data-stu-id="aff34-272">This should be suitable for most callers.</span></span> <span data-ttu-id="aff34-273">Die zweite Möglichkeit zum Rendering von Text, der als [**ID2D1RenderTarget::D rawglyphrun-**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawglyphrun) Methode verfügbar gemacht wird, bietet eine rasterisierung für Kunden, die bereits die Position der Symbole kennen, die Sie darstellen möchten.</span><span class="sxs-lookup"><span data-stu-id="aff34-273">The second way to render text, exposed as the [**ID2D1RenderTarget::DrawGlyphRun**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawglyphrun) method, provides rasterization for customers who already know the position of the glyphs they want to render.</span></span> <span data-ttu-id="aff34-274">Die folgenden beiden allgemeinen Regeln können dabei helfen, die Text Leistung beim Zeichnen in Direct2D zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="aff34-274">The following two general rules can help improve text performance when drawing in Direct2D.</span></span>

### <a name="drawtextlayout-vs-drawtext"></a><span data-ttu-id="aff34-275">Drawtextlayout im Vergleich zu DrawText</span><span class="sxs-lookup"><span data-stu-id="aff34-275">DrawTextLayout Vs. DrawText</span></span>

<span data-ttu-id="aff34-276">Sowohl [**DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) als auch [**drawtextlayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) ermöglichen einer Anwendung das einfache Rendering von Text, der von der [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) -API formatiert wird.</span><span class="sxs-lookup"><span data-stu-id="aff34-276">Both [**DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) and [**DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) enable an application to easily render text that is formatted by the [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) API.</span></span> <span data-ttu-id="aff34-277">**Drawtextlayout** zeichnet ein vorhandenes [**dwrite-Textlayout**](/windows/desktop/api/dwrite/nn-dwrite-idwritetextlayout) -Objekt mit [**renderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget), und **DrawText** erstellt basierend auf den Parametern, die übergeben werden, ein DirectWrite-Layout für den Aufrufer.</span><span class="sxs-lookup"><span data-stu-id="aff34-277">**DrawTextLayout** draws an existing [**DWriteTextLayout**](/windows/desktop/api/dwrite/nn-dwrite-idwritetextlayout) object to the [**RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget), and **DrawText** constructs a DirectWrite layout for the caller, based on the parameters that are passed in.</span></span> <span data-ttu-id="aff34-278">Wenn derselbe Text mehrmals gerendert werden muss, verwenden Sie **drawtextlayout** anstelle von **DrawText**, da **DrawText** jedes Mal, wenn er aufgerufen wird, ein Layout erstellt.</span><span class="sxs-lookup"><span data-stu-id="aff34-278">If the same text has to be rendered multiple times, use **DrawTextLayout** instead of **DrawText**, because **DrawText** creates a layout every time that it is called.</span></span>

### <a name="choosing-the-right-text-rendering-mode"></a><span data-ttu-id="aff34-279">Auswählen des richtigen textrenderingmodus</span><span class="sxs-lookup"><span data-stu-id="aff34-279">Choosing the right text rendering mode</span></span>

<span data-ttu-id="aff34-280">Legen Sie für den Text-antialiasmodus den [**D2D1 \_ Text- \_ Antialias Modus \_ \_ Grayscale**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode) explizit fest.</span><span class="sxs-lookup"><span data-stu-id="aff34-280">Set the text antialias mode to [**D2D1\_TEXT\_ANTIALIAS\_MODE\_GRAYSCALE**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode) explicitly.</span></span> <span data-ttu-id="aff34-281">Die Qualität des Renderings von Graustufen Text ist mit ClearType vergleichbar, aber viel schneller.</span><span class="sxs-lookup"><span data-stu-id="aff34-281">The quality of rendering grayscale text is comparable to ClearType but is much faster.</span></span>

### <a name="caching"></a><span data-ttu-id="aff34-282">Zwischenspeicherung</span><span class="sxs-lookup"><span data-stu-id="aff34-282">Caching</span></span>

<span data-ttu-id="aff34-283">Verwenden Sie die vollständige Szene oder das Zwischenspeichern der primitiven Bitmap, wie z. b. das Zeichnen von</span><span class="sxs-lookup"><span data-stu-id="aff34-283">Use full scene or per primitive bitmap caching like with drawing other primitives.</span></span>

## <a name="clipping-an-arbitrary-shape"></a><span data-ttu-id="aff34-284">Clipping einer beliebigen Form</span><span class="sxs-lookup"><span data-stu-id="aff34-284">Clipping an arbitrary shape</span></span>

<span data-ttu-id="aff34-285">Die Abbildung zeigt das Ergebnis der Anwendung eines Clips auf ein Bild.</span><span class="sxs-lookup"><span data-stu-id="aff34-285">The figure here shows the result of applying a clip to an image.</span></span>

![ein Bild, das ein Beispiel eines Bilds vor und nach einem Clip anzeigt.](images/clip.png)

<span data-ttu-id="aff34-287">Sie können dieses Ergebnis mithilfe von Ebenen mit einer Geometrie Maske oder der [**fillgeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) -Methode mit einem Deckkraft Pinsel erhalten.</span><span class="sxs-lookup"><span data-stu-id="aff34-287">You can get this result by using layers with a geometry mask or the [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) method with an opacity brush.</span></span>

<span data-ttu-id="aff34-288">Im folgenden finden Sie ein Beispiel, in dem eine Ebene verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="aff34-288">Here's an example that uses a layer:</span></span>


```C++
// Call PushLayer() and pass in the clipping geometry.
m_d2dContext->PushLayer(
    D2D1::LayerParameters(
        boundsRect,
        geometricMask));
```



<span data-ttu-id="aff34-289">Es folgt ein Beispiel, in dem die [**fillgeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) -Methode verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="aff34-289">Here's an example that uses the [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) method:</span></span>


```C++
// Create an opacity bitmap and render content.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &opacityBitmap);

m_d2dContext->SetTarget(opacityBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Create an opacity brush from the opacity bitmap.
m_d2dContext->CreateBitmapBrush(opacityBitmap.Get(),
    D2D1::BitmapBrushProperties(),
    D2D1::BrushProperties(),
    &bitmapBrush);

// Call the FillGeometry method and pass in the clip geometry and the opacity brush
m_d2dContext->FillGeometry( 
    clipGeometry.Get(),
    brush.Get(),
    opacityBrush.Get()); 
```



<span data-ttu-id="aff34-290">Wenn Sie in diesem Codebeispiel die pushlayer-Methode aufzurufen, übergeben Sie keine von der APP erstellte Ebene.</span><span class="sxs-lookup"><span data-stu-id="aff34-290">In this code example, when you call the PushLayer method, you don't pass in an app created layer.</span></span> <span data-ttu-id="aff34-291">Direct2D erstellt eine Ebene für Sie.</span><span class="sxs-lookup"><span data-stu-id="aff34-291">Direct2D creates a layer for you.</span></span> <span data-ttu-id="aff34-292">Direct2D ist in der Lage, die Zuordnung und Zerstörung dieser Ressource ohne Beteiligung der APP zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="aff34-292">Direct2D is able to manage the allocation and destruction of this resource without any involvement from the app.</span></span> <span data-ttu-id="aff34-293">Dadurch kann Direct2D Ebenen intern wieder verwenden und Ressourcen Verwaltungs Optimierungen anwenden.</span><span class="sxs-lookup"><span data-stu-id="aff34-293">This allows Direct2D to reuse layers internally and apply resource management optimizations.</span></span>

<span data-ttu-id="aff34-294">In Windows 8 wurden viele Optimierungen an der Verwendung von Ebenen vorgenommen, und es wird empfohlen, die Verwendung von ebenenapis anstelle von [**fillgeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) zu verwenden, wenn dies möglich ist.</span><span class="sxs-lookup"><span data-stu-id="aff34-294">In Windows 8 many optimizations have been made to the usage of layers and we recommend you try using layer APIs instead of [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) whenever possible.</span></span>

### <a name="pushlayer-in-windows-8"></a><span data-ttu-id="aff34-295">Pushlayer in Windows 8</span><span class="sxs-lookup"><span data-stu-id="aff34-295">PushLayer in Windows 8</span></span>

<span data-ttu-id="aff34-296">Die [**ID2D1DeviceContext**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1devicecontext) -Schnittstelle wird von der [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) -Schnittstelle abgeleitet und ist der Schlüssel zum Anzeigen von Direct2D-Inhalten in Windows 8. Weitere Informationen zu dieser Schnittstelle finden Sie unter [Geräte und Geräte Kontexte](devices-and-device-contexts.md).</span><span class="sxs-lookup"><span data-stu-id="aff34-296">The [**ID2D1DeviceContext**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1devicecontext) interface is derived from the [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) interface and is key to displaying Direct2D content in Windows 8, for more information about this interface see [Devices and Device Contexts](devices-and-device-contexts.md).</span></span> <span data-ttu-id="aff34-297">Mit der Gerätekontext Schnittstelle können Sie den Aufruf der [**createlayer**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createlayer(id2d1layer)) -Methode überspringen und dann NULL an die [**ID2D1DeviceContext::P ushlayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-pushlayer(constd2d1_layer_parameters1_id2d1layer)) -Methode übergeben.</span><span class="sxs-lookup"><span data-stu-id="aff34-297">With the device context interface, you can skip calling the [**CreateLayer**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createlayer(id2d1layer)) method and then pass NULL to the [**ID2D1DeviceContext::PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-pushlayer(constd2d1_layer_parameters1_id2d1layer)) method.</span></span> <span data-ttu-id="aff34-298">Direct2D verwaltet die ebenenressource automatisch und kann Ressourcen zwischen Ebenen und Effekt Diagrammen freigeben.</span><span class="sxs-lookup"><span data-stu-id="aff34-298">Direct2D automatically manages the layer resource and can share resources between layers and effect graphs.</span></span>

### <a name="axis-aligned-clips"></a><span data-ttu-id="aff34-299">Achsen ausgerichtete Clips</span><span class="sxs-lookup"><span data-stu-id="aff34-299">Axis-aligned clips</span></span>

<span data-ttu-id="aff34-300">, Wenn der Bereich, der abgeschnitten werden soll, an der Achse der Zeichen Oberfläche ausgerichtet ist, anstatt beliebig.</span><span class="sxs-lookup"><span data-stu-id="aff34-300">If the region to be clipped is aligned to the axis of the drawing surface, instead of arbitrary.</span></span> <span data-ttu-id="aff34-301">Dieser Fall eignet sich für die Verwendung eines Clip Rechtecks anstelle einer Ebene.</span><span class="sxs-lookup"><span data-stu-id="aff34-301">This case is suited for using a clip rectangle instead of a layer.</span></span> <span data-ttu-id="aff34-302">Der Leistungsgewinn liegt eher bei der Aliasing Geometrie als bei der Geometrie mit Antialiasing.</span><span class="sxs-lookup"><span data-stu-id="aff34-302">The performance gain is more for aliased geometry than antialiased geometry.</span></span> <span data-ttu-id="aff34-303">Weitere Informationen zu den Achsen ausgerichteten Clips finden Sie im Thema [**pushaxisalignedclip**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-pushaxisalignedclip(constd2d1_rect_f__d2d1_antialias_mode)) .</span><span class="sxs-lookup"><span data-stu-id="aff34-303">For more info on axis aligned clips, see the [**PushAxisAlignedClip**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-pushaxisalignedclip(constd2d1_rect_f__d2d1_antialias_mode)) topic.</span></span>

## <a name="dxgi-interoperability-avoid-frequent-switches"></a><span data-ttu-id="aff34-304">DXGI-Interoperabilität: Vermeiden von häufigen Switches</span><span class="sxs-lookup"><span data-stu-id="aff34-304">DXGI interoperability: avoid frequent switches</span></span>

<span data-ttu-id="aff34-305">Direct2D kann nahtlos mit Direct3D-Oberflächen zusammenarbeiten.</span><span class="sxs-lookup"><span data-stu-id="aff34-305">Direct2D can interoperate seamlessly with Direct3D surfaces.</span></span> <span data-ttu-id="aff34-306">Dies ist sehr nützlich für das Erstellen von Anwendungen, die eine Mischung aus 2D-und 3D-Inhalten darstellen.</span><span class="sxs-lookup"><span data-stu-id="aff34-306">This is very useful for creating applications that render a mixture of 2D and 3D content.</span></span> <span data-ttu-id="aff34-307">Jeder Wechsel zwischen Drawing Direct2D und Direct3D-Inhalt wirkt sich jedoch auf die Leistung aus.</span><span class="sxs-lookup"><span data-stu-id="aff34-307">But each switch between drawing Direct2D and Direct3D content affects performance.</span></span>

<span data-ttu-id="aff34-308">Beim Rendern auf eine DXGI-Oberfläche speichert Direct2D den Zustand der Direct3D-Geräte während des Renderings und stellt Sie wieder her, wenn das Rendering abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="aff34-308">When rendering to a DXGI surface, Direct2D saves the state of the Direct3D devices while rendering and restores it when rendering is completed.</span></span> <span data-ttu-id="aff34-309">Jedes Mal, wenn ein Batch von Direct2D Rendering abgeschlossen ist, werden die Kosten für diese Speicherung und Wiederherstellung und die Kosten für das leeren aller 2D-Vorgänge bezahlt. das Direct3D-Gerät wird jedoch nicht geleert.</span><span class="sxs-lookup"><span data-stu-id="aff34-309">Every time that a batch of Direct2D rendering is completed, the cost of this save and restore and the cost of flushing all the 2D operations are paid, and yet, the Direct3D device is not flushed.</span></span> <span data-ttu-id="aff34-310">Um die Leistung zu erhöhen, beschränken Sie daher die Anzahl der renderingschalter zwischen Direct2D und Direct3D.</span><span class="sxs-lookup"><span data-stu-id="aff34-310">Therefore, to increase performance, limit the number of rendering switches between Direct2D and Direct3D.</span></span>

## <a name="know-your-pixel-format"></a><span data-ttu-id="aff34-311">Erkennen Ihres Pixel Formats</span><span class="sxs-lookup"><span data-stu-id="aff34-311">Know Your Pixel Format</span></span>

<span data-ttu-id="aff34-312">Wenn Sie ein Renderziel erstellen, können Sie die [**D2D1 \_ Pixel- \_ Format**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) Struktur verwenden, um das Pixel Format und den Alpha Modus anzugeben, die vom Renderziel verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-312">When you create a render target, you can use the [**D2D1\_PIXEL\_FORMAT**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) structure specify the pixel format and alpha mode used by the render target.</span></span> <span data-ttu-id="aff34-313">Ein Alphakanal ist Teil des Pixel Formats, das den Abdeckungs Wert oder Deck Kraft-Informationen angibt.</span><span class="sxs-lookup"><span data-stu-id="aff34-313">An alpha channel is part of the pixel format that specifies the coverage value or opacity information.</span></span> <span data-ttu-id="aff34-314">Wenn ein Renderziel nicht den Alphakanal verwendet, sollte er im Modus " [**D2D1 Alpha Mode \_ \_ \_ Ignore**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) Alpha" erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-314">If a render target does not use the alpha channel, it should be created by using the [**D2D1\_ALPHA\_MODE\_IGNORE**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) alpha mode.</span></span> <span data-ttu-id="aff34-315">Dadurch wird die Zeit, die für das Rendern eines Alphakanals aufgewendet wird, der nicht benötigt wird, gespart.</span><span class="sxs-lookup"><span data-stu-id="aff34-315">This spares the time that is spent on rendering an alpha channel that is not needed.</span></span>

<span data-ttu-id="aff34-316">Weitere Informationen zu Pixel Formaten und Alpha Modi finden Sie [unter Unterstützte Pixel Formate und Alpha-Modi](supported-pixel-formats-and-alpha-modes.md).</span><span class="sxs-lookup"><span data-stu-id="aff34-316">For more information about pixel formats and alpha modes, see [Supported Pixel Formats and Alpha Modes](supported-pixel-formats-and-alpha-modes.md).</span></span>

## <a name="scene-complexity"></a><span data-ttu-id="aff34-317">Komplexität der Szene</span><span class="sxs-lookup"><span data-stu-id="aff34-317">Scene Complexity</span></span>

<span data-ttu-id="aff34-318">Wenn Sie Leistungs-Hotspots in einer Szene analysieren, die gerendert wird, kann es hilfreich sein, wenn Sie wissen, ob die Szene an die Füllrate gebunden ist oder Vertex-gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="aff34-318">When you analyze performance hot spots in a scene that will be rendered, knowing whether the scene is fill-rate bound or vertex bound can provide useful information.</span></span>

-   <span data-ttu-id="aff34-319">Füllrate: die Füllrate bezieht sich auf die Anzahl der Pixel, die eine Grafikkarte Renderingvorgänge und in den Videospeicher pro Sekunde schreiben kann.</span><span class="sxs-lookup"><span data-stu-id="aff34-319">Fill Rate: Fill rate refers to the number of pixels that a graphics card can render and write to video memory per second.</span></span>
-   <span data-ttu-id="aff34-320">Vertex-gebunden: eine Szene ist Scheitelpunkt gebunden, wenn Sie viele komplexe Geometrie enthält.</span><span class="sxs-lookup"><span data-stu-id="aff34-320">Vertex Bound: A scene is vertex bound when it contains lots of complex geometry.</span></span>

### <a name="understand-scene-complexity"></a><span data-ttu-id="aff34-321">Verstehen der Komplexität von Szenen</span><span class="sxs-lookup"><span data-stu-id="aff34-321">Understand Scene Complexity</span></span>

<span data-ttu-id="aff34-322">Sie können die Komplexität der Szene analysieren, indem Sie die Größe des Renderziels ändern.</span><span class="sxs-lookup"><span data-stu-id="aff34-322">You can analyze your scene complexity by altering the size of the render target.</span></span> <span data-ttu-id="aff34-323">Wenn Leistungssteigerungen für eine proportionale Reduzierung der Größe des Renderziels sichtbar sind, wird die Füllrate der Anwendung aufgehoben.</span><span class="sxs-lookup"><span data-stu-id="aff34-323">If performance gains are visible for a proportional reduction in size of the render target, then the application is fill-rate bound.</span></span> <span data-ttu-id="aff34-324">Andernfalls ist die Komplexität der Szene der Leistungsengpass.</span><span class="sxs-lookup"><span data-stu-id="aff34-324">Otherwise, the scene complexity is the performance bottleneck.</span></span>

<span data-ttu-id="aff34-325">Wenn eine Szene in der Füllrate gebunden ist, kann die Leistung durch eine Verringerung der Größe des Renderziels verbessert werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-325">When a scene is fill-rate bound, reducing the size of the render target can improve the performance.</span></span> <span data-ttu-id="aff34-326">Dies liegt daran, dass die Anzahl der zu rendernden Pixel proportional zur Größe des Renderziels reduziert wird.</span><span class="sxs-lookup"><span data-stu-id="aff34-326">This is because the number of pixels to be rendered will be reduced proportionally with the size of the render target.</span></span>

<span data-ttu-id="aff34-327">Wenn eine Szene Scheitelpunkt gebunden ist, verringern Sie die Komplexität der Geometrie.</span><span class="sxs-lookup"><span data-stu-id="aff34-327">When a scene is vertex bound, reduce the complexity of the geometry.</span></span> <span data-ttu-id="aff34-328">Beachten Sie jedoch, dass dies auf Kosten der Bildqualität erfolgt.</span><span class="sxs-lookup"><span data-stu-id="aff34-328">But remember that this is done at the expense of image quality.</span></span> <span data-ttu-id="aff34-329">Daher sollte eine sorgfältige Kompromiss Entscheidung zwischen der gewünschten Qualität und der erforderlichen Leistung getroffen werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-329">Therefore, a careful tradeoff decision should be made between the desired quality and the performance that is required.</span></span>

## <a name="improving-performance-for-direct2d-printing-apps"></a><span data-ttu-id="aff34-330">Verbessern der Leistung für Direct2D-Druck-apps</span><span class="sxs-lookup"><span data-stu-id="aff34-330">Improving performance for Direct2D printing apps</span></span>

<span data-ttu-id="aff34-331">[Direct2D](./direct2d-portal.md) bietet Kompatibilität mit dem Drucken.</span><span class="sxs-lookup"><span data-stu-id="aff34-331">[Direct2D](./direct2d-portal.md) offers compatibility with printing.</span></span> <span data-ttu-id="aff34-332">Sie können dieselben Direct2D-Zeichnungs Befehle (in Form von Direct2D-Befehlslisten) zum Drucken an das Direct2D-Druck Steuerelement senden, wenn Sie nicht wissen, auf welche Geräte Sie sich beziehen, oder wie die Zeichnung in das Drucken übersetzt wird.</span><span class="sxs-lookup"><span data-stu-id="aff34-332">You can send the same Direct2D drawing commands (in the form of Direct2D command lists) to the Direct2D print control for printing, if you don't know what devices you are drawing to, or how the drawing is translated to printing.</span></span>

<span data-ttu-id="aff34-333">Sie können die Verwendung des [Direct2D](./direct2d-portal.md) -Druck Steuer Elements und ihrer Direct2D-Zeichnungs Befehle weiter optimieren, um Druckergebnisse mit besserer Leistung zu liefern.</span><span class="sxs-lookup"><span data-stu-id="aff34-333">You can further fine-tune their usage of the [Direct2D](./direct2d-portal.md) print control and your Direct2D drawing commands to deliver printing results with better performance.</span></span>

<span data-ttu-id="aff34-334">Das Druck Steuerelement [Direct2D](./direct2d-portal.md) gibt Debugmeldungen aus, wenn ein Direct2D-Code Muster angezeigt wird, das zu einer niedrigeren Druckqualität oder-Leistung führt (z. b. Code muster weiter unten in diesem Thema), um Sie daran zu erinnern, wo Sie Leistungsprobleme vermeiden können</span><span class="sxs-lookup"><span data-stu-id="aff34-334">The [Direct2D](./direct2d-portal.md) print control outputs debug messages when it sees a Direct2D code pattern that leads to lower printing quality or performance (like, code patterns listed later in this topic) to remind you where you can avoid performance problems.</span></span> <span data-ttu-id="aff34-335">Um diese Debugmeldungen anzuzeigen, müssen Sie [Direct2D Debug Layer](direct2ddebuglayer-portal.md) in Ihrem Code aktivieren.</span><span class="sxs-lookup"><span data-stu-id="aff34-335">To see those debug messages, you need to enable [Direct2D Debug Layer](direct2ddebuglayer-portal.md) in your code.</span></span> <span data-ttu-id="aff34-336">Anweisungen zum Aktivieren der Ausgabe der Debugmeldung finden Sie unter [Debug Messages](direct2ddebuglayer-debugmessages.md) .</span><span class="sxs-lookup"><span data-stu-id="aff34-336">See [Debug Messages](direct2ddebuglayer-debugmessages.md) for instructions to enable debug message output.</span></span>

### <a name="set-the-right-property-values-when-you-create-the-d2d-print-control"></a><span data-ttu-id="aff34-337">Festlegen der richtigen Eigenschaftswerte beim Erstellen des D2D-Druck Steuer Elements</span><span class="sxs-lookup"><span data-stu-id="aff34-337">Set the right property values when you create the D2D print control</span></span>

<span data-ttu-id="aff34-338">Es gibt drei Eigenschaften, die Sie festlegen können, wenn Sie das [Direct2D](./direct2d-portal.md) -Druck Steuerelement erstellen.</span><span class="sxs-lookup"><span data-stu-id="aff34-338">There are three properties that you can set when you create the [Direct2D](./direct2d-portal.md) print control.</span></span> <span data-ttu-id="aff34-339">Zwei dieser Eigenschaften beeinflussen, wie das Direct2D-Druck Steuerelement bestimmte Direct2D-Befehle behandelt und sich wiederum auf die Gesamtleistung auswirkt.</span><span class="sxs-lookup"><span data-stu-id="aff34-339">Two of these properties impact how the Direct2D print control handles certain Direct2D commands and in turn impact the overall performance.</span></span>

-   <span data-ttu-id="aff34-340">Font Subset Mode: das [Direct2D](./direct2d-portal.md) -Druck Steuerelement unterteilt Schriftart Ressourcen, die auf jeder Seite verwendet werden, bevor die zu druckende Seite gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="aff34-340">Font Subset Mode: The [Direct2D](./direct2d-portal.md) print control subsets font resources used in each page before it sends the page to be printed.</span></span> <span data-ttu-id="aff34-341">Dieser Modus reduziert die Größe der zum Drucken benötigten Seiten Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="aff34-341">This mode reduces the size of page resources needed to print.</span></span> <span data-ttu-id="aff34-342">Abhängig von der Schriftart Verwendung auf der Seite können Sie verschiedene Schriftart Teilmengen-Modi auswählen, um die beste Leistung zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="aff34-342">Depending on font usage on the page, you can choose different font subset modes for the best performance.</span></span>
    -   <span data-ttu-id="aff34-343">[**D2D1 \_ Der \_ Standardwert für Schriftart- \_ Untermenge \_ \_ Drucken**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) bietet in den meisten Fällen die beste Druckleistung.</span><span class="sxs-lookup"><span data-stu-id="aff34-343">[**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_DEFAULT**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) provides the best printing performance in most cases.</span></span> <span data-ttu-id="aff34-344">Wenn dieser Modus festgelegt ist, verwendet das [Direct2D](./direct2d-portal.md) -Druck Steuerelement eine heuristische Strategie, um zu entscheiden, wann Schriftarten unterteilt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="aff34-344">When set to this mode, the [Direct2D](./direct2d-portal.md) print control uses a heuristic strategy to decide when to subset fonts.</span></span>
    -   <span data-ttu-id="aff34-345">Für kurze Druckaufträge mit 1 oder 2 Seiten wird empfohlen, [**den \_ Schriftart-Teilmengen \_ \_ \_ Modus \_ D2D1 zu drucken**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) , bei dem das [Direct2D](./direct2d-portal.md) -Druck Steuerelement die Schriftarten Ressourcen auf jeder Seite einrichtet und die Schriftart in den einzelnen Seiten einbettet. diese Schriftart wird dann verworfen, nachdem die Seite gedruckt wurde.</span><span class="sxs-lookup"><span data-stu-id="aff34-345">For short print jobs with 1 or 2 pages, we recommend [**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_EACHPAGE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) , where the [Direct2D](./direct2d-portal.md) print control subsets and embeds font resources in each page, then discards that font subset after the page prints.</span></span> <span data-ttu-id="aff34-346">Mit dieser Option wird sichergestellt, dass jede Seite sofort gedruckt werden kann, nachdem Sie generiert wurde, aber die Größe der Seiten Ressourcen, die für den Druck benötigt werden (normalerweise große Schriftart Teilmengen), etwas erhöht</span><span class="sxs-lookup"><span data-stu-id="aff34-346">This option makes sure each page can be printed immediately after it is generated but slightly increases size of page resources needed for printing (with usually large font subsets).</span></span>
    -   <span data-ttu-id="aff34-347">Für Druckaufträge mit vielen Seiten von Texten und kleinen Schrift Graden (z. b. 100 Textseiten, die eine einzelne Schriftart verwenden) Es wird empfohlen, den Schrift Schnitt für Schriftart in [](./direct2d-portal.md) [**D2D1 drucken zu lassen, wobei das Direct2D-Druck Steuerelement keine Schriftart Ressourcen unter \_ \_ \_ \_ \_**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode)teilt, sondern die ursprünglichen Schriftart Ressourcen zusammen mit der Seite sendet, die zuerst die Schriftart verwendet, und die Schriftart Ressourcen für spätere Seiten erneut verwendet, ohne Sie erneut zu senden.</span><span class="sxs-lookup"><span data-stu-id="aff34-347">For print jobs with many pages of texts and small font sizes (like 100 pages of text that uses a single font), we recommend [**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_NONE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode), where the [Direct2D](./direct2d-portal.md) print control doesn't subset font resources at all; instead, it sends out the original font resources along with the page that first uses the font, and re-uses the font resources for later pages without resending them.</span></span>
-   <span data-ttu-id="aff34-348">Rasterisierungsdpi: Wenn das [Direct2D](./direct2d-portal.md) -Druck Steuerelement während der Direct2D-XPS-Konvertierung Direct2D-Befehle Rasterisieren muss, wird dieser dpi-Wert für die rasterisierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="aff34-348">Rasterization DPI: When the [Direct2D](./direct2d-portal.md) print control needs to rasterize Direct2D commands during Direct2D-XPS conversion, it uses this DPI for rasterization.</span></span> <span data-ttu-id="aff34-349">Anders ausgedrückt: Wenn die Seite keinen gerastererten Inhalt hat, wird durch das Festlegen eines beliebigen dpi-Wert die Leistung und Qualität nicht geändert.</span><span class="sxs-lookup"><span data-stu-id="aff34-349">In other words, if the page doesn't have any rasterized contents, setting any DPI won't change performance and quality.</span></span> <span data-ttu-id="aff34-350">Abhängig von der rasterisierungsverwendung auf der Seite können Sie unterschiedliche rasterisierungsdpis auswählen, um ein optimales Gleichgewicht zwischen Treue und Leistung zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="aff34-350">Depending on rasterization usage on the page, you can choose different rasterization DPIs for the best balance between fidelity and performance.</span></span>
    -   <span data-ttu-id="aff34-351">150 ist der Standardwert, wenn Sie keinen Wert angeben, wenn Sie das [Direct2D](./direct2d-portal.md) -Druck Steuerelement erstellen. Dies ist in den meisten Fällen das beste Gleichgewicht der Druckqualität und der Druckleistung.</span><span class="sxs-lookup"><span data-stu-id="aff34-351">150 is the default value if you don't specify a value when you create the [Direct2D](./direct2d-portal.md) print control, which is the best balance of printing quality and printing performance in most cases.</span></span>
    -   <span data-ttu-id="aff34-352">Höhere dpi-Werte führen in der Regel zu einer besseren Druckqualität (da weitere Details beibehalten werden), aber zu einer geringeren Leistung aufgrund der größeren Bitmaps, die Sie generiert.</span><span class="sxs-lookup"><span data-stu-id="aff34-352">Higher DPI values usually result in better printing quality (as in more details preserved) but lower performance due to the larger bitmaps it generates.</span></span> <span data-ttu-id="aff34-353">Wir empfehlen keinen dpi-Wert größer als 300, da dadurch keine zusätzlichen Informationen, die von Menschen Augen visuell sichtbar sind, eingeführt werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-353">We don't recommend any DPI value greater than 300 since that won't introduce extra information visually perceivable by human eyes.</span></span>
    -   <span data-ttu-id="aff34-354">Niedrigerer dpi-Wert kann eine bessere Leistung bedeuten, kann jedoch auch zu einer niedrigeren Qualität führen</span><span class="sxs-lookup"><span data-stu-id="aff34-354">Lower DPI may mean better performance but may also produce lower quality.</span></span>

### <a name="avoid-using-certain-direct2d-drawing-patterns"></a><span data-ttu-id="aff34-355">Vermeiden Sie die Verwendung bestimmter Direct2D-Zeichnungs Muster</span><span class="sxs-lookup"><span data-stu-id="aff34-355">Avoid using certain Direct2D drawing patterns</span></span>

<span data-ttu-id="aff34-356">Es gibt Unterschiede zwischen dem, was [Direct2D](./direct2d-portal.md) visuell darstellen kann, und dem, was das Druck Subsystem in der gesamten Druck Pipeline behalten und transportieren kann.</span><span class="sxs-lookup"><span data-stu-id="aff34-356">There are differences between what [Direct2D](./direct2d-portal.md) can represent visually and what the print subsystem can maintain and transport along the whole print pipeline.</span></span> <span data-ttu-id="aff34-357">Das Druck Steuerelement Direct2D Bridges diese Lücken durch das Anfügen oder rasterieren von Direct2D-primitiven, die vom Druck Subsystem nicht nativ unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-357">The Direct2D print control bridges those gaps by either approximating or rasterizing Direct2D primitives that the print subsystem doesn't natively support.</span></span> <span data-ttu-id="aff34-358">Diese Näherung führt in der Regel zu einer geringeren Druck Treue, geringeren Druckleistung oder beidem.</span><span class="sxs-lookup"><span data-stu-id="aff34-358">Such approximation usually results in lower printing fidelity, lower printing performance, or both.</span></span> <span data-ttu-id="aff34-359">Daher ist es in allen Fällen nicht ideal, auch wenn ein Kunde die gleichen Zeichnungs Muster für Bildschirm-und Druck Rendering verwenden kann.</span><span class="sxs-lookup"><span data-stu-id="aff34-359">Therefore, even though a customer can use the same drawing patterns for both screen and print rendering, it is not ideal in all cases.</span></span> <span data-ttu-id="aff34-360">Es empfiehlt sich, solche Direct2D-primitive und-Muster nicht so weit wie möglich für den Druckpfad zu verwenden, oder Sie verwenden eine eigene rasterisierung, bei der Sie vollständige Kontrolle über die Qualität und die Größe der gerasterten Bilder verfügen.</span><span class="sxs-lookup"><span data-stu-id="aff34-360">It's best not to use such Direct2D primitives and patterns as much as possible for the print path, or to do you own rasterization where you have full control of the quality and the size of the rasterized images.</span></span>

<span data-ttu-id="aff34-361">Im folgenden finden Sie eine Liste der Fälle, in denen die Druckleistung und-Qualität nicht ideal sind und Sie ggf. den Codepfad für eine optimale Druckleistung unterscheiden möchten.</span><span class="sxs-lookup"><span data-stu-id="aff34-361">The here is a list of cases where the print performance and quality won't be ideal and the you might want to consider varying the code path for optimal print performance.</span></span>

-   <span data-ttu-id="aff34-362">Vermeiden Sie die Verwendung des primitiven Blend-Modus außer [**D2D1 \_ primitiver \_ Blend \_ sourceover**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_primitive_blend).</span><span class="sxs-lookup"><span data-stu-id="aff34-362">Avoid using primitive blend mode other than [**D2D1\_PRIMITIVE\_BLEND\_SOURCEOVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_primitive_blend).</span></span>
-   <span data-ttu-id="aff34-363">Vermeiden Sie die Verwendung von Kompositions Modi, wenn Sie ein anderes Bild als den D2D1-Modus für den zusammen [**\_ gesetzten \_ Modus \_ \_ über**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_composite_mode) und den **D2D1- \_ Verbund \_ Modus \_ \_**</span><span class="sxs-lookup"><span data-stu-id="aff34-363">Avoid using Composition Modes when drawing an image other than [**D2D1\_COMPOSITE\_MODE\_SOURCE\_OVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_composite_mode) and **D2D1\_COMPOSITE\_MODE\_DESTINATION\_OVER**.</span></span>
-   <span data-ttu-id="aff34-364">Vermeiden Sie das Zeichnen einer GDI-Metadatendatei.</span><span class="sxs-lookup"><span data-stu-id="aff34-364">Avoid drawing a GDI Meta File.</span></span>
-   <span data-ttu-id="aff34-365">Vermeiden Sie das Übertragen einer ebenenressource, die den Quell Hintergrund kopiert ( [**pushlayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-pushlayer) wird aufgerufen, wobei [**D2D1 \_ Layer \_ OPTIONS1 \_ Initialize \_ von \_ Background**](/windows/desktop/api/d2d1_1/ns-d2d1_1-d2d1_layer_parameters1) an die **D2D1 \_ Layer \_ PARAMETERS1** -Struktur übergeben wird).</span><span class="sxs-lookup"><span data-stu-id="aff34-365">Avoid pushing a layer resource that copies the source background (calling [**PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-pushlayer) with passing [**D2D1\_LAYER\_OPTIONS1\_INITIALIZE\_FROM\_BACKGROUND**](/windows/desktop/api/d2d1_1/ns-d2d1_1-d2d1_layer_parameters1) to the **D2D1\_LAYER\_PARAMETERS1** struct).</span></span>
-   <span data-ttu-id="aff34-366">Vermeiden Sie das Erstellen eines Bitmap-Pinsels oder Bild Pinsels mit der D2D1-Pinsel \_ Erweiterung \_ \_</span><span class="sxs-lookup"><span data-stu-id="aff34-366">Avoid creating Bitmap Brush or Image Brush with D2D1\_EXTEND\_MODE\_CLAMP.</span></span> <span data-ttu-id="aff34-367">Es wird empfohlen, dass Sie D2D1 extendermodusspiegelung verwenden \_ \_ , wenn Sie sich \_ keine Gedanken über Pixel außerhalb des Bilds machen (z. b., wenn das Bild, das an den Pinsel angefügt ist, größer als der gefüllte Zielbereich ist).</span><span class="sxs-lookup"><span data-stu-id="aff34-367">We recommend you use D2D1\_EXTEND\_MODE\_MIRROR if don't care about pixels outside of the image bound at all (like, the image attached to the brush is known to be larger than the filled target region).</span></span>
-   <span data-ttu-id="aff34-368">Vermeiden Sie das Zeichnen von Bitmaps mit [Perspektiven Transformationen](3d-perspective-transform.md).</span><span class="sxs-lookup"><span data-stu-id="aff34-368">Avoid drawing Bitmaps with [Perspective Transforms](3d-perspective-transform.md).</span></span>

### <a name="draw-text-in-a-direct-and-plain-way"></a><span data-ttu-id="aff34-369">Text direkt und auf einfache Weise zeichnen</span><span class="sxs-lookup"><span data-stu-id="aff34-369">Draw text in a direct and plain way</span></span>

<span data-ttu-id="aff34-370">Direct2D verfügt über mehrere Optimierungen beim Rendern von Texten, die für eine bessere Leistung und/oder eine bessere visuelle Qualität angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="aff34-370">Direct2D has several optimizations when rendering texts to display for better performance and/or better visual quality.</span></span> <span data-ttu-id="aff34-371">Aber nicht alle Optimierungen verbessern die Druckleistung und-Qualität, da der Druck auf dem Papier in der Regel eine viel höhere dpi-Menge hat, und das Drucken muss keine Szenarios wie Animation aufnehmen.</span><span class="sxs-lookup"><span data-stu-id="aff34-371">But not all optimizations improve the printing performance and quality since the printing on paper is usually in a much higher DPI, and printing does not need to accommodate scenarios like animation.</span></span> <span data-ttu-id="aff34-372">Daher wird empfohlen, dass Sie den ursprünglichen Text oder die Symbole direkt zeichnen und eine der folgenden Optimierungen vermeiden, wenn Sie die Befehlsliste zum Drucken erstellen.</span><span class="sxs-lookup"><span data-stu-id="aff34-372">So, we recommend you draw the original text or glyphs directly and avoid any of the following optimizations when creating the command list for printing.</span></span>

-   <span data-ttu-id="aff34-373">Vermeiden Sie das Zeichnen von Text mit der [**fillopacitymask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-fillopacitymask) -Methode.</span><span class="sxs-lookup"><span data-stu-id="aff34-373">Avoid drawing text with the [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-fillopacitymask) method.</span></span>
-   <span data-ttu-id="aff34-374">Vermeiden Sie das Zeichnen von Text im Alias Modus.</span><span class="sxs-lookup"><span data-stu-id="aff34-374">Avoid drawing text in Aliased Mode.</span></span>

### <a name="draw-the-original-bitmaps-when-possible"></a><span data-ttu-id="aff34-375">Nach Möglichkeit die ursprünglichen Bitmaps zeichnen</span><span class="sxs-lookup"><span data-stu-id="aff34-375">Draw the original bitmaps when possible</span></span>

<span data-ttu-id="aff34-376">Wenn die Ziel Bitmap ein JPEG ist, PNG, TIFF oder JPEG-XR Sie können eine WIC-Bitmap entweder aus einer Datenträger Datei oder aus einem in-Memory-Stream erstellen. Anschließend können Sie eine [Direct2D](./direct2d-portal.md) -Bitmap aus der WIC-Bitmap mithilfe von [**ID2D1DeviceContext:: depfromwicbitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1))und schließlich direkt an das Direct2D-Druck Steuerelement übergeben, ohne weitere Manipulationen durchführen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="aff34-376">If the target bitmap is a JPEG, PNG, TIFF, or JPEG-XR, you can create a WIC bitmap either from a disk file or from an in-memory stream, then create a [Direct2D](./direct2d-portal.md) bitmap from that WIC bitmap using [**ID2D1DeviceContext::CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1)), and finally directly pass that Direct2D bitmap to the Direct2D print control without further manipulation.</span></span> <span data-ttu-id="aff34-377">Auf diese Weise kann das Direct2D-Druck Steuerelement den bitmapStream wieder verwenden, was in der Regel zu einer besseren Druckleistung führt (durch das Überspringen der redundante Bitmap-Codierung und-Decodierung) und eine bessere Druckqualität (wenn Metadaten, z. b. Farbprofile, in der Bitmap beibehalten werden).</span><span class="sxs-lookup"><span data-stu-id="aff34-377">By doing so, the Direct2D print control is able to reuse the bitmap stream, which usually leads to better printing performance (by skipping redundant bitmap encoding and decoding), and better printing quality (when metadata, such as color profiles, in the bitmap will be preserved).</span></span>

<span data-ttu-id="aff34-378">Das Zeichnen der ursprünglichen Bitmap bietet die folgenden Vorteile für-Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="aff34-378">Drawing the original bitmap provides the following benefit for applications.</span></span>

-   <span data-ttu-id="aff34-379">Im Allgemeinen behält [Direct2D](./direct2d-portal.md) Print die ursprünglichen Informationen (ohne Verlust oder Rauschen) bis zum späten Zeitpunkt in der Pipeline bei, insbesondere dann, wenn Apps die Details der Druck Pipeline nicht kennen (bzw. nicht wissen möchten), insbesondere dann, wenn die Drucker Pipeline die Details der Druck Pipeline kennt</span><span class="sxs-lookup"><span data-stu-id="aff34-379">In general, [Direct2D](./direct2d-portal.md) print preserves the original information (without loss or noise) until late in the pipeline, especially when apps don't know (or do not want to know) the details of the print pipeline (like which printer it is printing to, what DPI is the target printer, and so on).</span></span>
-   <span data-ttu-id="aff34-380">In vielen Fällen bedeutet eine verzögerte Bitmap-rasterisierung eine bessere Leistung (z. b. beim Drucken eines 96dpi-Fotos auf einen 600 dpi-Drucker).</span><span class="sxs-lookup"><span data-stu-id="aff34-380">In many cases, delaying bitmap rasterization means better performance (like when printing an 96dpi photo to a 600dpi printer).</span></span>
-   <span data-ttu-id="aff34-381">In bestimmten Fällen ist das übergeben der ursprünglichen Bilder die einzige Möglichkeit, hohe Genauigkeit zu beachten (wie z. b. eingebettete Farbprofile).</span><span class="sxs-lookup"><span data-stu-id="aff34-381">In certain cases, passing the original images is the only way to honor high fidelity (like embedded color profiles).</span></span>

<span data-ttu-id="aff34-382">Eine solche Optimierung kann jedoch aufgrund der folgenden Aktionen nicht deaktiviert werden:</span><span class="sxs-lookup"><span data-stu-id="aff34-382">However, an you can't opt in such optimization because:</span></span>

-   <span data-ttu-id="aff34-383">Durch Abfragen von Drucker Informationen und der frühen rasterisierung können Sie Inhalte selbst mit vollständiger Kontrolle über die endgültige Darstellung auf dem Papier verkleinern.</span><span class="sxs-lookup"><span data-stu-id="aff34-383">By querying printer info and early rasterization, you can rasterize contents themselves with full control of the final appearance on paper.</span></span>
-   <span data-ttu-id="aff34-384">In bestimmten Fällen kann die frühe Vergrößerung tatsächlich die End-to-End-Leistung einer APP verbessern (z. b. das Drucken von Fotos in der Größe von Fotos).</span><span class="sxs-lookup"><span data-stu-id="aff34-384">In certain cases, early rasterization might actually improves an app’s end-to-end performance (like printing wallets-size photos).</span></span>
-   <span data-ttu-id="aff34-385">In bestimmten Fällen erfordert das übergeben der ursprünglichen Bitmaps eine bedeutende Änderung der vorhandenen Code Architektur (z. b. das Laden von Bildern und Ressourcen Update Pfaden in bestimmten Anwendungen).</span><span class="sxs-lookup"><span data-stu-id="aff34-385">In certain cases, passing the original bitmaps require significant change of existing code architecture (like image delay loading and resource update paths found in certain applications).</span></span>

## <a name="conclusion"></a><span data-ttu-id="aff34-386">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="aff34-386">Conclusion</span></span>

<span data-ttu-id="aff34-387">Obwohl Direct2D Hardware beschleunigt ist und für hohe Leistung vorgesehen ist, müssen Sie die Funktionen zum Maximieren des Durchsatzes ordnungsgemäß verwenden.</span><span class="sxs-lookup"><span data-stu-id="aff34-387">Although Direct2D is hardware accelerated and is meant for high performance, you must use the features correctly to maximize throughput.</span></span> <span data-ttu-id="aff34-388">Die hier vorgestellten Verfahren sind von der Untersuchung allgemeiner Szenarien abgeleitet und gelten möglicherweise nicht für alle Anwendungsszenarien.</span><span class="sxs-lookup"><span data-stu-id="aff34-388">The techniques we looked at here are derived from studying common scenarios and might not apply to all application scenarios.</span></span>

 

 
