---
title: Direct2D-Multithread-Apps
description: Beschreibt bewährte Methoden zum Erstellen von Multithread Direct2D-apps.
ms.assetid: FDD770D4-817F-44D9-86C4-15DD04D214AE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6be979b867edd6d36583959c4a595dbd507ca94f
ms.sourcegitcommit: c3243ec4ada05b7faf9d563853cb667ecef825e8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/03/2020
ms.locfileid: "103734792"
---
# <a name="multithreaded-direct2d-apps"></a><span data-ttu-id="26d5e-103">Direct2D-Multithread-Apps</span><span class="sxs-lookup"><span data-stu-id="26d5e-103">Multithreaded Direct2D Apps</span></span>

<span data-ttu-id="26d5e-104">Wenn Sie [Direct2D](./direct2d-portal.md) -apps entwickeln, müssen Sie möglicherweise über mehr als einen Thread auf Direct2D-Ressourcen zugreifen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-104">If you develop [Direct2D](./direct2d-portal.md) apps, you may need to access Direct2D resources from more than one thread.</span></span> <span data-ttu-id="26d5e-105">In anderen Fällen empfiehlt es sich, Multithreading zu verwenden, um eine bessere Leistung oder bessere Reaktionsfähigkeit zu erzielen (z. b. die Verwendung eines Threads für die Bildschirm Anzeige und einen separaten Thread für das Offline Rendering).</span><span class="sxs-lookup"><span data-stu-id="26d5e-105">In other cases, you may want to use multi-threading to get better performance or better responsiveness (like using one thread for screen display and a separate thread for offline rendering).</span></span>

<span data-ttu-id="26d5e-106">In diesem Thema werden die bewährten Methoden zum Entwickeln von Multithread [Direct2D](./direct2d-portal.md) -apps mit nur wenig oder ohne [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) Rendering beschrieben.</span><span class="sxs-lookup"><span data-stu-id="26d5e-106">This topic describes the best practices for developing multithreaded [Direct2D](./direct2d-portal.md) apps with little to no [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) rendering.</span></span> <span data-ttu-id="26d5e-107">Software Fehler, die durch Parallelitäts Probleme verursacht werden, können schwer zu finden sein, und es ist hilfreich, die Multithreading Richtlinie zu planen und die hier beschriebenen bewährten Methoden zu befolgen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-107">Software defects caused by concurrency issues can be difficult to track down, and it is helpful to plan your multithreading policy and to follow the best practices described here.</span></span>

> [!Note]  
> <span data-ttu-id="26d5e-108">Wenn Sie auf zwei [Direct2D](./direct2d-portal.md) -Ressourcen zugreifen, die aus zwei unterschiedlichen Single Thread Direct2D Factorys erstellt wurden, verursacht dies keine Zugriffs Konflikte, solange die zugrunde liegenden [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) -Geräte und-Geräte Kontexte ebenfalls verschieden sind.</span><span class="sxs-lookup"><span data-stu-id="26d5e-108">If you access two [Direct2D](./direct2d-portal.md) resources created from two different single threaded Direct2D factories it doesn't cause access conflicts as long as the underlying [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) devices and device contexts are also distinct.</span></span> <span data-ttu-id="26d5e-109">Wenn Sie über "Zugriff auf Direct2D-Ressourcen" in diesem Artikel sprechen, bedeutet dies, dass der Zugriff auf Direct2D-Ressourcen, die mit demselben Direct2D-Gerät erstellt wurden, nicht anders ist</span><span class="sxs-lookup"><span data-stu-id="26d5e-109">When talking about "accessing Direct2D resources" in this article, it really means "accessing Direct2D resources created from the same Direct2D Device" unless stated otherwise.</span></span>

## <a name="developing-thread-safe-apps-that-call-only-direct2d-apis"></a><span data-ttu-id="26d5e-110">Entwickeln von Thread-Safe-apps, die nur Direct2D-APIs anrufen</span><span class="sxs-lookup"><span data-stu-id="26d5e-110">Developing Thread-Safe Apps that Call Only Direct2D APIs</span></span>

<span data-ttu-id="26d5e-111">Sie können eine Multithread [Direct2D](./direct2d-portal.md) Factory-Instanz erstellen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-111">You can create a multithreaded [Direct2D](./direct2d-portal.md) factory instance.</span></span> <span data-ttu-id="26d5e-112">Sie können eine multithreadfactory und alle zugehörigen Ressourcen aus mehreren Threads verwenden und freigeben, aber der Zugriff auf diese Ressourcen (über Direct2D-Aufrufe) wird von Direct2D serialisiert, sodass keine Zugriffs Konflikte auftreten.</span><span class="sxs-lookup"><span data-stu-id="26d5e-112">You can use and share a multithreaded factory and all its resources from more than one thread, but accesses to those resources (via Direct2D calls) are serialized by Direct2D, so no access conflicts occur.</span></span> <span data-ttu-id="26d5e-113">Wenn in ihrer app nur Direct2D-APIs aufgerufen werden, erfolgt ein solcher Schutz automatisch durch Direct2D auf granularer Ebene mit minimalem Verwaltungsaufwand.</span><span class="sxs-lookup"><span data-stu-id="26d5e-113">If your app calls only Direct2D APIs, such protection is automatically done by Direct2D in a granular level with minimum overhead.</span></span> <span data-ttu-id="26d5e-114">Der Code zum Erstellen einer Multithread-Factory.</span><span class="sxs-lookup"><span data-stu-id="26d5e-114">The code to create a multithreaded factory here.</span></span>

```cpp
ID2D1Factory* m_D2DFactory;

// Create a Direct2D factory.
HRESULT hr = D2D1CreateFactory(
    D2D1_FACTORY_TYPE_MULTI_THREADED,
    &m_D2DFactory
);
```

<span data-ttu-id="26d5e-115">Das folgende Bild zeigt, wie [Direct2D](./direct2d-portal.md) zwei Threads serialisiert, die Aufrufe nur mit der Direct2D-API durchführen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-115">The image here shows how [Direct2D](./direct2d-portal.md) serializes two threads that make calls using only the Direct2D API.</span></span>

![Diagramm der zwei serialisierten Threads.](images/multi-thread.png)

## <a name="developing-thread-safe-direct2d-apps-with-minimal-direct3d-or-dxgi-calls"></a><span data-ttu-id="26d5e-117">Entwickeln von Thread-Safe Direct2D-apps mit minimalen Direct3D-oder DXGI-aufrufen</span><span class="sxs-lookup"><span data-stu-id="26d5e-117">Developing Thread-Safe Direct2D Apps with minimal Direct3D or DXGI Calls</span></span>

<span data-ttu-id="26d5e-118">Es ist häufiger, dass eine [Direct2D](./direct2d-portal.md) -APP auch einige [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) -oder DXGI-Aufrufe ausführt.</span><span class="sxs-lookup"><span data-stu-id="26d5e-118">It is more than often that a [Direct2D](./direct2d-portal.md) app also makes some [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls.</span></span> <span data-ttu-id="26d5e-119">Ein Anzeige Thread zeichnet sich z. b. in Direct2D und ist dann mithilfe einer [**DXGI-Swapkette**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain)vorhanden.</span><span class="sxs-lookup"><span data-stu-id="26d5e-119">For example, a display thread will draw in Direct2D then present using a [**DXGI swap chain**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain).</span></span>

<span data-ttu-id="26d5e-120">In diesem Fall ist die Sicherstellung der Thread Sicherheit komplizierter: einige [Direct2D](./direct2d-portal.md) -Aufrufe greifen indirekt auf die zugrunde liegenden [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) -Ressourcen zu, die gleichzeitig von einem anderen Thread aufgerufen werden, der Direct3D oder DXGI aufruft.</span><span class="sxs-lookup"><span data-stu-id="26d5e-120">In this case, assuring thread-safety is more complicated: some [Direct2D](./direct2d-portal.md) calls indirectly access the underlying [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) resources, which might be simultaneously accessed by another thread which calls Direct3D or DXGI.</span></span> <span data-ttu-id="26d5e-121">Da es sich bei diesen Direct3D-oder DXGI-Aufrufen nicht um renderingkonventionen Awareness und Control handelt, müssen Sie eine Multithread-Direct2D-Factory erstellen, aber Sie müssen mit Mor Vorgehen, um Zugriffs Konflikte zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="26d5e-121">Since those Direct3D or DXGI calls are out of Direct2D’s awareness and control, you need to create a multithreaded Direct2D factory, but you must do mor to avoid access conflicts.</span></span>

<span data-ttu-id="26d5e-122">Das Diagramm zeigt einen [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) -Ressourcen Zugriffs Konflikt, weil Thread T0 indirekt über einen [Direct2D](./direct2d-portal.md) -Befehl auf eine Ressource zugreift und T2 direkt über einen Direct3D-oder DXGI-Befehl auf dieselbe Ressource zugreift.</span><span class="sxs-lookup"><span data-stu-id="26d5e-122">The diagram here shows a [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) resource access conflict due to thread T0 accessing a resource indirectly via a [Direct2D](./direct2d-portal.md) call and T2 accessing the same resource directly via a Direct3D or DXGI call.</span></span>

> [!Note]  
> <span data-ttu-id="26d5e-123">Der Thread Schutz, den [Direct2D](./direct2d-portal.md) bereitstellt (die blaue Sperre in diesem Bild) ist in diesem Fall nicht hilfreich.</span><span class="sxs-lookup"><span data-stu-id="26d5e-123">The thread protection that [Direct2D](./direct2d-portal.md) provides (the blue lock in this image) doesn't help in this case.</span></span>

 

![Thread Schutz Diagramm.](images/multi-thread2.png)

<span data-ttu-id="26d5e-125">Um Ressourcen Zugriffs Konflikte zu vermeiden, wird empfohlen, dass Sie explizit die Sperre abrufen, die von [Direct2D](./direct2d-portal.md) für die interne Zugriffs Synchronisierung verwendet wird, und diese Sperre anwenden, wenn ein Thread [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) -oder DXGI-Aufrufe ausführen muss, die möglicherweise zu Zugriffs Konflikten führen, wie hier gezeigt.</span><span class="sxs-lookup"><span data-stu-id="26d5e-125">To avoid resource access conflict here, we recommend you explicitly acquire the lock that [Direct2D](./direct2d-portal.md) uses for internal access synchronization, and apply that lock when a thread needs to make [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls that might cause access conflict as shown here.</span></span> <span data-ttu-id="26d5e-126">Insbesondere sollten Sie sich mit dem Code, der Ausnahmen verwendet, oder einem frühen System, das auf HRESULT-Rückgabecodes basiert, besonders Gedanken machen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-126">In particular, you should take special care with code that uses exceptions or an early out system based on HRESULT return codes.</span></span> <span data-ttu-id="26d5e-127">Aus diesem Grund wird empfohlen, ein RAII (Resource Acquisition Is Initialization)-Muster zu verwenden, um die [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) -und [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) -Methoden aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-127">For this reason, we recommend you use an RAII (Resource Acquisition Is Initialization) pattern to call the [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) and [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) methods.</span></span>

> [!Note]  
> <span data-ttu-id="26d5e-128">Es ist wichtig, dass Sie Aufrufe der [**Eingabe**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) -und der [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) -Methode kombinieren, da Ihre APP andernfalls einen Deadlock verursachen kann.</span><span class="sxs-lookup"><span data-stu-id="26d5e-128">It is important that you pair up calls to the [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) and [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) methods, otherwise your app can deadlock.</span></span>

 

<span data-ttu-id="26d5e-129">Der folgende Code zeigt ein Beispiel für das Sperren und anschließende Entsperren von [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) -oder DXGI-aufrufen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-129">The code here shows an example of when to lock and then and unlock around [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls.</span></span>


```C++
void MyApp::DrawFromThread2()
{
    // We are accessing Direct3D resources directly without Direct2D's knowledge, so we
    // must manually acquire and apply the Direct2D factory lock.
    ID2D1Multithread* m_D2DMultithread;
    m_D2DFactory->QueryInterface(IID_PPV_ARGS(&m_D2DMultithread));
    m_D2DMultithread->Enter();
    
    // Now it is safe to make Direct3D/DXGI calls, such as IDXGISwapChain::Present
    MakeDirect3DCalls();

    // It is absolutely critical that the factory lock be released upon
    // exiting this function, or else any consequent Direct2D calls will be blocked.
    m_D2DMultithread->Leave();
}
```



> [!Note]  
> <span data-ttu-id="26d5e-130">Einige [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) -oder DXGI-Aufrufe (insbesondere [**idxgiswapchain::P Resent**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present)) können Sperren und/oder Rückrufe in den Code der aufrufenden Funktion oder Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-130">Some [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls (notably [**IDXGISwapChain::Present**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present)) may acquire locks and/or trigger callbacks into the code of the calling function or method.</span></span> <span data-ttu-id="26d5e-131">Sie sollten sich dies bewusst sein und sicherstellen, dass dieses Verhalten keine Deadlocks verursacht.</span><span class="sxs-lookup"><span data-stu-id="26d5e-131">You should be aware of this and make sure that such behavior doesn't cause deadlocks.</span></span> <span data-ttu-id="26d5e-132">Weitere Informationen finden Sie im Thema [Übersicht über DXGI](/windows/desktop/direct3ddxgi/d3d10-graphics-programming-guide-dxgi) .</span><span class="sxs-lookup"><span data-stu-id="26d5e-132">For more info, see the [DXGI Overview](/windows/desktop/direct3ddxgi/d3d10-graphics-programming-guide-dxgi) topic.</span></span>

 

![Direct2D-und Direct3D-Thread Sperr Diagramm.](images/multi-thread3.png)

<span data-ttu-id="26d5e-134">Wenn Sie die [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) -und [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) -Methode verwenden, werden die Aufrufe durch die automatische [Direct2D](./direct2d-portal.md) und die explizite Sperre geschützt, sodass die APP keinen Zugriffs Konflikt verursacht.</span><span class="sxs-lookup"><span data-stu-id="26d5e-134">When you use the [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) and [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) methods, the calls are protected by the automatic [Direct2D](./direct2d-portal.md) and the explicit lock, so the app doesn't hit access conflict.</span></span>

<span data-ttu-id="26d5e-135">Es gibt weitere Möglichkeiten, dieses Problem zu umgehen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-135">There are other approaches to work around this issue.</span></span> <span data-ttu-id="26d5e-136">Es wird jedoch empfohlen, [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) -oder DXGI-Aufrufe explizit mit der [Direct2D](./direct2d-portal.md) -Sperre zu schützen, da Sie in der Regel eine bessere Leistung bietet, da Sie Parallelität auf einer weitaus präzigerer Ebene und mit geringerem Aufwand unter renderingkonventionen Cover schützt.</span><span class="sxs-lookup"><span data-stu-id="26d5e-136">However, we recommend you explicitly guard [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls with the [Direct2D](./direct2d-portal.md) lock because it usually provides better performance as it protects concurrency at a much finer level and with lower overhead under Direct2D’s cover.</span></span>

## <a name="ensuring-atomicity-of-stateful-operations"></a><span data-ttu-id="26d5e-137">Sicherstellen der Atomizität Zustands behafteter Vorgänge</span><span class="sxs-lookup"><span data-stu-id="26d5e-137">Ensuring Atomicity of Stateful Operations</span></span>

<span data-ttu-id="26d5e-138">Wenngleich die Thread Sicherheitsfeatures von [DirectX](/previous-versions//ee663301(v=vs.85)) dabei helfen können sicherzustellen, dass keine zwei einzelnen API-Aufrufe gleichzeitig ausgeführt werden, müssen Sie auch sicherstellen, dass Threads, die Zustands behaftete API-Aufrufe ausführen, nicht gegenseitig stören</span><span class="sxs-lookup"><span data-stu-id="26d5e-138">While thread-safety features of [DirectX](/previous-versions//ee663301(v=vs.85)) can help ensure that no two individual API calls are made concurrently, you must also ensure that threads that make stateful API calls don't interfere with each other.</span></span> <span data-ttu-id="26d5e-139">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="26d5e-139">Here is an example.</span></span>

1.  <span data-ttu-id="26d5e-140">Es gibt zwei Textzeilen, die Sie sowohl auf dem Bildschirm (Thread 0) als auch auf dem Bildschirm (von Thread 1) renderierender darstellen möchten: Zeile \# 1 ist "A ist größer" und Zeile \# 2 ist "als B", die beide mit einem Pinsel mit Pinsel gezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="26d5e-140">There are two lines of text that you want to render to both on-screen (by Thread 0) and off-screen (by Thread 1): Line \#1 is "A is greater" and Line \#2 is "than B", both of which will be drawn using a solid black brush.</span></span>
2.  <span data-ttu-id="26d5e-141">Thread 1 zeichnet die erste Textzeile.</span><span class="sxs-lookup"><span data-stu-id="26d5e-141">Thread 1 draws the first line of text.</span></span>
3.  <span data-ttu-id="26d5e-142">Thread 0 reagiert auf eine Benutzereingabe, aktualisiert beide Textzeilen auf "B ist kleiner" bzw. "als ein" und hat die Pinsel Farbe für eine eigene Zeichnung in "rot" geändert.</span><span class="sxs-lookup"><span data-stu-id="26d5e-142">Thread 0 reacts to a user input, updates both text lines to "B is smaller" and "than A" respectively, and changed the brush color to solid red for its own drawing;</span></span>
4.  <span data-ttu-id="26d5e-143">Thread 1 zeichnet die zweite Textzeile, die jetzt "als A" ist, mit dem roten Farbpinsel.</span><span class="sxs-lookup"><span data-stu-id="26d5e-143">Thread 1 continues drawing the second line of text, which is now "than A", with the red color brush;</span></span>
5.  <span data-ttu-id="26d5e-144">Schließlich erhalten wir zwei Textzeilen auf dem Bildschirm für das Bildschirm Zeichen: "A ist größer" in schwarz und "als rot".</span><span class="sxs-lookup"><span data-stu-id="26d5e-144">Finally, we get two lines of text on the off-screen drawing target: "A is greater" in black and "than A" in red.</span></span>

![ein Diagramm der on-und off-Bildschirm Threads.](images/multi-thread4.png)

<span data-ttu-id="26d5e-146">In der obersten Zeile zeichnet Thread 0 mit aktuellen Text Zeichenfolgen und dem aktuellen schwarzen Pinsel.</span><span class="sxs-lookup"><span data-stu-id="26d5e-146">In the top row, Thread 0 draws with current text strings and the current black brush.</span></span> <span data-ttu-id="26d5e-147">Thread 1 schließt die Bildschirm Zeichnung nur in der oberen Hälfte ab.</span><span class="sxs-lookup"><span data-stu-id="26d5e-147">Thread 1 only finishes off-screen drawing on the top half.</span></span>

<span data-ttu-id="26d5e-148">In der mittleren Zeile antwortet Thread 0 auf Benutzerinteraktion, aktualisiert die Text Zeichenfolgen und den Pinsel und aktualisiert dann den Bildschirm.</span><span class="sxs-lookup"><span data-stu-id="26d5e-148">In the middle row, Thread 0 responds to user interaction, updates the text strings and the brush, then refreshes the screen.</span></span> <span data-ttu-id="26d5e-149">An diesem Punkt wird Thread 1 blockiert.</span><span class="sxs-lookup"><span data-stu-id="26d5e-149">At this point, Thread 1 is blocked.</span></span> <span data-ttu-id="26d5e-150">In der untersten Zeile setzt das abschließende Offscreen-Rendering nach Thread 1 das Zeichnen der unteren Hälfte mit einem geänderten Pinsel und einer geänderten Text Zeichenfolge fort.</span><span class="sxs-lookup"><span data-stu-id="26d5e-150">In the bottom row, the final off-screen rendering after Thread 1 resumes drawing the bottom half with an altered brush and an altered text string.</span></span>

<span data-ttu-id="26d5e-151">Um dieses Problem zu beheben, wird empfohlen, dass Sie für jeden Thread einen separaten Kontext haben.</span><span class="sxs-lookup"><span data-stu-id="26d5e-151">To address this issue, we recommend you have a separate context for each thread, so that:</span></span>

-   <span data-ttu-id="26d5e-152">Sie sollten eine Kopie des Geräte Kontexts erstellen, damit änderbare Ressourcen (d. h. Ressourcen, die während des Anzeige-oder Druckvorgangs variieren können, z. b. Textinhalte oder der Pinsel mit voll Tonfarbe im Beispiel) beim Rendering nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="26d5e-152">You should create a copy of the device context so that mutable resources (i.e. resources that may vary during display or printing, such as text contents or the solid color brush in the example) don't change when you render.</span></span> <span data-ttu-id="26d5e-153">In diesem Beispiel sollten Sie vor dem Zeichnen eine Kopie der beiden Textzeilen und den Farbpinsel aufbewahren.</span><span class="sxs-lookup"><span data-stu-id="26d5e-153">In this sample, you should maintain a copy of those two lines of texts and the color brush before you draw.</span></span> <span data-ttu-id="26d5e-154">Dadurch wird sichergestellt, dass jeder Thread über umfassende und konsistente Inhalte zum Zeichnen und präsentieren verfügt.</span><span class="sxs-lookup"><span data-stu-id="26d5e-154">By doing so, you guarantee each thread has complete and consistent content to draw and present.</span></span>
-   <span data-ttu-id="26d5e-155">Sie sollten Ressourcen mit hohem Gewicht (z. b. Bitmaps und komplexe Effekte) freigeben, die einmal initialisiert und dann nie Thread übergreifend geändert werden, um die Leistung zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="26d5e-155">You should share heavy-weight resources (like bitmaps and complex effect graphs) that are initialized once and then never modified across threads to increase performance.</span></span>
-   <span data-ttu-id="26d5e-156">Sie können entweder einfache Ressourcen (z. b. Pinsel mit voll Tonfarbe und Textformate) freigeben, die einmal initialisiert und dann nie über mehrere Threads hinweg geändert werden.</span><span class="sxs-lookup"><span data-stu-id="26d5e-156">You can either share light-weight resources (like solid color brushes and text formats) that are initialized once and then never modified across threads or not</span></span>

## <a name="summary"></a><span data-ttu-id="26d5e-157">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="26d5e-157">Summary</span></span>

<span data-ttu-id="26d5e-158">Beim Entwickeln von Multithread [Direct2D](./direct2d-portal.md) -apps müssen Sie eine Multithread Direct2D Factory erstellen und dann alle Direct2D-Ressourcen von dieser Factory ableiten.</span><span class="sxs-lookup"><span data-stu-id="26d5e-158">When you develop multithreaded [Direct2D](./direct2d-portal.md) apps, you must create a multithreaded Direct2D factory then derive all Direct2D resources from that factory.</span></span> <span data-ttu-id="26d5e-159">Wenn ein Thread [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) -oder DXGI-Aufrufe durchführt, müssen Sie die Direct2D-Sperre ebenfalls explizit abrufen, um diese Direct3D-oder DXGI-Aufrufe zu schützen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-159">If a thread will make [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls, you also must explicitly acquire then apply the Direct2D lock to guard those Direct3D or DXGI calls.</span></span> <span data-ttu-id="26d5e-160">Außerdem müssen Sie die Kontext Integrität sicherstellen, indem Sie für jeden Thread eine Kopie der änderbaren Ressourcen besitzen.</span><span class="sxs-lookup"><span data-stu-id="26d5e-160">Moreover, you must ensure context integrity by having a copy of mutable resources for each thread.</span></span>
