---
description: Beim Initialisieren eines VSS-Wiederherstellungs Vorgangs muss ein Anforderer das Sicherungs Komponenten Dokument und jedes relevante Writer-Metadatendokument abrufen, das während des Sicherungs Vorgangs erstellt und gespeichert wird.
ms.assetid: 0a087125-c9d4-460a-8153-3e2e26633ac2
title: Übersicht über die Wiederherstellungs Initialisierung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6eb62e5282a74e38cd53d36c8ba004f4b8069746
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104131269"
---
# <a name="overview-of-restore-initialization"></a><span data-ttu-id="95aab-103">Übersicht über die Wiederherstellungs Initialisierung</span><span class="sxs-lookup"><span data-stu-id="95aab-103">Overview of Restore Initialization</span></span>

<span data-ttu-id="95aab-104">Beim Initialisieren eines VSS-Wiederherstellungs Vorgangs muss ein Anforderer das Sicherungs Komponenten Dokument und jedes relevante Writer-Metadatendokument abrufen, das während des Sicherungs Vorgangs erstellt und gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="95aab-104">In initializing a VSS restore operation, a requester needs to retrieve the Backup Component Document and each relevant Writer Metadata Document created and saved during the backup operation.</span></span> <span data-ttu-id="95aab-105">Der aktuelle Zustand des Writers wird bei der Behandlung des vom Anforderer generierten [*identifizereignisses*](vssgloss-i.md) abgefragt.</span><span class="sxs-lookup"><span data-stu-id="95aab-105">The writer will have its current state queried in handling the [*Identify event*](vssgloss-i.md) that the requester generates.</span></span> <span data-ttu-id="95aab-106">Weitere Informationen finden Sie [unter Übersicht über die Verarbeitung einer Wiederherstellung unter VSS](overview-of-processing-a-restore-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="95aab-106">For more information, see [Overview of Processing a Restore Under VSS](overview-of-processing-a-restore-under-vss.md).</span></span>

<span data-ttu-id="95aab-107">In der folgenden Tabelle wird die Abfolge der Aktionen und Ereignisse angezeigt, die zum Initialisieren eines Wiederherstellungs Vorgangs erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="95aab-107">The following table shows the sequence of actions and events that are required to initialize a restore operation.</span></span>



| <span data-ttu-id="95aab-108">Requestaktion</span><span class="sxs-lookup"><span data-stu-id="95aab-108">Requester action</span></span>                                                                                                                                                                                                                                                                                                       | <span data-ttu-id="95aab-109">Ereignis</span><span class="sxs-lookup"><span data-stu-id="95aab-109">Event</span></span>                                                     | <span data-ttu-id="95aab-110">Writer-Aktion</span><span class="sxs-lookup"><span data-stu-id="95aab-110">Writer action</span></span>                                                                                                                                                                                                                                                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="95aab-111">Erstellen Sie eine [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) -Schnittstelle, initialisieren Sie Sie, um eine Wiederherstellung zu verwalten, und laden Sie gespeicherte requestmetadaten (siehe " [**foratevssbackupcomponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents)", [**IVssBackupComponents:: initializeforrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore)).</span><span class="sxs-lookup"><span data-stu-id="95aab-111">Create an [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface, initialize it to manage a restore, and load stored requester metadata (see [**CreateVssBackupComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents), [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore)).</span></span> | <span data-ttu-id="95aab-112">Keine</span><span class="sxs-lookup"><span data-stu-id="95aab-112">None</span></span>                                                      | <span data-ttu-id="95aab-113">Keine</span><span class="sxs-lookup"><span data-stu-id="95aab-113">None</span></span>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="95aab-114">Rufen Sie " [**kreatevssexaminewrite Metadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) " auf, um [**ivssexaminewrite Metadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) -Schnittstellen zu erstellen und Sie mit gespeicherten Writer-Metadaten zu laden.</span><span class="sxs-lookup"><span data-stu-id="95aab-114">Call [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) to create [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interfaces and load them with stored writer metadata.</span></span>                                                                                                           | <span data-ttu-id="95aab-115">Keine</span><span class="sxs-lookup"><span data-stu-id="95aab-115">None</span></span>                                                      | <span data-ttu-id="95aab-116">Keine</span><span class="sxs-lookup"><span data-stu-id="95aab-116">None</span></span>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="95aab-117">Initiieren eines asynchronen Kontakts mit Writern (siehe [**IVssBackupComponents:: gatherwritermetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).)</span><span class="sxs-lookup"><span data-stu-id="95aab-117">Initiate asynchronous contact with writers (see [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).)</span></span>                                                                                                                                                                      | [<span data-ttu-id="95aab-118">*Identifizieren*</span><span class="sxs-lookup"><span data-stu-id="95aab-118">*Identify*</span></span>](vssgloss-i.md) | <span data-ttu-id="95aab-119">Der Writer startet die Ereignis Behandlung zur Unterstützung der Wiederherstellung.</span><span class="sxs-lookup"><span data-stu-id="95aab-119">The writer begins event handling in support of the restore.</span></span> <span data-ttu-id="95aab-120">Erstellt das Writer-Metadatendokument (Weitere Informationen finden Sie unter [Arbeiten mit dem Writer-Metadatendokument](working-with-the-writer-metadata-document.md) [**CVssWriter:: OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify), [**ivsskreateschreitermetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata)).</span><span class="sxs-lookup"><span data-stu-id="95aab-120">Creates the Writer Metadata Document (see [Working with the Writer Metadata Document](working-with-the-writer-metadata-document.md), [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify), [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata)).</span></span> |
| <span data-ttu-id="95aab-121">Der Anforderer wartet darauf, dass Writer durch Aufrufen von [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync)initialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="95aab-121">The requester waits for writers to initialize by calling [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span></span>                                                                                                                                                                                                                               | <span data-ttu-id="95aab-122">Keine</span><span class="sxs-lookup"><span data-stu-id="95aab-122">None</span></span>                                                      | <span data-ttu-id="95aab-123">Keine</span><span class="sxs-lookup"><span data-stu-id="95aab-123">None</span></span>                                                                                                                                                                                                                                                                                                                      |



 

## <a name="requester-actions-during-restore-initialization"></a><span data-ttu-id="95aab-124">Requestaktionen während der Wiederherstellungs Initialisierung</span><span class="sxs-lookup"><span data-stu-id="95aab-124">Requester Actions during Restore Initialization</span></span>

<span data-ttu-id="95aab-125">Während der Initialisierungsphase einer Wiederherstellung benötigt der Anforderer Zugriff auf das Dokument mit den gespeicherten Sicherungs Komponenten und alle Writer-Metadatendokumente.</span><span class="sxs-lookup"><span data-stu-id="95aab-125">During the initialization phase of a restore, the requester needs to have access to the stored Backup Components Document and all the Writer Metadata Documents.</span></span>

<span data-ttu-id="95aab-126">Abhängig von der Implementierung bedeutet dies entweder, dass die anfordernde Person erfordert, dass Sicherungsmedien bereitgestellt und lesbar sind, oder dass ein anderer Mechanismus für den Zugriff auf die gespeicherten Metadaten verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="95aab-126">Depending on the implementation, this will mean either that the requester will require that backup media be mounted and readable, or that some other mechanism for accessing the stored metadata be available.</span></span>

<span data-ttu-id="95aab-127">Der Anforderer verwendet das gespeicherte XML-Dokument mit dem Sicherungs Komponenten Dokument der anfordernden Person, die die Sicherung ausgeführt hat, um das Dokument mit den Sicherungs Komponenten zu initialisieren, indem [**IVssBackupComponents:: initializeforrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore) auf die Informationen zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="95aab-127">The requester uses the stored XML document containing the Backup Components Document of the requester that performed the backup to initialize its Backup Components Document using [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore) can access the information.</span></span>

<span data-ttu-id="95aab-128">Wie im Fall der Sicherung, enthält das Dokument mit den Sicherungs Komponenten nicht genügend Informationen, um eine Wiederherstellung zu unterstützen. Daher benötigt der Anforderer Zugriff auf die während der Sicherung gespeicherten Writer-Metadatendokumente (siehe [Verwendung von Komponenten durch den Anforderer](use-of-components-by-the-requestor.md)).</span><span class="sxs-lookup"><span data-stu-id="95aab-128">As was the case during the backup, the Backup Components Document has insufficient information to support a restore; therefore, the requester needs access to those Writer Metadata Documents stored during backup (see [Use of Components by the Requester](use-of-components-by-the-requestor.md)).</span></span>

<span data-ttu-id="95aab-129">Der Anforderer Ruft die gespeicherten Writer-Metadaten durch Aufrufen von [**createvssexaminewrite Metadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) für jeden Writer ab, dessen Daten gesichert und nun wieder hergestellt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="95aab-129">The requester retrieves the stored writer metadata by calling [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) for each writer whose data was backed up and now is to be restored.</span></span> <span data-ttu-id="95aab-130">Diese Funktion erstellt ein [**ivssexaminewrite Metadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) -Objekt für jeden Writer und lädt das Writer-Metadatendokument des Writers in das-Objekt.</span><span class="sxs-lookup"><span data-stu-id="95aab-130">This function creates an [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) object for each writer and loads the writer's Writer Metadata Document into the object.</span></span>

<span data-ttu-id="95aab-131">Wie bei der Sicherung, um die Zusammenarbeit zwischen sich selbst und den Writern des Systems zu initiieren, muss ein Anforderer durch Aufrufen von [**IVssBackupComponents:: gatherwritermetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata)ein [*identifizereignis*](vssgloss-i.md) generieren.</span><span class="sxs-lookup"><span data-stu-id="95aab-131">As was the case during the backup, to initiate cooperation between itself and the system's writers, a requester must generate an [*Identify*](vssgloss-i.md) event by calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span> <span data-ttu-id="95aab-132">Es ist nicht erforderlich, [**IVssBackupComponents:: gatherschreiterstatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) nach dem Abschluss von [**gatherwrite Metadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata)aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="95aab-132">It is not necessary to call [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) following the completion of [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span> <span data-ttu-id="95aab-133">Writer, die das [*identifizereignis*](vssgloss-i.md) nicht verarbeiten können, sind nicht in der Liste der Writer enthalten, die die Metadaten bereitstellen, die von [**IVssBackupComponents:: GetWriterMetadataCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadatacount) und [**IVssBackupComponents:: getwritermetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) zurückgegeben werden (siehe [Ermitteln des Writer-Status](determining-writer-status.md)).</span><span class="sxs-lookup"><span data-stu-id="95aab-133">Writers that fail to process the [*Identify*](vssgloss-i.md) event will not be included in the list of writers providing the metadata to be returned by [**IVssBackupComponents::GetWriterMetadataCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadatacount) and [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (see [Determining Writer Status](determining-writer-status.md)).</span></span>

<span data-ttu-id="95aab-134">Wie beim Sicherungs Vorgang muss ein Anforderer die Informationen im Dokument mit den Sicherungs Komponenten Abfragen und analysieren und mit den Daten in den Writer-Metadatendokumenten vergleichen, um zu bestimmen, welche Komponenten gesichert wurden und welche Komponenten wieder hergestellt werden sollen (Weitere Informationen finden Sie unter [Übersicht über die Vorbereitung der Wiederherstellung](overview-of-preparing-for-restore.md)).</span><span class="sxs-lookup"><span data-stu-id="95aab-134">As with the backup operation, a requester will need to query and parse the information in the Backup Components Document and compare it to data in the Writer Metadata Documents to determine which components were backed up and to choose those to be restored (see [Overview of Preparing for Restore](overview-of-preparing-for-restore.md)).</span></span> <span data-ttu-id="95aab-135">Außerdem muss die anfordernde Person eine detaillierte Liste mit Informationen zu den Dateien auf dem Sicherungsmedium generieren, das für die Wiederherstellung ausgewählt wurde, sowie darüber, wie und wo Sie wieder hergestellt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="95aab-135">In addition, the requester will need to generate a detailed list containing information about the files on the backup media selected for restore, as well as how and where they are to be restored.</span></span> <span data-ttu-id="95aab-136">(Siehe [Erstellen einer Wiederherstellungs Gruppe](generating-a-restore-set.md).)</span><span class="sxs-lookup"><span data-stu-id="95aab-136">(See [Generating a Restore Set](generating-a-restore-set.md).)</span></span>

<span data-ttu-id="95aab-137">Daher ist es bei einigen Sicherungs Anwendungen möglicherweise hilfreich, auf dem Sicherungsmedium eine eigene Liste (in Ihrem eigenen optimierten Format) der Dateien und deren zugeordneten Writer, Komponenten, Wiederherstellungs Prozeduren und Speicherort Informationen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="95aab-137">Therefore, some backup applications may find it useful to have stored on the backup media their own list (in their own optimized format) of the files and their associated writer, component, restore procedure, and location information.</span></span> <span data-ttu-id="95aab-138">Diese Liste kann verwendet werden, um den Umfang der Verarbeitung und den Vergleich von Writer-Metadatendokumenten und den Sicherungs Komponenten Dokumenten zu minimieren, die zur Unterstützung einer Wiederherstellung erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="95aab-138">This list can be used to minimize the amount of parsing and comparing of Writer Metadata Documents and the Backup Component Documents required to support a restore.</span></span>

## <a name="writer-actions-during-restore-initialization"></a><span data-ttu-id="95aab-139">Writer-Aktionen während der Wiederherstellungs Initialisierung</span><span class="sxs-lookup"><span data-stu-id="95aab-139">Writer Actions during Restore Initialization</span></span>

<span data-ttu-id="95aab-140">Wie bei einem Wiederherstellungs Vorgang durchgeführt, ruft VSS als Reaktion auf das identifizereignis die virtuelle Handlermethode " [**CVssWriter:: OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify)" für jeden Writer auf.</span><span class="sxs-lookup"><span data-stu-id="95aab-140">Just as is done during a restore operation, in response to the Identify event, VSS calls each writer's virtual handler method [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify).</span></span>

<span data-ttu-id="95aab-141">Beachten Sie, dass andere Anwendungen als der aktuelle Anforderer (z.b. Systemanwendungen) Identifikations Ereignisse generieren können, die vom Writer behandelt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="95aab-141">Note that applications other than the current requester (for instance, system applications) can generate Identify events, which must be handled by the writer.</span></span> <span data-ttu-id="95aab-142">Außerdem kann ein Writer nicht innerhalb von [**CVssWriter:: OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) ermitteln, welche Anwendung das Identifikations Ereignis generiert hat.</span><span class="sxs-lookup"><span data-stu-id="95aab-142">In addition, there is no way for a writer to determine from within [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) which application has generated the Identify event.</span></span>

<span data-ttu-id="95aab-143">Wenn ein Writer bei der Verarbeitung eines Wiederherstellungs Vorgangs mehrere identifizierungsereignisse erhalten kann, sollten die Writer niemals Zustandsinformationen im [**CVssWriter:: OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) -Handler festlegen.</span><span class="sxs-lookup"><span data-stu-id="95aab-143">Given that a writer may receive several Identify events while processing a restore operation, writers should never set state information in the [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) handler.</span></span> <span data-ttu-id="95aab-144">Stattdessen müssen Sie denselben Algorithmus zum Erstellen Ihres Writer-Metadatendokuments verwenden, wie es bei Sicherungs Vorgängen geschehen ist (Weitere Informationen finden Sie unter [Writer-Aktionen während der Initialisierung der Sicherung](overview-of-backup-initialization.md) ).</span><span class="sxs-lookup"><span data-stu-id="95aab-144">Instead, they must use the same algorithm for creating their Writer Metadata Document as was done during backup operations (see [Writer Actions during Backup Initialization](overview-of-backup-initialization.md) for more information).</span></span>

 

 



