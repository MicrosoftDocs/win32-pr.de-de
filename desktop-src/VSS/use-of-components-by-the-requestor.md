---
description: Zusätzlich zum Durchführen einer Sicherung oder Wiederherstellung sowie zum Überwachen von Schatten Kopien muss ein Anforderer Informationen zu den Komponenten der Writer verwalten, mit denen er interagiert.
ms.assetid: 641abfbe-fc72-4468-9ef6-69c452adb1b3
title: Verwendung von Komponenten durch den Anforderer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83efdb9e80ac0331289c3b611978e66a58098de6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526306"
---
# <a name="use-of-components-by-the-requester"></a><span data-ttu-id="b360e-103">Verwendung von Komponenten durch den Anforderer</span><span class="sxs-lookup"><span data-stu-id="b360e-103">Use of Components by the Requester</span></span>

<span data-ttu-id="b360e-104">Zusätzlich zum Durchführen einer Sicherung oder Wiederherstellung sowie zum Überwachen von Schatten Kopien muss ein Anforderer Informationen zu den Komponenten der Writer verwalten, mit denen er interagiert.</span><span class="sxs-lookup"><span data-stu-id="b360e-104">In addition to performing a backup or restore, and supervising shadow copies, a requester must manage information about the components of the writers it interacts with.</span></span> <span data-ttu-id="b360e-105">Die Komponentenauswahl und der logische Pfad werden verwendet, um Daten aus einer Sicherung einzubeziehen oder auszuschließen, und um zu entscheiden, welche Komponenten Informationen im Dokument mit den Sicherungs Komponenten enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="b360e-105">Component selectability and logical path are used to include or exclude data from a backup, and to decide what component information is included in the Backup Components Document.</span></span>

## <a name="requester-component-selection-during-backup"></a><span data-ttu-id="b360e-106">Auswahl der requestkomponente während der Sicherung</span><span class="sxs-lookup"><span data-stu-id="b360e-106">Requester Component Selection during Backup</span></span>

<span data-ttu-id="b360e-107">Während des Sicherungs Vorgangs importiert ein Anforderer mithilfe der Methoden [**IVssBackupComponents:: gatherschreitermetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) und [**IVssBackupComponents:: getschreitermetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (siehe [Übersicht über die Sicherungs Initialisierung](overview-of-backup-initialization.md) ).</span><span class="sxs-lookup"><span data-stu-id="b360e-107">During backup operations, a requester imports writer metadata component data using the [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) and [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) methods (see [Overview of Backup Initialization](overview-of-backup-initialization.md) for more information).</span></span>

<span data-ttu-id="b360e-108">Nach dem untersuchen von Writer-Informationen mit der [**ivssexaminewritermetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) -Schnittstelle entscheidet ein Anforderer, welche Writer er sichert und in begrenztem Umfang, welche der Komponenten eines bestimmten Writers wieder gesichert werden.</span><span class="sxs-lookup"><span data-stu-id="b360e-108">After examining writer information with the [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface, a requester decides which writers it will back up and, to a limited extent, which of a given writer's components it will back up.</span></span>

<span data-ttu-id="b360e-109">Beim Sichern eines Writers wird ein Anforderer:</span><span class="sxs-lookup"><span data-stu-id="b360e-109">When backing up a writer, a requester:</span></span>

-   <span data-ttu-id="b360e-110">Muss [*explizit*](vssgloss-e.md) alle nicht auswählbaren Writer für Sicherungs Komponenten einschließen, ohne für Sicherungs-Vorgänger verfügbar zu sein, indem [**IVssBackupComponents:: addComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) zum Hinzufügen der Komponente zum Sicherungs Komponenten Dokument verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="b360e-110">Must [*explicitly include*](vssgloss-e.md) all of a writer's nonselectable for backup components without selectable for backup ancestors using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) to add the component to the Backup Components Document</span></span>
-   <span data-ttu-id="b360e-111">Kann explizit beliebige für Sicherungs Komponenten auswählbare Writer einschließen, indem [**IVssBackupComponents:: addComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) verwendet wird, um die Komponente dem Dokument mit den Sicherungs Komponenten hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="b360e-111">May explicitly include any of a writer's selectable for backup components using [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) to add the component to the Backup Components Document</span></span>
-   <span data-ttu-id="b360e-112">Wenn eine auswählbare for Backup-Komponente einen [*Komponenten Satz*](vssgloss-c.md)definiert, [*umfasst*](vssgloss-i.md) die explizite Einbindung implizit alle Mitglieder des Komponenten Satzes – ob für die Sicherung auswählbar.</span><span class="sxs-lookup"><span data-stu-id="b360e-112">If a selectable for backup component defines a [*component set*](vssgloss-c.md), its explicit inclusion [*implicitly includes*](vssgloss-i.md) all the component set's members—whether selectable for backup or not.</span></span> <span data-ttu-id="b360e-113">Diese Komponenten werden dem Dokument mit den Sicherungs Komponenten nicht hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="b360e-113">These components are not added to the Backup Components Document.</span></span>

<span data-ttu-id="b360e-114">Beim Hinzufügen einer auswählbaren for Backup-Komponente oder einer nicht auswählbaren Sicherungs Komponente für Sicherungs Komponenten, die für die Sicherung von Vorgängerversionen in den Sicherungs Komponenten dokumentiert sind, gibt ein Anforderer Folgendes</span><span class="sxs-lookup"><span data-stu-id="b360e-114">In adding a selectable for backup component or a nonselectable for backup components without selectable for backup ancestors to its Backup Components Document, a requester specifies the following:</span></span>

-   <span data-ttu-id="b360e-115">Die Instanz des Writers, der die Komponente verwaltet.</span><span class="sxs-lookup"><span data-stu-id="b360e-115">The instance of the writer managing the component</span></span>
-   <span data-ttu-id="b360e-116">Der Klassen Bezeichner des Writers.</span><span class="sxs-lookup"><span data-stu-id="b360e-116">The writer's class identifier</span></span>
-   <span data-ttu-id="b360e-117">Der [*logische Pfad*](vssgloss-l.md) der Komponente (die möglicherweise **null** ist).</span><span class="sxs-lookup"><span data-stu-id="b360e-117">The [*logical path*](vssgloss-l.md) of the component (which may be **NULL**)</span></span>
-   <span data-ttu-id="b360e-118">Der Name der Komponente.</span><span class="sxs-lookup"><span data-stu-id="b360e-118">The component's name</span></span>

<span data-ttu-id="b360e-119">Wenn eine Komponente nicht mit der Spezifikation identisch ist, wird ein Fehler zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="b360e-119">If a component does not match the specification, an error will be returned.</span></span>

<span data-ttu-id="b360e-120">Wenn eine solche Komponente vorhanden ist, erstellt VSS im Dokument mit den Sicherungs Komponenten eine [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) -Schnittstelle für die Komponente.</span><span class="sxs-lookup"><span data-stu-id="b360e-120">If such a component exists, VSS creates an [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface for the component in the Backup Components Document.</span></span> <span data-ttu-id="b360e-121">Diese Informationen können vom Writer und der Anforderer aufgerufen und geändert werden.</span><span class="sxs-lookup"><span data-stu-id="b360e-121">This information will be accessible and modifiable by the writer and requester.</span></span> <span data-ttu-id="b360e-122">Für eine auswählbare Komponente, die einen [*Komponenten Satz*](vssgloss-c.md)definiert, werden nicht nur Eigenschaften der Komponente, sondern auch alle darin enthaltenen unter Komponenten beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b360e-122">For a selectable component that defines a [*component set*](vssgloss-c.md), it describes not only properties of the component but also all the subcomponents it contains.</span></span>

<span data-ttu-id="b360e-123">Informationen zu implizit hinzugefügten Komponenten sind im Dokument mit den Sicherungs Komponenten nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="b360e-123">Information about implicitly added components is not available in the Backup Components Document.</span></span> <span data-ttu-id="b360e-124">Außerdem sind keine Dateiinformationen im Dokument mit den Sicherungs Komponenten verfügbar.</span><span class="sxs-lookup"><span data-stu-id="b360e-124">In addition, no file information is available in the Backup Components Document.</span></span> <span data-ttu-id="b360e-125">Um diese Informationen zu erhalten, muss der Anforderer die Writer-Metadatendokumente (die bereits gelesen wurden) im Kontext der ausgewählten gespeicherten Komponenten im Dokument mit den Sicherungs Komponenten untersuchen.</span><span class="sxs-lookup"><span data-stu-id="b360e-125">To obtain that information, the requester will have to examine the Writer Metadata Documents (which will have already been read) in the context of the selected stored components in the Backup Components Document.</span></span>

## <a name="requester-component-selection-during-restore"></a><span data-ttu-id="b360e-126">Auswahl der requestkomponente während der Wiederherstellung</span><span class="sxs-lookup"><span data-stu-id="b360e-126">Requester Component Selection during Restore</span></span>

<span data-ttu-id="b360e-127">Während des Wiederherstellungs Vorgangs sollte ein Anforderer keine Komponenten Informationen von den zurzeit im System aktiven Writern über [**IVssBackupComponents:: gatherwritermetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata)importieren, da der Status der derzeit ausgeführten Prozesse nicht notwendigerweise den Status der Prozesse widerspiegelt, wenn eine Sicherung erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="b360e-127">During restore operations, a requester should not import component information from the writers currently active on the system via [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), because the state of currently executing processes will not necessarily reflect the state of processes when a backup was made.</span></span>

<span data-ttu-id="b360e-128">Es sollte immer noch ein [*identifiz-Ereignis*](vssgloss-i.md) über [**IVssBackupComponents:: gatherwritermetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata)generiert werden, um ein *identifizereignis* zu erstellen und um zu bestimmen, welche Writer aktuell im System und deren Status sind.</span><span class="sxs-lookup"><span data-stu-id="b360e-128">It should still generate an [*Identify event*](vssgloss-i.md) via [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), both to create an *Identify event* and to determine which writers are currently on the system and their status.</span></span>

<span data-ttu-id="b360e-129">Der Anforderer Ruft das Dokument der gespeicherten Sicherungs Komponenten während der Initialisierung sowie gespeicherter Writer-Metadatendokumente ab (Weitere Informationen finden Sie unter [Übersicht über die Wiederherstellungs Initialisierung](overview-of-restore-initialization.md) ).</span><span class="sxs-lookup"><span data-stu-id="b360e-129">The requester retrieves the stored Backup Components Document during its initialization as well as stored Writer Metadata Documents (see [Overview of Restore Initialization](overview-of-restore-initialization.md) for more information) .</span></span>

<span data-ttu-id="b360e-130">Die Einbindung von Komponenten während der Sicherung ist größtenteils identisch mit denen für die Wiederherstellung, mit der Ausnahme, dass Sie [*für die Wiederherstellung eine auswählbare*](vssgloss-s.md) Verbindung mit dem [*logischen Pfad*](vssgloss-l.md)– nicht [*für die Sicherung ausgewählt*](vssgloss-s.md)haben</span><span class="sxs-lookup"><span data-stu-id="b360e-130">Inclusion of components during backup is largely the same as that for restore, except that you must consider [*selectable for restore*](vssgloss-s.md) along with [*logical path*](vssgloss-l.md)—not [*selectable for backup*](vssgloss-s.md).</span></span>

<span data-ttu-id="b360e-131">Es gibt jedoch einige Unterschiede:</span><span class="sxs-lookup"><span data-stu-id="b360e-131">There are, however, some differences:</span></span>

-   <span data-ttu-id="b360e-132">Wenn eine Komponente bei der Sicherung bereits explizit im Sicherungs Komponenten Dokument [*enthalten*](vssgloss-e.md) ist, wird [**IVssBackupComponents:: setselectedforrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) verwendet, um Sie explizit zum Sicherungs Komponenten Dokument für die Wiederherstellung hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="b360e-132">If a component has already been [*explicitly included*](vssgloss-e.md) to the Backup Components Document during backup, if it is included for restore (either explicitly or implicitly), [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) is used to explicitly add it to the Backup Components Document for restore.</span></span>
-   <span data-ttu-id="b360e-133">Wenn eine Komponente implizit in die Sicherung [*eingeschlossen*](vssgloss-i.md) wurde und für die Wiederherstellung nicht ausgewählt werden kann, ohne dass für die Wiederherstellung auswählbare Elemente vorhanden sind – was im Sicherungs Fall impliziert, dass eine explizite Einbindung erforderlich ist – ist die Komponente nicht explizit eingeschlossen (d. h., Sie wird nicht im Dokument mit den Sicherungs Komponenten mithilfe von [**IVssBackupComponents:**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore)</span><span class="sxs-lookup"><span data-stu-id="b360e-133">If a component was [*implicitly included*](vssgloss-i.md) to the backup, and is nonselectable for restore with no selectable for restore ancestors—which in the backup case would imply the need for explicit inclusion—the component is not explicitly included (that is, it is not added to the Backup Components Document using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore)).</span></span> <span data-ttu-id="b360e-134">Eine solche Komponente sollte als implizit für die Wiederherstellung ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="b360e-134">Such a component should be considered implicitly selected for restore.</span></span>
-   <span data-ttu-id="b360e-135">Der Komponenten, die implizit für die Sicherung ausgewählt wurden (unabhängig davon, ob diese Komponente für die Sicherung ausgewählt wurde oder nicht), können nur diejenigen, die für die Wiederherstellung ausgewählt werden können, dem Dokument mit den Sicherungs Komponenten mithilfe von [**IVssBackupComponents:: adressstoresubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent)hinzugefügt werden</span><span class="sxs-lookup"><span data-stu-id="b360e-135">Of those components implicitly selected for backup (whether that component was selectable for backup or not), only those that are selectable for restore can be added to the Backup Components Document using [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>
-   <span data-ttu-id="b360e-136">Auswählbar für Wiederherstellungs Komponenten kann eine [*Komponentengruppe*](vssgloss-c.md) für die Wiederherstellung definieren – genau so, wie Sie für Sicherungs Komponenten ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="b360e-136">Selectable for restore components may define a [*component set*](vssgloss-c.md) for restore—just as selectable for backup components do.</span></span> <span data-ttu-id="b360e-137">Diese Komponente für die Wiederherstellung ist dann für den Wiederherstellungs Vorgang definiert.</span><span class="sxs-lookup"><span data-stu-id="b360e-137">This selectable for restore component then defines this component set for the restore operation.</span></span>

<span data-ttu-id="b360e-138">Ein Writer ohne explizit für die Wiederherstellung ausgewählte Komponenten vor der Generierung eines [*vorab*](vssgloss-p.md) Ereignisses werden keine VSS-Ereignisse empfangen.</span><span class="sxs-lookup"><span data-stu-id="b360e-138">A writer with no components explicitly selected for restore prior to the generation of a [*PreRestore*](vssgloss-p.md) event will not receive any VSS events.</span></span>

<span data-ttu-id="b360e-139">Requester und Writer können mithilfe der [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) -Schnittstelle auf Informationen gespeicherter Komponenten zugreifen.</span><span class="sxs-lookup"><span data-stu-id="b360e-139">Requesters and writers can access stored component information using the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span> <span data-ttu-id="b360e-140">Mithilfe der **IVssComponent** -Schnittstelle können Writer einige der Einstellungen der Komponenten, die im Dokument mit den Sicherungs Komponenten explizit enthalten sind, ändern, um eine Wiederherstellung zu unterstützen (z. b. das [*Wiederherstellungs Ziel*](vssgloss-r.md)).</span><span class="sxs-lookup"><span data-stu-id="b360e-140">Through the **IVssComponent** interface, writers can modify some of the settings of those of its components explicitly included in the Backup Components Document to support a restore (such as the [*restore target*](vssgloss-r.md)).</span></span> <span data-ttu-id="b360e-141">Wenn ein Komponenten Satz definiert wird, werden Writer-Änderungen einer explizit enthaltenen Komponente an die zugehörigen [*unter Komponenten*](vssgloss-s.md)weitergegeben.</span><span class="sxs-lookup"><span data-stu-id="b360e-141">If it defines a component set, writer modifications of an explicitly included component will propagate to its [*subcomponents*](vssgloss-s.md).</span></span> <span data-ttu-id="b360e-142">Außerdem bietet die-Schnittstelle einen Mechanismus zum Übergeben von Informationen über Erfolg und Fehler von Wiederherstellung zwischen Writer und Anforderer.</span><span class="sxs-lookup"><span data-stu-id="b360e-142">In addition, the interface provides a mechanism for passing information about restore success and failure between writer and requester.</span></span>

<span data-ttu-id="b360e-143">Wie bei der Sicherung sind im Dokument mit den Sicherungs Komponenten nicht genügend Informationen vorhanden, um die Wiederherstellung zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="b360e-143">As during backup, there is insufficient information in the Backup Components Document itself to implement the restore.</span></span> <span data-ttu-id="b360e-144">Auch hier sind die Writer-Metadatendokumente erforderlich, um Informationen über die tatsächlichen Pfade der wiederherzustellenden Dateien bereitzustellen und um zu ermitteln, welche nicht auswählbaren Komponenten Teil des auswählbaren Komponenten Satzes sind und daher wieder hergestellt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="b360e-144">Again, the Writer Metadata Documents will be required to supply information about the actual paths of files to be restored and to discover what nonselectable components are part of the selectable components component set and therefore need to be restored.</span></span>

<span data-ttu-id="b360e-145">Weitere Informationen zu den Arten der selekabilität und deren Verwendung finden Sie unter [Arbeiten mit selekabilität und logischen Pfaden](working-with-selectability-and-logical-paths.md) .</span><span class="sxs-lookup"><span data-stu-id="b360e-145">See [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md) for information about the types of selectability and their usage.</span></span>

## <a name="use-of-writer-component-document-information-by-the-requester"></a><span data-ttu-id="b360e-146">Verwendung von Dokument Informationen des Writer-Komponente durch den Anforderer</span><span class="sxs-lookup"><span data-stu-id="b360e-146">Use of Writer Component Document Information by the Requester</span></span>

<span data-ttu-id="b360e-147">Jede Komponente wird eindeutig durch die [*Writer-Klassen-ID*](vssgloss-w.md) des übergeordneten Writers, den Namen und den [*logischen Pfad*](vssgloss-l.md)identifiziert.</span><span class="sxs-lookup"><span data-stu-id="b360e-147">Each component is uniquely identified by the [*Writer Class ID*](vssgloss-w.md) of its parent writer, its name, and its [*logical path*](vssgloss-l.md).</span></span>

<span data-ttu-id="b360e-148">Der Anforderer kann die von der [**IVssBackupComponents:: getschreitercomponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents) -Methode zurückgegebene [**ivssschreitercomponentset**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) -Schnittstelle verwenden, um Informationen zu jeder gespeicherten Komponente abzurufen.</span><span class="sxs-lookup"><span data-stu-id="b360e-148">The requester can use the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface returned by the [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents) method to obtain information about each stored component.</span></span>

<span data-ttu-id="b360e-149">Der Name und der logische Pfad der Komponente (unter anderen Elementen) finden Sie über die von [**ivssschreitercomponentslog:: getComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent)zurückgegebene [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="b360e-149">The component's name and logical path (among other items) can be found via the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface returned by [**IVssWriterComponentsExt::GetComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent).</span></span>

> [!Note]  
> <span data-ttu-id="b360e-150">Während der Wiederherstellungs Phase sollte der Anforderer [**ivssschreitercomponentsext:: getComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent) oder [**ivssschreitercomponentsext:: getcomponentcount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponentcount) nur aufrufen, nachdem der Aufruf von [**IVssBackupComponents::P**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) Realisierungs Vorgang zurückgegeben wurde, um dem Writer Zeit zu geben, das Dokument mit den Sicherungs Komponenten zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="b360e-150">During the restore phase, the requester should call [**IVssWriterComponentsExt::GetComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent) or [**IVssWriterComponentsExt::GetComponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponentcount) only after the call to [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) has returned, to allow time for the writer to update the Backup Components Document.</span></span> <span data-ttu-id="b360e-151">Ein Beispiel für eine solche Aktualisierung wäre das Ändern des Wiederherstellungs Ziels.</span><span class="sxs-lookup"><span data-stu-id="b360e-151">One example of such an update would be to change the restore target.</span></span>

 

<span data-ttu-id="b360e-152">Informationen zu den übergeordneten Writer der einzelnen gespeicherten auswählbaren Komponenten finden Sie unter Verwendung von [**ivssschreitercomponentsxt:: getschreiterinfo**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getwriterinfo).</span><span class="sxs-lookup"><span data-stu-id="b360e-152">Information about each stored selectable component's parent writer can be found using [**IVssWriterComponentsExt::GetWriterInfo**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getwriterinfo).</span></span>

<span data-ttu-id="b360e-153">Mit diesen Informationen können die Writer-Metadatendokumente abgefragt und das übereinstimmende Dokument identifiziert werden.</span><span class="sxs-lookup"><span data-stu-id="b360e-153">With this information, the Writer Metadata Documents can be queried and the matching document identified.</span></span> <span data-ttu-id="b360e-154">Anschließend kann der Anforderer mit dem [*logischen Pfad*](vssgloss-l.md)die abhängigen, nicht auswählbaren Komponenten für jede auswählbare Komponente identifizieren, d. –. alle Elemente der [*Komponentengruppe*](vssgloss-c.md)der auswählbaren Komponente identifizieren.</span><span class="sxs-lookup"><span data-stu-id="b360e-154">Then, by using the [*logical path*](vssgloss-l.md), the requester can identify the dependent nonselectable components for each selectable component—that is, identify all members of the selectable component's [*component set*](vssgloss-c.md).</span></span>

<span data-ttu-id="b360e-155">Mithilfe der [**ivssexaminewrite Metadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) -Schnittstelle verfügt der Anforderer nun über vollständige Komponenten Informationen – einschließlich der Pfadspezifikation (von der [**ivsswmcomponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) -Schnittstelle) – sowohl für auswählbare als auch für nicht auswählbare Komponenten, die Sie sichern oder wiederherstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="b360e-155">Using the [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interface, the requester now has full component information—including path specification (from the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface)—for both selectable and nonselectable components it needs to back up or restore.</span></span>

<span data-ttu-id="b360e-156">Dies ist ein Grund, warum es wichtig ist, dass ein Anforderer sowohl den Zustand seines eigenen Sicherungs Komponenten Dokuments als auch die Writer-Metadatendokumente der von ihm gesicherten Writer speichert.</span><span class="sxs-lookup"><span data-stu-id="b360e-156">This is one reason why it is vital for a requester to save both the state of its own Backup Components Document and the Writer Metadata Documents of the writers it is backing up.</span></span>

<span data-ttu-id="b360e-157">Ausführlichere Informationen finden Sie [unter Arbeiten mit selekabilität und logischen Pfaden](working-with-selectability-and-logical-paths.md) .</span><span class="sxs-lookup"><span data-stu-id="b360e-157">See [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md) for more detailed information.</span></span>

 

 
