---
description: Es gibt Situationen, in denen Daten von einem Writer von Daten abhängen, die von einem anderen Writer verwaltet werden. In diesen Fällen sollten Sie Daten von beiden Writern sichern oder wiederherstellen.
ms.assetid: 0413c289-74b7-4e83-a227-00bfb264e56e
title: Abhängigkeiten zwischen Komponenten, die von unterschiedlichen Writern verwaltet werden
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 91ba3be6a2c2f0a722c4c5f06ca95351e004e1cd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104349269"
---
# <a name="dependencies-between-components-managed-by-different-writers"></a><span data-ttu-id="35f1a-104">Abhängigkeiten zwischen Komponenten, die von unterschiedlichen Writern verwaltet werden</span><span class="sxs-lookup"><span data-stu-id="35f1a-104">Dependencies between Components Managed by Different Writers</span></span>

<span data-ttu-id="35f1a-105">Es gibt Situationen, in denen Daten von einem Writer von Daten abhängen, die von einem anderen Writer verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-105">There are situations where data from one writer depends on data managed by another writer.</span></span> <span data-ttu-id="35f1a-106">In diesen Fällen sollten Sie Daten von beiden Writern sichern oder wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-106">In these cases, you should back up or restore data from both writers.</span></span>

<span data-ttu-id="35f1a-107">VSS behandelt dieses Problem durch das Konzept einer expliziten Writer-Component-Abhängigkeit und der [**ivsswmabhängigkeits**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="35f1a-107">VSS handles this problem through the notion of an explicit writer-component dependency and the [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) interface.</span></span>

<span data-ttu-id="35f1a-108">Ein Writer Fügt beim Erstellen des Writer-Metadatendokuments mithilfe der [**ivsskreateschreitermetadata:: AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) -Methode eine oder mehrere Abhängigkeiten hinzu.</span><span class="sxs-lookup"><span data-stu-id="35f1a-108">A writer adds one or more dependencies while creating the Writer Metadata Document using the [**IVssCreateWriterMetadata::AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) method.</span></span> <span data-ttu-id="35f1a-109">Der Writer übergibt der Methode den Namen und den logischen Pfad der abhängigen Komponente (die er verwaltet) sowie den Namen und den logischen Pfad sowie die Writer- [*Klassen-ID*](vssgloss-w.md) (die GUID, die die Klasse identifiziert) der Komponente, von der er abhängt.</span><span class="sxs-lookup"><span data-stu-id="35f1a-109">The writer passes the method the name and logical path of the dependent component (which it manages), as well as the name and logical path and the [*writer class ID*](vssgloss-w.md) (the GUID identifying the class) of the component upon which it depends.</span></span>

<span data-ttu-id="35f1a-110">Nach der Einrichtung informiert diese Abhängigkeit die Anforderer darüber, dass während eines Sicherungs-oder Wiederherstellungs Vorgangs sowohl die abhängige Komponente als auch die Ziele ihrer Abhängigkeiten teilnehmen müssen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-110">Once established, this dependency informs the requester that during any backup or restore operation both the dependent component and the targets of its dependencies must participate.</span></span>

<span data-ttu-id="35f1a-111">Eine bestimmte Komponente kann mehrere Abhängigkeiten aufweisen. Dies erfordert, dass Sie und alle abhängigen Ziele an der Sicherung und Wiederherstellung beteiligt sind.</span><span class="sxs-lookup"><span data-stu-id="35f1a-111">A given component can have multiple dependencies, which requires that it and all its dependent targets participate in the backup and restore together.</span></span>

<span data-ttu-id="35f1a-112">Die abhängige Komponente und/oder die Ziel (n) ihrer Abhängigkeiten können entweder [*explizit*](vssgloss-e.md) oder [*implizit*](vssgloss-i.md) in einem Sicherungs-oder Wiederherstellungs Vorgang eingeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-112">The dependent component and/or the target(s) of its dependencies can be included either [*explicitly*](vssgloss-e.md) or [*implicitly*](vssgloss-i.md) in a backup or restore operations.</span></span>

<span data-ttu-id="35f1a-113">Der explizite Writer-Komponenten Abhängigkeits Mechanismus sollte nicht verwendet werden, um eine Abhängigkeit zwischen zwei Komponenten auf demselben Writer zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-113">The explicit writer component dependency mechanism should not be used to create a dependency between two components on the same writer.</span></span> <span data-ttu-id="35f1a-114">Die Auswahlregeln können die gleichen Funktionen effizienter und ohne das Risiko von zirkulären Abhängigkeiten bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-114">The selection rules can supply the same functionality more efficiently without risk of circular dependencies.</span></span>

<span data-ttu-id="35f1a-115">Beispielsweise könnte [**ivssupateschreitermetadata:: AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) verwendet werden, um die Abhängigkeit der Komponente "Write Data" (mit dem logischen Pfad "") des Writers "myWriter" in der Komponente "internetdata" (mit dem logischen Pfad "Connections") eines Writers namens "Internetconnector" mit der Writer-Klassen-ID X zu definieren. (obwohl es möglich ist, dass mehrere Writer mit derselben Klassen-ID gleichzeitig auf dem System ausgeführt werden, wird die Verwirrung vermieden, da die Kombination aus logischem Pfad und Komponenten Name auf dem System unter VSS eindeutig ist.)</span><span class="sxs-lookup"><span data-stu-id="35f1a-115">As an example, [**IVssCreateWriterMetadata::AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) could be used to define the dependency of the component writerData (with logical path "") of the writer MyWriter on component internetData (with a logical path of "Connections") of a writer named InternetConnector with a writer Class ID X. (While it is possible for multiple writers with the same class ID to be on the system simultaneously, confusion will be avoided because the combination of logical path and component name is unique on the system under VSS.)</span></span>

<span data-ttu-id="35f1a-116">Ein Writer fügt eine bestimmte Komponente durch Aufrufen von [**ivsscreatewritermetadata:: AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) , die mit verschiedenen Komponenten von unterschiedlichen Writern wiederholt wird, mehrere Abhängigkeiten hinzu.</span><span class="sxs-lookup"><span data-stu-id="35f1a-116">A writer adds multiple dependencies to a given component simply by calling [**IVssCreateWriterMetadata::AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) repeated with different components from different writers.</span></span> <span data-ttu-id="35f1a-117">Die Anzahl anderer Komponenten, von denen eine bestimmte Komponente abhängt, finden Sie unter Untersuchen des **cdependen-** Members der [**VSS \_ ComponentInfo**](/windows/desktop/api/VsBackup/ns-vsbackup-vss_componentinfo) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="35f1a-117">The number of other components a given component depends on can be found by examining the **cDependencies** member of the [**VSS\_COMPONENTINFO**](/windows/desktop/api/VsBackup/ns-vsbackup-vss_componentinfo) structure.</span></span>

<span data-ttu-id="35f1a-118">Ein Writer oder eine Anforderer Ruft Instanzen der [**ivsswmdepencenschnittstelle**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) mit [**ivsswmcomponent:: getabhängigkeiten**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency)ab.</span><span class="sxs-lookup"><span data-stu-id="35f1a-118">A writer or requester retrieves instances of the [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) interface with [**IVssWMComponent::GetDependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span></span> <span data-ttu-id="35f1a-119">**Ivsswmdepend** gibt den Komponentennamen, den logischen Pfad und die Klassen-ID des Writers zurück, der die Komponente verwaltet, die das Ziel der Abhängigkeit ist.</span><span class="sxs-lookup"><span data-stu-id="35f1a-119">The **IVssWMDependency** returns the component name, logical path, and class ID of the writer managing the component that is the target of the dependency.</span></span>

<span data-ttu-id="35f1a-120">Der Abhängigkeits Mechanismus schreibt keine bestimmte bevorzugte Reihenfolge zwischen der abhängigen Komponente und den Zielen ihrer Abhängigkeiten vor.</span><span class="sxs-lookup"><span data-stu-id="35f1a-120">The dependency mechanism does not prescribe any particular order of preference between the dependent component and the targets of its dependencies.</span></span> <span data-ttu-id="35f1a-121">Wie bereits erwähnt, müssen alle Abhängigkeiten darauf hindeuten, dass die Komponente oder Komponenten, von denen Sie abhängig ist, ebenfalls gesichert oder wieder hergestellt werden muss, wenn eine bestimmte Komponente gesichert oder wieder hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="35f1a-121">As noted above, all a dependency indicates is that whenever a given component is either backed up or restored, the component or components it depends on must be backed up or restored as well.</span></span> <span data-ttu-id="35f1a-122">Die genaue Implementierung der Abhängigkeit liegt im Ermessen der Sicherungs Anwendung.</span><span class="sxs-lookup"><span data-stu-id="35f1a-122">The exact implementation of dependency is at the discretion of the backup application.</span></span>

<span data-ttu-id="35f1a-123">Im obigen Fall ist beispielsweise die Komponente "Write Data" (logischer Pfad "") von der Komponente Internetconnector (logischer Pfad "Connections") abhängig.</span><span class="sxs-lookup"><span data-stu-id="35f1a-123">For example, in the case above, the component writerData (logical path "") depends on component InternetConnector (logical path "Connections").</span></span> <span data-ttu-id="35f1a-124">Ein Anforderer kann dies auf eine der folgenden Arten interpretieren:</span><span class="sxs-lookup"><span data-stu-id="35f1a-124">A requester is free to interpret this in either of the following ways:</span></span>

-   <span data-ttu-id="35f1a-125">Wenn die abhängige Komponente "Write Data" (implizit oder explizit) für die Sicherung oder Wiederherstellung ausgewählt wird, muss der Anforderer (entweder implizit oder explizit) das Ziel seiner Abhängigkeit (internetdata) auswählen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-125">If the dependent component, writerData, is selected (implicitly or explicitly) for backup or restore, the requester must select (either implicitly or explicitly) the target of its dependency, internetData</span></span>
-   <span data-ttu-id="35f1a-126">Wenn das Ziel seiner Abhängigkeit, internetdata, nicht für die Sicherung ausgewählt ist, sollte die abhängige Komponente "Write Data" nicht ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-126">If the target of its dependency, internetData, is not selected for backup, then the dependent component, writerData, should not be selected.</span></span>

<span data-ttu-id="35f1a-127">Wenn jedoch die Unterstützung für Abhängigkeiten entwickelt wird, sollten sich Entwickler von Anforderer bewusst sein, dass es keine Möglichkeit gibt, dass ein Writer feststellen kann, ob eine seiner Komponenten ein Ziel einer Abhängigkeit ist.</span><span class="sxs-lookup"><span data-stu-id="35f1a-127">However, when developing support for dependencies, requester developers should be aware that there is no way a writer can determine if one of its components is a target of a dependency.</span></span>

## <a name="declaring-remote-dependencies"></a><span data-ttu-id="35f1a-128">Deklarieren von Remote Abhängigkeiten</span><span class="sxs-lookup"><span data-stu-id="35f1a-128">Declaring Remote Dependencies</span></span>

<span data-ttu-id="35f1a-129">Eine verteilte Anwendung ist eine Anwendung, die so konfiguriert werden kann, dass ein oder mehrere Computer gleichzeitig verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-129">A distributed application is an application that can be configured to use one or more computers at a time.</span></span> <span data-ttu-id="35f1a-130">In der Regel wird die Anwendung auf einem oder mehreren Anwendungsserver Computern ausgeführt, und es wird eine Verbindung mit einem oder mehreren Datenbankserver Computern hergestellt (die aber möglicherweise tatsächlich auf diesem ausgeführt wird).</span><span class="sxs-lookup"><span data-stu-id="35f1a-130">Typically the application runs on one or more application server computers and communicates with (but may or may not actually run on) one or more database server computers.</span></span> <span data-ttu-id="35f1a-131">Diese Konfiguration wird manchmal als Bereitstellung mit mehreren Systemen bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="35f1a-131">This configuration is sometimes referred to as a multi-system deployment.</span></span> <span data-ttu-id="35f1a-132">Häufig kann dieselbe Anwendung auch für die Ausführung auf einem einzelnen Computer konfiguriert werden, auf dem ein Anwendungsserver und ein Datenbankserver ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-132">Often the same application can also be configured to run on a single computer that runs both an application server and a database server.</span></span> <span data-ttu-id="35f1a-133">Eine solche Konfiguration wird als Bereitstellung mit nur einem System bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="35f1a-133">Such a configuration is called a single-system deployment.</span></span> <span data-ttu-id="35f1a-134">In beiden Konfigurationen verfügen Anwendungsserver und Datenbankserver jeweils über eigene unabhängige VSS-Writer.</span><span class="sxs-lookup"><span data-stu-id="35f1a-134">In both configurations, the application server and database server each have their own independent VSS writers.</span></span>

<span data-ttu-id="35f1a-135">Wenn in einer Bereitstellung mit mehreren Systemen eine Komponente, die vom Writer der Anwendung verwaltet wird, von einer Remote Komponente abhängig ist, die vom Writer des Datenbankservers verwaltet wird, wird dies als Remote Abhängigkeit bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="35f1a-135">In a multi-system deployment, if a component managed by the application's writer depends on a remote component managed by the database server's writer, this is called a remote dependency.</span></span> <span data-ttu-id="35f1a-136">(Eine Bereitstellung mit einem einzelnen System hat dagegen nur lokale Abhängigkeiten.)</span><span class="sxs-lookup"><span data-stu-id="35f1a-136">(A single-system deployment, in contrast, has only local dependencies.)</span></span>

<span data-ttu-id="35f1a-137">Als Beispiel für eine Bereitstellung mit mehreren Systemen sollten Sie einen Anwendungsserver in Erwägung nehmen, der einen SQL Server Datenbankserver als Datenspeicher verwendet.</span><span class="sxs-lookup"><span data-stu-id="35f1a-137">As an example of a multi-system deployment, consider an application server that uses a SQL Server database server as a data store.</span></span> <span data-ttu-id="35f1a-138">Die anwendungsspezifischen Daten, die die Webparts, die Webinhalts Dateien und die IIS-Metabase enthalten, befinden sich auf einem oder mehreren Computern, die als Front-End-Webserver bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-138">The application-specific data, which includes the web parts, web content files, and the IIS metabase, resides on one or more computers, called front-end web servers.</span></span> <span data-ttu-id="35f1a-139">Der tatsächliche SQL-Datenspeicher, der die Konfigurations Datenbank und mehrere Inhalts Datenbanken umfasst, befindet sich auf einem oder mehreren anderen Computern, die als Back-End-Datenbankserver bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-139">The actual SQL data store, which includes the Config database and multiple Content databases, resides on one or more other computers, called back-end database servers.</span></span> <span data-ttu-id="35f1a-140">Alle Front-End-Webserver enthalten denselben anwendungsspezifischen Inhalt und dieselbe Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="35f1a-140">Each of the front-end web servers contains the same application-specific content and configuration.</span></span> <span data-ttu-id="35f1a-141">Alle Back-End-Datenbankserver können beliebige Inhalts Datenbanken oder die Konfigurations Datenbank hosten.</span><span class="sxs-lookup"><span data-stu-id="35f1a-141">Each of the back-end database servers can host any of the Content databases or the Config database.</span></span> <span data-ttu-id="35f1a-142">Die Anwendungssoftware wird nur auf den Front-End-Webservern ausgeführt, nicht auf den Datenbankservern.</span><span class="sxs-lookup"><span data-stu-id="35f1a-142">The application software runs only on the front-end web servers, not on the database servers.</span></span> <span data-ttu-id="35f1a-143">In dieser Konfiguration hat der VSS Writer der Anwendung Remote Abhängigkeiten von den Komponenten, die vom SQL Writer verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-143">In this configuration, the application's VSS writer has remote dependencies on the components managed by the SQL writer.</span></span>

<span data-ttu-id="35f1a-144">Ein Writer kann eine Remote Abhängigkeit deklarieren, indem die [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) -Methode aufgerufen wird, der " \\ \\ *Remotecomputername*" vorangestellt ist \\ , wobei " *Remotecomputername* " der Name des Computers ist, auf dem sich die Remote Komponente befindet, und der logische Pfad im *wszonlogicalpath* -Parameter.</span><span class="sxs-lookup"><span data-stu-id="35f1a-144">A writer can declare a remote dependency by calling the [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) method, prepending "\\\\*RemoteComputerName*\\", where *RemoteComputerName* is the name of the computer where the remote component resides, to the logical path in the *wszOnLogicalPath* parameter.</span></span> <span data-ttu-id="35f1a-145">Der Wert von *Remotecomputername* kann eine IP-Adresse oder ein Computername sein, der von der [**GetComputerNameEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getcomputernameexa) -Funktion zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="35f1a-145">The value of *RemoteComputerName* can be an IP address or a computer name returned by the [**GetComputerNameEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getcomputernameexa) function.</span></span>

<span data-ttu-id="35f1a-146">**Windows Server 2003:** Ein Writer kann bis Windows Server 2003 mit Service Pack 1 (SP1) keine Remote Abhängigkeiten deklarieren.</span><span class="sxs-lookup"><span data-stu-id="35f1a-146">**Windows Server 2003:** A writer cannot declare remote dependencies until Windows Server 2003 with Service Pack 1 (SP1).</span></span>

<span data-ttu-id="35f1a-147">Zum Identifizieren einer Abhängigkeit Ruft eine Anforderer die Methoden [**getschreiterid**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getwriterid), [**getlogicalpath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath)und [**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getcomponentname) der [**ivsswmdepen-Schnitt**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) Stelle auf.</span><span class="sxs-lookup"><span data-stu-id="35f1a-147">To identify a dependency, a requester calls the [**GetWriterId**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getwriterid), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath), and [**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getcomponentname) methods of the [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) interface.</span></span> <span data-ttu-id="35f1a-148">Der Anforderer muss den Komponentennamen untersuchen, den **GetComponentName** im *pbstrincomponentname* -Parameter zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="35f1a-148">The requester must examine the component name that **GetComponentName** returns in the *pbstrComponentName* parameter.</span></span> <span data-ttu-id="35f1a-149">Wenn der Komponenten Name mit " \\ \\ " beginnt, muss der Anforderer davon ausgehen, dass er eine Remote Abhängigkeit angibt und dass die erste Komponente, die auf "" folgt, \\ \\ der Remote *Computername* ist, der beim Aufrufen von [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency)angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="35f1a-149">If the component name begins with "\\\\", the requester must assume that it specifies a remote dependency and that the first component following "\\\\" is the *RemoteComputerName* that was specified when the writer called [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency).</span></span> <span data-ttu-id="35f1a-150">Wenn der Komponenten Name nicht mit "" beginnt \\ \\ , sollte der Anforderer davon ausgehen, dass er eine lokale Abhängigkeit angibt.</span><span class="sxs-lookup"><span data-stu-id="35f1a-150">If the component name does not begin with "\\\\", the requester should assume that it specifies a local dependency.</span></span>

<span data-ttu-id="35f1a-151">Wenn eine Remote Abhängigkeit vorhanden ist, muss der Anforderer die Remote Komponente sichern, wenn er die lokale Komponente sichert.</span><span class="sxs-lookup"><span data-stu-id="35f1a-151">If there is a remote dependency, the requester must back up the remote component when it backs up the local component.</span></span> <span data-ttu-id="35f1a-152">Zum Sichern der Remote Komponente sollte der Anforderer über einen Agent auf dem Remote Computer verfügen und die Sicherung auf dem Remote Computer initiieren.</span><span class="sxs-lookup"><span data-stu-id="35f1a-152">To back up the remote component, the requester should have an agent on the remote computer and should initiate the backup on the remote computer.</span></span>

## <a name="structuring-remote-dependencies"></a><span data-ttu-id="35f1a-153">Strukturieren von Remote Abhängigkeiten</span><span class="sxs-lookup"><span data-stu-id="35f1a-153">Structuring Remote Dependencies</span></span>

<span data-ttu-id="35f1a-154">Es ist wichtig zu verstehen, dass eine Abhängigkeit keine Komponente in und von sich selbst ist.</span><span class="sxs-lookup"><span data-stu-id="35f1a-154">It is important to understand that a dependency is not a component in and of itself.</span></span> <span data-ttu-id="35f1a-155">Eine Komponente ist erforderlich, um die Abhängigkeit zu speichern.</span><span class="sxs-lookup"><span data-stu-id="35f1a-155">A component is necessary to hold the dependency.</span></span>

<span data-ttu-id="35f1a-156">Die folgenden Beispiele zeigen zwei Möglichkeiten, einen Satz von Abhängigkeiten zu strukturieren.</span><span class="sxs-lookup"><span data-stu-id="35f1a-156">The following examples show two ways to structure a set of dependencies.</span></span>

``` syntax
Example 1:
    Writer 1
        Component A
            File A
            File B
            Dependency (SQL/MSDE Writer, Component X, "\")
            Dependency (SQL/MSDE Writer, Component Y, "\")

Example 2:
    Writer 2
        Component A
            File A
            File B
        Component B
            Dependency (SQL/MSDE Writer, Component X, "\")
            Dependency (SQL/MSDE Writer, Component Y, "\")
```

<span data-ttu-id="35f1a-157">In Beispiel 1 werden die Abhängigkeiten von Komponente A gespeichert. Da nur Komponenten ausgewählt werden können, nicht einzelne Dateien, müssen die Abhängigkeiten von Component A auf diese Weise so strukturiert werden, dass die gesamte Komponente, sowohl die Dateien als auch die Abhängigkeiten, immer gleich gesichert und wieder hergestellt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-157">In example 1, the dependencies are held by Component A. Because only components can be selected, not individual files, structuring Component A's dependencies this way would require that the entire component, both the files and the dependencies, must always be backed up and restored together.</span></span> <span data-ttu-id="35f1a-158">Sie können nicht einzeln gesichert oder wieder hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-158">They cannot be backed up or restored individually.</span></span>

<span data-ttu-id="35f1a-159">In Beispiel 2 enthalten separate Komponenten (Komponenten A und B) jede der Abhängigkeiten.</span><span class="sxs-lookup"><span data-stu-id="35f1a-159">In example 2, separate components (Components A and B) hold each of the dependencies.</span></span> <span data-ttu-id="35f1a-160">In diesem Fall können die beiden Komponenten unabhängig voneinander ausgewählt und daher unabhängig voneinander gesichert und wieder hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-160">In this case, the two components can be selected independently, and therefore backed up and restored independently.</span></span> <span data-ttu-id="35f1a-161">Wenn Sie die Abhängigkeiten auf diese Weise strukturieren, wird eine verteilte Anwendung viel flexibler bei der Verwaltung Ihrer Remote Abhängigkeiten.</span><span class="sxs-lookup"><span data-stu-id="35f1a-161">Structuring the dependencies this way gives a distributed application much more flexibility in managing its remote dependencies.</span></span>

## <a name="supporting-remote-dependencies"></a><span data-ttu-id="35f1a-162">Unterstützen von Remote Abhängigkeiten</span><span class="sxs-lookup"><span data-stu-id="35f1a-162">Supporting Remote Dependencies</span></span>

<span data-ttu-id="35f1a-163">Ein Anforderer kann vollständige oder partielle Unterstützung für Remote Abhängigkeiten bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-163">A requester can provide full or partial support for remote dependencies.</span></span>

<span data-ttu-id="35f1a-164">Um vollständige Unterstützung zu bieten, sollte der Anforderer zum Zeitpunkt der Sicherung und Wiederherstellung Folgendes ausführen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-164">To provide full support, the requester should do the following at backup and restore time.</span></span>

<span data-ttu-id="35f1a-165">Zum Zeitpunkt der Sicherung muss der Anforderer die Sicherung auf dem Front-End-Computer (lokal) starten, die vorhandenen Abhängigkeiten ermitteln und zusätzliche Sicherungsaufträge für die Erfassung der Back-End-Datenbanken erstellen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-165">At backup time, the requester must start the backup on the front-end (local) computer, determine the dependencies that exist, and spool additional backup jobs to capture the back-end databases.</span></span> <span data-ttu-id="35f1a-166">Der Anforderer muss warten, bis die Back-End-Sicherungsaufträge auf dem Remote Computer abgeschlossen sind, bevor die [**IVssBackupComponents:: setbackupcomplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) -und [**IVssBackupComponents:: BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) -Methode aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-166">The requester must wait until after the back-end backup jobs on the remote computer have completed before calling the [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) and [**IVssBackupComponents::BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) methods.</span></span> <span data-ttu-id="35f1a-167">Wenn die anfordernde Person wartet, bis die Sicherung der Back-End-Komponenten abgeschlossen ist, bevor **BackupComplete** aufgerufen wird, führt dies zu einer leichter BEHEB baren Sicherung für einen Writer, der zusätzliche Verbesserungen implementiert – z. b. eine topologiesperre, beispielsweise – während der Sicherung.</span><span class="sxs-lookup"><span data-stu-id="35f1a-167">If the requester waits until the backup of back-end components is complete before calling **BackupComplete**, this will produce a more easily recoverable backup for a writer that implements additional enhancements—such as topology locking, for example—during the backup.</span></span> <span data-ttu-id="35f1a-168">Im folgenden Verfahren wird erläutert, was der Anforderer tun sollte:</span><span class="sxs-lookup"><span data-stu-id="35f1a-168">The following procedure outlines what the requester should do:</span></span>

1.  <span data-ttu-id="35f1a-169">Auf dem lokalen Computer ruft der Anforderer die Methoden [**IVssBackupComponents:: initializeforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**IVssBackupComponents:: gatherschreitermetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents::P eneforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup)und [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) auf.</span><span class="sxs-lookup"><span data-stu-id="35f1a-169">On the local computer, the requester calls the [**IVssBackupComponents::InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), and [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) methods.</span></span>
2.  <span data-ttu-id="35f1a-170">Nachdem die lokale Schatten Kopie abgeschlossen ist, aber bevor die Sicherung abgeschlossen ist, Spool der Anforderer zusätzliche Sicherungsaufträge, indem er eine Anforderung an den Agent auf dem Remote Computer sendet.</span><span class="sxs-lookup"><span data-stu-id="35f1a-170">After the local shadow copy is completed, but before the backup is completed, the requester spools additional backup jobs by sending a request to its agent on the remote computer.</span></span>
3.  <span data-ttu-id="35f1a-171">Auf dem Remote Computer führt der Agent der Anforderer die gespoolte Sicherungs Sequenz durch Aufrufen von [**initializeforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**gatherwrite-Metadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), [**setbackupwar**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)und [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete)aus.</span><span class="sxs-lookup"><span data-stu-id="35f1a-171">On the remote computer, the requester's agent performs the spooled backup sequence by calling [**InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded), and [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span></span>
4.  <span data-ttu-id="35f1a-172">Wenn der Agent der Anforderer die Spoolaufträge auf dem Remote Computer abgeschlossen hat, schließt der Anforderer die Sicherungs Sequenz ab, indem er [**setbackuperfolg**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) und [**Backup Complete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete)aufruft.</span><span class="sxs-lookup"><span data-stu-id="35f1a-172">When the requester's agent has completed the spooled jobs on the remote computer, the requester completes the backup sequence by calling [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) and [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span></span>

<span data-ttu-id="35f1a-173">Zum Zeitpunkt der Wiederherstellung muss der Anforderer die Wiederherstellung mit dem Front-End-Computer (lokaler Computer) starten, die Komponenten und deren Abhängigkeiten auswählen, die wieder hergestellt werden sollen, und dann das [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) -Ereignis durch Aufrufen der **IVssBackupComponents::P reitore** -Methode senden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-173">At restore time, the requester must start the restore involving the front-end (local) computer, select the components and their dependencies to be restored, and then send the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event by calling the **IVssBackupComponents::PreRestore** method.</span></span> <span data-ttu-id="35f1a-174">Der Anforderer sollte dann die Back-End-Wiederherstellungs Aufträge auf dem Remote Computer spound die [**IVssBackupComponents::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) -Methode aufruft, wenn die Back-End-Wiederherstellungen abgeschlossen sind.</span><span class="sxs-lookup"><span data-stu-id="35f1a-174">The requester should then spool the back-end restore jobs on the remote computer and call the [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) method when the back-end restores are complete.</span></span> <span data-ttu-id="35f1a-175">Durch diese Anforderung erhält der Front-End-Writer mehr Kontrolle über die Wiederherstellungs Funktion und eine bessere Administrator Benutzer Leistung.</span><span class="sxs-lookup"><span data-stu-id="35f1a-175">This requirement gives the front-end writer more control over the restore experience and a better administrator user experience overall.</span></span> <span data-ttu-id="35f1a-176">Da die Sicherungen auf den einzelnen Systemen nicht zu demselben Zeitpunkt erfolgen, muss der Front-End-Writer einen Bereinigung der Back-End-Daten ausführen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-176">Because the backups across each of the systems do not occur at the same point in time, the front-end writer will need to perform some cleanup of the back-end data.</span></span> <span data-ttu-id="35f1a-177">In der Beispielanwendung, die im vorherigen Abschnitt "Deklarieren von Remote Abhängigkeiten" erläutert wurde, sollte der Writer eine Neuzuordnung oder Neuindizierung initiieren, nachdem eine Wiederherstellung einer der Back-End-Datenbanken abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="35f1a-177">In the example application discussed in the preceding "Declaring Remote Dependencies", the writer should initiate a site remapping or reindexing after a restore of one of the back-end databases has completed.</span></span> <span data-ttu-id="35f1a-178">Zu diesem Zweck muss der Writer Ereignisse auf dem Front-End-Server empfangen.</span><span class="sxs-lookup"><span data-stu-id="35f1a-178">To do this, the writer must receive events on the front-end server.</span></span> <span data-ttu-id="35f1a-179">Im folgenden Verfahren wird erläutert, was der Anforderer tun sollte:</span><span class="sxs-lookup"><span data-stu-id="35f1a-179">The following procedure outlines what the requester should do:</span></span>

1.  <span data-ttu-id="35f1a-180">Auf dem lokalen Computer ruft der Anforderer [**IVssBackupComponents:: initializeforrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**gatherwrite Metadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents:: setselectedforrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) (oder [**ivssbackupcomponentsex:: setselectedforrestoreex**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)) und [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore)auf.</span><span class="sxs-lookup"><span data-stu-id="35f1a-180">On the local computer, the requester calls [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) (or [**IVssBackupComponentsEx::SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)), and [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span></span>
2.  <span data-ttu-id="35f1a-181">Nachdem die [**vorab**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) Version abgeschlossen ist, aber bevor die [**postrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) -Phase beginnt, werden zusätzliche Wiederherstellungs Aufträge von der anfordernden Person Spool, indem eine Anforderung an den Agent auf dem Remote Computer gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="35f1a-181">After the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) phase is completed, but before the [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) phase begins, the requester spools additional restore jobs by sending a request to its agent on the remote computer.</span></span>
3.  <span data-ttu-id="35f1a-182">Auf dem Remote Computer führt der Agent der Anforderer die gespoolten Wiederherstellungs Aufträge durch Aufrufen von [**initializeforrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**gatherscriptermetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**setselectedforrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), [**setfilerestorestatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) (oder [**setselectedforrestoreex**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)) und [**postrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore)aus.</span><span class="sxs-lookup"><span data-stu-id="35f1a-182">On the remote computer, the requester's agent performs the spooled restore jobs by calling [**InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), [**SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) (or [**SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)), and [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span>
4.  <span data-ttu-id="35f1a-183">Wenn der Agent der Anforderer die Spoolaufträge auf dem Remote Computer abgeschlossen hat, schließt der Anforderer die Wiederherstellungs Sequenz ab, indem [**IVssBackupComponents:: setfilerestorestatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) und [**postrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore)aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="35f1a-183">When the requester's agent has completed the spooled jobs on the remote computer, the requester completes the restore sequence by calling [**IVssBackupComponents::SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) and [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span>

<span data-ttu-id="35f1a-184">Um eine partielle Unterstützung für Remote Abhängigkeiten bereitzustellen, muss die anfordernde Person Remote Abhängigkeiten befolgen und Sie als Teil der Sicherung einschließen, aber die Reihenfolge von Ereignissen auf Front-End-und Back-End-Systemen, wie in den vorherigen beiden Verfahren erläutert, wäre nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="35f1a-184">To provide partial support for remote dependencies, the requester must follow remote dependencies and include them as part of the backup, but the ordering of events on front-end and back-end systems as detailed in the previous two procedures would not be required.</span></span> <span data-ttu-id="35f1a-185">Für einen Anforderer, der nur partielle Unterstützung implementiert, sollte der Anforderer die Sicherungs-/Wiederherstellungs Dokumentation der Writer-Anwendung entnehmen, um zu verstehen, welche Szenarien unterstützt werden können.</span><span class="sxs-lookup"><span data-stu-id="35f1a-185">For a requester that implements only partial support, the requester should refer to the writer application's backup/restore documentation to understand what scenarios can be supported.</span></span>

 

 
