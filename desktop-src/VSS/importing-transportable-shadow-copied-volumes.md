---
description: Es ist manchmal wünschenswert, eine Schatten Kopie auf einem System zu erstellen, aber die Schatten Kopie auf einem zweiten System zu verwenden.
ms.assetid: 4ec63917-03c0-434e-892e-3d9d4c47740e
title: Importieren transportable schattenkopierter Volumes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3d259fbc047d088ee1f7064804a3ee98fe48da1b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104131280"
---
# <a name="importing-transportable-shadow-copied-volumes"></a><span data-ttu-id="905af-103">Importieren transportable schattenkopierter Volumes</span><span class="sxs-lookup"><span data-stu-id="905af-103">Importing Transportable Shadow Copied Volumes</span></span>

<span data-ttu-id="905af-104">Es ist manchmal wünschenswert, eine Schatten Kopie auf einem System zu erstellen, aber die Schatten Kopie auf einem zweiten System zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="905af-104">It is sometimes desirable to create a shadow copy on one system, but use the shadow copy on a second system.</span></span>

<span data-ttu-id="905af-105">Beachten Sie, dass die zu sichernden Daten normalerweise während des normalen Betriebs von einem bestimmten System (*SystemOne*) verwaltet werden und dass diese Daten physisch in einem Speicher Array oder einem Gerät gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="905af-105">Consider the case where data to be backed up is normally managed by a given system (*systemOne*) during normal operations, and that this data is physically stored on a storage array or an appliance.</span></span>

<span data-ttu-id="905af-106">Um die Unterbrechung von *SystemOne* zu minimieren (da Sicherungs Vorgänge ressourcenintensiv sein können), ist es wünschenswert, die Sicherung mithilfe von *systemtwo* auszuführen, einem Sicherungs Server, der Zugriff auf das gleiche Speicher Array wie *SystemOne* hat.</span><span class="sxs-lookup"><span data-stu-id="905af-106">To minimize any disruption to *systemOne* (because backup operations can be resource intensive), it is desirable to perform the backup using *systemTwo*, a backup server, which has access to the same storage array as *systemOne*.</span></span>

<span data-ttu-id="905af-107">Um eine korrekte Schatten Kopie zu gewährleisten – die Zusammenarbeit mit den Writern auf *SystemOne* und die Beibehaltung des Zustands für laufende Aufgaben – muss die Schatten Kopie von *SystemOne* ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="905af-107">To ensure a proper shadow copy—cooperating with the writers on *systemOne* and preserving the state appropriately for ongoing tasks—the shadow copy should be performed by *systemOne*.</span></span>

<span data-ttu-id="905af-108">Daher muss *SystemOne* eine [*austauschen-Schatten Kopie*](vssgloss-t.md)erstellen, die dann von *systemtwo* importiert wird.</span><span class="sxs-lookup"><span data-stu-id="905af-108">Therefore, *systemOne* must create a [*transportable shadow copy*](vssgloss-t.md), which *systemTwo* will then import.</span></span>

<span data-ttu-id="905af-109">**Windows Server 2003, Standard Edition, Windows Server 2003, Web Edition und Windows XP:** Transportable-schattenkopiesätze werden nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="905af-109">**Windows Server 2003, Standard Edition, Windows Server 2003, Web Edition and Windows XP:** Transportable shadow copy sets are not supported.</span></span> <span data-ttu-id="905af-110">Alle Editionen von Windows Server 2003 mit Service Pack 1 (SP1) unterstützen austauschen schattenkopiesätze.</span><span class="sxs-lookup"><span data-stu-id="905af-110">All editions of Windows Server 2003 with Service Pack 1 (SP1) support transportable shadow copy sets.</span></span>

<span data-ttu-id="905af-111">Ein typisches Beispiel für das Importieren einer austauschen-Schatten Kopie kann auf folgende Weise fortgesetzt werden:</span><span class="sxs-lookup"><span data-stu-id="905af-111">A typical example of importing a transportable shadow copy can proceed in the following way:</span></span>

1.  <span data-ttu-id="905af-112">Anfänglich wird die logische Einheit (LUN), die vom Speicher Array bereitgestellt wird, als Volume auf *SystemOne* eingebunden (z. b. F:).</span><span class="sxs-lookup"><span data-stu-id="905af-112">Initially, the logical unit (LUN) that is provided by the storage array is mounted as a volume on *systemOne* (say, F:).</span></span>
2.  <span data-ttu-id="905af-113">Ein Anforderer, der auf *SystemOne* ausgeführt wird, instanziiert eine Instanz von [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) und wird so fortgesetzt, als ob er eine Sicherung vorbereitet hätte.</span><span class="sxs-lookup"><span data-stu-id="905af-113">A requester that is running on *systemOne* instantiates an instance of [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) and proceeds as if it were preparing for a backup.</span></span> <span data-ttu-id="905af-114">(Weitere Informationen finden Sie unter Übersicht über die [Sicherungs Initialisierung](overview-of-backup-initialization.md), [Übersicht über die Sicherungs Ermittlungs Phase](overview-of-the-backup-discovery-phase.md)und [Übersicht über Aufgaben vor der Sicherung](overview-of-pre-backup-tasks.md) .)</span><span class="sxs-lookup"><span data-stu-id="905af-114">(See [Overview of Backup Initialization](overview-of-backup-initialization.md), [Overview of the Backup Discovery Phase](overview-of-the-backup-discovery-phase.md), and [Overview of Pre-Backup Tasks](overview-of-pre-backup-tasks.md) for more information.)</span></span>
3.  <span data-ttu-id="905af-115">Der Anforderer für *SystemOne* ändert den schattenkopiekontext, der in der Regel für den lokalen Sicherungs Vorgang verwendet wird (**VSS \_ ctx- \_ App- \_ Sicherung**), um anzugeben, dass eine austauschen-Schatten Kopie erstellt wird (**VSS \_ Volsnap \_ attr \_ austauschen**).</span><span class="sxs-lookup"><span data-stu-id="905af-115">The requester on *systemOne* modifies the shadow copy context that is typically used for local backup operation (**VSS\_CTX\_APP\_BACKUP**) to indicate that a transportable shadow copy will be created (**VSS\_VOLSNAP\_ATTR\_TRANSPORTABLE**).</span></span> <span data-ttu-id="905af-116">Das austauschen-Attribut kann auch anderen schattenkopiekontexten hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="905af-116">The transportable attribute can be added to other shadow copy contexts as well.</span></span>
4.  <span data-ttu-id="905af-117">Bei einem Schatten Kopier Kontext von **VSS \_ ctx \_ App \_ Backup** \| **VSS \_ Volsnap \_ attr \_ transportable** erstellt der Anforderer, der sich auf *SystemOne* befindet, eine Schatten Kopie durch Aufrufen von [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="905af-117">With a shadow copy context of **VSS\_CTX\_APP\_BACKUP** \| **VSS\_VOLSNAP\_ATTR\_TRANSPORTABLE**, the requester that is on *systemOne* creates a shadow copy by calling [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span>
5.  <span data-ttu-id="905af-118">*SystemOne* verwendet [**IVssBackupComponents:: SaveAsXml**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-saveasxml) , um den aktuellen Status des Sicherungs Komponenten Dokuments zu speichern, und [**ivssexaminewrite Metadata:: SaveAsXml**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-saveasxml) , um die Writer-Metadatendokumente jedes Writers zu speichern.</span><span class="sxs-lookup"><span data-stu-id="905af-118">*SystemOne* uses [**IVssBackupComponents::SaveAsXML**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-saveasxml) to save the current state of the Backup Components Document and [**IVssExamineWriterMetadata::SaveAsXML**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-saveasxml) to save each writer's Writer Metadata Documents.</span></span> <span data-ttu-id="905af-119">Die XML-Zeichen folgen, die diese Dokumente enthalten, werden dann für eine Anforderer verfügbar gemacht, die auf *systemtwo* ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="905af-119">The XML strings that contain these documents are then made available to a requester that is running on *systemTwo*.</span></span>

    <span data-ttu-id="905af-120">Der Anforderer überträgt das Dokument mit den Sicherungs Komponenten auf *systemtwo*.</span><span class="sxs-lookup"><span data-stu-id="905af-120">The requester transfers the Backup Components Document to *systemTwo*.</span></span>

    <span data-ttu-id="905af-121">Beachten Sie, dass die anfordernde Person in *SystemOne* die Instanz von [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) an dieser Stelle nicht freigibt, wenn der Zweck der Schatten Kopie für die Sicherung vorgesehen ist.</span><span class="sxs-lookup"><span data-stu-id="905af-121">Note that the requester on *systemOne* does not release its instance of [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) at this point if the purpose of the shadow copy is for backup.</span></span> <span data-ttu-id="905af-122">Die Schnittstelle sollte geöffnet bleiben, bis *systemtwo* die Sicherungs Vorgänge erfolgreich abgeschlossen hat.</span><span class="sxs-lookup"><span data-stu-id="905af-122">The interface should remain open until *systemTwo* successfully finishes its backup operations.</span></span> <span data-ttu-id="905af-123">Nur dann sollte der Anforderer ein Backup [**Complete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) -Ereignis ausgeben, da einige Writer Protokolle abschneiden und nach einer erfolgreichen Sicherung andere Aufgaben ausführen.</span><span class="sxs-lookup"><span data-stu-id="905af-123">Only then should the requester issue a [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) event since some writers will truncate logs and do other work after a successful backup.</span></span> <span data-ttu-id="905af-124">Wenn das Ziel der Schatten Kopie Data Mining oder anderen Zwecken ist, kann die Schnittstelle in diesem Schritt geschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="905af-124">If the goal of the shadow copy is data mining or other purposes, then the interface can be closed at this step.</span></span>

6.  <span data-ttu-id="905af-125">Der Anforderer auf *systemtwo* ruft dann [**IVssBackupComponents:: importshots**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-importsnapshots) auf, um Zugriff auf die Schatten Kopie zu erhalten, die von der anfordernden Person auf *SystemOne* erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="905af-125">The requester on *systemTwo* then calls [**IVssBackupComponents::ImportSnapshots**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-importsnapshots) to get access to the shadow copy that was created by the requester on *systemOne*.</span></span>
    > [!Note]  
    > <span data-ttu-id="905af-126">Der Anforderer ist für das Serialisieren des Import schattenkopievorgangs verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="905af-126">The requester is responsible for serializing the import shadow copy operation.</span></span> <span data-ttu-id="905af-127">Wenn der Versuch von [**IVssBackupComponents:: importshots**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-importsnapshots) fehlschlägt, bereinigt der VSS LUNs nicht auf seine eigene Weise.</span><span class="sxs-lookup"><span data-stu-id="905af-127">Also, if the call to [**IVssBackupComponents::ImportSnapshots**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-importsnapshots) fails, the VSS won't clean up LUNs on it's own.</span></span> <span data-ttu-id="905af-128">Der Anforderer muss die Bereinigung von LUNs initiieren.</span><span class="sxs-lookup"><span data-stu-id="905af-128">The requester has to initiate the cleanup of LUNs.</span></span>

     

7.  <span data-ttu-id="905af-129">Der Anforderer auf *systemtwo* führt die Sicherung des kopierten schattenkopierens genau so aus, als ob er eine Schatten Kopie sichern würde, die er selbst erstellt hat (siehe Übersicht über die [tatsächliche Sicherung von Dateien](overview-of-actual-backup-of-files.md)).</span><span class="sxs-lookup"><span data-stu-id="905af-129">The requester on *systemTwo* proceeds with the backup of the shadow copied material exactly as if it were backing up a shadow copy that it created by itself (see [Overview of Actual Backup Of Files](overview-of-actual-backup-of-files.md)).</span></span>

    <span data-ttu-id="905af-130">Der Anforderer auf *systemtwo* Ruft das [*Geräte Objekt*](vssgloss-d.md) der Schatten Kopie mithilfe von [**IVssBackupComponents:: getsnapshotproperties**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getsnapshotproperties) auf der importierten Schatten Kopie ab und fügt diese an den Anfang der ursprünglichen Dateipfade an, die aus den Metadaten abgerufen wurden, um auf die zu sichernden Dateien zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="905af-130">The requester on *systemTwo* obtains the shadow copy's [*device object*](vssgloss-d.md) using [**IVssBackupComponents::GetSnapshotProperties**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getsnapshotproperties) on the imported shadow copy and appends that to the beginning of the original file paths that were obtained from the metadata to access files to be backed up.</span></span>

8.  <span data-ttu-id="905af-131">Nachdem Sie die Schatten Kopie verwendet haben, muss der Anforderer auf *systemtwo* die Schatten Kopie löschen.</span><span class="sxs-lookup"><span data-stu-id="905af-131">After using the shadow copy, the requester on *systemTwo* must delete the shadow copy.</span></span> <span data-ttu-id="905af-132">Wie bei nicht transportierbaren Schatten Kopien *bedeutet dies,* dass der VSS-Dienst die Schatten Kopie löscht, wenn der schattenkopiekontext [**auf Schatten**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) Kopien mit automatischer Freigabe (z. b. **VSS- \_ ctx- \_ Sicherung**) hinweist.</span><span class="sxs-lookup"><span data-stu-id="905af-132">As with non-transportable shadow copies, if the shadow copy context indicates auto-release shadow copies (for example, **VSS\_CTX\_BACKUP**), then releasing the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) on *systemTwo* will cause the VSS service to delete the shadow copy.</span></span> <span data-ttu-id="905af-133">Wenn der Kontext andernfalls eine persistente Schatten Kopie (z. b. **VSS- \_ ctx- \_ App- \_ Rollback**) angibt, muss der Anforderer auf *systemtwo* explizit die Schatten Kopie löschen.</span><span class="sxs-lookup"><span data-stu-id="905af-133">Otherwise, if the context indicates a persistent shadow copy (for example, **VSS\_CTX\_APP\_ROLLBACK**), then the requester on *systemTwo* must explicitly delete the shadow copy.</span></span>

    <span data-ttu-id="905af-134">Dann signalisiert die anfordernde Person auf *systemtwo* der anfordernden *Person, dass* Sie mit der Sicherung der austauschen-Schatten Kopie fertiggestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="905af-134">Then the requester on *systemTwo* signals the requester on *systemOne* that it has finished with the backup of the transportable shadow copy.</span></span>

9.  <span data-ttu-id="905af-135">Nachdem der Anforderer für *SystemOne* eine Benachrichtigung erhalten hat, dass die anfordernde Person auf *systemtwo* die Sicherung der austauschen-Schatten Kopie abgeschlossen hat, benachrichtigt er die Writer über das System, indem er ein [**Backup Complete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) -Ereignis mit einem Befehl für **IVssBackupComponents:: BackupComplete** erzeugt.</span><span class="sxs-lookup"><span data-stu-id="905af-135">After the requester on *systemOne* has received notification that the requester on *systemTwo* has finished the backup of the transportable shadow copy, it notifies the writers on its system by generating a [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) event with a call to **IVssBackupComponents::BackupComplete**.</span></span> <span data-ttu-id="905af-136">An diesem Punkt kann der Anforderer auf *SystemOne* seine Instanz von [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents)freigeben.</span><span class="sxs-lookup"><span data-stu-id="905af-136">At this point, the requester on *systemOne* is free to release its instance of [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents).</span></span>

<span data-ttu-id="905af-137">Über **transportable Schatten Kopien in einem Cluster:** Transportable-Schatten Kopien müssen von außerhalb des Clusters importiert werden, solange das ursprüngliche Volume innerhalb des Clusters eingebunden wird.</span><span class="sxs-lookup"><span data-stu-id="905af-137">**Transportable shadow copies in a cluster:** Transportable shadow copies must be imported from outside the cluster as long as the original volume is mounted within the cluster.</span></span> <span data-ttu-id="905af-138">Informationen zum Implementieren einer schnellen Wiederherstellung in einem Cluster finden [Sie unter schnelle Wiederherstellung mithilfe von transportable-Schattenkopievolumes](fast-recovery-using-transportable-shadow-copied-volumes.md).</span><span class="sxs-lookup"><span data-stu-id="905af-138">For information about implementing a fast recovery in a cluster, see [Fast Recovery Using Transportable Shadow Copied Volumes](fast-recovery-using-transportable-shadow-copied-volumes.md).</span></span>

 

 



