---
description: Requester ist für den Lebenszyklus eines Sicherungs Komponenten Dokuments primär verantwortlich.
ms.assetid: 287b7b9a-ac04-4a74-83c1-2cdd4a571ac1
title: Lebenszyklus von Sicherungs Komponenten Dokumenten
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4bcb0263f46466d7be2bc19f3c8809167b2da08
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106373353"
---
# <a name="backup-components-document-life-cycle"></a><span data-ttu-id="3584a-103">Lebenszyklus von Sicherungs Komponenten Dokumenten</span><span class="sxs-lookup"><span data-stu-id="3584a-103">Backup Components Document Life Cycle</span></span>

<span data-ttu-id="3584a-104">Requester ist für den Lebenszyklus eines Sicherungs Komponenten Dokuments primär verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="3584a-104">Requesters have primary responsibility for the life cycle of a Backup Components Document.</span></span>

<span data-ttu-id="3584a-105">Dieses Steuerelement wird von einer Instanz des [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) -Schnittstellen Objekts, das von " [**kreatevssbackupcomponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents)" zurückgegeben wird, ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="3584a-105">This control is exercised by an instance of the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface object returned by [**CreateVssBackupComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents).</span></span>

<span data-ttu-id="3584a-106">Ein Anforderer muss ein Sicherungs Komponenten Dokument vor einer Sicherung oder Wiederherstellung initialisieren, indem [**IVssBackupComponents:: initializeforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup) oder [**IVssBackupComponents:: initializeforrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="3584a-106">A requester must initialize a Backup Components Document prior to a backup or restore by calling [**IVssBackupComponents::InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup) or [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore).</span></span> <span data-ttu-id="3584a-107">Der Anforderer kann das Dokument als leer oder eine zuvor gespeicherte Kopie des Dokuments laden.</span><span class="sxs-lookup"><span data-stu-id="3584a-107">The requester can initialize the document as empty, or it can load a previously stored copy of the document.</span></span>

<span data-ttu-id="3584a-108">Bei Sicherungs Vorgängen wird in der Regel ein Sicherungs Komponenten Dokument als leer initialisiert.</span><span class="sxs-lookup"><span data-stu-id="3584a-108">For backup operations, a Backup Components Document is typically initialized as empty.</span></span> <span data-ttu-id="3584a-109">Die Daten werden im Rahmen der Verarbeitung der Sicherung mit der Zusammenarbeit der Schreiber des Systems gefüllt.</span><span class="sxs-lookup"><span data-stu-id="3584a-109">Its data will be filled in with cooperation from the system's writers in the course of processing the backup.</span></span>

<span data-ttu-id="3584a-110">Bei Wiederherstellungs Vorgängen wird in der Regel ein Sicherungs Komponenten Dokument aus einem gespeicherten Dokument initialisiert, das während der ersten Sicherung generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="3584a-110">For restore operations, a Backup Components Document is typically initialized from a stored document generated during the initial backup.</span></span> <span data-ttu-id="3584a-111">Dies ermöglicht die Wiederherstellung (in Verbindung mit der Untersuchung gespeicherter Writer-Metadatendokumente), um zu bestimmen, welche Daten anfänglich gesichert und wie Sie wieder hergestellt werden sollten.</span><span class="sxs-lookup"><span data-stu-id="3584a-111">This allows the restore (in conjunction with examination of stored Writer Metadata Documents) to determine what data was initially backed up and how it should be restored.</span></span>

<span data-ttu-id="3584a-112">Das Sichern von über [*tragbaren Schatten Kopien*](vssgloss-t.md) ist eine Ausnahme von dieser Regel.</span><span class="sxs-lookup"><span data-stu-id="3584a-112">Backing up [*transportable shadow copies*](vssgloss-t.md) is an exception to this rule.</span></span> <span data-ttu-id="3584a-113">In diesem Fall könnte eine Schatten Kopie von einem System (wo es zusammen mit dem ersten Sicherungs Komponenten Dokument erstellt wurde) in ein anderes verschoben werden, indem die logische Einheit eines freigegebenen Speichergeräts neu zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="3584a-113">In this case, a shadow copy could have been moved from one system (where it was created along with the initial Backup Components Document) to another by means of reassigning a shared storage device's logical unit.</span></span> <span data-ttu-id="3584a-114">Um unter diesen Umständen zu sichern, lädt ein Anforderer den gespeicherten Sicherungs Status und geht von der Stelle aus, an der das ursprüngliche System verbleibt.</span><span class="sxs-lookup"><span data-stu-id="3584a-114">To back up under these circumstances, a requester loads the stored backup state and proceeds from where the initial system left off.</span></span> <span data-ttu-id="3584a-115">(Weitere Informationen finden Sie unter [Importieren von transportable-schattenkopierten Volumes](importing-transportable-shadow-copied-volumes.md).)</span><span class="sxs-lookup"><span data-stu-id="3584a-115">(For more information, see [Importing Transportable Shadow Copied Volumes](importing-transportable-shadow-copied-volumes.md).)</span></span>

<span data-ttu-id="3584a-116">Im Verlauf der Verarbeitung einer Sicherung entscheidet der Anforderer, welche Komponenten tatsächlich kopiert werden sollen, wenn die Komponenten als [*für die Sicherung wählbar*](vssgloss-s.md)gekennzeichnet sind, die [*logischen Pfade*](vssgloss-l.md)der Komponente und die eigene interne Logik.</span><span class="sxs-lookup"><span data-stu-id="3584a-116">In the course of processing a backup, the requester decides which components to actually copy on the basis of which components are marked as [*selectable for backup*](vssgloss-s.md), the component's [*logical paths*](vssgloss-l.md), and its own internal logic.</span></span>

<span data-ttu-id="3584a-117">Einige der Komponenten werden explizit in den Sicherungs Vorgang [*eingeschlossen*](vssgloss-e.md) . Informationen über die Komponente werden dem Dokument mit den Sicherungs Komponenten hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="3584a-117">Some of the components will be [*explicitly included*](vssgloss-e.md) in the backup operation; information about the component will be added to the Backup Components Document.</span></span> <span data-ttu-id="3584a-118">Andere werden implizit in die Sicherung [*eingeschlossen*](vssgloss-i.md) . Informationen zu den hinzugefügten Komponenten werden dem Dokument mit den Sicherungs Komponenten nicht hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="3584a-118">Others will be [*implicitly included*](vssgloss-i.md) in the backup; information about the added components will not be added to the Backup Components Document.</span></span>

<span data-ttu-id="3584a-119">Alle nicht auswählbaren Writer für Sicherungs Komponenten ohne auswählbaren Vorgänger in ihrem logischen Pfad, und diejenigen, die von der Anforderer ausgewählt werden, werden explizit hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="3584a-119">All of a writer's nonselectable for backup components without a selectable ancestor in their logical path, and those selectable for backup components the requester chooses, will be added explicitly.</span></span>

<span data-ttu-id="3584a-120">Sowohl nicht auswählbar als auch auswählbare Sicherungs Komponenten können implizit hinzugefügt werden, wenn Sie über einen auswählbaren Vorgänger in ihrem logischen Pfad verfügen, der explizit in der Sicherung enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="3584a-120">Both nonselectable and selectable for backup components can be added implicitly if they have a selectable ancestor in their logical path, which is explicitly included in the backup.</span></span> <span data-ttu-id="3584a-121">Diese Komponenten ([*unter Komponenten*](vssgloss-s.md)) sind Mitglieder der [*Komponenten Sätze*](vssgloss-s.md) , die durch ihren auswählbaren Vorgänger definiert werden.</span><span class="sxs-lookup"><span data-stu-id="3584a-121">These components ([*subcomponents*](vssgloss-s.md)) are members of [*component sets*](vssgloss-s.md) defined by their selectable ancestor.</span></span>

<span data-ttu-id="3584a-122">Bei der Behandlung von Wiederherstellungs Vorgängen verwendet die anfordernde Person bei der Wiederherstellung die Wahl der [*Wiederherstellung*](vssgloss-s.md) anstelle der selectlichkeit der Sicherung in Verbindung mit logischen Pfadinformationen und ihrer internen Logik, um zu entscheiden, welche Dateien wieder hergestellt werden</span><span class="sxs-lookup"><span data-stu-id="3584a-122">When handling restore operations, the requester uses [*selectability for restore*](vssgloss-s.md) instead of selectability for backup in conjunction with logical path information and its own internal logic to decide which files to restore.</span></span>

<span data-ttu-id="3584a-123">Wenn eine Komponente, die der Sicherung implizit hinzugefügt wurde, jetzt explizit der Wiederherstellung hinzugefügt werden soll, aktualisiert der Anforderer das Dokument mit den Sicherungs Komponenten mit den Informationen dieser Komponente.</span><span class="sxs-lookup"><span data-stu-id="3584a-123">If a component that had been implicitly added to the backup is now to be explicitly added to the restore, the requester will update the Backup Components Document with that component's information.</span></span>

<span data-ttu-id="3584a-124">Informationen zu den gespeicherten Komponenten sind sowohl für Anforderer als auch für Writer über Instanzen der [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) -Schnittstelle verfügbar.</span><span class="sxs-lookup"><span data-stu-id="3584a-124">Information about the stored components is available both to requesters and writers through instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

<span data-ttu-id="3584a-125">Dies erfolgt über [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) -Schnittstellen, die Writer Abfragen und (bis zum Ende von [**PostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot) -und [**postrestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore) -Ereignissen) Informationen im Sicherungs Komponenten Dokument ändern können.</span><span class="sxs-lookup"><span data-stu-id="3584a-125">It is through [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interfaces that writers can query and (until the end of [**PostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot) and [**PostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore) events) modify information in the Backup Components Document.</span></span>

<span data-ttu-id="3584a-126">Wenn der Ereignishandler [**CVssWriter:: onpreparebackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup), [**CVssWriter:: onprerestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore), [**CVssWriter:: OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot), [**CVssWriter:: OnBackupComplete**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete)oder [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore) aufgerufen wird, empfängt ein Writer eine Instanz einer [**ivssschreitercomponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="3584a-126">When the [**CVssWriter::OnPrepareBackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup), [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore), [**CVssWriter::OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot), [**CVssWriter::OnBackupComplete**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete), or [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore) event handler is called, a writer receives an instance of an [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) interface.</span></span>

<span data-ttu-id="3584a-127">Beachten Sie, dass das Sicherungs Komponenten Dokument bei der Generierung des [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) -Ereignisses schreibgeschützt ist. Daher kann [**CVssWriter:: OnBackupComplete**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete) die [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) -Schnittstelle nicht verwenden, um Sie zu ändern.</span><span class="sxs-lookup"><span data-stu-id="3584a-127">Note that upon generation of the [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) event, the Backup Components Document is made read-only, and therefore [**CVssWriter::OnBackupComplete**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupcomplete) cannot use the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface to modify it.</span></span>

<span data-ttu-id="3584a-128">Über die [**ivssschreitercomponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) -Schnittstelle kann der Writer Instanzen der [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) -Schnittstelle abrufen, die ihm den Zugriff auf alle seine Komponenten ermöglicht, die dem Dokument mit den Sicherungs Komponenten explizit hinzugefügt werden, und seinen Status ändern.</span><span class="sxs-lookup"><span data-stu-id="3584a-128">From the [**IVSSWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) interface, the writer can retrieve instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface that will allow it to access all of its components explicitly added to the Backup Components Document and to alter their state.</span></span> <span data-ttu-id="3584a-129">Weitere Informationen finden Sie unter [Übersicht über die Verarbeitung einer Sicherung unter VSS](overview-of-processing-a-backup-under-vss.md) und [im Überblick über die Verarbeitung einer Wiederherstellung unter VSS](overview-of-processing-a-restore-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="3584a-129">For more information, see [Overview of Processing a Backup Under VSS](overview-of-processing-a-backup-under-vss.md) and [Overview of Processing a Restore Under VSS](overview-of-processing-a-restore-under-vss.md).</span></span>

<span data-ttu-id="3584a-130">Sicherungs Komponenten Dokumente werden aus dem Arbeitsspeicher entfernt, wenn die [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) -Schnittstelle freigegeben wird, und müssen mithilfe von [**IVssBackupComponents:: SaveAsXml**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-saveasxml)gespeichert werden, oder alle Ihre Informationen gehen verloren.</span><span class="sxs-lookup"><span data-stu-id="3584a-130">Backup Components Documents are removed from memory when the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface is released, and must be stored using [**IVssBackupComponents::SaveAsXML**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-saveasxml), or all their information will be lost.</span></span>

<span data-ttu-id="3584a-131">Wenn außerdem ein [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) -Dokument ordnungsgemäß freigegeben wird, wird ein [**BackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown) -Ereignis generiert und [*Schatten Kopien mit automatischer Freigabe*](vssgloss-a.md) gelöscht.</span><span class="sxs-lookup"><span data-stu-id="3584a-131">In addition, when an [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) document is properly released, a [**BackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown) event is generated and [*auto-release shadow copies*](vssgloss-a.md) are deleted.</span></span>

 

 



