---
description: Nach einer Wiederherstellung überprüfen Writer den Status des Vorgangs, damit Sie die wiederhergestellten Daten verwenden und Fehler behandeln können.
ms.assetid: f9def67a-c4ea-4014-929f-51fbd10d770a
title: Übersicht über Wiederherstellungs Bereinigung und-Beendigung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 391e029cdb109589b42240b5482f6aba2ff43555
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104042092"
---
# <a name="overview-of-restore-clean-up-and-termination"></a><span data-ttu-id="9d010-103">Übersicht über Wiederherstellungs Bereinigung und-Beendigung</span><span class="sxs-lookup"><span data-stu-id="9d010-103">Overview of Restore Clean up and Termination</span></span>

<span data-ttu-id="9d010-104">Nach einer Wiederherstellung überprüfen Writer den Status des Vorgangs, damit Sie die wiederhergestellten Daten verwenden und Fehler behandeln können.</span><span class="sxs-lookup"><span data-stu-id="9d010-104">Following a restore, writers check the status of the operation so that they can make use of the restored data and deal with errors.</span></span> <span data-ttu-id="9d010-105">Der Anforderer muss auf den Abschluss dieser Aktivität warten.</span><span class="sxs-lookup"><span data-stu-id="9d010-105">The requester must wait for the completion of this activity.</span></span> <span data-ttu-id="9d010-106">Weitere Informationen finden Sie [unter Übersicht über die Verarbeitung einer Wiederherstellung unter VSS](overview-of-processing-a-restore-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="9d010-106">For more information, see [Overview of Processing a Restore Under VSS](overview-of-processing-a-restore-under-vss.md).</span></span>

<span data-ttu-id="9d010-107">In der folgenden Tabelle wird die Abfolge der Aktionen und Ereignisse aufgeführt, die nach dem Wiederherstellen eines Wiederherstellungs Vorgangs erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="9d010-107">The following table shows the sequence of actions and events that are required after a restore operation has taken place.</span></span>



| <span data-ttu-id="9d010-108">Requestaktion</span><span class="sxs-lookup"><span data-stu-id="9d010-108">Requester action</span></span>                                                                                                                                                                                                                                                                                                                                                              | <span data-ttu-id="9d010-109">Ereignis</span><span class="sxs-lookup"><span data-stu-id="9d010-109">Event</span></span>                                                           | <span data-ttu-id="9d010-110">Writer-Aktion</span><span class="sxs-lookup"><span data-stu-id="9d010-110">Writer action</span></span>                                                                                                                                                                                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9d010-111">Der Anforderer gibt das Ende der Wiederherstellung an (siehe [**IVssBackupComponents::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore)).</span><span class="sxs-lookup"><span data-stu-id="9d010-111">The requester indicates the end of the restore (see [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore)).</span></span>                                                                                                                                                                                                                                           | [<span data-ttu-id="9d010-112">*Postrestore*</span><span class="sxs-lookup"><span data-stu-id="9d010-112">*PostRestore*</span></span>](vssgloss-p.md) | <span data-ttu-id="9d010-113">Der Writer führt die Bereinigung nach der Wiederherstellung durch und behandelt Wiederherstellungs Fehler und Dateien, die an nicht standardmäßigen Speicherorten wieder hergestellt wurden (siehe [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore), [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent)).</span><span class="sxs-lookup"><span data-stu-id="9d010-113">The writer conducts post-restore cleanup, and handles restoration failures and files that have been restored to nonstandard locations (see [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore), [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent)).</span></span> |
| <span data-ttu-id="9d010-114">Der Anforderer wartet darauf, dass Writer das [**postrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) -Ereignis mit [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync)verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="9d010-114">The requester waits on writers to handle the [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) event with [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span></span> <span data-ttu-id="9d010-115">Außerdem sollte der Writer-Status überprüft werden (siehe [**IVssBackupComponents:: gatherschreiterstatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus), [**IVssBackupComponents:: getschreiterstatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus)).</span><span class="sxs-lookup"><span data-stu-id="9d010-115">It should also verify writer status (see [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus), [**IVssBackupComponents::GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus)).</span></span> | <span data-ttu-id="9d010-116">Keine</span><span class="sxs-lookup"><span data-stu-id="9d010-116">None</span></span>                                                            | <span data-ttu-id="9d010-117">Keine</span><span class="sxs-lookup"><span data-stu-id="9d010-117">None</span></span>                                                                                                                                                                                                                                               |
| <span data-ttu-id="9d010-118">Der Anforderer gibt die [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) -Schnittstelle frei.</span><span class="sxs-lookup"><span data-stu-id="9d010-118">The requester releases the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span>                                                                                                                                                                                                                                                                                    | <span data-ttu-id="9d010-119">Keine</span><span class="sxs-lookup"><span data-stu-id="9d010-119">None</span></span>                                                            | <span data-ttu-id="9d010-120">Keine</span><span class="sxs-lookup"><span data-stu-id="9d010-120">None</span></span>                                                                                                                                                                                                                                               |



 

## <a name="requester-actions-during-cleanup-and-termination"></a><span data-ttu-id="9d010-121">Requestaktionen während der Bereinigung und Beendigung</span><span class="sxs-lookup"><span data-stu-id="9d010-121">Requester Actions during Cleanup and Termination</span></span>

<span data-ttu-id="9d010-122">An diesem Punkt gibt eine anfordernde Person das Ende der Datei Wiederherstellungs Aktivitäten an, indem ein [*postrestore*](vssgloss-p.md) -Ereignis durch Aufrufen von [**IVssBackupComponents::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore)erzeugt wird.</span><span class="sxs-lookup"><span data-stu-id="9d010-122">At this point, a requester indicates the end of its file restoration activities by generating a [*PostRestore*](vssgloss-p.md) event by calling [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span>

<span data-ttu-id="9d010-123">Die Aktionen der Anforderer sind darauf beschränkt, auf die Writer zu warten, die ggf. einige abschließende Bereinigungs-und Wiederherstellungs Fehler ausführen müssen, und die [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) -Schnittstelle freigeben, nachdem alle Writer das [*postrestore*](vssgloss-p.md) -Ereignis verarbeitet haben.</span><span class="sxs-lookup"><span data-stu-id="9d010-123">The requester's actions are limited to waiting on the writers, which may need to perform some final cleanup and handle restore errors, and releasing the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface after all writers have returned from handling the [*PostRestore*](vssgloss-p.md) event.</span></span>

## <a name="writer-actions-during-cleanup-and-termination"></a><span data-ttu-id="9d010-124">Writer-Aktionen während der Bereinigung und Beendigung</span><span class="sxs-lookup"><span data-stu-id="9d010-124">Writer Actions during Cleanup and Termination</span></span>

<span data-ttu-id="9d010-125">Das [*postrestore*](vssgloss-p.md) -Ereignis wird von der virtuellen Methode [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore)behandelt.</span><span class="sxs-lookup"><span data-stu-id="9d010-125">The [*PostRestore*](vssgloss-p.md) event is handled by the virtual method [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore).</span></span> <span data-ttu-id="9d010-126">Die Standard Implementierung gibt nur **dann true** zurück, wenn keine Aktion ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9d010-126">The default implementation simply returns **true** without taking any action.</span></span> <span data-ttu-id="9d010-127">Wenn ein Writer eine bessere Kontrolle über die nach der Wiederherstellung benötigte Situation ausführen muss, kann er diese Methode überschreiben.</span><span class="sxs-lookup"><span data-stu-id="9d010-127">If a writer needs to exercise more control of the post-restore situation, it can override this method.</span></span>

<span data-ttu-id="9d010-128">Zusätzlich zu den normalen Bereinigungs Vorgängen (z. b. das Entfernen temporärer Dateien), die ein Writer in [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore)ausführen kann, kann er den Erfolg oder Misserfolg von Wiederherstellungs Vorgängen verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="9d010-128">In addition to any normal cleanup (such as removing temporary files) that a writer might perform in [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore), it can handle the success or failure of restore operations.</span></span>

<span data-ttu-id="9d010-129">Die Behandlung von Wiederherstellungs Fehlern, Dateien, die an einem alternativen Speicherort wieder hergestellt wurden, und der Bedarf an zukünftigen Wiederherstellungen liegt vollständig im Ermessen des Writers.</span><span class="sxs-lookup"><span data-stu-id="9d010-129">How it handles restore errors, files restored to an alternate location, and the need for future restores are completely at the writer's discretion.</span></span> <span data-ttu-id="9d010-130">Typische Aktionen können das Vergleichen von Dateien an Alternativen oder neuen Speicherorten mit derzeit verwendeten Dateien, das Zusammenführen von Daten aus mehreren Dateien oder das Starten neuer Sitzungen, die mit den neuen Datendateien verbunden sind, umfassen.</span><span class="sxs-lookup"><span data-stu-id="9d010-130">Typical actions might include comparing files in alternate or new locations with files currently in use, merging data from multiple files, or starting new sessions connected to the new data files.</span></span> <span data-ttu-id="9d010-131">VSS bietet die folgenden Mechanismen, um dies Komponenten Weise zu unterstützen:</span><span class="sxs-lookup"><span data-stu-id="9d010-131">VSS provides the following mechanisms for supporting this on a component-by-component basis:</span></span>

-   <span data-ttu-id="9d010-132">Erfolg oder Fehler beim Wiederherstellen von Komponenten finden Sie unter [**IVssComponent:: getfilerestorestatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus).</span><span class="sxs-lookup"><span data-stu-id="9d010-132">Success or failure in restoring any component can be found with [**IVssComponent::GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus).</span></span>
-   <span data-ttu-id="9d010-133">Die Verwendung alternativer Speicherort Zuordnungen beim Wiederherstellen von Dateien wird von [**IVssComponent:: getalternatelocationmapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping)angegeben.</span><span class="sxs-lookup"><span data-stu-id="9d010-133">The use of alternate location mappings in restoring files will be indicated by [**IVssComponent::GetAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping).</span></span>
-   <span data-ttu-id="9d010-134">Die Bestimmung, ob eine Wiederherstellung inkrementell ist und weitere Wiederherstellungen erfordert, wird durch Aufrufen von [**IVssComponent:: getadditionalrestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores)erreicht.</span><span class="sxs-lookup"><span data-stu-id="9d010-134">Determining if a restore is incremental and will require further restores is done by calling [**IVssComponent::GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores).</span></span> <span data-ttu-id="9d010-135">Writer, die eine komplette Wiederherstellung Ihrer Daten benötigen, sollten erst neu gestartet werden, wenn diese Methode false zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="9d010-135">Writers that need a complete restoration of their data should not restart until this method returns false.</span></span>
-   <span data-ttu-id="9d010-136">Writer können mithilfe von [**IVssComponent:: getnewtargetcount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) und [**IVssComponent:: getnewtarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget) ermitteln, ob der Anforderer benötigt hat, um Dateien an einem zuvor nicht angegebenen Speicherort wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="9d010-136">Writers can determine if the requester has needed to restore files to a previously unspecified location using [**IVssComponent::GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) and [**IVssComponent::GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget)</span></span>

<span data-ttu-id="9d010-137">(Weitere Informationen zum Wiederherstellen von Dateien an nicht standardmäßigen Speicherorten finden Sie unter [nicht standardmäßige Sicherungs-und Wiederherstellungs Speicherorte](non-default-backup-and-restore-locations.md).)</span><span class="sxs-lookup"><span data-stu-id="9d010-137">(For more information on restoring files to non-default locations, see [Non-Default Backup and Restore Locations](non-default-backup-and-restore-locations.md).)</span></span>

<span data-ttu-id="9d010-138">Wie bei jeder [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) -Methode gelten die von einer bestimmten Instanz zurückgegebenen Informationen auch für die Komponenten, die explizit für die Sicherung [*eingeschlossen*](vssgloss-e.md) werden, [und für alle](working-with-selectability-for-restore-and-subcomponents.md) Komponenten, die [*implizit*](vssgloss-i.md) für die Sicherungs Subkomponenten eingeschlossen sind. Dies schließt auch die unter Komponenten ein, die explizit von der anfordernden Person mithilfe von [**IVssBackupComponents:: adressstoresubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) wieder hergestellt werden können.</span><span class="sxs-lookup"><span data-stu-id="9d010-138">As with any [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) method, the information returned by a given instance applies to those components [*explicitly included*](vssgloss-e.md) for backup and any of its [*implicitly included*](vssgloss-i.md) for backup subcomponents, including those subcomponents explicitly included for restore by the requester using [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) (see [Working with Selectability For Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md) for details).</span></span>

<span data-ttu-id="9d010-139">Da die Writer auf das Dokument mit den Sicherungs Komponenten zugreifen müssen, ist es wichtig, dass der Anforderer die [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) -Schnittstelle erst freigibt, wenn die Verarbeitung der Writer abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="9d010-139">Because the writers will require access to the Backup Components Document, it is important that the requester not release the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface until writers have finished processing.</span></span>

 

 



