---
description: Der gesteuerte Ziel Mechanismus ermöglicht Writer das Neuzuordnen von Dateien zum Zeitpunkt der Wiederherstellung.
ms.assetid: c0b4ab26-2bb6-4b0f-b837-01057983b49b
title: Arbeiten mit gerichteten Zielen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8bd2e15ec873b87030a2d01be69d2c3e5f95a193
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104041744"
---
# <a name="working-with-directed-targets"></a><span data-ttu-id="a6003-103">Arbeiten mit gerichteten Zielen</span><span class="sxs-lookup"><span data-stu-id="a6003-103">Working with Directed Targets</span></span>

<span data-ttu-id="a6003-104">Der [*gesteuerte Ziel*](vssgloss-d.md) Mechanismus ermöglicht Writer das Neuzuordnen von Dateien zum Zeitpunkt der Wiederherstellung.</span><span class="sxs-lookup"><span data-stu-id="a6003-104">The [*directed target*](vssgloss-d.md) mechanism allows writers to remap files at restore time.</span></span> <span data-ttu-id="a6003-105">Dadurch können Writer folgende Aktionen ausführen:</span><span class="sxs-lookup"><span data-stu-id="a6003-105">This allows writers to do the following:</span></span>

-   <span data-ttu-id="a6003-106">Geben Sie neue Zielspeicher Orte an (analog zu [**IVssBackupComponents:: addnewtarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget)eines Anforderers).</span><span class="sxs-lookup"><span data-stu-id="a6003-106">Specify new target locations (analogous to a requester's [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget)).</span></span>
-   <span data-ttu-id="a6003-107">Freigeben von Speicherplatz, indem nur benötigte Teile einer Datei auf dem Datenträger wieder hergestellt werden, insbesondere dann, wenn eine Datei mithilfe des [*partiellen Datei*](vssgloss-p.md) Mechanismus gesichert wurde.</span><span class="sxs-lookup"><span data-stu-id="a6003-107">Reclaim disk space by restoring only needed parts of a file to disk, particularly when a file was backed up using the [*partial file*](vssgloss-p.md) mechanism.</span></span>
-   <span data-ttu-id="a6003-108">Ändern Sie das Dateiformat, um die aktuellen Anforderungen zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="a6003-108">Change the file format to meet current needs.</span></span>

<span data-ttu-id="a6003-109">Für alle Dateien, die mit einem gerichteten Ziel Vorgang verwendet werden sollen, muss ein [*Wiederherstellungs Ziel*](vssgloss-r.md) von VSS \_ RT \_ angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="a6003-109">Any file to be used with a directed target operation must have a [*restore target*](vssgloss-r.md) of VSS\_RT\_DIRECTED.</span></span>

<span data-ttu-id="a6003-110">Nachdem festgestellt wurde, dass ein Anforderer einen gerichteten Ziel Vorgang unterstützen kann, ein Writer (bei der Verarbeitung des [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) -Ereignisses) verwendet das [**IVssComponent:: adddirectedtarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget) -Element für die Instanz von [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , das der Komponente entspricht, die die Datei verwaltet (bzw. die Komponente, die den Komponenten Satz definiert, der die Datei enthält), um zu definieren, wie die Datei bei der Wiederherstellung neu zugeordnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="a6003-110">Once it has been established that a requester can support a directed target operation, a writer (while handling the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event) uses the [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget) for the instance of [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) corresponding to the component that manages the file (or the component that defines the component set that contains the file) to define how the file is to be remapped on restore.</span></span>

<span data-ttu-id="a6003-111">Bei Verwendung von [**IVssComponent:: adddirectedtarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget)geben Writer den Dateinamen und den Pfad zum Sichern der Datei an, den Dateinamen und den Pfad des Wiederherstellungs Ziels (diese Werte können mit dem ursprünglichen Dateinamen und Pfad übereinstimmen) sowie Quell-und Ziel Datei Bereiche.</span><span class="sxs-lookup"><span data-stu-id="a6003-111">In using [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget), writers specify the file name and path used to back up the file, the file name and path of its restore destination (these values can be the same as the original file name and path), and source and destination file ranges.</span></span>

<span data-ttu-id="a6003-112">Wie bei partiellen Datei Vorgängen sind Bereichs Listen Paare von Offsets in die zu sichernde Datei (in Bytes) und die Länge des wiederherzustellenden Abschnitts (in Byte), der Offset und die Länge, die durch einen Doppelpunkt getrennt werden, und jedes Paar durch ein Komma getrennt: \*offset1 \***:**_Length1_*_,_* \* Offset2 \***:**_Length2_.</span><span class="sxs-lookup"><span data-stu-id="a6003-112">As with partial file operations, range lists are pairs of offsets into the file to be backed up (in bytes) and the length of the section to be restored (in bytes), the offset and length being separated by a colon, and each pair separated by a comma: *Offset1\***:**_Length1_*_,_\* \*Offset2\***:**_Length2_.</span></span> <span data-ttu-id="a6003-113">Jeder Wert ist eine 64-Bit-Ganzzahl im Hexadezimal-oder Dezimal Format.</span><span class="sxs-lookup"><span data-stu-id="a6003-113">Each value is a 64-bit integer in either hexadecimal or decimal format.</span></span>

<span data-ttu-id="a6003-114">Wenn ein Writer den gerichteten Ziel Mechanismus verwenden muss, damit der Anforderer eine Datei an einem neuen Speicherort wiederherstellen kann, hätte er [**IVssComponent:: adddirectedtarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget) mit dem ursprünglichen Dateinamen und Pfad sowie den neuen Dateinamen und Pfad und den Quell Zielbereich mit einem Offset von 0 (null) und einer Länge angeben, die der gesamten Dateigröße entspricht.</span><span class="sxs-lookup"><span data-stu-id="a6003-114">If a writer needs to use the directed target mechanism to have the requester restore a file to a new location, it would have called [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget) with the original file name and path and the new file name and path, and specify source destination ranges with a zero offset and a length equal to that of the entire file size.</span></span>

<span data-ttu-id="a6003-115">Wenn ein Writer beispielsweise über eine 200K-Datei verfügen muss, z. b \\ . "c: Write Data \\ Index. dat", die als "C: \\ Write Data \\ OldIndex. dat" wieder hergestellt wird, lautet die Zeichenfolge für Quell-und Zielbereich "**0:204880**."</span><span class="sxs-lookup"><span data-stu-id="a6003-115">For instance, if a writer needs to have a 200K file, C:\\WriterData\\Index.dat, restored as C:\\WriterData\\OldIndex.dat, the source and destination range string would be "**0:204880**."</span></span>

<span data-ttu-id="a6003-116">Zum erneuten Zuordnen einer großen, teilweise gesicherten Datei verwendet der Anforderer den Quellbereich, der zum Sichern der Datei verwendet wird, und einen Zielbereich, der die Dateigröße reduziert.</span><span class="sxs-lookup"><span data-stu-id="a6003-116">To remap a large, partially backed-up file, the requester would use the source range used to back up the file and a destination range that will reduce the file size.</span></span> <span data-ttu-id="a6003-117">Die Informationen zum Quellbereich können mithilfe von [**IVssComponent:: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile) für die Instanz von [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) abgerufen werden. Dies entspricht der Komponente, die die Datei verwaltet (oder der Komponente, die den Komponenten Satz definiert, der die Datei enthält).</span><span class="sxs-lookup"><span data-stu-id="a6003-117">The source range information can be obtained by using [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile) for the instance of [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) corresponding to the component that manages the file (or the component that defines the component set that contains the file).</span></span>

<span data-ttu-id="a6003-118">Wenn die teilweise gesicherte Datei anfänglich eine große Datei war, deren Header Bytes 64-512, enthält eine Anzahl von Datensätzen und andere häufig aktualisierte Informationen, und die neuesten Daten befinden sich in den letzten 65536 Bytes der Datei – Bytes 0x1239e8577a bis 0x1239e7577a. ein Writer könnte eine Quell Bereichs Liste als Zeichenfolge "**64:448, 0x1239e8577a: 65536**" angeben.</span><span class="sxs-lookup"><span data-stu-id="a6003-118">If the partially backed-up file was initially a large file whose header, bytes 64-512, contains a records count and other frequently updated information, and whose most recent data is to be found in the file's last 65536 bytes—bytes 0x1239E8577A to 0x1239E7577A, a writer could specify a source range list as the string "**64:448,0x1239E8577A:65536**."</span></span>

<span data-ttu-id="a6003-119">Wenn der Writer die wiederhergestellte Datei neu zuordnen wollte, sodass Sie nur den Header und die neuesten Daten enthält, kann die Bereichs Liste die Zeichenfolge "**0:488488:65536**" lauten.</span><span class="sxs-lookup"><span data-stu-id="a6003-119">If the writer wanted to remap the restored file to contain only the header and most recent data, the range list could be the string "**0:488,488:65536**."</span></span>

<span data-ttu-id="a6003-120">Vor dem eigentlichen Ausführen eines Wiederherstellungs Vorgangs sollte ein Anforderer überprüfen, ob Dateien Unterstützung für unterstützte Ziele erfordern.</span><span class="sxs-lookup"><span data-stu-id="a6003-120">Prior to actually performing a restore operation, a requester should check to see if any files require directed target support.</span></span>

<span data-ttu-id="a6003-121">Zu diesem Zweck durchläuft der Anforderer zuerst die Writer mit gespeicherten Komponenten in seinem Sicherungs Komponenten Dokument mithilfe von [**IVssBackupComponents:: getwritercomponentscount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) und [**IVssBackupComponents:: getwritercomponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span><span class="sxs-lookup"><span data-stu-id="a6003-121">To do this, the requester first iterates over the writers with stored components in its Backup Components Document using [**IVssBackupComponents::GetWriterComponentsCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) and [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span></span>

<span data-ttu-id="a6003-122">Die [**IVssBackupComponents:: getschreitercomponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents) -Schnittstelle wird dann verwendet, um Instanzen der [**ivssschreitercomponentset**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) -Schnittstelle zurückzugeben, die die Methoden [**ivssschreitercomponentset XT:: getComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent) und [](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) [**ivssschreitercomponentset XT:: getcomponentcount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponentcount) bereitstellt</span><span class="sxs-lookup"><span data-stu-id="a6003-122">The [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents) interface is then used to return instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface, which provides [**IVssWriterComponentsExt::GetComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponent) and [**IVssWriterComponentsExt::GetComponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswritercomponents-getcomponentcount) methods that allow the requester to obtain [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instances.</span></span>

<span data-ttu-id="a6003-123">Dadurch kann ein Anforderer die gerichteten Ziel Kandidaten mithilfe von [**IVssComponent:: getdirectedtargetcount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) und [**IVssComponent:: getdirectedtarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget) für die Instanz von [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) abrufen. Dies entspricht der Komponente, die die Datei verwaltet (oder der Komponente, die den Komponenten Satz definiert, der die Datei enthält).</span><span class="sxs-lookup"><span data-stu-id="a6003-123">This allows a requester to obtain directed target candidates by using [**IVssComponent::GetDirectedTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) and [**IVssComponent::GetDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget) for the instance of [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) corresponding to the component that manages the file (or the component that defines the component set that contains the file).</span></span>

 

 
