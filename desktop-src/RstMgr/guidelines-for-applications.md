---
title: Richtlinien für Anwendungen
description: Anwendungen, die unter Windows Vista und Windows Server 2008 ausgeführt werden, sollten diese Richtlinien einhalten, um sicherzustellen, dass der Neustart-Manager Anwendungen bei Bedarf Herunterfahren und neu starten kann, um Updates zu installieren.
ms.assetid: 97b1df63-65a9-47b4-891b-e4a754882b89
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3ebace21e09956c68d34c90775c5ea646a8b2dd0
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "103729625"
---
# <a name="guidelines-for-applications"></a><span data-ttu-id="389cc-103">Richtlinien für Anwendungen</span><span class="sxs-lookup"><span data-stu-id="389cc-103">Guidelines for Applications</span></span>

<span data-ttu-id="389cc-104">Anwendungen, die unter Windows Vista und Windows Server 2008 ausgeführt werden, sollten diese Richtlinien einhalten, um sicherzustellen, dass der Neustart-Manager Anwendungen bei Bedarf Herunterfahren und neu starten kann, um Updates zu installieren.</span><span class="sxs-lookup"><span data-stu-id="389cc-104">Applications running on Windows Vista and Windows Server 2008 should adhere to these guidelines to ensure that the Restart Manager can shut down and restart applications if necessary to install updates.</span></span> <span data-ttu-id="389cc-105">Dienste können die Richtlinien verwenden, die unter [Richtlinien für Dienste](guidelines-for-services.md)beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="389cc-105">Services can use the guidelines that are described in [Guidelines for Services](guidelines-for-services.md).</span></span>

-   <span data-ttu-id="389cc-106">Der Neustart-Manager fragt GUI-Anwendungen für das Herunterfahren ab, indem er eine [**WM- \_ queryendsession**](/windows/desktop/Shutdown/wm-queryendsession) -Benachrichtigung sendet, für die der *LPARAM* -Parameter auf **EndSession \_ CloseApp** (0x1) festgelegt</span><span class="sxs-lookup"><span data-stu-id="389cc-106">The Restart Manager queries GUI applications for shutdown by sending a [**WM\_QUERYENDSESSION**](/windows/desktop/Shutdown/wm-queryendsession) notification that has the *lParam* parameter set to **ENDSESSION\_CLOSEAPP** (0x1).</span></span> <span data-ttu-id="389cc-107">Anwendungen sollten nicht heruntergefahren werden, wenn Sie eine " **WM \_ queryendsession** "-Meldung empfangen, weil eine andere Anwendung möglicherweise nicht heruntergefahren werden kann.</span><span class="sxs-lookup"><span data-stu-id="389cc-107">Applications should not shut down when they receive a **WM\_QUERYENDSESSION** message because another application may not be ready to shut down.</span></span> <span data-ttu-id="389cc-108">GUI-Anwendungen sollten auf die **WM- \_ Abfrage "queryendsession** " lauschen und den Wert " **true** " zurückgeben, wenn die Anwendung für das Herunterfahren und den Neustart vorbereitet ist.</span><span class="sxs-lookup"><span data-stu-id="389cc-108">GUI applications should listen for the **WM\_QUERYENDSESSION** message and return a value of **TRUE** if the application is prepared to shut down and restart.</span></span> <span data-ttu-id="389cc-109">Wenn keine Anwendung den Wert **false** zurückgibt, sendet der Neustart-Manager eine [**WM- \_ endsitzungs**](/windows/desktop/Shutdown/wm-endsession) Nachricht, wobei der *LPARAM* -Parameter auf **EndSession \_ CloseApp** (0x1) und der *wParam* -Parameter auf **true** festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="389cc-109">If no application returns a value of **FALSE**, the Restart Manager sends a [**WM\_ENDSESSION**](/windows/desktop/Shutdown/wm-endsession) message with the *lParam* parameter set to **ENDSESSION\_CLOSEAPP** (0x1) and the *wparam* parameter set to **TRUE**.</span></span> <span data-ttu-id="389cc-110">Anwendungen sollten nur heruntergefahren werden, wenn Sie die **WM- \_ endsitzungs** Nachricht empfangen.</span><span class="sxs-lookup"><span data-stu-id="389cc-110">Applications should shut down only when they receive the **WM\_ENDSESSION** message.</span></span> <span data-ttu-id="389cc-111">Der Neustart-Manager sendet außerdem eine [**WM- \_ Schließen**](../winmsg/wm-close.md) -Nachricht für GUI-Anwendungen, die beim Empfangen von **WM \_ EndSession** nicht heruntergefahren werden.</span><span class="sxs-lookup"><span data-stu-id="389cc-111">The Restart Manager also sends a [**WM\_CLOSE**](../winmsg/wm-close.md) message for GUI applications that do not shut down on receiving **WM\_ENDSESSION**.</span></span> <span data-ttu-id="389cc-112">Wenn eine GUI-Anwendung auf eine **WM- \_ queryendsession** -Nachricht antwortet, indem der Wert **false** zurückgegeben wird, wird das Herunterfahren abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="389cc-112">If any GUI application responds to a **WM\_QUERYENDSESSION** message by returning a value of **FALSE**, the shutdown is canceled.</span></span> <span data-ttu-id="389cc-113">Wenn das Herunterfahren jedoch erzwungen wird, wird die Anwendung unabhängig von der Anwendung beendet.</span><span class="sxs-lookup"><span data-stu-id="389cc-113">However, if the shutdown is forced, the application is terminated regardless.</span></span>
-   <span data-ttu-id="389cc-114">Wenn eine GUI-Anwendung eine [**WM- \_ endsitzungs**](/windows/desktop/Shutdown/wm-endsession) Nachricht empfängt, sollte sich die Anwendung auf das Herunterfahren innerhalb des angegebenen Timeout Zeitraums vorbereiten.</span><span class="sxs-lookup"><span data-stu-id="389cc-114">When a GUI application receives a [**WM\_ENDSESSION**](/windows/desktop/Shutdown/wm-endsession) message, the application should prepare itself to shut down within the specified timeout period.</span></span> <span data-ttu-id="389cc-115">Anwendungen sollten zumindest vorbereitet werden, indem alle Benutzerdaten und Zustandsinformationen, die nach einem Neustart benötigt werden, gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="389cc-115">At a minimum, applications should prepare by saving any user data and state information that is needed after a restart.</span></span> <span data-ttu-id="389cc-116">Es wird empfohlen, dass Anwendungen die Benutzerdaten und den Status regelmäßig speichern.</span><span class="sxs-lookup"><span data-stu-id="389cc-116">It is recommended that applications periodically save the user data and state.</span></span>
-   <span data-ttu-id="389cc-117">Der Neustart-Manager sendet eine **STRG \_ C- \_ Ereignis** Benachrichtigung an Konsolen Anwendungen, die heruntergefahren und neu gestartet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="389cc-117">The Restart Manager sends a **CTRL\_C\_EVENT** notification to console applications that must be shut down and restarted.</span></span> <span data-ttu-id="389cc-118">Wenn eine Konsolenanwendung eine **STRG \_ C- \_ Ereignis** Benachrichtigung empfängt, sollte die Anwendung die erforderlichen Maßnahmen ergreifen, um das Herunterfahren innerhalb des angegebenen Zeitlimits vorzubereiten.</span><span class="sxs-lookup"><span data-stu-id="389cc-118">When a console application receives a **CTRL\_C\_EVENT** notification, the application should take actions necessary to prepare for a shutdown within the specified timeout period.</span></span> <span data-ttu-id="389cc-119">Konsolen Anwendungen sollten mindestens eine [*Handlerroutine*](/windows/console/handlerroutine) -Funktion zum Verarbeiten der **STRG \_ C- \_ Ereignis** Benachrichtigung definieren und alle Benutzerdaten und Zustandsinformationen, die nach einem Neustart benötigt werden, speichern.</span><span class="sxs-lookup"><span data-stu-id="389cc-119">At a minimum, console applications should define a [*HandlerRoutine*](/windows/console/handlerroutine) function to handle the **CTRL\_C\_EVENT** notification and should save any user data and state information that is going to be needed after a restart.</span></span> <span data-ttu-id="389cc-120">Es wird empfohlen, dass Anwendungen die Benutzerdaten und den Status regelmäßig speichern.</span><span class="sxs-lookup"><span data-stu-id="389cc-120">It is recommended that applications periodically save the user data and state.</span></span>
-   <span data-ttu-id="389cc-121">Wenn Anwendungen nicht als Reaktion auf Herunterfahren heruntergefahren werden, können Installer die **rmforceshutdown** -Option der [**rmshutdown**](/windows/desktop/api/RestartManager/nf-restartmanager-rmshutdown) -Funktion verwenden, um zu erzwingen, dass die Anwendungen heruntergefahren werden.</span><span class="sxs-lookup"><span data-stu-id="389cc-121">If any applications do not shut down in response to the shutdown messages, installers can use the **RmForceShutdown** option of the [**RmShutdown**](/windows/desktop/api/RestartManager/nf-restartmanager-rmshutdown) function to force the applications to shut down.</span></span> <span data-ttu-id="389cc-122">Wenn das Installationsprogramm das erzwungene Herunterfahren angibt, versucht der Neustart-Manager, die Anwendungen ordnungsgemäß herunterzufahren, indem die Nachrichten nach dem Herunterfahren gesendet werden</span><span class="sxs-lookup"><span data-stu-id="389cc-122">When the installer specifies a forced shutdown, Restart Manager attempts to shut down the applications cleanly by sending the shutdown messages, but will force them shut if this fails.</span></span> <span data-ttu-id="389cc-123">GUI-Anwendungen und Konsolen Anwendungen können erzwungen werden, um die Installation eines wichtigen Sicherheitsupdates zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="389cc-123">GUI applications and console applications can be forced to shut down to enable the installation of a critical security update.</span></span> <span data-ttu-id="389cc-124">Da dies zu Datenverlusten führen kann, sollten Anwendungen die Shutdown-Nachrichten verarbeiten und bei Bedarf ordnungsgemäß herunterfahren.</span><span class="sxs-lookup"><span data-stu-id="389cc-124">Because this can result in data loss, applications should handle the shutdown messages and shut down cleanly when required.</span></span>
-   <span data-ttu-id="389cc-125">Anwendungen sollten sich für einen Neustart mithilfe der [**RegisterApplicationRestart**](/windows/desktop/api/winbase/nf-winbase-registerapplicationrestart) -Funktion registrieren.</span><span class="sxs-lookup"><span data-stu-id="389cc-125">Applications should register for a restart by using the [**RegisterApplicationRestart**](/windows/desktop/api/winbase/nf-winbase-registerapplicationrestart) function.</span></span> <span data-ttu-id="389cc-126">Der Neustart-Manager kann nur Anwendungen neu starten, die für den Neustart registriert wurden.</span><span class="sxs-lookup"><span data-stu-id="389cc-126">Restart Manager can only restart applications that have been registered for restart.</span></span> <span data-ttu-id="389cc-127">Dies ist die einzige Möglichkeit, dass der Neustart-Manager den Befehlszeilen Befehl ermitteln kann, der beim Neustart der Anwendung verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="389cc-127">This is the only way that the Restart Manager can determine the command-line command to use when restarting the application.</span></span> <span data-ttu-id="389cc-128">Wenn die Anwendung mit einem gespeicherten Zustand oder mit gespeicherten Daten erneut geöffnet werden muss, müssen diese Informationen in den Befehlszeilen Befehl eingeschlossen werden, der für die Anwendung registriert ist.</span><span class="sxs-lookup"><span data-stu-id="389cc-128">If the application must reopen with some saved state or data, that information must be included in the command-line command that is registered for the application.</span></span>
    > [!Note]  
    > <span data-ttu-id="389cc-129">Wenn die neu gestartete Anwendung im selben Verzeichnis ausgeführt werden muss, in dem Sie ausgeführt wurde, bevor Sie heruntergefahren wird, muss die Anwendung die Verzeichnisinformationen speichern und dann nach dem Neustart in das Verzeichnis wechseln.</span><span class="sxs-lookup"><span data-stu-id="389cc-129">If the restarted application must run in the same directory it ran in before being shut down, the application must save the directory information and then change to the directory after restarting.</span></span>

     

    > [!Note]  
    > <span data-ttu-id="389cc-130">Anwendungen, die nicht als aktuell angemeldeter Benutzer ausgeführt werden, werden von der Funktion [**rmrestart**](/windows/desktop/api/RestartManager/nf-restartmanager-rmrestart) nicht neu gestartet.</span><span class="sxs-lookup"><span data-stu-id="389cc-130">The [**RmRestart**](/windows/desktop/api/RestartManager/nf-restartmanager-rmrestart) function does not restart applications that do not run as the currently-logged on user.</span></span> <span data-ttu-id="389cc-131">Beispielsweise werden mit der **rmrestart** -Funktion keine Anwendungen neu gestartet, die mit dem Befehl **Ausführen als** gestartet wurden, der nicht als aktuell angemeldeter Benutzer ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="389cc-131">For example, the **RmRestart** function does not restart applications started with the **Run As** command that do not run as the currently-logged on user.</span></span> <span data-ttu-id="389cc-132">Diese Anwendungen müssen manuell neu gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="389cc-132">These applications must be manually restarted.</span></span>

     

-   <span data-ttu-id="389cc-133">Wenn der Neustart-Manager feststellt, dass ein Systemneustart erforderlich ist, um ein Update zu installieren, werden keine Anwendungen und Dienste heruntergefahren.</span><span class="sxs-lookup"><span data-stu-id="389cc-133">When Restart Manager determines that a system restart is required to install an update, it does not shut down any applications and services.</span></span> <span data-ttu-id="389cc-134">Stattdessen wird es dem Installer überlassen, zu entscheiden, wann ein Systemneustart geplant und das Update installiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="389cc-134">Instead, it leaves this to the installer to decide when to schedule a system restart and install the update.</span></span> <span data-ttu-id="389cc-135">Installationsprogramme können die Unterbrechungen für Benutzer verringern, die durch Updates verursacht werden, die einen Systemneustart erfordern, indem Sie die [**ExitWindowsEx**](/windows/desktop/api/winuser/nf-winuser-exitwindowsex) -Funktion mit dem **EWX \_ restartapps** -Flag oder die [**InitiateShutdown**](/windows/desktop/api/winreg/nf-winreg-initiateshutdowna) -Funktion mit dem Flag zum Herunterfahren von **\_ restartapps** verwenden.</span><span class="sxs-lookup"><span data-stu-id="389cc-135">Installers can reduce the disruption to users caused by updates that require a system restart by using the [**ExitWindowsEx**](/windows/desktop/api/winuser/nf-winuser-exitwindowsex) function with the **EWX\_RESTARTAPPS** flag or the [**InitiateShutdown**](/windows/desktop/api/winreg/nf-winreg-initiateshutdowna) function with the **SHUTDOWN\_RESTARTAPPS** flag.</span></span> <span data-ttu-id="389cc-136">Durch die Verwendung dieser Flags wird sichergestellt, dass für den Neustart registrierte Anwendungen nach einem Systemneustart neu gestartet werden, wodurch die Auswirkungen auf den Benutzer minimiert werden.</span><span class="sxs-lookup"><span data-stu-id="389cc-136">Using these flags ensures that applications registered for restart are restarted after a system reboot, which minimizes the impact on the user.</span></span>

 

 