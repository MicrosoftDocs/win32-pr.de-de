---
title: Proxy Server und WinRM
description: Windows-Remoteverwaltung (WinRM) verwendet HTTP und HTTPS zum Senden von Nachrichten zwischen dem Client-und dem Server Computer. Im allgemeinen sendet der WinRM-Client Nachrichten direkt an den WinRM-Server. WinRM-Clients können auch so konfiguriert werden, dass Sie einen Proxy Server verwenden.
ms.assetid: f8137b3a-7704-4b21-a923-6e2692e18d90
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e07bbfebb4c8f0eb9e77a8942d54677b55c60006
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "103727400"
---
# <a name="proxy-servers-and-winrm"></a><span data-ttu-id="d0257-105">Proxy Server und WinRM</span><span class="sxs-lookup"><span data-stu-id="d0257-105">Proxy Servers and WinRM</span></span>

<span data-ttu-id="d0257-106">Windows-Remoteverwaltung (WinRM) verwendet HTTP und HTTPS zum Senden von Nachrichten zwischen dem Client-und dem Server Computer.</span><span class="sxs-lookup"><span data-stu-id="d0257-106">Windows Remote Management (WinRM) uses HTTP and HTTPS to send messages between the client and server computers.</span></span> <span data-ttu-id="d0257-107">Im allgemeinen sendet der WinRM-Client Nachrichten direkt an den WinRM-Server.</span><span class="sxs-lookup"><span data-stu-id="d0257-107">In general, the WinRM client sends messages directly to the WinRM server.</span></span> <span data-ttu-id="d0257-108">WinRM-Clients können auch so konfiguriert werden, dass Sie einen Proxy Server verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0257-108">WinRM clients can be also configured to use a proxy server.</span></span>

<span data-ttu-id="d0257-109">Weitere Informationen finden Sie in den folgenden Abschnitten:</span><span class="sxs-lookup"><span data-stu-id="d0257-109">For more information, see the following sections:</span></span>

-   [<span data-ttu-id="d0257-110">Konfigurieren eines Proxy Servers für WinRM 2,0</span><span class="sxs-lookup"><span data-stu-id="d0257-110">Configuring a Proxy Server for WinRM 2.0</span></span>](#configuring-a-proxy-server-for-winrm-20)
    -   [<span data-ttu-id="d0257-111">HTTPS-basierte Proxy Verbindungen</span><span class="sxs-lookup"><span data-stu-id="d0257-111">HTTPS-Based Proxy Connections</span></span>](#https-based-proxy-connections)
    -   [<span data-ttu-id="d0257-112">HTTP-basierte Proxy Verbindungen</span><span class="sxs-lookup"><span data-stu-id="d0257-112">HTTP-Based Proxy Connections</span></span>](#http-based-proxy-connections)
-   [<span data-ttu-id="d0257-113">Konfigurieren eines Proxy Servers für WinRM 1,1 und früher</span><span class="sxs-lookup"><span data-stu-id="d0257-113">Configuring a Proxy Server for WinRM 1.1 and Earlier</span></span>](#configuring-a-proxy-server-for-winrm-11-and-earlier)

## <a name="configuring-a-proxy-server-for-winrm-20"></a><span data-ttu-id="d0257-114">Konfigurieren eines Proxy Servers für WinRM 2,0</span><span class="sxs-lookup"><span data-stu-id="d0257-114">Configuring a Proxy Server for WinRM 2.0</span></span>

<span data-ttu-id="d0257-115">WinRM 2,0 unterstützt eine breite Palette von Proxy Konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="d0257-115">WinRM 2.0 supports a wide range of proxy configurations.</span></span> <span data-ttu-id="d0257-116">WinRM unterstützt z. b. Proxys für http-und HTTPS-Transporte sowie für authentifizierte und nicht authentifizierte Proxy Server.</span><span class="sxs-lookup"><span data-stu-id="d0257-116">For example, WinRM supports proxies for HTTP and HTTPS transports and for authenticated and unauthenticated proxy servers.</span></span>

### <a name="https-based-proxy-connections"></a><span data-ttu-id="d0257-117">HTTPS-Based von Proxy Verbindungen</span><span class="sxs-lookup"><span data-stu-id="d0257-117">HTTPS-Based Proxy Connections</span></span>

<span data-ttu-id="d0257-118">Um eine bessere Sicherheit und Verbindungs basierte Affinität zu erzielen, sollte HTTPS als Transportmechanismus verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d0257-118">For better security and connection-based affinity, HTTPS should be used as the transport mechanism.</span></span>

<span data-ttu-id="d0257-119">Wenn für den Proxy Server eine Authentifizierung erforderlich ist, müssen die WinRM-Clients und-Server HTTPS verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0257-119">If the proxy server requires authentication, the WinRM clients and servers must use HTTPS.</span></span>

> [!Note]  
> <span data-ttu-id="d0257-120">Die Authentifizierung beim Proxy Server ist unabhängig von der Authentifizierung beim Zielserver.</span><span class="sxs-lookup"><span data-stu-id="d0257-120">Authentication to the proxy server is independent from the authentication to the destination server.</span></span>

 

### <a name="http-based-proxy-connections"></a><span data-ttu-id="d0257-121">HTTP-Based von Proxy Verbindungen</span><span class="sxs-lookup"><span data-stu-id="d0257-121">HTTP-Based Proxy Connections</span></span>

<span data-ttu-id="d0257-122">Wenn keine Proxy Server Authentifizierung erforderlich ist, kann entweder http oder HTTPS für den Transport verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d0257-122">If no proxy server authentication is required, either HTTP or HTTPs can be used for transport.</span></span> <span data-ttu-id="d0257-123">HTTP-basierte Verbindungen von einem WinRM-Client zu einem WinRM-Server über einen Proxy Server können jedoch problematisch sein.</span><span class="sxs-lookup"><span data-stu-id="d0257-123">However, HTTP-based connections from a WinRM client to a WinRM server through a proxy server can be problematic.</span></span>

<span data-ttu-id="d0257-124">Bei der Verwendung von http-basierten Verbindungen können folgende Probleme auftreten:</span><span class="sxs-lookup"><span data-stu-id="d0257-124">The following issues might be encountered when using HTTP-based connections:</span></span>

-   <span data-ttu-id="d0257-125">Der Proxy Server unterstützt keine Verbindungs basierte Authentifizierung, was dazu führen kann, dass die Authentifizierung auf dem Zielserver mit einem Fehler vom Typ "Zugriff verweigert" fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="d0257-125">The proxy server does not support connection-based authentication, which can cause the authentication against the destination server to fail with an access denied error.</span></span>
-   <span data-ttu-id="d0257-126">Zum Herstellen einer Verbindung mit dem Zielserver und dem Proxy Server sind mehrere Anmelde Informationen erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d0257-126">More than one set of credentials is needed to connect to the destination server and to the proxy server.</span></span>
-   <span data-ttu-id="d0257-127">HTTP-basierte Proxy Server unterstützen möglicherweise nicht die Fähigkeit, die zugeordneten Client basierten und serverbasierten Verbindungen aufrechtzuerhalten.</span><span class="sxs-lookup"><span data-stu-id="d0257-127">HTTP-based proxy servers might not support the ability to maintain the associated client-based and server-based connections.</span></span> <span data-ttu-id="d0257-128">Wenn der Proxy einen Client nicht stark mit einem Server verbindet und die TCP/IP-Verbindung aufrecht erhält, erhalten nicht authentifizierte Clients möglicherweise Zugriff auf Daten.</span><span class="sxs-lookup"><span data-stu-id="d0257-128">If the proxy does not strongly link a client to a server and maintain the TCP/IP connection, unauthenticated clients might gain access to data.</span></span> <span data-ttu-id="d0257-129">Die fehlende Verbindungs Affinität kann auch dazu führen, dass die Authentifizierung auf dem Server fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="d0257-129">Also, the lack of connection affinity might cause the authentication to fail against the server.</span></span>

<span data-ttu-id="d0257-130">Wenn http als Transport verwendet werden muss, sollte der Proxy Server die folgende Konfiguration unterstützen, um eine bessere WinRM-Antwort zu erzielen und Zugriffs Verweigerungs Fehler für WinRM-Clients zu verhindern:</span><span class="sxs-lookup"><span data-stu-id="d0257-130">If HTTP must be used as the transport, the proxy server should support the following configuration to achieve a better WinRM response and to prevent access denied failures for WinRM clients:</span></span>

-   <span data-ttu-id="d0257-131">Unterstützung für HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="d0257-131">Support for HTTP/1.1.</span></span> <span data-ttu-id="d0257-132">HTTP/1.1 ist bei der Zuordnung der Verbindungs Affinität zwischen Client und Server strenger.</span><span class="sxs-lookup"><span data-stu-id="d0257-132">HTTP/1.1 is more stringent in mapping connection affinity between client and server.</span></span>
-   <span data-ttu-id="d0257-133">Verbindungs basierte Authentifizierung für die Authentifizierung von Aushandlungs-, Kerberos-und kredssp-Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="d0257-133">Connection-based authentication for Negotiate, Kerberos, and CredSSP authentication.</span></span>

    <span data-ttu-id="d0257-134">Die Authentifizierung einer Anforderung erfordert mehrere Roundtrips zwischen Client und Server.</span><span class="sxs-lookup"><span data-stu-id="d0257-134">Authentication of a request requires multiple round-trips between the client and server.</span></span> <span data-ttu-id="d0257-135">Die meisten Aushandlung der Authentifizierung ist fertiggestellt, nachdem der authentifizier Ende Server (WinRM) eine Antwort an den Client gesendet hat, die keine 401-Antwort (nicht autorisiert) ist.</span><span class="sxs-lookup"><span data-stu-id="d0257-135">Most negotiation for authentication is complete after the authenticating (WinRM) server sends a response to the client that is not a 401 response (Unauthorized).</span></span> <span data-ttu-id="d0257-136">Wenn der WinRM-Server eine Antwort an den Client zurückgibt, bei der es sich nicht um eine 401-Antwort handelt, sollte der Proxy die Verbindung nicht schließen.</span><span class="sxs-lookup"><span data-stu-id="d0257-136">If the WinRM server returns a response to the client that is not a 401 response, the proxy should not close the connection.</span></span>

    <span data-ttu-id="d0257-137">Es können mehrere Anforderungs-/Antwort-Paare zwischen Client und Server gesendet werden, bevor die eigentlichen Paketdaten gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="d0257-137">Multiple request/response pairs can be sent between client and server before the actual packet data is sent.</span></span> <span data-ttu-id="d0257-138">WinRM 2,0 verwendet die Aushandlungs-und Kerberos-Authentifizierungs Schemas mit Verschlüsselung, wodurch zusätzliche Roundtrips hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="d0257-138">WinRM 2.0 uses the Negotiate and Kerberos authentication schemes with encryption, which can add extra round-trips.</span></span> <span data-ttu-id="d0257-139">Daten können erst an den Server gesendet werden, wenn die Authentifizierung beendet ist.</span><span class="sxs-lookup"><span data-stu-id="d0257-139">Data cannot be sent to the server until the authentication is complete.</span></span>

    <span data-ttu-id="d0257-140">Der WinRM-Server gibt eine Antwort auf 200-Ebene zurück, die angibt, dass die Authentifizierung fertiggestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="d0257-140">The WinRM server returns a 200-level response that indicates that the authentication is complete.</span></span> <span data-ttu-id="d0257-141">HTTP-basierte Proxy Server beenden möglicherweise die Verbindungs basierte Authentifizierungs Affinität und schließen die TCP/IP-Verbindung nach dem Empfang der Antwort auf 200-Ebene vom WinRM-Server.</span><span class="sxs-lookup"><span data-stu-id="d0257-141">HTTP-based proxy servers might end the connection-based authentication affinity and close the TCP/IP connection after receiving the 200-level response from the WinRM server.</span></span> <span data-ttu-id="d0257-142">Der abschließende Roundtrip vom Client zum Server enthält nicht das ursprüngliche Anforderungspaket.</span><span class="sxs-lookup"><span data-stu-id="d0257-142">The final round-trip from client to server does not include the original request packet.</span></span> <span data-ttu-id="d0257-143">Wenn die Verbindung vom Proxy Server geschlossen wird, versucht der Server, den Client erneut zu authentifizieren, und die Client Anforderung wird möglicherweise nie an den Server gesendet.</span><span class="sxs-lookup"><span data-stu-id="d0257-143">If the proxy server closes the connection, the server will attempt to re-authenticate the client and the client request might never be sent to the server.</span></span> <span data-ttu-id="d0257-144">Wenn die Verbindungs basierte Affinität nicht beibehalten wird, kann die Authentifizierung beim Zielserver mit einem Fehler vom Typ "Zugriff verweigert" fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="d0257-144">If the connection-based affinity is not maintained, authentication against the destination server can fail with an access denied error.</span></span>

-   <span data-ttu-id="d0257-145">Verbindungs Persistenz.</span><span class="sxs-lookup"><span data-stu-id="d0257-145">Connection persistence.</span></span> <span data-ttu-id="d0257-146">Die TCP/IP-Client Verbindung mit dem Proxy sollte weiterhin derselben TCP/IP-Verbindung vom Proxy zum Server zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="d0257-146">The client TCP/IP connection to the proxy should continue to map to the same TCP/IP connection from the proxy to the server.</span></span> <span data-ttu-id="d0257-147">Die Beibehaltung dieser Verbindung sorgt für eine höhere Leistung.</span><span class="sxs-lookup"><span data-stu-id="d0257-147">Maintaining this connection helps to achieve a higher level of performance.</span></span> <span data-ttu-id="d0257-148">Wenn die Verbindung nicht beibehalten wird, muss jede Anforderung erneut authentifiziert werden, was sich auf die Leistung auswirken kann.</span><span class="sxs-lookup"><span data-stu-id="d0257-148">If the connection is not maintained, every request must be re-authenticated, which might affect performance.</span></span>

### <a name="encryption-and-winrm-20"></a><span data-ttu-id="d0257-149">Verschlüsselung und WinRM 2,0</span><span class="sxs-lookup"><span data-stu-id="d0257-149">Encryption and WinRM 2.0</span></span>

<span data-ttu-id="d0257-150">WinRM 2,0 unterstützt die Verschlüsselung über HTTP mithilfe der Authentifizierungs Schemas aushandeln, Kerberos und kredssp.</span><span class="sxs-lookup"><span data-stu-id="d0257-150">WinRM 2.0 supports encryption over HTTP by using the Negotiate, Kerberos, and CredSSP authentication schemes.</span></span> <span data-ttu-id="d0257-151">Wenn ein WinRM-Server HTTP unterstützt und über einen Proxy darauf zugegriffen wird, muss der WinRM-Server die Verschlüsselung erzwingen und unverschlüsselten Netzwerk Datenverkehr nicht zulassen.</span><span class="sxs-lookup"><span data-stu-id="d0257-151">If a WinRM server supports HTTP and is accessed through a proxy, the WinRM server must enforce encryption and not allow unencrypted network traffic.</span></span>

<span data-ttu-id="d0257-152">Unter keinen Umständen sollten unverschlüsselte HTTP-Anforderungen über Proxy Server gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="d0257-152">Under no circumstances should unencrypted HTTP requests be sent through proxy servers.</span></span> <span data-ttu-id="d0257-153">Wenn Daten über einen Proxy Server übergeben werden müssen, bevor Sie an den Zielserver gesendet werden, sind die folgenden Sicherheitsprobleme sehr wichtig:</span><span class="sxs-lookup"><span data-stu-id="d0257-153">When data must pass through a proxy server before being sent to the destination server, the following security issues are very important:</span></span>

-   <span data-ttu-id="d0257-154">Es ist möglich, dass ein böswilliger Proxy Server jedes Anforderungs-/Antwort-Paar einschließlich Anmelde Informationen untersucht.</span><span class="sxs-lookup"><span data-stu-id="d0257-154">It is possible that a malicious proxy server could examine every request/response pair, including credentials.</span></span>
-   <span data-ttu-id="d0257-155">Wenn die TCP/IP-Verbindungen zwischen dem WinRM-Client und dem Proxy Server sowie zwischen dem Proxy Server und dem Zielserver nicht stark zugeordnet sind, könnte ein nicht autorisierter Client eine Verbindung mit dem Zielserver herstellen, indem er die gleiche authentifizierte Verbindung vom Proxy Server zum Zielserver verwendet.</span><span class="sxs-lookup"><span data-stu-id="d0257-155">If the TCP/IP connections are not strongly mapped between both the WinRM client and the proxy server and between the proxy server and the destination server, an unauthorized client could connect to the destination server by using the same authenticated connection from the proxy server to the destination server.</span></span> <span data-ttu-id="d0257-156">Der Zielserver gestattet dem nicht authentifizierten Client möglicherweise den Zugriff auf Daten.</span><span class="sxs-lookup"><span data-stu-id="d0257-156">The destination server might allow the unauthenticated client access to data.</span></span> <span data-ttu-id="d0257-157">Wenn die Verschlüsselung erzwungen wird, sendet der Zielserver eine Meldung vom Typ "Zugriff verweigert" an den nicht authentifizierten Client.</span><span class="sxs-lookup"><span data-stu-id="d0257-157">If encryption is enforced, the destination server sends an access denied message to the unauthenticated client.</span></span>

<span data-ttu-id="d0257-158">Die Verwendung der Verschlüsselung würde diese potenziellen Sicherheitsprobleme mindern.</span><span class="sxs-lookup"><span data-stu-id="d0257-158">Using encryption would mitigate these potential security issues.</span></span>

## <a name="configuring-a-proxy-server-for-winrm-11-and-earlier"></a><span data-ttu-id="d0257-159">Konfigurieren eines Proxy Servers für WinRM 1,1 und früher</span><span class="sxs-lookup"><span data-stu-id="d0257-159">Configuring a Proxy Server for WinRM 1.1 and Earlier</span></span>

<span data-ttu-id="d0257-160">Wenn ein Proxy erforderlich ist, um den WinRM-Server zu erreichen, benötigt der WinRM-Client die Windows HTTP-Dienste (WinHTTP)-Proxykonfiguration.</span><span class="sxs-lookup"><span data-stu-id="d0257-160">If a proxy is required to reach the WinRM server, the WinRM client relies on the Windows HTTP services (WinHTTP) proxy configuration.</span></span> <span data-ttu-id="d0257-161">WinHTTP ist standardmäßig nicht für die Verwendung eines Proxy Servers konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="d0257-161">By default, WinHTTP is not configured to use a proxy server.</span></span> <span data-ttu-id="d0257-162">Die WinHTTP-Proxykonfiguration kann mit den Befehlszeilen Programmen [ProxyCfg.exe](/previous-versions/windows/desktop/ms761351(v=vs.85)) oder [netsh](/previous-versions/windows/it-pro/windows-server-2003/cc785383(v=ws.10)) geändert werden.</span><span class="sxs-lookup"><span data-stu-id="d0257-162">WinHTTP proxy configuration can be changed by using the [ProxyCfg.exe](/previous-versions/windows/desktop/ms761351(v=vs.85)) or [netsh](/previous-versions/windows/it-pro/windows-server-2003/cc785383(v=ws.10)) command-line utilities.</span></span>

<span data-ttu-id="d0257-163">**WinRM 1,1 und früher:** WinRM verwendet die Internet Explorer-Proxy Einstellungen nicht.</span><span class="sxs-lookup"><span data-stu-id="d0257-163">**WinRM 1.1 and Earlier:** WinRM does not use the Internet Explorer proxy settings.</span></span>

 

 