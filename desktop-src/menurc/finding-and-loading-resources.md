---
title: Suchen und Laden von Ressourcen
description: In diesem Thema wird erläutert, wie eine Ressource in den Arbeitsspeicher geladen wird.
ms.assetid: 9e56cfdd-b365-4433-a507-a30220b4a92d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca9590927cad28772a6b4a5b761d74c9ebf101a6
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "104472828"
---
# <a name="finding-and-loading-resources"></a><span data-ttu-id="c33d6-103">Suchen und Laden von Ressourcen</span><span class="sxs-lookup"><span data-stu-id="c33d6-103">Finding and Loading Resources</span></span>

<span data-ttu-id="c33d6-104">Vor der Verwendung einer Ressource muss Sie von einer Anwendung in den Arbeitsspeicher geladen werden.</span><span class="sxs-lookup"><span data-stu-id="c33d6-104">Before using a resource, an application must load it into memory.</span></span> <span data-ttu-id="c33d6-105">Die Funktionen " [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) " und " [**findresourceex**](/windows/desktop/api/Winbase/nf-winbase-findresourceexa) " suchen eine Ressource in einem Modul und geben ein Handle für die binären Ressourcen Daten zurück.</span><span class="sxs-lookup"><span data-stu-id="c33d6-105">The [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) and [**FindResourceEx**](/windows/desktop/api/Winbase/nf-winbase-findresourceexa) functions find a resource in a module and return a handle to the binary resource data.</span></span> <span data-ttu-id="c33d6-106">**FindResource** sucht eine Ressource nach Typ und Namen.</span><span class="sxs-lookup"><span data-stu-id="c33d6-106">**FindResource** locates a resource by type and name.</span></span> <span data-ttu-id="c33d6-107">**Findresourceex** sucht die Ressource nach Typ, Name und Sprache.</span><span class="sxs-lookup"><span data-stu-id="c33d6-107">**FindResourceEx** locates the resource by type, name, and language.</span></span> <span data-ttu-id="c33d6-108">Informationen zu **FindResource** in diesem Thema gelten auch für **findresourceex**.</span><span class="sxs-lookup"><span data-stu-id="c33d6-108">Information about **FindResource** in this topic also applies to **FindResourceEx**.</span></span>

<span data-ttu-id="c33d6-109">Die [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) -Funktion verwendet das von [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) zurückgegebene Ressourcen handle, um die Ressource in den Arbeitsspeicher zu laden.</span><span class="sxs-lookup"><span data-stu-id="c33d6-109">The [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) function uses the resource handle returned by [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) to load the resource into memory.</span></span> <span data-ttu-id="c33d6-110">Nachdem eine Anwendung eine Ressource mithilfe von " **LoadResource**" geladen hat, wird der zugeordnete Speicher nur entladen, wenn alle Verweise auf das Modul über " [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary)" freigegeben werden.</span><span class="sxs-lookup"><span data-stu-id="c33d6-110">After an application loads a resource by using **LoadResource**, the system will unload the associated memory only when all references to its module are freed through [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span></span> <span data-ttu-id="c33d6-111">Anwendungen, die wiederholt auf dieselbe oder viele Ressourcen innerhalb eines bestimmten Moduls zugreifen müssen, können aufgrund der Speicher Zuordnung, die in wiederholten [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) -und **FreeLibrary** -aufrufen stattfindet, zu Leistungseinbußen kommen.</span><span class="sxs-lookup"><span data-stu-id="c33d6-111">Applications which need to repeatedly access the same or many resources within a particular module may incur performance penalties due to the memory mapping taking place in repeated [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) and **FreeLibrary** calls.</span></span> <span data-ttu-id="c33d6-112">Anwendungen sollten ein einzelnes Modul handle speichern, bis Ressourcen nicht mehr benötigt werden, und dann **FreeLibrary** aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="c33d6-112">Applications should store a single module handle until resources are no longer needed, and then call **FreeLibrary**.</span></span> <span data-ttu-id="c33d6-113">Nachdem ein Modul aus dem Arbeitsspeicher entladen wurde, werden die Ressourcen Handles ungültig.</span><span class="sxs-lookup"><span data-stu-id="c33d6-113">After a module is unloaded from memory, resource handles become invalid.</span></span>

<span data-ttu-id="c33d6-114">Eine Anwendung kann [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) und [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) verwenden, um beliebige Ressourcentypen zu suchen und zu laden. diese Funktionen sollten jedoch nur in einer der folgenden Situationen verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="c33d6-114">An application can use [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) and [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) to find and load any type of resource, but these functions should be used only in one of these situations:</span></span>

-   <span data-ttu-id="c33d6-115">Wenn die Anwendung nicht mithilfe einer vorhandenen Ressourcen spezifischen Funktion auf die Ressource zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="c33d6-115">When the application cannot access the resource by using an existing resource-specific function.</span></span>
-   <span data-ttu-id="c33d6-116">Wenn die Anwendung auf die Ressource als Binärdaten für nachfolgende Funktionsaufrufe zugreifen muss.</span><span class="sxs-lookup"><span data-stu-id="c33d6-116">When the application must access the resource as binary data for subsequent function calls.</span></span>

<span data-ttu-id="c33d6-117">Eine Anwendung sollte, wenn möglich, stattdessen eine der folgenden Ressourcen spezifischen Funktionen verwenden, um Ressourcen in einem Aufruf zu suchen und zu laden:</span><span class="sxs-lookup"><span data-stu-id="c33d6-117">Whenever possible, an application should instead use one of the following resource-specific functions to find and load resources in one call:</span></span>



| <span data-ttu-id="c33d6-118">Funktion</span><span class="sxs-lookup"><span data-stu-id="c33d6-118">Function</span></span>                                     | <span data-ttu-id="c33d6-119">Aktion</span><span class="sxs-lookup"><span data-stu-id="c33d6-119">Action</span></span>                                   | <span data-ttu-id="c33d6-120">So entfernen Sie die Ressource</span><span class="sxs-lookup"><span data-stu-id="c33d6-120">To remove resource</span></span>                                                                                               |
|----------------------------------------------|------------------------------------------|------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c33d6-121">**Format Message**</span><span class="sxs-lookup"><span data-stu-id="c33d6-121">**FormatMessage**</span></span>](/windows/desktop/api/winbase/nf-winbase-formatmessage)      | <span data-ttu-id="c33d6-122">Lädt und formatiert einen Nachrichten Tabelleneintrag.</span><span class="sxs-lookup"><span data-stu-id="c33d6-122">Loads and formats a message-table entry.</span></span> | <span data-ttu-id="c33d6-123">Keine Aktion erforderlich.</span><span class="sxs-lookup"><span data-stu-id="c33d6-123">No action needed.</span></span>                                                                                                |
| [<span data-ttu-id="c33d6-124">**LoadAccelerators**</span><span class="sxs-lookup"><span data-stu-id="c33d6-124">**LoadAccelerators**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa) | <span data-ttu-id="c33d6-125">Lädt eine Zugriffstasten Tabelle.</span><span class="sxs-lookup"><span data-stu-id="c33d6-125">Loads an accelerator table.</span></span>              | [<span data-ttu-id="c33d6-126">**DestroyAcceleratorTable**</span><span class="sxs-lookup"><span data-stu-id="c33d6-126">**DestroyAcceleratorTable**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroyacceleratortable)                                                       |
| [<span data-ttu-id="c33d6-127">**LoadBitmap**</span><span class="sxs-lookup"><span data-stu-id="c33d6-127">**LoadBitmap**</span></span>](/windows/desktop/api/winuser/nf-winuser-loadbitmapa)             | <span data-ttu-id="c33d6-128">Lädt eine Bitmap-Ressource.</span><span class="sxs-lookup"><span data-stu-id="c33d6-128">Loads a bitmap resource.</span></span>                 | [<span data-ttu-id="c33d6-129">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="c33d6-129">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)                                                                             |
| [<span data-ttu-id="c33d6-130">**LoadCursor**</span><span class="sxs-lookup"><span data-stu-id="c33d6-130">**LoadCursor**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadcursora)             | <span data-ttu-id="c33d6-131">Lädt eine Cursor Ressource.</span><span class="sxs-lookup"><span data-stu-id="c33d6-131">Loads a cursor resource.</span></span>                 | [<span data-ttu-id="c33d6-132">**Destroycursor**</span><span class="sxs-lookup"><span data-stu-id="c33d6-132">**DestroyCursor**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroycursor)                                                                           |
| [<span data-ttu-id="c33d6-133">**LoadIcon**</span><span class="sxs-lookup"><span data-stu-id="c33d6-133">**LoadIcon**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadicona)                 | <span data-ttu-id="c33d6-134">Lädt eine Symbol Ressource.</span><span class="sxs-lookup"><span data-stu-id="c33d6-134">Loads an icon resource.</span></span>                  | [<span data-ttu-id="c33d6-135">**DestroyIcon**</span><span class="sxs-lookup"><span data-stu-id="c33d6-135">**DestroyIcon**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroyicon)                                                                               |
| [<span data-ttu-id="c33d6-136">**LoadImage**</span><span class="sxs-lookup"><span data-stu-id="c33d6-136">**LoadImage**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadimagea)               | <span data-ttu-id="c33d6-137">Lädt ein Symbol, einen Cursor oder eine Bitmap.</span><span class="sxs-lookup"><span data-stu-id="c33d6-137">Loads an icon, cursor, or bitmap.</span></span>        | <span data-ttu-id="c33d6-138">[**DestroyIcon**](/windows/desktop/api/Winuser/nf-winuser-destroyicon), [**destroycursor**](/windows/desktop/api/Winuser/nf-winuser-destroycursor), [**DeleteObject**](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)</span><span class="sxs-lookup"><span data-stu-id="c33d6-138">[**DestroyIcon**](/windows/desktop/api/Winuser/nf-winuser-destroyicon), [**DestroyCursor**](/windows/desktop/api/Winuser/nf-winuser-destroycursor), [**DeleteObject**](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)</span></span> |
| [<span data-ttu-id="c33d6-139">**Loadmenu**</span><span class="sxs-lookup"><span data-stu-id="c33d6-139">**LoadMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadmenua)                 | <span data-ttu-id="c33d6-140">Lädt eine Menü Ressource.</span><span class="sxs-lookup"><span data-stu-id="c33d6-140">Loads a menu resource.</span></span>                   | [<span data-ttu-id="c33d6-141">**DestroyMenu**</span><span class="sxs-lookup"><span data-stu-id="c33d6-141">**DestroyMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroymenu)                                                                               |
| [<span data-ttu-id="c33d6-142">**LoadString**</span><span class="sxs-lookup"><span data-stu-id="c33d6-142">**LoadString**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadstringa)             | <span data-ttu-id="c33d6-143">Lädt einen Zeichen folgen Tabelleneintrag.</span><span class="sxs-lookup"><span data-stu-id="c33d6-143">Loads a string-table entry.</span></span>              | <span data-ttu-id="c33d6-144">Keine Aktion erforderlich.</span><span class="sxs-lookup"><span data-stu-id="c33d6-144">No action needed.</span></span>                                                                                                |



 

<span data-ttu-id="c33d6-145">Beachten Sie die releasefunktionen in der obigen Tabelle.</span><span class="sxs-lookup"><span data-stu-id="c33d6-145">Note the release functions in the table above.</span></span> <span data-ttu-id="c33d6-146">Vor dem beenden sollte eine Anwendung den von Zugriffstasten Tabellen, Bitmaps, Cursorn, Symbolen und Menüs belegten Speicher mithilfe der entsprechenden Funktionen freigeben.</span><span class="sxs-lookup"><span data-stu-id="c33d6-146">Before terminating, an application should release the memory occupied by accelerator tables, bitmaps, cursors, icons, and menus by using the appropriate functions.</span></span>

<span data-ttu-id="c33d6-147">Der Arbeitsspeicher, der mit den durch [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) und [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) geladenen Ressourcen verknüpft ist, wird freigegeben, sobald das Modul durch einen Befehl von " [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary)" entladen wurde.</span><span class="sxs-lookup"><span data-stu-id="c33d6-147">Memory associated with resources loaded through [**FindResource**](/windows/desktop/api/Winbase/nf-winbase-findresourcea) and [**LoadResource**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource) will be released once the module has been unloaded by a call to [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary).</span></span> <span data-ttu-id="c33d6-148">Alle Ressourcen, die beim Beenden der Anwendung entladen bleiben, werden automatisch vom System freigegeben.</span><span class="sxs-lookup"><span data-stu-id="c33d6-148">Any resources which remain unloaded at application termination will be automatically released by the system.</span></span>

 

 