---
title: Verwenden von Versionsinformationen
description: In diesem Thema wird erläutert, wie die Versions Informationsfunktionen verwendet werden.
ms.assetid: 447b57c9-9e94-4a28-897e-f7b87d9cb25a
keywords:
- Ressourcen, Versionsinformationen
- Versionsinformationen
- Informationen zur Installationsdatei
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1a8785275f5aac69218989250d1c0f83e0a1ff9f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "103725456"
---
# <a name="using-version-information"></a><span data-ttu-id="019cb-106">Verwenden von Versionsinformationen</span><span class="sxs-lookup"><span data-stu-id="019cb-106">Using Version Information</span></span>

<span data-ttu-id="019cb-107">Ein Installationsprogramm umfasst in der Regel die folgenden Ziele:</span><span class="sxs-lookup"><span data-stu-id="019cb-107">An installation program typically has the following goals:</span></span>

-   <span data-ttu-id="019cb-108">, Um Dateien am richtigen Speicherort zu platzieren.</span><span class="sxs-lookup"><span data-stu-id="019cb-108">To place files in the correct location.</span></span>
-   <span data-ttu-id="019cb-109">, Um den Benutzer zu benachrichtigen, wenn das Installationsprogramm eine vorhandene Datei durch eine Version ersetzt, die sich erheblich unterscheidet – beispielsweise, wenn Sie eine deutschsprachige Datei durch eine englischsprachige Datei ersetzen oder eine neuere Datei durch eine ältere Datei ersetzen.</span><span class="sxs-lookup"><span data-stu-id="019cb-109">To notify the user if the installation program is replacing an existing file with a version that is significantly different—for example, replacing a German-language file with an English-language file, or replacing a newer file with an older file.</span></span>

<span data-ttu-id="019cb-110">Wenn Sie das Installationsprogramm schreiben, müssen Sie für jede Datei über die folgenden Informationen verfügen:</span><span class="sxs-lookup"><span data-stu-id="019cb-110">When writing the installation program, you must have the following information for each file:</span></span>

-   <span data-ttu-id="019cb-111">Der Name und Speicherort der Datei (als Quelldatei bezeichnet).</span><span class="sxs-lookup"><span data-stu-id="019cb-111">The name and location of the file (referred to as the source file).</span></span>
-   <span data-ttu-id="019cb-112">Der Name der entsprechenden Datei auf der Festplatte des Benutzers (als Zieldatei bezeichnet).</span><span class="sxs-lookup"><span data-stu-id="019cb-112">The name of the equivalent file on the user's hard disk (referred to as the destination file).</span></span> <span data-ttu-id="019cb-113">Dieser Name ist in der Regel identisch mit dem Dateinamen auf dem Installations Datenträger.</span><span class="sxs-lookup"><span data-stu-id="019cb-113">This name is usually the same as the filename on the installation disk.</span></span>
-   <span data-ttu-id="019cb-114">Der Freigabe Status der Datei – d. h. ob die Datei für die zu installierende Anwendung privat ist oder von mehreren Anwendungen gemeinsam genutzt werden kann.</span><span class="sxs-lookup"><span data-stu-id="019cb-114">The sharing status of the file—that is, whether the file is private to the application being installed or could be shared by multiple applications.</span></span>

<span data-ttu-id="019cb-115">Das Installationsprogramm kann die [**verfindfile**](/windows/desktop/api/Winver/nf-winver-verfindfilea) -Funktion verwenden, um zu bestimmen, wo die Datei auf den Datenträger kopiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="019cb-115">The installation program can use the [**VerFindFile**](/windows/desktop/api/Winver/nf-winver-verfindfilea) function to determine where the file should be copied on the disk.</span></span> <span data-ttu-id="019cb-116">Diese Funktion kann auch verwendet werden, um anzugeben, ob die Datei für die Anwendung privat ist oder freigegeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="019cb-116">This function can also be used to specify whether the file is private to the application or can be shared.</span></span> <span data-ttu-id="019cb-117">Wenn beim Auffinden der Datei ein Problem auftritt, gibt **verfindfile** einen Fehlerwert zurück.</span><span class="sxs-lookup"><span data-stu-id="019cb-117">If a problem occurs in finding the file, **VerFindFile** returns an error value.</span></span> <span data-ttu-id="019cb-118">Wenn das System z. b. die Zieldatei verwendet, gibt **verfindfile** **VFF \_ FileInUse** zurück.</span><span class="sxs-lookup"><span data-stu-id="019cb-118">For example, if the system is using the destination file, **VerFindFile** returns **VFF\_FILEINUSE**.</span></span> <span data-ttu-id="019cb-119">Das Installationsprogramm muss den Benutzer über das Problem benachrichtigen und darauf reagieren, dass die Benutzer die Installation fortsetzen oder beenden können.</span><span class="sxs-lookup"><span data-stu-id="019cb-119">The installation program must notify the user of the problem and respond to the user's decision to continue or to end the installation.</span></span>

<span data-ttu-id="019cb-120">Die [**verinstallfile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) -Funktion kopiert die Quelldatei in eine temporäre Datei in dem Verzeichnis, das von [**verfindfile**](/windows/desktop/api/Winver/nf-winver-verfindfilea)angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="019cb-120">The [**VerInstallFile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) function copies the source file to a temporary file in the directory specified by [**VerFindFile**](/windows/desktop/api/Winver/nf-winver-verfindfilea).</span></span> <span data-ttu-id="019cb-121">Falls erforderlich, erweitert **verinstallfile** die Datei mithilfe der Funktionen in der datendekomprimierungbibliothek.</span><span class="sxs-lookup"><span data-stu-id="019cb-121">If necessary, **VerInstallFile** expands the file by using the functions in the data decompression library.</span></span>

<span data-ttu-id="019cb-122">[**Verinstallfile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) vergleicht die Versionsinformationen der temporären Datei mit der der Zieldatei.</span><span class="sxs-lookup"><span data-stu-id="019cb-122">[**VerInstallFile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) compares the version information of the temporary file to that of the destination file.</span></span> <span data-ttu-id="019cb-123">Wenn sich die beiden unterscheiden, gibt **verinstallfile** mindestens einen Fehlerwert zurück.</span><span class="sxs-lookup"><span data-stu-id="019cb-123">If the two differ, **VerInstallFile** returns one or more error values.</span></span> <span data-ttu-id="019cb-124">Beispielsweise wird **Vif \_ srcold** zurückgegeben, wenn die temporäre Datei älter als die Zieldatei ist, und **Vif \_ difflang** , wenn die Dateien unterschiedliche Sprach-IDs oder Code Page Werte aufweisen.</span><span class="sxs-lookup"><span data-stu-id="019cb-124">For example, it returns **VIF\_SRCOLD** if the temporary file is older than the destination file and **VIF\_DIFFLANG** if the files have different language identifiers or code-page values.</span></span> <span data-ttu-id="019cb-125">Das Installationsprogramm muss den Benutzer über das Problem benachrichtigen und darauf reagieren, dass die Benutzer die Installation fortsetzen oder beenden können.</span><span class="sxs-lookup"><span data-stu-id="019cb-125">The installation program must notify the user of the problem and respond to the user's decision to continue or to end the installation.</span></span>

<span data-ttu-id="019cb-126">Einige [**verinstallfile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) -Fehler sind wiederherstellbar.</span><span class="sxs-lookup"><span data-stu-id="019cb-126">Some [**VerInstallFile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) errors are recoverable.</span></span> <span data-ttu-id="019cb-127">Das heißt, dass das Installationsprogramm " **verinstallfile** " erneut aufruft und die VIFF-Option " **\_ forceinstall** " angibt, um die Datei unabhängig vom Versions Konflikt zu installieren.</span><span class="sxs-lookup"><span data-stu-id="019cb-127">That is, the installation program can call **VerInstallFile** again, specifying the **VIFF\_FORCEINSTALL** option, to install the file regardless of the version conflict.</span></span> <span data-ttu-id="019cb-128">Wenn **verinstallfile** " **Vif \_ tempfile** " zurückgibt und der Benutzer entscheidet, die Installation nicht zu erzwingen, sollte das Installationsprogramm die temporäre Datei löschen.</span><span class="sxs-lookup"><span data-stu-id="019cb-128">If **VerInstallFile** returns **VIF\_TEMPFILE** and the user chooses not to force the installation, the installation program should delete the temporary file.</span></span>

<span data-ttu-id="019cb-129">Bei [**verinstallfile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) kann ein nicht BEHEB barer Fehler auftreten, wenn versucht wird, die Installation zu erzwingen, obwohl der Fehler zuvor noch nicht vorhanden war.</span><span class="sxs-lookup"><span data-stu-id="019cb-129">[**VerInstallFile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) could encounter a nonrecoverable error when attempting to force installation, even though the error did not exist previously.</span></span> <span data-ttu-id="019cb-130">Beispielsweise könnte die Datei von einem anderen Benutzer gesperrt werden, bevor das Installationsprogramm versucht, die Installation zu erzwingen.</span><span class="sxs-lookup"><span data-stu-id="019cb-130">For example, the file could be locked by another user before the installation program attempted to force installation.</span></span> <span data-ttu-id="019cb-131">Wenn ein Installationsprogramm versucht, die Installation nach einem nicht BEHEB baren Fehler zu erzwingen, schlägt **verinstallfile** fehl.</span><span class="sxs-lookup"><span data-stu-id="019cb-131">If an installation program attempts to force installation after a non-recoverable error, **VerInstallFile** fails.</span></span> <span data-ttu-id="019cb-132">Das Installationsprogramm muss Routinen enthalten, um diese Art von Fehler zu beheben.</span><span class="sxs-lookup"><span data-stu-id="019cb-132">The installation program must contain routines to recover from this type of error.</span></span>

<span data-ttu-id="019cb-133">Die empfohlene Lösung besteht darin, ein Dialogfeld mit den Schaltflächen **install**, **Skip** und **install all** anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="019cb-133">The recommended solution is to display a dialog box with the buttons **Install**, **Skip**, and **Install All**.</span></span> <span data-ttu-id="019cb-134">(Eine andere Lösung ist ein Dialogfeld mit den Schaltflächen **Ja**, **Ja, über** **springen** und **Abbrechen**.) Mithilfe der Schaltfläche **alle installieren** sollte verhindert werden, dass das Installationsprogramm den Benutzer zu ähnlichen Fehlern auffordert, indem er die **VIFF \_ forceinstall** -Option in alle nachfolgenden Verwendungen von [**verinstallfile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea)einschließt.</span><span class="sxs-lookup"><span data-stu-id="019cb-134">(Another solution is a dialog box with the buttons **Yes**, **Yes to All**, **Skip**, and **Cancel**.) The **Install All** button should prevent the installation program from prompting the user about similar errors by including the **VIFF\_FORCEINSTALL** option in all subsequent uses of [**VerInstallFile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea).</span></span> <span data-ttu-id="019cb-135">Bei nicht BEHEB baren Fehlern sollten die Schaltflächen **Installieren** und **installieren alle** deaktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="019cb-135">For nonrecoverable errors, the **Install** and **Install All** buttons should be disabled.</span></span>

<span data-ttu-id="019cb-136">Zum Anzeigen einer nützlichen Fehlermeldung für den Benutzer muss das Installationsprogramm normalerweise Informationen aus den Versions Ressourcen der in Konflikt stehenden Dateien abrufen.</span><span class="sxs-lookup"><span data-stu-id="019cb-136">To display a useful error message to the user, the installation program usually must retrieve information from the version resources of the conflicting files.</span></span> <span data-ttu-id="019cb-137">Es gibt vier Funktionen, die das Installationsprogramm zu diesem Zweck verwenden kann:</span><span class="sxs-lookup"><span data-stu-id="019cb-137">There are four functions the installation program can use for this purpose:</span></span>

-   [<span data-ttu-id="019cb-138">**Fehler bei GetFileVersionInfoSize**</span><span class="sxs-lookup"><span data-stu-id="019cb-138">**GetFileVersionInfoSize**</span></span>](/windows/desktop/api/Winver/nf-winver-getfileversioninfosizea)
-   [<span data-ttu-id="019cb-139">**GetFileVersionInfo**</span><span class="sxs-lookup"><span data-stu-id="019cb-139">**GetFileVersionInfo**</span></span>](/windows/desktop/api/Winver/nf-winver-getfileversioninfoa)
-   [<span data-ttu-id="019cb-140">**VerQueryValue**</span><span class="sxs-lookup"><span data-stu-id="019cb-140">**VerQueryValue**</span></span>](/windows/desktop/api/Winver/nf-winver-verqueryvaluea)
-   [<span data-ttu-id="019cb-141">**Verlanguagename**</span><span class="sxs-lookup"><span data-stu-id="019cb-141">**VerLanguageName**</span></span>](/windows/desktop/api/Winver/nf-winver-verlanguagenamea)

<span data-ttu-id="019cb-142">[**GetFileVersionInfoSize**](/windows/desktop/api/Winver/nf-winver-getfileversioninfosizea) gibt die Größe der Versionsinformationen zurück.</span><span class="sxs-lookup"><span data-stu-id="019cb-142">[**GetFileVersionInfoSize**](/windows/desktop/api/Winver/nf-winver-getfileversioninfosizea) returns the size of the version information.</span></span> <span data-ttu-id="019cb-143">[**GetFileVersionInfo**](/windows/desktop/api/Winver/nf-winver-getfileversioninfoa) verwendet Informationen, die von **GetFileVersionInfoSize** abgerufen werden, um eine Struktur abzurufen, die die Versionsinformationen enthält.</span><span class="sxs-lookup"><span data-stu-id="019cb-143">[**GetFileVersionInfo**](/windows/desktop/api/Winver/nf-winver-getfileversioninfoa) uses information retrieved by **GetFileVersionInfoSize** to retrieve a structure that contains the version information.</span></span> <span data-ttu-id="019cb-144">[**VerQueryValue**](/windows/desktop/api/Winver/nf-winver-verqueryvaluea) Ruft ein bestimmtes Element aus dieser Struktur ab.</span><span class="sxs-lookup"><span data-stu-id="019cb-144">[**VerQueryValue**](/windows/desktop/api/Winver/nf-winver-verqueryvaluea) retrieves a specific member from that structure.</span></span>

<span data-ttu-id="019cb-145">Wenn [**verinstallfile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) beispielsweise den **Vif- \_ difftype** -Fehler zurückgibt, sollte das Installationsprogramm die Funktionen [**GetFileVersionInfoSize**](/windows/desktop/api/Winver/nf-winver-getfileversioninfosizea), [**GetFileVersionInfo**](/windows/desktop/api/Winver/nf-winver-getfileversioninfoa)und [**VerQueryValue**](/windows/desktop/api/Winver/nf-winver-verqueryvaluea) in den temporären Dateien und Zieldateien verwenden, um den allgemeinen Typ der einzelnen Dateien abzurufen.</span><span class="sxs-lookup"><span data-stu-id="019cb-145">For example, if [**VerInstallFile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) returns the **VIF\_DIFFTYPE** error, the installation program should use the [**GetFileVersionInfoSize**](/windows/desktop/api/Winver/nf-winver-getfileversioninfosizea), [**GetFileVersionInfo**](/windows/desktop/api/Winver/nf-winver-getfileversioninfoa), and [**VerQueryValue**](/windows/desktop/api/Winver/nf-winver-verqueryvaluea) functions on the temporary and destination files to obtain the general type of each file.</span></span> <span data-ttu-id="019cb-146">Wenn die Sprachen der Dateien in Konflikt stehen, sollte das Installationsprogramm auch [**verlanguagename**](/windows/desktop/api/Winver/nf-winver-verlanguagenamea) verwenden, um den binären sprach Bezeichner in eine Textdarstellung der Sprache zu übersetzen.</span><span class="sxs-lookup"><span data-stu-id="019cb-146">If the languages of the files conflict, the installation program should also use [**VerLanguageName**](/windows/desktop/api/Winver/nf-winver-verlanguagenamea) to translate the binary language identifier into a text representation of the language.</span></span> <span data-ttu-id="019cb-147">(Beispielsweise übersetzt 0x040c in die Zeichenfolge "Französisch".)</span><span class="sxs-lookup"><span data-stu-id="019cb-147">(For example, 0x040C translates to the string "French.")</span></span>

<span data-ttu-id="019cb-148">Wenn [**verinstallfile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) einen Datei Fehler zurückgibt, wie z. **b. Vif \_ accessverletzungs**, sollte das Installationsprogramm die [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) -Funktion verwenden, um den letzten Fehlerwert abzurufen.</span><span class="sxs-lookup"><span data-stu-id="019cb-148">If [**VerInstallFile**](/windows/desktop/api/Winver/nf-winver-verinstallfilea) returns a file error, such as **VIF\_ACCESSVIOLATION**, the installation program should use the [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) function to retrieve the most recent error value.</span></span> <span data-ttu-id="019cb-149">Das Programm sollte diesen Wert in eine informative Meldung übersetzen, die dem Benutzer angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="019cb-149">The program should translate this value into an informative message to display to the user.</span></span> <span data-ttu-id="019cb-150">Das Programm darf keine Kontrolle zwischen den Aufrufen von " **verinstallfile** " und " **GetLastError**" erhalten.</span><span class="sxs-lookup"><span data-stu-id="019cb-150">The program must not yield control between the calls to **VerInstallFile** and **GetLastError**.</span></span>

 

 