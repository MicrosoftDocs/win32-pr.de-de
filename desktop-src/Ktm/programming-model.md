---
description: Anwendungs Schreiber können kleinere Quell Codeänderungen vornehmen, um transaktive Datei-und Registrierungs Vorgänge mithilfe des Kerneltransaktions-Managers (KTM) hinzuzufügen.
ms.assetid: 356c66dc-5ddd-472f-835c-2e2cb019bcfd
title: Arbeiten mit Transaktionen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 255e40fb38ca4bfb24acdce717f133dbcf0c76f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "103865772"
---
# <a name="working-with-transactions"></a><span data-ttu-id="9f566-103">Arbeiten mit Transaktionen</span><span class="sxs-lookup"><span data-stu-id="9f566-103">Working With Transactions</span></span>

<span data-ttu-id="9f566-104">Anwendungs Schreiber können kleinere Quell Codeänderungen vornehmen, um transaktive Datei-und Registrierungs Vorgänge mithilfe des Kerneltransaktions-Managers (KTM) hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="9f566-104">Application writers can make minor source code changes to add transacted file and registry operations using the Kernel Transaction Manager (KTM).</span></span> <span data-ttu-id="9f566-105">In der Regel umfasst dies das Erstellen einer Transaktion und das Übergeben des Handles an andere Funktionen, die von Transaktions Ressourcen bereitgestellt werden, z. b. [Transaktions-NTFS](/windows/desktop/FileIO/transactional-ntfs-portal) und die transaktive Registrierung.</span><span class="sxs-lookup"><span data-stu-id="9f566-105">Typically, this will involve creating a transaction and passing the handle to other functions provided by transactional resources such as [Transactional NTFS](/windows/desktop/FileIO/transactional-ntfs-portal) and the Transacted Registry.</span></span>

<span data-ttu-id="9f566-106">KTM bietet Mechanismen, mit denen Ihre Anwendung an Transaktionen teilnehmen und ihren eigenen transaktionalen Ressourcen-Manager schreiben muss.</span><span class="sxs-lookup"><span data-stu-id="9f566-106">KTM provides mechanisms for your application to participate in transactions as well as to write your own transactional resource manager.</span></span> <span data-ttu-id="9f566-107">Es gibt Funktionen, die es Ihnen ermöglichen, vier Klassen von Kernel Objekten zu erstellen, zu verwalten und mit Ihnen zu arbeiten: Transaktionen, Transaktions-Manager, Ressourcen-Manager und Eintragung.</span><span class="sxs-lookup"><span data-stu-id="9f566-107">There are functions that allow you to create, manage, and work with four classes of kernel objects: transactions, transaction managers, resource managers, and enlistments.</span></span> <span data-ttu-id="9f566-108">Wenn Sie einfach Transaktionen verwenden, müssen Sie nur mit Transaktions Objekten arbeiten und diese Funktionen verwenden:</span><span class="sxs-lookup"><span data-stu-id="9f566-108">If you are simply using transactions, you only need to work with transaction objects and use these functions:</span></span>

-   [<span data-ttu-id="9f566-109">**CreateTransaction**</span><span class="sxs-lookup"><span data-stu-id="9f566-109">**CreateTransaction**</span></span>](/windows/desktop/api/KtmW32/nf-ktmw32-createtransaction)
-   [<span data-ttu-id="9f566-110">**CommitTransaction**</span><span class="sxs-lookup"><span data-stu-id="9f566-110">**CommitTransaction**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-committransaction)
-   [<span data-ttu-id="9f566-111">**RollbackTransaction**</span><span class="sxs-lookup"><span data-stu-id="9f566-111">**RollbackTransaction**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbacktransaction)

<span data-ttu-id="9f566-112">Gehen Sie niemals davon aus, dass eine Transaktion aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="9f566-112">Never assume a transaction is active.</span></span> <span data-ttu-id="9f566-113">Für Transaktionen kann aus vielen Gründen und jederzeit ein Rollback ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="9f566-113">Transactions can be rolled back for many reasons and at any time.</span></span>

<span data-ttu-id="9f566-114">Windows macht eine Handle-basierte Schnittstelle für Systemressourcen verfügbar.</span><span class="sxs-lookup"><span data-stu-id="9f566-114">Windows exposes a handle-based interface to system resources.</span></span> <span data-ttu-id="9f566-115">Um mit einem Betriebssystem Objekt zu arbeiten, fordert die Anwendung zuerst ein Handle für das Objekt an und verwendet dann dieses Handle in nachfolgenden Funktionsaufrufen, um auf das Objekt zuzugreifen oder es zu ändern.</span><span class="sxs-lookup"><span data-stu-id="9f566-115">To work with an operating system object, the application first requests a handle to the object, and then uses this handle in subsequent function calls to access or modify the object.</span></span> <span data-ttu-id="9f566-116">Ein Handle kann normalerweise in unterschiedlichen Modi geöffnet werden. der angegebene Modus wirkt sich auf die Semantik von nachfolgenden Funktionsaufrufen aus.</span><span class="sxs-lookup"><span data-stu-id="9f566-116">A handle can usually be opened in different modes; the mode specified affects the semantics of subsequent function calls.</span></span> <span data-ttu-id="9f566-117">Beispielsweise kann ein Datei Handle, das durch einen Aufruf von " [**deatefile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) " geöffnet wird, mit dem " *dwDesiredAccess* "-Flag, das auf " **generischer \_ Lese** Vorgang" festgelegt ist, nicht in Aufrufen verwendet werden,</span><span class="sxs-lookup"><span data-stu-id="9f566-117">For example, a file handle that is opened by a call to [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) with the *dwDesiredAccess* flag set to **GENERIC\_READ** cannot be used in calls that modify the file.</span></span>

<span data-ttu-id="9f566-118">Sie können mit [Distributed Transaction Coordinator](/previous-versions/windows/desktop/ms684146(v=vs.85)) Benutzermodus-Ressourcen wie SQL oder MSMQ und mit kernelmodusressourcen, die KTM verwenden, koordinieren.</span><span class="sxs-lookup"><span data-stu-id="9f566-118">You can coordinate with [Distributed Transaction Coordinator](/previous-versions/windows/desktop/ms684146(v=vs.85)) user-mode resources such as SQL or MSMQ, and with kernel-mode resources that use the KTM.</span></span> <span data-ttu-id="9f566-119">Erstellen Sie zunächst eine DTC-Transaktion oder ein [**System. Transactions**](/dotnet/api/system.transactions?view=dotnet-plat-ext-3.1) -Objekt, und rufen Sie dann das [**IKernelTransaction**](/previous-versions/windows/desktop/aa344210(v=vs.85)) -Objekt auf, von dem Sie den KTM-handle abrufen können.</span><span class="sxs-lookup"><span data-stu-id="9f566-119">First, create a DTC transaction, or a [**System.Transactions**](/dotnet/api/system.transactions?view=dotnet-plat-ext-3.1) object, then call the [**IKernelTransaction**](/previous-versions/windows/desktop/aa344210(v=vs.85)) object, from which you can obtain the KTM handle.</span></span> <span data-ttu-id="9f566-120">Das **IKernelTransaction** -Objekt erstellt eine KTM-Transaktion, die der DTC-Transaktion untergeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="9f566-120">The **IKernelTransaction** object creates a KTM transaction that is subordinate to the DTC transaction.</span></span> <span data-ttu-id="9f566-121">Mit diesem Handle können Sie die transaktiven Objekte erstellen, aber das Ergebnis der Transaktion mithilfe von DTC oder **System. Transactions** signalisieren.</span><span class="sxs-lookup"><span data-stu-id="9f566-121">With this handle, you can create your transacted objects, but signal the outcome of the transaction using DTC or **System.Transactions**.</span></span>

 

 
