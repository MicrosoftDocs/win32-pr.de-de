---
description: Ein Dienst, bei dem es sich um eine Konsolenanwendung handelt, kann einen Konsolen Steuerungs Handler registrieren, um eine Benachrichtigung zu erhalten, wenn sich ein Benutzer
ms.assetid: 86ace8b8-c1cb-4646-bc92-86bd578a82c5
title: Empfangen von Ereignissen in einem Dienst
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b95f7329383ffc8aea08102a2fe8cf8b49e0ef9d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104530080"
---
# <a name="receiving-events-in-a-service"></a><span data-ttu-id="ea159-103">Empfangen von Ereignissen in einem Dienst</span><span class="sxs-lookup"><span data-stu-id="ea159-103">Receiving Events in a Service</span></span>

<span data-ttu-id="ea159-104">Ein Dienst, bei dem es sich um eine Konsolenanwendung handelt, kann einen [Konsolen Steuerungs Handler](/windows/console/console-control-handlers) registrieren, um eine Benachrichtigung zu erhalten, wenn sich ein Benutzer</span><span class="sxs-lookup"><span data-stu-id="ea159-104">A service that is a console application can register a [console control handler](/windows/console/console-control-handlers) to receive notification when a user logs off.</span></span> <span data-ttu-id="ea159-105">Es wird jedoch kein Konsolen Ereignis gesendet, wenn sich ein interaktiver Benutzer anmeldet.</span><span class="sxs-lookup"><span data-stu-id="ea159-105">However, there is no console event sent when an interactive user logs on.</span></span> <span data-ttu-id="ea159-106">Informationen zum Empfangen von Benachrichtigungen, wenn sich ein Benutzer anmeldet, finden Sie unter [Erstellen eines Winlogon-Benachrichtigungs Pakets](/windows/desktop/SecAuthN/creating-a-winlogon-notification-package).</span><span class="sxs-lookup"><span data-stu-id="ea159-106">For information on receiving notification when a user logs on, see [Creating a Winlogon Notification Package](/windows/desktop/SecAuthN/creating-a-winlogon-notification-package).</span></span>

<span data-ttu-id="ea159-107">Das System überträgt Geräte Änderungs Ereignisse an alle Dienste.</span><span class="sxs-lookup"><span data-stu-id="ea159-107">The system broadcasts device change events to all services.</span></span> <span data-ttu-id="ea159-108">Diese Ereignisse können von einem Dienst in einer Fenster Prozedur oder in seinem Dienst Steuerungs Handler empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="ea159-108">These events can be received by a service in a window procedure or in its service control handler.</span></span> <span data-ttu-id="ea159-109">Verwenden Sie die [**registerdevicenotifi-**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa) Funktion, um anzugeben, welche Ereignisse der Dienst empfangen soll.</span><span class="sxs-lookup"><span data-stu-id="ea159-109">To specify which events your service should receive, use the [**RegisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa) function.</span></span>

<span data-ttu-id="ea159-110">Stellen Sie sicher, dass Plug & Play Geräte Ereignisse so schnell wie möglich behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="ea159-110">Be sure to handle Plug and Play device events as quickly as possible.</span></span> <span data-ttu-id="ea159-111">Andernfalls reagiert das System möglicherweise nicht mehr.</span><span class="sxs-lookup"><span data-stu-id="ea159-111">Otherwise, the system may become unresponsive.</span></span> <span data-ttu-id="ea159-112">Wenn der Ereignishandler einen Vorgang ausführen kann, der die Ausführung blockieren kann (z. b. e/a), empfiehlt es sich, einen weiteren Thread zu starten, um den Vorgang asynchron auszuführen.</span><span class="sxs-lookup"><span data-stu-id="ea159-112">If your event handler is to perform an operation that may block execution (such as I/O), it is best to start another thread to perform the operation asynchronously.</span></span>

<span data-ttu-id="ea159-113">Wenn ein Dienst [**registerdevicenotifizierung**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa)aufruft, gibt der Dienst auch ein Fenster Handle oder ein Dienststatus Handle an.</span><span class="sxs-lookup"><span data-stu-id="ea159-113">When a service calls [**RegisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa), the service also specifies either a window handle or a service status handle.</span></span> <span data-ttu-id="ea159-114">Wenn ein Dienst ein Fenster Handle angibt, empfängt die Fenster Prozedur die Benachrichtigungs Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="ea159-114">If a service specifies a window handle, the window procedure receives the notification events.</span></span> <span data-ttu-id="ea159-115">Wenn ein Dienst sein Dienststatus Handle angibt, empfängt der Dienst Steuerungs Handler die Benachrichtigungs Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="ea159-115">If a service specifies its service status handle, its service control handler receives the notification events.</span></span> <span data-ttu-id="ea159-116">Weitere Informationen finden Sie unter [**handlerex**](/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex).</span><span class="sxs-lookup"><span data-stu-id="ea159-116">For more information, see [**HandlerEx**](/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex).</span></span>

<span data-ttu-id="ea159-117">Die von [**registerdevicenotifizurück**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa) gegebenen Geräte Benachrichtigungs Handles müssen geschlossen werden, indem die [**unregisterdevicenotifi-**](/windows/desktop/api/winuser/nf-winuser-unregisterdevicenotification) Funktion aufgerufen wird, wenn Sie nicht mehr benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="ea159-117">Device notification handles returned by [**RegisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-registerdevicenotificationa) must be closed by calling the [**UnregisterDeviceNotification**](/windows/desktop/api/winuser/nf-winuser-unregisterdevicenotification) function when they are no longer needed.</span></span>

 

 
