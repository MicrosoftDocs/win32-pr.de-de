---
title: Informationen zu Kombinations Feldern
description: In diesem Abschnitt werden die unterschiedlichen Arten von Kombinations Feldern erläutert.
ms.assetid: 76410a87-aa0e-4da9-9e78-c80ac485e3cd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 344596a3c0aa772568956344aaddcc053b534993
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104558367"
---
# <a name="about-combo-boxes"></a><span data-ttu-id="217d8-103">Informationen zu Kombinations Feldern</span><span class="sxs-lookup"><span data-stu-id="217d8-103">About Combo Boxes</span></span>

<span data-ttu-id="217d8-104">Ein Kombinations Feld kombiniert ein Bearbeitungsfeld oder einen statischen Text und eine Liste.</span><span class="sxs-lookup"><span data-stu-id="217d8-104">A combo box combines an edit box or static text and a list.</span></span>

<span data-ttu-id="217d8-105">Dieses Thema enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="217d8-105">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="217d8-106">Kombinations Feld Typen und Stile</span><span class="sxs-lookup"><span data-stu-id="217d8-106">Combo Box Types and Styles</span></span>](#combo-box-types-and-styles)
-   [<span data-ttu-id="217d8-107">Kombinations Feld Liste</span><span class="sxs-lookup"><span data-stu-id="217d8-107">Combo Box List</span></span>](#combo-box-list)
    -   [<span data-ttu-id="217d8-108">Aktuelle Auswahl</span><span class="sxs-lookup"><span data-stu-id="217d8-108">Current Selection</span></span>](#current-selection)
    -   [<span data-ttu-id="217d8-109">Dropdown Listen</span><span class="sxs-lookup"><span data-stu-id="217d8-109">Drop-down Lists</span></span>](#drop-down-lists)
    -   [<span data-ttu-id="217d8-110">Inhalt auflisten</span><span class="sxs-lookup"><span data-stu-id="217d8-110">List Contents</span></span>](#list-contents)
-   [<span data-ttu-id="217d8-111">Steuerelement Auswahlfelder bearbeiten</span><span class="sxs-lookup"><span data-stu-id="217d8-111">Edit Control Selection Fields</span></span>](#edit-control-selection-fields)
-   [<span data-ttu-id="217d8-112">Vom Besitzer gezeichnete Kombinations Felder</span><span class="sxs-lookup"><span data-stu-id="217d8-112">Owner-Drawn Combo Boxes</span></span>](#owner-drawn-combo-boxes)
-   [<span data-ttu-id="217d8-113">Untergeordnete Kombinations Felder</span><span class="sxs-lookup"><span data-stu-id="217d8-113">Subclassed Combo Boxes</span></span>](#subclassed-combo-boxes)

## <a name="combo-box-types-and-styles"></a><span data-ttu-id="217d8-114">Kombinations Feld Typen und Stile</span><span class="sxs-lookup"><span data-stu-id="217d8-114">Combo Box Types and Styles</span></span>

<span data-ttu-id="217d8-115">Ein Kombinations Feld besteht aus einer Liste und einem Auswahlfeld.</span><span class="sxs-lookup"><span data-stu-id="217d8-115">A combo box consists of a list and a selection field.</span></span> <span data-ttu-id="217d8-116">Die Liste enthält die Optionen, die ein Benutzer auswählen kann, und im Feldauswahl wird die aktuelle Auswahl angezeigt.</span><span class="sxs-lookup"><span data-stu-id="217d8-116">The list presents the options that a user can select, and the selection field displays the current selection.</span></span> <span data-ttu-id="217d8-117">Wenn das Auswahlfeld ein Bearbeitungs Steuerelement ist, kann der Benutzerinformationen eingeben, die in der Liste nicht verfügbar sind. Andernfalls kann der Benutzer nur Elemente in der Liste auswählen.</span><span class="sxs-lookup"><span data-stu-id="217d8-117">If the selection field is an edit control, the user can enter information not available in the list; otherwise, the user can only select items in the list.</span></span>

<span data-ttu-id="217d8-118">Die Bibliothek für allgemeine Steuerelemente umfasst drei Haupt Formate von Kombinations Feldern, wie in der folgenden Tabelle dargestellt.</span><span class="sxs-lookup"><span data-stu-id="217d8-118">The common controls library includes three main styles of combo box, as shown in the following table.</span></span>



| <span data-ttu-id="217d8-119">Typ des Kombinations Felds</span><span class="sxs-lookup"><span data-stu-id="217d8-119">Combo box type</span></span>             | <span data-ttu-id="217d8-120">Stil Konstante</span><span class="sxs-lookup"><span data-stu-id="217d8-120">Style constant</span></span>                                                 | <span data-ttu-id="217d8-121">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="217d8-121">Description</span></span>                                                                                  |
|----------------------------|----------------------------------------------------------------|----------------------------------------------------------------------------------------------|
| <span data-ttu-id="217d8-122">Einfach</span><span class="sxs-lookup"><span data-stu-id="217d8-122">Simple</span></span>                     | [<span data-ttu-id="217d8-123">**CBS \_ Simple**</span><span class="sxs-lookup"><span data-stu-id="217d8-123">**CBS\_SIMPLE**</span></span>](combo-box-styles.md)             | <span data-ttu-id="217d8-124">Zeigt die Liste jederzeit an und zeigt das ausgewählte Element in einem Bearbeitungs Steuerelement an.</span><span class="sxs-lookup"><span data-stu-id="217d8-124">Displays the list at all times, and shows the selected item in an edit control.</span></span>              |
| <span data-ttu-id="217d8-125">Drop-down</span><span class="sxs-lookup"><span data-stu-id="217d8-125">Drop-down</span></span>                  | [<span data-ttu-id="217d8-126">**CBS- \_ Dropdown**</span><span class="sxs-lookup"><span data-stu-id="217d8-126">**CBS\_DROPDOWN**</span></span>](combo-box-styles.md)         | <span data-ttu-id="217d8-127">Zeigt die Liste an, wenn auf das Symbol geklickt wird, und zeigt das ausgewählte Element in einem Bearbeitungs Steuerelement an.</span><span class="sxs-lookup"><span data-stu-id="217d8-127">Displays the list when the icon is clicked, and shows the selected item in an edit control.</span></span>  |
| <span data-ttu-id="217d8-128">Dropdown Liste (Dropdown Liste)</span><span class="sxs-lookup"><span data-stu-id="217d8-128">Drop-down list (drop list)</span></span> | [<span data-ttu-id="217d8-129">**CBS- \_ Dropdown Liste**</span><span class="sxs-lookup"><span data-stu-id="217d8-129">**CBS\_DROPDOWNLIST**</span></span>](combo-box-styles.md) | <span data-ttu-id="217d8-130">Zeigt die Liste an, wenn auf das Symbol geklickt wird, und zeigt das ausgewählte Element in einem statischen Steuerelement an.</span><span class="sxs-lookup"><span data-stu-id="217d8-130">Displays the list when the icon is clicked, and shows the selected item in a static control.</span></span> |



 

<span data-ttu-id="217d8-131">Die folgenden Screenshots zeigen die drei Arten von Kombinations Feldern, die in Windows Vista angezeigt werden können.</span><span class="sxs-lookup"><span data-stu-id="217d8-131">The following screen shots each show the three kinds of combo box as they might appear in Windows Vista.</span></span> <span data-ttu-id="217d8-132">Im ersten Screenshot hat der Benutzer ein Element im einfachen Kombinations Feld ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="217d8-132">In the first screen shot, the user has selected an item in the simple combo box.</span></span> <span data-ttu-id="217d8-133">Der Benutzer kann auch einen neuen Wert in das Bearbeitungsfeld dieses Steuer Elements eingeben.</span><span class="sxs-lookup"><span data-stu-id="217d8-133">The user can also type a new value in the edit box of this control.</span></span> <span data-ttu-id="217d8-134">Die Größe der Liste wurde im Microsoft Visual Studio Ressourcen-Editor angepasst und ist nur groß genug, um zwei Elemente aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="217d8-134">The list has been sized in the Microsoft Visual Studio resource editor and is only large enough to accommodate two items.</span></span>

![Screenshot, der ein in einem einfachen Kombinations Feld ausgewähltes Element anzeigt](images/simplecombo.png)

<span data-ttu-id="217d8-136">Im zweiten Screenshot hat der Benutzer im Dropdown-Kombinations Feld neuen Text in das Bearbeitungs Steuerelement eingegeben.</span><span class="sxs-lookup"><span data-stu-id="217d8-136">In the second screen shot, the user has typed new text in the edit control of the drop-down combo box.</span></span> <span data-ttu-id="217d8-137">Der Benutzer könnte auch ein vorhandenes Element auswählen.</span><span class="sxs-lookup"><span data-stu-id="217d8-137">The user could also have selected an existing item.</span></span> <span data-ttu-id="217d8-138">Das Listenfeld wird erweitert, um so viele Elemente wie möglich aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="217d8-138">The list box expands to accommodate as many items as possible.</span></span>

![Screenshot mit Text, der in ein Dropdown-Kombinations Feld eingegeben wird](images/dropdown.png)

<span data-ttu-id="217d8-140">Im dritten Screenshot hat der Benutzer das Kombinations Feld für die Dropdown Liste geöffnet.</span><span class="sxs-lookup"><span data-stu-id="217d8-140">In the third screen shot, the user has opened the drop-down list combo box.</span></span> <span data-ttu-id="217d8-141">Das Listenfeld wird erweitert, um so viele Elemente wie möglich aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="217d8-141">The list box expands to accommodate as many items as possible.</span></span> <span data-ttu-id="217d8-142">Der Benutzer kann keinen neuen Text eingeben.</span><span class="sxs-lookup"><span data-stu-id="217d8-142">The user cannot enter new text.</span></span>

![Screenshot mit einem Element, das in einem Kombinations Feld der Dropdown Liste ausgewählt ist](images/droplist.png)

<span data-ttu-id="217d8-144">Es gibt auch eine Reihe von Kombinations Feld Stilen, die bestimmte Eigenschaften definieren.</span><span class="sxs-lookup"><span data-stu-id="217d8-144">There are also a number of combo box styles that define specific properties.</span></span> <span data-ttu-id="217d8-145">Kombinations Feld Stile definieren bestimmte Eigenschaften eines Kombinations Felds.</span><span class="sxs-lookup"><span data-stu-id="217d8-145">Combo box styles define specific properties of a combo box.</span></span> <span data-ttu-id="217d8-146">Sie können Stile kombinieren. einige Stile gelten jedoch nur für bestimmte Kombinations Feld Typen.</span><span class="sxs-lookup"><span data-stu-id="217d8-146">You can combine styles; however, some styles apply only to certain combo box types.</span></span> <span data-ttu-id="217d8-147">Eine Tabelle mit Kombinations Feld Formaten finden Sie unter Kombinations [Feld-Stile](combo-box-styles.md).</span><span class="sxs-lookup"><span data-stu-id="217d8-147">For a table of combo box styles, see [Combo Box Styles](combo-box-styles.md).</span></span>

> [!Note]  
> <span data-ttu-id="217d8-148">Um visuelle Stile mit Kombinations Feldern zu verwenden, muss eine Anwendung ein Manifest enthalten, und es muss am Anfang des Programms [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="217d8-148">To use visual styles with combo boxes, an application must include a manifest and must call [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) at the beginning of the program.</span></span> <span data-ttu-id="217d8-149">Weitere Informationen zu visuellen Stilen finden Sie unter [visuelle Stile](themes-overview.md).</span><span class="sxs-lookup"><span data-stu-id="217d8-149">For information on visual styles, see [Visual Styles](themes-overview.md).</span></span> <span data-ttu-id="217d8-150">Weitere Informationen zu Manifesten finden Sie unter [Aktivieren von visuellen Stilen](cookbook-overview.md).</span><span class="sxs-lookup"><span data-stu-id="217d8-150">For information on manifests, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

 

## <a name="combo-box-list"></a><span data-ttu-id="217d8-151">Kombinations Feld Liste</span><span class="sxs-lookup"><span data-stu-id="217d8-151">Combo Box List</span></span>

<span data-ttu-id="217d8-152">Die Liste ist der Teil eines Kombinations Felds, in dem die Elemente angezeigt werden, die ein Benutzer auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="217d8-152">The list is the portion of a combo box that displays the items a user can select.</span></span> <span data-ttu-id="217d8-153">In der Regel Initialisiert eine Anwendung den Inhalt der Liste, wenn ein Kombinations Feld erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="217d8-153">Typically, an application initializes the contents of the list when it creates a combo box.</span></span> <span data-ttu-id="217d8-154">Jedes vom Benutzer ausgewählte Listenelement ist die *aktuelle Auswahl*.</span><span class="sxs-lookup"><span data-stu-id="217d8-154">Any list item selected by the user is the *current selection*.</span></span> <span data-ttu-id="217d8-155">Es können nicht mehrere Elemente ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="217d8-155">Multiple items cannot be selected.</span></span> <span data-ttu-id="217d8-156">In einfachen und Dropdown-Kombinations Feldern kann der Benutzer das Auswahlfeld eingeben, anstatt ein Listenelement auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="217d8-156">In simple and drop-down combo boxes, the user can type in the selection field instead of selecting a list item.</span></span> <span data-ttu-id="217d8-157">In diesen Fällen gibt es keine aktuelle Auswahl, und die Anwendung ist dafür verantwortlich, das Element der Liste hinzuzufügen und Sie zur aktuellen Auswahl zu machen, wenn dies angebracht ist.</span><span class="sxs-lookup"><span data-stu-id="217d8-157">In these cases, there is no current selection, and it is the application's responsibility to add the item to the list and make it the current selection, if it is appropriate to do so.</span></span>

<span data-ttu-id="217d8-158">In diesem Abschnitt werden die folgenden Themen behandelt:</span><span class="sxs-lookup"><span data-stu-id="217d8-158">This section discusses following topics:</span></span>

-   [<span data-ttu-id="217d8-159">Aktuelle Auswahl</span><span class="sxs-lookup"><span data-stu-id="217d8-159">Current Selection</span></span>](#current-selection)
-   [<span data-ttu-id="217d8-160">Dropdown Listen</span><span class="sxs-lookup"><span data-stu-id="217d8-160">Drop-down Lists</span></span>](#drop-down-lists)
-   [<span data-ttu-id="217d8-161">Inhalt auflisten</span><span class="sxs-lookup"><span data-stu-id="217d8-161">List Contents</span></span>](#list-contents)

### <a name="current-selection"></a><span data-ttu-id="217d8-162">Aktuelle Auswahl</span><span class="sxs-lookup"><span data-stu-id="217d8-162">Current Selection</span></span>

<span data-ttu-id="217d8-163">Die aktuelle Auswahl ist ein Listenelement, das der Benutzer ausgewählt hat. der ausgewählte Text wird im Auswahlfeld des Kombinations Felds angezeigt.</span><span class="sxs-lookup"><span data-stu-id="217d8-163">The current selection is a list item that the user has selected; the selected text appears in the selection field of the combo box.</span></span> <span data-ttu-id="217d8-164">Bei einem einfachen Kombinations Feld oder einem Dropdown-Kombinations Feld ist die aktuelle Auswahl jedoch nur eine Form der möglichen Benutzereingabe in einem Kombinations Feld.</span><span class="sxs-lookup"><span data-stu-id="217d8-164">However, in the case of a simple combo box or a drop-down combo box, the current selection is only one form of possible user input in a combo box.</span></span> <span data-ttu-id="217d8-165">Der Benutzer kann auch Text in das Auswahlfeld eingeben.</span><span class="sxs-lookup"><span data-stu-id="217d8-165">The user can also type text in the selection field.</span></span>

<span data-ttu-id="217d8-166">Die aktuelle Auswahl wird durch den NULL basierten Index des ausgewählten Listen Elements identifiziert.</span><span class="sxs-lookup"><span data-stu-id="217d8-166">The current selection is identified by the zero-based index of the selected list item.</span></span> <span data-ttu-id="217d8-167">Eine Anwendung kann Sie jederzeit festlegen und abrufen.</span><span class="sxs-lookup"><span data-stu-id="217d8-167">An application can set and retrieve it at any time.</span></span> <span data-ttu-id="217d8-168">Das übergeordnete Fenster oder die Dialogfeld Prozedur empfängt eine Benachrichtigung, wenn der Benutzer die aktuelle Auswahl für ein Kombinations Feld ändert.</span><span class="sxs-lookup"><span data-stu-id="217d8-168">The parent window or dialog box procedure receives notification when the user changes the current selection for a combo box.</span></span> <span data-ttu-id="217d8-169">Das übergeordnete Fenster oder Dialogfeld wird nicht benachrichtigt, wenn die Anwendung die Auswahl ändert.</span><span class="sxs-lookup"><span data-stu-id="217d8-169">The parent window or dialog box is not notified when the application changes the selection.</span></span>

<span data-ttu-id="217d8-170">Wenn ein Kombinations Feld erstellt wird, gibt es keine aktuelle Auswahl.</span><span class="sxs-lookup"><span data-stu-id="217d8-170">When a combo box is created, there is no current selection.</span></span> <span data-ttu-id="217d8-171">Dies gilt auch für ein einfaches oder Dropdown-Kombinations Feld, wenn der Benutzer den Inhalt des Auswahl Felds bearbeitet hat.</span><span class="sxs-lookup"><span data-stu-id="217d8-171">This is also true for a simple or drop-down combo box, if the user has edited the contents of the selection field.</span></span> <span data-ttu-id="217d8-172">Um die aktuelle Auswahl festzulegen, sendet eine Anwendung die [**CB- \_ setcurrsel**](cb-setcursel.md) -Nachricht an das Kombinations Feld.</span><span class="sxs-lookup"><span data-stu-id="217d8-172">To set the current selection, an application sends the [**CB\_SETCURSEL**](cb-setcursel.md) message to the combo box.</span></span> <span data-ttu-id="217d8-173">Eine Anwendung kann auch die [**CB- \_ SelectString**](cb-selectstring.md) -Nachricht verwenden, um die aktuelle Auswahl auf ein Listenelement festzulegen, dessen Zeichenfolge mit einer angegebenen Zeichenfolge beginnt.</span><span class="sxs-lookup"><span data-stu-id="217d8-173">An application can also use the [**CB\_SELECTSTRING**](cb-selectstring.md) message to set the current selection to a list item whose string begins with a specified string.</span></span> <span data-ttu-id="217d8-174">Um die aktuelle Auswahl zu bestimmen, sendet eine Anwendung die [**CB \_ getcurrsel**](cb-getcursel.md) -Nachricht an das Kombinations Feld.</span><span class="sxs-lookup"><span data-stu-id="217d8-174">To determine the current selection, an application sends the [**CB\_GETCURSEL**](cb-getcursel.md) message to the combo box.</span></span> <span data-ttu-id="217d8-175">Wenn keine aktuelle Auswahl vorhanden ist, gibt diese Meldung CB \_ Err zurück.</span><span class="sxs-lookup"><span data-stu-id="217d8-175">If there is no current selection, this message returns CB\_ERR.</span></span>

<span data-ttu-id="217d8-176">Wenn der Benutzer die aktuelle Auswahl in einem Kombinations Feld ändert, empfängt das übergeordnete Fenster oder die Dialogfeld Prozedur eine [**WM- \_ Befehls**](/windows/desktop/menurc/wm-command) Meldung mit dem [CBN \_ selChange](cbn-selchange.md) -Benachrichtigungs Code im höherwertigen Wort des *wParam* -Parameters.</span><span class="sxs-lookup"><span data-stu-id="217d8-176">When the user changes the current selection in a combo box, the parent window or dialog-box procedure receives a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message with the [CBN\_SELCHANGE](cbn-selchange.md) notification code in the high-order word of the *wParam* parameter.</span></span> <span data-ttu-id="217d8-177">Dieser Benachrichtigungs Code wird nicht gesendet, wenn die aktuelle Auswahl mithilfe der [**CB- \_ setcurrsel**](cb-setcursel.md) -Nachricht festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="217d8-177">This notification code is not sent when the current selection is set using the [**CB\_SETCURSEL**](cb-setcursel.md) message.</span></span>

<span data-ttu-id="217d8-178">Ein Dropdown-Kombinations Feld oder ein Dropdown-Listenfeld sendet den [CBN- \_ closeup](cbn-closeup.md) -Benachrichtigungs Code an das übergeordnete Fenster oder die Dialogfeld Prozedur, wenn die Dropdown Liste geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="217d8-178">A drop-down combo box or drop-down list box sends the [CBN\_CLOSEUP](cbn-closeup.md) notification code to the parent window or dialog-box procedure when the drop-down list closes.</span></span> <span data-ttu-id="217d8-179">Wenn der Benutzer die aktuelle Auswahl geändert hat, sendet das Kombinations Feld auch den [CBN \_ selChange](cbn-selchange.md) -Benachrichtigungs Code, wenn die Dropdown Liste geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="217d8-179">If the user changed the current selection, the combo box also sends the [CBN\_SELCHANGE](cbn-selchange.md) notification code when the drop-down list closes.</span></span> <span data-ttu-id="217d8-180">Um einen bestimmten Prozess jedes Mal auszuführen, wenn der Benutzer ein Listenelement auswählt, können Sie entweder den \_ Benachrichtigungs Code CBN selChange oder CBN \_ closeup verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="217d8-180">To execute a specific process each time the user selects a list item, you can handle either the CBN\_SELCHANGE or CBN\_CLOSEUP notification code.</span></span> <span data-ttu-id="217d8-181">In der Regel warten Sie \_ vor dem Verarbeiten einer Änderung in der aktuellen Auswahl den Benachrichtigungs Code für die CBN-Schließung.</span><span class="sxs-lookup"><span data-stu-id="217d8-181">Typically, you would wait for the CBN\_CLOSEUP notification code before processing a change in the current selection.</span></span> <span data-ttu-id="217d8-182">Dies kann besonders wichtig sein, wenn eine beträchtliche Menge an Verarbeitung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="217d8-182">This can be particularly important if a significant amount of processing is required.</span></span>

<span data-ttu-id="217d8-183">Eine Anwendung kann auch die Benachrichtigungs Codes " [CBN \_ selendok](cbn-selendok.md) " und " [CBN \_ selendcancel](cbn-selendcancel.md) " verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="217d8-183">An application could also process the [CBN\_SELENDOK](cbn-selendok.md) and [CBN\_SELENDCANCEL](cbn-selendcancel.md) notification codes.</span></span> <span data-ttu-id="217d8-184">Das System sendet CBN \_ selendok, wenn der Benutzer ein Listenelement auswählt, oder wählt ein Element aus und schließt dann die Liste.</span><span class="sxs-lookup"><span data-stu-id="217d8-184">The system sends CBN\_SELENDOK when the user selects a list item, or selects an item and then closes the list.</span></span> <span data-ttu-id="217d8-185">Dies gibt an, dass der Benutzer beendet wurde und dass die Auswahl verarbeitet werden sollte.</span><span class="sxs-lookup"><span data-stu-id="217d8-185">This indicates that the user has finished, and that the selection should be processed.</span></span> <span data-ttu-id="217d8-186">CBN \_ selendcancel wird gesendet, wenn der Benutzer ein Element auswählt, dann aber ein anderes Steuerelement auswählt, ESC drückt, während die Dropdown Liste geöffnet ist, oder das Dialogfeld schließt.</span><span class="sxs-lookup"><span data-stu-id="217d8-186">CBN\_SELENDCANCEL is sent when the user selects an item, but then selects another control, presses ESC while the drop-down list is open, or closes the dialog box.</span></span> <span data-ttu-id="217d8-187">Dies gibt an, dass die Auswahl des Benutzers ignoriert werden soll.</span><span class="sxs-lookup"><span data-stu-id="217d8-187">This indicates that the user's selection should be ignored.</span></span> <span data-ttu-id="217d8-188">CBN- \_ selendok wird vor jeder [CBN- \_ selChange](cbn-selchange.md) -Nachricht gesendet.</span><span class="sxs-lookup"><span data-stu-id="217d8-188">CBN\_SELENDOK is sent before every [CBN\_SELCHANGE](cbn-selchange.md) message.</span></span>

<span data-ttu-id="217d8-189">In einem einfachen Kombinations Feld sendet das System den [CBN- \_ dblclk](cbn-dblclk.md) -Benachrichtigungs Code, wenn der Benutzer auf ein Listenelement doppelklickt.</span><span class="sxs-lookup"><span data-stu-id="217d8-189">In a simple combo box, the system sends the [CBN\_DBLCLK](cbn-dblclk.md) notification code when the user double-clicks a list item.</span></span> <span data-ttu-id="217d8-190">Wenn Sie in einem Dropdown-Kombinations Feld oder in einer Dropdown Liste die Liste ausblenden, ist es nicht möglich, auf ein Element zu doppelklicken.</span><span class="sxs-lookup"><span data-stu-id="217d8-190">In a drop-down combo box or drop-down list, a single click hides the list, so it is not possible to double-click an item.</span></span>

### <a name="drop-down-lists"></a><span data-ttu-id="217d8-191">Dropdown Listen</span><span class="sxs-lookup"><span data-stu-id="217d8-191">Drop-down Lists</span></span>

<span data-ttu-id="217d8-192">Bestimmte Benachrichtigungen und Nachrichten gelten nur für Kombinations Felder mit Dropdown Listen.</span><span class="sxs-lookup"><span data-stu-id="217d8-192">Certain notifications and messages apply only to combo boxes containing drop-down lists.</span></span> <span data-ttu-id="217d8-193">Wenn eine Dropdown Liste geöffnet oder geschlossen ist, empfängt das übergeordnete Fenster eines Kombinations Felds eine Benachrichtigung in Form einer [**WM- \_ Befehls**](/windows/desktop/menurc/wm-command) Meldung.</span><span class="sxs-lookup"><span data-stu-id="217d8-193">When a drop-down list is open or closed, the parent window of a combo box receives a notification in the form of a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message.</span></span> <span data-ttu-id="217d8-194">Wenn die Liste geöffnet wird, ist das hochwertige Wort von *wParam* die [CBN- \_ Dropdown](cbn-dropdown.md)Liste.</span><span class="sxs-lookup"><span data-stu-id="217d8-194">If the list is being opened, the high-order word of *wParam* is [CBN\_DROPDOWN](cbn-dropdown.md).</span></span> <span data-ttu-id="217d8-195">Wenn die Liste geschlossen wird, ist Sie [CBN- \_ closeup](cbn-closeup.md).</span><span class="sxs-lookup"><span data-stu-id="217d8-195">If the list is being closed, it is [CBN\_CLOSEUP](cbn-closeup.md).</span></span>

<span data-ttu-id="217d8-196">Eine Anwendung kann die Liste mit einem Dropdown-Kombinations Feld oder einem Dropdown-Listenfeld öffnen, indem Sie die [**CB- \_ ShowDropDown**](cb-showdropdown.md) -Meldung verwendet.</span><span class="sxs-lookup"><span data-stu-id="217d8-196">An application can open the list of a drop-down combo box or drop-down list box by using the [**CB\_SHOWDROPDOWN**](cb-showdropdown.md) message.</span></span> <span data-ttu-id="217d8-197">Mithilfe der [**CB \_ getdroppedstate**](cb-getdroppedstate.md) -Nachricht kann ermittelt werden, ob die Liste geöffnet ist, und die Koordinaten einer Dropdown Liste können mithilfe der [**CB \_ getdroppedcontrolrect**](cb-getdroppedcontrolrect.md) -Nachricht bestimmt werden.</span><span class="sxs-lookup"><span data-stu-id="217d8-197">It can determine whether the list is open by using the [**CB\_GETDROPPEDSTATE**](cb-getdroppedstate.md) message and can determine the coordinates of a drop-down list by using the [**CB\_GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) message.</span></span> <span data-ttu-id="217d8-198">Eine Anwendung kann die Breite einer Dropdown Liste auch erhöhen, indem Sie die [**CB- \_ setdroppeer-DTH**](cb-setdroppedwidth.md) -Nachricht verwendet.</span><span class="sxs-lookup"><span data-stu-id="217d8-198">An application can also increase the width of a drop-down list by using the [**CB\_SETDROPPEDWIDTH**](cb-setdroppedwidth.md) message.</span></span>

### <a name="list-contents"></a><span data-ttu-id="217d8-199">Inhalt auflisten</span><span class="sxs-lookup"><span data-stu-id="217d8-199">List Contents</span></span>

<span data-ttu-id="217d8-200">Wenn eine Anwendung ein Kombinations Feld erstellt, wird das Kombinations Feld in der Regel initialisiert, indem ein oder mehrere Elemente zur Liste hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="217d8-200">When an application creates a combo box, it typically initializes the combo box by adding one or more items to the list.</span></span> <span data-ttu-id="217d8-201">Später kann eine Anwendung Listenelemente hinzufügen oder löschen, die Liste erneut initialisieren oder Element Informationen daraus abrufen.</span><span class="sxs-lookup"><span data-stu-id="217d8-201">Later, an application may add or delete list items, reinitialize the list, or retrieve item information from it.</span></span>

<span data-ttu-id="217d8-202">Eine Anwendung fügt einem Kombinations Feld Listenelemente hinzu, indem die [**CB \_ AddString**](cb-addstring.md) -Nachricht an Sie gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="217d8-202">An application adds list items to a combo box by sending the [**CB\_ADDSTRING**](cb-addstring.md) message to it.</span></span> <span data-ttu-id="217d8-203">Das angegebene Element wird am Ende der Liste oder in einem sortierten Kombinations Feld in der richtigen sortierten Position basierend auf der Element Zeichenfolge hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="217d8-203">The specified item is added to the end of the list or, in a sorted combo box, in its correct sorted position based on the item's string.</span></span> <span data-ttu-id="217d8-204">In einem unsortierten Kombinations Feld kann eine Anwendung die [**CB \_ InsertString**](cb-insertstring.md) -Nachricht verwenden, um ein Element an einer bestimmten Position einzufügen.</span><span class="sxs-lookup"><span data-stu-id="217d8-204">In an unsorted combo box, an application can use the [**CB\_INSERTSTRING**](cb-insertstring.md) message to insert an item at a specific position.</span></span> <span data-ttu-id="217d8-205">Nach dem hinzufügen wird ein Listenelement durch seine Position identifiziert.</span><span class="sxs-lookup"><span data-stu-id="217d8-205">Once added, a list item is identified by its position.</span></span>

<span data-ttu-id="217d8-206">Mithilfe der [**CB- \_ FindString**](cb-findstring.md) -oder [**CB \_ FindStringExact**](cb-findstringexact.md) -Nachricht kann eine Anwendung die Position eines Listen Elements bestimmen.</span><span class="sxs-lookup"><span data-stu-id="217d8-206">By using the [**CB\_FINDSTRING**](cb-findstring.md) or [**CB\_FINDSTRINGEXACT**](cb-findstringexact.md) message, an application can determine the position of a list item.</span></span> <span data-ttu-id="217d8-207">**CB \_ FindString** findet ein Element, dessen Zeichenfolge mit der angegebenen Zeichenfolge beginnt.</span><span class="sxs-lookup"><span data-stu-id="217d8-207">**CB\_FINDSTRING** finds an item whose string begins with the specified string.</span></span> <span data-ttu-id="217d8-208">**CB \_ FindStringExact** findet ein Element, dessen Zeichenfolge exakt mit der Zeichenfolge übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="217d8-208">**CB\_FINDSTRINGEXACT** finds an item whose string matches the string exactly.</span></span> <span data-ttu-id="217d8-209">Bei beiden Meldungen wird die Groß-/Kleinschreibung</span><span class="sxs-lookup"><span data-stu-id="217d8-209">Neither message is case sensitive.</span></span>

<span data-ttu-id="217d8-210">Eine Anwendung kann ein Listenelement mithilfe der [**CB \_ deletestring**](cb-deletestring.md) -Nachricht entfernen.</span><span class="sxs-lookup"><span data-stu-id="217d8-210">An application can remove a list item by using the [**CB\_DELETESTRING**](cb-deletestring.md) message.</span></span> <span data-ttu-id="217d8-211">Wenn eine Anwendung die Kombinations Feld Liste erneut initialisieren muss, kann Sie zuerst den gesamten Inhalt mithilfe der [**CB \_ resetcontent**](cb-resetcontent.md) -Nachricht löschen.</span><span class="sxs-lookup"><span data-stu-id="217d8-211">If an application needs to reinitialize the combo box list, it can first clear its entire contents by using the [**CB\_RESETCONTENT**](cb-resetcontent.md) message.</span></span> <span data-ttu-id="217d8-212">Wenn der Liste mehrere Elemente hinzugefügt werden, nachdem bereits ein Kombinations Feld angezeigt wurde, kann eine Anwendung das Flag neu zeichnen löschen, um zu verhindern, dass das Kombinations Feld neu gezeichnet wird, nachdem jedes Element hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="217d8-212">When adding multiple items to the list after a combo box has already been shown, an application can clear the redraw flag to prevent the combo box from being repainted after each item is added.</span></span> <span data-ttu-id="217d8-213">Weitere Informationen zum erneuten Zeichnen finden Sie in der Beschreibung der [**WM- \_**](/windows/desktop/gdi/wm-setredraw) Nachricht.</span><span class="sxs-lookup"><span data-stu-id="217d8-213">For more information about redrawing, see the description of the [**WM\_SETREDRAW**](/windows/desktop/gdi/wm-setredraw) message.</span></span>

<span data-ttu-id="217d8-214">Zum Abrufen der Zeichenfolge, die einem Listenelement zugeordnet ist, kann eine Anwendung die [**CB \_ getlbtext**](cb-getlbtext.md) -Nachricht verwenden.</span><span class="sxs-lookup"><span data-stu-id="217d8-214">To retrieve the string associated with a list item, an application can use the [**CB\_GETLBTEXT**](cb-getlbtext.md) message.</span></span> <span data-ttu-id="217d8-215">Die Zeichenfolge des Elements wird in den Puffer kopiert, der von der Anwendung angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="217d8-215">The item's string is copied to the buffer specified by the application.</span></span> <span data-ttu-id="217d8-216">Um sicherzustellen, dass der Puffer groß genug ist, um die Zeichenfolge zu empfangen, kann die Anwendung zuerst die [**CB \_ getlbtextlen**](cb-getlbtextlen.md) -Nachricht verwenden, um die Länge der Zeichenfolge zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="217d8-216">To ensure that the buffer is large enough to receive the string, the application can first use the [**CB\_GETLBTEXTLEN**](cb-getlbtextlen.md) message to determine the length of the string.</span></span> <span data-ttu-id="217d8-217">Um die Anzahl der Listenelemente in einem Kombinations Feld zu erhalten, kann eine Anwendung die [**CB \_ GetCount**](cb-getcount.md) -Nachricht verwenden.</span><span class="sxs-lookup"><span data-stu-id="217d8-217">To get the number of list items in a combo box, an application can use the [**CB\_GETCOUNT**](cb-getcount.md) message.</span></span>

## <a name="edit-control-selection-fields"></a><span data-ttu-id="217d8-218">Steuerelement Auswahlfelder bearbeiten</span><span class="sxs-lookup"><span data-stu-id="217d8-218">Edit Control Selection Fields</span></span>

<span data-ttu-id="217d8-219">Eine Anwendung kann den Inhalt des Auswahl Felds abrufen oder festlegen und die Bearbeitungs Auswahl bestimmen oder festlegen.</span><span class="sxs-lookup"><span data-stu-id="217d8-219">An application can retrieve or set the contents of the selection field and can determine or set the edit selection.</span></span> <span data-ttu-id="217d8-220">Die Anwendung kann auch die Menge an Text begrenzen, die ein Benutzer in das Auswahlfeld eingeben kann.</span><span class="sxs-lookup"><span data-stu-id="217d8-220">The application can also limit the amount of text a user can type in the selection field.</span></span> <span data-ttu-id="217d8-221">Wenn sich der Inhalt des Auswahl Felds ändert, sendet das System Benachrichtigungs Meldungen an das übergeordnete Fenster oder die Dialogfeld Prozedur.</span><span class="sxs-lookup"><span data-stu-id="217d8-221">When the contents of the selection field change, the system sends notification messages to the parent window or dialog box procedure.</span></span>

<span data-ttu-id="217d8-222">Um den Inhalt des Auswahl Felds abzurufen, kann eine Anwendung die WM- [**\_ gettext**](/windows/desktop/winmsg/wm-gettext) -Nachricht an das Kombinations Feld senden.</span><span class="sxs-lookup"><span data-stu-id="217d8-222">To retrieve the content of the selection field, an application can send the [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext) message to the combo box.</span></span> <span data-ttu-id="217d8-223">Um den Inhalt des Auswahl Felds eines einfachen oder Dropdown-Kombinations Felds festzulegen, kann eine Anwendung die WM- [**\_ SetText**](/windows/desktop/winmsg/wm-settext) -Nachricht an das Kombinations Feld senden.</span><span class="sxs-lookup"><span data-stu-id="217d8-223">To set the contents of the selection field of a simple or drop-down combo box, an application can send the [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext) message to the combo box.</span></span>

<span data-ttu-id="217d8-224">Die Auswahl bearbeiten ist der Bereich des ausgewählten Texts (sofern vorhanden) im Auswahlfeld eines einfachen oder Dropdown-Kombinations Felds.</span><span class="sxs-lookup"><span data-stu-id="217d8-224">The edit selection is the range of selected text, if any, in the selection field of a simple or drop-down combo box.</span></span> <span data-ttu-id="217d8-225">Eine Anwendung kann die Position des Anfangs-und Endzeichens der aktuellen Auswahl mithilfe der [**CB \_ geteditsel**](cb-geteditsel.md) -Nachricht ermitteln.</span><span class="sxs-lookup"><span data-stu-id="217d8-225">An application can determine the starting and ending character positions of the current selection by using the [**CB\_GETEDITSEL**](cb-geteditsel.md) message.</span></span> <span data-ttu-id="217d8-226">Mithilfe der CB-Nachricht " [**\_ logsditsel**](cb-seteditsel.md) " können auch Zeichen in der Bearbeitungs Auswahl ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="217d8-226">It can also select characters in the edit selection by using the [**CB\_SETEDITSEL**](cb-seteditsel.md) message.</span></span>

<span data-ttu-id="217d8-227">Anfänglich wird der Text, den der Benutzer in das Auswahlfeld eingeben kann, durch die Größe des Auswahl Felds beschränkt.</span><span class="sxs-lookup"><span data-stu-id="217d8-227">Initially, the amount of text that the user can type into the selection field is limited by the size of the selection field.</span></span> <span data-ttu-id="217d8-228">Wenn das Kombinations Feld jedoch den [**\_ autohscroll**](combo-box-styles.md) -Stil "CBS" aufweist, kann der Text weiterhin über die Größe des Auswahl Felds hinausgehen.</span><span class="sxs-lookup"><span data-stu-id="217d8-228">However, if the combo box has the [**CBS\_AUTOHSCROLL**](combo-box-styles.md) style, the text can continue beyond the size of the selection field.</span></span> <span data-ttu-id="217d8-229">Eine Anwendung kann die [**CB- \_ Begrenzungs Text**](cb-limittext.md) Nachricht verwenden, um die Menge an Text einzuschränken, die ein Benutzer in das Auswahlfeld eingeben kann, unabhängig davon, ob das Steuerelement den " **CBS \_ autohscroll** "-Stil hat.</span><span class="sxs-lookup"><span data-stu-id="217d8-229">An application can use the [**CB\_LIMITTEXT**](cb-limittext.md) message to limit the amount of text a user can type into the selection field, regardless of whether the control has the **CBS\_AUTOHSCROLL** style.</span></span>

<span data-ttu-id="217d8-230">Wenn der Benutzer den Inhalt des Auswahl Felds bearbeitet, empfängt das übergeordnete Fenster oder die Dialogfeld Prozedur Benachrichtigungs Meldungen.</span><span class="sxs-lookup"><span data-stu-id="217d8-230">When the user edits the content of the selection field, the parent window or dialog box procedure receives notification messages.</span></span> <span data-ttu-id="217d8-231">Der [CBN- \_ editupdate](cbn-editupdate.md) -Benachrichtigungs Code wird zuerst gesendet und zeigt an, dass der Text im Auswahlfeld bearbeitet wurde.</span><span class="sxs-lookup"><span data-stu-id="217d8-231">The [CBN\_EDITUPDATE](cbn-editupdate.md) notification code is sent first, indicating that the text in the selection field has been edited.</span></span> <span data-ttu-id="217d8-232">Nachdem der geänderte Text angezeigt wird, sendet das System [CBN \_ EditChange](cbn-editchange.md).</span><span class="sxs-lookup"><span data-stu-id="217d8-232">After the altered text is displayed, the system sends [CBN\_EDITCHANGE](cbn-editchange.md).</span></span> <span data-ttu-id="217d8-233">Wenn das Auswahlfeld Inhalt geändert wird, wenn ein Listenelement ausgewählt wird, werden diese Nachrichten nicht gesendet.</span><span class="sxs-lookup"><span data-stu-id="217d8-233">When the selection field content changes as the result of a list item being selected, these messages are not sent.</span></span>

## <a name="owner-drawn-combo-boxes"></a><span data-ttu-id="217d8-234">Kombinations Felder Owner-Drawn</span><span class="sxs-lookup"><span data-stu-id="217d8-234">Owner-Drawn Combo Boxes</span></span>

<span data-ttu-id="217d8-235">Eine Anwendung kann ein vom Besitzer gezeichnetes Kombinations Feld erstellen, um Aufgaben für das Zeichnen von Listenelementen zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="217d8-235">An application can create an owner-drawn combo box to take responsibility for painting list items.</span></span> <span data-ttu-id="217d8-236">Das übergeordnete Fenster eines von einem Besitzer gezeichneten Kombinations Felds (dessen Besitzer) empfängt [**WM \_ DrawItem**](wm-drawitem.md) -Nachrichten, wenn ein Teil des Kombinations Felds gezeichnet werden muss.</span><span class="sxs-lookup"><span data-stu-id="217d8-236">The parent window of an owner-drawn combo box (its owner) receives [**WM\_DRAWITEM**](wm-drawitem.md) messages when a portion of the combo box needs to be painted.</span></span> <span data-ttu-id="217d8-237">Ein vom Besitzer gezeichnetes Kombinations Feld kann weitere Informationen als oder zusätzlich zu Text Zeichenfolgen auflisten.</span><span class="sxs-lookup"><span data-stu-id="217d8-237">An owner-drawn combo box can list information other than, or in addition to, text strings.</span></span> <span data-ttu-id="217d8-238">Vom Besitzer gezeichnete Kombinations Felder können von einem beliebigen Typ sein.</span><span class="sxs-lookup"><span data-stu-id="217d8-238">Owner-drawn combo boxes can be of any type.</span></span> <span data-ttu-id="217d8-239">Allerdings kann das Bearbeitungs Steuerelement in einem einfachen oder Dropdown-Kombinations Feld nur Text anzeigen, während der Besitzer das Auswahlfeld in einem Dropdown-Listenfeld zeichnet.</span><span class="sxs-lookup"><span data-stu-id="217d8-239">However, the edit control in a simple or drop-down combo box can only display text, while the owner paints the selection field in a drop-down list box.</span></span>

<span data-ttu-id="217d8-240">Der Besitzer eines von einem Besitzer gezeichneten Kombinations Felds muss die [**WM- \_ DrawItem**](wm-drawitem.md) -Nachricht verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="217d8-240">The owner of an owner-drawn combo box must process the [**WM\_DRAWITEM**](wm-drawitem.md) message.</span></span> <span data-ttu-id="217d8-241">Diese Meldung wird immer dann gesendet, wenn ein Teil des Kombinations Felds neu gezeichnet werden muss.</span><span class="sxs-lookup"><span data-stu-id="217d8-241">This message is sent whenever a portion of the combo box must be redrawn.</span></span> <span data-ttu-id="217d8-242">Der Besitzer muss möglicherweise andere Nachrichten verarbeiten, abhängig von den für das Kombinations Feld angegebenen Stilen.</span><span class="sxs-lookup"><span data-stu-id="217d8-242">The owner may need to process other messages, depending on the styles specified for the combo box.</span></span>

<span data-ttu-id="217d8-243">Eine Anwendung kann ein vom Besitzer gezeichnetes Kombinations Feld erstellen, indem das CBS-Besitzer-oder [**CBS \_**](combo-box-styles.md) -Besitzer-Format angegeben wird. [**\_**](combo-box-styles.md)</span><span class="sxs-lookup"><span data-stu-id="217d8-243">An application can create an owner-drawn combo box by specifying the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) or [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style.</span></span> <span data-ttu-id="217d8-244">Wenn alle Listenelemente im Kombinations Feld die gleiche Höhe haben (z. b. Zeichen folgen oder Symbole), kann eine Anwendung den **CBS \_** -Besitzer "Besitzer" verwenden.</span><span class="sxs-lookup"><span data-stu-id="217d8-244">If all list items in the combo box are the same height, such as strings or icons, an application can use the **CBS\_OWNERDRAWFIXED** style.</span></span> <span data-ttu-id="217d8-245">Wenn Listenelemente unterschiedlich hoch sind, wie z. b. Bitmaps mit unterschiedlicher Größe, kann eine Anwendung den CBS-Besitzer der Art "Besitzer" verwenden. **\_**</span><span class="sxs-lookup"><span data-stu-id="217d8-245">If list items are of varying height, like bitmaps of different size, an application can use the **CBS\_OWNERDRAWVARIABLE** style.</span></span>

<span data-ttu-id="217d8-246">Der Besitzer eines von einem Besitzer gezeichneten Kombinations Felds kann eine [**WM \_ MeasureItem**](wm-measureitem.md) -Nachricht verarbeiten, um die Dimensionen von Listenelementen im Kombinations Feld anzugeben.</span><span class="sxs-lookup"><span data-stu-id="217d8-246">The owner of an owner-drawn combo box can process a [**WM\_MEASUREITEM**](wm-measureitem.md) message to specify the dimensions of list items in the combo box.</span></span> <span data-ttu-id="217d8-247">Wenn die Anwendung das Kombinations Feld mithilfe des CBS- [**\_ Besitzers**](combo-box-styles.md) "Besitzer" erstellt, sendet das System die " **WM \_ MeasureItem** "-Meldung nur einmal.</span><span class="sxs-lookup"><span data-stu-id="217d8-247">If the application creates the combo box by using the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) style, the system sends the **WM\_MEASUREITEM** message only once.</span></span> <span data-ttu-id="217d8-248">Die vom Besitzer angegebenen Dimensionen werden für alle Listenelemente verwendet.</span><span class="sxs-lookup"><span data-stu-id="217d8-248">The dimensions specified by the owner are used for all list items.</span></span> <span data-ttu-id="217d8-249">Wenn der [**" \_ CBS**](combo-box-styles.md) -Besitzer"-Stil verwendet wird, sendet das System eine **WM \_ MeasureItem** -Meldung für jedes Listenelement, das dem Kombinations Feld hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="217d8-249">If the [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style is used, the system sends a **WM\_MEASUREITEM** message for each list item added to the combo box.</span></span> <span data-ttu-id="217d8-250">Der Besitzer kann die Höhe eines Listen Elements jederzeit mithilfe der [**CB- \_ GetItemHeight**](cb-getitemheight.md) -und [**CB \_ setitemheight**](cb-setitemheight.md) -Nachrichten bestimmen oder festlegen.</span><span class="sxs-lookup"><span data-stu-id="217d8-250">The owner can determine or set the height of a list item at any time by using the [**CB\_GETITEMHEIGHT**](cb-getitemheight.md) and [**CB\_SETITEMHEIGHT**](cb-setitemheight.md) messages, respectively.</span></span>

<span data-ttu-id="217d8-251">Wenn die in einem von einem Besitzer gezeichneten Kombinations Feld angezeigten Informationen Text enthalten, kann eine Anwendung den Text für jedes Listenelement durch Angabe des [**CBS \_ hasstrings**](combo-box-styles.md) -Stils nachverfolgen.</span><span class="sxs-lookup"><span data-stu-id="217d8-251">If the information displayed in an owner-drawn combo box includes text, an application can keep track of the text for each list item by specifying the [**CBS\_HASSTRINGS**](combo-box-styles.md) style.</span></span> <span data-ttu-id="217d8-252">Kombinations Felder mit dem [**CBS- \_ Sortier**](combo-box-styles.md) Stil werden basierend auf diesem Text sortiert.</span><span class="sxs-lookup"><span data-stu-id="217d8-252">Combo boxes with the [**CBS\_SORT**](combo-box-styles.md) style are sorted based on this text.</span></span> <span data-ttu-id="217d8-253">Wenn ein Kombinations Feld und nicht der **CBS \_ hasstrings** -Stil sortiert ist, muss der Besitzer die [**WM \_ compareitem**](wm-compareitem.md) -Nachricht verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="217d8-253">If a combo box is sorted and not of the **CBS\_HASSTRINGS** style, the owner must process the [**WM\_COMPAREITEM**](wm-compareitem.md) message.</span></span>

<span data-ttu-id="217d8-254">In einem vom Besitzer gezeichneten Kombinations Feld muss der Besitzer Listenelemente nachverfolgen, die andere Informationen als oder zusätzlich zu Text enthalten.</span><span class="sxs-lookup"><span data-stu-id="217d8-254">In an owner-drawn combo box, the owner must keep track of list items containing information other than or in addition to text.</span></span> <span data-ttu-id="217d8-255">Eine bequeme Möglichkeit hierfür ist, das Handle in den Informationen als Elementdaten zu speichern.</span><span class="sxs-lookup"><span data-stu-id="217d8-255">One convenient way to do this is to save the handle to the information as item data.</span></span> <span data-ttu-id="217d8-256">Zum Freigeben von Datenobjekten, die Elementen in einem Kombinations Feld zugeordnet sind, kann der Besitzer die " [**WM \_ DeleteItem**](wm-deleteitem.md) "-Meldung verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="217d8-256">To free data objects associated with items in a combo box, the owner can process the [**WM\_DELETEITEM**](wm-deleteitem.md) message.</span></span>

## <a name="subclassed-combo-boxes"></a><span data-ttu-id="217d8-257">Untergeordnete Kombinations Felder</span><span class="sxs-lookup"><span data-stu-id="217d8-257">Subclassed Combo Boxes</span></span>

<span data-ttu-id="217d8-258">Unterklassen sind Verfahren, mit denen eine Anwendung Nachrichten abfangen und verarbeiten kann, die an ein Fenster gesendet oder gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="217d8-258">Subclassing is a procedure that allows an application to intercept and process messages sent or posted to a window.</span></span> <span data-ttu-id="217d8-259">Durch die Verwendung von Unterklassen kann eine Anwendung ihre eigene Verarbeitung für bestimmte Nachrichten ersetzen, während die meiste Nachrichtenverarbeitung an die Klassen definierte Fenster Prozedur überlassen wird.</span><span class="sxs-lookup"><span data-stu-id="217d8-259">By using subclassing, an application can substitute its own processing for certain messages, while leaving most message processing to the class-defined window procedure.</span></span>

<span data-ttu-id="217d8-260">Wenn das Betriebssystem ein Fenster erstellt, speichert es Informationen dazu in einer internen Datenstruktur, die einen Zeiger auf die Fenster Prozedur enthält.</span><span class="sxs-lookup"><span data-stu-id="217d8-260">When the operating system creates a window, it saves information about it in an internal data structure that includes a pointer to the window procedure.</span></span> <span data-ttu-id="217d8-261">Zur Unterklasse eines Fensters Ruft eine Anwendung die [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) -Funktion auf, um den Zeiger auf diese Prozedur durch einen Zeiger auf eine Anwendungs definierte Unterklassen Prozedur zu ersetzen.</span><span class="sxs-lookup"><span data-stu-id="217d8-261">To subclass a window, an application calls the [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) function to replace the pointer to that procedure with a pointer to an application-defined subclass procedure.</span></span> <span data-ttu-id="217d8-262">Anschließend werden alle Nachrichten an das Fenster an die Unterklassen Prozedur gesendet.</span><span class="sxs-lookup"><span data-stu-id="217d8-262">Thereafter, all messages to the window are sent to the subclass procedure.</span></span> <span data-ttu-id="217d8-263">Diese Prozedur verwendet dann die [**callwindowproc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) -Funktion, um nicht verarbeitete Nachrichten an die ursprüngliche Fenster Prozedur zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="217d8-263">This procedure then uses the [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) function to pass unprocessed messages to the original window procedure.</span></span> <span data-ttu-id="217d8-264">Eine Beschreibung der von der ComboBox-Klassen Fenster Prozedur ausgeführten Nachrichtenverarbeitung finden Sie unter [Standardverhalten](combo-box-features.md)für Kombinations Felder.</span><span class="sxs-lookup"><span data-stu-id="217d8-264">For a description of the message processing performed by the COMBOBOX class window procedure, see [Default Combo Box Behavior](combo-box-features.md).</span></span>

<span data-ttu-id="217d8-265">Wenn sich das Kombinations Feld außerhalb eines Dialog Felds befindet, kann eine Anwendung die Tab-, Enter-und ESC-Taste nicht verarbeiten, es sei denn, es wird eine Unterklassen Prozedur verwendet.</span><span class="sxs-lookup"><span data-stu-id="217d8-265">When the combo box is outside a dialog box, an application cannot process the TAB, ENTER, and ESC keys unless it uses a subclass procedure.</span></span> <span data-ttu-id="217d8-266">Wenn ein einfaches oder Dropdown-Kombinations Feld den Eingabefokus erhält, wird der Fokus sofort auf das untergeordnete Bearbeitungs Steuerelement festgelegt.</span><span class="sxs-lookup"><span data-stu-id="217d8-266">When a simple or drop-down combo box receives the input focus, it immediately sets the focus to its child edit control.</span></span> <span data-ttu-id="217d8-267">Daher muss eine Anwendung das Bearbeitungs Steuerelement unterteilen, um Tastatureingaben für ein einfaches oder Dropdown-Kombinations Feld abzufangen.</span><span class="sxs-lookup"><span data-stu-id="217d8-267">Therefore, an application must subclass the edit control to intercept keyboard input for a simple or drop-down combo box.</span></span> <span data-ttu-id="217d8-268">Ein Beispiel hierfür finden Sie [unter Unterklassen für ein Kombinations Feld](using-combo-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="217d8-268">For an example of this, see [Subclassing a Combo Box](using-combo-boxes.md).</span></span>

<span data-ttu-id="217d8-269">Wenn eine Unterklassen Prozedur die WM-Zeichnungs Nachricht verarbeitet, muss Sie die [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) -Funktion verwenden, um das [**\_ Zeichnen**](/windows/desktop/gdi/wm-paint) vorzubereiten.</span><span class="sxs-lookup"><span data-stu-id="217d8-269">If a subclass procedure processes the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message, it must use the [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) function to prepare for painting.</span></span> <span data-ttu-id="217d8-270">Vor dem Aufrufen der [**endpaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) -Funktion übergibt Sie das Handle des Geräte Kontexts (DC) als *wParam* -Parameter für die Fenster Prozedur.</span><span class="sxs-lookup"><span data-stu-id="217d8-270">Before calling the [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) function, it passes the device context (DC) handle as the *wParam* parameter for the window procedure.</span></span> <span data-ttu-id="217d8-271">Wenn **endpaint** zuerst aufgerufen wird, wird die Prozedur für das Klassen Fenster nicht gezeichnet, da **endpaint** das gesamte Fenster überprüft.</span><span class="sxs-lookup"><span data-stu-id="217d8-271">If **EndPaint** is called first, the class window procedure does no painting because **EndPaint** validates the entire window.</span></span>

<span data-ttu-id="217d8-272">Eine Technik, die sich auf die Unterklassen bezieht, ist eine übergeordnete Klasse.</span><span class="sxs-lookup"><span data-stu-id="217d8-272">A technique related to subclassing is superclassing.</span></span> <span data-ttu-id="217d8-273">Eine übergeordnete Klasse ähnelt jeder anderen Klasse, mit der Ausnahme, dass die Fenster Prozedur [**defwindowproc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) nicht zum Verarbeiten nicht verarbeiteter Nachrichten aufruft.</span><span class="sxs-lookup"><span data-stu-id="217d8-273">A superclass resembles any other class except that its window procedure does not call [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) to handle unprocessed messages.</span></span> <span data-ttu-id="217d8-274">Stattdessen übergibt sie nicht verarbeitete Nachrichten an die Fenster Prozedur für die übergeordnete Fenster Klasse.</span><span class="sxs-lookup"><span data-stu-id="217d8-274">Instead, it passes unprocessed messages to the window procedure for the parent window class.</span></span> <span data-ttu-id="217d8-275">Befolgen Sie die Richtlinien in [Windows-Prozeduren](/windows/desktop/winmsg/window-procedures) , um Probleme zu vermeiden, die bei Unterklassen und Superklassen auftreten können.</span><span class="sxs-lookup"><span data-stu-id="217d8-275">Follow the guidelines in [Window Procedures](/windows/desktop/winmsg/window-procedures) to avoid problems that can occur with subclassing and superclassing.</span></span>

 

 