---
title: Informationen zu Tree-View Steuerelementen
description: Ein Strukturansicht-Steuerelement ist ein Fenster, in dem eine hierarchische Liste von Elementen angezeigt wird, z. b. die Überschriften in einem Dokument, die Einträge in einem Index oder die Dateien und Verzeichnisse auf einem Datenträger.
ms.assetid: 10cc7949-dd77-412d-bad1-db8d8a049582
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df70a2d3c2f841b022930a07ee2f140ee5bfc8e3
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "103949173"
---
# <a name="about-tree-view-controls"></a>Informationen zu Tree-View Steuerelementen

Ein Strukturansicht-Steuerelement ist ein Fenster, in dem eine hierarchische Liste von Elementen angezeigt wird, z. b. die Überschriften in einem Dokument, die Einträge in einem Index oder die Dateien und Verzeichnisse auf einem Datenträger. Jedes Element besteht aus einer Bezeichnung und einem optionalen Bitmapbild, und jedem Element kann eine Liste von unter Elementen zugeordnet sein. Wenn Sie auf ein Element klicken, kann der Benutzer die zugeordnete Liste der unter Elemente erweitern oder reduzieren.

Die folgende Abbildung zeigt ein einfaches Strukturansicht-Steuerelement mit einem Stamm Knoten, einem erweiterten Knoten und einem reduzierten Knoten. Das-Steuerelement verwendet eine Bitmap für das ausgewählte Element und eine andere Bitmap für andere Elemente.

![Screenshot mit fünf Knoten in einer Hierarchie der Text eines Knotens ist ausgewählt, aber die Knoten sind nicht durch Zeilen miteinander verknüpft.](images/tv-simple.png)

Nachdem Sie ein Strukturansicht-Steuerelement erstellt haben, können Sie Elemente hinzufügen, entfernen, anordnen oder anderweitig bearbeiten, indem Sie Nachrichten an das Steuerelement senden. Jede Nachricht verfügt über ein oder mehrere zugehörige Makros, die Sie verwenden können, statt die Nachricht explizit zu senden.

Die folgenden Themen werden in diesem Abschnitt erläutert.

-   [Struktur Ansichts Stile](#tree-view-styles)
-   [Über-und untergeordnete Elemente](#parent-and-child-items)
-   [Element Bezeichnungen](#item-labels)
-   [Bezeichnungs Bearbeitung für Strukturansicht](#tree-view-label-editing)
-   [Struktur-Ansichts Element Position](#tree-view-item-position)
-   [Struktur-Ansichts Element Zustände (Übersicht)](#tree-view-item-states-overview)
-   [Elementauswahl](#item-selection)
-   [Element Informationen](#item-information)
-   [Strukturansicht: Bildlisten](#tree-view-image-lists)
-   [Drag & Drop-Vorgänge](#drag-and-drop-operations)
-   [Benachrichtigungs Meldungen für das Baumansicht-Steuerelement](#tree-view-control-notification-messages)
-   [Standardmäßige Tree-View Steuerung der Nachrichtenverarbeitung](#default-tree-view-control-message-processing)
-   [Zugehörige Themen](#related-topics)

## <a name="tree-view-styles"></a>Tree-View Stile

Strukturansicht-Stile steuern Aspekte der Darstellung eines Strukturansicht-Steuer Elements. Sie legen die anfänglichen Stile fest, wenn Sie das Strukturansicht-Steuerelement erstellen. Sie können die Stile abrufen und ändern, nachdem Sie das Strukturansicht-Steuerelement mithilfe der Funktionen " [**GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) " und " [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) " erstellt haben.

Der Stil der [**TV- \_ haslines**](tree-view-control-window-styles.md) erweitert die grafische Darstellung der Hierarchie eines Strukturansicht-Steuer Elements durch das Zeichnen von Linien, die untergeordnete Elemente mit ihrem übergeordneten Element verknüpfen, wie in der folgenden Abbildung dargestellt.

![Screenshot, der die vorherige Anordnung anzeigt, jedoch mit Zeilen, die den Knoten beitreten die erste Zeile wird vom Stamm Knoten abgeleitet.](images/tv-haslines.png)

In diesem Stil werden keine Linien am Stamm der Hierarchie gezeichnet. Zu diesem Zweck müssen Sie die Stile " [**TVs \_ haslines**](tree-view-control-window-styles.md) " und " [**TVs \_ linesAtRoot**](tree-view-control-window-styles.md) " kombinieren. Das Ergebnis ist in der folgenden Abbildung dargestellt.

![Screenshot mit der vorherigen Anordnung, aber mit einer zusätzlichen horizontalen Linie, die zum Stamm Knoten führt](images/tv-rootlines.png)

Der Benutzer kann die Liste der untergeordneten Elemente eines übergeordneten Elements durch Doppelklicken auf das übergeordnete Element erweitern oder reduzieren. Ein Strukturansicht-Steuerelement, das über den Stil der [**TV- \_ hasschaltfläche**](tree-view-control-window-styles.md) verfügt, fügt links neben jedem übergeordneten Element eine Schaltfläche hinzu. Der Benutzer kann einmal auf die Schaltfläche klicken, anstatt auf das übergeordnete Element doppelklicken, um das untergeordnete Element zu erweitern oder zu reduzieren. **Fernseh \_ Geräte Hasbuttons** fügt den Elementen im Stamm der Hierarchie keine Schaltflächen hinzu. Zu diesem Zweck müssen Sie die [**TV- \_ haslines**](tree-view-control-window-styles.md), die TV- **\_ Schalt** Flächen " [**\_ linesAtRoot**](tree-view-control-window-styles.md)" und "TVs" kombinieren. Diese Kombination von Stilen ist in der folgenden Abbildung dargestellt.

![Screenshot mit der vorherigen Anordnung, aber mit Schaltflächen zum erweitern/reduzieren in jedem Scheitelpunkt von zwei Zeilen](images/tv-hasbuttons.png)

Der Stil der [**TV- \_ Kontrollkästchen**](tree-view-control-window-styles.md) erstellt Kontrollkästchen neben jedem Element. Wenn Sie das CheckBox-Format verwenden möchten, müssen Sie nach dem Erstellen des Strukturansicht-Steuer Elements und vor dem Auffüllen der Struktur den Stil für die TV-Kontroll **\_ Kästchen** (mit " [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga)") festlegen. Andernfalls werden die Kontrollkästchen abhängig von den zeitlichen Problemen möglicherweise deaktiviert angezeigt. In der folgenden Abbildung wird das CheckBox-Format gezeigt.

![Screenshot, der die vorherige Anordnung anzeigt, aber mit einem Kontrollkästchen neben jedem Knoten zwei der Kontrollkästchen sind ausgewählt.](images/tv-haschecks.png)

Der [**\_ vollrowselect**](tree-view-control-window-styles.md) -Stil von TVs bewirkt, dass sich die Auswahl Markierung über der vollständigen Breite des Steuer Elements und nicht nur über dem Element selbst erstreckt. In der folgenden Abbildung wird dieser Stil veranschaulicht.

![Screenshot mit der ursprünglichen Anordnung von fünf Knoten ohne Zeilen, aber mit der Auswahl Markierung wird die vollständige Breite des Steuer Elements erweitert.](images/tv-fullrow.png)

Der [**\_ EditLabels**](tree-view-control-window-styles.md) -Stil von TVs ermöglicht dem Benutzer das Bearbeiten der Bezeichnungen von Struktur Ansichts Elementen. Weitere Informationen zum Bearbeiten von Bezeichnungen finden Sie Unterstruktur [Ansicht Bezeichnungs Bearbeitung](#tree-view-label-editing).

Weitere Informationen zu diesen und anderen Stilen finden Sie Unterstruktur [Ansicht-Steuerelement Fenster Stile](tree-view-control-window-styles.md).

## <a name="parent-and-child-items"></a>Über-und untergeordnete Elemente

Jedes Element in einem Strukturansicht-Steuerelement kann eine Liste von untergeordneten Elementen enthalten – die als untergeordnete *Elemente* bezeichnet werden – die diesem zugeordnet sind. Ein Element, das über ein oder mehrere untergeordnete Elemente verfügt, wird als über *geordnetes Element* bezeichnet. Unterhalb des übergeordneten Elements wird ein untergeordnetes Element angezeigt, das eingerückt wird, um anzugeben, dass es dem übergeordneten Element untergeordnet ist. Ein Element, das über kein übergeordnetes Element verfügt, wird oben in der Hierarchie angezeigt und wird als Stamm *Element* bezeichnet.

Um einem Strukturansicht-Steuerelement ein Element hinzuzufügen, senden Sie die [**TVM \_ InsertItem**](tvm-insertitem.md) -Meldung an das-Steuerelement. Die Meldung gibt ein Handle für den HTREEITEM-Typ zurück, der das Element eindeutig identifiziert. Wenn Sie ein Element hinzufügen, müssen Sie das Handle für das übergeordnete Element des neuen Elements angeben. Wenn Sie **null** oder den TVI- \_ Stammwert anstelle eines übergeordneten Element Handles in der [**TVINSERTSTRUCT**](/windows/win32/api/commctrl/ns-commctrl-tvinsertstructa) -Struktur angeben, wird das Element als Stamm Element hinzugefügt.

Der Status der Liste der untergeordneten Elemente eines übergeordneten Elements kann zu einem beliebigen Zeitpunkt entweder erweitert oder reduziert werden. Wenn der Zustand erweitert ist, werden die untergeordneten Elemente unter dem übergeordneten Element angezeigt. Wenn Sie reduziert ist, werden die untergeordneten Elemente nicht angezeigt. Die Liste wechselt automatisch zwischen den erweiterten und reduzierten Zuständen, wenn der Benutzer auf das übergeordnete Element doppelklickt, oder, wenn das übergeordnete Element den Stil der [**TV- \_ hasbuttons**](tree-view-control-window-styles.md) hat, wenn der Benutzer auf die Schaltfläche klickt, die dem übergeordneten Element zugeordnet ist. Eine Anwendung kann die untergeordneten Elemente mithilfe der [**TVM \_**](tvm-expand.md) -Erweiterungs Nachricht erweitern oder reduzieren.

Ein Strukturansicht-Steuerelement sendet dem übergeordneten Fenster eine [TVN \_ itemexpandeing](tvn-itemexpanding.md) -Benachrichtigungs Meldung, wenn die Liste der untergeordneten Elemente eines übergeordneten Elements erweitert oder reduziert wird. Die Benachrichtigung gibt der Anwendung die Möglichkeit, die Änderung zu verhindern oder Attribute des übergeordneten Elements festzulegen, die vom Status der Liste der untergeordneten Elemente abhängen. Nachdem der Status der Liste geändert wurde, sendet das Strukturansicht-Steuerelement dem übergeordneten Fenster eine [TVN \_ itemexpanded](tvn-itemexpanded.md) -Benachrichtigungs Meldung.

Wenn eine Liste von untergeordneten Elementen erweitert wird, wird Sie relativ zum übergeordneten Element eingerückt. Sie können die Einzugs Menge mithilfe der [**TVM- \_ setIndent**](tvm-setindent.md) -Nachricht festlegen oder den aktuellen Betrag mithilfe der [**TVM \_**](tvm-getindent.md) -Nachricht abrufen.

Ein Strukturansicht-Steuerelement verwendet den Arbeitsspeicher, der vom Heap des Prozesses belegt wird, der das Strukturansicht-Steuerelement erstellt. Die maximale Anzahl von Elementen in einer Strukturansicht basiert auf der Menge an Arbeitsspeicher, die im Heap verfügbar ist.

## <a name="item-labels"></a>Element Bezeichnungen

Sie geben in der Regel den Text der Bezeichnung eines Elements an, wenn Sie das Element dem Strukturansicht-Steuerelement hinzufügen. Die [**TVM \_ InsertItem**](tvm-insertitem.md) -Nachricht enthält eine [**tvitem**](/windows/win32/api/commctrl/ns-commctrl-tvitema) -Struktur, die die Eigenschaften des Elements definiert, einschließlich einer Zeichenfolge, die den Text der Bezeichnung enthält.

Ein Strukturansicht-Steuerelement ordnet Speicher zum Speichern der einzelnen Elemente zu. der Text der Element Bezeichnungen nimmt einen signifikanten Teil dieses Speichers an. Wenn Ihre Anwendung eine Kopie der Zeichen folgen im Strukturansicht-Steuerelement verwaltet, können Sie die Arbeitsspeicher Anforderungen des Steuer Elements verringern, indem Sie den LPSTR- \_ textcallback-Wert im **pszText** -Member von [**tvitem**](/windows/win32/api/commctrl/ns-commctrl-tvitema) angeben, anstatt tatsächliche Zeichen folgen an die Strukturansicht zu übergeben. Die Verwendung von LPSTR \_ textcallback bewirkt, dass das Strukturansicht-Steuerelement den Text der Bezeichnung eines Elements aus dem übergeordneten Fenster abruft, wenn das Element neu gezeichnet werden muss. Zum Abrufen des Texts sendet das Strukturansicht-Steuerelement eine [TVN \_ getdispinfo](tvn-getdispinfo.md) -Benachrichtigungs Meldung, die die Adresse einer [**NMTVDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmtvdispinfoa) -Struktur enthält. Das übergeordnete Fenster muss die entsprechenden Member der enthaltenen-Struktur ausfüllen.

## <a name="tree-view-label-editing"></a>Bearbeitung der Tree-View Bezeichnung

Der Benutzer kann die Bezeichnungen von Elementen in einem Strukturansicht-Steuerelement, das über den [**\_ EditLabels**](tree-view-control-window-styles.md) -Stil "TVs" verfügt, direkt bearbeiten. Der Benutzer beginnt mit der Bearbeitung, indem er auf die Bezeichnung des Elements klickt, das den Fokus besitzt. Eine Anwendung beginnt mit der Bearbeitung mithilfe der [**TVM \_ EditLabel**](tvm-editlabel.md) -Nachricht. Das Strukturansicht-Steuerelement benachrichtigt das übergeordnete Fenster, wenn die Bearbeitung beginnt und abgebrochen oder abgeschlossen wird. Wenn die Bearbeitung abgeschlossen ist, ist das übergeordnete Fenster für das Aktualisieren der Element Bezeichnung zuständig, falls dies erforderlich ist.

Wenn die Bezeichnungs Bearbeitung beginnt, sendet ein Strukturansicht-Steuerelement das übergeordnete Fenster an eine [TVN \_ beginlabeledit](tvn-beginlabeledit.md) -Benachrichtigungs Meldung. Durch die Verarbeitung dieser Benachrichtigung kann eine Anwendung das Bearbeiten einiger Bezeichnungen zulassen und die Bearbeitung anderer Benutzer verhindern. Wenn Sie 0 (null) zurückgeben, wird die Bearbeitung ermöglicht, und die Rückgabe von

Wenn die Bezeichnungs Bearbeitung abgebrochen oder abgeschlossen wird, sendet ein Strukturansicht-Steuerelement seinem übergeordneten Fenster eine [TVN \_ endlabeledit](tvn-endlabeledit.md) -Benachrichtigungs Meldung. Der *LPARAM* -Parameter ist die Adresse einer [**NMTVDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmtvdispinfoa) -Struktur. Der *Element* Parameter ist eine [**tvitem**](/windows/win32/api/commctrl/ns-commctrl-tvitema) -Struktur, die das Element identifiziert und den bearbeiteten Text enthält. Das übergeordnete Fenster ist für die Aktualisierung der Element Bezeichnung zuständig, wenn die neue Bezeichnung beibehalten werden soll. Der **pszText** -Member von **tvitem** ist 0 (null), wenn die Bearbeitung abgebrochen wird.

Während der Bezeichnungs Bearbeitung können Sie das Handle [ \_](tvn-beginlabeledit.md) für das Bearbeitungs Steuerelement abrufen, das für die Bezeichnungs Bearbeitung verwendet wird, indem Sie die [**TVM \_ geteditcontrol**](tvm-geteditcontrol.md) -Nachricht verwenden. Sie können das Bearbeitungs Steuerelement an eine [**EM- \_ SetLimitText**](em-setlimittext.md) -Nachricht senden, um die Menge an Text einzuschränken, die ein Benutzer eingeben kann, oder eine Unterklasse des Bearbeitungs Steuer Elements, um ungültige Zeichen abzufangen und Beachten Sie jedoch, dass das Bearbeitungs Steuerelement nur angezeigt wird, *nachdem*   TVN \_ beginlabeledit gesendet wurde.

## <a name="tree-view-item-position"></a>Position des Tree-View Elements

Die Anfangsposition eines Elements wird festgelegt, wenn das Element dem Strukturansicht-Steuerelement mithilfe der [**TVM \_ InsertItem**](tvm-insertitem.md) -Nachricht hinzugefügt wird. Die Meldung enthält eine [**TVINSERTSTRUCT**](/windows/win32/api/commctrl/ns-commctrl-tvinsertstructa) -Struktur, die das Handle für das übergeordnete Element und das Handle für das Element angibt, nach dem das neue Element eingefügt werden soll. Der zweite Handle muss entweder ein untergeordnetes Element des angegebenen übergeordneten Elements oder einen der folgenden Werte identifizieren: TVI \_ First, TVI \_ Last oder TVI \_ Sort.

Wenn TVI \_ First oder TVI \_ Last angegeben ist, platziert das Strukturansicht-Steuerelement das neue Element am Anfang oder Ende der Liste der untergeordneten Elemente des angegebenen übergeordneten Elements. Wenn TVI \_ Sort angegeben ist, fügt das Strukturansicht-Steuerelement das neue Element in der Liste der untergeordneten Elemente in alphabetischer Reihenfolge basierend auf dem Text der Element Bezeichnungen ein.

Mithilfe der [**TVM \_ SortChildren**](tvm-sortchildren.md) -Nachricht können Sie die Liste der untergeordneten Elemente eines übergeordneten Elements in alphabetischer Reihenfolge platzieren. Die Meldung enthält einen Parameter, der angibt, ob alle Ebenen von untergeordneten Elementen, die vom angegebenen übergeordneten Element absteigend sind, ebenfalls alphabetisch sortiert werden.

Mithilfe der [**TVM \_ SortChildren encb**](tvm-sortchildrencb.md) -Meldung können Sie untergeordnete Elemente basierend auf den von Ihnen definierten Kriterien sortieren. Wenn Sie diese Meldung verwenden, geben Sie eine Anwendungs definierte Rückruffunktion an, die vom Strukturansicht-Steuerelement aufgerufen werden kann, wenn die relative Reihenfolge von zwei untergeordneten Elementen bestimmt werden muss. Die Rückruffunktion empfängt von der Anwendung definierte 2 32-Bit-Werte für die verglichenen Elemente und einen dritten 32-Bit-Wert, den Sie beim Senden der **TVM \_ sortcb encb** angeben.

## <a name="tree-view-item-states-overview"></a>Übersicht über Tree-View Element Zustände

Jedes Element in einem Strukturansicht-Steuerelement verfügt über einen aktuellen Zustand. Die Zustandsinformationen für jedes Element enthalten einen Satz von Bitflags und Bildlisten Indizes, die das Zustands Bild des Elements und das Überlagerungs Bild angeben. Die Bitflags geben an, ob das Element ausgewählt, deaktiviert, erweitert usw. ist. Zum größten Teil legt ein Strukturansicht-Steuerelement den Zustand eines Elements automatisch so fest, dass Benutzeraktionen wie z. b. die Auswahl eines Elements angezeigt werden. Sie können jedoch auch den Zustand eines Elements mithilfe der [**TVM \_ SetItem**](tvm-setitem.md) -Meldung festlegen, und Sie können den aktuellen Zustand eines Elements mithilfe der [**TVM \_ GetItem**](tvm-getitem.md) -Nachricht abrufen. Eine umfassende Liste der Element Zustände finden Sie Unterstruktur [Ansicht-Steuerelement Zustände](tree-view-control-item-states.md).

Der aktuelle Zustand eines Elements wird vom **State** -Member der [**tvitem**](/windows/win32/api/commctrl/ns-commctrl-tvitema) -Struktur angegeben. In einem Strukturansicht-Steuerelement kann der Zustand eines Elements geändert werden, um eine Benutzeraktion widerzuspiegeln, z. b. das Auswählen des Elements oder das Festlegen des Fokus auf das Element. Außerdem kann eine Anwendung den Zustand eines Elements ändern, um das Element zu deaktivieren oder auszublenden oder ein Überlagerungs Bild oder ein Zustands Bild anzugeben.

Wenn Sie den Zustand eines Elements angeben oder ändern, gibt das **statemask** -Element von [**tvitem**](/windows/win32/api/commctrl/ns-commctrl-tvitema) an, welche Zustands Bits festgelegt werden sollen, und das statusmember **enthält die neuen** Werte für diese Bits.

Um das Überlagerungs Bild eines Elements festzulegen, muss **statemask** den [**Tvis- \_ overlaymask**](tree-view-control-item-states.md) -Wert enthalten, und **State** muss den 1-basierten Index des Überlagerungs Bilds enthalten, das nach links 8 Bits mithilfe des [**INDEXTOOVERLAYMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextooverlaymask) -Makros verschoben wurde. Der Index kann NULL sein, um kein Überlagerungs Bild anzugeben.

Neben dem Symbol eines Elements wird ein Status Bild angezeigt, das einen Anwendungs definierten Zustand angibt. Zustands Bilder sind in einer *Zustands Image Liste* enthalten, die durch das Senden einer [**TVM- \_ SetImageList**](tvm-setimagelist.md) -Meldung angegeben wird. Um das Zustands Bild eines Elements festzulegen, schließen Sie den [**Tvis- \_ stateimagemask**](tree-view-control-item-states.md) -Wert in das **statemask** -Element der [**tvitem**](/windows/win32/api/commctrl/ns-commctrl-tvitema) -Struktur ein. Bits 12 bis 15 des **Zustands** Members der Struktur geben den Index in der statusbildliste des abzurufenden Bilds an.

Verwenden Sie [**indexystateimagemask**](/windows/desktop/api/Commctrl/nf-commctrl-indextostateimagemask), um den Status Bild Index festzulegen. Dieses Makro nimmt einen Index an und legt die Bits 12 bis 15 entsprechend fest. Um anzugeben, dass das Element kein Zustands Bild hat, legen Sie den Index auf NULL fest. Diese Konvention bedeutet, dass Image NULL in der Status Bild Liste nicht als Zustands Bild verwendet werden kann. Um Bits 12 bis 15 des **State** -Members zu isolieren, verwenden Sie die [**Tvis- \_ stateimagemask**](tree-view-control-item-states.md) -Maske. Weitere Informationen zu Überlagerungs-und Zustands Bildern finden Sie Unterstruktur [Ansicht Bildlisten](#tree-view-image-lists).

## <a name="item-selection"></a>Elementauswahl

Ein Strukturansicht-Steuerelement benachrichtigt das übergeordnete Fenster, wenn sich die Auswahl von einem Element in ein anderes ändert, indem die [TVN \_ selchanging](tvn-selchanging.md) -und [TVN \_ selchanged](tvn-selchanged.md) -Benachrichtigungs Meldungen gesendet werden. Beide Benachrichtigungen enthalten einen Wert, der angibt, ob es sich bei der Änderung um das Ergebnis eines Mausklicks oder eines Tastatur Schlags handelt. Die Benachrichtigungen enthalten außerdem Informationen über das Element, das die Auswahl erhält, und das Element, das die Auswahl verliert. Mit diesen Informationen können Sie Element Attribute festlegen, die vom Auswahl Zustand des Elements abhängen. Wenn Sie " **true** " als Antwort auf "TVN selchanging" zurückgeben \_ , wird verhindert, dass die Auswahl geändert wird, und " **false** "

Eine Anwendung kann die Auswahl durch Senden der [**TVM- \_ SelectItem**](tvm-selectitem.md) -Nachricht ändern.

## <a name="item-information"></a>Element Informationen

Strukturansicht-Steuerelemente unterstützen eine Reihe von Nachrichten, die Informationen zu Elementen im Steuerelement abrufen.

Die [**TVM \_ GetItem**](tvm-getitem.md) -Nachricht kann das Handle und die Attribute eines Elements abrufen. Die Attribute eines Elements enthalten seinen aktuellen Zustand, die Indizes in der Bildliste des Steuer Elements der ausgewählten und nicht ausgewählten Bitmapbilder des Elements, ein Flag, das angibt, ob das Element über untergeordnete Elemente verfügt, die Adresse der Zeichenfolge des Elements und den von der Anwendung definierten 32-Bit-Wert des Elements.

Die [**TVM \_ GetNextItem**](tvm-getnextitem.md) -Meldung Ruft das Struktur Ansichts Element ab, das die angegebene Beziehung zum aktuellen Element trägt. Die Nachricht kann das übergeordnete Element eines Elements, das nächste oder vorherige sichtbare Element, das erste untergeordnete Element usw. abrufen.

Die [**TVM \_ GetItemRect**](tvm-getitemrect.md) -Meldung Ruft das umgebende Rechteck für ein Struktur Ansichts Element ab. Die [**TVM \_ GetCount**](tvm-getcount.md) -und [**TVM \_ GetVisibleCount**](tvm-getvisiblecount.md) -Meldungen rufen die Anzahl der Elemente in einem Strukturansicht-Steuerelement und die Anzahl der Elemente ab, die im Fenster des Strukturansicht-Steuer Elements vollständig sichtbar sein können. Sie können sicherstellen, dass ein bestimmtes Element sichtbar ist, indem Sie die [**TVM \_ EnsureVisible**](tvm-ensurevisible.md) -Meldung verwenden.

## <a name="tree-view-image-lists"></a>Tree-View Bildlisten

Jedem Element in einem Strukturansicht-Steuerelement können vier bitzugeordnete Bilder zugeordnet werden.

-   Ein Bild, z. b. ein offener Ordner, der angezeigt wird, wenn das Element ausgewählt wird.
-   Ein Bild, z. b. ein geschlossener Ordner, der angezeigt wird, wenn das Element nicht ausgewählt ist.
-   Ein Überlagerungs Bild, das transparent über das ausgewählte oder nicht ausgewählte Bild gezeichnet wird.
-   Ein Zustands Bild, bei dem es sich um ein zusätzliches Bild handelt, das links neben dem ausgewählten oder nicht ausgewählten Bild angezeigt wird. Sie können Zustands Bilder, wie z. b. aktivierte und gelöschte Kontrollkästchen, verwenden, um Anwendungs definierte Element Zustände anzugeben.

Standardmäßig werden von einem Strukturansicht-Steuerelement keine Element Bilder angezeigt. Zum Anzeigen von Element Bildern müssen Sie Bildlisten erstellen und Sie dem Steuerelement zuordnen. Weitere Informationen zu Bildlisten finden Sie unter [Bildlisten](image-lists.md).

Ein Strukturansicht-Steuerelement kann über zwei Bildlisten verfügen: eine normale Bildliste und eine Status Bild Liste. In einer normalen Bildliste werden die ausgewählten, nicht ausgewählten und Überlagerungs Bilder gespeichert. In einer Status Bild Liste werden Zustands Bilder gespeichert. Verwenden Sie die Create-Funktion von [**ImageList \_**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_create) , um eine Bildliste zu erstellen, und verwenden Sie andere Bildauflistungs Funktionen, um der Bildliste Bitmaps hinzuzufügen. Um dann die Bildliste dem Strukturansicht-Steuerelement zuzuordnen, verwenden Sie die [**TVM-Meldung " \_ SetImageList**](tvm-setimagelist.md) ". Die [**TVM \_ GetImageList**](tvm-getimagelist.md) -Meldung Ruft ein Handle für eine der Bildlisten eines Strukturansicht-Steuer Elements ab. Diese Meldung ist nützlich, wenn Sie der Liste weitere Bilder hinzufügen müssen.

Zusätzlich zu den ausgewählten und nicht ausgewählten Images kann die normale Bildliste eines Strukturansicht-Steuer Elements bis zu vier Überlagerungs Bilder enthalten. Überlagerungs Bilder werden von einem 1-basierten Index identifiziert und sind so konzipiert, dass Sie transparent über die ausgewählten und nicht ausgewählten Images gezeichnet werden. Um einen Überlagerungs Masken Index einem Bild in der normalen Bildliste zuzuweisen, müssen Sie die [**ImageList-Funktion " \_ SetImage**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_setoverlayimage) " aufzurufen.

Standardmäßig wird für alle Elemente das erste Bild in der normalen Bildliste für den ausgewählten und den nicht ausgewählten Zustand angezeigt. Außerdem werden in Elementen standardmäßig keine Überlagerungs Bilder oder Zustands Bilder angezeigt. Sie können diese Standardverhalten für ein Element ändern, indem Sie die [**TVM \_ InsertItem**](tvm-insertitem.md) -oder [**TVM \_**](tvm-setitem.md) -Nachricht senden. Diese Nachrichten verwenden die [**tvitem**](/windows/win32/api/commctrl/ns-commctrl-tvitema) -Struktur, um Bildlisten Indizes für ein Element festzulegen.

Legen Sie die tvif \_ SelectedImage-und tvif- \_ Bildbits im **Mask** -Member der [**tvitem**](/windows/win32/api/commctrl/ns-commctrl-tvitema) -Struktur fest, und geben Sie Indizes aus der normalen Bildliste des Steuer Elements in den Membern " **iselectimage** " und " **iImage** " an, um die ausgewählten und nicht ausgewählten Images eines Elements anzugeben. Alternativ können Sie den Wert "I \_ imagecallback" in " **iselectimage** " und " **iImage** " angeben, anstatt Indizes anzugeben. Dies bewirkt, dass das Steuerelement jedes Mal, wenn das Element neu gezeichnet wird, sein übergeordnetes Fenster für einen Bildlisten Index abfragt. Das-Steuerelement sendet die [TVN \_ getdispinfo](tvn-getdispinfo.md) -Benachrichtigungs Meldung, um den Index abzurufen.

Um ein Überlagerungs Bild einem Element zuzuordnen, verwenden Sie das [**indexyoverlaymask**](/windows/desktop/api/Commctrl/nf-commctrl-indextooverlaymask) -Makro, um einen Überlagerungs Masken Index im **State** -Member der [**tvitem**](/windows/win32/api/commctrl/ns-commctrl-tvitema) -Struktur des Elements anzugeben. Sie müssen auch die [**Tvis- \_ overlaymask**](tree-view-control-item-states.md) -Bits im **Status Ask** -Member festlegen. Überlagerungs Masken Indizes sind 1-basiert. ein Index von NULL gibt an, dass kein Überlagerungs Bild angegeben wurde.

Zustands Bilder werden in einer separaten Zustands Image Liste gespeichert und durch ihren Index identifiziert. Um die Status Bild Liste anzugeben, senden Sie eine TVM-Meldung " [**\_ SetImageList**](tvm-setimagelist.md) ". Im Gegensatz zum Listenansicht-Steuerelement, das einen 1-basierten Index zum Identifizieren von Zustands Bildern verwendet, werden Strukturansicht-Steuerelement Zustands Bilder durch einen NULL basierten Index identifiziert. Ein Index mit der Größe 0 (null) gibt jedoch an, dass das Element nicht über ein Zustands Bild verfügt. Folglich kann Image NULL nicht als Zustands Bild verwendet werden. Weitere Informationen zu Element Zuständen und Zustands Bildern finden Sie Unterstruktur [Ansicht Element Zustände (Übersicht](#tree-view-item-states-overview)).

## <a name="drag-and-drop-operations"></a>Drag & Drop-Vorgänge

Ein Strukturansicht-Steuerelement benachrichtigt das übergeordnete Fenster, wenn der Benutzer mit dem Ziehen eines Elements beginnt. Das übergeordnete Fenster empfängt eine [TVN \_ BeginDrag](tvn-begindrag.md) -Benachrichtigungs Meldung, wenn der Benutzer mit dem Ziehen eines Elements mit der linken Maustaste beginnt und eine [TVN \_ beginrdrag](tvn-beginrdrag.md) -Benachrichtigungs Meldung angezeigt wird, wenn der Benutzer mit der rechten Maustaste loslässt. Sie können verhindern, dass ein Strukturansicht-Steuerelement diese Benachrichtigungen sendet, indem Sie dem Strukturansicht-Steuerelement den Stil " [**\_ disabledragdrop**](tree-view-control-window-styles.md) " des-Steuer Elements geben

Sie erhalten ein Bild, das während eines Zieh Vorgangs mithilfe der TVM-Meldung " [**\_ fiatedragimage**](tvm-createdragimage.md) " angezeigt wird. Das Strukturansicht-Steuerelement erstellt eine Zieh Bitmap auf der Grundlage der Bezeichnung des gezogenen Elements. Dann erstellt das Strukturansicht-Steuerelement eine Bildliste, fügt Sie der Bitmap hinzu und gibt das Handle für die Bildliste zurück.

Sie müssen den Code bereitstellen, der das Element tatsächlich zieht. Dies umfasst in der Regel die Verwendung der Zieh Funktionen der Abbild Listen Funktionen und die Verarbeitung der Nachrichten [**WM \_ mousmove**](/windows/desktop/inputdev/wm-mousemove) und [**WM \_ lbuttonup**](/windows/desktop/inputdev/wm-lbuttonup) (oder [**WM \_ rbuttonup**](/windows/desktop/inputdev/wm-rbuttonup)), die an das übergeordnete Fenster gesendet werden, nachdem der Zieh Vorgang begonnen wurde.

Wenn Elemente in einem Strukturansicht-Steuerelement die Ziele von Drag & Drop-Vorgängen sind, müssen Sie wissen, wenn sich der Mauszeiger auf einem Ziel Element befindet. Mithilfe der [**TVM- \_ HitTest**](tvm-hittest.md) -Meldung können Sie herausfinden. Sie geben die Adresse einer [**TVHITTESTINFO**](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo) -Struktur an, die die aktuellen Koordinaten des Mauszeigers enthält. Wenn die [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) -Funktion zurückgegeben wird, enthält die-Struktur ein Flag, das die Position des Mauszeigers relativ zum Strukturansicht-Steuerelement angibt. Wenn sich der Zeiger über einem Element im Strukturansicht-Steuerelement befindet, enthält die Struktur auch das Handle für das Element.

Sie können angeben, dass ein Element das Ziel eines Drag & Drop-Vorgangs ist. verwenden Sie dazu die [**TVM \_ SetItem**](tvm-setitem.md) -Meldung, um den Status auf den durch [**Tvis fest \_ gelegten Wert**](tree-view-control-item-states.md) festzulegen. Ein Element mit diesem Zustand wird in dem Format gezeichnet, mit dem ein Drag & Drop-Ziel angegeben wird.

## <a name="tree-view-control-notification-messages"></a>Benachrichtigungs Meldungen zur Tree-View Steuerung

Ein Strukturansicht-Steuerelement sendet die folgenden Benachrichtigungs Meldungen in Form von WM-Benachrichtigungs Meldungen an das übergeordnete Fenster. [**\_**](wm-notify.md)



| Benachrichtigung                                    | Beschreibung                                                                            |
|-------------------------------------------------|----------------------------------------------------------------------------------------|
| [TVN \_ BeginDrag](tvn-begindrag.md)             | Signalisiert den Anfang eines Drag & Drop-Vorgangs.                                        |
| [TVN \_ beginlabeledit](tvn-beginlabeledit.md)   | Signalisiert den Start der direkten Bezeichnungs Bearbeitung.                                           |
| [TVN \_ beginrdrag](tvn-beginrdrag.md)           | Signalisiert, dass die Rechte Maustaste einen Drag & Drop-Vorgang gestartet hat.             |
| [TVN \_ DeleteItem](tvn-deleteitem.md)           | Signalisiert das Löschen eines bestimmten Elements.                                               |
| [TVN \_ endlabeledit](tvn-endlabeledit.md)       | Signalisiert das Ende der Bezeichnungs Bearbeitung.                                                      |
| [TVN \_ getdispinfo](tvn-getdispinfo.md)         | Fordert Informationen an, die vom Strukturansicht-Steuerelement zum Anzeigen eines Elements benötigt werden.           |
| [TVN \_ itemexpanded](tvn-itemexpanded.md)       | Signalisiert, dass die Liste der untergeordneten Elemente eines übergeordneten Elements erweitert oder reduziert wurde.            |
| [TVN \_ itemexpanding](tvn-itemexpanding.md)     | Signalisiert, dass die Liste der untergeordneten Elemente eines übergeordneten Elements im Begriff ist, erweitert oder reduziert zu werden. |
| [TVN- \_ KeyDown](tvn-keydown.md)                 | Signalisiert ein Tastaturereignis.                                                              |
| [TVN \_ selchanged](tvn-selchanged.md)           | Signalisiert, dass sich die Auswahl von einem Element in ein anderes geändert hat.                       |
| [Auswahl von TVN \_](tvn-selchanging.md)         | Signalisiert, dass die Auswahl im Begriff ist, von einem Element in ein anderes zu ändern.            |
| [TVN \_ setdispinfo](tvn-setdispinfo.md)         | Benachrichtigt ein übergeordnetes Fenster, dass es die Informationen aktualisieren muss, die für ein Element verwaltet werden. |



 

## <a name="default-tree-view-control-message-processing"></a>Standardmäßige Tree-View Steuerung der Nachrichtenverarbeitung

In diesem Abschnitt wird die Fenster Nachrichtenverarbeitung beschrieben, die von einem Strukturansicht-Steuerelement ausgeführt wird. Nachrichten, die für Strukturansicht-Steuerelemente spezifisch sind, werden in anderen Abschnitten dieses Dokuments erläutert, sodass Sie hier nicht enthalten sind.



| `Message`                                            | Verarbeitung wird ausgeführt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**WM- \_ Befehl**](/windows/desktop/menurc/wm-command)               | Verarbeitet die Benachrichtigungs Meldungen " [en \_ Update](en-update.md) " und " [en \_ killfocus](en-killfocus.md) Edit Control" und leitet alle anderen Bearbeitungs Steuerelement Benachrichtigungen an das übergeordnete Fenster weiter. Es ist kein Rückgabewert vorhanden.                                                                                                                                                                                                                                                                                                |
| [**WM \_ Erstellen**](/windows/desktop/winmsg/wm-create)                 | Weist Speicher zu und initialisiert interne Datenstrukturen. Andernfalls wird NULL zurückgegeben, wenn erfolgreich, andernfalls-1.                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**WM \_ zerstören**](/windows/desktop/winmsg/wm-destroy)               | Gibt alle dem Steuerelement zugeordneten Systemressourcen frei. Gibt 0 (null) zurück.                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**WM \_ aktivieren**](/windows/desktop/winmsg/wm-enable)                 | Aktiviert oder deaktiviert das Steuerelement.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**WM- \_ erasebkgnd**](/windows/desktop/winmsg/wm-erasebkgnd)         | Löscht den Fenster Hintergrund mithilfe der aktuellen Hintergrundfarbe für das Strukturansicht-Steuerelement. Sie gibt **true** zurück.                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**WM \_ getdlgcode**](/windows/desktop/dlgbox/wm-getdlgcode)         | Gibt eine Kombination der dlgc \_ -wantpfeile-und dlgc- \_ wantchars-Werte zurück.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**WM- \_ getFont**](/windows/desktop/winmsg/wm-getfont)               | Gibt das Handle für die Schriftart der aktuellen Bezeichnung zurück.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [**WM- \_ HScroll**](wm-hscroll.md)                  | Führt im Strukturansicht-Steuerelement einen Bildlauf durch. Gibt **true** zurück, wenn ein Bildlauf durchgeführt wird, andernfalls **false** .                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**WM- \_ KeyDown**](/windows/desktop/inputdev/wm-keydown)             | Sendet die [TVN- \_ KeyDown](tvn-keydown.md) -Benachrichtigungs Meldung an das übergeordnete Fenster aller Schlüssel. Sendet die nm-Benachrichtigungs Meldung [ \_ (Strukturansicht)](nm-return-tree-view-.md) , wenn der Benutzer die EINGABETASTE drückt. Die Einfügemarke wird verschoben, wenn der Benutzer die Richtungs Tasten drückt, bzw. die Bild-auf, Bild-ab-, Start-, End-oder RÜCKTASTE. Sie führt einen Bildlauf im Strukturansicht-Steuerelement durch, wenn der Benutzer die STRG-Taste in Kombination mit diesen Schlüsseln drückt. Andernfalls wird **true** zurückgegeben, wenn eine Taste verarbeitet wird, andernfalls **false** . |
| [**WM- \_ killfokus**](/windows/desktop/inputdev/wm-killfocus)         | Zeichnet das fokussierte Element ggf. neu und sendet eine [nm- \_ killfocus](nm-killfocus-tree-view.md) -Benachrichtigungs Meldung (Strukturansicht) an das übergeordnete Fenster.                                                                                                                                                                                                                                                                                                                                                                  |
| [**WM \_ lbuttondblclk**](/windows/desktop/inputdev/wm-lbuttondblclk) | Bricht die Bezeichnungs Bearbeitung ab und sendet, wenn auf ein Element Doppel geklickt wurde, die [nm- \_ dblclk](nm-dblclk-tree-view.md) -Benachrichtigungs Meldung (Strukturansicht) an das übergeordnete Fenster. Wenn das übergeordnete Fenster 0 zurückgibt, schaltet das Strukturansicht-Steuerelement den erweiterten Zustand des Elements um und sendet das übergeordnete Fenster die [TVN \_ itemexpandate](tvn-itemexpanding.md) -und [TVN \_ itemexpanded](tvn-itemexpanded.md) -Benachrichtigungs Meldungen. Es ist kein Rückgabewert vorhanden.                                                                             |
| [**WM \_ lbuttondown**](/windows/desktop/inputdev/wm-lbuttondown)     | Schaltet den erweiterten Zustand um, wenn der Benutzer auf die Schaltfläche geklickt hat, die einem übergeordneten Element zugeordnet ist. Wenn der Benutzer auf eine Element Bezeichnung geklickt hat, wählt das Strukturansicht-Steuerelement den Fokus aus und legt den Fokus auf das Element fest. Wenn der Benutzer die Maus vor dem Loslassen der Maustaste bewegt, startet das Strukturansicht-Steuerelement einen Drag & Drop-Vorgang. Es ist kein Rückgabewert vorhanden.                                                                                                                                                                          |
| [**WM- \_ Paint**](/windows/desktop/gdi/wm-paint)                      | Zeichnet den ungültigen Bereich des Strukturansicht-Steuer Elements. Gibt 0 (null) zurück. Wenn der *wParam* -Parameter ungleich **null** ist, geht das Steuerelement davon aus, dass es sich bei dem Wert um ein Handle für einen Gerätekontext (HDC) und zeichnet, die diesen Gerätekontext verwenden.                                                                                                                                                                                                                                                                                      |
| [**WM- \_ rbuttondown**](/windows/desktop/inputdev/wm-rbuttondown)     | Prüft, ob auf ein Element geklickt wurde und ein Zieh Vorgang begonnen wurde. Wenn der Vorgang begonnen hat, sendet er eine [TVN \_ beginrdrag](tvn-beginrdrag.md) -Benachrichtigungs Meldung an das übergeordnete Fenster und hebt das Ablage Ziel hervor. Andernfalls sendet Sie eine [nm \_ rclick](nm-rclick-tree-view.md) -Benachrichtigungs Meldung (Strukturansicht) an das übergeordnete Fenster. Es ist kein Rückgabewert vorhanden.                                                                                                                                           |
| [**WM- \_ SetFocus**](/windows/desktop/inputdev/wm-setfocus)           | Zeichnet das fokussierte Element ggf. neu und sendet eine [nm- \_ SetFocus](nm-setfocus.md) -Benachrichtigungs Meldung an das übergeordnete Fenster.                                                                                                                                                                                                                                                                                                                                                                                          |
| [**WM- \_ setFont**](/windows/desktop/winmsg/wm-setfont)               | Speichert das angegebene Schriftart Handle und zeichnet das Strukturansicht-Steuerelement mithilfe der neuen Schriftart neu.                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**WM \_ -Ziel**](/windows/desktop/gdi/wm-setredraw)              | Legt das Flag zum Umzeichnen fest oder löscht dieses. Das Strukturansicht-Steuerelement wird neu gezeichnet, nachdem das neu zeichnen-Flag festgelegt wurde. Gibt 0 (null) zurück.                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**WM- \_ Größe**](/windows/desktop/winmsg/wm-size)                     | Berechnet interne Variablen neu, die von der Größe des Client Bereichs des Strukturansicht-Steuer Elements abhängig sind. Sie gibt **true** zurück.                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**WM- \_ StyleChanged**](/windows/desktop/winmsg/wm-stylechanged)     | Bricht die Bezeichnungs Bearbeitung ab und zeichnet das Strukturansicht-Steuerelement mithilfe der neuen Stile neu. Gibt 0 (null) zurück.                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**WM- \_ syscolorchange**](/windows/desktop/gdi/wm-syscolorchange)    | Zeichnet das Strukturansicht-Steuerelement mithilfe der neuen Farbe neu, wenn das neu zeichnen-Flag festgelegt ist. Es ist kein Rückgabewert vorhanden.                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**WM- \_ Timer**](/windows/desktop/winmsg/wm-timer)                   | Beginnt, eine Element Bezeichnung zu bearbeiten. Wenn der Benutzer auf die Bezeichnung des Fokus Elements klickt, legt das Strukturansicht-Steuerelement einen Timer fest, anstatt sofort in den Bearbeitungsmodus zu wechseln. Der Timer ermöglicht es, dass die Strukturansicht nicht in den Bearbeitungsmodus wechselt, wenn der Benutzer auf die Bezeichnung doppelklickt. Gibt 0 (null) zurück.                                                                                                                                                                                                                       |
| [**WM- \_ VScroll**](wm-vscroll.md)                  | Führt im Strukturansicht-Steuerelement einen Bildlauf durch. Gibt **true** zurück, wenn ein Bildlauf durchgeführt wird, andernfalls **false** .                                                                                                                                                                                                                                                                                                                                                                                                                     |



 

## <a name="related-topics"></a>Zugehörige Themen

<dl> <dt>

[Beispiel: custdtv veranschaulicht benutzerdefiniertes Zeichnen in einer TreeView (Q248496)](https://support.microsoft.com/default.aspx?scid=kb;EN-US;q248496)
</dt> </dl>

 

 