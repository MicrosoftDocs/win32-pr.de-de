---
title: Informationen Tree-View Steuerelementen
description: Ein Strukturansicht-Steuerelement ist ein Fenster, in dem eine hierarchische Liste von Elementen angezeigt wird, z. B. die Überschriften in einem Dokument, die Einträge in einem Index oder die Dateien und Verzeichnisse auf einem Datenträger.
ms.assetid: 10cc7949-dd77-412d-bad1-db8d8a049582
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5ea08743a7ac138a6cea5f766dd91aee2ec714acc2d4c8b98e1f2bee26c42ff9
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/11/2021
ms.locfileid: "119769812"
---
# <a name="about-tree-view-controls"></a>Informationen Tree-View Steuerelementen

Ein Strukturansicht-Steuerelement ist ein Fenster, in dem eine hierarchische Liste von Elementen angezeigt wird, z. B. die Überschriften in einem Dokument, die Einträge in einem Index oder die Dateien und Verzeichnisse auf einem Datenträger. Jedes Element besteht aus einer Bezeichnung und einem optionalen Bitmapbild, und jedem Element kann eine Liste von Unteritems zugeordnet sein. Durch Klicken auf ein Element kann der Benutzer die zugeordnete Liste der Unteritems erweitern oder reduzieren.

Die folgende Abbildung zeigt ein einfaches Strukturansicht-Steuerelement mit einem Stammknoten, einem erweiterten Knoten und einem reduzierten Knoten. Das -Steuerelement verwendet eine Bitmap für das ausgewählte Element und eine andere Bitmap für andere Elemente.

![Screenshot, der fünf Knoten in einer Hierarchie zeigt; Der Text eines Knotens ist ausgewählt, aber Knoten sind nicht durch Zeilen miteinander verknüpft.](images/tv-simple.png)

Nach dem Erstellen eines Strukturansicht-Steuerelements können Sie Elemente hinzufügen, entfernen, anordnen oder anderweitig bearbeiten, indem Sie Nachrichten an das Steuerelement senden. Jede Nachricht verfügt über ein oder mehrere entsprechende Makros, die Sie verwenden können, anstatt die Nachricht explizit zu senden.

Die folgenden Themen werden in diesem Abschnitt erläutert.

-   [Strukturansichtsstile](#tree-view-styles)
-   [Übergeordnete und untergeordnete Elemente](#parent-and-child-items)
-   [Elementbezeichnungen](#item-labels)
-   [Bearbeiten von Strukturansichtsbezeichnungen](#tree-view-label-editing)
-   [Position des Strukturansichtselements](#tree-view-item-position)
-   [Übersicht über Elementzustände in Strukturansichten](#tree-view-item-states-overview)
-   [Elementauswahl](#item-selection)
-   [Elementinformationen](#item-information)
-   [Strukturansicht– Bildlisten](#tree-view-image-lists)
-   [Drag-and-Drop Operations](#drag-and-drop-operations)
-   [Benachrichtigungsmeldungen zu Steuerelementen in Strukturansichten](#tree-view-control-notification-messages)
-   [Standardeinstellung Tree-View Steuern der Nachrichtenverarbeitung](#default-tree-view-control-message-processing)
-   [Zugehörige Themen](#related-topics)

## <a name="tree-view-styles"></a>Tree-View Formatvorlagen

Strukturansichtsstile steuern Aspekte der Darstellung eines Strukturansicht-Steuerelements. Sie legen die anfänglichen Stile fest, wenn Sie das Strukturansicht-Steuerelement erstellen. Sie können die Stile abrufen und ändern, nachdem Sie das Strukturansicht-Steuerelement mithilfe der [**Funktionen GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) und [**SetWindowLong erstellt**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) haben.

Der [**TVS \_ HASLINES-Stil**](tree-view-control-window-styles.md) verbessert die grafische Darstellung der Hierarchie eines Strukturansichtssteuerelements, indem Linien gezeichnungt werden, die untergeordnete Elemente mit ihrem übergeordneten Element verknüpfen, wie in der folgenden Abbildung dargestellt.

![Screenshot, der die vorherige Anordnung zeigt, aber mit Linien, die die Knoten verbinden; Die erste Zeile wird vom Stammknoten absteigend](images/tv-haslines.png)

Dieser Stil selbst zeichnen keine Linien am Stamm der Hierarchie. Dazu müssen Sie die [**TVS \_ HASLINES-**](tree-view-control-window-styles.md) und [**TVS \_ LINESATROOT-Stile**](tree-view-control-window-styles.md) kombinieren. Das Ergebnis wird in der folgenden Abbildung dargestellt.

![Screenshot der vorherigen Anordnung, jedoch mit einer zusätzlichen horizontalen Linie, die zum Stammknoten führt](images/tv-rootlines.png)

Der Benutzer kann die Liste der untergeordneten Elemente eines übergeordneten Elements erweitern oder reduzieren, indem er auf das übergeordnete Element doppelklickt. Ein Strukturansicht-Steuerelement mit dem [**TVS \_ HASBUTTONS-Stil**](tree-view-control-window-styles.md) fügt links neben jedem übergeordneten Element eine Schaltfläche hinzu. Der Benutzer kann einmal auf die Schaltfläche klicken, anstatt auf das übergeordnete Element zu doppelklicken, um das untergeordnete Element zu erweitern oder zu reduzieren. **TVS \_ HASBUTTONS** fügt Elementen im Stammverzeichnis der Hierarchie keine Schaltflächen hinzu. Dazu müssen Sie [**TVS \_ HASLINES,**](tree-view-control-window-styles.md) [**TVS \_ LINESATROOT**](tree-view-control-window-styles.md)und **TVS \_ HASBUTTONS kombinieren.** Diese Kombination von Stilen ist in der folgenden Abbildung dargestellt.

![Screenshot der vorherigen Anordnung, jedoch mit Schaltflächen zum Erweitern/Reduzieren an jedem Scheitelpunkt mit zwei Linien](images/tv-hasbuttons.png)

Der [**TVS \_ CHECKBOXES-Stil**](tree-view-control-window-styles.md) erstellt Kontrollkästchen neben jedem Element. Wenn Sie den Kontrollkästchenstil verwenden möchten, müssen Sie das **TVS \_ CHECKBOXES-Format** (mit [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga)) festlegen, nachdem Sie das Strukturansichtssteuerfeld erstellt und die Struktur aufgefüllt haben. Andernfalls werden die Kontrollkästchen je nach Zeitsteuerungsproblemen möglicherweise deaktiviert angezeigt. Die folgende Abbildung zeigt den Kontrollkästchenstil.

![Screenshot der vorherigen Anordnung, jedoch mit einem Kontrollkästchen neben jedem Knoten; Zwei der Kontrollkästchen sind aktiviert.](images/tv-haschecks.png)

Der [**TVS \_ FULLROWSELECT-Stil**](tree-view-control-window-styles.md) bewirkt, dass sich die Auswahlmarkung nicht nur über das Element selbst, sondern über die gesamte Breite des Steuerelements erstreckt. Die folgende Abbildung zeigt diesen Stil.

![Screenshot, der die ursprüngliche Anordnung von fünf Knoten ohne Linien zeigt, aber die Hervorhebung der Auswahl erweitert die gesamte Breite des Steuerelements.](images/tv-fullrow.png)

Der [**TVS \_ EDITLABELS-Stil**](tree-view-control-window-styles.md) ermöglicht es dem Benutzer, die Bezeichnungen von Strukturansichtselementen zu bearbeiten. Weitere Informationen zum Bearbeiten von Bezeichnungen finden Sie unter [Bearbeiten von Strukturansichtsbezeichnungen.](#tree-view-label-editing)

Weitere Informationen zu diesen und anderen Stilen finden Sie unter [Strukturansicht-Steuerelement-Fensterstile.](tree-view-control-window-styles.md)

## <a name="parent-and-child-items"></a>Übergeordnete und untergeordnete Elemente

Jedem Element in einem Strukturansicht-Steuerelement kann eine Liste von Unterelementen , die als untergeordnete Elemente bezeichnet *werden,* zugeordnet sein. Ein Element, das über mindestens ein untergeordnetes Element verfügt, wird als *übergeordnetes Element bezeichnet.* Ein untergeordnetes Element wird unter seinem übergeordneten Element angezeigt und eingezogen, um anzugeben, dass es dem übergeordneten Element untergeordnet ist. Ein Element ohne übergeordnetes Element wird oben in der Hierarchie angezeigt und als *Stammelement bezeichnet.*

Um einem Strukturansichtssteuerelement ein Element hinzuzufügen, senden Sie die [**TVM \_ INSERTITEM-Meldung**](tvm-insertitem.md) an das Steuerelement. Die Meldung gibt ein Handle an den HTREEITEM-Typ zurück, der das Element eindeutig identifiziert. Beim Hinzufügen eines Elements müssen Sie das Handle für das übergeordnete Element des neuen Elements angeben. Wenn Sie **NULL oder** den TVI ROOT-Wert anstelle eines übergeordneten Elementhandpunkts in der \_ [**TVINSERTSTRUCT-Struktur**](/windows/win32/api/commctrl/ns-commctrl-tvinsertstructa) angeben, wird das Element als Stammelement hinzugefügt.

Der Status der Liste untergeordneter Elemente eines übergeordneten Elements kann jederzeit erweitert oder reduziert werden. Wenn der Zustand erweitert wird, werden die untergeordneten Elemente unter dem übergeordneten Element angezeigt. Wenn es reduziert wird, werden die untergeordneten Elemente nicht angezeigt. Die Liste wird automatisch zwischen dem erweiterten und reduzierten Zustände umschalten, wenn der Benutzer auf das übergeordnete Element doppelklickt oder wenn das übergeordnete Element über das [**FORMAT \_ TVS HASBUTTONS**](tree-view-control-window-styles.md) verfügt, wenn der Benutzer auf die schaltfläche klickt, die dem übergeordneten Element zugeordnet ist. Eine Anwendung kann die untergeordneten Elemente mithilfe der [**MELDUNG TVM \_ EXPAND erweitern oder reduzieren.**](tvm-expand.md)

Ein Strukturansicht-Steuerelement sendet dem übergeordneten Fenster eine [TVN \_ ITEMEXPANDING-Benachrichtigungsmeldung,](tvn-itemexpanding.md) wenn die Liste der untergeordneten Elemente eines übergeordneten Elements erweitert oder reduziert werden soll. Die Benachrichtigung gibt einer Anwendung die Möglichkeit, die Änderung zu verhindern oder Attribute des übergeordneten Elements, die vom Status der Liste der untergeordneten Elemente abhängen, zu festlegen. Nach dem Ändern des Status der Liste sendet das Strukturansicht-Steuerelement dem übergeordneten Fenster eine [TVN \_ ITEMEXPANDED-Benachrichtigungsmeldung.](tvn-itemexpanded.md)

Wenn eine Liste untergeordneter Elemente erweitert wird, wird sie relativ zum übergeordneten Element eingerückt. Sie können die Einzugsmenge mithilfe der [**TVM \_ SETINDENT-Nachricht**](tvm-setindent.md) festlegen oder den aktuellen Betrag mithilfe der [**TVM \_ GETINDENT-Nachricht**](tvm-getindent.md) abrufen.

Ein Strukturansicht-Steuerelement verwendet Arbeitsspeicher, der aus dem Heap des Prozesses zugeordnet wird, der das Strukturansicht-Steuerelement erstellt. Die maximale Anzahl von Elementen in einer Strukturansicht basiert auf der Im Heap verfügbaren Arbeitsspeichermenge.

## <a name="item-labels"></a>Elementbezeichnungen

In der Regel geben Sie den Text der Bezeichnung eines Elements an, wenn Sie das Element dem Strukturansicht-Steuerelement hinzufügen. Die [**TVM \_ INSERTITEM-Nachricht**](tvm-insertitem.md) enthält eine [**TVITEM-Struktur,**](/windows/win32/api/commctrl/ns-commctrl-tvitema) die die Eigenschaften des Elements definiert, einschließlich einer Zeichenfolge, die den Text der Bezeichnung enthält.

Ein Strukturansicht-Steuerelement ordnet Arbeitsspeicher zum Speichern der einzelnen Elemente zu. Der Text der Elementbezeichnungen nimmt einen erheblichen Teil dieses Arbeitsspeichers ein. Wenn Ihre Anwendung eine Kopie der Zeichenfolgen im Strukturansicht-Steuerelement verwaltet, können Sie die Arbeitsspeicheranforderungen des Steuerelements verringern, indem Sie den LPSTR \_ TEXTCALLBACK-Wert im **pszText-Member** von [**TVITEM**](/windows/win32/api/commctrl/ns-commctrl-tvitema) angeben, anstatt tatsächliche Zeichenfolgen an die Strukturansicht zu übergeben. Die Verwendung von LPSTR TEXTCALLBACK bewirkt, dass das Strukturansichtssteuerelement den Text der Bezeichnung eines Elements aus dem übergeordneten Fenster abruft, wenn das Element \_ neu gezeichnet werden muss. Um den Text abzurufen, sendet das Strukturansicht-Steuerelement eine [TVN GETDISPINFO-Benachrichtigungsmeldung, \_](tvn-getdispinfo.md) die die Adresse einer [**NMTVDISPINFO-Struktur**](/windows/win32/api/commctrl/ns-commctrl-nmtvdispinfoa) enthält. Das übergeordnete Fenster muss die entsprechenden Member der eingeschlossenen -Struktur ausfüllen.

## <a name="tree-view-label-editing"></a>Tree-View Beschriftungsbearbeitung

Der Benutzer kann die Bezeichnungen von Elementen direkt in einem Strukturansicht-Steuerelement bearbeiten, das über den [**\_ TVS-Stil EDITLABELS**](tree-view-control-window-styles.md) verfügt. Der Benutzer beginnt mit der Bearbeitung, indem er auf die Bezeichnung des Elements klickt, das den Fokus besitzt. Eine Anwendung beginnt mit der Bearbeitung mithilfe der [**\_ TVM-Nachricht EDITLABEL.**](tvm-editlabel.md) Das Strukturansicht-Steuerelement benachrichtigt das übergeordnete Fenster, wenn die Bearbeitung beginnt und wenn es abgebrochen oder abgeschlossen wird. Wenn die Bearbeitung abgeschlossen ist, ist das übergeordnete Fenster für die Aktualisierung der Bezeichnung des Elements verantwortlich, falls dies erforderlich ist.

Wenn die Bearbeitung von Bezeichnungen beginnt, sendet ein Strukturansicht-Steuerelement dem übergeordneten Fenster eine [TVN \_ BEGINLABELEDIT-Benachrichtigungsmeldung.](tvn-beginlabeledit.md) Durch die Verarbeitung dieser Benachrichtigung kann eine Anwendung die Bearbeitung einiger Bezeichnungen zulassen und die Bearbeitung anderer verhindern. Die Rückgabe von 0 (null) ermöglicht die Bearbeitung, und die Rückgabe ungleich 0 verhindert dies.

Wenn die Bearbeitung von Bezeichnungen abgebrochen oder abgeschlossen wird, sendet ein Strukturansicht-Steuerelement dem übergeordneten Fenster eine [TVN \_ ENDLABELEDIT-Benachrichtigungsmeldung.](tvn-endlabeledit.md) Der *lParam-Parameter* ist die Adresse einer [**NMTVDISPINFO-Struktur.**](/windows/win32/api/commctrl/ns-commctrl-nmtvdispinfoa) Der *Item-Parameter* ist eine [**TVITEM-Struktur,**](/windows/win32/api/commctrl/ns-commctrl-tvitema) die das Element identifiziert und den bearbeiteten Text enthält. Das übergeordnete Fenster ist dafür verantwortlich, die Bezeichnung des Elements zu aktualisieren, wenn die neue Bezeichnung erhalten bleiben soll. Das **pszText-Member** von **TVITEM** ist 0 (null), wenn die Bearbeitung abgebrochen wird.

Während der Bezeichnungsbearbeitung können Sie in der Regel als Reaktion auf die Benachrichtigungsmeldung [ \_ TVN BEGINLABELEDIT](tvn-beginlabeledit.md) das Handle für das Bearbeitungssteuerzeichen abrufen, das für die Bezeichnungsbearbeitung verwendet wird, indem Sie die [**TVM \_ GETEDITCONTROL-Meldung**](tvm-geteditcontrol.md) verwenden. Sie können dem Bearbeitungssteuerfeld eine [**EM \_ SETLIMITTEXT-Nachricht**](em-setlimittext.md) senden, um die Textmenge zu begrenzen, die ein Benutzer in das Bearbeitungssteuerfeld eingeben oder untergliedern kann, um ungültige Zeichen abzufangen und zu verwerfen. Beachten Sie jedoch, dass das Bearbeitungssteuerzeichen erst angezeigt wird, *nachdem* TVN \_ BEGINLABELEDIT gesendet wurde.

## <a name="tree-view-item-position"></a>Tree-View Elementposition

Die Anfangsposition eines Elements wird festgelegt, wenn das Element dem Strukturansicht-Steuerelement mithilfe der [**TVM \_ INSERTITEM-Meldung hinzugefügt**](tvm-insertitem.md) wird. Die Meldung enthält eine [**TVINSERTSTRUCT-Struktur,**](/windows/win32/api/commctrl/ns-commctrl-tvinsertstructa) die das Handle für das übergeordnete Element und das Handle für das Element angibt, nach dem das neue Element eingefügt werden soll. Das zweite Handle muss entweder ein untergeordnetes Element des angegebenen übergeordneten Elements oder einen der folgenden Werte identifizieren: TVI \_ FIRST, TVI \_ LAST oder TVI \_ SORT.

Wenn TVI FIRST oder TVI LAST angegeben wird, platziert das Strukturansicht-Steuerelement das neue Element am Anfang oder Ende der Liste der untergeordneten Elemente des angegebenen \_ \_ übergeordneten Elements. Wenn TVI SORT angegeben wird, fügt das Strukturansichtssteuerelement das neue Element basierend auf dem Text der Elementbezeichnungen in alphabetischer Reihenfolge in die Liste der \_ untergeordneten Elemente ein.

Sie können die Liste der untergeordneten Elemente eines übergeordneten Elements in alphabetischer Reihenfolge mithilfe der [**TVM \_ SORTCHILDREN-Meldung**](tvm-sortchildren.md) hinzufügen. Die Meldung enthält einen -Parameter, der angibt, ob alle Ebenen untergeordneter Elemente, die vom angegebenen übergeordneten Element absteigen, ebenfalls in alphabetischer Reihenfolge sortiert werden.

Mit [**der TVM \_ SORTCHILDRENCB-Nachricht**](tvm-sortchildrencb.md) können Sie untergeordnete Elemente anhand von Kriterien sortieren, die Sie definieren. Wenn Sie diese Meldung verwenden, geben Sie eine anwendungsdefinierte Rückruffunktion an, die das Strukturansicht-Steuerelement aufrufen kann, wenn die relative Reihenfolge von zwei untergeordneten Elementen festgelegt werden muss. Die Rückruffunktion empfängt zwei anwendungsdefinierte 32-Bit-Werte für die verglichenen Elemente und einen dritten 32-Bit-Wert, den Sie beim Senden von **TVM \_ SORTCHILDRENCB angeben.**

## <a name="tree-view-item-states-overview"></a>Tree-View Elementzustände – Übersicht

Jedes Element in einem Strukturansicht-Steuerelement hat einen aktuellen Zustand. Die Zustandsinformationen für jedes Element umfassen einen Satz von Bitflags sowie Bildlistenindizes, die das Statusbild und das Überlagerungsbild des Elements angeben. Die Bitflags geben an, ob das Element ausgewählt, deaktiviert, erweitert und so weiter ist. In den meisten Fällen legt ein Strukturansicht-Steuerelement automatisch den Zustand eines Elements fest, um Benutzeraktionen wie die Auswahl eines Elements widerzuleiten. Sie können den Zustand eines Elements jedoch auch mithilfe der [**TVM \_ SETITEM-Nachricht**](tvm-setitem.md) festlegen und den aktuellen Zustand eines Elements mithilfe der [**TVM \_ GETITEM-Nachricht**](tvm-getitem.md) abrufen. Eine vollständige Liste der Elementzustände finden Sie unter [Strukturansicht-Steuerelementelementzustände.](tree-view-control-item-states.md)

Der aktuelle Zustand eines Elements wird vom **Zustandselement** der [**TVITEM-Struktur**](/windows/win32/api/commctrl/ns-commctrl-tvitema) angegeben. Ein Strukturansicht-Steuerelement kann den Zustand eines Elements ändern, um eine Benutzeraktion widerzubeenden, z. B. das Auswählen des Elements oder das Festlegen des Fokus auf das Element. Darüber hinaus kann eine Anwendung den Zustand eines Elements ändern, um das Element zu deaktivieren oder auszublenden oder ein Überlagerungsbild oder ein Statusbild anzugeben.

Wenn Sie den Zustand eines Elements angeben oder ändern, gibt das **StateMask-Element** von  [**TVITEM**](/windows/win32/api/commctrl/ns-commctrl-tvitema) an, welche Zustandsbits festgelegt werden müssen, und das Zustandselement enthält die neuen Werte für diese Bits.

Zum Festlegen des Überlagerungsbilds eines Elements muss die Zustandsmaske  den [**TVIS \_ OVERLAYMASK-Wert**](tree-view-control-item-states.md) enthalten, und der Zustand muss den einbasierten Index des Überlagerungsbilds enthalten, das mithilfe des [**INDEXTOOVERLAYMASK-Makros**](/windows/desktop/api/Commctrl/nf-commctrl-indextooverlaymask) um 8 Bits nach links verschoben wurde.  Der Index kann 0 (null) sein, um kein Überlagerungsbild anzugeben.

Neben dem Symbol eines Elements wird ein Statusbild angezeigt, um einen anwendungsdefinierten Zustand anzugeben. Zustandsbilder sind in einer *Statusbildliste enthalten,* die durch Senden einer [**TVM \_ SETIMAGELIST-Nachricht angegeben**](tvm-setimagelist.md) wird. Um das Zustandsbild eines Elements zu festlegen, schließen Sie den [**TVIS \_ STATEIMAGEMASK-Wert**](tree-view-control-item-states.md) in das **StateMask-Element** der [**TVITEM-Struktur**](/windows/win32/api/commctrl/ns-commctrl-tvitema) ein. Die Bits 12 bis 15  des Zustandsmitglieds der Struktur geben den Index in der Statusbildliste des zu zeichneten Bilds an.

Verwenden Sie zum Festlegen des Statusbildindexes [**INDEXTOSTATEIMAGEMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextostateimagemask). Dieses Makro verwendet einen Index und legt die Bits 12 bis 15 entsprechend fest. Um anzugeben, dass das Element über kein Statusbild verfügt, legen Sie den Index auf 0 (null) fest. Diese Konvention bedeutet, dass das Bild 0 (null) in der Statusbildliste nicht als Zustandsbild verwendet werden kann. Verwenden Sie die [**TVIS \_ STATEIMAGEMASK-Maske,**](tree-view-control-item-states.md) um die Bits 12 bis 15 des Zustandsmitglieds zu isolieren.  Weitere Informationen zu Überlagerungs- und Zustandsbildern finden Sie unter [Tree-View Image Lists](#tree-view-image-lists).

## <a name="item-selection"></a>Elementauswahl

Ein Strukturansicht-Steuerelement benachrichtigt das übergeordnete Fenster, wenn sich die Auswahl von einem Element zu einem anderen ändert, indem die Benachrichtigungsmeldungen [TVN \_ SELCHANGING](tvn-selchanging.md) und [TVN \_ SELCHANGED](tvn-selchanged.md) gesendet werden. Beide Benachrichtigungen enthalten einen Wert, der angibt, ob die Änderung das Ergebnis eines Mausklicks oder einer Tastatureingabe ist. Die Benachrichtigungen enthalten auch Informationen über das Element, das die Auswahl erhalten soll, und das Element, das die Auswahl verliert. Mithilfe dieser Informationen können Sie Elementattribute festlegen, die vom Auswahlzustand des Elements abhängen. Die **Rückgabe von TRUE** als Reaktion auf TVN SELCHANGING verhindert, dass die Auswahl geändert wird, und die Rückgabe von \_ **FALSE** ermöglicht die Änderung.

Eine Anwendung kann die Auswahl ändern, indem sie die [**TVM \_ SELECTITEM-Nachricht**](tvm-selectitem.md) sendet.

## <a name="item-information"></a>Elementinformationen

Strukturansichtssteuerelemente unterstützen eine Reihe von Meldungen, die Informationen zu Elementen im Steuerelement abrufen.

Die [**TVM \_ GETITEM-Nachricht**](tvm-getitem.md) kann das Handle und die Attribute eines Elements abrufen. Zu den Attributen eines Elements gehören der aktuelle Zustand, die Indizes in der Bildliste des Steuerelements der ausgewählten und nicht ausgewählten Bitmapbilder des Elements, ein Flag, das angibt, ob das Element untergeordnete Elemente enthält, die Adresse der Bezeichnungszeichenfolge des Elements und der anwendungsdefinierte 32-Bit-Wert des Elements.

Die [**TVM \_ GETNEXTITEM-Nachricht**](tvm-getnextitem.md) ruft das Strukturansichtselement ab, das die angegebene Beziehung zum aktuellen Element trägt. Die Nachricht kann das übergeordnete Element eines Elements, das nächste oder vorherige sichtbare Element, das erste untergeordnete Element und so weiter abrufen.

Die [**TVM \_ GETITEMRECT-Nachricht**](tvm-getitemrect.md) ruft das umgebundene Rechteck für ein Strukturansichtselement ab. Die [**TVM \_ GETCOUNT-**](tvm-getcount.md) und [**TVM \_ GETVISIBLECOUNT-Meldungen**](tvm-getvisiblecount.md) rufen die Anzahl der Elemente in einem Strukturansicht-Steuerelement und die Anzahl der Elemente ab, die im Fenster des Strukturansicht-Steuerelements vollständig sichtbar sein können. Sie können sicherstellen, dass ein bestimmtes Element sichtbar ist, indem Sie die [**NACHRICHT TVM \_ ENSUREVISIBLE**](tvm-ensurevisible.md) verwenden.

## <a name="tree-view-image-lists"></a>Tree-View Bildlisten

Jedem Element in einem Strukturansicht-Steuerelement können vier Bitmapbilder zugeordnet sein.

-   Ein Bild, z. B. ein geöffneter Ordner, das angezeigt wird, wenn das Element ausgewählt wird.
-   Ein Bild, z. B. ein geschlossener Ordner, das angezeigt wird, wenn das Element nicht ausgewählt ist.
-   Ein Überlagerungsbild, das transparent über dem ausgewählten oder nicht ausgewählten Bild gezeichnet wird.
-   Ein Statusbild, bei dem es sich um ein zusätzliches Bild handelt, das links neben dem ausgewählten oder nicht ausgewählten Bild angezeigt wird. Sie können Zustandsbilder wie z. B. Kontrollkästchen mit und ohne Kontrollkästchen verwenden, um anwendungsdefinierte Elementzustände anzugeben.

Standardmäßig zeigt ein Strukturansicht-Steuerelement keine Elementbilder an. Zum Anzeigen von Elementbildern müssen Sie Bildlisten erstellen und diese dem Steuerelement zuordnen. Weitere Informationen zu Bildlisten finden Sie unter [Bildlisten.](image-lists.md)

Ein Strukturansicht-Steuerelement kann zwei Bildlisten enthalten: eine normale Bildliste und eine Statusbildliste. In einer normalen Bildliste werden die ausgewählten, nicht ausgewählten und Überlagerungsbilder gespeichert. In einer Statusbildliste werden Zustandsbilder gespeichert. Verwenden Sie [**die ImageList \_ Create-Funktion,**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_create) um eine Bildliste zu erstellen, und verwenden Sie andere Bildlistenfunktionen, um der Bildliste Bitmaps hinzuzufügen. Verwenden Sie dann die [**TVM \_ SETIMAGELIST-Meldung,**](tvm-setimagelist.md) um die Bildliste dem Strukturansicht-Steuerelement zu zuordnen. Die [**TVM \_ GETIMAGELIST-Nachricht**](tvm-getimagelist.md) ruft ein Handle für eine der Bildlisten eines Strukturansicht-Steuerelements ab. Diese Meldung ist nützlich, wenn Sie der Liste weitere Bilder hinzufügen müssen.

Zusätzlich zu den ausgewählten und nicht ausgewählten Bildern kann die normale Bildliste eines Strukturansicht-Steuerelements bis zu vier Überlagerungsbilder enthalten. Überlagerungsbilder werden durch einen einbasierten Index identifiziert und sind so konzipiert, dass sie transparent über die ausgewählten und nicht ausgewählten Bilder gezeichnet werden. Um einem Bild in der normalen Bildliste einen Overlaymaskenindex zu zuweisen, rufen Sie die [**Funktion ImageList \_ SetOverlayImage**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_setoverlayimage) auf.

Standardmäßig zeigen alle Elemente das erste Bild in der normalen Bildliste sowohl für den ausgewählten als auch für den nicht ausgewählten Zustand an. Außerdem zeigen Elemente standardmäßig keine Überlagerungsbilder oder Zustandsbilder an. Sie können diese Standardverhalten für ein Element ändern, indem Sie die [**TVM \_ INSERTITEM-**](tvm-insertitem.md) oder [**TVM \_ SETITEM-Nachricht**](tvm-setitem.md) senden. Diese Nachrichten verwenden die [**TVITEM-Struktur,**](/windows/win32/api/commctrl/ns-commctrl-tvitema) um Bildlistenindizes für ein Element anzugeben.

Um die ausgewählten und nicht ausgewählten Bilder eines Elements anzugeben, legen Sie die TVIF SELECTEDIMAGE- und TVIF IMAGE-Bits im Maskenelement der TVITEM-Struktur fest, und geben Sie Indizes aus der normalen Bildliste des Steuerelements in den \_ \_ **iSelectImage-** und  **iImage-Membern** an. [](/windows/win32/api/commctrl/ns-commctrl-tvitema) Alternativ können Sie den I \_ IMAGECALLBACK-Wert in **iSelectImage** und **iImage** angeben, anstatt Indizes anzugeben. Dies bewirkt, dass das -Steuerelement jedes Mal, wenn das Element neu gezeichnet wird, sein übergeordnetes Fenster nach einem Bildlistenindex abfragt. Das -Steuerelement sendet die [TVN \_ GETDISPINFO-Benachrichtigungsmeldung,](tvn-getdispinfo.md) um den Index abzurufen.

Verwenden Sie zum Zuordnen eines Überlagerungsbilds zu einem Element das [**IndexTOOVERLAYMASK-Makro,**](/windows/desktop/api/Commctrl/nf-commctrl-indextooverlaymask) um einen Überlagerungsmaskenindex im Zustandselement der [**TVITEM-Struktur**](/windows/win32/api/commctrl/ns-commctrl-tvitema) des Elements anzugeben.  Sie müssen auch die [**TVIS \_ OVERLAYMASK-Bits**](tree-view-control-item-states.md) im **stateMask-Member** festlegen. Überlagerungsmaskenindizes sind 1-basiert. Ein Index von 0 (null) gibt an, dass kein Überlagerungsbild angegeben wurde.

Zustandsbilder werden in einer separaten Statusbildliste gespeichert und durch ihren Index identifiziert. Um die Statusbildliste anzugeben, senden Sie eine [**\_ TVM SETIMAGELIST-Nachricht.**](tvm-setimagelist.md) Im Gegensatz zum Listenansicht-Steuerelement, das einen einbasierten Index zum Identifizieren von Zustandsbildern verwendet, werden Steuerelementzustandsbilder in Strukturansichten durch einen nullbasierten Index identifiziert. Ein Index von 0 (null) gibt jedoch an, dass das Element kein Statusbild hat. Daher kann das Bild 0 (null) nicht als Zustandsbild verwendet werden. Weitere Informationen zu Elementzuständen und Zustandsbildern finden Sie unter [Übersicht über Elementzustände in Strukturansichten.](#tree-view-item-states-overview)

## <a name="drag-and-drop-operations"></a>Drag & Drop-Vorgänge

Ein Strukturansicht-Steuerelement benachrichtigt das übergeordnete Fenster, wenn der Benutzer mit dem Ziehen eines Elements beginnt. Das übergeordnete Fenster empfängt eine [TVN \_ BEGINDRAG-Benachrichtigung,](tvn-begindrag.md) wenn der Benutzer mit dem Ziehen eines Elements mit der linken Maustaste beginnt, und eine [TVN BEGINRDRAG-Benachrichtigungsmeldung, \_ ](tvn-beginrdrag.md) wenn der Benutzer mit dem Ziehen mit der rechten Schaltfläche beginnt. Sie können verhindern, dass ein Strukturansicht-Steuerelement diese Benachrichtigungen sendet, indem Sie dem Strukturansicht-Steuerelement den [**TVS \_ DISABLEDRAGDROP-Stil**](tree-view-control-window-styles.md) geben.

Sie erhalten ein Bild, das während eines Ziehvorgang mithilfe der [**TVM \_ CREATEDRAGIMAGE-Meldung angezeigt werden**](tvm-createdragimage.md) soll. Das Strukturansicht-Steuerelement erstellt eine Ziehbitmap basierend auf der Bezeichnung des gezogenen Elements. Anschließend erstellt das Strukturansicht-Steuerelement eine Bildliste, fügt ihr die Bitmap hinzu und gibt das Handle an die Bildliste zurück.

Sie müssen den Code bereitstellen, der das Element tatsächlich zieht. Dies umfasst in der Regel die Verwendung der Ziehfunktionen der Bildlistenfunktionen und die Verarbeitung der [**WM \_ MOUSEMOVE-**](/windows/desktop/inputdev/wm-mousemove) und [**\_ WM-LBUTTONUP-Meldungen**](/windows/desktop/inputdev/wm-lbuttonup) (oder [**WM \_ RBUTTONUP),**](/windows/desktop/inputdev/wm-rbuttonup)die an das übergeordnete Fenster gesendet werden, nachdem der Ziehvorgang begonnen hat.

Wenn Elemente in einem Strukturansicht-Steuerelement ziele von Drag & Drop-Vorgängen sein sollen, müssen Sie wissen, wann sich der Mauszeiger auf einem Zielelement befindet. Dies können Sie mithilfe der [**\_ TVM-HITTEST-Meldung**](tvm-hittest.md) herausfinden. Sie geben die Adresse einer [**TVHITTESTINFO-Struktur**](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo) an, die die aktuellen Koordinaten des Mauszeigers enthält. Wenn die [**SendMessage-Funktion**](/windows/desktop/api/winuser/nf-winuser-sendmessage) zurückgegeben wird, enthält die -Struktur ein Flag, das die Position des Mauszeigers relativ zum Strukturansicht-Steuerelement angibt. Wenn sich der Zeiger über einem Element im Strukturansicht-Steuerelement befindet, enthält die Struktur auch das Handle für das Element.

You can indicate that an item is the target of a drag-and-drop operation by using the [**TVM\_SETITEM**](tvm-setitem.md) message to set the state to the [**TVIS\_DROPHILITED**](tree-view-control-item-states.md) value. Ein Element mit diesem Zustand wird im Stil gezeichnet, der zum Angeben eines Drag & Drop-Ziels verwendet wird.

## <a name="tree-view-control-notification-messages"></a>Tree-View-Benachrichtigungsmeldungen

Ein Strukturansicht-Steuerelement sendet die folgenden Benachrichtigungsmeldungen in Form von [**WM \_ NOTIFY-Nachrichten**](wm-notify.md) an das übergeordnete Fenster.



| Benachrichtigung                                    | Beschreibung                                                                            |
|-------------------------------------------------|----------------------------------------------------------------------------------------|
| [TVN \_ BEGINDRAG](tvn-begindrag.md)             | Signalisiert den Start eines Drag & Drop-Vorgangs.                                        |
| [TVN \_ BEGINLABELEDIT](tvn-beginlabeledit.md)   | Signalisiert den Beginn der Bearbeitung der bezeichnungsbasierten Beschriftung.                                           |
| [TVN \_ BEGINRDRAG](tvn-beginrdrag.md)           | Signalisiert, dass die rechte Maustaste einen Drag & Drop-Vorgang gestartet hat.             |
| [TVN \_ DELETEITEM](tvn-deleteitem.md)           | Signalisiert das Löschen eines bestimmten Elements.                                               |
| [TVN \_ ENDLABELEDIT](tvn-endlabeledit.md)       | Signalisiert das Ende der Bezeichnungsbearbeitung.                                                      |
| [TVN \_ GETDISPINFO](tvn-getdispinfo.md)         | Fordert Informationen an, die das Strukturansichtssteuerelement benötigt, um ein Element anzuzeigen.           |
| [TVN \_ ITEMEXPANDED](tvn-itemexpanded.md)       | Signalisiert, dass die Liste der untergeordneten Elemente eines übergeordneten Elements erweitert oder reduziert wurde.            |
| [TVN \_ ITEMEXPANDING](tvn-itemexpanding.md)     | Signalisiert, dass die Liste der untergeordneten Elemente eines übergeordneten Elements erweitert oder reduziert wird. |
| [TVN \_ KEYDOWN](tvn-keydown.md)                 | Signalisiert ein Tastaturereignis.                                                              |
| [TVN \_ SELCHANGED](tvn-selchanged.md)           | Signalisiert, dass sich die Auswahl von einem Element zu einem anderen geändert hat.                       |
| [TVN \_ SELCHANGING](tvn-selchanging.md)         | Signalisiert, dass die Auswahl von einem Element in ein anderes geändert wird.            |
| [TVN \_ SETDISPINFO](tvn-setdispinfo.md)         | Benachrichtigt ein übergeordnetes Fenster, dass es die Informationen aktualisieren muss, die es für ein Element verwaltet. |



 

## <a name="default-tree-view-control-message-processing"></a>Standardeinstellung Tree-View Steuern der Nachrichtenverarbeitung

In diesem Abschnitt wird die Fensternachrichtenverarbeitung beschrieben, die von einem Strukturansicht-Steuerelement ausgeführt wird. Meldungen, die für Strukturansichtssteuerelemente spezifisch sind, werden in anderen Abschnitten dieses Dokuments erläutert, sodass sie hier nicht enthalten sind.



| `Message`                                            | Verarbeitung ausgeführt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**\_WM-BEFEHL**](/windows/desktop/menurc/wm-command)               | Verarbeitet die [Benachrichtigungsmeldungen EN \_ UPDATE](en-update.md) und [EN \_ KILLFOCUS](en-killfocus.md) zum Bearbeiten von Steuerelementen und gibt alle anderen Bearbeitungssteuerungsbenachrichtigungen an das übergeordnete Fenster weiter. Es ist kein Rückgabewert vorhanden.                                                                                                                                                                                                                                                                                                |
| [**WM \_ CREATE**](/windows/desktop/winmsg/wm-create)                 | Weist Arbeitsspeicher zu und initialisiert interne Datenstrukturen. Bei Erfolg wird 0 (null) zurückgegeben, andernfalls -1.                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**WM \_ DESTROY**](/windows/desktop/winmsg/wm-destroy)               | Gibt alle Systemressourcen frei, die dem Steuerelement zugeordnet sind. Sie gibt 0 (null) zurück.                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**WM \_ ENABLE**](/windows/desktop/winmsg/wm-enable)                 | Aktiviert oder deaktiviert das Steuerelement.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**WM \_ ERASEBKGND**](/windows/desktop/winmsg/wm-erasebkgnd)         | Löscht den Fensterhintergrund mithilfe der aktuellen Hintergrundfarbe für das Strukturansicht-Steuerelement. Sie gibt **TRUE zurück.**                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**WM \_ GETDLGCODE**](/windows/desktop/dlgbox/wm-getdlgcode)         | Gibt eine Kombination der DLGC-Werte \_ WANT DLGC WANTGCWS und DLGC \_ WANTCHARS zurück.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**WM \_ GETFONT**](/windows/desktop/winmsg/wm-getfont)               | Gibt das Handle an die aktuelle Bezeichnungsschriftart zurück.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [**WM \_ HSCROLL**](wm-hscroll.md)                  | Führt einen Bildlauf für das Strukturansichtssteuerfeld aus. Sie gibt **TRUE zurück,** wenn ein Bildlauf erfolgt, andernfalls **FALSE.**                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown)             | Sendet die [TVN \_ KEYDOWN-Benachrichtigungsmeldung](tvn-keydown.md) für alle Schlüssel an das übergeordnete Fenster. Sendet die [ \_ Benachrichtigungsmeldung NM RETURN (Strukturansicht),](nm-return-tree-view-.md) wenn der Benutzer die EINGABETASTE drückt. Sie verschiebt das Caret-Zeichen, wenn der Benutzer die Richtungstasten drückt oder die TASTEN "NACH OBEN", "SEITE NACH UNTEN", "HOME", "END" oder "BACKSPACE" drückt. Es führt einen Bildlauf im Strukturansichtssteuerfeld durch, wenn der Benutzer die STRG-Taste in Kombination mit diesen Tasten drückt. Sie gibt **TRUE zurück,** wenn ein Schlüssel verarbeitet wird, andernfalls **FALSE.** |
| [**WM \_ KILLFOCUS**](/windows/desktop/inputdev/wm-killfocus)         | Neu gemalt das fokussierte Element (sofern verfügbar) und sendet eine [NM \_ KILLFOCUS-Benachrichtigungsmeldung (Strukturansicht)](nm-killfocus-tree-view.md) an das übergeordnete Fenster.                                                                                                                                                                                                                                                                                                                                                                  |
| [**WM \_ LBUTTONDBLCLK**](/windows/desktop/inputdev/wm-lbuttondblclk) | Bricht die Bezeichnungsbearbeitung ab und sendet, wenn auf ein Element doppelklickt wurde, die Benachrichtigungsmeldung [NM \_ DBLCLK (Strukturansicht)](nm-dblclk-tree-view.md) an das übergeordnete Fenster. Wenn das übergeordnete Fenster 0 zurückgibt, schaltet das Strukturansicht-Steuerelement den erweiterten Zustand des Elements um und sendet dem übergeordneten Fenster die Benachrichtigungsmeldungen [TVN \_ ITEMEXPANDING](tvn-itemexpanding.md) und [TVN \_ ITEMEXPANDED.](tvn-itemexpanded.md) Es ist kein Rückgabewert vorhanden.                                                                             |
| [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown)     | Umschaltet den erweiterten Zustand, wenn der Benutzer auf die Einem übergeordneten Element zugeordnete Schaltfläche geklickt hat. Wenn der Benutzer auf eine Elementbezeichnung geklickt hat, wählt das Strukturansicht-Steuerelement den Fokus auf das Element aus und legt diesen fest. Wenn der Benutzer die Maus bewegt, bevor er die Maustaste loslassen kann, startet das Strukturansicht-Steuerelement einen Drag & Drop-Vorgang. Es ist kein Rückgabewert vorhanden.                                                                                                                                                                          |
| [**WM \_ PAINT**](/windows/desktop/gdi/wm-paint)                      | Zeichnet den ungültigen Bereich des Strukturansicht-Steuerelements. Sie gibt 0 (null) zurück. Wenn der *wParam-Parameter* nicht **NULL** ist, geht das Steuerelement davon aus, dass der Wert ein Handle für einen Gerätekontext (HDC) ist, und zeichnet mit diesem Gerätekontext.                                                                                                                                                                                                                                                                                      |
| [**WM \_ RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown)     | Überprüft, ob auf ein Element geklickt wurde und ein Ziehvorgang gestartet wurde. Wenn der Vorgang gestartet wurde, sendet er eine [TVN \_ BEGINRDRAG-Benachrichtigungsmeldung](tvn-beginrdrag.md) an das übergeordnete Fenster und hebt das Absturzziel hervor. Andernfalls wird eine [NM \_ RCLICK-Benachrichtigung (Strukturansicht)](nm-rclick-tree-view.md) an das übergeordnete Fenster gesendet. Es ist kein Rückgabewert vorhanden.                                                                                                                                           |
| [**WM \_ SETFOCUS**](/windows/desktop/inputdev/wm-setfocus)           | Neu gemalt das fokussierte Element (sofern verfügbar) und sendet eine [NM SETFOCUS-Benachrichtigungsmeldung \_ ](nm-setfocus.md) an das übergeordnete Fenster.                                                                                                                                                                                                                                                                                                                                                                                          |
| [**WM \_ SETFONT**](/windows/desktop/winmsg/wm-setfont)               | Speichert das angegebene Schriftarthandl und zeigt das Strukturansicht-Steuerelement mithilfe der neuen Schriftart neu an.                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**WM \_ SETREDRAW**](/windows/desktop/gdi/wm-setredraw)              | Legt das Flag für das neu gezeichnete -Flag fest oder legt es fest. Das Strukturansicht-Steuerelement wird neu gezeichnet, nachdem das Flag für das neu gezeichnete Steuerelement festgelegt wurde. Sie gibt 0 (null) zurück.                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**WM \_ SIZE**](/windows/desktop/winmsg/wm-size)                     | Neucomputet interne Variablen, die von der Größe des Clientbereichs des Strukturansicht-Steuerelements abhängen. Sie gibt **TRUE zurück.**                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**WM \_ STYLECHANGED**](/windows/desktop/winmsg/wm-stylechanged)     | Bricht die Bearbeitung von Bezeichnungen ab unddrawst das Strukturansicht-Steuerelement mithilfe der neuen Stile neu. Sie gibt 0 (null) zurück.                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**WM \_ SYSCOLORCHANGE**](/windows/desktop/gdi/wm-syscolorchange)    | Das Strukturansicht-Steuerelement wird mit der neuen Farbe neu gezeichnet, wenn das Neuzeichnungsflag festgelegt ist. Es ist kein Rückgabewert vorhanden.                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**WM \_ TIMER**](/windows/desktop/winmsg/wm-timer)                   | Beginnt mit dem Bearbeiten einer Elementbezeichnung. Wenn der Benutzer auf die Bezeichnung des fokussierten Elements klickt, legt das Strukturansicht-Steuerelement einen Timer fest, anstatt sofort in den Bearbeitungsmodus zu wechseln. Der Timer ermöglicht es der Strukturansicht, den Eintritt in den Bearbeitungsmodus zu vermeiden, wenn der Benutzer auf die Bezeichnung doppelklickt. Sie gibt 0 (null) zurück.                                                                                                                                                                                                                       |
| [**WM \_ VSCROLL**](wm-vscroll.md)                  | Führt einen Bildlauf für das Strukturansichtssteuerfeld aus. Sie gibt **TRUE zurück,** wenn ein Bildlauf erfolgt, andernfalls **FALSE.**                                                                                                                                                                                                                                                                                                                                                                                                                     |



 

## <a name="related-topics"></a>Zugehörige Themen

<dl> <dt>

[BEISPIEL: CustDTv veranschaulicht benutzerdefiniertes Zeichnen in einer TreeView (Q248496)](https://support.microsoft.com/default.aspx?scid=kb;EN-US;q248496)
</dt> </dl>

 

 