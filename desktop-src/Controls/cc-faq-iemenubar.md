---
title: Erstellen einer Menüleiste für Internet Explorer-Style
description: Auf den ersten Blick sieht die Menüleiste in Microsoft Internet Explorer 5 und höher einem Standardmenü ähnlich aus. Es ist jedoch ganz anders, wenn Sie beginnen, es zu verwenden.
ms.assetid: e0fe25f2-3d49-4c5a-a3f9-2f468f2cfef2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b262bc55407d263c97d4bd7e3938a9794d3a58f5
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "103858494"
---
# <a name="how-to-create-an-internet-explorer-style-menu-bar"></a><span data-ttu-id="c00aa-104">Erstellen einer Menüleiste für Internet Explorer-Style</span><span class="sxs-lookup"><span data-stu-id="c00aa-104">How to Create an Internet Explorer-Style Menu Bar</span></span>

<span data-ttu-id="c00aa-105">Auf den ersten Blick sieht die Menüleiste in Microsoft Internet Explorer 5 und höher einem Standardmenü ähnlich aus.</span><span class="sxs-lookup"><span data-stu-id="c00aa-105">At first glance, the menu bar in Microsoft Internet Explorer 5 and later looks similar to a standard menu.</span></span> <span data-ttu-id="c00aa-106">Es ist jedoch ganz anders, wenn Sie beginnen, es zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="c00aa-106">However, it looks quite different when you begin using it.</span></span>

<span data-ttu-id="c00aa-107">Der folgende Screenshot zeigt die Menüleiste von Windows Internet Explorer, in der das Menü Extras ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-107">The following screen shot shows the Windows Internet Explorer menu bar with the Tools menu selected.</span></span>

![Screenshot der Windows Internet Explorer-Menüleiste mit ausgewähltem Menü "Extras"](images/howto8.jpg)

<span data-ttu-id="c00aa-109">Die Menüleiste ist tatsächlich ein Symbolleisten-Steuerelement, das wie ein Standardmenü aussieht.</span><span class="sxs-lookup"><span data-stu-id="c00aa-109">The menu bar is actually a toolbar control that looks like a standard menu.</span></span> <span data-ttu-id="c00aa-110">Anstelle von Menü Elementen der obersten Ebene enthält eine Menüleiste eine Reihe von nur-Text-Schaltflächen, die ein Dropdown Menü anzeigen, wenn darauf geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="c00aa-110">Instead of top-level menu items, a menu bar has a series of text-only buttons that display a drop-down menu when clicked.</span></span> <span data-ttu-id="c00aa-111">Als spezieller Typ der Symbolleiste bietet eine Menüleiste jedoch einige Funktionen, die Standardmenüs fehlen:</span><span class="sxs-lookup"><span data-stu-id="c00aa-111">However, as a specialized type of toolbar, a menu bar has some capabilities that standard menus lack:</span></span>

-   <span data-ttu-id="c00aa-112">Sie kann mithilfe von standardmäßigen Symbolleisten Techniken angepasst werden, sodass der Benutzer Elemente verschieben, löschen oder hinzufügen kann.</span><span class="sxs-lookup"><span data-stu-id="c00aa-112">It can be customized using standard toolbar techniques, allowing the user to move, delete, or add items.</span></span>
-   <span data-ttu-id="c00aa-113">Sie kann über eine Hot-Tracking verfügen, damit Benutzer wissen, wenn Sie sich über einem Element der obersten Ebene befinden, ohne darauf klicken zu müssen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-113">It can have hot-tracking, so that users will know when they are over a top-level item without having to click it first.</span></span>

<span data-ttu-id="c00aa-114">Eine Menüleiste kann in ein Grund leisten-Steuerelement eingebunden werden, das Ihnen die folgenden Features bietet:</span><span class="sxs-lookup"><span data-stu-id="c00aa-114">A menu bar can be incorporated into a rebar control, giving it the following features:</span></span>

-   <span data-ttu-id="c00aa-115">Sie kann über einen Zieh Punkt verfügen, der dem Benutzer das Verschieben oder Ändern der Größe des Bands ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="c00aa-115">It can have a gripper, which allows the user to move or resize the band.</span></span>
-   <span data-ttu-id="c00aa-116">Es kann einen Strip im Info leisten-Steuerelement mit anderen Bändern, wie z. b. der Standard Symbolleiste in der vorherigen Abbildung, freigeben.</span><span class="sxs-lookup"><span data-stu-id="c00aa-116">It can share a strip in the rebar control with other bands, such as the standard toolbar in the preceding illustration.</span></span>
-   <span data-ttu-id="c00aa-117">Es kann ein Chevron anzeigen, wenn es von einem angrenzenden Band abgedeckt wird, sodass der Benutzer Zugriff auf die ausgeblendeten Elemente hat.</span><span class="sxs-lookup"><span data-stu-id="c00aa-117">It can display a chevron when it is covered by an adjacent band, giving the user access to the hidden items.</span></span>
-   <span data-ttu-id="c00aa-118">Sie kann über eine von der Anwendung definierte Hintergrund Bitmap verfügen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-118">It can have an application-defined background bitmap.</span></span>

<span data-ttu-id="c00aa-119">In diesem Thema wird erläutert, wie eine Menüleiste implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="c00aa-119">This topic discusses how to implement a menu bar.</span></span> <span data-ttu-id="c00aa-120">Da eine Menüleiste eine spezielle Implementierung eines Symbolleisten-Steuer Elements ist, wird der Fokus auf Themen, die für Menüleisten spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="c00aa-120">Since a menu bar is a specialized implementation of a toolbar control, the focus will be on topics that are specific to menu bars.</span></span> <span data-ttu-id="c00aa-121">Eine Erläuterung dazu, wie Sie eine Symbolleiste in ein Grund leisten-Steuerelement integrieren, finden Sie unter [How to Create a Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md) und [about Grund leisten Controls](rebar-controls.md).</span><span class="sxs-lookup"><span data-stu-id="c00aa-121">For a discussion of how to incorporate a toolbar into a rebar control, see [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md) and [About Rebar Controls](rebar-controls.md).</span></span>

-   [<span data-ttu-id="c00aa-122">Erstellen einer Symbolleiste in eine Menüleiste</span><span class="sxs-lookup"><span data-stu-id="c00aa-122">Making a Toolbar into a Menu Bar</span></span>](#making-a-toolbar-into-a-menu-bar)
-   [<span data-ttu-id="c00aa-123">Behandeln der Navigation mit aktiviertem Menü Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="c00aa-123">Handling Navigation with Menu Hot-Tracking Disabled</span></span>](#handling-navigation-with-menu-hot-tracking-disabled)
    -   [<span data-ttu-id="c00aa-124">Maus Navigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-124">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="c00aa-125">Tastatur Navigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-125">Keyboard Navigation</span></span>](#keyboard-navigation)
    -   [<span data-ttu-id="c00aa-126">Gemischte Navigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-126">Mixed Navigation</span></span>](#mixed-navigation)
-   [<span data-ttu-id="c00aa-127">Behandeln der Navigation mit aktiviertem Menü Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="c00aa-127">Handling Navigation with Menu Hot-Tracking Enabled</span></span>](#handling-navigation-with-menu-hot-tracking-enabled)
    -   [<span data-ttu-id="c00aa-128">Nachrichtenverarbeitung für Menü-Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="c00aa-128">Message Processing for Menu Hot-Tracking</span></span>](#message-processing-for-menu-hot-tracking)
    -   [<span data-ttu-id="c00aa-129">Maus Navigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-129">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="c00aa-130">Tastatur Navigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-130">Keyboard Navigation</span></span>](#keyboard-navigation)

## <a name="making-a-toolbar-into-a-menu-bar"></a><span data-ttu-id="c00aa-131">Erstellen einer Symbolleiste in eine Menüleiste</span><span class="sxs-lookup"><span data-stu-id="c00aa-131">Making a Toolbar into a Menu Bar</span></span>

<span data-ttu-id="c00aa-132">So machen Sie eine Symbolleiste in eine Menüleiste:</span><span class="sxs-lookup"><span data-stu-id="c00aa-132">To make a toolbar into a menu bar:</span></span>

-   <span data-ttu-id="c00aa-133">Erstellen Sie eine flache Symbolleiste, indem Sie [**tbstyle \_ Flat**](toolbar-control-and-button-styles.md) mit den anderen Fenster stilflags einschließen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-133">Create a flat toolbar by including [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="c00aa-134">Der **\_ flache Stil von tbstyle** ermöglicht außerdem die Hot-Tracking-Funktion.</span><span class="sxs-lookup"><span data-stu-id="c00aa-134">The **TBSTYLE\_FLAT** style also enables hot-tracking.</span></span> <span data-ttu-id="c00aa-135">Bei diesem Stil sieht die Menüleiste dem Standardmenü so lange aus, bis der Benutzer eine Schaltfläche aktiviert.</span><span class="sxs-lookup"><span data-stu-id="c00aa-135">With this style, the menu bar looks much like a standard menu until the user activates a button.</span></span> <span data-ttu-id="c00aa-136">Anschließend wird die Schaltfläche so angezeigt, dass Sie auf der Symbolleiste angezeigt wird, und Sie beim Klicken auf die Schaltfläche debugdrücken.</span><span class="sxs-lookup"><span data-stu-id="c00aa-136">Then, the button appears to stand out from the toolbar and depress when it is clicked, just like a standard button.</span></span> <span data-ttu-id="c00aa-137">Da die Hot-Tracking-Funktion aktiviert ist, muss zum Aktivieren einer Schaltfläche nur der Cursor darauf zeigen, um eine Schaltfläche zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="c00aa-137">Because hot-tracking is enabled, all that is needed to activate a button is for the cursor to hover over it.</span></span> <span data-ttu-id="c00aa-138">Wenn der Cursor auf eine andere Schaltfläche verschoben wird, wird er aktiviert und die alte Schaltfläche deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="c00aa-138">If the cursor moves to another button, it will be activated and the old button deactivated.</span></span>
-   <span data-ttu-id="c00aa-139">Erstellen Sie Schaltflächen im Listenformat, indem Sie die [**tbstyle- \_ Liste**](toolbar-control-and-button-styles.md) mit den anderen Fenster Stil-Flags einschließen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-139">Create list-style buttons by including [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="c00aa-140">Dieser Stil erstellt eine schlankere Schaltfläche, die mehr ähnelt wie ein Standardmenü Element der obersten Ebene.</span><span class="sxs-lookup"><span data-stu-id="c00aa-140">This style creates a thinner button that looks more like a standard top-level menu item.</span></span>
-   <span data-ttu-id="c00aa-141">Legen Sie die Schaltflächen Text-Only fest, indem Sie den **ibitmap** -Member der [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) -Struktur der Schaltfläche auf ich \_ imagenone und den **IString** -Member auf den Schaltflächen Text festlegen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-141">Make the buttons text-only by setting the **iBitmap** member of the button's [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure to I\_IMAGENONE and the **iString** member to the button text.</span></span>
-   <span data-ttu-id="c00aa-142">Versehen Sie jede Schaltfläche mit dem [**btns- \_ Dropdown**](toolbar-control-and-button-styles.md) Stil.</span><span class="sxs-lookup"><span data-stu-id="c00aa-142">Give each button the [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="c00aa-143">Wenn auf die Schaltfläche geklickt wird, sendet das Symbolleisten-Steuerelement eine [TBN- \_ Dropdown](tbn-dropdown.md) Benachrichtigung an Ihre Anwendung, um Sie aufzufordern, das Menü der Schaltfläche anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-143">When the button is clicked, the toolbar control sends your application a [TBN\_DROPDOWN](tbn-dropdown.md) notification to prompt it to display the button's menu.</span></span>
-   <span data-ttu-id="c00aa-144">Integrieren Sie die Menüleiste in ein Info Balken-Band.</span><span class="sxs-lookup"><span data-stu-id="c00aa-144">Incorporate the menu bar into a rebar band.</span></span> <span data-ttu-id="c00aa-145">Aktivieren Sie sowohl Gripper als auch Chevrons, wie unter [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md)erläutert.</span><span class="sxs-lookup"><span data-stu-id="c00aa-145">Enable both grippers and chevrons, as discussed in [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md).</span></span>
-   <span data-ttu-id="c00aa-146">Implementieren Sie einen [TBN- \_ Dropdown](tbn-dropdown.md) Handler, um das *Dropdown Menü* der Schaltfläche anzuzeigen, wenn darauf geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="c00aa-146">Implement a [TBN\_DROPDOWN](tbn-dropdown.md) handler to display the button's *drop-down menu* when it is clicked.</span></span> <span data-ttu-id="c00aa-147">Das Dropdown Menü ist ein Typ von Popup-Menü.</span><span class="sxs-lookup"><span data-stu-id="c00aa-147">The drop-down menu is a type of pop-up menu.</span></span> <span data-ttu-id="c00aa-148">Sie wird mithilfe der [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) -Funktion erstellt, wobei die linke obere Ecke an der linken unteren Ecke der Schaltfläche ausgerichtet ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-148">It is created by using the [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) function, with its upper-left corner aligned with the lower-left corner of the button.</span></span>
-   <span data-ttu-id="c00aa-149">Implementieren Sie die Tastaturnavigation, sodass die Menüleiste ohne Maus vollständig zugänglich ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-149">Implement keyboard navigation, so that the menu bar is fully accessible without a mouse.</span></span>
-   <span data-ttu-id="c00aa-150">Implementieren Sie das Menü "Hot-Tracking".</span><span class="sxs-lookup"><span data-stu-id="c00aa-150">Implement menu hot-tracking.</span></span> <span data-ttu-id="c00aa-151">Wenn in Standardmenüs ein Menü Element Menü der obersten Ebene angezeigt wird, wird der Cursor über ein anderes Element der obersten Ebene automatisch im Menü angezeigt, und das Menü des vorherigen Elements wird ausgeblendet.</span><span class="sxs-lookup"><span data-stu-id="c00aa-151">With standard menus, once a top level menu item's menu has been displayed, moving the cursor over another top-level item automatically displays its menu and collapses the menu of the previous item.</span></span> <span data-ttu-id="c00aa-152">Mit dem Symbolleisten-Steuerelement wird der Cursor auf den Cursor nachverfolgt und das Schaltflächen Bild geändert, aber das neue Menü wird automatisch angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c00aa-152">The toolbar control will hot-track the cursor and change the button image, but it does automatically display the new menu.</span></span> <span data-ttu-id="c00aa-153">Die Anwendung muss dies explizit tun.</span><span class="sxs-lookup"><span data-stu-id="c00aa-153">Your application must do so explicitly.</span></span>

<span data-ttu-id="c00aa-154">Die meisten dieser Elemente sind einfach zu implementieren und werden an anderer Stelle erörtert.</span><span class="sxs-lookup"><span data-stu-id="c00aa-154">Most of these items are straightforward to implement and are discussed elsewhere.</span></span> <span data-ttu-id="c00aa-155">Eine allgemeine Erörterung der Verwendung von Symbolleisten und Grund leisten-Steuerelementen finden Sie unter [Erstellen einer Internet Explorer-Style Symbolleiste](cc-faq-ietoolbar.md), [Informationen zu Symbol](toolbar-controls-overview.md)leisten-Steuerelementen oder über Grund leisten-Steuer [Elemente](rebar-controls.md) .</span><span class="sxs-lookup"><span data-stu-id="c00aa-155">See [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md), [About Toolbar Controls](toolbar-controls-overview.md), or [About Rebar Controls](rebar-controls.md) for a general discussion of how to use toolbars and rebar controls.</span></span> <span data-ttu-id="c00aa-156">Weitere Informationen zur Behandlung von Popup Menüs finden Sie unter [Menüs](/windows/desktop/menurc/menus) .</span><span class="sxs-lookup"><span data-stu-id="c00aa-156">See [Menus](/windows/desktop/menurc/menus) for a discussion of how to handle pop-up menus.</span></span> <span data-ttu-id="c00aa-157">Die letzten beiden Elemente, Tastaturnavigation und Menü-Hot-Tracking, werden im weiteren Verlauf dieses Themas erläutert.</span><span class="sxs-lookup"><span data-stu-id="c00aa-157">The final two items, keyboard navigation and menu hot-tracking, are discussed in the remainder of this topic.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-disabled"></a><span data-ttu-id="c00aa-158">Behandeln der Navigation mit aktiviertem Menü Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="c00aa-158">Handling Navigation with Menu Hot-Tracking Disabled</span></span>

<span data-ttu-id="c00aa-159">Benutzer können mit der Maus, der Tastatur oder einer Kombination aus beidem in der Menüleiste navigieren.</span><span class="sxs-lookup"><span data-stu-id="c00aa-159">Users can choose to navigate the menu bar with the mouse, the keyboard, or a mixture of both.</span></span> <span data-ttu-id="c00aa-160">Um die Navigation in der Menüleiste zu implementieren, muss Ihre Anwendung Symbolleisten Benachrichtigungen verarbeiten und die Maus und Tastatur überwachen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-160">To implement menu bar navigation, your application must handle toolbar notifications and monitor the mouse and keyboard.</span></span> <span data-ttu-id="c00aa-161">Diese Aufgabe kann in zwei unterschiedliche Teile aufgeteilt werden: mit und ohne Menü-Hot-Tracking.</span><span class="sxs-lookup"><span data-stu-id="c00aa-161">This task can be broken into two distinct parts: with and without menu hot-tracking.</span></span> <span data-ttu-id="c00aa-162">In diesem Abschnitt wird erläutert, wie die Navigation behandelt wird, wenn keine Menüs angezeigt werden und das Menü "Hot-Tracking" nicht aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-162">This section discusses how to handle navigation when no menus are displayed and menu hot-tracking is not enabled.</span></span>

### <a name="mouse-navigation"></a><span data-ttu-id="c00aa-163">Maus Navigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-163">Mouse Navigation</span></span>

<span data-ttu-id="c00aa-164">Wenn die Hot-Tracking-Menüoption deaktiviert ist, können Sie eine Menüleiste als normale Symbolleiste behandeln.</span><span class="sxs-lookup"><span data-stu-id="c00aa-164">If menu hot-tracking is disabled, you can treat a menu bar as a normal toolbar.</span></span> <span data-ttu-id="c00aa-165">Wenn der Benutzer mit einer Maus navigiert, muss die [TBN- \_ Dropdown](tbn-dropdown.md) Benachrichtigung von der gesamten Anwendung verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="c00aa-165">If the user is navigating with a mouse, all your application needs to do is handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification.</span></span> <span data-ttu-id="c00aa-166">Wenn diese Benachrichtigung empfangen wird, zeigen Sie das entsprechende Dropdown Menü an, und aktivieren Sie das Menü "Hot-Tracking".</span><span class="sxs-lookup"><span data-stu-id="c00aa-166">When this notification is received, display the appropriate drop-down menu, and enable menu hot-tracking.</span></span> <span data-ttu-id="c00aa-167">Danach befinden Sie sich im Menü "Hot-Tracking-System", das unter [Handling Navigation with Menu Hot-Tracking aktiviert](#handling-navigation-with-menu-hot-tracking-enabled)ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-167">From then on, you are in the menu hot-tracking regime discussed in [Handling Navigation with Menu Hot-Tracking Enabled](#handling-navigation-with-menu-hot-tracking-enabled).</span></span>

<span data-ttu-id="c00aa-168">Wie in [mixed Navigation](#mixed-navigation)erläutert, müssen Sie auch die TBN-Meldung " [ \_ betitemchange](tbn-hotitemchange.md) " behandeln, um die aktive Schaltfläche zu verfolgen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-168">As discussed in [Mixed Navigation](#mixed-navigation), you also need to handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="c00aa-169">Diese Benachrichtigung ist irrelevant, wenn der Benutzer nur mit der Maus navigiert, aber dies ist erforderlich, wenn die Maus-und Tastaturnavigation gemischt ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-169">This notification is irrelevant if the user is only navigating with the mouse, but it is necessary when mouse and keyboard navigation are mixed.</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="c00aa-170">Tastaturnavigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-170">Keyboard Navigation</span></span>

<span data-ttu-id="c00aa-171">Wie bereits im vorherigen Abschnitt erwähnt, kann der Benutzer mit der Tastatur eine Reihe von Navigations Vorgängen durchführen, wenn das Menü "Hot-Tracking" deaktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-171">As noted in the previous section, the user can do a number of navigation operations with the keyboard when menu hot-tracking is disabled.</span></span> <span data-ttu-id="c00aa-172">Symbolleisten-Steuerelemente unterstützen Tastaturnavigation nur, wenn Sie den Fokus haben</span><span class="sxs-lookup"><span data-stu-id="c00aa-172">Toolbar controls support keyboard navigation only if they have focus.</span></span> <span data-ttu-id="c00aa-173">Außerdem werden nicht alle für Menüleisten benötigten Tastendruck Aufgaben behandelt.</span><span class="sxs-lookup"><span data-stu-id="c00aa-173">They also do not handle all the key presses that are needed for menu bars.</span></span> <span data-ttu-id="c00aa-174">Die einfachste Lösung für die Tastaturnavigation besteht darin, die relevanten Tastendruck Ereignisse explizit zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="c00aa-174">The simplest solution to handling keyboard navigation is to process the relevant key press events explicitly.</span></span>

<span data-ttu-id="c00aa-175">Wenn die Hot-Tracking-Menüs deaktiviert ist, muss die Anwendung diese Tastendruck Ereignisse wie folgt behandeln:</span><span class="sxs-lookup"><span data-stu-id="c00aa-175">If menu hot-tracking is disabled, your application must handle these key press events in the following way:</span></span>

-   <span data-ttu-id="c00aa-176">F10-TASTE</span><span class="sxs-lookup"><span data-stu-id="c00aa-176">The F10 key.</span></span> <span data-ttu-id="c00aa-177">Aktivieren Sie die erste Schaltfläche mit der [**TB \_**](tb-sethotitem.md)"".</span><span class="sxs-lookup"><span data-stu-id="c00aa-177">Activate the first button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span>
-   <span data-ttu-id="c00aa-178">Die nach-links-und nach-rechts-Taste.</span><span class="sxs-lookup"><span data-stu-id="c00aa-178">The LEFT ARROW and RIGHT ARROW keys.</span></span> <span data-ttu-id="c00aa-179">Aktivieren Sie die angrenzende Schaltfläche mit dem [**TB \_**](tb-sethotitem.md)-Element.</span><span class="sxs-lookup"><span data-stu-id="c00aa-179">Activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="c00aa-180">Wenn der Benutzer versucht, von einem Ende der Menüleiste zu navigieren, aktivieren Sie die erste Schaltfläche am gegenüberliegenden Ende.</span><span class="sxs-lookup"><span data-stu-id="c00aa-180">If the user attempts to navigate off either end of the menu bar, activate the first button at the opposite end.</span></span>
-   <span data-ttu-id="c00aa-181">Der escapeschlüssel.</span><span class="sxs-lookup"><span data-stu-id="c00aa-181">The ESCAPE key.</span></span> <span data-ttu-id="c00aa-182">Deaktivieren Sie die aktive Schaltfläche mit dem " [**TB \_**](tb-sethotitem.md)".</span><span class="sxs-lookup"><span data-stu-id="c00aa-182">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="c00aa-183">Die Menüleiste sollte in den Zustand zurückversetzt werden, der vor dem Aktivieren der ersten Schaltfläche aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-183">The menu bar should be returned to the state it had prior to activating the first button.</span></span>
-   <span data-ttu-id="c00aa-184">Eine Tastenkombination für Alt-*Taste* .</span><span class="sxs-lookup"><span data-stu-id="c00aa-184">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="c00aa-185">Verwenden Sie die [**TB- \_ mapaccelerernachricht**](tb-mapaccelerator.md) , um zu bestimmen, welcher Schaltfläche das *Schlüssel* Zeichen entspricht.</span><span class="sxs-lookup"><span data-stu-id="c00aa-185">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="c00aa-186">Zeigen Sie das Dropdown Menü der Schaltfläche an, und aktivieren Sie das Menü "Hot-Tracking".</span><span class="sxs-lookup"><span data-stu-id="c00aa-186">Display the button's drop-down menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="c00aa-187">NACH-UNTEN-TASTE</span><span class="sxs-lookup"><span data-stu-id="c00aa-187">The DOWN ARROW key.</span></span> <span data-ttu-id="c00aa-188">Wenn eine Schaltfläche aktiv ist, aber kein Menü angezeigt wird, zeigen Sie das Menü der Schaltfläche an, und aktivieren Sie das Menü "Hot-Tracking".</span><span class="sxs-lookup"><span data-stu-id="c00aa-188">If a button is active but no menu has been displayed, display the button's menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="c00aa-189">EINGABETASTE</span><span class="sxs-lookup"><span data-stu-id="c00aa-189">The ENTER key.</span></span> <span data-ttu-id="c00aa-190">Deaktivieren Sie die aktive Schaltfläche mit dem " [**TB \_**](tb-sethotitem.md)".</span><span class="sxs-lookup"><span data-stu-id="c00aa-190">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="c00aa-191">Die Menüleiste sollte in den Zustand zurückversetzt werden, der vor dem Aktivieren der ersten Schaltfläche aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-191">The menu bar should be returned to the state it had prior to activating the first button.</span></span>

### <a name="mixed-navigation"></a><span data-ttu-id="c00aa-192">Gemischte Navigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-192">Mixed Navigation</span></span>

<span data-ttu-id="c00aa-193">Die im vorherigen Abschnitt beschriebenen Tastatur Navigations Handler führen im Grunde zwei Aufgaben aus: verfolgen Sie die aktive Schaltfläche, und zeigen Sie das entsprechende Menü an, wenn eine Schaltfläche ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="c00aa-193">The keyboard navigation handlers outlined in the preceding section basically do two tasks: keep track of the active button and display the appropriate menu when a button is selected.</span></span> <span data-ttu-id="c00aa-194">Diese Handler sind ausreichend, solange der Benutzer nur über die Tastatur navigiert.</span><span class="sxs-lookup"><span data-stu-id="c00aa-194">These handlers are sufficient as long as the user navigates only with the keyboard.</span></span> <span data-ttu-id="c00aa-195">Benutzer mischen jedoch oft die Tastatur-und Maus Navigation.</span><span class="sxs-lookup"><span data-stu-id="c00aa-195">However, users often mix keyboard and mouse navigation.</span></span> <span data-ttu-id="c00aa-196">Beispielsweise können Sie die erste Schaltfläche mit der Taste F10 aktivieren, mit der Maus eine andere Schaltfläche aktivieren und dann das Menü mit der nach-unten-Taste öffnen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-196">For example, they might activate the first button with the F10 key, use the mouse to activate a different button, and then open its menu with the DOWN ARROW key.</span></span> <span data-ttu-id="c00aa-197">Wenn Sie nur die Tastendruck überwachen, um den aktiven Schlüssel zu verfolgen, wird das falsche Menü angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c00aa-197">If you are only monitoring key presses to keep track of the active key, you will display the wrong menu.</span></span> <span data-ttu-id="c00aa-198">Sie müssen auch die TBN-Meldung " [ \_ betitemchange](tbn-hotitemchange.md) " behandeln, um die aktive Schaltfläche korrekt zu verfolgen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-198">You must also handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to accurately keep track of the active button.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-enabled"></a><span data-ttu-id="c00aa-199">Behandeln der Navigation mit aktiviertem Menü Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="c00aa-199">Handling Navigation with Menu Hot-Tracking Enabled</span></span>

<span data-ttu-id="c00aa-200">Wenn Menü-Hot-Tracking aktiviert ist, muss Ihre Anwendung die Art und Weise ändern, wie Sie auf die Benutzernavigation reagiert.</span><span class="sxs-lookup"><span data-stu-id="c00aa-200">When menu hot-tracking is enabled, your application must change the way it responds to user navigation.</span></span> <span data-ttu-id="c00aa-201">Um das Verhalten von Standardmenüs zu replizieren, müssen Sie die folgenden Funktionen explizit implementieren.</span><span class="sxs-lookup"><span data-stu-id="c00aa-201">To replicate the behavior of standard menus, you must implement the following features explicitly.</span></span>

<span data-ttu-id="c00aa-202">Mit der Maus Navigation:</span><span class="sxs-lookup"><span data-stu-id="c00aa-202">With mouse navigation:</span></span>

-   <span data-ttu-id="c00aa-203">Wenn der Benutzer den Cursor über eine andere Schaltfläche bewegt, wird das Menü sofort angezeigt, und das vorherige Menü wird nicht mehr angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c00aa-203">If the user moves the cursor over another button, that menu immediately appears and the previous menu disappears.</span></span>
-   <span data-ttu-id="c00aa-204">Die Hot-Tracking-Menü bleibt aktiv, bis der Benutzer einen Befehl auswählt oder auf einen Punkt klickt, der nicht Teil des Menü Bereichs ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-204">Menu hot-tracking stays active until the user selects a command or clicks a point that is not part of the menu region.</span></span> <span data-ttu-id="c00aa-205">Beide Aktionen deaktivieren Menü-Hot-Tracking, bis auf eine andere Schaltfläche geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="c00aa-205">Either action deactivates menu hot-tracking until another button is clicked.</span></span>
-   <span data-ttu-id="c00aa-206">Wenn der Cursor aus dem Menü verschoben wird, bleibt das aktuelle Dropdown Menü so lange erhalten, bis der Cursor zurück wechselt, oder der Benutzer klickt auf einen Punkt außerhalb, den Bereich, der im Menü abgedeckt ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-206">If the cursor moves off the menu, the current drop-down menu remains until the cursor moves back onto, or the user clicks a point outside, the area covered by the menu.</span></span> <span data-ttu-id="c00aa-207">Wenn der Cursor zu einer anderen Schaltfläche zurückkehrt, als gerade angezeigt wird, wird das alte Menü reduziert, und das neue Menü wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c00aa-207">If the cursor returns to a different button than the one currently being displayed, the old menu is collapsed and the new menu is displayed.</span></span>

<span data-ttu-id="c00aa-208">Mit Tastaturnavigation:</span><span class="sxs-lookup"><span data-stu-id="c00aa-208">With keyboard navigation:</span></span>

-   <span data-ttu-id="c00aa-209">Mit der nach-rechts-Taste wird der Fokus nach rechts verschoben.</span><span class="sxs-lookup"><span data-stu-id="c00aa-209">The RIGHT ARROW key moves the focus to the right.</span></span> <span data-ttu-id="c00aa-210">Wenn das Element über ein Untermenü verfügt, zeigen Sie das Untermenü an.</span><span class="sxs-lookup"><span data-stu-id="c00aa-210">If the item has a submenu, display the submenu.</span></span> <span data-ttu-id="c00aa-211">Wenn das Element nicht über ein Untermenü verfügt, reduzieren Sie das Menü und alle Untermenüs, aktivieren Sie die Schaltfläche weiter mit dem TB-Element, und zeigen Sie das Menü für die angrenzende Schaltfläche an. [**\_**](tb-sethotitem.md)</span><span class="sxs-lookup"><span data-stu-id="c00aa-211">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="c00aa-212">Wenn die letzte Schaltfläche aktiv ist, wenn diese Meldung empfangen wird, zeigen Sie das Menü für die erste Schaltfläche an.</span><span class="sxs-lookup"><span data-stu-id="c00aa-212">If the last button is active when this message is received, display the menu for the first button.</span></span>
-   <span data-ttu-id="c00aa-213">Mit der nach-links-Taste wird der Fokus nach links verschoben.</span><span class="sxs-lookup"><span data-stu-id="c00aa-213">The LEFT ARROW key moves the focus to the left.</span></span> <span data-ttu-id="c00aa-214">Wenn das Element ein Untermenü ist, reduzieren Sie es, und verschieben Sie den Fokus auf das übergeordnete Menü.</span><span class="sxs-lookup"><span data-stu-id="c00aa-214">If the item is a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="c00aa-215">Wenn es sich bei dem Element nicht um ein Untermenü handelt, reduzieren Sie das Menü, aktivieren Sie die Schaltfläche "weiter" mit " [**TB \_**](tb-sethotitem.md)", und zeigen Sie das Menü für diese Schaltfläche an.</span><span class="sxs-lookup"><span data-stu-id="c00aa-215">If the item is not a submenu, collapse the menu, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for that button.</span></span>

<!-- -->

-   <span data-ttu-id="c00aa-216">Der escapeschlüssel sichert einen Schritt in der Anzeige.</span><span class="sxs-lookup"><span data-stu-id="c00aa-216">The ESCAPE key backs the display up one step.</span></span>
    -   <span data-ttu-id="c00aa-217">Wenn ein Untermenü angezeigt wird, wird es reduziert, und der Fokus wechselt zum übergeordneten Menü.</span><span class="sxs-lookup"><span data-stu-id="c00aa-217">If a submenu is displayed, it is collapsed and focus shifts to the parent menu.</span></span>
    -   <span data-ttu-id="c00aa-218">Wenn das Menü einer Schaltfläche angezeigt wird, wird es reduziert, und die Menü-Hot-Tracking-Option ist deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="c00aa-218">If a button's menu is displayed, it is collapsed and menu hot-tracking is disabled.</span></span> <span data-ttu-id="c00aa-219">Die Schaltfläche des Elements bleibt aktiv.</span><span class="sxs-lookup"><span data-stu-id="c00aa-219">The item's button remains active.</span></span>
    -   <span data-ttu-id="c00aa-220">Wenn keine Menüs angezeigt werden, aber eine Schaltfläche aktiv ist, wird die Schaltfläche deaktiviert, und die Menü-Hot-Tracking-Option ist deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="c00aa-220">If no menus are displayed but a button is active, the button is deactivated and menu hot-tracking is disabled.</span></span>
-   <span data-ttu-id="c00aa-221">Die nach-oben-und nach-unten-Taste werden nur für die Navigation innerhalb eines bestimmten Menüs verwendet.</span><span class="sxs-lookup"><span data-stu-id="c00aa-221">The UP ARROW and DOWN ARROW keys are used only to navigate within a particular menu.</span></span>
-   <span data-ttu-id="c00aa-222">Die EINGABETASTE öffnet den Befehl, der einem Menü Element zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-222">The ENTER key launches the command associated with a menu item.</span></span> <span data-ttu-id="c00aa-223">Wenn das Menü Element über ein Untermenü verfügt, wird es mit der EINGABETASTE angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c00aa-223">If the menu item has a submenu, the ENTER key displays it.</span></span>

<span data-ttu-id="c00aa-224">Wie beim deaktivierten Menü "Hot-Tracking" muss Ihre Anwendung die Maus-, Tastatur-und gemischte Navigation verarbeiten können.</span><span class="sxs-lookup"><span data-stu-id="c00aa-224">As with the menu hot-tracking disabled case, your application must be able to handle mouse, keyboard, and mixed navigation.</span></span> <span data-ttu-id="c00aa-225">Die Tatsache, dass ein Menü angezeigt wird, bedeutet jedoch, dass das Messaging etwas anders gehandhabt werden muss.</span><span class="sxs-lookup"><span data-stu-id="c00aa-225">However, the fact that a menu is displayed means that messaging will have to be handled somewhat differently.</span></span>

### <a name="message-processing-for-menu-hot-tracking"></a><span data-ttu-id="c00aa-226">Nachrichtenverarbeitung für Menü Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="c00aa-226">Message Processing for Menu Hot-Tracking</span></span>

<span data-ttu-id="c00aa-227">Das Menü "Hot-Tracking" erfordert, dass immer ein Menü angezeigt wird, abgesehen von dem kurzen Intervall, das zum Wechseln in ein neues Menü erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-227">Menu hot-tracking requires that a menu be displayed at all times, apart from the brief interval required to switch to a new menu.</span></span> <span data-ttu-id="c00aa-228">Allerdings ist das Dropdown Menü, das von [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) angezeigt wird, Modal.</span><span class="sxs-lookup"><span data-stu-id="c00aa-228">However, the drop-down menu that is displayed by [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) is modal.</span></span> <span data-ttu-id="c00aa-229">Ihre Anwendung empfängt weiterhin einige Nachrichten direkt, einschließlich [**WM- \_ Befehl**](/windows/desktop/menurc/wm-command), [TBN- \_ hotitemchange](tbn-hotitemchange.md)und normaler Menü bezogener Meldungen wie z. b. [**WM \_ MenuSelect**](/windows/desktop/menurc/wm-menuselect).</span><span class="sxs-lookup"><span data-stu-id="c00aa-229">Your application will continue to receive some messages directly, including [**WM\_COMMAND**](/windows/desktop/menurc/wm-command), [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md), and normal menu-related messages such as [**WM\_MENUSELECT**](/windows/desktop/menurc/wm-menuselect).</span></span> <span data-ttu-id="c00aa-230">Es werden jedoch keine Tastatur-oder Maus Nachrichten auf niedriger Ebene direkt empfangen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-230">However, it will not receive low-level keyboard or mouse messages directly.</span></span> <span data-ttu-id="c00aa-231">Um Nachrichten wie z. b. [**WM \_ MouseMove**](/windows/desktop/inputdev/wm-mousemove)zu verarbeiten, müssen Sie einen nachrichtenhook festlegen, um Nachrichten abzufangen, die an das Menü geleitet werden.</span><span class="sxs-lookup"><span data-stu-id="c00aa-231">To handle messages such as [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), you must set a message hook to intercept messages that are directed to the menu.</span></span>

<span data-ttu-id="c00aa-232">Wenn ein Dropdown Menü angezeigt wird, legen Sie den Nachrichten Hook fest, indem Sie die Funktion [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) aufrufen, wobei der *idhook* -Parameter auf WH \_ msgfilter festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="c00aa-232">When a drop-down menu is displayed, set the message hook by calling the [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) function with the *idHook* parameter set to WH\_MSGFILTER.</span></span> <span data-ttu-id="c00aa-233">Alle für das Menü vorgesehenen Meldungen werden an Ihre Hook- [Prozedur](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85))übermittelt.</span><span class="sxs-lookup"><span data-stu-id="c00aa-233">All messages intended for the menu will be passed to your [hook procedure](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)).</span></span> <span data-ttu-id="c00aa-234">Mit dem folgenden Code Fragment wird z. b. ein nachrichtenhook festgelegt, der Nachrichten abfängt, die in einem Dropdown Menü angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c00aa-234">For example, the following code fragment sets a message hook that will trap messages that are going to a drop-down menu.</span></span> <span data-ttu-id="c00aa-235">`MsgHook` der Name der Hook-Prozedur und `hhookMsg` ist das Handle der Prozedur.</span><span class="sxs-lookup"><span data-stu-id="c00aa-235">`MsgHook` is the name of the hook procedure, and `hhookMsg` is the handle to the procedure.</span></span>


```
hhookMsg = SetWindowsHookEx(WH_MSGFILTER, MsgHook, HINST_THISDLL, 0);
```



<span data-ttu-id="c00aa-236">Menü Meldungen werden identifiziert, indem der *nCode* -Parameter der Hook-Prozedur auf das MSGF-Menü festgelegt wird \_ .</span><span class="sxs-lookup"><span data-stu-id="c00aa-236">Menu messages are identified by setting the hook procedure's *nCode* parameter to MSGF\_MENU.</span></span> <span data-ttu-id="c00aa-237">Der *LPARAM* -Parameter verweist auf eine [**msg**](/windows/win32/api/winuser/ns-winuser-msg) -Struktur mit der Meldung.</span><span class="sxs-lookup"><span data-stu-id="c00aa-237">The *lParam* parameter will point to a [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) structure with the message.</span></span> <span data-ttu-id="c00aa-238">Die Details zu den Nachrichten, die behandelt werden müssen, und wie im weiteren Verlauf dieses Themas erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="c00aa-238">The details of which messages need to be handled, and how, are discussed in the remainder of this topic.</span></span>

<span data-ttu-id="c00aa-239">Die Anwendung muss alle Nachrichten an den nächsten Nachrichten Hook übergeben, indem Sie die [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-239">Your application must pass all messages on to the next message hook by calling the [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) function.</span></span> <span data-ttu-id="c00aa-240">Sie müssen auch Maus Nachrichten direkt an das Symbolleisten-Steuerelement senden, um alle Punkt Koordinaten in den Koordinaten Bereich der Symbolleiste zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="c00aa-240">You must also send mouse messages directly to the toolbar control, making sure to convert any point coordinates to the toolbar client coordinate space.</span></span> <span data-ttu-id="c00aa-241">Das direkte Senden von Nachrichten stellt sicher, dass das ToolBar-Steuerelement die entsprechenden Maus Meldungen empfängt.</span><span class="sxs-lookup"><span data-stu-id="c00aa-241">Sending the messages directly ensures that the toolbar control receives the appropriate mouse messages.</span></span> <span data-ttu-id="c00aa-242">Beispielsweise muss die Symbolleiste WM- [**\_ mousermove**](/windows/desktop/inputdev/wm-mousemove) -Nachrichten empfangen, um die Schaltflächen zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-242">For instance, the toolbar needs to receive [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in order to hot-track its buttons.</span></span>

<span data-ttu-id="c00aa-243">Wenn eine neue Schaltfläche aktiviert ist, muss die Anwendung das alte Dropdown Menü mit der Meldung " [**WM \_ cancelmode**](/windows/desktop/winmsg/wm-cancelmode) " reduzieren und ein neues Menü anzeigen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-243">When a new button is activated, your application must collapse the old drop-down menu with a [**WM\_CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) message, and display a new menu.</span></span> <span data-ttu-id="c00aa-244">Außerdem muss das Dropdown Menü reduziert werden, wenn der Fokus in der Menüleiste mit der Tastaturnavigation oder durch Klicken außerhalb des Menü Bereichs angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c00aa-244">It must also collapse the drop-down menu when focus is taken from the menu bar with keyboard navigation or by clicking outside the menu area.</span></span> <span data-ttu-id="c00aa-245">Wenn Sie ein Menü reduzieren, sollten Sie den Nachrichten Hook mithilfe der [**unhookwindowshookex**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) -Funktion freigeben.</span><span class="sxs-lookup"><span data-stu-id="c00aa-245">Whenever you collapse a menu, you should free its message hook by using the [**UnhookWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) function.</span></span> <span data-ttu-id="c00aa-246">Wenn Sie ein weiteres Dropdown Menü anzeigen müssen, erstellen Sie einen neuen nachrichtenhook.</span><span class="sxs-lookup"><span data-stu-id="c00aa-246">If you need to display another drop-down menu, create a new message hook.</span></span> <span data-ttu-id="c00aa-247">Wenn ein Befehl gestartet wird, wird das Menü automatisch reduziert, aber Sie müssen den nachrichtenhook explizit freigeben.</span><span class="sxs-lookup"><span data-stu-id="c00aa-247">When a command is launched, the menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="c00aa-248">Im folgenden Codebeispiel wird der Nachrichten Hook freigegeben, der im vorherigen Beispiel festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="c00aa-248">The following code example frees the message hook that was set in the previous example.</span></span>


```
UnhookWindowsHookEx(hhookMsg);
```



### <a name="mouse-navigation"></a><span data-ttu-id="c00aa-249">Maus Navigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-249">Mouse Navigation</span></span>

<span data-ttu-id="c00aa-250">Wenn ein normales Symbolleisten-Steuerelement mit der Schaltfläche "aktiv" nachverfolgt wird, wird die aktive Schaltfläche hervorgehoben, und die Anwendung wird bei jedem Aktivieren einer neuen Schaltfläche mit einer [TBN \_ ](tbn-hotitemchange.md) -Nachricht über die</span><span class="sxs-lookup"><span data-stu-id="c00aa-250">When a normal toolbar control hot-tracks buttons, it highlights the active button and sends the application a [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification each time a new button is activated.</span></span> <span data-ttu-id="c00aa-251">Ihre Anwendung ist dafür verantwortlich, das entsprechende Dropdown Menü anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-251">Your application is responsible for displaying the appropriate drop-down menu.</span></span> <span data-ttu-id="c00aa-252">Sie muss:</span><span class="sxs-lookup"><span data-stu-id="c00aa-252">It must:</span></span>

-   <span data-ttu-id="c00aa-253">Behandeln Sie die [TBN- \_ betitemchange](tbn-hotitemchange.md) -Benachrichtigung, um die aktive Schaltfläche nachzuverfolgen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-253">Handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="c00aa-254">Wenn sich die aktive Schaltfläche ändert, reduzieren Sie das alte Menü, und erstellen Sie ein neues.</span><span class="sxs-lookup"><span data-stu-id="c00aa-254">When the active button changes, collapse the old menu and create a new one.</span></span>
-   <span data-ttu-id="c00aa-255">Behandelt die [TBN- \_ Dropdown](tbn-dropdown.md) Benachrichtigung, die gesendet wird, wenn auf eine Schaltfläche geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="c00aa-255">Handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification that is sent when a button is clicked.</span></span> <span data-ttu-id="c00aa-256">Anschließend sollte das Menü reduziert und die Hot-Tracking-Menüs deaktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="c00aa-256">It should then collapse the menu and disable menu hot-tracking.</span></span> <span data-ttu-id="c00aa-257">Die Schaltfläche bleibt aktiv.</span><span class="sxs-lookup"><span data-stu-id="c00aa-257">The button remains active.</span></span>
-   <span data-ttu-id="c00aa-258">Behandeln Sie die Nachrichten " [**WM \_ lbuttondown**](/windows/desktop/inputdev/wm-lbuttondown)", " [**WM \_ rbuttondown**](/windows/desktop/inputdev/wm-rbuttondown)" und " [**WM \_ MouseMove**](/windows/desktop/inputdev/wm-mousemove) " in ihrer nachrichtenhook-Prozedur, um die Mausposition nachzuverfolgen.</span><span class="sxs-lookup"><span data-stu-id="c00aa-258">Handle the [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), [**WM\_RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown), and [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in your message hook procedure, to keep track of the mouse position.</span></span> <span data-ttu-id="c00aa-259">Wenn außerhalb des Menü Bereichs auf die Maus geklickt wird, reduzieren Sie das aktuelle Dropdown Menü, deaktivieren Sie die Menü-Hot-Tracking-Option, und geben Sie die Menüleiste in ihren voraktivierungs Zustand zurück.</span><span class="sxs-lookup"><span data-stu-id="c00aa-259">If the mouse is clicked outside the menu area, collapse the current drop-down menu, deactivate menu hot-tracking, and return the menu bar to its preactivation state.</span></span>
-   <span data-ttu-id="c00aa-260">Wenn ein Menübefehl gestartet wird, deaktivieren Sie das Menü "Hot-Tracking".</span><span class="sxs-lookup"><span data-stu-id="c00aa-260">When a menu command is launched, disable menu hot-tracking.</span></span> <span data-ttu-id="c00aa-261">Das Menü wird automatisch reduziert, aber Sie müssen den nachrichtenhook explizit freigeben.</span><span class="sxs-lookup"><span data-stu-id="c00aa-261">The menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="c00aa-262">Sie müssen auch Menü bezogenes Messaging verarbeiten, z. b. die " [**WM \_ initmenupopup**](/windows/desktop/menurc/wm-initmenupopup) "-Meldung, die gesendet wird, wenn ein Menü Element ein Untermenü anzeigen muss.</span><span class="sxs-lookup"><span data-stu-id="c00aa-262">You must also handle menu-related messaging, such as the [**WM\_INITMENUPOPUP**](/windows/desktop/menurc/wm-initmenupopup) message that is sent when a menu item needs to display a submenu.</span></span> <span data-ttu-id="c00aa-263">Eine Erläuterung dazu, wie solche Nachrichten behandelt werden, finden Sie unter [Menüs](/windows/desktop/menurc/menus).</span><span class="sxs-lookup"><span data-stu-id="c00aa-263">For a discussion of how to handle such messages, see [Menus](/windows/desktop/menurc/menus).</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="c00aa-264">Tastaturnavigation</span><span class="sxs-lookup"><span data-stu-id="c00aa-264">Keyboard Navigation</span></span>

<span data-ttu-id="c00aa-265">Die Anwendung muss Tastatur Meldungen in der Message Hook-Prozedur verarbeiten und auf diese reagieren, die sich auf die Menü-Hot-Tracking auswirken.</span><span class="sxs-lookup"><span data-stu-id="c00aa-265">Your application must process keyboard messages in the message hook procedure and act on those that affect menu hot-tracking.</span></span> <span data-ttu-id="c00aa-266">Die folgenden Tastendruck Punkte müssen behandelt werden:</span><span class="sxs-lookup"><span data-stu-id="c00aa-266">The following key presses must be handled:</span></span>

-   <span data-ttu-id="c00aa-267">Der escapeschlüssel.</span><span class="sxs-lookup"><span data-stu-id="c00aa-267">The ESCAPE key.</span></span> <span data-ttu-id="c00aa-268">Der escapeschlüssel sichert die Anzeige um eine Ebene nach oben.</span><span class="sxs-lookup"><span data-stu-id="c00aa-268">The ESCAPE key backs the display up one level.</span></span> <span data-ttu-id="c00aa-269">Wenn ein Untermenü angezeigt wird, muss es reduziert werden.</span><span class="sxs-lookup"><span data-stu-id="c00aa-269">If a submenu is being displayed, it must be collapsed.</span></span> <span data-ttu-id="c00aa-270">Wenn das primäre Menü einer Schaltfläche angezeigt wird, reduzieren Sie es, und deaktivieren Sie das Menü "Hot-Tracking".</span><span class="sxs-lookup"><span data-stu-id="c00aa-270">If a button's primary menu is displayed, collapse it and disable menu hot-tracking.</span></span> <span data-ttu-id="c00aa-271">Die Schaltfläche bleibt aktiv.</span><span class="sxs-lookup"><span data-stu-id="c00aa-271">The button remains active.</span></span>
-   <span data-ttu-id="c00aa-272">NACH-RECHTS-TASTE</span><span class="sxs-lookup"><span data-stu-id="c00aa-272">The RIGHT ARROW key.</span></span> <span data-ttu-id="c00aa-273">Wenn das Element über ein Untermenü verfügt, zeigen Sie es an.</span><span class="sxs-lookup"><span data-stu-id="c00aa-273">If the item has a submenu, display it.</span></span> <span data-ttu-id="c00aa-274">Wenn das Element nicht über ein Untermenü verfügt, reduzieren Sie das Menü und alle Untermenüs, aktivieren Sie die Schaltfläche weiter mit dem TB-Element, und zeigen Sie das zugehörige Menü an. [**\_**](tb-sethotitem.md)</span><span class="sxs-lookup"><span data-stu-id="c00aa-274">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="c00aa-275">Wenn die letzte Schaltfläche beim Empfang dieser Benachrichtigung aktiv war, zeigen Sie das Menü für die erste Schaltfläche an.</span><span class="sxs-lookup"><span data-stu-id="c00aa-275">If the last button was active when this notification was received, display the menu for the first button.</span></span>
-   <span data-ttu-id="c00aa-276">NACH-LINKS-TASTE</span><span class="sxs-lookup"><span data-stu-id="c00aa-276">The LEFT ARROW key.</span></span> <span data-ttu-id="c00aa-277">Wenn sich das Element in einem Untermenü befindet, reduzieren Sie es, und verschieben Sie den Fokus auf das übergeordnete Menü.</span><span class="sxs-lookup"><span data-stu-id="c00aa-277">If the item is in a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="c00aa-278">Wenn es sich bei dem Element nicht um ein Untermenü handelt, reduzieren Sie das Menü, aktivieren Sie die angrenzende Schaltfläche mit [**TB \_**](tb-sethotitem.md), und zeigen Sie das zugehörige Menü an.</span><span class="sxs-lookup"><span data-stu-id="c00aa-278">If the item is not a submenu, collapse the menu, activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="c00aa-279">Wenn die erste Schaltfläche beim Empfang dieser Benachrichtigung aktiv war, zeigen Sie das Menü für die letzte Schaltfläche an.</span><span class="sxs-lookup"><span data-stu-id="c00aa-279">If the first button was active when this notification was received, display the menu for the last button.</span></span>
-   <span data-ttu-id="c00aa-280">Die nach-oben-und nach-unten-Taste.</span><span class="sxs-lookup"><span data-stu-id="c00aa-280">The UP ARROW and DOWN ARROW keys.</span></span> <span data-ttu-id="c00aa-281">Diese Schlüssel werden verwendet, um in einem Menü zu navigieren, haben jedoch keine direkte Auswirkung auf die Hot-Tracking-Menüs.</span><span class="sxs-lookup"><span data-stu-id="c00aa-281">These keys are used to navigate within a menu but do not directly affect menu hot-tracking.</span></span>
-   <span data-ttu-id="c00aa-282">Eine Tastenkombination für Alt-*Taste* .</span><span class="sxs-lookup"><span data-stu-id="c00aa-282">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="c00aa-283">Verwenden Sie die [**TB- \_ mapaccelerernachricht**](tb-mapaccelerator.md) , um zu bestimmen, welcher Schaltfläche das *Schlüssel* Zeichen entspricht.</span><span class="sxs-lookup"><span data-stu-id="c00aa-283">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="c00aa-284">Wenn es sich um eine andere Schaltfläche als die derzeit aktive Schaltfläche handelt, reduzieren Sie das aktuelle Dropdown Menü, aktivieren Sie die neue Schaltfläche mit dem TB-Element, und zeigen Sie das Menü für die angrenzende Schaltfläche an. [**\_**](tb-sethotitem.md)</span><span class="sxs-lookup"><span data-stu-id="c00aa-284">If it corresponds to a different button than the currently active one, collapse the current drop-down menu, activate the new button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="c00aa-285">Wenn das *Schlüsselzeichen* der aktuell angezeigten Schaltfläche entspricht, reduzieren Sie das Dropdown Menü, und deaktivieren Sie das Menü "Hot-Tracking".</span><span class="sxs-lookup"><span data-stu-id="c00aa-285">If the *Key character* corresponds to the currently displayed button, collapse the drop-down menu and disable menu hot-tracking.</span></span> <span data-ttu-id="c00aa-286">Die Schaltfläche sollte aktiv bleiben.</span><span class="sxs-lookup"><span data-stu-id="c00aa-286">The button should remain active.</span></span>

 

 