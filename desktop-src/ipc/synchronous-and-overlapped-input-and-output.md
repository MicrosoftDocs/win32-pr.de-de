---
description: E/a-Vorgänge für synchrone Pipe und asynchrone Pipe-e/a. Die Funktionen ReadFile, Write File, transactnamedpipe und connectnamedpipe können Eingabe-und Ausgabe Vorgänge in einer Pipe entweder synchron oder asynchron ausführen.
ms.assetid: 5ab9bb7f-1f99-4041-bba8-2863f34dbcaf
title: Synchrone und überlappende Pipe-e/a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3becfb19dfe5fa49d4121246a576fb3200226b1a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106352735"
---
# <a name="synchronous-and-overlapped-pipe-io"></a><span data-ttu-id="bb3d7-104">Synchrone und überlappende Pipe-e/a</span><span class="sxs-lookup"><span data-stu-id="bb3d7-104">Synchronous and Overlapped Pipe I/O</span></span>

<span data-ttu-id="bb3d7-105">Die Funktionen [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile), [**Write File**](/windows/desktop/api/fileapi/nf-fileapi-writefile), [**transactnamedpipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-transactnamedpipe)und [**connectnamedpipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) können Eingabe-und Ausgabe Vorgänge in einer Pipe entweder synchron oder asynchron ausführen.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-105">The [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile), [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile), [**TransactNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-transactnamedpipe), and [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) functions can perform input and output operations on a pipe either synchronously or asynchronously.</span></span> <span data-ttu-id="bb3d7-106">Wenn eine Funktion synchron ausgeführt wird, wird Sie erst zurückgegeben, wenn der ausgeführte Vorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-106">When a function runs synchronously, it does not return until the operation it is performing is completed.</span></span> <span data-ttu-id="bb3d7-107">Dies bedeutet, dass die Ausführung des aufrufenden Threads für einen unbestimmten Zeitraum blockiert werden kann, während er darauf wartet, dass ein zeitaufwendiger Vorgang abgeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-107">This means that the execution of the calling thread can be blocked for an indefinite period while it waits for a time-consuming operation to be completed.</span></span> <span data-ttu-id="bb3d7-108">Wenn eine Funktion asynchron ausgeführt wird, wird Sie sofort zurückgegeben, auch wenn der Vorgang nicht abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-108">When a function runs asynchronously, it returns immediately, even if the operation has not been completed.</span></span> <span data-ttu-id="bb3d7-109">Dadurch kann ein zeitaufwändiger Vorgang im Hintergrund ausgeführt werden, während der aufrufende Thread kostenlos andere Aufgaben ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-109">This enables a time-consuming operation to be executed in the background while the calling thread is free to perform other tasks.</span></span>

<span data-ttu-id="bb3d7-110">Durch die Verwendung asynchroner e/a kann ein Pipeserver eine Schleife verwenden, die die folgenden Schritte ausführt:</span><span class="sxs-lookup"><span data-stu-id="bb3d7-110">Using asynchronous I/O enables a pipe server to use a loop that performs the following steps:</span></span>

1.  <span data-ttu-id="bb3d7-111">Geben Sie mehrere Ereignis Objekte in einem Rückruf der wait-Funktion an, und warten Sie, bis eines der Objekte auf den signalisierten Zustand festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-111">Specify multiple event objects in a call to the wait function, and wait for one of the objects to be set to the signaled state.</span></span>
2.  <span data-ttu-id="bb3d7-112">Verwenden Sie den Rückgabewert der wait-Funktion, um zu bestimmen, welcher überlappende Vorgang abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-112">Use the wait function's return value to determine which overlapped operation has finished.</span></span>
3.  <span data-ttu-id="bb3d7-113">Führen Sie die erforderlichen Aufgaben zum Bereinigen des abgeschlossenen Vorgangs aus, und initiieren Sie den nächsten Vorgang für dieses Pipehandle.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-113">Perform the tasks necessary to clean up the completed operation and initiate the next operation for that pipe handle.</span></span> <span data-ttu-id="bb3d7-114">Dies kann dazu führen, dass ein weiterer überlappende Vorgang für das gleiche Pipehandle gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-114">This can involve starting another overlapped operation for the same pipe handle.</span></span>

<span data-ttu-id="bb3d7-115">Überlappende Vorgänge ermöglichen es einer Pipe, gleichzeitig Daten zu lesen und zu schreiben, und für einen einzelnen Thread, um gleichzeitige e/a-Vorgänge für mehrere Pipehandles auszuführen.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-115">Overlapped operations make it possible for one pipe to read and write data simultaneously and for a single thread to perform simultaneous I/O operations on multiple pipe handles.</span></span> <span data-ttu-id="bb3d7-116">Dies ermöglicht es einem Single Thread-Pipe-Server, die Kommunikation mit mehreren Pipe-Clients effizient zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-116">This enables a single-threaded pipe server to handle communications with multiple pipe clients efficiently.</span></span> <span data-ttu-id="bb3d7-117">Ein Beispiel finden Sie unter [Named Pipe-Server mit über](named-pipe-server-using-overlapped-i-o.md)Lapp enden e/a-Vorgängen.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-117">For an example, see [Named Pipe Server Using Overlapped I/O](named-pipe-server-using-overlapped-i-o.md).</span></span>

<span data-ttu-id="bb3d7-118">Damit ein Pipe-Server synchrone Vorgänge für die Kommunikation mit mehr als einem Client verwendet, muss für jeden Pipeclient ein separater Thread erstellt werden, damit ein oder mehrere Threads ausgeführt werden können, während andere Threads warten.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-118">For a pipe server to use synchronous operations to communicate with more than one client, it must create a separate thread for each pipe client so that one or more threads can run while other threads are waiting.</span></span> <span data-ttu-id="bb3d7-119">Ein Beispiel für einen Multithread Pipe-Server, der synchrone Vorgänge verwendet, finden Sie unter [Multithread Pipe-Server](multithreaded-pipe-server.md).</span><span class="sxs-lookup"><span data-stu-id="bb3d7-119">For an example of a multithreaded pipe server that uses synchronous operations, see [Multithreaded Pipe Server](multithreaded-pipe-server.md).</span></span>

## <a name="enabling-asynchronous-operation"></a><span data-ttu-id="bb3d7-120">Aktivieren des asynchronen Vorgangs</span><span class="sxs-lookup"><span data-stu-id="bb3d7-120">Enabling Asynchronous Operation</span></span>

<span data-ttu-id="bb3d7-121">Die Funktionen " [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile)", " [**Write File**](/windows/desktop/api/fileapi/nf-fileapi-writefile)", " [**transactnamedpipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-transactnamedpipe)" und " [**connectnamedpipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) " können nur dann asynchron ausgeführt werden, wenn Sie den überlappenden Modus für das angegebene Pipehandle aktivieren und einen gültigen Zeiger auf eine [**über**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) Lapp Ende Struktur angeben.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-121">The [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile), [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile), [**TransactNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-transactnamedpipe), and [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) functions can be performed asynchronously only if you enable overlapped mode for the specified pipe handle and specify a valid pointer to an [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure.</span></span> <span data-ttu-id="bb3d7-122">Wenn der **über** Lapp Ende Zeiger **null** ist, kann der Rückgabewert der Funktion fälschlicherweise anzeigen, dass der Vorgang abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-122">If the **OVERLAPPED** pointer is **NULL**, the function return value can incorrectly indicate that the operation has been completed.</span></span> <span data-ttu-id="bb3d7-123">Daher wird dringend empfohlen, dass Sie immer eine gültige überlappende Struktur angeben, wenn Sie ein Handle mit überlappenden \_ Dateiflag erstellen \_ und das asynchrone Verhalten wünschen. </span><span class="sxs-lookup"><span data-stu-id="bb3d7-123">Therefore, it is strongly recommended that if you create a handle with FILE\_FLAG\_OVERLAPPED and want asynchronous behavior, you should always specify a valid **OVERLAPPED** structure.</span></span>

<span data-ttu-id="bb3d7-124">Das **hevent** -Element der angegebenen [**über**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) Lapp enden Struktur muss ein Handle für ein Ereignis Objekt für manuelles Zurücksetzen enthalten.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-124">The **hEvent** member of the specified [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure must contain a handle to a manual-reset event object.</span></span> <span data-ttu-id="bb3d7-125">Hierbei handelt es sich um ein Synchronisierungs Objekt [**, das von der Funktion**](/windows/desktop/api/synchapi/nf-synchapi-createeventa) "-Funktion</span><span class="sxs-lookup"><span data-stu-id="bb3d7-125">This is a synchronization object created by the [**CreateEvent**](/windows/desktop/api/synchapi/nf-synchapi-createeventa) function.</span></span> <span data-ttu-id="bb3d7-126">Der Thread, der den überlappenden Vorgang initiiert, verwendet das Ereignis Objekt, um zu bestimmen, wann der Vorgang abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-126">The thread that initiates the overlapped operation uses the event object to determine when the operation has finished.</span></span> <span data-ttu-id="bb3d7-127">Sie sollten das Pipehandle nicht für die Synchronisierung verwenden, wenn Sie gleichzeitige Vorgänge für denselben handle ausführen, da es keine Möglichkeit gibt, zu ermitteln, welcher Vorgang durchgeführt wurde, um den Pipehandle zu signalisieren.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-127">You should not use the pipe handle for synchronization when performing simultaneous operations on the same handle because there is no way of knowing which operation's completion caused the pipe handle to be signaled.</span></span> <span data-ttu-id="bb3d7-128">Die einzige zuverlässige Methode für die Ausführung gleichzeitiger Vorgänge auf demselben Pipehandle besteht darin, eine separate **über** Lapp Ende Struktur mit einem eigenen Ereignis Objekt für jeden Vorgang zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-128">The only reliable technique for performing simultaneous operations on the same pipe handle is to use a separate **OVERLAPPED** structure with its own event object for each operation.</span></span> <span data-ttu-id="bb3d7-129">Weitere Informationen zu Ereignis Objekten finden Sie unter [Synchronisierung](/windows/desktop/Sync/synchronization).</span><span class="sxs-lookup"><span data-stu-id="bb3d7-129">For more information about event objects, see [Synchronization](/windows/desktop/Sync/synchronization).</span></span>

<span data-ttu-id="bb3d7-130">Außerdem können Sie benachrichtigt werden, wenn ein überlappende Vorgang mit den Funktionen [**GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) oder [**getqueuedcompletionstatusex**](/windows/desktop/FileIO/getqueuedcompletionstatusex-func) abgeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-130">Also, you can be notified when an overlapped operation completes by using the [**GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) or [**GetQueuedCompletionStatusEx**](/windows/desktop/FileIO/getqueuedcompletionstatusex-func) functions.</span></span> <span data-ttu-id="bb3d7-131">In diesem Fall müssen Sie das manuelle Zurücksetzungs Ereignis nicht in der [**über**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) Lapp enden Struktur zuweisen, und der Abschluss erfolgt mit dem Pipehandle auf die gleiche Weise wie ein asynchroner Lese-oder Schreibvorgang.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-131">In this case, you do not need to assign the manual-reset event in the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure, and the completion happens against the pipe handle in the same way as an asynchronous read or write operation.</span></span> <span data-ttu-id="bb3d7-132">Weitere Informationen finden Sie unter e [/a-Abschlussports](/windows/desktop/FileIO/i-o-completion-ports).</span><span class="sxs-lookup"><span data-stu-id="bb3d7-132">For more information, see [I/O Completion Ports](/windows/desktop/FileIO/i-o-completion-ports).</span></span>

<span data-ttu-id="bb3d7-133">Bei der asynchronen Ausführung von [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile)-, [**Write File**](/windows/desktop/api/fileapi/nf-fileapi-writefile)-, [**transactnamedpipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-transactnamedpipe)-und [**connectnamedpipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) -Vorgängen tritt Folgendes auf:</span><span class="sxs-lookup"><span data-stu-id="bb3d7-133">When [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile), [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile), [**TransactNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-transactnamedpipe), and [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) operations are performed asynchronously, one of the following occurs:</span></span>

-   <span data-ttu-id="bb3d7-134">Wenn der Vorgang abgeschlossen ist, wenn die Funktion zurückgibt, gibt der Rückgabewert an, ob der Vorgang erfolgreich war oder fehlgeschlagen ist.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-134">If the operation is complete when the function returns, the return value indicates the success or failure of the operation.</span></span> <span data-ttu-id="bb3d7-135">Wenn ein Fehler auftritt, ist der Rückgabewert 0 (null), und die [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) -Funktion gibt etwas anderes als Fehler-e/a steht \_ \_ aus.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-135">If an error occurs, the return value is zero and the [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) function returns something other than ERROR\_IO\_PENDING.</span></span>
-   <span data-ttu-id="bb3d7-136">Wenn der Vorgang nicht abgeschlossen ist, wenn die Funktion zurückgibt, ist der Rückgabewert 0 (null) und [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) gibt eine ausstehende Fehler-e/a zurück \_ \_</span><span class="sxs-lookup"><span data-stu-id="bb3d7-136">If the operation has not finished when the function returns, the return value is zero and [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) returns ERROR\_IO\_PENDING.</span></span> <span data-ttu-id="bb3d7-137">In diesem Fall muss der aufrufende Thread warten, bis der Vorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-137">In this case, the calling thread must wait until the operation has finished.</span></span> <span data-ttu-id="bb3d7-138">Der aufrufende Thread muss dann die [**GetOverLappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) -Funktion aufrufen, um die Ergebnisse zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-138">The calling thread must then call the [**GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) function to determine the results.</span></span>

## <a name="using-completion-routines"></a><span data-ttu-id="bb3d7-139">Verwenden von Vervollständigungs Routinen</span><span class="sxs-lookup"><span data-stu-id="bb3d7-139">Using Completion Routines</span></span>

<span data-ttu-id="bb3d7-140">Die Funktionen "read [**fileex**](/windows/desktop/api/fileapi/nf-fileapi-readfileex) " und " [**Write fileex**](/windows/desktop/api/fileapi/nf-fileapi-writefileex) " bieten eine andere Form von überlappenden e/a-Vorgängen.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-140">The [**ReadFileEx**](/windows/desktop/api/fileapi/nf-fileapi-readfileex) and [**WriteFileEx**](/windows/desktop/api/fileapi/nf-fileapi-writefileex) functions provide another form of overlapped I/O.</span></span> <span data-ttu-id="bb3d7-141">Im Gegensatz zu den überlappenden Funktionen "read [**File**](/windows/desktop/api/fileapi/nf-fileapi-readfile) " und " [**Write File**](/windows/desktop/api/fileapi/nf-fileapi-writefile) ", die ein Ereignis Objekt verwenden, um den Abschluss zu signalisieren, geben die erweiterten Funktionen eine *Abschluss Routine* an.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-141">Unlike the overlapped [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) functions, which use an event object to signal completion, the extended functions specify a *completion routine*.</span></span> <span data-ttu-id="bb3d7-142">Eine Vervollständigungs Routine ist eine Funktion, die in die Warteschlange eingereiht wird, wenn der Lese-oder Schreibvorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-142">A completion routine is a function that is queued for execution when the read or write operation is finished.</span></span> <span data-ttu-id="bb3d7-143">Die Vervollständigungs Routine wird erst ausgeführt, wenn der Thread, der "read **fileex** " und " **Write fileex** " aufgerufen hat, einen Warn *baren warte Vorgang* startet, indem eine der [wartetabellenwartefunktionen](/windows/desktop/Sync/wait-functions) aufgerufen wird, bei denen der Parameter " *falertable* " auf **true**</span><span class="sxs-lookup"><span data-stu-id="bb3d7-143">The completion routine is not executed until the thread that called **ReadFileEx** and **WriteFileEx** starts an *alertable wait operation* by calling one of the [alertable wait functions](/windows/desktop/Sync/wait-functions) with the *fAlertable* parameter set to **TRUE**.</span></span> <span data-ttu-id="bb3d7-144">Bei einem Warteschlangen-Wait-Vorgang geben die Funktionen auch dann zurück, wenn eine "Write **fileex** "-oder " **Write fileex** "-Abschluss Routine zur Ausführung in die Warteschlange</span><span class="sxs-lookup"><span data-stu-id="bb3d7-144">In an alertable wait operation, the functions also return when a **ReadFileEx** or **WriteFileEx** completion routine is queued for execution.</span></span> <span data-ttu-id="bb3d7-145">Ein Pipeserver kann mithilfe der erweiterten Funktionen eine Sequenz von Lese-und Schreibvorgängen für jeden Client ausführen, der eine Verbindung mit dem Server herstellt.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-145">A pipe server can use the extended functions to perform a sequence of read and write operations for each client that connects to it.</span></span> <span data-ttu-id="bb3d7-146">Jeder Lese-oder Schreibvorgang in der Sequenz gibt eine Abschluss Routine an, und jede Abschluss Routine initiiert den nächsten Schritt in der Sequenz.</span><span class="sxs-lookup"><span data-stu-id="bb3d7-146">Each read or write operation in the sequence specifies a completion routine, and each completion routine initiates the next step in the sequence.</span></span> <span data-ttu-id="bb3d7-147">Ein Beispiel finden Sie unter [Named Pipe Server Using completion Routinen](named-pipe-server-using-completion-routines.md).</span><span class="sxs-lookup"><span data-stu-id="bb3d7-147">For an example, see [Named Pipe Server Using Completion Routines](named-pipe-server-using-completion-routines.md).</span></span>

 

 
