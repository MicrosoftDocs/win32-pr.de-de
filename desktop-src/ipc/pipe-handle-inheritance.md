---
description: Der Pipeserver steuert, ob seine Handles auf folgende Weise geerbt werden können.
ms.assetid: 72302f8b-f3a2-4efc-aab1-e596b8323984
title: Vererbung von Pipehandles
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 21cf91d4393b43011a2df632806f96da1e713b96
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103749672"
---
# <a name="pipe-handle-inheritance"></a><span data-ttu-id="0c07e-103">Vererbung von Pipehandles</span><span class="sxs-lookup"><span data-stu-id="0c07e-103">Pipe Handle Inheritance</span></span>

<span data-ttu-id="0c07e-104">Der Pipeserver steuert, ob seine Handles wie folgt geerbt werden können:</span><span class="sxs-lookup"><span data-stu-id="0c07e-104">The pipe server controls whether its handles can be inherited in the following ways:</span></span>

-   <span data-ttu-id="0c07e-105">Die Funktion " [**kreatepipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-createpipe) " empfängt eine Struktur von [**Sicherheits \_ Attributen**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="0c07e-105">The [**CreatePipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-createpipe) function receives a [**SECURITY\_ATTRIBUTES**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) structure.</span></span> <span data-ttu-id="0c07e-106">Wenn der Pipeserver den **binherithandle** -Member dieser Struktur auf " **true**" festlegt, können die von " **kreatepipe** " erstellten Handles geerbt werden.</span><span class="sxs-lookup"><span data-stu-id="0c07e-106">If the pipe server sets the **bInheritHandle** member of this structure to **TRUE**, the handles created by **CreatePipe** can be inherited.</span></span>
-   <span data-ttu-id="0c07e-107">Der Pipeserver kann die [**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) -Funktion verwenden, um die Vererbung eines Pipehandles zu ändern.</span><span class="sxs-lookup"><span data-stu-id="0c07e-107">The pipe server can use the [**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) function to change the inheritance of a pipe handle.</span></span> <span data-ttu-id="0c07e-108">Der Pipeserver kann ein nicht Vererb bares Duplikat eines vererbbaren Pipehandles oder ein Vererb bares Duplikat eines nicht vererbbaren Pipehandles erstellen.</span><span class="sxs-lookup"><span data-stu-id="0c07e-108">The pipe server can create a noninheritable duplicate of an inheritable pipe handle or an inheritable duplicate of a noninheritable pipe handle.</span></span>
-   <span data-ttu-id="0c07e-109">Mit der Funktion "up- [**Process**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) " kann der Pipeserver angeben, ob ein untergeordneter Prozess alle oder keine seiner vererbbaren Handles erbt.</span><span class="sxs-lookup"><span data-stu-id="0c07e-109">The [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function enables the pipe server to specify whether a child process inherits all or none of its inheritable handles.</span></span>

<span data-ttu-id="0c07e-110">Wenn ein untergeordneter Prozess ein Pipehandle erbt, ermöglicht das System dem Prozess den Zugriff auf die Pipe.</span><span class="sxs-lookup"><span data-stu-id="0c07e-110">When a child process inherits a pipe handle, the system enables the process to access the pipe.</span></span> <span data-ttu-id="0c07e-111">Der übergeordnete Prozess muss den Handle-Wert jedoch an den untergeordneten Prozess übermitteln.</span><span class="sxs-lookup"><span data-stu-id="0c07e-111">However, the parent process must communicate the handle value to the child process.</span></span> <span data-ttu-id="0c07e-112">Der übergeordnete Prozess bewirkt in der Regel, dass das Standardausgabe Handle an den untergeordneten Prozess umgeleitet wird, wie in den folgenden Schritten gezeigt:</span><span class="sxs-lookup"><span data-stu-id="0c07e-112">The parent process typically does this by redirecting the standard output handle to the child process, as shown in the following steps:</span></span>

1.  <span data-ttu-id="0c07e-113">Ruft die [**getstdhandle**](/windows/console/getstdhandle) -Funktion auf, um das aktuelle Standardausgabe Handle abzurufen. Speichern Sie dieses Handle, damit Sie das ursprüngliche Standardausgabe handle wiederherstellen können, nachdem der untergeordnete Prozess erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="0c07e-113">Call the [**GetStdHandle**](/windows/console/getstdhandle) function to get the current standard output handle; save this handle so you can restore the original standard output handle after the child process has been created.</span></span>
2.  <span data-ttu-id="0c07e-114">Aufrufen der [**setstdhandle**](/windows/console/setstdhandle) -Funktion zum Festlegen des Standardausgabe Handles auf das Schreib Handle der Pipe.</span><span class="sxs-lookup"><span data-stu-id="0c07e-114">Call the [**SetStdHandle**](/windows/console/setstdhandle) function to set the standard output handle to the write handle to the pipe.</span></span> <span data-ttu-id="0c07e-115">Nun kann der übergeordnete Prozess den untergeordneten Prozess erstellen.</span><span class="sxs-lookup"><span data-stu-id="0c07e-115">Now the parent process can create the child process.</span></span>
3.  <span data-ttu-id="0c07e-116">Ruft die [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) -Funktion auf, um das Schreib Handle für die Pipe zu schließen.</span><span class="sxs-lookup"><span data-stu-id="0c07e-116">Call the [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) function to close the write handle to the pipe.</span></span> <span data-ttu-id="0c07e-117">Nachdem der untergeordnete Prozess das Schreib handle erbt, benötigt der übergeordnete Prozess seine Kopie nicht mehr.</span><span class="sxs-lookup"><span data-stu-id="0c07e-117">After the child process inherits the write handle, the parent process no longer needs its copy.</span></span>
4.  <span data-ttu-id="0c07e-118">Aufrufen von [**setstdhandle**](/windows/console/setstdhandle) , um das ursprüngliche Standardausgabe handle wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="0c07e-118">Call [**SetStdHandle**](/windows/console/setstdhandle) to restore the original standard output handle.</span></span>

<span data-ttu-id="0c07e-119">Der untergeordnete Prozess verwendet die [**getstdhandle**](/windows/console/getstdhandle) -Funktion, um das Standardausgabe handle, das nun ein Handle für das schreibende einer Pipe ist, zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="0c07e-119">The child process uses the [**GetStdHandle**](/windows/console/getstdhandle) function to get its standard output handle, which is now a handle to the write end of a pipe.</span></span> <span data-ttu-id="0c07e-120">Der untergeordnete Prozess verwendet dann die Funktion " [**Write File**](/windows/desktop/api/fileapi/nf-fileapi-writefile) ", um die Ausgabe an die Pipe zu senden.</span><span class="sxs-lookup"><span data-stu-id="0c07e-120">The child process then uses the [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) function to send its output to the pipe.</span></span> <span data-ttu-id="0c07e-121">Wenn das untergeordnete Element mit der Pipe fertig ist, sollte es das Pipehandle schließen, indem [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) aufgerufen oder beendet wird, wodurch das Handle automatisch geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="0c07e-121">When the child has finished with the pipe, it should close the pipe handle by calling [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) or by terminating, which automatically closes the handle.</span></span>

<span data-ttu-id="0c07e-122">Der übergeordnete Prozess verwendet die Funktion zum [**Lesen von Dateien**](/windows/desktop/api/fileapi/nf-fileapi-readfile) , um Eingaben aus der Pipe zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="0c07e-122">The parent process uses the [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) function to receive input from the pipe.</span></span> <span data-ttu-id="0c07e-123">Daten werden als Datenstrom von Bytes in eine anonyme Pipe geschrieben.</span><span class="sxs-lookup"><span data-stu-id="0c07e-123">Data is written to an anonymous pipe as a stream of bytes.</span></span> <span data-ttu-id="0c07e-124">Dies bedeutet, dass der übergeordnete Prozess, der aus einer Pipe liest, nicht zwischen den in separaten Schreibvorgängen geschriebenen Bytes unterscheiden kann, es sei denn, die über-und untergeordneten Prozesse verwenden ein Protokoll, um anzugeben, wo der Schreibvorgang</span><span class="sxs-lookup"><span data-stu-id="0c07e-124">This means that the parent process reading from a pipe cannot distinguish between the bytes written in separate write operations, unless both the parent and child processes use a protocol to indicate where the write operation ends.</span></span> <span data-ttu-id="0c07e-125">Wenn alle Schreib Handles für die Pipe geschlossen sind, gibt die Funktion "read **File** " 0 (null) zurück.</span><span class="sxs-lookup"><span data-stu-id="0c07e-125">When all write handles to the pipe are closed, the **ReadFile** function returns zero.</span></span> <span data-ttu-id="0c07e-126">Es ist wichtig, dass der übergeordnete Prozess sein Handle bis zum schreibende der Pipe schließt, bevor "read **File**" aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="0c07e-126">It is important for the parent process to close its handle to the write end of the pipe before calling **ReadFile**.</span></span> <span data-ttu-id="0c07e-127">Wenn dies nicht erfolgt, kann der Vorgang zum **Lesen von Dateien** nicht 0 (null) zurückgeben, da der übergeordnete Prozess über ein geöffnetes Handle für das schreibende der Pipe verfügt.</span><span class="sxs-lookup"><span data-stu-id="0c07e-127">If this is not done, the **ReadFile** operation cannot return zero because the parent process has an open handle to the write end of the pipe.</span></span>

<span data-ttu-id="0c07e-128">Die Prozedur zum Umleiten des Standardeingabe Handles ähnelt der Vorgehensweise beim Umleiten des Standardausgabe Handles, mit dem Unterschied, dass das lesehandle der Pipe als Standardeingabe Handle des untergeordneten Elements verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="0c07e-128">The procedure for redirecting the standard input handle is similar to that for redirecting the standard output handle, except that the pipe's read handle is used as the child's standard input handle.</span></span> <span data-ttu-id="0c07e-129">In diesem Fall muss der übergeordnete Prozess sicherstellen, dass der untergeordnete Prozess den Schreib Handle der Pipe nicht erbt.</span><span class="sxs-lookup"><span data-stu-id="0c07e-129">In this case, the parent process must ensure that the child process does not inherit the pipe's write handle.</span></span> <span data-ttu-id="0c07e-130">Wenn dies nicht der Fall ist, kann der vom untergeordneten Prozess ausgeführte Vorgang zum [**Lesen von Dateien**](/windows/desktop/api/fileapi/nf-fileapi-readfile) keine NULL zurückgeben, da der untergeordnete Prozess über ein geöffnetes Handle für das schreibende der Pipe verfügt.</span><span class="sxs-lookup"><span data-stu-id="0c07e-130">If this is not done, the [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) operation performed by the child process cannot return zero because the child process has an open handle to the write end of the pipe.</span></span>

<span data-ttu-id="0c07e-131">Ein Beispielprogramm, das anonyme Pipes zum Umleiten der Standard Handles eines untergeordneten Prozesses verwendet, finden Sie unter [Erstellen eines untergeordneten Prozesses mit umgeleiteter Eingabe und Ausgabe](/windows/desktop/ProcThread/creating-a-child-process-with-redirected-input-and-output).</span><span class="sxs-lookup"><span data-stu-id="0c07e-131">For an example program that uses anonymous pipes to redirect the standard handles of a child process, see [Creating a Child Process with Redirected Input and Output](/windows/desktop/ProcThread/creating-a-child-process-with-redirected-input-and-output).</span></span>

 

 
