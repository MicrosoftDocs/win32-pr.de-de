---
title: Interagieren mit IMAPI
description: In den folgenden Schritten wird eine typische Interaktion zwischen einer Anwendung und IMAPI beschrieben.
ms.assetid: e57a86c4-7e27-40cf-a9c1-081b3f20d9d9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3e68bee24cfe0724ed14d439b0789f5023338853
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "103947787"
---
# <a name="interacting-with-imapi"></a><span data-ttu-id="06636-103">Interagieren mit IMAPI</span><span class="sxs-lookup"><span data-stu-id="06636-103">Interacting with IMAPI</span></span>

<span data-ttu-id="06636-104">In den folgenden Schritten wird eine typische Interaktion zwischen einer Anwendung und IMAPI beschrieben.</span><span class="sxs-lookup"><span data-stu-id="06636-104">The following steps describe a typical interaction between an application and IMAPI.</span></span>

1.  <span data-ttu-id="06636-105">Erstellen Sie eine Instanz von **msdiscmasterobj** (mithilfe von **cokreateinstance**, intelligenten Zeigern aus einem Import usw.), und fordern Sie die [**idiscmaster**](/windows/desktop/api/Imapi/nn-imapi-idiscmaster) -Schnittstelle an.</span><span class="sxs-lookup"><span data-stu-id="06636-105">Create an instance of the **MSDiscMasterObj** (using **CoCreateInstance**, smart pointers from an import, and so on) and request the [**IDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-idiscmaster) interface.</span></span>
2.  <span data-ttu-id="06636-106">Rufen Sie den Zugriff auf IMAPI durch Aufrufen von [**idiscmaster:: Open**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-open)ab.</span><span class="sxs-lookup"><span data-stu-id="06636-106">Acquire access to IMAPI by calling [**IDiscMaster::Open**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-open).</span></span> <span data-ttu-id="06636-107">Wenn dieser Vorgang erfolgreich ist, verfügt die Anwendung über Vollzugriff auf alle in **msdiscmasterobj** implementierten Schnittstellen und Methoden.</span><span class="sxs-lookup"><span data-stu-id="06636-107">If this call succeeds, the application has full access to all the interfaces and methods implemented in **MSDiscMasterObj**.</span></span>
3.  <span data-ttu-id="06636-108">Rufen Sie den Enumerator für den discmaster Format mithilfe von [**enumdiscmasterformats**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscmasterformats)ab.</span><span class="sxs-lookup"><span data-stu-id="06636-108">Retrieve the disc master format enumerator using [**EnumDiscMasterFormats**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscmasterformats).</span></span> <span data-ttu-id="06636-109">Listet die vom Disk-Master Objekt unterstützten Formate auf und wählt dann das aktive Format aus.</span><span class="sxs-lookup"><span data-stu-id="06636-109">Enumerate the set of formats that the disc master object supports, then select the active format.</span></span> <span data-ttu-id="06636-110">Bei den vom Enumerator zurückgegebenen Formaten handelt es sich um die IIDs der Schnittstellen für [**ijolietdiscmaster**](/windows/desktop/api/Imapi/nn-imapi-ijolietdiscmaster) und [**iredbookdiscmaster**](/windows/desktop/api/Imapi/nn-imapi-iredbookdiscmaster).</span><span class="sxs-lookup"><span data-stu-id="06636-110">The formats returned from the enumerator are the IIDs of the interfaces for [**IJolietDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-ijolietdiscmaster) and [**IRedbookDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-iredbookdiscmaster).</span></span>
4.  <span data-ttu-id="06636-111">Rufen Sie den Disk Recorder-Enumerator mithilfe von " [**enumdiskrecorder**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscrecorders)" ab.</span><span class="sxs-lookup"><span data-stu-id="06636-111">Retrieve the disc recorder enumerator using [**EnumDiscRecorders**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscrecorders).</span></span> <span data-ttu-id="06636-112">Auflisten Sie die Liste der unterstützten Festplatten Recorder (spezifisch für das aktive Format), und wählen Sie dann die aktive Aufzeichnung aus.</span><span class="sxs-lookup"><span data-stu-id="06636-112">Enumerate the list of supported disc recorders (specific to the active format), then select the active recorder.</span></span> <span data-ttu-id="06636-113">Die [**idiscrecorder**](/windows/desktop/api/Imapi/nn-imapi-idiscrecorder) -Schnittstelle stellt ein physisches Gerät dar.</span><span class="sxs-lookup"><span data-stu-id="06636-113">The [**IDiscRecorder**](/windows/desktop/api/Imapi/nn-imapi-idiscrecorder) interface represents a physical device.</span></span>
5.  <span data-ttu-id="06636-114">Verwenden Sie [**idiscmaster::P rogressrat**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-progressadvise) zum Registrieren für Fortschritts Rückrufe.</span><span class="sxs-lookup"><span data-stu-id="06636-114">Use [**IDiscMaster::ProgressAdvise**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-progressadvise) to register for progress callbacks.</span></span>
6.  <span data-ttu-id="06636-115">Verwenden Sie die-Schnittstelle für das ausgewählte Format, um Inhalt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="06636-115">Use the interface for the selected format to build up content.</span></span> <span data-ttu-id="06636-116">Inhalts Builds werden inkrementell erstellt, sodass Titel oder Ordnerinhalte einem Teil Scheiben Stück für Stück hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="06636-116">Content builds incrementally, so tracks or folder contents can be added to a disc piece by piece.</span></span> <span data-ttu-id="06636-117">Das aufbauen dieses Inhalts wird als *Staging eines Bilds* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="06636-117">Building up this content is called *staging an image*.</span></span> <span data-ttu-id="06636-118">Der Inhalt des bereitgestellten Abbilds kann nicht inkrementell gelöscht werden. (Sie können keinen hinzugefügten Titel entfernen, aber es ist möglich, den Inhalt eines gestaffelten Bilds zu löschen, damit das Staging wieder gestartet werden kann.</span><span class="sxs-lookup"><span data-stu-id="06636-118">The contents of the staged image cannot be incrementally deleted (you cannot remove a track that has been added), but it is possible to clear the contents of a staged image so that staging can start again.</span></span> <span data-ttu-id="06636-119">Verwenden Sie [**idiscmaster:: clearformatcontent**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-clearformatcontent) , um das Staging neu zu starten.</span><span class="sxs-lookup"><span data-stu-id="06636-119">Use [**IDiscMaster::ClearFormatContent**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-clearformatcontent) to restart staging.</span></span>

<span data-ttu-id="06636-120">**Für Audiodaten:  **</span><span class="sxs-lookup"><span data-stu-id="06636-120">**For Audio:  **</span></span>

1.  <span data-ttu-id="06636-121">Verwenden Sie [**iredbookdiscmaster:: kreateaudiotrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-createaudiotrack) , um anzugeben, dass ein neuer Audiotitel auf der Festplatte gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="06636-121">Use [**IRedbookDiscMaster::CreateAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-createaudiotrack) to indicate a new audio track is being started on the disc.</span></span>
2.  <span data-ttu-id="06636-122">Verwenden Sie [**iredbookdiscmaster:: addaudiotrackblocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-addaudiotrackblocks) , um einer Spur rohaudiodaten hinzuzufügen. Die Anwendung kann [**getavailableaudiotrackblocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getavailableaudiotrackblocks), [**gettotalaudioblocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-gettotalaudioblocks)und [**getusedaudioblocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getusedaudioblocks) zum Abrufen statistischer Informationen verwenden.</span><span class="sxs-lookup"><span data-stu-id="06636-122">Use [**IRedbookDiscMaster::AddAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-addaudiotrackblocks) to add raw audio data to a track. The application can use [**GetAvailableAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getavailableaudiotrackblocks), [**GetTotalAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-gettotalaudioblocks), and [**GetUsedAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getusedaudioblocks) to retrieve statistical information.</span></span>
3.  <span data-ttu-id="06636-123">Verwenden Sie [**iredbookdiscmaster:: closeaudiotrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-closeaudiotrack) , um eine Audiospur zu schließen.</span><span class="sxs-lookup"><span data-stu-id="06636-123">Use [**IRedbookDiscMaster::CloseAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-closeaudiotrack) to close an audio track.</span></span>
4.  <span data-ttu-id="06636-124">Wiederholen Sie die Schritte 1-3, bis kein Speicherplatz mehr vorhanden ist oder alle Audiospuren geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="06636-124">Repeat steps 1-3 until out of space or all audio tracks have been written.</span></span>

<span data-ttu-id="06636-125">**Für Daten:  **</span><span class="sxs-lookup"><span data-stu-id="06636-125">**For Data:  **</span></span>

1.  <span data-ttu-id="06636-126">Verwenden Sie [**ijolietdiscmaster:: AddData**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-adddata) , um den Inhalt eines Ordners dem Image hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="06636-126">Use [**IJolietDiscMaster::AddData**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-adddata) to add the contents of a folder to the image.</span></span> <span data-ttu-id="06636-127">Die Elemente in einem Ordner werden im Stammverzeichnis der Bilddatei abgelegt.</span><span class="sxs-lookup"><span data-stu-id="06636-127">The items within a folder are placed in the root of the image file.</span></span> <span data-ttu-id="06636-128">Verwenden Sie [**gettotaldatablocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-gettotaldatablocks) und [**getuseddatablocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-getuseddatablocks) , um statistische Informationen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="06636-128">Use [**GetTotalDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-gettotaldatablocks) and [**GetUsedDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-getuseddatablocks) to retrieve statistical information.</span></span>
2.  <span data-ttu-id="06636-129">Wiederholen Sie den obigen Schritt, bis Sie nicht mehr genügend Speicherplatz haben oder alle Daten hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="06636-129">Repeat the above step until out of space or all data has been added.</span></span>

<span data-ttu-id="06636-130">**Für alle-CDs:  **</span><span class="sxs-lookup"><span data-stu-id="06636-130">**For All Discs:  **</span></span>

1.  <span data-ttu-id="06636-131">Verwenden Sie [**idiscmaster:: recorddisk**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-recorddisc) , um die Festplatte aufzuzeichnen.</span><span class="sxs-lookup"><span data-stu-id="06636-131">Use [**IDiscMaster::RecordDisc**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-recorddisc) to record the disc.</span></span>
2.  <span data-ttu-id="06636-132">Schließen Sie die IMAPI-Sitzung mithilfe von [**idiscmaster:: Close**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-close).</span><span class="sxs-lookup"><span data-stu-id="06636-132">Close the IMAPI session using [**IDiscMaster::Close**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-close).</span></span> <span data-ttu-id="06636-133">Durch das Schließen der Sitzung wird der Inhalt des Datenträger-Stash gelöscht.</span><span class="sxs-lookup"><span data-stu-id="06636-133">Closing the session clears the contents of the disc stash.</span></span>

 

 




