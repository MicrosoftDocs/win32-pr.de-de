---
description: Wenn eine Anwendung eine Verbindung mit einem Hardware Gerät für die Windows-Abbild Beschaffung (WIA) herstellt, erstellt WIA eine Elementstruktur (eine hierarchische Struktur von iwiaitem-oder IWiaItem2-Schnittstellen), die das Gerät und seine Bilder, Ordner und Scanvorgänge darstellt.
ms.assetid: 2a7bcfd4-4075-48a4-9eff-5210b9a635e3
title: Auswählen eines Geräts (WIA)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 08a2eab41016397f6505e60efcbf78d1fdf82499
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103862671"
---
# <a name="selecting-a-device-wia"></a><span data-ttu-id="4a495-103">Auswählen eines Geräts (WIA)</span><span class="sxs-lookup"><span data-stu-id="4a495-103">Selecting a Device (WIA)</span></span>

<span data-ttu-id="4a495-104">Wenn eine Anwendung eine Verbindung mit einem Hardware Gerät für die Windows-Abbild Beschaffung (WIA) herstellt, erstellt WIA eine Elementstruktur (eine hierarchische Struktur von [**iwiaitem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) -oder [**IWiaItem2**](-wia-iwiaitem2.md) -Schnittstellen), die das Gerät und seine Bilder, Ordner und Scanvorgänge darstellt.</span><span class="sxs-lookup"><span data-stu-id="4a495-104">When an application connects to a Windows Image Acquisition (WIA) hardware device, WIA creates an item tree (a hierarchical tree of [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) interfaces) that represents the device and its images, folders, and scanning beds.</span></span> <span data-ttu-id="4a495-105">Eine Anwendung kann ein Gerät ohne Benutzereingabe auswählen und eine Verbindung mit ihm herstellen, oder es kann ein Dialogfeld angezeigt werden, in dem ein Benutzer ein Gerät auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="4a495-105">An application can select and connect to a device without user input, or it can display a dialog box that allows a user to select a device.</span></span>

-   [<span data-ttu-id="4a495-106">Auswählen eines Geräts ohne die Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="4a495-106">Selecting a Device Without the UI</span></span>](#selecting-a-device-without-the-ui)
-   [<span data-ttu-id="4a495-107">Auswählen eines Geräts mithilfe der Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="4a495-107">Selecting a Device With the UI</span></span>](#selecting-a-device-with-the-ui)

## <a name="selecting-a-device-without-the-ui"></a><span data-ttu-id="4a495-108">Auswählen eines Geräts ohne die Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="4a495-108">Selecting a Device Without the UI</span></span>

<span data-ttu-id="4a495-109">Führen Sie die folgenden Schritte aus, um ein WIA-Hardware Gerät auszuwählen und eine Verbindung mit ihm herzustellen.</span><span class="sxs-lookup"><span data-stu-id="4a495-109">Perform the following steps to select and connect to a WIA hardware device.</span></span>

-   <span data-ttu-id="4a495-110">Rufen Sie [cokreateinstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) auf, um einen Zeiger auf die [**iwiadevmgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) -oder [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) -Schnittstelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="4a495-110">Call [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to retrieve a pointer to the [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface.</span></span>
-   <span data-ttu-id="4a495-111">Verwenden Sie die [**iwiadevmgr:: enumdeviceinfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-enumdeviceinfo) -Methode der [**iwiadevmgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) -oder [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) -Schnittstelle, um einen Zeiger auf die [**ienumwia \_ dev \_ Info**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info) -Schnittstelle zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="4a495-111">Use the [**IWiaDevMgr::EnumDeviceInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-enumdeviceinfo) method of the [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface to obtain a pointer to the [**IEnumWIA\_DEV\_INFO**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info) interface.</span></span> <span data-ttu-id="4a495-112">Anweisungen zum Auflisten von Geräten finden Sie unter Auflisten von [System Geräten](-wia-enumerating-system-devices.md).</span><span class="sxs-lookup"><span data-stu-id="4a495-112">For instructions on how to enumerate devices, see [Enumerating System Devices](-wia-enumerating-system-devices.md).</span></span>
-   <span data-ttu-id="4a495-113">Verwenden Sie [**ienumwia \_ dev \_ Info**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info) Interface, um [**iwiapropertystorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) -Schnittstellen Zeiger für jedes aufgelistete WIA-Gerät abzurufen.</span><span class="sxs-lookup"><span data-stu-id="4a495-113">Use [**IEnumWIA\_DEV\_INFO**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_info) interface to obtain [**IWiaPropertyStorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) interface pointers for each WIA device enumerated.</span></span>
-   <span data-ttu-id="4a495-114">Verwenden Sie [**iwiapropertystorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) Interface, um die Geräte Informations Eigenschaften jedes Geräts zu überprüfen und die WIA \_ DIP \_ dev-ID- \_ Eigenschaft vom gewünschten Gerät zu speichern.</span><span class="sxs-lookup"><span data-stu-id="4a495-114">Use [**IWiaPropertyStorage**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) interface to inspect the device information properties of each device and save the WIA\_DIP\_DEV\_ID property from the desired device.</span></span>
-   <span data-ttu-id="4a495-115">Verwenden Sie die DeviceID-Eigenschaft mit der [**iwiadevmgr:: anatedevice**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-createdevice) -Methode in der [**iwiadevmgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) -oder [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) -Schnittstelle, um ein WIA-Geräte Objekt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="4a495-115">Use the DeviceID property with the [**IWiaDevMgr::CreateDevice**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-createdevice) method in the [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface to create a WIA device object.</span></span> <span data-ttu-id="4a495-116">Die **iwiadevmgr:: deatedevice** -Methode stellt der Anwendung den Zeiger auf die [**iwiaitem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) -oder [**IWiaItem2**](-wia-iwiaitem2.md) -Schnittstelle des Stamm Elements des angegebenen Geräts bereit.</span><span class="sxs-lookup"><span data-stu-id="4a495-116">The **IWiaDevMgr::CreateDevice** method provides the application with the pointer to the [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) interface of the root item of the specified device.</span></span>

<span data-ttu-id="4a495-117">Ein Beispiel dafür, wie Sie dies in einer Anwendung durchführen können, finden Sie im Abschnitt [Erstellen eines Geräts](-wia-creating-a-device.md) im Tutorial dieses Handbuchs.</span><span class="sxs-lookup"><span data-stu-id="4a495-117">For an example of how to do this in an application, see [Creating a Device](-wia-creating-a-device.md) in the tutorial section of this guide.</span></span>

## <a name="selecting-a-device-with-the-ui"></a><span data-ttu-id="4a495-118">Auswählen eines Geräts mithilfe der Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="4a495-118">Selecting a Device With the UI</span></span>

<span data-ttu-id="4a495-119">Nach dem Abrufen eines Zeigers auf [**iwiadevmgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr)kann eine Anwendung einem Benutzer ermöglichen, ein Gerät auszuwählen, indem er die restlichen Schritte überspringt und [**iwiadevmgr:: SelectDeviceDlg**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-selectdevicedlg)anruft.</span><span class="sxs-lookup"><span data-stu-id="4a495-119">After retrieving a pointer to [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr), an application can allow a user to select a device by skipping the rest of the above steps and calling [**IWiaDevMgr::SelectDeviceDlg**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-selectdevicedlg).</span></span> <span data-ttu-id="4a495-120">**Iwiadevmgr:: selectde vicedlg** zeigt ein Dialogfeld an, in dem der Benutzer ein WIA-Gerät auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="4a495-120">The **IWiaDevMgr::SelectDeviceDlg** displays a dialog box in which the user can select a WIA device.</span></span>

<span data-ttu-id="4a495-121">Es wird empfohlen, dass Anwendungen die Geräte-und Abbild Auswahl über ein Menü Element namens **von Scanner** im Menü **Datei** verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="4a495-121">It is recommended that applications make device and image selection available through a menu item named **From scanner** on the **File** menu.</span></span>

 

 
