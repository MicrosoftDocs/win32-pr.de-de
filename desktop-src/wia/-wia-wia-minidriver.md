---
description: Anwendungen sehen Windows-Abbild Erfassungsgeräte (WIA) als hierarchische Struktur von iwiaitem-oder IWiaItem2-Objekten mit dem Stamm Element, das das eigentliche Gerät darstellt.
ms.assetid: ae4ded93-09be-4caa-ad6e-1a9071fdb4b6
title: WIA-Mini Treiber
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5aadaf55cfe2e8102d4e0e02cf9787b9696e327
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104526411"
---
# <a name="wia-minidriver"></a><span data-ttu-id="628aa-103">WIA-Mini Treiber</span><span class="sxs-lookup"><span data-stu-id="628aa-103">WIA Minidriver</span></span>

<span data-ttu-id="628aa-104">Anwendungen sehen Windows-Abbild Erfassungsgeräte (WIA) als hierarchische Struktur von [**iwiaitem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) -oder [**IWiaItem2**](-wia-iwiaitem2.md) -Objekten mit dem Stamm Element, das das eigentliche Gerät darstellt.</span><span class="sxs-lookup"><span data-stu-id="628aa-104">Applications see Windows Image Acquisition (WIA) devices as a hierarchical tree of [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) objects with the root item representing the device itself.</span></span> <span data-ttu-id="628aa-105">WIA-Geräte können gleichzeitig von mehr als einer Anwendung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="628aa-105">WIA devices may be used concurrently by more than one application.</span></span> <span data-ttu-id="628aa-106">Daher ist es erforderlich, dass die Ansichten der einzelnen Anwendungen von **iwiaitem** -oder **IWiaItem2** -Objekten unabhängig von den Sichten einer anderen Anwendung sind.</span><span class="sxs-lookup"><span data-stu-id="628aa-106">It is therefore necessary that each application's view of an **IWiaItem** or **IWiaItem2** object be independent of another application's views.</span></span> <span data-ttu-id="628aa-107">Dies wird erreicht, indem zwei unterschiedliche Element Objekte vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="628aa-107">This is accomplished by having two different item objects.</span></span> <span data-ttu-id="628aa-108">Der Treiber erstellt mithilfe der WIA driver Services-Methoden die Treiber Elementstruktur von [iwiadrvitem Interface](https://msdn.microsoft.com/library/ms793976.aspx) Objects, auch als Treiber Elemente bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="628aa-108">The driver creates the driver item tree of [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) objects, also called driver items, using the WIA driver services methods.</span></span> <span data-ttu-id="628aa-109">Dabei handelt es sich um globale Objekte, die der Treiber zum Darstellen der internen Elemente jedes Treibers verwendet.</span><span class="sxs-lookup"><span data-stu-id="628aa-109">These are global objects that the driver uses to represent each driver's internal items.</span></span> <span data-ttu-id="628aa-110">Wenn eine Anwendung ein **iwiaitem** -oder **IWiaItem2** -Objekt (auch als Anwendungs Element bezeichnet) erstellt, wird dieses Objekt mit der entsprechenden [iwiadrvitem-Schnittstelle](https://msdn.microsoft.com/library/ms793976.aspx) des Treibers in der Treiber Elementstruktur verknüpft.</span><span class="sxs-lookup"><span data-stu-id="628aa-110">When an application creates an **IWiaItem** or **IWiaItem2** object (also called an application item), this object is linked to the driver's corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) in the driver item tree.</span></span> <span data-ttu-id="628aa-111">Für das [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekt, das den folgenden Regeln unterliegt, wird ein Verweis Zähler beibehalten:</span><span class="sxs-lookup"><span data-stu-id="628aa-111">A reference count is maintained on the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object subject to the following rules:</span></span>

-   <span data-ttu-id="628aa-112">Wenn ein Treiber der Treiber Elementstruktur ein [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekt hinzufügt, wird der Verweis Zähler des [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekts inkrementiert.</span><span class="sxs-lookup"><span data-stu-id="628aa-112">When a driver adds an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object to the driver item tree, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is incremented.</span></span> <span data-ttu-id="628aa-113">Dies erfolgt in der Regel bei [iwiaminidrv::d rvinitializewia](https://msdn.microsoft.com/library/ms794097.aspx) oder bei der Verarbeitung eines WIA \_ cmd- \_ Befehls zum Synchronisieren.</span><span class="sxs-lookup"><span data-stu-id="628aa-113">This typically takes place during [IWiaMiniDrv::drvInitializeWia](https://msdn.microsoft.com/library/ms794097.aspx) or when a WIA\_CMD\_SYNCHRONIZE command is processed.</span></span>
-   <span data-ttu-id="628aa-114">Wenn ein Treiber ein [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekt aus der Treiber Elementstruktur entfernt, wird der Verweis Zähler des [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekts dekrementiert, und das [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekt ist so gekennzeichnet, dass es nicht mehr auf das Gerät zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="628aa-114">When a driver removes an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object from the driver item tree, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is decremented and the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is marked so that it can't access the device again.</span></span> <span data-ttu-id="628aa-115">Dies geschieht in der Regel, wenn ein Gerät getrennt oder ein Element gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="628aa-115">This typically takes place when a device is disconnected or an item is deleted.</span></span> <span data-ttu-id="628aa-116">Anwendungen können weiterhin Eigenschaften aus einem [**iwiaitem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) -oder [**IWiaItem2**](-wia-iwiaitem2.md) -Objekt lesen, auch wenn das zugehörige [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekt aus der Treiber Elementstruktur entfernt wurde.</span><span class="sxs-lookup"><span data-stu-id="628aa-116">Applications are still able to read properties from an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object even when the corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object has been removed from the driver item tree.</span></span>
-   <span data-ttu-id="628aa-117">Wenn ein [**iwiaitem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) -oder [**IWiaItem2**](-wia-iwiaitem2.md) -Objekt erstellt wird, wird es mit einem entsprechenden [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekt verknüpft.</span><span class="sxs-lookup"><span data-stu-id="628aa-117">When an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object is created it is linked to a corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object.</span></span> <span data-ttu-id="628aa-118">Der Verweis Zähler des [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekts wird inkrementiert.</span><span class="sxs-lookup"><span data-stu-id="628aa-118">The reference count of the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is incremented.</span></span>
-   <span data-ttu-id="628aa-119">Wenn ein [**iwiaitem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) -oder [**IWiaItem2**](-wia-iwiaitem2.md) -Objekt freigegeben wird, wird der Link zum entsprechenden [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekt getrennt, und der Verweis Zähler des [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekts wird dekrementiert.</span><span class="sxs-lookup"><span data-stu-id="628aa-119">When an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object is released, the link to its corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is severed and the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is decremented.</span></span>
-   <span data-ttu-id="628aa-120">Wenn der Verweis Zähler eines [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekts auf NULL wechselt, wird das [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekt gelöscht.</span><span class="sxs-lookup"><span data-stu-id="628aa-120">If an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count goes to zero, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is deleted.</span></span> <span data-ttu-id="628aa-121">Dies gilt für alle [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekte einschließlich des Stamm Elements.</span><span class="sxs-lookup"><span data-stu-id="628aa-121">This applies to all [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) objects including the root item.</span></span> <span data-ttu-id="628aa-122">Der Verweis Zähler eines [iwiadrvitem-Schnittstellen](https://msdn.microsoft.com/library/ms793976.aspx) Objekts wird nur auf 0 (null) gesetzt, wenn keine Anwendungs Elemente darauf verweisen und es nicht mehr mit der Treiber Elementstruktur verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="628aa-122">An [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count only goes to zero when no application items reference it and it is no longer linked to the driver item tree.</span></span>

<span data-ttu-id="628aa-123">Mit diesem Verweis Zählschema können viele [**iwiaitem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) -oder [**IWiaItem2**](-wia-iwiaitem2.md) -Objekte ohne Störungen mit einer [iwiadrvitem-Schnittstelle](https://msdn.microsoft.com/library/ms793976.aspx) verknüpft werden.</span><span class="sxs-lookup"><span data-stu-id="628aa-123">Using this reference counting scheme, many [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) objects may link to one [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) without interference.</span></span> <span data-ttu-id="628aa-124">Da jedes **iwiaitem** oder **IWiaItem2** seinen eigenen Eigenschafts Speicher enthält, kann eine Anwendung weiterhin Element Eigenschaften lesen, auch nachdem ein Element gelöscht wurde, aber es ist kein Vorgang erforderlich, der Zugriff auf das Gerät erfordert.</span><span class="sxs-lookup"><span data-stu-id="628aa-124">Because each **IWiaItem** or **IWiaItem2** contains its own property storage, an application can continue to read item properties even after an item has been deleted, but no operation that requires access to the device will succeed.</span></span> <span data-ttu-id="628aa-125">Da Element Eigenschaften im **iwiaitem** -oder **IWiaItem2** -Objekt gespeichert werden, muss der Treiber die Eigenschaften des **iwiaitem** -oder **IWiaItem2** -Objekts vor einer Datenübertragung auf das Gerät festlegen.</span><span class="sxs-lookup"><span data-stu-id="628aa-125">Because item properties are stored in the **IWiaItem** or **IWiaItem2** object, the driver must set the **IWiaItem** or **IWiaItem2** object's properties to the device before a data transfer.</span></span>

 

 



