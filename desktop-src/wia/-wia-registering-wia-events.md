---
description: 'Anwendungen können sich registrieren, um über die Windows-Abbild Erfassung (WIA) Hardware Geräte Ereignisse benachrichtigt zu werden, indem Sie eine der folgenden iwiadevmgr-oder IWiaDevMgr2-Schnittstellen Methoden aufrufen: iwiadevmgr:: registereventcallbackclsid oder IWiaDevMgr2:: registereventcallbackclsidiwiadevmgr:: registereventcallbackinterface oder IWiaDevMgr2:: registereventcallbackinterfakeiwiadevmgr:: registereventcallbackprogram oder IWiaDevMgr2:: registereventcallbackprogram'
ms.assetid: 0c142083-835f-4bbd-ab32-eb6130f99c59
title: Registrieren von WIA-Ereignissen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa9fc36540a64211428579bc13b84902490ea103
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103958964"
---
# <a name="registering-wia-events"></a><span data-ttu-id="4dfd9-103">Registrieren von WIA-Ereignissen</span><span class="sxs-lookup"><span data-stu-id="4dfd9-103">Registering WIA Events</span></span>

<span data-ttu-id="4dfd9-104">Anwendungen können sich registrieren, um über die Windows-Abbild Erfassung (WIA) Hardware Geräte Ereignisse benachrichtigt zu werden, indem Sie eine der folgenden [**iwiadevmgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) -oder [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) -Schnittstellen Methoden aufrufen:</span><span class="sxs-lookup"><span data-stu-id="4dfd9-104">Applications can register to be notified of Windows Image Acquisition (WIA) hardware device events by calling one of the following [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface methods:</span></span>

-   <span data-ttu-id="4dfd9-105">[**Iwiadevmgr:: registereventcallbackclsid**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) oder [ **IWiaDevMgr2:: registereventcallbackclsid**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span><span class="sxs-lookup"><span data-stu-id="4dfd9-105">[**IWiaDevMgr::RegisterEventCallbackCLSID**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) or [**IWiaDevMgr2::RegisterEventCallbackCLSID**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span></span>
-   <span data-ttu-id="4dfd9-106">[**Iwiadevmgr:: registereventcallbackinterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) oder [ **IWiaDevMgr2:: registereventcallbackinterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span><span class="sxs-lookup"><span data-stu-id="4dfd9-106">[**IWiaDevMgr::RegisterEventCallbackInterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) or [**IWiaDevMgr2::RegisterEventCallbackInterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span></span>
-   <span data-ttu-id="4dfd9-107">[**Iwiadevmgr:: registereventcallbackprogram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) oder [ **IWiaDevMgr2:: registereventcallbackprogram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span><span class="sxs-lookup"><span data-stu-id="4dfd9-107">[**IWiaDevMgr::RegisterEventCallbackProgram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) or [**IWiaDevMgr2::RegisterEventCallbackProgram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span></span>

<span data-ttu-id="4dfd9-108">Alle diese Methoden akzeptieren Parameter, mit denen das Ereignis und das Hardware Gerät angegeben werden, für das die Anwendung benachrichtigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-108">All of these methods take parameters that specify the event and the hardware device for which the application is to be notified.</span></span> <span data-ttu-id="4dfd9-109">Anwendungen registrieren sich für den Empfang eines Ereignisses für alle WIA-Geräte, indem Sie einen **null** -Wert für den Parameter übergeben, der das Hardware Gerät angibt.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-109">Applications register to receive an event for all WIA devices by passing a **NULL** value for the parameter that specifies the hardware device.</span></span>

<span data-ttu-id="4dfd9-110">Mit der **registereventcallbackinterface** -Methode wird eine Anwendung zum Empfangen eines WIA-Hardware Geräte Ereignisses registriert, wenn die Anwendung zum Zeitpunkt des Ereignisses ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-110">The **RegisterEventCallbackInterface** method registers an application to receive a WIA hardware device event if the application is running at the time the event occurs.</span></span> <span data-ttu-id="4dfd9-111">Wenn das Ereignis, für das die Anwendung registriert ist, auftritt, ruft WIA die [**iwiaeventcallback:: imageeventcallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) -Methode des von der Anwendung bereitgestellten Objekts auf, um die Ereignis Informationen zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-111">When the event for which the application is registered occurs, WIA calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of the application-provided object to transmit the event information.</span></span>

<span data-ttu-id="4dfd9-112">Mit der **registereventcallbackclsid** -Methode wird eine Anwendung registriert, bei der es sich um eine registrierte Component Object Model COM-Komponente handelt, um ein WIA-Hardware Geräte Ereignis zu empfangen, auch wenn die Anwendung nicht ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-112">The **RegisterEventCallbackCLSID** method registers an application that is a registered Component Object Model (COM) component to receive a WIA hardware device event even if the application is not running.</span></span> <span data-ttu-id="4dfd9-113">Zusätzlich zu den zuvor erwähnten Parametern nimmt diese Methode den Parameter *pclsid* an, der die Klassen-ID der Anwendung angibt.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-113">In addition to the parameters mentioned previously, this method takes a parameter, *pClsID*, that specifies the class ID of the application.</span></span> <span data-ttu-id="4dfd9-114">Wenn das angegebene Ereignis auftritt, verwendet das WIA-System die [cokreateinstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion und die von *pclsid* angegebene Klassen-ID, um eine neue Instanz der Anwendung zu erstellen, und ruft die [**iwiaeventcallback:: imageeventcallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) -Methode dieser Anwendung auf, um die Ereignis Informationen zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-114">When the specified event occurs, the WIA system uses the [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function and the class ID specified by *pClsID* to create a new instance of the application, and calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of that application to transmit the event information.</span></span>

<span data-ttu-id="4dfd9-115">Mit der **registereventcallbackprogram** -Methode wird eine Anwendung zum Empfangen eines WIA-Hardware Geräte Ereignisses registriert, auch wenn die Anwendung nicht ausgeführt wird, wenn das Ereignis eintritt.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-115">The **RegisterEventCallbackProgram** method registers an application to receive a WIA hardware device event even if the application is not running when the event occurs.</span></span> <span data-ttu-id="4dfd9-116">Die Anwendung muss keine registrierte COM-Komponente sein.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-116">The application need not be a registered COM component.</span></span> <span data-ttu-id="4dfd9-117">WIA wird die Anwendung mit einer Befehlszeilen Anweisung gestartet.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-117">WIA launches the application with a command line statement.</span></span> <span data-ttu-id="4dfd9-118">**Registereventcallbackprogram** übernimmt den Parameter *bstrincommandline*, der den vollständigen Pfad und den Dateinamen der ausführbaren Anwendung angibt.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-118">**RegisterEventCallbackProgram** takes a parameter, *bstrCommandline*, that specifies the full path and filename of the executable application.</span></span> <span data-ttu-id="4dfd9-119">**Registereventcallbackprogram** ist für die Abwärtskompatibilität mit Anwendungen vorhanden, die nicht für WIA geschrieben wurden, und sollte vermieden werden.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-119">**RegisterEventCallbackProgram** exists for backward compatibility with applications that were not written for WIA, and should be avoided.</span></span> <span data-ttu-id="4dfd9-120">Verwenden Sie stattdessen **registereventcallbackinterface** oder **registereventcallbackclsid** .</span><span class="sxs-lookup"><span data-stu-id="4dfd9-120">Use **RegisterEventCallbackInterface** or **RegisterEventCallbackCLSID** instead.</span></span>

<span data-ttu-id="4dfd9-121">Um zu ermitteln, welche Handler für Ereignisse auf einem bestimmten WIA-Gerät registriert sind, ruft eine Anwendung eine [**iwiaitem:: enumregistereventinfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) -Methode oder [**IWiaItem2:: enumregistereventinfo**](-wia-iwiaitem2-enumregistereventinfo.md) -Methode eines Stamm Elements auf.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-121">To determine which handlers are registered for events on a specific WIA device, an application calls a [**IWiaItem::EnumRegisterEventInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) or [**IWiaItem2::EnumRegisterEventInfo**](-wia-iwiaitem2-enumregistereventinfo.md) method of a root item.</span></span> <span data-ttu-id="4dfd9-122">Diese Methode erstellt ein Enumerationsobjekt für die Registrierungsinformationen.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-122">This method creates an enumeration object for the registration information.</span></span> <span data-ttu-id="4dfd9-123">Die Anwendung kann dann die [**ienumwia \_ dev \_ Caps**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) -Schnittstelle dieses Objekts verwenden, um Informationen zu den Handlern aufzuzählen, die für den Empfang von Ereignissen für dieses Gerät registriert sind.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-123">The application can then use the [**IEnumWIA\_DEV\_CAPS**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) interface of that object to enumerate information about the handlers registered to receive events for that device.</span></span>

<span data-ttu-id="4dfd9-124">Wenn ein Ereignis auftritt, für das eine laufende Anwendung über **registereventcallbackinterface** und entweder **registereventcallbackclsid** oder **registereventcallbackprogram** registriert wird, WIA benachrichtigt die laufende Anwendung und versucht nicht, eine neue Instanz der Anwendung zu starten, da die Ereignis Registrierung über **registereventcallbackinterface** Vorrang vor " **registereventcallbackclsid** " und " **registereventcallbackprogram**" hat.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-124">If an event occurs for which a running application is registered through **RegisterEventCallbackInterface** and either **RegisterEventCallbackCLSID** or **RegisterEventCallbackProgram**, WIA notifies the running application and does not attempt to launch a new instance of the application because event registration through **RegisterEventCallbackInterface** takes precedence over both **RegisterEventCallbackCLSID** and **RegisterEventCallbackProgram**.</span></span>

> [!Note]  
> <span data-ttu-id="4dfd9-125">In einer Multithreadanwendung gibt es keine Garantie dafür, dass der Thread, den der Ereignis Benachrichtigungs Rückruf zurückgibt, derselbe Thread ist, der den Rückruf registriert hat.</span><span class="sxs-lookup"><span data-stu-id="4dfd9-125">In a multi-threaded application, there is no guarantee that the thread that the event notification callback will return on is the same thread that registered the callback.</span></span>

 

 

 
