---
title: Erstellen einer Windows Media Device Manager-Anwendung
description: Erstellen einer Windows Media Device Manager-Anwendung
ms.assetid: 6a200bd9-19dd-4130-acb4-e038b469c334
keywords:
- Windows Media Device Manager, Erstellen von Anwendungen
- Device Manager, Erstellen von Anwendungen
- Windows Media Device Manager, Programmier Handbuch
- Device Manager, Programmier Handbuch
- Programmier Handbuch, Desktop Anwendungen
- Programmier Handbuch, Windows Media Device Manager
- Programmier Handbuch, Plug-ins
- Programmier Handbuch, Erstellen von Anwendungen
- Windows Media Device Manager, Desktop Anwendungen
- Device Manager, Desktop Anwendungen
- Windows Media Device Manager, Plug-ins
- Device Manager, Plug-in
- Plug-ins, erstellen
- Plug-ins, Programmier Handbuch
- Desktop Anwendungen, erstellen
- Erstellen von Windows Media Device Manager-Anwendungen, Informationen zu
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b50a2dfce057b993f84c0aca4c8f45796f67ba8
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "106340205"
---
# <a name="creating-a-windows-media-device-manager-application"></a><span data-ttu-id="de597-119">Erstellen einer Windows Media Device Manager-Anwendung</span><span class="sxs-lookup"><span data-stu-id="de597-119">Creating a Windows Media Device Manager Application</span></span>

<span data-ttu-id="de597-120">In diesem Abschnitt wird beschrieben, wie Sie Windows Media Device Manager in der Anwendung verwenden.</span><span class="sxs-lookup"><span data-stu-id="de597-120">This section describes how to use Windows Media Device Manager in your application.</span></span> <span data-ttu-id="de597-121">Der Begriff "Anwendung" bedeutet hier entweder eine ausführbare Datei, z. b. einen Media Player oder ein com-Plug-in, z. b. ein Messungs-Plug-in.</span><span class="sxs-lookup"><span data-stu-id="de597-121">The term "application" here means either an executable, such as a media player, or a COM plug-in, such as a metering plug-in.</span></span>

<span data-ttu-id="de597-122">Microsoft umfasst mehrere Dienstanbieter mit Windows XP und Windows Media Player 10, darunter einen MTP-Dienstanbieter, einen Windows CE Dienstanbieter (für Geräte mit Windows CE und mithilfe des RAPI-Protokolls (z. b. Pocket PC) und einen Dienstanbieter für MSC-Geräte (Massenspeicher Kategorie).</span><span class="sxs-lookup"><span data-stu-id="de597-122">Microsoft includes several service providers with Windows XP and Windows Media Player 10, including an MTP service provider, a Windows CE service provider (for devices running Windows CE and using the RAPI protocol, such as the Pocket PC), and a service provider for mass-storage category (MSC) devices.</span></span> <span data-ttu-id="de597-123">Sie können auch einen eigenen Dienstanbieter erstellen, um die Kommunikation mit Ihrem eigenen Gerät sicherzustellen. Weitere Informationen finden Sie unter [Erstellen eines Dienstanbieters](creating-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="de597-123">You can also create your own service provider to ensure communication with your own device; for more information, see [Creating a Service Provider](creating-a-service-provider.md).</span></span>

<span data-ttu-id="de597-124">Es gibt eine Reihe von Legacy Dienstanbietern von Drittanbietern, die die nicht-MTP-, nicht-RAPI-oder nicht-MSC-Geräte eines bestimmten Herstellers adressieren.</span><span class="sxs-lookup"><span data-stu-id="de597-124">There are a number of third-party legacy service providers that address a particular manufacturer's non-MTP, non-RAPI, or non-MSC device.</span></span> <span data-ttu-id="de597-125">Diese Dienstanbieter sind auf dem Treiber Datenträger enthalten, der mit diesen Geräten ausgeliefert wird.</span><span class="sxs-lookup"><span data-stu-id="de597-125">These service providers are included on the driver disk shipped with these devices.</span></span>

<span data-ttu-id="de597-126">Eine Anwendung, die Windows Media Device Manager verwendet, muss die folgenden Schritte ausführen.</span><span class="sxs-lookup"><span data-stu-id="de597-126">An application that uses Windows Media Device Manager must perform the following steps.</span></span>

1.  <span data-ttu-id="de597-127">**Erkennen von Datenschutzproblemen, die mit der Entwicklung einer Anwendung verbunden sind.**</span><span class="sxs-lookup"><span data-stu-id="de597-127">**Become aware of privacy issues involved with developing an application.**</span></span> <span data-ttu-id="de597-128">In der [Datenschutzerklärung](privacy-statement.md) finden Sie Informationen zu einigen Datenschutzproblemen im Zusammenhang mit der Entwicklung einer Windows Media Device Manager Anwendung</span><span class="sxs-lookup"><span data-stu-id="de597-128">See [Privacy Statement](privacy-statement.md) to learn about some privacy issues involving developing a Windows Media Device Manager application.</span></span>
2.  <span data-ttu-id="de597-129">**Fügen Sie die erforderlichen Bibliotheks-und Header Dateien für die Anwendung ein.**</span><span class="sxs-lookup"><span data-stu-id="de597-129">**Include the required library and header files for your application.**</span></span> <span data-ttu-id="de597-130">Informationen zu den Dateien, die Sie in Ihr Projekt einschließen müssen, finden Sie unter [erforderliche Bibliothek-und Header Dateien für eine Anwendung](required-library-and-header-files-for-an-application.md) .</span><span class="sxs-lookup"><span data-stu-id="de597-130">See [Required Library and Header Files for an Application](required-library-and-header-files-for-an-application.md) to learn what files you will need to include in your project.</span></span>
3.  <span data-ttu-id="de597-131">**Authentifizieren Sie die Anwendung, und rufen Sie die Hauptschnittstelle von iwmdmdevice ab.**</span><span class="sxs-lookup"><span data-stu-id="de597-131">**Authenticate the application and acquire the root IWMDMDevice interface.**</span></span> <span data-ttu-id="de597-132">Die erste Aufgabe, die eine Anwendung für die Verwendung von Windows Media Device Manager ausführen muss, besteht darin, sich zu authentifizieren.</span><span class="sxs-lookup"><span data-stu-id="de597-132">The first task an application must do to use Windows Media Device Manager is to authenticate itself.</span></span> <span data-ttu-id="de597-133">Bei diesem Vorgang wird die Identität der Anwendung auf Windows Media-Device Manager mithilfe eines Dummy-Zertifikats für eingeschränkte Windows Media Device Manager-Funktionen überprüft, oder es wird ein offizielles Zertifikat für die vollständige Funktionalität verwendet.</span><span class="sxs-lookup"><span data-stu-id="de597-133">This process verifies the identity of the application to Windows Media Device Manager using a dummy certificate for limited Windows Media Device Manager functionality, or using an official certificate for full functionality.</span></span> <span data-ttu-id="de597-134">Weitere Informationen finden Sie unter [Authentifizieren der Anwendung](authenticating-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="de597-134">For more information, see [Authenticating the Application](authenticating-the-application.md).</span></span>
4.  <span data-ttu-id="de597-135">**Listet die verbundenen Geräte auf.**</span><span class="sxs-lookup"><span data-stu-id="de597-135">**Enumerate the connected devices.**</span></span> <span data-ttu-id="de597-136">Der erste Schritt bei der Kommunikation mit Geräten besteht darin herauszufinden, welche Geräte verbunden sind und für Windows Media Device Manager zugänglich sind.</span><span class="sxs-lookup"><span data-stu-id="de597-136">The first step in communicating with devices is to find out what devices are connected and accessible to Windows Media Device Manager.</span></span> <span data-ttu-id="de597-137">Weitere Informationen finden Sie unter Auflisten von [Geräten](enumerating-devices.md).</span><span class="sxs-lookup"><span data-stu-id="de597-137">For more information, see [Enumerating Devices](enumerating-devices.md).</span></span>
5.  <span data-ttu-id="de597-138">**Überprüfen Sie den Status der DRM-Komponenten des Geräts.**</span><span class="sxs-lookup"><span data-stu-id="de597-138">**Check the status of the device's DRM components.**</span></span> <span data-ttu-id="de597-139">Zum Verwenden von DRM-geschützten Dateien muss ein Gerät auf einer bestimmten Version von Windows Media DRM für tragbare Geräte erstellt werden, und die DRM-Komponenten müssen auf dem neuesten Stand sein.</span><span class="sxs-lookup"><span data-stu-id="de597-139">To use DRM-protected files, a device must be built on some version of Windows Media DRM for Portable Devices, and the DRM components must be up to date.</span></span> <span data-ttu-id="de597-140">Bevor Sie mit der Verarbeitung von Dateien auf dem Gerät beginnen, sollten Sie überprüfen, ob das Gerät von DRM geschützte Dateien unterstützt und ob das Gerät aktualisiert werden muss.</span><span class="sxs-lookup"><span data-stu-id="de597-140">Before you begin handling files on the device, it is best to see if the device supports DRM-protected files, and whether the device needs to be updated.</span></span> <span data-ttu-id="de597-141">Weitere Informationen finden Sie unter [behandeln geschützter Inhalte in der Anwendung](handling-protected-content-in-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="de597-141">For more information, see [Handling Protected Content in the Application](handling-protected-content-in-the-application.md).</span></span>
6.  <span data-ttu-id="de597-142">**Erkunden Sie ein Gerät.**</span><span class="sxs-lookup"><span data-stu-id="de597-142">**Explore a device.**</span></span> <span data-ttu-id="de597-143">Nachdem Sie das gewünschte Gerät gefunden haben, können Sie den Inhalt dieses Geräts überprüfen.</span><span class="sxs-lookup"><span data-stu-id="de597-143">After you have found the device you want, you can explore the contents of that device.</span></span> <span data-ttu-id="de597-144">Weitere Informationen finden Sie unter unter [Suchen eines Geräts](exploring-a-device.md).</span><span class="sxs-lookup"><span data-stu-id="de597-144">For more information, see [Exploring a Device](exploring-a-device.md).</span></span>
7.  <span data-ttu-id="de597-145">**Lesen von Dateien vom Gerät und Schreiben von Dateien auf das Gerät.**</span><span class="sxs-lookup"><span data-stu-id="de597-145">**Read files from the device, and write files to the device.**</span></span> <span data-ttu-id="de597-146">Nachdem Sie das Layout des Geräts kennen, können Sie mit dem Übertragen von Dateien auf das und vom Gerät beginnen.</span><span class="sxs-lookup"><span data-stu-id="de597-146">After you know about the layout of the device, you can begin transferring files to and from the device.</span></span> <span data-ttu-id="de597-147">Weitere Informationen finden Sie unter [Lesen von Dateien vom Gerät](reading-files-from-the-device.md) und [Schreiben von Dateien auf das Gerät](writing-files-to-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="de597-147">For more information, see [Reading Files from the Device](reading-files-from-the-device.md) and [Writing Files to the Device](writing-files-to-the-device.md).</span></span>
8.  <span data-ttu-id="de597-148">**Erstellen von Wiedergabelisten auf dem Gerät.**</span><span class="sxs-lookup"><span data-stu-id="de597-148">**Create playlists on the device.**</span></span> <span data-ttu-id="de597-149">Eine Datei, die Sie auf das Gerät schreiben können, ist eine abstrakte Datei, die eine Auflistung von Verweisen auf andere Dateien ist.</span><span class="sxs-lookup"><span data-stu-id="de597-149">One kind of file you can write to the device is an abstract file, which is a collection of references to other files.</span></span> <span data-ttu-id="de597-150">Die Möglichkeit, abstrakte Dateien auf ein Gerät zu schreiben, hängt zwar vom Dienstanbieter und vom Gerät ab, aber im Allgemeinen haben nur MTP-Geräte diese Funktion.</span><span class="sxs-lookup"><span data-stu-id="de597-150">Although the ability to write abstract files to a device depends on the service provider and the device, generally only MTP devices have this capability.</span></span> <span data-ttu-id="de597-151">Weitere Informationen finden Sie unter [Erstellen einer Wiedergabeliste auf dem Gerät](creating-a-playlist-on-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="de597-151">For more information, see [Creating a Playlist on the Device](creating-a-playlist-on-the-device.md).</span></span>

<span data-ttu-id="de597-152">Zusätzlich zu diesen Schritten gibt es mehrere weitere Funktionen, die Sie in Ihrer Anwendung aktivieren können:</span><span class="sxs-lookup"><span data-stu-id="de597-152">In addition to these steps, there are several more features that you can enable in your application:</span></span>

-   <span data-ttu-id="de597-153">**Benachrichtigungen.**</span><span class="sxs-lookup"><span data-stu-id="de597-153">**Notifications.**</span></span> <span data-ttu-id="de597-154">Sie können Ihre Anwendung für den Empfang von Benachrichtigungen aktivieren, wenn Geräte eine Verbindung mit dem Computer herstellen oder diese trennen.</span><span class="sxs-lookup"><span data-stu-id="de597-154">You can enable your application to receive notifications when devices connect or disconnect from the computer.</span></span> <span data-ttu-id="de597-155">Weitere Informationen finden Sie unter [Aktivieren von Benachrichtigungen](enabling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="de597-155">For more information, see [Enabling Notifications](enabling-notifications.md).</span></span>
-   <span data-ttu-id="de597-156">**Protokollierung:**</span><span class="sxs-lookup"><span data-stu-id="de597-156">**Logging.**</span></span> <span data-ttu-id="de597-157">Windows Media Device Manager verwendet ein Protokollierungs Objekt, das einen Datensatz seiner Aktionen in einer lokalen Textdatei speichert.</span><span class="sxs-lookup"><span data-stu-id="de597-157">Windows Media Device Manager uses a logging object that saves a record of its actions to a local text file.</span></span> <span data-ttu-id="de597-158">Sie können diesem Protokollmeldungen hinzufügen, um die Analyse von Fehlern oder der Leistung in Ihrer Anwendung zu erleichtern.</span><span class="sxs-lookup"><span data-stu-id="de597-158">You can add messages to this log to help you analyze errors or performance in your application.</span></span> <span data-ttu-id="de597-159">Weitere Informationen finden Sie unter [Aktivieren der Protokollierung](enabling-logging.md).</span><span class="sxs-lookup"><span data-stu-id="de597-159">For more information, see [Enabling Logging](enabling-logging.md).</span></span>
-   <span data-ttu-id="de597-160">**Verwendung der Messungs Inhalte.**</span><span class="sxs-lookup"><span data-stu-id="de597-160">**Metering content usage.**</span></span> <span data-ttu-id="de597-161">Sie können Statistiken zur Inhalts Verwendung für Lizenzen abrufen, die dieses Recht erteilen.</span><span class="sxs-lookup"><span data-stu-id="de597-161">You can retrieve content usage statistics for licenses that grant this right.</span></span> <span data-ttu-id="de597-162">Diese Statistiken können dann an einen Webserver gesendet werden, um die Lizenzgebühren für Inhalts Besitzer zu berechnen.</span><span class="sxs-lookup"><span data-stu-id="de597-162">These statistics can then be sent up to a Web server to calculate royalty payments to content owners.</span></span> <span data-ttu-id="de597-163">Weitere Informationen finden Sie unter [Messungs Inhalts Verwendung](metering-content-usage.md).</span><span class="sxs-lookup"><span data-stu-id="de597-163">For more information, see [Metering Content Usage](metering-content-usage.md).</span></span>

<span data-ttu-id="de597-164">**Vorsicht beachten**</span><span class="sxs-lookup"><span data-stu-id="de597-164">**A note of caution**</span></span>

<span data-ttu-id="de597-165">Möglicherweise muss Ihre Anwendung mit einer Vielzahl von Geräten arbeiten, einschließlich einiger, die Sie nicht entwickelt haben und deren Code Sie noch nie getestet haben.</span><span class="sxs-lookup"><span data-stu-id="de597-165">Your application may need to work with a variety of devices, including some that you have not developed and have never tested your code against.</span></span> <span data-ttu-id="de597-166">Diese Geräte reagieren möglicherweise nicht genau auf Abfragen und Befehle oder implementieren MTP oder andere Spezifikationen.</span><span class="sxs-lookup"><span data-stu-id="de597-166">These devices might or might not accurately respond to queries and commands, or implement MTP or other specifications.</span></span> <span data-ttu-id="de597-167">Stellen Sie sicher, dass Sie eine robuste Fehlerüberprüfung und Fall Back Funktion einschließen, um die unerwartete zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="de597-167">Be sure to include robust error checking and fallback functionality to deal with the unexpected.</span></span> <span data-ttu-id="de597-168">Programm defensiv.</span><span class="sxs-lookup"><span data-stu-id="de597-168">Program defensively.</span></span>

## <a name="related-topics"></a><span data-ttu-id="de597-169">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="de597-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="de597-170">**Programmierhandbuch**</span><span class="sxs-lookup"><span data-stu-id="de597-170">**Programming Guide**</span></span>](programming-guide.md)
</dt> </dl>

 

 




