---
title: Architektur von Windows Media Device Manager
description: Architektur von Windows Media Device Manager
ms.assetid: 3c1b2da4-559d-427b-b502-5ef8dc055a8e
keywords:
- Windows Media-Device Manager, Architektur
- Device Manager, Architektur
- Architektur für Windows Media Device Manager
- Windows Media Device Manager, Desktop Anwendungen
- Device Manager, Desktop Anwendungen
- Windows Media Device Manager, Dienstanbieter
- Device Manager, Dienstanbieter
- Windows Media Device Manager, Plug-ins
- Device Manager, Plug-ins
- Desktop Anwendungen, Windows Media Device Manager-Architektur
- Dienstanbieter, Windows Media Device Manager-Architektur
- Plug-ins, Windows Media Device Manager-Architektur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9fda87e4ed4bce2c82bbb9c0863c119851965940
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104206488"
---
# <a name="windows-media-device-manager-architecture"></a><span data-ttu-id="4f8a9-115">Architektur von Windows Media Device Manager</span><span class="sxs-lookup"><span data-stu-id="4f8a9-115">Windows Media Device Manager Architecture</span></span>

<span data-ttu-id="4f8a9-116">Mithilfe von Windows Media Device Manager kann eine Anwendung oder ein Plug-in mit einem Gerät kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-116">Windows Media Device Manager enables an application or plug-in to communicate with a device.</span></span> <span data-ttu-id="4f8a9-117">Anwendungen können Geräte Metadaten anfordern, angeschlossene Geräte aufzählen und durchsuchen und Objekte (Ordner, Dateien, Wiedergabelisten usw.) senden oder empfangen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-117">Applications can request device metadata, enumerate and explore attached devices, and send or receive objects (folders, files, playlists, and so on).</span></span> <span data-ttu-id="4f8a9-118">Windows Media Device Manager stellt eine einzelne API für die aufrufende Anwendung bereit, unabhängig davon, welche Art von Gerät aufgerufen wird (MTP-oder Massenspeicher Klasse, auf Version 10 basierende Dienstanbieter oder Dienstanbieter, die auf früheren Versionen von Windows Media Device Manager basieren).</span><span class="sxs-lookup"><span data-stu-id="4f8a9-118">Windows Media Device Manager provides a single API to the calling application, no matter what type of device is being called (MTP or Mass Storage Class, service providers built on version 10 or service providers built on earlier versions of Windows Media Device Manager).</span></span>

<span data-ttu-id="4f8a9-119">Windows Media Device Manager fungiert als Ganzes für die drei Hauptkomponenten des Systems: die Anwendung, die Anforderungen (Informationen zum Lesen und Schreiben von Daten usw.) ausführt. ein sicherer Inhaltsanbieter, bei dem es sich um eine Komponente handelt, die die Kommunikation mit DRM-geschützten Dateien behandelt. und ein Dienstanbieter, der Anforderungen von der Anwendung empfängt und mit dem Gerät kommuniziert, um diese Anforderungen auszuführen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-119">Windows Media Device Manager acts as a go-between for the three major components of the system: the application, which makes requests (for information, to read or write data, and so on); a secure content provider, which is a component that handles communication with DRM-protected files; and a service provider, which receives requests from the application and communicates with the device to perform these requests.</span></span> <span data-ttu-id="4f8a9-120">Die Anwendung und der Dienstanbieter werden auf dem Windows Media Device Manager SDK erstellt.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-120">Both the application and the service provider are built on the Windows Media Device Manager SDK.</span></span>

<span data-ttu-id="4f8a9-121">Das folgende Diagramm zeigt, wie eine Desktop Anwendung mithilfe von Windows Media Device Manager 11 mit einem Gerät kommuniziert.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-121">The following diagram shows how a desktop application communicates with a device using Windows Media Device Manager 11.</span></span>

![Diagramm, das zeigt, wie eine Anwendung mit vier verschiedenen Arten von Geräten kommuniziert.](images/wmdm-device-communication.gif)

<span data-ttu-id="4f8a9-123">Das obige Diagramm zeigt eine Anwendung, die mit vier verschiedenen Gerätetypen kommuniziert, die jeweils über einen eigenen Dienstanbieter verfügen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-123">The preceding diagram shows an application communicating with four different types of devices, each with its own service provider.</span></span> <span data-ttu-id="4f8a9-124">Jeder Dienstanbieter ist für die Kommunikation mit einem bestimmten Gerätetyp konzipiert. Dieses Diagramm zeigt die drei von Microsoft bereitgestellten Dienstanbieter (generische Klassen Treiber für Massenspeicher Klassen-Geräte, RAPI-Geräte und MTP-Geräte) sowie einen benutzerdefinierten Dienstanbieter für ein proprietäres Gerät, das von einem Drittanbieter erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-124">Every service provider is designed to communicate with a specific type of device; this diagram shows the three Microsoft-provided service providers (generic class drivers for Mass Storage Class devices, RAPI devices, and MTP devices), as well as a custom service provider for a proprietary device built by a third party.</span></span> <span data-ttu-id="4f8a9-125">Wenn ein Gerät eine Verbindung herstellt, instanziiert Windows Media Device Manager eine Instanz des Dienstanbieters, der für dieses Gerät registriert ist.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-125">When a device connects, Windows Media Device Manager instantiates an instance of the service provider registered for that device.</span></span> <span data-ttu-id="4f8a9-126">Die Dienstanbieter erhalten Anforderungen von der Anwendung über Windows Media Device Manager Schnittstellen, die Sie implementieren, verwenden Sie die geeigneten Treiber für die Kommunikation mit dem Gerät, und geben Sie entsprechende Ergebnisse zurück.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-126">The service providers get requests from the application through Windows Media Device Manager interfaces that they implement, use appropriate drivers to communicate with the device, and return appropriate results.</span></span> <span data-ttu-id="4f8a9-127">Die Kommunikation zwischen dem Dienstanbieter und dem Gerät erfolgt außerhalb der Domäne von Windows Media Device Manager.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-127">Communication between the service provider and the device is outside the domain of Windows Media Device Manager.</span></span>

<span data-ttu-id="4f8a9-128">Dienstanbieter sind für die Anwendung nicht sichtbar. in einer Anwendung wird nur eine Liste der Geräte angezeigt, da Windows Media Device Manager einen Standardsatz von Methoden und Schnittstellen für alle Geräte verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-128">Service providers are invisible to the application; an application sees only a list of "devices" because Windows Media Device Manager exposes a standard set of methods and interfaces for all devices.</span></span> <span data-ttu-id="4f8a9-129">Wenn ein Hersteller einen benutzerdefinierten Dienstanbieter erstellt, muss er alle standardmäßigen Windows Media Device Manager-Methoden verarbeiten, wenn Anwendungen in der Lage sein sollen, das Gerät zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-129">If a manufacturer creates a custom service provider, it must handle all the standard Windows Media Device Manager methods if applications are to be able to use the device.</span></span>

<span data-ttu-id="4f8a9-130">Dieses Diagramm zeigt auch ein Modul des Typs Secure Content Provider (SCP).</span><span class="sxs-lookup"><span data-stu-id="4f8a9-130">This diagram also shows a secure content provider (SCP) module.</span></span> <span data-ttu-id="4f8a9-131">Dieses Modul ist für die Behandlung von Digital Rights Management geschützten Inhalten (DRM) verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-131">This module is responsible for handling digital rights management (DRM) protected content.</span></span> <span data-ttu-id="4f8a9-132">Microsoft stellt ein SCP-Modul bereit, das von DRM geschützte WMA-und WMV-Dateien verarbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-132">Microsoft provides an SCP module that can handle DRM-protected WMA and WMV files.</span></span> <span data-ttu-id="4f8a9-133">Wenn eine Anwendung oder ein Gerät andere geschützte Formate verarbeiten soll, muss es ein eigenes SCP-Modul bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-133">If an application or device intends to handle other protected formats, it must provide its own SCP module.</span></span> <span data-ttu-id="4f8a9-134">Weder die Anwendung noch der Dienstanbieter verarbeitet direkt den SCP.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-134">Neither the application nor the service provider deals with the SCP directly.</span></span>

<span data-ttu-id="4f8a9-135">Sowohl die Anwendung als auch der Dienstanbieter werden auf Windows Media Device Manager erstellt, die Aufrufe zwischen der Anwendung und dem entsprechenden Dienstanbieter für ein Gerät weiterleitet. der Dienstanbieter ist für die direkte Kommunikation mit dem Gerät verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-135">Both the application and the service provider are built on Windows Media Device Manager, which routes calls between the application and the appropriate service provider for a device; the service provider is responsible for communicating directly with the device.</span></span> <span data-ttu-id="4f8a9-136">Windows Media Device Manager führt bestimmte Aktionen aus (z. b. das Auflisten verbundener Geräte, Routing Aufrufe und die Verarbeitung der Komponenten Überprüfung). der größte Teil der Arbeit erfolgt jedoch durch den Dienstanbieter, der Anforderungen von der Anwendung empfängt und mit dem Gerät kommuniziert.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-136">Windows Media Device Manager does perform some actions itself (such as enumerating connected devices, routing calls, and handling component verification); however, most of the work is done by the service provider, which receives requests from the application and communicates with the device.</span></span>

<span data-ttu-id="4f8a9-137">Eine auf Windows Media Device Manager basierende Anwendung kann mit Geräten und Dienstanbietern kommunizieren, die auf früheren Versionen von Windows Media Device Manager basieren; diese älteren Geräte werden jedoch über 9-Serie-Komponenten ausgeführt (nicht angezeigt) und unterstützen nicht die neuesten Features, insbesondere die erweiterte Digital Rights Management Technologie.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-137">An application built on Windows Media Device Manager can communicate with devices and service providers built on earlier versions of Windows Media Device Manager; however, these older devices will be run through 9 Series components (not shown), and will not support the newest features, particularly the more advanced digital rights management technology.</span></span>

<span data-ttu-id="4f8a9-138">Architektur eines Geräts</span><span class="sxs-lookup"><span data-stu-id="4f8a9-138">Architecture of a Device</span></span>

<span data-ttu-id="4f8a9-139">Das folgende Diagramm zeigt eine vereinfachte Hierarchie von Geräten und Speicher, die von einer Anwendung verwendet wird, die Windows Media Device Manager verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-139">The following diagram shows a simplified hierarchy of devices and storages as seen by an application using Windows Media Device Manager.</span></span>

![das Diagramm zeigt die Speicher auf einem Gerät.](images/wmdm-basic-device-layout.gif)

<span data-ttu-id="4f8a9-141">Das obige Diagramm zeigt eine vereinfachte Version eines verbundenen Flash Laufwerks, wie von einer Windows Media Device Manager-Anwendung dargestellt.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-141">The preceding diagram shows a simplified version of a connected flash drive, as seen by a Windows Media Device Manager application.</span></span> <span data-ttu-id="4f8a9-142">Das Flash Laufwerk verfügt über Attribute und Eigenschaften, z. b. eine Seriennummer und unterstützte Format Konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-142">The flash drive has attributes and properties, such as a serial number and supported format configurations.</span></span> <span data-ttu-id="4f8a9-143">Ein unmittelbar untergeordnetes Element des Flash-Geräts ist das Stamm Speicher Objekt, das einen Ordner enthält, der selbst ein Bild und einen Song enthält.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-143">An immediate child of the flash device is the root storage object, which contains a folder, which itself contains an image and a song.</span></span>

<span data-ttu-id="4f8a9-144">Eine Anwendung listet die Liste der angefügten Geräte durch Aufrufen einer Enumerationsmethode auf, die von der Stamm- [**iwmdevicemanager**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdevicemanager) -Schnittstelle verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-144">An application enumerates the list of attached devices by calling an enumeration method exposed by the root [**IWMDeviceManager**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdevicemanager) interface.</span></span> <span data-ttu-id="4f8a9-145">Geräte werden durch eine [**iwmdmdevice**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmdevice) (oder eine abgeleitete) Schnittstelle dargestellt.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-145">Devices are represented by an [**IWMDMDevice**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmdevice) (or a derived) interface.</span></span> <span data-ttu-id="4f8a9-146">Diese Schnittstelle stellt Methoden zum Abrufen des Geräte namens, der Formatierungsfunktionen, der Seriennummer usw. und einer Methode zur Verfügung, die auf dem Gerät *Speicher* auflistet.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-146">This interface exposes methods to retrieve the device name, format capabilities, serial number, and so on, as well as a method that enumerates *storages* on the device.</span></span> <span data-ttu-id="4f8a9-147">In Windows Media Device Manager ist ein Speicher eine beliebige Art von Objekt auf dem Gerät, unabhängig davon, ob es sich um ein tatsächliches BLOB von Daten handelt.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-147">In Windows Media Device Manager, a storage is any kind of object on the device, whether or not it is an actual blob of data.</span></span> <span data-ttu-id="4f8a9-148">Beispiel: Audiodateien, Textdateien, Ordner, Wiedergabelisten, die als Dateien gespeichert sind, und als Metadaten gespeicherte Wiedergabelisten gelten als Speicher, auch wenn Ordner und Metadatenelemente wahrscheinlich keine physische Datei darstellen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-148">For example: audio files, text files, folders, playlists stored as files, and playlists stored as metadata are all considered storages, even though folders and metadata items probably do not represent a physical file.</span></span> <span data-ttu-id="4f8a9-149">Der Typ (oder das Format) eines Speichers kann abgerufen werden, indem [**GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-getattributes) aufgerufen wird (oder [**GetMetadata**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage3-getmetadata), um das Format des Speichers anzufordern).</span><span class="sxs-lookup"><span data-stu-id="4f8a9-149">The type (or format) of a storage can be retrieved by calling [**GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-getattributes) (or [**GetMetadata**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage3-getmetadata), requesting the format of the storage).</span></span>

<span data-ttu-id="4f8a9-150">Storages auf einem Gerät werden hierarchisch gespeichert, und alle Geräte verfügen über einen Stamm Speicher.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-150">Storages on a device are stored hierarchically, and all devices have a root storage.</span></span> <span data-ttu-id="4f8a9-151">Jeder Speicher kann NULL oder mehr untergeordnete Objekte enthalten, die durch den Aufruf der [**iwmdmstorage:: enumstorage**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-enumstorage) -Methode des Speichers aufgezählt werden.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-151">Each storage can hold zero or more child objects, enumerated by calling that storage's [**IWMDMStorage::EnumStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-enumstorage) method.</span></span>

<span data-ttu-id="4f8a9-152">Beachten Sie, dass jedem Speicher im Diagramm Attribute und Metadaten zugeordnet sind (es werden nicht alle Werte angezeigt).</span><span class="sxs-lookup"><span data-stu-id="4f8a9-152">Note that each storage in the diagram has attributes and metadata associated with it (not all values are shown).</span></span> <span data-ttu-id="4f8a9-153">Attribute sind einfache, boolesche Informationen, die häufig Verwaltungs-oder Navigationsinformationen beschreiben (z. b. "hat Ordner" oder "kann gelöscht werden"), wohingegen Metadaten Zeichen folgen Werte, Zahlen oder komplexe Informationen sein können (z. b. Renderingfunktionen).</span><span class="sxs-lookup"><span data-stu-id="4f8a9-153">Attributes are simple, Boolean information often describing management or navigational information (such as "has folders" or "can delete"), whereas metadata can be string values, numbers, or complex information (such as rendering capabilities).</span></span> <span data-ttu-id="4f8a9-154">Attribute werden durch einen relativ begrenzten Satz von Flags beschrieben, die vom SDK definiert und durch Aufrufen von [**iwmdmstorage:: GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-getattributes) oder [**IWMDMStorage2:: GetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage2-getattributes2)abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-154">Attributes are described by a fairly limited set of flags defined by the SDK and retrieved by calling [**IWMDMStorage::GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-getattributes) or [**IWMDMStorage2::GetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage2-getattributes2).</span></span> <span data-ttu-id="4f8a9-155">Metadatenwerte werden durch einen eindeutigen Namen abgerufen. Das SDK definiert eine Reihe von Metadatenwerten, die von Geräten unterstützt werden sollen. Geräte können jedoch eigene [metadatenkonstanten](metadata-constants.md)definieren.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-155">Metadata values are retrieved by a unique name; the SDK defines a number of metadata values that devices should support, but devices can define their own [metadata constants](metadata-constants.md).</span></span> <span data-ttu-id="4f8a9-156">Wenn ein Gerät oder ein Dienstanbieter jedoch eine neue metadatenkonstante definiert, können Anwendungen diesen Wert nur dann anfordern oder festlegen, wenn die Anwendungsentwickler diese neue Konstante kennen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-156">However, if a device or service provider defines a new metadata constant, applications won't be able to request or set this value unless the application developers were aware of this new constant.</span></span> <span data-ttu-id="4f8a9-157">Ein Dienstanbieter muss [**IWMDMStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage3) oder höher unterstützen, um das Abrufen oder Festlegen von Metadaten zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-157">A service provider must support [**IWMDMStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage3) or later to support retrieving or setting metadata.</span></span> <span data-ttu-id="4f8a9-158">Weitere Informationen finden Sie unter [erhalten und Festlegen von Metadaten und Attributen](getting-and-setting-metadata-and-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="4f8a9-158">For more information, see [Getting and Setting Metadata and Attributes](getting-and-setting-metadata-and-attributes.md).</span></span>

<span data-ttu-id="4f8a9-159">Dienstanbieter</span><span class="sxs-lookup"><span data-stu-id="4f8a9-159">Service Providers</span></span>

<span data-ttu-id="4f8a9-160">Der Dienstanbieter fungiert als middlemann zwischen der Anwendung und dem Gerät.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-160">The service provider acts as a middleman between the application and the device.</span></span> <span data-ttu-id="4f8a9-161">Der Dienstanbieter ist für den Anwendungsentwickler unsichtbar, sodass ein Anwendungsentwickler nichts über das Entwickeln eines Dienstanbieters wissen muss.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-161">The service provider is invisible to the application developer, so an application developer does not need to know anything about developing a service provider.</span></span> <span data-ttu-id="4f8a9-162">Es ist jedoch der Dienstanbieter, der die Kommunikation mit einem Gerät durchführt.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-162">However, it is the service provider that does the work of communicating with a device.</span></span>

<span data-ttu-id="4f8a9-163">Ein Dienstanbieter ist eine com-dll, die auf Windows Media Device Manager basiert und Anforderungen von einer Anwendung empfängt und mit dem Gerät kommuniziert, um Sie auszuführen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-163">A service provider is a COM DLL built on Windows Media Device Manager that receives requests from an application and communicates with the device to perform them.</span></span> <span data-ttu-id="4f8a9-164">Die Kommunikation mit der Desktop Anwendung wird von Windows Media Device Manager vermittelt; die Kommunikation mit dem Gerät unterliegt der Kontrolle des Dienstanbieters.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-164">Communication with the desktop application is mediated by Windows Media Device Manager; communication with the device is under the control of the service provider.</span></span>

<span data-ttu-id="4f8a9-165">Ein Dienstanbieter empfängt Anforderungen von der Anwendung zum Aufzählen von Geräte Inhalten, Anforderungen an Gerätefunktionen, Anforderungen zum Lesen und Schreiben von Daten usw.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-165">A service provider receives requests from the application to enumerate device content, requests for device capabilities, requests to read or write data, and so on.</span></span> <span data-ttu-id="4f8a9-166">Er muss wissen, dass ein Gerät gut genug ist, damit Befehle im richtigen Format und Protokoll gesendet werden können.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-166">It must know the design of a device well enough that it can send commands in the proper format and protocol.</span></span> <span data-ttu-id="4f8a9-167">Er sollte auch gerätespezifische Anforderungen ausblenden können, wie z. b. eine erforderliche Dateierweiterung für Wiedergabelisten, damit Anwendungen diese Anforderungen nicht kennen müssen, damit das Gerät verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-167">It should also be able to hide device-specific requirements, such as a required file extension for playlists, so that applications do not need to know these requirements in order to use the device.</span></span>

<span data-ttu-id="4f8a9-168">Microsoft stellt eine Reihe von Dienstanbietern für Standardgeräte Typen bereit, einschließlich generischer MTP-Geräte, Massenspeicher Klassen-Geräte und RAPI-Geräten.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-168">Microsoft provides a number of service providers for standard device types, including generic MTP devices, Mass Storage Class devices, and RAPI devices.</span></span> <span data-ttu-id="4f8a9-169">Der einzige Grund, warum ein Geräte-Designer einen benutzerdefinierten Dienstanbieter erstellen muss, ist, wenn ein Gerät bestimmte oder ungewöhnliche Datenspeicher Anforderungen hat, die von den Standard Dienstanbietern nicht behandelt werden – z. b. wenn Dateien an bestimmten Speicherorten gespeichert werden müssen und das Betriebssystem das Betriebssystem nicht automatisch verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-169">The only reason a device designer should need to create a custom service provider is if a device has some specific or unusual data storage requirements that the standard service providers do not handle—for instance, if files must be stored in specific locations and the device operating system does not handle this automatically.</span></span>

<span data-ttu-id="4f8a9-170">Wenn ein Gerät mit dem Computer verbunden ist, erstellt das Betriebssystem eine Instanz des entsprechenden Dienstanbieters für jede Windows Media Device Manager-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-170">When a device is connected to the computer, the operating system creates one instance of the appropriate service provider for each Windows Media Device Manager application.</span></span> <span data-ttu-id="4f8a9-171">Wenn eine zweite Windows Media Device Manager-Anwendung gestartet wird, wird eine zweite Instanz des Dienstanbieters geladen.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-171">If a second Windows Media Device Manager application starts, a second instance of the service provider will be loaded.</span></span> <span data-ttu-id="4f8a9-172">Jeder Dienstanbieter kann jedoch mehrere Geräte verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-172">However, each service provider can handle multiple devices.</span></span> <span data-ttu-id="4f8a9-173">Dies wird im folgenden Diagramm veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-173">The following diagram illustrates this.</span></span>

![das Diagramm zeigt zwei MTP-Geräte, die mit zwei Anwendungen kommunizieren.](images/wmdm-sp-to-device.gif)

<span data-ttu-id="4f8a9-175">Das obige Diagramm zeigt zwei verschiedene Anwendungen, die mit zwei MTP-Geräten kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-175">The preceding diagram shows two different applications communicating with two MTP devices.</span></span> <span data-ttu-id="4f8a9-176">Die Geräte verwenden die gleiche Dienstanbieter Klasse, aber jede Anwendung verfügt über eine eigene Instanz desselben Dienstanbieters.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-176">The devices use the same service provider class, but each application has its own instance of the same service provider.</span></span> <span data-ttu-id="4f8a9-177">Jede Instanz des Dienstanbieters kommuniziert mit Geräten.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-177">Each service provider instance is communicating with devices.</span></span> <span data-ttu-id="4f8a9-178">Die verschiedenen Instanzen des Dienstanbieters sind einander nicht bewusst.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-178">The different instances of the service provider are not aware of each other.</span></span>

<span data-ttu-id="4f8a9-179">Viele Anwendungsmethoden verfügen über eine entsprechend benannte Dienstanbieter Methode.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-179">Many application methods have a correspondingly named service provider method.</span></span> <span data-ttu-id="4f8a9-180">Wenn die Anwendung eine-Methode aufruft, leitet Windows Media Device Manager den Aufruf an die entsprechende-Methode für den Dienstanbieter weiter. (allerdings werden möglicherweise einige zusätzliche interne Aktionen zuerst durchgeführt.)</span><span class="sxs-lookup"><span data-stu-id="4f8a9-180">When the application calls a method, Windows Media Device Manager routes the call to the corresponding method on the service provider (though it might perform some additional internal actions first).</span></span> <span data-ttu-id="4f8a9-181">Wenn die Anwendung z. b. [**IWMDMDevice3:: GetProperty**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice3-getproperty)aufruft, leitet Windows Media Device Manager diesen Aufruf an die Implementierung von [**IMDSPDevice3:: GetProperty**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice3-getproperty)des Dienstanbieters weiter.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-181">For example, when the application calls [**IWMDMDevice3::GetProperty**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice3-getproperty), Windows Media Device Manager routes this call to the service provider's implementation of [**IMDSPDevice3::GetProperty**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice3-getproperty).</span></span> <span data-ttu-id="4f8a9-182">(Die meisten Anwendungsschnittstellen beginnen mit iwmdm, und die zugehörige Dienstanbieter Schnittstelle beginnt mit imdsp).</span><span class="sxs-lookup"><span data-stu-id="4f8a9-182">(Most application interfaces begin with IWMDM, and the corresponding service provider interface begins with IMDSP).</span></span> <span data-ttu-id="4f8a9-183">Der Dienstanbieter wird erwartet, dass dieser Methodenaufrufe behandelt und ein entsprechendes Ergebnis zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-183">The service provider is expected to handle this method call and return an appropriate result.</span></span>

<span data-ttu-id="4f8a9-184">Eine Anwendung untersucht oder kommuniziert nicht direkt mit einem Gerät (es sei denn, es wird [**IWMDMDevice3 aufgerufen::D eviceiocontrol**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice3-deviceiocontrol) oder [**iwmdmstorage:: sendopaquecommand**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-sendopaquecommand)); die Anwendung kommuniziert mit dem Dienstanbieter, der ein Gerät auf logischere und einfache Weise darstellen muss.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-184">An application never explores or communicates with a device directly (unless it calls [**IWMDMDevice3::DeviceIoControl**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice3-deviceiocontrol) or [**IWMDMStorage::SendOpaqueCommand**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-sendopaquecommand)); the application communicates with the service provider, which must represent a device in the most logical and simple manner possible.</span></span> <span data-ttu-id="4f8a9-185">Wenn die Anwendung Informationen über das Gerät anfordert oder Objekte auf dem Gerät auflistet, fragt der Dienstanbieter das Gerät entsprechend ab und ruft die entsprechenden Informationen ab und gibt diese zurück.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-185">When the application requests information about the device, or enumerates objects on the device, the service provider queries the device in an appropriate manner and acquires and returns the appropriate information.</span></span> <span data-ttu-id="4f8a9-186">Wenn dies der Fall ist, kann die Dateiorganisation auf dem Gerät anders verfügbar sein als auf dem Gerät.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-186">It may expose the file organization on the device differently from how it is physically stored on the device, if that is appropriate.</span></span> <span data-ttu-id="4f8a9-187">Allerdings wird das Gerät verfügbar gemacht. es sollte einheitlich und logisch sein, damit die Anwendung die Anforderungen ermitteln und die Befehle verarbeiten kann, die Sie sendet.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-187">However it exposes the device, it should be in a consistent, logical manner, to enable the application to find what it needs and handle the commands it sends.</span></span> <span data-ttu-id="4f8a9-188">Ein guter Dienstanbieter verbirgt gerätespezifische Besonderheiten – wenn das Gerät z. b. physisch eine Wiedergabeliste als Datei mit einer benutzerdefinierten Dateierweiterung speichert, sollte der Dienstanbieter diese Erweiterung automatisch hinzufügen, wenn die Anwendung eine Wiedergabeliste auf dem Gerät erstellt. Es sollte nicht erwartet werden, dass die Anwendung die richtige Erweiterung kennt, wenn ein Wiedergabelisten Objekt erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-188">A good service provider will hide device-specific peculiarities—for example, if the device physically stores a playlist as a file with a custom file extension, the service provider should add that extension automatically when the application creates a playlist on the device; it should not expect the application to know the proper extension when creating a playlist object.</span></span>

<span data-ttu-id="4f8a9-189">Dienstanbieter werden innerhalb des Prozesses der aufrufenden Anwendung ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-189">Service providers run inside the process of the calling application.</span></span> <span data-ttu-id="4f8a9-190">Die einzige Ausnahme ist der MTP-Dienstanbieter, der in einem eigenen Prozess ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-190">The only exception to this is the MTP service provider, which runs in its own process.</span></span> <span data-ttu-id="4f8a9-191">Aus diesem Grund besteht das Risiko, dass ein blockierter Dienstanbieter die aufrufenden Anwendung blockiert.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-191">Because of this, there is some risk that a blocked service provider will cause the calling application to block.</span></span> <span data-ttu-id="4f8a9-192">Daher sollten Dienstanbieter so entworfen werden, dass Sie robust sind und Blockierungen verhindern, und Anwendungen sollten so entworfen werden, dass das stecken bleiben vermieden wird, wenn ein bestimmter Methoden Aufrufwert nicht schnell zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="4f8a9-192">Therefore, service providers should be designed to be robust and prevent blocking, and applications should be designed to avoid stalling if a particular method call does not return quickly.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4f8a9-193">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="4f8a9-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4f8a9-194">**Einstieg**</span><span class="sxs-lookup"><span data-stu-id="4f8a9-194">**Getting Started**</span></span>](getting-started.md)
</dt> </dl>

 

 




