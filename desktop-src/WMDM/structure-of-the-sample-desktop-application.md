---
title: Struktur der Beispiel-Desktop Anwendung
description: Struktur der Beispiel-Desktop Anwendung
ms.assetid: e042470d-dc78-488c-bcad-2e8d34714d5d
keywords:
- Windows Media Device Manager, Beispiele
- Device Manager, Beispiele
- Desktop Anwendungen, Beispiele
- Windows Media Device Manager, Beispiel für eine Desktop Anwendung
- Beispiel für Device Manager Desktop Anwendung
- Beispiele, Desktop Anwendungen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 34fb377c1bb6ebf943721b55ec6175e65f70ddde
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "103711118"
---
# <a name="structure-of-the-sample-desktop-application"></a><span data-ttu-id="00a65-109">Struktur der Beispiel-Desktop Anwendung</span><span class="sxs-lookup"><span data-stu-id="00a65-109">Structure of the Sample Desktop Application</span></span>

<span data-ttu-id="00a65-110">Die Beispiel-Desktop Anwendung besteht aus zwei Hauptteilen:</span><span class="sxs-lookup"><span data-stu-id="00a65-110">The sample desktop application consists of two main pieces:</span></span>

-   <span data-ttu-id="00a65-111">Das wmdapp-Projekt enthält die meisten Klassen, die die Benutzeroberfläche anzeigen, Drag & amp; Drop verarbeiten und alle erforderlichen Funktionen des Programms ausführen.</span><span class="sxs-lookup"><span data-stu-id="00a65-111">The wmdapp project contains most of the classes that display the user interface, handle dragging and dropping, and perform all the required functionality of the program.</span></span>
-   <span data-ttu-id="00a65-112">Das proghelp-Projekt ist eine Hilfsanwendung, die nicht erforderliche Klassen zum Verarbeiten von Status Benachrichtigungen und manuellen Übertragungen von Dateien vom Desktop zur Anwendung enthält.</span><span class="sxs-lookup"><span data-stu-id="00a65-112">The proghelp project is a helper application that contains nonessential classes to handle status notifications and manual file transfers from the desktop to the application.</span></span>

<span data-ttu-id="00a65-113">Die ausführbare Datei verwendet das Hilfsprojekt nur dann, wenn der Benutzer im Menü **Optionen die Option** **use Operation Interface** ausgewählt hat, um die manuelle Dateiübertragung an das Gerät zu verarbeiten und die Statusleiste im Formular zum Herunterladen des Fortschritts zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="00a65-113">The executable uses the helper project only when the user selects **Use Operation Interface** on the **Options** menu to handle manual file transfer to the device, and to increment the status bar in the download progress form.</span></span> <span data-ttu-id="00a65-114">Der gesamte Rest der Anwendung wird im wmdapp-Projekt behandelt.</span><span class="sxs-lookup"><span data-stu-id="00a65-114">All the rest of the application is handled in the wmdapp project.</span></span>



| <span data-ttu-id="00a65-115">Klasse</span><span class="sxs-lookup"><span data-stu-id="00a65-115">Class</span></span>                | <span data-ttu-id="00a65-116">Datei</span><span class="sxs-lookup"><span data-stu-id="00a65-116">File</span></span>                    | <span data-ttu-id="00a65-117">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="00a65-117">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                     |
|----------------------|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="00a65-118">—</span><span class="sxs-lookup"><span data-stu-id="00a65-118">—</span></span>                    | <span data-ttu-id="00a65-119">wmdmapp. cpp</span><span class="sxs-lookup"><span data-stu-id="00a65-119">wmdmapp.cpp</span></span>             | <span data-ttu-id="00a65-120">Die Klasse, die das übergeordnete Fenster der Benutzeroberfläche behandelt.</span><span class="sxs-lookup"><span data-stu-id="00a65-120">The class that handles the parent window of the user interface.</span></span> <span data-ttu-id="00a65-121">Der Code in dieser Datei verarbeitet auch einige Benutzereingaben, die nicht von cdevfiles behandelt werden, z. b. das Erstellen einer Wiedergabeliste oder eines Albums auf einem Gerät, das Löschen von Dateien und das Registrieren von Menü Optionen.</span><span class="sxs-lookup"><span data-stu-id="00a65-121">The code in this file also handles some user input not handled by CDevFiles, such as creating a playlist or album on a device, deleting files, and registering menu choices.</span></span>                                                                                                                                                    |
| <span data-ttu-id="00a65-122">Cdevices</span><span class="sxs-lookup"><span data-stu-id="00a65-122">CDevices</span></span>             | <span data-ttu-id="00a65-123">Geräte. cpp</span><span class="sxs-lookup"><span data-stu-id="00a65-123">Devices.cpp</span></span>             | <span data-ttu-id="00a65-124">Die Klasse, die den linken Bereich des Haupt Anwendungsfensters behandelt, in dem die verfügbaren Geräte aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="00a65-124">The class that handles the left-hand pane of the main application window, where the available devices are listed.</span></span> <span data-ttu-id="00a65-125">Diese Klasse verwaltet die Messaging Schleife, die Benutzereingaben behandelt, z. b. das Auswählen eines Geräts und das Benachrichtigen des cdevfiles-Bereichs, um die entsprechenden Dateien zu laden, wenn sich die Geräteauswahl geändert hat.</span><span class="sxs-lookup"><span data-stu-id="00a65-125">This class manages the messaging loop, which handles user input such as selecting a device and notifying the CDevFiles pane to load the appropriate files when the device selection has changed.</span></span>                                                                              |
| <span data-ttu-id="00a65-126">Cdevfiles</span><span class="sxs-lookup"><span data-stu-id="00a65-126">CDevFiles</span></span>            | <span data-ttu-id="00a65-127">Devfiles. cpp</span><span class="sxs-lookup"><span data-stu-id="00a65-127">Devfiles.cpp</span></span>            | <span data-ttu-id="00a65-128">Die Klasse, die den rechten Bereich des Haupt Anwendungsfensters behandelt, in dem die Dateien auf dem ausgewählten Gerät aufgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="00a65-128">The class that handles the right-hand pane of the main application window, where the files on the selected device are listed.</span></span> <span data-ttu-id="00a65-129">Diese Klasse verwaltet die Messaging Schleife und verarbeitet Benutzereingaben, z. b. das Ziehen von Dateien auf das Gerät und das Löschen von Dateien auf dem Gerät.</span><span class="sxs-lookup"><span data-stu-id="00a65-129">This class manages the messaging loop, and handles user input such as dragging files onto the device and deleting files from the device.</span></span>                                                                                                                          |
| <span data-ttu-id="00a65-130">Cstatus</span><span class="sxs-lookup"><span data-stu-id="00a65-130">CStatus</span></span>              | <span data-ttu-id="00a65-131">Status. cpp</span><span class="sxs-lookup"><span data-stu-id="00a65-131">Status.cpp</span></span>              | <span data-ttu-id="00a65-132">Die Klasse, die die untere Statusleiste im Hauptfenster behandelt, in der die Anzahl der Geräte und Dateien aufgeführt ist, sowie die Menge an freiem und verwendeter Arbeitsspeicher auf dem ausgewählten Gerät.</span><span class="sxs-lookup"><span data-stu-id="00a65-132">The class that handles the bottom status bar in the main window, where the number of devices and files is listed, along with the amount of free and used memory on the selected device.</span></span>                                                                                                                                                                                                         |
| <span data-ttu-id="00a65-133">Cwmdm</span><span class="sxs-lookup"><span data-stu-id="00a65-133">CWMDM</span></span>                | <span data-ttu-id="00a65-134">Wmdevmgr. cpp</span><span class="sxs-lookup"><span data-stu-id="00a65-134">Wmdevmgr.cpp</span></span>            | <span data-ttu-id="00a65-135">Die Oberfläche der obersten Ebene für Windows Media Device Manager.</span><span class="sxs-lookup"><span data-stu-id="00a65-135">The top-level interface for Windows Media Device Manager.</span></span> <span data-ttu-id="00a65-136">Diese Klasse übernimmt die Authentifizierung, ruft die **iwmdevicemanager** -Schnittstelle der obersten Ebene ab und registriert sich mit der **iwmdmnotification** -Schnittstelle für Benachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="00a65-136">This class handles authentication, retrieves the top-level **IWMDeviceManager** interface, and registers for notifications with the **IWMDMNotification** interface.</span></span>                                                                                                                                                                  |
| <span data-ttu-id="00a65-137">Cprogress</span><span class="sxs-lookup"><span data-stu-id="00a65-137">CProgress</span></span>            | <span data-ttu-id="00a65-138">"Progress. cpp"</span><span class="sxs-lookup"><span data-stu-id="00a65-138">Progress.cpp</span></span>            | <span data-ttu-id="00a65-139">Die-Klasse im Haupt Anwendungsprojekt, das das Dialogfeld erstellt und verwaltet, das den Fortschritt eines Ereignisses anzeigt.</span><span class="sxs-lookup"><span data-stu-id="00a65-139">The class in the main application project that creates and manages the dialog box showing the progress of an event.</span></span>                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="00a65-140">Citemdata</span><span class="sxs-lookup"><span data-stu-id="00a65-140">CItemData</span></span>            | <span data-ttu-id="00a65-141">ItemData. cpp</span><span class="sxs-lookup"><span data-stu-id="00a65-141">ItemData.cpp</span></span>            | <span data-ttu-id="00a65-142">Eine Wrapper Klasse, die einen Zeiger auf einen Speicher (bei Darstellung einer Datei oder eines Ordners auf dem Gerät) oder ein Gerät (bei Darstellung eines Geräts) enthält, sowie eine Vielzahl von Informationen über das Objekt, einschließlich Größe und Attributen.</span><span class="sxs-lookup"><span data-stu-id="00a65-142">A wrapper class that holds a pointer to a storage (if representing a file or folder on the device) or a device (if representing a device), as well as a variety of information about the object including size and attributes.</span></span>                                                                                                                                                                  |
| <span data-ttu-id="00a65-143">Cnotificationhandler</span><span class="sxs-lookup"><span data-stu-id="00a65-143">CNotificationHandler</span></span> | <span data-ttu-id="00a65-144">Notificationhandler. cpp</span><span class="sxs-lookup"><span data-stu-id="00a65-144">Notificationhandler.cpp</span></span> | <span data-ttu-id="00a65-145">Behandelt Benachrichtigungen über das eintreffen und Entfernen von Geräten durch Warnung im Fenster "cdevices".</span><span class="sxs-lookup"><span data-stu-id="00a65-145">Handles device arrival and removal notifications by alerting the CDevices window.</span></span>                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="00a65-146">Cprogresshelper</span><span class="sxs-lookup"><span data-stu-id="00a65-146">CProgressHelper</span></span>      | <span data-ttu-id="00a65-147">Progresshelper. cpp</span><span class="sxs-lookup"><span data-stu-id="00a65-147">ProgressHelper.cpp</span></span>      | <span data-ttu-id="00a65-148">Wird von cdevfiles in lokalen Funktionen erstellt, um Benachrichtigungen von Windows Media-Device Manager durch Implementieren von **iwmdmprogress** zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="00a65-148">Created by CDevFiles in local functions to receive notifications from Windows Media Device Manager by implementing **IWMDMProgress**.</span></span> <span data-ttu-id="00a65-149">Sie wird von der cprogress-Klasse verwendet, um die Anzahl der Balken in der Statusanzeige zu ermitteln, und, wenn eine Aktion abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="00a65-149">It is used by the CProgress class to determine the amount of bars in the progress bar, and when an action is finished.</span></span> <span data-ttu-id="00a65-150">Diese Klasse ist als COM-Objekt definiert, das die SDK-Schnittstelle **iwmdmprogress** und eine benutzerdefinierte Schnittstelle iwmdmprogresshelper verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="00a65-150">This class is defined as a COM object that exposes the SDK interface **IWMDMProgress** and a custom interface IWMDMProgressHelper.</span></span> |
| <span data-ttu-id="00a65-151">Coperationhelper</span><span class="sxs-lookup"><span data-stu-id="00a65-151">COperationHelper</span></span>     | <span data-ttu-id="00a65-152">Operationhelper. cpp</span><span class="sxs-lookup"><span data-stu-id="00a65-152">Operationhelper.cpp</span></span>     | <span data-ttu-id="00a65-153">Diese Klasse implementiert **iwmdmoperation** , um die manuelle Übertragung von Dateien zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="00a65-153">This class implements **IWMDMOperation** to handle manual transfer of files.</span></span> <span data-ttu-id="00a65-154">Es ist eine Multithread-Schnittstelle, die asynchron auftreten kann. es wird als COM-Objekt definiert, das eine benutzerdefinierte Schnittstelle (iwmdmoperationhelper) verfügbar macht, um die Klasse zu instanziieren und zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="00a65-154">It is multi-threaded to allow it to occur asynchronously, and is defined as a COM object that exposes a custom interface, IWMDMOperationHelper, to instantiate and initialize the class.</span></span> <span data-ttu-id="00a65-155">Diese Klasse wird nur verwendet, wenn der Benutzer im Menü **Optionen die Option** "Vorgangs Schnittstelle verwenden" auswählt.</span><span class="sxs-lookup"><span data-stu-id="00a65-155">This class is only used if the user selects "Use Operation Interface" in the **Options** menu.</span></span>                            |



 

<span data-ttu-id="00a65-156">In den folgenden Listen finden Sie die grundlegenden Schritte, die für verschiedene Benutzeraktionen ausgeführt werden:</span><span class="sxs-lookup"><span data-stu-id="00a65-156">The following lists outline the basic steps that occur for various user actions:</span></span>

<span data-ttu-id="00a65-157">**Beim Start**</span><span class="sxs-lookup"><span data-stu-id="00a65-157">**On startup**</span></span>

<span data-ttu-id="00a65-158">Die folgenden Hauptschritte werden ausgeführt, wenn die Beispielanwendung gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="00a65-158">The following main steps occur when the sample application is started.</span></span>

1.  <span data-ttu-id="00a65-159">Die globale cwmdm-Variable wird instanziiert und authentifiziert und wird für den Empfang von Benachrichtigungen registriert.</span><span class="sxs-lookup"><span data-stu-id="00a65-159">The global CWMDM variable is instantiated and authenticated, and registers to receive notifications</span></span>
2.  <span data-ttu-id="00a65-160">Globale cdevices werden instanziiert, und cdevices:: Create wird aufgerufen, um den Bereich Geräte zu erstellen und auszufüllen.</span><span class="sxs-lookup"><span data-stu-id="00a65-160">A global CDevices is instantiated, and CDevices::Create is called to create and fill the devices pane.</span></span>
3.  <span data-ttu-id="00a65-161">Eine globale cdevfiles wird instanziiert, und cdevfiles:: Create wird aufgerufen, um den Bereich Dateien zu erstellen (dieser wird erst aufgefüllt, wenn der Benutzer ein Gerät auswählt).</span><span class="sxs-lookup"><span data-stu-id="00a65-161">A global CDevFiles is instantiated, and CDevFiles::Create is called to create the files pane (which is not filled until the user selects a device).</span></span>
4.  <span data-ttu-id="00a65-162">Ein globaler cstatus wird instanziiert, und cstatus:: Create wird aufgerufen, um die Statusleiste zu instanziieren.</span><span class="sxs-lookup"><span data-stu-id="00a65-162">A global CStatus is instantiated, and CStatus::Create is called to instantiate the status bar.</span></span>
5.  <span data-ttu-id="00a65-163">\_Onviewrefresh listet alle Geräte auf und initialisiert und fügt alle Geräte (citemdata) zu cdevices hinzu und aktualisiert die Statusleiste, um die Anzahl der Geräte anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="00a65-163">\_OnViewRefresh enumerates through all devices and initializes and adds all devices (CItemData) to CDevices and updates the status bar to show the number of devices.</span></span>
6.  <span data-ttu-id="00a65-164">Cdevices:: AddItem fügt das Element der TreeView-Ansicht, die die Geräte darstellt, mit einem Zeiger auf sich selbst als "tvitem. lParam" hinzu.</span><span class="sxs-lookup"><span data-stu-id="00a65-164">CDevices::AddItem adds the item to the treeview representing the devices, with a pointer to itself as the TVITEM.lparam.</span></span> <span data-ttu-id="00a65-165">Alle cdevice-Objekte (Geräte) und cdevfiles-Objekte (Datei) werden in diesem Mitglied des TreeView-Knotens im entsprechenden Fenster gespeichert.</span><span class="sxs-lookup"><span data-stu-id="00a65-165">All CDevice (devices) and CDevFiles (file) objects are stored in this member of the treeview node in the appropriate window.</span></span>

<span data-ttu-id="00a65-166">**Beim Auswählen eines Geräts**</span><span class="sxs-lookup"><span data-stu-id="00a65-166">**On selecting a device**</span></span>

<span data-ttu-id="00a65-167">Die folgenden Hauptschritte werden ausgeführt, wenn der Benutzer im linken Bereich des Anwendungsfensters ein Gerät auswählt.</span><span class="sxs-lookup"><span data-stu-id="00a65-167">The following main steps occur when the user selects a device in the left-hand pane of the application window.</span></span>

1.  <span data-ttu-id="00a65-168">Das Fenster "cdevices" fängt einen Klick ein und stellt eine WM- \_ DRM- \_ updatedevice-Nachricht an sich selbst.</span><span class="sxs-lookup"><span data-stu-id="00a65-168">The CDevices window traps a click and posts a WM\_DRM\_UPDATEDEVICE message, to itself.</span></span>
2.  <span data-ttu-id="00a65-169">Cdevices empfängt eine eigene Nachricht und ruft updateselection auf, das dem globalen cdevfiles-Objekt mitteilt, alles zu löschen, alle Elemente der obersten Ebene im Gerät aufzulisten und cdevfiles:: AddItem aufzurufen, um die einzelnen Elemente dem Bereich Dateien hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="00a65-169">CDevices receives its own message and calls UpdateSelection, which tells the global CDevFiles object to clear everything, enumerate all the top-level items in the device, and calls CDevFiles::AddItem to add each to the files pane.</span></span>
3.  <span data-ttu-id="00a65-170">Zum Schluss ruft cdevices cdevfiles:: updatestatusbar auf, um die Statusleiste mit den richtigen Geräte-und Dateiinformationen zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="00a65-170">Finally, CDevices calls CDevFiles::UpdateStatusBar to update the status bar with the correct device and file information.</span></span>

<span data-ttu-id="00a65-171">**Beim Erstellen einer Wiedergabeliste**</span><span class="sxs-lookup"><span data-stu-id="00a65-171">**On creating a playlist**</span></span>

<span data-ttu-id="00a65-172">Nachdem Sie auf "Wiedergabeliste erstellen" im Menü " **Container** " geklickt haben, ruft die Anwendung die lokale Funktion " \_ onupatewiedergabe" auf, die die folgenden Aktionen ausführt:</span><span class="sxs-lookup"><span data-stu-id="00a65-172">After clicking "Create Playlist" on the **Containers** menu, the application calls the local function \_OnCreatePlaylist, which performs the following actions:</span></span>

1.  <span data-ttu-id="00a65-173">Die Anzahl ausgewählter Elemente aus der globalen cdevfiles-Variablen erhalten.</span><span class="sxs-lookup"><span data-stu-id="00a65-173">Get the number of selected items from the global CDevFiles variable.</span></span>
2.  <span data-ttu-id="00a65-174">Ruft die lokale Funktion dlgnamewiedergabe auf, um ein Dialogfeld zu öffnen, in dem Sie einen Namen für die Wiedergabeliste abrufen können.</span><span class="sxs-lookup"><span data-stu-id="00a65-174">Call the local function DlgNamePlaylist to open a dialog box to get a name for the playlist.</span></span>
3.  <span data-ttu-id="00a65-175">Rufen Sie cprogress:: Create auf, um ein Dialogfeld zu erstellen, in dem der Fortschritt der Aktion angezeigt wird, und legen Sie Parameter für die cprogress-Klasse fest, z. b. Titel Text, Bereich, aktueller Wert usw.</span><span class="sxs-lookup"><span data-stu-id="00a65-175">Call the CProgress::Create to create a dialog window showing the progress of the action, and set parameters on the CProgress class, such as the title text, range, current value, and so on.</span></span>
4.  <span data-ttu-id="00a65-176">Durchlaufen Sie alle ausgewählten Elemente im Struktur Ansichts Objekt der cdevfiles, und fordern Sie das citemdata-Objekt an, das jeder ausgewählten Datei in der Strukturansicht zugeordnet ist. erhöhen Sie die Status Dialogleiste der einzelnen Dateien.</span><span class="sxs-lookup"><span data-stu-id="00a65-176">Loop through all the selected items in the CDevFiles tree view object, and request the CItemData object associated with each selected file in the tree view, incrementing the progress dialog bar with each file.</span></span> <span data-ttu-id="00a65-177">Die Dateien werden einem Array von [**iwmdmstorage**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage) -Schnittstellen hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="00a65-177">The files are added to an array of [**IWMDMStorage**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage) interfaces.</span></span>
5.  <span data-ttu-id="00a65-178">Rufen Sie ein Handle für das aktuell ausgewählte Element ab, und Fragen Sie es nach einer [**IWMDMStorageControl3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstoragecontrol3) -Schnittstelle ab, die später zum Erstellen der neuen Wiedergabeliste auf dem Gerät verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="00a65-178">Get a handle to the currently selected item and query it for an [**IWMDMStorageControl3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstoragecontrol3) interface, which will be used later to create the new playlist on the device.</span></span>
6.  <span data-ttu-id="00a65-179">Fragen Sie das ausgewählte Objekt nach [**IWMDMStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage3)ab, und rufen Sie [**CreateEmptyMetadataObject**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage3-createemptymetadataobject) auf, um eine neue [**iwmdmmetadata**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmmetadata)-Schnittstelle zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="00a65-179">Query the selected object for [**IWMDMStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage3), and call [**CreateEmptyMetadataObject**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage3-createemptymetadataobject) to create a new [**IWMDMMetaData**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmmetadata)interface.</span></span>
7.  <span data-ttu-id="00a65-180">Fügen Sie den Code "WMDM \_ Formatcode \_ abstractaudiovideoplaylist" zur neuen **iwmdmmetadata** -Schnittstelle hinzu, und erstellen Sie eine Wiedergabeliste auf dem Gerät durch Aufrufen von [**IWMDMStorageControl3:: Insert3**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstoragecontrol3-insert3)und übergeben Sie die Metadatenschnittstelle.</span><span class="sxs-lookup"><span data-stu-id="00a65-180">Add the WMDM\_FORMATCODE\_ABSTRACTAUDIOVIDEOPLAYLIST format code to the new **IWMDMMetadata** interface and create a playlist on the device by calling [**IWMDMStorageControl3::Insert3**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstoragecontrol3-insert3), passing in the metadata interface.</span></span> <span data-ttu-id="00a65-181">Die-Methode ruft einen Zeiger auf den neuen **iwmdmstorage** auf dem Gerät ab.</span><span class="sxs-lookup"><span data-stu-id="00a65-181">The method retrieves a pointer to the new **IWMDMStorage** on the device.</span></span>
8.  <span data-ttu-id="00a65-182">Füllen Sie die Wiedergabeliste aus, indem Sie den neuen Speicher für [**IWMDMStorage4**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage4)Abfragen und [**IWMDMStorage4:: abtreferences**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage4-setreferences)aufrufen. übergeben Sie dabei das in Schritt 4 gesammelte Array von **iwmdmstorage** -Zeigern.</span><span class="sxs-lookup"><span data-stu-id="00a65-182">Fill the playlist by querying the new storage for [**IWMDMStorage4**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage4), and calling [**IWMDMStorage4::SetReferences**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage4-setreferences), passing in the array of **IWMDMStorage** pointers collected in step 4.</span></span>
9.  <span data-ttu-id="00a65-183">Erstellen Sie abschließend ein neues citemdata-Objekt, das die neue Wiedergabeliste auf dem Gerät enthält, initialisieren Sie es mit dem neuen Speicher, und rufen Sie cdevfiles:: AddItem auf, um es dem Bereich "cdevfiles" hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="00a65-183">Finally, create a new CItemData object to hold the new playlist on the device, initialize it with the new storage, and call CDevFiles::AddItem to add it to the CDevFiles pane.</span></span>

## <a name="related-topics"></a><span data-ttu-id="00a65-184">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="00a65-184">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="00a65-185">**Beispiel für eine Desktop Anwendung**</span><span class="sxs-lookup"><span data-stu-id="00a65-185">**Sample Desktop Application**</span></span>](sample-desktop-application.md)
</dt> </dl>

 

 




