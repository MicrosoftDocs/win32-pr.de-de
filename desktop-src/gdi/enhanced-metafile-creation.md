---
description: Sie erstellen eine erweiterte Metadatei mithilfe der Funktion "-Funktion", die die entsprechenden Argumente bereitstellt.
ms.assetid: b012e50e-a7f5-4687-9833-38dacc113d77
title: Erweiterte metadateierstellung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 080c350e41e895c5d4bf834a6f407cca5907743d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103754416"
---
# <a name="enhanced-metafile-creation"></a><span data-ttu-id="8f65a-103">Erweiterte metadateierstellung</span><span class="sxs-lookup"><span data-stu-id="8f65a-103">Enhanced Metafile Creation</span></span>

<span data-ttu-id="8f65a-104">Sie erstellen eine erweiterte Metadatei mithilfe der [**Funktion "**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) -Funktion", die die entsprechenden Argumente bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="8f65a-104">You create an enhanced metafile by using the [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) function, supplying the appropriate arguments.</span></span> <span data-ttu-id="8f65a-105">Das System verwendet diese Argumente, um Bild Dimensionen beizubehalten, zu bestimmen, ob die Metadatendatei auf einem Datenträger oder im Arbeitsspeicher gespeichert werden soll usw.</span><span class="sxs-lookup"><span data-stu-id="8f65a-105">The system uses these arguments to maintain picture dimensions, determine whether the metafile should be stored on a disk or in memory, and so on.</span></span>

<span data-ttu-id="8f65a-106">Um Bild Dimensionen über Ausgabegeräte hinweg beizubehalten, erfordert die Auflösung des Referenz Geräts in der [**Datei**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) "".</span><span class="sxs-lookup"><span data-stu-id="8f65a-106">To maintain picture dimensions across output devices, [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) requires the resolution of the reference device.</span></span> <span data-ttu-id="8f65a-107">Dieses *Referenzgerät* ist das Gerät, auf dem das Bild zum ersten Mal angezeigt wird, und der *Referenz-DC* ist der *Gerätekontext* , der dem Referenzgerät zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="8f65a-107">This *reference device* is the device on which the picture first appeared, and the *reference DC* is the *device context* associated with the reference device.</span></span> <span data-ttu-id="8f65a-108">Wenn Sie die **CreateEnhMetaFile** -Funktion aufrufen, müssen Sie ein Handle bereitstellen, das diesen DC identifiziert.</span><span class="sxs-lookup"><span data-stu-id="8f65a-108">When calling the **CreateEnhMetaFile** function, you must supply a handle that identifies this DC.</span></span> <span data-ttu-id="8f65a-109">Sie können dieses Handle abrufen, indem Sie die [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) -oder [**CreateDC**](/windows/desktop/api/Wingdi/nf-wingdi-createdca) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="8f65a-109">You can get this handle by calling the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) or [**CreateDC**](/windows/desktop/api/Wingdi/nf-wingdi-createdca) function.</span></span> <span data-ttu-id="8f65a-110">Sie können auch **null** als Handle angeben, um das aktuelle Anzeigegerät für das Referenzgerät zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="8f65a-110">You can also specify **NULL** as the handle to use the current display device for the reference device.</span></span>

<span data-ttu-id="8f65a-111">In den meisten Anwendungen werden Bilder permanent gespeichert und daher eine erweiterte Metadatei erstellt, die auf einem Datenträger gespeichert ist. Es gibt jedoch einige Instanzen, wenn dies nicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="8f65a-111">Most applications store pictures permanently and therefore create an enhanced metafile that is stored on a disk; however, there are some instances when this is not necessary.</span></span> <span data-ttu-id="8f65a-112">Beispielsweise könnte eine Textverarbeitungsanwendung, die Diagramm Zeichnungsfunktionen bereitstellt, ein benutzerdefiniertes Diagramm im Arbeitsspeicher als erweiterte Metadatendatei speichern und dann die erweiterten metadateibits aus dem Arbeitsspeicher in die Dokument Datei des Benutzers kopieren.</span><span class="sxs-lookup"><span data-stu-id="8f65a-112">For example, a word-processing application that provides chart-drawing capabilities could store a user-defined chart in memory as an enhanced metafile and then copy the enhanced metafile bits from memory into the user's document file.</span></span> <span data-ttu-id="8f65a-113">Eine Anwendung, die eine auf einem Datenträger dauerhaft gespeicherte Metadatei erfordert, muss beim Aufrufen von "" die [**Datei "**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea)" den Dateinamen angeben.</span><span class="sxs-lookup"><span data-stu-id="8f65a-113">An application that requires a metafile that is stored permanently on a disk must supply the file name when it calls [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span></span> <span data-ttu-id="8f65a-114">Wenn Sie keinen Dateinamen angeben, behandelt das System die Metadatendatei automatisch als temporäre Datei und speichert Sie im Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="8f65a-114">If you do not supply a file name, the system automatically treats the metafile as a temporary file and stores it in memory.</span></span>

<span data-ttu-id="8f65a-115">Sie können eine optionale Textbeschreibung zu einer Metadatei hinzufügen, die Informationen über das Bild und den Autor enthält.</span><span class="sxs-lookup"><span data-stu-id="8f65a-115">You can add an optional text description to a metafile containing information about the picture and the author.</span></span> <span data-ttu-id="8f65a-116">In einer Anwendung können diese Zeichen folgen im Dialogfeld Datei öffnen angezeigt werden, um dem Benutzerinformationen über metadateninhalte bereitzustellen, die bei der Auswahl der entsprechenden Datei helfen.</span><span class="sxs-lookup"><span data-stu-id="8f65a-116">An application can display these strings in the File Open dialog box to provide the user with information about metafile content that will help in selecting the appropriate file.</span></span> <span data-ttu-id="8f65a-117">Wenn eine Anwendung die Textbeschreibung enthält, muss Sie einen Zeiger auf die Zeichenfolge bereitstellen, wenn Sie "" "" " [**".**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea)</span><span class="sxs-lookup"><span data-stu-id="8f65a-117">If an application includes the text description, it must supply a pointer to the string when it calls [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea).</span></span>

<span data-ttu-id="8f65a-118">Wenn " [**deateenhmetafile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) " erfolgreich ist, wird ein Handle zurückgegeben, das einen speziellen Metadatei-Gerätekontext identifiziert.</span><span class="sxs-lookup"><span data-stu-id="8f65a-118">When [**CreateEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-createenhmetafilea) succeeds, it returns a handle that identifies a special metafile device context.</span></span> <span data-ttu-id="8f65a-119">Ein Metadatei-Gerätekontext ist insofern eindeutig, als er einer Datei und nicht einem Ausgabegerät zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="8f65a-119">A metafile device context is unique in that it is associated with a file rather than with an output device.</span></span> <span data-ttu-id="8f65a-120">Wenn das System eine GDI-Funktion verarbeitet, die ein Handle für einen Metadatei-Gerätekontext empfangen hat, konvertiert Sie die GDI-Funktion in einen erweiterten Metadateidatensatz und fügt den Datensatz an das Ende der erweiterten Metadatei an.</span><span class="sxs-lookup"><span data-stu-id="8f65a-120">When the system processes a GDI function that received a handle to a metafile device context, it converts the GDI function into an enhanced-metafile record and appends the record to the end of the enhanced metafile.</span></span>

<span data-ttu-id="8f65a-121">Nachdem ein Bild abgeschlossen und der letzte Datensatz an die erweiterte Metadatendatei angehängt wurde, kann die Anwendung die Datei durch Aufrufen der [**CloseEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-closeenhmetafile) -Funktion schließen.</span><span class="sxs-lookup"><span data-stu-id="8f65a-121">After a picture is complete and the last record is appended to the enhanced metafile, the application can close the file by calling the [**CloseEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-closeenhmetafile) function.</span></span> <span data-ttu-id="8f65a-122">Diese Funktion schließt und löscht den speziellen Metadatei-Gerätekontext und gibt ein Handle zurück, das die erweiterte Metadatei identifiziert.</span><span class="sxs-lookup"><span data-stu-id="8f65a-122">This function closes and deletes the special metafile device context and returns a handle identifying the enhanced metafile.</span></span>

<span data-ttu-id="8f65a-123">Zum Löschen einer Datei mit erweitertem Format oder eines metadateihandles mit erweitertem Format müssen Sie die [**DeleteEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-deleteenhmetafile) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="8f65a-123">To delete an enhanced-format metafile or an enhanced-format metafile handle, call the [**DeleteEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-deleteenhmetafile) function.</span></span>

 

 



