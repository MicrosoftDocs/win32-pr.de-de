---
description: 'Sie können das Handle für eine erweiterte Metadatei verwenden, um die folgenden Aufgaben auszuführen:'
ms.assetid: 8f887c38-6cfa-4918-aa44-dd5fb837b40b
title: Erweiterte metadateivorgänge
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 18ba9e2ac2f14c4436c039a66cc3211b471c0461
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104130780"
---
# <a name="enhanced-metafile-operations"></a><span data-ttu-id="8b508-103">Erweiterte metadateivorgänge</span><span class="sxs-lookup"><span data-stu-id="8b508-103">Enhanced Metafile Operations</span></span>

<span data-ttu-id="8b508-104">Sie können das Handle für eine erweiterte Metadatei verwenden, um die folgenden Aufgaben auszuführen:</span><span class="sxs-lookup"><span data-stu-id="8b508-104">You can use the handle to an enhanced metafile to accomplish the following tasks:</span></span>

-   <span data-ttu-id="8b508-105">Zeigt das in einer erweiterten Metadatei gespeicherte Bild an.</span><span class="sxs-lookup"><span data-stu-id="8b508-105">Display the picture stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="8b508-106">Erstellen Sie Kopien einer erweiterten Metadatei.</span><span class="sxs-lookup"><span data-stu-id="8b508-106">Create copies of an enhanced metafile.</span></span>
-   <span data-ttu-id="8b508-107">Bearbeiten Sie eine erweiterte Metadatendatei.</span><span class="sxs-lookup"><span data-stu-id="8b508-107">Edit an enhanced metafile.</span></span>
-   <span data-ttu-id="8b508-108">Rufen Sie die optionale Beschreibung ab, die in einer erweiterten Metadatei gespeichert ist.</span><span class="sxs-lookup"><span data-stu-id="8b508-108">Retrieve the optional description stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="8b508-109">Rufen Sie eine Kopie eines Enhanced-Metafile-Headers ab.</span><span class="sxs-lookup"><span data-stu-id="8b508-109">Retrieve a copy of an enhanced-metafile header.</span></span>
-   <span data-ttu-id="8b508-110">Rufen Sie eine binäre Version einer erweiterten Metadatei ab.</span><span class="sxs-lookup"><span data-stu-id="8b508-110">Retrieve a binary version of an enhanced metafile.</span></span>
-   <span data-ttu-id="8b508-111">Listet die Farben in der optionalen Palette auf.</span><span class="sxs-lookup"><span data-stu-id="8b508-111">Enumerate the colors in the optional palette.</span></span>

<span data-ttu-id="8b508-112">Diese Aufgaben werden in den Abschnitten im weiteren Verlauf dieses Themas erläutert.</span><span class="sxs-lookup"><span data-stu-id="8b508-112">These tasks are discussed in the sections in the remainder of this topic.</span></span>

## <a name="display-the-picture-stored-in-an-enhanced-metafile"></a><span data-ttu-id="8b508-113">Anzeigen des in einer erweiterten Metadatei gespeicherten Bilds</span><span class="sxs-lookup"><span data-stu-id="8b508-113">Display the Picture Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="8b508-114">Mithilfe der Funktion [**playenhmetafile**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) können Sie das Bild anzeigen, das in einer erweiterten Metadatei gespeichert ist.</span><span class="sxs-lookup"><span data-stu-id="8b508-114">You can display the picture stored in an enhanced metafile using the [**PlayEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) function.</span></span> <span data-ttu-id="8b508-115">Übergeben Sie der Funktion ein Handle an die erweiterte Metadatendatei, ohne dass Sie sich mit dem Format der erweiterten metadateieinträge beschäftigen müssen.</span><span class="sxs-lookup"><span data-stu-id="8b508-115">Pass the function a handle to the enhanced metafile, without being concerned with the format of the enhanced metafile records.</span></span> <span data-ttu-id="8b508-116">Manchmal ist es jedoch wünschenswert, die Datensätze in der erweiterten Metadatei aufzuzählen, um nach einer bestimmten GDI-Funktion zu suchen und die Parameter der Funktion in irgendeiner Weise zu ändern.</span><span class="sxs-lookup"><span data-stu-id="8b508-116">However, it is sometimes desirable to enumerate the records in the enhanced metafile to search for a particular GDI function and modify the parameters of the function in some manner.</span></span> <span data-ttu-id="8b508-117">Zu diesem Zweck können Sie " [**enumenhmetafile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) " verwenden und eine Rückruffunktion " [**enhmetafileproc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc)" bereitstellen, um die erweiterten Metadatei-Datensätze zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="8b508-117">To do this, you can use [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) and provide a callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), to process the enhanced metafile records.</span></span> <span data-ttu-id="8b508-118">Um die Parameter für einen erweiterten Metadateidatensatz zu ändern, müssen Sie das Format der Parameter im Datensatz kennen.</span><span class="sxs-lookup"><span data-stu-id="8b508-118">To modify the parameters for an enhanced metafile record, you must know the format of the parameters within the record.</span></span>

## <a name="create-copies-of-an-enhanced-metafile"></a><span data-ttu-id="8b508-119">Erstellen von Kopien einer erweiterten Metadatei</span><span class="sxs-lookup"><span data-stu-id="8b508-119">Create Copies of an Enhanced Metafile</span></span>

<span data-ttu-id="8b508-120">Einige Anwendungen erstellen temporäre Sicherungskopien (oder Duplikate) einer Datei, bevor Sie dem Benutzer die Möglichkeit geben, das Original zu ändern.</span><span class="sxs-lookup"><span data-stu-id="8b508-120">Some applications create temporary backup (or duplicate) copies of a file before enabling the user to alter the original.</span></span> <span data-ttu-id="8b508-121">Eine Anwendung kann eine Sicherungskopie einer erweiterten Metadatei erstellen, indem Sie die [**copyenhmetafile**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) -Funktion aufrufen und ein Handle bereitstellt, das die erweiterte Metadatei identifiziert, und einen Zeiger auf den Namen der neuen Datei bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="8b508-121">An application can create a backup copy of an enhanced metafile by calling the [**CopyEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) function, supplying a handle that identifies the enhanced metafile, and supplying a pointer to the name of the new file.</span></span>

<span data-ttu-id="8b508-122">Rufen Sie zum Erstellen einer Speicher basierten Metadatei mit erweitertem Format die [**SetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) -Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="8b508-122">To create a memory-based enhanced-format metafile, call the [**SetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) function.</span></span>

## <a name="edit-an-enhanced-metafile"></a><span data-ttu-id="8b508-123">Bearbeiten einer erweiterten Metadatei</span><span class="sxs-lookup"><span data-stu-id="8b508-123">Edit an Enhanced Metafile</span></span>

<span data-ttu-id="8b508-124">Die meisten Zeichnungs-, Illustrations-und computergestützten Entwurfs Anwendungen (CAD) erfordern eine Methode zum Bearbeiten eines Bilds, das in einer erweiterten Metadatei gespeichert ist.</span><span class="sxs-lookup"><span data-stu-id="8b508-124">Most drawing, illustration, and computer-aided design (CAD) applications require a means of editing a picture stored in an enhanced metafile.</span></span> <span data-ttu-id="8b508-125">Obwohl das Bearbeiten einer erweiterten Metadatei eine komplexe Aufgabe ist, können Sie die [**enumenhmetafile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) -Funktion in Kombination mit anderen Funktionen verwenden, um diese Funktion in der Anwendung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="8b508-125">Although editing an enhanced metafile is a complex task, you can use the [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) function in combination with other functions to provide this capability in your application.</span></span> <span data-ttu-id="8b508-126">Mit der **enumenhmetafile** -Funktion und der zugehörigen Rückruffunktion " [**enhmetafileproc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc)" kann die Anwendung einzelne Datensätze in einer erweiterten Metadatei verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="8b508-126">The **EnumEnhMetaFile** function and its associated callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), enable the application to process individual records in an enhanced metafile.</span></span>

## <a name="retrieve-the-optional-description-stored-in-an-enhanced-metafile"></a><span data-ttu-id="8b508-127">Abrufen der optionalen Beschreibung, die in einer erweiterten Metadatei gespeichert ist</span><span class="sxs-lookup"><span data-stu-id="8b508-127">Retrieve the Optional Description Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="8b508-128">Einige Anwendungen zeigen die Textbeschreibung einer erweiterten Metadatei mit dem entsprechenden Dateinamen im Dialogfeld **Öffnen** an.</span><span class="sxs-lookup"><span data-stu-id="8b508-128">Some applications display the text description of an enhanced metafile with the corresponding file name in the **Open** dialog box.</span></span> <span data-ttu-id="8b508-129">Sie können bestimmen, ob diese Zeichenfolge in einer erweiterten Metadatei vorhanden ist, indem Sie den Metadatei-Header mit der [**getenhmetafileheader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) -Funktion abrufen und einen seiner Member untersuchen.</span><span class="sxs-lookup"><span data-stu-id="8b508-129">You can determine whether this string exists in an enhanced metafile by retrieving the metafile header with the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examining one of its members.</span></span> <span data-ttu-id="8b508-130">Wenn die Zeichenfolge vorhanden ist, ruft die Anwendung Sie durch Aufrufen der [**getenhmetafiledescription**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) -Funktion ab.</span><span class="sxs-lookup"><span data-stu-id="8b508-130">If the string exists, the application retrieves it by calling the [**GetEnhMetaFileDescription**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) function.</span></span>

## <a name="retrieve-a-binary-version-of-an-enhanced-metafile"></a><span data-ttu-id="8b508-131">Abrufen einer binären Version einer erweiterten Metadatei</span><span class="sxs-lookup"><span data-stu-id="8b508-131">Retrieve a Binary Version of an Enhanced Metafile</span></span>

<span data-ttu-id="8b508-132">Sie können den Inhalt einer Metadatei abrufen, indem Sie die [**GetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) -Funktion aufrufen. bevor Sie den Inhalt abrufen, müssen Sie jedoch die Größe der Datei angeben.</span><span class="sxs-lookup"><span data-stu-id="8b508-132">You can retrieve the contents of a metafile by calling the [**GetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) function; however, before retrieving the contents, you must specify the size of the file.</span></span> <span data-ttu-id="8b508-133">Um die Größe zu erhalten, können Sie die [**getenhmetafileheader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) -Funktion verwenden und den entsprechenden Member überprüfen.</span><span class="sxs-lookup"><span data-stu-id="8b508-133">To get the size, you can use the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examine the appropriate member.</span></span>

## <a name="enumerate-the-colors-in-the-optional-palette"></a><span data-ttu-id="8b508-134">Auflisten der Farben in der optionalen Palette</span><span class="sxs-lookup"><span data-stu-id="8b508-134">Enumerate the Colors in the Optional Palette</span></span>

<span data-ttu-id="8b508-135">Um konsistente Farben zu erreichen, wenn ein Bild auf verschiedenen Ausgabegeräten angezeigt wird, können Sie die [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) -Funktion aufzurufen und eine logische Palette in einer erweiterten Metadatei speichern.</span><span class="sxs-lookup"><span data-stu-id="8b508-135">To achieve consistent colors when a picture is displayed on various output devices, you can call the [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) function and store a logical palette in an enhanced metafile.</span></span> <span data-ttu-id="8b508-136">Eine Anwendung, die das in der erweiterten Metadatei gespeicherte Bild anzeigt, ruft diese Palette ab und ruft die [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) -Funktion vor dem Anzeigen des Bilds auf.</span><span class="sxs-lookup"><span data-stu-id="8b508-136">An application that displays the picture stored in the enhanced metafile retrieves this palette and calls the [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) function before displaying the picture.</span></span> <span data-ttu-id="8b508-137">Um zu ermitteln, ob eine Palette in einer erweiterten Metadatei gespeichert ist, rufen Sie den Metadatei-Header ab, und überprüfen Sie den entsprechenden Member.</span><span class="sxs-lookup"><span data-stu-id="8b508-137">To determine whether a palette is stored in an enhanced metafile, retrieve the metafile header and examine the appropriate member.</span></span> <span data-ttu-id="8b508-138">Wenn eine Palette vorhanden ist, können Sie die [**getenhmetafilepaletteentries**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) -Funktion aufrufen, um die logische Palette abzurufen.</span><span class="sxs-lookup"><span data-stu-id="8b508-138">If a palette exists, you can call the [**GetEnhMetaFilePaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) function to retrieve the logical palette.</span></span>

 

 
