---
description: Änderungen an der Systempalette für das Anzeigegerät können dramatische und mitunter unerwünschte Auswirkungen auf die in Windows auf dem Desktop verwendeten Farben haben.
ms.assetid: 9c470b6f-c0d3-462e-9649-1f39b06bd543
title: Palettennachrichten
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9f19a5458ec89d8d9a0524fd2ec383de740c0179
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104978449"
---
# <a name="palette-messages"></a><span data-ttu-id="21cc3-103">Palettennachrichten</span><span class="sxs-lookup"><span data-stu-id="21cc3-103">Palette Messages</span></span>

<span data-ttu-id="21cc3-104">Änderungen an der Systempalette für das Anzeigegerät können dramatische und mitunter unerwünschte Auswirkungen auf die in Windows auf dem Desktop verwendeten Farben haben.</span><span class="sxs-lookup"><span data-stu-id="21cc3-104">Changes to the system palette for the display device can have dramatic and sometimes undesirable effects on the colors used in windows on the desktop.</span></span> <span data-ttu-id="21cc3-105">Um die Auswirkungen dieser Änderungen zu minimieren, stellt das System eine Reihe von Nachrichten bereit, mit deren Hilfe Anwendungen ihre logischen Paletten verwalten können und gleichzeitig sichergestellt werden, dass die Farben im aktiven Fenster so nah wie möglich an den gewünschten Farben sind.</span><span class="sxs-lookup"><span data-stu-id="21cc3-105">To minimize the impact of these changes, the system provides a set of messages that help applications manage their logical palettes while ensuring that colors in the active window are as close as possible to the colors intended.</span></span>

<span data-ttu-id="21cc3-106">Das System sendet eine [**WM \_ querynewpalette**](wm-querynewpalette.md) -Nachricht an ein überlappendes Fenster der obersten Ebene oder direkt vor dem Aktivieren des Fensters.</span><span class="sxs-lookup"><span data-stu-id="21cc3-106">The system sends a [**WM\_QUERYNEWPALETTE**](wm-querynewpalette.md) message to a top-level or overlapped window just before activating the window.</span></span> <span data-ttu-id="21cc3-107">Diese Meldung gibt einer Anwendung die Möglichkeit, die logische Palette auszuwählen und zu erkennen, sodass Sie die bestmögliche Zuordnung von Farben für die logische Palette erhält.</span><span class="sxs-lookup"><span data-stu-id="21cc3-107">This message gives an application the opportunity to select and realize its logical palette so that it receives the best possible mapping of colors for its logical palette.</span></span> <span data-ttu-id="21cc3-108">Wenn die Anwendung die Nachricht empfängt, sollte Sie die Funktionen " [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette)", " [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject)" und " [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) " verwenden, um die logische Palette auszuwählen und zu erkennen.</span><span class="sxs-lookup"><span data-stu-id="21cc3-108">When the application receives the message, it should use the [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette), [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject), and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) functions to select and realize the logical palette.</span></span> <span data-ttu-id="21cc3-109">Dadurch wird das System angewiesen, Farben in der Systempalette zu aktualisieren, sodass seine Farben so viele Farben in der logischen Palette wie möglich entsprechen.</span><span class="sxs-lookup"><span data-stu-id="21cc3-109">Doing so directs the system to update colors in the system palette so that its colors match as many colors in the logical palette as possible.</span></span>

<span data-ttu-id="21cc3-110">Wenn eine Anwendung Änderungen an der Systempalette aufgrund der erkannten logischen Palette bewirkt, sendet das System eine [**WM \_ palettechanged**](wm-palettechanged.md) -Nachricht an alle Fenster der obersten Ebene und überlappende Fenster.</span><span class="sxs-lookup"><span data-stu-id="21cc3-110">When an application causes changes to the system palette as a result of realizing its logical palette, the system sends a [**WM\_PALETTECHANGED**](wm-palettechanged.md) message to all top-level and overlapped windows.</span></span> <span data-ttu-id="21cc3-111">Diese Meldung gibt Anwendungen die Möglichkeit, die Farben in den Client Bereichen ihrer Fenster zu aktualisieren und Farben zu ersetzen, die sich mit Farben geändert haben, die den gewünschten Farben genauer entsprechen.</span><span class="sxs-lookup"><span data-stu-id="21cc3-111">This message gives applications the opportunity to update the colors in the client areas of their windows, replacing colors that have changed with colors that more closely match the intended colors.</span></span> <span data-ttu-id="21cc3-112">Eine Anwendung, die die **WM \_ palettechanged** -Nachricht empfängt, sollte [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) und [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) verwenden, um die logischen Paletten zurückzusetzen, die allen inaktiven Fenstern zugeordnet sind, und dann die Farben im Client Bereich für jedes inaktive Fenster mithilfe der [**updatecolors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) -Funktion zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="21cc3-112">An application that receives the **WM\_PALETTECHANGED** message should use [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) to reset the logical palettes associated with all inactive windows and then update the colors in the client area for each inactive window by using the [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) function.</span></span> <span data-ttu-id="21cc3-113">Diese Technik garantiert nicht die höchste Anzahl von exakten Farb Übereinstimmungen. Allerdings wird sichergestellt, dass die Farben in der logischen Palette den sinnvollen Farben in der Systempalette zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="21cc3-113">This technique does not guarantee the greatest number of exact color matches; however, it does ensure that colors in the logical palette are mapped to reasonable colors in the system palette.</span></span>

> [!Note]  
> <span data-ttu-id="21cc3-114">Um zu vermeiden, dass eine Endlosschleife erstellt wird, sollte eine Anwendung niemals die Palette für das Fenster erkennen, dessen Handle mit dem Handle übereinstimmt, das im *wParam* -Parameter der [**WM \_ palettechanged**](wm-palettechanged.md) -Nachricht übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="21cc3-114">To avoid creating an infinite loop, an application should never realize the palette for the window whose handle matches the handle passed in the *wParam* parameter of the [**WM\_PALETTECHANGED**](wm-palettechanged.md) message.</span></span>

 

<span data-ttu-id="21cc3-115">Die Funktion [**updatecolors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) aktualisiert in der Regel einen Client Bereich eines inaktiven Fensters schneller, als den Bereich neu zu zeichnen.</span><span class="sxs-lookup"><span data-stu-id="21cc3-115">The [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) function typically updates a client area of an inactive window faster than redrawing the area.</span></span> <span data-ttu-id="21cc3-116">Da **updatecolors** jedoch eine Farb Übersetzung basierend auf der Farbe jedes Pixels vor der Änderung der Systempalette durchführt, führt jeder Rückruf dieser Funktion zu einem Verlust der Farbgenauigkeit.</span><span class="sxs-lookup"><span data-stu-id="21cc3-116">However, because **UpdateColors** performs color translation based on the color of each pixel before the system palette changed, each call to this function results in the loss of some color accuracy.</span></span> <span data-ttu-id="21cc3-117">Dies bedeutet, dass **updatecolors** nicht zum Aktualisieren von Farben verwendet werden können, wenn das Fenster aktiv wird.</span><span class="sxs-lookup"><span data-stu-id="21cc3-117">This means **UpdateColors** cannot be used to update colors when the window becomes active.</span></span> <span data-ttu-id="21cc3-118">In solchen Fällen sollte die Anwendung den Client Bereich neu zeichnen.</span><span class="sxs-lookup"><span data-stu-id="21cc3-118">In such cases, the application should redraw the client area.</span></span>

<span data-ttu-id="21cc3-119">Das System kann die [**WM- \_ Abfrage "querynewpalette**](wm-querynewpalette.md) " senden, wenn Änderungen an der logischen Palette vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="21cc3-119">The system may send the [**WM\_QUERYNEWPALETTE**](wm-querynewpalette.md) message when changes to the logical palette are made.</span></span> <span data-ttu-id="21cc3-120">Außerdem kann das System die WM- [**\_ paletteischanging**](wm-paletteischanging.md) -Nachricht an alle Fenster der obersten Ebene und überlappende Fenster senden, wenn sich die Systempalette ändert.</span><span class="sxs-lookup"><span data-stu-id="21cc3-120">Also, the system may send the [**WM\_PALETTEISCHANGING**](wm-paletteischanging.md) message to all top-level and overlapped windows when the system palette is about to change.</span></span>

 

 



