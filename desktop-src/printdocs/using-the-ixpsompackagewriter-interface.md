---
description: Die ixpsompackagewriter-Schnittstelle erstellt eine XPS-Dokument Datei, in die Anwendungen den Inhalt der ixpsompage-Schnittstellen eines XPS-OMS schreiben können.
ms.assetid: eff1ab1e-2205-4f5c-9e32-199e073f5dbf
title: Verwenden der ixpsompackagewriter-Schnittstelle
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f1e8a34a0538ff09cc050ac287d5314be93f0da8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106362663"
---
# <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="7f36a-103">Verwenden der ixpsompackagewriter-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="7f36a-103">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="7f36a-104">Die [**ixpsompackagewriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) -Schnittstelle erstellt eine XPS-Dokument Datei, in die Anwendungen den Inhalt der [**ixpsompage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) -Schnittstellen eines XPS-OMS schreiben können.</span><span class="sxs-lookup"><span data-stu-id="7f36a-104">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an XPS document file into which applications can write the contents of the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interfaces of an XPS OM.</span></span> <span data-ttu-id="7f36a-105">Die [**ixpsompackagewriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) -Schnittstelle ist besonders nützlich, wenn Dokumentinhalte sequenziell verarbeitet oder erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="7f36a-105">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface is most useful when document contents are being processed or created sequentially.</span></span> <span data-ttu-id="7f36a-106">Im Gegensatz zu den Methoden " [**Write**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) " und " [**Write-to Stream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) " der [**ixpsompackage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) -Schnittstelle, damit die **ixpsompackagewriter** -Schnittstelle verwendet werden kann, muss weder das gesamte "FixedDocument" noch "FixedDocumentSequence" abgeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="7f36a-106">Unlike the [**WriteToFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) and [**WriteToStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) methods of the [**IXpsOMPackage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) interface, for the **IXpsOMPackageWriter** interface to be used neither the entire FixedDocument nor the FixedDocumentSequence has to be finished.</span></span>

## <a name="overview"></a><span data-ttu-id="7f36a-107">Übersicht</span><span class="sxs-lookup"><span data-stu-id="7f36a-107">Overview</span></span>

<span data-ttu-id="7f36a-108">Die [**ixpsompackagewriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) -Schnittstelle schreibt jeweils eine Seite von der ersten Seite eines XPS-Dokuments in die letzte Seite.</span><span class="sxs-lookup"><span data-stu-id="7f36a-108">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface writes one page at a time, from the first page of an XPS document to the last.</span></span> <span data-ttu-id="7f36a-109">Die-Schnittstelle kann verwendet werden, um einfache XPS-Dokument Dateien und auch komplexe XPS-Dokument Dateien zu erstellen, die mehr als ein FixedDocument in der FixedDocumentSequence enthalten.</span><span class="sxs-lookup"><span data-stu-id="7f36a-109">The interface can be used to create simple XPS document files and also complex XPS document files that contain more than one FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="7f36a-110">In komplexen XPS-Dokument Dateien werden fixeddocuments auch nacheinander erstellt, beginnend mit dem ersten FixedDocument in FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="7f36a-110">In complex XPS document files, the FixedDocuments are also created in sequence, starting with the first FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="7f36a-111">Die **ixpsompackagewriter** -Schnittstelle unterstützt nicht die Erstellung von Dokument Inhalten in zufälliger Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="7f36a-111">The **IXpsOMPackageWriter** interface does not support the creation of document contents in random order.</span></span> <span data-ttu-id="7f36a-112">Verwenden Sie diese z. b., um einen sequenziellen Bericht zu erstellen oder um die Verarbeitung in einem Gerätetreiber Filter auszuführen, bei dem der Inhalt des Dokuments nacheinander an den Treiber übertragen wird.</span><span class="sxs-lookup"><span data-stu-id="7f36a-112">Use it, for example, to create a sequential report or to perform processing in a device driver filter where the document contents are fed to the driver in sequence.</span></span>

## <a name="terminology-review"></a><span data-ttu-id="7f36a-113">Überprüfung der Terminologie</span><span class="sxs-lookup"><span data-stu-id="7f36a-113">Terminology Review</span></span>

<span data-ttu-id="7f36a-114">Eine *XPS-Dokument Datei* ist ein OPC-Paket (Open Packaging Conventions), das der XML Paper Specification entspricht.</span><span class="sxs-lookup"><span data-stu-id="7f36a-114">An *XPS document file* is an Open Packaging Conventions (OPC) package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="7f36a-115">Aus technischer Sicht erstellt die [**ixpsompackagewriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) -Schnittstelle also ein *OPC-Paket*, aber es ist ein OPC-Paket, das der XML Paper Specification entspricht.</span><span class="sxs-lookup"><span data-stu-id="7f36a-115">So, technically, the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an *OPC package*, but it is an OPC package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="7f36a-116">Aus diesem Grund werden die Begriffe *XPS-Dokument* und- *Paket* in Diskussionen über XPS-Dokumente häufig austauschbar verwendet.</span><span class="sxs-lookup"><span data-stu-id="7f36a-116">For this reason, in discussions about XPS documents, the terms *XPS document* and *package* are often used interchangeably.</span></span>

<span data-ttu-id="7f36a-117">Das von der [**ixpsompackagewriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) -Schnittstelle erstellte *Paket* enthält die erforderlichen XPS-Dokument Komponenten: eine FixedDocumentSequence, mindestens ein FixedDocument und mindestens eine FixedPage.</span><span class="sxs-lookup"><span data-stu-id="7f36a-117">The *package* created by the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface will contain the required XPS document components: a FixedDocumentSequence, at least one FixedDocument, and at least one FixedPage.</span></span> <span data-ttu-id="7f36a-118">"FixedDocumentSequence" wird erstellt, wenn die **ixpsompackagewriter** -Schnittstelle instanziiert wird.</span><span class="sxs-lookup"><span data-stu-id="7f36a-118">The FixedDocumentSequence is created when the **IXpsOMPackageWriter** interface is instantiated.</span></span> <span data-ttu-id="7f36a-119">Jedes Mal, wenn [**ixpsompackagewriter:: startnewdocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) aufgerufen wird, wird ein FixedDocument-Dokument erstellt, und es wird jedes Mal eine FixedPage erstellt, wenn [**ixpsompackagewriter:: addPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7f36a-119">A FixedDocument is created every time [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) is called, and a FixedPage is created every time [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) is called.</span></span> <span data-ttu-id="7f36a-120">Da die-Schnittstelle den Dokumentinhalt sequenziell schreibt, fügt die **addPage** -Methode die Seite dem zuletzt erstellten FixedDocument-Dokument hinzu.</span><span class="sxs-lookup"><span data-stu-id="7f36a-120">Because the interface writes the document contents sequentially, the **AddPage** method adds the page to the most recently created FixedDocument.</span></span>

## <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="7f36a-121">Verwenden der ixpsompackagewriter-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="7f36a-121">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="7f36a-122">Im folgenden Verfahren wird beschrieben, wie eine XPS-Dokument Datei mithilfe der [**ixpsompackagewriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) -Schnittstelle erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="7f36a-122">The following procedure describes how to create an XPS document file by using the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span> <span data-ttu-id="7f36a-123">In der Prozedur wird nicht beschrieben, wie eine [**ixpsompage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) -Schnittstelle und deren Inhalt instanziiert wird.</span><span class="sxs-lookup"><span data-stu-id="7f36a-123">The procedure does not describe how to instantiate an [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface and its contents.</span></span> <span data-ttu-id="7f36a-124">Weitere Informationen zu **ixpsompage** und zum Hinzufügen von Inhalt zu einer Seite finden Sie unter [XPS OM-Seiten Schnittstellen](xps-object-model-page-interfaces.md) und in den Themen, die im Abschnitt "Siehe auch" aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="7f36a-124">For more information about **IXpsOMPage** and adding content to a page, see [XPS OM Page Interfaces](xps-object-model-page-interfaces.md) and the topics listed in the See Also section.</span></span>

 <span data-ttu-id="7f36a-125">**Erstellen eines Dokuments**</span><span class="sxs-lookup"><span data-stu-id="7f36a-125">**Creating a document**</span></span>

1.  <span data-ttu-id="7f36a-126">Instanziieren Sie eine [**ixpsompackagewriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="7f36a-126">Instantiate an [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span>

    <span data-ttu-id="7f36a-127">Dadurch wird eine leere "FixedDocumentSequence" im Paket erstellt.</span><span class="sxs-lookup"><span data-stu-id="7f36a-127">This creates an empty FixedDocumentSequence in the package.</span></span>

    -   <span data-ttu-id="7f36a-128">Wenn Sie ein XPS-Dokument in einer Datei erstellen möchten, rufen Sie [**ixpsomobjectfactory:: conatepackageschreiteronfile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile)auf.</span><span class="sxs-lookup"><span data-stu-id="7f36a-128">To create an XPS document in a file, call [**IXpsOMObjectFactory::CreatePackageWriterOnFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile).</span></span>
    -   <span data-ttu-id="7f36a-129">Um ein XPS-Dokument in einem Stream zu erstellen, rufen Sie [**ixpsomobjectfactory:: anatepackageschreiteronstream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream)auf.</span><span class="sxs-lookup"><span data-stu-id="7f36a-129">To create an XPS document in a stream, call [**IXpsOMObjectFactory::CreatePackageWriterOnStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream).</span></span>

2.  <span data-ttu-id="7f36a-130">Starten Sie ein neues Dokument im Paket, indem Sie [**ixpsompackagewriter:: startnewdocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="7f36a-130">Start a new document in the package by calling [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>

    <span data-ttu-id="7f36a-131">Bevor Sie eine Seite hinzufügen, können Sie [**ixpsompackagewriter:: startnewdocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) aufrufen, um der in Schritt 1 erstellten FixedDocumentSequence ein FixedDocument hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="7f36a-131">Before adding a page, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) to add a FixedDocument to the FixedDocumentSequence that was created in step 1.</span></span>

3.  <span data-ttu-id="7f36a-132">Inhalt hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="7f36a-132">Add content.</span></span>
    -   <span data-ttu-id="7f36a-133">Um dem Dokument eine neue FixedPage hinzuzufügen, wenden Sie [**ixpsompackagewriter:: addPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage)an, und übergeben Sie dabei einen Zeiger auf die [**ixpsompage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) -Schnittstelle mit dem Inhalt der FixedPage, die Sie hinzufügen möchten.</span><span class="sxs-lookup"><span data-stu-id="7f36a-133">To add a new FixedPage to the document, call [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage), passing it a pointer to the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface that has the contents of the FixedPage that you want to add.</span></span>
    -   <span data-ttu-id="7f36a-134">Um ein neues FixedDocument in der FixedDocumentSequence-Sequenz zu erstellen, rufen Sie [**ixpsompackagewriter:: startnewdocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument)auf.</span><span class="sxs-lookup"><span data-stu-id="7f36a-134">To create a new FixedDocument in the FixedDocumentSequence, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>
4.  <span data-ttu-id="7f36a-135">Schließen Sie das Paket und seinen Inhalt, indem Sie [**ixpsompackagewriter:: Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="7f36a-135">Close the package and its contents by calling [**IXpsOMPackageWriter::Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close).</span></span>

## <a name="advanced-features"></a><span data-ttu-id="7f36a-136">Erweiterte Funktionen</span><span class="sxs-lookup"><span data-stu-id="7f36a-136">Advanced Features</span></span>

<span data-ttu-id="7f36a-137">Die Methoden der [**ixpsompackagewriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) -Schnittstelle unterstützen auch das Hinzufügen von Ressourcen, Miniaturansichten und Druck Tickets.</span><span class="sxs-lookup"><span data-stu-id="7f36a-137">The methods of the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface also support the adding of resources, thumbnails, and print tickets.</span></span> <span data-ttu-id="7f36a-138">Diese Dokument Komponenten können auf den Ebenen "Package", "FixedDocumentSequence", "FixedDocument" und "FixedPage" hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="7f36a-138">These document components can be added at the package, FixedDocumentSequence, FixedDocument, and FixedPage levels.</span></span> <span data-ttu-id="7f36a-139">Weitere Informationen zum Verwenden dieser Schnittstelle zum Drucken finden Sie unter [Drucken eines XPS OM](print-an-xps-om.md).</span><span class="sxs-lookup"><span data-stu-id="7f36a-139">For more information about using this interface for printing, see [Print an XPS OM](print-an-xps-om.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="7f36a-140">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="7f36a-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7f36a-141">Verwenden der XPS Digital-Signatur-API</span><span class="sxs-lookup"><span data-stu-id="7f36a-141">Using XPS Digital Signature API</span></span>](using-digital-signatures-in-xps-documents.md)
</dt> <dt>

[<span data-ttu-id="7f36a-142">XPS-Schnittstellen für Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="7f36a-142">XPS OM Page Interfaces</span></span>](xps-object-model-page-interfaces.md)
</dt> <dt>

[<span data-ttu-id="7f36a-143">Navigieren im XPS-OM</span><span class="sxs-lookup"><span data-stu-id="7f36a-143">Navigate the XPS OM</span></span>](navigate-the-xps-om.md)
</dt> <dt>

[<span data-ttu-id="7f36a-144">Arbeiten mit XPS OM-Canvas und visuellen Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="7f36a-144">Working with XPS OM Canvas and Visual Interfaces</span></span>](working-with-xpsomcanvas-interfaces.md)
</dt> <dt>

[<span data-ttu-id="7f36a-145">Arbeiten mit XPS-OM-Pfad Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="7f36a-145">Working with XPS OM Path Interfaces</span></span>](working-with-xps-object-model-path-interfaces.md)
</dt> <dt>

[<span data-ttu-id="7f36a-146">Arbeiten mit XPS OM-Text, Grafiken und Bild Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="7f36a-146">Working with XPS OM Text, Graphics, and Image Interfaces</span></span>](working-with-xps-object-model-text-and-image-interfaces.md)
</dt> <dt>

[<span data-ttu-id="7f36a-147">Schnittstellen für XPS-OM-Druck Tickets</span><span class="sxs-lookup"><span data-stu-id="7f36a-147">XPS OM Print Ticket Interfaces</span></span>](xps-object-model-print-ticket-interfaces.md)
</dt> <dt>

[<span data-ttu-id="7f36a-148">**Ixpsomthumbnailgenerator**</span><span class="sxs-lookup"><span data-stu-id="7f36a-148">**IXpsOMThumbnailGenerator**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomthumbnailgenerator)
</dt> <dt>

[<span data-ttu-id="7f36a-149">XPS-Dokument-API-Referenz</span><span class="sxs-lookup"><span data-stu-id="7f36a-149">XPS Document API Reference</span></span>](xps-programming-reference.md)
</dt> <dt>

[<span data-ttu-id="7f36a-150">XML Paper Specification</span><span class="sxs-lookup"><span data-stu-id="7f36a-150">XML Paper Specification</span></span>](https://www.ecma-international.org/activities/XML%20Paper%20Specification/XPS%20Standard%20WD%201.6.pdf)
</dt> </dl>

 

 



