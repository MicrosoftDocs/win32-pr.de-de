---
title: Prinzipal Namen
description: Damit ein Client eine gegenseitig authentifizierte Sitzung mit einem Serverprogramm erstellen kann, muss er den erwarteten Prinzipal Namen des Servers bereitstellen.
ms.assetid: 4d9977f8-0efb-4559-977e-3eba4e277bc0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 554ffecff6eb019b4712e6b2d9f5c6319db492e7
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104471652"
---
# <a name="principal-names"></a><span data-ttu-id="794f7-103">Prinzipal Namen</span><span class="sxs-lookup"><span data-stu-id="794f7-103">Principal Names</span></span>

<span data-ttu-id="794f7-104">Damit ein Client eine gegenseitig authentifizierte Sitzung mit einem Serverprogramm erstellen kann, muss er den erwarteten Prinzipal Namen des Servers bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="794f7-104">For a client to create a mutually authenticated session with a server program, it must provide the server's expected principal name.</span></span> <span data-ttu-id="794f7-105">Einige Protokolle, wie z. b. Kerberos, erfordern einen korrekten Server Prinzipal Namen für jede beliebige authentifizierte Sitzung.</span><span class="sxs-lookup"><span data-stu-id="794f7-105">Some protocols, such as Kerberos, require a correct server principal name for any authenticated session.</span></span> <span data-ttu-id="794f7-106">Ein Prinzipal ist eine Entität, die vom Sicherheitssystem erkannt wird.</span><span class="sxs-lookup"><span data-stu-id="794f7-106">A principal is an entity that the security system recognizes.</span></span> <span data-ttu-id="794f7-107">Dies schließt sowohl menschliche Benutzer als auch Systemdienste ein.</span><span class="sxs-lookup"><span data-stu-id="794f7-107">This includes human users as well as system services.</span></span> <span data-ttu-id="794f7-108">Alle Prinzipal Namen haben ein ähnliches Format für eine bestimmte Security Support Provider (SSP).</span><span class="sxs-lookup"><span data-stu-id="794f7-108">All principal names take similar format for a given security support provider (SSP).</span></span> <span data-ttu-id="794f7-109">Ein SSP ist ein Softwaremodul, das die Sicherheitsüberprüfung ausführt.</span><span class="sxs-lookup"><span data-stu-id="794f7-109">An SSP is a software module that performs security validation.</span></span> <span data-ttu-id="794f7-110">Weitere Informationen finden Sie unter [Übersicht über die SSPI-Architektur](sspi-architectural-overview.md).</span><span class="sxs-lookup"><span data-stu-id="794f7-110">For more information, see [SSPI Architectural Overview](sspi-architectural-overview.md).</span></span> <span data-ttu-id="794f7-111">Um die Einheitlichkeit aufrechtzuerhalten, gibt ein Sicherheitsanbieter in der Regelsystem Dienste ähnliche Namen wie Benutzer.</span><span class="sxs-lookup"><span data-stu-id="794f7-111">To maintain uniformity, a security provider usually gives system services similar names as users.</span></span> <span data-ttu-id="794f7-112">Unter einigen Sicherheitsanbietern haben Systemdienste möglicherweise keinen Prinzipal Namen.</span><span class="sxs-lookup"><span data-stu-id="794f7-112">Under some security providers, system services may not have a principal name.</span></span>

<span data-ttu-id="794f7-113">Der Server registriert seinen Prinzipal Namen für den Sicherheitsanbieter mithilfe der [**rpcserverregisterauthinfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterauthinfo) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="794f7-113">The server registers its principal name for the security provider using the [**RpcServerRegisterAuthInfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterauthinfo) function.</span></span> <span data-ttu-id="794f7-114">Für jeden Sicherheitsanbieter kann nur ein Server Prinzipal Name verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="794f7-114">Only one server principal name can be used for each security provider.</span></span> <span data-ttu-id="794f7-115">Wenn mehr als ein Name registriert ist, wird ein Name nach dem Zufallsprinzip ausgewählt und verwendet.</span><span class="sxs-lookup"><span data-stu-id="794f7-115">If more than one name is registered, one name is randomly chosen and used.</span></span> <span data-ttu-id="794f7-116">Der SSP schreibt das Format des Prinzipal namens vor.</span><span class="sxs-lookup"><span data-stu-id="794f7-116">The SSP dictates the format of the principal name.</span></span> <span data-ttu-id="794f7-117">Beispielsweise sehen die Kerberos/Aushandlungs-SSPs für einen Systemdienst ungefähr wie folgt aus: Computer \_ Name $ @childdomain.parentdomain1.parentdomain2.COM .</span><span class="sxs-lookup"><span data-stu-id="794f7-117">For example, the Kerberos/Negotiate SSPs for a system service look approximately like the following: machine\_name$@childdomain.parentdomain1.parentdomain2.COM.</span></span>

<span data-ttu-id="794f7-118">Die empfohlene Vorgehensweise zum Erstellen von Prinzipal Namen ist die Verwendung von dokumentierten APIs (z. b. der **dsmakespn** -Funktion), anstatt den Prinzipal Namen aus Zeichen folgen zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="794f7-118">The recommended procedure for generating principal names is to use documented APIs (such as the **DsMakeSpn** function), rather than piecing together the principal name from strings.</span></span> <span data-ttu-id="794f7-119">Die Verwendung dokumentierter APIs steigert die Portabilität zwischen verschiedenen Bereitstellungs Umgebungen und beseitigt die Möglichkeit von Fehlern.</span><span class="sxs-lookup"><span data-stu-id="794f7-119">Using documented APIs increases portability between different deployment environments and eliminates the possibility for errors.</span></span>

<span data-ttu-id="794f7-120">Durch die Angabe eines falschen Prinzipal namens kann verhindert werden, dass der Client und der Server eine authentifizierte Sitzung einrichten.</span><span class="sxs-lookup"><span data-stu-id="794f7-120">Specifying an incorrect principal name may prevent the client and server from establishing an authenticated session.</span></span> <span data-ttu-id="794f7-121">Der Schannel-SSP übernimmt Prinzipal Namen in einer von zwei Formen:</span><span class="sxs-lookup"><span data-stu-id="794f7-121">The SCHANNEL SSP takes principal names in either of two forms:</span></span>

-   <span data-ttu-id="794f7-122">Das erste SChannel-Prinzipal namens Formular ist das [*msstd*](m-glos.md) -Formular.</span><span class="sxs-lookup"><span data-stu-id="794f7-122">The first SCHANNEL principal name form is the [*msstd*](m-glos.md) form.</span></span> <span data-ttu-id="794f7-123">Namen in msstd-Form folgen im Allgemeinen dem Muster msstd:servername@serverdomain.com .</span><span class="sxs-lookup"><span data-stu-id="794f7-123">Names in msstd form generally follow the pattern msstd:servername@serverdomain.com.</span></span> <span data-ttu-id="794f7-124">Dies wird als e-Mail-Name-Eigenschaft bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="794f7-124">This is referred to as an email name property.</span></span> <span data-ttu-id="794f7-125">Wenn das Zertifikat eine e-Mail-Name-Eigenschaft enthält und das @-Zeichen (@) enthält, lautet der Prinzipal Name msstd: Email Name.</span><span class="sxs-lookup"><span data-stu-id="794f7-125">If the certificate contains an email name property, and it contains the at sign (@), the principal name is msstd:email name.</span></span> <span data-ttu-id="794f7-126">Andernfalls muss Sie die Common Name-Eigenschaft enthalten.</span><span class="sxs-lookup"><span data-stu-id="794f7-126">Otherwise it must contain the common name property.</span></span> <span data-ttu-id="794f7-127">Interne umgekehrte Schrägstriche werden wie bei Zeichen folgen Bindungen verdoppelt.</span><span class="sxs-lookup"><span data-stu-id="794f7-127">Internal backslashes are doubled, just as in string bindings.</span></span>
-   <span data-ttu-id="794f7-128">Das zweite SChannel-Prinzipal namens Formular ist das [*voll Text*](f-glos.md) Format.</span><span class="sxs-lookup"><span data-stu-id="794f7-128">The second SCHANNEL principal name form is the [*fullsic*](f-glos.md) form.</span></span> <span data-ttu-id="794f7-129">Dabei handelt es sich um eine Reihe von RFC1779-kompatiblen Namen, die durch eckige Klammern begrenzt und durch umgekehrte Schrägstriche voneinander getrennt sind.</span><span class="sxs-lookup"><span data-stu-id="794f7-129">This is a series of RFC1779-compliant names bounded by angle brackets and separated by backslashes.</span></span> <span data-ttu-id="794f7-130">Sie folgt normalerweise dem Muster fullsic: \\ < \\ Authority \\ subauthority \\ .... \\ Person> oder fullsic: \\ < \\ Authority- \\ unter Autorität \\ ..... \\ Serverprogram->.</span><span class="sxs-lookup"><span data-stu-id="794f7-130">It typically follows the pattern fullsic:\\<\\Authority\\SubAuthority\\.....\\Person> or fullsic:\\<\\Authority\\SubAuthority\\.....\\ServerProgram>.</span></span>

<span data-ttu-id="794f7-131">Wenn der Name nicht mit dem Zertifikat identisch ist, wird die Fehlermeldung " \_ Zugriff \_ verweigert" zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="794f7-131">If the name does not match the certificate, ERROR\_ACCESS\_DENIED is returned.</span></span> <span data-ttu-id="794f7-132">Wenn das Namensformat ungültig ist, gibt Schannel SSP den \_ ungültigen Code Fehler \_ Parameter zurück.</span><span class="sxs-lookup"><span data-stu-id="794f7-132">If the name format is invalid, SCHANNEL SSP returns the code ERROR\_INVALID\_PARAMETER.</span></span>

<span data-ttu-id="794f7-133">Um den Prinzipal Namen des Servers abzufragen, können Anwendungen [**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname)aufruft.</span><span class="sxs-lookup"><span data-stu-id="794f7-133">To query for the server's principal name, applications can call [**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname).</span></span> <span data-ttu-id="794f7-134">Dadurch wird eine NULL-terminierte Zeichenfolge für den Prinzipal Namen zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="794f7-134">This allocates a null-terminated string to hold the principal name.</span></span> <span data-ttu-id="794f7-135">Bevor die Anwendung beendet wird, muss Sie [**rpcstringfree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcstringfree) aufrufen, um den von dieser Zeichenfolge belegten Arbeitsspeicher freizugeben.</span><span class="sxs-lookup"><span data-stu-id="794f7-135">Before it terminates, your application must invoke [**RpcStringFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcstringfree) to release the memory this string occupies.</span></span>

<span data-ttu-id="794f7-136">Das Abfragen des Server namens auf diese Weise ist nicht sicher und sollte vermieden werden.</span><span class="sxs-lookup"><span data-stu-id="794f7-136">Querying for the server name in this manner is not secure and should be avoided.</span></span> <span data-ttu-id="794f7-137">Bei der Server Authentifizierung sollte das Client Programm wissen, mit welchem Server es eine Verbindung herstellt, und den Server Prinzipal Namen neu erstellen.</span><span class="sxs-lookup"><span data-stu-id="794f7-137">For server authentication, the client program should know which server it is connecting to and should create the server principal name from scratch.</span></span>

 

 




