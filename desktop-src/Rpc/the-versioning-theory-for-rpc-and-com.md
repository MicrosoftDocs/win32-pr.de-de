---
title: Die versionierungstheorie für RPC und com
description: Versionierungstheorie für Remote Prozedur Aufruf (RPC) und com.
ms.assetid: c4df0a7b-e1be-481d-9149-317ffc9179b9
keywords:
- Remote Prozedur Aufruf RPC, Best Practices, Versionierung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e03b23c91bf69fbc3c4f72366b80812fd54330d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104102118"
---
# <a name="the-versioning-theory-for-rpc-and-com"></a><span data-ttu-id="302db-104">Die versionierungstheorie für RPC und com</span><span class="sxs-lookup"><span data-stu-id="302db-104">The Versioning Theory for RPC and COM</span></span>

<span data-ttu-id="302db-105">Nur zwei vollständig narrensicher-Methoden unterstützen neue Funktionen ohne das Risiko von Problemen bei der Netzwerkkompatibilität:</span><span class="sxs-lookup"><span data-stu-id="302db-105">Only two completely foolproof methods support new functionality without risk of wire compatibility problems:</span></span>

-   <span data-ttu-id="302db-106">Ändern Sie die Schnittstellen Version gemäß den Regeln. Dadurch wird verhindert, dass neue Clients mit einem alten Server kommunizieren, und es wird möglicherweise verhindert, dass ein Alter Client mit dem neuen Server kommuniziert.</span><span class="sxs-lookup"><span data-stu-id="302db-106">Change the interface version according to the rules; this prevents new clients from communicating with an old server, and may or may not prevent an old client from communicating with the new server.</span></span> <span data-ttu-id="302db-107">Dies wird weiter unten in diesem Abschnitt erläutert.</span><span class="sxs-lookup"><span data-stu-id="302db-107">This is clarified later in this section.</span></span>
-   <span data-ttu-id="302db-108">Führen Sie eine andere Schnittstelle ein, die die neue Funktionalität behandelt.</span><span class="sxs-lookup"><span data-stu-id="302db-108">Introduce a different interface dealing with the new functionality.</span></span>

<span data-ttu-id="302db-109">Eine standardmäßige RPC-Schnittstelle wird durch eine Kombination aus GUID und Versionsnummer identifiziert. eine COM-Schnittstelle wird durch ihre GUID identifiziert.</span><span class="sxs-lookup"><span data-stu-id="302db-109">A standard RPC interface is identified by a GUID and version number combination; a COM interface is identified by its GUID.</span></span> <span data-ttu-id="302db-110">Die-Version besteht aus Haupt-und Nebenkomponenten.</span><span class="sxs-lookup"><span data-stu-id="302db-110">The version consists of major and minor parts.</span></span> <span data-ttu-id="302db-111">Bei Standardschnittstellen mit derselben GUID und verschiedenen Versionsnummern ist nur eine Verbindung möglich, wenn die Hauptversion identisch ist, und der Client ist nicht höher als die neben Version des Servers.</span><span class="sxs-lookup"><span data-stu-id="302db-111">For standard interfaces with the same GUID and different version numbers, a connection is possible only when the major version is the same, and the client is not higher than the minor version of the server.</span></span>

<span data-ttu-id="302db-112">Dies hat zur Folge, dass das Ändern der RPC-Schnittstellen-GUID die Netzwerkkompatibilität unterbricht, während das Ändern des Schnittstellen namens nicht erfolgt.</span><span class="sxs-lookup"><span data-stu-id="302db-112">A consequence is that changing the RPC interface GUID breaks wire compatibility, while changing the interface name does not.</span></span>

<span data-ttu-id="302db-113">In Standard-RPC ist ein Pfad für Upgrades und Erweiterungen gut definiert und erfordert im Grunde, dass neue Methoden nur am Ende der-Schnittstelle hinzugefügt werden, und neue Typen nur in den neuen Methoden verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="302db-113">In standard RPC, a path for upgrades and extensions is well defined, and basically requires that new methods only be added at the end of the interface, and new types be used only in the new methods.</span></span> <span data-ttu-id="302db-114">Wenn solche Ergänzungen erforderlich sind, muss die neben Version erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="302db-114">If such additions are needed, the minor version must be increased.</span></span> <span data-ttu-id="302db-115">Jede andere Änderung erfordert eine Änderung in der Hauptversion, weil die Client-und Server Software bei der Übertragung nicht kompatibel wäre.</span><span class="sxs-lookup"><span data-stu-id="302db-115">Any other change requires a change in the major version, because the client and server software would be incompatible on the wire.</span></span> <span data-ttu-id="302db-116">Wenn diese Regeln eingehalten werden, wird sichergestellt, dass beide Seiten vollständig kompatibel sind, wenn eine Verbindung zwischen einem neuen Client und einem alten Server besteht oder umgekehrt.</span><span class="sxs-lookup"><span data-stu-id="302db-116">Adhering to these rules assures whenever there is a connection between a new client and old server, or vice-versa, both sides are fully compatible.</span></span>

<span data-ttu-id="302db-117">Für eine COM-Schnittstelle kann das Versions Attribut nicht verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="302db-117">For a COM interface, the version attribute cannot be used.</span></span> <span data-ttu-id="302db-118">Das Erstellen neuer Schnittstellen und das Erben von den alten Schnittstellen entspricht der Bearbeitung der Version in RPC.</span><span class="sxs-lookup"><span data-stu-id="302db-118">Creating new interfaces and inheriting from the old interfaces is an equivalent of manipulating the version in RPC.</span></span> <span data-ttu-id="302db-119">Der beste Ansatz für com besteht in der Regel darin, eine neue Schnittstelle für die erweiterte Funktionalität zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="302db-119">Typically, the best approach in COM is to create a new interface for the expanded functionality.</span></span> <span data-ttu-id="302db-120">Eine Entsprechung der neben Version ist die neue Schnittstelle, die von der alten-Schnittstelle erbt.</span><span class="sxs-lookup"><span data-stu-id="302db-120">An equivalent of the minor version is the new interface inheriting from the old one.</span></span> <span data-ttu-id="302db-121">Um alte Methoden oder alte Datentypen zu ändern, ist eine völlig neue COM-Schnittstelle erforderlich – eine Schnittstelle, die nicht von der alten Methode erbt.</span><span class="sxs-lookup"><span data-stu-id="302db-121">Changing old methods or old data types requires an entirely new COM interface—an interface that does not inherit from the old one.</span></span>

<span data-ttu-id="302db-122">Bei com ist die [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) -Funktion eine bewährte Methode, um zu überprüfen, ob ein Server eine Schnittstelle unterstützt. Daher kann die Situation, in der ein Client mit einer alten oder einer neuen Version einer Schnittstelle kommunizieren kann, problemlos aufgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="302db-122">For COM, the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) function is an established method of checking whether a server supports an interface; hence, the situations where a client can talk to an old or a new version of an interface can be easily resolved.</span></span>

 

 