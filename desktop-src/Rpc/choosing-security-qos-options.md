---
title: Auswählen von Sicherheits-QoS-Optionen
description: Die sicherheitsqos-Optionen werden als Teil des securityqos-Parameters übergeben, der an die rpcbindingsetauthinfoex-Funktion übergeben wird. Verwenden Sie die folgenden bewährten Methoden.
ms.assetid: 43befe3d-079a-4389-a1ff-6bda90935769
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c286b516438eae78117ef8d73939c3b4bed396d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "106341961"
---
# <a name="choosing-security-qos-options"></a><span data-ttu-id="6e3c1-104">Auswählen von Sicherheits-QoS-Optionen</span><span class="sxs-lookup"><span data-stu-id="6e3c1-104">Choosing Security QOS Options</span></span>

<span data-ttu-id="6e3c1-105">Die sicherheitsqos-Optionen werden als Teil des *securityqos* -Parameters übergeben, der an die [**rpcbindingsetauthinfoex**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) -Funktion übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-105">The security QOS options are passed as part of the *SecurityQOS* parameter given to the [**RpcBindingSetAuthInfoEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) function.</span></span> <span data-ttu-id="6e3c1-106">Verwenden Sie die folgenden bewährten Methoden.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-106">Use the following best practices.</span></span>

## <a name="use-mutual-authentication"></a><span data-ttu-id="6e3c1-107">Gegenseitige Authentifizierung verwenden</span><span class="sxs-lookup"><span data-stu-id="6e3c1-107">Use Mutual Authentication</span></span>

<span data-ttu-id="6e3c1-108">Die echte gegenseitige Authentifizierung ist nur für bestimmte Sicherheitsanbieter verfügbar: Aushandeln (bei Aushandlung von Kerberos), Kerberos und Schannel.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-108">True mutual authentication is available only for certain security providers: Negotiate (when it negotiates Kerberos), Kerberos, and Schannel.</span></span> <span data-ttu-id="6e3c1-109">NTLM unterstützt keine gegenseitige Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-109">NTLM does not support mutual authentication.</span></span> <span data-ttu-id="6e3c1-110">Für die Verwendung der gegenseitigen Authentifizierung muss ein wohlgeformter Server Prinzipal Name angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-110">Using mutual authentication requires that a well formed server principal name be provided.</span></span> <span data-ttu-id="6e3c1-111">Viele Entwickler verwenden die folgende fehlerhafte Sicherheitsübung: der Server wird aufgerufen, um nach seinem Prinzipal Namen ([**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname)) zu Fragen, und dann Fragen Sie mithilfe dieses Prinzipal namens Blind die gegenseitige Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-111">Many developers use the following faulty security practice: The server is called to ask for its principal name ([**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname)), and then they blindly ask for mutual authentication using that principal name.</span></span> <span data-ttu-id="6e3c1-112">Diese Vorgehensweise unterbricht die gesamte Idee der gegenseitigen Authentifizierung. die Idee der gegenseitigen Authentifizierung besteht darin, dass nur bestimmte Server aufgerufen werden, da sie vertrauenswürdig sind, Ihre Daten zu analysieren und zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-112">This approach breaks the whole idea of mutual authentication; the idea of mutual authentication is that only certain servers are called because they are trusted to parse and handle your data.</span></span> <span data-ttu-id="6e3c1-113">Mithilfe der soeben beschriebenen fehlerhaften Sicherheitsübung geben Entwickler Ihre Daten an alle intelligenten genug, um Ihren Namen zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-113">Using the faulty security practice just described, developers give their data to anyone smart enough to return their name.</span></span>

<span data-ttu-id="6e3c1-114">Wenn die Client Software z. b. nur einen Server aufrufen soll, der unter den Konten Joe, Pete oder Alice ausgeführt wird, sollte die [**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname) -Funktion aufgerufen werden, und der zurück gesendete Name sollte geprüft werden.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-114">As an example, if the client software should call only a server running under Joe, Pete, or Alice's accounts, the [**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname) function should be called, and the name sent back should be checked.</span></span> <span data-ttu-id="6e3c1-115">Wenn er Joe, Pete oder Alice ist, muss die gegenseitige Authentifizierung mit dem Server Prinzipal Namen angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-115">If it is Joe, Pete or Alice, mutual authentication should be requested using their server principal name.</span></span> <span data-ttu-id="6e3c1-116">Dadurch wird sichergestellt, dass beide Hälften der Konversation zum gleichen Prinzipal wechseln.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-116">This ensures both halves of the conversation go to the same principal.</span></span>

<span data-ttu-id="6e3c1-117">Wenn die Client Software einen Dienst anrufen soll, der nur unter dem Joe-Konto ausgeführt wird, verfassen Sie den Server Prinzipal Namen von Joe direkt, und nehmen Sie den-</span><span class="sxs-lookup"><span data-stu-id="6e3c1-117">If client software should call a service running under Joe's account only, directly compose Joe's server principal name and make the call.</span></span> <span data-ttu-id="6e3c1-118">Wenn der Server nicht Joe ist, kann der-Befehl einfach nicht ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-118">If the server is not Joe, the call will simply fail.</span></span>

<span data-ttu-id="6e3c1-119">Häufig werden Dienste als Windows-Systemdienste ausgeführt. Dies bedeutet, dass Sie unter dem Computer Konto ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-119">Many times, services run as Windows system services, which means they run under the machine account.</span></span> <span data-ttu-id="6e3c1-120">Die gegenseitige Authentifizierung und Erstellung eines Server Prinzipal namens wird weiterhin empfohlen.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-120">Mutual authentication and creation of a server principal name is still recommended.</span></span>

## <a name="use-the-lowest-impersonationtype-that-allows-the-call-to-go-through"></a><span data-ttu-id="6e3c1-121">Verwenden Sie den niedrigsten Identitäts ationstyp, mit dem der Aufruf durchlaufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-121">Use the Lowest ImpersonationType that Allows the Call to Go Through</span></span>

<span data-ttu-id="6e3c1-122">Diese bewährte Vorgehensweise ist recht selbsterklärend.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-122">This Best Practice is fairly self explanatory.</span></span> <span data-ttu-id="6e3c1-123">Selbst wenn die gegenseitige Authentifizierung verwendet wird, sollten Sie dem Server nicht mehr Rechte als notwendig einräumen. Möglicherweise wurde ein legitimer Server kompromittiert, und auch wenn die von Ihnen gesendeten Daten in diesen Fällen in die falschen Hände geraten, kann zumindest der Server in Ihrem Namen nicht auf andere Daten im Netzwerk zugreifen.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-123">Even if mutual authentication is used, do not give the server more rights than necessary; a legitimate server may have been compromised, and even though the data you send falls into the wrong hands in such cases, at least the server will not be able to access other data on the network on your behalf.</span></span> <span data-ttu-id="6e3c1-124">Einige Server lehnen einen Aufruf ab, der nicht über genügend Informationen zum Ermitteln und ggf. annehmen des Aufrufers verfügt.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-124">Some servers will reject a call that does not have sufficient information to determine, and possibly impersonate, the caller.</span></span> <span data-ttu-id="6e3c1-125">Beachten Sie außerdem, dass einige Protokoll Sequenzen die Sicherheit auf Transport Ebene ([**ncacn \_ NP**](/windows/desktop/Midl/ncacn-np) und [**Ncalrpc**](/windows/desktop/Midl/ncalrpc)) unterstützen.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-125">Also, be aware that some protocol sequences support transport level security ([**ncacn\_np**](/windows/desktop/Midl/ncacn-np) and [**ncalrpc**](/windows/desktop/Midl/ncalrpc)).</span></span> <span data-ttu-id="6e3c1-126">In solchen Fällen kann der Server jederzeit einen Identitätswechsel durchführen, wenn Sie eine ausreichend hohe Identitätswechsel Ebene durch den *networkoptions* -Parameter angeben, wenn Sie das Bindungs Handle erstellen.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-126">In such cases, the server can always impersonate you if you specify a sufficiently high impersonation level through the *NetworkOptions* parameter when you create the binding handle.</span></span>

<span data-ttu-id="6e3c1-127">Schließlich können einige Sicherheitsanbieter oder Transporte den Identitäts ationstyp transparent auf eine höhere Ebene als die angegebene Ebene über stoßen.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-127">Finally, some security providers or transports may transparently bump ImpersonationType to a higher level than that specified.</span></span> <span data-ttu-id="6e3c1-128">Wenn Sie ein Programm entwickeln, stellen Sie sicher, dass Sie versuchen, Aufrufe mit dem vorgesehenen Identitäts ationstyp auszuführen, und prüfen Sie, ob Sie einen höheren Identitäts ationstyp auf dem Server erhalten.</span><span class="sxs-lookup"><span data-stu-id="6e3c1-128">When developing a program, make sure you try to make calls with the intended ImpersonationType and check whether you are getting higher ImpersonationType on the server.</span></span>

 

 