---
title: Verwalten von Netzwerk Verbindungs Sätzen (Zuordnungen)
description: Ab Windows 2000 kann für die RPC-Laufzeit mehr als eine Verbindung zwischen dem Client und dem Server beibehalten werden.
ms.assetid: 9b9c42e9-8ed5-46a6-b6ec-4093ce0128bb
keywords:
- Verwalten von Netzwerk Verbindungs Sätzen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 81e99afe23d90e44d85dc7a2ec9301b45e1f20b1
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104207114"
---
# <a name="managing-network-connection-sets-associations"></a><span data-ttu-id="07ad4-104">Verwalten von Netzwerk Verbindungs Sätzen (Zuordnungen)</span><span class="sxs-lookup"><span data-stu-id="07ad4-104">Managing Network Connection Sets (Associations)</span></span>

<span data-ttu-id="07ad4-105">Ab Windows 2000 kann für die RPC-Laufzeit mehr als eine Verbindung zwischen dem Client und dem Server beibehalten werden.</span><span class="sxs-lookup"><span data-stu-id="07ad4-105">Starting with Windows 2000, the RPC run time may maintain more than one connection between the client and the server.</span></span> <span data-ttu-id="07ad4-106">Dies erleichtert den Betrieb für Transporte, die das Ändern der Client Identität nicht unterstützen, ohne dass die Verbindung, Multithread-Clients und asynchrone Clients wieder hergestellt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="07ad4-106">This facilitates operation on transports that do not support changing the client identity without reestablishing the connection, multithreaded clients, and asynchronous clients.</span></span> <span data-ttu-id="07ad4-107">Der Satz von Verbindungen zwischen einem Client Prozess und einem Server Endpunkt wird in der RPC-Terminologie als " *Association* " bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="07ad4-107">The set of connections between a client process and a server endpoint is called an *association* in RPC terminology.</span></span> <span data-ttu-id="07ad4-108">Das Verständnis von Zuordnungen kann die Implementierung von RPC verbessern.</span><span class="sxs-lookup"><span data-stu-id="07ad4-108">Understanding associations can improve the implementation of RPC.</span></span>

<span data-ttu-id="07ad4-109">In einem Szenario mit einem Single-Client-Identitäts Szenario öffnet RPC eine Verbindung zwischen einem Client Prozess und einem Server Endpunkt, um RPC-Aufrufe durchführen zu können.</span><span class="sxs-lookup"><span data-stu-id="07ad4-109">In a single-thread, single-client identity scenario, RPC opens one connection between a client process and a server endpoint to make RPC calls.</span></span> <span data-ttu-id="07ad4-110">Wenn ein synchroner RPC-Aufruf durchgeführt wird, sendet der Client die Anforderung an den Server über diese Verbindung und erhält auch die Antwort darauf.</span><span class="sxs-lookup"><span data-stu-id="07ad4-110">When a synchronous RPC call is made, the client sends the request to the server on this connection, and receives the reply on it as well.</span></span> <span data-ttu-id="07ad4-111">Wenn die Anzahl der Threads, die RPC-Aufrufe im Client Prozess bewirken, zunimmt, kann sich die Sicherheitsidentität des Clients ändern.</span><span class="sxs-lookup"><span data-stu-id="07ad4-111">When the number of threads making RPC calls in the client process grows, the security identity of the client can change.</span></span> <span data-ttu-id="07ad4-112">Wenn asynchrone/Pipe-Aufrufe mit synchronen Aufrufen auf dem Client gemischt werden, benötigt RPC möglicherweise mehr als eine Netzwerkverbindung.</span><span class="sxs-lookup"><span data-stu-id="07ad4-112">When asynchronous/pipe calls are mixed with synchronous calls on the client, RPC may need more than one network connection.</span></span> <span data-ttu-id="07ad4-113">Alle Verbindungen im Satz werden in einen Verbindungspool eingefügt, der als Zuordnung bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="07ad4-113">All connections in the set are put in a connection pool called an association.</span></span>

<span data-ttu-id="07ad4-114">Ein synchroner Remote Prozedur Aufruf verwendet exklusiv eine angegebene Verbindung, um die RPC-Standards einzuhalten.</span><span class="sxs-lookup"><span data-stu-id="07ad4-114">A synchronous remote procedure call exclusively uses a given connection to conform with RPC standards.</span></span> <span data-ttu-id="07ad4-115">Eine Verbindung, die von einem synchronen RPC-Aufruf verwendet wird, wird als ausgelastet betrachtet, wenn eine Anforderung gesendet wurde, aber keine Antwort empfangen wurde.</span><span class="sxs-lookup"><span data-stu-id="07ad4-115">A connection used by a synchronous RPC call is considered busy if a request has been sent, but a response has not been received.</span></span> <span data-ttu-id="07ad4-116">Es ist kein anderer Datenverkehr für diese Verbindung zulässig, bis die Antwort empfangen wurde.</span><span class="sxs-lookup"><span data-stu-id="07ad4-116">No other traffic is allowed on that connection until the response is received.</span></span> <span data-ttu-id="07ad4-117">Die RPC-Laufzeit versucht, asynchrone und Weiterleiten von RPC-Aufrufen über dieselbe Verbindung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="07ad4-117">The RPC run time attempts to multiplex asynchronous and pipe RPC calls on the same connection.</span></span> <span data-ttu-id="07ad4-118">Synchrone und asynchrone/Pipe-Aufrufe können nicht mit derselben Verbindung gemischt werden, d. h., eine gegebene Verbindung kann für synchrone RPC-Aufrufe oder für asynchrone/Pipe-RPC-Aufrufe verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="07ad4-118">Synchronous and asynchronous/pipe calls cannot be mixed on the same connection, which means that a given connection can be used for either synchronous RPC calls or for asynchronous/pipe RPC calls.</span></span>

<span data-ttu-id="07ad4-119">RPC versucht aggressiv, Verbindungen aus dem Pool wiederzuverwenden.</span><span class="sxs-lookup"><span data-stu-id="07ad4-119">RPC aggressively tries to reuse connections from the pool.</span></span> <span data-ttu-id="07ad4-120">Wenn ein neuer RPC-Aufruf erfolgt, versucht RPC, eine geeignete Verbindung aus dem Pool zu finden, und erstellt nur dann eine neue Verbindung, wenn eine geeignete Verbindung nicht gefunden werden kann.</span><span class="sxs-lookup"><span data-stu-id="07ad4-120">When a new RPC call is made, RPC attempts to find a suitable connection from the pool, and creates a new connection only if a suitable connection cannot be found.</span></span> <span data-ttu-id="07ad4-121">Damit eine Verbindung als geeignet eingestuft wird, muss Sie folgende Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="07ad4-121">For a connection to be considered suitable, it must:</span></span>

-   <span data-ttu-id="07ad4-122">Der geeignete Typ (synchron oder asynchron/Pipe).</span><span class="sxs-lookup"><span data-stu-id="07ad4-122">Be of the appropriate type (synchronous, or asynchronous/pipe).</span></span>
-   <span data-ttu-id="07ad4-123">Kostenlos.</span><span class="sxs-lookup"><span data-stu-id="07ad4-123">Be free.</span></span>
-   <span data-ttu-id="07ad4-124">Sie haben dieselbe Sicherheitsidentität wie das Bindungs handle, für das der-Befehl durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="07ad4-124">Have the same security identity as the binding handle on which the call is made.</span></span> <span data-ttu-id="07ad4-125">Wenn die dynamische Identitäts Verfolgung verwendet wird, wird die Identität des Bindungs Handles am Anfang des Aufrufes aus dem Thread Token aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="07ad4-125">If dynamic identity tracking is used, the identity of the binding handle is refreshed from the thread token at the beginning of the call.</span></span> <span data-ttu-id="07ad4-126">Wenn die statische Identitäts Nachverfolgung verwendet wird, wird die Client Identität verwendet, die für das Bindungs handle gestempelt wird.</span><span class="sxs-lookup"><span data-stu-id="07ad4-126">If static identity tracking is used, the client identity stamped on the binding handle is used.</span></span>

<span data-ttu-id="07ad4-127">Wenn der Aufruf beendet ist, wird die Verbindung nach dem Empfang der Antwort als frei markiert und kann für andere RPC-Aufrufe verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="07ad4-127">When the call is complete, once the response is received, the connection is marked as free and can be used for other RPC calls.</span></span>

<span data-ttu-id="07ad4-128">Die Sicherheitsidentität für eine Verbindung kann nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="07ad4-128">The security identity on a connection cannot change.</span></span> <span data-ttu-id="07ad4-129">Wenn z. b. eine große Anzahl von Aufrufen desselben Servers unter verschiedenen Sicherheits Identitäten durchgeführt wird, wächst die Anzahl der Verbindungen im Thread Pool.</span><span class="sxs-lookup"><span data-stu-id="07ad4-129">For example, if a large number of calls to the same server are made under different security identities, the number of connections in the thread pool grows.</span></span> <span data-ttu-id="07ad4-130">Die Zuordnung selbst ist Verweis Zählung, und wenn alle Verweise nicht mehr vorhanden sind, werden alle Verbindungen angehalten und geschlossen.</span><span class="sxs-lookup"><span data-stu-id="07ad4-130">The association itself is reference-counted, and when all references are gone, it stops and closes all connections.</span></span> <span data-ttu-id="07ad4-131">Jedes Bindungs Handle und jedes Kontext Handle enthalten einen Verweis auf die Zuordnung.</span><span class="sxs-lookup"><span data-stu-id="07ad4-131">Every binding handle and every context handle hold a reference on the association.</span></span> <span data-ttu-id="07ad4-132">Wenn alle geschlossen sind, verschwindet die Zuordnung.</span><span class="sxs-lookup"><span data-stu-id="07ad4-132">When all are closed, the association disappears.</span></span> <span data-ttu-id="07ad4-133">Unter Windows XP verschwinden Zuordnungen nicht notwendigerweise sofort. Sie bleiben möglicherweise für einen kurzen Zeitraum erhalten (der zielzeitraum beträgt 20 Sekunden, aber die RPC-Laufzeit kann das zerstören der Zuordnung verzögern, wenn keine Threads zum Ausführen der Aufgabe verfügbar sind).</span><span class="sxs-lookup"><span data-stu-id="07ad4-133">On Windows XP, associations do not necessarily disappear immediately; they may remain for a short period (the target period is 20 seconds, but the RPC run time may choose to delay destroying the association if no threads are available to execute the task).</span></span> <span data-ttu-id="07ad4-134">Wenn Sie nicht möchten, dass die Zuordnung aktiv bleibt, nachdem das letzte Kontext Handle/Bindungs Handle geschlossen wurde, verwenden Sie \_ die \_ Option RPC C opt dont LINGER, um zu erzwingen, dass die RPC- \_ \_ Laufzeit die Verbindung sofort schließt.</span><span class="sxs-lookup"><span data-stu-id="07ad4-134">If you do not want the association to stay alive after the last context handle/binding handle is closed, use the RPC\_C\_OPT\_DONT\_LINGER option to force the RPC Runtime to immediately close the connection.</span></span>

 

 




