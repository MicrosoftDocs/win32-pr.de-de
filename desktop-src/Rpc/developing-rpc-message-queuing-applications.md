---
title: Entwickeln von RPC-Message Queuinganwendungen
description: Es ist nur sehr wenig Aufwand erforderlich, um den MSMQ-Transport in der RPC-Anwendung zu nutzen.
ms.assetid: 1ea97df8-cdf5-43b8-88aa-9e8fa6ae845a
keywords:
- Remote Prozedur Aufruf RPC, Tasks, entwickeln von Message Queuinganwendungen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f3e51707c0a6903200e51dd35e50e998430c8eae
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104039496"
---
# <a name="developing-rpc-message-queuing-applications"></a><span data-ttu-id="e36da-104">Entwickeln von RPC-Message Queuinganwendungen</span><span class="sxs-lookup"><span data-stu-id="e36da-104">Developing RPC-Message Queuing Applications</span></span>

<span data-ttu-id="e36da-105">Es ist nur sehr wenig Aufwand erforderlich, um den MSMQ-Transport in der RPC-Anwendung zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="e36da-105">Very little effort is necessary to take advantage of the MSMQ transport in your RPC application.</span></span> <span data-ttu-id="e36da-106">Für synchrones Messaging müssen Sie nur den Nachrichten Warteschlangen Transport ([**ncadg \_ MQ**](/windows/desktop/Midl/ncadg-mq)) als Protokoll Sequenz angeben.</span><span class="sxs-lookup"><span data-stu-id="e36da-106">For synchronous messaging you need only specify the message queue transport ([**ncadg\_mq**](/windows/desktop/Midl/ncadg-mq)) as the protocol sequence.</span></span> <span data-ttu-id="e36da-107">Das **ncadg \_ MQ** -Protokoll unterstützt alle standardmäßigen Datagramm-Features mit Ausnahme von Broadcast aufrufen.</span><span class="sxs-lookup"><span data-stu-id="e36da-107">The **ncadg\_mq** protocol supports all of the standard datagram features except broadcasting calls.</span></span> <span data-ttu-id="e36da-108">Beachten Sie außerdem, dass der Nachrichten Warteschlangen-Transport derzeit keine dynamischen Endpunkte unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e36da-108">Also, note that currently the message-queue transport does not support dynamic endpoints.</span></span>

<span data-ttu-id="e36da-109">Wenn Sie das \[ [**Message**](/windows/desktop/Midl/message) - \] Attribut auf Remote Prozedur Deklarationen in der IDL-Datei anwenden, implementieren Sie Message Queueing für diese Aufrufe automatisch im asynchronen Modus.</span><span class="sxs-lookup"><span data-stu-id="e36da-109">By applying the \[[**message**](/windows/desktop/Midl/message)\] attribute to remote procedure declarations in the IDL file, you automatically implement asynchronous-mode message queuing for those calls.</span></span> <span data-ttu-id="e36da-110">Dies ermöglicht es den Client-und Server Anwendungen, viele der Eigenschaften zu steuern, die mit Nachrichten und Nachrichten Warteschlangen verknüpft sind. dazu gehören:</span><span class="sxs-lookup"><span data-stu-id="e36da-110">This makes it possible for the client and server applications to control many of the properties associated with messages and message queues, including:</span></span>

-   <span data-ttu-id="e36da-111">Quality of Service</span><span class="sxs-lookup"><span data-stu-id="e36da-111">Quality of service</span></span>
-   <span data-ttu-id="e36da-112">Bestätigung der Bestätigung</span><span class="sxs-lookup"><span data-stu-id="e36da-112">Acknowledgment of receipt</span></span>
-   <span data-ttu-id="e36da-113">Journaling</span><span class="sxs-lookup"><span data-stu-id="e36da-113">Journaling</span></span>
-   <span data-ttu-id="e36da-114">Rückruf Priorität</span><span class="sxs-lookup"><span data-stu-id="e36da-114">Call priority</span></span>
-   <span data-ttu-id="e36da-115">Persistenz der Server Prozess Warteschlange</span><span class="sxs-lookup"><span data-stu-id="e36da-115">Persistence of Server Process Queue</span></span>

<span data-ttu-id="e36da-116">Quality of Service ist der Aufwand, den der Transport durchführt, um den Server Prozess aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="e36da-116">Quality of service is the effort that the transport will make to deliver the call to the server process.</span></span> <span data-ttu-id="e36da-117">Eine Express-Übermittlung wird im Arbeitsspeicher in die Warteschlange eingereiht, sodass Sie recht schnell ist, aber der Aufruf geht verloren, wenn eine Computer-oder Netzwerkverbindung zum falschen Zeitpunkt ausfällt.</span><span class="sxs-lookup"><span data-stu-id="e36da-117">An express delivery will be queued in memory, so it is fairly fast, but the call will be lost if a computer or network connection goes down at the wrong time.</span></span> <span data-ttu-id="e36da-118">Eine wiederherstellbare Übermittlung wird an eine Datenträger Datei gesendet, bis Sie übermittelt wird, sodass der Aufruf nicht verloren geht, selbst bei einem Computerabsturz.</span><span class="sxs-lookup"><span data-stu-id="e36da-118">A recoverable delivery will be posted to a disk file until it is delivered, so the call will not be lost, even in the face of a computer crash.</span></span> <span data-ttu-id="e36da-119">Dadurch erhalten Sie eine garantierte Bereitstellung, Kosten in der Leistung, während die einzelnen Aufrufe auf den Datenträger geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="e36da-119">This gives guaranteed delivery, but at a cost in performance as each call is written to disk.</span></span>

<span data-ttu-id="e36da-120">Sie können auch den MSMQ-Transport anweisen, auf die Bestätigung zu warten, dass der-Befehl die Ziel Warteschlange (Server) vor der Rückgabe erreicht hat.</span><span class="sxs-lookup"><span data-stu-id="e36da-120">You can also tell the MSMQ transport to wait for acknowledgment that the call reached the destination (server) queue before returning.</span></span> <span data-ttu-id="e36da-121">Wenn Sie diese Option auswählen, wird der Client so lange blockiert, bis der Server den-Befehl bestätigt; andernfalls wird die Steuerung sofort an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="e36da-121">Choosing this option blocks the client until the server acknowledges the call, otherwise control returns to the client immediately upon making the call.</span></span>

<span data-ttu-id="e36da-122">Durch die Verwendung von Journalen können Aufrufe auf dem Datenträger protokolliert werden.</span><span class="sxs-lookup"><span data-stu-id="e36da-122">By using journaling, calls can be logged to disk.</span></span> <span data-ttu-id="e36da-123">Wenn Journal Vorgänge aktiviert ist, wird jeder-Vorgang auf dem Datenträger protokolliert, da er an den nächsten Hop auf seine Weise an den Server Prozess übertragen wird.</span><span class="sxs-lookup"><span data-stu-id="e36da-123">If journaling is turned on, each call is logged to disk as it is transmitted to the next hop on its way to the server process.</span></span>

<span data-ttu-id="e36da-124">Die Aufruf Priorität kann in Verbindung mit dem RPC- \[ [**Nachrichten**](/windows/desktop/Midl/message) \] Funktions Attribut verwendet werden, um Aufrufe mit höherer Priorität zu ermöglichen, die Vorrang vor Aufrufen mit niedrigerer Priorität haben, selbst wenn die Aufrufe mit hoher Priorität später eingehen.</span><span class="sxs-lookup"><span data-stu-id="e36da-124">Call priority can be used in conjunction with the RPC \[[**message**](/windows/desktop/Midl/message)\] function attribute to allow calls with higher priority to take precedence over calls with lower priority, even if the high priority calls arrive later.</span></span> <span data-ttu-id="e36da-125">Die Aufruf Priorität funktioniert auch in begrenztem Umfang mit synchronem RPC, aber synchrone RPC-Aufrufe können nicht auf die gleiche Weise wie asynchrone Aufrufe gestapelt werden.</span><span class="sxs-lookup"><span data-stu-id="e36da-125">Call priority will also work in a limited fashion with synchronous RPC, but synchronous RPC calls cannot stack up in the same manner as asynchronous calls.</span></span>

<span data-ttu-id="e36da-126">Der Client Prozess steuert alle oben genannten Eigenschaften durch Aufrufen von [**rpcbindingsetoption**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetoption).</span><span class="sxs-lookup"><span data-stu-id="e36da-126">The client process controls all of the above properties by calling [**RpcBindingSetOption**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetoption).</span></span> <span data-ttu-id="e36da-127">Nach der Festlegung bleiben diese Eigenschaften wirksam, bis Sie in einem anderen Aufrufen von **rpcbindingsetoption** geändert werden.</span><span class="sxs-lookup"><span data-stu-id="e36da-127">Once set, these properties remain in effect until they are changed in another call to **RpcBindingSetOption**.</span></span>

<span data-ttu-id="e36da-128">Der RPC-Server Prozess kann die Lebensdauer der Empfangs Warteschlange steuern.</span><span class="sxs-lookup"><span data-stu-id="e36da-128">The RPC server process can control the lifetime of its receive queue.</span></span> <span data-ttu-id="e36da-129">Standardmäßig wird die Warteschlange gelöscht, wenn der Server Prozess beendet wird.</span><span class="sxs-lookup"><span data-stu-id="e36da-129">By default the queue is deleted when the server process exits.</span></span> <span data-ttu-id="e36da-130">Der Server Prozess kann jedoch beim Einrichten des Endpunkts [**rpcserveruseprotonqepex**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) verwenden, um dem Transport mitzuteilen, dass die Warteschlange weiterhin vorhanden sein kann, und auch dann, wenn der Server Prozess nicht ausgeführt wird, auch wenn der Server Prozess nicht ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="e36da-130">However, the server process can use [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) when setting up its endpoint to tell the transport to allow the queue to continue to exist and to accept call requests even when the server process is not running.</span></span> <span data-ttu-id="e36da-131">In diesem Fall werden die Aufrufe später in die Warteschlange eingereiht und ausgeführt, wenn der Server Prozess wieder online geschaltet wird.</span><span class="sxs-lookup"><span data-stu-id="e36da-131">In this case, the calls are queued up and executed later, when the server process comes back online.</span></span>

> [!Note]  
> <span data-ttu-id="e36da-132">Wenn Sie asynchrone \[ [**Nachrichten**](/windows/desktop/Midl/message) \] Aufrufe in einer Schnittstelle verwenden, müssen Sie die Schnittstelle registrieren, indem Sie [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif) oder [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) aufrufen, bevor Sie [**rpcserveruseprotsetqepex**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex)**(ncadg \_ mq)** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="e36da-132">If you are using asynchronous \[[**message**](/windows/desktop/Midl/message)\] calls in an interface, you must register the interface by calling [**RpcServerRegisterIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterif) or [**RpcServerRegisterIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterifex) before calling [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex)**(ncadg\_mq)**.</span></span> <span data-ttu-id="e36da-133">Wenn Sie die Protokoll Sequenz aktivieren, werden alle Aufrufe, die bereits auf die Warteschlange für den Server warten, von der Warteschlange gelesen.</span><span class="sxs-lookup"><span data-stu-id="e36da-133">Once you turn on the protocol sequence, any calls already waiting on the queue for the server will begin to be read off the queue.</span></span> <span data-ttu-id="e36da-134">Wenn die entsprechende RPC-Schnittstelle nicht registriert wurde, können die Aufrufe nicht ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="e36da-134">If the corresponding RPC interface has not been registered, the calls will fail.</span></span> <span data-ttu-id="e36da-135">Diese Situation kann eintreten, wenn Sie einen permanenten Endpunkt für Remote Prozedur Aufrufe eingerichtet haben, der Server heruntergefahren wurde und Clients weiterhin Aufrufe an den Server senden.</span><span class="sxs-lookup"><span data-stu-id="e36da-135">This situation can happen if you have a setup a permanent endpoint for your remote procedure calls, the server has been shut down, and clients have continued to send calls to the server.</span></span> <span data-ttu-id="e36da-136">Diese Aufrufe werden in der Warteschlange gestapelt und warten darauf, gelesen zu werden, sobald der Server wieder online ist.</span><span class="sxs-lookup"><span data-stu-id="e36da-136">These calls will be stacked up in the queue, waiting to be read once the server comes back online.</span></span>

 

<span data-ttu-id="e36da-137">Weitere Informationen finden Sie unter [**rpcbindingsetoption**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetoption), [**rpcserveruseprotseqepex**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex)und \[ [**Message**](/windows/desktop/Midl/message) \] , [**ncadg \_ MQ**](/windows/desktop/Midl/ncadg-mq).</span><span class="sxs-lookup"><span data-stu-id="e36da-137">For more information, see [**RpcBindingSetOption**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetoption), [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex), and \[[**message**](/windows/desktop/Midl/message)\], [**ncadg\_mq**](/windows/desktop/Midl/ncadg-mq).</span></span>

 

 