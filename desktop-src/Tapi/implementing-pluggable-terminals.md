---
description: Die allgemeinen Anforderungen für die austauschbare Terminal Implementierung sind unten aufgeführt.
ms.assetid: 7cee19b1-ceea-494a-b576-4deede759905
title: Implementieren austauschbarer Terminals
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 494b2f6bc5ccb214bc7101f570a4db3037fd8cae
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106349463"
---
# <a name="implementing-pluggable-terminals"></a><span data-ttu-id="067c6-103">Implementieren austauschbarer Terminals</span><span class="sxs-lookup"><span data-stu-id="067c6-103">Implementing Pluggable Terminals</span></span>

<span data-ttu-id="067c6-104">Die allgemeinen Anforderungen für die austauschbare Terminal Implementierung lauten:</span><span class="sxs-lookup"><span data-stu-id="067c6-104">The general requirements for pluggable terminal implementation are:</span></span>

-   <span data-ttu-id="067c6-105">Der dem austauschbaren Terminal zugrunde liegende streamingcode sollte den Funktionen der gewünschten MSPs entsprechen.</span><span class="sxs-lookup"><span data-stu-id="067c6-105">A pluggable terminal's underlying streaming code should match the capabilities of the desired MSPs.</span></span>
-   <span data-ttu-id="067c6-106">Das Terminal muss DirectShow-Filter verwenden, um mit den meisten MSPs zu arbeiten (hier wird davon ausgegangen).</span><span class="sxs-lookup"><span data-stu-id="067c6-106">The terminal must use DirectShow filters to work with most MSPs (this is assumed from here on).</span></span>
-   <span data-ttu-id="067c6-107">Audioterminals müssen für die meisten MSPs 8 kHz 16-Bit-Mono-PCM unterstützen.</span><span class="sxs-lookup"><span data-stu-id="067c6-107">Audio terminals must support 8 kHz 16-bit mono linear PCM for most MSPs.</span></span>
-   <span data-ttu-id="067c6-108">Das Terminal sollte das Marshalling von freien Threads durch Implementieren von [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal)ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="067c6-108">The terminal should enable free threaded marshalling by implementing [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal).</span></span> <span data-ttu-id="067c6-109">Das Terminal kann dies durch Aufrufen der com-API [**cocreatefreethreadedmarshaler**](/windows/win32/api/combaseapi/nf-combaseapi-cocreatefreethreadedmarshaler) erreichen, indem Sie **IMarshal** auf den zurückgegebenen Zeiger aggregierte.</span><span class="sxs-lookup"><span data-stu-id="067c6-109">The terminal can do this by calling the COM API [**CoCreateFreeThreadedMarshaler**](/windows/win32/api/combaseapi/nf-combaseapi-cocreatefreethreadedmarshaler) and aggregating **IMarshal** to the returned pointer.</span></span> <span data-ttu-id="067c6-110">Der Dekonstruktor des Terminal Objekts sollte " [**IMarshal->Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)" aufrufen.</span><span class="sxs-lookup"><span data-stu-id="067c6-110">The terminal object's destructor should call [**IMarshal->Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release).</span></span>
-   <span data-ttu-id="067c6-111">Das Terminal sollte alle zusätzlichen Terminal spezifischen Schnittstellen implementieren oder Aggregieren, die geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="067c6-111">The terminal should implement or aggregate any additional terminal-specific interfaces that are appropriate.</span></span>
-   <span data-ttu-id="067c6-112">Die Terminal Implementierung muss Thread sicher sein.</span><span class="sxs-lookup"><span data-stu-id="067c6-112">The terminal implementation must be thread-safe.</span></span>
-   <span data-ttu-id="067c6-113">Die Terminal Implementierung muss \# termmgr. h für die Definition von [**itterminalcontrol**](/windows/desktop/api/Termmgr/nn-termmgr-itterminalcontrol)enthalten.</span><span class="sxs-lookup"><span data-stu-id="067c6-113">The terminal implementation must \#include Termmgr.h for the definition of [**ITTerminalControl**](/windows/desktop/api/Termmgr/nn-termmgr-itterminalcontrol).</span></span> <span data-ttu-id="067c6-114">Dies gilt zusätzlich zu den üblichen includes-und-Bibliotheken, die für TAPI 3-oder TAPI 3-Anwendungen unter Windows 2000 SP1 benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="067c6-114">This is in addition to the usual includes and libs that are needed for TAPI 3 or TAPI 3 applications under Windows 2000 SP1.</span></span>

<span data-ttu-id="067c6-115">Hinweise zur Implementierung der Schnittstelle und Methode:</span><span class="sxs-lookup"><span data-stu-id="067c6-115">Interface and method implementation notes:</span></span>

<span data-ttu-id="067c6-116">Das Terminal muss [**itterminal**](/windows/win32/api/tapi3if/nn-tapi3if-itterminal) (Dual Interface – Vtable + [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)) implementieren.</span><span class="sxs-lookup"><span data-stu-id="067c6-116">The terminal must implement [**ITTerminal**](/windows/win32/api/tapi3if/nn-tapi3if-itterminal) (dual interface–vtable + [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)).</span></span>

[<span data-ttu-id="067c6-117">**Itterminal:: get \_ terminalclass**</span><span class="sxs-lookup"><span data-stu-id="067c6-117">**ITTerminal::get\_TerminalClass**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itterminal-get_terminalclass)

<span data-ttu-id="067c6-118">Das Terminal muss eine **BSTR** -Darstellung einer GUID zurückgeben, die Sie ausgewählt haben, die ihren Terminaltyp identifiziert.</span><span class="sxs-lookup"><span data-stu-id="067c6-118">The terminal must return a **BSTR** representation of a GUID you've picked that identifies your type of terminal.</span></span> <span data-ttu-id="067c6-119">Weisen Sie den **BSTR** über " [**SysAllocString**](/windows/win32/api/oleauto/nf-oleauto-sysallocstring)" zu.</span><span class="sxs-lookup"><span data-stu-id="067c6-119">Allocate the **BSTR** via [**SysAllocString**](/windows/win32/api/oleauto/nf-oleauto-sysallocstring).</span></span> <span data-ttu-id="067c6-120">Um von GUID in **BSTR** zu konvertieren, nennen Sie [**stringfromclsid**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid), **SysAllocString** und [**CoTaskMemFree**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree).</span><span class="sxs-lookup"><span data-stu-id="067c6-120">To convert from GUID to **BSTR**, call [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid), **SysAllocString**, and [**CoTaskMemFree**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree).</span></span>

[<span data-ttu-id="067c6-121">**Itterminal:: get \_ terminaltype**</span><span class="sxs-lookup"><span data-stu-id="067c6-121">**ITTerminal::get\_TerminalType**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itterminal-get_terminaltype)

<span data-ttu-id="067c6-122">Das Terminal sollte in der Regel TT Dynamic zurückgeben, \_ Wenn eine Anwendung das Terminal implementiert.</span><span class="sxs-lookup"><span data-stu-id="067c6-122">The terminal should generally return TT\_DYNAMIC if an application implements the terminal.</span></span> <span data-ttu-id="067c6-123">Die Rückgabe von "TT \_ static" funktioniert auch, und das zurückgeben dieses Werts kann sinnvoll sein, wenn das Terminal einem Hardware Gerät entspricht. Dies kann jedoch für Benutzer verwirrend sein, da ein statisches Terminal nicht in der statischen terminalenumeration von MSP vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="067c6-123">Returning TT\_STATIC will also work, and returning this value may be appropriate if the terminal corresponds to a hardware device; however, doing this may be confusing to users because a static terminal will not be present in the MSP's static terminal enumeration.</span></span>

[<span data-ttu-id="067c6-124">**Itterminal:: get- \_ Status**</span><span class="sxs-lookup"><span data-stu-id="067c6-124">**ITTerminal::get\_State**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itterminal-get_state)

<span data-ttu-id="067c6-125">Wenn die Terminal Implementierung die Anzahl der Streams, mit denen das Terminal gleichzeitig verbunden sein kann, nicht willkürlich einschränkt, sollte das Terminal immer TS \_ notinuse zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="067c6-125">If the terminal implementation does not arbitrarily limit the number of streams that the terminal can be concurrently connected to, then the terminal should always return TS\_NOTINUSE.</span></span>

<span data-ttu-id="067c6-126">Andernfalls schränkt die Terminal Implementierung willkürlich die Anzahl der Streams ein, mit denen das Terminal gleichzeitig verbunden werden kann.</span><span class="sxs-lookup"><span data-stu-id="067c6-126">Otherwise, the terminal implementation arbitrarily limits the number of streams that the terminal can be connected to at a time.</span></span> <span data-ttu-id="067c6-127">In diesem Fall sollte das Terminal die Anzahl der Datenströme, mit denen er verbunden ist, beibehalten.</span><span class="sxs-lookup"><span data-stu-id="067c6-127">In this case, the terminal should keep a count of how many streams it is connected to.</span></span> <span data-ttu-id="067c6-128">Das Terminal sollte diese interne Anzahl bei einem erfolgreichen [**itterminalcontrol:: connectterminal**](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-connectterminal) -Befehl erhöhen und auf einem erfolgreichen [**itterminalcontrol::D isconnectterminal**](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-disconnectterminal) -Befehl Dekrement verringern.</span><span class="sxs-lookup"><span data-stu-id="067c6-128">The terminal should increment this internal count on a successful [**ITTerminalControl::ConnectTerminal**](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-connectterminal) call and decrement it on a successful [**ITTerminalControl::DisconnectTerminal**](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-disconnectterminal) call.</span></span> <span data-ttu-id="067c6-129">Im [**itterminal:: get- \_ Zustand**](/windows/win32/api/tapi3if/nf-tapi3if-itterminal-get_state)sollte "TS InUse" zurückgegeben werden, \_ Wenn diese Anzahl gleich der maximalen Anzahl von Streams ist, für die das Terminal gleichzeitig ausgewählt werden kann. andernfalls sollte "TS \_ notinuse" zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="067c6-129">In [**ITTerminal::get\_State**](/windows/win32/api/tapi3if/nf-tapi3if-itterminal-get_state), it should return TS\_INUSE if this count is equal to the maximum number of streams that the terminal can be selected on at a time; otherwise, it should return TS\_NOTINUSE.</span></span> <span data-ttu-id="067c6-130">Beachten Sie, dass die Anzahl einfach ein boolescher Wert oder ein Terminal Zustandswert sein kann, wenn der Grenzwert 1 ist \_ .</span><span class="sxs-lookup"><span data-stu-id="067c6-130">Note that if the limit is one, the count can simply be a Boolean or a TERMINAL\_STATE value.</span></span>

[<span data-ttu-id="067c6-131">**Itterminal:: get- \_ Name**</span><span class="sxs-lookup"><span data-stu-id="067c6-131">**ITTerminal::get\_Name**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itterminal-get_name)

<span data-ttu-id="067c6-132">Das Terminal sollte einen **BSTR** -Namen seiner Wahl zurückgeben, der über " [**SysAllocString**](/windows/win32/api/oleauto/nf-oleauto-sysallocstring)" zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="067c6-132">The terminal should return a **BSTR** name of its choice, allocated via [**SysAllocString**](/windows/win32/api/oleauto/nf-oleauto-sysallocstring).</span></span> <span data-ttu-id="067c6-133">Dieser Name sollte für den Benutzer aussagekräftig sein und lokalisiert werden.</span><span class="sxs-lookup"><span data-stu-id="067c6-133">This name should be meaningful to the user and should be localized.</span></span>

[<span data-ttu-id="067c6-134">**Itterminal:: get- \_ mediaType**</span><span class="sxs-lookup"><span data-stu-id="067c6-134">**ITTerminal::get\_MediaType**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itterminal-get_mediatype)

<span data-ttu-id="067c6-135">Das Terminal sollte seinen Medientyp zurückgeben, entweder tapimediatype \_ Audiodatei oder tapimediatype \_ Video.</span><span class="sxs-lookup"><span data-stu-id="067c6-135">The terminal should return its media type, either TAPIMEDIATYPE\_AUDIO or TAPIMEDIATYPE\_VIDEO.</span></span>

[<span data-ttu-id="067c6-136">**Itterminal:: get- \_ Richtung**</span><span class="sxs-lookup"><span data-stu-id="067c6-136">**ITTerminal::get\_Direction**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itterminal-get_direction)

<span data-ttu-id="067c6-137">Das Terminal gibt den \_ terminalumenumenumerationswert zurück, der die Richtung des Terminals angibt.</span><span class="sxs-lookup"><span data-stu-id="067c6-137">The terminal returns the TERMINAL\_DIRECTION enum value indicating the direction of the terminal.</span></span> <span data-ttu-id="067c6-138">Wenn das Terminal bidirektional ist (z. b. eine Bridge), muss es den TD- \_ bidirektionalen Wert zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="067c6-138">If the terminal is bidirectional (for example, a bridge), then it must return TD\_BIDIRECTIONAL.</span></span>

<span data-ttu-id="067c6-139">Das Terminal muss [**itterminalcontrol**](/windows/desktop/api/Termmgr/nn-termmgr-itterminalcontrol) (nur Vtable) implementieren.</span><span class="sxs-lookup"><span data-stu-id="067c6-139">The terminal must implement [**ITTerminalControl**](/windows/desktop/api/Termmgr/nn-termmgr-itterminalcontrol) (vtable only).</span></span>

[<span data-ttu-id="067c6-140">**Itterminalcontrol:: get \_ adresssshandle**</span><span class="sxs-lookup"><span data-stu-id="067c6-140">**ITTerminalControl::get\_AddressHandle**</span></span>](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-get_addresshandle)

<span data-ttu-id="067c6-141">Ein von der Anwendung bereitgestelltes Terminal sollte immer **null** als Adress Handle zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="067c6-141">An application-provided terminal should always return **NULL** as the address handle.</span></span> <span data-ttu-id="067c6-142">Dies gibt dem MSP an, dass dieses Terminal nicht für ein bestimmtes MSP-Adress Objekt erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="067c6-142">This indicates to the MSP that this terminal was not created on a specific MSP address object.</span></span>

[<span data-ttu-id="067c6-143">**Itterminalcontrol:: connectterminal**</span><span class="sxs-lookup"><span data-stu-id="067c6-143">**ITTerminalControl::ConnectTerminal**</span></span>](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-connectterminal)

<span data-ttu-id="067c6-144">Bei diesem Aufruf fügt das Terminal seine Filter dem angegebenen Diagramm hinzu und verbindet Sie ggf. miteinander.</span><span class="sxs-lookup"><span data-stu-id="067c6-144">On this call, the terminal will add its filter(s) to the given graph and connect them to each other, if applicable.</span></span> <span data-ttu-id="067c6-145">Das Terminal sollte dann die vom Terminal verfügbar gemachten PIN (s) für die angegebene Datenstrom Richtung zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="067c6-145">Then the terminal should return the pin(s) exposed by the terminal for the stream direction specified.</span></span>

<span data-ttu-id="067c6-146">Ein Terminal, das keine gleichzeitige Verbindung mit mehreren Streams unterstützt, würde \_ beim erfolgreichen Abschluss dieser Methode eine interne Variable auf Terminaldiensteverwendung festlegen.</span><span class="sxs-lookup"><span data-stu-id="067c6-146">A terminal that does not support concurrent connection to multiple streams would set an internal variable to TS\_INUSE on successful completion of this method.</span></span>

<span data-ttu-id="067c6-147">Das Terminal kann den *dwterminaldirection* -Parameter dieses Aufrufes verwenden, um die Richtung des Streams zu bestimmen, mit dem eine Verbindung hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="067c6-147">The terminal can use the *dwTerminalDirection* parameter from this call to determine the direction of the stream that it is being connected to.</span></span> <span data-ttu-id="067c6-148">Dies ist für bidirektionale Terminals erforderlich.</span><span class="sxs-lookup"><span data-stu-id="067c6-148">This is required for bidirectional terminals.</span></span>

> [!Note]  
> <span data-ttu-id="067c6-149">In der Regel (in den MSP-Basisklassen und in allen bekannten MSPs) schlägt der MSP-streamcode die Verbindung fehl, wenn das Terminal mehr als eine PIN von einem einzigen [**connectterminal**](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-connectterminal) -Befehl zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="067c6-149">Typically (in the MSP base classes and in all known MSPs), the MSP stream code will fail the connection if the terminal returns more than one pin from a single [**ConnectTerminal**](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-connectterminal) call.</span></span> <span data-ttu-id="067c6-150">Das ist in Ordnung, da ein Terminal, das mehr als eine PIN während der Verbindung zurückgibt, erfordert, dass der MSP besondere Kenntnisse des Terminals hat, um die zusätzlichen Pins effektiv nutzen zu können.</span><span class="sxs-lookup"><span data-stu-id="067c6-150">This is fine, because a terminal that returns more than one pin during connection requires the MSP to have special knowledge of the terminal to make use of the extra pins effectively.</span></span>

 

[<span data-ttu-id="067c6-151">**Itterminalcontrol:: completeconnectterminal**</span><span class="sxs-lookup"><span data-stu-id="067c6-151">**ITTerminalControl::CompleteConnectTerminal**</span></span>](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-completeconnectterminal)

<span data-ttu-id="067c6-152">Das Terminal sollte nur S OK zurückgeben \_ .</span><span class="sxs-lookup"><span data-stu-id="067c6-152">The terminal should just return S\_OK.</span></span> <span data-ttu-id="067c6-153">Das Terminal kann auch nach der Verbindungs Initialisierung durchführen, wenn dies erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="067c6-153">The terminal may also do post-connection initialization if it needs to.</span></span>

[<span data-ttu-id="067c6-154">**Itterminalcontrol::D isconnectterminal**</span><span class="sxs-lookup"><span data-stu-id="067c6-154">**ITTerminalControl::DisconnectTerminal**</span></span>](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-disconnectterminal)

<span data-ttu-id="067c6-155">Das Terminal sollte alle erforderlichen Aktionen ausführen, um die Verbindung mit dem Terminal vom Rest des Diagramms getrennt zu werden.</span><span class="sxs-lookup"><span data-stu-id="067c6-155">The terminal should do whatever is needed to disconnect the terminal from the rest of the graph.</span></span> <span data-ttu-id="067c6-156">In der Regel umfasst dies das Entfernen aller Terminals-Filter aus dem Diagramm und das Festlegen des Terminal Zustands auf \_ terminaldienstedienste.</span><span class="sxs-lookup"><span data-stu-id="067c6-156">Typically this involves removing all the terminals' filters from the graph and setting the terminal state to TS\_NOTINUSE.</span></span>

[<span data-ttu-id="067c6-157">**Itterminalcontrol:: runrenderfilter**</span><span class="sxs-lookup"><span data-stu-id="067c6-157">**ITTerminalControl::RunRenderFilter**</span></span>](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-runrenderfilter)

<span data-ttu-id="067c6-158">Das Terminal sollte nur E \_ notimpl zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="067c6-158">The terminal should just return E\_NOTIMPL.</span></span>

[<span data-ttu-id="067c6-159">**Itterminalcontrol:: stoprenderfilter**</span><span class="sxs-lookup"><span data-stu-id="067c6-159">**ITTerminalControl::StopRenderFilter**</span></span>](/windows/desktop/api/Termmgr/nf-termmgr-itterminalcontrol-stoprenderfilter)

<span data-ttu-id="067c6-160">Das Terminal sollte nur E \_ notimpl zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="067c6-160">The terminal should just return E\_NOTIMPL.</span></span>

 

 
