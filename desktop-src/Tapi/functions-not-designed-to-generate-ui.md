---
description: Angenommen, der Dienstanbieter muss ein Dialogfeld (z. b. das Dialogfeld Unimodem oder atsp Talk/hangup) während der Verarbeitung von linemakecall oder linedial anzeigen.
ms.assetid: 46f87947-bfcd-48ad-8c33-7ea4d9caa34c
title: Funktionen, die nicht zum Generieren von Benutzeroberflächen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70bd7ed1395136d1a2d2a31b060127395e8804ac
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104529066"
---
# <a name="functions-not-designed-to-generate-ui"></a><span data-ttu-id="b196e-103">Funktionen, die nicht zum Generieren von Benutzeroberflächen</span><span class="sxs-lookup"><span data-stu-id="b196e-103">Functions Not Designed to Generate UI</span></span>

<span data-ttu-id="b196e-104">Angenommen, der Dienstanbieter muss ein Dialogfeld (z. b. das Dialogfeld Unimodem oder atsp **Talk/hangup** ) während der Verarbeitung von [**linemakecall**](/windows/win32/api/tapi/nf-tapi-linemakecall) oder [**linedial**](/windows/win32/api/tapi/nf-tapi-linedial)anzeigen.</span><span class="sxs-lookup"><span data-stu-id="b196e-104">Assume that the service provider must display a dialog box (like the Unimodem or ATSP **Talk/Hangup** dialog box) during the processing of [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) or [**lineDial**](/windows/win32/api/tapi/nf-tapi-linedial).</span></span> <span data-ttu-id="b196e-105">In diesem Fall ist dies der Dienstanbieter, nicht die Anwendung, der entscheidet, dass die Benutzeroberfläche angezeigt werden muss.</span><span class="sxs-lookup"><span data-stu-id="b196e-105">In this case, it is the service provider, not the application, that decides that UI must be displayed.</span></span>

<span data-ttu-id="b196e-106">Um die Benutzeroberflächen-DLL im Anwendungsprozess aufzurufen, ruft der Dienstanbieter den TSPI- [*Zeilen \_ Ereignis*](/windows/win32/api/tspi/nc-tspi-lineevent) Rückruf auf und erzeugt dabei eine Zeile mit der Meldung "" mit der Meldung "", dass ein Zeiger auf eine Struktur des Typs " [**tuispikreatedialoginstancepara**](/windows/win32/api/tspi/ns-tspi-tuispicreatedialoginstanceparams)" übergeben wird. [**\_**](line-createdialoginstance.md)</span><span class="sxs-lookup"><span data-stu-id="b196e-106">To invoke the UI DLL in the application process, the service provider calls the TSPI [*Line\_Event*](/windows/win32/api/tspi/nc-tspi-lineevent) callback, generating a [**LINE\_CREATEDIALOGINSTANCE**](line-createdialoginstance.md) message, passing in a pointer to a structure of type [**TUISPICREATEDIALOGINSTANCEPARAMS**](/windows/win32/api/tspi/ns-tspi-tuispicreatedialoginstanceparams).</span></span> <span data-ttu-id="b196e-107">Diese Struktur enthält die **dwrequestid** der Funktion, der die Benutzeroberfläche zugeordnet ist, sodass die Client Anwendung, in der die Benutzeroberfläche generiert werden soll, von tapisrv identifiziert werden kann.</span><span class="sxs-lookup"><span data-stu-id="b196e-107">This structure contains the **dwRequestID** of the function with which the UI is associated, allowing TAPISRV to identify the client application in which the UI is to be generated.</span></span>

<span data-ttu-id="b196e-108">Tapisrv verlangt, dass die Instanz von TAPI der richtigen Anwendung die Benutzeroberflächen-DLL lädt und einen Thread für die Benutzeroberfläche innerhalb des Anwendungsprozesses erstellt.</span><span class="sxs-lookup"><span data-stu-id="b196e-108">TAPISRV requests the correct application's instance of TAPI to load the UI DLL and create a thread for the UI within the application's process.</span></span> <span data-ttu-id="b196e-109">In diesem neuen UI-Thread ruft TAPI die [**tuispi \_ providergenericdialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) -Funktion der UI-dll auf und übergibt dabei Daten, die vom Telefoniedienstanbieter in der Struktur angegeben wurden, die mit der [**Zeile " \_ foratedialoginstance**](line-createdialoginstance.md) " übergeben wurde. die Benutzeroberflächen-DLL zeigt das entsprechende Dialogfeld an</span><span class="sxs-lookup"><span data-stu-id="b196e-109">From this new UI thread, TAPI calls the UI DLL's [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) function, passing in data that was specified by the telephony service provider in the structure passed in with the [**LINE\_CREATEDIALOGINSTANCE**](line-createdialoginstance.md) message; the UI DLL displays the appropriate dialog box (which is a matter for private design between the UI DLL and the telephony service provider).</span></span> <span data-ttu-id="b196e-110">Die Benutzeroberflächen-DLL gibt nicht von " **tuispi \_ providergenericdialog** " zurück, bis das Dialogfeld geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="b196e-110">The UI DLL does not return from **TUISPI\_providerGenericDialog** until the dialog box is closed.</span></span>

<span data-ttu-id="b196e-111">Der Telefoniedienstanbieter kann aktualisierte Daten generieren, um Sie im Dialogfeld anzuzeigen (oder z. b. das Dialogfeld zu schließen, wenn der Rückruf abgebrochen oder andere Ereignisse eintreten), indem eine [**Zeile \_ senddialoginstancedata**](line-senddialoginstancedata.md) -Nachricht gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="b196e-111">The telephony service provider can generate updated data to display in the dialog box (or, for example, instruct the dialog box to be closed, if the call is abandoned or other events occur) by sending a [**LINE\_SENDDIALOGINSTANCEDATA**](line-senddialoginstancedata.md) message.</span></span> <span data-ttu-id="b196e-112">Tapisrv überträgt die Daten an TAPI, das die Funktion " [**tuispi \_ providergenericdialogdata**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialogdata) " der UI-DLL aufruft.</span><span class="sxs-lookup"><span data-stu-id="b196e-112">TAPISRV conveys the data to TAPI, which calls the UI DLL's [**TUISPI\_providerGenericDialogData**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialogdata) function.</span></span> <span data-ttu-id="b196e-113">Dieser Mechanismus stellt ein unidirektionales "Send" an die Benutzeroberflächen-DLL bereit.</span><span class="sxs-lookup"><span data-stu-id="b196e-113">This mechanism provides a unidirectional "send" to the UI DLL.</span></span> <span data-ttu-id="b196e-114">Wenn die Benutzeroberflächen-DLL den Telefoniedienstanbieter über die Ergebnisse des Dialog Felds informieren oder andere Daten abrufen möchte, kann Sie die [*dllcallbackproc*](/windows/win32/api/tspi/nc-tspi-tuispidllcallback) -Funktion aufrufen (einen Zeiger, den Sie empfangen hat, als " [**tuispi \_ providergenericdialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) " aufgerufen wurde).</span><span class="sxs-lookup"><span data-stu-id="b196e-114">If the UI DLL wants to inform the telephony service provider of the results of the dialog box or obtain other data, it can call the [*DllCallbackProc*](/windows/win32/api/tspi/nc-tspi-tuispidllcallback) function (a pointer to which it received when [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) was called).</span></span>

<span data-ttu-id="b196e-115">Wenn das Dialogfeld verworfen wird, kehrt [**tuispi \_ providergenericdialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) zu TAPI zurück.</span><span class="sxs-lookup"><span data-stu-id="b196e-115">When the dialog box is dismissed, [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) returns to TAPI.</span></span> <span data-ttu-id="b196e-116">TAPI ruft [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary) auf, um die UI-DLL freizugeben, und beendet den UI-Thread, den er im Anwendungskontext erstellt hat.</span><span class="sxs-lookup"><span data-stu-id="b196e-116">TAPI calls [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary) to release the UI DLL, and exits the UI thread it had created in the application context.</span></span> <span data-ttu-id="b196e-117">Anschließend fordert er tapisrv auf, die [**TSPI \_ providerfredialoginstance**](/windows/win32/api/tspi/nf-tspi-tspi_providerfreedialoginstance) -Funktion des Telefoniedienstanbieters aufzurufen, um die Bindung der Zuordnung aufzuheben, die erstellt wurde, als der Telefoniedienstanbieter ursprünglich die [**Zeile " \_ froatedialoginstance**](line-createdialoginstance.md) "</span><span class="sxs-lookup"><span data-stu-id="b196e-117">It then requests TAPISRV to call the telephony service provider's [**TSPI\_providerFreeDialogInstance**](/windows/win32/api/tspi/nf-tspi-tspi_providerfreedialoginstance) function to unbind the association created when the telephony service provider originally sent the [**LINE\_CREATEDIALOGINSTANCE**](line-createdialoginstance.md) message.</span></span> <span data-ttu-id="b196e-118">Diese Funktion wird auch aufgerufen, wenn der Anwendungsprozess unerwartet beendet wird, bevor " **tuispi \_ providergenericdialog** " zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="b196e-118">This function is also called if the application process terminates unexpectedly before **TUISPI\_providerGenericDialog** returns.</span></span>

 

 
