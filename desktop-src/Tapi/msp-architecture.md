---
description: In der TAPI-Architektur werden alle TSPS im Kontext von tapisrv ausgeführt, der als Dienst Prozess in svchost implementiert ist.
ms.assetid: f47662f9-2fca-4044-ab26-617e5b1f9eae
title: MSP-Architektur
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e8c1229ddce90f79c122c47572b4567d230b0b4e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104393334"
---
# <a name="msp-architecture"></a><span data-ttu-id="e4499-103">MSP-Architektur</span><span class="sxs-lookup"><span data-stu-id="e4499-103">MSP Architecture</span></span>

<span data-ttu-id="e4499-104">In der TAPI-Architektur werden alle TSPS im Kontext von tapisrv ausgeführt, der als Dienst Prozess in svchost implementiert ist.</span><span class="sxs-lookup"><span data-stu-id="e4499-104">In TAPI architecture, all TSPs are run in the context of TAPISRV, which is implemented as a service process within SVCHOST.</span></span> <span data-ttu-id="e4499-105">TAPI-Anwendungen Leben in Ihrem eigenen Prozess.</span><span class="sxs-lookup"><span data-stu-id="e4499-105">TAPI applications live in their own process.</span></span> <span data-ttu-id="e4499-106">TAPI-Anwendungen laden Tapi3.dll und alle benötigten MSPs in ihren eigenen Prozess, und die TAPI-dll kommuniziert mit tapisrv über eine private RPC-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="e4499-106">TAPI applications load Tapi3.dll and any needed MSPs into their own process, and the TAPI DLL communicates with TAPISRV through a private RPC interface.</span></span> <span data-ttu-id="e4499-107">Im folgenden Diagramm wird die Interaktion dieser Komponenten veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="e4499-107">The following diagram illustrates the interaction of these components.</span></span>

![Interaktionen zwischen tapisrv, TAPI-Anwendungen und MSPs](images/tsp-msp1.png)

<span data-ttu-id="e4499-109">Ein Medien Dienstanbieter (MSP) stellt Medien Streaming mithilfe der Abstraktionen von Terminals, Streams und unter strömen bereit.</span><span class="sxs-lookup"><span data-stu-id="e4499-109">A media service provider (MSP) provides media streaming using the abstractions of Terminals, Streams, and SubStreams.</span></span>

<span data-ttu-id="e4499-110">Ein Terminal ist eine Senke oder Quelle für einen Mediendaten Strom.</span><span class="sxs-lookup"><span data-stu-id="e4499-110">A Terminal is a sink or source for a media stream.</span></span> <span data-ttu-id="e4499-111">Dabei kann es sich um ein physisches Objekt handeln, z. b. einen Redner oder ein Mikrofon, oder es kann eine Abstraktion eines Geräts sein, z. b. ein Videofenster.</span><span class="sxs-lookup"><span data-stu-id="e4499-111">It may be a physical object, such as a speaker or a microphone, or it may be an abstraction of a device, such as a video window.</span></span> <span data-ttu-id="e4499-112">Das [Terminal Objekt](terminal-object.md) macht die [**itterminal**](/windows/win32/api/tapi3if/nn-tapi3if-itterminal) -Schnittstelle verfügbar.</span><span class="sxs-lookup"><span data-stu-id="e4499-112">The [Terminal Object](terminal-object.md) exposes the [**ITTerminal**](/windows/win32/api/tapi3if/nn-tapi3if-itterminal) interface.</span></span> <span data-ttu-id="e4499-113">Die Terminal Klasse wird durch die GUID der [**Terminal Klasse**](terminal-class.md) beschrieben.</span><span class="sxs-lookup"><span data-stu-id="e4499-113">The class of terminal is described by the [**Terminal Class**](terminal-class.md) GUID.</span></span> <span data-ttu-id="e4499-114">Ein MSP kann seine eigenen Terminal Klassen definieren.</span><span class="sxs-lookup"><span data-stu-id="e4499-114">An MSP may define its own terminal classes.</span></span>

<span data-ttu-id="e4499-115">Streams dividiert die Medien eines Aufrufes basierend auf dem [**Medientyp**](tapimediatype--constants.md) oder-Typ, der [**Richtung**](/windows/desktop/api/Tapi3if/ne-tapi3if-terminal_direction)des Streams und der Zieladresse des Mediums.</span><span class="sxs-lookup"><span data-stu-id="e4499-115">Streams divide the media of a call based on the [**media type**](tapimediatype--constants.md) or type, the stream's [**direction**](/windows/desktop/api/Tapi3if/ne-tapi3if-terminal_direction), and the destination address of the media.</span></span> <span data-ttu-id="e4499-116">Ein eingehender Audiostream von einem Modem ist beispielsweise ein Streamobjekt, ein ausgehender Videostream zu einer IP-Adresse und ein Port ist ein Datenstrom Objekt. die Videostreams aus einer IP-Multicast Gruppe werden ebenfalls als ein Streamobjekt betrachtet.</span><span class="sxs-lookup"><span data-stu-id="e4499-116">For example, an incoming audio stream from a modem is a stream object, an outgoing video stream to an IP address and port is a stream object, the video streams coming from a IP multicast group are also considered as one stream object.</span></span> <span data-ttu-id="e4499-117">Das Stream-Objekt wird durch die [**itstreamcontrol**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) -Schnittstelle dargestellt.</span><span class="sxs-lookup"><span data-stu-id="e4499-117">The Stream object is represented by the [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) interface.</span></span>

<span data-ttu-id="e4499-118">Unter Ströme ermöglichen eine präzisere Steuerung des Mediums.</span><span class="sxs-lookup"><span data-stu-id="e4499-118">SubStreams allow finer control over the media.</span></span> <span data-ttu-id="e4499-119">Im Fall von IP-Multicast könnte das eingehende videostreamobjekt beispielsweise mehrere Personen darstellen.</span><span class="sxs-lookup"><span data-stu-id="e4499-119">For example, in the IP multicast case, the incoming video stream object might represent several people.</span></span> <span data-ttu-id="e4499-120">Die Anwendung möchte wahrscheinlich, dass jeder Teilnehmer über einen separaten Renderer verfügt.</span><span class="sxs-lookup"><span data-stu-id="e4499-120">The application will most likely want each participant to have a separate renderer.</span></span> <span data-ttu-id="e4499-121">Der eingehende Videostream kann in mehrere unter Ströme aufgeteilt werden, eine für jede Person.</span><span class="sxs-lookup"><span data-stu-id="e4499-121">The incoming video stream can be divided into several substreams, one for each person.</span></span> <span data-ttu-id="e4499-122">Ein untergeordneter Stream würde einer Person entsprechen und kann separat konfiguriert und gesteuert werden.</span><span class="sxs-lookup"><span data-stu-id="e4499-122">One substream would correspond to one person, and can be configured and controlled separately.</span></span> <span data-ttu-id="e4499-123">Das substream-Objekt wird durch die [**itsubstreamcontrol**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstreamcontrol) -Schnittstelle dargestellt.</span><span class="sxs-lookup"><span data-stu-id="e4499-123">The SubStream object is represented by the [**ITSubStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstreamcontrol) interface.</span></span>

<span data-ttu-id="e4499-124">Wenn eine Anwendung [**itaddress:: anatecall**](/windows/desktop/api/tapi3if/nf-tapi3if-itaddress-createcall) aufruft, um einen Aufruf einzurichten, muss Sie den Typ des erforderlichen Mediums angeben.</span><span class="sxs-lookup"><span data-stu-id="e4499-124">When an application calls [**ITAddress::CreateCall**](/windows/desktop/api/tapi3if/nf-tapi3if-itaddress-createcall) to set up a call, it must specify the type of media required.</span></span> <span data-ttu-id="e4499-125">Bei einem ausgehenden-Befehl weist er nur TAPI an, wenn der-Befehl erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="e4499-125">On an outgoing call, it simply tells TAPI when the call is created.</span></span> <span data-ttu-id="e4499-126">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="e4499-126">For example:</span></span>

``` syntax
HRESULT hr = pAddress->CreateCall( 
       pszDestAddress, 
       lAddressType, 
       TAPIMEDIATYPE_AUDIO | TAPIMEDIATYPE_VIDEO, 
       &pCall 
       ); 
// If (hr != S_OK ) process the error here
```

<span data-ttu-id="e4499-127">In diesem Fall erstellt die Anwendung einen ausgehenden audiovideobefehl.</span><span class="sxs-lookup"><span data-stu-id="e4499-127">In this case, the application is creating an outgoing audio-video call.</span></span>

<span data-ttu-id="e4499-128">Die übergebenen Medientypen geben das Medium an, an dem die Anwendung über die Lebensdauer des Aufrufes interessiert ist.</span><span class="sxs-lookup"><span data-stu-id="e4499-128">The media types passed in indicate the media that the application is interested in over the lifetime of the call.</span></span> <span data-ttu-id="e4499-129">Die Anwendung kann z. b. Audioinformationen und Videos beim Erstellen des Aufrufes angeben. Wählen Sie jedoch am Anfang nur audioterminals aus.</span><span class="sxs-lookup"><span data-stu-id="e4499-129">For example, the application may specify audio and video when creating the call, but select only audio terminals at the beginning.</span></span> <span data-ttu-id="e4499-130">Das MSP startet nur Streaming-Audiodaten, lehnt jedoch eine lokale oder Remote-Video Anforderung ab, die zu einem späteren Zeitpunkt während der Lebensdauer des Aufrufes ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="e4499-130">The MSP will start streaming only audio, but will not reject a local or remote video request made later in the lifetime of the call.</span></span>

<span data-ttu-id="e4499-131">Wenn die Anwendung dann [**itbasiccallcontrol:: Connect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-connect)aufruft, ruft TAPI 3 [**TSPI \_ linemakecall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall) im TSP auf.</span><span class="sxs-lookup"><span data-stu-id="e4499-131">When the application then calls [**ITBasicCallControl::Connect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-connect), TAPI 3 calls [**TSPI\_lineMakeCall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall) in the TSP.</span></span> <span data-ttu-id="e4499-132">Nachdem ein-Rückruf eingerichtet wurde, können MSP und TSP bei Bedarf kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="e4499-132">After a call is established, the MSP and TSP can communicate as necessary.</span></span>

<span data-ttu-id="e4499-133">Wenn eine Verbindung getrennt wird, liegt es an den MSP-und TSP, um über das Beenden des Aufrufens zu kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="e4499-133">When a call is disconnecting, it is up to the MSP and TSP to communicate about tearing down the call.</span></span> <span data-ttu-id="e4499-134">Tapi3.dll wird [**TSPI \_ linedrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) aufrufen, wenn die Anwendung [**Disconnect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-disconnect)aufruft.</span><span class="sxs-lookup"><span data-stu-id="e4499-134">Tapi3.dll will call [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) if the application calls [**Disconnect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-disconnect).</span></span>

 

 
