---
description: Die folgende Abbildung zeigt die allgemeine Architektur von Telefoniedienstanbietern und deren zugeordneten Benutzeroberflächen-DLLs (Dynamic Link Libraries).
ms.assetid: b5efe57a-19b8-49c5-810f-180633ed50d2
title: Architektur (telefonieapi)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14423dba77af1ded38af4a6f2b896e76d28ca2cd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106353453"
---
# <a name="architecture-telephony-api"></a><span data-ttu-id="034a5-103">Architektur (telefonieapi)</span><span class="sxs-lookup"><span data-stu-id="034a5-103">Architecture (Telephony API)</span></span>

<span data-ttu-id="034a5-104">Die folgende Abbildung zeigt die allgemeine Architektur von Telefoniedienstanbietern und deren zugeordneten Benutzeroberflächen-DLLs (Dynamic Link Libraries).</span><span class="sxs-lookup"><span data-stu-id="034a5-104">The following illustration shows the general architecture of telephony service providers and their associated user interface dynamic-link libraries (UI DLLs).</span></span>

![TSPS und zugehörige UI-DLLs](images/spuidl01.png)

<span data-ttu-id="034a5-106">Der Dienstanbieter besteht aus mindestens zwei Komponenten.</span><span class="sxs-lookup"><span data-stu-id="034a5-106">The service provider consists of a minimum of two components.</span></span> <span data-ttu-id="034a5-107">Die Dienstanbieter-dll (in der Abbildung als Main bezeichnet). TSP) wird im Kontext des tapisrv-Prozesses ausgeführt und führt alle Aufgaben des Dienstanbieters aus, die nicht mit Benutzeroberflächen Elementen verknüpft sind, die mit der Verwendung des Geräts einer bestimmten Anwendung verknüpft sind (höchstwahrscheinlich in Verbindung mit nicht in der Abbildung dargestellten Komponenten auf niedrigerer Ebene).</span><span class="sxs-lookup"><span data-stu-id="034a5-107">The service provider DLL (designated in the illustration as MAIN.TSP) executes in the context of the TAPISRV process, and performs all of the tasks of the service provider that are not related to user interface elements associated with a particular application's use of the device (most likely, in conjunction with lower-level components not shown in the illustration).</span></span> <span data-ttu-id="034a5-108">Im Gegensatz zu früheren Versionen von TAPI, bei denen der Code der Benutzeroberfläche in den Dienstanbieter integriert wurde (und aufgrund der vorherigen Architektur im Kontext der Anwendung ausgeführt wurde), muss der Dienstanbieter nun eine separate Komponente enthalten, die die Elemente der Benutzeroberfläche implementiert.</span><span class="sxs-lookup"><span data-stu-id="034a5-108">But unlike previous versions of TAPI in which the user interface code was integrated into the service provider (and executed, because of the previous architecture, within the context of the application), the service provider must now include a separate component that implements the user interface elements.</span></span>

<span data-ttu-id="034a5-109">Die Benutzeroberflächen-DLL des Dienstanbieters muss Funktionen exportieren, die von TAPI aufgerufen werden, wenn die Anwendung TAPI-Funktionen aufruft, die Benutzeroberfläche generieren: [**tuispi \_ lineconfigdialog**](/windows/win32/api/tspi/nf-tspi-tuispi_lineconfigdialog), [**tuispi \_ lineconfigdialogedit**](/windows/win32/api/tspi/nf-tspi-tuispi_lineconfigdialogedit), [**tuispi \_ phoneconfigdialog**](/windows/win32/api/tspi/nf-tspi-tuispi_phoneconfigdialog), [**tuispi \_ providerconfig**](/windows/win32/api/tspi/nf-tspi-tuispi_providerconfig), [**tuispi \_ providerinstall**](/windows/win32/api/tspi/nf-tspi-tuispi_providerinstall)und [**tuispi \_ providerremove**](/windows/win32/api/tspi/nf-tspi-tuispi_providerremove).</span><span class="sxs-lookup"><span data-stu-id="034a5-109">The service provider UI DLL must export functions that are called by TAPI when the application calls TAPI functions that generate UI: [**TUISPI\_lineConfigDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_lineconfigdialog), [**TUISPI\_lineConfigDialogEdit**](/windows/win32/api/tspi/nf-tspi-tuispi_lineconfigdialogedit), [**TUISPI\_phoneConfigDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_phoneconfigdialog), [**TUISPI\_providerConfig**](/windows/win32/api/tspi/nf-tspi-tuispi_providerconfig), [**TUISPI\_providerInstall**](/windows/win32/api/tspi/nf-tspi-tuispi_providerinstall), and [**TUISPI\_providerRemove**](/windows/win32/api/tspi/nf-tspi-tuispi_providerremove).</span></span> <span data-ttu-id="034a5-110">Jede dieser Funktionen umfasst als Parameter einen Zeiger auf eine Rückruffunktion in TAPI, den Typ " [**tuispidllcallback**](/windows/win32/api/tspi/nc-tspi-tuispidllcallback)", der von der Benutzeroberflächen-DLL verwendet werden kann, um bidirektional (senden und empfangen von Daten) mit der Dienstanbieter-dll, die im tapisrv-Prozess ausgeführt wird, zu kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="034a5-110">Each of these functions includes as a parameter a pointer to a callback function in TAPI, of type [**TUISPIDLLCALLBACK**](/windows/win32/api/tspi/nc-tspi-tuispidllcallback), which the UI DLL can use to communicate bidirectionally (both send and receive data) with the service provider DLL executing in the TAPISRV process.</span></span> <span data-ttu-id="034a5-111">Wenn der Dienstanbieter jemals eine spontane Benutzeroberfläche generiert (z. b. das Dialogfeld Unimodem **Talk/hangup** ), in Verbindung mit jeder TSPI-Funktion, für die die Benutzeroberfläche nicht erwartet wird (z. b. eine Funktion, die nicht über einen *HWND* -Parameter verfügt), muss die Benutzeroberflächen-DLL [**tuispi \_ providergenericdialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) und [**tuispi \_**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialogdata)</span><span class="sxs-lookup"><span data-stu-id="034a5-111">If the service provider ever generates spontaneous UI, such as the Unimodem **Talk/Hangup** dialog box, in conjunction with any TSPI function for which UI is not expected (for example, any function that does not have an *hwnd* parameter), then the UI DLL must export [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) and [**TUISPI\_providerGenericDialogData**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialogdata).</span></span>

> [!Note]  
> <span data-ttu-id="034a5-112">Die ursprünglichen TSPI-Funktionen für die Benutzeroberflächen Erstellung ( [**TSPI \_ lineconfigdialog**](/windows/win32/api/tspi/nf-tspi-tspi_lineconfigdialog), [**TSPI \_ lineconfigdialogedit**](/windows/win32/api/tspi/nf-tspi-tspi_lineconfigdialogedit), [**TSPI \_ phoneconfigdialog**](/windows/win32/api/tspi/nf-tspi-tspi_phoneconfigdialog), [**TSPI \_ providerconfig**](/windows/win32/api/tspi/nf-tspi-tspi_providerconfig), [**TSPI \_ providerinstall**](/windows/win32/api/tspi/nf-tspi-tspi_providerinstall)und [**TSPI \_ providerremove**](/windows/win32/api/tspi/nf-tspi-tspi_providerremove)) sind veraltet und werden von TAPI nie aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="034a5-112">The original TSPI UI-generating functions ( [**TSPI\_lineConfigDialog**](/windows/win32/api/tspi/nf-tspi-tspi_lineconfigdialog), [**TSPI\_lineConfigDialogEdit**](/windows/win32/api/tspi/nf-tspi-tspi_lineconfigdialogedit), [**TSPI\_phoneConfigDialog**](/windows/win32/api/tspi/nf-tspi-tspi_phoneconfigdialog), [**TSPI\_providerConfig**](/windows/win32/api/tspi/nf-tspi-tspi_providerconfig), [**TSPI\_providerInstall**](/windows/win32/api/tspi/nf-tspi-tspi_providerinstall), and [**TSPI\_providerRemove**](/windows/win32/api/tspi/nf-tspi-tspi_providerremove)) are obsolete and never called by TAPI.</span></span> <span data-ttu-id="034a5-113">Daher müssen diese nicht von der Dienstanbieter-dll exportiert werden.</span><span class="sxs-lookup"><span data-stu-id="034a5-113">Therefore, these are not required to be exported by the service provider DLL.</span></span> <span data-ttu-id="034a5-114">Wenn der Dienstanbieter jedoch als einer aufgeführt werden soll, der über die Telefonie-Systemsteuerung hinzugefügt werden kann, ein Dienstprogramm, das in den Versionen 1,4 und früher mit Windows-Telefoniefunktionen bereitgestellt wird. **TSPI \_ providerinstall** muss exportiert werden. wenn die Schaltfläche " [**Entfernen**](/windows/win32/api/tapi3if/nn-tapi3if-itcollection2) " in der System Steuerungs Option "Telefonie" aktiviert sein soll, wenn Sie ausgewählt ist, muss Sie " **TSPI \_ providerremove**" exportieren. wenn die Schaltfläche " **Setup** " in der Systemsteuerung "Telefonie" aktiviert werden soll, wenn Sie ausgewählt ist, muss Sie " **TSPI \_ providerconfig**" exportieren.</span><span class="sxs-lookup"><span data-stu-id="034a5-114">However, if the service provider wants to be listed as one that can be added by the Telephony Control Panel, a utility supplied with Windows Telephony in versions 1.4 and earlier, it must export **TSPI\_providerInstall**; if it wants to have the [**Remove**](/windows/win32/api/tapi3if/nn-tapi3if-itcollection2) button enabled in the Telephony Control Panel when it is selected, it must export **TSPI\_providerRemove**; and if it wants the **Setup** button to be enabled in the Telephony Control Panel when it is selected, it must export **TSPI\_providerConfig**.</span></span> <span data-ttu-id="034a5-115">Die Telefonie-Systemsteuerung prüft, ob diese Funktionen in der TSP-Datei des Dienstanbieters vorhanden sind, um die Benutzeroberfläche so anzupassen, dass Sie anzeigt, welche Vorgänge ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="034a5-115">The Telephony Control Panel checks for the presence of these functions in the service provider TSP file to adjust its user interface to reflect which operations can be performed.</span></span>

 

<span data-ttu-id="034a5-116">Die Dienstanbieter-dll muss die [**TSPI \_ provideruiidentifizierung**](/windows/win32/api/tspi/nf-tspi-tspi_provideruiidentify) -Funktion exportieren, die der tapisrv-Prozess verwendet, um den Namen der Benutzeroberflächen-DLL zu erhalten, die im Anwendungsprozess geladen werden soll.</span><span class="sxs-lookup"><span data-stu-id="034a5-116">The service provider DLL must export the [**TSPI\_providerUIIdentify**](/windows/win32/api/tspi/nf-tspi-tspi_provideruiidentify) function that TAPISRV process uses to obtain the name of the UI DLL to load in the application process.</span></span> <span data-ttu-id="034a5-117">Es muss die [**TSPI \_ providergenericdialogdata**](/windows/win32/api/tspi/nf-tspi-tspi_providergenericdialogdata) -Funktion exportieren, um Anforderungen von der Benutzeroberflächen-DLL zu empfangen und auf diese zu antworten, damit Daten angezeigt werden. Außerdem muss der [**TSPI \_ providerfredialoginstance**](/windows/win32/api/tspi/nf-tspi-tspi_providerfreedialoginstance) -Prozess für den tapisrv-Prozess exportiert werden, um dem Dienstanbieter mitzuteilen, wann eine Zuordnung zur Erstellung einer spontanen Benutzeroberfläche in Verbindung mit einer Funktion veröffentlicht werden soll, die nicht als Darstellung der Benutzeroberfläche für den Benutzer definiert wurde.</span><span class="sxs-lookup"><span data-stu-id="034a5-117">It must export the [**TSPI\_providerGenericDialogData**](/windows/win32/api/tspi/nf-tspi-tspi_providergenericdialogdata) function to receive and respond to requests from the UI DLL for data to display, and it must export [**TSPI\_providerFreeDialogInstance**](/windows/win32/api/tspi/nf-tspi-tspi_providerfreedialoginstance) for TAPISRV process to tell the service provider when to release an association established for the purpose of generating spontaneous UI in conjunction with a function that is not defined as presenting UI to the user.</span></span> <span data-ttu-id="034a5-118">Die Dienstanbieter-dll kann Daten unidirektional mithilfe der neuen TSPI-Nachrichten [**Zeile \_ senddialoginstancedata**](line-senddialoginstancedata.md)an die Benutzeroberflächen-DLL senden.</span><span class="sxs-lookup"><span data-stu-id="034a5-118">The service provider DLL can unidirectionally send data to the UI DLL by using the new TSPI message [**LINE\_SENDDIALOGINSTANCEDATA**](line-senddialoginstancedata.md).</span></span>

<span data-ttu-id="034a5-119">Da die Namen der TSPI-und tuispi-Funktionen absichtlich als verschieden definiert werden, können die Dienstanbieter-dll und die UI-dll bei Bedarf dieselbe DLL-Datei sein.</span><span class="sxs-lookup"><span data-stu-id="034a5-119">Because the names of the TSPI and TUISPI functions are intentionally defined to be different, the service provider DLL and the UI DLL can be the same DLL file, if desired.</span></span> <span data-ttu-id="034a5-120">Bei der ordnungsgemäßen Segmentierung führt dies nicht unbedingt zu einer unnötigen Verwendung des Arbeitsspeichers im Anwendungskontext und kann den Installationsprozess für Dienstanbieter vereinfachen, die derzeit in einer einzigen dll implementiert werden können.</span><span class="sxs-lookup"><span data-stu-id="034a5-120">With proper segmentation, this does not necessarily result in any unnecessary usage of memory in the application context, and can simplify the installation process for service providers that can currently be implemented in a single DLL.</span></span> <span data-ttu-id="034a5-121">TAPI ruft nur die Funktionen auf, die für den Kontext geeignet sind, in dem die dll verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="034a5-121">TAPI calls only the functions that are appropriate for the context in which the DLL is being used.</span></span>

<span data-ttu-id="034a5-122">Der Telefoniedienstanbieter und die Benutzeroberflächen-DLL müssen beide mit der Anforderung entworfen werden, dass die Benutzeroberflächen Funktionen gleichzeitig aus mehreren Anwendungs Prozessen aufgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="034a5-122">The telephony service provider and the UI DLL must both be designed with the requirement in mind that the UI functions can be invoked from multiple application processes simultaneously.</span></span> <span data-ttu-id="034a5-123">Außerdem müssen Sie in Erwägung gezogen werden, dass sich die Anwendung und der TAPI-Dienst, unter denen der Telefoniedienstanbieter ausgeführt wird, auf separaten Computern auf einem LAN befinden können.</span><span class="sxs-lookup"><span data-stu-id="034a5-123">They must also consider that the application and the TAPI service under which the telephony service provider is executing can be on separate computers on a LAN.</span></span>

 

 
