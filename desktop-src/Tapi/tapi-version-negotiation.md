---
description: Im Laufe der Zeit sind unter Umständen verschiedene Versionen für TAPI, Anwendungen und Dienstanbieter für eine Linie oder ein Telefon vorhanden.
ms.assetid: 36a17ae8-31db-4db9-a401-097d47aa26ad
title: Aushandlung der TAPI-Version
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f41f4ca6f12862d6fc19f982c48b90bdafe2aaa2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106353617"
---
# <a name="tapi-version-negotiation"></a><span data-ttu-id="f124b-103">Aushandlung der TAPI-Version</span><span class="sxs-lookup"><span data-stu-id="f124b-103">TAPI Version Negotiation</span></span>

<span data-ttu-id="f124b-104">Im Laufe der Zeit sind unter Umständen verschiedene Versionen für TAPI, Anwendungen und Dienstanbieter für eine Linie oder ein Telefon vorhanden.</span><span class="sxs-lookup"><span data-stu-id="f124b-104">Over time, different versions may exist for TAPI, applications, and service providers for a line or phone.</span></span> <span data-ttu-id="f124b-105">Neue Versionen können neue Features, neue Felder für Datenstrukturen usw. definieren.</span><span class="sxs-lookup"><span data-stu-id="f124b-105">New versions may define new features, new fields to data structures, and so on.</span></span> <span data-ttu-id="f124b-106">Versionsnummern geben daher an, wie verschiedene Datenstrukturen interpretiert werden.</span><span class="sxs-lookup"><span data-stu-id="f124b-106">Version numbers therefore indicate how to interpret various data structures.</span></span>

<span data-ttu-id="f124b-107">Um eine optimale Interoperabilität verschiedener Versionen von Anwendungen, Versionen von TAPI selbst und Versionen von Dienstanbietern durch verschiedene Lieferanten zu ermöglichen, bietet TAPI einen einfachen, zweistufigen Aushandlungs Mechanismus für-Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="f124b-107">To allow optimal interoperability of different versions of applications, versions of TAPI itself, and versions of service providers by different vendors, TAPI provides a simple, two-step version negotiation mechanism for applications.</span></span> <span data-ttu-id="f124b-108">Zwei verschiedene Versionen müssen von der Anwendung, TAPI und dem Dienstanbieter für jedes Zeilen Gerät vereinbart werden.</span><span class="sxs-lookup"><span data-stu-id="f124b-108">Two different versions must be agreed on by the application, TAPI, and the service provider for each line device.</span></span> <span data-ttu-id="f124b-109">Der erste ist die Versionsnummer für die einfache und ergänzende Telefonie und wird als API-Version bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="f124b-109">The first is the version number for Basic and Supplementary Telephony and is referred to as the API version.</span></span> <span data-ttu-id="f124b-110">Die andere gilt für anbieterspezifische Erweiterungen, sofern vorhanden, und wird als Erweiterungs Version bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="f124b-110">The other is for provider-specific extensions, if any, and is referred to as the extension version.</span></span> <span data-ttu-id="f124b-111">Das Format der Datenstrukturen und Datentypen, die von den grundlegenden und ergänzenden Features von TAPI verwendet werden, wird durch die API-Version definiert, während die Erweiterungs Version das Format der Datenstrukturen bestimmt, die von den herstellerspezifischen Erweiterungen definiert werden.</span><span class="sxs-lookup"><span data-stu-id="f124b-111">The format of the data structures and datatypes used by TAPI's basic and supplementary features is defined by the API version, while the extension version determines the format of the data structures defined by the vendor-specific extensions.</span></span>

<span data-ttu-id="f124b-112">Die Versions Aushandlung verläuft in zwei Phasen.</span><span class="sxs-lookup"><span data-stu-id="f124b-112">Version negotiation proceeds in two phases.</span></span> <span data-ttu-id="f124b-113">In der ersten Phase wird die API-Versionsnummer ausgehandelt, und der Erweiterungs Bezeichner, der mit herstellerspezifischen, auf dem Gerät unterstützten Erweiterungen verknüpft ist, wird abgerufen.</span><span class="sxs-lookup"><span data-stu-id="f124b-113">In the first phase, the API version number is negotiated and the extension identifier associated with any vendor-specific extensions supported on the device is obtained.</span></span> <span data-ttu-id="f124b-114">In der zweiten Phase wird die Erweiterungs Version ausgehandelt.</span><span class="sxs-lookup"><span data-stu-id="f124b-114">In the second phase, the extension version is negotiated.</span></span> <span data-ttu-id="f124b-115">Wenn die Anwendung keine API-Erweiterungen verwendet, überspringt Sie die zweite Phase, und Erweiterungen werden nicht vom Dienstanbieter aktiviert.</span><span class="sxs-lookup"><span data-stu-id="f124b-115">If the application does not use any API extensions, it skips the second phase and extensions are not activated by the service provider.</span></span> <span data-ttu-id="f124b-116">Wenn die Anwendung Erweiterungen verwenden will, aber die Erweiterungen des Dienstanbieters (der Erweiterungs Bezeichner) von der Anwendung nicht erkannt werden, sollte die Anwendung auch die Aushandlung der Erweiterungs Version überspringen.</span><span class="sxs-lookup"><span data-stu-id="f124b-116">If the application does want to use extensions, but the service provider's extensions (the extension identifier) are not recognized by the application, the application should skip the negotiation for extension version as well.</span></span> <span data-ttu-id="f124b-117">Jeder Anbieter verfügt über einen eigenen Satz von zulässigen (anerkannten) Versionen für jeden Satz von Erweiterungs Spezifikationen, der von ihm verteilt wird.</span><span class="sxs-lookup"><span data-stu-id="f124b-117">Each vendor has its own set of legal (recognized) versions for each set of extension specifications it distributes.</span></span>

<span data-ttu-id="f124b-118">Die [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion) -Funktion wird verwendet, um die zu verwendende API-Versionsnummer auszuhandeln.</span><span class="sxs-lookup"><span data-stu-id="f124b-118">The [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion) function is used to negotiate the API version number to use.</span></span> <span data-ttu-id="f124b-119">Außerdem wird der vom liniengerät Unterstützte Erweiterungs Bezeichner abgerufen, und es werden Nullen zurückgegeben, wenn keine Erweiterungen unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="f124b-119">It also retrieves the extension identifier supported by the line device, returning zeros if no extensions are supported.</span></span> <span data-ttu-id="f124b-120">Mit diesem Funktions aufrufbefehl stellt die Anwendung den API-Versions Bereich bereit, mit dem Sie kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="f124b-120">With this function call, the application provides the API version range it is compatible with.</span></span> <span data-ttu-id="f124b-121">TAPI verhandelt wiederum mit dem Dienstanbieter der Zeile, um zu bestimmen, welcher API-Versions Bereich unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="f124b-121">TAPI in turn negotiates with the line's service provider to determine which API version range it supports.</span></span> <span data-ttu-id="f124b-122">TAPI wählt als nächstes eine Versionsnummer (in der Regel, auch wenn nicht unbedingt, die höchste Versionsnummer) im überlappenden Versions Bereich aus, den die Anwendung, die dll und der Dienstanbieter bereitgestellt haben.</span><span class="sxs-lookup"><span data-stu-id="f124b-122">TAPI next selects a version number (typically, although not necessarily, the highest version number) in the overlapping version range that the application, the DLL, and the service provider have supplied.</span></span> <span data-ttu-id="f124b-123">Diese Nummer wird an die Anwendung zurückgegeben, zusammen mit dem Erweiterungs Bezeichner, der die Erweiterungen definiert, die vom Dienstanbieter dieser Zeile verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="f124b-123">This number is returned to the application, along with the extension identifier that defines the extensions available from that line's service provider.</span></span>

<span data-ttu-id="f124b-124">Wenn die Anwendung die Erweiterungen verwenden möchte, die durch den zurückgegebenen Erweiterungs Bezeichner definiert werden, muss zuerst [**linenegotiateextversion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateextversion) aufgerufen werden, um die Erweiterungs Version auszuhandeln.</span><span class="sxs-lookup"><span data-stu-id="f124b-124">If the application wants to use the extensions defined by the returned extension identifier, it must first call [**lineNegotiateExtVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateextversion) to negotiate the extension version.</span></span> <span data-ttu-id="f124b-125">In einer ähnlichen Aushandlungs Phase gibt die Anwendung die bereits vereinbarte API-Version und den von ihr unterstützten Erweiterungs Versions Bereich an.</span><span class="sxs-lookup"><span data-stu-id="f124b-125">In a similar negotiation phase, the application specifies the already agreed-upon API version and the extension version range it supports.</span></span> <span data-ttu-id="f124b-126">TAPI übergibt diese Informationen an den Dienstanbieter für die Zeile.</span><span class="sxs-lookup"><span data-stu-id="f124b-126">TAPI passes this information to the service provider for the line.</span></span> <span data-ttu-id="f124b-127">Der Dienstanbieter überprüft die API-Version und den Erweiterungs Versions Bereich gegen seinen eigenen und wählt die entsprechende Erweiterungs Versionsnummer aus, sofern vorhanden.</span><span class="sxs-lookup"><span data-stu-id="f124b-127">The service provider checks the API version and the extension version range against its own, and selects the appropriate extension version number, if one exists.</span></span>

<span data-ttu-id="f124b-128">Wenn die Anwendung später [**linegetdevcaps**](/windows/desktop/api/Tapi/nf-tapi-linegetdevcaps)aufruft, gibt Sie einen Satz von Gerätefunktionen für die Zeile zurück, die den Ergebnissen der Versions Aushandlung entsprechen.</span><span class="sxs-lookup"><span data-stu-id="f124b-128">When the application later calls [**lineGetDevCaps**](/windows/desktop/api/Tapi/nf-tapi-linegetdevcaps), it returns a set of device capabilities for the line that correspond to the results of version negotiation.</span></span> <span data-ttu-id="f124b-129">Hierzu gehören die Gerätefunktionen der Zeile, die mit der API-Version konsistent sind, sowie die gerätespezifischen Funktionen der Zeile, die der Erweiterungs Version entsprechen.</span><span class="sxs-lookup"><span data-stu-id="f124b-129">These include the line's device capabilities consistent with the API version and the line's device-specific capabilities consistent with the extension version.</span></span> <span data-ttu-id="f124b-130">Die Anwendung muss beide Versionsnummern angeben, wenn Sie eine Linie öffnet.</span><span class="sxs-lookup"><span data-stu-id="f124b-130">The application must specify both of these version numbers when it opens a line.</span></span> <span data-ttu-id="f124b-131">An diesem Punkt werden die Anwendung, die dll und der Dienstanbieter für die Verwendung der vereinbarten Versionen verpflichtet.</span><span class="sxs-lookup"><span data-stu-id="f124b-131">At that point, the application, the DLL, and the service provider are committed to using the agreed-upon versions.</span></span> <span data-ttu-id="f124b-132">Wenn keine gerätespezifischen Erweiterungen verwendet werden sollen, sollte die Erweiterungs Version als 0 (null) angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="f124b-132">If device-specific extensions are not to be used, the extension version should be specified as zero.</span></span>

<span data-ttu-id="f124b-133">In einer Umgebung, in der mehrere Anwendungen das gleiche Zeilen Gerät öffnen, wählt die erste Anwendung, die das liniengerät öffnet, die Versionen für alle zukünftigen Anwendungen aus, die die Zeile verwenden möchten (Dienstanbieter unterstützen nicht mehrere Versionen gleichzeitig). Auf ähnliche Weise kann eine Anwendung, die mehrere Linien Geräte öffnet, den Betrieb von allen Linien Geräten unter derselben API-Versionsnummer erleichtern.</span><span class="sxs-lookup"><span data-stu-id="f124b-133">In an environment where multiple applications open the same line device, the first application to open the line device selects the versions for all future applications that want to use the line (service providers do not support multiple versions simultaneously.) Similarly, an application that opens multiple line devices may find it easier to operate all line devices under the same API version number.</span></span>

<span data-ttu-id="f124b-134">Jede Funktion, die einen *dwapiversion* -Parameter oder einen ähnlichen Parameter annimmt, muss diesen Parameter entweder auf die höchste API-Version festlegen, die von der Anwendung unterstützt wird, oder auf die API-Version, die mit der Funktion [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion) oder [**phonenegotiateapiversion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion) auf einem bestimmten Gerät</span><span class="sxs-lookup"><span data-stu-id="f124b-134">Every function that takes a *dwAPIVersion* or similar parameter must set this parameter to either the highest API version supported by the application or the API version negotiated using the [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion) or [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion) function on a particular device.</span></span> <span data-ttu-id="f124b-135">Verwenden Sie die folgende Tabelle als Richtlinie:</span><span class="sxs-lookup"><span data-stu-id="f124b-135">Use the following table as a guide:</span></span>



| <span data-ttu-id="f124b-136">Funktion</span><span class="sxs-lookup"><span data-stu-id="f124b-136">Function</span></span>                                                     | <span data-ttu-id="f124b-137">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="f124b-137">Meaning</span></span>                                                                               |
|--------------------------------------------------------------|---------------------------------------------------------------------------------------|
| [<span data-ttu-id="f124b-138">**linegetaddresscaps**</span><span class="sxs-lookup"><span data-stu-id="f124b-138">**lineGetAddressCaps**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegetaddresscaps)             | <span data-ttu-id="f124b-139">Verwenden Sie die von [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion)zurückgegebene Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-139">Use version returned by [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span></span>   |
| [<span data-ttu-id="f124b-140">**linegetcountry**</span><span class="sxs-lookup"><span data-stu-id="f124b-140">**lineGetCountry**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegetcountry)                     | <span data-ttu-id="f124b-141">Verwenden Sie die höchste von der Anwendung unterstützte Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-141">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="f124b-142">**linegetdevcaps**</span><span class="sxs-lookup"><span data-stu-id="f124b-142">**lineGetDevCaps**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegetdevcaps)                     | <span data-ttu-id="f124b-143">Verwenden Sie die von [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion)zurückgegebene Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-143">Use version returned by [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span></span>   |
| [<span data-ttu-id="f124b-144">**linegetproviderlist**</span><span class="sxs-lookup"><span data-stu-id="f124b-144">**lineGetProviderList**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegetproviderlist)           | <span data-ttu-id="f124b-145">Verwenden Sie die höchste von der Anwendung unterstützte Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-145">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="f124b-146">**linegettranslatecaps**</span><span class="sxs-lookup"><span data-stu-id="f124b-146">**lineGetTranslateCaps**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegettranslatecaps)         | <span data-ttu-id="f124b-147">Verwenden Sie die höchste von der Anwendung unterstützte Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-147">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="f124b-148">**lineNegotiateAPIVersion**</span><span class="sxs-lookup"><span data-stu-id="f124b-148">**lineNegotiateAPIVersion**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion)   | <span data-ttu-id="f124b-149">Verwenden Sie die höchste von der Anwendung unterstützte Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-149">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="f124b-150">**linenegotiateextversion**</span><span class="sxs-lookup"><span data-stu-id="f124b-150">**lineNegotiateExtVersion**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linenegotiateextversion)   | <span data-ttu-id="f124b-151">Verwenden Sie die von [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion)zurückgegebene Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-151">Use version returned by [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span></span>   |
| [<span data-ttu-id="f124b-152">**lineOpen**</span><span class="sxs-lookup"><span data-stu-id="f124b-152">**lineOpen**</span></span>](/windows/desktop/api/Tapi/nf-tapi-lineopen)                                 | <span data-ttu-id="f124b-153">Verwenden Sie die von [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion)zurückgegebene Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-153">Use version returned by [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span></span>   |
| [<span data-ttu-id="f124b-154">**linetranslateaddress**</span><span class="sxs-lookup"><span data-stu-id="f124b-154">**lineTranslateAddress**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linetranslateaddress)         | <span data-ttu-id="f124b-155">Verwenden Sie die höchste von der Anwendung unterstützte Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-155">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="f124b-156">**linetranslatedialog**</span><span class="sxs-lookup"><span data-stu-id="f124b-156">**lineTranslateDialog**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linetranslatedialog)           | <span data-ttu-id="f124b-157">Verwenden Sie die höchste von der Anwendung unterstützte Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-157">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="f124b-158">**phonegetdevcaps**</span><span class="sxs-lookup"><span data-stu-id="f124b-158">**phoneGetDevCaps**</span></span>](/windows/desktop/api/Tapi/nf-tapi-phonegetdevcaps)                   | <span data-ttu-id="f124b-159">Verwenden Sie die von [**phonenegotiateapiversion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion)zurückgegebene Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-159">Use version returned by [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion).</span></span> |
| [<span data-ttu-id="f124b-160">**phonenegotiateapiversion**</span><span class="sxs-lookup"><span data-stu-id="f124b-160">**phoneNegotiateAPIVersion**</span></span>](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion) | <span data-ttu-id="f124b-161">Verwenden Sie die höchste von der Anwendung unterstützte Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-161">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="f124b-162">**phonenegotiateextversion**</span><span class="sxs-lookup"><span data-stu-id="f124b-162">**phoneNegotiateExtVersion**</span></span>](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateextversion) | <span data-ttu-id="f124b-163">Verwenden Sie die von [**phonenegotiateapiversion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion)zurückgegebene Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-163">Use version returned by [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion).</span></span> |
| [<span data-ttu-id="f124b-164">**phoneopen**</span><span class="sxs-lookup"><span data-stu-id="f124b-164">**phoneOpen**</span></span>](/windows/desktop/api/Tapi/nf-tapi-phoneopen)                               | <span data-ttu-id="f124b-165">Verwenden Sie die von [**phonenegotiateapiversion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion)zurückgegebene Version.</span><span class="sxs-lookup"><span data-stu-id="f124b-165">Use version returned by [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion).</span></span> |



 

> [!IMPORTANT]
> <span data-ttu-id="f124b-166">Wenn Sie eine API-Version aushandeln, legen Sie die hohen und niedrigen Versionsnummern immer auf den Bereich von Versionen fest, der von der Anwendung unterstützt werden kann.</span><span class="sxs-lookup"><span data-stu-id="f124b-166">When negotiating an API version, always set the high and low version numbers to the range of versions that your application can support.</span></span> <span data-ttu-id="f124b-167">Verwenden Sie z. b. niemals 0x00000000 für die niedrige Version oder 0xFFFFFFFF für den hohen Wert, da diese Werte erfordern, dass Ihre Anwendung alle Versionen von TAPI sowohl in der Vergangenheit als auch in der Zukunft unterstützt.</span><span class="sxs-lookup"><span data-stu-id="f124b-167">For example, never use 0x00000000 for the low version or 0xFFFFFFFF for the high because these values require that your application support all versions of TAPI, both past and future.</span></span>

 

 

 



