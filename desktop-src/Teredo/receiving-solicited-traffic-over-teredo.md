---
title: Empfangen von angeforderten Datenverkehr über Teredo
description: Viele Anwendungen, wie z. b. Microsoft Internet Explorer und Microsoft Outlook, initiieren nur Verbindungen mit dem Internet.
ms.assetid: bff5d65e-050d-4b09-9982-8024612ffa6e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 035d067afeb9c62795efb5acd0bb28adc3afcb16
ms.sourcegitcommit: 773fa6257ead6c74154ad3cf46d21e49adc900aa
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/09/2020
ms.locfileid: "104517177"
---
# <a name="receiving-solicited-traffic-over-teredo"></a><span data-ttu-id="571d6-103">Empfangen von angeforderten Datenverkehr über Teredo</span><span class="sxs-lookup"><span data-stu-id="571d6-103">Receiving Solicited Traffic Over Teredo</span></span>

<span data-ttu-id="571d6-104">Viele Anwendungen, wie z. b. Microsoft Internet Explorer und Microsoft Outlook, initiieren nur Verbindungen mit dem Internet.</span><span class="sxs-lookup"><span data-stu-id="571d6-104">Many applications such as Microsoft Internet Explorer and Microsoft Outlook only initiate connections to the Internet.</span></span> <span data-ttu-id="571d6-105">Für diese Anwendungen kann [Teredo](about-teredo.md) eine nahtlose Konnektivität über IPv6 bereitstellen, wenn keine anderen IPv6-Schnittstellen vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="571d6-105">For these applications, [Teredo](about-teredo.md) can provide seamless connectivity over IPv6 in the absence of other IPv6 interfaces.</span></span> <span data-ttu-id="571d6-106">Darüber hinaus kann der angeforderte Datenverkehr über die Teredo-Schnittstelle auf den früheren Plattformen von Microsoft Windows XP mit Service Pack 2 (SP2) und Windows Server 2003 empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="571d6-106">Additionally, solicited traffic can be received over the Teredo Interface on the earlier Microsoft Windows XP with Service Pack 2 (SP2) and Windows Server 2003 platforms.</span></span>

<span data-ttu-id="571d6-107">In der folgenden Dokumentation wird erläutert, wie diese Anwendungen Konnektivität erreichen und in welchen Situationen Teredo verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="571d6-107">The following documentation explains how these applications achieve connectivity, and the circumstances under which Teredo is used.</span></span>

## <a name="obtaining-a-destination-address"></a><span data-ttu-id="571d6-108">Abrufen einer Zieladresse</span><span class="sxs-lookup"><span data-stu-id="571d6-108">Obtaining a Destination Address</span></span>

<span data-ttu-id="571d6-109">Eine Anwendung versucht, die Zieladresse mithilfe verschiedener Methoden (z. b. Domain Name System (DNS) oder Peer Name Resolution Protocol (PNRP) abzurufen.</span><span class="sxs-lookup"><span data-stu-id="571d6-109">An application attempts to obtain the destination address using various methods such as Domain Name System (DNS) or Peer Name Resolution Protocol (PNRP).</span></span> <span data-ttu-id="571d6-110">Die Anwendung kann mithilfe dieser Methoden mehrere IPv4-und IPv6-IP-Adressen abrufen.</span><span class="sxs-lookup"><span data-stu-id="571d6-110">It is possible for the application to obtain multiple IPv4 and IPv6 IP addresses using these methods.</span></span> <span data-ttu-id="571d6-111">Zu den typischen APIs, die zum Abrufen von IP-Adressen verwendet werden, gehören die Windows XP-API [**gethostbyname**](/windows/desktop/api/wsipv6ok/nf-wsipv6ok-gethostbyname) und die neue Windows Vista-API [**getaddrinfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo).</span><span class="sxs-lookup"><span data-stu-id="571d6-111">The typical APIs used to obtain IP addresses include the Windows XP API [**GetHostByName**](/windows/desktop/api/wsipv6ok/nf-wsipv6ok-gethostbyname) and the new Windows Vista API [**GetAddrInfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo).</span></span> <span data-ttu-id="571d6-112">Beispielsweise ermöglicht die Verwendung der getaddrinfo-API mit dem Parameter " *AI \_ Family* ", der auf "AF inet6" festgelegt ist, \_ als addrinfo-/Protokoll-Server die Abfrage von DNS-Servern für IPv6-Adressen.</span><span class="sxs-lookup"><span data-stu-id="571d6-112">For example, using the GetAddrInfo API with the *ai\_family* parameter set to AF\_INET6 as the addrinfo/protocol hint allows the user to query DNS servers for IPv6 addresses specifically.</span></span> <span data-ttu-id="571d6-113">Die [**DNSQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) -API mit dem Typ "DNS \_ Type \_ AAAA" kann auch verwendet werden, um die DNS-Server für AAAA-Einträge abzufragen.</span><span class="sxs-lookup"><span data-stu-id="571d6-113">The [**DnsQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) API with the type DNS\_TYPE\_AAAA can also be used to query the DNS servers for AAAA records.</span></span>

## <a name="establishing-a-connection"></a><span data-ttu-id="571d6-114">Herstellen einer Verbindung</span><span class="sxs-lookup"><span data-stu-id="571d6-114">Establishing a Connection</span></span>

<span data-ttu-id="571d6-115">Eine mit Teredo festgelegte Verbindung wird als "nahtlos" beschrieben, da Sie wie jede andere IPv6-Verbindung behandelt wird.</span><span class="sxs-lookup"><span data-stu-id="571d6-115">A connection established with Teredo is described as 'seamless' because it is handled like any other IPv6 connection.</span></span> <span data-ttu-id="571d6-116">Die Programmierung einer Anwendung erfordert keine besondere Überlegung, um die Teredo-Schnittstelle verwenden zu können.</span><span class="sxs-lookup"><span data-stu-id="571d6-116">The programming of an application does not require special consideration to be capable of utilizing the Teredo interface.</span></span> <span data-ttu-id="571d6-117">Wenn eine Verbindung zwischen Teredo-Schnittstellen hergestellt wird, ist ein Relayrouter, der typisch für IPv6-zu-IPv4 und andere systemeigene Schnittstellen ist, nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="571d6-117">When a connection is established between Teredo interfaces, a relay router, typical of 6to4 and other native interfaces, is not required.</span></span> <span data-ttu-id="571d6-118">Teredo ist jedoch als letzte Übergangstechnologie für den Übergang der IPv6-Konnektivität konzipiert.</span><span class="sxs-lookup"><span data-stu-id="571d6-118">However, Teredo is designed as a last resort transition technology for IPv6 connectivity.</span></span>

> [!Note]  
> <span data-ttu-id="571d6-119">Teredo wird nicht verwendet, wenn der angegebene Hostname nur zu IPv4-Adressen aufgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="571d6-119">Teredo is not utilized if the supplied hostname resolves to IPv4 addresses only.</span></span>

 

<span data-ttu-id="571d6-120">Wenn eine Anwendung versucht, eine Verbindung mit einem Ziel mithilfe von IPv6-Adressen herzustellen, tritt Folgendes auf:</span><span class="sxs-lookup"><span data-stu-id="571d6-120">When an application attempts to connect to a destination using IPv6 addresses, the following will occur:</span></span>

-   <span data-ttu-id="571d6-121">Die Anwendung ruft eine Liste der IPv6-Adressen durch Aufrufen der [**getadaptersadressen**](/windows/desktop/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) -API ab.</span><span class="sxs-lookup"><span data-stu-id="571d6-121">The application obtains a list of IPv6 addresses by calling the [**GetAdaptersAddresses**](/windows/desktop/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) API.</span></span> <span data-ttu-id="571d6-122">Der Windows Vista-Stapel gibt eine Liste aller Schnittstellen basierend auf der in [RFC 3484](https://www.irt.org/rfc/rfc3484.htm)angegebenen Sortierreihenfolge zurück.</span><span class="sxs-lookup"><span data-stu-id="571d6-122">The Windows Vista stack returns a list of all interfaces based on the sorting order specified in [RFC 3484](https://www.irt.org/rfc/rfc3484.htm).</span></span> <span data-ttu-id="571d6-123">Daher werden IPv6-und IPv6-zu-IPv4-IPv6-Schnittstellen vor der Teredo-Schnittstelle aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="571d6-123">As a result, IPv6 and 6to4 IPv6 interfaces will be listed before Teredo interface.</span></span> <span data-ttu-id="571d6-124">Wenn jedoch keine systemeigene IPv6-oder IPv6-zu-IPv4-Konnektivität verfügbar ist, ist Teredo die einzige aufgelistete IPv6-fähige Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="571d6-124">However, when native IPv6 or 6to4 connectivity is not available, Teredo will be the only IPv6 capable interface listed.</span></span>

    <span data-ttu-id="571d6-125">Beachten Sie, dass eine Anwendung jede beliebige Schnittstelle verwenden kann, die vom Windows Vista-Stapel bereitgestellt wird. die Reihenfolge der zurückgegebenen Schnittstellen Liste führt jedoch am häufigsten dazu, dass Teredo zuletzt versucht wird.</span><span class="sxs-lookup"><span data-stu-id="571d6-125">It is important to remember that an application can use any interface provided by the Windows Vista stack, however the ordering of the interface list returned will most often result in Teredo being attempted last.</span></span>

-   <span data-ttu-id="571d6-126">Bevor Windows Vista versucht, eine Verbindung über die Teredo-Schnittstelle herzustellen, stellt das Betriebssystem sicher, dass die IPv6-Adresse stabilisiert ist.</span><span class="sxs-lookup"><span data-stu-id="571d6-126">Before Windows Vista attempts a connection over the Teredo interface, the operating system ensures that the IPv6 address has stabilized.</span></span> <span data-ttu-id="571d6-127">Dies erfolgt automatisch für ausgehende Verbindungen und ist keine entscheidende Überlegung für eine Anwendung.</span><span class="sxs-lookup"><span data-stu-id="571d6-127">This is done automatically for outgoing connections and is not a crucial consideration for an application.</span></span> <span data-ttu-id="571d6-128">Wenn die Anwendung die Adress Stabilität gewährleisten muss, kann die [**notifystableunicastipadresssstable**](/windows/desktop/api/netioapi/nf-netioapi-notifystableunicastipaddresstable) -API aufgerufen werden, um sicherzustellen, dass die Teredo-Adresse stabil ist.</span><span class="sxs-lookup"><span data-stu-id="571d6-128">In the event the application is required to guarantee address stability, the [**NotifyStableUnicastIpAddressTable**](/windows/desktop/api/netioapi/nf-netioapi-notifystableunicastipaddresstable) API can be called to ensure that the Teredo address is stable.</span></span>

-   <span data-ttu-id="571d6-129">Eine Teredo-Schnittstelle versucht, eine Verbindung mit einer anderen Teredo-Schnittstelle am Ziel herzustellen.</span><span class="sxs-lookup"><span data-stu-id="571d6-129">A Teredo interface will attempt to connect to another Teredo interface at the destination.</span></span> <span data-ttu-id="571d6-130">Wenn eine Teredo-Schnittstelle nicht vorhanden ist, wird eine Verbindung mit einer nativen oder IPv6-zu-IPv4-Zieladresse über ein Host spezifisches Relay hergestellt.</span><span class="sxs-lookup"><span data-stu-id="571d6-130">If a Teredo interface is not present, a connection is established with a native or 6to4 destination address through a host-specific relay.</span></span>

<span data-ttu-id="571d6-131">Es ist auch möglich, dass Anwendungen, die Verbindungen mit dem Internet initiieren, nicht angeforderten Datenverkehr empfangen.</span><span class="sxs-lookup"><span data-stu-id="571d6-131">It is also possible for applications that initiate connections to the Internet to receive unsolicited traffic.</span></span> <span data-ttu-id="571d6-132">Weitere Informationen finden Sie unter [empfangen von angefordertem Datenverkehr über Teredo](receiving-unsolicited-traffic-over-teredo.md).</span><span class="sxs-lookup"><span data-stu-id="571d6-132">For more details see [Receiving Unsolicited Traffic Over Teredo](receiving-unsolicited-traffic-over-teredo.md).</span></span>

## <a name="using-the-wsaconnectbyname-api"></a><span data-ttu-id="571d6-133">Verwenden der WSAConnectByName-API</span><span class="sxs-lookup"><span data-stu-id="571d6-133">Using the WSAConnectByName API</span></span>

<span data-ttu-id="571d6-134">Durch Aufrufen der WSAConnectByName-API ist es möglich, dass eine Anwendung eine Verbindung mit einem Zielnamen herstellt, anstatt die genaue IP-Adresse anzugeben.</span><span class="sxs-lookup"><span data-stu-id="571d6-134">By calling the WSAConnectByName API, it is possible for an application to connect to a destination name instead of specifying the exact IP address.</span></span> <span data-ttu-id="571d6-135">Der Windows Vista-Stapel bevorzugt IPv6 über IPv4, und daher werden alle Verbindungsversuche zuerst an IPv6-Adressen durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="571d6-135">The Windows Vista stack prefers IPv6 over IPv4, and as a result any connection attempts will be made to IPv6 addresses first.</span></span>

<span data-ttu-id="571d6-136">Durch Aufrufen der WSAConnectByName-API werden alle Ziel-IP-Adressen in der folgenden Reihenfolge sortiert:</span><span class="sxs-lookup"><span data-stu-id="571d6-136">Calling the WSAConnectByName API will sort all destination IP addresses obtained in the following order:</span></span>

-   <span data-ttu-id="571d6-137">Native IPv6-Adresse</span><span class="sxs-lookup"><span data-stu-id="571d6-137">Native IPv6 address</span></span>
-   <span data-ttu-id="571d6-138">IPv6-zu-IPv4 IP-Adresse</span><span class="sxs-lookup"><span data-stu-id="571d6-138">6to4 IP address</span></span>
-   <span data-ttu-id="571d6-139">IPv4-Adresse</span><span class="sxs-lookup"><span data-stu-id="571d6-139">IPv4 address</span></span>
-   <span data-ttu-id="571d6-140">Teredo-Adresse</span><span class="sxs-lookup"><span data-stu-id="571d6-140">Teredo address</span></span>

<span data-ttu-id="571d6-141">Nachdem die Zieladressen intern sortiert wurden, wird eine Verbindung mit dem Ziel basierend auf der am besten verfügbaren Route auf dem lokalen Host für die Zieladresse versucht.</span><span class="sxs-lookup"><span data-stu-id="571d6-141">After the destination addresses are sorted internally, a connection to the destination is attempted based on the best route available on the local host for the destination address.</span></span> <span data-ttu-id="571d6-142">Wie in der Reihenfolge der sortierten Adressen angegeben, wird die IPv4-Adresse verwendet, um die Verbindung herzustellen, wenn der Zielname in eine IPv4-und Teredo-Adresse aufgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="571d6-142">As indicated by the order of the sorted addresses, if the destination name resolves to a IPv4 and Teredo address, the IPv4 address will be used to establish the connection.</span></span>

<span data-ttu-id="571d6-143">Die WSAConnectByName-API arbeitet intern, um die beste Entsprechung zwischen Adressen zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="571d6-143">The WSAConnectByName API works internally to find the best match between addresses.</span></span> <span data-ttu-id="571d6-144">Dieser Versuch basiert auf den Routen, die auf dem lokalen Host und den Zieladressen verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="571d6-144">This attempt is based on the routes available on the local host and the destination addresses.</span></span>

<span data-ttu-id="571d6-145">Aufgrund der aktuellen Abwesenheit von Teredo-Relays im Internet ist es unwahrscheinlich, dass Verbindungen mit nativen IPv6-Adressen über die Teredo-Schnittstelle hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="571d6-145">Due to current absence of Teredo relays on the Internet, connections to native IPv6 addresses are unlikely to succeed over the Teredo interface.</span></span> <span data-ttu-id="571d6-146">Wenn WSAConnectByName aufgerufen wird, gibt Windows Vista keine AAAA-Abfragen aus, wenn Teredo die einzige verfügbare IPv6-fähige Schnittstelle ist.</span><span class="sxs-lookup"><span data-stu-id="571d6-146">If WSAConnectByName is called, Windows Vista will not issue AAAA queries when Teredo is the only IPv6 capable interface available.</span></span> <span data-ttu-id="571d6-147">Dadurch wird sichergestellt, dass systemeigene IPv6-Adressen nicht als Ziel abgerufen werden und dass Verbindungen über IPv4 versucht werden, was die höchste Erfolgschance hat.</span><span class="sxs-lookup"><span data-stu-id="571d6-147">This ensures that native IPv6 addresses are not obtained as a destination and that connections are attempted over IPv4, which has the highest chance of success.</span></span> <span data-ttu-id="571d6-148">Um IPv6-Adressen zu erhalten, wenn Teredo die einzige IPv6-fähige Schnittstelle ist, muss eine Anwendung explizit die DNSQuery-API für AAAA-Datensätze verwenden.</span><span class="sxs-lookup"><span data-stu-id="571d6-148">In order to obtain IPv6 addresses when Teredo is the only IPv6 capable interface, an application must explicitly use the DnsQuery API for AAAA records.</span></span>

 

 