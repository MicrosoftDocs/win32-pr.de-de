---
description: In diesem Thema wird beschrieben, wie Sie Arbeits Warteschlangen in Microsoft Media Foundation verwenden.
ms.assetid: 6be05df7-e8ff-4110-8f73-a62eb31fd414
title: Verwenden von Arbeits Warteschlangen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2d7bb41b830742ca871d44cadac9bd26a9967aa1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104215003"
---
# <a name="using-work-queues"></a><span data-ttu-id="fd7f6-103">Verwenden von Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="fd7f6-103">Using Work Queues</span></span>

<span data-ttu-id="fd7f6-104">In diesem Thema wird beschrieben, wie Sie Arbeits Warteschlangen in Microsoft Media Foundation verwenden.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-104">This topic describes how to use work queues in Microsoft Media Foundation.</span></span>

-   [<span data-ttu-id="fd7f6-105">Verwenden von Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="fd7f6-105">Using Work Queues</span></span>](#using-work-queues)
-   [<span data-ttu-id="fd7f6-106">Herunterfahren von Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="fd7f6-106">Shutting Down Work Queues</span></span>](#shutting-down-work-queues)
-   [<span data-ttu-id="fd7f6-107">Verwenden geplanter Arbeitselemente</span><span class="sxs-lookup"><span data-stu-id="fd7f6-107">Using Scheduled Work Items</span></span>](#using-scheduled-work-items)
-   [<span data-ttu-id="fd7f6-108">Verwenden regelmäßiger Rückrufe</span><span class="sxs-lookup"><span data-stu-id="fd7f6-108">Using Periodic Callbacks</span></span>](#using-periodic-callbacks)
-   [<span data-ttu-id="fd7f6-109">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="fd7f6-109">Related topics</span></span>](#related-topics)

## <a name="using-work-queues"></a><span data-ttu-id="fd7f6-110">Verwenden von Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="fd7f6-110">Using Work Queues</span></span>

<span data-ttu-id="fd7f6-111">Eine Arbeits Warteschlange ist eine effiziente Möglichkeit, um asynchrone Vorgänge in einem anderen Thread auszuführen.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-111">A work queue is an efficient way to perform asynchronous operations on another thread.</span></span> <span data-ttu-id="fd7f6-112">Konzeptionell werden Arbeitselemente in die Warteschlange eingefügt, und die Warteschlange verfügt über einen Thread, der jedes Element aus der Warteschlange abruft und sendet.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-112">Conceptually, you put work items in the queue, and the queue has a thread that pulls each item from the queue and dispatches it.</span></span> <span data-ttu-id="fd7f6-113">Arbeitselemente werden mithilfe der [**imfasynccallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) -Schnittstelle als Rückrufe implementiert.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-113">Work items are implemented as callbacks by using the [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) interface.</span></span>

<span data-ttu-id="fd7f6-114">Media Foundation erstellt mehrere standardmäßige Arbeits Warteschlangen, die als *Platform Work Queues* bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-114">Media Foundation creates several standard work queues, called *platform work queues*.</span></span> <span data-ttu-id="fd7f6-115">Anwendungen können auch eigene Arbeits Warteschlangen erstellen, die als *private Arbeits Warteschlangen* bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-115">Applications can also create their own work queues, called *private work queues*.</span></span> <span data-ttu-id="fd7f6-116">Eine Liste der Platt Form Arbeitswarteschlangen finden Sie unter Bezeichner für [Arbeits](work-queue-identifiers.md)Warteschlangen.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-116">For a list of the platform work queues, see [Work Queue Identifiers](work-queue-identifiers.md).</span></span> <span data-ttu-id="fd7f6-117">Um eine private Arbeits Warteschlange zu erstellen, rufen Sie [**mfbelegcateworkqueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue)auf.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-117">To create a private work queue, call [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue).</span></span> <span data-ttu-id="fd7f6-118">Diese Funktion gibt einen Bezeichner für die neue Arbeits Warteschlange zurück.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-118">This function returns an identifier for the new work queue.</span></span> <span data-ttu-id="fd7f6-119">Um ein Element in die Warteschlange einzufügen, nennen Sie [**mfputworkitem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) oder [**mfputworkitemex**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span><span class="sxs-lookup"><span data-stu-id="fd7f6-119">To put an item in the queue, call [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) or [**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span></span> <span data-ttu-id="fd7f6-120">In beiden Fällen müssen Sie eine Rückruf Schnittstelle angeben.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-120">In both cases, you must specify a callback interface.</span></span>

-   <span data-ttu-id="fd7f6-121">[**Mfputworkitem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) nimmt einen Zeiger auf die [**imfasynccallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) -Schnittstelle sowie ein optionales Zustands Objekt an, das **IUnknown** implementiert.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-121">[**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) takes a pointer to the [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) interface, plus an optional state object that implements **IUnknown**.</span></span> <span data-ttu-id="fd7f6-122">Dabei handelt es sich um dieselben Parameter, die in asynchronen Methoden verwendet werden, wie im Thema [asynchrone Rückruf Methoden](asynchronous-callback-methods.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-122">These are the same parameters used in asynchronous methods, as described in the topic [Asynchronous Callback Methods](asynchronous-callback-methods.md).</span></span> <span data-ttu-id="fd7f6-123">Intern erstellt diese Funktion ein asynchrones Ergebnis Objekt, das an die [**Aufruf**](/windows/desktop/api/mfobjects/nf-mfobjects-imfasynccallback-invoke) Methode des Rückrufs übermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-123">Internally, this function creates an asynchronous result object, which is passed to the callback's [**Invoke**](/windows/desktop/api/mfobjects/nf-mfobjects-imfasynccallback-invoke) method.</span></span>
-   <span data-ttu-id="fd7f6-124">[**Mfputworkitemex**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex) übernimmt einen Zeiger auf die [**imfasynkresult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-124">[**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex) takes a pointer to the [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) interface.</span></span> <span data-ttu-id="fd7f6-125">Diese Schnittstelle stellt ein asynchrones Ergebnis Objekt dar.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-125">This interface represents an asynchronous result object.</span></span> <span data-ttu-id="fd7f6-126">Erstellen Sie dieses Objekt, indem Sie [**mfcreateasyncresult**](/windows/desktop/api/mfapi/nf-mfapi-mfcreateasyncresult) aufrufen und die Rückruf Schnittstelle und optional ein Zustands Objekt angeben.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-126">Create this object by calling [**MFCreateAsyncResult**](/windows/desktop/api/mfapi/nf-mfapi-mfcreateasyncresult) and specifying your callback interface and, optionally, a state object.</span></span>

<span data-ttu-id="fd7f6-127">In beiden Fällen ruft der Arbeits Warteschlangen Thread Ihre [**imfasynccallback:: Aufrufen**](/windows/desktop/api/mfobjects/nf-mfobjects-imfasynccallback-invoke) -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-127">In both cases, the work queue thread calls your [**IMFAsyncCallback::Invoke**](/windows/desktop/api/mfobjects/nf-mfobjects-imfasynccallback-invoke) method.</span></span> <span data-ttu-id="fd7f6-128">Verwenden Sie die Methode " **aufrufen** ", um das Arbeits Element auszuführen.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-128">Use the **Invoke** method to perform the work item.</span></span>

<span data-ttu-id="fd7f6-129">Wenn mehr als ein Thread oder eine Komponente dieselbe Arbeits Warteschlange gemeinsam verwendet, können Sie [**mflockworkqueue**](/windows/desktop/api/mfapi/nf-mfapi-mflockworkqueue) zum Sperren der Arbeits Warteschlange anrufen, wodurch die Plattform nicht freigegeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-129">If more than one thread or component shares the same work queue, you can call [**MFLockWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mflockworkqueue) to lock the work queue, which prevents the platform from releasing it.</span></span> <span data-ttu-id="fd7f6-130">Sie müssen für jeden [**mfbelegcateworkqueue-mfbelegungsqueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) -Befehl oder **mflockworkqueue**-Befehl einmal [**mfunlockworkqueue**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockworkqueue) abrufen, um die Arbeits Warteschlange freizugeben.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-130">For each call to [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) or **MFLockWorkQueue**, you must call [**MFUnlockWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockworkqueue) once to release the work queue.</span></span> <span data-ttu-id="fd7f6-131">Wenn Sie z. b. eine neue Arbeits Warteschlange erstellen und diese dann einmal sperren, müssen Sie **mfunlockworkqueue** zweimal (einmal für den **mfbelegcateworkqueue** -Aufrufvorgang und einmal für den **mflockworkqueue**-Aufrufvorgang) aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-131">For example, if you create a new work queue and then lock it once, you must call **MFUnlockWorkQueue** twice, once for the call to **MFAllocateWorkQueue** and once for the call to **MFLockWorkQueue**.</span></span>

<span data-ttu-id="fd7f6-132">Der folgende Code zeigt, wie Sie eine neue Arbeits Warteschlange erstellen, eine Arbeitsaufgabe in die Warteschlange stellen und die Arbeits Warteschlange freigeben.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-132">The following code shows how to create a new work queue, put a work item in the queue, and release the work queue.</span></span>

<span data-ttu-id="fd7f6-133">Weitere Informationen zu Arbeits Warteschlangen in Windows 8 finden Sie unter [Verbesserungen der Arbeits Warteschlange und Threading](media-foundation-work-queue-and-threading-improvements.md)</span><span class="sxs-lookup"><span data-stu-id="fd7f6-133">See [Work Queue and Threading Improvements](media-foundation-work-queue-and-threading-improvements.md) for additional information on work queues in Windows 8.</span></span>


```C++
DWORD idWorkQueue = 0;
HRESULT hr = S_OK;

// Create a new work queue.
hr = MFAllocateWorkQueue(&idWorkQueue);

// Put an item on the queue.
if (SUCCEEDED(hr))
{
    hr = MFPutWorkItem(idWorkQueue, pCallback, NULL);
}

// Wait for the callback to be invoked.
if (SUCCEEDED(hr))
{
    WaitForSingleObject(hEvent, INFINITE);
}

// Release the work queue.
if (SUCCEEDED(hr))
{
    hr = MFUnlockWorkQueue(idWorkQueue);
}
```



<span data-ttu-id="fd7f6-134">In diesem Beispiel wird davon ausgegangen, dass *pCallback* ein Zeiger auf die [**imfasynccallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) -Schnittstelle der Anwendung ist.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-134">This example assumes that *pCallback* is a pointer to the application's [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) interface.</span></span> <span data-ttu-id="fd7f6-135">Außerdem wird davon ausgegangen, dass der Rückruf das *hevent* -Ereignis handle festlegt.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-135">It also assumes that the callback sets the *hEvent* event handle.</span></span> <span data-ttu-id="fd7f6-136">Der Code wartet, bis dieses Ereignis festgelegt wird, bevor [**mfunlockworkqueue**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockworkqueue)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-136">The code waits for this event to be set before calling [**MFUnlockWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockworkqueue).</span></span>

<span data-ttu-id="fd7f6-137">Arbeitswarteschlangen-Threads werden immer im Prozess des Aufrufers erstellt.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-137">Work queue threads are always created in the caller's process.</span></span> <span data-ttu-id="fd7f6-138">Innerhalb der einzelnen Arbeits Warteschlangen werden die Rückrufe serialisiert.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-138">Within each work queue, the callbacks are serialized.</span></span> <span data-ttu-id="fd7f6-139">Wenn Sie [**mfputworkitem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) zweimal mit derselben Arbeits Warteschlange aufrufen, wird der zweite Rückruf erst aufgerufen, wenn der erste Rückruf zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-139">If you call [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) twice with the same work queue, the second callback is not invoked until the first callback has returned.</span></span>

## <a name="shutting-down-work-queues"></a><span data-ttu-id="fd7f6-140">Herunterfahren von Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="fd7f6-140">Shutting Down Work Queues</span></span>

<span data-ttu-id="fd7f6-141">Geben Sie vor dem Aufrufen von [**mfshutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown)alle Ressourcen frei, die von Arbeitsthreads verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-141">Before calling [**MFShutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown), release any resources that are being used by work queue threads.</span></span> <span data-ttu-id="fd7f6-142">Um diesen Prozess zu synchronisieren, können Sie die Media Foundation Plattform sperren, wodurch verhindert wird, dass die **mfshutdown** -Funktion alle Arbeitswarteschlangen-Threads schließt.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-142">To synchronize this process, you can lock the Media Foundation platform, which prevents the **MFShutdown** function from closing any work queue threads.</span></span> <span data-ttu-id="fd7f6-143">Wenn **mfshutdown** aufgerufen wird, während die Plattform gesperrt ist, wartet **mfshutdown** einige hundert Millisekunden, bis die Plattform entsperrt wird.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-143">If **MFShutdown** is called while the platform is locked, **MFShutdown** waits a few hundred milliseconds for the platform to be unlocked.</span></span> <span data-ttu-id="fd7f6-144">Wenn Sie nicht innerhalb dieser Zeit entsperrt wird, schließt **MF Shutdown** die Arbeitswarteschlangen-Threads.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-144">If it is not unlocked within that time, **MFShutdown** closes the work queue threads.</span></span>

<span data-ttu-id="fd7f6-145">Die Standard Implementierung von [**imfasynkresult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) sperrt die Media Foundation Plattform automatisch, wenn das Ergebnis Objekt erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-145">The default implementation of [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) automatically locks the Media Foundation platform when the result object is created.</span></span> <span data-ttu-id="fd7f6-146">Das Freigeben der-Schnittstelle entsperrt die-Plattform.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-146">Releasing the interface unlocks the platform.</span></span> <span data-ttu-id="fd7f6-147">Daher müssen Sie die Plattform fast niemals direkt sperren.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-147">Therefore, you will almost never need to lock the platform directly.</span></span> <span data-ttu-id="fd7f6-148">Wenn Sie jedoch eine eigene benutzerdefinierte Implementierung von **imfasynkresult** schreiben, sollten Sie die Plattform manuell sperren und entsperren.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-148">But if you write your own custom implementation of **IMFAsyncResult**, then you should manually lock and unlock the platform.</span></span> <span data-ttu-id="fd7f6-149">Um die Plattform zu sperren, nennen Sie [**mflockplatform**](/windows/desktop/api/mfapi/nf-mfapi-mflockplatform).</span><span class="sxs-lookup"><span data-stu-id="fd7f6-149">To lock the platform, call [**MFLockPlatform**](/windows/desktop/api/mfapi/nf-mfapi-mflockplatform).</span></span> <span data-ttu-id="fd7f6-150">Um die Plattform zu entsperren, nennen Sie [**mfunlockplatform**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockplatform).</span><span class="sxs-lookup"><span data-stu-id="fd7f6-150">To unlock the platform, call [**MFUnlockPlatform**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockplatform).</span></span> <span data-ttu-id="fd7f6-151">Ein Beispiel finden Sie unter [benutzerdefinierte asynchrone Ergebnis Objekte](custom-asynchronous-result-objects.md).</span><span class="sxs-lookup"><span data-stu-id="fd7f6-151">For an example, see [Custom Asynchronous Result Objects](custom-asynchronous-result-objects.md).</span></span>

<span data-ttu-id="fd7f6-152">Nachdem Sie [**mfshutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown)aufgerufen haben, müssen Sie sicherstellen, dass die Plattform innerhalb des 5-Sekunden-Timeout Zeitraums entsperrt wird.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-152">After you call [**MFShutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown), you need to ensure that the platform is unlocked within the 5-second time-out period.</span></span> <span data-ttu-id="fd7f6-153">Veröffentlichen Sie dazu alle [**imfasyncresult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) -Zeiger, und rufen Sie [**mfunlockplatform**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockplatform) auf, wenn Sie die Plattform manuell gesperrt haben.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-153">Do this by releasing all [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) pointers, and by calling [**MFUnlockPlatform**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockplatform) if you locked the platform manually.</span></span> <span data-ttu-id="fd7f6-154">Stellen Sie sicher, dass alle Ressourcen freigegeben werden, die von Arbeitswarteschlangen-Threads verwendet werden, oder die Anwendung kann Speicher Verluste.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-154">Make sure to release any resources that are being used by work queue threads, or your application might leak memory.</span></span>

<span data-ttu-id="fd7f6-155">Wenn Ihre Anwendung in der Regel vor dem Aufruf von [**mfshutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown)alle Media Foundation Objekte herunterfährt und freigibt, müssen Sie sich keine Gedanken über das Sperren machen.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-155">Typically, if your application shuts down and releases every Media Foundation object before calling [**MFShutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown), you do not have to worry about locking.</span></span> <span data-ttu-id="fd7f6-156">Mit dem Sperrmechanismus können Arbeitswarteschlangen-Threads einfach ordnungsgemäß beendet werden, nachdem Sie **mfshutdown** aufgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-156">The locking mechanism simply allows work queue threads to exit gracefully after you call **MFShutdown**.</span></span>

## <a name="using-scheduled-work-items"></a><span data-ttu-id="fd7f6-157">Verwenden geplanter Arbeitselemente</span><span class="sxs-lookup"><span data-stu-id="fd7f6-157">Using Scheduled Work Items</span></span>

<span data-ttu-id="fd7f6-158">Sie können einen Rückruf so planen, dass er nach einer festgelegten Zeitspanne durch Aufrufen von [**mfscheduleworkitem**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitem) oder [**mfscheduleworkitemex**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitemex)auftritt.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-158">You can schedule a callback to occur after a set period of time by calling [**MFScheduleWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitem) or [**MFScheduleWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitemex).</span></span>

-   <span data-ttu-id="fd7f6-159">[**Mfscheduleworkitem**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitem) nimmt einen Zeiger auf Ihren Rückruf, ein optionales Zustands Objekt und ein Timeout Intervall an.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-159">[**MFScheduleWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitem) takes a pointer to your callback, an optional state object, and a time-out interval.</span></span>
-   <span data-ttu-id="fd7f6-160">[**Mfscheduleworkitemex**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitemex) übernimmt einen Zeiger auf ein asynchrones Ergebnis Objekt und einen Timeout Wert.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-160">[**MFScheduleWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitemex) takes a pointer to an asynchronous result object and a time-out value.</span></span>

<span data-ttu-id="fd7f6-161">Geben Sie das Timeout als negativen Wert in Millisekunden an.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-161">Specify the time-out as a negative value in milliseconds.</span></span> <span data-ttu-id="fd7f6-162">Wenn Sie z. b. einen Rückruf innerhalb von 5 Sekunden planen möchten, verwenden Sie den Wert − 5000.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-162">For example, to schedule a callback to be invoked in 5 seconds, use the value −5000.</span></span> <span data-ttu-id="fd7f6-163">Beide Funktionen geben einen **mfworkitem- \_ Schlüssel** Wert zurück, den Sie verwenden können, um den Rückruf abzubrechen, indem Sie ihn an die [**mfcancelworkitem**](/windows/desktop/api/mfapi/nf-mfapi-mfcancelworkitem) -Funktion übergeben.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-163">Both functions return an **MFWORKITEM\_KEY** value, which you can use to cancel the callback by passing it to the [**MFCancelWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfcancelworkitem) function.</span></span>

<span data-ttu-id="fd7f6-164">Für geplante Arbeitsaufgaben wird immer die Arbeits Warteschlange "mfasync- \_ Rückruf Warteschlange" verwendet \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="fd7f6-164">Scheduled work items always use the MFASYNC\_CALLBACK\_QUEUE\_TIMER platform work queue.</span></span>

## <a name="using-periodic-callbacks"></a><span data-ttu-id="fd7f6-165">Verwenden regelmäßiger Rückrufe</span><span class="sxs-lookup"><span data-stu-id="fd7f6-165">Using Periodic Callbacks</span></span>

<span data-ttu-id="fd7f6-166">Die [**mfaddperiodiccallback**](/windows/desktop/api/mfapi/nf-mfapi-mfaddperiodiccallback) -Funktion plant, dass ein Rückruf regelmäßig aufgerufen wird, bis Sie ihn abbrechen.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-166">The [**MFAddPeriodicCallback**](/windows/desktop/api/mfapi/nf-mfapi-mfaddperiodiccallback) function schedules a callback to be invoked periodically until you cancel it.</span></span> <span data-ttu-id="fd7f6-167">Das Rückruf Intervall ist korrigiert. Anwendungen können diese nicht ändern.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-167">The callback interval is fixed; applications cannot change it.</span></span> <span data-ttu-id="fd7f6-168">Um das exakte Intervall zu ermitteln, müssen Sie [**mfgettimerperiodicity**](/windows/desktop/api/mfapi/nf-mfapi-mfgettimerperiodicity)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-168">To find out the exact interval, call [**MFGetTimerPeriodicity**](/windows/desktop/api/mfapi/nf-mfapi-mfgettimerperiodicity).</span></span> <span data-ttu-id="fd7f6-169">Das Intervall liegt in der Reihenfolge von 10 Millisekunden. diese Funktion ist daher für Situationen gedacht, in denen Sie einen häufigen "Tick" benötigen, z. b. die Implementierung einer Präsentations Uhr.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-169">The interval is on the order of 10 milliseconds, so this function is meant for situations where you need a frequent "tick," such as implementing a presentation clock.</span></span> <span data-ttu-id="fd7f6-170">Wenn Sie planen möchten, dass ein Vorgang seltener auftritt, verwenden Sie ein geplantes Arbeits Element, wie zuvor beschrieben.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-170">If you want to schedule an operation to occur less frequently, use a scheduled work item, as described previously.</span></span>

<span data-ttu-id="fd7f6-171">Im Gegensatz zu den anderen in diesem Thema beschriebenen Rückrufe verwendet der periodische Rückruf nicht die [**imfasynccallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-171">Unlike the other callbacks described in this topic, the periodic callback does not use the [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) interface.</span></span> <span data-ttu-id="fd7f6-172">Stattdessen wird ein Funktionszeiger verwendet.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-172">Instead, it uses a function pointer.</span></span> <span data-ttu-id="fd7f6-173">Weitere Informationen finden Sie unter [**MF-Rückruf**](/windows/win32/api/mfapi/nc-mfapi-mfperiodiccallback).</span><span class="sxs-lookup"><span data-stu-id="fd7f6-173">For more information, see [**MFPERIODICCALLBACK Callback**](/windows/win32/api/mfapi/nc-mfapi-mfperiodiccallback).</span></span>

<span data-ttu-id="fd7f6-174">Um den periodischen Rückruf abzubrechen, rufen Sie [**mfremoveperiodiccallback**](/windows/desktop/api/mfapi/nf-mfapi-mfremoveperiodiccallback)auf.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-174">To cancel the periodic callback, call [**MFRemovePeriodicCallback**](/windows/desktop/api/mfapi/nf-mfapi-mfremoveperiodiccallback).</span></span>

<span data-ttu-id="fd7f6-175">Periodische Rückrufe verwenden die mfasync-Rückruf Warteschlange für die Zeit Geber \_ \_ \_ Plattform.</span><span class="sxs-lookup"><span data-stu-id="fd7f6-175">Periodic callbacks use the MFASYNC\_CALLBACK\_QUEUE\_TIMER platform work queue.</span></span>

## <a name="related-topics"></a><span data-ttu-id="fd7f6-176">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="fd7f6-176">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fd7f6-177">Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="fd7f6-177">Work Queues</span></span>](work-queues.md)
</dt> <dt>

[<span data-ttu-id="fd7f6-178">**Mfasynkresult**</span><span class="sxs-lookup"><span data-stu-id="fd7f6-178">**MFASYNCRESULT**</span></span>](/windows/win32/api/mfapi/ns-mfapi-mfasyncresult)
</dt> <dt>

[<span data-ttu-id="fd7f6-179">Arbeits Warteschlangen und Threading</span><span class="sxs-lookup"><span data-stu-id="fd7f6-179">Work Queue and Threading Improvements</span></span>](media-foundation-work-queue-and-threading-improvements.md)
</dt> </dl>

 

 
