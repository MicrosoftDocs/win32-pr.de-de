---
description: Konfigurieren der Video Codierung
ms.assetid: 917600f5-5580-4ca5-bce9-70eadec40df7
title: Konfigurieren der Video Codierung (Microsoft Media Foundation)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8bd82240ea9f540f283e0fb6340c06be00336226
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104127949"
---
# <a name="configuring-video-encoding-microsoft-media-foundation"></a><span data-ttu-id="74669-103">Konfigurieren der Video Codierung (Microsoft Media Foundation)</span><span class="sxs-lookup"><span data-stu-id="74669-103">Configuring Video Encoding (Microsoft Media Foundation)</span></span>

<span data-ttu-id="74669-104">Um den Video Encoder zu konfigurieren, führen Sie die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="74669-104">To configure the video encoder, perform the following steps:</span></span>

1.  <span data-ttu-id="74669-105">Legen Sie mithilfe von **IPropertyBag:: Write** alle Eigenschaften für den Encoder DMO fest.</span><span class="sxs-lookup"><span data-stu-id="74669-105">Set any properties on the encoder DMO by using **IPropertyBag::Write**.</span></span> <span data-ttu-id="74669-106">In der folgenden Liste wird der minimale Satz von Eigenschaften zusammengefasst, die zum Codieren eines CBR-Videostreams erforderlich sind (alle diese Werte haben Standardwerte, die verwendet werden können):</span><span class="sxs-lookup"><span data-stu-id="74669-106">The following list summarizes the minimum set of properties that are required to encode a CBR video stream (all of these values have defaults that can be used):</span></span>

    -   <span data-ttu-id="74669-107">Die[mfpkey \_ videowindow](mfpkey-videowindowproperty.md) -Eigenschaft gibt das Puffer Fenster an, das für den Datenstrom verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="74669-107">The[MFPKEY\_VIDEOWINDOW](mfpkey-videowindowproperty.md) property specifies the buffer window to use for the stream.</span></span> <span data-ttu-id="74669-108">Weitere Informationen zur Einstellung "Buffer Windows" und deren Auswirkungen auf den Inhalt finden Sie unter [Codierungs Methoden](encodingmethods.md).</span><span class="sxs-lookup"><span data-stu-id="74669-108">For more information about the buffer windows setting and how it affects content, see [Encoding Methods](encodingmethods.md).</span></span> <span data-ttu-id="74669-109">Das Standard Puffer Fenster beträgt drei Sekunden, was für viele Szenarien geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="74669-109">The default buffer window is three seconds, which is appropriate for many scenarios.</span></span>
    -   <span data-ttu-id="74669-110">Die Video Komplexität ist so festgelegt, dass der Kompromiss zwischen der Qualität des codierten Inhalts und der Zeit, die zum Codieren erforderlich ist, festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="74669-110">Video complexity is set to determine the tradeoff between the quality of the encoded content and the time that is required to encode.</span></span> <span data-ttu-id="74669-111">Wenn Sie keinen Wert festlegen, wird der Standardwert verwendet.</span><span class="sxs-lookup"><span data-stu-id="74669-111">If you do not set a value, the default value is used.</span></span> <span data-ttu-id="74669-112">Sie können jedoch die empfohlenen Modi für einen bestimmten Codec ermitteln, indem Sie [iwmcodec-Eigenschaften:: getcodecprop](/windows/desktop/api/wmcodecdsp/nf-wmcodecdsp-iwmcodecprops-getcodecprop) aufrufen, um g \_ wszwmvccomplexityexlive, g \_ wszwmvccomplexityexoffline und g \_ wszwmvccomplexityexmax abzurufen.</span><span class="sxs-lookup"><span data-stu-id="74669-112">However, you can find the recommended modes for a specific codec by calling [IWMCodecProps::GetCodecProp](/windows/desktop/api/wmcodecdsp/nf-wmcodecdsp-iwmcodecprops-getcodecprop) to retrieve g\_wszWMVCComplexityExLive, g\_wszWMVCComplexityExOffline, and g\_wszWMVCComplexityExMax.</span></span> <span data-ttu-id="74669-113">Anschließend können Sie [mfpkey \_ complexityex](mfpkey-complexityexproperty.md) auf einen Wert zwischen 0 und der gemeldeten maximalen Komplexität festlegen.</span><span class="sxs-lookup"><span data-stu-id="74669-113">Then you can set [MFPKEY\_COMPLEXITYEX](mfpkey-complexityexproperty.md) to a value between 0 and the reported maximum complexity.</span></span>
    -   <span data-ttu-id="74669-114">[Mfpkey \_ Mit Crisp](mfpkey-crispproperty.md) wird die relative Wichtigkeit der Video Glätte und die Bildqualität codierter Frames angegeben.</span><span class="sxs-lookup"><span data-stu-id="74669-114">[MFPKEY\_CRISP](mfpkey-crispproperty.md) specifies the relative importance of video smoothness and the image quality of encoded frames.</span></span> <span data-ttu-id="74669-115">In den meisten Fällen funktioniert der Standardwert einwandfrei.</span><span class="sxs-lookup"><span data-stu-id="74669-115">In most cases, the default value works fine.</span></span>
    -   <span data-ttu-id="74669-116">Für Videoinhalte, die in einem anderen Container als "ASF" gespeichert sind, muss die Eigenschaft " [mfpkey \_ asfoverheadperframe](mfpkey-asfoverheadperframeproperty.md) " auf "0" festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="74669-116">For video content stored in a container other than ASF, the [MFPKEY\_ASFOVERHEADPERFRAME](mfpkey-asfoverheadperframeproperty.md) property must be set to 0.</span></span> <span data-ttu-id="74669-117">Dies ist nicht der Standardwert.</span><span class="sxs-lookup"><span data-stu-id="74669-117">This is not the default value.</span></span>

    <span data-ttu-id="74669-118">Weitere Informationen zum Konfigurieren von VBR-Streams finden [Sie unter Verwenden der VBR-Codierung](usingvbrencoding.md).</span><span class="sxs-lookup"><span data-stu-id="74669-118">For information about configuring VBR streams, see [Using VBR Encoding](usingvbrencoding.md).</span></span>

2.  <span data-ttu-id="74669-119">Konfigurieren Sie die [**DMO- \_ \_ Medientyp**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) Struktur für den Eingabetyp, oder verwenden Sie bei Verwendung des Media Foundation SDK die Funktion [**mfinitmediatypfromvideoinfoheader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader) .</span><span class="sxs-lookup"><span data-stu-id="74669-119">Configure the [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure for the input type, or if you are using the Media Foundation SDK, use the [**MFInitMediaTypeFromVideoInfoHeader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader) function.</span></span> <span data-ttu-id="74669-120">Verwenden Sie eine [**videoinfoheader**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) -Struktur, die den unkomprimierten Eingabe Inhalt beschreibt.</span><span class="sxs-lookup"><span data-stu-id="74669-120">Use a [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) structure describing the uncompressed input content.</span></span> <span data-ttu-id="74669-121">Der Codec ändert nicht die Größe des Videos oder konvertiert den Farb Raum.</span><span class="sxs-lookup"><span data-stu-id="74669-121">The codec does not resize video or convert the color space.</span></span>
3.  <span data-ttu-id="74669-122">Legen Sie den Eingabetyp mithilfe von [**imediaobject:: setinputtype**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype) oder [**IMF Transform:: setinputtype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype)fest.</span><span class="sxs-lookup"><span data-stu-id="74669-122">Set the input type using [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype) or [**IMFTransform::SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype).</span></span>
4.  <span data-ttu-id="74669-123">Konfigurieren Sie den Ausgabetyp für den Encoder.</span><span class="sxs-lookup"><span data-stu-id="74669-123">Configure the output type for the encoder.</span></span> <span data-ttu-id="74669-124">Nachdem der Eingabetyp festgelegt wurde, listet der Encoder die ausgegebene Ausgabetypen auf, ausgenommen den **dwbitrate** -Member der [**videoinfoheader**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) -Struktur oder das [**MF \_ MT \_ AVG- \_ Bitrate**](mf-mt-avg-bitrate-attribute.md) -Attribut der [**imfmediatype**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediatype) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="74669-124">After the input type is set, the encoder enumerates output types that are complete except for the **dwBitrate** member of the [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) structure, or the [**MF\_MT\_AVG\_BITRATE**](mf-mt-avg-bitrate-attribute.md) attribute of the [**IMFMediaType**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediatype) interface.</span></span> <span data-ttu-id="74669-125">Wenn Sie einen Ausgabetyp abrufen, bevor Sie einen Eingabetyp festlegen, wird der übermittelten [**DMO- \_ \_ Medientyp**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) Struktur kein **videoinfoheader** zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="74669-125">If you retrieve an output type before setting an input type, the delivered [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure will not have an associated **VIDEOINFOHEADER**.</span></span>
5.  <span data-ttu-id="74669-126">Rufen Sie die privaten Codec-Daten ab, und fügen Sie Sie an die [**videoinfoheader**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) -Struktur an, die Sie an die [**DMO- \_ \_ Medientyp**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) Struktur oder an [**imfmediatype**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediatype)übergeben.</span><span class="sxs-lookup"><span data-stu-id="74669-126">Retrieve the codec private data and append it to the [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) structure that you pass to the [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure or to [**IMFMediaType**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediatype).</span></span> <span data-ttu-id="74669-127">Weitere Informationen finden Sie unter [Verwenden von privaten Videocodec-Daten](usingvideocodecprivatedata.md).</span><span class="sxs-lookup"><span data-stu-id="74669-127">For more information, see [Using Video Codec Private Data](usingvideocodecprivatedata.md).</span></span>
6.  <span data-ttu-id="74669-128">Legen Sie den Ausgabetyp fest, indem Sie die [**imediaobject:: setoutputtype**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype) -Methode oder die [**imftransform:: setoutputtype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="74669-128">Set the output type by calling the [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype) or [**IMFTransform::SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype) method.</span></span> <span data-ttu-id="74669-129">Übergeben Sie entweder die [**DMO- \_ \_ Medientyp**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) Struktur mit der abgeschlossenen [**videoinfoheader**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) -Struktur (einschließlich angefügter privater Daten), auf die im **pbformat** -Member verwiesen wird, oder erstellen Sie einen [**imfmediatype**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediatype) durch Aufrufen von [**mfinitmediatypfromvideoinfoheader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader).</span><span class="sxs-lookup"><span data-stu-id="74669-129">Either pass the [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure with the completed [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) structure (including appended private data) referenced in the **pbFormat** member, or construct an [**IMFMediaType**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediatype) by calling [**MFInitMediaTypeFromVideoInfoHeader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader).</span></span>

> [!Note]  
> <span data-ttu-id="74669-130">Das Video Encoder-Objekt unterstützt zwei Ausgaben.</span><span class="sxs-lookup"><span data-stu-id="74669-130">The video encoder object supports two outputs.</span></span> <span data-ttu-id="74669-131">Die zweite Ausgabe ist für den Encoder "Post View".</span><span class="sxs-lookup"><span data-stu-id="74669-131">The second output is for encoder "post view".</span></span> <span data-ttu-id="74669-132">Es werden die nicht komprimierten Beispiele bereitgestellt, die vom Decoder übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="74669-132">It delivers the uncompressed samples as they will be delivered from the decoder.</span></span> <span data-ttu-id="74669-133">Dies ermöglicht es Ihnen, die Qualität der Codierung zu überwachen, ohne zu warten, bis der gesamte Stream verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="74669-133">This enables you to monitor the quality of the encoding without having to wait until the entire stream is processed.</span></span> <span data-ttu-id="74669-134">Diese Ausgabe ist optional.</span><span class="sxs-lookup"><span data-stu-id="74669-134">This output is optional.</span></span> <span data-ttu-id="74669-135">Wenn Sie diese verwenden möchten, konfigurieren Sie Ihren Typ nach dem gleichen Prozess, der auch zum Festlegen des encodereingabetyps verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="74669-135">If you want to use it, configure its type following the same process used to set the encoder input type.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="74669-136">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="74669-136">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="74669-137">Arbeiten mit Videos</span><span class="sxs-lookup"><span data-stu-id="74669-137">Working with Video</span></span>](workingwithvideo.md)
</dt> </dl>

 

 
