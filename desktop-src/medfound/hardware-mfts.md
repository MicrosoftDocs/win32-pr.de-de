---
description: In diesem Thema wird beschrieben, wie eine Media Foundation Transformation (MFT) geschrieben wird, die als Proxy für einen Hardware Encoder, Decoder oder einen Port (Digital Signal Processor, DSP) fungiert.
ms.assetid: 9922d403-5d0d-433f-ad9f-c86142ac0f46
title: Hardware-MFTs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ac5ce05b4fdad6040b51f66f543c1737fc3918d2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104214966"
---
# <a name="hardware-mfts"></a><span data-ttu-id="e71f5-103">Hardware-MFTs</span><span class="sxs-lookup"><span data-stu-id="e71f5-103">Hardware MFTs</span></span>

> [!Note]  
> <span data-ttu-id="e71f5-104">Dieses Thema gilt für Windows 7 oder höher.</span><span class="sxs-lookup"><span data-stu-id="e71f5-104">This topic applies to Windows 7 or later.</span></span>

 

<span data-ttu-id="e71f5-105">In diesem Thema wird beschrieben, wie eine Media Foundation Transformation (MFT) geschrieben wird, die als Proxy für einen Hardware Encoder, Decoder oder einen Port (Digital Signal Processor, DSP) fungiert.</span><span class="sxs-lookup"><span data-stu-id="e71f5-105">This topic describes how to write a Media Foundation transform (MFT) that acts as a proxy to a hardware encoder, decoder, or digital signal processor (DSP).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e71f5-106">Wenn ein Hardware Codec den AVStream-Multimedia-Klassen Treiber verwendet, ist kein benutzerdefiniertes MFT erforderlich.</span><span class="sxs-lookup"><span data-stu-id="e71f5-106">If a hardware codec uses the AVStream multimedia class driver, it does not require a custom MFT.</span></span> <span data-ttu-id="e71f5-107">Media Foundation stellt zu diesem Zweck einen AVStream-Proxy bereit.</span><span class="sxs-lookup"><span data-stu-id="e71f5-107">Media Foundation provides an AVStream proxy for this purpose.</span></span> <span data-ttu-id="e71f5-108">Die Informationen in diesem Thema gelten nur für Sonderfälle, in denen der Hardware Codec AVStream nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="e71f5-108">The information in this topic applies only in the special case where the hardware codec does not use AVStream.</span></span> <span data-ttu-id="e71f5-109">Weitere Informationen finden Sie [unter Unterstützung für Hardware Codec in AVStream](https://msdn.microsoft.com/library/dd568169.aspx).</span><span class="sxs-lookup"><span data-stu-id="e71f5-109">For more information, see [Hardware Codec Support in AVStream](https://msdn.microsoft.com/library/dd568169.aspx).</span></span>

 

<span data-ttu-id="e71f5-110">Dieses Thema enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="e71f5-110">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="e71f5-111">Introduction (Einführung)</span><span class="sxs-lookup"><span data-stu-id="e71f5-111">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="e71f5-112">Hardware-MFT-Attribute</span><span class="sxs-lookup"><span data-stu-id="e71f5-112">Hardware MFT Attributes</span></span>](#hardware-mft-attributes)
-   [<span data-ttu-id="e71f5-113">Hardware Hand Shake Sequenz</span><span class="sxs-lookup"><span data-stu-id="e71f5-113">Hardware Handshake Sequence</span></span>](#hardware-handshake-sequence)
-   [<span data-ttu-id="e71f5-114">Datenverarbeitung</span><span class="sxs-lookup"><span data-stu-id="e71f5-114">Data Processing</span></span>](#data-processing)
-   [<span data-ttu-id="e71f5-115">Paarweise Decoder/Encoder</span><span class="sxs-lookup"><span data-stu-id="e71f5-115">Paired Decoder/Encoder</span></span>](#paired-decoderencoder)
-   [<span data-ttu-id="e71f5-116">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="e71f5-116">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="e71f5-117">Einführung</span><span class="sxs-lookup"><span data-stu-id="e71f5-117">Introduction</span></span>

<span data-ttu-id="e71f5-118">Jeder Hardware-Codec, der nicht auf AVStream basiert, muss eine eigene MFT bereitstellen, die als Proxy für den Treiber fungiert.</span><span class="sxs-lookup"><span data-stu-id="e71f5-118">Any hardware codec that is not based on AVStream must provide its own MFT to act as a proxy to the driver.</span></span> <span data-ttu-id="e71f5-119">Ein Hardwarecodec kann mehrere unterschiedliche funktionale Blöcke enthalten:</span><span class="sxs-lookup"><span data-stu-id="e71f5-119">A hardware codec might incorporate several distinct functional blocks:</span></span>

-   <span data-ttu-id="e71f5-120">Encoder</span><span class="sxs-lookup"><span data-stu-id="e71f5-120">Encoder</span></span>
-   <span data-ttu-id="e71f5-121">Decoder</span><span class="sxs-lookup"><span data-stu-id="e71f5-121">Decoder</span></span>
-   <span data-ttu-id="e71f5-122">Frame Skalierung/Formatkonvertierung</span><span class="sxs-lookup"><span data-stu-id="e71f5-122">Frame scaling/format conversion</span></span>

<span data-ttu-id="e71f5-123">Jede dieser Funktionen sollte von einem separaten MFT verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-123">Each of these functions should be managed by a separate MFT.</span></span> <span data-ttu-id="e71f5-124">Eine Hardware-MFT sollte nie als "Transcoder" für mehrere Zwecke fungieren.</span><span class="sxs-lookup"><span data-stu-id="e71f5-124">A hardware MFT should never act as a multi-purpose "transcoder."</span></span> <span data-ttu-id="e71f5-125">Fügen Sie Codierungs Funktionen stattdessen in einem MFT-Codierer ein.</span><span class="sxs-lookup"><span data-stu-id="e71f5-125">Instead, put encoding functions into an encoder MFT and decoding functions into a decoder MFT.</span></span> <span data-ttu-id="e71f5-126">Wenn die Hardware Frame Skalierung und Formatkonvertierungen bietet, platzieren Sie diese Funktionen in einem separaten Videoprozessor, der in der Kategorie **\_ \_ Video \_ Prozessor Kategorie der MFT-Kategorie** registriert ist.</span><span class="sxs-lookup"><span data-stu-id="e71f5-126">If the hardware offers frame scaling and format conversions, place those functions in a separate video processor, registered in the **MFT\_CATEGORY\_VIDEO\_PROCESSOR** category.</span></span> <span data-ttu-id="e71f5-127">Wenn die Hardware keine Frame Skalierung oder Formatkonvertierung unterstützt, stellt Media Foundation einen Software-Videoprozessor bereit.</span><span class="sxs-lookup"><span data-stu-id="e71f5-127">If the hardware does not support frame scaling or format conversion, Media Foundation provides a software video processor.</span></span>

<span data-ttu-id="e71f5-128">Für Hardware-MFTs gelten die folgenden allgemeinen Anforderungen:</span><span class="sxs-lookup"><span data-stu-id="e71f5-128">Hardware MFTs have the following general requirements:</span></span>

-   <span data-ttu-id="e71f5-129">Hardware-MFTs müssen das neue asynchrone Verarbeitungsmodell verwenden, wie in [asynchroner MFTs](asynchronous-mfts.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="e71f5-129">Hardware MFTs must use the new asynchronous processing model, as described in [Asynchronous MFTs](asynchronous-mfts.md).</span></span>
-   <span data-ttu-id="e71f5-130">Hardware-MFTs müssen dynamische Formatänderungen unterstützen, wie in [dynamische Formatänderungen](basic-mft-processing-model.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="e71f5-130">Hardware MFTs must support dynamic format changes, as described in [Dynamic Format Changes](basic-mft-processing-model.md).</span></span>

## <a name="hardware-mft-attributes"></a><span data-ttu-id="e71f5-131">Hardware-MFT-Attribute</span><span class="sxs-lookup"><span data-stu-id="e71f5-131">Hardware MFT Attributes</span></span>

<span data-ttu-id="e71f5-132">Eine Hardware-MFT muss folgende Methoden im Zusammenhang mit Attributen implementieren:</span><span class="sxs-lookup"><span data-stu-id="e71f5-132">A hardware MFT must implement following methods related to attributes:</span></span>

-   <span data-ttu-id="e71f5-133">[**Imftransform:: GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes): gibt einen Attribut Speicher für globale MFT-Attribute zurück.</span><span class="sxs-lookup"><span data-stu-id="e71f5-133">[**IMFTransform::GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes): Returns an attribute store for global MFT attributes.</span></span>
-   <span data-ttu-id="e71f5-134">[**IMF Transform:: getinputstreamattributs**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstreamattributes): gibt einen Attribut Speicher für einen Eingabestream zurück.</span><span class="sxs-lookup"><span data-stu-id="e71f5-134">[**IMFTransform::GetInputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstreamattributes): Returns an attribute store for an input stream.</span></span>
-   <span data-ttu-id="e71f5-135">[**IMF Transform:: getoutputstreamattributs**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreamattributes): gibt einen Attribut Speicher für einen Ausgabestream zurück.</span><span class="sxs-lookup"><span data-stu-id="e71f5-135">[**IMFTransform::GetOutputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreamattributes): Returns an attribute store for an output stream.</span></span>

<span data-ttu-id="e71f5-136">Wenn der MFT erstmalig erstellt wird, muss er die folgenden Attribute für seinen eigenen globalen Attribut Speicher festlegen (d. h. den von [**GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes)zurückgegebenen Attribut Speicher):</span><span class="sxs-lookup"><span data-stu-id="e71f5-136">When the MFT is first created, it must set the following attributes on its own global attribute store (that is, the attribute store returned by [**GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes)):</span></span>



| <span data-ttu-id="e71f5-137">Attribut</span><span class="sxs-lookup"><span data-stu-id="e71f5-137">Attribute</span></span>                                                                                    | <span data-ttu-id="e71f5-138">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="e71f5-138">Description</span></span>                                                                                                                                                                            |
|----------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e71f5-139">MF- \_ Transformation \_ Async</span><span class="sxs-lookup"><span data-stu-id="e71f5-139">MF\_TRANSFORM\_ASYNC</span></span>](mf-transform-async.md)                                               | <span data-ttu-id="e71f5-140">Muss auf " **true**" festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-140">Must be set to **TRUE**.</span></span> <span data-ttu-id="e71f5-141">Gibt an, dass die MFT asynchrone Verarbeitung ausführt.</span><span class="sxs-lookup"><span data-stu-id="e71f5-141">Indicates that the MFT performs asynchronous processing.</span></span>                                                                                                      |
| [<span data-ttu-id="e71f5-142">MFT-Aufzählungs \_ \_ Hardware-URL- \_ \_ Attribut</span><span class="sxs-lookup"><span data-stu-id="e71f5-142">MFT\_ENUM\_HARDWARE\_URL\_Attribute</span></span>](mft-enum-hardware-url-attribute.md)                   | <span data-ttu-id="e71f5-143">Enthält den symbolischen Link für das Hardware Gerät.</span><span class="sxs-lookup"><span data-stu-id="e71f5-143">Contains the symbolic link for the hardware device.</span></span><br/> <span data-ttu-id="e71f5-144">Das topologielader verwendet dieses Attribut, um zu testen, ob ein MFT ein Hardware Gerät darstellt.</span><span class="sxs-lookup"><span data-stu-id="e71f5-144">The topology loader uses the presence of this attribute to test whether an MFT represents a hardware device.</span></span><br/> |
| [<span data-ttu-id="e71f5-145">**MFT- \_ Unterstützung für \_ dynamisches \_ Format \_ ändern**</span><span class="sxs-lookup"><span data-stu-id="e71f5-145">**MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE**</span></span>](mft-support-dynamic-format-change-attribute.md) | <span data-ttu-id="e71f5-146">Muss auf " **true**" festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-146">Must be set to **TRUE**.</span></span> <span data-ttu-id="e71f5-147">Gibt an, dass der MFT dynamische Formatänderungen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e71f5-147">Indicates that the MFT supports dynamic format changes.</span></span>                                                                                                       |



 

## <a name="hardware-handshake-sequence"></a><span data-ttu-id="e71f5-148">Hardware Hand Shake Sequenz</span><span class="sxs-lookup"><span data-stu-id="e71f5-148">Hardware Handshake Sequence</span></span>

<span data-ttu-id="e71f5-149">Wenn zwei MFTs dasselbe physische Gerät darstellen, können Sie Daten innerhalb der Hardware austauschen – beispielsweise über einen Hardwarebus.</span><span class="sxs-lookup"><span data-stu-id="e71f5-149">If two MFTs represent the same physical device, they can exchange data within the hardware—for example, over a hardware bus.</span></span> <span data-ttu-id="e71f5-150">Es ist nicht erforderlich, die Daten in den Systemspeicher und dann zurück auf das Gerät zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="e71f5-150">There is no need to copy the data into system memory and then back to the device.</span></span>

<span data-ttu-id="e71f5-151">In der folgenden Abbildung stellen die MFTs mit der Bezeichnung "A" und "B" funktionale Blöcke innerhalb derselben Hardware dar.</span><span class="sxs-lookup"><span data-stu-id="e71f5-151">In the following diagram, the MFTs labeled "A" and "B" represent functional blocks within the same hardware.</span></span> <span data-ttu-id="e71f5-152">Beispielsweise kann in einem Transcodierungs Szenario "a" einen Hardware Decoder und "B" einen Hardware Encoder darstellen.</span><span class="sxs-lookup"><span data-stu-id="e71f5-152">For example, in a transcoding scenario, "A" might represent a hardware decoder and "B" might represent a hardware encoder.</span></span> <span data-ttu-id="e71f5-153">Der Datenfluss zwischen "A" und "B" erfolgt innerhalb der Hardware.</span><span class="sxs-lookup"><span data-stu-id="e71f5-153">The data flow between "A" and "B" occurs within the hardware.</span></span> <span data-ttu-id="e71f5-154">Die MFT-Bezeichnung "C" ist eine Software-MFT.</span><span class="sxs-lookup"><span data-stu-id="e71f5-154">The MFT labeled "C" is a software MFT.</span></span> <span data-ttu-id="e71f5-155">Der Datenfluss von "B" zu "C" verwendet den System Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="e71f5-155">Data flow from "B" to "C" uses system memory.</span></span>

![Diagramm, das Felder mit der Bezeichnung a bis c und einen Hardwarecodec anzeigt: a zeigt auf b und den Codec, der Codec zeigt auf b und b auf c](images/proxy-mft.png)

<span data-ttu-id="e71f5-157">Zum Herstellen einer Hardware Verbindung müssen die beiden Hardware-MFTs einen privaten Kommunikationskanal verwenden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-157">To establish a hardware connection, the two hardware MFTs must use a private communication channel.</span></span> <span data-ttu-id="e71f5-158">Diese Verbindung wird während der Format Aushandlung hergestellt, bevor die Medientypen festgelegt werden, und vor dem ersten Aufrufen von [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span><span class="sxs-lookup"><span data-stu-id="e71f5-158">This connection is established during format negotiation, before the media types are set and before the first call to [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span></span> <span data-ttu-id="e71f5-159">Der Verbindungsprozess funktioniert wie folgt:</span><span class="sxs-lookup"><span data-stu-id="e71f5-159">The connection process works as follows:</span></span>

1.  <span data-ttu-id="e71f5-160">Das topologielader überprüft beide MFTs auf das vorhanden sein des [MFT \_ Enum- \_ Hardware-URL- \_ \_ Attribut](mft-enum-hardware-url-attribute.md) Attributs.</span><span class="sxs-lookup"><span data-stu-id="e71f5-160">The topology loader checks both MFTs for the presence of the [MFT\_ENUM\_HARDWARE\_URL\_Attribute](mft-enum-hardware-url-attribute.md) attribute.</span></span> <span data-ttu-id="e71f5-161">Beachten Sie, dass der Wert dieses Attributs nicht untersucht wird.</span><span class="sxs-lookup"><span data-stu-id="e71f5-161">Note that it does not examine the value of this attribute.</span></span>
2.  <span data-ttu-id="e71f5-162">Wenn das [MFT- \_ Enum- \_ Hardware-URL- \_ \_ Attribut](mft-enum-hardware-url-attribute.md) in beiden MFTs vorhanden ist, führt das topologielader Folgendes aus:</span><span class="sxs-lookup"><span data-stu-id="e71f5-162">If [MFT\_ENUM\_HARDWARE\_URL\_Attribute](mft-enum-hardware-url-attribute.md) is present on both MFTs, the topology loader does the following:</span></span>
    1.  <span data-ttu-id="e71f5-163">Das topologielader ruft [**imftransform:: getoutputstreamattributs**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreamattributes) für den upstreammft (A) auf.</span><span class="sxs-lookup"><span data-stu-id="e71f5-163">The topology loader calls [**IMFTransform::GetOutputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreamattributes) on the upstream MFT (A).</span></span> <span data-ttu-id="e71f5-164">Diese Methode gibt einen [**imfattributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) -Zeiger zurück.</span><span class="sxs-lookup"><span data-stu-id="e71f5-164">This method returns an [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) pointer.</span></span> <span data-ttu-id="e71f5-165">Lassen Sie diesen Zeiger als " *pupstream*" bezeichnen.</span><span class="sxs-lookup"><span data-stu-id="e71f5-165">Let this pointer be denoted *pUpstream*.</span></span>
    2.  <span data-ttu-id="e71f5-166">Das topologielader ruft [**imftransform:: getinputstreamattributs für die downstreammft**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstreamattributes) (B) auf.</span><span class="sxs-lookup"><span data-stu-id="e71f5-166">The topology loader calls [**IMFTransform::GetInputStreamAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputstreamattributes) on the downstream MFT (B).</span></span> <span data-ttu-id="e71f5-167">Dieser Befehl gibt auch einen [**imfattributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) -Zeiger zurück.</span><span class="sxs-lookup"><span data-stu-id="e71f5-167">This call also returns an [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) pointer.</span></span> <span data-ttu-id="e71f5-168">Lassen Sie diesen Zeiger als " *pdownstream*" bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="e71f5-168">Let this pointer be denoted *pDownstream*.</span></span>
    3.  <span data-ttu-id="e71f5-169">Das topologielader legt das Attribut Attribut des [verbundenen MFT- \_ \_ Streams \_](mft-connected-stream-attribute.md) auf *pdownstream* fest, indem [**imfattributes:: setunknown**](/windows/desktop/api/mfobjects/nf-mfobjects-imfattributes-setunknown)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="e71f5-169">The topology loader sets the [MFT\_CONNECTED\_STREAM\_ATTRIBUTE](mft-connected-stream-attribute.md) attribute on *pDownstream* by calling [**IMFAttributes::SetUnknown**](/windows/desktop/api/mfobjects/nf-mfobjects-imfattributes-setunknown).</span></span> <span data-ttu-id="e71f5-170">Der Wert des-Attributs ist der *pupstream* -Zeiger.</span><span class="sxs-lookup"><span data-stu-id="e71f5-170">The value of the attribute is the *pUpstream* pointer.</span></span>
    4.  <span data-ttu-id="e71f5-171">Der topologielader legt die mit dem [ \_ HW- \_ \_ \_ streamattribut verbundene MFT](mft-connected-to-hw-stream.md) für *pdownstream* und *pupstream* auf **true** fest.</span><span class="sxs-lookup"><span data-stu-id="e71f5-171">The topology loader sets the [MFT\_CONNECTED\_TO\_HW\_STREAM](mft-connected-to-hw-stream.md) attribute to **TRUE** on both *pDownstream* and *pUpstream*.</span></span>
3.  <span data-ttu-id="e71f5-172">An diesem Punkt hat das downstreammft einen Zeiger auf den Attribut Speicher der Upstream-MFT, wie in der folgenden Abbildung dargestellt.</span><span class="sxs-lookup"><span data-stu-id="e71f5-172">At this point, the downstream MFT has a pointer to the upstream MFT's attribute store, as shown in the following diagram.</span></span>

    ![Diagramm mit jedem MFTs, der auf seinen Stream zeigt, jeder Stream, der auf seinen Speicher zeigt, und der Eingabe Speicher mit einer gestrichelten Linie in den Ausgabe Speicher](images/proxy-mft2.png)

    > [!Note]  
    > <span data-ttu-id="e71f5-174">Aus Gründen der Übersichtlichkeit zeigt dieses Diagramm die Datenströme und die Attribut Speicher als unterschiedliche Objekte an, dies ist für die Implementierung jedoch nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="e71f5-174">For clarity, this diagram shows the streams and the attribute stores as distinct objects, but that is not required for the implementation.</span></span>

     

4.  <span data-ttu-id="e71f5-175">Der Downstream-MFT verwendet den [**imfattributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) -Zeiger, um einen privaten Kommunikationskanal mit der upstreammft einzurichten.</span><span class="sxs-lookup"><span data-stu-id="e71f5-175">The downstream MFT uses the [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) pointer to establish a private communication channel with the upstream MFT.</span></span> <span data-ttu-id="e71f5-176">Da der Kanal privat ist, wird der genaue Mechanismus durch die-Implementierung definiert.</span><span class="sxs-lookup"><span data-stu-id="e71f5-176">Because the channel is private, the exact mechanism is defined by the implementation.</span></span> <span data-ttu-id="e71f5-177">Beispielsweise könnte die MFT eine private com-Schnittstelle Abfragen.</span><span class="sxs-lookup"><span data-stu-id="e71f5-177">For example, the MFT might query for a private COM interface.</span></span>

<span data-ttu-id="e71f5-178">In Schritt 4 muss das downstreammft überprüfen, ob die beiden MFTs dasselbe physische Gerät gemeinsam verwenden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-178">During step 4, the downstream MFT must verify whether the two MFTs share the same physical device.</span></span> <span data-ttu-id="e71f5-179">Wenn dies nicht der Fall ist, müssen Sie auf den System Arbeitsspeicher für den Datentransport zurückgreifen.</span><span class="sxs-lookup"><span data-stu-id="e71f5-179">If not, they must fall back to using system memory for data transport.</span></span> <span data-ttu-id="e71f5-180">Dies ermöglicht die korrekte Funktionsweise des MFT mit Software-MFTs und anderen Hardware Geräten.</span><span class="sxs-lookup"><span data-stu-id="e71f5-180">This enables the MFT to operate correctly with software MFTs and other hardware devices.</span></span>

<span data-ttu-id="e71f5-181">Wenn der Handshake erfolgreich ist und die beiden MFTs einen privaten Datenkanal gemeinsam verwenden, verwenden Sie nicht das standardmäßige Datenverarbeitungs Modell (im nächsten Abschnitt beschrieben) am Verbindungspunkt.</span><span class="sxs-lookup"><span data-stu-id="e71f5-181">If the handshake succeeds and the two MFTs share a private data channel, they do not use the standard data processing model (described in the next section) at the connection point.</span></span> <span data-ttu-id="e71f5-182">Insbesondere das downstreammft sendet keine [metransformneedinput](metransformneedinput.md) -Ereignisse. Weitere Informationen finden Sie im nächsten Abschnitt in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="e71f5-182">Specifically, the downstream MFT does not send [METransformNeedInput](metransformneedinput.md) events; for more details, refer to the next section in this topic.</span></span>

## <a name="data-processing"></a><span data-ttu-id="e71f5-183">Datenverarbeitung</span><span class="sxs-lookup"><span data-stu-id="e71f5-183">Data Processing</span></span>

<span data-ttu-id="e71f5-184">Wenn eine Hardware-MFT den Systemspeicher für den Datentransport verwendet, funktioniert der Prozess wie folgt:</span><span class="sxs-lookup"><span data-stu-id="e71f5-184">When a hardware MFT uses system memory for data transport, the process works as follows:</span></span>

1.  <span data-ttu-id="e71f5-185">Um weitere Eingaben anzufordern, sendet der MFT ein [metransformneedinput](metransformneedinput.md) -Ereignis.</span><span class="sxs-lookup"><span data-stu-id="e71f5-185">To request more input, the MFT sends an [METransformNeedInput](metransformneedinput.md) event.</span></span>
2.  <span data-ttu-id="e71f5-186">Das [metransformneedinput](metransformneedinput.md) -Ereignis bewirkt, dass die Pipeline [**imftransform::P rocessinput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput)aufruft.</span><span class="sxs-lookup"><span data-stu-id="e71f5-186">The [METransformNeedInput](metransformneedinput.md) event causes the pipeline to call [**IMFTransform::ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span></span>
3.  <span data-ttu-id="e71f5-187">Wenn der MFT Ausgabedaten enthält, sendet der MFT ein [metransformhaveoutput](metransformhaveoutput.md) -Ereignis.</span><span class="sxs-lookup"><span data-stu-id="e71f5-187">When the MFT has output data, the MFT sends an [METransformHaveOutput](metransformhaveoutput.md) event.</span></span>
4.  <span data-ttu-id="e71f5-188">Das [metransformhaveoutput](metransformhaveoutput.md) -Ereignis bewirkt, dass die Pipeline [**imftransform::P rocess Output**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput)aufruft.</span><span class="sxs-lookup"><span data-stu-id="e71f5-188">The [METransformHaveOutput](metransformhaveoutput.md) event causes the pipeline to call [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span>

<span data-ttu-id="e71f5-189">Weitere Informationen finden Sie unter [asynchrone MFTs](asynchronous-mfts.md).</span><span class="sxs-lookup"><span data-stu-id="e71f5-189">For details, refer to [Asynchronous MFTs](asynchronous-mfts.md).</span></span>

<span data-ttu-id="e71f5-190">Wenn die MFT jedoch einen Hardware Kanal verwendet, sendet Sie diese Ereignisse nicht an den Hardware Verbindungspunkt, da die gesamte Datenübertragung intern innerhalb der Hardware erfolgt.</span><span class="sxs-lookup"><span data-stu-id="e71f5-190">If the MFT uses a hardware channel, however, it does not send these events at the hardware connection point, because all data transfer happens internally within the hardware.</span></span> <span data-ttu-id="e71f5-191">Daher ruft die Pipeline nicht [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) oder [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) am Verbindungspunkt auf.</span><span class="sxs-lookup"><span data-stu-id="e71f5-191">Therefore, the pipeline does not call [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) or [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) at the connection point.</span></span>

<span data-ttu-id="e71f5-192">Sehen Sie sich beispielsweise das erste Diagramm in diesem Thema an.</span><span class="sxs-lookup"><span data-stu-id="e71f5-192">For example, consider the first diagram in this topic.</span></span> <span data-ttu-id="e71f5-193">Bei dieser Konfiguration erfolgt die Datenverarbeitung wie folgt:</span><span class="sxs-lookup"><span data-stu-id="e71f5-193">Given this configuration, data processing would occur as follows:</span></span>

1.  <span data-ttu-id="e71f5-194">"A" sendet [metransformneedinput](metransformneedinput.md) , um Daten anzufordern.</span><span class="sxs-lookup"><span data-stu-id="e71f5-194">"A" sends [METransformNeedInput](metransformneedinput.md) to request data.</span></span>
2.  <span data-ttu-id="e71f5-195">Die Pipeline ruft [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) für "A" auf.</span><span class="sxs-lookup"><span data-stu-id="e71f5-195">The pipeline calls [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) on "A".</span></span>
3.  <span data-ttu-id="e71f5-196">"A" und "B" verarbeiten die Daten in der Hardware.</span><span class="sxs-lookup"><span data-stu-id="e71f5-196">"A" and "B" process the data in hardware.</span></span>
4.  <span data-ttu-id="e71f5-197">Wenn die Verarbeitung fertig ist, sendet "B" ein [metransformhaveoutput](metransformhaveoutput.md) -Ereignis.</span><span class="sxs-lookup"><span data-stu-id="e71f5-197">When the processing is complete, "B" sends an [METransformHaveOutput](metransformhaveoutput.md) event.</span></span>
5.  <span data-ttu-id="e71f5-198">Die Pipeline ruft [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) für "B" auf.</span><span class="sxs-lookup"><span data-stu-id="e71f5-198">The pipeline calls [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) on "B".</span></span>

## <a name="paired-decoderencoder"></a><span data-ttu-id="e71f5-199">Paarweise Decoder/Encoder</span><span class="sxs-lookup"><span data-stu-id="e71f5-199">Paired Decoder/Encoder</span></span>

<span data-ttu-id="e71f5-200">Wenn sich ein Decoder und ein Encoder auf demselben Hardware Chip befinden, ist es möglicherweise besser, Sie bei der Transcodierung zusammen zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-200">If a decoder and encoder are located on the same hardware chip, it may be preferable to use them together when transcoding.</span></span> <span data-ttu-id="e71f5-201">Das heißt, wenn Sie eine auswählen, sollte die andere in der Transcodierung-Pipeline ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-201">That is, selecting one should cause the other to be selected in the transcoding pipeline.</span></span> <span data-ttu-id="e71f5-202">Um sicherzustellen, dass übereinstimmende Hardware Codecs ausgewählt werden, sollten beide Codec-MFTs einen benutzerdefinierten Medientyp anbieten.</span><span class="sxs-lookup"><span data-stu-id="e71f5-202">To ensure that matching hardware codecs are chosen, both codec MFTs should offer a custom media type.</span></span> <span data-ttu-id="e71f5-203">So erstellen Sie einen benutzerdefinierten Medientyp:</span><span class="sxs-lookup"><span data-stu-id="e71f5-203">To create a custom media type:</span></span>

-   <span data-ttu-id="e71f5-204">Legen Sie ggf. das Attribut " [**MF- \_ \_ Haupt \_**](mf-mt-major-type-attribute.md) Attribut" auf **mfmediatype \_ -Audiodatei** oder **mfmediatype- \_ Video** fest.</span><span class="sxs-lookup"><span data-stu-id="e71f5-204">Set the [**MF\_MT\_MAJOR\_TYPE**](mf-mt-major-type-attribute.md) attribute to **MFMediaType\_Audio** or **MFMediaType\_Video**, as appropriate.</span></span>
-   <span data-ttu-id="e71f5-205">Legen Sie das Attribut " [**MF \_ MT \_ SubType**](mf-mt-subtype-attribute.md) " auf einen benutzerdefinierten GUID-Wert fest.</span><span class="sxs-lookup"><span data-stu-id="e71f5-205">Set the [**MF\_MT\_SUBTYPE**](mf-mt-subtype-attribute.md) attribute to a custom GUID value.</span></span>

<span data-ttu-id="e71f5-206">Andere Typattribute sind optional.</span><span class="sxs-lookup"><span data-stu-id="e71f5-206">Other type attributes are optional.</span></span> <span data-ttu-id="e71f5-207">Der Decoder gibt den benutzerdefinierten Typ aus seinem [**imftransform:: getoutputavailabletype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype)zurück, und der Encoder gibt den benutzerdefinierten Typ aus der [**imftransform:: getinputavailabletype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) -Methode zurück.</span><span class="sxs-lookup"><span data-stu-id="e71f5-207">The decoder returns the custom type from its [**IMFTransform::GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype), and the encoder returns the custom type from its [**IMFTransform::GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) method.</span></span> <span data-ttu-id="e71f5-208">In beiden Fällen muss der benutzerdefinierte Typ der erste Eintrag in der Liste (*dwtypeindex* = 0) sein.</span><span class="sxs-lookup"><span data-stu-id="e71f5-208">In both cases, the custom type must be the first entry in the list (*dwTypeIndex* = 0).</span></span>

<span data-ttu-id="e71f5-209">Zum Arbeiten mit Software Codecs sollte der Codec auch mindestens ein Standardformat (z. b. NV12 for Video) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="e71f5-209">To work with software codecs, the codec should also return at least one standard format, such as NV12 for video.</span></span> <span data-ttu-id="e71f5-210">Standard Formate sollten nach dem benutzerdefinierten Typ (*dwtypeindex* > 0) angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-210">Standard formats should appear after the custom type (*dwTypeIndex* > 0).</span></span> <span data-ttu-id="e71f5-211">Wenn die beiden Codecs immer paarweise gekoppelt werden müssen und nicht mit Software Codecs interagieren können, sollten die MFTs nur das benutzerdefinierte Format zurückgeben und keine Standardformate zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="e71f5-211">If the two codecs must always be paired and cannot interoperate with software codecs, the MFTs should return only the custom format and not return any standard formats.</span></span>

> [!Note]  
> <span data-ttu-id="e71f5-212">Wenn ein Decoder keine Standardformate zurückgibt, kann er nicht für die Wiedergabe mit dem [erweiterten Videorenderer](enhanced-video-renderer.md)verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-212">If a decoder does not return any standard formats, it cannot be used for playback with the [Enhanced Video Renderer](enhanced-video-renderer.md).</span></span> <span data-ttu-id="e71f5-213">In diesem Fall sollte Sie als ein nur-transcode-Decoder registriert werden.</span><span class="sxs-lookup"><span data-stu-id="e71f5-213">In that case, it should be registered as a transcode-only decoder.</span></span> <span data-ttu-id="e71f5-214">Siehe [nur-transcode-Decoders](implementing-a-codec-mft.md).</span><span class="sxs-lookup"><span data-stu-id="e71f5-214">See [Transcode-Only Decoders](implementing-a-codec-mft.md).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="e71f5-215">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="e71f5-215">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e71f5-216">Schreiben eines benutzerdefinierten MFT</span><span class="sxs-lookup"><span data-stu-id="e71f5-216">Writing a Custom MFT</span></span>](writing-a-custom-mft.md)
</dt> <dt>

[<span data-ttu-id="e71f5-217">Implementieren eines Codec-MFT</span><span class="sxs-lookup"><span data-stu-id="e71f5-217">Implementing a Codec MFT</span></span>](implementing-a-codec-mft.md)
</dt> <dt>

[<span data-ttu-id="e71f5-218">Media Foundation Transformationen</span><span class="sxs-lookup"><span data-stu-id="e71f5-218">Media Foundation Transforms</span></span>](media-foundation-transforms.md)
</dt> </dl>

 

 




