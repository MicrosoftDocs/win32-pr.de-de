---
description: Erfahren Sie mehr über das Erstellen der ASF-Dateisenke, mit der eine Anwendung ASF-Mediendaten in einer Datei archivieren kann.
ms.assetid: 991f3345-a6b4-45c2-a89d-3c13c70b6bbc
title: Erstellen der ASF-Dateisenke
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6fcd9ea19f0200dfd330f421fd5dac2cd100b702
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/19/2021
ms.locfileid: "112409923"
---
# <a name="creating-the-asf-file-sink"></a><span data-ttu-id="a8d43-103">Erstellen der ASF-Dateisenke</span><span class="sxs-lookup"><span data-stu-id="a8d43-103">Creating the ASF File Sink</span></span>

<span data-ttu-id="a8d43-104">Die ASF-Dateisenke ist eine Implementierung von [**VONMEDIASink,**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) die von Media Foundation bereitgestellt wird, die eine Anwendung zum Archivieren von ASF-Mediendaten in einer Datei verwenden kann.</span><span class="sxs-lookup"><span data-stu-id="a8d43-104">The ASF file sink is an implementation of [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) provided by Media Foundation that an application can use to archive ASF media data to a file.</span></span> <span data-ttu-id="a8d43-105">Informationen zum Objektmodell und zur allgemeinen Verwendung von ASF-Mediensenken finden Sie unter [ASF-Mediensenken.](asf-media-sinks.md)</span><span class="sxs-lookup"><span data-stu-id="a8d43-105">For information about ASF Media Sinks' object model and general usage, see [ASF Media Sinks](asf-media-sinks.md).</span></span>

<span data-ttu-id="a8d43-106">Es gibt zwei Möglichkeiten, eine Instanz der ASF-Dateisenke zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a8d43-106">There are two ways of creating an instance of the ASF file sink.</span></span> <span data-ttu-id="a8d43-107">Sie können [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) oder [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a8d43-107">You can call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) or [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate).</span></span>

<span data-ttu-id="a8d43-108">Wenn Sie [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink)aufrufen, müssen Sie einen Bytestream für die Ausgabedatei angeben, in die die Senke den ASF-Inhalt während einer Codierungssitzung schreibt.</span><span class="sxs-lookup"><span data-stu-id="a8d43-108">If you call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), you must specify a byte stream, for the output file, into which the sink will write the ASF content during an encoding session.</span></span> <span data-ttu-id="a8d43-109">Der angegebene Bytestream muss über suchbare und beschreibbare Funktionen verfügen, andernfalls schlägt der **MFCreateASFMediaSink-Aufruf** mit dem E \_ FAIL-Fehlercode fehl.</span><span class="sxs-lookup"><span data-stu-id="a8d43-109">The specified byte stream must have seekable and writable capabilities otherwise the **MFCreateASFMediaSink** call fails with the E\_FAIL error code.</span></span> <span data-ttu-id="a8d43-110">Dieser Aufruf erstellt ein In-Process-Dateisenkenobjekt und gibt einen Zeiger auf die [**INTERFACESMediaSink-Schnittstelle**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) der Dateisenke zurück.</span><span class="sxs-lookup"><span data-stu-id="a8d43-110">This call creates an in-process file sink object and returns a pointer to the [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) interface of the file sink.</span></span>

<span data-ttu-id="a8d43-111">Wenn Sie [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate)aufrufen, müssen Sie die URL der Ausgabedatei angeben, in die die Dateisenke Mediendaten schreibt.</span><span class="sxs-lookup"><span data-stu-id="a8d43-111">If you call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), you must specify the URL of the output file into which the file sink will write media data.</span></span> <span data-ttu-id="a8d43-112">In diesem Fall erstellt die Dateisenke intern den Bytestream.</span><span class="sxs-lookup"><span data-stu-id="a8d43-112">In this case, the file sink internally creates the byte stream.</span></span> <span data-ttu-id="a8d43-113">Die Funktion gibt einen Zeiger auf die [**INTERFACESActivate-Schnittstelle**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) der Dateisenke zurück.</span><span class="sxs-lookup"><span data-stu-id="a8d43-113">The function returns a pointer to the [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) interface of the file sink.</span></span> <span data-ttu-id="a8d43-114">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="a8d43-114">To</span></span>

<span data-ttu-id="a8d43-115">Ziehen Sie [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) anstelle von [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink)in Betracht, wenn Ihre Codierungstopologie wie folgt entworfen wurde:</span><span class="sxs-lookup"><span data-stu-id="a8d43-115">Consider [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) instead of [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), when your encoding topology is designed as follows:</span></span>

-   <span data-ttu-id="a8d43-116">Die Codierungstopologie ist für den Geschützten Medienpfad (Protected Media Path, PMP) vorgesehen, und die Dateisenke wird außerhalb des Prozesses verwendet.</span><span class="sxs-lookup"><span data-stu-id="a8d43-116">The encoding topology is for the protected media path (PMP) and the file sink is used out-of-process.</span></span>
-   <span data-ttu-id="a8d43-117">Der Ausgabeknoten der Topologie wird mithilfe des zurückgegebenen Zeigers auf das Activate-Objekt der Dateisenke erstellt, und Ihre Anwendung verfolgt die Datenströme in der Dateisenke anhand von Datenstromnummern nach.</span><span class="sxs-lookup"><span data-stu-id="a8d43-117">The output node of the topology is created by using the returned pointer to the activate object of the file sink and your application is keeping track of the streams in the file sink by stream numbers.</span></span>
    > [!Note]  
    > <span data-ttu-id="a8d43-118">Sie können die Dateisenke aktivieren, indem Sie [**DIE AKTIONACTIVATE::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a8d43-118">You can activate the file sink by calling [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject).</span></span> <span data-ttu-id="a8d43-119">Sie müssen das Objekt jedoch nicht explictly aktivieren.</span><span class="sxs-lookup"><span data-stu-id="a8d43-119">However you do not need to activate the object explictly.</span></span> <span data-ttu-id="a8d43-120">Die Mediensitzung verfolgt das Aktivierungsobjekt nach und aktiviert die Dateisenke während der Codierungssitzung automatisch.</span><span class="sxs-lookup"><span data-stu-id="a8d43-120">The Media Session keeps track of the activation object and activates the file sink automatically during the encoding session.</span></span>

     

-   <span data-ttu-id="a8d43-121">Die Streaminformationen werden im ContentInfo-Objekt konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="a8d43-121">The stream information is configured in the ContentInfo object.</span></span> <span data-ttu-id="a8d43-122">Im nächsten Unterabschnitt nicht erläutert.</span><span class="sxs-lookup"><span data-stu-id="a8d43-122">Disucssed in the next sub-section.</span></span>

<span data-ttu-id="a8d43-123">Nach dem Erstellen der ASF-Dateisenke muss sie vor dem Erstellen der Topologie konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="a8d43-123">After creating the ASF file sink it must be configured before building the topology.</span></span> <span data-ttu-id="a8d43-124">Die Dateisenke muss die folgenden Informationen kennen, um die Ausgabedatei zu generieren.</span><span class="sxs-lookup"><span data-stu-id="a8d43-124">The file sink needs to know the following information in order to generate the output file.</span></span>

-   <span data-ttu-id="a8d43-125">Grundlegende Datenstrominformationen</span><span class="sxs-lookup"><span data-stu-id="a8d43-125">Basic stream information</span></span>
-   <span data-ttu-id="a8d43-126">Informationen zum Codierungsmodus</span><span class="sxs-lookup"><span data-stu-id="a8d43-126">Encoding mode information</span></span>
-   <span data-ttu-id="a8d43-127">Metadaten</span><span class="sxs-lookup"><span data-stu-id="a8d43-127">Metadata</span></span>

<span data-ttu-id="a8d43-128">Die Dateisenke implementiert das [ASF ContentInfo-Objekt](asf-contentinfo-object.md) und macht die [**IMFASFContentInfo-Schnittstelle**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) verfügbar, sodass eine Anwendung damit Informationen im Zusammenhang mit den Streams und der Codierung festlegen kann.</span><span class="sxs-lookup"><span data-stu-id="a8d43-128">The file sink implements the [ASF ContentInfo Object](asf-contentinfo-object.md) and exposes the [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface so that an application can use it to set information related to the streams and encoding.</span></span> <span data-ttu-id="a8d43-129">Abhängig von der Funktion, die Sie zum Erstellen der Dateisenke aufgerufen haben, gibt es zwei Möglichkeiten, einen Verweis auf die **IMFASFContentInfo-Schnittstelle** zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a8d43-129">Depending on the function you called to create the file sink, there are two ways of getting a reference to the **IMFASFContentInfo** interface.</span></span>

-   <span data-ttu-id="a8d43-130">Wenn Sie die [**MFCreateASFMediaSink-Funktion**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) aufrufen, muss die Anwendung die [**IMFASFContentInfo-Schnittstelle**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) abfragen, indem SIE IN DER zurückgegebenen **Dateisenke DIEMEDIASink::QueryInterface** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a8d43-130">If you call the [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) function, the application must query for [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface by calling **IMFMediaSink::QueryInterface** on the returned file sink.</span></span>
-   <span data-ttu-id="a8d43-131">Wenn Sie [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate)aufrufen, erwartet diese Funktion, dass Sie vor dem Aufruf über ein vollständig konfiguriertes ContentInfo-Objekt verfügen.</span><span class="sxs-lookup"><span data-stu-id="a8d43-131">If you choose to call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), this function expects that you have a fully-configured ContentInfo object prior to the call.</span></span> <span data-ttu-id="a8d43-132">Hierzu müssen Sie ein leeres ContentInfo-Objekt erstellen, indem Sie [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) aufrufen und es dann mit allen erforderlichen Informationen konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="a8d43-132">To do this, you need to create an empty ContentInfo object by calling [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) and then configure it with all the required information.</span></span> <span data-ttu-id="a8d43-133">Übergeben Sie das konfigurierte ContentInfo-Objekt an **MFCreateASFMediaSinkActivate,** um einen Zeiger auf das Senkenaktivierungsobjekt zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="a8d43-133">Pass the configured ContentInfo object to the **MFCreateASFMediaSinkActivate** to receive a pointer to the sink activate object.</span></span> <span data-ttu-id="a8d43-134">Sie können die Dateisenke nicht mithilfe des zurückgegebenen Aktivierungsobjekts aktivieren und dann Datenstrom- oder Codierungsinformationen ändern.</span><span class="sxs-lookup"><span data-stu-id="a8d43-134">You cannot activate the file sink by using the returned activation object and then change any stream or encoding information.</span></span>

<span data-ttu-id="a8d43-135">Informationen zum Konfigurieren von Senkenstreams und bestimmten Eigenschaften finden Sie in den folgenden Themen:</span><span class="sxs-lookup"><span data-stu-id="a8d43-135">For information about configuring sink streams and specific properties, see the following topics:</span></span>

-   [<span data-ttu-id="a8d43-136">Hinzufügen von Streaminformationen zur ASF-Dateisenke</span><span class="sxs-lookup"><span data-stu-id="a8d43-136">Adding Stream Information to the ASF File Sink</span></span>](adding-stream-information-to-the-asf-file-sink.md)
-   [<span data-ttu-id="a8d43-137">Festlegen von Eigenschaften in der Dateisenke</span><span class="sxs-lookup"><span data-stu-id="a8d43-137">Setting Properties in the File Sink</span></span>](setting-properties-in-the-file-sink.md)
-   [<span data-ttu-id="a8d43-138">Hinzufügen von Metadaten zur Dateisenke</span><span class="sxs-lookup"><span data-stu-id="a8d43-138">Adding Metadata to the File Sink</span></span>](adding-metadata-to-the-file-sink.md)

## <a name="related-topics"></a><span data-ttu-id="a8d43-139">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="a8d43-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a8d43-140">ASF-Mediensenken</span><span class="sxs-lookup"><span data-stu-id="a8d43-140">ASF Media Sinks</span></span>](asf-media-sinks.md)
</dt> <dt>

[<span data-ttu-id="a8d43-141">ASF-Komponenten auf Pipelineebene</span><span class="sxs-lookup"><span data-stu-id="a8d43-141">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="a8d43-142">ASF-Unterstützung in Media Foundation</span><span class="sxs-lookup"><span data-stu-id="a8d43-142">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 



