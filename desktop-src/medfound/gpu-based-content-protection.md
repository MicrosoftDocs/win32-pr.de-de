---
description: Beschreibt Videoinhalte&\# 8211 und Schutzfunktionen, die von einem Grafiktreiber bereitgestellt werden können.
ms.assetid: FD0625BB-484A-43E6-8931-DB635D4F017F
title: GPU-Based Content Protection
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6bbc1a0f88cae199b9aab38e5ec429ea5427f44b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104563397"
---
# <a name="gpu-based-content-protection"></a><span data-ttu-id="68b93-103">GPU-Based Content Protection</span><span class="sxs-lookup"><span data-stu-id="68b93-103">GPU-Based Content Protection</span></span>

<span data-ttu-id="68b93-104">In diesem Thema werden Videoinhalte – Schutzfunktionen beschrieben, die von einem Grafiktreiber bereitgestellt werden können.</span><span class="sxs-lookup"><span data-stu-id="68b93-104">This topic describes video content–protection capabilities that a graphics driver can provide.</span></span>

-   [<span data-ttu-id="68b93-105">Introduction (Einführung)</span><span class="sxs-lookup"><span data-stu-id="68b93-105">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="68b93-106">Übersicht über den Decodierungs Prozess</span><span class="sxs-lookup"><span data-stu-id="68b93-106">Overview of the Decoding Process</span></span>](#overview-of-the-decoding-process)
-   [<span data-ttu-id="68b93-107">Verschlüsseln komprimierter Video Puffer für den Decoder</span><span class="sxs-lookup"><span data-stu-id="68b93-107">Encrypting Compressed Video Buffers for the Decoder</span></span>](#encrypting-compressed-video-buffers-for-the-decoder)
    -   [<span data-ttu-id="68b93-108">1. Abfragen der Content Protection Funktionen des Treibers</span><span class="sxs-lookup"><span data-stu-id="68b93-108">1. Query the Content Protection Capabilities of the Driver</span></span>](#1-query-the-content-protection-capabilities-of-the-driver)
    -   [<span data-ttu-id="68b93-109">2. Konfigurieren des authentifizierten Kanals</span><span class="sxs-lookup"><span data-stu-id="68b93-109">2. Configure the Authenticated Channel</span></span>](#2-configure-the-authenticated-channel)
    -   [<span data-ttu-id="68b93-110">3. Konfigurieren der Kryptografiesitzung</span><span class="sxs-lookup"><span data-stu-id="68b93-110">3. Configure the Cryptographic Session</span></span>](#3-configure-the-cryptographic-session)
    -   [<span data-ttu-id="68b93-111">4. erhalten Sie ein Handle für das DXVA-Decodergerät.</span><span class="sxs-lookup"><span data-stu-id="68b93-111">4. Get a Handle to the DXVA Decoder Device</span></span>](#4-get-a-handle-to-the-dxva-decoder-device)
    -   [<span data-ttu-id="68b93-112">5. Zuordnen des DXVA-Decoders zur Kryptografiesitzung</span><span class="sxs-lookup"><span data-stu-id="68b93-112">5. Associate the DXVA Decoder with the Cryptographic Session</span></span>](#5-associate-the-dxva-decoder-with-the-cryptographic-session)
-   [<span data-ttu-id="68b93-113">Senden von authentifizierten Kanal Befehlen</span><span class="sxs-lookup"><span data-stu-id="68b93-113">Sending Authenticated Channel Commands</span></span>](#sending-authenticated-channel-commands)
-   [<span data-ttu-id="68b93-114">Senden von authentifizierten Kanal Abfragen</span><span class="sxs-lookup"><span data-stu-id="68b93-114">Sending Authenticated Channel Queries</span></span>](#sending-authenticated-channel-queries)
-   [<span data-ttu-id="68b93-115">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="68b93-115">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="68b93-116">Einführung</span><span class="sxs-lookup"><span data-stu-id="68b93-116">Introduction</span></span>

<span data-ttu-id="68b93-117">Das folgende Diagramm zeigt eine vereinfachte Ansicht, wie Inhalte geschützter Videos durch die Pipeline durchlaufen werden, die gerendert werden soll.</span><span class="sxs-lookup"><span data-stu-id="68b93-117">The following diagram shows a simplified view of how protected video content travels through the pipeline to be rendered.</span></span>

![ein Diagramm, in dem geschützte Videoinhalte angezeigt werden.](images/d3d9video01.png)

> [!Note]  
> <span data-ttu-id="68b93-119">Der [geschützte Medien Pfad](protected-media-path.md) (PMP) ist in diesem Diagramm nicht dargestellt.</span><span class="sxs-lookup"><span data-stu-id="68b93-119">The [Protected Media Path](protected-media-path.md) (PMP) is not depicted in this diagram.</span></span> <span data-ttu-id="68b93-120">Der hier gezeigte Datenfluss kann in einem PMP-Prozess oder innerhalb eines Anwendungsprozesses auftreten.</span><span class="sxs-lookup"><span data-stu-id="68b93-120">The data flow that is shown here might occur within a PMP process, or within an application process.</span></span>

 

<span data-ttu-id="68b93-121">Der Decoder empfängt verschlüsselte, komprimierte Videodaten aus einer externen Quelle.</span><span class="sxs-lookup"><span data-stu-id="68b93-121">The decoder receives encrypted, compressed video data from an external source.</span></span> <span data-ttu-id="68b93-122">Außerdem wird davon ausgegangen, dass der Decoder auch einen kryptografischen Schlüssel erhält, um diese Daten zu entschlüsseln.</span><span class="sxs-lookup"><span data-stu-id="68b93-122">It is assumed also the decoder also receives a cryptographic key to decrypt this data.</span></span> <span data-ttu-id="68b93-123">In diesem Thema wird nicht der Schlüsselaustausch zwischen der Videoquelle und dem Decoder beschrieben, aber das PMP definiert einen möglichen Mechanismus.</span><span class="sxs-lookup"><span data-stu-id="68b93-123">This topic does not describe the key exchange between the video source and decoder, but the PMP defines one possible mechanism.</span></span> <span data-ttu-id="68b93-124">Die GPU ist an dieser Phase nicht beteiligt.</span><span class="sxs-lookup"><span data-stu-id="68b93-124">The GPU is not involved at this stage.</span></span>

<span data-ttu-id="68b93-125">Bei der Hardware beschleunigten Decodierung übergibt der Software Decoder komprimierte Videoinhalte an die GPU.</span><span class="sxs-lookup"><span data-stu-id="68b93-125">For hardware-accelerated decoding, the software decoder passes compressed video content to the GPU.</span></span> <span data-ttu-id="68b93-126">Um diesen Inhalt zu schützen, verschlüsselt der Decoder die Daten, in der Regel AES-CTR, erneut, bevor Sie an den Hardwarebeschleuniger übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="68b93-126">To protect this content, the decoder re-encrypts the data, typically using AES-CTR, before passing it to the hardware accelerator.</span></span> <span data-ttu-id="68b93-127">Zwischen dem Decoder und dem Grafiktreiber wird ein Schlüsselaustausch Mechanismus definiert.</span><span class="sxs-lookup"><span data-stu-id="68b93-127">A key-exchange mechanism is defined between the decoder and the graphics driver.</span></span>

<span data-ttu-id="68b93-128">Decodierte Video Frames werden im Videospeicher gespeichert, in der Regel im Klartext.</span><span class="sxs-lookup"><span data-stu-id="68b93-128">Decoded video frames are stored in video memory, generally in the clear.</span></span> <span data-ttu-id="68b93-129">An diesem Punkt werden die Frames verarbeitet und dann dargestellt.</span><span class="sxs-lookup"><span data-stu-id="68b93-129">At this point, the frames are processed and then presented.</span></span> <span data-ttu-id="68b93-130">Es gibt zwei Hauptoptionen für die Präsentation.</span><span class="sxs-lookup"><span data-stu-id="68b93-130">There are two main options for presentation.</span></span>

-   <span data-ttu-id="68b93-131">Frames können mithilfe eines Hardware Überlagerungs Fensters angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="68b93-131">Frames can be presented using a hardware overlay.</span></span> <span data-ttu-id="68b93-132">Weitere Informationen finden Sie [unter Unterstützung für Hardware Überlagerung](hardware-overlay-support.md).</span><span class="sxs-lookup"><span data-stu-id="68b93-132">For more information, see [Hardware Overlay Support](hardware-overlay-support.md).</span></span>
-   <span data-ttu-id="68b93-133">Frames können von der Desktop Fensterverwaltung (DWM) mithilfe einer freigegebenen Oberfläche dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="68b93-133">Frames can be presented by the Desktop Window Manage (DWM) using a shared surface.</span></span>

<span data-ttu-id="68b93-134">Der letzte Schritt besteht darin, den Frame auf dem Monitor anzuzeigen, der möglicherweise einen Link Schutz zwischen der Grafikkarte und dem Anzeigegerät erfordert.</span><span class="sxs-lookup"><span data-stu-id="68b93-134">The last step is to display the frame on the monitor, which may require link protection between the graphics card and the display device.</span></span> <span data-ttu-id="68b93-135">Ein Beispiel für den Link Schutz ist High-Bandwidth Digital Content Protection (HDCP).</span><span class="sxs-lookup"><span data-stu-id="68b93-135">An example of link protection is High-Bandwidth Digital Content Protection (HDCP).</span></span> <span data-ttu-id="68b93-136">Der Link Schutz wird mithilfe von [Output Protection Manager](output-protection-manager.md) (OPM) konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="68b93-136">Link protection is configured using [Output Protection Manager](output-protection-manager.md) (OPM).</span></span> <span data-ttu-id="68b93-137">OPM wird in diesem Thema nicht beschrieben. Weitere Informationen finden Sie unter [Verwenden von Output Protection Manager](using-output-protection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="68b93-137">This topic does not describe OPM; for more information, see [Using Output Protection Manager](using-output-protection-manager.md).</span></span>

## <a name="overview-of-the-decoding-process"></a><span data-ttu-id="68b93-138">Übersicht über den Decodierungs Prozess</span><span class="sxs-lookup"><span data-stu-id="68b93-138">Overview of the Decoding Process</span></span>

<span data-ttu-id="68b93-139">Während der Hardware beschleunigten Decodierung muss der Software Decoder komprimierte Videodaten an die Grafikkarte übergeben.</span><span class="sxs-lookup"><span data-stu-id="68b93-139">During hardware-accelerated decoding, the software decoder must pass compressed video data to the graphics card.</span></span> <span data-ttu-id="68b93-140">Bei Premium-Inhalten müssen diese Daten in der Regel mithilfe der Verschlüsselung mit symmetrischen Schlüsseln verschlüsselt werden, bevor Sie an die GPU gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="68b93-140">For premium content, this data typically must be encrypted, using symmetric-key encryption, before it is sent to the GPU.</span></span>

<span data-ttu-id="68b93-141">Zum Verschlüsseln des Videos für die Decodierung verwendet der Software Decoder die folgenden Schnittstellen:</span><span class="sxs-lookup"><span data-stu-id="68b93-141">To encrypt the video for decoding, the software decoder uses the following interfaces:</span></span>

-   <span data-ttu-id="68b93-142">[**Idirectxvideodecoder**](/windows/desktop/api/dxva2api/nn-dxva2api-idirectxvideodecoder).</span><span class="sxs-lookup"><span data-stu-id="68b93-142">[**IDirectXVideoDecoder**](/windows/desktop/api/dxva2api/nn-dxva2api-idirectxvideodecoder).</span></span> <span data-ttu-id="68b93-143">Stellt das DXVA-Decoder-Gerät dar, das auch als Accelerator bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="68b93-143">Represents the DXVA decoder device, also called the accelerator.</span></span>
-   <span data-ttu-id="68b93-144">[**IDirect3DCryptoSession9**](/windows/desktop/api/d3d9/nn-d3d9-idirect3dcryptosession9).</span><span class="sxs-lookup"><span data-stu-id="68b93-144">[**IDirect3DCryptoSession9**](/windows/desktop/api/d3d9/nn-d3d9-idirect3dcryptosession9).</span></span> <span data-ttu-id="68b93-145">Stellt eine Kryptografiesitzung dar, die den Verschlüsselungsschlüssel bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="68b93-145">Represents a cryptographic session, which provides the encryption key.</span></span>
-   <span data-ttu-id="68b93-146">[**IDirect3DAuthenticatedChannel9**](/windows/desktop/api/d3d9/nn-d3d9-idirect3dauthenticatedchannel9).</span><span class="sxs-lookup"><span data-stu-id="68b93-146">[**IDirect3DAuthenticatedChannel9**](/windows/desktop/api/d3d9/nn-d3d9-idirect3dauthenticatedchannel9).</span></span> <span data-ttu-id="68b93-147">Stellt einen authentifizierten Kanal dar, der es dem Software Decoder ermöglicht, die Kryptografiesitzung dem DXVA-Decoder zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="68b93-147">Represents an authenticated channel, which enables the software decoder to associate the cryptographic session with the DXVA decoder.</span></span>

![ein Diagramm, das die von Direct3D9-Decodierungs Schnittstellen anzeigt.](images/d3d9video02.png)

<span data-ttu-id="68b93-149">Alle diese Schnittstellen werden vom Direct3D-Gerät wie folgt abgerufen:</span><span class="sxs-lookup"><span data-stu-id="68b93-149">All of these interfaces are obtained from the Direct3D device, as follows:</span></span>



| <span data-ttu-id="68b93-150">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="68b93-150">Interface</span></span>                                                                | <span data-ttu-id="68b93-151">Erstellung</span><span class="sxs-lookup"><span data-stu-id="68b93-151">Creation</span></span>                                                                                                                                                                      |
|--------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="68b93-152">**Idirectxvideodecoder**</span><span class="sxs-lookup"><span data-stu-id="68b93-152">**IDirectXVideoDecoder**</span></span>](/windows/desktop/api/dxva2api/nn-dxva2api-idirectxvideodecoder)                     | <span data-ttu-id="68b93-153">Aufrufen von [**idirectxvideodecoderservice:: createvideodecoder**](/windows/desktop/api/dxva2api/nf-dxva2api-idirectxvideodecoderservice-createvideodecoder).</span><span class="sxs-lookup"><span data-stu-id="68b93-153">Call [**IDirectXVideoDecoderService::CreateVideoDecoder**](/windows/desktop/api/dxva2api/nf-dxva2api-idirectxvideodecoderservice-createvideodecoder).</span></span> <span data-ttu-id="68b93-154">Das DXVA-Decodergerät wird durch eine DXVA-Profil-GUID identifiziert.</span><span class="sxs-lookup"><span data-stu-id="68b93-154">The DXVA decoder device is identified by a DXVA profile GUID.</span></span> |
| [<span data-ttu-id="68b93-155">**IDirect3DCryptoSession9**</span><span class="sxs-lookup"><span data-stu-id="68b93-155">**IDirect3DCryptoSession9**</span></span>](/windows/desktop/api/d3d9/nn-d3d9-idirect3dcryptosession9)               | <span data-ttu-id="68b93-156">Aufrufen von [**IDirect3DDevice9Video:: anatecrypdesession**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createcryptosession).</span><span class="sxs-lookup"><span data-stu-id="68b93-156">Call [**IDirect3DDevice9Video::CreateCryptoSession**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createcryptosession).</span></span>                                                                         |
| [<span data-ttu-id="68b93-157">**IDirect3DAuthenticatedChannel9**</span><span class="sxs-lookup"><span data-stu-id="68b93-157">**IDirect3DAuthenticatedChannel9**</span></span>](/windows/desktop/api/d3d9/nn-d3d9-idirect3dauthenticatedchannel9) | <span data-ttu-id="68b93-158">Aufrufen von [**IDirect3DDevice9Video:: kreateauthentiinitiedchannel**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createauthenticatedchannel).</span><span class="sxs-lookup"><span data-stu-id="68b93-158">Call [**IDirect3DDevice9Video::CreateAuthenticatedChannel**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createauthenticatedchannel).</span></span>                                                           |



 

> [!Note]  
> <span data-ttu-id="68b93-159">Zum Abrufen eines Zeigers auf die [**IDirect3DDevice9Video**](/windows/desktop/api/d3d9/nn-d3d9-idirect3ddevice9video) -Schnittstelle können Sie [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) auf einem D3D9Ex-Gerät abrufen.</span><span class="sxs-lookup"><span data-stu-id="68b93-159">To get a pointer to the [**IDirect3DDevice9Video**](/windows/desktop/api/d3d9/nn-d3d9-idirect3ddevice9video) interface, call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on a D3D9Ex device.</span></span>

 

<span data-ttu-id="68b93-160">Der authentifizierte Kanal bietet einen vertrauenswürdigen Kommunikationskanal zwischen dem Software Decoder und dem Treiber.</span><span class="sxs-lookup"><span data-stu-id="68b93-160">The authenticated channel provides a trusted communication channel between the software decoder and the driver.</span></span> <span data-ttu-id="68b93-161">Der Kommunikationskanal funktioniert wie folgt:</span><span class="sxs-lookup"><span data-stu-id="68b93-161">The communication channel works as follows:</span></span>

-   <span data-ttu-id="68b93-162">Der Treiber stellt eine X. 509-Zertifikat Kette bereit, deren Stamm Zertifikat von Microsoft signiert ist.</span><span class="sxs-lookup"><span data-stu-id="68b93-162">The driver provides an X.509 certificate chain whose root certificate is signed by Microsoft.</span></span>
-   <span data-ttu-id="68b93-163">Das Zertifikat enthält einen öffentlichen RSA-Schlüssel für den Treiber.</span><span class="sxs-lookup"><span data-stu-id="68b93-163">The certificate contains an RSA public key for the driver.</span></span>
-   <span data-ttu-id="68b93-164">Der Software Decoder verwendet den öffentlichen Schlüssel, um dem Treiber einen 128-Bit-AES-Sitzungsschlüssel zu senden.</span><span class="sxs-lookup"><span data-stu-id="68b93-164">The software decoder uses the public key to send the driver a 128-bit AES session key.</span></span>
-   <span data-ttu-id="68b93-165">Der Software Decoder sendet Abfragen und Befehle an den authentifizierten Kanal.</span><span class="sxs-lookup"><span data-stu-id="68b93-165">The software decoder sends queries and commands to the authenticated channel.</span></span>
-   <span data-ttu-id="68b93-166">Der Sitzungsschlüssel wird zum Berechnen von Nachrichten Authentifizierungscodes (Macs) für die Abfragen und Befehle verwendet.</span><span class="sxs-lookup"><span data-stu-id="68b93-166">The session key is used to compute message authentication codes (MACs) for the queries and commands.</span></span> <span data-ttu-id="68b93-167">Der Treiber verwendet die Macs, um die Integrität der Abfrage-/Befehlsdaten zu überprüfen, und der Software Decoder verwendet diese, um die Integrität der Antwortdaten des Treibers zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="68b93-167">The driver uses the MACs to verify the integrity of the query/command data, and the software decoder uses them to verify the integrity of the response data from the driver.</span></span>

## <a name="encrypting-compressed-video-buffers-for-the-decoder"></a><span data-ttu-id="68b93-168">Verschlüsseln komprimierter Video Puffer für den Decoder</span><span class="sxs-lookup"><span data-stu-id="68b93-168">Encrypting Compressed Video Buffers for the Decoder</span></span>

<span data-ttu-id="68b93-169">Im folgenden finden Sie eine allgemeine Übersicht über den Verschlüsselungs-und Decodierungs Prozess:</span><span class="sxs-lookup"><span data-stu-id="68b93-169">Here is a high-level overview of the encryption and decoding process:</span></span>

1.  <span data-ttu-id="68b93-170">Der Software Decoder empfängt einen Stream verschlüsselter Daten aus der Videoquelle.</span><span class="sxs-lookup"><span data-stu-id="68b93-170">The software decoder receives a stream of encrypted data from the video source.</span></span> <span data-ttu-id="68b93-171">Der Decoder entschlüsselt diesen Datenstrom.</span><span class="sxs-lookup"><span data-stu-id="68b93-171">The decoder decrypts this stream.</span></span>
2.  <span data-ttu-id="68b93-172">Der Software Decoder aushandiert einen Sitzungsschlüssel mit der Kryptografiesitzung.</span><span class="sxs-lookup"><span data-stu-id="68b93-172">The software decoder negotiates a session key with the cryptographic session.</span></span>
3.  <span data-ttu-id="68b93-173">Der Software Decoder verwendet den authentifizierten Kanal, um die Kryptografiesitzung dem DXVA-Decodergerät zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="68b93-173">The software decoder uses the authenticated channel to associate the cryptographic session with the DXVA decoder device.</span></span>
4.  <span data-ttu-id="68b93-174">Der Software Decoder fügt komprimierte Daten in DXVA-Puffer ein, die vom DXVA-Decodergerät (Accelerator) abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="68b93-174">The software decoder puts compressed data in DXVA buffers that it gets from the DXVA decoder device (accelerator).</span></span> <span data-ttu-id="68b93-175">Für geschützte Inhalte verschlüsselt der Software Encoder die Daten, die in die DXVA-Puffer eingefügt werden, unter Verwendung des Sitzungsschlüssels für die Verschlüsselung.</span><span class="sxs-lookup"><span data-stu-id="68b93-175">For protected content, the software encoder encrypts the data that is puts into the DXVA buffers, using the session key for the encryption.</span></span>
    > [!Note]  
    > <span data-ttu-id="68b93-176">Einige Treiber verwenden einen Inhalts Schlüssel anstelle des Sitzungsschlüssels für die Verschlüsselung.</span><span class="sxs-lookup"><span data-stu-id="68b93-176">Some drivers use a content key, instead of the session key, for encryption.</span></span> <span data-ttu-id="68b93-177">Der Inhalts Schlüssel kann sich von einem Frame zur nächsten ändern.</span><span class="sxs-lookup"><span data-stu-id="68b93-177">The content key could change from one frame to the next.</span></span>

     

5.  <span data-ttu-id="68b93-178">Der Decoder übergibt die verschlüsselten komprimierten Puffer an die Zugriffstaste.</span><span class="sxs-lookup"><span data-stu-id="68b93-178">The decoder submits the encrypted compressed buffers to the accelerator.</span></span> <span data-ttu-id="68b93-179">Für AES-CTR übergibt der Decoder auch den Initialisierungs Vektor.</span><span class="sxs-lookup"><span data-stu-id="68b93-179">For AES-CTR, the decoder also passes the initialization vector.</span></span> <span data-ttu-id="68b93-180">Wenn ein Inhalts Schlüssel verwendet wird, übergibt der Decoder den Inhalts Schlüssel, der mit dem Sitzungsschlüssel verschlüsselt wurde.</span><span class="sxs-lookup"><span data-stu-id="68b93-180">If a content key is used, the decoder passes content key, encrypted using the session key.</span></span>

<span data-ttu-id="68b93-181">Direct3D verfügt über Standardunterstützung für 128-Bit-AES-CTR, wurde jedoch für die Erweiterung auf zusätzliche Verschlüsselungstypen entwickelt.</span><span class="sxs-lookup"><span data-stu-id="68b93-181">Direct3D has standard support for 128-bit AES-CTR, but is designed to extend to additional encryption types.</span></span>

<span data-ttu-id="68b93-182">In den nächsten fünf Abschnitten finden Sie ausführlichere Schritte.</span><span class="sxs-lookup"><span data-stu-id="68b93-182">The next five sections give more detailed steps.</span></span>

-   [<span data-ttu-id="68b93-183">1. Abfragen der Content Protection Funktionen des Treibers</span><span class="sxs-lookup"><span data-stu-id="68b93-183">1. Query the Content Protection Capabilities of the Driver</span></span>](#1-query-the-content-protection-capabilities-of-the-driver)
-   [<span data-ttu-id="68b93-184">2. Konfigurieren des authentifizierten Kanals</span><span class="sxs-lookup"><span data-stu-id="68b93-184">2. Configure the Authenticated Channel</span></span>](#2-configure-the-authenticated-channel)
-   [<span data-ttu-id="68b93-185">3. Konfigurieren der Kryptografiesitzung</span><span class="sxs-lookup"><span data-stu-id="68b93-185">3. Configure the Cryptographic Session</span></span>](#3-configure-the-cryptographic-session)
-   [<span data-ttu-id="68b93-186">4. erhalten Sie ein Handle für das DXVA-Decodergerät.</span><span class="sxs-lookup"><span data-stu-id="68b93-186">4. Get a Handle to the DXVA Decoder Device</span></span>](#4-get-a-handle-to-the-dxva-decoder-device)
-   [<span data-ttu-id="68b93-187">5. Zuordnen des DXVA-Decoders zur Kryptografiesitzung</span><span class="sxs-lookup"><span data-stu-id="68b93-187">5. Associate the DXVA Decoder with the Cryptographic Session</span></span>](#5-associate-the-dxva-decoder-with-the-cryptographic-session)

### <a name="1-query-the-content-protection-capabilities-of-the-driver"></a><span data-ttu-id="68b93-188">1. Abfragen der Content Protection Funktionen des Treibers</span><span class="sxs-lookup"><span data-stu-id="68b93-188">1. Query the Content Protection Capabilities of the Driver</span></span>

<span data-ttu-id="68b93-189">Bevor Sie versuchen, die Verschlüsselung anzuwenden, sollten Sie die inhaltsschutzfunktionen des Treibers erhalten.</span><span class="sxs-lookup"><span data-stu-id="68b93-189">Before attempting to apply encryption, get the content protection capabilities of the driver.</span></span>

1.  <span data-ttu-id="68b93-190">Einen Zeiger auf das Direct3D 9-Gerät erhalten.</span><span class="sxs-lookup"><span data-stu-id="68b93-190">Get a pointer to the Direct3D 9 device.</span></span>
2.  <span data-ttu-id="68b93-191">Ruft [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) für die [**IDirect3DDevice9Video**](/windows/desktop/api/d3d9/nn-d3d9-idirect3ddevice9video) -Schnittstelle auf.</span><span class="sxs-lookup"><span data-stu-id="68b93-191">Call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the [**IDirect3DDevice9Video**](/windows/desktop/api/d3d9/nn-d3d9-idirect3ddevice9video) interface.</span></span>
3.  <span data-ttu-id="68b93-192">Aufrufen von [**IDirect3DDevice9Video:: getcontentschutzcaps**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-getcontentprotectioncaps).</span><span class="sxs-lookup"><span data-stu-id="68b93-192">Call [**IDirect3DDevice9Video::GetContentProtectionCaps**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-getcontentprotectioncaps).</span></span> <span data-ttu-id="68b93-193">Diese Methode füllt eine [**D3DCONTENTPROTECTIONCAPS**](/windows/desktop/api/d3d9caps/ns-d3d9caps-d3dcontentprotectioncaps) -Struktur mit den inhaltsschutzfunktionen des Treibers aus.</span><span class="sxs-lookup"><span data-stu-id="68b93-193">This method fills in a [**D3DCONTENTPROTECTIONCAPS**](/windows/desktop/api/d3d9caps/ns-d3d9caps-d3dcontentprotectioncaps) structure with the driver’s content protection capabilities.</span></span>

<span data-ttu-id="68b93-194">Achten Sie insbesondere auf die folgenden Funktionen:</span><span class="sxs-lookup"><span data-stu-id="68b93-194">In particular, look for the following capabilities:</span></span>

-   <span data-ttu-id="68b93-195">Wenn das **Caps** -Mitglied die **D3DCPCAPS_SOFTWARE** oder **D3DCPCAPS_HARDWARE** -Flag enthält, kann der Treiber die Verschlüsselung ausführen.</span><span class="sxs-lookup"><span data-stu-id="68b93-195">If the **Caps** member contains the **D3DCPCAPS_SOFTWARE** or **D3DCPCAPS_HARDWARE** flag, the driver can perform encryption.</span></span>
-   <span data-ttu-id="68b93-196">Der **keyexchangetype** -Member gibt an, wie der Schlüsselaustausch für den Sitzungsschlüssel durchgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="68b93-196">The **KeyExchangeType** member specifies how to perform key exchange for the session key.</span></span>
-   <span data-ttu-id="68b93-197">Wenn das **Caps** -Element das **D3DCPCAPS_CONTENTKEY** -Flag enthält, verwendet der Treiber einen separaten Inhalts Schlüssel für die Verschlüsselung.</span><span class="sxs-lookup"><span data-stu-id="68b93-197">If the **Caps** member contains the **D3DCPCAPS_CONTENTKEY** flag, the driver uses a separate content key for encryption.</span></span> <span data-ttu-id="68b93-198">Dies ist wichtig, wenn Sie den Sitzungsschlüssel generieren.</span><span class="sxs-lookup"><span data-stu-id="68b93-198">This is important when you generate the session key.</span></span>

<span data-ttu-id="68b93-199">Zusätzliche Funktionen werden im **Caps** -Member angezeigt.</span><span class="sxs-lookup"><span data-stu-id="68b93-199">Additional capabilities are indicated in the **Caps** member.</span></span>

### <a name="2-configure-the-authenticated-channel"></a><span data-ttu-id="68b93-200">2. Konfigurieren des authentifizierten Kanals</span><span class="sxs-lookup"><span data-stu-id="68b93-200">2. Configure the Authenticated Channel</span></span>

<span data-ttu-id="68b93-201">Der nächste Schritt besteht darin, den authentifizierten Kanal zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="68b93-201">The next step is to configure the authenticated channel.</span></span>

1.  <span data-ttu-id="68b93-202">Rufen Sie [**IDirect3DDevice9Video:: kreateauthentiinitiedchannel**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createauthenticatedchannel) auf, um den authentifizierten Kanal zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="68b93-202">Call [**IDirect3DDevice9Video::CreateAuthenticatedChannel**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createauthenticatedchannel) to create the authenticated channel.</span></span> <span data-ttu-id="68b93-203">Geben Sie für den *channelType* -Parameter einen Kanaltyp an, der mit den Funktionen des Treibers übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="68b93-203">For the *ChannelType* parameter, specify a channel type that matches the capabilities of the driver.</span></span>
    -   <span data-ttu-id="68b93-204">Der **D3DAUTHENTICATEDCHANNEL_DRIVER_SOFTWARE** Kanaltyp entspricht **D3DCPCAPS_SOFTWARE**.</span><span class="sxs-lookup"><span data-stu-id="68b93-204">The **D3DAUTHENTICATEDCHANNEL_DRIVER_SOFTWARE** channel type corresponds to **D3DCPCAPS_SOFTWARE**.</span></span>
    -   <span data-ttu-id="68b93-205">Der **D3DAUTHENTICATEDCHANNEL_DRIVER_HARDWARE** Kanaltyp entspricht **D3DCPCAPS_HARDWARE**.</span><span class="sxs-lookup"><span data-stu-id="68b93-205">The **D3DAUTHENTICATEDCHANNEL_DRIVER_HARDWARE** channel type corresponds to **D3DCPCAPS_HARDWARE**.</span></span>

    <span data-ttu-id="68b93-206">Die Methode "Methode" gibt einen Zeiger auf die [**IDirect3DAuthenticatedChannel9**](/windows/desktop/api/d3d9/nn-d3d9-idirect3dauthenticatedchannel9) -Schnittstelle zusammen mit einem Handle für **den Kanal zurück** .</span><span class="sxs-lookup"><span data-stu-id="68b93-206">The **CreateAuthenticatedChannel** method returns a pointer to the [**IDirect3DAuthenticatedChannel9**](/windows/desktop/api/d3d9/nn-d3d9-idirect3dauthenticatedchannel9) interface along with a handle to the channel.</span></span> <span data-ttu-id="68b93-207">Das Handle wird später verwendet, um die Kryptografiesitzung dem authentifizierten Kanal zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="68b93-207">The handle is used later to associate the cryptographic session with the authenticated channel.</span></span>
2.  <span data-ttu-id="68b93-208">Aufrufen von [**IDirect3DAuthenticatedChannel9:: getcertifikatesize**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-getcertificatesize) zum Abrufen der Größe des X. 509-Zertifikats des Treibers.</span><span class="sxs-lookup"><span data-stu-id="68b93-208">Call [**IDirect3DAuthenticatedChannel9::GetCertificateSize**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-getcertificatesize) to get the size of the driver's X.509 certificate.</span></span> <span data-ttu-id="68b93-209">Weisen Sie einen Puffer mit der erforderlichen Größe zu.</span><span class="sxs-lookup"><span data-stu-id="68b93-209">Allocate a buffer of the required size.</span></span>
3.  <span data-ttu-id="68b93-210">Aufrufen von [**IDirect3DAuthenticatedChannel9:: GetCertificate**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-getcertificate) zum Abrufen des Zertifikats.</span><span class="sxs-lookup"><span data-stu-id="68b93-210">Call [**IDirect3DAuthenticatedChannel9::GetCertificate**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-getcertificate) to get the certificate.</span></span> <span data-ttu-id="68b93-211">Die-Methode kopiert das Zertifikat in den Puffer, der im vorherigen Schritt zugeordnet wurde.</span><span class="sxs-lookup"><span data-stu-id="68b93-211">The method copies the certificate into the buffer that was allocated in the previous step.</span></span>
4.  <span data-ttu-id="68b93-212">Vergewissern Sie sich, dass das Zertifikat des Treibers von Microsoft signiert wurde und nicht widerrufen wurde.</span><span class="sxs-lookup"><span data-stu-id="68b93-212">Verify that the driver’s certificate was signed by Microsoft and has not been revoked.</span></span>
5.  <span data-ttu-id="68b93-213">Den öffentlichen Schlüssel aus dem Zertifikat zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="68b93-213">Get the public key from the certificate.</span></span>
6.  <span data-ttu-id="68b93-214">Generieren Sie einen zufälligen RSA-Sitzungsschlüssel.</span><span class="sxs-lookup"><span data-stu-id="68b93-214">Generate a random RSA session key.</span></span> <span data-ttu-id="68b93-215">Dieser Sitzungsschlüssel wird zum Signieren von Daten verwendet, die an den authentifizierten Kanal gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="68b93-215">This session key is used to sign data that is sent to the authenticated channel.</span></span> <span data-ttu-id="68b93-216">Verschlüsseln Sie den Sitzungsschlüssel mit dem öffentlichen Schlüssel des Treibers.</span><span class="sxs-lookup"><span data-stu-id="68b93-216">Encrypt the session key using the driver's public key.</span></span>
7.  <span data-ttu-id="68b93-217">Aufrufen von [**IDirect3DAuthenticatedChannel9:: aushandatekeyexchange**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-negotiatekeyexchange) , um den verschlüsselten Sitzungsschlüssel an den Treiber zu senden.</span><span class="sxs-lookup"><span data-stu-id="68b93-217">Call [**IDirect3DAuthenticatedChannel9::NegotiateKeyExchange**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-negotiatekeyexchange) to send the encrypted session key to the driver.</span></span>
8.  <span data-ttu-id="68b93-218">Initialisieren Sie den sicheren Kanal wie folgt:</span><span class="sxs-lookup"><span data-stu-id="68b93-218">Initialize the secure channel as follows:</span></span>
    1.  <span data-ttu-id="68b93-219">Füllen Sie eine [**D3DAUTHENTICATEDCHANNEL_CONFIGUREINITIALIZE**](d3dauthenticatedchannel-configureinitialize.md) Struktur aus, wie in der Dokumentation beschrieben.</span><span class="sxs-lookup"><span data-stu-id="68b93-219">Fill in a [**D3DAUTHENTICATEDCHANNEL_CONFIGUREINITIALIZE**](d3dauthenticatedchannel-configureinitialize.md) structure as described in the documentation.</span></span>
    2.  <span data-ttu-id="68b93-220">Senden Sie den [**D3DAUTHENTICATEDCONFIGURE_INITIALIZE**](d3dauthenticatedconfigure-initialize.md) Befehl, indem Sie [**IDirect3DAuthenticatedChannel9:: Configure**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-configure) aufrufen, wie im Abschnitt [Senden von authentifizierten Kanal Befehlen](#sending-authenticated-channel-commands)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="68b93-220">Send the [**D3DAUTHENTICATEDCONFIGURE_INITIALIZE**](d3dauthenticatedconfigure-initialize.md) command by calling [**IDirect3DAuthenticatedChannel9::Configure**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-configure) as described in the section [Sending Authenticated Channel Commands](#sending-authenticated-channel-commands).</span></span> <span data-ttu-id="68b93-221">Dieser Befehl enthält die Startsequenz Nummern für die Befehle und Abfragen, die an den authentifizierten Kanal gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="68b93-221">This command contains the starting sequence numbers for the commands and queries that are sent to the authenticated channel.</span></span>
9.  <span data-ttu-id="68b93-222">Überprüfen Sie den Kanaltyp, indem Sie eine [**D3DAUTHENTICATEDQUERY_CHANNELTYPE**](d3dauthenticatedquery-channeltype.md) Abfrage an den authentifizierten Kanal senden, wie im Abschnitt [Senden von authentifizierten Kanal Abfragen](#sending-authenticated-channel-queries)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="68b93-222">Verify the channel type by sending a [**D3DAUTHENTICATEDQUERY_CHANNELTYPE**](d3dauthenticatedquery-channeltype.md) query to the authenticated channel, as described in the section [Sending Authenticated Channel Queries](#sending-authenticated-channel-queries).</span></span> <span data-ttu-id="68b93-223">Überprüfen Sie, ob der Kanaltyp mit dem übereinstimmt [**, den Sie in der Methode "**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createauthenticatedchannel) Methode" von "" aufgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="68b93-223">Check that the channel type matches what you specified in the [**CreateAuthenticatedChannel**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createauthenticatedchannel) method.</span></span>

### <a name="3-configure-the-cryptographic-session"></a><span data-ttu-id="68b93-224">3. Konfigurieren der Kryptografiesitzung</span><span class="sxs-lookup"><span data-stu-id="68b93-224">3. Configure the Cryptographic Session</span></span>

<span data-ttu-id="68b93-225">Konfigurieren Sie als nächstes die Kryptografiesitzung, und legen Sie den Sitzungsschlüssel fest.</span><span class="sxs-lookup"><span data-stu-id="68b93-225">Next, configure the cryptographic session and establish the session key.</span></span>

1.  <span data-ttu-id="68b93-226">Rufen Sie [**IDirect3DDevice9Video:: featecrypdesession**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createcryptosession) auf, um die Kryptografiesitzung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="68b93-226">Call [**IDirect3DDevice9Video::CreateCryptoSession**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createcryptosession) to create the cryptographic session.</span></span> <span data-ttu-id="68b93-227">Diese Methode gibt einen Zeiger auf die [**IDirect3DCryptoSession9**](/windows/desktop/api/d3d9/nn-d3d9-idirect3dcryptosession9) -Schnittstelle und zusammen mit einem Handle zur Kryptografiesitzung zurück.</span><span class="sxs-lookup"><span data-stu-id="68b93-227">This method returns a pointer to the [**IDirect3DCryptoSession9**](/windows/desktop/api/d3d9/nn-d3d9-idirect3dcryptosession9) interface and along with a handle to the cryptographic session.</span></span>
2.  <span data-ttu-id="68b93-228">Aufrufen von [**IDirect3DCryptoSession9:: getcertifikatesize**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dcryptosession9-getcertificatesize) zum Abrufen der Größe des X. 509-Zertifikats des Treibers.</span><span class="sxs-lookup"><span data-stu-id="68b93-228">Call [**IDirect3DCryptoSession9::GetCertificateSize**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dcryptosession9-getcertificatesize) to get the size of the driver's X.509 certificate.</span></span> <span data-ttu-id="68b93-229">Weisen Sie einen Puffer mit der erforderlichen Größe zu.</span><span class="sxs-lookup"><span data-stu-id="68b93-229">Allocate a buffer of the required size.</span></span>
3.  <span data-ttu-id="68b93-230">Aufrufen von [**IDirect3DCryptoSession9:: GetCertificate**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dcryptosession9-getcertificate) zum Abrufen des Zertifikats.</span><span class="sxs-lookup"><span data-stu-id="68b93-230">Call [**IDirect3DCryptoSession9::GetCertificate**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dcryptosession9-getcertificate) to get the certificate.</span></span> <span data-ttu-id="68b93-231">Die-Methode kopiert das Zertifikat in den Puffer, der im vorherigen Schritt zugeordnet wurde.</span><span class="sxs-lookup"><span data-stu-id="68b93-231">The method copies the certificate into the buffer that was allocated in the previous step.</span></span>
4.  <span data-ttu-id="68b93-232">Vergewissern Sie sich, dass das Zertifikat des Treibers von Microsoft signiert wurde und nicht widerrufen wurde.</span><span class="sxs-lookup"><span data-stu-id="68b93-232">Verify that the driver’s certificate was signed by Microsoft and has not been revoked.</span></span>
5.  <span data-ttu-id="68b93-233">Den öffentlichen Schlüssel aus dem Zertifikat zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="68b93-233">Get the public key from the certificate.</span></span>
6.  <span data-ttu-id="68b93-234">Generieren Sie einen zufälligen RSA-Sitzungsschlüssel.</span><span class="sxs-lookup"><span data-stu-id="68b93-234">Generate a random RSA session key.</span></span> <span data-ttu-id="68b93-235">Dabei handelt es sich um einen separaten Sitzungsschlüssel aus dem authentifizierten channelsitzungsschlüssel.</span><span class="sxs-lookup"><span data-stu-id="68b93-235">This is a separate session key from the authenticated channel session key.</span></span> <span data-ttu-id="68b93-236">Verschlüsseln Sie den Sitzungsschlüssel mit dem öffentlichen Schlüssel des Treibers.</span><span class="sxs-lookup"><span data-stu-id="68b93-236">Encrypt the session key using the driver's public key.</span></span>
7.  <span data-ttu-id="68b93-237">Aufrufen von [**IDirect3DCryptoSession9:: aushandatekeyexchange**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-negotiatekeyexchange) , um den verschlüsselten Sitzungsschlüssel an den Treiber zu senden.</span><span class="sxs-lookup"><span data-stu-id="68b93-237">Call [**IDirect3DCryptoSession9::NegotiateKeyExchange**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-negotiatekeyexchange) to send the encrypted session key to the driver.</span></span>
8.  <span data-ttu-id="68b93-238">Wenn die inhaltsschutzfunktionen **D3DCPCAPS_CONTENTKEY** enthalten, erstellen Sie einen zufälligen RSA-Inhalts Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="68b93-238">If the content protection capabilities include **D3DCPCAPS_CONTENTKEY**, create a random RSA content key.</span></span> <span data-ttu-id="68b93-239">Diese wird später im Decodierungs Vorgang verwendet.</span><span class="sxs-lookup"><span data-stu-id="68b93-239">This will be used later in the decoding process.</span></span>

### <a name="4-get-a-handle-to-the-dxva-decoder-device"></a><span data-ttu-id="68b93-240">4. erhalten Sie ein Handle für das DXVA-Decodergerät.</span><span class="sxs-lookup"><span data-stu-id="68b93-240">4. Get a Handle to the DXVA Decoder Device</span></span>

<span data-ttu-id="68b93-241">Für den nächsten Schritt benötigen Sie ein Handle für das DXVA-Decodergerät.</span><span class="sxs-lookup"><span data-stu-id="68b93-241">For the next step, you will need a handle to the DXVA decoder device.</span></span> <span data-ttu-id="68b93-242">Um dieses Handle zu erhalten, füllen Sie eine DXVA2_DecodeExecuteParams Struktur wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="68b93-242">To get this handle, fill in a DXVA2_DecodeExecuteParams structure as follows:</span></span>


```C++
HANDLE hDecodeDeviceHandle;

DXVA2_DecodeExecuteParams execParams = {0};
DXVA2_DecodeExtensionData ExtensionExecute = {0};
    
execParams.NumCompBuffers = 0;
execParams.pCompressedBuffers = NULL;
execParams.pExtensionData = &ExtensionExecute;

ExtensionExecute.Function = DXVA2_DECODE_GET_DRIVER_HANDLE;
ExtensionExecute.pPrivateInputData = NULL;
ExtensionExecute.PrivateInputDataSize = 0;
ExtensionExecute.pPrivateOutputData = &hDecodeDeviceHandle;
ExtensionExecute.PrivateOutputDataSize = sizeof(HANDLE);
```



<span data-ttu-id="68b93-243">Legen Sie den **pextensiondata** -Member der [**DXVA2_DecodeExecuteParams**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodeexecuteparams) -Struktur auf die Adresse einer [**DXVA2_DecodeExtensionData**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodeextensiondata) Struktur fest.</span><span class="sxs-lookup"><span data-stu-id="68b93-243">Set the **pExtensionData** member of the [**DXVA2_DecodeExecuteParams**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodeexecuteparams) structure to the address of a [**DXVA2_DecodeExtensionData**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodeextensiondata) structure.</span></span>

<span data-ttu-id="68b93-244">Legen Sie in der [**DXVA2_DecodeExtensionData**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodeextensiondata) Struktur den **Funktionsmember** auf **DXVA2_DECODE_GET_DRIVER_HANDLE** fest.</span><span class="sxs-lookup"><span data-stu-id="68b93-244">In the [**DXVA2_DecodeExtensionData**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodeextensiondata) structure, set the **Function** member to **DXVA2_DECODE_GET_DRIVER_HANDLE**.</span></span> <span data-ttu-id="68b93-245">Legen Sie **pprivateoutputdata** auf die Adresse eines Puffers fest, der groß genug ist, um einen **handle** -Wert zu speichern.</span><span class="sxs-lookup"><span data-stu-id="68b93-245">Set **pPrivateOutputData** to the address of a buffer that is large enough to store a **HANDLE** value.</span></span> <span data-ttu-id="68b93-246">(Im vorherigen Beispiel ist dieser Puffer die Variable *hdecodedevicehandle* .)</span><span class="sxs-lookup"><span data-stu-id="68b93-246">(In the previous example, this buffer is the *hDecodeDeviceHandle* variable.)</span></span>

<span data-ttu-id="68b93-247">Nennen Sie dann [**idirectxvideodecoder:: Execute**](/windows/desktop/api/dxva2api/nf-dxva2api-idirectxvideodecoder-execute) , und übergeben Sie die Adresse der [**DXVA2_DecodeExecuteParams**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodeexecuteparams) Struktur.</span><span class="sxs-lookup"><span data-stu-id="68b93-247">Then call [**IDirectXVideoDecoder::Execute**](/windows/desktop/api/dxva2api/nf-dxva2api-idirectxvideodecoder-execute) and pass in the address of the [**DXVA2_DecodeExecuteParams**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodeexecuteparams) structure.</span></span> <span data-ttu-id="68b93-248">Das Handle für den DXVA-Decoder wird in " **pprivateoutputdata**" zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="68b93-248">The handle to the DXVA decoder is returned in **pPrivateOutputData**.</span></span>

### <a name="5-associate-the-dxva-decoder-with-the-cryptographic-session"></a><span data-ttu-id="68b93-249">5. Zuordnen des DXVA-Decoders zur Kryptografiesitzung</span><span class="sxs-lookup"><span data-stu-id="68b93-249">5. Associate the DXVA Decoder with the Cryptographic Session</span></span>

<span data-ttu-id="68b93-250">Ordnen Sie anschließend das DXVA-Decodergerät dem Direct3D-Gerät und der Kryptografiesitzung wie folgt zu:</span><span class="sxs-lookup"><span data-stu-id="68b93-250">Next, associate the DXVA decoder device with the Direct3D device and the cryptographic session, as follows:</span></span>

1.  <span data-ttu-id="68b93-251">Erhalten Sie ein Handle für das DXVA-Decodergerät, wie im vorherigen Abschnitt beschrieben.</span><span class="sxs-lookup"><span data-stu-id="68b93-251">Get a handle to the DXVA decoder device, as described in the previous section.</span></span>
2.  <span data-ttu-id="68b93-252">Sie erhalten ein Handle für das Direct3D-Gerät, indem Sie eine [**D3DAUTHENTICATEDQUERY_DEVICEHANDLE**](d3dauthenticatedquery-devicehandle.md) Abfrage an den authentifizierten Kanal senden.</span><span class="sxs-lookup"><span data-stu-id="68b93-252">Get a handle to the Direct3D device, by sending a [**D3DAUTHENTICATEDQUERY_DEVICEHANDLE**](d3dauthenticatedquery-devicehandle.md) query to the authenticated channel.</span></span>
3.  <span data-ttu-id="68b93-253">Fügen Sie eine [**D3DAUTHENTICATEDCHANNEL_CONFIGURECRYPTOSESSION**](d3dauthenticatedchannel-configurecryptosession.md) Struktur mit den folgenden Informationen ein:</span><span class="sxs-lookup"><span data-stu-id="68b93-253">Fill in a [**D3DAUTHENTICATEDCHANNEL_CONFIGURECRYPTOSESSION**](d3dauthenticatedchannel-configurecryptosession.md) structure with the following information:</span></span>
    -   <span data-ttu-id="68b93-254">Legen Sie den **DXVA2DecodeHandle** -Member auf das Handle des DXVA-decodergeräts fest.</span><span class="sxs-lookup"><span data-stu-id="68b93-254">Set the **DXVA2DecodeHandle** member to the handle to the DXVA decoder device.</span></span>
    -   <span data-ttu-id="68b93-255">Legen Sie den **cryptosessionhandle** -Member auf das Handle der Kryptografiesitzung fest.</span><span class="sxs-lookup"><span data-stu-id="68b93-255">Set the **CryptoSessionHandle** member to the handle to the cryptographic session.</span></span> <span data-ttu-id="68b93-256">Dieses Handle wird von der [**IDirect3DDevice9Video:: featecryptosession**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createcryptosession) -Methode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="68b93-256">This handle is returned by the [**IDirect3DDevice9Video::CreateCryptoSession**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9video-createcryptosession) method.</span></span>
    -   <span data-ttu-id="68b93-257">Legen Sie das Element " **envicehandle** " auf das Direct3D-Geräte Handle fest.</span><span class="sxs-lookup"><span data-stu-id="68b93-257">Set the **DeviceHandle** member to the Direct3D device handle.</span></span>
4.  <span data-ttu-id="68b93-258">[**IDirect3DAuthenticatedChannel9:: Configure**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-configure) , um einen [**D3DAUTHENTICATEDCONFIGURE_CRYPTOSESSION**](d3dauthenticatedconfigure-cryptosession.md) Befehl an den authentifizierten Kanal zu senden.</span><span class="sxs-lookup"><span data-stu-id="68b93-258">Call [**IDirect3DAuthenticatedChannel9::Configure**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-configure) to send a [**D3DAUTHENTICATEDCONFIGURE_CRYPTOSESSION**](d3dauthenticatedconfigure-cryptosession.md) command to the authenticated channel.</span></span>

<span data-ttu-id="68b93-259">Das folgende Diagramm veranschaulicht den Austausch von Handles:</span><span class="sxs-lookup"><span data-stu-id="68b93-259">The following diagram illustrates the exchange of handles:</span></span>

![ein Diagramm, das zeigt, wie der DXVA-Decoder der Kryptografiesitzung zugeordnet wird.](images/d3d9video03.png)

<span data-ttu-id="68b93-261">Der Software Decoder kann nun den kryptografiesitzungsschlüssel verwenden, um die komprimierten Video Puffer zu verschlüsseln.</span><span class="sxs-lookup"><span data-stu-id="68b93-261">The software decoder can now use the cryptographic session key to encrypt the compressed video buffers.</span></span> <span data-ttu-id="68b93-262">Jeder komprimierte Puffer verfügt über einen eigenen Initialisierungs Vektor (IV), der im **pvpvpstate** -Member der [**DXVA2_DecodeBufferDesc**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodebufferdesc) Struktur angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="68b93-262">Each compressed buffer will have its own initialization vector (IV) specified in the **pvPVPState** member of the [**DXVA2_DecodeBufferDesc**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_decodebufferdesc) structure.</span></span>

## <a name="sending-authenticated-channel-commands"></a><span data-ttu-id="68b93-263">Senden von authentifizierten Kanal Befehlen</span><span class="sxs-lookup"><span data-stu-id="68b93-263">Sending Authenticated Channel Commands</span></span>

<span data-ttu-id="68b93-264">Ein Satz von Befehlen wird zum Konfigurieren des authentifizierten Kanals und zum Festlegen verschiedener Inhalts Schutzmaßnahmen definiert.</span><span class="sxs-lookup"><span data-stu-id="68b93-264">A set of commands are defined for configuring the authenticated channel and setting various content protections.</span></span> <span data-ttu-id="68b93-265">Eine Liste der Befehle finden Sie unter [Content Protection-Befehle](content-protection-commands.md).</span><span class="sxs-lookup"><span data-stu-id="68b93-265">For a list of commands, see [Content Protection Commands](content-protection-commands.md).</span></span>

<span data-ttu-id="68b93-266">Führen Sie die folgenden Schritte aus, um einen Befehl an den authentifizierten Kanal zu senden.</span><span class="sxs-lookup"><span data-stu-id="68b93-266">To send a command to the authenticated channel, perform the following steps.</span></span>

1.  <span data-ttu-id="68b93-267">Füllen Sie die Eingabedaten Struktur aus.</span><span class="sxs-lookup"><span data-stu-id="68b93-267">Fill in the input data structure.</span></span> <span data-ttu-id="68b93-268">Diese Datenstruktur ist immer eine [**D3DAUTHENTICATEDCHANNEL_CONFIGURE_INPUT**](d3dauthenticatedchannel-configure-input.md) Struktur, gefolgt von zusätzlichen Feldern.</span><span class="sxs-lookup"><span data-stu-id="68b93-268">This data structure is always a [**D3DAUTHENTICATEDCHANNEL_CONFIGURE_INPUT**](d3dauthenticatedchannel-configure-input.md) structure followed by additional fields.</span></span> <span data-ttu-id="68b93-269">Füllen Sie die **D3DAUTHENTICATEDCHANNEL_CONFIGURE_INPUT** Struktur aus, wie in der folgenden Tabelle gezeigt.</span><span class="sxs-lookup"><span data-stu-id="68b93-269">Fill in the **D3DAUTHENTICATEDCHANNEL_CONFIGURE_INPUT** structure as shown in the following table.</span></span>

    <table>
    <colgroup>
    <col style="width: 50%" />
    <col style="width: 50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th><span data-ttu-id="68b93-270">Member</span><span class="sxs-lookup"><span data-stu-id="68b93-270">Member</span></span></th>
    <th><span data-ttu-id="68b93-271">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="68b93-271">Description</span></span></th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td><span data-ttu-id="68b93-272"><strong>OMAC</strong></span><span class="sxs-lookup"><span data-stu-id="68b93-272"><strong>omac</strong></span></span></td>
    <td><span data-ttu-id="68b93-273">Dieses Feld jetzt überspringen.</span><span class="sxs-lookup"><span data-stu-id="68b93-273">Skip this field for now.</span></span></td>
    </tr>
    <tr class="even">
    <td><span data-ttu-id="68b93-274"><strong>Konfiguriertyp</strong></span><span class="sxs-lookup"><span data-stu-id="68b93-274"><strong>ConfigureType</strong></span></span></td>
    <td><span data-ttu-id="68b93-275">GUID, die den Befehl identifiziert.</span><span class="sxs-lookup"><span data-stu-id="68b93-275">GUID that identifies the command.</span></span> <span data-ttu-id="68b93-276">Eine Liste der Befehle finden Sie unter <a href="content-protection-commands.md">Content Protection-Befehle</a>.</span><span class="sxs-lookup"><span data-stu-id="68b93-276">For a list of commands, see <a href="content-protection-commands.md">Content Protection Commands</a>.</span></span></td>
    </tr>
    <tr class="odd">
    <td><span data-ttu-id="68b93-277"><strong>hchannel</strong></span><span class="sxs-lookup"><span data-stu-id="68b93-277"><strong>hChannel</strong></span></span></td>
    <td><span data-ttu-id="68b93-278">Das Handle für den authentifizierten Kanal.</span><span class="sxs-lookup"><span data-stu-id="68b93-278">The handle to the authenticated channel.</span></span></td>
    </tr>
    <tr class="even">
    <td><span data-ttu-id="68b93-279"><strong>SequenceNumber</strong></span><span class="sxs-lookup"><span data-stu-id="68b93-279"><strong>SequenceNumber</strong></span></span></td>
    <td><span data-ttu-id="68b93-280">Die Sequenznummer.</span><span class="sxs-lookup"><span data-stu-id="68b93-280">The sequence number.</span></span> <span data-ttu-id="68b93-281">Die erste Sequenznummer wird durch Senden eines <a href="d3dauthenticatedconfigure-initialize.md"><strong>D3DAUTHENTICATEDCONFIGURE_INITIALIZE</strong></a> Befehls angegeben.</span><span class="sxs-lookup"><span data-stu-id="68b93-281">The first sequence number is specified by sending a <a href="d3dauthenticatedconfigure-initialize.md"><strong>D3DAUTHENTICATEDCONFIGURE_INITIALIZE</strong></a> command.</span></span> <span data-ttu-id="68b93-282">Jedes Mal, wenn Sie einen anderen Befehl senden, erhöhen Sie diese Zahl um 1.</span><span class="sxs-lookup"><span data-stu-id="68b93-282">Each time you send another command, increment this number by 1.</span></span> <span data-ttu-id="68b93-283">Die Sequenznummer schützt vor Replay-Angriffen.</span><span class="sxs-lookup"><span data-stu-id="68b93-283">The sequence number guards against replay attacks.</span></span>
    <blockquote>
    [!Note]<br />
<span data-ttu-id="68b93-284">Es werden zwei separate Sequenznummern verwendet, eine für Befehle und eine für Abfragen.</span><span class="sxs-lookup"><span data-stu-id="68b93-284">Two separate sequence numbers are used, one for commands and one for queries.</span></span>
    </blockquote>
    <br/> <br/></td>
    </tr>
    </tbody>
    </table>

    

     

2.  <span data-ttu-id="68b93-285">Berechnen Sie das OMAC-Tag für den Datenblock, der nach dem **OMAC** -Member der Eingabe Struktur angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="68b93-285">Calculate the OMAC tag for the block of data that appears after the **omac** member of the input structure.</span></span> <span data-ttu-id="68b93-286">Kopieren Sie dann diesen Tagwert in den **OMAC** -Member.</span><span class="sxs-lookup"><span data-stu-id="68b93-286">Then copy this tag value into the **omac** member.</span></span>
3.  <span data-ttu-id="68b93-287">[**IDirect3DAuthenticatedChannel9:: Configure**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-configure)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="68b93-287">Call [**IDirect3DAuthenticatedChannel9::Configure**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-configure).</span></span>
4.  <span data-ttu-id="68b93-288">Der Treiber legt die Ausgabe aus dem Befehl in der [**D3DAUTHENTICATEDCHANNEL_CONFIGURE_OUTPUT**](d3dauthenticatedchannel-configure-output.md) Struktur ab.</span><span class="sxs-lookup"><span data-stu-id="68b93-288">The driver places the output from the command in the [**D3DAUTHENTICATEDCHANNEL_CONFIGURE_OUTPUT**](d3dauthenticatedchannel-configure-output.md) structure.</span></span>
5.  <span data-ttu-id="68b93-289">Berechnen Sie das OMAC-Tag für den Datenblock, der nach dem **OMAC** -Member der Ausgabestruktur angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="68b93-289">Calculate the OMAC tag for the block of data that appears after the **omac** member of the output structure.</span></span> <span data-ttu-id="68b93-290">Vergleichen Sie dies mit dem Wert des **OMAC** -Members.</span><span class="sxs-lookup"><span data-stu-id="68b93-290">Compare this with the value of the **omac** member.</span></span> <span data-ttu-id="68b93-291">Schlägt fehl, wenn Sie nicht stimmen.</span><span class="sxs-lookup"><span data-stu-id="68b93-291">Fail if they do not match.</span></span>
6.  <span data-ttu-id="68b93-292">Vergleichen Sie die Werte der Member " **konfiguritytype**", " **hchannel**" und " **SequenceNumber** " in der Ausgabestruktur mit ihren Werten für diese Elemente.</span><span class="sxs-lookup"><span data-stu-id="68b93-292">Compare the values of the **ConfigureType**, **hChannel**, and **SequenceNumber** members in the output structure against your values for those members.</span></span> <span data-ttu-id="68b93-293">Schlägt fehl, wenn Sie nicht stimmen.</span><span class="sxs-lookup"><span data-stu-id="68b93-293">Fail if they do not match.</span></span>
7.  <span data-ttu-id="68b93-294">Erhöhen Sie die Sequenznummer für den nächsten Befehl.</span><span class="sxs-lookup"><span data-stu-id="68b93-294">Increment the sequence number for the next command.</span></span>

## <a name="sending-authenticated-channel-queries"></a><span data-ttu-id="68b93-295">Senden von authentifizierten Kanal Abfragen</span><span class="sxs-lookup"><span data-stu-id="68b93-295">Sending Authenticated Channel Queries</span></span>

<span data-ttu-id="68b93-296">Ein Satz von Abfragen wird zum Abrufen von Informationen über den authentifizierten Kanal definiert.</span><span class="sxs-lookup"><span data-stu-id="68b93-296">A set of queries are defined for retrieving information about the authenticated channel.</span></span> <span data-ttu-id="68b93-297">Eine Liste der Abfragen finden Sie unter [Content Protection-Abfragen](content-protection-queries.md).</span><span class="sxs-lookup"><span data-stu-id="68b93-297">For a list of queries, see [Content Protection Queries](content-protection-queries.md).</span></span>

<span data-ttu-id="68b93-298">Führen Sie die folgenden Schritte aus, um einen Befehl an den authentifizierten Kanal zu senden.</span><span class="sxs-lookup"><span data-stu-id="68b93-298">To send a command to the authenticated channel, perform the following steps.</span></span>

1.  <span data-ttu-id="68b93-299">Füllen Sie die Eingabedaten Struktur aus.</span><span class="sxs-lookup"><span data-stu-id="68b93-299">Fill in the input data structure.</span></span> <span data-ttu-id="68b93-300">Diese Datenstruktur ist immer eine [**D3DAUTHENTICATEDCHANNEL_QUERY_INPUT**](d3dauthenticatedchannel-query-input.md) Struktur, der möglicherweise zusätzliche Felder folgt.</span><span class="sxs-lookup"><span data-stu-id="68b93-300">This data structure is always a [**D3DAUTHENTICATEDCHANNEL_QUERY_INPUT**](d3dauthenticatedchannel-query-input.md) structure, possibly followed by additional fields.</span></span> <span data-ttu-id="68b93-301">Füllen Sie die **D3DAUTHENTICATEDCHANNEL_QUERY_INPUT** Struktur aus, wie in der folgenden Tabelle gezeigt.</span><span class="sxs-lookup"><span data-stu-id="68b93-301">Fill in the **D3DAUTHENTICATEDCHANNEL_QUERY_INPUT** structure as shown in the following table.</span></span>

    <table>
    <colgroup>
    <col style="width: 50%" />
    <col style="width: 50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th><span data-ttu-id="68b93-302">Member</span><span class="sxs-lookup"><span data-stu-id="68b93-302">Member</span></span></th>
    <th><span data-ttu-id="68b93-303">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="68b93-303">Description</span></span></th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td><span data-ttu-id="68b93-304"><strong>QueryType</strong></span><span class="sxs-lookup"><span data-stu-id="68b93-304"><strong>QueryType</strong></span></span></td>
    <td><span data-ttu-id="68b93-305">GUID, die die Abfrage identifiziert.</span><span class="sxs-lookup"><span data-stu-id="68b93-305">GUID that identifies the query.</span></span> <span data-ttu-id="68b93-306">Eine Liste der Abfragen finden Sie unter <a href="content-protection-queries.md">Content Protection-Abfragen</a>.</span><span class="sxs-lookup"><span data-stu-id="68b93-306">For a list of queries, see <a href="content-protection-queries.md">Content Protection Queries</a>.</span></span></td>
    </tr>
    <tr class="even">
    <td><span data-ttu-id="68b93-307"><strong>hchannel</strong></span><span class="sxs-lookup"><span data-stu-id="68b93-307"><strong>hChannel</strong></span></span></td>
    <td><span data-ttu-id="68b93-308">Das Handle für den authentifizierten Kanal.</span><span class="sxs-lookup"><span data-stu-id="68b93-308">The handle to the authenticated channel.</span></span></td>
    </tr>
    <tr class="odd">
    <td><span data-ttu-id="68b93-309"><strong>SequenceNumber</strong></span><span class="sxs-lookup"><span data-stu-id="68b93-309"><strong>SequenceNumber</strong></span></span></td>
    <td><span data-ttu-id="68b93-310">Die Sequenznummer.</span><span class="sxs-lookup"><span data-stu-id="68b93-310">The sequence number.</span></span> <span data-ttu-id="68b93-311">Die erste Sequenznummer wird durch Senden eines <a href="d3dauthenticatedconfigure-initialize.md"><strong>D3DAUTHENTICATEDCONFIGURE_INITIALIZE</strong></a> Befehls angegeben.</span><span class="sxs-lookup"><span data-stu-id="68b93-311">The first sequence number is specified by sending a <a href="d3dauthenticatedconfigure-initialize.md"><strong>D3DAUTHENTICATEDCONFIGURE_INITIALIZE</strong></a> command.</span></span> <span data-ttu-id="68b93-312">Jedes Mal, wenn Sie eine andere Abfrage senden, erhöhen Sie diese Zahl um 1.</span><span class="sxs-lookup"><span data-stu-id="68b93-312">Each time you send another query, increment this number by 1.</span></span> <span data-ttu-id="68b93-313">Die Sequenznummer schützt vor Replay-Angriffen.</span><span class="sxs-lookup"><span data-stu-id="68b93-313">The sequence number guards against replay attacks.</span></span>
    <blockquote>
    [!Note]<br />
<span data-ttu-id="68b93-314">Es werden zwei separate Sequenznummern verwendet, eine für Befehle und eine für Abfragen.</span><span class="sxs-lookup"><span data-stu-id="68b93-314">Two separate sequence numbers are used, one for commands and one for queries.</span></span>
    </blockquote>
    <br/> <br/></td>
    </tr>
    </tbody>
    </table>

    

     

2.  <span data-ttu-id="68b93-315">[**IDirect3DAuthenticatedChannel9:: Query**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-query)aufruft.</span><span class="sxs-lookup"><span data-stu-id="68b93-315">Call [**IDirect3DAuthenticatedChannel9::Query**](/windows/desktop/api/d3d9/nf-d3d9-idirect3dauthenticatedchannel9-query).</span></span>
3.  <span data-ttu-id="68b93-316">Der Treiber legt die Ausgabe der Abfrage in einer [**D3DAUTHENTICATEDCHANNEL_QUERY_OUTPUT**](d3dauthenticatedchannel-query-output.md) Struktur ab.</span><span class="sxs-lookup"><span data-stu-id="68b93-316">The driver places the output from the query in a [**D3DAUTHENTICATEDCHANNEL_QUERY_OUTPUT**](d3dauthenticatedchannel-query-output.md) structure.</span></span> <span data-ttu-id="68b93-317">Auf diese Struktur folgen je nach Abfragetyp zusätzliche Felder.</span><span class="sxs-lookup"><span data-stu-id="68b93-317">This structure is followed by additional fields, depending on the query type.</span></span>
4.  <span data-ttu-id="68b93-318">Berechnen Sie das OMAC-Tag für den Datenblock, der nach dem **OMAC** -Member der Ausgabestruktur angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="68b93-318">Calculate the OMAC tag for the block of data that appears after the **omac** member of the output structure.</span></span> <span data-ttu-id="68b93-319">Vergleichen Sie dies mit dem Wert des **OMAC** -Members.</span><span class="sxs-lookup"><span data-stu-id="68b93-319">Compare this with the value of the **omac** member.</span></span> <span data-ttu-id="68b93-320">Schlägt fehl, wenn Sie nicht stimmen.</span><span class="sxs-lookup"><span data-stu-id="68b93-320">Fail if they do not match.</span></span>
5.  <span data-ttu-id="68b93-321">Vergleichen Sie die Werte der Member " **konfiguritytype**", " **hchannel**" und " **SequenceNumber** " in der Ausgabestruktur mit ihren Werten für diese Elemente.</span><span class="sxs-lookup"><span data-stu-id="68b93-321">Compare the values of the **ConfigureType**, **hChannel**, and **SequenceNumber** members in the output structure against your values for those members.</span></span> <span data-ttu-id="68b93-322">Schlägt fehl, wenn Sie nicht stimmen.</span><span class="sxs-lookup"><span data-stu-id="68b93-322">Fail if they do not match.</span></span>
6.  <span data-ttu-id="68b93-323">Erhöhen Sie die Sequenznummer für die nächste Abfrage.</span><span class="sxs-lookup"><span data-stu-id="68b93-323">Increment the sequence number for the next query.</span></span>

## <a name="related-topics"></a><span data-ttu-id="68b93-324">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="68b93-324">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="68b93-325">Direct3D 9-Video-APIs</span><span class="sxs-lookup"><span data-stu-id="68b93-325">Direct3D 9 Video APIs</span></span>](direct3d-video-apis.md)
</dt> </dl>

 

 
