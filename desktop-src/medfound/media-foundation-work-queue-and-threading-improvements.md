---
description: In diesem Thema werden die Verbesserungen in Windows 8 für Arbeits Warteschlangen und Threading in der Microsoft Media Foundation Plattform beschrieben.
ms.assetid: 9E2A1D94-BF82-488E-8297-D524683ABE17
title: Arbeits Warteschlangen und Threading
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 07b307cb00316696e075e9e9cc2a138e98e149be
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/03/2021
ms.locfileid: "104050714"
---
# <a name="work-queue-and-threading-improvements"></a><span data-ttu-id="2db8a-103">Arbeits Warteschlangen und Threading</span><span class="sxs-lookup"><span data-stu-id="2db8a-103">Work Queue and Threading Improvements</span></span>

<span data-ttu-id="2db8a-104">In diesem Thema werden die Verbesserungen in Windows 8 für Arbeits Warteschlangen und Threading in der Microsoft Media Foundation Plattform beschrieben.</span><span class="sxs-lookup"><span data-stu-id="2db8a-104">This topic describes improvements in Windows 8 for work queues and threading in the Microsoft Media Foundation platform.</span></span>

-   [<span data-ttu-id="2db8a-105">Windows 7-Verhalten</span><span class="sxs-lookup"><span data-stu-id="2db8a-105">Windows 7 Behavior</span></span>](#windows-7-behavior)
    -   [<span data-ttu-id="2db8a-106">Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="2db8a-106">Work Queues</span></span>](#work-queues)
    -   [<span data-ttu-id="2db8a-107">MMCSS-Unterstützung</span><span class="sxs-lookup"><span data-stu-id="2db8a-107">MMCSS Support</span></span>](#mmcss-support)
    -   [<span data-ttu-id="2db8a-108">Imfrealtimeclient</span><span class="sxs-lookup"><span data-stu-id="2db8a-108">IMFRealTimeClient</span></span>](#imfrealtimeclientex)
-   [<span data-ttu-id="2db8a-109">Verbesserte Windows 8</span><span class="sxs-lookup"><span data-stu-id="2db8a-109">Windows 8 Improvements</span></span>](#windows-8-improvements)
    -   [<span data-ttu-id="2db8a-110">Multithread-Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="2db8a-110">Multithreaded Work Queues</span></span>](#multithreaded-work-queues)
    -   [<span data-ttu-id="2db8a-111">Arbeits Warteschlangen für freigegebene Aufgaben</span><span class="sxs-lookup"><span data-stu-id="2db8a-111">Shared Task Work Queues</span></span>](#shared-task-work-queues)
    -   [<span data-ttu-id="2db8a-112">Warteschlange</span><span class="sxs-lookup"><span data-stu-id="2db8a-112">Wait Queue</span></span>](#wait-queue)
    -   [<span data-ttu-id="2db8a-113">Erweiterungen der MMCSS-Unterstützung</span><span class="sxs-lookup"><span data-stu-id="2db8a-113">Enhancements to MMCSS Support</span></span>](#enhancements-to-mmcss-support)
    -   [<span data-ttu-id="2db8a-114">Imfrealtimecliumtex</span><span class="sxs-lookup"><span data-stu-id="2db8a-114">IMFRealTimeClientEx</span></span>](#imfrealtimeclientex)
    -   [<span data-ttu-id="2db8a-115">Topologiebranches</span><span class="sxs-lookup"><span data-stu-id="2db8a-115">Topology Branches</span></span>](#topology-branches)
-   [<span data-ttu-id="2db8a-116">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="2db8a-116">Recommendations</span></span>](#recommendations)
-   [<span data-ttu-id="2db8a-117">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="2db8a-117">Summary</span></span>](#summary)
-   [<span data-ttu-id="2db8a-118">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="2db8a-118">Related topics</span></span>](#related-topics)

## <a name="windows-7-behavior"></a><span data-ttu-id="2db8a-119">Windows 7-Verhalten</span><span class="sxs-lookup"><span data-stu-id="2db8a-119">Windows 7 Behavior</span></span>

<span data-ttu-id="2db8a-120">In diesem Abschnitt wird das Verhalten Media Foundation Arbeits Warteschlangen in Windows 7 zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="2db8a-120">This section summarizes the behavior of Media Foundation work queues in Windows 7.</span></span>

### <a name="work-queues"></a><span data-ttu-id="2db8a-121">Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="2db8a-121">Work Queues</span></span>

<span data-ttu-id="2db8a-122">Die Media Foundation Plattform erstellt mehrere standardmäßige Arbeits Warteschlangen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-122">The Media Foundation platform creates several standard work queues.</span></span> <span data-ttu-id="2db8a-123">Nur zwei werden als für die allgemeine Anwendungs Verwendung dokumentiert:</span><span class="sxs-lookup"><span data-stu-id="2db8a-123">Only two are documented as being for general application use:</span></span>

-   <span data-ttu-id="2db8a-124">**mfasync- \_ Rückruf \_ Warteschlangen \_ Standard**</span><span class="sxs-lookup"><span data-stu-id="2db8a-124">**MFASYNC\_CALLBACK\_QUEUE\_STANDARD**</span></span>
-   <span data-ttu-id="2db8a-125">**lange Funktion der mfasync- \_ Rückruf \_ Warteschlange \_ \_**</span><span class="sxs-lookup"><span data-stu-id="2db8a-125">**MFASYNC\_CALLBACK\_QUEUE\_LONG\_FUNCTION**</span></span>

<span data-ttu-id="2db8a-126">Eine Anwendung oder Komponente kann neue Arbeits Warteschlangen zuweisen, indem Sie [**mfallocateworkqueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) oder [**mfallocateworkqueueex**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueueex)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-126">An application or component can allocate new work queues by calling [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) or [**MFAllocateWorkQueueEx**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueueex).</span></span> <span data-ttu-id="2db8a-127">Die Funktion " **MF belegcateworkqueueex** " definiert zwei Typen von Arbeits Warteschlangen:</span><span class="sxs-lookup"><span data-stu-id="2db8a-127">The **MFAllocateWorkQueueEx** function defines two types of work queue:</span></span>

-   <span data-ttu-id="2db8a-128">**MF \_ Standard \_ Arbeits Warteschlange** erstellt eine Arbeits Warteschlange ohne Nachrichten Schleife.</span><span class="sxs-lookup"><span data-stu-id="2db8a-128">**MF\_STANDARD\_WORKQUEUE** creates a work queue without a message loop.</span></span>
-   <span data-ttu-id="2db8a-129">**MF \_ Fenster \_ Arbeits Warteschlange** erstellt eine Arbeits Warteschlange mit einer Nachrichten Schleife.</span><span class="sxs-lookup"><span data-stu-id="2db8a-129">**MF\_WINDOW\_WORKQUEUE** creates a work queue with a message loop.</span></span>

<span data-ttu-id="2db8a-130">Um ein Arbeits Element in die Warteschlange zu stellen, nennen Sie [**mfputworkitem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) oder [**mfputworkitemex**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span><span class="sxs-lookup"><span data-stu-id="2db8a-130">To queue a work item, call [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) or [**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span></span> <span data-ttu-id="2db8a-131">Die Plattform führt das Arbeits Element durch Aufrufen der vom Aufrufer bereitgestellten Implementierung von [**imfasynccallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback)aus.</span><span class="sxs-lookup"><span data-stu-id="2db8a-131">The platform executes the work item by invoking the caller-provided implementation of [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback).</span></span> <span data-ttu-id="2db8a-132">In Windows 7 und früheren Versionen erstellt die Plattform einen Thread pro Arbeits Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="2db8a-132">In Windows 7 and earlier, the platform creates one thread per work queue.</span></span>

### <a name="mmcss-support"></a><span data-ttu-id="2db8a-133">MMCSS-Unterstützung</span><span class="sxs-lookup"><span data-stu-id="2db8a-133">MMCSS Support</span></span>

<span data-ttu-id="2db8a-134">Der [Multimedia Class Scheduler Service](../procthread/multimedia-class-scheduler-service.md) (MMCSS) verwaltet Thread Prioritäten, sodass Multimediaanwendungen regelmäßige Slices der CPU-Zeit erhalten, ohne dass CPU-Ressourcen Anwendungen mit niedrigerer Priorität verweigert werden.</span><span class="sxs-lookup"><span data-stu-id="2db8a-134">The [Multimedia Class Scheduler Service](../procthread/multimedia-class-scheduler-service.md) (MMCSS) manages thread priorities so that multimedia applications get regular slices of CPU time, without denying CPU resources to lower-priority applications.</span></span> <span data-ttu-id="2db8a-135">MMCSS definiert eine Reihe von *Tasks* , die über unterschiedliche CPU-Auslastungs Profile verfügen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-135">MMCSS defines a set of *tasks* that have different CPU utilization profiles.</span></span> <span data-ttu-id="2db8a-136">Wenn ein Thread einem MMCSS-Task Beitritt, legt MMCSS die Priorität des Threads auf der Grundlage verschiedener Faktoren fest:</span><span class="sxs-lookup"><span data-stu-id="2db8a-136">When a thread joins an MMCSS task, MMCSS sets the priority of the thread based on several factors:</span></span>

-   <span data-ttu-id="2db8a-137">Die Basis Priorität der Aufgabe, die in der Registrierung festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="2db8a-137">The base priority of the task, which is set in the registry.</span></span>
-   <span data-ttu-id="2db8a-138">Die relative Thread Priorität, die zur Laufzeit durch Aufrufen von [**avsetmmthreadpriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority)festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="2db8a-138">The relative thread priority, which is set at run time by calling [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span></span>
-   <span data-ttu-id="2db8a-139">Verschiedene Lauf Zeitmerkmale, wie z. b. ob die Anwendung im Vordergrund steht und wie viel CPU-Zeit von den Threads in den einzelnen MMCSS-Klassen verbraucht wird.</span><span class="sxs-lookup"><span data-stu-id="2db8a-139">Various run-time characteristics, such as whether the application is in the foreground, and how much CPU time is being consumed by the threads in each MMCSS class.</span></span>

<span data-ttu-id="2db8a-140">Eine Anwendung kann eine Arbeits Warteschlange mit MMCSS registrieren, indem [**mfbeginregisterworkqueuewithmmcss**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="2db8a-140">An application can register a work queue with MMCSS by calling [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss).</span></span> <span data-ttu-id="2db8a-141">Diese Funktion nimmt eine Arbeits Warteschlangen-ID, eine MMCSS-Klasse (Taskname) und den MMCSS-Task Bezeichner an.</span><span class="sxs-lookup"><span data-stu-id="2db8a-141">This function takes a work queue ID, an MMCSS class (task name), and the MMCSS task identifier.</span></span> <span data-ttu-id="2db8a-142">Intern wird [**avsetmmthreadcharacteristics**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadcharacteristicsa) mit dem Aufgaben Namen und der Task-ID aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-142">Internally, it calls [**AvSetMmThreadCharacteristics**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadcharacteristicsa) with the task name and task ID.</span></span> <span data-ttu-id="2db8a-143">Nachdem eine Arbeits Warteschlange mit MMCSS registriert wurde, können Sie die Klasse und die Task-ID abrufen, indem Sie [**mfgetworkqueuemmcssclass**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcssclass) und [**mfgetworkqueuemmcsstaskid**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsstaskid)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-143">After a work queue is registered with MMCSS, you can get the class and task ID by calling [**MFGetWorkQueueMMCSSClass**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcssclass) and [**MFGetWorkQueueMMCSSTaskId**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsstaskid).</span></span>

<span data-ttu-id="2db8a-144">Die [Medien Sitzung](media-session.md) bietet über die [**imfworkqueueservices**](/windows/desktop/api/mfidl/nn-mfidl-imfworkqueueservices) -Schnittstelle einen etwas höheren Zugriff auf diese APIs.</span><span class="sxs-lookup"><span data-stu-id="2db8a-144">The [Media Session](media-session.md) provides somewhat higher-level access to these APIs, through the [**IMFWorkQueueServices**](/windows/desktop/api/mfidl/nn-mfidl-imfworkqueueservices) interface.</span></span> <span data-ttu-id="2db8a-145">Diese Schnittstelle stellt zwei primäre Methoden bereit:</span><span class="sxs-lookup"><span data-stu-id="2db8a-145">This interface provides two primary methods:</span></span>

| <span data-ttu-id="2db8a-146">Methode</span><span class="sxs-lookup"><span data-stu-id="2db8a-146">Method</span></span>                                                                                                            | <span data-ttu-id="2db8a-147">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="2db8a-147">Description</span></span>                                                                                                                                                                                                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2db8a-148">**Beginregisterplatformworkqueuewithmmcss**</span><span class="sxs-lookup"><span data-stu-id="2db8a-148">**BeginRegisterPlatformWorkQueueWithMMCSS**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregisterplatformworkqueuewithmmcss)   | <span data-ttu-id="2db8a-149">Registriert eine Arbeits Warteschlange bei einem MMCSS-Task.</span><span class="sxs-lookup"><span data-stu-id="2db8a-149">Registers a work queue with an MMCSS task.</span></span> <span data-ttu-id="2db8a-150">Bei dieser Methode handelt es sich im Grunde um einen schmalen Wrapper um [**mfbeginregisterworkqueuewithmmcss**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss), aber Sie können den Wert " **mfasync \_ Callback \_ Queue \_ all** " übergeben, um alle Platt Form Arbeitswarteschlangen gleichzeitig zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="2db8a-150">This method is essentially a thin wrapper around [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss), but you can pass the value **MFASYNC\_CALLBACK\_QUEUE\_ALL** to register all of the platform work queues at once.</span></span> |
| [<span data-ttu-id="2db8a-151">**Beginregistertopologyworkqueueswithmmcss**</span><span class="sxs-lookup"><span data-stu-id="2db8a-151">**BeginRegisterTopologyWorkQueuesWithMMCSS**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) | <span data-ttu-id="2db8a-152">Registriert einen Branch der Topologie bei einer Arbeits Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="2db8a-152">Registers a branch of the topology with a work queue.</span></span>                                                                                                                                                                                                                                         |



 

<span data-ttu-id="2db8a-153">Gehen Sie folgendermaßen vor, um eine topologieverzweigung zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="2db8a-153">To register a topology branch, do the following.</span></span>

1.  <span data-ttu-id="2db8a-154">Legen Sie das Attribut für die [MF- \_ toponode- \_ workqueue- \_ ID](mf-toponode-workqueue-id-attribute.md) auf dem Quellknoten für den Branch fest.</span><span class="sxs-lookup"><span data-stu-id="2db8a-154">Set the [MF\_TOPONODE\_WORKQUEUE\_ID](mf-toponode-workqueue-id-attribute.md) attribute on the source node for the branch.</span></span> <span data-ttu-id="2db8a-155">Verwenden Sie einen beliebigen von der Anwendung definierten Wert.</span><span class="sxs-lookup"><span data-stu-id="2db8a-155">Use any application-defined value.</span></span>
2.  <span data-ttu-id="2db8a-156">Legen Sie optional die **\_ \_ \_ MMCSS- \_ Klasse "MF toponode workqueue** " fest, um die Arbeits Warteschlange einem MMCSS-Task beizutreten.</span><span class="sxs-lookup"><span data-stu-id="2db8a-156">Optionally, set the **MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS** to join the work queue to an MMCSS task.</span></span>
3.  <span data-ttu-id="2db8a-157">Aufrufen von [**beginregistertopologyworkqueueswithmmcss**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) in der aufgelösten Topologie.</span><span class="sxs-lookup"><span data-stu-id="2db8a-157">Call [**BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) on the resolved topology.</span></span>

<span data-ttu-id="2db8a-158">Die Medien Sitzung ordnet eine neue Arbeits Warteschlange für jeden eindeutigen Wert der [MF- \_ toponode- \_ workqueue- \_ ID](mf-toponode-workqueue-id-attribute.md)zu.</span><span class="sxs-lookup"><span data-stu-id="2db8a-158">The Media Session allocates a new work queue for each unique value of [MF\_TOPONODE\_WORKQUEUE\_ID](mf-toponode-workqueue-id-attribute.md).</span></span> <span data-ttu-id="2db8a-159">Für jeden topologiebranch werden asynchrone Pipeline Vorgänge in der Arbeits Warteschlange durchgeführt, die der Verzweigung zugewiesen ist.</span><span class="sxs-lookup"><span data-stu-id="2db8a-159">For each topology branch, asynchronous pipeline operations are performed on the work queue that is assigned to the branch.</span></span>

### <a name="imfrealtimeclient"></a><span data-ttu-id="2db8a-160">Imfrealtimeclient</span><span class="sxs-lookup"><span data-stu-id="2db8a-160">IMFRealTimeClient</span></span>

<span data-ttu-id="2db8a-161">Die [**imfrealtimeclient**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclient) -Schnittstelle ist für Pipeline Komponenten vorgesehen, die entweder eigene Threads erstellen oder Arbeits Warteschlangen für asynchrone Vorgänge verwenden.</span><span class="sxs-lookup"><span data-stu-id="2db8a-161">The [**IMFRealTimeClient**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclient) interface is intended for pipeline components that either create their own threads or use work queues for asynchronous operations.</span></span> <span data-ttu-id="2db8a-162">Die Medien Sitzung verwendet diese Schnittstelle, um die Pipeline Komponente über das korrekte Verhalten wie folgt zu benachrichtigen:</span><span class="sxs-lookup"><span data-stu-id="2db8a-162">The Media Session uses this interface to notify the pipeline component of the correct behavior, as follows:</span></span>

-   <span data-ttu-id="2db8a-163">Wenn die Pipeline Komponente einen Arbeits Thread erstellt, benachrichtigt die [**imfrealtimeclient:: registerthreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads) -Methode die Komponente, welcher MMCSS-Klasse beitreten soll.</span><span class="sxs-lookup"><span data-stu-id="2db8a-163">If the pipeline component creates a worker thread, the [**IMFRealTimeClient::RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads) method notifies the component which MMCSS class to join.</span></span>
-   <span data-ttu-id="2db8a-164">Wenn die Pipeline Komponente eine Arbeits Warteschlange verwendet, teilt die [**imfrealtimeclient:: setworkqueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue) -Methode der Komponente mit, welche Arbeits Warteschlange verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="2db8a-164">If the pipeline component uses a work queue, the [**IMFRealTimeClient::SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue) method tells the component which work queue to use.</span></span>

<span data-ttu-id="2db8a-165">In der Regel verwendet eine Pipeline Komponente entweder einen Thread oder eine Arbeits Warteschlange, um asynchrone Aufgaben auszuführen, aber nicht beides.</span><span class="sxs-lookup"><span data-stu-id="2db8a-165">Typically, a pipeline component uses either a thread or a work queue to perform asynchronous tasks, but not both.</span></span>

## <a name="windows-8-improvements"></a><span data-ttu-id="2db8a-166">Verbesserte Windows 8</span><span class="sxs-lookup"><span data-stu-id="2db8a-166">Windows 8 Improvements</span></span>

### <a name="multithreaded-work-queues"></a><span data-ttu-id="2db8a-167">Multithread-Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="2db8a-167">Multithreaded Work Queues</span></span>

<span data-ttu-id="2db8a-168">In Windows 8 unterstützt Media Foundation einen neuen Arbeits Aufgabentyp, der als *Multithread-Warteschlange* bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="2db8a-168">In Windows 8, Media Foundation supports a new type of work queue called the *multithreaded queue*.</span></span> <span data-ttu-id="2db8a-169">Eine multithreadwarteschlange verwendet einen System Thread Pool, um Arbeitselemente zu verteilen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-169">A multithreaded queue uses a system thread pool to dispatch work items.</span></span> <span data-ttu-id="2db8a-170">Die Multithread-Warteschlange skaliert besser als die vorherigen Single Thread-Warteschlangen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-170">The multithreaded queue scales better than the previous single-threaded queues.</span></span> <span data-ttu-id="2db8a-171">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="2db8a-171">For example,</span></span>

-   <span data-ttu-id="2db8a-172">Mehrere Komponenten können eine multithreadwarteschlange freigeben, ohne eine andere zu blockieren, sodass weniger Threads erstellt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-172">Several components can share a multithreaded queue without blocking one another, requiring the creation of fewer threads.</span></span>

-   <span data-ttu-id="2db8a-173">Arbeitselemente werden optimiert, um Kontextwechsel zu vermeiden, wenn ein Ereignis bereits festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="2db8a-173">Work items are optimized to avoid context switches if an event is already set.</span></span> <span data-ttu-id="2db8a-174">Dies ist effizienter als das Erstellen eigener Threads, um auf Ereignisse zu warten.</span><span class="sxs-lookup"><span data-stu-id="2db8a-174">This is more efficient than creating your own threads to wait on events.</span></span>

<span data-ttu-id="2db8a-175">Bei der Verwendung von [**imfrealtimeclientex**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex)sollten Anwendungen das Einrichten von Threads vermeiden und stattdessen die Arbeits Warteschlangen verwenden.</span><span class="sxs-lookup"><span data-stu-id="2db8a-175">When using [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex), applications should avoid spinning up threads and instead should use the work queues.</span></span> <span data-ttu-id="2db8a-176">Um dies zu erreichen, sollten die Anwendungen [**setworkqueueex**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-setworkqueueex) implementieren und nicht [**registerthreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-registerthreadsex) und [**unregisterthreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-unregisterthreads)verwenden.</span><span class="sxs-lookup"><span data-stu-id="2db8a-176">To accomplish this, applications should implement [**SetWorkQueueEx**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-setworkqueueex) and not use [**RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-registerthreadsex) and [**UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-unregisterthreads).</span></span>

<span data-ttu-id="2db8a-177">Wenn die Media Foundation Plattform initialisiert wird, erstellt Sie eine Multithread-Warteschlange mit dem Bezeichner **mfasync- \_ Rückruf \_ Warteschlange \_ Multithread**.</span><span class="sxs-lookup"><span data-stu-id="2db8a-177">When the Media Foundation platform is initialized, it creates a multithreaded queue with the identifier **MFASYNC\_CALLBACK\_QUEUE\_MULTITHREADED**.</span></span>

<span data-ttu-id="2db8a-178">Arbeitselemente werden von der Multithread-Warteschlange nicht serialisiert.</span><span class="sxs-lookup"><span data-stu-id="2db8a-178">A multithreaded queue does not serialize work items.</span></span> <span data-ttu-id="2db8a-179">Wenn ein Thread aus dem Thread Pool verfügbar wird, wird das nächste Arbeits Element in der Warteschlange weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="2db8a-179">Whenever a thread from the thread pool becomes available, the next work item on the queue is dispatched.</span></span> <span data-ttu-id="2db8a-180">Der Aufrufer muss sicherstellen, dass die Arbeit richtig serialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="2db8a-180">The caller must ensure that work is serialized correctly.</span></span> <span data-ttu-id="2db8a-181">Um dies zu vereinfachen, Media Foundation eine *serielle Arbeits Warteschlange* definiert.</span><span class="sxs-lookup"><span data-stu-id="2db8a-181">To make this easier, Media Foundation defines a *serial work queue*.</span></span> <span data-ttu-id="2db8a-182">Eine serielle Warteschlange schließt eine andere Arbeits Warteschlange ein</span><span class="sxs-lookup"><span data-stu-id="2db8a-182">A serial queue wraps another work queue but guarantees fully serialized execution.</span></span> <span data-ttu-id="2db8a-183">Das nächste Element in der Warteschlange wird erst gesendet, wenn das vorherige Element abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="2db8a-183">The next item on the queue is not dispatched until the previous item completes.</span></span>

<span data-ttu-id="2db8a-184">Der folgende Code erstellt eine warteschlangenwarteschlange über die Multithread-Multithread-Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="2db8a-184">The following code creates a serializer queue over the platform multithreaded queue.</span></span>


```C++
DWORD workQueueID;
hr = MFAllocateSerialWorkQueue(MFASYNC_CALLBACK_QUEUE_MULTITHREADED, &workQueueID); 
```



<span data-ttu-id="2db8a-185">Mehrere serielle Warteschlangen können eine Multithread-Warteschlange einschließen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-185">More than one serial queue can wrap the same multithreaded queue.</span></span> <span data-ttu-id="2db8a-186">Die seriellen Warteschlangen verwenden dann denselben Thread Pool, und die serialisierte Ausführung wird innerhalb jeder Warteschlange erzwungen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-186">The serial queues then share the same thread pool, and serialized execution is enforced within each queue.</span></span>

<span data-ttu-id="2db8a-187">Die Standard Arbeits Warteschlangen, die vor Windows 8 vorhanden waren, werden nun als serielle Arbeits Warteschlangen implementiert, die die Multithread-Multithread-Warteschlange</span><span class="sxs-lookup"><span data-stu-id="2db8a-187">The standard work queues that existed prior to Windows 8 are now implemented as serial work queues that wrap the platform multithreaded queue.</span></span> <span data-ttu-id="2db8a-188">Durch diese Änderung wird die Abwärtskompatibilität beibehalten.</span><span class="sxs-lookup"><span data-stu-id="2db8a-188">This change preserves backward compatibility.</span></span>

### <a name="shared-task-work-queues"></a><span data-ttu-id="2db8a-189">Arbeits Warteschlangen für freigegebene Aufgaben</span><span class="sxs-lookup"><span data-stu-id="2db8a-189">Shared Task Work Queues</span></span>

<span data-ttu-id="2db8a-190">Wenn Sie mit dem Kernel Planer ordnungsgemäß arbeiten möchten, sollte für jede von Ihnen verwendete MMCSS-Aufgabe eine Multithread-Arbeits Warteschlange vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="2db8a-190">To work correctly with the kernel scheduler, there should be one multithreaded work queue for each MMCSS task that you use.</span></span> <span data-ttu-id="2db8a-191">Die Media Foundation Plattform ordnet diese nach Bedarf zu, bis zu einer pro MMCSS-Aufgabe pro Prozess.</span><span class="sxs-lookup"><span data-stu-id="2db8a-191">The Media Foundation platform allocates these as needed, up to one per MMCSS task, per process.</span></span> <span data-ttu-id="2db8a-192">Um die freigegebene Arbeits Warteschlange für eine bestimmte MMCSS-Aufgabe abzurufen, nennen Sie [**mflocksharedworkqueue**](/windows/desktop/api/mfapi/nf-mfapi-mflocksharedworkqueue) , und geben Sie den Aufgaben Namen an.</span><span class="sxs-lookup"><span data-stu-id="2db8a-192">To get the shared work queue for a particular MMCSS task, call [**MFLockSharedWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mflocksharedworkqueue) and specify the task name.</span></span> <span data-ttu-id="2db8a-193">Die-Funktion sucht den Aufgaben Namen in einer Tabelle.</span><span class="sxs-lookup"><span data-stu-id="2db8a-193">The function looks up the task name in a table.</span></span> <span data-ttu-id="2db8a-194">Wenn eine Arbeits Warteschlange für diese Aufgabe nicht bereits vorhanden ist, ordnet die Funktion eine neue Master-Arbeits Warteschlange zu und fügt Sie sofort mit der MMCSS-Aufgabe an.</span><span class="sxs-lookup"><span data-stu-id="2db8a-194">If a work queue does not already exist for this task, the function allocates a new MT work queue and immediately joins it to the MMCSS task.</span></span> <span data-ttu-id="2db8a-195">Wenn bereits eine Arbeits Warteschlange für diese Aufgabe vorhanden ist, gibt die Funktion den Bezeichner der vorhandenen Arbeits Warteschlange zurück.</span><span class="sxs-lookup"><span data-stu-id="2db8a-195">If a work queue already exists for that task, the function returns the identifier of the existing work queue.</span></span>

### <a name="wait-queue"></a><span data-ttu-id="2db8a-196">Warteschlange</span><span class="sxs-lookup"><span data-stu-id="2db8a-196">Wait Queue</span></span>

<span data-ttu-id="2db8a-197">Die *Warteschlange* ist eine besondere Plattform-Arbeits Warteschlange, die darauf wartet, dass Ereignisse signalisiert werden.</span><span class="sxs-lookup"><span data-stu-id="2db8a-197">The *wait queue* is a special platform work queue that waits on events to be signaled.</span></span> <span data-ttu-id="2db8a-198">Wenn eine Komponente auf die Signalisierung eines Ereignisses warten muss, kann Sie die Warteschlange verwenden, anstatt einen Arbeits Thread zu erstellen, der auf das Ereignis wartet.</span><span class="sxs-lookup"><span data-stu-id="2db8a-198">If a component needs to wait for an event to be signaled, it can use the wait queue instead of creating a worker thread to wait on the event.</span></span>

<span data-ttu-id="2db8a-199">Um die Warteschlange zu verwenden, nennen Sie [**mfputwaitingworkitem**](/windows/desktop/api/mfapi/nf-mfapi-mfputwaitingworkitem).</span><span class="sxs-lookup"><span data-stu-id="2db8a-199">To use the wait queue, call [**MFPutWaitingWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputwaitingworkitem).</span></span> <span data-ttu-id="2db8a-200">Zu den Parametern gehören das Ereignis Handle und ein [**imfasynkresult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) -Zeiger.</span><span class="sxs-lookup"><span data-stu-id="2db8a-200">The parameters include the event handle and an [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) pointer.</span></span> <span data-ttu-id="2db8a-201">Wenn das Ereignis signalisiert wird, ruft die Warteschlange ihren Rückruf auf.</span><span class="sxs-lookup"><span data-stu-id="2db8a-201">When the event is signaled, the wait queue invokes your callback.</span></span> <span data-ttu-id="2db8a-202">Es gibt eine Warteschlange für eine einzelne Plattform. Anwendungen können keine eigenen Warteschlangen für Warteschlangen erstellen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-202">There is a single platform wait queue; applications cannot create their own wait queues.</span></span>

### <a name="enhancements-to-mmcss-support"></a><span data-ttu-id="2db8a-203">Erweiterungen der MMCSS-Unterstützung</span><span class="sxs-lookup"><span data-stu-id="2db8a-203">Enhancements to MMCSS Support</span></span>

<span data-ttu-id="2db8a-204">Die folgenden neuen Media Foundation-Plattformfunktionen beziehen sich auf MMCSS.</span><span class="sxs-lookup"><span data-stu-id="2db8a-204">The following new Media Foundation platform functions relate to MMCSS.</span></span>



| <span data-ttu-id="2db8a-205">Funktion</span><span class="sxs-lookup"><span data-stu-id="2db8a-205">Function</span></span>                                                                           | <span data-ttu-id="2db8a-206">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="2db8a-206">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2db8a-207">**MFBeginRegisterWorkQueueWithMMCSSEx**</span><span class="sxs-lookup"><span data-stu-id="2db8a-207">**MFBeginRegisterWorkQueueWithMMCSSEx**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcssex) | <span data-ttu-id="2db8a-208">Registriert eine Arbeits Warteschlange mit MMCSS.</span><span class="sxs-lookup"><span data-stu-id="2db8a-208">Registers a work queue with MMCSS.</span></span> <span data-ttu-id="2db8a-209">Diese Funktion enthält einen Parameter zum Angeben der relativen Thread Priorität.</span><span class="sxs-lookup"><span data-stu-id="2db8a-209">This function includes a parameter to specify relative thread priority.</span></span> <span data-ttu-id="2db8a-210">Intern wird dieser Wert in einen-Aufrufen von [**avsetmmthreadpriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority)übersetzt.</span><span class="sxs-lookup"><span data-stu-id="2db8a-210">Internally, this value is translated into a call to [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span></span>                                                                                                                                                                               |
| [<span data-ttu-id="2db8a-211">**MF getworkqueuemmcsspriority**</span><span class="sxs-lookup"><span data-stu-id="2db8a-211">**MFGetWorkQueueMMCSSPriority**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsspriority)                 | <span data-ttu-id="2db8a-212">Fragt die Priorität einer Arbeits Warteschlange ab.</span><span class="sxs-lookup"><span data-stu-id="2db8a-212">Queries the priority of a work queue.</span></span>                                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="2db8a-213">**MF registerplatformwithmmcss**</span><span class="sxs-lookup"><span data-stu-id="2db8a-213">**MFRegisterPlatformWithMMCSS**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfregisterplatformwithmmcss)                 | <span data-ttu-id="2db8a-214">Registriert alle Platt Form Arbeitswarteschlangen bei einer MMCSS-Aufgabe.</span><span class="sxs-lookup"><span data-stu-id="2db8a-214">Registers all of the platform work queues with an MMCSS task.</span></span> <span data-ttu-id="2db8a-215">Diese Funktion ähnelt der [**imfworkqueueservices:: beginregisterplatformworkqueuewithmmcss**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregisterplatformworkqueuewithmmcss) -Methode, kann aber ohne Erstellen einer Instanz der Medien Sitzung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="2db8a-215">This function is similar to the [**IMFWorkQueueServices::BeginRegisterPlatformWorkQueueWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregisterplatformworkqueuewithmmcss) method, but it can be used without creating an instance of the Media Session.</span></span> <span data-ttu-id="2db8a-216">Darüber hinaus enthält die-Funktion einen-Parameter, um die Basis Thread Priorität anzugeben.</span><span class="sxs-lookup"><span data-stu-id="2db8a-216">In addition, the function includes a parameter to specify the base thread priority.</span></span> |



 

<span data-ttu-id="2db8a-217">Anwendungen, die die Medien Sitzung verwenden, sollten für den audiorenderingbranch das Attribut " [MF \_ toponode \_ workqueue" der \_ MMCSS- \_ Klasse](mf-toponode-workqueue-mmcss-class-attribute.md) auf "Audiodaten" festlegen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-217">Applications that use the Media Session should set the [MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS](mf-toponode-workqueue-mmcss-class-attribute.md) attribute to "Audio" for the audio rendering branch.</span></span> <span data-ttu-id="2db8a-218">Legen Sie das-Attribut für den videorenderingbranch auf "Wiedergabe" fest.</span><span class="sxs-lookup"><span data-stu-id="2db8a-218">Set the attribute to "Playback" for the video rendering branch.</span></span>

### <a name="imfrealtimeclientex"></a><span data-ttu-id="2db8a-219">Imfrealtimecliumtex</span><span class="sxs-lookup"><span data-stu-id="2db8a-219">IMFRealTimeClientEx</span></span>

<span data-ttu-id="2db8a-220">Die [**imfrealtimecliumtex**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex) -Schnittstelle zum Ersetzen von imfrealtimeclient für Pipeline Komponenten, die asynchrone Vorgänge ausführen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-220">The [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex) interface to replaces IMFRealTimeClient, for pipeline components that perform asynchronous operations.</span></span>



| <span data-ttu-id="2db8a-221">Methode</span><span class="sxs-lookup"><span data-stu-id="2db8a-221">Method</span></span>                                                             | <span data-ttu-id="2db8a-222">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="2db8a-222">Description</span></span>                                                                                                                                                                                                                    |
|--------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2db8a-223">**Registerthreadsex**</span><span class="sxs-lookup"><span data-stu-id="2db8a-223">**RegisterThreadsEx**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-registerthreadsex) | <span data-ttu-id="2db8a-224">Benachrichtigt die Komponente, ihre Threads bei MMCSS zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="2db8a-224">Notifies the component to register its threads with MMCSS.</span></span> <span data-ttu-id="2db8a-225">Diese Methode entspricht [**imfrealtimeclient:: registerthreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads), fügt aber einen Parameter für die Basis Thread Priorität hinzu.</span><span class="sxs-lookup"><span data-stu-id="2db8a-225">This method is equivalent to [**IMFRealTimeClient::RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads), but it adds a parameter for the base thread priority.</span></span> |
| [<span data-ttu-id="2db8a-226">**Setworkqueueex**</span><span class="sxs-lookup"><span data-stu-id="2db8a-226">**SetWorkQueueEx**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-setworkqueueex)       | <span data-ttu-id="2db8a-227">Benachrichtigt die Komponente, eine bestimmte Arbeits Warteschlange zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="2db8a-227">Notifies the component to use a specific work queue.</span></span> <span data-ttu-id="2db8a-228">Diese Methode entspricht [**imfreadtimeclient:: setworkqueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue), fügt aber einen Parameter für die Arbeits Element Priorität hinzu.</span><span class="sxs-lookup"><span data-stu-id="2db8a-228">This method is equivalent to [**IMFReadTimeClient::SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue), but it adds a parameter for the work item priority.</span></span>               |
| [<span data-ttu-id="2db8a-229">**Unregisterthreads**</span><span class="sxs-lookup"><span data-stu-id="2db8a-229">**UnregisterThreads**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-unregisterthreads) | <span data-ttu-id="2db8a-230">Benachrichtigt die Komponente, dass die Registrierung Ihrer Threads bei MMCSS aufgehoben werden soll.</span><span class="sxs-lookup"><span data-stu-id="2db8a-230">Notifies the component to unregister its threads from MMCSS.</span></span> <span data-ttu-id="2db8a-231">Diese Methode ist identisch mit der [**imfrealtimeclient:: unregisterthreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-unregisterthreads) -Methode.</span><span class="sxs-lookup"><span data-stu-id="2db8a-231">This method is identical to the [**IMFRealTimeClient::UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-unregisterthreads) method.</span></span>                                       |



 

<span data-ttu-id="2db8a-232">Pipeline Komponenten sollten aus den folgenden Gründen Arbeits Warteschlangen verwenden und keine Arbeitsthreads erstellen:</span><span class="sxs-lookup"><span data-stu-id="2db8a-232">Pipeline components should use work queues, and should not create worker threads, for the following reasons:</span></span>

-   <span data-ttu-id="2db8a-233">Die Skalierung von Arbeits Warteschlangen ist besser, da Sie die Betriebssystem-Thread Pools</span><span class="sxs-lookup"><span data-stu-id="2db8a-233">Work queues scale better, because they use the OS thread pools.</span></span>
-   <span data-ttu-id="2db8a-234">Die Plattform behandelt die Details zum Registrieren von Arbeits Warteschlangen mit MMCSS.</span><span class="sxs-lookup"><span data-stu-id="2db8a-234">The platform handles the details of registering work queues with MMCSS.</span></span>
-   <span data-ttu-id="2db8a-235">Ein Arbeits Thread kann problemlos einen Deadlock verursachen, der schwer zu Debuggen ist.</span><span class="sxs-lookup"><span data-stu-id="2db8a-235">A worker thread can easily cause a deadlock that is hard to debug.</span></span>

<span data-ttu-id="2db8a-236">Sie sollten auch die Arbeits Warteschlange des Serialisierungsprogramms verwenden, wenn Sie Ihre asynchronen Vorgänge serialisieren müssen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-236">Also, consider using the serializer work queue if you need to serialize your asynchronous operations.</span></span>

### <a name="topology-branches"></a><span data-ttu-id="2db8a-237">Topologiebranches</span><span class="sxs-lookup"><span data-stu-id="2db8a-237">Topology Branches</span></span>

<span data-ttu-id="2db8a-238">Wenn das Attribut " [MF \_ toponode \_ workqueue" der \_ MMCSS- \_ Klasse](mf-toponode-workqueue-mmcss-class-attribute.md) eine topologieverzweigung mit MMCSS registriert, verwendet die Medien Sitzung in Windows 8 die freigegebenen MT-Arbeits Warteschlangen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-238">If the [MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS](mf-toponode-workqueue-mmcss-class-attribute.md) attribute registers a topology branch with MMCSS, in Windows 8 the Media Session uses the shared MT work queues.</span></span> <span data-ttu-id="2db8a-239">In früheren Versionen von Windows hat die Medien Sitzung eine neue Arbeits Warteschlange zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="2db8a-239">In earlier versions of Windows, the Media Session allocated a new work queue.</span></span>

<span data-ttu-id="2db8a-240">Zwei neue Attribute werden für die Registrierung einer topologieverzweigung mit MMCSS definiert.</span><span class="sxs-lookup"><span data-stu-id="2db8a-240">Two new attributes are defined for registering a topology branch with MMCSS.</span></span>



| <span data-ttu-id="2db8a-241">Attribut</span><span class="sxs-lookup"><span data-stu-id="2db8a-241">Attribute</span></span>                                                                            | <span data-ttu-id="2db8a-242">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="2db8a-242">Description</span></span>                         |
|--------------------------------------------------------------------------------------|-------------------------------------|
| [<span data-ttu-id="2db8a-243">MMCSS-Priorität der MF- \_ toponode- \_ workqueue \_ \_</span><span class="sxs-lookup"><span data-stu-id="2db8a-243">MF\_TOPONODE\_WORKQUEUE\_MMCSS\_PRIORITY</span></span>](mf-toponode-workqueue-mmcss-priority.md) | <span data-ttu-id="2db8a-244">Gibt die Basis Thread Priorität an.</span><span class="sxs-lookup"><span data-stu-id="2db8a-244">Specifies the base thread priority.</span></span> |
| [<span data-ttu-id="2db8a-245">Element Priorität für MF- \_ toponode- \_ workqueue \_ \_</span><span class="sxs-lookup"><span data-stu-id="2db8a-245">MF\_TOPONODE\_WORKQUEUE\_ITEM\_PRIORITY</span></span>](mf-toponode-workqueue-item-priority.md)   | <span data-ttu-id="2db8a-246">Gibt die Arbeits Element Priorität an.</span><span class="sxs-lookup"><span data-stu-id="2db8a-246">Specifies the work item priority.</span></span>   |



 

## <a name="recommendations"></a><span data-ttu-id="2db8a-247">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="2db8a-247">Recommendations</span></span>

-   <span data-ttu-id="2db8a-248">Anwendungen, die die Medien Sitzung verwenden, sollten die [MF- \_ toponode- \_ workqueue- \_ MMCSS- \_ Klasse](mf-toponode-workqueue-mmcss-class-attribute.md) für den audiorenderingbranch auf "Audiodatei" festlegen und für den videorenderingbranch "Wiedergabe"</span><span class="sxs-lookup"><span data-stu-id="2db8a-248">Applications that use the Media Session should set [MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS](mf-toponode-workqueue-mmcss-class-attribute.md) to "Audio" for the audio rendering branch and "Playback" for the video rendering branch.</span></span>
-   <span data-ttu-id="2db8a-249">Anwendungen, die die Medien Sitzung verwenden, sollten [**imfworkqueueservices:: beginregistertopologyworkqueueswithmmcss**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) in der Topologie aufrufen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-249">Applications that use the Media Session should call [**IMFWorkQueueServices::BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) on the topology.</span></span>
-   <span data-ttu-id="2db8a-250">Für Pipeline Komponenten werden Arbeits Warteschlangen anstelle von Arbeitsthreads empfohlen.</span><span class="sxs-lookup"><span data-stu-id="2db8a-250">For pipeline components, work queues are recommended instead of worker threads.</span></span> <span data-ttu-id="2db8a-251">Wenn die Komponente entweder Arbeits Warteschlangen oder Arbeitsthreads verwendet, implementieren Sie [**imfrealtimeclientex**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex).</span><span class="sxs-lookup"><span data-stu-id="2db8a-251">If the component uses either work queues or worker threads, implement [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex).</span></span>
-   <span data-ttu-id="2db8a-252">Erstellen Sie keine privaten Arbeits Warteschlangen, da dadurch der Zweck der Platt Form Arbeitswarteschlangen nicht mehr möglich ist.</span><span class="sxs-lookup"><span data-stu-id="2db8a-252">Do not create private work queues, as this defeats the purpose of the platform work queues.</span></span> <span data-ttu-id="2db8a-253">Verwenden Sie die Multithread-Multithread-Warteschlange oder eine serielle Warteschlange, die die Multithread-Multithread-Warteschlange</span><span class="sxs-lookup"><span data-stu-id="2db8a-253">Use either the platform multithreaded queue or a serial queue that wraps the platform multithreaded queue.</span></span>
-   <span data-ttu-id="2db8a-254">Wenn Sie asynchrone Vorgänge serialisieren müssen, verwenden Sie eine serielle Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="2db8a-254">If you need to serialize asynchronous operations, use a serial queue.</span></span>

## <a name="summary"></a><span data-ttu-id="2db8a-255">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="2db8a-255">Summary</span></span>

<span data-ttu-id="2db8a-256">Die folgenden Media Foundation Plattform-APIs, die sich auf Threads und Arbeits Warteschlangen beziehen, sind neu in Windows 8.</span><span class="sxs-lookup"><span data-stu-id="2db8a-256">The following Media Foundation platform APIs that relate to threads and work queues are new for Windows 8.</span></span>

-   [<span data-ttu-id="2db8a-257">Element Priorität für MF- \_ toponode- \_ workqueue \_ \_</span><span class="sxs-lookup"><span data-stu-id="2db8a-257">MF\_TOPONODE\_WORKQUEUE\_ITEM\_PRIORITY</span></span>](mf-toponode-workqueue-item-priority.md)
-   [<span data-ttu-id="2db8a-258">MMCSS-Priorität der MF- \_ toponode- \_ workqueue \_ \_</span><span class="sxs-lookup"><span data-stu-id="2db8a-258">MF\_TOPONODE\_WORKQUEUE\_MMCSS\_PRIORITY</span></span>](mf-toponode-workqueue-mmcss-priority.md)
-   [<span data-ttu-id="2db8a-259">**MF-Dienst Warteschlange**</span><span class="sxs-lookup"><span data-stu-id="2db8a-259">**MFAllocateSerialWorkQueue**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfallocateserialworkqueue)
-   [<span data-ttu-id="2db8a-260">**MFBeginRegisterWorkQueueWithMMCSSEx**</span><span class="sxs-lookup"><span data-stu-id="2db8a-260">**MFBeginRegisterWorkQueueWithMMCSSEx**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcssex)
-   [<span data-ttu-id="2db8a-261">**MF getworkqueuemmcsspriority**</span><span class="sxs-lookup"><span data-stu-id="2db8a-261">**MFGetWorkQueueMMCSSPriority**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsspriority)
-   [<span data-ttu-id="2db8a-262">**Mfputwaitingworkitem**</span><span class="sxs-lookup"><span data-stu-id="2db8a-262">**MFPutWaitingWorkItem**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfputwaitingworkitem)
-   [<span data-ttu-id="2db8a-263">**MFPutWorkItem2**</span><span class="sxs-lookup"><span data-stu-id="2db8a-263">**MFPutWorkItem2**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem2)
-   [<span data-ttu-id="2db8a-264">**MFPutWorkItemEx2**</span><span class="sxs-lookup"><span data-stu-id="2db8a-264">**MFPutWorkItemEx2**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex2)
-   [<span data-ttu-id="2db8a-265">**MF registerplatformwithmmcss**</span><span class="sxs-lookup"><span data-stu-id="2db8a-265">**MFRegisterPlatformWithMMCSS**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfregisterplatformwithmmcss)
-   [<span data-ttu-id="2db8a-266">**Mfunregisterplatformfrommmcss**</span><span class="sxs-lookup"><span data-stu-id="2db8a-266">**MFUnregisterPlatformFromMMCSS**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfunregisterplatformfrommmcss)
-   [<span data-ttu-id="2db8a-267">**Mflocksharedworkqueue**</span><span class="sxs-lookup"><span data-stu-id="2db8a-267">**MFLockSharedWorkQueue**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mflocksharedworkqueue)
-   [<span data-ttu-id="2db8a-268">**Imfrealtimecliumtex**</span><span class="sxs-lookup"><span data-stu-id="2db8a-268">**IMFRealTimeClientEx**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex)

## <a name="related-topics"></a><span data-ttu-id="2db8a-269">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="2db8a-269">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2db8a-270">Arbeits Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="2db8a-270">Work Queues</span></span>](work-queues.md)
</dt> </dl>

 

 
