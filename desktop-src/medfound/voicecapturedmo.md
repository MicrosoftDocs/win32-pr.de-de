---
description: Ein-Objekt, das mehrere DSPs in Bezug auf die sprach Erfassung kapselt.
ms.assetid: 6c77c8f6-289e-4130-b56a-e1f0bcc40f3e
title: Sprach Erfassungs-DSP (wmcodecdsp. h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 6e48c3b3194873008f45ef80ef3a21dad416158b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103755225"
---
# <a name="voice-capture-dsp"></a><span data-ttu-id="4f995-103">Sprach Erfassungs-DSP</span><span class="sxs-lookup"><span data-stu-id="4f995-103">Voice Capture DSP</span></span>

<span data-ttu-id="4f995-104">Ein-Objekt, das mehrere DSPs in Bezug auf die sprach Erfassung kapselt.</span><span class="sxs-lookup"><span data-stu-id="4f995-104">An object that encapsulates several DSPs related to voice capture.</span></span>

## <a name="clsid"></a><span data-ttu-id="4f995-105">CLSID</span><span class="sxs-lookup"><span data-stu-id="4f995-105">CLSID</span></span>

<span data-ttu-id="4f995-106">CLSID \_ cwmaudioaec</span><span class="sxs-lookup"><span data-stu-id="4f995-106">CLSID\_CWMAudioAEC</span></span>

## <a name="interfaces"></a><span data-ttu-id="4f995-107">Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="4f995-107">Interfaces</span></span>

-   [<span data-ttu-id="4f995-108">**Imediaobject**</span><span class="sxs-lookup"><span data-stu-id="4f995-108">**IMediaObject**</span></span>](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject)
-   <span data-ttu-id="4f995-109">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="4f995-109">**IPropertyStore**</span></span>

## <a name="properties"></a><span data-ttu-id="4f995-110">Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="4f995-110">Properties</span></span>



| <span data-ttu-id="4f995-111">Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="4f995-111">Property</span></span>                                                                                     | <span data-ttu-id="4f995-112">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="4f995-112">Description</span></span>                                                                                       |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="4f995-113">mfpkey \_ wmaaecma- \_ Geräte \_ Indizes</span><span class="sxs-lookup"><span data-stu-id="4f995-113">MFPKEY\_WMAAECMA\_DEVICE\_INDEXES</span></span>](mfpkey-wmaaecma-device-indexesproperty.md)              | <span data-ttu-id="4f995-114">Gibt an, welche Audiogeräte der DMO zum Erfassen und Rendern von Audiodaten verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f995-114">Specifies which audio devices the DMO uses for capturing and rendering audio.</span></span>                     |
| [<span data-ttu-id="4f995-115">mfpkey \_ wmaaecma \_ devicepair- \_ GUID</span><span class="sxs-lookup"><span data-stu-id="4f995-115">MFPKEY\_WMAAECMA\_DEVICEPAIR\_GUID</span></span>](mfpkey-wmaaecma-devicepair-guidproperty.md)            | <span data-ttu-id="4f995-116">Gibt die Kombination von Audiogeräten an, die zurzeit von der Anwendung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f995-116">Identifies the combination of audio devices that the application is currently using.</span></span>              |
| [<span data-ttu-id="4f995-117">mfpkey \_ wmaaecma \_ DMO- \_ Quell \_ Modus</span><span class="sxs-lookup"><span data-stu-id="4f995-117">MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE</span></span>](mfpkey-wmaaecma-dmo-source-modeproperty.md)           | <span data-ttu-id="4f995-118">Gibt an, ob der DMO den Quell Modus oder den Filter Modus verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f995-118">Specifies whether the DMO uses source mode or filter mode.</span></span>                                        |
| [<span data-ttu-id="4f995-119">mfpkey \_ wmaaecma \_ featr \_ AES</span><span class="sxs-lookup"><span data-stu-id="4f995-119">MFPKEY\_WMAAECMA\_FEATR\_AES</span></span>](mfpkey-wmaaecma-featr-aesproperty.md)                        | <span data-ttu-id="4f995-120">Gibt an, wie oft der DMO eine akustische Echo Unterdrückung (AES) für das restliche Signal ausführt.</span><span class="sxs-lookup"><span data-stu-id="4f995-120">Specifies how many times the DMO performs acoustic echo suppression (AES) on the residual signal.</span></span> |
| [<span data-ttu-id="4f995-121">mfpkey \_ wmaaecma \_ featr \_ AGC</span><span class="sxs-lookup"><span data-stu-id="4f995-121">MFPKEY\_WMAAECMA\_FEATR\_AGC</span></span>](mfpkey-wmaaecma-featr-agcproperty.md)                        | <span data-ttu-id="4f995-122">Gibt an, ob der DMO die automatische Steuerelement Steuerung ausführt.</span><span class="sxs-lookup"><span data-stu-id="4f995-122">Specifies whether the DMO performs automatic gain control.</span></span>                                        |
| [<span data-ttu-id="4f995-123">mfpkey \_ wmaaecma \_ featr \_ Center- \_ Clip</span><span class="sxs-lookup"><span data-stu-id="4f995-123">MFPKEY\_WMAAECMA\_FEATR\_CENTER\_CLIP</span></span>](mfpkey-wmaaecma-featr-center-clipproperty.md)       | <span data-ttu-id="4f995-124">Gibt an, ob der DMO das zentrale Clipping ausführt.</span><span class="sxs-lookup"><span data-stu-id="4f995-124">Specifies whether the DMO performs center clipping.</span></span>                                               |
| [<span data-ttu-id="4f995-125">mfpkey \_ wmaaecma \_ featr- \_ Echo \_ Länge</span><span class="sxs-lookup"><span data-stu-id="4f995-125">MFPKEY\_WMAAECMA\_FEATR\_ECHO\_LENGTH</span></span>](mfpkey-wmaaecma-featr-echo-lengthproperty.md)       | <span data-ttu-id="4f995-126">Gibt die Dauer von Echo an, die der AEC-Algorithmus (Akustik Echo Abbruch) verarbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="4f995-126">Specifies the duration of echo that the acoustic echo cancellation (AEC) algorithm can handle.</span></span>    |
| [<span data-ttu-id="4f995-127">mfpkey \_ wmaaecma \_ featr- \_ Frame \_ Größe</span><span class="sxs-lookup"><span data-stu-id="4f995-127">MFPKEY\_WMAAECMA\_FEATR\_FRAME\_SIZE</span></span>](mfpkey-wmaaecma-featr-frame-sizeproperty.md)         | <span data-ttu-id="4f995-128">Gibt die audioframe Größe an.</span><span class="sxs-lookup"><span data-stu-id="4f995-128">Specifies the audio frame size.</span></span>                                                                   |
| [<span data-ttu-id="4f995-129">mfpkey \_ wmaaecma \_ featr \_ micarr- \_ Strahl</span><span class="sxs-lookup"><span data-stu-id="4f995-129">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_BEAM</span></span>](mfpkey-wmaaecma-featr-micarr-beamproperty.md)       | <span data-ttu-id="4f995-130">Gibt an, welchen Strahl der DMO für die Verarbeitung von mikrofonarrays verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f995-130">Specifies which beam the DMO uses for microphone array processing.</span></span>                                |
| [<span data-ttu-id="4f995-131">mfpkey \_ wmaaecma \_ featr \_ micarr- \_ Modus</span><span class="sxs-lookup"><span data-stu-id="4f995-131">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_MODE</span></span>](mfpkey-wmaaecma-featr-micarr-modeproperty.md)       | <span data-ttu-id="4f995-132">Gibt an, wie der DMO die Verarbeitung von mikrofonarrays ausführt.</span><span class="sxs-lookup"><span data-stu-id="4f995-132">Specifies how the DMO performs microphone array processing.</span></span>                                       |
| [<span data-ttu-id="4f995-133">mfpkey \_ wmaaecma \_ featr \_ micarr \_ Preproc</span><span class="sxs-lookup"><span data-stu-id="4f995-133">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_PREPROC</span></span>](mfpkey-wmaaecma-featr-micarr-preprocproperty.md) | <span data-ttu-id="4f995-134">Gibt an, ob der DMO die Vorverarbeitung eines mikrofonarrays ausführt.</span><span class="sxs-lookup"><span data-stu-id="4f995-134">Specifies whether the DMO performs microphone array preprocessing.</span></span>                                |
| [<span data-ttu-id="4f995-135">mfpkey \_ wmaaecma \_ featr \_ \_ Füll Füll Füll Zeichen</span><span class="sxs-lookup"><span data-stu-id="4f995-135">MFPKEY\_WMAAECMA\_FEATR\_NOISE\_FILL</span></span>](mfpkey-wmaaecma-featr-noise-fillproperty.md)         | <span data-ttu-id="4f995-136">Gibt an, ob das DMO Füll Füllvorgänge durchführt.</span><span class="sxs-lookup"><span data-stu-id="4f995-136">Specifies whether the DMO performs noise filling.</span></span>                                                 |
| [<span data-ttu-id="4f995-137">mfpkey \_ wmaaecma \_ featr \_ NS</span><span class="sxs-lookup"><span data-stu-id="4f995-137">MFPKEY\_WMAAECMA\_FEATR\_NS</span></span>](mfpkey-wmaaecma-featr-nsproperty.md)                          | <span data-ttu-id="4f995-138">Gibt an, ob der DMO eine Rauschunterdrückung durchführt.</span><span class="sxs-lookup"><span data-stu-id="4f995-138">Specifies whether the DMO performs noise suppression.</span></span>                                             |
| [<span data-ttu-id="4f995-139">mfpkey \_ wmaaecma \_ featr \_ VAD</span><span class="sxs-lookup"><span data-stu-id="4f995-139">MFPKEY\_WMAAECMA\_FEATR\_VAD</span></span>](mfpkey-wmaaecma-featr-vadproperty.md)                        | <span data-ttu-id="4f995-140">Gibt den Typ der sprach Aktivitäts Erkennung an, die vom DMO durchführt wird.</span><span class="sxs-lookup"><span data-stu-id="4f995-140">Specifies the type of voice activity detection that the DMO performs.</span></span>                             |
| [<span data-ttu-id="4f995-141">mfpkey- \_ wmaaecma- \_ Funktions \_ Modus</span><span class="sxs-lookup"><span data-stu-id="4f995-141">MFPKEY\_WMAAECMA\_FEATURE\_MODE</span></span>](mfpkey-wmaaecma-feature-modeproperty.md)                  | <span data-ttu-id="4f995-142">Ermöglicht es der Anwendung, die Standardeinstellungen für verschiedene Eigenschaften zu überschreiben.</span><span class="sxs-lookup"><span data-stu-id="4f995-142">Enables the application to override the default settings on various properties.</span></span>                   |
| [<span data-ttu-id="4f995-143">mfpkey \_ wmaaecma \_ MIC-Wert \_ \_ bounter</span><span class="sxs-lookup"><span data-stu-id="4f995-143">MFPKEY\_WMAAECMA\_MIC\_GAIN\_BOUNDER</span></span>](mfpkey-wmaaecma-mic-gain-bounderproperty.md)         | <span data-ttu-id="4f995-144">Gibt an, ob das DMO die über-und das umgebende Mikrofon anwendet.</span><span class="sxs-lookup"><span data-stu-id="4f995-144">Specifies whether the DMO applies microphone gain bounding.</span></span>                                       |
| [<span data-ttu-id="4f995-145">mfpkey \_ wmaaecma \_ micarray \_ descptr</span><span class="sxs-lookup"><span data-stu-id="4f995-145">MFPKEY\_WMAAECMA\_MICARRAY\_DESCPTR</span></span>](mfpkey-wmaaecma-micarray-descptrproperty.md)          | <span data-ttu-id="4f995-146">Gibt die Mikrofon Array Geometrie an.</span><span class="sxs-lookup"><span data-stu-id="4f995-146">Specifies the microphone array geometry.</span></span>                                                          |
| [<span data-ttu-id="4f995-147">mfpkey \_ wmaaecma \_ Quality- \_ Metriken</span><span class="sxs-lookup"><span data-stu-id="4f995-147">MFPKEY\_WMAAECMA\_QUALITY\_METRICS</span></span>](mfpkey-wmaaecma-quality-metricsproperty.md)            | <span data-ttu-id="4f995-148">Ruft Qualitätsmetriken für AEC ab.</span><span class="sxs-lookup"><span data-stu-id="4f995-148">Retrieves quality metrics for AEC.</span></span>                                                                |
| [<span data-ttu-id="4f995-149">mfpkey \_ wmaaecma \_ ruft \_ TS- \_ Statistiken ab</span><span class="sxs-lookup"><span data-stu-id="4f995-149">MFPKEY\_WMAAECMA\_RETRIEVE\_TS\_STATS</span></span>](mfpkey-wmaaecma-retrieve-ts-statsproperty.md)       | <span data-ttu-id="4f995-150">Gibt an, ob der DMO Zeitstempel Statistiken in der Registrierung speichert.</span><span class="sxs-lookup"><span data-stu-id="4f995-150">Specifies whether the DMO stores time stamp statistics in the registry.</span></span>                           |
| [<span data-ttu-id="4f995-151">mfpkey- \_ wmaaecma- \_ System \_ Modus</span><span class="sxs-lookup"><span data-stu-id="4f995-151">MFPKEY\_WMAAECMA\_SYSTEM\_MODE</span></span>](mfpkey-wmaaecma-system-modeproperty.md)                    | <span data-ttu-id="4f995-152">Legt den Verarbeitungsmodus fest.</span><span class="sxs-lookup"><span data-stu-id="4f995-152">Sets the processing mode.</span></span>                                                                         |



 

## <a name="remarks"></a><span data-ttu-id="4f995-153">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="4f995-153">Remarks</span></span>

<span data-ttu-id="4f995-154">Im Gegensatz zu anderen DSPs kapselt das sprach Erfassungs Objekt mehrere DSPs in einem einzelnen-Objekt, und das-Objekt ist nur ein DMO-Objekt (es implementiert nicht [**IMF Transform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span><span class="sxs-lookup"><span data-stu-id="4f995-154">Unlike the other DSPs, the voice capture object encapsulates multiple DSPs in a single object, and the object is a DMO object only (it does not implement [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span></span> <span data-ttu-id="4f995-155">Die sprach Erfassungs-DMO umfasst die folgenden DSP-Komponenten:</span><span class="sxs-lookup"><span data-stu-id="4f995-155">The voice capture DMO includes the following DSP components:</span></span>

-   <span data-ttu-id="4f995-156">Abbruch von akustischem Echo (AEC)</span><span class="sxs-lookup"><span data-stu-id="4f995-156">Acoustic echo cancellation (AEC)</span></span>
-   <span data-ttu-id="4f995-157">Verarbeitung von mikrofonarrays</span><span class="sxs-lookup"><span data-stu-id="4f995-157">Microphone array processing</span></span>
-   <span data-ttu-id="4f995-158">Rauschunterdrückung</span><span class="sxs-lookup"><span data-stu-id="4f995-158">Noise suppression</span></span>
-   <span data-ttu-id="4f995-159">Automatisches erlangen von Steuerelementen</span><span class="sxs-lookup"><span data-stu-id="4f995-159">Automatic gain control</span></span>
-   <span data-ttu-id="4f995-160">Sprach Aktivitäts Erkennung</span><span class="sxs-lookup"><span data-stu-id="4f995-160">Voice activity detection</span></span>

<span data-ttu-id="4f995-161">Anwendungen können jede Komponente einzeln aktivieren bzw. deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="4f995-161">Applications can turn each component on and off individually.</span></span>

<span data-ttu-id="4f995-162">Der sprach Erfassungs-DMO unterstützt zwei Betriebsmodi, den *Filter* Modus und den *Quell* Modus.</span><span class="sxs-lookup"><span data-stu-id="4f995-162">The voice capture DMO supports two modes of operation, *filter* mode and *source* mode.</span></span> <span data-ttu-id="4f995-163">Im Filter Modus werden von der Anwendung Audiobeispiele vom Mikrofon und von der Sprecher Zeile an den DMO gesendet, und der DMO erzeugt eine Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="4f995-163">In filter mode, the application sends audio samples from the microphone and from the speaker line to the DMO, and the DMO produces output.</span></span>

<span data-ttu-id="4f995-164">Im Quell Modus muss die Anwendung keine Beispiele für den DMO bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="4f995-164">In source mode, the application does not need to deliver samples to the DMO.</span></span> <span data-ttu-id="4f995-165">Stattdessen verwaltet der DMO alle Vorgänge auf den Audiogeräten, einschließlich der Initialisierung der Geräte, dem erfassen und Synchronisieren der Audiodatenströme, dem Berechnen von Zeitstempeln und dem Abrufen der Geometrie des mikrofonarrays.</span><span class="sxs-lookup"><span data-stu-id="4f995-165">Instead, the DMO manages all of the operations on the audio devices, including initializing the devices, capturing and synchronizing the audio streams, calculating time stamps, and retrieving the geometry of the microphone array.</span></span> <span data-ttu-id="4f995-166">Mithilfe des Quell Modus konfiguriert die Anwendung einfach den DMO, und die Ausgabe des DMO ist ein sauberes, verarbeitetes Mikrofonsignal.</span><span class="sxs-lookup"><span data-stu-id="4f995-166">Using source mode, the application simply configures the DMO, and the output from the DMO is a clean, processed microphone signal.</span></span> <span data-ttu-id="4f995-167">Der Quell Modus ist wesentlich einfacher zu verwenden als der Filter Modus, und wird für die meisten Anwendungen empfohlen.</span><span class="sxs-lookup"><span data-stu-id="4f995-167">Source mode is significantly easier to use than filter mode, and is recommended for most applications.</span></span>

<span data-ttu-id="4f995-168">Zurzeit unterstützt die sprach Erfassungs-DMO nur einen akustische Echo Abbruch (Single-Channel), sodass die Ausgabe der Redner Zeile einen einzelnen Kanal aufweisen muss.</span><span class="sxs-lookup"><span data-stu-id="4f995-168">Currently the voice capture DMO supports only single-channel acoustic echo cancellation (AEC), so the output from the speaker line must be single-channel.</span></span> <span data-ttu-id="4f995-169">Wenn die Verarbeitung von mikrofonarrays deaktiviert ist, wird die Eingabe mit mehreren Kanälen für die AEC-Verarbeitung auf einen Kanal reduziert.</span><span class="sxs-lookup"><span data-stu-id="4f995-169">If microphone array processing is disabled, multi-channel input is folded down to one channel for AEC processing.</span></span> <span data-ttu-id="4f995-170">Wenn die Verarbeitung von mikrofonarrays und die AEC-Verarbeitung aktiviert sind, wird AEC vor der Verarbeitung des mikrofonarrays für jedes Mikrofon Element ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="4f995-170">If both microphone array processing and AEC processing are enabled, AEC is performed on each microphone element before microphone array processing.</span></span>

### <a name="microphone-array-processing"></a><span data-ttu-id="4f995-171">Verarbeitung von mikrofonarrays</span><span class="sxs-lookup"><span data-stu-id="4f995-171">Microphone Array Processing</span></span>

<span data-ttu-id="4f995-172">Ein Mikrofon Array ist ein Satz eng positionierter Mikrofone.</span><span class="sxs-lookup"><span data-stu-id="4f995-172">A microphone array is a set of closely positioned microphones.</span></span> <span data-ttu-id="4f995-173">Mikrofonarrays erzielen eine bessere Direktionalität als ein einzelnes Mikrofon, da die akustischen Wellen bei jedem Mikrofon zu einem etwas anderen Zeitpunkt eintreffen.</span><span class="sxs-lookup"><span data-stu-id="4f995-173">Microphone arrays achieve better directionality than a single microphone, because the acoustic waves arrive at each microphone at a slightly different time.</span></span> <span data-ttu-id="4f995-174">Weitere Informationen zu mikrofonarrays finden Sie in den Webartikeln [Mikrofon Array Unterstützung in Windows Vista](/windows-hardware/design/component-guidelines/audio) und [Erstellen und Verwenden von mikrofonarrays für Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span><span class="sxs-lookup"><span data-stu-id="4f995-174">For more information on microphone arrays see the web articles [Microphone Array Support in Windows Vista](/windows-hardware/design/component-guidelines/audio) and [How to Build and Use Microphone Arrays for Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span></span>

### <a name="using-the-voice-capture-dsp"></a><span data-ttu-id="4f995-175">Verwenden des sprach Erfassungs-DSP</span><span class="sxs-lookup"><span data-stu-id="4f995-175">Using the Voice Capture DSP</span></span>

<span data-ttu-id="4f995-176">Führen Sie die folgenden Schritte aus, um den sprach Erfassungs-DSP zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="4f995-176">To use the Voice Capture DSP, perform the following steps.</span></span>

### <a name="1-initialize-the-dmo"></a><span data-ttu-id="4f995-177">1. Initialisieren des DMO</span><span class="sxs-lookup"><span data-stu-id="4f995-177">1. Initialize the DMO</span></span>

<span data-ttu-id="4f995-178">Erstellen Sie die sprach Erfassungs-DMO, indem Sie [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) mit der CLSID- **CLSID \_ cwmaudioaec** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="4f995-178">Create the voice capture DMO by calling [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) with the CLSID **CLSID\_CWMAudioAEC**.</span></span> <span data-ttu-id="4f995-179">Der sprach Erfassungs-dsdp macht nur die Schnittstellen [**imediaobject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) und [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) verfügbar und kann daher nur als DMO verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f995-179">The voice capture DSDP exposes only the [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) and [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interfaces, so it can only be used as a DMO.</span></span>

<span data-ttu-id="4f995-180">DMO ist standardmäßig auf den Quell Modus festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4f995-180">The DMO defaults to source mode.</span></span> <span data-ttu-id="4f995-181">Um den Filter Modus auszuwählen, legen Sie die Eigenschaft [mfpkey \_ wmaaecma \_ DMO \_ Source \_ Mode](mfpkey-wmaaecma-dmo-source-modeproperty.md) auf **Variant \_ false** fest.</span><span class="sxs-lookup"><span data-stu-id="4f995-181">To select filter mode, set the [MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE](mfpkey-wmaaecma-dmo-source-modeproperty.md) property to **VARIANT\_FALSE**.</span></span>

<span data-ttu-id="4f995-182">Konfigurieren Sie als nächstes die internen Eigenschaften des DMO mithilfe der [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="4f995-182">Next, configure the internal properties of the DMO by using the [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interface.</span></span> <span data-ttu-id="4f995-183">Die einzige Eigenschaft, die von einer Anwendung festgelegt werden muss, ist die [mfpkey \_ wmaaecma \_ System \_ Mode](mfpkey-wmaaecma-system-modeproperty.md) -Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="4f995-183">The only property that an application must set is the [MFPKEY\_WMAAECMA\_SYSTEM\_MODE](mfpkey-wmaaecma-system-modeproperty.md) property.</span></span> <span data-ttu-id="4f995-184">Diese Eigenschaft konfiguriert die Verarbeitungs Pipeline innerhalb des DMO.</span><span class="sxs-lookup"><span data-stu-id="4f995-184">This property configures the processing pipeline within the DMO.</span></span> <span data-ttu-id="4f995-185">Die anderen Eigenschaften sind optional.</span><span class="sxs-lookup"><span data-stu-id="4f995-185">The other properties are optional.</span></span>

### <a name="2-set-the-input-and-output-formats"></a><span data-ttu-id="4f995-186">2. Festlegen der Eingabe-und Ausgabeformate</span><span class="sxs-lookup"><span data-stu-id="4f995-186">2. Set the Input and Output Formats</span></span>

<span data-ttu-id="4f995-187">Wenn Sie DMO im Filter Modus verwenden, legen Sie das Eingabeformat durch Aufrufen von [**imediaobject:: setinputtype**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype)fest.</span><span class="sxs-lookup"><span data-stu-id="4f995-187">If you are using the DMO in filter mode, set the input format by calling [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype).</span></span> <span data-ttu-id="4f995-188">Das Eingabeformat kann fast jeder gültige unkomprimierte PCM oder IEEE-Gleit Komma-Audiotyp sein.</span><span class="sxs-lookup"><span data-stu-id="4f995-188">The input format can be almost any valid uncompressed PCM or IEEE floating-point audio type.</span></span> <span data-ttu-id="4f995-189">Wenn das Eingabeformat nicht mit dem Ausgabeformat identisch ist, führt der DMO automatisch eine Stichproben Raten Konvertierung durch.</span><span class="sxs-lookup"><span data-stu-id="4f995-189">If the input format does not match the output format, the DMO automatically performs sample-rate conversion.</span></span>

<span data-ttu-id="4f995-190">Wenn Sie die DMO im Quell Modus verwenden, legen Sie das Eingabeformat nicht fest.</span><span class="sxs-lookup"><span data-stu-id="4f995-190">If you are using the DMO in source mode, do not set the input format.</span></span> <span data-ttu-id="4f995-191">Der DMO konfiguriert das Eingabeformat automatisch auf der Grundlage der Audiogeräte.</span><span class="sxs-lookup"><span data-stu-id="4f995-191">The DMO automatically configures the input format based on the audio devices.</span></span>

<span data-ttu-id="4f995-192">Legen Sie in beiden Modi das Ausgabeformat durch Aufrufen von [**imediaobject:: setoutputtype**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype)fest.</span><span class="sxs-lookup"><span data-stu-id="4f995-192">In either mode, set the output format by calling [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span></span> <span data-ttu-id="4f995-193">Der DMO kann die folgenden Ausgabeformate akzeptieren:</span><span class="sxs-lookup"><span data-stu-id="4f995-193">The DMO can accept the following output formats:</span></span>

-   <span data-ttu-id="4f995-194">Untertyp: **mediasubtype \_ PCM** oder **mediasubtype \_ IEEE \_ float**</span><span class="sxs-lookup"><span data-stu-id="4f995-194">Subtype: **MEDIASUBTYPE\_PCM** or **MEDIASUBTYPE\_IEEE\_FLOAT**</span></span>
-   <span data-ttu-id="4f995-195">Format Block: [**Waveformat**](/windows/win32/api/mmreg/ns-mmreg-waveformat) oder [**WaveFormatEx**](/previous-versions/dd757713(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="4f995-195">Format block: [**WAVEFORMAT**](/windows/win32/api/mmreg/ns-mmreg-waveformat) or [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))</span></span>
-   <span data-ttu-id="4f995-196">Stichproben pro Sekunde: 8.000; 11.025; 16.000; oder 22.050</span><span class="sxs-lookup"><span data-stu-id="4f995-196">Samples per second: 8,000; 11,025; 16,000; or 22,050</span></span>
-   <span data-ttu-id="4f995-197">Kanäle: 1 für den reinen AEC-Modus, 2 oder 4 für die Verarbeitung von mikrofonarrays</span><span class="sxs-lookup"><span data-stu-id="4f995-197">Channels: 1 for AEC-only mode, 2 or 4 for microphone array processing</span></span>
-   <span data-ttu-id="4f995-198">Bits pro Beispiel: 16</span><span class="sxs-lookup"><span data-stu-id="4f995-198">Bits per sample: 16</span></span>

<span data-ttu-id="4f995-199">Mit dem folgenden Code wird der Ausgabetyp auf einen 32-Bit-PCM mit einem PCM mit einem einzelnen Kanal</span><span class="sxs-lookup"><span data-stu-id="4f995-199">The following code sets the output type to 16-bit single-channel PCM audio:</span></span>


```
DMO_MEDIA_TYPE mt;  // Media type.
mt.majortype = MEDIATYPE_Audio;
mt.subtype = MEDIASUBTYPE_PCM;
mt.lSampleSize = 0;
mt.bFixedSizeSamples = TRUE;
mt.bTemporalCompression = FALSE;
mt.formattype = FORMAT_WaveFormatEx;

// Allocate the format block to hold the WAVEFORMATEX structure.
hr = MoInitMediaType(&mt, sizeof(WAVEFORMATEX));
if (SUCCEEDED(hr))
{
    WAVEFORMATEX *pwav = (WAVEFORMATEX*)mt.pbFormat;
    pwav->wFormatTag = WAVE_FORMAT_PCM;
    pwav->nChannels = 1;
    pwav->nSamplesPerSec = 16000;
    pwav->nAvgBytesPerSec = 32000;
    pwav->nBlockAlign = 2;
    pwav->wBitsPerSample = 16;
    pwav->cbSize = 0;

    // Set the output type.
    if (SUCCEEDED(hr))
    {
        hr = pDMO->SetOutputType(0, &mt, 0); 
    }
    // Free the format block.
    MoFreeMediaType(&mt);
}
```



### <a name="3-process-data"></a><span data-ttu-id="4f995-200">3. verarbeiten von Daten</span><span class="sxs-lookup"><span data-stu-id="4f995-200">3. Process Data</span></span>

<span data-ttu-id="4f995-201">Vor der Verarbeitung von Daten empfiehlt es sich, [**imediaobject:: depingestreamingresources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources)aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="4f995-201">Before processing any data, it is recommended to call [**IMediaObject::AllocateStreamingResources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources).</span></span> <span data-ttu-id="4f995-202">Diese Methode ordnet die Ressourcen zu, die intern vom DMO verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f995-202">This method allocates the resources used internally by the DMO.</span></span> <span data-ttu-id="4f995-203">Nach den zuvor aufgeführten Schritten, nicht vor, wird "" **zugeordnet** .</span><span class="sxs-lookup"><span data-stu-id="4f995-203">Call **AllocateStreamingResources** after the steps listed previously, not before.</span></span> <span data-ttu-id="4f995-204">Wenn Sie diese Methode nicht aufzurufen, ordnet der DMO beim Start der Datenverarbeitung automatisch Ressourcen zu.</span><span class="sxs-lookup"><span data-stu-id="4f995-204">If you do not call this method, the DMO automatically allocates resources when data processing starts.</span></span>

<span data-ttu-id="4f995-205">Wenn Sie den DMO im Filter Modus verwenden, müssen Sie die Eingabedaten an den DMO übergeben, indem Sie [**imediaobject::P rocessinput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="4f995-205">If you are using the DMO in filter mode, you must pass input data to the DMO by calling [**IMediaObject::ProcessInput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput).</span></span> <span data-ttu-id="4f995-206">Die Audiodaten des Mikrofons werden an Stream 0 weitergeleitet, und die Audiodaten aus der Redner Linie werden in Stream 1 geleitet.</span><span class="sxs-lookup"><span data-stu-id="4f995-206">The audio data from the microphone goes to stream 0, and the audio data from the speaker line goes to stream 1.</span></span> <span data-ttu-id="4f995-207">Wenn Sie den DMO im Quell Modus verwenden, müssen Sie **ProcessInput** nicht aufrufen.</span><span class="sxs-lookup"><span data-stu-id="4f995-207">If you are using the DMO in source mode, you do not need to call **ProcessInput**.</span></span>

<span data-ttu-id="4f995-208">Um Ausgabedaten aus dem DSP zu erhalten, führen Sie die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="4f995-208">To get output data from the DSP, perform the following steps:</span></span>

1.  <span data-ttu-id="4f995-209">Erstellen Sie ein Puffer Objekt, das die Ausgabedaten enthalten soll.</span><span class="sxs-lookup"><span data-stu-id="4f995-209">Create a buffer object to hold the output data.</span></span> <span data-ttu-id="4f995-210">Das Buffer-Objekt muss die [**imediabuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="4f995-210">The buffer object must implement the [**IMediaBuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) interface.</span></span> <span data-ttu-id="4f995-211">Die Größe des Puffers hängt von den Anforderungen der Anwendung ab.</span><span class="sxs-lookup"><span data-stu-id="4f995-211">The size of the buffer depends on the requirements of your application.</span></span> <span data-ttu-id="4f995-212">Wenn Sie einen größeren Puffer zuordnen, können Sie die Wahrscheinlichkeit verringern, dass ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="4f995-212">Allocating a larger buffer can reduce the chances of glitches occurring.</span></span>
2.  <span data-ttu-id="4f995-213">Deklarieren Sie eine [**DMO- \_ Ausgabe \_ Daten \_ Puffer**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) Struktur, und legen Sie das **pbuffer** -Element auf das Puffer Objekt fest.</span><span class="sxs-lookup"><span data-stu-id="4f995-213">Declare a [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure and set the **pBuffer** member to point to your buffer object.</span></span>
3.  <span data-ttu-id="4f995-214">Übergeben Sie die [**DMO- \_ Ausgabe \_ Daten \_ Puffer**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) Struktur an die [**imediaobject::P rocess Output**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) -Methode.</span><span class="sxs-lookup"><span data-stu-id="4f995-214">Pass the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure to the [**IMediaObject::ProcessOutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) method.</span></span>
4.  <span data-ttu-id="4f995-215">Setzen Sie diese Methode fort, solange der DMO Ausgabedaten enthält.</span><span class="sxs-lookup"><span data-stu-id="4f995-215">Continue to call this method for as long as the DMO has output data.</span></span> <span data-ttu-id="4f995-216">Der DSP signalisiert, dass eine höhere Ausgabe besteht, indem das Flag **DMO \_ Output \_ Data \_ bufferf \_ unvollständiges** Flag im **dwStatus** -Member der [**DMO- \_ Ausgabe \_ Daten \_ Puffer**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) Struktur festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="4f995-216">The DSP signals that it has more output by setting the **DMO\_OUTPUT\_DATA\_BUFFERF\_INCOMPLETE** flag in the **dwStatus** member of the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure.</span></span>

## <a name="requirements"></a><span data-ttu-id="4f995-217">Anforderungen</span><span class="sxs-lookup"><span data-stu-id="4f995-217">Requirements</span></span>



| <span data-ttu-id="4f995-218">Anforderung</span><span class="sxs-lookup"><span data-stu-id="4f995-218">Requirement</span></span> | <span data-ttu-id="4f995-219">Wert</span><span class="sxs-lookup"><span data-stu-id="4f995-219">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="4f995-220">Unterstützte Mindestversion (Client)</span><span class="sxs-lookup"><span data-stu-id="4f995-220">Minimum supported client</span></span><br/> | <span data-ttu-id="4f995-221">Nur Windows Vista \[ -Desktop-Apps\]</span><span class="sxs-lookup"><span data-stu-id="4f995-221">Windows Vista \[desktop apps only\]</span></span><br/>                                          |
| <span data-ttu-id="4f995-222">Unterstützte Mindestversion (Server)</span><span class="sxs-lookup"><span data-stu-id="4f995-222">Minimum supported server</span></span><br/> | <span data-ttu-id="4f995-223">Nur Windows Server 2008 \[ -Desktop-Apps\]</span><span class="sxs-lookup"><span data-stu-id="4f995-223">Windows Server 2008 \[desktop apps only\]</span></span><br/>                                    |
| <span data-ttu-id="4f995-224">Header</span><span class="sxs-lookup"><span data-stu-id="4f995-224">Header</span></span><br/>                   | <dl> <span data-ttu-id="4f995-225"><dt>Wmcodecdsp. h</dt></span><span class="sxs-lookup"><span data-stu-id="4f995-225"><dt>Wmcodecdsp.h</dt></span></span> </dl> |
| <span data-ttu-id="4f995-226">DLL</span><span class="sxs-lookup"><span data-stu-id="4f995-226">DLL</span></span><br/>                      | <dl> <span data-ttu-id="4f995-227"><dt>Mfwmaaec.dll</dt></span><span class="sxs-lookup"><span data-stu-id="4f995-227"><dt>Mfwmaaec.dll</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="4f995-228">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="4f995-228">See also</span></span>

<dl> <dt>

[<span data-ttu-id="4f995-229">Digitale Signal Prozessoren</span><span class="sxs-lookup"><span data-stu-id="4f995-229">Digital Signal Processors</span></span>](windowsmediadigitalsignalprocessors.md)
</dt> </dl>

 

 
