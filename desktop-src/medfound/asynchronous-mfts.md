---
description: In diesem Thema wird die asynchrone Datenverarbeitung für Media Foundation Transformationen (MFTs) beschrieben.
ms.assetid: d438ffae-fc50-454f-8ce4-2d6676500fff
title: Asynchrone MFTs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4a16950cf431eff16f2befb382a77910c49ccb2e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106343211"
---
# <a name="asynchronous-mfts"></a><span data-ttu-id="c1e3c-103">Asynchrone MFTs</span><span class="sxs-lookup"><span data-stu-id="c1e3c-103">Asynchronous MFTs</span></span>

<span data-ttu-id="c1e3c-104">In diesem Thema wird die asynchrone Datenverarbeitung für Media Foundation Transformationen (MFTs) beschrieben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-104">This topic describes asynchronous data processing for Media Foundation transforms (MFTs).</span></span>

> [!Note]  
> <span data-ttu-id="c1e3c-105">Dieses Thema gilt für Windows 7 oder höher.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-105">This topic applies to Windows 7 or later.</span></span>

 

-   [<span data-ttu-id="c1e3c-106">Informationen zu asynchronen MFTs</span><span class="sxs-lookup"><span data-stu-id="c1e3c-106">About Asynchronous MFTs</span></span>](#about-asynchronous-mfts)
-   [<span data-ttu-id="c1e3c-107">Allgemeine Anforderungen</span><span class="sxs-lookup"><span data-stu-id="c1e3c-107">General Requirements</span></span>](#general-requirements)
-   [<span data-ttu-id="c1e3c-108">Ereignisse</span><span class="sxs-lookup"><span data-stu-id="c1e3c-108">Events</span></span>](#events)
-   [<span data-ttu-id="c1e3c-109">ProcessInput</span><span class="sxs-lookup"><span data-stu-id="c1e3c-109">ProcessInput</span></span>](#processinput)
-   [<span data-ttu-id="c1e3c-110">ProcessOutput</span><span class="sxs-lookup"><span data-stu-id="c1e3c-110">ProcessOutput</span></span>](#processoutput)
-   [<span data-ttu-id="c1e3c-111">Ernde</span><span class="sxs-lookup"><span data-stu-id="c1e3c-111">Draining</span></span>](#draining)
-   [<span data-ttu-id="c1e3c-112">Lak</span><span class="sxs-lookup"><span data-stu-id="c1e3c-112">Flushing</span></span>](#flushing)
-   [<span data-ttu-id="c1e3c-113">Marker</span><span class="sxs-lookup"><span data-stu-id="c1e3c-113">Markers</span></span>](#markers)
-   [<span data-ttu-id="c1e3c-114">Formatieren von Änderungen</span><span class="sxs-lookup"><span data-stu-id="c1e3c-114">Format Changes</span></span>](#format-changes)
-   [<span data-ttu-id="c1e3c-115">Attribute</span><span class="sxs-lookup"><span data-stu-id="c1e3c-115">Attributes</span></span>](#attributes)
-   [<span data-ttu-id="c1e3c-116">Entsperren von asynchronen MFTs</span><span class="sxs-lookup"><span data-stu-id="c1e3c-116">Unlocking Asynchronous MFTs</span></span>](#unlocking-asynchronous-mfts)
-   [<span data-ttu-id="c1e3c-117">Der MFT wird heruntergefahren.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-117">Shutting Down the MFT</span></span>](#shutting-down-the-mft)
-   [<span data-ttu-id="c1e3c-118">Registrierung und Enumeration</span><span class="sxs-lookup"><span data-stu-id="c1e3c-118">Registration and Enumeration</span></span>](#registration-and-enumeration)
-   [<span data-ttu-id="c1e3c-119">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="c1e3c-119">Related topics</span></span>](#related-topics)

## <a name="about-asynchronous-mfts"></a><span data-ttu-id="c1e3c-120">Informationen zu asynchronen MFTs</span><span class="sxs-lookup"><span data-stu-id="c1e3c-120">About Asynchronous MFTs</span></span>

<span data-ttu-id="c1e3c-121">Wenn MFTs in Windows Vista eingeführt wurden, wurde die API für die *synchrone* Datenverarbeitung konzipiert.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-121">When MFTs were introduced in Windows Vista, the API was designed for *synchronous* data processing.</span></span> <span data-ttu-id="c1e3c-122">In diesem Modell wartet der MFT immer entweder auf Eingaben oder wartet auf die Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-122">In that model, the MFT is always either waiting to get input, or waiting to produce output.</span></span>

<span data-ttu-id="c1e3c-123">Denken Sie an einen typischen Video Decoder.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-123">Consider a typical video decoder.</span></span> <span data-ttu-id="c1e3c-124">Um einen decodierten Frame zu erhalten, ruft der Client [**imftransform::P rocess Output**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput)auf.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-124">To get a decoded frame, the client calls [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span> <span data-ttu-id="c1e3c-125">Wenn der Decoder über genügend Daten zum Decodieren eines Frames verfügt, werden **ProcessOutput** blockiert, während die MFT den Frame decodiert.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-125">If the decoder has enough data to decode a frame, **ProcessOutput** blocks while the MFT decodes the frame.</span></span> <span data-ttu-id="c1e3c-126">Andernfalls gibt **ProcessOutput** **MF_E_TRANSFORM_NEED_MORE_INPUT** zurück, was darauf hinweist, dass der Client [**imftransform::P rocessinput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput)aufrufen sollte.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-126">Otherwise, **ProcessOutput** returns **MF_E_TRANSFORM_NEED_MORE_INPUT**, indicating that the client should call [**IMFTransform::ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span></span>

<span data-ttu-id="c1e3c-127">Dieses Modell funktioniert gut, wenn der Decoder alle Decodierungs Vorgänge in einem Thread ausführt.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-127">This model works well if the decoder performs all of its decoding operations on one thread.</span></span> <span data-ttu-id="c1e3c-128">Angenommen, der Decoder verwendet mehrere Threads, um Frames parallel zu decodieren.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-128">But suppose the decoder uses several threads to decode frames in parallel.</span></span> <span data-ttu-id="c1e3c-129">Um die optimale Leistung zu erzielen, sollte der Decoder immer dann neue Eingaben erhalten, wenn sich ein Decodierungs Thread im Leerlauf</span><span class="sxs-lookup"><span data-stu-id="c1e3c-129">For the best performance, the decoder should receive new input whenever a decoding thread becomes idle.</span></span> <span data-ttu-id="c1e3c-130">Die Rate, mit der Threads Decodierungs Vorgänge ausführen, wird jedoch nicht exakt an den Aufrufen von [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) und [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput)des Clients angepasst, was dazu führt, dass Threads auf Arbeit warten.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-130">But the rate at which threads complete decoding operations will not align exactly with the client's calls to [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) and [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput), resulting in threads waiting for work.</span></span>

<span data-ttu-id="c1e3c-131">Windows 7 führt die ereignisgesteuerte *asynchrone* Verarbeitung für MFTs ein.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-131">Windows 7 introduces event-driven, *asynchronous* processing for MFTs.</span></span> <span data-ttu-id="c1e3c-132">Bei diesem Modell sendet ein Ereignis an den Client, wenn die MFT eine Eingabe oder eine Ausgabe benötigt.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-132">In this model, whenever the MFT needs input or has output, it sends an event to the client.</span></span>

## <a name="general-requirements"></a><span data-ttu-id="c1e3c-133">Allgemeine Anforderungen</span><span class="sxs-lookup"><span data-stu-id="c1e3c-133">General Requirements</span></span>

<span data-ttu-id="c1e3c-134">In diesem Thema wird beschrieben, wie sich asynchrone MFTs von synchroner MFT unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-134">This topic describes how asynchronous MFTs differ from synchronous MFT.</span></span> <span data-ttu-id="c1e3c-135">Mit Ausnahme der in diesem Thema genannten, sind die beiden Verarbeitungs Modelle identisch.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-135">Except where noted in this topic, the two processing models are the same.</span></span> <span data-ttu-id="c1e3c-136">(Insbesondere ist die Format Aushandlung identisch.)</span><span class="sxs-lookup"><span data-stu-id="c1e3c-136">(In particular, format negotiation is the same.)</span></span>

<span data-ttu-id="c1e3c-137">Ein asynchroner MFT muss die folgenden Schnittstellen implementieren:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-137">An asynchronous MFT must implement the following interfaces:</span></span>

-   [<span data-ttu-id="c1e3c-138">**IMF-Transformation**</span><span class="sxs-lookup"><span data-stu-id="c1e3c-138">**IMFTransform**</span></span>](/windows/desktop/api/mftransform/nn-mftransform-imftransform)
-   [<span data-ttu-id="c1e3c-139">**IMF Media Event Generator**</span><span class="sxs-lookup"><span data-stu-id="c1e3c-139">**IMFMediaEventGenerator**</span></span>](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator)
-   [<span data-ttu-id="c1e3c-140">**Nicht Herunterfahren**</span><span class="sxs-lookup"><span data-stu-id="c1e3c-140">**IMFShutdown**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown)

## <a name="events"></a><span data-ttu-id="c1e3c-141">Ereignisse</span><span class="sxs-lookup"><span data-stu-id="c1e3c-141">Events</span></span>

<span data-ttu-id="c1e3c-142">Ein asynchroner MFT verwendet die folgenden Ereignisse, um den Datenverarbeitungs Status zu signalisieren:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-142">An asynchronous MFT uses the following events to signal its data-processing status:</span></span>



| <span data-ttu-id="c1e3c-143">Ereignis</span><span class="sxs-lookup"><span data-stu-id="c1e3c-143">Event</span></span>                                                    | <span data-ttu-id="c1e3c-144">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="c1e3c-144">Description</span></span>                                                       |
|----------------------------------------------------------|-------------------------------------------------------------------|
| [<span data-ttu-id="c1e3c-145">Metransformneedinput</span><span class="sxs-lookup"><span data-stu-id="c1e3c-145">METransformNeedInput</span></span>](metransformneedinput.md)         | <span data-ttu-id="c1e3c-146">Wird gesendet, wenn die MFT mehr Eingaben akzeptieren kann.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-146">Sent when the MFT can accept more input.</span></span>                          |
| [<span data-ttu-id="c1e3c-147">Metransformhaveoutput</span><span class="sxs-lookup"><span data-stu-id="c1e3c-147">METransformHaveOutput</span></span>](metransformhaveoutput.md)       | <span data-ttu-id="c1e3c-148">Wird gesendet, wenn die MFT ausgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-148">Sent when the MFT has output.</span></span>                                     |
| [<span data-ttu-id="c1e3c-149">Metransformdraunvollständig</span><span class="sxs-lookup"><span data-stu-id="c1e3c-149">METransformDrainComplete</span></span>](metransformdraincomplete.md) | <span data-ttu-id="c1e3c-150">Wird gesendet, wenn ein Ausgleichs Vorgang abgeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-150">Sent when a drain operation completes.</span></span> <span data-ttu-id="c1e3c-151">Siehe [ableiten](#draining).</span><span class="sxs-lookup"><span data-stu-id="c1e3c-151">See [Draining](#draining).</span></span> |
| [<span data-ttu-id="c1e3c-152">Metransformmarker</span><span class="sxs-lookup"><span data-stu-id="c1e3c-152">METransformMarker</span></span>](metransformmarker.md)               | <span data-ttu-id="c1e3c-153">Wird gesendet, wenn ein Marker ein Prozess ist.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-153">Sent when a marker is process.</span></span> <span data-ttu-id="c1e3c-154">Siehe [Marker](#markers).</span><span class="sxs-lookup"><span data-stu-id="c1e3c-154">See [Markers](#markers).</span></span>           |



 

<span data-ttu-id="c1e3c-155">Diese Ereignisse werden out-of-Band gesendet.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-155">These events are sent out-of-band.</span></span> <span data-ttu-id="c1e3c-156">Es ist wichtig, den Unterschied zwischen in-Band-und Out-of-Band-Ereignissen im Kontext einer MFT zu verstehen.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-156">It is important to understand the difference between in-band and out-of-band events in the context of an MFT.</span></span>

<span data-ttu-id="c1e3c-157">Der ursprüngliche MFT-Entwurf unterstützt *in-Band-* Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-157">The original MFT design supports *in-band* events.</span></span> <span data-ttu-id="c1e3c-158">Ein in-Band-Ereignis enthält Informationen zum Datenstrom, z. b. Informationen zu einer Formatänderung.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-158">An in-band event contains information about the data stream, such as information about a format change.</span></span> <span data-ttu-id="c1e3c-159">Der Client sendet in-Band-Ereignisse durch Aufrufen von [**imftransform::P rocesabvent**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processevent)an die MFT.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-159">The client sends in-band events to the MFT by calling [**IMFTransform::ProcessEvent**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processevent).</span></span> <span data-ttu-id="c1e3c-160">Der MFT kann in-Band-Ereignisse in der [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) -Methode an den Client zurücksenden.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-160">The MFT can send in-band events back to the client in the [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) method.</span></span> <span data-ttu-id="c1e3c-161">(Insbesondere werden Ereignisse im Member " **Peer Vents** " der [**MFT_OUTPUT_DATA_BUFFER**](/windows/desktop/api/mftransform/ns-mftransform-mft_output_data_buffer) Struktur übermittelt.)</span><span class="sxs-lookup"><span data-stu-id="c1e3c-161">(Specifically, events are conveyed in the **pEvents** member of the [**MFT_OUTPUT_DATA_BUFFER**](/windows/desktop/api/mftransform/ns-mftransform-mft_output_data_buffer) structure.)</span></span>

<span data-ttu-id="c1e3c-162">Ein MFT sendet out-of-Band-Ereignisse über die [**imfmediaeventgenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) -Schnittstelle wie folgt:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-162">An MFT sends out-of-band events through the [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) interface as follows:</span></span>

1.  <span data-ttu-id="c1e3c-163">Die MFT implementiert die [**imfmediaeventgenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) -Schnittstelle, wie in [Medienereignis Generatoren](media-event-generators.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-163">The MFT implements the [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) interface, as described in [Media Event Generators](media-event-generators.md).</span></span>
2.  <span data-ttu-id="c1e3c-164">Der Client ruft **IUnknown:: QueryInterface** auf der MFT für die [**imfmediaeventgenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) -Schnittstelle auf.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-164">The client calls **IUnknown::QueryInterface** on the MFT for the [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) interface.</span></span> <span data-ttu-id="c1e3c-165">Diese Schnittstelle muss von einem asynchronen MFT verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-165">An asynchronous MFT must expose this interface.</span></span> <span data-ttu-id="c1e3c-166">Synchrone MFTs sollten diese Schnittstelle nicht verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-166">Synchronous MFTs should not expose this interface.</span></span>
3.  <span data-ttu-id="c1e3c-167">Vom Client werden [**imfmediaeventgenerator:: begingetevent**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventgenerator-begingetevent) und [**imfmediaeventgenerator:: endgetevent**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventgenerator-endgetevent) aufgerufen, um Out-of-Band-Ereignisse vom MFT zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-167">The client calls [**IMFMediaEventGenerator::BeginGetEvent**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventgenerator-begingetevent) and [**IMFMediaEventGenerator::EndGetEvent**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventgenerator-endgetevent) to receive out-of-band events from the MFT.</span></span>

## <a name="processinput"></a><span data-ttu-id="c1e3c-168">ProcessInput</span><span class="sxs-lookup"><span data-stu-id="c1e3c-168">ProcessInput</span></span>

<span data-ttu-id="c1e3c-169">Die [**IMF Transform::P rocessinput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) -Methode wird wie folgt geändert:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-169">The [**IMFTransform::ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) method is modified as follows:</span></span>

1.  <span data-ttu-id="c1e3c-170">Beim Starten des Streamings sendet der Client die [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) Nachricht.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-170">When streaming starts, the client sends the [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) message.</span></span>
2.  <span data-ttu-id="c1e3c-171">Beim Streaming fordert der MFT Daten an, indem er ein [metransformneedinput](metransformneedinput.md) -Ereignis sendet.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-171">During streaming, the MFT requests data by sending an [METransformNeedInput](metransformneedinput.md) event.</span></span> <span data-ttu-id="c1e3c-172">Die Ereignisdaten sind der Datenstrom Bezeichner.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-172">The event data is the stream identifier.</span></span>
3.  <span data-ttu-id="c1e3c-173">Für jedes [metransformneedinput](metransformneedinput.md) -Ereignis ruft der Client [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) für den angegebenen Stream auf.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-173">For each [METransformNeedInput](metransformneedinput.md) event, the client calls [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) for the specified stream.</span></span>
4.  <span data-ttu-id="c1e3c-174">Am Ende des Streamings ruft der Client möglicherweise [**ProcessMessage**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processmessage) mit der [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) Meldung auf.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-174">At the end of streaming, the client may call [**ProcessMessage**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processmessage) with the [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) message.</span></span>

<span data-ttu-id="c1e3c-175">Implementierungs Hinweise:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-175">Implementation notes:</span></span>

-   <span data-ttu-id="c1e3c-176">Die MFT darf keine [metransformneedinput](metransformneedinput.md) -Ereignisse senden, bis die [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) Nachricht empfangen wird.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-176">The MFT must not send any [METransformNeedInput](metransformneedinput.md) events until it receives the [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) message.</span></span>
-   <span data-ttu-id="c1e3c-177">Während des Streamings sendet der MFT möglicherweise jederzeit [metransformneedinput](metransformneedinput.md) -Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-177">During streaming, the MFT may send [METransformNeedInput](metransformneedinput.md) events at any time.</span></span>
-   <span data-ttu-id="c1e3c-178">Der MFT sollte die Anzahl der ausstehenden [metransformneedinput](metransformneedinput.md) -Ereignisse beibehalten.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-178">The MFT should maintain a count of pending [METransformNeedInput](metransformneedinput.md) events.</span></span> <span data-ttu-id="c1e3c-179">Alle Aufrufe von [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) , die keinem metransformneedinput-Ereignis entsprechen, müssen **MF_E_NOTACCEPTING** zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-179">Any call to [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) that does not correspond to an METransformNeedInput event must return **MF_E_NOTACCEPTING**.</span></span>
-   <span data-ttu-id="c1e3c-180">Wenn die MFT die [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) Nachricht empfängt, setzt Sie die Anzahl der ausstehenden [metransformneedinput](metransformneedinput.md) -Ereignisse auf NULL zurück.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-180">When the MFT receives the [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) message, it resets the count of pending [METransformNeedInput](metransformneedinput.md) events to zero.</span></span>
-   <span data-ttu-id="c1e3c-181">Der MFT darf keine [metransformneedinput](metransformneedinput.md) -Ereignisse senden, nachdem er die [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) Nachricht empfangen hat.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-181">The MFT must not send any [METransformNeedInput](metransformneedinput.md) events after it receives the [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) message.</span></span>
-   <span data-ttu-id="c1e3c-182">Wenn [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) vor [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) oder nach [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md)aufgerufen wird, muss die Methode **MF_E_NOTACCEPTING** zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-182">If [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) is called before [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) or after [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md), the method must return **MF_E_NOTACCEPTING**.</span></span>

## <a name="processoutput"></a><span data-ttu-id="c1e3c-183">ProcessOutput</span><span class="sxs-lookup"><span data-stu-id="c1e3c-183">ProcessOutput</span></span>

<span data-ttu-id="c1e3c-184">Die [**IMF Transform::P rocess Output**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) -Methode wird wie folgt geändert:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-184">The [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) method is modified as follows:</span></span>

1.  <span data-ttu-id="c1e3c-185">Wenn die MFT eine Ausgabe hat, sendet Sie ein [metransformhaveoutput](metransformhaveoutput.md) -Ereignis.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-185">Whenever the MFT has output, it sends an [METransformHaveOutput](metransformhaveoutput.md) event.</span></span>
2.  <span data-ttu-id="c1e3c-186">Für jedes [metransformhaveoutput](metransformhaveoutput.md) -Ereignis ruft der Client [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput)auf.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-186">For each [METransformHaveOutput](metransformhaveoutput.md) event, the client calls [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span>

<span data-ttu-id="c1e3c-187">Implementierungs Hinweise:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-187">Implementation notes:</span></span>

-   <span data-ttu-id="c1e3c-188">Wenn der Client [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) zu einem beliebigen Zeitpunkt aufruft, gibt die Methode **E_UNEXPECTED** zurück.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-188">If the client calls [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) at any other time, the method returns **E_UNEXPECTED**.</span></span>
-   <span data-ttu-id="c1e3c-189">Ein asynchroner MFT sollte niemals **MF_E_TRANSFORM_NEED_MORE_INPUT** von der [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) -Methode zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-189">An asynchronous MFT should never return **MF_E_TRANSFORM_NEED_MORE_INPUT** from the [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) method.</span></span> <span data-ttu-id="c1e3c-190">Wenn die MFT mehr Eingaben erfordert, sendet Sie ein [metransformneedinput](metransformneedinput.md) -Ereignis.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-190">If the MFT requires more input, it sends an [METransformNeedInput](metransformneedinput.md) event.</span></span>

## <a name="draining"></a><span data-ttu-id="c1e3c-191">Ernde</span><span class="sxs-lookup"><span data-stu-id="c1e3c-191">Draining</span></span>

<span data-ttu-id="c1e3c-192">Das Entleeren eines MFT bewirkt, dass der MFT so viele Ausgaben erzeugt, wie er von den bereits gesendeten Eingabedaten möglich ist.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-192">Draining an MFT causes the MFT to produce as much output as it can from whatever input data has already been sent.</span></span> <span data-ttu-id="c1e3c-193">Das Ableiten einer asynchronen MFT funktioniert wie folgt:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-193">Draining an asynchronous MFT works as follows:</span></span>

1.  <span data-ttu-id="c1e3c-194">Der Client sendet die [**MFT_MESSAGE_COMMAND_DRAIN**](mft-message-command-drain.md) Nachricht.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-194">The client sends the [**MFT_MESSAGE_COMMAND_DRAIN**](mft-message-command-drain.md) message.</span></span>
2.  <span data-ttu-id="c1e3c-195">Der MFT sendet weiterhin [metransformhaveoutput](metransformhaveoutput.md) -Ereignisse, bis keine weiteren Daten mehr verarbeitet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-195">The MFT continues to send [METransformHaveOutput](metransformhaveoutput.md) events until it has no more data to process.</span></span> <span data-ttu-id="c1e3c-196">Während dieser Zeit werden keine [metransformneedinput](metransformneedinput.md) -Ereignisse gesendet.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-196">It does not send [METransformNeedInput](metransformneedinput.md) events during this time.</span></span>
3.  <span data-ttu-id="c1e3c-197">Nachdem das MFT das letzte [metransformhaveoutput](metransformhaveoutput.md) -Ereignis gesendet hat, sendet es ein [metransformdraunvollständiges](metransformdraincomplete.md) Ereignis.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-197">After the MFT sends the last [METransformHaveOutput](metransformhaveoutput.md) event, it sends an [METransformDrainComplete](metransformdraincomplete.md) event.</span></span>

<span data-ttu-id="c1e3c-198">Nachdem die ENTF-Datei vollständig ist, sendet der MFT kein anderes [metransformneedinput](metransformneedinput.md) -Ereignis, bis eine [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) Meldung vom Client empfangen wird.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-198">After draining is complete, the MFT does not send another [METransformNeedInput](metransformneedinput.md) event until it receives an [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) message from the client.</span></span>

## <a name="flushing"></a><span data-ttu-id="c1e3c-199">Lak</span><span class="sxs-lookup"><span data-stu-id="c1e3c-199">Flushing</span></span>

<span data-ttu-id="c1e3c-200">Der Client kann die MFT leeren, indem er die [**MFT_MESSAGE_COMMAND_FLUSH**](mft-message-command-flush.md) Nachricht sendet.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-200">The client can flush the MFT by sending the [**MFT_MESSAGE_COMMAND_FLUSH**](mft-message-command-flush.md) message.</span></span> <span data-ttu-id="c1e3c-201">Die MFT löscht alle Eingabe-und Ausgabe Beispiele, die Sie enthält.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-201">The MFT drops all of the input and output samples it is holding.</span></span>

<span data-ttu-id="c1e3c-202">Der MFT sendet kein anderes [metransformneedinput](metransformneedinput.md) -Ereignis, bis eine [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) Meldung vom Client empfangen wird.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-202">The MFT does not send another [METransformNeedInput](metransformneedinput.md) event until it receives an [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) message from the client.</span></span>

## <a name="markers"></a><span data-ttu-id="c1e3c-203">Marker</span><span class="sxs-lookup"><span data-stu-id="c1e3c-203">Markers</span></span>

<span data-ttu-id="c1e3c-204">Der Client kann einen Punkt im Stream markieren, indem er die [**MFT_MESSAGE_COMMAND_MARKER**](mft-message-command-marker.md) Nachricht sendet.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-204">The client can mark a point in the stream by sending the [**MFT_MESSAGE_COMMAND_MARKER**](mft-message-command-marker.md) message.</span></span> <span data-ttu-id="c1e3c-205">Die MFT antwortet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-205">The MFT responds as follows:</span></span>

1.  <span data-ttu-id="c1e3c-206">Der MFT generiert so viele Ausgabe Beispiele wie aus den vorhandenen Eingabedaten und sendet ein [metransformhaveoutput](metransformhaveoutput.md) -Ereignis für jedes Ausgabe Beispiel.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-206">The MFT generates as many output samples as it can from the existing input data, sending an [METransformHaveOutput](metransformhaveoutput.md) event for each output sample.</span></span>
2.  <span data-ttu-id="c1e3c-207">Nachdem die gesamte Ausgabe generiert wurde, sendet der MFT ein [metransformmarker](metransformmarker.md) -Ereignis.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-207">After all of the output is generated, the MFT sends an [METransformMarker](metransformmarker.md) event.</span></span> <span data-ttu-id="c1e3c-208">Dieses Ereignis muss nach allen [metransformhaveoutput](metransformhaveoutput.md) -Ereignissen gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-208">This event must be sent after all of the [METransformHaveOutput](metransformhaveoutput.md) events.</span></span>

<span data-ttu-id="c1e3c-209">Nehmen wir beispielsweise an, dass ein Decoder über genügend Eingabedaten verfügt, um vier Ausgabe Beispiele zu liefern.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-209">For example, suppose that a decoder has enough input data to produce four output samples.</span></span> <span data-ttu-id="c1e3c-210">Wenn der Client die [**MFT_MESSAGE_COMMAND_MARKER**](mft-message-command-marker.md) Nachricht sendet, werden von der MFT vier [metransformhaveoutput](metransformhaveoutput.md) -Ereignisse (eine pro Ausgabe Stichprobe), gefolgt von einem [metransformmarker](metransformmarker.md) -Ereignis in die Warteschlange eingereiht.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-210">If the client sends the [**MFT_MESSAGE_COMMAND_MARKER**](mft-message-command-marker.md) message, the MFT will queue four [METransformHaveOutput](metransformhaveoutput.md) events (one per output sample), followed by an [METransformMarker](metransformmarker.md) event.</span></span>

<span data-ttu-id="c1e3c-211">Die markernachricht ähnelt der Ablass Nachricht.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-211">The marker message is similar to the drain message.</span></span> <span data-ttu-id="c1e3c-212">Eine Ableitung wird jedoch als Unterbrechung im Stream betrachtet, während ein Marker nicht ist.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-212">However, a drain is considered a break in the stream, whereas a marker is not.</span></span> <span data-ttu-id="c1e3c-213">Das Ableiten von und Markierungen hat die folgenden Unterschiede.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-213">Draining and markers have the following differences.</span></span>

<span data-ttu-id="c1e3c-214">Ernde</span><span class="sxs-lookup"><span data-stu-id="c1e3c-214">Draining:</span></span>

-   <span data-ttu-id="c1e3c-215">Während der Ableitung sendet der MFT keine [metransformneedinput](metransformneedinput.md) -Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-215">While draining, the MFT does not send [METransformNeedInput](metransformneedinput.md) events.</span></span>
-   <span data-ttu-id="c1e3c-216">Der MFT verwirft alle Eingabedaten, die nicht zum Erstellen eines Ausgabe Beispiels verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-216">The MFT discards any input data that cannot be used to create an output sample.</span></span>
-   <span data-ttu-id="c1e3c-217">Einige MFTs verursachen am Ende der Daten ein "Fragment".</span><span class="sxs-lookup"><span data-stu-id="c1e3c-217">Some MFTs produce a "tail" at the end of the data.</span></span> <span data-ttu-id="c1e3c-218">Beispielsweise erzeugen Audioeffekte wie z. b. "Reverb" oder "Echo" zusätzliche Daten, nachdem die Eingabedaten beendet wurden.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-218">For example, audio effects such as reverb or echo produce extra data after the input data has stopped.</span></span> <span data-ttu-id="c1e3c-219">Ein MFT, das ein Ende generiert, sollte dies am Ende eines Ausgleichs Vorgangs bewirken.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-219">An MFT that generates a tail should do so at the end of a drain operation.</span></span>
-   <span data-ttu-id="c1e3c-220">Nachdem der MFT-Vorgang abgeschlossen wurde, wird das nächste Ausgabe Beispiel mit dem [**MFSampleExtension_Discontinuity**](mfsampleextension-discontinuity-attribute.md) -Attribut markiert, um eine Diskontinuität im Datenstrom anzugeben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-220">After the MFT has finished draining, it marks the next output sample with the [**MFSampleExtension_Discontinuity**](mfsampleextension-discontinuity-attribute.md) attribute, to indicate a discontinuity in the stream.</span></span>

<span data-ttu-id="c1e3c-221">Setzen</span><span class="sxs-lookup"><span data-stu-id="c1e3c-221">Marker:</span></span>

-   <span data-ttu-id="c1e3c-222">Der MFT sendet weiterhin [metransformneedinput](metransformneedinput.md) -Ereignisse vor dem Senden des markerereignisses.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-222">The MFT continues to send [METransformNeedInput](metransformneedinput.md) events before sending the marker event.</span></span>
-   <span data-ttu-id="c1e3c-223">Der MFT löscht keine Eingabedaten.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-223">The MFT does not discard any input data.</span></span> <span data-ttu-id="c1e3c-224">Wenn partielle Daten vorhanden sind, sollten Sie nach dem Markerpunkt verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-224">If there is partial data, it should be processed after the marker point.</span></span>
-   <span data-ttu-id="c1e3c-225">Der MFT erzeugt am Markerpunkt kein Ende.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-225">The MFT does not produce a tail at the marker point.</span></span>
-   <span data-ttu-id="c1e3c-226">Das Flag für die Diskontinuität nach dem Markerpunkt wird vom MFT nicht festgelegt.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-226">The MFT does not set the discontinuity flag after the marker point.</span></span>

## <a name="format-changes"></a><span data-ttu-id="c1e3c-227">Formatieren von Änderungen</span><span class="sxs-lookup"><span data-stu-id="c1e3c-227">Format Changes</span></span>

<span data-ttu-id="c1e3c-228">Ein asynchroner MFT muss dynamische Formatänderungen unterstützen, wie unter [Verarbeiten von streamänderungen](handling-stream-changes.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-228">An asynchronous MFT must support dynamic format changes, as described in [Handling Stream Changes](handling-stream-changes.md).</span></span>

## <a name="attributes"></a><span data-ttu-id="c1e3c-229">Attribute</span><span class="sxs-lookup"><span data-stu-id="c1e3c-229">Attributes</span></span>

<span data-ttu-id="c1e3c-230">Ein asynchroner MFT muss die [**imftransform:: GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) -Methode implementieren, um einen gültigen Attribut Speicher zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-230">An asynchronous MFT must implement the [**IMFTransform::GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) method to return a valid attribute store.</span></span> <span data-ttu-id="c1e3c-231">Die folgenden Attribute gelten für asynchrone MFTs:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-231">The following attributes apply to asynchronous MFTs:</span></span>



| <span data-ttu-id="c1e3c-232">Attribut</span><span class="sxs-lookup"><span data-stu-id="c1e3c-232">Attribute</span></span>                                                                                    | <span data-ttu-id="c1e3c-233">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="c1e3c-233">Description</span></span>                                                                                                                       |
|----------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c1e3c-234">MF_TRANSFORM_ASYNC</span><span class="sxs-lookup"><span data-stu-id="c1e3c-234">MF_TRANSFORM_ASYNC</span></span>](mf-transform-async.md)                                               | <span data-ttu-id="c1e3c-235">Das MFT muss dieses Attribut auf " **true** " festlegen (1).</span><span class="sxs-lookup"><span data-stu-id="c1e3c-235">The MFT must set this attribute to **TRUE** (1).</span></span> <span data-ttu-id="c1e3c-236">Der Client kann dieses Attribut Abfragen, um zu ermitteln, ob der MFT asynchron ist.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-236">The client can query this attribute to discover whether the MFT is asynchronous.</span></span> |
| [<span data-ttu-id="c1e3c-237">MF_TRANSFORM_ASYNC_UNLOCK</span><span class="sxs-lookup"><span data-stu-id="c1e3c-237">MF_TRANSFORM_ASYNC_UNLOCK</span></span>](mf-transform-async-unlock.md)                                |                                                                                                                                   |
| [<span data-ttu-id="c1e3c-238">**MFT_SUPPORT_DYNAMIC_FORMAT_CHANGE**</span><span class="sxs-lookup"><span data-stu-id="c1e3c-238">**MFT_SUPPORT_DYNAMIC_FORMAT_CHANGE**</span></span>](mft-support-dynamic-format-change-attribute.md) | <span data-ttu-id="c1e3c-239">Das MFT muss dieses Attribut auf " **true** " festlegen (1).</span><span class="sxs-lookup"><span data-stu-id="c1e3c-239">The MFT must set this attribute to **TRUE** (1).</span></span> <span data-ttu-id="c1e3c-240">Der Client kann davon ausgehen, dass dieses Attribut festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-240">The client can assume that this attribute is set.</span></span>                                |



 

## <a name="unlocking-asynchronous-mfts"></a><span data-ttu-id="c1e3c-241">Entsperren von asynchronen MFTs</span><span class="sxs-lookup"><span data-stu-id="c1e3c-241">Unlocking Asynchronous MFTs</span></span>

<span data-ttu-id="c1e3c-242">Asynchrone MFTs sind nicht kompatibel mit dem ursprünglichen MFT-Datenverarbeitungs Modell.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-242">Asynchronous MFTs are not compatible with the original MFT data processing model.</span></span> <span data-ttu-id="c1e3c-243">Um zu verhindern, dass asynchrone MFTs vorhandene Anwendungen unterbrechen, wird der folgende Mechanismus definiert:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-243">To prevent asynchronous MFTs from breaking existing applications, the following mechanism is defined:</span></span>

<dl> <span data-ttu-id="c1e3c-244">Der Client ruft <a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes">imftransform:: GetAttributes</a> auf der MFT auf.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-244">The client calls <a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes">IMFTransform::GetAttributes</a> on the MFT.</span></span>  
<span data-ttu-id="c1e3c-245">Der Client fragt den für dieses <a href="mf-transform-async.md">MF_TRANSFORM_ASYNC</a> Attribut ab.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-245">The client queries the for this <a href="mf-transform-async.md">MF_TRANSFORM_ASYNC</a> attribute.</span></span> <span data-ttu-id="c1e3c-246">Für eine asynchrone MFT ist der Wert dieses Attributs " **true**".</span><span class="sxs-lookup"><span data-stu-id="c1e3c-246">For an asynchronous MFT, the value of this attribute is **TRUE**.</span></span>  
<span data-ttu-id="c1e3c-247">Zum Entsperren des MFT muss der Client das <a href="mf-transform-async-unlock.md">MF_TRANSFORM_ASYNC_UNLOCK</a> -Attribut auf " **true**" festlegen.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-247">To unlock the MFT, the client must sets the <a href="mf-transform-async-unlock.md">MF_TRANSFORM_ASYNC_UNLOCK</a> attribute to **TRUE**.</span></span>  
</dl>

<span data-ttu-id="c1e3c-248">Bis der Client die Sperrung des MFT entsperrt, sollten alle [**imftransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) -Methoden **MF_E_TRANSFORM_ASYNC_LOCKED** zurückgeben, mit den folgenden Ausnahmen:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-248">Until the client unlocks the MFT, all [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) methods should return **MF_E_TRANSFORM_ASYNC_LOCKED**, with the following exceptions:</span></span>

-   <span data-ttu-id="c1e3c-249">[**IMF Transform:: GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) (alle asynchronen MFTs)</span><span class="sxs-lookup"><span data-stu-id="c1e3c-249">[**IMFTransform::GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) (all asynchronous MFTs)</span></span>
-   <span data-ttu-id="c1e3c-250">[**Imftransform:: getinputavailabletype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) (alle asynchronen MFTs)</span><span class="sxs-lookup"><span data-stu-id="c1e3c-250">[**IMFTransform::GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) (all asynchronous MFTs)</span></span>
-   <span data-ttu-id="c1e3c-251">[**IMF Transform:: getoutputcurrenttype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputcurrenttype) (nur Encoder)</span><span class="sxs-lookup"><span data-stu-id="c1e3c-251">[**IMFTransform::GetOutputCurrentType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputcurrenttype) (encoders only)</span></span>
-   <span data-ttu-id="c1e3c-252">[**IMF Transform:: setoutputtype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype) (nur Encoder)</span><span class="sxs-lookup"><span data-stu-id="c1e3c-252">[**IMFTransform::SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype) (encoders only)</span></span>
-   <span data-ttu-id="c1e3c-253">[**IMF Transform:: getstreamcount**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamcount) (alle asynchronen MFTs)</span><span class="sxs-lookup"><span data-stu-id="c1e3c-253">[**IMFTransform::GetStreamCount**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamcount) (all asynchronous MFTs)</span></span>
-   <span data-ttu-id="c1e3c-254">[**IMF Transform:: getstreamids**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamids) (alle asynchronen MFTs)</span><span class="sxs-lookup"><span data-stu-id="c1e3c-254">[**IMFTransform::GetStreamIDs**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamids) (all asynchronous MFTs)</span></span>

<span data-ttu-id="c1e3c-255">Der folgende Code zeigt, wie Sie eine asynchrone MFT entsperren:</span><span class="sxs-lookup"><span data-stu-id="c1e3c-255">The following code shows how to unlock an asynchronous MFT:</span></span>


```C++
HRESULT UnlockAsyncMFT(IMFTransform *pMFT)
{
    IMFAttributes *pAttributes = NULL;

    HRESULT hr = hr = pMFT->GetAttributes(&pAttributes);

    if (SUCCEEDED(hr))
    {
        hr = pAttributes->SetUINT32(MF_TRANSFORM_ASYNC_UNLOCK, TRUE);
        pAttributes->Release();
    }
    
    return hr;
}
```



## <a name="shutting-down-the-mft"></a><span data-ttu-id="c1e3c-256">Der MFT wird heruntergefahren.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-256">Shutting Down the MFT</span></span>

<span data-ttu-id="c1e3c-257">Asynchrone MFTs müssen die [**IMF Shutdown**](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown) -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-257">Asynchronous MFTs must implement the [**IMFShutdown**](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown) interface.</span></span>

-   <span data-ttu-id="c1e3c-258">[**Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown): die Ereignis Warteschlange muss vom MFT heruntergefahren werden.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-258">[**Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown): The MFT must shut down its event queue.</span></span> <span data-ttu-id="c1e3c-259">Wenn Sie die Standard Ereignis Warteschlange verwenden, nennen Sie [**imfmediaeventqueue:: Shutdown**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventqueue-shutdown).</span><span class="sxs-lookup"><span data-stu-id="c1e3c-259">If using the standard event queue, call [**IMFMediaEventQueue::Shutdown**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventqueue-shutdown).</span></span> <span data-ttu-id="c1e3c-260">Optional kann der MFT andere Ressourcen freigeben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-260">Optionally, the MFT may release other resources.</span></span> <span data-ttu-id="c1e3c-261">Der Client darf den MFT nach dem Aufrufen des **herunter** Fahrens nicht verwenden.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-261">The client must not use the MFT after calling **Shutdown**.</span></span>
-   <span data-ttu-id="c1e3c-262">[**Getshutdownstatus**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-getshutdownstatus): Nachdem das [**herunter**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown) fahren aufgerufen wurde, sollte der MFT den Wert **MFSHUTDOWN_COMPLETED** im *pstatus* -Parameter zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-262">[**GetShutdownStatus**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-getshutdownstatus): After [**Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown) has been called, the MFT should return the value **MFSHUTDOWN_COMPLETED** in the *pStatus* parameter.</span></span> <span data-ttu-id="c1e3c-263">Der Wert **MFSHUTDOWN_INITIATED** sollte nicht zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-263">It should not return the value **MFSHUTDOWN_INITIATED**.</span></span>

## <a name="registration-and-enumeration"></a><span data-ttu-id="c1e3c-264">Registrierung und Enumeration</span><span class="sxs-lookup"><span data-stu-id="c1e3c-264">Registration and Enumeration</span></span>

<span data-ttu-id="c1e3c-265">Um eine asynchrone MFT zu registrieren, müssen Sie die Funktion [**mftregister**](/windows/desktop/api/mfapi/nf-mfapi-mftregister) aufrufen und das **MFT_ENUM_FLAG_ASYNCMFT** -Flag im *Flags* -Parameter festlegen.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-265">To register an asynchronous MFT, call the [**MFTRegister**](/windows/desktop/api/mfapi/nf-mfapi-mftregister) function and set the **MFT_ENUM_FLAG_ASYNCMFT** flag in the *Flags* parameter.</span></span> <span data-ttu-id="c1e3c-266">(Zuvor war dieses Flag reserviert.)</span><span class="sxs-lookup"><span data-stu-id="c1e3c-266">(Previously this flag was reserved.)</span></span>

<span data-ttu-id="c1e3c-267">Um asynchrone MFTs aufzulisten, müssen Sie die Funktion [**mftenumex**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) aufrufen und das **MFT_ENUM_FLAG_ASYNCMFT** -Flag im *Flags* -Parameter festlegen.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-267">To enumerate asynchronous MFTs, call the [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) function and set the **MFT_ENUM_FLAG_ASYNCMFT** flag in the *Flags* parameter.</span></span> <span data-ttu-id="c1e3c-268">Aus Gründen der Abwärtskompatibilität listet die [**MF**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) -Funktion keine asynchronen MFTs auf.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-268">For backward compatibility, the [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) function does not enumerate asynchronous MFTs.</span></span> <span data-ttu-id="c1e3c-269">Andernfalls könnte das Installieren einer asynchronen MFT auf dem Computer des Benutzers vorhandene Anwendungen unterbrechen.</span><span class="sxs-lookup"><span data-stu-id="c1e3c-269">Otherwise, installing an asynchronous MFT on the user's computer could break existing applications.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c1e3c-270">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="c1e3c-270">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c1e3c-271">Media Foundation Transformationen</span><span class="sxs-lookup"><span data-stu-id="c1e3c-271">Media Foundation Transforms</span></span>](media-foundation-transforms.md)
</dt> </dl>

 

 



