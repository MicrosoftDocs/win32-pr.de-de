---
description: In diesem Thema wird beschrieben, wie Media Foundation Transformationen Zeitstempel verarbeiten sollten.
ms.assetid: 4ab576ce-becd-4736-921e-e463c0dff841
title: Zeitstempel und Dauer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2323c11fa0e3ec2b2b2d5ba1cefe4f5d5fa80c5b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104130465"
---
# <a name="time-stamps-and-durations"></a><span data-ttu-id="30fa5-103">Zeitstempel und Dauer</span><span class="sxs-lookup"><span data-stu-id="30fa5-103">Time Stamps and Durations</span></span>

<span data-ttu-id="30fa5-104">In diesem Thema wird beschrieben, wie [Media Foundation Transformationen](media-foundation-transforms.md) Zeitstempel verarbeiten sollten.</span><span class="sxs-lookup"><span data-stu-id="30fa5-104">This topic describes how [Media Foundation Transforms](media-foundation-transforms.md) should handle time stamps.</span></span>

<span data-ttu-id="30fa5-105">Ein MFT muss in allen Ausgabe Beispielen als genau einen Zeitstempel und eine Dauer festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-105">An MFT must set as accurate a time stamp and duration as possible on all output samples.</span></span> <span data-ttu-id="30fa5-106">Bei einem einfachen MFT, das einen Eingabepuffer annimmt und ihn vollständig in einem Ausgabepuffer verarbeitet, sollte der MFT den Zeitstempel und die Dauer direkt aus dem Eingabe Beispiel in das Ausgabe Beispiel kopieren.</span><span class="sxs-lookup"><span data-stu-id="30fa5-106">For a simple MFT that takes one input buffer and completely processes it into an output buffer, the MFT should just copy the time stamp and duration directly from the input sample to the output sample.</span></span> <span data-ttu-id="30fa5-107">Viele Transformationen sind jedoch komplexer als dies und erfordern möglicherweise komplexere Berechnungen der Ausgabezeit.</span><span class="sxs-lookup"><span data-stu-id="30fa5-107">However, many transforms are more complex than this and may require more complex calculations of output time.</span></span> <span data-ttu-id="30fa5-108">Alle MFTs sollten die folgenden grundlegenden Regeln beachten:</span><span class="sxs-lookup"><span data-stu-id="30fa5-108">All MFTs should observe the following basic rules:</span></span>

-   <span data-ttu-id="30fa5-109">Ein MFT sollte versuchen, einen Zeitstempel und eine Dauer für alle nicht komprimierten Video-oder audioausgabebeispiele abzulegen, wenn ein präziser Zeitstempel oder eine Dauer für die Eingabe Stichproben angegeben ist oder berechnet werden kann.</span><span class="sxs-lookup"><span data-stu-id="30fa5-109">An MFT should try to put a time stamp and duration on all uncompressed video or audio output samples if an accurate time stamp or duration is given on the input samples or can be calculated.</span></span> <span data-ttu-id="30fa5-110">Für einige Ausgabezeit Stempel ist möglicherweise eine Interpolations Zeit erforderlich, insbesondere für Decoder.</span><span class="sxs-lookup"><span data-stu-id="30fa5-110">Interpolation may be required for some output time stamps, especially for decoders.</span></span>
-   <span data-ttu-id="30fa5-111">Die Zeitstempel und die Dauer der Eingabe Stichproben sollten in den Ausgabe Beispielen so weit wie möglich beibehalten werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-111">The time stamps and durations of the input samples should be preserved on the output samples as much as possible.</span></span>
-   <span data-ttu-id="30fa5-112">Die Ausgabezeit Stempel oder-Zeiträume stimmen möglicherweise nicht mit der Eingabe ab, da die MFT Daten zurückgibt oder die Ausgabe in andere Teile als die Eingabe abbricht.</span><span class="sxs-lookup"><span data-stu-id="30fa5-112">The output time stamps or durations might not match the input because the MFT is holding back data or breaking the output into different-sized pieces than the input.</span></span> <span data-ttu-id="30fa5-113">In diesem Fall sollte der MFT den Ausgabezeit Stempel aus dem frühesten Eingabe Beispiel berechnen, der Daten enthält, die zum Erstellen des Ausgabe Beispiels verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-113">In that case, the MFT should calculate the output time stamp from the earliest input sample that contains data used to create the output sample.</span></span> <span data-ttu-id="30fa5-114">Fügen Sie zum Berechnen des Ausgabezeit Stempels der Dauer der Daten, die bereits aus diesem Beispiel transformiert wurden, den Eingabe Zeitstempel des entsprechenden Eingabe Beispiels hinzu.</span><span class="sxs-lookup"><span data-stu-id="30fa5-114">To calculate the output time stamp, add the input time stamp of the appropriate input sample to the duration of data that has already been transformed from that sample.</span></span> <span data-ttu-id="30fa5-115">Im zweiten Beispiel am Ende dieses Abschnitts wird diese Idee veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="30fa5-115">The second example at the end of this section illustrates this idea.</span></span>
-   <span data-ttu-id="30fa5-116">Wenn die Eingabe Beispiele eine Dauer aufweisen, sollte diese Dauer beibehalten werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-116">If the input samples have duration, that duration should be preserved.</span></span> <span data-ttu-id="30fa5-117">Wenn eine Eingabe Stichprobe keine Dauer hat, sollte der MFT nach Möglichkeit eine Dauer berechnen, die aus der Größe des Ausgabepuffers oder der durch den Medientyp gegebenen Daten Rate besteht.</span><span class="sxs-lookup"><span data-stu-id="30fa5-117">If an input sample does not have duration, the MFT should calculate a duration if possible from the size of the output buffer or the data rate given by the media type.</span></span>
-   <span data-ttu-id="30fa5-118">Berechnete Zeiträume sollten abgeschnitten (abgerundet), nicht auf das nächste Inkrement gerundet werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-118">Calculated durations should be truncated (rounded down), not rounded to the nearest increment.</span></span> <span data-ttu-id="30fa5-119">Die Pipeline verfügt über genügend Slack, um Zeiträume zu verarbeiten, die etwas ungenau sind, aber es ist einfacher für die Pipeline, eine Dauer zu verarbeiten, die 1% zu kurz ist als eine Dauer von 1% zu lang.</span><span class="sxs-lookup"><span data-stu-id="30fa5-119">The pipeline has enough slack to handle durations that are slightly inaccurate, but it is easier for the pipeline to handle a duration that is 1% too short than a duration that is 1% too long.</span></span> <span data-ttu-id="30fa5-120">Das heißt, es gibt keinen Grund, die Dauer absichtlich zu verkürzen, außer durch Rundung.</span><span class="sxs-lookup"><span data-stu-id="30fa5-120">That said, there is no reason to deliberately shorten the durations, other than by rounding.</span></span>

### <a name="decoders"></a><span data-ttu-id="30fa5-121">Decoder</span><span class="sxs-lookup"><span data-stu-id="30fa5-121">Decoders</span></span>

<span data-ttu-id="30fa5-122">Ein Decoder konvertiert komprimierte Pakete in unkomprimierte Daten.</span><span class="sxs-lookup"><span data-stu-id="30fa5-122">A decoder converts compressed packets into uncompressed data.</span></span> <span data-ttu-id="30fa5-123">Da die Ausgabe nicht komprimiert ist, haben Decoder eine besondere Verpflichtung, die Zeitstempel und die Dauer zu korrigieren.</span><span class="sxs-lookup"><span data-stu-id="30fa5-123">Because the output is uncompressed, decoders have a special obligation to get the time stamps and durations correct.</span></span> <span data-ttu-id="30fa5-124">Einige komprimierte Formate, insbesondere MPEG-2, haben keine Zeitstempel für alle Eingabe Pakete und haben häufig keine Dauer für ein Paket.</span><span class="sxs-lookup"><span data-stu-id="30fa5-124">Some compressed formats, most notably MPEG-2, do not have time stamps on all input packets and often have no duration on any packet.</span></span> <span data-ttu-id="30fa5-125">Bei diesen Formaten ist der Decoder dafür verantwortlich, einen gültigen Zeitstempel und eine Dauer für jedes Ausgabe Beispiel zu setzen, indem er die impliziten Dauer der gesamten Ausgabe seit dem letzten Zeitstempel-Eingabe Beispiel summiert.</span><span class="sxs-lookup"><span data-stu-id="30fa5-125">For these formats, the decoder is responsible for putting a valid time stamp and duration on every output sample, by summing the implied durations of all the output since the last time-stamped input sample.</span></span>

<span data-ttu-id="30fa5-126">Wenn die Dauer für Videos nicht im komprimierten Format verfügbar ist, sollte der Decoder die Dauer als Umkehrung der Framerate berechnen, in 100-Nanosecond-Einheiten konvertiert und abgerundet werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-126">For video, if the duration is not available in the compressed format, the decoder should calculate the duration as the inverse of the frame rate, converted to 100-nanosecond units and rounded down.</span></span>

<span data-ttu-id="30fa5-127">Wenn die Dauer für Audiodaten nicht im komprimierten Format verfügbar ist, sollte der Decoder die Dauer als Umkehrung der audiobeispielrate multipliziert mit der Anzahl der Stichproben im Ausgabepuffer, in 100-Nanosecond-Einheiten konvertiert und abgerundet werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-127">For audio, if the duration is not available in the compressed format, the decoder should calculate the duration as the inverse of the audio sample rate multiplied by the number of samples in the output buffer, converted to 100-nanosecond units and rounded down.</span></span>

<span data-ttu-id="30fa5-128">Eine Transformation sollte nur dann eine Stichprobe ohne einen Zeitstempel ausgeben, wenn die MFT nie einen Zeitstempel für ein Eingabe Beispiel erhalten hat, oder wenn es keine Möglichkeit gibt, einen exakten Ausgabezeit Stempel aus dem vorherigen Eingabe Zeitstempel zu berechnen.</span><span class="sxs-lookup"><span data-stu-id="30fa5-128">The only time a transform should output a sample without a time stamp is if the MFT has never received a time stamp on an input sample, or if there is no way to calculate an accurate output time stamp from the previous input time stamp.</span></span>

### <a name="audio-decoders"></a><span data-ttu-id="30fa5-129">Audiodecoder</span><span class="sxs-lookup"><span data-stu-id="30fa5-129">Audio Decoders</span></span>

<span data-ttu-id="30fa5-130">Für Audiodecoder wird die Dauer der einzelnen Ausgabe Stichprobe aus der audiosamplingrate und der Anzahl der PCM-Stichproben pro Kanal im Ausgabepuffer berechnet.</span><span class="sxs-lookup"><span data-stu-id="30fa5-130">For audio decoders, the duration of each output sample is calculated from the audio sampling rate and the number of PCM samples per channel in the output buffer.</span></span>

<span data-ttu-id="30fa5-131">Die korrekte Methode zum Berechnen der Ausgabezeit Stempel hängt davon ab, ob die Eingabe Beispiele Zeitstempel enthalten.</span><span class="sxs-lookup"><span data-stu-id="30fa5-131">The correct way to calculate output time stamps depends on whether the input samples contain time stamps.</span></span>

<span data-ttu-id="30fa5-132">Wenn die Eingabe Beispiele Zeitstempel enthalten, berechnet der Decoder die Ausgabezeit Stempel aus den Eingabe Zeitstempeln wie folgt:</span><span class="sxs-lookup"><span data-stu-id="30fa5-132">If the input samples contain time stamps, the decoder calculates the output time stamps from the input time stamps, as follows:</span></span>

-   <span data-ttu-id="30fa5-133">Wenn jeder Eingabepuffer eine oder mehrere vollständige komprimierte Frames ohne partielle Frames enthält, entspricht der Ausgabezeit Stempel dem Eingabe Zeitstempel abzüglich der bekannten Latenz des Decoders.</span><span class="sxs-lookup"><span data-stu-id="30fa5-133">If each input buffer contains a one or more complete compressed frames, with no partial frames, the output time stamp equals the input time stamp, minus the known latency of the decoder.</span></span> <span data-ttu-id="30fa5-134">Ein Dolby Digital (AC-3)-Decoder hat z. b. eine Latenz von 256 PCM-Stichproben.</span><span class="sxs-lookup"><span data-stu-id="30fa5-134">For example, a Dolby Digital (AC-3) decoder has a latency of 256 PCM samples.</span></span> <span data-ttu-id="30fa5-135">Bei der Samplingrate von 48-kHz beträgt die Latenz z. b. 5,33 Millisekunden (MS).</span><span class="sxs-lookup"><span data-stu-id="30fa5-135">For example, at 48-kHz sampling rate, the latency is 5.33 milliseconds (msec).</span></span> <span data-ttu-id="30fa5-136">Wenn der Eingabe Zeitstempel also 1000 ms beträgt, lautet der Ausgabezeit Stempel 1000 – 5,33 = 994,66 ms.</span><span class="sxs-lookup"><span data-stu-id="30fa5-136">Therefore, if the input time stamp is 1000 msec, the output time stamp is 1000 – 5.33 = 994.66 msec.</span></span> <span data-ttu-id="30fa5-137">Wenn der Eingabepuffer mehr als einen vollständigen komprimierten Frame enthält, erzeugt der Decoder ein Ausgabe Beispiel für jeden Frame im Eingabe Beispiel.</span><span class="sxs-lookup"><span data-stu-id="30fa5-137">If the input buffer includes more than one whole compressed frame, the decoder will produce one output sample for every frame in the input sample.</span></span> <span data-ttu-id="30fa5-138">Alle Ausgabe Beispiele werden ordnungsgemäß mit einem Zeitstempel versehen, sodass keine Lücken vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="30fa5-138">All output samples will be time stamped correctly such that there are no gaps.</span></span>
-   <span data-ttu-id="30fa5-139">Abhängig vom Transport Format kann ein Eingabepuffer partielle Frames enthalten.</span><span class="sxs-lookup"><span data-stu-id="30fa5-139">Depending on the transport format, an input buffer might contain partial frames.</span></span> <span data-ttu-id="30fa5-140">Ein Puffer kann z. b. einen Teil eines Frames aus dem vorherigen Eingabepuffer enthalten, gefolgt von einem oder mehreren abgeschlossenen Frames, gefolgt vom Anfang des nächsten Frames.</span><span class="sxs-lookup"><span data-stu-id="30fa5-140">For example, a buffer might contain part of a frame from the previous input buffer, followed by one or more complete frames, followed by the start of the next frame.</span></span> <span data-ttu-id="30fa5-141">In diesem Fall ist es im allgemeinen richtig, anzunehmen, dass der Eingabe Zeitstempel dem ersten Frame entspricht, der innerhalb des Puffers beginnt.</span><span class="sxs-lookup"><span data-stu-id="30fa5-141">In this case, it is generally correct to assume that the input time stamp corresponds to the first frame that starts within the buffer.</span></span> <span data-ttu-id="30fa5-142">(Das heißt, ein partieller Frame, der im vorherigen Puffer gestartet wurde, ist nicht im Zeitstempel des aktuellen Puffers enthalten.) Berechnen Sie den Ausgabezeit Stempel entsprechend.</span><span class="sxs-lookup"><span data-stu-id="30fa5-142">(That is, a partial frame that started in the previous buffer is not included in the time stamp for the current buffer.) Calculate the output time stamp accordingly.</span></span>

<span data-ttu-id="30fa5-143">Wenn die Eingabe Beispiele keine Zeitstempel enthalten:</span><span class="sxs-lookup"><span data-stu-id="30fa5-143">If the input samples do not contain any time stamps:</span></span>

-   <span data-ttu-id="30fa5-144">Der Decoder sollte seine eigenen Zeitstempel generieren und den ersten Ausgabezeit Stempel auf NULL festlegen.</span><span class="sxs-lookup"><span data-stu-id="30fa5-144">The decoder should generate its own time stamps, setting the first output time stamp to zero.</span></span>
-   <span data-ttu-id="30fa5-145">Die Stichproben Dauer wird anhand der Anzahl von Ausgabe Beispielen im Puffer und der Stichprobenrate berechnet.</span><span class="sxs-lookup"><span data-stu-id="30fa5-145">The sample duration is calculated from the number of output samples in the buffer and the sample rate.</span></span>
-   <span data-ttu-id="30fa5-146">Nachfolgende Zeitstempel werden aus dem vorherigen Zeitstempel und der Dauer berechnet: Aktueller Zeitstempel + aktuelle Dauer = nächster Zeitstempel.</span><span class="sxs-lookup"><span data-stu-id="30fa5-146">Subsequent time stamps are calculated from the previous time stamp and duration: Current time stamp + current duration = next time stamp.</span></span> <span data-ttu-id="30fa5-147">Es sollten keine Lücken in den Ausgabezeit Stempeln vorliegen.</span><span class="sxs-lookup"><span data-stu-id="30fa5-147">There should be no gaps in the output time stamps.</span></span>

<span data-ttu-id="30fa5-148">Wenn der Eingabedaten Strom Anfangszeit Stempel enthält, aber aus irgendeinem Grund zu keinem Zeitstempel wechselt, sollte der Decoder weiterhin seine eigenen Ausgabezeit Stempel generieren, sodass Sie kontinuierlich sind und keine Lücke vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="30fa5-148">If the input stream initially contains time stamps, but for some reason switches to no time stamps, the decoder should continue to generate its own output time stamps, such that they are continuous and there is no gap.</span></span>

<span data-ttu-id="30fa5-149">Wenn der Eingabedaten Strom Zeitstempel enthält, aber es gibt Lücken in den Zeiten, gibt der Decoder diese Lücken einfach weiter.</span><span class="sxs-lookup"><span data-stu-id="30fa5-149">If the input stream contains time stamps, but there are gaps in the times, the decoder will simply propagate these gaps.</span></span> <span data-ttu-id="30fa5-150">Anders ausgedrückt: der Decoder sollte nicht versuchen, inkonsistente Zeitstempel im Eingabestream zu korrigieren.</span><span class="sxs-lookup"><span data-stu-id="30fa5-150">In other words, the decoder should not attempt to fix inconsistent time stamps in the input stream.</span></span>

### <a name="mixers"></a><span data-ttu-id="30fa5-151">Mischer</span><span class="sxs-lookup"><span data-stu-id="30fa5-151">Mixers</span></span>

> [!Note]  
> <span data-ttu-id="30fa5-152">In Windows Vista unterstützt die Media Foundation Pipeline keine MFTs mit mehr als einer Eingabe.</span><span class="sxs-lookup"><span data-stu-id="30fa5-152">In Windows Vista, the Media Foundation pipeline does not support MFTs with more than one input.</span></span> <span data-ttu-id="30fa5-153">MFTs mit mehreren Eingaben werden in Windows 7 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="30fa5-153">Multiple-input MFTs are supported in Windows 7.</span></span>

 

<span data-ttu-id="30fa5-154">Ein Mixer nimmt mehrere Eingaben an und mischt sie in eine Ausgabe ein.</span><span class="sxs-lookup"><span data-stu-id="30fa5-154">A mixer takes multiple inputs and mixes them into one output.</span></span> <span data-ttu-id="30fa5-155">Wenn die Eingabedaten Ströme nicht vollständig von der Rate gesperrt sind oder leicht zeitgleich versetzt werden, kann die festgelegte Zeit in der Ausgabe mehrdeutig sein.</span><span class="sxs-lookup"><span data-stu-id="30fa5-155">If the input streams are not completely rate-locked, or are slightly offset in time from each other, there can be ambiguity about which time to set on the output.</span></span> <span data-ttu-id="30fa5-156">Im folgenden finden Sie einige Richtlinien, abhängig vom Medientyp:</span><span class="sxs-lookup"><span data-stu-id="30fa5-156">Here are some guidelines, depending on the media type:</span></span>

-   <span data-ttu-id="30fa5-157">Audio.</span><span class="sxs-lookup"><span data-stu-id="30fa5-157">Audio.</span></span> <span data-ttu-id="30fa5-158">Beim Start oder unmittelbar nach einer Ableitung oder Leerung sollte ein Audiomixer warten, bis Ausgabe Beispiele erzeugt werden, bis er ein Eingabe Beispiel für alle erforderlichen Eingabedaten Ströme erhalten hat.</span><span class="sxs-lookup"><span data-stu-id="30fa5-158">At startup or immediately after a drain or flush, an audio mixer should wait to produce output samples until it has received an input sample on all required input streams.</span></span> <span data-ttu-id="30fa5-159">An diesem Punkt sollte der früheste Zeitstempel der anfänglichen Stichproben ausgewählt werden, der als Grundlage für die Ausgabezeit Stempel verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="30fa5-159">At that point, it should choose the earliest time stamp of the initial samples to use as a baseline for the output time stamps.</span></span> <span data-ttu-id="30fa5-160">Die anderen Streams sollten mit Ruhe aufgefüllt werden, um eine beliebige Zeit Abweichung zu bilden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-160">The other streams should be padded with silence to make up any time discrepancy.</span></span> <span data-ttu-id="30fa5-161">Wenn eine Stichprobe in einem optionalen Eingabedaten Strom empfangen wird, sollte Sie auch in die Berechnung einbezogen werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-161">If a sample is received on an optional input stream, it should also be factored into the calculation.</span></span> <span data-ttu-id="30fa5-162">Ab diesem Zeitpunkt sollte der MFT eine kontinuierliche und ununterbrochene Kette von Ausgabezeit Stempeln entwickeln.</span><span class="sxs-lookup"><span data-stu-id="30fa5-162">From that point on, the MFT should strive to produce a continuous and unbroken chain of output time stamps.</span></span> <span data-ttu-id="30fa5-163">Im Allgemeinen sollte der MFT nicht versuchen, einen Datenstrom in Relation zu einem anderen zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="30fa5-163">In general, the MFT should not try to account for one stream drifting relative to another.</span></span> <span data-ttu-id="30fa5-164">Stattdessen sollte die Ausgabezeit Stempel aus dem Baseline-Zeitstempel, der Ausgabe Rate und den Puffergrößen berechnet werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-164">Instead, it should calculate the output time stamps from the baseline time stamp, the output rate, and the buffer sizes.</span></span> <span data-ttu-id="30fa5-165">Wenn eine andere Ableitung oder Leerung auftritt, sollte der MFT seine Baseline-Zeitstempel zurücksetzen.</span><span class="sxs-lookup"><span data-stu-id="30fa5-165">When another drain or flush occurs, the MFT should reset its baseline time stamps.</span></span>

-   <span data-ttu-id="30fa5-166">Video.</span><span class="sxs-lookup"><span data-stu-id="30fa5-166">Video.</span></span> <span data-ttu-id="30fa5-167">Beim Start oder unmittelbar nach einer Ableitung oder Leerung sollte ein Video-Mixer warten, bis Ausgabe Beispiele erzeugt werden, bis er ein Eingabe Beispiel für alle erforderlichen Eingabedaten Ströme erhalten hat.</span><span class="sxs-lookup"><span data-stu-id="30fa5-167">At startup or immediately after a drain or flush, a video mixer should wait to produce output samples until it has received an input sample on all required input streams.</span></span> <span data-ttu-id="30fa5-168">An diesem Punkt sollte der früheste Zeitstempel der anfänglichen Stichproben ausgewählt werden, der als Grundlage für die Ausgabezeit Stempel verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="30fa5-168">At that point, it should choose the earliest time stamp of the initial samples to use as a baseline for the output time stamps.</span></span> <span data-ttu-id="30fa5-169">Im Allgemeinen sollte Sie sich darauf konzentrieren, kontinuierliche und reguläre Ausgabezeit Stempel und die Dauer zu korrigieren, auch wenn die Eingabe nicht so regulär ist, wenn dies durch wiederholte Eingabe Frames notwendig ist.</span><span class="sxs-lookup"><span data-stu-id="30fa5-169">In general, it should strive to keep continuous and regular output time stamps and fixed durations, even if the input is not as regular, if necessary by repeating input frames.</span></span>

### <a name="encoders"></a><span data-ttu-id="30fa5-170">Encoder</span><span class="sxs-lookup"><span data-stu-id="30fa5-170">Encoders</span></span>

<span data-ttu-id="30fa5-171">Ein Encoder konvertiert unkomprimierte Audiodaten oder Videos in komprimierte Pakete.</span><span class="sxs-lookup"><span data-stu-id="30fa5-171">An encoder converts uncompressed audio or video into compressed packets.</span></span> <span data-ttu-id="30fa5-172">Ein Encoder sollte die folgenden Richtlinien befolgen:</span><span class="sxs-lookup"><span data-stu-id="30fa5-172">An encoder should follow these guidelines:</span></span>

-   <span data-ttu-id="30fa5-173">Der Encoder muss den Konventionen des Ausgabeformats folgen.</span><span class="sxs-lookup"><span data-stu-id="30fa5-173">The encoder should follow the conventions of the output format.</span></span> <span data-ttu-id="30fa5-174">Wenn das Format in der Regel nicht jedes Beispiel mit einem Zeitstempel versehen wird, wie in MPEG-2, benötigen nicht alle Ausgabe Beispiele einen Zeitstempel und eine Dauer.</span><span class="sxs-lookup"><span data-stu-id="30fa5-174">If the format does not typically time stamp every sample, as in MPEG-2, not every output sample needs to have a time stamp and a duration.</span></span>

-   <span data-ttu-id="30fa5-175">Die Eingabe Zeitstempel sollten im Ausgabeformat beibehalten werden, wenn das Format über Felder für Zeitstempel verfügt, es sei denn, es handelt sich um bessere Zeit Informationen, die von einer anderen Quelle verfügbar sind, z. b. die Anwendung selbst.</span><span class="sxs-lookup"><span data-stu-id="30fa5-175">The input time stamps should be preserved in the output format, if the format has fields for time stamps, unless better time information is a available from another source, such as the application itself.</span></span>

### <a name="multiplexers"></a><span data-ttu-id="30fa5-176">Multiplexers (</span><span class="sxs-lookup"><span data-stu-id="30fa5-176">Multiplexers</span></span>

> [!Note]  
> <span data-ttu-id="30fa5-177">In Windows Vista unterstützt die Media Foundation Pipeline keine MFTs mit mehr als einer Eingabe.</span><span class="sxs-lookup"><span data-stu-id="30fa5-177">In Windows Vista, the Media Foundation pipeline does not support MFTs with more than one input.</span></span> <span data-ttu-id="30fa5-178">MFTs mit mehreren Eingaben werden in Windows 7 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="30fa5-178">Multiple-input MFTs are supported in Windows 7.</span></span>

 

<span data-ttu-id="30fa5-179">Ein Multiplexer kombiniert zwei unterschiedliche Audio-oder Videostreams zu einem verschachtelten Format, wie z. b. AVI oder MPEG-2-Transportstream.</span><span class="sxs-lookup"><span data-stu-id="30fa5-179">A multiplexer combines two different audio or video streams into one interleaved format, such as AVI or MPEG-2 Transport Stream.</span></span> <span data-ttu-id="30fa5-180">Ein Multiplexer sollte folgende Richtlinien befolgen:</span><span class="sxs-lookup"><span data-stu-id="30fa5-180">A multiplexer should follow these guidelines:</span></span>

-   <span data-ttu-id="30fa5-181">Der Multiplexer muss den Konventionen des Ausgabeformats folgen.</span><span class="sxs-lookup"><span data-stu-id="30fa5-181">The multiplexer should follow the conventions of the output format.</span></span> <span data-ttu-id="30fa5-182">Wenn das Format in der Regel nicht jedes Beispiel mit einem Zeitstempel versehen wird, wie in MPEG-2, benötigen nicht alle Ausgabe Beispiele einen Zeitstempel und eine Dauer.</span><span class="sxs-lookup"><span data-stu-id="30fa5-182">If the format does not typically time stamp every sample, as in MPEG-2, not every output sample needs to have a time stamp and a duration.</span></span>

-   <span data-ttu-id="30fa5-183">Der Zeitstempel sollte die früheste Zeit für einen Frame, der in diesem Paket beginnt, oder die Uhrzeit des ersten audiobeispiels widerspiegeln, die von diesem Paket decodiert wird.</span><span class="sxs-lookup"><span data-stu-id="30fa5-183">The time stamp should reflect the earliest time that would be placed on any frame that begins in that packet, or the time of the first audio sample that would be decoded from that packet.</span></span> <span data-ttu-id="30fa5-184">Ignorieren Sie diese Richtlinie, wenn Sie mit den Konventionen des Ausgabeformats in Konflikt steht.</span><span class="sxs-lookup"><span data-stu-id="30fa5-184">Ignore this guideline if it conflicts with the conventions of the output format.</span></span>

### <a name="demultiplexers"></a><span data-ttu-id="30fa5-185">Demultiplexer</span><span class="sxs-lookup"><span data-stu-id="30fa5-185">Demultiplexers</span></span>

<span data-ttu-id="30fa5-186">Ein Demultiplexer teilt ein überlappendes Format (z. b. AVI oder MPEG-2-Transportstream) in die zugrunde liegenden Audiodaten Ströme auf.</span><span class="sxs-lookup"><span data-stu-id="30fa5-186">A demultiplexer splits an interleaved format, such as AVI or MPEG-2 Transport Stream, into the underlying audio and video streams.</span></span>

<span data-ttu-id="30fa5-187">Wenn das Format bestimmte Zeitstempel Informationen enthält, die verwendet werden können, um genaue Ausgabezeit Stempel basierend auf den Eingabe Zeitstempeln zu berechnen, sollten diese Informationen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-187">If the format contains specific time stamp information that can be used to calculate accurate output time stamps based on the input time stamps, that information should be used.</span></span> <span data-ttu-id="30fa5-188">Wenn das Format jedoch Zeiten in einer vollständig anderen Basis enthält, die keine Beziehung zu den Eingabe Zeitstempeln haben, und ein präziser Offset zum Eingabe Zeitstempel nicht berechnet werden kann, sollten die eigenen Zeiten des Formats ignoriert werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-188">However, if the format contains times in a completely different base that bear no relation to the input time stamps, and an accurate offset to the input time stamp cannot be calculated, the format's own times should be ignored.</span></span>

<span data-ttu-id="30fa5-189">Wenn das Format keine verwendbaren Zeitstempel Informationen enthält, sollte der Demultiplexer diese Regeln befolgen:</span><span class="sxs-lookup"><span data-stu-id="30fa5-189">If the format does not have usable time stamp information, the demultiplexer should follow these rules:</span></span>

-   <span data-ttu-id="30fa5-190">Nicht komprimierte Ausgabestreams sollten nach Möglichkeit über gültige Zeitstempel und Dauer verfügen, die anhand des nächstgelegenen vorherigen Eingabe Zeitstempels berechnet werden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-190">Uncompressed output streams should have valid time stamps and durations if possible, calculated from the closest previous input time stamp.</span></span>

-   <span data-ttu-id="30fa5-191">Komprimierte Ausgabestreams sollten Zeitstempel nur für das erste Ausgabe Beispiel aufweisen, das aus einem Eingabe Beispiel mit einem Zeitstempel abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="30fa5-191">Compressed output streams should have time stamps on only the first output sample derived from an input sample with a time stamp.</span></span> <span data-ttu-id="30fa5-192">Wenn das Eingabe Beispiel keinen Zeitstempel hat, sollten keine Ausgabe Beispiele, die von diesem Eingabe Beispiel abgeleitet werden, über einen Zeitstempel verfügen.</span><span class="sxs-lookup"><span data-stu-id="30fa5-192">If the input sample does not have a time stamp, no output samples derived from that input sample should have a time stamp.</span></span> <span data-ttu-id="30fa5-193">Wenn das Eingabe Beispiel in mehrere Ausgabe Beispiele aufgeteilt ist, sollte nur das erste Ausgabe Beispiel einen Zeitstempel aufweisen, und der Rest sollte keine Zeitstempel enthalten.</span><span class="sxs-lookup"><span data-stu-id="30fa5-193">If the input sample is broken into multiple output samples, only the first output sample should have a time stamp, and the rest should have no time stamps.</span></span>

### <a name="examples"></a><span data-ttu-id="30fa5-194">Beispiele</span><span class="sxs-lookup"><span data-stu-id="30fa5-194">Examples</span></span>

<span data-ttu-id="30fa5-195">Beispiel 1:</span><span class="sxs-lookup"><span data-stu-id="30fa5-195">Example 1.</span></span> <span data-ttu-id="30fa5-196">Angenommen, ein Videoeffekt nimmt immer einen nicht komprimierten Eingabe Rahmen an, wendet den Effekt an und kopiert ihn in die Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="30fa5-196">Suppose that a video effect always takes an uncompressed input frame, applies the effect, and copies it to the output.</span></span> <span data-ttu-id="30fa5-197">Er hält niemals Frames zurück oder puffert Eingaben.</span><span class="sxs-lookup"><span data-stu-id="30fa5-197">It never holds back any frames or buffers any input.</span></span> <span data-ttu-id="30fa5-198">Diese MFT kopiert einfach den Zeitstempel und die Dauer aus dem Eingabe Beispiel in das Ausgabe Beispiel, sofern diese verfügbar sind, und führt überhaupt keine Zeit Berechnungen durch.</span><span class="sxs-lookup"><span data-stu-id="30fa5-198">This MFT simply copies the time stamp and duration from the input sample to the output sample, if they are available, and does no time calculations at all.</span></span>

<span data-ttu-id="30fa5-199">Beispiel 2:</span><span class="sxs-lookup"><span data-stu-id="30fa5-199">Example 2.</span></span> <span data-ttu-id="30fa5-200">Nehmen wir an, dass ein Audioeffekt alle 10 Millisekunden (MS) jedes Eingabe Puffers transformiert und die zusätzlichen 10 MS zum kombinieren mit dem nächsten Puffer speichert.</span><span class="sxs-lookup"><span data-stu-id="30fa5-200">Suppose that an audio effect transforms all but 10 milliseconds (ms) of each input buffer, saving the extra 10 ms to combine with the next buffer.</span></span> <span data-ttu-id="30fa5-201">Es wird ein Datenstrom von Beispielen abgerufen, die alle eine Dauer von 50 ms haben.</span><span class="sxs-lookup"><span data-stu-id="30fa5-201">It gets a stream of samples that all have a duration of 50 ms.</span></span> <span data-ttu-id="30fa5-202">Die Eingabe Zeiten sind in der folgenden Tabelle aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="30fa5-202">The input times are shown in the following table.</span></span>



| <span data-ttu-id="30fa5-203">Beispiel</span><span class="sxs-lookup"><span data-stu-id="30fa5-203">Sample</span></span> | <span data-ttu-id="30fa5-204">Eingabe Zeit</span><span class="sxs-lookup"><span data-stu-id="30fa5-204">Input time</span></span> | <span data-ttu-id="30fa5-205">Eingabe Dauer</span><span class="sxs-lookup"><span data-stu-id="30fa5-205">Input duration</span></span> | <span data-ttu-id="30fa5-206">Ausgabezeit</span><span class="sxs-lookup"><span data-stu-id="30fa5-206">Output time</span></span> | <span data-ttu-id="30fa5-207">Ausgabe Dauer</span><span class="sxs-lookup"><span data-stu-id="30fa5-207">Output duration</span></span> |
|--------|------------|----------------|-------------|-----------------|
| <span data-ttu-id="30fa5-208">1</span><span class="sxs-lookup"><span data-stu-id="30fa5-208">1</span></span>      | <span data-ttu-id="30fa5-209">20</span><span class="sxs-lookup"><span data-stu-id="30fa5-209">20</span></span>         | <span data-ttu-id="30fa5-210">50</span><span class="sxs-lookup"><span data-stu-id="30fa5-210">50</span></span>             | <span data-ttu-id="30fa5-211">20</span><span class="sxs-lookup"><span data-stu-id="30fa5-211">20</span></span>          | <span data-ttu-id="30fa5-212">40</span><span class="sxs-lookup"><span data-stu-id="30fa5-212">40</span></span>              |
| <span data-ttu-id="30fa5-213">2</span><span class="sxs-lookup"><span data-stu-id="30fa5-213">2</span></span>      | <span data-ttu-id="30fa5-214">70</span><span class="sxs-lookup"><span data-stu-id="30fa5-214">70</span></span>         | <span data-ttu-id="30fa5-215">50</span><span class="sxs-lookup"><span data-stu-id="30fa5-215">50</span></span>             | <span data-ttu-id="30fa5-216">60</span><span class="sxs-lookup"><span data-stu-id="30fa5-216">60</span></span>          | <span data-ttu-id="30fa5-217">50</span><span class="sxs-lookup"><span data-stu-id="30fa5-217">50</span></span>              |
| <span data-ttu-id="30fa5-218">3</span><span class="sxs-lookup"><span data-stu-id="30fa5-218">3</span></span>      | <span data-ttu-id="30fa5-219">121</span><span class="sxs-lookup"><span data-stu-id="30fa5-219">121</span></span>        | <span data-ttu-id="30fa5-220">50</span><span class="sxs-lookup"><span data-stu-id="30fa5-220">50</span></span>             | <span data-ttu-id="30fa5-221">110</span><span class="sxs-lookup"><span data-stu-id="30fa5-221">110</span></span>         | <span data-ttu-id="30fa5-222">50</span><span class="sxs-lookup"><span data-stu-id="30fa5-222">50</span></span>              |
| <span data-ttu-id="30fa5-223">4</span><span class="sxs-lookup"><span data-stu-id="30fa5-223">4</span></span>      | <span data-ttu-id="30fa5-224">171</span><span class="sxs-lookup"><span data-stu-id="30fa5-224">171</span></span>        | <span data-ttu-id="30fa5-225">50</span><span class="sxs-lookup"><span data-stu-id="30fa5-225">50</span></span>             | <span data-ttu-id="30fa5-226">161</span><span class="sxs-lookup"><span data-stu-id="30fa5-226">161</span></span>         | <span data-ttu-id="30fa5-227">50</span><span class="sxs-lookup"><span data-stu-id="30fa5-227">50</span></span>              |



 

<span data-ttu-id="30fa5-228">Beachten Sie die 1-MS-Abweichung zwischen der tatsächlichen Dauer von Stichprobe 2 und der impliziten Dauer basierend auf dem nächsten Zeitstempel (121?</span><span class="sxs-lookup"><span data-stu-id="30fa5-228">Note the 1-ms discrepancy between the actual duration of sample 2 and the implied duration based on the next time stamp (121 ?</span></span> <span data-ttu-id="30fa5-229">70 = 51).</span><span class="sxs-lookup"><span data-stu-id="30fa5-229">70 = 51).</span></span>

<span data-ttu-id="30fa5-230">Da der MFT 10 MS zurückhält, gibt er die ersten 40 ms der Eingabe Stichprobe 1 als Ausgabe Beispiel 1 mit einem Zeitstempel von 20 ms und einer Dauer von 40 ms aus.</span><span class="sxs-lookup"><span data-stu-id="30fa5-230">Because the MFT holds back 10 ms, it outputs the first 40 ms of input sample 1 as output sample 1, with a time stamp of 20 ms and a duration of 40 ms.</span></span>

<span data-ttu-id="30fa5-231">Ausgabe Beispiel 2 kombiniert die 10 MS, die zuvor mit 40 ms der Eingabe Stichprobe 2 zurück gehalten wurden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-231">Output sample 2 combines the 10 ms previously held back with 40 ms of input sample 2.</span></span> <span data-ttu-id="30fa5-232">Dieses Beispiel erhält einen Zeitstempel von 60 ms (der Zeitstempel des vorherigen Eingabe Beispiels, 20 ms, zuzüglich der Dauer der Daten, die aus diesem Beispiel bereits verarbeitet wurden, 40 ms).</span><span class="sxs-lookup"><span data-stu-id="30fa5-232">This sample is given a time stamp of 60 ms (the time stamp of the previous input sample, 20ms, plus the duration of the data already processed from that sample, 40ms).</span></span> <span data-ttu-id="30fa5-233">Es erhält eine Dauer von 50 ms.</span><span class="sxs-lookup"><span data-stu-id="30fa5-233">It is given a duration of 50ms.</span></span>

<span data-ttu-id="30fa5-234">Ebenso hat das nächste Beispiel einen Zeitstempel von 110ms (70ms + 40 ms) mit einer Dauer von 50 ms.</span><span class="sxs-lookup"><span data-stu-id="30fa5-234">Similarly, the next sample has a time stamp of 110ms (70ms + 40ms) with a duration of 50 ms.</span></span>

<span data-ttu-id="30fa5-235">Die nächste Berechnung ist interessanter.</span><span class="sxs-lookup"><span data-stu-id="30fa5-235">The next calculation is more interesting.</span></span> <span data-ttu-id="30fa5-236">Der implizite Zeitstempel aus der vorherigen Ausgabezeit und Dauer beträgt 160 MS (Zeitstempel 110 ms + Dauer 50 ms).</span><span class="sxs-lookup"><span data-stu-id="30fa5-236">The implied time stamp from the previous output time and duration would be 160 ms (time stamp 110 ms + duration 50 ms).</span></span> <span data-ttu-id="30fa5-237">Allerdings sollte der Ausgabezeit Stempel aus dem Eingabe Zeitstempel des frühesten Eingabe Beispiels berechnet werden, das das Ausgabe Beispiel zeitlich überlappt, zuzüglich der Länge der Daten, die bereits aus diesem Beispiel verarbeitet wurden.</span><span class="sxs-lookup"><span data-stu-id="30fa5-237">However, the output time stamp is supposed to be calculated from the input time stamp of the earliest input sample that overlaps the output sample in time, plus the length of any data already processed from that sample.</span></span> <span data-ttu-id="30fa5-238">Das nächstgelegene überlappende Eingabe Beispiel ist das Beispiel 4 (Zeitstempel = 171), aber dies ist nicht das früheste.</span><span class="sxs-lookup"><span data-stu-id="30fa5-238">The closest overlapping input sample is the sample 4 (time stamp = 171), but this is not the earliest one.</span></span> <span data-ttu-id="30fa5-239">Das früheste überlappende Beispiel ist Sample 3 (Zeitstempel = 121).</span><span class="sxs-lookup"><span data-stu-id="30fa5-239">The earliest overlapping sample is sample 3 (time stamp = 121).</span></span> <span data-ttu-id="30fa5-240">Wenn die 40 ms hinzugefügt werden, die aus diesem Beispiel bereits verarbeitet wurden, ist das Ergebnis 161.</span><span class="sxs-lookup"><span data-stu-id="30fa5-240">Adding the 40ms that has already been processed from that sample, the result is 161.</span></span>

## <a name="related-topics"></a><span data-ttu-id="30fa5-241">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="30fa5-241">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="30fa5-242">Schreiben eines benutzerdefinierten MFT</span><span class="sxs-lookup"><span data-stu-id="30fa5-242">Writing a Custom MFT</span></span>](writing-a-custom-mft.md)
</dt> </dl>

 

 



