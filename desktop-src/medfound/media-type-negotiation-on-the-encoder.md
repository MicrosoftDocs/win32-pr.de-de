---
description: Medientyp Aushandlung für den Encoder
ms.assetid: c8ae543e-68f7-4c74-9cb7-2a200bd51820
title: Medientyp Aushandlung für den Encoder
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7845e9d50c5d418198dc0e08313e2e9329ffab8
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/03/2021
ms.locfileid: "103961210"
---
# <a name="media-type-negotiation-on-the-encoder"></a><span data-ttu-id="c0227-103">Medientyp Aushandlung für den Encoder</span><span class="sxs-lookup"><span data-stu-id="c0227-103">Media Type Negotiation on the Encoder</span></span>

<span data-ttu-id="c0227-104">In Microsoft Media Foundation werden Encoder als [Media Foundation Transformationen](media-foundation-transforms.md) (MFTs) mit einer Eingabe und einer Ausgabe implementiert.</span><span class="sxs-lookup"><span data-stu-id="c0227-104">In Microsoft Media Foundation, encoders are implemented as [Media Foundation transforms](media-foundation-transforms.md) (MFTs) with one input and one output.</span></span> <span data-ttu-id="c0227-105">Vor einer Codierungs Sitzung muss ein Encoder die Merkmale des Datenstroms, der als Eingabe empfangen wird, und das Format des Datenstroms, der als Ausgabe erzeugt wird, kennen.</span><span class="sxs-lookup"><span data-stu-id="c0227-105">Before an encoding session, an encoder needs to know the characteristics of the stream it will receive as input and the format of the stream it will produce as output.</span></span> <span data-ttu-id="c0227-106">Sie müssen die Eingabe-und Ausgabemedien Typen und die zugehörigen Eigenschaften festlegen, bevor Sie Daten über den Encoder übergeben.</span><span class="sxs-lookup"><span data-stu-id="c0227-106">You must set the input and output media types and related characteristics before you pass data through the encoder.</span></span> <span data-ttu-id="c0227-107">Sie müssen die Eingabe-und Ausgabeformate angeben, indem Sie die entsprechenden [Medientyp-GUIDs](media-type-guids.md) angeben und die Merkmale des Ausgabestreams festlegen, indem Sie die relevanten [Medientyp Attribute](media-type-attributes.md) für den Ausgabe Medientyp festlegen.</span><span class="sxs-lookup"><span data-stu-id="c0227-107">You must supply the input and output formats by specifying the appropriate [Media Type GUIDs](media-type-guids.md) and set the characteristics of the output stream by setting the relevant [Media Type Attributes](media-type-attributes.md) on the output media type.</span></span> <span data-ttu-id="c0227-108">Ein neu instanziierte Encoder weist keine festgelegten Medientypen auf.</span><span class="sxs-lookup"><span data-stu-id="c0227-108">A newly instantiated encoder does not have any set media types.</span></span>

<span data-ttu-id="c0227-109">Der Eingabe Medientyp ist ein unkomprimiertes Format, z. b. PCM-Audiodaten oder RGB-Video.</span><span class="sxs-lookup"><span data-stu-id="c0227-109">The input media type is an uncompressed format, such as PCM audio or RGB video.</span></span> <span data-ttu-id="c0227-110">Die vom Encoder verwendeten Format Typen sind auf die Typen beschränkt, die von den **videoinfoheader** -und **WaveFormatEx** -Strukturen beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="c0227-110">The format types that are used by the encoder are limited to those described by the **VIDEOINFOHEADER** and **WAVEFORMATEX** structures.</span></span> <span data-ttu-id="c0227-111">Weitere Informationen zu diesen Strukturen finden Sie in der Windows SDK-Dokumentation. Media Foundation stellt Hilfsfunktionen zum Erstellen von Medientypen aus Format Strukturen bereit.</span><span class="sxs-lookup"><span data-stu-id="c0227-111">For more information about these structures, see the Windows SDK documentation.Media foundation provides helper functions to create media types from format structures.</span></span> <span data-ttu-id="c0227-112">Beispielsweise initialisiert die Funktion " [**mfinitmediatyetfromvideoinfoheader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader) " einen Videotyp aus einer **videoinfoheader** -Struktur, und die Funktion " [**mfinitmediatypeer fromwaveformatex**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromwaveformatex) " Initialisiert einen Videotyp aus einer **WaveFormatEx** -oder **WAVEFORMATEXTENSIBLE** -Struktur.</span><span class="sxs-lookup"><span data-stu-id="c0227-112">For example, the [**MFInitMediaTypeFromVideoInfoHeader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader) function initializes a video type from a **VIDEOINFOHEADER** structure, and the [**MFInitMediaTypeFromWaveFormatEx**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromwaveformatex) function initializes a video type from a **WAVEFORMATEX** or **WAVEFORMATEXTENSIBLE** structure.</span></span> <span data-ttu-id="c0227-113">Weitere Informationen finden Sie unter [Medientyp Konvertierungen](media-type-conversions.md).</span><span class="sxs-lookup"><span data-stu-id="c0227-113">For more information, see [Media Type Conversions](media-type-conversions.md).</span></span> <span data-ttu-id="c0227-114">Sie müssen den Eingabe Medientyp für den Encoder festlegen, indem Sie [**imftransform:: setinputtype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="c0227-114">You must set the input media type on the encoder by calling [**IMFTransform::SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype).</span></span>

<span data-ttu-id="c0227-115">Der Ausgabe Medientyp ist das Komprimierungs Format, das im endgültigen Quelldaten Strom oder in der endgültigen Datei verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c0227-115">The output media type is the compression format used in the final source stream or file.</span></span> <span data-ttu-id="c0227-116">Sie können den verfügbaren Ausgabe Medientyp erst festlegen, nachdem Sie den Eingabe Medientyp festgelegt haben.</span><span class="sxs-lookup"><span data-stu-id="c0227-116">You can set the available output media type only after setting the input media type.</span></span> <span data-ttu-id="c0227-117">Sie können die unterstützten Ausgabetypen abrufen, indem Sie " [**imftransform:: getoutputavailabletype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype) " in einer Schleife aufrufen, bis der Encoder " **MF \_ E \_ No \_ more \_ types**" zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="c0227-117">You can retrieve the supported output types by calling [**IMFTransform::GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype) in a loop until the encoder returns **MF\_E\_NO\_MORE\_TYPES**.</span></span> <span data-ttu-id="c0227-118">Erhöhen Sie den Typindex bei jeder Iterationen.</span><span class="sxs-lookup"><span data-stu-id="c0227-118">Increment the type index with each iteration.</span></span> <span data-ttu-id="c0227-119">Wenn Sie einen geeigneten Medientyp finden, legen Sie den Ausgabe Medientyp durch Aufrufen von [**imftransform:: setoutputtype**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype)fest.</span><span class="sxs-lookup"><span data-stu-id="c0227-119">When you find an appropriate media type, set the output media type by calling [**IMFTransform::SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span></span>

<span data-ttu-id="c0227-120">Der entscheidende Faktor bei der Auswahl des Ausgabemedien Typs hängt vom Codierungstyp und den Codierungs Anforderungen ab.</span><span class="sxs-lookup"><span data-stu-id="c0227-120">The deciding factor in choosing the output media type depends on the type of encoding and your encoding requirements.</span></span> <span data-ttu-id="c0227-121">Beispielsweise möchten Sie für Audiodatenströme, die CBR-codiert sind, einen Medientyp suchen, der mit Ihrer Eingabe übereinstimmt, und eine Bitrate haben, die so nah wie möglich an einem Zielwert ist.</span><span class="sxs-lookup"><span data-stu-id="c0227-121">For example, for audio streams that are CBR-encoded, you want to find a media type that matches your input and has a bit rate that is as close as possible to a target value.</span></span>

<span data-ttu-id="c0227-122">Wenn Sie einen anderen Codierungs Modus als CBR verwenden möchten, müssen Sie den-Modus festlegen und dann die Ausgabetypen für diesen Modus auflisten, da der Encoder die unterstützten Ausgabetypen abhängig vom festgelegten Modus ändert.</span><span class="sxs-lookup"><span data-stu-id="c0227-122">If you want to use an encoding mode other than CBR, you must set the mode and then enumerate the output types for that mode, because the encoder changes the supported output types depending upon the mode set.</span></span> <span data-ttu-id="c0227-123">Die Eigenschaften, die den Codierungs Modus steuern, sind [**mfpkey \_ vbrenabled**](mfpkey-vbrenabledproperty.md) und [**mfpkey \_ passesused**](mfpkey-passesusedproperty.md).</span><span class="sxs-lookup"><span data-stu-id="c0227-123">The properties that control the encoding mode are [**MFPKEY\_VBRENABLED**](mfpkey-vbrenabledproperty.md) and [**MFPKEY\_PASSESUSED**](mfpkey-passesusedproperty.md).</span></span> <span data-ttu-id="c0227-124">Wenn Sie z. b. Ausgabetypen für die VBR-Qualitäts Codierung auflisten, hängt der Medientyp von dem Qualitäts Wert ab, den Sie verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="c0227-124">For example, if you are enumerating output types for VBR-quality encoding, the media type depends on the quality value you decide to use.</span></span> <span data-ttu-id="c0227-125">Weitere Informationen zum Festlegen dieser Eigenschaften finden Sie unter [Codierungs Eigenschaften](configuring-the-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="c0227-125">For information about setting these properties, see [Encoding Properties](configuring-the-encoder.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c0227-126">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="c0227-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c0227-127">Instanziieren eines MFT-Encoders</span><span class="sxs-lookup"><span data-stu-id="c0227-127">Instantiating an Encoder MFT</span></span>](instantiating-the-encoder-mft.md)
</dt> <dt>

[<span data-ttu-id="c0227-128">Windows Media Encoder</span><span class="sxs-lookup"><span data-stu-id="c0227-128">Windows Media Encoders</span></span>](windows-media-encoders.md)
</dt> </dl>

 

 



