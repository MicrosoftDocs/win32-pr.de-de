---
title: Verarbeiten der Verbindung mit einer Fenster Station
description: Ein Prozess stellt automatisch eine Verbindung mit einer Fenster Station und einem Desktop her, wenn er zum ersten Mal eine User32-oder gdi32-Funktion aufruft (mit Ausnahme der Fenster Station-und Desktop Funktionen).
ms.assetid: 280f69e7-5c99-41a7-94e3-da13deaac9f5
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7a87e97b19ac1210b04447652268c5f53b7e2a6d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104390737"
---
# <a name="process-connection-to-a-window-station"></a><span data-ttu-id="946fb-103">Verarbeiten der Verbindung mit einer Fenster Station</span><span class="sxs-lookup"><span data-stu-id="946fb-103">Process Connection to a Window Station</span></span>

<span data-ttu-id="946fb-104">Ein Prozess stellt automatisch eine Verbindung mit einer Fenster Station und einem Desktop her, wenn er zum ersten Mal eine User32-oder gdi32-Funktion aufruft (mit Ausnahme der Fenster Station-und Desktop Funktionen).</span><span class="sxs-lookup"><span data-stu-id="946fb-104">A process automatically establishes a connection to a window station and desktop when it first calls a USER32 or GDI32 function (other than the window station and desktop functions).</span></span> <span data-ttu-id="946fb-105">Das System bestimmt die Fenster Station, mit der ein Prozess eine Verbindung herstellt, gemäß den folgenden Regeln:</span><span class="sxs-lookup"><span data-stu-id="946fb-105">The system determines the window station to which a process connects according to the following rules:</span></span>

1.  <span data-ttu-id="946fb-106">Wenn der Prozess die Funktion " [**SetProcessWindowStation**](/windows/win32/api/winuser/nf-winuser-setprocesswindowstation) " aufgerufen hat, stellt er eine Verbindung mit der in diesem Aufruf angegebenen Fenster Station her.</span><span class="sxs-lookup"><span data-stu-id="946fb-106">If the process has called the [**SetProcessWindowStation**](/windows/win32/api/winuser/nf-winuser-setprocesswindowstation) function, it connects to the window station specified in that call.</span></span>
2.  <span data-ttu-id="946fb-107">Wenn der Prozess [**SetProcessWindowStation**](/windows/win32/api/winuser/nf-winuser-setprocesswindowstation)nicht aufgerufen hat, stellt er eine Verbindung mit der Fenster Station her, die vom übergeordneten Prozess geerbt wurde.</span><span class="sxs-lookup"><span data-stu-id="946fb-107">If the process did not call [**SetProcessWindowStation**](/windows/win32/api/winuser/nf-winuser-setprocesswindowstation), it connects to the window station inherited from the parent process.</span></span>
3.  <span data-ttu-id="946fb-108">Wenn der Prozess [**SetProcessWindowStation**](/windows/win32/api/winuser/nf-winuser-setprocesswindowstation) nicht aufgerufen hat und keine Fenster Station geerbt hat, versucht das System, den maximal \_ zulässigen Zugriff zu öffnen und wie folgt eine Verbindung mit einer Fenster Station herzustellen:</span><span class="sxs-lookup"><span data-stu-id="946fb-108">If the process did not call [**SetProcessWindowStation**](/windows/win32/api/winuser/nf-winuser-setprocesswindowstation) and did not inherit a window station, the system attempts to open for MAXIMUM\_ALLOWED access and connect to a window station as follows:</span></span>
    -   <span data-ttu-id="946fb-109">Wenn ein Fenster Stationsname im **lpdesktop-** Member der [**STARTUPINFO**](/windows/desktop/api/processthreadsapi/ns-processthreadsapi-startupinfoa) -Struktur angegeben wurde, die beim Erstellen des Prozesses verwendet wurde, stellt der Prozess eine Verbindung mit der angegebenen Fenster Station her.</span><span class="sxs-lookup"><span data-stu-id="946fb-109">If a window station name was specified in the **lpDesktop** member of the [**STARTUPINFO**](/windows/desktop/api/processthreadsapi/ns-processthreadsapi-startupinfoa) structure that was used when the process was created, the process connects to the specified window station.</span></span>
    -   <span data-ttu-id="946fb-110">Andernfalls stellt der Prozess eine Verbindung mit der interaktiven Fenster Station her, wenn der Prozess in der Anmelde Sitzung des interaktiven Benutzers ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="946fb-110">Otherwise, if the process is running in the logon session of the interactive user, the process connects to the interactive window station.</span></span>
    -   <span data-ttu-id="946fb-111">Wenn der Prozess in einer nicht interaktiven Anmelde Sitzung ausgeführt wird, wird der Name der Fenster Station basierend auf dem Anmelde Sitzungs Bezeichner erstellt, und es wird versucht, die Fenster Station zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="946fb-111">If the process is running in a noninteractive logon session, the window station name is formed based on the logon session identifier and an attempt is made to open that window station.</span></span> <span data-ttu-id="946fb-112">Wenn der Öffnungsvorgang fehlschlägt, weil diese Fenster Station nicht vorhanden ist, versucht das System, die Fenster Station und einen Standard Desktop zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="946fb-112">If the open operation fails because this window station does not exist, the system tries to create the window station and a default desktop.</span></span>

<span data-ttu-id="946fb-113">Die während dieses Verbindungs Vorgangs zugewiesene Fenster Station kann nicht durch Aufrufen der [**closewindowstation**](/windows/win32/api/winuser/nf-winuser-closewindowstation) -Funktion geschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="946fb-113">The window station assigned during this connection process cannot be closed by calling the [**CloseWindowStation**](/windows/win32/api/winuser/nf-winuser-closewindowstation) function.</span></span>

<span data-ttu-id="946fb-114">Wenn ein Prozess eine Verbindung mit einer Fenster Station herstellt, durchsucht das System die Handle-Tabelle des Prozesses nach geerbten Handles.</span><span class="sxs-lookup"><span data-stu-id="946fb-114">When a process is connecting to a window station, the system searches the process's handle table for inherited handles.</span></span> <span data-ttu-id="946fb-115">Das System verwendet das erste gefundene Fenster Station-handle.</span><span class="sxs-lookup"><span data-stu-id="946fb-115">The system uses the first window station handle it finds.</span></span> <span data-ttu-id="946fb-116">Wenn Sie möchten, dass ein untergeordneter Prozess eine Verbindung mit einer bestimmten geerbten Fenster Station herstellt, müssen Sie sicherstellen, dass nur das gewünschte Handle als vererbbar gekennzeichnet ist.</span><span class="sxs-lookup"><span data-stu-id="946fb-116">If you want a child process to connect to a particular inherited window station, you must ensure that only the desired handle is marked inheritable.</span></span> <span data-ttu-id="946fb-117">Wenn ein untergeordneter Prozess mehrere Fenster Stations Handles erbt, sind die Ergebnisse der Fenster Stations Verbindung nicht definiert.</span><span class="sxs-lookup"><span data-stu-id="946fb-117">If a child process inherits multiple window station handles, the results of the window station connection are undefined.</span></span>

<span data-ttu-id="946fb-118">Behandelt eine Fenster Station, die das System öffnet, während ein Prozess mit einer Fenster Station verbunden wird, ist nicht vererbbar.</span><span class="sxs-lookup"><span data-stu-id="946fb-118">Handles to a window station that the system opens while connecting a process to a window station are not inheritable.</span></span>

## <a name="related-topics"></a><span data-ttu-id="946fb-119">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="946fb-119">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="946fb-120">Thread Verbindung mit einem Desktop</span><span class="sxs-lookup"><span data-stu-id="946fb-120">Thread Connection to a Desktop</span></span>](thread-connection-to-a-desktop.md)
</dt> </dl>

 

 