---
description: Die wsaaccept-Funktion ermöglicht einer Anwendung das Abrufen von Aufruferinformationen wie Aufrufer-ID und Quality of Service, bevor Sie entscheiden, ob eine eingehende Verbindungsanforderung akzeptiert
ms.assetid: 65883556-6890-4d0a-8c7f-c4ff68642caf
title: Einrichten und Löschen der Verbindung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f9c4ac1f32524d097e11825f8104eb41fee3c528
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106357335"
---
# <a name="connection-setup-and-teardown"></a><span data-ttu-id="666de-103">Einrichten und Löschen der Verbindung</span><span class="sxs-lookup"><span data-stu-id="666de-103">Connection Setup and Teardown</span></span>

<span data-ttu-id="666de-104">Die [**wsaaccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept) -Funktion ermöglicht einer Anwendung das Abrufen von Aufruferinformationen wie Aufrufer-ID und Quality of Service, bevor Sie entscheiden, ob eine eingehende Verbindungsanforderung akzeptiert</span><span class="sxs-lookup"><span data-stu-id="666de-104">The [**WSAAccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept) function lets an application obtain caller information such as caller identifier and Quality of Service before deciding whether to accept an incoming connection request.</span></span> <span data-ttu-id="666de-105">Dies erfolgt mit einem Rückruf einer von der Anwendung bereitgestellten Bedingungs Funktion.</span><span class="sxs-lookup"><span data-stu-id="666de-105">This is done with a callback to an application-supplied condition function.</span></span>

<span data-ttu-id="666de-106">Benutzer-zu-Benutzer-Daten, die durch Parameter in der [**wsaconnetct**](/windows/desktop/api/Winsock2/nf-winsock2-wsaconnect) -Funktion und die Condition-Funktion von [**wsaaccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept) angegeben werden, können während der Verbindungs Herstellung an den Peer übertragen werden, sofern diese Funktion vom Dienstanbieter unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="666de-106">User-to-user data specified by parameters in the [**WSAConnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaconnect) function and the condition function of [**WSAAccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept) can be transferred to the peer during connection establishment, provided this feature is supported by the service provider.</span></span>

<span data-ttu-id="666de-107">Es ist auch möglich (bei Protokollen, die dies unterstützen), Benutzerdaten zwischen den Endpunkten zum Zeitpunkt der Verbindungs Löschung auszutauschen.</span><span class="sxs-lookup"><span data-stu-id="666de-107">It is also possible (for protocols that support this) to exchange user data between the endpoints at connection teardown time.</span></span> <span data-ttu-id="666de-108">Das Ende, das "Beendigungs" initiiert, kann die [**wsasenddisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsasenddisconnect) -Funktion aufzurufen, um anzugeben, dass keine weiteren Daten gesendet werden, und um die Verbindungs-Beendigungs-Sequenz zu initiieren.</span><span class="sxs-lookup"><span data-stu-id="666de-108">The end that initiates the teardown can call the [**WSASendDisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsasenddisconnect) function to indicate that no more data be sent and to initiate the connection teardown sequence.</span></span> <span data-ttu-id="666de-109">Bei bestimmten Protokollen ist ein Teil von "Beendigungs" die Übermittlung von Disconnect-Daten vom Beendigungs-Initiator.</span><span class="sxs-lookup"><span data-stu-id="666de-109">For certain protocols, part of teardown is the delivery of disconnect data from the teardown initiator.</span></span> <span data-ttu-id="666de-110">Nachdem Sie festgestellt haben, dass das Remote Ende "Beendigungs" initiiert hat (in der Regel durch die Bestätigung der FD- \_ Schließung), kann die [**wsarecvdisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecvdisconnect) -Funktion aufgerufen werden, um die Trennungs Daten zu empfangen, sofern vorhanden</span><span class="sxs-lookup"><span data-stu-id="666de-110">After receiving notice that the remote end has initiated teardown (typically by the FD\_CLOSE indication), the [**WSARecvDisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecvdisconnect) function can be called to receive the disconnect data, if any.</span></span>

<span data-ttu-id="666de-111">Beachten Sie das folgende Szenario, um zu veranschaulichen, wie die Trennung von Daten verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="666de-111">To illustrate how disconnect data can be used, consider the following scenario.</span></span> <span data-ttu-id="666de-112">Die Client Hälfte einer Client/Server-Anwendung ist für das Beenden einer Socketverbindung verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="666de-112">The client half of a client/server application is responsible for terminating a socket connection.</span></span> <span data-ttu-id="666de-113">Koincident mit der Beendigung stellt die Gesamtzahl der Transaktionen, die Sie mit dem Server verarbeitet hat (unter Verwendung von Disconnect-Daten) bereit.</span><span class="sxs-lookup"><span data-stu-id="666de-113">Coincident with the termination, it provides (using disconnect data) the total number of transactions it processed with the server.</span></span> <span data-ttu-id="666de-114">Der Server antwortet wiederum mit der kumulativen Gesamtsumme der Transaktionen, die er mit allen Clients verarbeitet hat.</span><span class="sxs-lookup"><span data-stu-id="666de-114">The server in turn responds with the cumulative total of transactions that it has processed with all clients.</span></span> <span data-ttu-id="666de-115">Die Abfolge der Aufrufe und Anzeichen können wie folgt auftreten:</span><span class="sxs-lookup"><span data-stu-id="666de-115">The sequence of calls and indications might occur as follows:</span></span>

| <span data-ttu-id="666de-116">Clientseitig</span><span class="sxs-lookup"><span data-stu-id="666de-116">Client side</span></span>                                                                                                              | <span data-ttu-id="666de-117">Serverseitig</span><span class="sxs-lookup"><span data-stu-id="666de-117">Server side</span></span>                                                                                                                                                                                                                   |
|--------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="666de-118">(1) [**wsasenddisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsasenddisconnect) aufrufen, um die Sitzung zu beenden und die Transaktions Summe zu liefern.</span><span class="sxs-lookup"><span data-stu-id="666de-118">(1) Invoke [**WSASendDisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsasenddisconnect) to conclude session and supply transaction total.</span></span>            |                                                                                                                                                                                                                               |
|                                                                                                                          | <span data-ttu-id="666de-119">(2) Get FD \_ Close, [**empfangener**](/windows/desktop/api/winsock/nf-winsock-recv) mit einem Rückgabewert von 0 (null) oder [wsaediscon](windows-sockets-error-codes-2.md) -Fehlerrückgabe von [**WSARecv**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv) , was auf das ordnungsgemäße Herunterfahren hinweist.</span><span class="sxs-lookup"><span data-stu-id="666de-119">(2) Get FD\_CLOSE, [**recv**](/windows/desktop/api/winsock/nf-winsock-recv) with a return value of zero, or [WSAEDISCON](windows-sockets-error-codes-2.md) error return from [**WSARecv**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecv) indicating graceful shutdown in progress.</span></span> |
|                                                                                                                          | <span data-ttu-id="666de-120">(3) [**wsarecvdisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecvdisconnect) aufrufen, um die Transaktions Summe des Clients zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="666de-120">(3) Invoke [**WSARecvDisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecvdisconnect) to get client's transaction total.</span></span>                                                                                                                                |
|                                                                                                                          | <span data-ttu-id="666de-121">(4) berechnen des kumulativen Gesamtergebnisses aller Transaktionen.</span><span class="sxs-lookup"><span data-stu-id="666de-121">(4) Compute cumulative grand total of all transactions.</span></span>                                                                                                                                                                       |
|                                                                                                                          | <span data-ttu-id="666de-122">(5) [**wsasenddisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsasenddisconnect) aufrufen, um das Gesamtergebnis zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="666de-122">(5) Invoke [**WSASendDisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsasenddisconnect) to transmit grand total.</span></span>                                                                                                                                          |
| <span data-ttu-id="666de-123">(6) empfangen Sie die Bestätigung von FD \_ .</span><span class="sxs-lookup"><span data-stu-id="666de-123">(6) Receive FD\_CLOSE indication.</span></span>                                                                                        | <span data-ttu-id="666de-124">(5a) rufen Sie [**closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket)auf.</span><span class="sxs-lookup"><span data-stu-id="666de-124">(5a) Invoke [**closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket).</span></span>                                                                                                                                                                             |
| <span data-ttu-id="666de-125">(7) rufen Sie [**wsarecvdisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecvdisconnect) auf, um eine kumulative Gesamtsumme von Transaktionen zu empfangen und zu speichern.</span><span class="sxs-lookup"><span data-stu-id="666de-125">(7) Invoke [**WSARecvDisconnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsarecvdisconnect) to receive and store cumulative grand total of transactions.</span></span> |                                                                                                                                                                                                                               |
| <span data-ttu-id="666de-126">(8) [ **closesocket** aufrufen](/windows/desktop/api/winsock/nf-winsock-closesocket)</span><span class="sxs-lookup"><span data-stu-id="666de-126">(8) Invoke [**closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket)</span></span>                                                                          |                                                                                                                                                                                                                               |



 

<span data-ttu-id="666de-127">Beachten Sie, dass Step (5a) (Schritt (5)) befolgt werden muss, aber keine zeitliche Beziehungs Beziehung mit Schritt (6), (7) oder (8) aufweist.</span><span class="sxs-lookup"><span data-stu-id="666de-127">Note that step (5a) must follow step (5), but has no timing relationship with step (6), (7), or (8).</span></span>

 

 



