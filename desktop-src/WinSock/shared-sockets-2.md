---
description: Die wsadupliingesocket-Funktion wird eingeführt, um die prozessübergreifende socketfreigabe zu aktivieren.
ms.assetid: f7cf40e9-f3a6-4b62-8a78-df25464e2365
title: Freigegebene Sockets
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb6753b01f6389254756254d2ebe196af8e2a8a3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103959333"
---
# <a name="shared-sockets"></a><span data-ttu-id="4b64d-103">Freigegebene Sockets</span><span class="sxs-lookup"><span data-stu-id="4b64d-103">Shared Sockets</span></span>

<span data-ttu-id="4b64d-104">Die [**wsadupliingesocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsaduplicatesocketa) -Funktion wird eingeführt, um die prozessübergreifende socketfreigabe zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="4b64d-104">The [**WSADuplicateSocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsaduplicatesocketa) function is introduced to enable socket sharing across processes.</span></span> <span data-ttu-id="4b64d-105">Von einem Quell Prozess wird **wsadupliplatesocket** aufgerufen, um eine spezielle [**wsaprotocol- \_ Informations**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) Struktur für einen Ziel Prozess Bezeichner zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="4b64d-105">A source process calls **WSADuplicateSocket** to obtain a special [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure for a target process identifier.</span></span> <span data-ttu-id="4b64d-106">Er verwendet einen gewissen Prozess für die prozessübergreifende Kommunikation (IPC), um den Inhalt dieser Struktur an einen Ziel Prozess zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="4b64d-106">It uses some interprocess communications (IPC) mechanism to pass the contents of this structure to a target process.</span></span> <span data-ttu-id="4b64d-107">Der Ziel Prozess verwendet dann die **wsaprotocol- \_ Informations** Struktur in einem [**wspsocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket)-aufrufsvorgang.</span><span class="sxs-lookup"><span data-stu-id="4b64d-107">The target process then uses the **WSAPROTOCOL\_INFO** structure in a call to [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket).</span></span> <span data-ttu-id="4b64d-108">Der von dieser Funktion zurückgegebene socketdeskriptor ist ein zusätzlicher socketdeskriptor für einen zugrunde liegenden Socket, der freigegeben wird.</span><span class="sxs-lookup"><span data-stu-id="4b64d-108">The socket descriptor returned by this function will be an additional socket descriptor to an underlying socket which thus becomes shared.</span></span> <span data-ttu-id="4b64d-109">Sockets können von Threads in einem bestimmten Prozess gemeinsam genutzt werden, ohne dass die **wsadupliallesocket** -Funktion verwendet wird, da ein socketdeskriptor in allen Threads eines Prozesses gültig ist.</span><span class="sxs-lookup"><span data-stu-id="4b64d-109">Sockets can be shared among threads in a given process without using the **WSADuplicateSocket** function because a socket descriptor is valid in all threads of a process.</span></span>

<span data-ttu-id="4b64d-110">Die zwei (oder mehr) Deskriptoren, die auf einen freigegebenen Socket verweisen, können unabhängig von den e/a-Vorgängen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4b64d-110">The two (or more) descriptors that reference a shared socket can be used independently as far as I/O is concerned.</span></span> <span data-ttu-id="4b64d-111">Die Winsock-Schnittstelle implementiert jedoch keinen Zugriffs Steuerungstyp, sodass die Prozesse alle Vorgänge für einen freigegebenen Socket koordinieren müssen.</span><span class="sxs-lookup"><span data-stu-id="4b64d-111">However, the Winsock interface does not implement any type of access control, so the processes must coordinate any operations on a shared socket.</span></span> <span data-ttu-id="4b64d-112">Ein typisches Beispiel für die Freigabe von Sockets besteht darin, einen Prozess zum Erstellen von Sockets und zum Herstellen von Verbindungen zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="4b64d-112">A typical example of sharing sockets is to use one process for creating sockets and establishing connections.</span></span> <span data-ttu-id="4b64d-113">Dieser Prozess übergibt Sockets an andere Prozesse, die für den Informationsaustausch zuständig sind.</span><span class="sxs-lookup"><span data-stu-id="4b64d-113">This process then hands off sockets to other processes that are responsible for information exchange.</span></span>

<span data-ttu-id="4b64d-114">Die [**wsaduplitoresocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsaduplicatesocketa) -Funktion erstellt socketdeskriptoren und nicht den zugrunde liegenden Socket.</span><span class="sxs-lookup"><span data-stu-id="4b64d-114">The [**WSADuplicateSocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsaduplicatesocketa) function creates socket descriptors and not the underlying socket.</span></span> <span data-ttu-id="4b64d-115">Folglich werden alle einem Socket zugeordneten Zustände in allen Deskriptoren gemeinsam gespeichert.</span><span class="sxs-lookup"><span data-stu-id="4b64d-115">As a result, all the states associated with a socket are held in common across all the descriptors.</span></span> <span data-ttu-id="4b64d-116">Beispielsweise wird ein [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) -Vorgang, der mit einem Deskriptor ausgeführt wird, anschließend mithilfe von [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) von einem beliebigen oder allen Deskriptoren sichtbar.</span><span class="sxs-lookup"><span data-stu-id="4b64d-116">For example, a [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) operation performed using one descriptor is subsequently visible using a [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) from any or all descriptors.</span></span> <span data-ttu-id="4b64d-117">Ein Prozess kann [**closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket) für einen duplizierten Socket aufzurufen, und die Zuordnung des Deskriptors wird aufgehoben.</span><span class="sxs-lookup"><span data-stu-id="4b64d-117">A process can call [**closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket) on a duplicated socket and the descriptor will become deallocated.</span></span> <span data-ttu-id="4b64d-118">Der zugrunde liegende Socket bleibt jedoch geöffnet, bis **closesocket** mit dem letzten verbleibenden Deskriptor aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="4b64d-118">The underlying socket, however, remains open until **closesocket** is called with the last remaining descriptor.</span></span>

<span data-ttu-id="4b64d-119">Benachrichtigungen zu freigegebenen Sockets unterliegen den üblichen Einschränkungen der [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) -und [**WSAEventSelect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect) -Funktionen.</span><span class="sxs-lookup"><span data-stu-id="4b64d-119">Notification on shared sockets is subject to the usual constraints of the [**WSAAsyncSelect**](/windows/desktop/api/winsock/nf-winsock-wsaasyncselect) and [**WSAEventSelect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaeventselect) functions.</span></span> <span data-ttu-id="4b64d-120">Wenn Sie einen dieser Aufrufe mit einem der freigegebenen Deskriptoren ausgeben, werden alle vorherigen Ereignis Registrierungen für den Socket abgebrochen, unabhängig davon, welcher Deskriptor für die Registrierung verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="4b64d-120">Issuing either of these calls using any of the shared descriptors cancels any previous event registration for the socket, regardless of which descriptor was used to make that registration.</span></span> <span data-ttu-id="4b64d-121">Folglich wäre es z. B. nicht möglich, den Prozess A Receive FD \_ -Lese Ereignisse und Process B-Receive-Write-Ereignisse zu verarbeiten \_ .</span><span class="sxs-lookup"><span data-stu-id="4b64d-121">Thus, for example, it would not be possible to have process A receive FD\_READ events and process B receive FD\_WRITE events.</span></span> <span data-ttu-id="4b64d-122">In Situationen, in denen eine solche strenge Koordination erforderlich ist, wird empfohlen, dass Entwickler anstelle von separaten Prozessen Threads verwenden.</span><span class="sxs-lookup"><span data-stu-id="4b64d-122">For situations when such tight coordination is required, it is suggested that developers use threads instead of separate processes.</span></span>

 

 
