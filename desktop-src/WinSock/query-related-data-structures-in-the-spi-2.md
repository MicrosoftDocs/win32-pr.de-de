---
description: Die wsaqueryset-Struktur wird verwendet, um Abfragen für die nsplookupservicebegin-Funktion zu erstellen und zum Übermitteln von Abfrage Ergebnissen für die nsplookupservicenext-Funktion zu verwenden.
ms.assetid: 017b5828-bc6e-42b7-aba7-21648b2dd707
title: Query-Related von Datenstrukturen in der SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57ce5a7016bd2ad96f464137177036b470c64a95
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104565959"
---
# <a name="query-related-data-structures-in-the-spi"></a><span data-ttu-id="84d28-103">Query-Related von Datenstrukturen in der SPI</span><span class="sxs-lookup"><span data-stu-id="84d28-103">Query-Related Data Structures in the SPI</span></span>

<span data-ttu-id="84d28-104">Die [**wsaqueryset**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) -Struktur wird zum Erstellen von Abfragen für [**nsplookupservicebegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin)verwendet und zum Übermitteln von Abfrage Ergebnissen für [**nsplookupservicenext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext)verwendet.</span><span class="sxs-lookup"><span data-stu-id="84d28-104">The [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure is used to form queries for [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin), and used to deliver query results for [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span></span> <span data-ttu-id="84d28-105">Es handelt sich um eine komplexe Struktur, da Sie Zeiger auf verschiedene andere Strukturen enthält, von denen einige immer noch andere Strukturen referenzieren.</span><span class="sxs-lookup"><span data-stu-id="84d28-105">It is a complex structure because it contains pointers to several other structures, some of which reference still other structures.</span></span> <span data-ttu-id="84d28-106">Die Beziehung zwischen **wsaqueryset** und den Strukturen, auf die verwiesen wird, ist wie folgt dargestellt:</span><span class="sxs-lookup"><span data-stu-id="84d28-106">The relationship between **WSAQUERYSET** and the structures it references is illustrated as follows:</span></span>

![wsaqueryset-Strukturen](images/ovrvw3-2.png)

<span data-ttu-id="84d28-108">Innerhalb der [**wsaqueryset**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) -Struktur sind die meisten Member selbsterklärend, aber einige verdienen weitere Erläuterungen.</span><span class="sxs-lookup"><span data-stu-id="84d28-108">Within the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure, most of the members are self explanatory, but some deserve additional explanation.</span></span> <span data-ttu-id="84d28-109">Die **dwSize** wird mit sizeof ( **wsaqueryset**) gefüllt und kann von Namespace Anbietern verwendet werden, um unterschiedliche Versionen der möglicherweise angezeigten **wsaqueryset** -Struktur zu erkennen und anzupassen.</span><span class="sxs-lookup"><span data-stu-id="84d28-109">The **dwSize** will be filled in with sizeof( **WSAQUERYSET**), and can be used by namespace providers to detect and adapt to different versions of the **WSAQUERYSET** structure that may appear.</span></span>

<span data-ttu-id="84d28-110">Der **dwoutputflags** -Member wird von einem Namespace Anbieter verwendet, um zusätzliche Daten über Abfrageergebnisse bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="84d28-110">The **dwOutputFlags** member is used by a namespace provider to provide additional data about query results.</span></span> <span data-ttu-id="84d28-111">Weitere Informationen finden Sie unter [**nsplookupservicenext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span><span class="sxs-lookup"><span data-stu-id="84d28-111">For more information, see [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span></span>

<span data-ttu-id="84d28-112">Die von **lpversion** referenzierte [**wsaecomparator**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) -Struktur wird sowohl für die Abfrage Einschränkung als auch für Ergebnisse verwendet.</span><span class="sxs-lookup"><span data-stu-id="84d28-112">The [**WSAECOMPARATOR**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) structure referenced by **lpversion** is used for both query constraint and results.</span></span> <span data-ttu-id="84d28-113">Für Abfragen gibt der **dwVersion** -Member die gewünschte Version des Dienstanbieter an.</span><span class="sxs-lookup"><span data-stu-id="84d28-113">For queries, the **dwVersion** member indicates the desired version of the service.</span></span> <span data-ttu-id="84d28-114">Der **echow** -Member ist ein enumerierter Typ, der angibt, wie der Vergleich durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="84d28-114">The **ecHow** member is an enumerated type which specifies how the comparison will be made.</span></span> <span data-ttu-id="84d28-115">Die Optionen sind "Comp gleich", \_ was erfordert, dass eine genaue Entsprechung in der Version auftritt, oder Comp \_ notless, das angibt, dass die Versionsnummer des diensnicht kleiner ist als der Wert von " **dwVersion**".</span><span class="sxs-lookup"><span data-stu-id="84d28-115">The choices are COMP\_EQUALS which requires that an exact match in version occurs, or COMP\_NOTLESS which specifies that the service's version number be no less than the value of **dwVersion**.</span></span>

<span data-ttu-id="84d28-116">Die Interpretation von **dwnamespace** und **lpnsproviderid** hängt davon ab, wie die Struktur verwendet wird, und wird weiter unten in den einzelnen Funktionsbeschreibungen beschrieben, die diese Struktur verwenden.</span><span class="sxs-lookup"><span data-stu-id="84d28-116">The interpretation of **dwNameSpace** and **lpNSProviderId** depends upon how the structure is being used and is described further in the individual function descriptions that utilize this structure.</span></span>

<span data-ttu-id="84d28-117">Das **lpszcontext** -Element gilt für hierarchische Namespaces und gibt den Anfangspunkt einer Abfrage oder den Speicherort in der Hierarchie an, in der sich der Dienst befindet.</span><span class="sxs-lookup"><span data-stu-id="84d28-117">The **lpszContext** member applies to hierarchical namespaces, and specifies the starting point of a query or the location within the hierarchy where the service resides.</span></span> <span data-ttu-id="84d28-118">Allgemeine Regeln</span><span class="sxs-lookup"><span data-stu-id="84d28-118">The general rules are:</span></span>

-   <span data-ttu-id="84d28-119">Mit dem Wert **null**(leer) wird die Suche im Standardkontext gestartet.</span><span class="sxs-lookup"><span data-stu-id="84d28-119">A value of **NULL**, blank ("") will start the search at the default context.</span></span>
-   <span data-ttu-id="84d28-120">Der Wert " \\ " beginnt die Suche am Anfang des Namespace.</span><span class="sxs-lookup"><span data-stu-id="84d28-120">A value of "\\" starts the search at the top of the namespace.</span></span>
-   <span data-ttu-id="84d28-121">Bei jedem anderen Wert wird die Suche am vorgesehenen Punkt gestartet.</span><span class="sxs-lookup"><span data-stu-id="84d28-121">Any other value starts the search at the designated point.</span></span>

<span data-ttu-id="84d28-122">Anbieter, die keine Kapselung unterstützen, geben möglicherweise einen Fehler zurück, wenn etwas anderes als "" oder " \\ " angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="84d28-122">Providers that do not support containment may return an error if anything other than "" or "\\" is specified.</span></span> <span data-ttu-id="84d28-123">Anbieter, die eingeschränkte Einschluss Unterstützung (z. b. Gruppen) unterstützen, müssen "", " \\ " oder einen bestimmten Punkt akzeptieren.</span><span class="sxs-lookup"><span data-stu-id="84d28-123">Providers that support limited containment, such as groups, should accept "", '\\", or a designated point.</span></span> <span data-ttu-id="84d28-124">Kontexte sind Namespace spezifisch.</span><span class="sxs-lookup"><span data-stu-id="84d28-124">Contexts are namespace specific.</span></span> <span data-ttu-id="84d28-125">Wenn **dwnamespace** den Wert NS \_ all hat, sollte nur "" oder " \\ " als Kontext weitergegeben werden, da diese von allen Namespaces erkannt werden.</span><span class="sxs-lookup"><span data-stu-id="84d28-125">If **dwNameSpace** is NS\_ALL, then only "" or "\\" should be passed as the context because these are recognized by all namespaces.</span></span>

<span data-ttu-id="84d28-126">Der **lpszquerystring** -Member wird verwendet, um zusätzliche, Namespace spezifische Abfrage Informationen bereitzustellen, z. b. eine Zeichenfolge, die einen bekannten Dienst-und Transportprotokoll Namen beschreibt, wie in "FTP/TCP".</span><span class="sxs-lookup"><span data-stu-id="84d28-126">The **lpszQueryString** member is used to supply additional, namespace-specific query information such as a string describing a well-known service and transport protocol name, as in "ftp/tcp".</span></span>

<span data-ttu-id="84d28-127">Die [**afprotokolls**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) -Struktur, auf die von **lpafpprotokolle** verwiesen wird, wird nur zu Abfrage Zwecken verwendet und stellt eine Liste von Protokollen bereit, um die Abfrage einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="84d28-127">The [**AFPROTOCOLS**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) structure referenced by **lpafpProtocols** is used for query purposes only, and supplies a list of protocols to constrain the query.</span></span> <span data-ttu-id="84d28-128">Diese Protokolle werden als (Adressfamilie, Protokoll Paare) dargestellt, da Protokoll Werte nur im Kontext einer Adressfamilie Bedeutung haben.</span><span class="sxs-lookup"><span data-stu-id="84d28-128">These protocols are represented as (address family, protocol) pairs, because protocol values only have meaning within the context of an address family.</span></span>

<span data-ttu-id="84d28-129">Das Array der [**csaddr \_**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) -Informationsstruktur, auf das von **lpcsabuffer** verwiesen wird, enthält alle Informationen, die erforderlich sind, damit ein Dienst zum Einrichten einer Überwachung verwendet werden kann, oder ein Client, der beim Herstellen einer Verbindung mit dem Dienst verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="84d28-129">The array of [**CSADDR\_INFO**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) structure referenced by **lpcsaBuffer** contains all of the information required for either a service to use in establishing a listen, or a client to use in establishing a connection to the service.</span></span> <span data-ttu-id="84d28-130">Die Member **localaddr** und **remoteaddr** enthalten beide direkt eine [**socketadressstruktur \_**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) .</span><span class="sxs-lookup"><span data-stu-id="84d28-130">The **LocalAddr** and **RemoteAddr** members both directly contain a [**SOCKET\_ADDRESS**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) structure.</span></span> <span data-ttu-id="84d28-131">Ein Dienst erstellt einen Socket mithilfe des Tupels (localaddr. lpsockaddr->SA- \_ Familie, isockettype, iProtocol).</span><span class="sxs-lookup"><span data-stu-id="84d28-131">A service would create a socket using the tuple (LocalAddr.lpSockaddr->sa\_family, iSocketType, iProtocol).</span></span> <span data-ttu-id="84d28-132">Er bindet den Socket mithilfe von "localaddr. lpsockaddr" und "localaddr. lpsockaddrlength" an eine lokale Adresse.</span><span class="sxs-lookup"><span data-stu-id="84d28-132">It would bind the socket to a local address using LocalAddr.lpSockaddr, and LocalAddr.lpSockaddrLength.</span></span> <span data-ttu-id="84d28-133">Der Client erstellt seinen Socket mit dem Tupel (remoteaddr. lpsockaddr->SA- \_ Familie, isockettype, iProtocol) und verwendet die Kombination aus remoteaddr. lpsockaddr und remoteaddr. lpsockaddrlength beim Herstellen einer Remote Verbindung.</span><span class="sxs-lookup"><span data-stu-id="84d28-133">The client creates its socket with the tuple (RemoteAddr.lpSockaddr->sa\_family, iSocketType, iProtocol), and uses the combination of RemoteAddr.lpSockaddr, and RemoteAddr.lpSockaddrLength when making a remote connection.</span></span>

 

 
