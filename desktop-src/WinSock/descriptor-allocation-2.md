---
description: Während Windows Sockets-Dienstanbietern das Implementieren von Sockets als IFS-Objekte (installierbare File System) empfehlen, werden von der Winsock-Architektur auch Dienstanbieter unterstützt, deren Sockethandles keine IFS-Objekte sind.
ms.assetid: ed5e10f4-fa17-4a07-9cac-43767915b8e9
title: Deskriptorzuordnung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 095301798eb850fc4eb63e1939712379b5ead85e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106357334"
---
# <a name="descriptor-allocation"></a><span data-ttu-id="142fc-103">Deskriptorzuordnung</span><span class="sxs-lookup"><span data-stu-id="142fc-103">Descriptor Allocation</span></span>

<span data-ttu-id="142fc-104">Während Windows Sockets-Dienstanbietern das Implementieren von Sockets als IFS-Objekte (installierbare File System) empfehlen, werden von der Winsock-Architektur auch Dienstanbieter unterstützt, deren Sockethandles keine IFS-Objekte sind.</span><span class="sxs-lookup"><span data-stu-id="142fc-104">While Windows Sockets service providers are encouraged to implement sockets as installable file system (IFS) objects, the Winsock architecture also accommodates service providers whose socket handles are not IFS objects.</span></span> <span data-ttu-id="142fc-105">Anbieter mit IFS-Handles geben dies über das XP1 \_ IFS \_ Handles-Attribut Bit in der [**wsaprotocol- \_ Informations**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) Struktur an.</span><span class="sxs-lookup"><span data-stu-id="142fc-105">Providers with IFS handles indicate this through the XP1\_IFS\_HANDLES attribute bit in the [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure.</span></span> <span data-ttu-id="142fc-106">(Hinweis: XP1 \_ \_Das IFS Handles-Attribut Bit war nicht in Release 2.0.8 der API-Spezifikation enthalten, wurde aber bereits über den Errata-Mechanismus hinzugefügt.) Winsock SPI-Clients können Anbieter nutzen, deren socketdeskriptoren IFS-Handles sind, indem Sie diese Deskriptoren mit standardmäßigen Windows-e/a-Funktionen wie "read [File](/windows/win32/api/fileapi/nf-fileapi-readfile) " und " [Write File](/windows/win32/api/fileapi/nf-fileapi-writefile)" verwenden.</span><span class="sxs-lookup"><span data-stu-id="142fc-106">(Note: the XP1\_IFS\_HANDLES attribute bit was not included in release 2.0.8 of the API specification, but has since been added through the errata mechanism.) Winsock SPI clients may take advantage of providers whose socket descriptors are IFS handles by using these descriptors with standard Windows I/O facilities, such as [ReadFile](/windows/win32/api/fileapi/nf-fileapi-readfile) and [WriteFile](/windows/win32/api/fileapi/nf-fileapi-writefile).</span></span>

<span data-ttu-id="142fc-107">Wenn ein IFS-Anbieter einen neuen socketdeskriptor erstellt, ist es obligatorisch, dass der Anbieter [**wpumodifyifshandle**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpumodifyifshandle) aufruft, bevor der neue Handle für einen Windows Sockets SPI-Client bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="142fc-107">Whenever an IFS provider creates a new socket descriptor, it is mandatory that the provider call [**WPUModifyIFSHandle**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpumodifyifshandle) prior to supplying the new handle to a Windows Sockets SPI client.</span></span> <span data-ttu-id="142fc-108">Diese Funktion nimmt einen Anbieter Bezeichner und einen vorgeschlagenen IFS-Handle vom Anbieter als Eingabe an und gibt ein (möglicherweise) geändertes Handle zurück.</span><span class="sxs-lookup"><span data-stu-id="142fc-108">This function takes a provider identifier and a proposed IFS handle from the provider as input and returns a (possibly) modified handle.</span></span> <span data-ttu-id="142fc-109">Der IFS-Anbieter muss nur das geänderte Handle für seinen Client bereitstellen, und alle Anforderungen vom Client verweisen nur auf dieses geänderte handle.</span><span class="sxs-lookup"><span data-stu-id="142fc-109">The IFS provider must supply only the modified handle to its client, and all requests from the client will reference only this modified handle.</span></span> <span data-ttu-id="142fc-110">Es ist garantiert, dass das geänderte Handle nicht vom vorgeschlagenen handle unterschieden wird, soweit es sich um das Betriebssystem handelt.</span><span class="sxs-lookup"><span data-stu-id="142fc-110">The modified handle is guaranteed to be indistinguishable from the proposed handle as far as the operating system is concerned.</span></span> <span data-ttu-id="142fc-111">Daher wählt der Dienstanbieter in den meisten Fällen einfach nur das geänderte Handle in der gesamten internen Verarbeitung aus.</span><span class="sxs-lookup"><span data-stu-id="142fc-111">Thus in most instances, the service provider will simply choose to use only the modified handle in all of its internal processing.</span></span> <span data-ttu-id="142fc-112">Der Zweck dieser Änderungs Funktion besteht darin, dass der Ws2- \_32.dll den Prozess der Identifizierung des mit einem bestimmten Socket verknüpften Dienstanbieters erheblich optimieren kann.</span><span class="sxs-lookup"><span data-stu-id="142fc-112">The purpose of this modification function is to allow the Ws2\_32.dll to greatly streamline the process of identifying the service provider associated with a given socket.</span></span>

<span data-ttu-id="142fc-113">Anbieter, die keine IFS-Handles zurückgeben, müssen \_ über den [**wpuanatesockethandle**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpucreatesockethandle) -Befehl ein gültiges Handle vom Ws2-32.dll erhalten.</span><span class="sxs-lookup"><span data-stu-id="142fc-113">Providers that do not return IFS handles must obtain a valid handle from the Ws2\_32.dll via the [**WPUCreateSocketHandle**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpucreatesockethandle) call.</span></span> <span data-ttu-id="142fc-114">Der nonifs-Anbieter muss dem Client nur ein von Windows Sockets 2.DLL bereitgestelltes handle anbieten, und alle Anforderungen vom Client verweisen nur auf diese Handles.</span><span class="sxs-lookup"><span data-stu-id="142fc-114">The nonIFS provider must offer only a Windows Sockets 2.DLL-supplied handle to its client, and all requests from the client will reference only these handles.</span></span> <span data-ttu-id="142fc-115">Um die Implementierung von Dienstanbietern zu erleichtern, ist einer der Eingabeparameter, die von einem Anbieter in **wpukreatesockethandle** bereitgestellt werden, ein DWORD-Kontextwert.</span><span class="sxs-lookup"><span data-stu-id="142fc-115">As a convenience to service provider implementers, one of the input parameters supplied by a provider in **WPUCreateSocketHandle** is a DWORD context value.</span></span> <span data-ttu-id="142fc-116">Der Ws2 \_ -32.dll ordnet diesen Kontextwert dem zugeordneten Sockethandle zu und ermöglicht einem Dienstanbieter das Abrufen des Kontext Werts zu einem beliebigen Zeitpunkt durch den Aufruf von [**wpuquerysockethandlecontext**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuquerysockethandlecontext) .</span><span class="sxs-lookup"><span data-stu-id="142fc-116">The Ws2\_32.dll associates this context value with the allocated socket handle and allows a service provider to retrieve the context value at any time through the [**WPUQuerySocketHandleContext**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuquerysockethandlecontext) call.</span></span> <span data-ttu-id="142fc-117">Eine typische Verwendung dieses Kontext Werts wäre das Speichern eines Zeigers auf eine vom Dienstanbieter beibegebener Datenstruktur, die zum Speichern von socketstatusinformationen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="142fc-117">A typical use for this context value would be to store a pointer to a service provider maintained data structure used to store socket state information.</span></span>

 

 
