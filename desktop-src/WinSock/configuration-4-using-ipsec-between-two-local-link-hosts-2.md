---
description: Mit dieser Konfiguration wird eine IPSec-Sicherheits Zuordnung (SA) zwischen zwei Hosts im gleichen Subnetz erstellt, um die Authentifizierung mit dem Authentifizierungs Header (AH) und dem MD5-Hash Algorithmus (Message Digest 5) auszuführen.
ms.assetid: ed88d8ee-ac65-4310-a988-ead50ff743fd
title: 'Konfiguration 3: Verwenden von IPSec zwischen zwei local-Link-Hosts'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 994e7a760b6ae1ba87678d6061881e5eb80faf88
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104129216"
---
# <a name="configuration-3-using-ipsec-between-two-local-link-hosts"></a><span data-ttu-id="0b258-103">Konfiguration 3: Verwenden von IPSec zwischen zwei local-Link-Hosts</span><span class="sxs-lookup"><span data-stu-id="0b258-103">Configuration 3: Using IPsec Between Two Local-link Hosts</span></span>

<span data-ttu-id="0b258-104">Mit dieser Konfiguration wird eine IPSec-Sicherheits Zuordnung (SA) zwischen zwei Hosts im gleichen Subnetz erstellt, um die Authentifizierung mit dem Authentifizierungs Header (AH) und dem MD5-Hash Algorithmus (Message Digest 5) auszuführen.</span><span class="sxs-lookup"><span data-stu-id="0b258-104">This configuration creates an IPsec Security Association (SA) between two hosts on the same subnet to perform authentication using the Authentication Header (AH) and the Message Digest 5 (MD5) hashing algorithm.</span></span> <span data-ttu-id="0b258-105">In diesem Beispiel sichert die angezeigte Konfiguration den gesamten Datenverkehr zwischen zwei benachbarten Hosts: Host 1 mit der Link-Local-Adresse FE80:: 2AA: FF: FE53: A92C und Host 2 mit der Link-Local-Adresse FE80:: 2AA: FF: FE92: D0F1.</span><span class="sxs-lookup"><span data-stu-id="0b258-105">In this example, the configuration shown secures all traffic between two neighboring hosts: Host 1, with the link-local address FE80::2AA:FF:FE53:A92C, and Host 2, with the link-local address FE80::2AA:FF:FE92:D0F1.</span></span>

<span data-ttu-id="0b258-106">**So verwenden Sie IPSec zwischen zwei local-Link-Hosts**</span><span class="sxs-lookup"><span data-stu-id="0b258-106">**To use IPsec between two local-link hosts**</span></span>

1.  <span data-ttu-id="0b258-107">Erstellen Sie auf Host 1 mithilfe des Befehls dem ipsec6 c leere Sicherheits Zuordnungs Dateien (Sad) und Security Policy (SPD).</span><span class="sxs-lookup"><span data-stu-id="0b258-107">On Host 1, create blank security association (SAD) and security policy (SPD) files by using the ipsec6 c command.</span></span> <span data-ttu-id="0b258-108">In diesem Beispiel ist der Befehl Ipsec6.exe dem ipsec6 c Test.</span><span class="sxs-lookup"><span data-stu-id="0b258-108">In this example, the Ipsec6.exe command is ipsec6 c test.</span></span> <span data-ttu-id="0b258-109">Dadurch werden zwei Dateien erstellt, um Sicherheits Zuordnungen (Test. Sad) und Sicherheitsrichtlinien (Test. SPD) manuell zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="0b258-109">This creates two files to manually configure security associations (Test.sad) and security policies (Test.spd).</span></span>
2.  <span data-ttu-id="0b258-110">Bearbeiten Sie auf Host 1 die SPD-Datei, um eine Sicherheitsrichtlinie hinzuzufügen, die den gesamten Datenverkehr zwischen Host 1 und Host 2 sichert.</span><span class="sxs-lookup"><span data-stu-id="0b258-110">On Host 1, edit the SPD file to add a security policy that secures all traffic between Host 1 and Host 2.</span></span>

    <span data-ttu-id="0b258-111">Die folgende Tabelle zeigt die Sicherheitsrichtlinie, die der Datei "Test. SPD" vor dem ersten Eintrag für dieses Beispiel hinzugefügt wurde (der erste Eintrag in der Datei "Test. SPD" wurde nicht geändert).</span><span class="sxs-lookup"><span data-stu-id="0b258-111">The following table shows the security policy added to the Test.spd file before the first entry for this example (the first entry in the Test.spd file was not modified).</span></span>

    | <span data-ttu-id="0b258-112">SPD-Datei Feldname</span><span class="sxs-lookup"><span data-stu-id="0b258-112">SPD file field name</span></span> | <span data-ttu-id="0b258-113">Beispielwert</span><span class="sxs-lookup"><span data-stu-id="0b258-113">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="0b258-114">**Richtlinie**</span><span class="sxs-lookup"><span data-stu-id="0b258-114">**Policy**</span></span>          | <span data-ttu-id="0b258-115">2</span><span class="sxs-lookup"><span data-stu-id="0b258-115">2</span></span>                          |
    | <span data-ttu-id="0b258-116">**Remoteipaddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-116">**RemoteIPAddr**</span></span>    | <span data-ttu-id="0b258-117">**FE80:: 2AA: FF: FE92: D0F1**</span><span class="sxs-lookup"><span data-stu-id="0b258-117">**FE80::2AA:FF:FE92:D0F1**</span></span> |
    | <span data-ttu-id="0b258-118">**Lokalpaddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-118">**LocalIPAddr**</span></span>     | \*                         |
    | <span data-ttu-id="0b258-119">**Remoteport**</span><span class="sxs-lookup"><span data-stu-id="0b258-119">**RemotePort**</span></span>      | \*                         |
    | <span data-ttu-id="0b258-120">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0b258-120">**Protocol**</span></span>        | \*                         |
    | <span data-ttu-id="0b258-121">**LocalPort**</span><span class="sxs-lookup"><span data-stu-id="0b258-121">**LocalPort**</span></span>       | \*                         |
    | <span data-ttu-id="0b258-122">**Ipsecprotocol**</span><span class="sxs-lookup"><span data-stu-id="0b258-122">**IPSecProtocol**</span></span>   | <span data-ttu-id="0b258-123">**Ada**</span><span class="sxs-lookup"><span data-stu-id="0b258-123">**AH**</span></span>                     |
    | <span data-ttu-id="0b258-124">**Ipsecmode**</span><span class="sxs-lookup"><span data-stu-id="0b258-124">**IPSecMode**</span></span>       | <span data-ttu-id="0b258-125">**Personen**</span><span class="sxs-lookup"><span data-stu-id="0b258-125">**TRANSPORT**</span></span>              |
    | <span data-ttu-id="0b258-126">**RemoteGWIPAddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-126">**RemoteGWIPAddr**</span></span>  | \*                         |
    | <span data-ttu-id="0b258-127">**Sabundleindex**</span><span class="sxs-lookup"><span data-stu-id="0b258-127">**SABundleIndex**</span></span>   | <span data-ttu-id="0b258-128">**NONE**</span><span class="sxs-lookup"><span data-stu-id="0b258-128">**NONE**</span></span>                   |
    | <span data-ttu-id="0b258-129">**Richtung**</span><span class="sxs-lookup"><span data-stu-id="0b258-129">**Direction**</span></span>       | <span data-ttu-id="0b258-130">**Bidirect**</span><span class="sxs-lookup"><span data-stu-id="0b258-130">**BIDIRECT**</span></span>               |
    | <span data-ttu-id="0b258-131">**Aktion**</span><span class="sxs-lookup"><span data-stu-id="0b258-131">**Action**</span></span>          | <span data-ttu-id="0b258-132">**Apply**</span><span class="sxs-lookup"><span data-stu-id="0b258-132">**APPLY**</span></span>                  |
    | <span data-ttu-id="0b258-133">**InterfaceIndex**</span><span class="sxs-lookup"><span data-stu-id="0b258-133">**InterfaceIndex**</span></span>  | <span data-ttu-id="0b258-134">0</span><span class="sxs-lookup"><span data-stu-id="0b258-134">0</span></span>                          |

    

     

    <span data-ttu-id="0b258-135">Platzieren Sie am Ende der Zeile ein Semikolon, das diese Sicherheitsrichtlinie konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="0b258-135">Place a semicolon at the end of the line configuring this security policy.</span></span> <span data-ttu-id="0b258-136">Die Richtlinien Einträge müssen in absteigender numerischer Reihenfolge abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="0b258-136">The policy entries must be placed in decreasing numerical order.</span></span>

3.  <span data-ttu-id="0b258-137">Bearbeiten Sie auf Host 1 die Datei "Sad", und fügen Sie den gesamten Datenverkehr zwischen Host 1 und Host 2 SA-Einträge hinzu.</span><span class="sxs-lookup"><span data-stu-id="0b258-137">On Host 1, edit the SAD file, adding SA entries to secure all traffic between Host 1 and Host 2.</span></span> <span data-ttu-id="0b258-138">Es müssen zwei Sicherheits Zuordnungen erstellt werden: eine für den Datenverkehr zu Host 2 und eine für den Datenverkehr von Host 2.</span><span class="sxs-lookup"><span data-stu-id="0b258-138">Two security associations must be created, one for traffic to Host 2 and one for traffic from Host 2.</span></span>

    <span data-ttu-id="0b258-139">In der folgenden Tabelle wird der erste SA-Eintrag angezeigt, der der Datei "Test. Sad" für dieses Beispiel hinzugefügt wurde (für Datenverkehr zu Host 2).</span><span class="sxs-lookup"><span data-stu-id="0b258-139">The following table shows the first SA entry added to the Test.sad file for this example (for traffic to Host 2).</span></span>

    | <span data-ttu-id="0b258-140">Trauriger Datei Feldname</span><span class="sxs-lookup"><span data-stu-id="0b258-140">SAD file field name</span></span> | <span data-ttu-id="0b258-141">Beispielwert</span><span class="sxs-lookup"><span data-stu-id="0b258-141">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="0b258-142">**Saentry**</span><span class="sxs-lookup"><span data-stu-id="0b258-142">**SAEntry**</span></span>         | <span data-ttu-id="0b258-143">2</span><span class="sxs-lookup"><span data-stu-id="0b258-143">2</span></span>                          |
    | <span data-ttu-id="0b258-144">**SPI**</span><span class="sxs-lookup"><span data-stu-id="0b258-144">**SPI**</span></span>             | <span data-ttu-id="0b258-145">3001</span><span class="sxs-lookup"><span data-stu-id="0b258-145">3001</span></span>                       |
    | <span data-ttu-id="0b258-146">**Savon paddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-146">**SADestIPAddr**</span></span>    | <span data-ttu-id="0b258-147">**FE80:: 2AA: FF: FE92: D0F1**</span><span class="sxs-lookup"><span data-stu-id="0b258-147">**FE80::2AA:FF:FE92:D0F1**</span></span> |
    | <span data-ttu-id="0b258-148">**"-Paddr"**</span><span class="sxs-lookup"><span data-stu-id="0b258-148">**DestIPAddr**</span></span>      | <span data-ttu-id="0b258-149">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-149">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-150">**Srcipaddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-150">**SrcIPAddr**</span></span>       | <span data-ttu-id="0b258-151">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-151">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-152">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0b258-152">**Protocol**</span></span>        | <span data-ttu-id="0b258-153">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-153">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-154">**DestPort**</span><span class="sxs-lookup"><span data-stu-id="0b258-154">**DestPort**</span></span>        | <span data-ttu-id="0b258-155">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-155">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-156">**Srcport**</span><span class="sxs-lookup"><span data-stu-id="0b258-156">**SrcPort**</span></span>         | <span data-ttu-id="0b258-157">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-157">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-158">**AuthAlg**</span><span class="sxs-lookup"><span data-stu-id="0b258-158">**AuthAlg**</span></span>         | <span data-ttu-id="0b258-159">**HMAC-MD5**</span><span class="sxs-lookup"><span data-stu-id="0b258-159">**HMAC-MD5**</span></span>               |
    | <span data-ttu-id="0b258-160">**KeyFile**</span><span class="sxs-lookup"><span data-stu-id="0b258-160">**KeyFile**</span></span>         | <span data-ttu-id="0b258-161">**Test. Key**</span><span class="sxs-lookup"><span data-stu-id="0b258-161">**Test.key**</span></span>               |
    | <span data-ttu-id="0b258-162">**Richtung**</span><span class="sxs-lookup"><span data-stu-id="0b258-162">**Direction**</span></span>       | <span data-ttu-id="0b258-163">**Ausgehende**</span><span class="sxs-lookup"><span data-stu-id="0b258-163">**OUTBOUND**</span></span>               |
    | <span data-ttu-id="0b258-164">**Secpolicyindex**</span><span class="sxs-lookup"><span data-stu-id="0b258-164">**SecPolicyIndex**</span></span>  | <span data-ttu-id="0b258-165">2</span><span class="sxs-lookup"><span data-stu-id="0b258-165">2</span></span>                          |

    

     

    <span data-ttu-id="0b258-166">Platzieren Sie am Ende der Zeile ein Semikolon, das diese SA konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="0b258-166">Place a semicolon at the end of the line configuring this SA.</span></span>

    <span data-ttu-id="0b258-167">In der folgenden Tabelle wird der zweite SA-Eintrag angezeigt, der der Datei "Test. Sad" für dieses Beispiel hinzugefügt wurde (für Datenverkehr von Host 2).</span><span class="sxs-lookup"><span data-stu-id="0b258-167">The following table shows the second SA entry added to the Test.sad file for this example (for traffic from Host 2).</span></span>

    | <span data-ttu-id="0b258-168">Trauriger Datei Feldname</span><span class="sxs-lookup"><span data-stu-id="0b258-168">SAD file field name</span></span> | <span data-ttu-id="0b258-169">Beispielwert</span><span class="sxs-lookup"><span data-stu-id="0b258-169">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="0b258-170">**Saentry**</span><span class="sxs-lookup"><span data-stu-id="0b258-170">**SAEntry**</span></span>         | <span data-ttu-id="0b258-171">1</span><span class="sxs-lookup"><span data-stu-id="0b258-171">1</span></span>                          |
    | <span data-ttu-id="0b258-172">**SPI**</span><span class="sxs-lookup"><span data-stu-id="0b258-172">**SPI**</span></span>             | <span data-ttu-id="0b258-173">3000</span><span class="sxs-lookup"><span data-stu-id="0b258-173">3000</span></span>                       |
    | <span data-ttu-id="0b258-174">**Savon paddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-174">**SADestIPAddr**</span></span>    | <span data-ttu-id="0b258-175">**FE80:: 2AA: FF: FE53: A92C**</span><span class="sxs-lookup"><span data-stu-id="0b258-175">**FE80::2AA:FF:FE53:A92C**</span></span> |
    | <span data-ttu-id="0b258-176">**"-Paddr"**</span><span class="sxs-lookup"><span data-stu-id="0b258-176">**DestIPAddr**</span></span>      | <span data-ttu-id="0b258-177">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-177">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-178">**Srcipaddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-178">**SrcIPAddr**</span></span>       | <span data-ttu-id="0b258-179">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-179">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-180">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0b258-180">**Protocol**</span></span>        | <span data-ttu-id="0b258-181">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-181">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-182">**DestPort**</span><span class="sxs-lookup"><span data-stu-id="0b258-182">**DestPort**</span></span>        | <span data-ttu-id="0b258-183">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-183">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-184">**Srcport**</span><span class="sxs-lookup"><span data-stu-id="0b258-184">**SrcPort**</span></span>         | <span data-ttu-id="0b258-185">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-185">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-186">**AuthAlg**</span><span class="sxs-lookup"><span data-stu-id="0b258-186">**AuthAlg**</span></span>         | <span data-ttu-id="0b258-187">**HMAC-MD5**</span><span class="sxs-lookup"><span data-stu-id="0b258-187">**HMAC-MD5**</span></span>               |
    | <span data-ttu-id="0b258-188">**KeyFile**</span><span class="sxs-lookup"><span data-stu-id="0b258-188">**KeyFile**</span></span>         | <span data-ttu-id="0b258-189">**Test. Key**</span><span class="sxs-lookup"><span data-stu-id="0b258-189">**Test.key**</span></span>               |
    | <span data-ttu-id="0b258-190">**Richtung**</span><span class="sxs-lookup"><span data-stu-id="0b258-190">**Direction**</span></span>       | <span data-ttu-id="0b258-191">**Einheimische**</span><span class="sxs-lookup"><span data-stu-id="0b258-191">**INBOUND**</span></span>                |
    | <span data-ttu-id="0b258-192">**Secpolicyindex**</span><span class="sxs-lookup"><span data-stu-id="0b258-192">**SecPolicyIndex**</span></span>  | <span data-ttu-id="0b258-193">2</span><span class="sxs-lookup"><span data-stu-id="0b258-193">2</span></span>                          |

    

     

    <span data-ttu-id="0b258-194">Platzieren Sie am Ende der Zeile ein Semikolon, das diese SA konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="0b258-194">Place a semicolon at the end of the line configuring this SA.</span></span> <span data-ttu-id="0b258-195">Die SA-Einträge müssen in absteigender numerischer Reihenfolge abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="0b258-195">The SA entries must be placed in decreasing numerical order.</span></span>

4.  <span data-ttu-id="0b258-196">Erstellen Sie auf Host 1 eine Textdatei, die eine Text Zeichenfolge enthält, die zum Authentifizieren der mit Host 2 erstellten SAS verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="0b258-196">On Host 1, create a text file that contains a text string used to authenticate the SAs created with Host 2.</span></span> <span data-ttu-id="0b258-197">In diesem Beispiel wird die Datei "Test. Key" mit dem Inhalt "This is a Test" erstellt.</span><span class="sxs-lookup"><span data-stu-id="0b258-197">In this example, the file Test.key is created with the contents "This is a test".</span></span> <span data-ttu-id="0b258-198">Sie müssen die Schlüssel Zeichenfolge in doppelte Anführungszeichen einschließen, damit der Schlüssel vom dem ipsec6-Tool gelesen werden konnte.</span><span class="sxs-lookup"><span data-stu-id="0b258-198">You must include double quotes around the key string in order for the key to be read by the ipsec6 tool.</span></span>

    <span data-ttu-id="0b258-199">Die Microsoft IPv6-Technologievorschau unterstützt nur manuell konfigurierte Schlüssel für die Authentifizierung von IPSec-SAS.</span><span class="sxs-lookup"><span data-stu-id="0b258-199">The Microsoft IPv6 Technology Preview only supports manually configured keys for the authentication of IPsec SAs.</span></span> <span data-ttu-id="0b258-200">Die manuellen Schlüssel werden konfiguriert, indem Textdateien erstellt werden, die die Text Zeichenfolge des manuellen Schlüssels enthalten.</span><span class="sxs-lookup"><span data-stu-id="0b258-200">The manual keys are configured by creating text files that contain the text string of the manual key.</span></span> <span data-ttu-id="0b258-201">In diesem Beispiel wird der gleiche Schlüssel für die SAS in beide Richtungen verwendet.</span><span class="sxs-lookup"><span data-stu-id="0b258-201">In this example, the same key for the SAs is used in both directions.</span></span> <span data-ttu-id="0b258-202">Sie können verschiedene Schlüssel für eingehende und ausgehende SAS verwenden, indem Sie unterschiedliche Schlüsseldateien erstellen und mit dem keyfile-Feld in der SAD-Datei auf Sie verweisen.</span><span class="sxs-lookup"><span data-stu-id="0b258-202">You can use different keys for inbound and outbound SAs by creating different key files and referencing them with the KeyFile field in the SAD file.</span></span>

5.  <span data-ttu-id="0b258-203">Erstellen Sie auf Host 2 leere Sicherheits Zuordnungs Dateien (Sad) und Security Policy (SPD) mit dem Befehl dem ipsec6 c.</span><span class="sxs-lookup"><span data-stu-id="0b258-203">On Host 2, create blank security association (SAD) and security policy (SPD) files by using the ipsec6 c command.</span></span> <span data-ttu-id="0b258-204">In diesem Beispiel ist der Befehl Ipsec6.exe dem ipsec6 c Test.</span><span class="sxs-lookup"><span data-stu-id="0b258-204">In this example, the Ipsec6.exe command is ipsec6 c test.</span></span> <span data-ttu-id="0b258-205">Dadurch werden zwei Dateien mit leeren Einträgen zum manuellen Konfigurieren von Sicherheits Zuordnungen (Test. Sad) und Sicherheitsrichtlinien (Test. SPD) erstellt.</span><span class="sxs-lookup"><span data-stu-id="0b258-205">This creates two files with blank entries for manually configuring security associations (Test.sad) and security policies (Test.spd).</span></span>

    <span data-ttu-id="0b258-206">Um das Beispiel zu vereinfachen, werden die gleichen Dateinamen für die Sad-und SPD-Dateien auf Host 2 verwendet.</span><span class="sxs-lookup"><span data-stu-id="0b258-206">To simplify the example, the same file names for the SAD and SPD files are used on Host 2.</span></span> <span data-ttu-id="0b258-207">Sie können auswählen, dass auf jedem Host unterschiedliche Dateinamen verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="0b258-207">You can choose to use different file names on each host.</span></span>

6.  <span data-ttu-id="0b258-208">Bearbeiten Sie auf Host 2 die SPD-Datei, um eine Sicherheitsrichtlinie hinzuzufügen, die den gesamten Datenverkehr zwischen Host 2 und Host 1 sichert.</span><span class="sxs-lookup"><span data-stu-id="0b258-208">On Host 2, edit the SPD file to add a security policy that secures all traffic between Host 2 and Host 1.</span></span>

    <span data-ttu-id="0b258-209">In der folgenden Tabelle wird der Sicherheitsrichtlinien Eintrag angezeigt, der vor dem ersten Eintrag der Datei "Test. SPD" für dieses Beispiel hinzugefügt wurde (der erste Eintrag in der Datei "Test. SPD" wurde nicht geändert).</span><span class="sxs-lookup"><span data-stu-id="0b258-209">The following table shows the security policy entry added before the first entry to the Test.spd file for this example (the first entry in the Test.spd file was not modified).</span></span>

    | <span data-ttu-id="0b258-210">SPD-Datei Feldname</span><span class="sxs-lookup"><span data-stu-id="0b258-210">SPD file field name</span></span> | <span data-ttu-id="0b258-211">Beispielwert</span><span class="sxs-lookup"><span data-stu-id="0b258-211">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="0b258-212">**Richtlinie**</span><span class="sxs-lookup"><span data-stu-id="0b258-212">**Policy**</span></span>          | <span data-ttu-id="0b258-213">2</span><span class="sxs-lookup"><span data-stu-id="0b258-213">2</span></span>                          |
    | <span data-ttu-id="0b258-214">**Remoteipaddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-214">**RemoteIPAddr**</span></span>    | <span data-ttu-id="0b258-215">**FE80:: 2AA: FF: FE53: A92C**</span><span class="sxs-lookup"><span data-stu-id="0b258-215">**FE80::2AA:FF:FE53:A92C**</span></span> |
    | <span data-ttu-id="0b258-216">**Lokalpaddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-216">**LocalIPAddr**</span></span>     | \*                         |
    | <span data-ttu-id="0b258-217">**Remoteport**</span><span class="sxs-lookup"><span data-stu-id="0b258-217">**RemotePort**</span></span>      | \*                         |
    | <span data-ttu-id="0b258-218">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0b258-218">**Protocol**</span></span>        | \*                         |
    | <span data-ttu-id="0b258-219">**LocalPort**</span><span class="sxs-lookup"><span data-stu-id="0b258-219">**LocalPort**</span></span>       | \*                         |
    | <span data-ttu-id="0b258-220">**Ipsecprotocol**</span><span class="sxs-lookup"><span data-stu-id="0b258-220">**IPSecProtocol**</span></span>   | <span data-ttu-id="0b258-221">**Ada**</span><span class="sxs-lookup"><span data-stu-id="0b258-221">**AH**</span></span>                     |
    | <span data-ttu-id="0b258-222">**Ipsecmode**</span><span class="sxs-lookup"><span data-stu-id="0b258-222">**IPSecMode**</span></span>       | <span data-ttu-id="0b258-223">**Personen**</span><span class="sxs-lookup"><span data-stu-id="0b258-223">**TRANSPORT**</span></span>              |
    | <span data-ttu-id="0b258-224">**RemoteGWIPAddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-224">**RemoteGWIPAddr**</span></span>  | \*                         |
    | <span data-ttu-id="0b258-225">**Sabundleindex**</span><span class="sxs-lookup"><span data-stu-id="0b258-225">**SABundleIndex**</span></span>   | <span data-ttu-id="0b258-226">**NONE**</span><span class="sxs-lookup"><span data-stu-id="0b258-226">**NONE**</span></span>                   |
    | <span data-ttu-id="0b258-227">**Richtung**</span><span class="sxs-lookup"><span data-stu-id="0b258-227">**Direction**</span></span>       | <span data-ttu-id="0b258-228">**Bidirect**</span><span class="sxs-lookup"><span data-stu-id="0b258-228">**BIDIRECT**</span></span>               |
    | <span data-ttu-id="0b258-229">**Aktion**</span><span class="sxs-lookup"><span data-stu-id="0b258-229">**Action**</span></span>          | <span data-ttu-id="0b258-230">**Apply**</span><span class="sxs-lookup"><span data-stu-id="0b258-230">**APPLY**</span></span>                  |
    | <span data-ttu-id="0b258-231">**InterfaceIndex**</span><span class="sxs-lookup"><span data-stu-id="0b258-231">**InterfaceIndex**</span></span>  | <span data-ttu-id="0b258-232">0</span><span class="sxs-lookup"><span data-stu-id="0b258-232">0</span></span>                          |

    

     

    <span data-ttu-id="0b258-233">Platzieren Sie am Ende der Zeile ein Semikolon, das diese Sicherheitsrichtlinie konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="0b258-233">Place a semicolon at the end of the line configuring this security policy.</span></span> <span data-ttu-id="0b258-234">Die Richtlinien Einträge müssen in absteigender numerischer Reihenfolge abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="0b258-234">The policy entries must be placed in decreasing numerical order.</span></span>

7.  <span data-ttu-id="0b258-235">Bearbeiten Sie auf Host 2 die traurige Datei, und fügen Sie SA-Einträge hinzu, um den gesamten Datenverkehr zwischen Host 2 und Host 1 zu sichern.</span><span class="sxs-lookup"><span data-stu-id="0b258-235">On Host 2, edit the SAD file, adding SA entries to secure all traffic between Host 2 and Host 1.</span></span> <span data-ttu-id="0b258-236">Es müssen zwei Sicherheits Zuordnungen erstellt werden: eine für den Datenverkehr zu Host 1 und eine für den Datenverkehr von Host 1.</span><span class="sxs-lookup"><span data-stu-id="0b258-236">Two security associations must be created-one for traffic to Host 1 and one for traffic from Host 1.</span></span>

    <span data-ttu-id="0b258-237">In der folgenden Tabelle werden die ersten SA angezeigt, die der Datei "Test. Sad" für dieses Beispiel hinzugefügt wurden (für Datenverkehr von Host 1).</span><span class="sxs-lookup"><span data-stu-id="0b258-237">The following table shows the first SA added to the Test.sad file for this example (for traffic from Host 1).</span></span>

    | <span data-ttu-id="0b258-238">Trauriger Datei Feldname</span><span class="sxs-lookup"><span data-stu-id="0b258-238">SAD file field name</span></span> | <span data-ttu-id="0b258-239">Beispielwert</span><span class="sxs-lookup"><span data-stu-id="0b258-239">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="0b258-240">**Saentry**</span><span class="sxs-lookup"><span data-stu-id="0b258-240">**SAEntry**</span></span>         | <span data-ttu-id="0b258-241">2</span><span class="sxs-lookup"><span data-stu-id="0b258-241">2</span></span>                          |
    | <span data-ttu-id="0b258-242">**SPI**</span><span class="sxs-lookup"><span data-stu-id="0b258-242">**SPI**</span></span>             | <span data-ttu-id="0b258-243">3001</span><span class="sxs-lookup"><span data-stu-id="0b258-243">3001</span></span>                       |
    | <span data-ttu-id="0b258-244">**Savon paddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-244">**SADestIPAddr**</span></span>    | <span data-ttu-id="0b258-245">**FE80:: 2AA: FF: FE92: D0F1**</span><span class="sxs-lookup"><span data-stu-id="0b258-245">**FE80::2AA:FF:FE92:D0F1**</span></span> |
    | <span data-ttu-id="0b258-246">**"-Paddr"**</span><span class="sxs-lookup"><span data-stu-id="0b258-246">**DestIPAddr**</span></span>      | <span data-ttu-id="0b258-247">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-247">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-248">**Srcipaddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-248">**SrcIPAddr**</span></span>       | <span data-ttu-id="0b258-249">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-249">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-250">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0b258-250">**Protocol**</span></span>        | <span data-ttu-id="0b258-251">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-251">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-252">**DestPort**</span><span class="sxs-lookup"><span data-stu-id="0b258-252">**DestPort**</span></span>        | <span data-ttu-id="0b258-253">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-253">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-254">**Srcport**</span><span class="sxs-lookup"><span data-stu-id="0b258-254">**SrcPort**</span></span>         | <span data-ttu-id="0b258-255">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-255">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-256">**AuthAlg**</span><span class="sxs-lookup"><span data-stu-id="0b258-256">**AuthAlg**</span></span>         | <span data-ttu-id="0b258-257">**HMAC-MD5**</span><span class="sxs-lookup"><span data-stu-id="0b258-257">**HMAC-MD5**</span></span>               |
    | <span data-ttu-id="0b258-258">**KeyFile**</span><span class="sxs-lookup"><span data-stu-id="0b258-258">**KeyFile**</span></span>         | <span data-ttu-id="0b258-259">**Test. Key**</span><span class="sxs-lookup"><span data-stu-id="0b258-259">**Test.key**</span></span>               |
    | <span data-ttu-id="0b258-260">**Richtung**</span><span class="sxs-lookup"><span data-stu-id="0b258-260">**Direction**</span></span>       | <span data-ttu-id="0b258-261">**Einheimische**</span><span class="sxs-lookup"><span data-stu-id="0b258-261">**INBOUND**</span></span>                |
    | <span data-ttu-id="0b258-262">**Secpolicyindex**</span><span class="sxs-lookup"><span data-stu-id="0b258-262">**SecPolicyIndex**</span></span>  | <span data-ttu-id="0b258-263">2</span><span class="sxs-lookup"><span data-stu-id="0b258-263">2</span></span>                          |

    

     

    <span data-ttu-id="0b258-264">Platzieren Sie am Ende der Zeile ein Semikolon, das diese SA konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="0b258-264">Place a semicolon at the end of the line configuring this SA.</span></span>

    <span data-ttu-id="0b258-265">In der folgenden Tabelle wird der zweite SA-Eintrag angezeigt, der der Datei "Test. Sad" für dieses Beispiel hinzugefügt wurde (für Datenverkehr zu Host 1).</span><span class="sxs-lookup"><span data-stu-id="0b258-265">The following table shows the second SA entry added to the Test.sad file for this example (for traffic to Host 1).</span></span>

    | <span data-ttu-id="0b258-266">Trauriger Datei Feldname</span><span class="sxs-lookup"><span data-stu-id="0b258-266">SAD file field name</span></span> | <span data-ttu-id="0b258-267">Beispielwert</span><span class="sxs-lookup"><span data-stu-id="0b258-267">Example value</span></span>              |
    |---------------------|----------------------------|
    | <span data-ttu-id="0b258-268">**Saentry**</span><span class="sxs-lookup"><span data-stu-id="0b258-268">**SAEntry**</span></span>         | <span data-ttu-id="0b258-269">1</span><span class="sxs-lookup"><span data-stu-id="0b258-269">1</span></span>                          |
    | <span data-ttu-id="0b258-270">**SPI**</span><span class="sxs-lookup"><span data-stu-id="0b258-270">**SPI**</span></span>             | <span data-ttu-id="0b258-271">3000</span><span class="sxs-lookup"><span data-stu-id="0b258-271">3000</span></span>                       |
    | <span data-ttu-id="0b258-272">**Savon paddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-272">**SADestIPAddr**</span></span>    | <span data-ttu-id="0b258-273">**FE80:: 2AA: FF: FE53: A92C**</span><span class="sxs-lookup"><span data-stu-id="0b258-273">**FE80::2AA:FF:FE53:A92C**</span></span> |
    | <span data-ttu-id="0b258-274">**"-Paddr"**</span><span class="sxs-lookup"><span data-stu-id="0b258-274">**DestIPAddr**</span></span>      | <span data-ttu-id="0b258-275">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-275">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-276">**Srcipaddr**</span><span class="sxs-lookup"><span data-stu-id="0b258-276">**SrcIPAddr**</span></span>       | <span data-ttu-id="0b258-277">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-277">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-278">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0b258-278">**Protocol**</span></span>        | <span data-ttu-id="0b258-279">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-279">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-280">**DestPort**</span><span class="sxs-lookup"><span data-stu-id="0b258-280">**DestPort**</span></span>        | <span data-ttu-id="0b258-281">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-281">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-282">**Srcport**</span><span class="sxs-lookup"><span data-stu-id="0b258-282">**SrcPort**</span></span>         | <span data-ttu-id="0b258-283">**RICHTLINIE**</span><span class="sxs-lookup"><span data-stu-id="0b258-283">**POLICY**</span></span>                 |
    | <span data-ttu-id="0b258-284">**AuthAlg**</span><span class="sxs-lookup"><span data-stu-id="0b258-284">**AuthAlg**</span></span>         | <span data-ttu-id="0b258-285">**HMAC-MD5**</span><span class="sxs-lookup"><span data-stu-id="0b258-285">**HMAC-MD5**</span></span>               |
    | <span data-ttu-id="0b258-286">**KeyFile**</span><span class="sxs-lookup"><span data-stu-id="0b258-286">**KeyFile**</span></span>         | <span data-ttu-id="0b258-287">**Test. Key**</span><span class="sxs-lookup"><span data-stu-id="0b258-287">**Test.key**</span></span>               |
    | <span data-ttu-id="0b258-288">**Richtung**</span><span class="sxs-lookup"><span data-stu-id="0b258-288">**Direction**</span></span>       | <span data-ttu-id="0b258-289">**Ausgehende**</span><span class="sxs-lookup"><span data-stu-id="0b258-289">**OUTBOUND**</span></span>               |
    | <span data-ttu-id="0b258-290">**Secpolicyindex**</span><span class="sxs-lookup"><span data-stu-id="0b258-290">**SecPolicyIndex**</span></span>  | <span data-ttu-id="0b258-291">2</span><span class="sxs-lookup"><span data-stu-id="0b258-291">2</span></span>                          |

    

     

    <span data-ttu-id="0b258-292">Platzieren Sie am Ende der Zeile ein Semikolon, das diese SA konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="0b258-292">Place a semicolon at the end of the line configuring this SA.</span></span> <span data-ttu-id="0b258-293">Die SA-Einträge müssen in absteigender numerischer Reihenfolge abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="0b258-293">The SA entries must be placed in decreasing numerical order.</span></span>

8.  <span data-ttu-id="0b258-294">Erstellen Sie auf Host 2 eine Textdatei, die eine Text Zeichenfolge enthält, die zum Authentifizieren der mit Host 1 erstellten SAS verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="0b258-294">On Host 2, create a text file that contains a text string used to authenticate the SAs created with Host 1.</span></span> <span data-ttu-id="0b258-295">In diesem Beispiel wird die Datei "Test. Key" mit dem Inhalt "This is a Test" erstellt.</span><span class="sxs-lookup"><span data-stu-id="0b258-295">In this example, the file Test.key is created with the contents "This is a test".</span></span> <span data-ttu-id="0b258-296">Sie müssen die Schlüssel Zeichenfolge in doppelte Anführungszeichen einschließen, damit der Schlüssel vom dem ipsec6-Tool gelesen werden konnte.</span><span class="sxs-lookup"><span data-stu-id="0b258-296">You must include double quotes around the key string in order for the key to be read by the ipsec6 tool.</span></span>
9.  <span data-ttu-id="0b258-297">Fügen Sie auf Host 1 mithilfe des Befehls "dem ipsec6 a" die konfigurierten Sicherheitsrichtlinien und SAS aus den SPD-und Sad-Dateien hinzu.</span><span class="sxs-lookup"><span data-stu-id="0b258-297">On Host 1, add the configured security policies and SAs from the SPD and SAD files using the ipsec6 a command.</span></span> <span data-ttu-id="0b258-298">In diesem Beispiel wird der Befehl dem ipsec6 a Test auf Host 1 ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="0b258-298">In this example, the ipsec6 a test command is run on Host 1.</span></span>
10. <span data-ttu-id="0b258-299">Fügen Sie auf Host 2 die konfigurierten Sicherheitsrichtlinien und die SAS aus den SPD-und Sad-Dateien hinzu, indem Sie den dem ipsec6 a-Befehl verwenden.</span><span class="sxs-lookup"><span data-stu-id="0b258-299">On Host 2, add the configured security policies and SAs from the SPD and SAD files by using the ipsec6 a command.</span></span> <span data-ttu-id="0b258-300">In diesem Beispiel wird der Befehl dem ipsec6 a Test auf Host 2 ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="0b258-300">In this example, the ipsec6 a test command is run on Host 2.</span></span>
11. <span data-ttu-id="0b258-301">Ping Host 1 von Host 2 mit dem ping6-Befehl.</span><span class="sxs-lookup"><span data-stu-id="0b258-301">Ping Host 1 from Host 2 with the ping6 command.</span></span>

    <span data-ttu-id="0b258-302">Wenn Sie den Datenverkehr mit Microsoft-Netzwerkmonitor oder einem anderen Paketsniffer erfassen, sollte der Austausch der ICMPv6-Echo Anforderungs-und Echo Antwort Nachrichten mit einem Authentifizierungs Header zwischen dem IPv6-Header und dem ICMPv6-Header angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="0b258-302">If you capture the traffic using Microsoft Network Monitor or another packet sniffer, you should see the exchange of ICMPv6 Echo Request and Echo Reply messages with an Authentication Header between the IPv6 header and the ICMPv6 header.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0b258-303">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="0b258-303">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0b258-304">Empfohlene Konfigurationen für IPv6</span><span class="sxs-lookup"><span data-stu-id="0b258-304">Recommended Configurations for IPv6</span></span>](recommended-configurations-2.md)
</dt> <dt>

[<span data-ttu-id="0b258-305">Einzelnes Subnetz mit Link-Local-Adressen</span><span class="sxs-lookup"><span data-stu-id="0b258-305">Single subnet with link-local addresses</span></span>](configuration-1-single-subnet-with-link-local-addresses-2.md)
</dt> <dt>

[<span data-ttu-id="0b258-306">IPv6-Datenverkehr zwischen Knoten in unterschiedlichen Subnetzen eines IPv4-Netzwerks (IPv6-zu-IPv4)</span><span class="sxs-lookup"><span data-stu-id="0b258-306">IPv6 traffic between nodes on different subnets of an IPv4 internetwork (6to4)</span></span>](configuration-2-ipv6-traffic-between-nodes-on-different-subnets-of-an-ipv4-internetwork-6to4--2.md)
</dt> </dl>

 

 



