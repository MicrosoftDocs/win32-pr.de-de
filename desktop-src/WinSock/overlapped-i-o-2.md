---
description: Windows Sockets 2 stellt überlappende e/a vor und erfordert, dass alle Transportanbieter diese Funktion unterstützen.
ms.assetid: 90d49171-e211-4426-aa56-88aaeac7c578
title: Überlappende Eingabe/Ausgabe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d8caa13dd3d50e4f0fdaa1b92fa8e99afd8e2e1
ms.sourcegitcommit: 3d9dce1bd6c84e2b51759e940aa95aa9b459cd20
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/04/2021
ms.locfileid: "103869620"
---
# <a name="overlapped-inputoutput"></a><span data-ttu-id="97950-103">Überlappende Eingabe/Ausgabe</span><span class="sxs-lookup"><span data-stu-id="97950-103">Overlapped Input/Output</span></span>

<span data-ttu-id="97950-104">Windows Sockets 2 stellt überlappende e/a vor und erfordert, dass alle Transportanbieter diese Funktion unterstützen.</span><span class="sxs-lookup"><span data-stu-id="97950-104">Windows Sockets 2 introduces overlapped I/O and requires that all transport providers support this capability.</span></span> <span data-ttu-id="97950-105">Überlappende e/a-Vorgänge können nur für Sockets ausgeführt werden, die über die [**wspsocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) -Funktion mit dem überlappenden Flag für das WSA \_ -Flag erstellt wurden \_ , und folgen dem in Windows eingerichteten Modell.</span><span class="sxs-lookup"><span data-stu-id="97950-105">Overlapped I/O can be performed only on sockets that were created through the [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) function with the WSA\_FLAG\_OVERLAPPED flag set, and follow the model established in Windows.</span></span>

<span data-ttu-id="97950-106">Zum empfangen verwendet ein Client [**wsprecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) oder [**wsprecvfrom**](/previous-versions/windows/desktop/legacy/ms742287(v=vs.85)) , um Puffer anzugeben, in die Daten empfangen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="97950-106">For receiving, a client uses [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) or [**WSPRecvFrom**](/previous-versions/windows/desktop/legacy/ms742287(v=vs.85)) to supply buffers into which data is to be received.</span></span> <span data-ttu-id="97950-107">Wenn ein oder mehrere Puffer vor dem Zeitpunkt gepostet werden, zu dem Daten vom Netzwerk empfangen wurden, ist es möglich, dass die Daten sofort in die Puffer des Benutzers eingefügt werden, sobald sie eintreffen, und so den Kopiervorgang vermeiden, der andernfalls stattfinden würde.</span><span class="sxs-lookup"><span data-stu-id="97950-107">If one or more buffers are posted prior to the time when data has been received by the network, it is possible that data will be placed into the user's buffers immediately as it arrives and thereby avoid the copy operation that would otherwise occur.</span></span> <span data-ttu-id="97950-108">Wenn Daten empfangen werden, wenn Empfangs Puffer bereits gepostet wurden, werden Sie sofort in die Puffer des Benutzers kopiert.</span><span class="sxs-lookup"><span data-stu-id="97950-108">If data arrives when receive buffers have already been posted, it is copied immediately into the user's buffers.</span></span> <span data-ttu-id="97950-109">Wenn die Daten empfangen werden, wenn von der Anwendung keine Empfangs Puffer gepostet wurden, greift der Dienstanbieter auf den synchronen Vorgangs Stil zu, bei dem die eingehenden Daten intern gepuffert werden, bis der Client einen Empfangs Aufruf ausgibt und damit einen Puffer bereitstellt, in den die Daten kopiert werden können.</span><span class="sxs-lookup"><span data-stu-id="97950-109">If data arrives when no receive buffers have been posted by the application, the service provider resorts to the synchronous style of operation where the incoming data is buffered internally until such time as the client issues a receive call and thereby supplies a buffer into which the data may be copied.</span></span> <span data-ttu-id="97950-110">Eine Ausnahme besteht darin, dass die Anwendung [**wspsetsockopt**](/previous-versions/windows/hardware/network/ff566318(v=vs.85)) verwendet, um die Größe des Empfangspuffers auf NULL festzulegen.</span><span class="sxs-lookup"><span data-stu-id="97950-110">An exception to this would be if the application used [**WSPSetSockOpt**](/previous-versions/windows/hardware/network/ff566318(v=vs.85)) to set the size of the receive buffer to zero.</span></span> <span data-ttu-id="97950-111">In dieser Instanz können zuverlässige Protokolle nur Daten empfangen, wenn Anwendungs Puffer gepostet wurden, und Daten über unzuverlässige Protokolle würden verloren gehen.</span><span class="sxs-lookup"><span data-stu-id="97950-111">In this instance, reliable protocols would only allow data to be received when application buffers had been posted, and data on unreliable protocols would be lost.</span></span>

<span data-ttu-id="97950-112">Auf der sendenden Seite stellen Clients mithilfe von [**wspsend**](/previous-versions/windows/hardware/network/ff566316(v=vs.85)) oder [**wspsendto**](/previous-versions/windows/desktop/legacy/ms742291(v=vs.85)) Zeiger auf gefüllte Puffer bereit und stimmen dann zu, dass die Puffer erst dann gestört werden, wenn das Netzwerk den Pufferinhalt genutzt hat.</span><span class="sxs-lookup"><span data-stu-id="97950-112">On the sending side, clients use [**WSPSend**](/previous-versions/windows/hardware/network/ff566316(v=vs.85)) or [**WSPSendTo**](/previous-versions/windows/desktop/legacy/ms742291(v=vs.85)) to supply pointers to filled buffers and then agree not to disturb the buffers in any way until the network has consumed the buffer's contents.</span></span>

<span data-ttu-id="97950-113">Überlappende Sende-und Empfangs Aufrufe werden sofort zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="97950-113">Overlapped send and receive calls return immediately.</span></span> <span data-ttu-id="97950-114">Der Rückgabewert 0 (null) gibt an, dass der e/a-Vorgang sofort abgeschlossen wurde und dass die entsprechende Vervollständigungs Angabe bereits erfolgt ist.</span><span class="sxs-lookup"><span data-stu-id="97950-114">A return value of zero indicates that the I/O operation completed immediately and that the corresponding completion indication has already occurred.</span></span> <span data-ttu-id="97950-115">Das heißt, das zugeordnete Ereignis Objekt wurde signalisiert, oder die Abschluss Routine wurde über [**wpuqueueapc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc)in die Warteschlange eingereiht.</span><span class="sxs-lookup"><span data-stu-id="97950-115">That is, the associated event object has been signaled, or the completion routine has been queued through [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span></span> <span data-ttu-id="97950-116">Der Rückgabewert \_ Socketfehler gekoppelt mit dem Fehlercode WSA e/A \_ \_ steht aus, dass der überlappende Vorgang erfolgreich initiiert wurde und dass ein weiterer Hinweis bereitgestellt wird, wenn Sendepuffer verarbeitet wurden oder Empfangs Puffer ausgefüllt werden.</span><span class="sxs-lookup"><span data-stu-id="97950-116">A return value of SOCKET\_ERROR coupled with an error code of WSA\_IO\_PENDING indicates that the overlapped operation has been successfully initiated and that a subsequent indication will be provided when send buffers have been consumed or when receive buffers are filled.</span></span> <span data-ttu-id="97950-117">Jeder andere Fehlercode gibt an, dass der überlappende Vorgang nicht erfolgreich initiiert wurde und keine Vervollständigungs Angabe erfolgt.</span><span class="sxs-lookup"><span data-stu-id="97950-117">Any other error code indicates that the overlapped operation was not successfully initiated and that no completion indication will be forthcoming.</span></span>

<span data-ttu-id="97950-118">Sende-und Empfangs Vorgänge können überlappen.</span><span class="sxs-lookup"><span data-stu-id="97950-118">Both send and receive operations can be overlapped.</span></span> <span data-ttu-id="97950-119">Die Empfangsfunktionen können mehrmals aufgerufen werden, um Empfangs Puffer in Vorbereitung auf eingehende Daten zu senden, und die Sende Funktionen können mehrmals aufgerufen werden, um mehrere zu sendende Puffer in die Warteschlange zu stellen.</span><span class="sxs-lookup"><span data-stu-id="97950-119">The receive functions may be invoked multiple times to post receive buffers in preparation for incoming data, and the send functions may be invoked multiple times to queue up multiple buffers to be sent.</span></span> <span data-ttu-id="97950-120">Beachten Sie Folgendes: während eine Reihe von überlappenden Sende Puffern in der angegebenen Reihenfolge gesendet wird, können die entsprechenden Vervollständigungs Hinweise in einer anderen Reihenfolge auftreten.</span><span class="sxs-lookup"><span data-stu-id="97950-120">Note that while a series of overlapped send buffers will be sent in the order supplied, the corresponding completion indications may occur in a different order.</span></span> <span data-ttu-id="97950-121">Ebenso werden Puffer auf der Empfangsseite in der Reihenfolge aufgefüllt, in der Sie bereitgestellt werden, aber Vervollständigungs Hinweise können in einer anderen Reihenfolge auftreten.</span><span class="sxs-lookup"><span data-stu-id="97950-121">Likewise, on the receiving side, buffers will be filled in the order they are supplied, but completion indications may occur in a different order.</span></span>

<span data-ttu-id="97950-122">Die verzögerte Vervollständigungsfunktion der überlappenden e/a ist auch für [**wspioctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))verfügbar.</span><span class="sxs-lookup"><span data-stu-id="97950-122">The deferred completion feature of overlapped I/O is also available for [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)).</span></span>

## <a name="delivering-completion-indications"></a><span data-ttu-id="97950-123">Bereitstellung von Abschluss hinweisen</span><span class="sxs-lookup"><span data-stu-id="97950-123">Delivering Completion Indications</span></span>

<span data-ttu-id="97950-124">Dienstanbieter haben zwei Möglichkeiten, den überlappenden Abschluss anzugeben: das Festlegen eines vom Client angegebenen Ereignis Objekts oder das Aufrufen einer vom Client angegebenen Vervollständigungs Routine.</span><span class="sxs-lookup"><span data-stu-id="97950-124">Service providers have two ways to indicate overlapped completion: setting a client-specified event object, or invoking a client-specified completion routine.</span></span> <span data-ttu-id="97950-125">In beiden Fällen wird eine Datenstruktur ( [**wsaoverllapp**](/windows/desktop/api/Winsock2/ns-winsock2-wsaoverlapped)) jedem überlappenden Vorgang zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="97950-125">In both cases a data structure, [**WSAOVERLAPPED**](/windows/desktop/api/Winsock2/ns-winsock2-wsaoverlapped), is associated with each overlapped operation.</span></span> <span data-ttu-id="97950-126">Diese Struktur wird vom Client zugeordnet und verwendet, um anzugeben, welches Ereignis Objekt (sofern vorhanden) festgelegt werden soll, wenn der Vorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="97950-126">This structure is allocated by the client and used by it to indicate which event object (if any) is to be set when completion occurs.</span></span> <span data-ttu-id="97950-127">Die **wsaoverllapp** -Struktur kann vom Dienstanbieter als Speicherort zum Speichern eines Handles für die Ergebnisse (z. b. Anzahl der übertragenen Bytes, aktualisierte Flags, Fehlercodes usw.) für einen bestimmten überlappenden Vorgang verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="97950-127">The **WSAOVERLAPPED** structure may be used by the service provider as a place to store a handle to the results (for example, number of bytes transferred, updated flags, error codes, etc.) for a particular overlapped operation.</span></span> <span data-ttu-id="97950-128">Zum Abrufen dieser Ergebnisse müssen die Clients [**wspgefliverlappedresult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult)aufrufen und einen Zeiger auf die entsprechende überlappende Struktur übergeben.</span><span class="sxs-lookup"><span data-stu-id="97950-128">To obtain these results clients must invoke [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult), passing in a pointer to the corresponding overlapped structure.</span></span>

<span data-ttu-id="97950-129">Wenn für eine bestimmte überlappende e/a-Anforderung eine ereignisbasierte Vervollständigungs Anzeige ausgewählt ist, kann die [**wspgetoverlappedresult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult) -Routine von Clients verwendet werden, um die Ausführung des überlappenden Vorgangs abzufragen oder zu warten.</span><span class="sxs-lookup"><span data-stu-id="97950-129">If event based completion indication is selected for a particular overlapped I/O request, the [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult) routine may itself be used by clients to either poll or wait for completion of the overlapped operation.</span></span> <span data-ttu-id="97950-130">Wenn für eine bestimmte überlappende e/a-Anforderung ein Vervollständigungs Hinweis auf Vervollständigungs Routine ausgewählt ist, ist nur die Abruf Option von **wspgetoverlappedresult** verfügbar.</span><span class="sxs-lookup"><span data-stu-id="97950-130">If completion-routine-based completion indication is selected for a particular overlapped I/O request, only the polling option of **WSPGetOverlappedResult** is available.</span></span> <span data-ttu-id="97950-131">Ein Client kann auch andere Mittel für den warte Vorgang verwenden (z. b. die Verwendung von [**wsawaitformultipleevents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents)), bis das entsprechende Ereignis Objekt signalisiert wurde oder die angegebene Abschluss Routine vom Dienstanbieter aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="97950-131">A client may also use other means to wait (such as using [**WSAWaitForMultipleEvents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents)) until the corresponding event object has been signaled or the specified completion routine has been invoked by the service provider.</span></span> <span data-ttu-id="97950-132">Nachdem der Abschluss angegeben wurde, ruft der Client möglicherweise **wspgegetverlappedresult** auf, und es wird davon ausgegangen, dass der Aufruf sofort abgeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="97950-132">Once completion has been indicated, the client may invoke **WSPGetOverlappedResult**, with the expectation that the call will complete immediately.</span></span>

## <a name="invoking-socket-io-completion-routines"></a><span data-ttu-id="97950-133">Aufrufen von Socket-e/a-Abschluss Routinen</span><span class="sxs-lookup"><span data-stu-id="97950-133">Invoking Socket I/O Completion Routines</span></span>

<span data-ttu-id="97950-134">Wenn der *lpCompletionRoutine* -Parameter für einen überlappenden Vorgang nicht **null** ist, liegt es in der Verantwortung des Dienstanbieters, den Aufruf der vom Client angegebenen Vervollständigungs Routine zu ordnen, wenn der überlappende Vorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="97950-134">If the *lpCompletionRoutine* parameter to an overlapped operation is not **NULL**, it is the service provider's responsibility to arrange for invocation of the client-specified completion routine when the overlapped operation completes.</span></span> <span data-ttu-id="97950-135">Da die Vervollständigungs Routine im Kontext desselben Threads ausgeführt werden muss, der den überlappenden Vorgang initiiert hat, kann Sie nicht direkt vom Dienstanbieter aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="97950-135">Since the completion routine must be executed in the context of the same thread that initiated the overlapped operation, it cannot be invoked directly from the service provider.</span></span> <span data-ttu-id="97950-136">Der Ws2- \_32.DLL bietet einen asynchronen Prozedur Aufruf (APC)-Mechanismus, um den Aufruf von Vervollständigungs Routinen zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="97950-136">The Ws2\_32.DLL offers an asynchronous procedure call (APC) mechanism to facilitate invocation of completion routines.</span></span>

<span data-ttu-id="97950-137">Ein Dienstanbieter ordnet an, dass eine Funktion im richtigen Thread durch Aufrufen von [**wpuqueueapc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc)ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="97950-137">A service provider arranges for a function to be executed in the proper thread by calling [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span></span> <span data-ttu-id="97950-138">Diese Funktion kann von jedem Prozess-und Thread Kontext aus aufgerufen werden. Dies gilt auch für einen anderen Kontext als den Thread und den Prozess, der zum Initiieren des überlappenden Vorgangs verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="97950-138">This function can be called from any process and thread context, even a context different from the thread and process that was used to initiate the overlapped operation.</span></span>

<span data-ttu-id="97950-139">[**Wpuqueueapc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) übernimmt als Eingabeparameter einen Zeiger auf eine [**wsathreadid**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) -Struktur, einen Zeiger auf eine APC-Funktion, die aufgerufen werden soll, und einen 32-Bit-Kontextwert, der anschließend an die APC-Funktion weitergeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="97950-139">[**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) takes as input parameters a pointer to a [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) structure, a pointer to an APC function to be invoked, and a 32-bit context value that is subsequently passed to the APC function.</span></span> <span data-ttu-id="97950-140">Dienstanbieter werden stets mit einem Zeiger auf die richtige **wsathreadid** -Struktur über den *lpthreadid* -Parameter für die überlappende Funktion bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="97950-140">Service providers are always supplied with a pointer to the proper **WSATHREADID** structure through the *lpThreadId* parameter to the overlapped function.</span></span> <span data-ttu-id="97950-141">Der Anbieter sollte die **wsathreadid** -Struktur lokal speichern und einen Zeiger auf diese Kopie der **wsathreadid** -Struktur als Eingabeparameter für **wpuqueueapc** bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="97950-141">The provider should store the **WSATHREADID** structure locally and supply a pointer to this copy of the **WSATHREADID** structure as an input parameter to **WPUQueueApc**.</span></span> <span data-ttu-id="97950-142">Nachdem die **wpuqueueapc** -Funktion zurückgegeben wurde, kann der Anbieter seine Kopie von **wsathreadid** verwerfen.</span><span class="sxs-lookup"><span data-stu-id="97950-142">Once the **WPUQueueApc** function returns, the provider can dispose of its copy of the **WSATHREADID**.</span></span>

<span data-ttu-id="97950-143">Die Prozedur [**wpuqueueapc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) stellt einfach genügend Informationen in die Warteschlange, um die angegebene APC-Funktion mit den angegebenen Parametern aufzurufen, aber Sie wird nicht aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="97950-143">The procedure [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) simply enqueues sufficient information to call the indicated APC function with the given parameters, but does not call it.</span></span> <span data-ttu-id="97950-144">Wenn der Zielthread in den Wartezustand einer Warn Tabelle wechselt, werden diese Informationen aus der Warteschlange entfernt, und die APC-Funktion wird in diesem Zielthread und Prozess Kontext aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="97950-144">When the target thread enters an alertable wait state, this information is dequeued and a call is made to the APC function in that target thread and process context.</span></span> <span data-ttu-id="97950-145">Da der APC-Mechanismus nur einen einzelnen 32-Bit-Kontextwert unterstützt, kann die APC-Funktion nicht selbst die vom Client angegebene Vervollständigungs Routine sein, die mehr Parameter umfasst.</span><span class="sxs-lookup"><span data-stu-id="97950-145">Because the APC mechanism supports only a single 32-bit context value, the APC function cannot itself be the client-specified completion routine, which involves more parameters.</span></span> <span data-ttu-id="97950-146">Der Dienstanbieter muss stattdessen einen Zeiger auf seine eigene APC-Funktion bereitstellen, die den angegebenen Kontextwert verwendet, um auf die erforderlichen Ergebnisinformationen für den überlappenden Vorgang zuzugreifen, und dann die vom Client angegebene Vervollständigungs Routine aufruft.</span><span class="sxs-lookup"><span data-stu-id="97950-146">The service provider must instead supply a pointer to its own APC function which uses the supplied context value to access the needed result information for the overlapped operation, and then invokes the client-specified completion routine.</span></span>

<span data-ttu-id="97950-147">Für Dienstanbieter, bei denen eine Benutzermoduskomponente überlappende e/a implementiert, ist eine typische Verwendung des APC-Mechanismus wie folgt:</span><span class="sxs-lookup"><span data-stu-id="97950-147">For service providers where a user-mode component implements overlapped I/O, a typical usage of the APC mechanism is as follows:</span></span>

-   <span data-ttu-id="97950-148">Wenn der e/a-Vorgang abgeschlossen ist, ordnet der Anbieter einen kleinen Puffer zu und packt ihn mit einem Zeiger auf die vom Client bereitgestellte Vervollständigungs Prozedur und Parameterwerte, die an die Prozedur übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="97950-148">When the I/O operation completes, the provider allocates a small buffer and packs it with a pointer to the client-supplied completion procedure and parameter values to pass to the procedure.</span></span>
-   <span data-ttu-id="97950-149">Ein APC wird in die Warteschlange eingereiht, wobei der Zeiger auf den Puffer als Kontextwert und seine eigene zwischen Prozedur als Ziel Prozedur angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="97950-149">It queues an APC, specifying the pointer to the buffer as the context value and its own intermediate procedure as the target procedure.</span></span>
-   <span data-ttu-id="97950-150">Wenn der Ziel Thread schließlich in den Wartezustand der Warn Tabelle wechselt, wird die zwischen Prozedur des Dienstanbieters im richtigen Thread Kontext aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="97950-150">When the target thread eventually enters alertable wait state, the service provider's intermediate procedure is called in the proper thread context.</span></span>
-   <span data-ttu-id="97950-151">Die zwischen Prozedur entpackt einfach Parameter, hebt die Zuordnung des Puffers auf und ruft die vom Client bereitgestellte Abschluss Prozedur auf.</span><span class="sxs-lookup"><span data-stu-id="97950-151">The intermediate procedure simply unpacks parameters, deallocates the buffer, and calls the client-supplied completion procedure.</span></span>
-   <span data-ttu-id="97950-152">Für Dienstanbieter, bei denen eine Kernelmoduskomponente überlappende e/a-Vorgänge implementiert, ist eine typische-Implementierung ähnlich, außer dass die-Implementierung standardmäßige Kernel Schnittstellen verwendet, um das APC in die Warteschlange zu stellen.</span><span class="sxs-lookup"><span data-stu-id="97950-152">For service providers where a kernel-mode component implements overlapped I/O, a typical implementation is similar, except that the implementation would use standard kernel interfaces to enqueue the APC.</span></span>

<span data-ttu-id="97950-153">Die Beschreibung der relevanten Kernel Schnittstellen liegt außerhalb des Bereichs der Windows Sockets 2-Spezifikation.</span><span class="sxs-lookup"><span data-stu-id="97950-153">Description of the relevant kernel interfaces is outside the scope of the Windows Sockets 2 specification.</span></span>

> [!Note]  
> <span data-ttu-id="97950-154">Dienstanbieter müssen zulassen, dass Windows Sockets 2-Clients Sende-und Empfangs Vorgänge aus dem Kontext der Socket-e/a-Abschluss Routine aufrufen und sicherstellen, dass die e/a-Abschluss Routinen für einen bestimmten Socket nicht geschachtelt werden.</span><span class="sxs-lookup"><span data-stu-id="97950-154">Service providers must allow Windows Sockets 2 clients to invoke send and receive operations from within the context of the socket I/O completion routine and guarantee that for a given socket, I/O completion routines will not be nested.</span></span>

 

<span data-ttu-id="97950-155">Unter bestimmten Umständen muss ein geschichteter Dienstanbieter möglicherweise überlappende Vorgänge innerhalb eines internen Arbeits Threads initiieren und vervollständigen.</span><span class="sxs-lookup"><span data-stu-id="97950-155">Under some circumstances, a layered service provider may need to initiate and complete overlapped operations from within an internal worker thread.</span></span> <span data-ttu-id="97950-156">In diesem Fall wäre eine [**wsathreadid**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) nicht in einem eingehenden Funktions aufrufsbefehl verfügbar.</span><span class="sxs-lookup"><span data-stu-id="97950-156">In this case, a [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) would not be available from an incoming function call.</span></span> <span data-ttu-id="97950-157">Die Dienstanbieter Schnittstelle stellt einen [**upcallwpuopencurrentthread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuopencurrentthread)bereit, um eine **wsathreadid** für den aktuellen Thread zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="97950-157">The service provider interface provides an upcall, [**WPUOpenCurrentThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuopencurrentthread), to obtain a **WSATHREADID** for the current thread.</span></span> <span data-ttu-id="97950-158">Wenn diese **wsathreadid** nicht mehr benötigt wird, sollten ihre Ressourcen durch Aufrufen von [**wpuclosethread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuclosethread)zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="97950-158">When this **WSATHREADID** is no longer needed, its resources should be returned by calling [**WPUCloseThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuclosethread).</span></span>

 

 
