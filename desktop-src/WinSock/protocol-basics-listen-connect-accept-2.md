---
description: Protokoll Grundlagen von wsplauschen, wspaccept und wspconnect zum Einrichten einer Socketverbindung mit Windows Sockets (Winsock).
ms.assetid: b1b4d6b9-36db-4000-9c6b-662765b6d091
title: 'Grundlagen des Protokolls: lauschen, verbinden, annehmen'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d62ef290d71e571154b4d022c24c7e21f8fffa1c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104129133"
---
# <a name="protocol-basics-listen-connect-accept"></a><span data-ttu-id="f40f2-103">Grundlagen des Protokolls: lauschen, verbinden, annehmen</span><span class="sxs-lookup"><span data-stu-id="f40f2-103">Protocol Basics: Listen, Connect, Accept</span></span>

<span data-ttu-id="f40f2-104">Die grundlegenden Vorgänge, die beim Einrichten einer Socketverbindung beteiligt sind, können am häufigsten in Bezug auf das Client-Server-Paradigma erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="f40f2-104">The basic operations involved with establishing a socket connection can be most conveniently explained in terms of the client-server paradigm.</span></span>

<span data-ttu-id="f40f2-105">Die Serverseite erstellt zunächst einen Socket, bindet Sie an eine bekannte lokale Adresse (sodass der Client Sie finden kann) und versetzt den Socket in den Empfangsmodus, über [**wsplauschen**](/previous-versions/windows/hardware/network/ff566297(v=vs.85)), um alle eingehenden Verbindungsanforderungen vorzubereiten und die Länge der Warteschlange für den Verbindungs Rückstand anzugeben.</span><span class="sxs-lookup"><span data-stu-id="f40f2-105">The server side will first create a socket, bind it to a well known local address (so that the client can find it), and put the socket in listening mode, through [**WSPListen**](/previous-versions/windows/hardware/network/ff566297(v=vs.85)), in order to prepare for any incoming connection requests and to specify the length of the connection backlog queue.</span></span> <span data-ttu-id="f40f2-106">Dienstanbieter halten ausstehende Verbindungsanforderungen in einer backwarewarteschlange, bis Sie vom Server bearbeitet oder (aufgrund eines Timeouts) vom Client abgezogen werden.</span><span class="sxs-lookup"><span data-stu-id="f40f2-106">Service providers hold pending connection requests in a backlog queue until they are acted upon by the server or are withdrawn (due to a time-out) by the client.</span></span> <span data-ttu-id="f40f2-107">Ein Dienstanbieter kann Anforderungen im Hintergrund ignorieren, um die Größe der Rückstands Warteschlange über eine vom Anbieter definierte Obergrenze hinaus zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="f40f2-107">A service provider may silently ignore requests to extend the size of the backlog queue beyond a provider-defined upper limit.</span></span>

<span data-ttu-id="f40f2-108">An diesem Punkt kann die Serverseite, wenn ein blockierender Socket verwendet wird, sofort [**wspaccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept) aufruft, der blockiert wird, bis eine Verbindungsanforderung aussteht.</span><span class="sxs-lookup"><span data-stu-id="f40f2-108">At this point, if a blocking socket is being used, the server side may immediately call [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept) which will block until a connection request is pending.</span></span> <span data-ttu-id="f40f2-109">Umgekehrt kann der Server auch einen der zuvor beschriebenen Mechanismen zur Netzwerk Ereignisanzeige verwenden, um Benachrichtigungen über eingehende Verbindungsanforderungen anzuordnen.</span><span class="sxs-lookup"><span data-stu-id="f40f2-109">Conversely, the server may also use one of the network event indication mechanisms discussed previously to arrange for notification of incoming connection requests.</span></span> <span data-ttu-id="f40f2-110">Je nach ausgewähltem Benachrichtigungs Mechanismus gibt der Anbieter entweder eine Windows-Meldung aus oder signalisiert ein Ereignis Objekt, wenn Verbindungsanforderungen eintreffen.</span><span class="sxs-lookup"><span data-stu-id="f40f2-110">Depending on the notification mechanism selected, the provider will either issue a Windows message or signal an event object when connection requests arrive.</span></span> <span data-ttu-id="f40f2-111">Informationen zur Registrierung für das FD-Accept Network-Ereignis finden Sie unter [Benachrichtigung zu Netzwerk Ereignissen](notification-of-network-events-2.md) \_ .</span><span class="sxs-lookup"><span data-stu-id="f40f2-111">See [Notification of Network Events](notification-of-network-events-2.md) for how to register for the FD\_ACCEPT network event.</span></span>

<span data-ttu-id="f40f2-112">Auf der Clientseite wird ein geeigneter Socket erstellt und die Verbindung initiiert, indem [**wspconnect**](/previous-versions/windows/hardware/network/ff566275(v=vs.85))aufgerufen wird und die bekannte Server Adresse angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f40f2-112">The client side will create an appropriate socket, and initiate the connection by calling [**WSPConnect**](/previous-versions/windows/hardware/network/ff566275(v=vs.85)), specifying the known server address.</span></span> <span data-ttu-id="f40f2-113">Clients führen in der Regel keinen expliziten [**Bindungs**](/windows/desktop/api/winsock/nf-winsock-bind) Vorgang aus, bevor Sie eine Verbindung initiieren, sodass der Dienstanbieter eine implizite Bindung in seinem Auftrag ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="f40f2-113">Clients usually do not perform an explicit [**bind**](/windows/desktop/api/winsock/nf-winsock-bind) operation prior to initiating a connection, allowing the service provider to perform an implicit bind on their behalf.</span></span> <span data-ttu-id="f40f2-114">Wenn sich der Socket im Blockierungs Modus befindet, wird **wspconnect** blockiert, bis der Server die Verbindungsanforderung empfangen und verarbeitet hat (oder bis ein Timeout auftritt).</span><span class="sxs-lookup"><span data-stu-id="f40f2-114">If the socket is in blocking mode, **WSPConnect** will block until the server has received and acted upon the connection request (or until a time-out occurs).</span></span> <span data-ttu-id="f40f2-115">Andernfalls sollte der Client einen der zuvor beschriebenen Mechanismen zur Netzwerk Ereignisanzeige verwenden, um eine Benachrichtigung über eine neue Verbindung anzuordnen.</span><span class="sxs-lookup"><span data-stu-id="f40f2-115">Otherwise, the client should use one of the network event indication mechanisms discussed previously to arrange for notification of a new connection being established.</span></span> <span data-ttu-id="f40f2-116">Je nach ausgewähltem Benachrichtigungs Mechanismus gibt der Anbieter dies entweder über eine Windows-Meldung oder durch Signalisieren eines Ereignis Objekts an.</span><span class="sxs-lookup"><span data-stu-id="f40f2-116">Depending on the notification mechanism selected, the provider will indicate this either through a Windows message or by signaling an event object.</span></span>

<span data-ttu-id="f40f2-117">Wenn [**wspaccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept)von der Serverseite aufgerufen wird, ruft der Dienstanbieter die von der Anwendung bereitgestellte Bedingungs Funktion auf und verwendet Funktionsparameter, um die Server Informationen aus dem obersten Eintrag in der Warteschlange für Verbindungs Anforderungs Backlogs zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="f40f2-117">When the server side invokes [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept), the service provider calls the application-supplied condition function, using function parameters to pass into the server information from the top entry in the connection request backlog queue.</span></span> <span data-ttu-id="f40f2-118">Zu diesen Informationen gehören beispielsweise die Adresse der Verbindung zwischen Host, verfügbare Benutzerdaten und verfügbare QoS-Informationen.</span><span class="sxs-lookup"><span data-stu-id="f40f2-118">This information includes such things as address of connecting host, any available user data, and any available QoS information.</span></span> <span data-ttu-id="f40f2-119">Mithilfe dieser Informationen bestimmt die Condition-Funktion des Servers, ob die Anforderung akzeptiert, abgelehnt oder die Entscheidung bis zu einem späteren Zeitpunkt zurückgesetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="f40f2-119">Using this information the server's condition function determines whether to accept the request, reject the request, or defer making a decision until later.</span></span> <span data-ttu-id="f40f2-120">Diese Entscheidung wird durch den Rückgabewert der Condition-Funktion angegeben.</span><span class="sxs-lookup"><span data-stu-id="f40f2-120">This decision is indicated through the return value of the condition function.</span></span> <span data-ttu-id="f40f2-121">Informationen zur Registrierung für das FD Connect Network-Ereignis finden Sie unter [Benachrichtigung zu Netzwerk Ereignissen](notification-of-network-events-2.md) \_ .</span><span class="sxs-lookup"><span data-stu-id="f40f2-121">See [Notification of Network Events](notification-of-network-events-2.md) for how to register for the FD\_CONNECT network event.</span></span>

<span data-ttu-id="f40f2-122">Wenn der Server beschließt, die Anforderung zu akzeptieren, muss der Anbieter einen neuen Socket mit allen Attributen und Ereignis Registrierungen erstellen, die dem Abhör Socket entsprechen.</span><span class="sxs-lookup"><span data-stu-id="f40f2-122">If the server decides to accept the request, the provider must create a new socket with all of the same attributes and event registrations as the listening socket.</span></span> <span data-ttu-id="f40f2-123">Der ursprüngliche Socket verbleibt im Status "lauschen", sodass nachfolgende Verbindungsanforderungen empfangen werden können.</span><span class="sxs-lookup"><span data-stu-id="f40f2-123">The original socket remains in the listening state so that subsequent connection requests can be received.</span></span> <span data-ttu-id="f40f2-124">Durch Ausgabeparameter der Bedingungs Funktion kann der Server auch beliebige Benutzerdaten für die Antwort bereitstellen und QoS-Parameter zuweisen (vorausgesetzt, dass diese Vorgänge vom Dienstanbieter unterstützt werden).</span><span class="sxs-lookup"><span data-stu-id="f40f2-124">Through output parameters of the condition function, the server may also supply any response user data and assign QoS parameters (assuming that these operations are supported by the service provider).</span></span>

 

 
