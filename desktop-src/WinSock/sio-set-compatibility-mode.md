---
description: Fordert an, wie der Netzwerk Stapel bestimmte Verhalten verarbeiten soll, bei denen die Standardmethode für die Handhabung des Verhaltens in Windows-Versionen unterschiedlich sein kann.
ms.assetid: 9574e21f-5ac4-4210-8031-2f3b07416813
title: SIO_SET_COMPATIBILITY_MODE Steuerungs Codes
ms.topic: reference
ms.date: 05/20/2019
req.target-min-winverclnt: Windows Vista [desktop apps only]
req.target-min-winversvr: Windows Server 2008 [desktop apps only]
api_location:
- mstcpip.h
ms.openlocfilehash: 58972595adb71a30728cb4817a80814cd987a6de
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106345103"
---
# <a name="sio_set_compatibility_mode-control-code"></a><span data-ttu-id="3ebc8-103">SIO_SET_COMPATIBILITY_MODE Steuerungs Codes</span><span class="sxs-lookup"><span data-stu-id="3ebc8-103">SIO_SET_COMPATIBILITY_MODE Control Code</span></span>

## <a name="description"></a><span data-ttu-id="3ebc8-104">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="3ebc8-104">Description</span></span>

<span data-ttu-id="3ebc8-105">Der **\_ \_ Kompatibilitätsmodus für den Kompatibilitäts \_ Modus von SIO** fordert an, wie der Netzwerk Stapel bestimmte Verhalten verarbeiten soll, bei denen die Standardmethode zum Verarbeiten des Verhaltens in Windows-Versionen unterschiedlich sein kann.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-105">The **SIO\_SET\_COMPATIBILITY\_MODE** control code requests how the networking stack should handle certain behaviors for which the default way of handling the behavior may differ across Windows versions.</span></span>

<span data-ttu-id="3ebc8-106">Um diesen Vorgang auszuführen, wenden Sie die [**WSAIoctl**](/windows/desktop/api/winsock2/nf-winsock2-wsaioctl) -oder **wspioctl** -Funktion mit den folgenden Parametern an.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-106">To perform this operation, call the [**WSAIoctl**](/windows/desktop/api/winsock2/nf-winsock2-wsaioctl) or **WSPIoctl** function with the following parameters.</span></span>

```cpp
int WSAIoctl(
  (socket) s,             // descriptor identifying a socket
  SIO_SET_COMPATIBILITY_MODE, // dwIoControlCode
  (LPVOID) lpvInBuffer,    // pointer to WSA_COMPATIBILITY_MODE struct
  (DWORD) cbInBuffer,      // length of input buffer
  NULL,         // output buffer
  0,       // size of output buffer
  (LPDWORD) lpcbBytesReturned,    // number of bytes returned
  (LPWSAOVERLAPPED) lpOverlapped,   // OVERLAPPED structure
  (LPWSAOVERLAPPED_COMPLETION_ROUTINE) lpCompletionRoutine,  // completion routine
);
```

```cpp
int WSPIoctl(
  (socket) s,             // descriptor identifying a socket
  SIO_SET_COMPATIBILITY_MODE, // dwIoControlCode
  (LPVOID) lpvInBuffer,    // pointer to WSA_COMPATIBILITY_MODE struct
  (DWORD) cbInBuffer,      // length of input buffer
  NULL,         // output buffer
  0,       // size of output buffer
  (LPDWORD) lpcbBytesReturned,    // number of bytes returned
  (LPWSAOVERLAPPED) lpOverlapped,   // OVERLAPPED structure
  (LPWSAOVERLAPPED_COMPLETION_ROUTINE) lpCompletionRoutine,  // completion routine
  (LPWSATHREADID) lpThreadId,   // a WSATHREADID structure
  (LPINT) lpErrno   // a pointer to the error code.
);
```

## <a name="parameters"></a><span data-ttu-id="3ebc8-107">Parameter</span><span class="sxs-lookup"><span data-stu-id="3ebc8-107">Parameters</span></span>

### <a name="s"></a><span data-ttu-id="3ebc8-108">s</span><span class="sxs-lookup"><span data-stu-id="3ebc8-108">s</span></span>

<span data-ttu-id="3ebc8-109">Ein Deskriptor, der einen Socket identifiziert.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-109">A descriptor identifying a socket.</span></span>

### <a name="dwiocontrolcode"></a><span data-ttu-id="3ebc8-110">dwIoControlCode</span><span class="sxs-lookup"><span data-stu-id="3ebc8-110">dwIoControlCode</span></span>

<span data-ttu-id="3ebc8-111">Der Steuerelement Code für den Vorgang.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-111">The control code for the operation.</span></span>
<span data-ttu-id="3ebc8-112">Verwenden Sie für diesen Vorgang den **\_ \_ Kompatibilitäts \_ Modus "sio festlegen** ".</span><span class="sxs-lookup"><span data-stu-id="3ebc8-112">Use **SIO\_SET\_COMPATIBILITY\_MODE** for this operation.</span></span>

### <a name="lpvinbuffer"></a><span data-ttu-id="3ebc8-113">lpvinbuffer</span><span class="sxs-lookup"><span data-stu-id="3ebc8-113">lpvInBuffer</span></span>

<span data-ttu-id="3ebc8-114">Ein Zeiger auf den Eingabepuffer.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-114">A pointer to the input buffer.</span></span>
<span data-ttu-id="3ebc8-115">Dieser Parameter sollte auf eine **WSA- \_ Kompatibilitäts \_ Modus** -Struktur zeigen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-115">This parameter should point to a **WSA\_COMPATIBILITY\_MODE** structure.</span></span>

### <a name="cbinbuffer"></a><span data-ttu-id="3ebc8-116">cbinbuffer</span><span class="sxs-lookup"><span data-stu-id="3ebc8-116">cbInBuffer</span></span>

<span data-ttu-id="3ebc8-117">Die Größe des Eingabe Puffers in Bytes.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-117">The size, in bytes, of the input buffer.</span></span>
<span data-ttu-id="3ebc8-118">Dieser Parameter muss größer oder gleich der Größe der **WSA- \_ Kompatibilitäts \_ Modus** -Struktur sein, auf die vom *lpvinbuffer* -Parameter verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-118">This parameter should equal to or greater than the size of the **WSA\_COMPATIBILITY\_MODE** structure pointed to by the *lpvInBuffer* parameter.</span></span>

### <a name="lpvoutbuffer"></a><span data-ttu-id="3ebc8-119">lpvoutbuffer</span><span class="sxs-lookup"><span data-stu-id="3ebc8-119">lpvOutBuffer</span></span>

<span data-ttu-id="3ebc8-120">Ein Zeiger auf den Ausgabepuffer.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-120">A pointer to the output buffer.</span></span>
<span data-ttu-id="3ebc8-121">Dieser Parameter wird für diesen Vorgang nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-121">This parameter is unused for this operation.</span></span>

### <a name="cboutbuffer"></a><span data-ttu-id="3ebc8-122">cboutbuffer</span><span class="sxs-lookup"><span data-stu-id="3ebc8-122">cbOutBuffer</span></span>

<span data-ttu-id="3ebc8-123">Die Größe des Ausgabepuffers in Bytes.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-123">The size, in bytes, of the output buffer.</span></span>
<span data-ttu-id="3ebc8-124">Dieser Parameter muss auf 0 (null) festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-124">This parameter must be set to zero.</span></span>

### <a name="lpcbbytesreturned"></a><span data-ttu-id="3ebc8-125">lpcbbyteszurück gegeben</span><span class="sxs-lookup"><span data-stu-id="3ebc8-125">lpcbBytesReturned</span></span>

<span data-ttu-id="3ebc8-126">Ein Zeiger auf eine Variable, die die Größe der im Ausgabepuffer gespeicherten Daten (in Bytes) empfängt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-126">A pointer to a variable that receives the size, in bytes, of the data stored in the output buffer.</span></span>
<span data-ttu-id="3ebc8-127">Dieser zurückgegebene Parameter verweist auf einen **DWORD** -Wert von 0 (null) für diesen Vorgang, da keine Ausgabe vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-127">This returned parameter points to a **DWORD** value of zero for this operation, since there is no output.</span></span>

### <a name="lpvoverlapped"></a><span data-ttu-id="3ebc8-128">lpvoverlgetauscht</span><span class="sxs-lookup"><span data-stu-id="3ebc8-128">lpvOverlapped</span></span>

<span data-ttu-id="3ebc8-129">Ein Zeiger auf eine [**wsaoverllapp**](/windows/desktop/api/winsock2/ns-winsock2-wsaoverlapped) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-129">A pointer to a [**WSAOVERLAPPED**](/windows/desktop/api/winsock2/ns-winsock2-wsaoverlapped) structure.</span></span>

<span data-ttu-id="3ebc8-130">Wenn Socket *s* ohne das überlappende Attribut erstellt wurde, wird der *lpoverllapp* -Parameter ignoriert.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-130">If socket *s* was created without the overlapped attribute, the *lpOverlapped* parameter is ignored.</span></span>

<span data-ttu-id="3ebc8-131">Wenn *s* mit dem überlappenden Attribut geöffnet wurde und der *lpoverlgetauscht* -Parameter nicht **null** ist, wird der Vorgang als überlappende (asynchrone) Operation ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-131">If *s* was opened with the overlapped attribute and the *lpOverlapped* parameter is not **NULL**, the operation is performed as an overlapped (asynchronous) operation.</span></span>
<span data-ttu-id="3ebc8-132">In diesem Fall muss der *lpoverllapp* -Parameter auf eine gültige [**wsaoverllapp**](/windows/desktop/api/winsock2/ns-winsock2-wsaoverlapped) -Struktur zeigen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-132">In this case, *lpOverlapped* parameter must point to a valid [**WSAOVERLAPPED**](/windows/desktop/api/winsock2/ns-winsock2-wsaoverlapped) structure.</span></span>

<span data-ttu-id="3ebc8-133">Bei überlappenden Vorgängen gibt die Funktion [**WSAIoctl**](/windows/desktop/api/winsock2/nf-winsock2-wsaioctl) oder **wspioctl** sofort zurück, und die entsprechende Vervollständigungs Methode wird signalisiert, wenn der Vorgang abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-133">For overlapped operations, the [**WSAIoctl**](/windows/desktop/api/winsock2/nf-winsock2-wsaioctl) or **WSPIoctl** function returns immediately, and the appropriate completion method is signaled when the operation has been completed.</span></span>
<span data-ttu-id="3ebc8-134">Andernfalls gibt die Funktion nicht zurück, bis der Vorgang abgeschlossen ist oder ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-134">Otherwise, the function does not return until the operation has been completed or an error occurs.</span></span>

### <a name="lpcompletionroutine"></a><span data-ttu-id="3ebc8-135">lpCompletionRoutine</span><span class="sxs-lookup"><span data-stu-id="3ebc8-135">lpCompletionRoutine</span></span>

<span data-ttu-id="3ebc8-136">Typ: \_ In_opt \_ [ **LPWSAOVERLAPPED_COMPLETION_ROUTINE**](/windows/win32/api/winsock2/nc-winsock2-lpwsaoverlapped_completion_routine)</span><span class="sxs-lookup"><span data-stu-id="3ebc8-136">Type: \_In_opt\_ [**LPWSAOVERLAPPED_COMPLETION_ROUTINE**](/windows/win32/api/winsock2/nc-winsock2-lpwsaoverlapped_completion_routine)</span></span>

<span data-ttu-id="3ebc8-137">Ein Zeiger auf die Vervollständigungs Routine, die aufgerufen wird, wenn der Vorgang abgeschlossen wurde (bei nicht überlappenden Sockets ignoriert).</span><span class="sxs-lookup"><span data-stu-id="3ebc8-137">A pointer to the completion routine called when the operation has been completed (ignored for non-overlapped sockets).</span></span>

### <a name="lpthreadid"></a><span data-ttu-id="3ebc8-138">lpthreadid</span><span class="sxs-lookup"><span data-stu-id="3ebc8-138">lpThreadId</span></span>

<span data-ttu-id="3ebc8-139">Ein Zeiger auf eine [**wsathreadid**](/windows/desktop/api/ws2spi/ns-ws2spi-wsathreadid) -Struktur, die vom Anbieter in einem nachfolgenden [**wpuqueueapc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc)-Rückruf verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-139">A pointer to a [**WSATHREADID**](/windows/desktop/api/ws2spi/ns-ws2spi-wsathreadid) structure to be used by the provider in a subsequent call to [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span></span>
<span data-ttu-id="3ebc8-140">Der Anbieter sollte die referenzierte [**wsathreadid**](/windows/desktop/api/ws2spi/ns-ws2spi-wsathreadid) -Struktur (nicht den Zeiger auf dieselbe) speichern, bis die [**wpuqueueapc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) -Funktion zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-140">The provider should store the referenced [**WSATHREADID**](/windows/desktop/api/ws2spi/ns-ws2spi-wsathreadid) structure (not the pointer to same) until after the [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) function returns.</span></span>

<span data-ttu-id="3ebc8-141">**Hinweis**  Dieser Parameter gilt nur für die **wspioctl** -Funktion.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-141">**Note**  This parameter applies only to the **WSPIoctl** function.</span></span>

### <a name="lperrno"></a><span data-ttu-id="3ebc8-142">lperrno</span><span class="sxs-lookup"><span data-stu-id="3ebc8-142">lpErrno</span></span>

<span data-ttu-id="3ebc8-143">Ein Zeiger auf den Fehlercode.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-143">A pointer to the error code.</span></span>

<span data-ttu-id="3ebc8-144">**Hinweis**  Dieser Parameter gilt nur für die **wspioctl** -Funktion.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-144">**Note**  This parameter applies only to the **WSPIoctl** function.</span></span>

## <a name="return-value"></a><span data-ttu-id="3ebc8-145">Rückgabewert</span><span class="sxs-lookup"><span data-stu-id="3ebc8-145">Return value</span></span>

<span data-ttu-id="3ebc8-146">Wenn der Vorgang erfolgreich abgeschlossen wird, gibt die [**WSAIoctl**](/windows/desktop/api/winsock2/nf-winsock2-wsaioctl) -oder **wspioctl** -Funktion NULL zurück.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-146">If the operation completes successfully, the [**WSAIoctl**](/windows/desktop/api/winsock2/nf-winsock2-wsaioctl) or **WSPIoctl** function returns zero.</span></span>

<span data-ttu-id="3ebc8-147">Wenn der Vorgang fehlschlägt oder aussteht, gibt die Funktion [**WSAIoctl**](/windows/desktop/api/winsock2/nf-winsock2-wsaioctl) oder **wspioctl** einen **\_ Socketfehler** zurück.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-147">If the operation fails or is pending, the [**WSAIoctl**](/windows/desktop/api/winsock2/nf-winsock2-wsaioctl) or **WSPIoctl** function returns **SOCKET\_ERROR**.</span></span>
<span data-ttu-id="3ebc8-148">Um erweiterte Fehlerinformationen abzurufen, nennen Sie [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror).</span><span class="sxs-lookup"><span data-stu-id="3ebc8-148">To get extended error information, call [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror).</span></span>

| <span data-ttu-id="3ebc8-149">Fehlercode</span><span class="sxs-lookup"><span data-stu-id="3ebc8-149">Error code</span></span> | <span data-ttu-id="3ebc8-150">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="3ebc8-150">Meaning</span></span> |
|------------|---------|
| <span data-ttu-id="3ebc8-151">**ausstehende WSA-e/a \_ \_**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-151">**WSA\_IO\_PENDING**</span></span> | <span data-ttu-id="3ebc8-152">Ein übergebener Vorgang wurde erfolgreich initiiert, und der Abschluss wird zu einem späteren Zeitpunkt angegeben.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-152">An overlapped operation was successfully initiated and completion will be indicated at a later time.</span></span> |
| <span data-ttu-id="3ebc8-153">**WSA- \_ Vorgang \_ abgebrochen**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-153">**WSA\_OPERATION\_ABORTED**</span></span> | <span data-ttu-id="3ebc8-154">Ein über Lapp ender Vorgang wurde aufgrund der Schließung des Sockets oder der Ausführung des Befehls " **SIO \_ Flush** ioctl" abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-154">An overlapped operation was canceled due to the closure of the socket or the execution of the **SIO\_FLUSH** IOCTL command.</span></span> |
| <span data-ttu-id="3ebc8-155">**WSAEFAULT**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-155">**WSAEFAULT**</span></span> | <span data-ttu-id="3ebc8-156">Der *lpoverllapp* -oder *lpCompletionRoutine* -Parameter ist nicht vollständig in einem gültigen Teil des Benutzer Adressraums enthalten.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-156">The *lpOverlapped* or *lpCompletionRoutine* parameter is not totally contained in a valid part of the user address space.</span></span> |
| <span data-ttu-id="3ebc8-157">**Wsaeingabe Progress**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-157">**WSAEINPROGRESS**</span></span> | <span data-ttu-id="3ebc8-158">Die-Funktion wird aufgerufen, wenn ein Rückruf ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-158">The function is invoked when a callback is in progress.</span></span> |
| <span data-ttu-id="3ebc8-159">**Wsaeingabe**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-159">**WSAEINTR**</span></span> | <span data-ttu-id="3ebc8-160">Ein Blockierungs Vorgang wurde unterbrochen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-160">A blocking operation was interrupted.</span></span> |
| <span data-ttu-id="3ebc8-161">**Wsaabval**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-161">**WSAEINVAL**</span></span> | <span data-ttu-id="3ebc8-162">Der *dwIoControlCode* -Parameter ist kein gültiger Befehl, oder ein angegebener Eingabeparameter ist nicht zulässig, oder der Befehl ist nicht auf den angegebenen Sockettyp anwendbar.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-162">The *dwIoControlCode* parameter is not a valid command, or a specified input parameter is not acceptable, or the command is not applicable to the type of socket specified.</span></span> <span data-ttu-id="3ebc8-163">Dieser Fehler wird zurückgegeben, wenn der *cbinbuffer* -Parameter kleiner als der sizeof der **WSA- \_ Kompatibilitäts \_ Modus** -Struktur ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-163">This error is returned if the *cbInBuffer* parameter is less than the sizeof the **WSA\_COMPATIBILITY\_MODE** structure.</span></span>
| <span data-ttu-id="3ebc8-164">**WSAENETDOWN**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-164">**WSAENETDOWN**</span></span> | <span data-ttu-id="3ebc8-165">Das Netzwerk Subsystem ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-165">The network subsystem has failed.</span></span> |
| <span data-ttu-id="3ebc8-166">**Wsaumoproumopt**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-166">**WSAENOPROTOOPT**</span></span> | <span data-ttu-id="3ebc8-167">Die Socketoption wird für das angegebene Protokoll nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-167">The socket option is not supported on the specified protocol.</span></span> |
| <span data-ttu-id="3ebc8-168">**WSAENOTCONN**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-168">**WSAENOTCONN**</span></span> | <span data-ttu-id="3ebc8-169">Die Socket s ist nicht verbunden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-169">The socket s is not connected.</span></span> |
| <span data-ttu-id="3ebc8-170">**Wsaumotsock**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-170">**WSAENOTSOCK**</span></span> | <span data-ttu-id="3ebc8-171">Der Deskriptor *s* ist kein Socket.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-171">The descriptor *s* is not a socket.</span></span> |
| <span data-ttu-id="3ebc8-172">**WSAEOPNOTSUPP**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-172">**WSAEOPNOTSUPP**</span></span> | <span data-ttu-id="3ebc8-173">Der angegebene ioctl-Befehl wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-173">The specified IOCTL command is not supported.</span></span> <span data-ttu-id="3ebc8-174">Dieser Fehler wird zurückgegeben, wenn der IOCTL- **\_ \_ Kompatibilitäts \_ Modus** für den-Transport nicht vom Transportanbieter unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-174">This error is returned if the **SIO\_SET\_COMPATIBILITY\_MODE** IOCTL is not supported by the transport provider.</span></span> <span data-ttu-id="3ebc8-175">Dieser Fehler wird auch zurückgegeben, wenn für einen Datagrammsocket versucht wird, den **\_ \_ Kompatibilitäts \_ Modus** für den SIO-Satz zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-175">This error is also returned when an attempt to use the **SIO\_SET\_COMPATIBILITY\_MODE** IOCTL is made on a datagram socket.</span></span> |

## <a name="remarks"></a><span data-ttu-id="3ebc8-176">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="3ebc8-176">Remarks</span></span>

<span data-ttu-id="3ebc8-177">die IOCTL- **\_ \_ Kompatibilitätsmodus-Kompatibilitäts \_ Modus** fordert an, wie der Netzwerk Stapel bestimmte Verhalten verarbeiten soll, bei denen die Standardmethode zur Handhabung des Verhaltens in Windows-Versionen unterschiedlich sein kann.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-177">the **SIO\_SET\_COMPATIBILITY\_MODE** IOCTL requests how the networking stack should handle certain behaviors for which the default way of handling the behavior may differ across Windows versions.</span></span>
<span data-ttu-id="3ebc8-178">Die Eingabe Argument Struktur für **den \_ \_ Kompatibilitäts \_ Modus für den-Kompatibilitätsmodus** wird in der **WSA- \_ Kompatibilitäts \_ Modus** -Struktur angegeben, die in der Header Datei " *mswap*</span><span class="sxs-lookup"><span data-stu-id="3ebc8-178">The input argument structure for **SIO\_SET\_COMPATIBILITY\_MODE** is specified in the **WSA\_COMPATIBILITY\_MODE** structure defined in the *Mswsockdef.h* header file.</span></span>
<span data-ttu-id="3ebc8-179">Ein Zeiger auf die Struktur des **WSA- \_ Kompatibilitäts \_ Modus** wird im *cbinbuffer* -Parameter übergeben.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-179">A pointer to the **WSA\_COMPATIBILITY\_MODE** structure is passed in the *cbInBuffer* parameter.</span></span>
<span data-ttu-id="3ebc8-180">Diese Struktur ist wie folgt definiert:</span><span class="sxs-lookup"><span data-stu-id="3ebc8-180">This structure is defined as follows:</span></span>

```cpp
// Need to #include <mswsock.h>

/* Argument structure for SIO_SET_COMPATIBILITY_MODE */
typedef struct _WSA_COMPATIBILITY_MODE {
    WSA_COMPATIBILITY_BEHAVIOR_ID BehaviorId;
    ULONG TargetOsVersion;
} WSA_COMPATIBILITY_MODE, *PWSA_COMPATIBILITY_MODE;
```

<span data-ttu-id="3ebc8-181">Der im **Verhaltensweise-** Member angegebene Wert gibt das angeforderte Verhalten an.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-181">The value specified in the **BehaviorId** member indicates the behavior requested.</span></span>
<span data-ttu-id="3ebc8-182">Der im **targetosversion** -Member angegebene Wert gibt die Windows-Version an, die für das Verhalten angefordert wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-182">The value specified in the **TargetOsVersion** member indicates the Windows version that is being requested for the behavior.</span></span>

<span data-ttu-id="3ebc8-183">Der Behavior **orid-** Member kann einer der Werte aus dem Enumerationstyp der **WSA- \_ Kompatibilitäts \_ Verhaltens- \_ ID** sein, der in der Header Datei " *mslisockdef. h* " definiert ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-183">The **BehaviorId** member can be one of the values from the **WSA\_COMPATIBILITY\_BEHAVIOR\_ID** enumeration type defined in the *Mswsockdef.h* header file.</span></span>
<span data-ttu-id="3ebc8-184">Die möglichen Werte für den Member " **verhalarid** " lauten wie folgt:</span><span class="sxs-lookup"><span data-stu-id="3ebc8-184">The possible values for the **BehaviorId** member are as follows:</span></span>

| <span data-ttu-id="3ebc8-185">Begriff</span><span class="sxs-lookup"><span data-stu-id="3ebc8-185">Term</span></span> | <span data-ttu-id="3ebc8-186">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="3ebc8-186">Description</span></span> |
|------|-------------|
| <span data-ttu-id="3ebc8-187">Wsaverhalorall</span><span class="sxs-lookup"><span data-stu-id="3ebc8-187">WsaBehaviorAll</span></span> | <span data-ttu-id="3ebc8-188">Dies entspricht der Anforderung aller möglichen kompatiblen Verhalten, die für die **WSA- \_ Kompatibilitäts \_ Verhaltens- \_ ID** definiert sind.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-188">This is equivalent to requesting all of the possible compatible behaviors defined for **WSA\_COMPATIBILITY\_BEHAVIOR\_ID**.</span></span> |
| <span data-ttu-id="3ebc8-189">Wsaverhaltereceivepufferung</span><span class="sxs-lookup"><span data-stu-id="3ebc8-189">WsaBehaviorReceiveBuffering</span></span> | <span data-ttu-id="3ebc8-190">Wenn das **targetosversion** -Element auf einen Wert für Windows Vista oder höher festgelegt ist, sind die TCP-Empfangs Puffergröße auf diesem Socket mithilfe der Option " **so \_ rcvbuf** " auch nach der Einrichtung einer TCP-Verbindung zulässig.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-190">When the **TargetOsVersion** member is set to a value for Windows Vista or later, reductions to the TCP receive buffer size on this socket using the **SO\_RCVBUF** socket option are allowed even after a TCP connection has been establishment.</span></span> <span data-ttu-id="3ebc8-191">Wenn das **targetosversion** -Element auf einen früheren Wert als Windows Vista festgelegt ist, sind nach dem **herstellen der Verbindung \_** keine Reduzierungen der TCP-Empfangs Puffergröße auf diesem Socket zulässig.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-191">When the **TargetOsVersion** member is set to a value earlier than Windows Vista, reductions to the TCP receive buffer size on this socket using the **SO\_RCVBUF** socket option are not allowed after connection establishment.</span></span> |
| <span data-ttu-id="3ebc8-192">Wsaverhalorautotuning</span><span class="sxs-lookup"><span data-stu-id="3ebc8-192">WsaBehaviorAutoTuning</span></span> | <span data-ttu-id="3ebc8-193">Wenn das **targetosversion** -Element auf einen Wert für Windows Vista oder höher festgelegt ist, ist die automatische Optimierung des Empfangs Fensters aktiviert, und der TCP-Fenster Skalierungsfaktor wird vom Standardwert 8 auf 2 reduziert.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-193">When the **TargetOsVersion** member is set to a value for Windows Vista or later, receive window auto-tuning is enabled and the TCP window scale factor is reduced to 2 from the default value of 8.</span></span> <span data-ttu-id="3ebc8-194">Wenn **targetosversion** auf einen früheren Wert als Windows Vista festgelegt ist, ist die automatische Optimierung des Empfangs Fensters deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-194">When the **TargetOsVersion** is set to a value earlier than Windows Vista, receive window auto-tuning is disabled.</span></span> <span data-ttu-id="3ebc8-195">Die Option zum Skalieren von TCP-Fenstern ist ebenfalls deaktiviert, und die maximale tatsächliche Empfangs Fenstergröße ist auf 65.535 Bytes begrenzt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-195">The TCP window scaling option is also disabled and the maximum true receive window size is limited to 65,535 bytes.</span></span> <span data-ttu-id="3ebc8-196">Die Option für die TCP-Fenster Skalierung kann für die Verbindung nicht ausgehandelt werden, auch wenn die Option " **\_ rcvbuf** " für diesen Socket aufgerufen wurde und einen Wert größer als 65.535 Bytes angibt, bevor die Verbindung hergestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-196">The TCP window scaling option can't be negotiated on the connection even if the **SO\_RCVBUF** socket option was called on this socket specifying a value greater than 65,535 bytes before the connection was established.</span></span> |

<span data-ttu-id="3ebc8-197">Der **targetosversion** -Member kann eine der ntddi-Versions Konstanten sein, die in der Header Datei " *sdkddkver. h* " definiert sind.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-197">The **TargetOsVersion** member can be one of the NTDDI version constants defined in the *Sdkddkver.h* header file.</span></span>
<span data-ttu-id="3ebc8-198">Einige der möglichen Werte für den **targetosversion** -Member lauten wie folgt:</span><span class="sxs-lookup"><span data-stu-id="3ebc8-198">Some of the possible values for the **TargetOsVersion** member are as follows:</span></span>

| <span data-ttu-id="3ebc8-199">Begriff</span><span class="sxs-lookup"><span data-stu-id="3ebc8-199">Term</span></span> | <span data-ttu-id="3ebc8-200">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="3ebc8-200">Description</span></span> |
|------|-------------|
| <span data-ttu-id="3ebc8-201">ntddi \_ Longhorn</span><span class="sxs-lookup"><span data-stu-id="3ebc8-201">NTDDI\_LONGHORN</span></span> | <span data-ttu-id="3ebc8-202">Das zielverhalten ist die Standardeinstellung für Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-202">The target behavior is the default for Windows Vista.</span></span> |
| <span data-ttu-id="3ebc8-203">Ntddi \_ WS03</span><span class="sxs-lookup"><span data-stu-id="3ebc8-203">NTDDI\_WS03</span></span> | <span data-ttu-id="3ebc8-204">Das zielverhalten ist die Standardeinstellung für Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-204">The target behavior is the default for Windows Server 2003.</span></span> |
| <span data-ttu-id="3ebc8-205">ntddi- \_ WinXP</span><span class="sxs-lookup"><span data-stu-id="3ebc8-205">NTDDI\_WINXP</span></span> | <span data-ttu-id="3ebc8-206">Das zielverhalten ist die Standardeinstellung für Windows XP.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-206">The target behavior is the default for Windows XP.</span></span> |
| <span data-ttu-id="3ebc8-207">Ntddi \_ WIN2K</span><span class="sxs-lookup"><span data-stu-id="3ebc8-207">NTDDI\_WIN2K</span></span> | <span data-ttu-id="3ebc8-208">Das zielverhalten ist die Standardeinstellung für Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-208">The target behavior is the default for Windows 2000.</span></span> |

<span data-ttu-id="3ebc8-209">Die Haupt Auswirkung des Members **targetosversion** ist, ob dieser Member auf einen Wert gleich oder größer als **ntddi \_ Longhorn** festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-209">The primary impact of the **TargetOsVersion** member is whether this member is set to a value equal or greater than **NTDDI\_LONGHORN**.</span></span>

<span data-ttu-id="3ebc8-210">Die TCP-Leistung hängt nicht nur von der Übertragungsrate selbst, sondern auch vom Produkt der Übertragungsrate und der Roundtrip-Verzögerungszeit ab.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-210">TCP performance depends not only on the transfer rate itself, but rather on the product of the transfer rate and the round-trip delay time.</span></span>
<span data-ttu-id="3ebc8-211">Mit diesem Produkt zur Bandbreiten Verzögerung wird die Menge der Daten gemessen, die "die Pipe füllen".</span><span class="sxs-lookup"><span data-stu-id="3ebc8-211">This bandwidth-delay product measures the amount of data that would "fill the pipe".</span></span>
<span data-ttu-id="3ebc8-212">Dieses Produkt mit Bandbreiten Verzögerung ist der für Absender und Empfänger erforderliche Pufferspeicher, um den maximalen Durchsatz der TCP-Verbindung über den Pfad zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-212">This bandwidth-delay product is the buffer space required at sender and receiver to obtain maximum throughput on the TCP connection over the path.</span></span>
<span data-ttu-id="3ebc8-213">Dieser Pufferspeicher stellt die Menge der nicht bestätigten Daten dar, die von TCP verarbeitet werden müssen, damit die Pipeline voll ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-213">This buffer space represents the amount of unacknowledged data that TCP must handle in order to keep the pipeline full.</span></span>
<span data-ttu-id="3ebc8-214">TCP-Leistungsprobleme treten auf, wenn das Produkt für die Bandbreiten Verzögerung groß ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-214">TCP performance problems arise when the bandwidth-delay product is large.</span></span>
<span data-ttu-id="3ebc8-215">Ein Netzwerkpfad, der unter diesen Bedingungen betrieben wird, wird häufig als "Long, FAT Pipe" bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-215">A network path operating under these conditions is often called a "long, fat pipe".</span></span>
<span data-ttu-id="3ebc8-216">Beispiele hierfür sind hochleistungsfähige Paket Satelliten Verknüpfungen, drahtlose Hochgeschwindigkeitsverbindungen und über lange Entfernungen unterirdische Fiber-optische Links.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-216">Examples include high-capacity packet satellite links, high-speed wireless links, and terrestrial fiber-optical links over long distances.</span></span>

<span data-ttu-id="3ebc8-217">Der TCP-Header verwendet ein 16-Bit-Datenfeld (das Fenster Feld im TCP-Paket Header), um die Größe des Empfangs Fensters an den Absender zu melden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-217">The TCP header uses a 16-bit data field (the Window field in the TCP packet header) to report the receive window size to the sender.</span></span>
<span data-ttu-id="3ebc8-218">Daher ist das größte Fenster, das verwendet werden kann, 65.535 bytes.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-218">Therefore, the largest window that can be used is 65,535 bytes.</span></span>
<span data-ttu-id="3ebc8-219">Um diese Einschränkung zu umgehen, wurde eine TCP-Erweiterungsoption (TCP-Fenster Skala) für Hochleistungs-TCP hinzugefügt, um Windows mit mehr als 65.535 Bytes zuzulassen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-219">To circumvent this limitation a TCP extension option, TCP Window Scale, was added for high-performance TCP to allow windows larger than 65,535 bytes.</span></span>
<span data-ttu-id="3ebc8-220">Die TCP-Fenster Skalierungs Option (wsopt) ist in RFC 1323 definiert, die auf der [IETF-Website](https://www.ietf.org/rfc/rfc1122.txt)verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-220">The TCP Window Scale option (WSopt) is defined in RFC 1323 available at the [IETF website](https://www.ietf.org/rfc/rfc1122.txt).</span></span>
<span data-ttu-id="3ebc8-221">Die wsopt-Erweiterung erweitert die Definition des TCP-Fensters auf 32 Bits mithilfe eines logarithmischen 1-Byte-Skalierungsfaktors, um das 16-Bit-Fenster Feld im TCP-Header zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-221">The WSopt extension expands the definition of the TCP window to 32 bits using a one-byte logarithmic scale factor to extend the 16-bit Window field in the TCP header.</span></span>
<span data-ttu-id="3ebc8-222">Die wsopt-Erweiterung definiert einen impliziten Skalierungsfaktor (2 zu einer Potenz), der verwendet wird, um den Wert der Fenstergröße zu multiplizieren, der in einem TCP-Header gefunden wird, um die tatsächliche Fenstergröße zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-222">The WSopt extension defines an implicit scale factor (2 to some power), which is used to multiply the window size value found in a TCP header to obtain the true window size.</span></span>
<span data-ttu-id="3ebc8-223">Ein Fenster Skalierungsfaktor von 8 ergibt also eine echte Fenstergröße, die dem Wert im Fenster Feld im TCP-Header entspricht, multipliziert mit 2 ^ 8 oder 256.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-223">So a window scale factor of 8 would result in a true window size equal to the value in the Window field in the TCP header multiplied by 2^8 or 256.</span></span>
<span data-ttu-id="3ebc8-224">Wenn das Fenster Feld im TCP-Header auf den maximalen Wert von 65.535 Bytes festgelegt ist und der wsopt-Skalierungsfaktor mit dem Wert 8 ausgehandelt wurde, wäre die echte Fenstergröße 16.776.960 bytes.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-224">So if the Window field in the TCP header was set to the maximum value of 65,535 bytes and the WSopt scale factor was negotiated to a value of 8, the true window size would be 16,776,960 bytes.</span></span>

<span data-ttu-id="3ebc8-225">Die tatsächliche Empfangs Fenstergröße und somit der Skalierungsfaktor werden durch den maximalen Empfangs Pufferbereich bestimmt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-225">The true receive window size and therefore the scale factor is determined by the maximum receive buffer space.</span></span>
<span data-ttu-id="3ebc8-226">Der maximale Pufferspeicher ist die Datenmenge, die ein TCP-Empfänger senden kann, bevor auf eine Bestätigung gewartet werden muss.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-226">This maximum buffer space is the amount of data that a TCP receiver allows a TCP sender to send before having to wait for an acknowledgement.</span></span>
<span data-ttu-id="3ebc8-227">Nachdem die Verbindung hergestellt wurde, wird die Empfangs Fenstergröße in jedem TCP-Segment (das Fenster Feld im TCP-Header) angekündigt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-227">After the connection is established, the receive window size is advertised in each TCP segment (the Window field in the TCP header).</span></span>
<span data-ttu-id="3ebc8-228">Die Ankündigung der maximalen Datenmenge, die der Absender senden kann, ist ein Empfänger seitiger Fluss Steuerungsmechanismus, der verhindert, dass der Absenderdaten sendet, die der Empfänger nicht speichern kann.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-228">Advertising the maximum amount of data that the sender can send is a receiver-side flow control mechanism that prevents the sender from sending data that the receiver cannot store.</span></span>
<span data-ttu-id="3ebc8-229">Ein sendender Host kann nur die maximale Datenmenge senden, die vom Empfänger angekündigt wird, bevor er auf eine Bestätigung und eine Aktualisierung der Empfangs Fenstergröße wartet.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-229">A sending host can only send the maximum amount of data advertised by the receiver before waiting for an acknowledgment and a receive window size update.</span></span>

<span data-ttu-id="3ebc8-230">Unter Windows Server 2003 und Windows XP hat der maximale Empfangs Pufferspeicher, der die Größe des Empfangs Fensters für den TCP/IP-Stapel darstellt, einen Standardwert, der auf der Verbindungsgeschwindigkeit der Sende Schnittstelle basiert.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-230">On Windows Server 2003 and Windows XP, the maximum receive buffer space which represents the receive window size for the TCP/IP stack has a default value based on the link speed of the sending interface.</span></span>
<span data-ttu-id="3ebc8-231">Der tatsächliche Wert passt sich automatisch an sogar Inkremente der maximalen Segmentgröße (MSS) an, die während der TCP-Verbindungs Herstellung ausgehandelt werden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-231">The actual value automatically adjusts to even increments of the maximum segment size (MSS) negotiated during TCP connection establishment.</span></span>
<span data-ttu-id="3ebc8-232">Bei einem Link mit einer Länge von 10 MBit/Sek. ist die Standardgröße des Empfangs Fensters normalerweise auf 16K Bytes festgelegt, während bei einem Link von 100 MBit/Sek die Standardgröße des Empfangs Fensters auf 65.535 Bytes festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-232">So for a 10 Mbit/sec link, the default receive window size would normally be set to 16K bytes, while on a 100 MBit/sec link the default receive window size would be set to 65,535 bytes.</span></span>

<span data-ttu-id="3ebc8-233">Unter Windows Server 2003 und Windows XP kann die tatsächliche maximale Empfangs Fenstergröße für den TCP/IP-Stapel mithilfe der folgenden Registrierungs Werte für eine bestimmte Schnittstelle oder für das gesamte System manuell konfiguriert werden:</span><span class="sxs-lookup"><span data-stu-id="3ebc8-233">On Windows Server 2003 and Windows XP, the true maximum receive window size for the TCP/IP stack can be manually configured using the following registry values on a specific interface or for the entire system:</span></span>

`HKEY_LOCAL_MACHINE\SYSTEM\Current Control Set\Services\Tcpip\Parameters\TCPWindowSize`

`HKEY_LOCAL_MACHINE\SYSTEM\Current Control Set\Services\Tcpip\Parameters\Interface\TCPWindowSize`

<span data-ttu-id="3ebc8-234">Der Registrierungs Wert für **TcpWindowSize** kann auf maximal 65.535 Bytes festgelegt werden, wenn die wsopt-Erweiterung nicht verwendet wird, oder maximal 1.073.741.823 Byte, wenn die wsopt-Erweiterung verwendet wird (ein maximaler Skalierungsfaktor von 4 wird unterstützt).</span><span class="sxs-lookup"><span data-stu-id="3ebc8-234">The registry value for **TCPWindowSize** can be set to a maximum of 65,535 bytes when not using the WSopt extension or a maximum of 1,073,741,823 bytes when the WSopt extension is used (a maximum scale factor of 4 is supported).</span></span>
<span data-ttu-id="3ebc8-235">Ohne Fenster Skalierung kann eine Anwendung unabhängig von der Pfad Bandbreite nur einen Durchsatz von ungefähr 5 meits pro Sekunde (Mbit/s) für einen Pfad mit einer Roundtrip-Zeit von 100 Millisekunden (RTT) erzielen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-235">Without window scaling, an application can only achieve a throughput of approximately 5 megabits per second (Mbps) on a path with a 100 millisecond round-trip time (RTT), regardless of the path bandwidth.</span></span>
<span data-ttu-id="3ebc8-236">Dieser Durchsatz kann auf ein Gigabit pro Sekunde (Gbit/s) mit Fenster Skalierung skaliert werden, wodurch TCP den Skalierungsfaktor für die Fenstergröße während der Verbindungs Herstellung aushandeln kann.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-236">This throughput can be scaled to over a gigabit per second (Gbps) with window scaling, which allows TCP to negotiate the scaling factor for the window size during connection establishment.</span></span>

<span data-ttu-id="3ebc8-237">Unter Windows Server 2003 und Windows XP kann die wsopt-Erweiterung aktiviert werden, indem der folgende Registrierungs Wert festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-237">On Windows Server 2003 and Windows XP, the WSopt extension can be enabled by setting the following registry value.</span></span>

`HKEY_LOCAL_MACHINE\SYSTEM\Current Control Set\Services\Tcpip\Parameters\Tcp1323Opts`

<span data-ttu-id="3ebc8-238">Der Registrierungs Wert " **Tcp1323Opts** " ist ein **DWORD** -codiertes, sodass beim Festlegen von Bit 0 die TCP-wsopt-Erweiterung aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-238">The **Tcp1323Opts** registry value is a **DWORD** encoded such that when bit 0 is set, TCP WSopt extension is enabled.</span></span>
<span data-ttu-id="3ebc8-239">Wenn Bit 1 festgelegt ist, wird die in RFC 1323 definierte TCP-Zeitstempel Option (tsopt) aktiviert.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-239">When bit 1 is set, the TCP Timestamp option (TSopt) defined in RFC 1323 is enabled.</span></span>
<span data-ttu-id="3ebc8-240">Mit einem Wert von 1 oder 3 wird die wsopt-Erweiterung aktiviert.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-240">So a value of either 1 or 3 will enable the WSopt extension.</span></span>

<span data-ttu-id="3ebc8-241">Unter Windows Server 2003 und Windows XP ist die Standardeinstellung, dass die Registrierungs Werte TcpWindowSize und Tcp1323Opts nicht erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-241">On Windows Server 2003 and Windows XP, the default is that the TCPWindowSize and the Tcp1323Opts registry values are not created.</span></span>
<span data-ttu-id="3ebc8-242">Der Standardwert ist, dass die wsopt-Erweiterung deaktiviert ist und die Größe des TCP-Empfangs Fensters vom System auf den maximalen Wert von bis zu 65.535 Bytes basierend auf der Verbindungsgeschwindigkeit festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-242">So the default is that the WSopt extension is disabled and the TCP receive window size is set by the system to maximum value of up to 65,535 bytes based on the link speed.</span></span>
<span data-ttu-id="3ebc8-243">Wenn die Fenster Skalierung unter Windows Server 2003 und Windows XP aktiviert ist, indem der Registrierungs Wert Tcp1323Opts festgelegt wird, wird die Fenster Skalierung für eine TCP-Verbindung immer noch verwendet, wenn sowohl der Absender als auch der Empfänger eine TCP-Fenster Skalierungs Option im zu gegenseitig gesendeten Bereich synchronisieren (SYN) zum Aushandeln eines Fenster Skalierungsfaktors enthalten.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-243">When window scaling is enabled on Windows Server 2003 and Windows XP by setting the Tcp1323Opts registry value, window scaling on a TCP connection is still only used when both the sender and receiver include a TCP window scale option in the synchronize (SYN) segment sent to each other to negotiate a window scale factor.</span></span>
<span data-ttu-id="3ebc8-244">Wenn für eine Verbindung die Fenster Skalierung verwendet wird, wird das Fenster Feld im TCP-Header auf 65.535 Bytes festgelegt, und der Fenster Skalierungsfaktor wird verwendet, um die tatsächliche Empfangs Fenstergröße nach oben um den Fenster Skalierungsfaktor zu ändern, der beim Herstellen der Verbindung ausgehandelt wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-244">When window scaling is used on a connection, the Window field in the TCP header is set to 65,535 bytes and the window scale factor is used to adjust the true receive window size upward by the window scale factor negotiated when the connection is established.</span></span>

<span data-ttu-id="3ebc8-245">Eine Anwendung kann die TCP-Empfangs Fenstergröße für eine Verbindung mit der Option " **so \_ rcvbuf** " angeben.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-245">An application can specify the TCP receive window size for a connection by using the **SO\_RCVBUF** socket option.</span></span>
<span data-ttu-id="3ebc8-246">Die Größe des TCP-Empfangs Fensters für einen Socket kann jederzeit mithilfe von **\_ rcvbuf** gesteigert werden. Sie kann jedoch nur vor dem Herstellen einer Verbindung reduziert werden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-246">The TCP receive window size for a socket can be increased at any time using **SO\_RCVBUF**, but it can only be decreased prior to establishing a connection.</span></span>
<span data-ttu-id="3ebc8-247">Um die Fenster Skalierung zu verwenden, muss eine Anwendung eine Fenstergröße von mehr als 65.535 Bytes angeben, wenn die Option " **so \_ rcvbuf** Socket" verwendet wird, bevor die Verbindung hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-247">In order to use window scaling, an application must specify a window size larger than 65,535 bytes when using the **SO\_RCVBUF** socket option before the connection is established.</span></span>

<span data-ttu-id="3ebc8-248">Der ideale Wert für die TCP-Empfangs Fenstergröße ist oft schwierig zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-248">The ideal value for the TCP receive window size is often difficult to determine.</span></span>
<span data-ttu-id="3ebc8-249">Zum Auffüllen der Netzwerkkapazität zwischen dem Absender und dem Empfänger sollte die Empfangs Fenstergröße auf das Produkt für die Bandbreiten Verzögerung für die Verbindung festgelegt werden. dabei handelt es sich um die Bandbreite, multipliziert mit der Roundtrip-Zeit.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-249">In order to fill the capacity of the network between the sender and receiver, the receive window size should be set to the bandwidth-delay product for the connection, which is the bandwidth multiplied by the round-trip time.</span></span>
<span data-ttu-id="3ebc8-250">Auch wenn eine Anwendung das Produkt für die Bandbreiten Verzögerung ordnungsgemäß bestimmen kann, ist es immer noch nicht bekannt, wie schnell die empfangende Anwendung Daten aus dem eingehenden Datenpuffer (der Abruf Rate der Anwendung) abruft.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-250">Even if an application can correctly determine the bandwidth-delay product, it is still not known how quickly the receiving application will retrieve data from the incoming data buffer (the application retrieve rate).</span></span>
<span data-ttu-id="3ebc8-251">Trotz der Unterstützung für die TCP-Fenster Skalierung kann die maximale Empfangs Fenstergröße in Windows Server 2003 und Windows XP weiterhin den Durchsatz begrenzen, da es sich um eine maximale maximale Größe für alle TCP-Verbindungen handelt (es sei denn, Sie werden pro Anwendung mithilfe von **\_ rcvbuf** angegeben), wodurch der Durchsatz für einige Verbindungen verbessert und der Durchsatz für andere verringert wird</span><span class="sxs-lookup"><span data-stu-id="3ebc8-251">Despite the support for TCP window scaling, the maximum receive window size in Windows Server 2003 and Windows XP can still limit throughput because it is a fixed maximum size for all TCP connections (unless specified per application using **SO\_RCVBUF**), which can enhance throughput for some connections and decrease throughput for others.</span></span>
<span data-ttu-id="3ebc8-252">Darüber hinaus unterscheidet sich die maximale Größe des Empfangs Fensters für eine TCP-Verbindung nicht von der Änderung der Netzwerkbedingungen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-252">Additionally, the fixed maximum receive window size for a TCP connection does not vary with changing network conditions.</span></span>

<span data-ttu-id="3ebc8-253">Der TCP/IP-Stapel in Windows Vista unterstützt die Funktion zum automatischen Optimieren von Empfangs Fenstern, um das Problem zu beheben, mit dem der Wert der maximalen Empfangs Fenstergröße für eine TCP-Verbindung basierend auf den aktuellen Netzwerkbedingungen korrekt festgelegt werden kann.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-253">To solve the problem of correctly determining the value of the maximum receive window size for a TCP connection based on the current conditions of the network, the TCP/IP stack in Windows Vista supports a receive window auto-tuning feature.</span></span>
<span data-ttu-id="3ebc8-254">Wenn dieses Feature aktiviert ist, bestimmt die automatische Optimierung des Empfangs Fensters kontinuierlich die optimale echte Empfangs Fenstergröße, indem das Produkt für die Bandbreiten Verzögerung und die Anwendungs Abruf Rate gemessen wird, und passt die tatsächliche maximale Empfangs Fenstergröße basierend auf den veränderten Netzwerkbedingungen an.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-254">When this feature is enabled, receive window auto-tuning continually determines the optimal true receive window size by measuring the bandwidth-delay product and the application retrieve rate, and adjusts the true maximum receive window size based on changing network conditions.</span></span>
<span data-ttu-id="3ebc8-255">Die automatische Optimierung des Empfangs Fensters ermöglicht die TCP-wsopt-Erweiterung standardmäßig, sodass bis zu 16.776.960 bytes für die echte Fenstergröße zugelassen werden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-255">Receive window auto-tuning enables the TCP WSopt extension by default, allowing up to 16,776,960 bytes for the true window size.</span></span>
<span data-ttu-id="3ebc8-256">Wenn die Daten über die Verbindung übertragen werden, überwacht der TCP/IP-Stapel die Verbindung, misst das aktuelle Bandbreiten Verzögerungs Produkt für die Verbindung und die Empfangs Rate der Anwendung und passt die tatsächliche Empfangs Fenstergröße an, um den Durchsatz zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-256">As the data flows over the connection, the TCP/IP stack monitors the connection, measures the current bandwidth-delay product for the connection and the application receive rate, and adjusts the actual receive window size to optimize throughput.</span></span>
<span data-ttu-id="3ebc8-257">Der TCP/IP-Stapel ändert den Wert des Fenster Felds im TCP-Header basierend auf den Netzwerkbedingungen, da der wsopt-Skalierungsfaktor beim ersten Herstellen der Verbindung korrigiert wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-257">The TCP/IP stack changes the value of the Window field in the TCP header based on network conditions, since the WSopt scale factor is fixed when the connection is first established.</span></span>

<span data-ttu-id="3ebc8-258">Der TCP/IP-Stapel in Windows Vista verwendet nicht mehr die Registrierungs Werte " **TcpWindowSize** ".</span><span class="sxs-lookup"><span data-stu-id="3ebc8-258">The TCP/IP stack in Windows Vista no longer uses the **TCPWindowSize** registry values.</span></span>
<span data-ttu-id="3ebc8-259">Bei einem besseren Durchsatz zwischen TCP-Peers erhöht sich die Auslastung der Netzwerkbandbreite während der Datenübertragung.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-259">With better throughput between TCP peers, the utilization of network bandwidth increases during data transfer.</span></span>
<span data-ttu-id="3ebc8-260">Wenn alle Anwendungen für den Empfang von TCP-Daten optimiert sind, kann sich die Gesamtauslastung des Netzwerks erheblich erhöhen. Dadurch wird die Verwendung von Quality of Service (QoS) in Netzwerken, die mit der Kapazität oder nahezu der Kapazität arbeiten, wichtiger.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-260">If all the applications are optimized to receive TCP data, then the overall utilization of the network can increase substantially, making the use of Quality of Service (QoS) more important on networks that are operating at or near capacity.</span></span>

<span data-ttu-id="3ebc8-261">Das Standardverhalten von Windows Vista für die Empfangs Pufferung, wenn der **markerset- \_ \_ Kompatibilitäts \_ Modus** nicht mithilfe von **wsaverhalorreceivebuffereing** angegeben wird, ist, dass nach dem Herstellen einer Verbindung keine Größe der Empfangs Fenster **Größe verwendet werden \_** kann.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-261">The default behavior on Windows Vista for receive buffering when **SIO\_SET\_COMPATIBILITY\_MODE** is not specified using **WsaBehaviorReceiveBuffering** is that no receive window size reductions using **SO\_RCVBUF** socket option are allowed after a connection is established.</span></span>

<span data-ttu-id="3ebc8-262">Das Standardverhalten von Windows Vista für die automatische Optimierung, wenn der **\_ \_ Kompatibilitäts \_ Modus** für die Verwendung von " **wsaverhalorautotuning** " nicht angegeben ist, besteht darin, dass der Stapel eine automatische Optimierung des Fensters mit einem Fenster Skalierungsfaktor von 8 empfängt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-262">The default behavior on Windows Vista for auto-tuning when **SIO\_SET\_COMPATIBILITY\_MODE** is not specified using **WsaBehaviorAutoTuning** is that the stack will do receive window auto-tuning using a window scale factor of 8.</span></span>
<span data-ttu-id="3ebc8-263">Beachten Sie Folgendes: Wenn eine Anwendung eine gültige Empfangs Fenstergröße mit der " **so \_ rcvbuf** "-Socketoption festlegt, verwendet der Stapel die angegebene Größe, und die automatische Optimierung des Fenster Empfangs wird deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-263">Note that if an application sets a valid receive window size with the **SO\_RCVBUF** socket option, the stack will use the size specified and window receive auto-tuning will disabled.</span></span>
<span data-ttu-id="3ebc8-264">Die automatische Optimierung von Windows kann auch vollständig deaktiviert werden, indem der folgende Befehl verwendet wird `netsh interface tcp set global autotuninglevel=disabled` . in diesem Fall hat die Angabe von " **wsaverhalorautotuning** " keine Auswirkung.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-264">Windows autotuning may also be disabled completely using the following command, `netsh interface tcp set global autotuninglevel=disabled`, in which case specifying **WsaBehaviorAutoTuning** will have no affect.</span></span>
<span data-ttu-id="3ebc8-265">Die automatische Optimierung des Fenster Empfangs kann auch basierend auf der Gruppenrichtlinie deaktiviert werden, die unter Windows Server 2008 festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-265">Window receive autotuning can also be disabled based on group policy set on Windows Server 2008.</span></span>

<span data-ttu-id="3ebc8-266">Die Option **wsaverhalorautotuning** ist unter Windows Vista für einige Internet Gateway-Geräte und Firewalls erforderlich, die Datenflüsse für TCP-Verbindungen, die die wsopt-Erweiterung und einen Windows-Skalierungsfaktor verwenden, nicht ordnungsgemäß unterstützen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-266">The **WsaBehaviorAutoTuning** option is needed on Windows Vista for some Internet gateway devices and firewalls that do not correctly support data flows for TCP connections that use the WSopt extension and a windows scale factor.</span></span>
<span data-ttu-id="3ebc8-267">Unter Windows Vista aushandiert ein Empfänger standardmäßig einen Fenster Skalierungsfaktor von 8 für eine maximale echte Fenstergröße von 16.776.960 bytes.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-267">On Windows Vista, a receiver by default negotiates a window scale factor of 8 for a maximum true window size of 16,776,960 bytes.</span></span>
<span data-ttu-id="3ebc8-268">Wenn Daten über einen schnellen Link fließen, beginnt Windows zunächst mit einer 64 Kilobyte echten Fenstergröße, indem das Fenster Feld des TCP-Headers auf 256 festgelegt und der Fenster Skalierungsfaktor in den TCP-Optionen auf 8 festgelegt wird (256 \* 2 ^ 8 = 64 KB).</span><span class="sxs-lookup"><span data-stu-id="3ebc8-268">When data begins to flow on a fast link, Windows initially starts with a 64 Kilobyte true window size by setting the Window field of the TCP header to 256 and setting the window scale factor to 8 in the TCP options (256\*2^8=64KB).</span></span>
<span data-ttu-id="3ebc8-269">Einige Internet Gateway-Geräte und Firewalls ignorieren den Fenster Skalierungsfaktor und betrachten nur das Feld "angekündigtes Fenster" im als 256 angegebenen TCP-Header und legen eingehende Pakete für die Verbindung ab, die mehr als 256 Bytes an TCP-Daten enthalten.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-269">Some Internet gateway devices and firewalls ignore the window scale factor and only look at the advertised Window field in the TCP header specified as 256, and drop incoming packets for the connection that contain more than 256 bytes of TCP data.</span></span>
<span data-ttu-id="3ebc8-270">Zur Unterstützung der Skalierung von TCP-Empfangs Fenstern muss ein Gatewaygerät oder eine Firewall den TCP-Handshake überwachen und den ausgehandelten Fenster Skalierungsfaktor als Teil der TCP-Verbindungsdaten verfolgen.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-270">To support TCP receive window scaling, a gateway device or firewall must monitor the TCP handshake and track the negotiated window scale factor as part of the TCP connection data.</span></span>
<span data-ttu-id="3ebc8-271">Außerdem ignorieren einige Anwendungen und TCP-Stapel Implementierungen auf anderen Plattformen die TCP-wsopt-Erweiterung und den Fenster Skalierungsfaktor.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-271">Also some applications and TCP stack implementations on other platforms ignore the TCP WSopt extension and the window scaling factor.</span></span>
<span data-ttu-id="3ebc8-272">Daher kann der Remote Host, der die Daten sendet, Daten mit der im Feld "Fenster" des TCP-Headers (256 Bytes) angekündigten Rate senden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-272">So the remote host sending the data may send data at the rate advertised in the Window field of the TCP header (256 bytes).</span></span>
<span data-ttu-id="3ebc8-273">Dies kann dazu führen, dass Daten vom Empfänger sehr langsam empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-273">This can result in data being received very slowly by the receiver.</span></span>

<span data-ttu-id="3ebc8-274">Wenn Sie das Element **verhalted** auf **wsaverhalorautotuning** und die **targetosversion** auf Windows Vista festlegen, wird der Fenster Skalierungsfaktor auf 2 reduziert, sodass das Fenster Feld im TCP-Header anfänglich auf 16.384 Bytes und der Fenster Skalierungsfaktor auf 2 festgelegt ist, sodass eine anfängliche echte Fenster Empfangs Größe von 64 KB beträgt.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-274">Setting the **BehaviorId** member to **WsaBehaviorAutoTuning** and the **TargetOsVersion** to Windows Vista reduces the window scale factor to 2, so the Window field in the TCP header is initially set to 16,384 bytes and the window scale factor is set to 2 for an initial true window receive size of 64K bytes.</span></span>
<span data-ttu-id="3ebc8-275">Die Funktion zur automatischen Optimierung von Fenstern kann dann die Größe des echten Fenster Empfangs auf bis zu 262.140 bytes erhöhen, indem das Fenster Feld im TCP-Header auf 65.535 Bytes festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-275">The window auto-tuning feature can then increase the true window receive size up to 262,140 bytes by setting the Window field in the TCP header to 65,535 bytes.</span></span>
<span data-ttu-id="3ebc8-276">Eine Anwendung sollte den **\_ Kompatibilitätsmodus für den- \_ Kompatibilitäts \_ Modus von SIO** festlegen, sobald ein Socket erstellt wird, da diese Option nicht sinnvoll ist oder nach dem Senden eines SYN-Vorgangs angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-276">An application should set the **SIO\_SET\_COMPATIBILITY\_MODE** IOCTL as soon as a socket is created, since this option doesn't make sense or apply after a SYN is sent.</span></span>
<span data-ttu-id="3ebc8-277">Das Festlegen dieser Option hat dieselbe Auswirkung wie der folgende Befehl: `netsh interface tcp set global autotuninglevel=highlyrestricted`</span><span class="sxs-lookup"><span data-stu-id="3ebc8-277">Setting this option has the same impact as the following command: `netsh interface tcp set global autotuninglevel=highlyrestricted`</span></span>

<span data-ttu-id="3ebc8-278">Beachten Sie, dass die Header Datei " *mtausockdef. h* " automatisch in " *mswap. h* " oder " *nettiodef. h*" enthalten ist und nicht direkt verwendet werden sollte.</span><span class="sxs-lookup"><span data-stu-id="3ebc8-278">Note that the *Mswsockdef.h* header file is automatically included in *Mswsock.h* or *Netiodef.h*, and should not be used directly.</span></span>

## <a name="see-also"></a><span data-ttu-id="3ebc8-279">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="3ebc8-279">See also</span></span>

[<span data-ttu-id="3ebc8-280">**Glühbirne**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-280">**socket**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-socket)

[<span data-ttu-id="3ebc8-281">**WSAGetLastError**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-281">**WSAGetLastError**</span></span>](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror)

[<span data-ttu-id="3ebc8-282">**Wsagein verlappedresult**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-282">**WSAGetOverlappedResult**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-wsagetoverlappedresult)

[<span data-ttu-id="3ebc8-283">**WSAIoctl**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-283">**WSAIoctl**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-wsaioctl)

[<span data-ttu-id="3ebc8-284">**Wsaoverlgetauscht**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-284">**WSAOVERLAPPED**</span></span>](/windows/desktop/api/winsock2/ns-winsock2-wsaoverlapped)

[<span data-ttu-id="3ebc8-285">**Wsasocketa**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-285">**WSASocketA**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-wsasocketa)

[<span data-ttu-id="3ebc8-286">**Wsasocketw**</span><span class="sxs-lookup"><span data-stu-id="3ebc8-286">**WSASocketW**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-wsasocketw)
