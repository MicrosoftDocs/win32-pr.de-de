---
title: Geometry Shader Stage
description: Die Geometry-Shader-Phase (GS) führt anwendungsspezifischen Shadercode mit Scheiteltices als Eingabe und der Möglichkeit aus, Scheitelungen bei der Ausgabe zu generieren.
ms.assetid: F3208862-980E-403F-9154-13B34A882787
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3099ed5ede8dd89dc607ed838ff6e3fabfb16a69
ms.sourcegitcommit: ca37395fd832e798375e81142b97cffcffabf184
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/24/2021
ms.locfileid: "110335364"
---
# <a name="geometry-shader-stage"></a><span data-ttu-id="8e8a2-103">Geometry Shader Stage</span><span class="sxs-lookup"><span data-stu-id="8e8a2-103">Geometry Shader Stage</span></span>

<span data-ttu-id="8e8a2-104">Die Geometry-Shader-Phase (GS) führt anwendungsspezifischen Shadercode mit Scheiteltices als Eingabe und der Möglichkeit aus, Scheitelungen bei der Ausgabe zu generieren.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-104">The geometry-shader (GS) stage runs application-specified shader code with vertices as input and the ability to generate vertices on output.</span></span>

## <a name="the-geometry-shader"></a><span data-ttu-id="8e8a2-105">Der Geometrie-Shader</span><span class="sxs-lookup"><span data-stu-id="8e8a2-105">The Geometry Shader</span></span>

<span data-ttu-id="8e8a2-106">Im Gegensatz zu Vertex-Shadern, die auf einem einzelnen Scheitelpunkt arbeiten, sind die Eingaben des Geometrie-Shaders die Scheitelpunkte für einen vollständigen Primitiven (zwei Scheitelpunkte für Linien, drei Scheitelpunkte für Dreiecke oder ein scheitelpunkt für Punkt).</span><span class="sxs-lookup"><span data-stu-id="8e8a2-106">Unlike vertex shaders, which operate on a single vertex, the geometry shader's inputs are the vertices for a full primitive (two vertices for lines, three vertices for triangles, or single vertex for point).</span></span> <span data-ttu-id="8e8a2-107">Geometrie-Shader können auch die Scheitelpunktdaten für die an den Rand angrenzenden Primitiven als Eingabe (zwei zusätzliche Scheitelpunkte für eine Linie, weitere drei für ein Dreieck) als Eingabe verwenden.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-107">Geometry shaders can also bring in the vertex data for the edge-adjacent primitives as input (an additional two vertices for a line, an additional three for a triangle).</span></span> <span data-ttu-id="8e8a2-108">Die folgende Abbildung zeigt ein Dreieck und eine Linie mit angrenzenden Scheitellinien.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-108">The following illustration shows a triangle and a line with adjacent vertices.</span></span>

![Abbildung eines Dreiecks und einer Linie mit angrenzenden Scheitellinien](images/d3d10-gs.png)

|     | <span data-ttu-id="8e8a2-110">type</span><span class="sxs-lookup"><span data-stu-id="8e8a2-110">Type</span></span>                |
|-----|-----------------|
| <span data-ttu-id="8e8a2-111">**TV**</span><span class="sxs-lookup"><span data-stu-id="8e8a2-111">**TV**</span></span>  | <span data-ttu-id="8e8a2-112">Dreiecksvertex</span><span class="sxs-lookup"><span data-stu-id="8e8a2-112">Triangle vertex</span></span> |
| <span data-ttu-id="8e8a2-113">**Av**</span><span class="sxs-lookup"><span data-stu-id="8e8a2-113">**AV**</span></span>  | <span data-ttu-id="8e8a2-114">Benachbarter Scheitelpunkt</span><span class="sxs-lookup"><span data-stu-id="8e8a2-114">Adjacent vertex</span></span> |
| <span data-ttu-id="8e8a2-115">**Lv**</span><span class="sxs-lookup"><span data-stu-id="8e8a2-115">**LV**</span></span>  | <span data-ttu-id="8e8a2-116">Linienvertex</span><span class="sxs-lookup"><span data-stu-id="8e8a2-116">Line vertex</span></span>     |



 

<span data-ttu-id="8e8a2-117">Die Geometry-Shader-Stufe kann den vom SV PrimitiveID-System generierten Wert nutzen, der automatisch von der \_ IA generiert [](d3d10-graphics-programming-guide-input-assembler-stage-using.md) wird.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-117">The geometry-shader stage can consume the SV\_PrimitiveID [system-generated value](d3d10-graphics-programming-guide-input-assembler-stage-using.md) that is auto-generated by the IA.</span></span> <span data-ttu-id="8e8a2-118">Auf diese Weise können primitive Daten abgerufen oder bei Wunsch berechnet werden.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-118">This allows per-primitive data to be fetched or computed if desired.</span></span>

<span data-ttu-id="8e8a2-119">Die geometry-shader-Stufe kann mehrere Scheitelpunkts aus einer einzigen ausgewählten Topologie aus geben (ausgabetopologien der GS-Stufe sind verfügbar: tristrip, linestrip und pointlist).</span><span class="sxs-lookup"><span data-stu-id="8e8a2-119">The geometry-shader stage is capable of outputting multiple vertices forming a single selected topology (GS stage output topologies available are: tristrip, linestrip, and pointlist).</span></span> <span data-ttu-id="8e8a2-120">Die Anzahl der ausgegebenen Primitive kann bei jedem Aufruf des Geometrie-Shaders frei variieren, obwohl die maximale Anzahl von Scheitelzeichen, die ausgegeben werden könnten, statisch deklariert werden muss.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-120">The number of primitives emitted can vary freely within any invocation of the geometry shader, though the maximum number of vertices that could be emitted must be declared statically.</span></span> <span data-ttu-id="8e8a2-121">Striplängen, die von einem Aufruf eines Geometrie-Shaders ausgegeben werden, können beliebig sein, und neue Strips können über die RESTARTStrip-HLSL-Funktion erstellt werden. [](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-so-restartstrip)</span><span class="sxs-lookup"><span data-stu-id="8e8a2-121">Strip lengths emitted from a geometry shader invocation can be arbitrary, and new strips can be created via the [RestartStrip](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-so-restartstrip) HLSL function.</span></span>

<span data-ttu-id="8e8a2-122">Die Ausgabe des Geometrie-Shaders kann über die Streamausgabephase an die Rasterizerphase und/oder an einen Scheitelpunktpuffer im Arbeitsspeicher übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-122">Geometry shader output may be fed to the rasterizer stage and/or to a vertex buffer in memory via the stream output stage.</span></span> <span data-ttu-id="8e8a2-123">Die an den Arbeitsspeicher gespeiste Ausgabe wird auf einzelne Punkt-/Linien-/Dreieckslisten erweitert (genau so, wie sie an den Rasterizer übergeben würden).</span><span class="sxs-lookup"><span data-stu-id="8e8a2-123">Output fed to memory is expanded to individual point/line/triangle lists (exactly as they would be passed to the rasterizer).</span></span>

<span data-ttu-id="8e8a2-124">Wenn ein Geometrie-Shader aktiv ist, wird er einmal für jeden Primitiven aufgerufen, der zuvor in der Pipeline übergeben oder generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-124">When a geometry shader is active, it is invoked once for every primitive passed down or generated earlier in the pipeline.</span></span> <span data-ttu-id="8e8a2-125">Jeder Aufruf des geometry-Shaders betrachtet die Daten für den aufrufende Primitiven als Eingabe, unabhängig davon, ob es sich um einen einzelnen Punkt, eine einzelne Linie oder ein einzelnes Dreieck handelt.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-125">Each invocation of the geometry shader sees as input the data for the invoking primitive, whether that is a single point, a single line, or a single triangle.</span></span> <span data-ttu-id="8e8a2-126">Ein Dreiecksstreifen von früher in der Pipeline würde zu einem Aufruf des Geometrie-Shaders für jedes einzelne Dreieck im Strip führen (so, als ob der Strip in eine Dreiecksliste erweitert würde).</span><span class="sxs-lookup"><span data-stu-id="8e8a2-126">A triangle strip from earlier in the pipeline would result in an invocation of the geometry shader for each individual triangle in the strip (as if the strip were expanded out into a triangle list).</span></span> <span data-ttu-id="8e8a2-127">Alle Eingabedaten für jeden Scheitelpunkt im einzelnen Primitiven sind verfügbar (d. h. drei Scheitelpunkte für Dreieck) sowie ggf. angrenzende Scheitelpunktdaten.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-127">All the input data for each vertex in the individual primitive is available (i.e. 3 vertices for triangle), plus adjacent vertex data if applicable/available.</span></span>

<span data-ttu-id="8e8a2-128">Ein Geometry-Shader gibt Daten nacheinander nacheinander aus, indem Scheitelpunkte an ein Ausgabestreamobjekt angefügt werden.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-128">A geometry shader outputs data one vertex at a time by appending vertices to an output stream object.</span></span> <span data-ttu-id="8e8a2-129">Die Topologie der Datenströme wird durch eine feste Deklaration bestimmt, bei der folgendes ausgewählt wird: PointStream, LineStream oder TriangleStream als Ausgabe für die GS-Phase.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-129">The topology of the streams is determined by a fixed declaration, choosing one of: PointStream, LineStream, or TriangleStream as the output for the GS stage.</span></span> <span data-ttu-id="8e8a2-130">Es sind drei Arten von Streamobjekten verfügbar: PointStream, LineStream und TriangleStream, bei denen es sich um Objekte mit Vorlagen handelt.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-130">There are three types of stream objects available, PointStream, LineStream and TriangleStream which are all templated objects.</span></span> <span data-ttu-id="8e8a2-131">Die Topologie der Ausgabe wird durch ihren jeweiligen Objekttyp bestimmt, während das Format der an den Stream angefügten Scheitelpunkte vom Vorlagentyp bestimmt wird.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-131">The topology of the output is determined by their respective object type, while the format of the vertices appended to the stream is determined by the template type.</span></span> <span data-ttu-id="8e8a2-132">Die Ausführung einer geometry-Shaderinstanz ist atomar aus anderen Aufrufen, mit der Ausnahme, dass den Streams hinzugefügte Daten seriell sind.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-132">Execution of a geometry shader instance is atomic from other invocations, except that data added to the streams is serial.</span></span> <span data-ttu-id="8e8a2-133">Die Ausgaben eines angegebenen Aufrufs eines Geometry-Shaders sind unabhängig von anderen Aufrufen (obwohl die Reihenfolge beachtet wird).</span><span class="sxs-lookup"><span data-stu-id="8e8a2-133">The outputs of a given invocation of a geometry shader are independent of other invocations (though ordering is respected).</span></span> <span data-ttu-id="8e8a2-134">Ein Geometrie-Shader, der Dreiecksstreifen generiert, startet bei jedem Aufruf einen neuen Strip.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-134">A geometry shader generating triangle strips will start a new strip on every invocation.</span></span>

<span data-ttu-id="8e8a2-135">Wenn eine Geometrie-Shaderausgabe als vom System interpretierter Wert identifiziert wird (z. B. SV \_ RenderTargetArrayIndex oder SV Position), untersucht die Hardware diese Daten und führt abhängig \_ vom Wert ein Verhalten aus, zusätzlich zur Möglichkeit, die Daten selbst zur Eingabe an die nächste Shaderphase zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-135">When a geometry shader output is identified as a System Interpreted Value (e.g. SV\_RenderTargetArrayIndex or SV\_Position), hardware looks at this data and performs some behavior dependent on the value, in addition to being able to pass the data itself to the next shader stage for input.</span></span> <span data-ttu-id="8e8a2-136">Wenn eine solche Datenausgabe des Geometrie-Shaders für die Hardware auf primitiver Basis (z. B. SV \_ RenderTargetArrayIndex oder SV ViewportArrayIndex) eine Bedeutung hat, anstatt auf Scheitelpunktbasis (z. B. \_ SV \_ ClipDistance n oder \[ SV Position), \] werden die pro \_ primitiven Daten aus dem für den primitiven Typ ausgegebenen führenden Scheitelpunkt übernommen.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-136">When such data output from the geometry shader has meaning to the hardware on a per-primitive basis (such as SV\_RenderTargetArrayIndex or SV\_ViewportArrayIndex), rather than on a per-vertex basis (such as SV\_ClipDistance\[n\] or SV\_Position), the per-primitive data is taken from the leading vertex emitted for the primitive.</span></span>

<span data-ttu-id="8e8a2-137">Teilweise abgeschlossene Primitive können vom Geometrie-Shader generiert werden, wenn der Geometrie-Shader endet und der Grundtyp unvollständig ist.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-137">Partially completed primitives could be generated by the geometry shader if the geometry shader ends and the primitive is incomplete.</span></span> <span data-ttu-id="8e8a2-138">Unvollständige Primitive werden automatisch verworfen.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-138">Incomplete primitives are silently discarded.</span></span> <span data-ttu-id="8e8a2-139">Dies ähnelt der Behandlung teilweise abgeschlossener Primitive durch die IA.</span><span class="sxs-lookup"><span data-stu-id="8e8a2-139">This is similar to the way the IA treats partially completed primitives.</span></span>

<span data-ttu-id="8e8a2-140">Der Geometrie-Shader kann Auslastungs- und Texturstastingvorgänge ausführen, bei denen keine Ableitungen des Bildschirmbereichs erforderlich sind (samplelevel, samplecmplevelzero, samplegrad).</span><span class="sxs-lookup"><span data-stu-id="8e8a2-140">The geometry shader can perform load and texture sampling operations where screen-space derivatives are not required (samplelevel, samplecmplevelzero, samplegrad).</span></span>

<span data-ttu-id="8e8a2-141">Folgende Algorithmen können im Geometrie-Shader implementiert werden:</span><span class="sxs-lookup"><span data-stu-id="8e8a2-141">Algorithms that can be implemented in the geometry shader include:</span></span>

-   <span data-ttu-id="8e8a2-142">Punkt-Sprite-Erweiterung</span><span class="sxs-lookup"><span data-stu-id="8e8a2-142">Point Sprite Expansion</span></span>
-   <span data-ttu-id="8e8a2-143">Dynamische Partikelsysteme</span><span class="sxs-lookup"><span data-stu-id="8e8a2-143">Dynamic Particle Systems</span></span>
-   <span data-ttu-id="8e8a2-144">Generierung von"/"Ellen"</span><span class="sxs-lookup"><span data-stu-id="8e8a2-144">Fur/Fin Generation</span></span>
-   <span data-ttu-id="8e8a2-145">Schattenvolumengenerierung</span><span class="sxs-lookup"><span data-stu-id="8e8a2-145">Shadow Volume Generation</span></span>
-   <span data-ttu-id="8e8a2-146">Single Pass Render-to-Cubemap</span><span class="sxs-lookup"><span data-stu-id="8e8a2-146">Single Pass Render-to-Cubemap</span></span>
-   <span data-ttu-id="8e8a2-147">Per-Primitive Materialtausch</span><span class="sxs-lookup"><span data-stu-id="8e8a2-147">Per-Primitive Material Swapping</span></span>
-   <span data-ttu-id="8e8a2-148">Per-Primitive MaterialSetup: Einschließlich der Generierung von baryzentrierten Koordinaten als primitive Daten, sodass ein Pixel-Shader eine benutzerdefinierte Attributinterpolation ausführen kann (ein Beispiel für eine höherwertige Normalinterpolation finden Sie unter [CubeMapGS-Beispiel](https://msdn.microsoft.com/library/Ee416398(v=VS.85).aspx)).</span><span class="sxs-lookup"><span data-stu-id="8e8a2-148">Per-Primitive Material Setup - Including generation of barycentric coordinates as primitive data so that a pixel shader can perform custom attribute interpolation (for an example of higher-order normal interpolation, see [CubeMapGS Sample](https://msdn.microsoft.com/library/Ee416398(v=VS.85).aspx)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="8e8a2-149">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="8e8a2-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8e8a2-150">Grafikpipeline</span><span class="sxs-lookup"><span data-stu-id="8e8a2-150">Graphics Pipeline</span></span>](overviews-direct3d-11-graphics-pipeline.md)
</dt> <dt>

[<span data-ttu-id="8e8a2-151">Pipelinestufen (Direct3D 10)</span><span class="sxs-lookup"><span data-stu-id="8e8a2-151">Pipeline Stages (Direct3D 10)</span></span>](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-pipeline-stages)
</dt> </dl>

 

 