---
title: Befehls Planung
description: Jedem Befehl ist eine Priorität zugeordnet.
ms.assetid: 63f6ba9d-0b87-403b-916b-aa8550f98a11
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 06512f0748aa88f6b32de3291e2ed1c262212ba2
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "106341455"
---
# <a name="command-scheduling"></a><span data-ttu-id="b6e5f-103">Befehls Planung</span><span class="sxs-lookup"><span data-stu-id="b6e5f-103">Command Scheduling</span></span>

## <a name="command-scheduling"></a><span data-ttu-id="b6e5f-104">Befehls Planung</span><span class="sxs-lookup"><span data-stu-id="b6e5f-104">Command Scheduling</span></span>

<span data-ttu-id="b6e5f-105">Befehle können jederzeit aus mehreren Kontexten an die TSB übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-105">Commands can be submitted to the TBS from multiple contexts at any time.</span></span> <span data-ttu-id="b6e5f-106">Ein physisches TPM kann jedoch nur jeweils einen Befehl verarbeiten, und einige Befehle können für einen längeren Zeitraum ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-106">However, a physical TPM can only process one command at a time, and some commands can run for a significant period of time.</span></span> <span data-ttu-id="b6e5f-107">Wenn mehrere Befehle ausstehend sind, entscheidet der TSB, welcher Befehl an das TPM gesendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-107">When multiple commands are pending, the TBS decides which command to send to the TPM.</span></span> <span data-ttu-id="b6e5f-108">Wenn ein Befehl übermittelt wird, ist jedem Befehl eine Priorität zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-108">When a command is submitted, each command has a priority associated with it.</span></span> <span data-ttu-id="b6e5f-109">Die TSB verwendet diese Prioritäten, um zu bestimmen, welcher ausstehende Befehl gesendet werden soll, wenn das TPM kostenlos ist.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-109">The TBS uses these priorities to determine which pending command to submit whenever the TPM is free.</span></span> <span data-ttu-id="b6e5f-110">Die vier Prioritätsstufen sind niedrig, normal, hoch und System.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-110">The four levels of priority are low, normal, high, and system.</span></span> <span data-ttu-id="b6e5f-111">Anwendungen sollten niedrige, normale oder hohe Priorität verwenden.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-111">Applications should use low, normal, or high priority.</span></span> <span data-ttu-id="b6e5f-112">Obwohl Befehle mit hoher Priorität üblicherweise vor Befehlen mit niedriger Priorität ausgeführt werden, hat der TSB-Befehls Planer eine Alterungs Richtlinie, die den Befehlen, die für einen längeren Zeitraum blockiert wurden, eine sehr hohe Priorität bietet.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-112">Although high-priority commands are usually executed before low-priority commands, the TBS command scheduler has an aging policy that eventually gives very high priority to commands that have been blocked for significant periods of time.</span></span>

## <a name="context-management"></a><span data-ttu-id="b6e5f-113">Kontext Verwaltung</span><span class="sxs-lookup"><span data-stu-id="b6e5f-113">Context Management</span></span>

<span data-ttu-id="b6e5f-114">Wenn ein TPM \_ savecontext-oder TPM2 contextsave-Befehl mit einem virtuellen Handle an eine von TSB verwaltete Ressource übermittelt wird, führt der TSB den entsprechenden Befehl für die physische Ressource aus und gibt das Ergebnis an den Aufrufer zurück, wenn die Ressource physisch im TPM vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-114">When a TPM\_SaveContext or TPM2 ContextSave command is submitted with a virtual handle to a resource that the TBS is managing, the TBS executes the appropriate command on the physical resource and returns the result to the caller if the resource is physically present in the TPM.</span></span> <span data-ttu-id="b6e5f-115">Wenn die Ressource nicht physisch im TPM vorhanden ist, bewirkt die Vorverarbeitung des TPM \_ savecontext-oder TPM2 \_ contextsave-Befehls, dass die Ressource erneut geladen wird. an diesem Punkt wird der Kontext gespeichert und an den Aufrufer zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-115">If the resource is not physically present in the TPM, the preprocessing of the TPM\_SaveContext or TPM2\_ContextSave command causes the resource to be reloaded, at which point the context will be saved and returned to the caller.</span></span> <span data-ttu-id="b6e5f-116">Wenn die zu speichernde Ressource einen Typ hat, der nach dem Speichern normalerweise automatisch vom TPM geleert wird, wird die virtuelle Ressource von TSB bei Abschluss dieses Befehls ungültig.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-116">If the resource being saved is of a type that is normally flushed automatically from the TPM after saving, the TBS invalidates the virtual resource upon completion of this command.</span></span> <span data-ttu-id="b6e5f-117">Wenn ein TPM- \_ loadcontext-oder TPM2 \_ contextload-Befehl an die TSB übermittelt wird, führt die TSB den Befehl sofort aus.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-117">When a TPM\_LoadContext or TPM2\_ContextLoad command is submitted to the TBS, the TBS executes the command immediately.</span></span> <span data-ttu-id="b6e5f-118">Wenn der Befehl erfolgreich abgeschlossen wird, virtualisiert die TSB das Ressourcen Handle und übergibt den resultierenden TPM-Bytestream an den Aufrufer.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-118">If the command completes successfully, the TBS virtualizes the resource handle and passes the resulting TPM byte stream to the caller.</span></span> <span data-ttu-id="b6e5f-119">Wenn ein TPM- \_ Befehl flushspecific oder TPM2 \_ flushcontext mit einem virtuellen Handle an eine von TSB verwaltete Ressource gesendet wird, führt die TSB einen TPM- \_ flushspecific-oder TPM2 \_ flushcontext-Befehl aus, um die Ressource aus dem TPM zu entfernen, wenn Sie physisch vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-119">When a TPM\_FlushSpecific or TPM2\_FlushContext command is submitted with a virtual handle to a resource that the TBS is managing, the TBS executes a TPM\_FlushSpecific or TPM2\_FlushContext command to evict the resource from the TPM if it is physically present.</span></span> <span data-ttu-id="b6e5f-120">In diesem Fall macht die TSB die virtuelle Ressource ungültig und gibt das Ergebnis des Flush-Befehls an den Aufrufer zurück.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-120">In this case, the TBS invalidates the virtual resource and returns the result of the flush command to the caller.</span></span> <span data-ttu-id="b6e5f-121">Wenn die Ressource nicht physisch im TPM vorhanden ist, wird die Ressource, die dem virtuellen Handle entspricht, durch die Vorverarbeitung des TPM- \_ flushspecific-oder TPM2 \_ flushcontext-Befehls geladen. Sie wird dann geleert, wenn der Befehl tatsächlich verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-121">If the resource is not physically present in the TPM, the preprocessing of the TPM\_FlushSpecific or TPM2\_FlushContext command will load the resource that corresponds to the virtual handle, but it will then be flushed when the command is actually processed.</span></span> <span data-ttu-id="b6e5f-122">TSB bietet keine Unterstützung für das TPM \_ keycontrolowner-Bit oder die keephandle-Funktionalität des TPM \_ loadcontext-Vorgangs, sodass eine Ressource nicht das gleiche Handle erhält, das Sie vor dem Speichern des Kontexts besaß.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-122">The TBS does not support the TPM\_KeyControlOwner bit or the keepHandle functionality of the TPM\_LoadContext operation, so it will not give a resource the same handle it had before the context was saved.</span></span>

## <a name="other-commands"></a><span data-ttu-id="b6e5f-123">Andere Befehle</span><span class="sxs-lookup"><span data-stu-id="b6e5f-123">Other Commands</span></span>

<span data-ttu-id="b6e5f-124">Befehle, die in dieser Dokumentation nicht erwähnt werden, werden verarbeitet, indem die virtuellen Schlüssel Handles durch physische Schlüssel Handles (falls erforderlich) ersetzt und an das TPM übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-124">Commands that are not mentioned in this documentation are processed by replacing virtual key handles with physical key handles (if necessary) and submitting them to the TPM.</span></span> <span data-ttu-id="b6e5f-125">Dies erfolgt nach dem Ausführen der entsprechenden Vorgänge, um sicherzustellen, dass die verwendeten Ressourcen physisch auf dem TPM vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-125">This is done after performing the appropriate operations to ensure that resources being used are physically present on the TPM.</span></span> <span data-ttu-id="b6e5f-126">Es wird keine zusätzliche besondere Verarbeitung durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-126">No additional special processing is performed.</span></span> <span data-ttu-id="b6e5f-127">Die TSB versucht nicht, die Genauigkeit der Virtualisierung zu verbessern, indem die vom TPM zurückgegebenen Daten als Teil einer TPM \_ getcapability-oder TPM2 \_ getcapability-Abfrage geändert werden.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-127">The TBS does not attempt to improve the fidelity of the virtualization by modifying data passed back from the TPM as part of a TPM\_GetCapabilities or TPM2\_GetCapability query.</span></span> <span data-ttu-id="b6e5f-128">Die TSB unterstützt auch die physischen TCG-Anwesenheits Befehle.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-128">The TBS also supports TCG Physical Presence commands.</span></span> <span data-ttu-id="b6e5f-129">Die TSB fungiert als Passthrough für Befehle für physische Präsenz. Es wird keine spezielle Verarbeitung durch die TSB selbst ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-129">The TBS acts as a pass-through for Physical Presence commands; no special processing is performed by the TBS itself.</span></span>

## <a name="cleanup"></a><span data-ttu-id="b6e5f-130">Cleanup</span><span class="sxs-lookup"><span data-stu-id="b6e5f-130">Cleanup</span></span>

<span data-ttu-id="b6e5f-131">Wenn ein Kontext beendet wird, werden alle zugeordneten physischen und virtuellen Ressourcen bereinigt, sodass keine Systemressourcen mehr beansprucht werden.</span><span class="sxs-lookup"><span data-stu-id="b6e5f-131">When a context exits, all physical and virtual resources associated with it are cleaned up so they no longer consume system resources.</span></span>

 

 




