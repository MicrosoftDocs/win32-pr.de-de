---
description: Mithilfe von Aktivierungs Kontexten können COM-Objekte verwendet werden, ohne dass Sie registriert werden müssen.
ms.assetid: e6ec7b8b-8032-4dff-8f96-07ae3ffc286d
title: Erstellen Registration-Free COM-Objekten
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70e377a04f44e6624294116b8274a8dcc1e82b8e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106362545"
---
# <a name="creating-registration-free-com-objects"></a><span data-ttu-id="2a99e-103">Erstellen Registration-Free COM-Objekten</span><span class="sxs-lookup"><span data-stu-id="2a99e-103">Creating Registration-Free COM Objects</span></span>

<span data-ttu-id="2a99e-104">Mithilfe von Aktivierungs Kontexten können COM-Objekte verwendet werden, ohne dass Sie registriert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="2a99e-104">Activation contexts enable COM objects to be used without requiring that they be registered.</span></span> <span data-ttu-id="2a99e-105">Dadurch kann Ihre Anwendung mehrere Komponenten mit unterschiedlichen Funktionen aufweisen, die auf Ihrer Version basieren, anstatt deren Registrierungsinformationen.</span><span class="sxs-lookup"><span data-stu-id="2a99e-105">This enables your application to have multiple components with different functionality based upon their version rather than their registry information.</span></span> <span data-ttu-id="2a99e-106">Mehrere Komponenten können dasselbe com-Objekt mit derselben GUID verfügbar machen, haben jedoch unterschiedliche Funktionen, die auf der Version basieren.</span><span class="sxs-lookup"><span data-stu-id="2a99e-106">Multiple components can expose the same COM object with the same GUID but have different functionality based on the version.</span></span>

<span data-ttu-id="2a99e-107">Wenn eine Anwendung eine GUID von [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid)anfordert, sucht com zuerst im aktiven Aktivierungs Kontext nach der Zuordnung von ProgID zu CLSID.</span><span class="sxs-lookup"><span data-stu-id="2a99e-107">When an application requests a GUID from [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid), COM first searches for the mapping from progid to CLSID in the active activation context.</span></span> <span data-ttu-id="2a99e-108">Wenn eine Anwendung mithilfe von [**cokreateinstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) einen Instanz-Schnittstellen Zeiger erhält, sucht com im aktiven Aktivierungs Kontext nach der dll, die die CLSID hostet.</span><span class="sxs-lookup"><span data-stu-id="2a99e-108">When an application uses [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to obtain an instance interface pointer, COM searches in the active activation context to find which DLL will host the CLSID.</span></span> <span data-ttu-id="2a99e-109">Wenn der Aktivierungs Kontext die erforderlichen Informationen nicht enthält, sucht com mithilfe der üblichen Methode nach den Informationen in der Registrierung.</span><span class="sxs-lookup"><span data-stu-id="2a99e-109">If the activation context does not contain the required information, COM then searches for the information in the registry using the usual method.</span></span>

<span data-ttu-id="2a99e-110">Beachten Sie, dass com den Aktivierungs Kontext des erstellenden Threads auf den Hostthread marshallst, da der Aktivierungs Kontext Thread bezogen ist, bevor [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) oder [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) auf dem Hostthread aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="2a99e-110">Note that because activation contexts are per-thread, COM marshals the activation context of the creating thread over to the host thread and activates it before calling [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) on the host thread.</span></span> <span data-ttu-id="2a99e-111">Diese Funktionalität ist in Windows bereits vorhanden, und der Client Code ist nicht erforderlich, um dies zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="2a99e-111">This functionality is already present in Windows, client code is not required to do anything to implement this.</span></span>

<span data-ttu-id="2a99e-112">COM-Klassen können von gehosteten Komponenten exportiert werden, ohne die Registrierung durchlaufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="2a99e-112">COM classes can be exported by hosted components without going through the registry.</span></span> <span data-ttu-id="2a99e-113">Mehrere Komponenten können dieselbe ProgID für verschiedene com-Objekte verfügbar machen, und ihre Hostinganwendung sollte nur den richtigen Aktivierungs Kontext finden und dann [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid) und [**cokreateinstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) verwenden, um die Schnittstellen Zeiger des gehosteten Objekts zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="2a99e-113">Multiple components can expose the same ProgID for different COM objects, and your hosting application should only find the proper activation context and then use [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid) and [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to get the hosted object's interface pointers.</span></span>

 

 
