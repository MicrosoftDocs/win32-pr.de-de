---
description: Wenn Sie Ihre eigenen parallelen Assemblys erstellen, befolgen Sie die Richtlinien zum Erstellen paralleler Assemblys.
ms.assetid: e5fc3bae-0646-4418-a8f7-369856f03cd5
title: Erstellen von DLLs für parallele Assemblys
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa15f3876c60ce55be00d60d8f417eb0c2cbf6ec
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104216547"
---
# <a name="authoring-dlls-for-side-by-side-assemblies"></a><span data-ttu-id="ccd90-103">Erstellen von DLLs für parallele Assemblys</span><span class="sxs-lookup"><span data-stu-id="ccd90-103">Authoring DLLs for Side-by-side Assemblies</span></span>

<span data-ttu-id="ccd90-104">Wenn Sie eigene parallele Assemblys erstellen, befolgen Sie die [Richtlinien zum Erstellen](guidelines-for-creating-side-by-side-assemblies.md) paralleler Assemblys und zum Erstellen beliebiger DLLs, die in der Assembly gemäß den folgenden Richtlinien verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="ccd90-104">When creating your own side-by-side assemblies, follow the [Guidelines for Creating Side-by-side Assemblies](guidelines-for-creating-side-by-side-assemblies.md) and author any DLLs used in the assembly according to the following guidelines:</span></span>

-   <span data-ttu-id="ccd90-105">Ihre DLLs sollten so entworfen werden, dass mehrere Versionen gleichzeitig und im selben Prozess ausgeführt werden können, ohne dass sich diese gegenseitig beeinträchtigen.</span><span class="sxs-lookup"><span data-stu-id="ccd90-105">Your DLLs should be designed so that multiple versions can run at the same time and in the same process without interfering with each other.</span></span> <span data-ttu-id="ccd90-106">Viele Anwendungen hosten z. b. mehrere Plug-ins, die jeweils eine andere Version einer Komponente benötigen.</span><span class="sxs-lookup"><span data-stu-id="ccd90-106">For example, many applications host multiple plug-ins that each require a different version of one component.</span></span> <span data-ttu-id="ccd90-107">Der Entwickler muss die parallele Assembly entwerfen und testen, um sicherzustellen, dass mehrere Versionen der Komponenten ordnungsgemäß funktionieren, wenn Sie gleichzeitig im selben Prozess ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ccd90-107">The developer the side-by-side assembly needs to design and test to ensure that multiple versions of the component work correctly when run at the same time in the same process.</span></span>

-   <span data-ttu-id="ccd90-108">Wenn Sie beabsichtigen, die Komponente als freigegebene Komponente auf Systemen vor Windows XP bereitzustellen, müssen Sie die Komponente auf diesen Systemen weiterhin als eine einzelne Instanz freigegebene Komponente installieren.</span><span class="sxs-lookup"><span data-stu-id="ccd90-108">If you plan to provide your component as a shared component on systems earlier than Windows XP, you need to continue to install the component on these systems as a single-instance shared component.</span></span> <span data-ttu-id="ccd90-109">In diesem Fall müssen Sie sicherstellen, dass die Komponente abwärts kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="ccd90-109">In this case, you need to ensure your component is backward compatible.</span></span>

-   <span data-ttu-id="ccd90-110">Evaluieren Sie die Verwendung von-Objekten, wenn mehr als eine Version der Assembly auf dem System ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ccd90-110">Evaluate the use of objects when more than one version of your assembly is run on the system.</span></span> <span data-ttu-id="ccd90-111">Stellen Sie fest, ob für verschiedene Versionen der Assembly separate Datenstrukturen erforderlich sind, wie z. b. Speicher Abbild Dateien, Named Pipes, registrierte Windows-Meldungen und-Klassen, gemeinsam genutzter Speicher, Semaphore, Mutexe und Hardwaretreiber.</span><span class="sxs-lookup"><span data-stu-id="ccd90-111">Determine whether different versions of the assembly require separate data structures, such as memory-mapped files, named pipes, registered Windows messages and classes, shared memory, semaphores, mutexes, and hardware drivers.</span></span> <span data-ttu-id="ccd90-112">Alle Datenstrukturen, die in Assemblyversionen verwendet werden, müssen abwärts kompatibel sein.</span><span class="sxs-lookup"><span data-stu-id="ccd90-112">Any data structures used across assembly versions must be backward-compatible.</span></span> <span data-ttu-id="ccd90-113">Entscheiden Sie, welche Datenstrukturen in verschiedenen Versionen verwendet werden können und welche Datenstrukturen für eine Version privat sein müssen.</span><span class="sxs-lookup"><span data-stu-id="ccd90-113">Decide which data structures can be used across versions, and which data structures must be private to a version.</span></span> <span data-ttu-id="ccd90-114">Stellen Sie fest, ob freigegebene Datenstrukturen separate Synchronisierungs Objekte erfordern, z. b. Semaphore und Mutexe.</span><span class="sxs-lookup"><span data-stu-id="ccd90-114">Determine whether shared data structures require separate synchronization objects, such as semaphores and mutexes.</span></span>

-   <span data-ttu-id="ccd90-115">Einige Objekte, z. b. Fenster Klassen und Atome, werden für jeden Prozess eindeutig benannt.</span><span class="sxs-lookup"><span data-stu-id="ccd90-115">Some objects, such as window classes and Atoms, are uniquely named for each process.</span></span> <span data-ttu-id="ccd90-116">Objekte, wie z. b. Fenster Klassen, sollten für jede Assembly mit dem Manifest versioniert werden.</span><span class="sxs-lookup"><span data-stu-id="ccd90-116">Objects such as window classes should be versioned for each assembly using the manifest.</span></span> <span data-ttu-id="ccd90-117">Verwenden Sie für Objekte, wie z. b. Atome, versionsspezifische Bezeichner, es sei denn, Sie planen eine Versions übergreifende Freigabe.</span><span class="sxs-lookup"><span data-stu-id="ccd90-117">For objects such as Atoms, use version-specific identifiers unless you plan to share across versions.</span></span> <span data-ttu-id="ccd90-118">Wenn Sie versionsspezifische Bezeichner verwenden, verwenden Sie die vierteilige Versionsnummer.</span><span class="sxs-lookup"><span data-stu-id="ccd90-118">If you use version-specific identifiers, use the four-part versioning number.</span></span>

-   <span data-ttu-id="ccd90-119">Fügen Sie keinen selbst Registrierungscode in eine DLL ein.</span><span class="sxs-lookup"><span data-stu-id="ccd90-119">Include no self-registering code in any DLL.</span></span> <span data-ttu-id="ccd90-120">Eine DLL in einer parallelen Assembly kann nicht selbst registriert werden.</span><span class="sxs-lookup"><span data-stu-id="ccd90-120">A DLL in a side-by-side assembly cannot be self-registering.</span></span>

-   <span data-ttu-id="ccd90-121">Definieren Sie alle Versions spezifischen Namen in der DLL mit \# define-Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="ccd90-121">Define all version-specific names in your DLL with \#define statements.</span></span> <span data-ttu-id="ccd90-122">Dadurch können alle Registrierungsschlüssel von einem Speicherort aus geändert werden.</span><span class="sxs-lookup"><span data-stu-id="ccd90-122">This enables all registry keys to be changed from one location.</span></span> <span data-ttu-id="ccd90-123">Wenn Sie eine neue Version der Assembly freigeben, müssen Sie diese define-Anweisung nur ändern \# .</span><span class="sxs-lookup"><span data-stu-id="ccd90-123">When you release a new version of your assembly, you only need to change this \#define statement.</span></span> <span data-ttu-id="ccd90-124">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="ccd90-124">For example:</span></span>

    `#define MyRegistryKey "MyAssembly1.0.0.0"`

-   <span data-ttu-id="ccd90-125">Speichern Sie alle nicht persistenten Daten im temporären Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="ccd90-125">Store any nonpersistent data in the Temp directory.</span></span>

-   <span data-ttu-id="ccd90-126">Legen Sie keine Benutzerdaten an globalen Speicherorten ab.</span><span class="sxs-lookup"><span data-stu-id="ccd90-126">Do not put user data into global locations.</span></span> <span data-ttu-id="ccd90-127">Halten Sie die Anwendungsdaten von den Benutzerdaten getrennt.</span><span class="sxs-lookup"><span data-stu-id="ccd90-127">Keep application data separate from user data.</span></span>

-   <span data-ttu-id="ccd90-128">Weisen Sie alle freigegebenen Dateien einer Dateiversion zu, die vom Namen der Anwendung abhängt.</span><span class="sxs-lookup"><span data-stu-id="ccd90-128">Assign all shared files a file version that depends upon the application's name.</span></span>

-   <span data-ttu-id="ccd90-129">Weisen Sie alle Nachrichten und Datenstrukturen zu, die für die Verarbeitung einer Version verwendet werden, um eine unbeabsichtigte prozessübergreifende Freigabe zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="ccd90-129">Assign all messages and data structures used across processes a version to prevent unintentional cross-process sharing.</span></span>

-   <span data-ttu-id="ccd90-130">Die dll sollte nicht von der Freigabe über Versionen abhängen, die möglicherweise nicht vorhanden sind, wie z. b. freigegebene Speicher Abschnitte, die nicht für verschiedene Versionen der Assembly freigegeben sind.</span><span class="sxs-lookup"><span data-stu-id="ccd90-130">Your DLL should not depend upon sharing across versions that may not exist, such as shared memory sections that are not shared across different versions of your assembly.</span></span>

-   <span data-ttu-id="ccd90-131">Wenn Sie neue Funktionen hinzufügen, die nicht dem Binär Schnittstellen-Kompatibilitäts Vertrag der ursprünglichen dll folgen, müssen Sie eine neue CLSID, ProgID und einen Dateinamen zuweisen.</span><span class="sxs-lookup"><span data-stu-id="ccd90-131">If you add new functionality that does not follow the binary interface compatibility contract of the original DLL, you must assign a new CLSID, ProgId, and file name.</span></span> <span data-ttu-id="ccd90-132">In zukünftigen Versionen ihrer parallelen Assembly müssen diese CLSID, ProgID und der Dateiname verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ccd90-132">Future versions of your side-by-side assembly is then required to use this CLSID, ProgId, and file name.</span></span> <span data-ttu-id="ccd90-133">Dies verhindert einen Konflikt, wenn eine Version der dll, die nicht nebeneinander ist, über eine Seite-an-Seite-Version registriert wird.</span><span class="sxs-lookup"><span data-stu-id="ccd90-133">This prevents a conflict when a version of the DLL that is not side-by-side is registered over a side-by-side version.</span></span>

-   <span data-ttu-id="ccd90-134">Wenn Sie dieselbe CLSID oder ProgID wieder verwenden, testen Sie, um sicherzustellen, dass die Assembly abwärts kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="ccd90-134">If you reuse the same CLSID or ProgId, test to ensure that the assembly is backward compatible.</span></span>

-   <span data-ttu-id="ccd90-135">Initialisieren Sie die Standardeinstellungen für die Assembly im Assemblycode, und legen Sie Sie fest.</span><span class="sxs-lookup"><span data-stu-id="ccd90-135">Initialize and set the default settings for the assembly in the assembly code.</span></span> <span data-ttu-id="ccd90-136">Speichern Sie die Standardeinstellungen nicht in der Registrierung.</span><span class="sxs-lookup"><span data-stu-id="ccd90-136">Do not save the defaults settings in the registry.</span></span>

-   <span data-ttu-id="ccd90-137">Weisen Sie allen Datenstrukturen Versionen zu.</span><span class="sxs-lookup"><span data-stu-id="ccd90-137">Assign versions to all data structures.</span></span>

-   <span data-ttu-id="ccd90-138">In Ihrer dll sollte der Status der parallelen Assembly gespeichert werden, wie unter [Authoring State Storage for Side-by-Side](authoring-state-storage-for-side-by-side-assemblies.md)Assemblys beschrieben.</span><span class="sxs-lookup"><span data-stu-id="ccd90-138">Your DLL should store the state of the side-by-side assembly as described in [Authoring State Storage for Side-by-Side Assemblies](authoring-state-storage-for-side-by-side-assemblies.md).</span></span>

 

 



