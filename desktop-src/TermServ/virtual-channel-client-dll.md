---
title: Client-DLL des virtuellen Kanals
description: Der Client einer virtuellen Channels-Anwendung ist eine DLL, die während der Remotedesktopdienste Initialisierung auf dem Client Computer geladen wird. Die dll muss auf dem Client Computer registriert werden.
ms.assetid: fca0505c-c4a9-4230-aeaa-ff3dfa62f581
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cfd7ffccda8b1da7dfc3920b0a47a12e97840e0a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104037023"
---
# <a name="virtual-channel-client-dll"></a><span data-ttu-id="c6534-104">Client-DLL des virtuellen Kanals</span><span class="sxs-lookup"><span data-stu-id="c6534-104">Virtual Channel Client DLL</span></span>

<span data-ttu-id="c6534-105">Der Client einer virtuellen Channels-Anwendung ist eine DLL, die während der Remotedesktopdienste Initialisierung auf dem Client Computer geladen wird.</span><span class="sxs-lookup"><span data-stu-id="c6534-105">The client of a virtual channels application is a DLL that is loaded during the Remote Desktop Services initialization on the client computer.</span></span> <span data-ttu-id="c6534-106">Die dll muss auf dem Client Computer registriert werden.</span><span class="sxs-lookup"><span data-stu-id="c6534-106">The DLL must be registered on the client computer.</span></span> <span data-ttu-id="c6534-107">Weitere Informationen finden Sie unter [Virtual Channel Client Registration](virtual-channel-client-registration.md).</span><span class="sxs-lookup"><span data-stu-id="c6534-107">For more information, see [Virtual Channel Client Registration](virtual-channel-client-registration.md).</span></span>

<span data-ttu-id="c6534-108">Die Client-DLL muss eine [**virtualchannelentry**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelentry) -Funktion exportieren, die während der Initialisierung Remotedesktopdienste aufruft.</span><span class="sxs-lookup"><span data-stu-id="c6534-108">The client DLL must export a [**VirtualChannelEntry**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelentry) function, which Remote Desktop Services calls during initialization.</span></span> <span data-ttu-id="c6534-109">Der Einstiegspunkt " **virtualchannelentry** " erhält einen Zeiger auf die Struktur der [**Kanal \_ Einstiegs \_ Punkte**](/windows/win32/api/cchannel/ns-cchannel-channel_entry_points) .</span><span class="sxs-lookup"><span data-stu-id="c6534-109">The **VirtualChannelEntry** entry point receives a pointer to a [**CHANNEL\_ENTRY\_POINTS**](/windows/win32/api/cchannel/ns-cchannel-channel_entry_points) structure.</span></span> <span data-ttu-id="c6534-110">Diese Struktur enthält Zeiger auf die Funktionen, die von der Client-DLL aufgerufen werden, um auf virtuelle Kanäle zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="c6534-110">This structure contains pointers to the functions that the client DLL calls to access virtual channels.</span></span>



| <span data-ttu-id="c6534-111">Funktion</span><span class="sxs-lookup"><span data-stu-id="c6534-111">Function</span></span>                                                      | <span data-ttu-id="c6534-112">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="c6534-112">Description</span></span>                                                                                                                                                                                                                                                                           |
|---------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c6534-113">**Virtualchannelinit**</span><span class="sxs-lookup"><span data-stu-id="c6534-113">**VirtualChannelInit**</span></span>](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit)<br/>   | <span data-ttu-id="c6534-114">Registriert die Namen der virtuellen Kanäle, die vom Client verwendet werden sollen, und stellt eine [**virtualchannelinitevent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_init_event_fn) -Rückruffunktion bereit, über die Remotedesktopdienste den Client über Ereignisse benachrichtigt, die die Client Verbindung beeinflussen.</span><span class="sxs-lookup"><span data-stu-id="c6534-114">Registers the names of the virtual channels to be used by the client and provides a [**VirtualChannelInitEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_init_event_fn) callback function through which Remote Desktop Services notifies the client about events that affect the client connection.</span></span><br/> |
| [<span data-ttu-id="c6534-115">**Virtualchannelopen**</span><span class="sxs-lookup"><span data-stu-id="c6534-115">**VirtualChannelOpen**</span></span>](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen)<br/>   | <span data-ttu-id="c6534-116">Öffnet das Client Ende eines angegebenen virtuellen Kanals und stellt eine [**virtualchannelopenevent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) -Rückruffunktion bereit, über die Remotedesktopdienste den Client über Ereignisse benachrichtigt, die den virtuellen Kanal betreffen.</span><span class="sxs-lookup"><span data-stu-id="c6534-116">Opens the client end of a specified virtual channel and provides a [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) callback function through which Remote Desktop Services notifies the client about events that affect the virtual channel.</span></span><br/>                    |
| [<span data-ttu-id="c6534-117">**Virtualchannelwrite**</span><span class="sxs-lookup"><span data-stu-id="c6534-117">**VirtualChannelWrite**</span></span>](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelwrite)<br/> | <span data-ttu-id="c6534-118">Schreibt Daten in einen virtuellen Kanal.</span><span class="sxs-lookup"><span data-stu-id="c6534-118">Writes data to a virtual channel.</span></span> <span data-ttu-id="c6534-119">Remotedesktopdienste sendet diese Daten an das Server Ende des virtuellen Kanals.</span><span class="sxs-lookup"><span data-stu-id="c6534-119">Remote Desktop Services sends this data to the server end of the virtual channel.</span></span> <span data-ttu-id="c6534-120">Das Server Ende Ruft die [**Wout virtualchannelread**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread) -Funktion auf, um die Daten zu lesen.</span><span class="sxs-lookup"><span data-stu-id="c6534-120">The server end calls the [**WTSVirtualChannelRead**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread) function to read the data.</span></span><br/>                                             |
| [<span data-ttu-id="c6534-121">**Virtualchannelclose**</span><span class="sxs-lookup"><span data-stu-id="c6534-121">**VirtualChannelClose**</span></span>](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelclose)<br/> | <span data-ttu-id="c6534-122">Schließt einen virtuellen Kanal.</span><span class="sxs-lookup"><span data-stu-id="c6534-122">Closes a virtual channel.</span></span><br/>                                                                                                                                                                                                                                                  |



 

<span data-ttu-id="c6534-123">Die [**virtualchannelentry**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelentry) -Funktion der dll muss die [**virtualchannelinit**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit) -Funktion aufrufen, um den Zugriff auf virtuelle Kanäle zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="c6534-123">Your DLL's [**VirtualChannelEntry**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelentry) function must call the [**VirtualChannelInit**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit) function to initialize access to virtual channels.</span></span> <span data-ttu-id="c6534-124">Wenn Sie **virtualchannelinit** aufgerufen haben, müssen Sie einen Zeiger an die [**virtualchannelinitevent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_init_event_fn) -Rückruffunktion übergeben.</span><span class="sxs-lookup"><span data-stu-id="c6534-124">When you call **VirtualChannelInit**, you must pass a pointer to the [**VirtualChannelInitEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_init_event_fn) callback function.</span></span> <span data-ttu-id="c6534-125">Remotedesktopdienste ruft diese Rückruffunktion auf, wenn die Initialisierung abgeschlossen ist, und wieder, wenn eine Verbindung mit einem Remotedesktop-Sitzungshost (RD-Sitzungshost) Server hergestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="c6534-125">Remote Desktop Services calls this callback function when initialization is complete and again when a connection has been established with a Remote Desktop Session Host (RD Session Host) server.</span></span>

<span data-ttu-id="c6534-126">Nachdem die Verbindung hergestellt wurde, können Sie die [**virtualchannelopen**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen) -Funktion zum Öffnen der durch den [**virtualchannelinit**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit) -Befehl registrierten virtuellen Kanäle aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="c6534-126">After the connection is established, you can call the [**VirtualChannelOpen**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen) function to open the virtual channels registered by the [**VirtualChannelInit**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit) call.</span></span> <span data-ttu-id="c6534-127">Der **virtualchannelopen** -Befehl gibt einen Zeiger auf die [**virtualchannelopenevent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) -Rückruffunktion an.</span><span class="sxs-lookup"><span data-stu-id="c6534-127">The **VirtualChannelOpen** call specifies a pointer to your [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) callback function.</span></span>

<span data-ttu-id="c6534-128">Nachdem der [**virtualchannelopen**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen) -Rückruf zurückgegeben wurde, können Sie die [**virtualchannelwrite**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelwrite) -Funktion zum Schreiben in den virtuellen Kanal abrufen.</span><span class="sxs-lookup"><span data-stu-id="c6534-128">After the [**VirtualChannelOpen**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen) call returns, you can call the [**VirtualChannelWrite**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelwrite) function to write to the virtual channel.</span></span> <span data-ttu-id="c6534-129">Der Schreibvorgang ist asynchron. Daher dürfen Sie den an **virtualchannelwrite** über gebenden Puffer nicht freigeben oder wieder verwenden, bis Remotedesktopdienste die [**virtualchannelopenevent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) -Funktion aufruft, um anzugeben, dass der Schreibvorgang abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="c6534-129">The write operation is asynchronous, so you must not free or reuse the buffer passed to **VirtualChannelWrite** until Remote Desktop Services calls your [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) function to indicate that the write operation has been completed.</span></span> <span data-ttu-id="c6534-130">Wenn Sie **virtualchannelwrite** aufgerufen haben, können Sie ein Benutzerdaten-Element übergeben, das den Schreibvorgang identifiziert.</span><span class="sxs-lookup"><span data-stu-id="c6534-130">When you call **VirtualChannelWrite**, you can pass a piece of user data that identifies the write operation.</span></span> <span data-ttu-id="c6534-131">Remotedesktopdienste übergibt diese Benutzerdaten zurück, wenn **virtualchannelopenevent** aufgerufen wird, um Sie zu benachrichtigen, dass der Vorgang abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="c6534-131">Remote Desktop Services passes this user data back when it calls **VirtualChannelOpenEvent** to notify you that the operation has completed.</span></span> <span data-ttu-id="c6534-132">Am Server Ende des virtuellen Kanals ruft das Server-Add-in die Funktion [**Wout virtualchannelread**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread) auf, um die Daten zu lesen.</span><span class="sxs-lookup"><span data-stu-id="c6534-132">At the server end of the virtual channel, the server add-in calls the [**WTSVirtualChannelRead**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread) function to read the data.</span></span>

<span data-ttu-id="c6534-133">Remotedesktopdienste ruft auch Ihre [**virtualchannelopenevent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) -Funktion auf, wenn Daten vom Servermodul in den virtuellen Kanal geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="c6534-133">Remote Desktop Services also calls your [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) function when data is written to the virtual channel by the server module.</span></span> <span data-ttu-id="c6534-134">Das Servermodul Ruft die [**Wout virtualchannelwrite**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelwrite) -Funktion auf, um Daten auf das Server Ende des virtuellen Kanals zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="c6534-134">The server module calls the [**WTSVirtualChannelWrite**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelwrite) function to write data to the server end of the virtual channel.</span></span>

<span data-ttu-id="c6534-135">Die Module Client und Server können Datenblöcke beliebiger Größe in den virtuellen Kanal schreiben.</span><span class="sxs-lookup"><span data-stu-id="c6534-135">The client and server modules can write data blocks of any size to the virtual channel.</span></span> <span data-ttu-id="c6534-136">Vor dem Senden der Daten werden die Daten jedoch Remotedesktopdienste in Segmente von Segmenten mit channellänge von Segmenten segmentiert \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="c6534-136">Before sending the data, however, Remote Desktop Services segments the data into chunks of CHANNEL\_CHUNK\_LENGTH bytes.</span></span> <span data-ttu-id="c6534-137">Remotedesktopdienste die [**virtualchannelopenevent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) -Funktion für jeden Datenblock einmal aufruft, anstatt die Daten in einen Block der ursprünglichen Größe neu zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="c6534-137">Remote Desktop Services calls your [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) function once for each chunk of data, rather than rebuilding the data into a block of the original size.</span></span> <span data-ttu-id="c6534-138">Jeder Aufrufe von **virtualchannelopenevent** gibt die Größe des Blocks, die vom Server geschriebene Gesamtgröße an und gibt an, ob die Daten den Anfang, das Mittel oder das Ende eines Blocks darstellen, der vom Server geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="c6534-138">Each call to **VirtualChannelOpenEvent** indicates the size of the chunk, the total size written by the server, and whether the data constitutes the beginning, middle, or end of a block written by the server.</span></span>

<span data-ttu-id="c6534-139">Sie können die [**virtualchannelclose**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelclose) -Funktion zum Schließen eines Kanals aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="c6534-139">You can call the [**VirtualChannelClose**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelclose) function to close a channel.</span></span> <span data-ttu-id="c6534-140">Es ist jedoch nicht notwendig, ihn aufzurufen, da Remotedesktopdienste alle Kanäle automatisch schließt, wenn der Client die Verbindung mit dem Server trennt.</span><span class="sxs-lookup"><span data-stu-id="c6534-140">However, it is not necessary to call it because Remote Desktop Services closes all channels automatically when the client disconnects from the server.</span></span>

 

 





