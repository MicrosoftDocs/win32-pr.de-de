---
title: Benutzerdefinierte RAS-Skript
description: Entwickler können eine benutzerdefinierte Skript-DLL erstellen, die sich auf einem RAS-Client Computer befindet. Diese DLL kann während der Verbindungs Herstellung mit dem Server kommunizieren.
ms.assetid: c27b8b02-6018-4441-a355-1fb890b9001c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c625f020d9dafcb352c5f1b382014f9dba189330
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "103948849"
---
# <a name="ras-custom-scripting"></a><span data-ttu-id="c3d5e-104">Benutzerdefinierte RAS-Skript</span><span class="sxs-lookup"><span data-stu-id="c3d5e-104">RAS Custom Scripting</span></span>

<span data-ttu-id="c3d5e-105">Entwickler können eine benutzerdefinierte Skript-DLL erstellen, die sich auf einem RAS-Client Computer befindet.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-105">Developers can create a custom-scripting DLL that resides on a RAS client computer.</span></span> <span data-ttu-id="c3d5e-106">Diese DLL kann während der Verbindungs Herstellung mit dem Server kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-106">This DLL can communicate with the server during the process of establishing a connection.</span></span>

<span data-ttu-id="c3d5e-107">**Windows NT:** Die benutzerdefinierte Skripterstellung ist nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-107">**Windows NT:** Custom scripting is not available.</span></span>

## <a name="setting-up-the-dll"></a><span data-ttu-id="c3d5e-108">Einrichten der dll</span><span class="sxs-lookup"><span data-stu-id="c3d5e-108">Setting up the DLL</span></span>

<span data-ttu-id="c3d5e-109">Um die dll einzurichten, erstellen Sie einen Wert mit dem Namen " **customscriptdllpath** " unter dem folgenden Registrierungsschlüssel:</span><span class="sxs-lookup"><span data-stu-id="c3d5e-109">To set up the DLL, create a value with the name **CustomScriptDllPath** under the following registry key:</span></span>

```
HKEY_LOCAL_MACHINE
   System
      CurrentControlSet
         Services
            Rasman
               Parameters
```

<span data-ttu-id="c3d5e-110">Dieser Wert muss vom Typ " **reg \_ Expand \_ SZ**" sein.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-110">This value should be of type **REG\_EXPAND\_SZ**.</span></span> <span data-ttu-id="c3d5e-111">Der Wert sollte den Pfad zur benutzerdefinierten Skript-dll enthalten.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-111">The value should contain the path to the custom-scripting DLL.</span></span> <span data-ttu-id="c3d5e-112">Nur eine benutzerdefinierte Skript-dll wird für jeden RAS-Client Computer unterstützt.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-112">Only one custom-scripting DLL is supported for each RAS client computer.</span></span>

## <a name="interaction-between-the-server-ras-and-the-custom-scripting-dll"></a><span data-ttu-id="c3d5e-113">Interaktion zwischen dem Server, RAS und der Custom-Scripting-dll</span><span class="sxs-lookup"><span data-stu-id="c3d5e-113">Interaction Between the Server, RAS, and the Custom-Scripting DLL</span></span>

<span data-ttu-id="c3d5e-114">Die benutzerdefinierte Skript-DLL sollte einen einzelnen Einstiegspunkt exportieren: [**rascustomscriptexecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span><span class="sxs-lookup"><span data-stu-id="c3d5e-114">The custom scripting DLL should export a single entry point: [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span></span> <span data-ttu-id="c3d5e-115">RAS ruft diese Funktion während des interaktiven rascs- \_ Zustands des Verbindungsprozesses auf.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-115">RAS calls this function during the RASCS\_Interactive state of the connection process.</span></span> <span data-ttu-id="c3d5e-116">Der interaktive rascs \_ -Status ist ein angehaltene Zustand, mit dem der Benutzer mit einer Benutzeroberfläche interagieren kann, die von der benutzerdefinierten Skript-dll angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-116">The RASCS\_Interactive state is a paused state, which allows the user to interact with a user interface presented by the custom-scripting DLL.</span></span> <span data-ttu-id="c3d5e-117">Weitere Informationen zu Verbindungs Zuständen finden Sie unter " [**rasrestate**](/previous-versions/windows/desktop/legacy/aa376727(v=vs.85)) ".</span><span class="sxs-lookup"><span data-stu-id="c3d5e-117">See [**RASCONNSTATE**](/previous-versions/windows/desktop/legacy/aa376727(v=vs.85)) for more information about connection states.</span></span>

<span data-ttu-id="c3d5e-118">RAS übergibt als Parameter an die [**rascustomscriptexecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) -Funktion:</span><span class="sxs-lookup"><span data-stu-id="c3d5e-118">RAS will pass as parameters to the [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) function:</span></span>

-   <span data-ttu-id="c3d5e-119">Ein Handle für den Port auf dem Client Computer, der für die Verbindung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-119">A handle to the port on the client computer that is being used for the connection.</span></span>
-   <span data-ttu-id="c3d5e-120">Zeichen folgen, die das Telefonbuch und den Eintrag für die Verbindung identifizieren.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-120">Strings that identify the phone book and entry for the connection.</span></span>
-   <span data-ttu-id="c3d5e-121">RAS übergibt auch ein Handle an ein Fenster, damit die DLL eine Benutzeroberfläche bereitstellen kann.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-121">RAS also passes in a handle to a window to enable the DLL to present a user interface.</span></span>
-   <span data-ttu-id="c3d5e-122">Eine Reihe von Funktions Zeigern, die von der DLL für die Kommunikation mit dem Server verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-122">A set of function pointers that the DLL can use to communicate with the server.</span></span>

<span data-ttu-id="c3d5e-123">Weitere Informationen zu diesen Parametern finden Sie unter [**rascustomscriptexecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) .</span><span class="sxs-lookup"><span data-stu-id="c3d5e-123">See [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) for more information about these parameters.</span></span>

<span data-ttu-id="c3d5e-124">RAS übergibt einen Zeiger auf eine [**rascustomscriptextensions**](/previous-versions/windows/desktop/legacy/aa376738(v=vs.85)) -Struktur als letzten Parameter an [**rascustomscriptexecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span><span class="sxs-lookup"><span data-stu-id="c3d5e-124">RAS passes a pointer to a [**RASCUSTOMSCRIPTEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa376738(v=vs.85)) structure as the last parameter to [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span></span> <span data-ttu-id="c3d5e-125">Diese Struktur enthält einen Zeiger auf eine Funktion vom Typ [**pfnrassetcommsettings**](/windows/desktop/api/Ras/nc-ras-pfnrassetcommsettings).</span><span class="sxs-lookup"><span data-stu-id="c3d5e-125">This structure contains a pointer to a function of type [**PFNRASSETCOMMSETTINGS**](/windows/desktop/api/Ras/nc-ras-pfnrassetcommsettings).</span></span> <span data-ttu-id="c3d5e-126">Die benutzerdefinierte Skript-dll ruft diese Funktion auf, um die Kommunikationseinstellungen auf dem Port zu ändern, der von der Verbindung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-126">The custom-scripting DLL calls this function to modify the communication settings on the port being used by the connection.</span></span>

<span data-ttu-id="c3d5e-127">RAS vermittelt die Interaktion zwischen dem Server und der benutzerdefinierten Skript-dll.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-127">RAS mediates the interaction between the server and the custom-scripting DLL.</span></span> <span data-ttu-id="c3d5e-128">In der Regel initiiert der Server das Dialogfeld.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-128">Typically, the server initiates the dialog.</span></span> <span data-ttu-id="c3d5e-129">Der Server kann z. b. den Benutzernamen und das Kennwort des Benutzers anfordern.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-129">For example, the server may request the user name and password of the user.</span></span>

<span data-ttu-id="c3d5e-130">Wenn Sie die benutzerdefinierte Skripterstellung verwenden, um eine Verbindung herzustellen, muss auf dem Server Windows NT 4,0 oder Windows 2000 nicht ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-130">When using custom-scripting to establish a connection, the server need not be running Windows NT 4.0 or Windows 2000.</span></span>

## <a name="custom-scripting-user-interface-must-support-idcancel"></a><span data-ttu-id="c3d5e-131">Benutzerdefinierte Skripterstellung für Benutzeroberfläche muss IDCANCEL unterstützen</span><span class="sxs-lookup"><span data-stu-id="c3d5e-131">Custom Scripting User Interface Must Support IDCANCEL</span></span>

<span data-ttu-id="c3d5e-132">Wenn die benutzerdefinierte Einwählprogramm eine Benutzeroberfläche anzeigt, muss die Benutzeroberfläche die WM-befehlsnachrichten unterstützen, \_ wobei LoWord (*wParam*) gleich IDCANCEL ist.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-132">If the custom dialer displays a user interface, the user interface must support WM\_COMMAND messages where LOWORD(*wParam*) equals IDCANCEL.</span></span>

## <a name="configuring-the-connection"></a><span data-ttu-id="c3d5e-133">Konfigurieren der Verbindung</span><span class="sxs-lookup"><span data-stu-id="c3d5e-133">Configuring the Connection</span></span>

<span data-ttu-id="c3d5e-134">Der [**rascustomscriptexecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) -Einstiegspunkt kann von der [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) -oder unter Windows XP von der [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala)aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-134">The [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) entry point can be invoked from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) or, on Windows XP, from [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala).</span></span>

<span data-ttu-id="c3d5e-135">Zum Aufrufen von [**rascustomscriptexecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) von [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga)legen Sie die Option raseo \_ CustomScript im Telefonbucheintrag für die Verbindung fest.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-135">To invoke [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga), set the RASEO\_CustomScript option in the phone-book entry for the connection.</span></span> <span data-ttu-id="c3d5e-136">Unter dem **dwfoptions** -Member von [**rasentry**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) finden Sie eine Beschreibung der Optionen für den Telefonbucheintrag.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-136">See the **dwfOptions** member of [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) for a description of phone-book entry options.</span></span> <span data-ttu-id="c3d5e-137">Verwenden Sie die Funktionen " [**rasgetentryproperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) " und " [**rassetentryproperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) ", um diese Option Programm gesteuert festzulegen.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-137">Use the [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) and [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) functions to set this option programmatically.</span></span>

<span data-ttu-id="c3d5e-138">**Windows XP:** Zum Aufrufen von [**rascustomscriptexecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) von [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala)muss beim Aufruf von " **rasdial** " eine " [**rasdialextensions**](/previous-versions/windows/desktop/legacy/aa377029(v=vs.85)) "-Struktur angegeben werden, und diese Struktur muss das rtoopt \_ usecustomscripting-Flag angeben.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-138">**Windows XP:** To invoke [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) from [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala), the call to **RasDial** must specify a [**RASDIALEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa377029(v=vs.85)) structure, and this structure must specify the RDEOPT\_UseCustomScripting flag.</span></span> <span data-ttu-id="c3d5e-139">Außerdem muss für den Telefonbucheintrag für die Verbindung die Option "raseo CustomScript" angegeben werden, \_ wie im vorherigen Abschnitt beschrieben.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-139">In addition, the phone-book entry for the connection must specify the RASEO\_CustomScript option as described in the preceding paragraph.</span></span>

## <a name="invoking-the-custom-scripting-dll"></a><span data-ttu-id="c3d5e-140">Aufrufen der benutzerdefinierten Skript-dll</span><span class="sxs-lookup"><span data-stu-id="c3d5e-140">Invoking the Custom Scripting DLL</span></span>

<span data-ttu-id="c3d5e-141">Wenn der Benutzer eine Verbindung für einen Telefonbucheintrag aktiviert, bei dem raseo \_ CustomScript festgelegt ist, ruft RAS die benutzerdefinierte Skript-dll auf.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-141">If the user activates a connection for a phone-book entry that has RASEO\_CustomScript set, RAS invokes the custom-scripting DLL.</span></span> <span data-ttu-id="c3d5e-142">In diesem Szenario ruft RAS die benutzerdefinierte Skript-DLL von [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga)auf.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-142">In this scenario, RAS invokes the custom-scripting DLL from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga).</span></span>

<span data-ttu-id="c3d5e-143">Wenn Sie die benutzerdefinierte Skript-dll Programm gesteuert aufrufen möchten, stellen Sie die Verbindung mithilfe der Funktion " [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) " her.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-143">To invoke the custom-scripting DLL programmatically, establish the connection using the [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) function.</span></span> <span data-ttu-id="c3d5e-144">Unter Windows XP Ruft die Funktion " [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala) " auch die benutzerdefinierte Skript-dll auf.</span><span class="sxs-lookup"><span data-stu-id="c3d5e-144">On Windows XP, the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function also invokes the custom-scripting DLL.</span></span>

 

 