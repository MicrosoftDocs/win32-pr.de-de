---
description: Sie können symmetrische Schlüssel und asymmetrische Schlüssel mit CNG importieren und exportieren. Und Sie können Schlüssel Export-und-Importfunktionen verwenden, um Schlüssel zwischen Computern zu verschieben.
ms.assetid: 37bda1e0-5dd2-455c-9627-4e7e1b0e04d3
title: Schlüssel Import und-Export
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8be59cc5f5c4b3d1a98fa30cf4e967d5469d2f1f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106342630"
---
# <a name="key-import-and-export"></a><span data-ttu-id="de4ae-104">Schlüssel Import und-Export</span><span class="sxs-lookup"><span data-stu-id="de4ae-104">Key Import and Export</span></span>

<span data-ttu-id="de4ae-105">Sie können [*symmetrische Schlüssel*](/windows/desktop/SecGloss/s-gly) und asymmetrische Schlüssel mit CNG importieren und exportieren.</span><span class="sxs-lookup"><span data-stu-id="de4ae-105">You can import and export [*symmetric keys*](/windows/desktop/SecGloss/s-gly) and asymmetric keys with CNG.</span></span> <span data-ttu-id="de4ae-106">Und Sie können Schlüssel Export-und-Importfunktionen verwenden, um Schlüssel zwischen Computern zu verschieben.</span><span class="sxs-lookup"><span data-stu-id="de4ae-106">And you can use key export and import functionality to move keys between machines.</span></span>

## <a name="symmetric-keys"></a><span data-ttu-id="de4ae-107">Symmetrische Schlüssel</span><span class="sxs-lookup"><span data-stu-id="de4ae-107">Symmetric keys</span></span>

<span data-ttu-id="de4ae-108">Zum Importieren oder Exportieren von symmetrischen (oder Sitzungs-) Schlüsseln, in denen derselbe Schlüssel zum Verschlüsseln und Entschlüsseln von Daten verwendet wird, können Sie die Funktionen [**BCryptImportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkey) und [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) verwenden.</span><span class="sxs-lookup"><span data-stu-id="de4ae-108">To import or export symmetric (or session) keys in which the same key is used to encrypt and decrypt some data, you can use the [**BCryptImportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkey) and [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) functions.</span></span> <span data-ttu-id="de4ae-109">In der Regel exportieren Sie zuerst einen Schlüssel mithilfe der **BCryptExportKey** -Funktion, bevor Sie mit der **BCryptImportKey** -Funktion importieren.</span><span class="sxs-lookup"><span data-stu-id="de4ae-109">Typically, you first export a key by using the **BCryptExportKey** function before importing by using the **BCryptImportKey** function.</span></span> <span data-ttu-id="de4ae-110">Die Funktionen dienen zum Aktivieren der Verschlüsselung exportierter und importierter Schlüssel mithilfe der Parameter " *hexportkey* " und " *himportkey* ". die Microsoft-Implementierung dieser Funktionen unterstützt jedoch nicht die Verschlüsselung von exportierten und importierten Schlüsseln.</span><span class="sxs-lookup"><span data-stu-id="de4ae-110">The functions are designed to enable encryption of exported and imported keys by using the *hExportKey* and *hImportKey* parameters; however, the Microsoft implementation of these functions does not support encryption of exported and imported keys.</span></span>

## <a name="asymmetric-keys"></a><span data-ttu-id="de4ae-111">Asymmetrische Schlüssel</span><span class="sxs-lookup"><span data-stu-id="de4ae-111">Asymmetric keys</span></span>

<span data-ttu-id="de4ae-112">Wenn Sie asymmetrische (oder [*öffentliche/private*](/windows/desktop/SecGloss/p-gly)) Schlüsselpaare importieren möchten, in denen ein Schlüssel für die Verschlüsselung verwendet wird, und der andere zum Entschlüsseln einiger Daten verwendet wird, können Sie eine der Funktionen [**BCryptImportKeyPair**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkeypair) oder [**ncryptimportkey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptimportkey) verwenden.</span><span class="sxs-lookup"><span data-stu-id="de4ae-112">To import asymmetric (or [*public/private*](/windows/desktop/SecGloss/p-gly)) key pairs in which one key is used to encrypt and the other is used to decrypt some data, you can use either of the [**BCryptImportKeyPair**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkeypair) or [**NCryptImportKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptimportkey) functions.</span></span> <span data-ttu-id="de4ae-113">Ein CNG-Anbieter muss das Schlüsselpaar mit einem unterstützten [*Schlüsselblob*](/windows/desktop/SecGloss/k-gly) -Typ codieren.</span><span class="sxs-lookup"><span data-stu-id="de4ae-113">A CNG provider must encode the key pair by using a supported [*key BLOB*](/windows/desktop/SecGloss/k-gly) type.</span></span> <span data-ttu-id="de4ae-114">[**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) kann verwendet werden, um das codierte Schlüsselblob zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="de4ae-114">[**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) can be used to create the encoded key BLOB.</span></span> <span data-ttu-id="de4ae-115">[CNG-Strukturen](cng-structures.md) beschreibt die wichtigsten BLOB-Typen und-Strukturen, die der Microsoft-Schlüsselspeicher Anbieter unterstützt.</span><span class="sxs-lookup"><span data-stu-id="de4ae-115">[CNG Structures](cng-structures.md) describes the key BLOB types and structures that Microsoft Key Storage Provider supports.</span></span>

<span data-ttu-id="de4ae-116">Damit [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) ein persistente Schlüsselpaar erstellt, muss das Eingabe Schlüsselblob einen [*privaten Schlüssel*](/windows/desktop/SecGloss/p-gly)enthalten.</span><span class="sxs-lookup"><span data-stu-id="de4ae-116">For [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) to create a persisted key pair, the input key BLOB must contain a [*private key*](/windows/desktop/SecGloss/p-gly).</span></span> <span data-ttu-id="de4ae-117">[*Öffentliche Schlüssel*](/windows/desktop/SecGloss/p-gly) werden nicht persistent gespeichert.</span><span class="sxs-lookup"><span data-stu-id="de4ae-117">[*Public keys*](/windows/desktop/SecGloss/p-gly) are not persisted.</span></span>

<span data-ttu-id="de4ae-118">Der Schlüssel Name und die Export Richtlinie sind nicht Teil der in [CNG-Strukturen](cng-structures.md)definierten [*BLOB*](/windows/desktop/SecGloss/b-gly) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="de4ae-118">The key name and export policy are not part of the [*BLOB*](/windows/desktop/SecGloss/b-gly) structure defined in [CNG Structures](cng-structures.md).</span></span> <span data-ttu-id="de4ae-119">Wenn ein BLOB jedoch einen nicht transparenten BLOB-Typ aufweist (z. b. das Speicher Image eines internen Schlüssel Zustands), enthält das BLOB möglicherweise den Schlüsselnamen und die Exportrichtlinien Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="de4ae-119">However, if a BLOB is of an opaque BLOB type (such as the memory image of an internal key state), the BLOB might contain the key name and export-policy properties.</span></span>

<span data-ttu-id="de4ae-120">Im folgenden Verfahren wird beschrieben, wie ein persistenter privater Schlüssel mit seinen Eigenschaften importiert wird.</span><span class="sxs-lookup"><span data-stu-id="de4ae-120">The following procedure describes how to import a persisted private key with its properties.</span></span>

<span data-ttu-id="de4ae-121">**So importieren Sie einen persistenten Schlüssel**</span><span class="sxs-lookup"><span data-stu-id="de4ae-121">**To import a persisted key**</span></span>

1.  <span data-ttu-id="de4ae-122">Erstellen Sie einen persistenten Schlüssel mithilfe der [**ncryptkreatepersistedkey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptcreatepersistedkey) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="de4ae-122">Create a persisted key by using the [**NCryptCreatePersistedKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptcreatepersistedkey) function.</span></span>
2.  <span data-ttu-id="de4ae-123">Legen Sie mit der [**ncryptsetproperty**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptsetproperty) -Funktion alle gewünschten Eigenschaften für das Schlüsselobjekt fest.</span><span class="sxs-lookup"><span data-stu-id="de4ae-123">Set any desired properties on the key object by using the [**NCryptSetProperty**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptsetproperty) function.</span></span>
3.  <span data-ttu-id="de4ae-124">Legen Sie das Import-Schlüsselblob als Eigenschaft für den Schlüssel fest, wobei der BLOB-Typ der Eigenschaftsname ist.</span><span class="sxs-lookup"><span data-stu-id="de4ae-124">Set the import key BLOB as a property on the key, with the BLOB type as the property name.</span></span>
4.  <span data-ttu-id="de4ae-125">Finalisieren Sie den persistenten Schlüssel Import mithilfe der [**ncryptfinalizekey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptfinalizekey) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="de4ae-125">Finalize the persisted key import by using the [**NCryptFinalizeKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptfinalizekey) function.</span></span>

 

 
