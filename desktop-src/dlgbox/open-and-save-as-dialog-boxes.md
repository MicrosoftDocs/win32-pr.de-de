---
title: Dialogfelder "Öffnen und Speichern unter"
description: Im Dialogfeld Öffnen können Benutzer das Laufwerk, das Verzeichnis und den Namen einer Datei oder eines Dateisatzes angeben, die geöffnet werden sollen.
ms.assetid: 5676ca9d-daca-40bf-8881-def2ff841c58
keywords:
- Allgemeine Dialogfeldbibliothek
- Allgemeine Dialogfelder
- Dialogfeld Öffnen
- Speichern unter (Dialogfeld)
- Anpassen des Dialogfelds "Öffnen"
- Anpassen des Dialogfelds "Speichern unter"
- Dialogfelder, Öffnen
- Dialogfelder,Speichern unter
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: be957276f0d5a6370bb53aca4b1af5052b422011
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/27/2021
ms.locfileid: "110548885"
---
# <a name="open-and-save-as-dialog-boxes"></a><span data-ttu-id="9e2a8-111">Dialogfelder "Öffnen und Speichern unter"</span><span class="sxs-lookup"><span data-stu-id="9e2a8-111">Open and Save As Dialog Boxes</span></span>

> [!NOTE]
> <span data-ttu-id="9e2a8-112">Die [**GetOpenFileName-Funktion**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) wird im [Beispiel File is in use](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse)veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-112">The [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function is demonstrated in the [File is in use sample](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse).</span></span>

<span data-ttu-id="9e2a8-113">\[Ab Windows Vista wurden die Dialogfelder **Öffnen** und **Speichern unter** allgemein durch das [Dialogfeld "Allgemeines Element"](../shell/common-file-dialog.md)ersetzt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-113">\[Starting with Windows Vista, the **Open** and **Save As** common dialog boxes have been superseded by the [Common Item Dialog](../shell/common-file-dialog.md).</span></span> <span data-ttu-id="9e2a8-114">Es wird empfohlen, die Dialogfeld-API für allgemeine Elemente anstelle dieser Dialogfelder aus der Common Dialog Box Library zu verwenden.\]</span><span class="sxs-lookup"><span data-stu-id="9e2a8-114">We recommended that you use the Common Item Dialog API instead of these dialog boxes from the Common Dialog Box Library.\]</span></span>

<span data-ttu-id="9e2a8-115">Im Dialogfeld **Öffnen** können Benutzer das Laufwerk, das Verzeichnis und den Namen einer Datei oder eines Dateisatzes angeben, die geöffnet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-115">The **Open** dialog box lets the user specify the drive, directory, and the name of a file or set of files to open.</span></span> <span data-ttu-id="9e2a8-116">Sie erstellen und zeigen ein Dialogfeld **Öffnen** an, indem Sie eine [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) initialisieren und die Struktur an die [**GetOpenFileName-Funktion**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) übergeben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-116">You create and display an **Open** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function.</span></span>

<span data-ttu-id="9e2a8-117">Im Dialogfeld **Speichern unter** kann der Benutzer das Laufwerk, das Verzeichnis und den Namen einer datei angeben, die gespeichert werden soll.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-117">The **Save As** dialog box lets the user specify the drive, directory, and name of a file to save.</span></span> <span data-ttu-id="9e2a8-118">Sie erstellen und zeigen ein Dialogfeld **Speichern unter** an, indem Sie eine [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) initialisieren und die Struktur an die [**GetSaveFileName-Funktion**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) übergeben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-118">You create and display a **Save As** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) function.</span></span>

<span data-ttu-id="9e2a8-119">Die Dialogfelder **Öffnen** und **Speichern unter** im Explorer-Stil bieten Benutzeroberflächenfeatures, die dem Windows-Explorer ähneln.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-119">Explorer-style **Open** and **Save As** dialog boxes provide user-interface features that are similar to the Windows Explorer.</span></span> <span data-ttu-id="9e2a8-120">Das System unterstützt jedoch weiterhin die Dialogfelder **Öffnen** und **Speichern unter** im alten Stil für Anwendungen, die mit der alten Benutzeroberfläche konsistent sein müssen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-120">However, the system continues to support old-style **Open** and **Save As** dialog boxes for applications that must be consistent with the old-style user interface.</span></span>

<span data-ttu-id="9e2a8-121">Neben dem Unterschied in der Darstellung unterscheiden sich die Dialogfelder im Explorer-Stil und im alten Stil durch die Verwendung von benutzerdefinierten Vorlagen und Hookprozes zum Anpassen der Dialogfelder.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-121">In addition to the difference in appearance, the Explorer-style and old-style dialog boxes differ in their use of custom templates and hook procedures for customizing the dialog boxes.</span></span> <span data-ttu-id="9e2a8-122">Die Dialogfelder im Explorer- und alten Stil weisen jedoch das gleiche Verhalten für die meisten grundlegenden Vorgänge auf, z. B. das Angeben eines Dateinamenfilters, das Überprüfen der Benutzereingabe und das Abrufen des vom Benutzer angegebenen Dateinamens.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-122">However, the Explorer-style and old-style dialog boxes have the same behavior for most basic operations, such as specifying a file name filter, validating the user's input, and getting the file name specified by the user.</span></span> <span data-ttu-id="9e2a8-123">Weitere Informationen zu den Dialogfeldern im Explorer- und alten Stil finden Sie unter Öffnen und Speichern [unter Anpassung des Dialogfelds](#open-and-save-as-dialog-box-customization).</span><span class="sxs-lookup"><span data-stu-id="9e2a8-123">For more information about the Explorer-style and old-style dialog boxes, see [Open and Save As Dialog Box Customization](#open-and-save-as-dialog-box-customization).</span></span>

<span data-ttu-id="9e2a8-124">Die folgende Abbildung zeigt ein typisches Dialogfeld **"Öffnen" im** Explorer-Stil.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-124">The following illustration shows a typical Explorer-style **Open** dialog box.</span></span>

![Dialogfeld "Datei öffnen"](images/opendialogboxxp.png)

<span data-ttu-id="9e2a8-126">Die folgende Abbildung zeigt ein typisches Dialogfeld "Speichern **unter"** im Explorer-Stil.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-126">The following illustration shows a typical Explorer-style **Save As** dialog box.</span></span>

![Dialogfeld "Datei speichern"](images/saveasdialogboxxp.png)

<span data-ttu-id="9e2a8-128">Wenn der Benutzer einen Dateinamen angibt und auf die **Schaltfläche OK** klickt, gibt [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) oder [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) **TRUE zurück.**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-128">If the user specifies a file name and clicks the **OK** button, [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) returns **TRUE**.</span></span> <span data-ttu-id="9e2a8-129">Der Puffer, auf den der **lpstrFile-Member** der [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) zeigt, enthält den vollständigen Pfad und Dateinamen, die vom Benutzer angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-129">The buffer pointed to by the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure contains the full path and file name specified by the user.</span></span>

<span data-ttu-id="9e2a8-130">Wenn der Benutzer das Dialogfeld **Öffnen** oder **Speichern unter** abbricht oder ein Fehler auftritt, gibt die Funktion **FALSE zurück.**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-130">If the user cancels the **Open** or **Save As** dialog box or an error occurs, the function returns **FALSE**.</span></span> <span data-ttu-id="9e2a8-131">Um die Ursache des Fehlers zu ermitteln, rufen Sie die [**CommDlgExtendedError-Funktion auf,**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) um den erweiterten Fehlerwert abzurufen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-131">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span> <span data-ttu-id="9e2a8-132">Wenn der **lpstrFile-Puffer** zu klein ist, um den vollständigen Namen zu erhalten, gibt **CommDlgExtendedError** **FNERR \_ BUFFERTOOSMALL** zurück, und die ersten 2 Bytes des Puffers, auf die das **lpstrFile-Element** zeigt, werden auf einen ganzzahligen Wert festgelegt, der die größe angibt, die zum Empfangen des vollständigen Namens erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-132">If the **lpstrFile** buffer is too small to receive the full name, **CommDlgExtendedError** returns **FNERR\_BUFFERTOOSMALL** and the first 2 bytes of the buffer pointed to by the **lpstrFile** member are set to an integer value specifying the size required to receive the full name.</span></span>

<span data-ttu-id="9e2a8-133">Die folgenden Themen werden in diesem Abschnitt erläutert.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-133">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="9e2a8-134">Dateinamen und Verzeichnisse</span><span class="sxs-lookup"><span data-stu-id="9e2a8-134">File Names and Directories</span></span>](#file-names-and-directories)
-   [<span data-ttu-id="9e2a8-135">Filter</span><span class="sxs-lookup"><span data-stu-id="9e2a8-135">Filters</span></span>](#filters)
-   [<span data-ttu-id="9e2a8-136">Datei- und Verzeichnisüberprüfung</span><span class="sxs-lookup"><span data-stu-id="9e2a8-136">File and Directory Validation</span></span>](#file-and-directory-validation)
-   [<span data-ttu-id="9e2a8-137">Anpassen des Dialogfelds "Öffnen und Speichern unter"</span><span class="sxs-lookup"><span data-stu-id="9e2a8-137">Open and Save As Dialog Box Customization</span></span>](#open-and-save-as-dialog-box-customization)
-   [<span data-ttu-id="9e2a8-138">Hook-Prozeduren im Explorer-Stil</span><span class="sxs-lookup"><span data-stu-id="9e2a8-138">Explorer-Style Hook Procedures</span></span>](#explorer-style-hook-procedures)
-   [<span data-ttu-id="9e2a8-139">Benutzerdefinierte Vorlagen im Explorer-Stil</span><span class="sxs-lookup"><span data-stu-id="9e2a8-139">Explorer-Style Custom Templates</span></span>](#explorer-style-custom-templates)
-   [<span data-ttu-id="9e2a8-140">Steuerelementbezeichner im Explorer-Stil</span><span class="sxs-lookup"><span data-stu-id="9e2a8-140">Explorer-Style Control Identifiers</span></span>](#explorer-style-control-identifiers)
-   [<span data-ttu-id="9e2a8-141">Anpassen Old-Style Dialogfeldern</span><span class="sxs-lookup"><span data-stu-id="9e2a8-141">Customizing Old-Style Dialog Boxes</span></span>](#customizing-old-style-dialog-boxes)

## <a name="file-names-and-directories"></a><span data-ttu-id="9e2a8-142">Dateinamen und Verzeichnisse</span><span class="sxs-lookup"><span data-stu-id="9e2a8-142">File Names and Directories</span></span>

<span data-ttu-id="9e2a8-143">Die Informationen in diesem Abschnitt gelten sowohl für  Dialogfelder im Explorer-Stil als auch für Dialogfelder im alten **Und-Format** öffnen und speichern unter.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-143">The information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="9e2a8-144">Vor dem Aufrufen der Funktionen [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) oder [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) muss der **lpstrFile-Member** der [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) auf den Puffer verweisen, um den Dateinamen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-144">Before calling the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions, the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must point to the buffer to receive the file name.</span></span> <span data-ttu-id="9e2a8-145">Der **nMaxFile-Member** muss die Größe des **lpstrFile-Puffers** in Zeichen angeben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-145">The **nMaxFile** member must specify the size, in characters, of the **lpstrFile** buffer.</span></span> <span data-ttu-id="9e2a8-146">Für eine ANSI-Funktion ist dies die Anzahl von Bytes, für eine Unicode-Funktion jedoch die Anzahl der Zeichen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-146">For an ANSI function this is the number of bytes, but for a Unicode function this is the number of characters.</span></span>

<span data-ttu-id="9e2a8-147">Wenn der Benutzer einen Dateinamen angibt und auf die Schaltfläche **OK** klickt, kopiert das Dialogfeld das ausgewählte Laufwerk, das verzeichnis und den Dateinamen in den **lpstrFile-Puffer.**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-147">If the user specifies a file name and clicks the **OK** button, the dialog box copies the selected drive, directory, and file name to the **lpstrFile** buffer.</span></span> <span data-ttu-id="9e2a8-148">Die -Funktion legt auch die Member **nFileOffset** und **nFileExtension** auf die Offsets in Zeichen vom Anfang des Puffers bis zum Dateinamen bzw. zur Dateinamenerweiterung fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-148">The function also sets the **nFileOffset** and **nFileExtension** members to the offsets, in characters, from the start of the buffer to the file name and to the file name extension, respectively.</span></span>

<span data-ttu-id="9e2a8-149">Um nur den Dateinamen und die Erweiterung abzurufen, legen Sie den **lpstrFileTitle-Member** so fest, dass er auf einen Puffer verweist, und legen Sie den **nMaxFileTitle-Member** auf die Größe des Puffers in Zeichen fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-149">To retrieve just the file name and extension, set the **lpstrFileTitle** member to point to a buffer and set the **nMaxFileTitle** member to the size, in characters, of the buffer.</span></span> <span data-ttu-id="9e2a8-150">Alternativ können Sie den **lpstrFile-Puffer** in einem Aufruf der [**GetFileTitle-Funktion**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) übergeben, um den Anzeigenamen der ausgewählten Datei abzurufen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-150">Alternatively, you can pass the **lpstrFile** buffer in a call to the [**GetFileTitle**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) function to get the display name of the selected file.</span></span> <span data-ttu-id="9e2a8-151">Beachten Sie jedoch, dass der dateiname, den **GetFileTitle** zurückgibt, nur dann eine Erweiterung enthält, wenn dies die Einstellung des Benutzers zum Anzeigen von Dateinamen ist.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-151">Note, however, that the file name that **GetFileTitle** returns includes an extension only if that is the user's preference for displaying file names.</span></span>

<span data-ttu-id="9e2a8-152">Das Dialogfeld verwendet das aktuelle Verzeichnis für den aufrufenden Prozess als erstes Verzeichnis, aus dem Dateien und Verzeichnisse angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-152">The dialog box uses the current directory for the calling process as the initial directory from which to display files and directories.</span></span> <span data-ttu-id="9e2a8-153">Verwenden Sie die Funktionen [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) und [**SetCurrentDirectory,**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) um das aktuelle Verzeichnis eines Prozesses abzurufen und zu ändern.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-153">Use the [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) and [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) functions to get and change the current directory of a process.</span></span> <span data-ttu-id="9e2a8-154">Um ein anderes Anfangsverzeichnis anzugeben, ohne das aktuelle Verzeichnis zu ändern, verwenden Sie den **LpstrInitialDir-Member,** um den Namen eines Verzeichnisses anzugeben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-154">To specify a different initial directory without changing your current directory, use the **lpstrInitialDir** member to specify the name of a directory.</span></span> <span data-ttu-id="9e2a8-155">Das Dialogfeld ändert automatisch Ihr aktuelles Verzeichnis, wenn der Benutzer ein anderes Laufwerk oder Verzeichnis auswählt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-155">The dialog box automatically changes your current directory when the user selects a different drive or directory.</span></span> <span data-ttu-id="9e2a8-156">Um zu verhindern, dass das Dialogfeld Ihr aktuelles Verzeichnis ändert, legen Sie das **FLAG OFN \_ NOCHANGEDIR** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-156">To prevent the dialog box from changing your current directory, set the **OFN\_NOCHANGEDIR** flag.</span></span> <span data-ttu-id="9e2a8-157">Dieses Flag verhindert nicht, dass der Benutzer Verzeichnisse ändert, um eine Datei zu finden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-157">This flag does not prevent the user from changing directories to find a file.</span></span>

<span data-ttu-id="9e2a8-158">Um eine Standarddateinamenerweiterung anzugeben, verwenden Sie **den lpstrDefExt-Member.**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-158">To specify a default file name extension, use the **lpstrDefExt** member.</span></span> <span data-ttu-id="9e2a8-159">Wenn der Benutzer einen Dateinamen angibt, der keine Erweiterung hat, fügt das Dialogfeld die Standarderweiterung hinzu.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-159">If the user specifies a file name that does not have an extension, the dialog box adds your default extension.</span></span> <span data-ttu-id="9e2a8-160">Wenn Sie eine Standarderweiterung angeben und der Benutzer einen Dateinamen mit einer anderen Erweiterung angibt, legt das Dialogfeld das **OFN \_ EXTENSIONDIFFERENT-Flag** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-160">If you specify a default extension and the user specifies a file name with a different extension, the dialog box sets the **OFN\_EXTENSIONDIFFERENT** flag.</span></span>

<span data-ttu-id="9e2a8-161">Damit der Benutzer mehr als eine Datei aus einem Verzeichnis auswählen kann, legen Sie das **OFN \_ ALLOWMULTISELECT-Flag** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-161">To let the user select more than one file from a directory, set the **OFN\_ALLOWMULTISELECT** flag.</span></span> <span data-ttu-id="9e2a8-162">Zur Kompatibilität mit älteren Anwendungen verwendet das Standarddialogfeld für mehrfache Auswahl die Benutzeroberfläche im alten Stil.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-162">For compatibility with older applications, the default multiple selection dialog box uses the old-style user interface.</span></span> <span data-ttu-id="9e2a8-163">Um ein Dialogfeld mit mehrfacher Auswahl im Explorer-Stil anzuzeigen, müssen Sie auch das **\_ OFN-EXPLORER-Flag** festlegen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-163">To display an Explorer-style multiple selection dialog box, you must also set the **OFN\_EXPLORER** flag.</span></span>

<span data-ttu-id="9e2a8-164">Wenn der Benutzer mehrere Dateien auswählt, gibt der Puffer, auf den der **lpstrFile-Member** zeigt, den Pfad zum aktuellen Verzeichnis zurück, gefolgt von den Dateinamen der ausgewählten Dateien.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-164">If the user selects more than one file, the buffer pointed to by the **lpstrFile** member returns the path to the current directory followed by the file names of the selected files.</span></span> <span data-ttu-id="9e2a8-165">Das **nFileOffset-Member** ist der Offset zum ersten Dateinamen, und das **nFileExtension-Member** wird nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-165">The **nFileOffset** member is the offset to the first file name, and the **nFileExtension** member is not used.</span></span> <span data-ttu-id="9e2a8-166">In der folgenden Tabelle wird der Unterschied zwischen Dialogfeldern im Explorer- und alten Stil bei der Rückgabe mehrerer Dateinamen beschrieben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-166">The following table describes the difference between Explorer-style and old-style dialog boxes in returning multiple file names.</span></span>



| <span data-ttu-id="9e2a8-167">Dialogfeldformat</span><span class="sxs-lookup"><span data-stu-id="9e2a8-167">Dialog box style</span></span>            | <span data-ttu-id="9e2a8-168">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="9e2a8-168">Description</span></span>                                                                                                                                                                                                               |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9e2a8-169">Dialogfelder im Explorer-Stil</span><span class="sxs-lookup"><span data-stu-id="9e2a8-169">Explorer-style dialog boxes</span></span> | <span data-ttu-id="9e2a8-170">Die Verzeichnis- und Dateinamenzeichenfolgen sind **durch NULL** getrennt, und es wird ein zusätzliches **NULL-Zeichen** nach dem Namen der letzten Datei verwendet.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-170">The directory and file name strings are **NULL** separated, with an extra **NULL** character after the last file name.</span></span> <span data-ttu-id="9e2a8-171">Mit diesem Format können dialogfelder im Explorer-Stil lange Dateinamen zurückgeben, die Leerzeichen enthalten.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-171">This format enables the Explorer-style dialog boxes to return long file names that include spaces.</span></span> |
| <span data-ttu-id="9e2a8-172">Dialogfelder im alten Stil</span><span class="sxs-lookup"><span data-stu-id="9e2a8-172">Old-style dialog boxes</span></span>      | <span data-ttu-id="9e2a8-173">Die Verzeichnis- und Dateinamenzeichenfolgen werden durch Leerzeichen getrennt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-173">The directory and file name strings are separated by spaces.</span></span> <span data-ttu-id="9e2a8-174">Für Dateinamen mit Leerzeichen verwendet die Funktion kurze Dateinamen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-174">For file names with spaces, the function uses short file names.</span></span>                                                                                              |



 

<span data-ttu-id="9e2a8-175">Sie können die [**FindFirstFile-Funktion**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) verwenden, um zwischen langen und kurzen Dateinamen zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-175">You can use the [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) function to convert between long and short file names.</span></span>

<span data-ttu-id="9e2a8-176">Wenn Sie **OFN \_ ALLOWMULTISELECT** angeben und der Benutzer nur eine Datei auswählt, verfügt die **lpstrFile-Zeichenfolge** nicht über ein Trennzeichen zwischen Pfad und Dateiname.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-176">If you specify **OFN\_ALLOWMULTISELECT** and the user selects only one file, the **lpstrFile** string does not have a separator between the path and file name.</span></span>

## <a name="filters"></a><span data-ttu-id="9e2a8-177">Filter</span><span class="sxs-lookup"><span data-stu-id="9e2a8-177">Filters</span></span>

<span data-ttu-id="9e2a8-178">Die Informationen in diesem Abschnitt gelten sowohl für die Dialogfelder Im Explorer-Stil als auch im alten Stil **Öffnen** und **Speichern unter.**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-178">The information in this section applies to both Explorer-style and old style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="9e2a8-179">Sie können Dateinamenfilter bereitstellen, um den Benutzer beim Einschränken der Dateinamen zu unterstützen, die im Dialogfeld angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-179">You can provide file name filters to assist the user in limiting the file names that the dialog box displays.</span></span> <span data-ttu-id="9e2a8-180">Ein Dateinamenfilter besteht aus einem Paar von NULL-terminierten Zeichenfolgen, einer Beschreibung und einem Muster, die mit der anderen verkettet sind.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-180">A file name filter consists of a pair of null-terminated strings, a description and a pattern, one concatenated to the other.</span></span> <span data-ttu-id="9e2a8-181">Im Dialogfeld wird die Beschreibung angezeigt, mit der der Benutzer auswählen kann, welcher Filter verwendet werden soll. und verwendet das Muster, um die anzuzeigende Datei auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-181">The dialog box displays the description to let the user pick which filter to use; and it uses the pattern to select the files to display.</span></span>

<span data-ttu-id="9e2a8-182">Um die Filter anzugeben, legen Sie den **lpstrFilter-Member** der [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) so fest, dass er auf einen Puffer zeigt, der ein Array von Filterzeichenfolgenpaaren enthält.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-182">To specify the filters, set the **lpstrFilter** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to point to a buffer that contains an array of filter string pairs.</span></span> <span data-ttu-id="9e2a8-183">Auf die letzte Zeichenfolge im Array muss ein zusätzliches NULL-Zeichen folgen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-183">The last string in the array must be followed by an extra null character.</span></span>

<span data-ttu-id="9e2a8-184">Eine Musterzeichenfolge kann eine Kombination aus gültigen Dateinamenzeichen und dem Sternchen ( \* ) sein.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-184">A pattern string can be a combination of valid file name characters and the asterisk (\*).</span></span> <span data-ttu-id="9e2a8-185">Das Sternchen ist ein Platzhalter, der eine beliebige Kombination gültiger Dateinamenzeichen darstellt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-185">The asterisk is a wildcard that represents any combination of valid file name characters.</span></span> <span data-ttu-id="9e2a8-186">Im Dialogfeld werden nur die Dateien angezeigt, die dem Muster entsprechen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-186">The dialog box displays only those files that match the pattern.</span></span> <span data-ttu-id="9e2a8-187">Um mehrere Muster für dieselbe Beschreibung anzugeben, müssen Sie ein Semikolon (;) , um die Muster zu trennen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-187">To specify multiple patterns for the same description, you must use a semicolon (;) to separate the patterns.</span></span> <span data-ttu-id="9e2a8-188">Beachten Sie, dass Leerzeichen in der Musterzeichenfolge zu unerwarteten Ergebnissen führen können.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-188">Note that space characters in the pattern string can produce unexpected results.</span></span>

<span data-ttu-id="9e2a8-189">Das folgende Codefragment gibt zwei Filter an.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-189">The following code fragment specifies two filters.</span></span> <span data-ttu-id="9e2a8-190">Der Filter mit der Beschreibung "Quelle" weist zwei Muster auf.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-190">The filter with the "Source" description has two patterns.</span></span> <span data-ttu-id="9e2a8-191">Wenn der Benutzer diesen Filter auswählt, zeigt das Dialogfeld nur Dateien mit dem an. C und . CXX-Erweiterungen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-191">If the user selects this filter, the dialog box displays only files that have the .C and .CXX extensions.</span></span> <span data-ttu-id="9e2a8-192">Beachten Sie, dass in der Programmiersprache C eine Zeichenfolge, die in doppelte Anführungszeichen eingeschlossen ist, NULL-terminiert ist.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-192">Note, in the C programming language, a string enclosed in double quotes is null-terminated.</span></span>


```
OPENFILENAME ofn;       // common dialog box structure

ofn.lpstrFilter = "Source\0*.C;*.CXX\0All\0*.*\0"
ofn.nFilterIndex = 1;
```



<span data-ttu-id="9e2a8-193">Der **nFilterIndex-Member** der [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) gibt einen Index an, der angibt, welcher Filter das Dialogfeld anfänglich verwendet.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-193">The **nFilterIndex** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure specifies an index that indicates which filter the dialog box initially uses.</span></span> <span data-ttu-id="9e2a8-194">Der erste Filter im Puffer weist den Index 1, den zweiten 2 usw. auf.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-194">The first filter in the buffer has index 1, the second 2, and so on.</span></span> <span data-ttu-id="9e2a8-195">Wenn der Benutzer den Filter während der Verwendung des Dialogfelds ändert, wird das **Element nFilterIndex** bei der Rückgabe auf den Index des ausgewählten Filters festgelegt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-195">If the user changes the filter while using the dialog box, the **nFilterIndex** member is set to the index of the selected filter on return.</span></span>

<span data-ttu-id="9e2a8-196">Sie können einen benutzerdefinierten Filter erstellen, indem Sie das **lpstrCustomFilter-Member** auf die Adresse eines Puffers festlegen, der einen einzelnen Filter enthält, und indem Sie das **nMaxCustFilter-Member** auf die Größe des Puffers in Zeichen oder Bytes festlegen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-196">You can create a custom filter by setting the **lpstrCustomFilter** member to the address of a buffer that contains a single filter, and by setting the **nMaxCustFilter** member to the size of the buffer, in characters or bytes.</span></span> <span data-ttu-id="9e2a8-197">Das Dialogfeld platziert den benutzerdefinierten Filter immer am Anfang der Filterliste und aktualisiert bei der Rückgabe immer den Musterteil des Filters mit dem Muster aus dem vom Benutzer ausgewählten Filter.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-197">The dialog box always places the custom filter at the beginning of the list of filters and, on return, always updates the pattern part of the filter with the pattern from the filter selected by the user.</span></span>

<span data-ttu-id="9e2a8-198">Bei Dialogfeldern im Explorer-Stil kann sich die Standarderweiterung ändern, wenn der Benutzer einen anderen Filter auswählt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-198">For Explorer-style dialog boxes, the default extension may change if the user selects a different filter.</span></span> <span data-ttu-id="9e2a8-199">Wenn der Benutzer einen Filter auswählt, dessen erstes Muster das Formular \* hat.*xxx* (d. h. die Erweiterung enthält kein Platzhalterzeichen), verwendet das Dialogfeld *xxx* als Standarderweiterung.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-199">If the user selects a filter whose first pattern is of the form \*.*xxx* (that is, the extension does not include a wildcard character), the dialog box uses *xxx* as the default extension.</span></span> <span data-ttu-id="9e2a8-200">Dies tritt nur auf, wenn Sie eine Standarderweiterung im **lpstrDefExt-Member** der [**OPENFILENAME-Struktur angegeben**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) haben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-200">This occurs only if you specified a default extension in the **lpstrDefExt** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span> <span data-ttu-id="9e2a8-201">Wenn der Benutzer z. B. "Quelle \\ 0 " auswählt. \* C; \* . CXX \\ 0"-Filter, die Standarderweiterung wird in "C" geändert.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-201">For example, if the user selects the "Source\\0\*.C;\*.CXX\\0" filter, the default extension changes to "C".</span></span> <span data-ttu-id="9e2a8-202">Wenn Sie den Filter jedoch als "Quelle \\ 0 " definiert \* haben. C \* \\ 0", würde sich die Standarderweiterung nicht ändern, da die Erweiterung einen Platzhalter enthält.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-202">However, if you had defined the filter as "Source\\0\*.C\*\\0", the default extension would not change because the extension includes a wildcard.</span></span>

<span data-ttu-id="9e2a8-203">Die [**CDN \_ INCLUDEITEM-Benachrichtigungsmeldung**](cdn-includeitem.md) bietet eine weitere Möglichkeit, die im Dialogfeld angezeigten Namen zu filtern.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-203">The [**CDN\_INCLUDEITEM**](cdn-includeitem.md) notification message provides another way to filter the names that the dialog box displays.</span></span> <span data-ttu-id="9e2a8-204">Um diese Meldung zu verwenden, geben Sie eine [**OFNHookProc-Hookprozedur**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) an, und geben Sie das **OFN \_ ENABLEINCLUDENOTIFY-Flag** in der [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) an, wenn Sie das Dialogfeld erstellen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-204">To use this message, provide an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure and specify the **OFN\_ENABLEINCLUDENOTIFY** flag in the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="9e2a8-205">Jedes Mal, wenn der Benutzer einen Ordner öffnet, sendet das Dialogfeld für jedes Element im neu geöffneten Ordner eine **CDN \_ INCLUDEITEM-Benachrichtigung** an Die Hookprozedur.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-205">Each time the user opens a folder, the dialog box sends a **CDN\_INCLUDEITEM** notification to your hook procedure for each item in the newly opened folder.</span></span> <span data-ttu-id="9e2a8-206">Der Rückgabewert der Hookprozedur gibt an, ob das Dialogfeld das Element in der Elementliste des Ordners anzeigen soll.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-206">The return value of the hook procedure indicates whether the dialog box should display the item in the folder's item list.</span></span>

## <a name="file-and-directory-validation"></a><span data-ttu-id="9e2a8-207">Datei- und Verzeichnisüberprüfung</span><span class="sxs-lookup"><span data-stu-id="9e2a8-207">File and Directory Validation</span></span>

<span data-ttu-id="9e2a8-208">Sofern nicht anders angegeben, gelten die Informationen in diesem Abschnitt sowohl für Dialogfelder im Explorer- als auch im alten Stil im **Format** Öffnen **und** Speichern unter.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-208">Except as noted, the information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="9e2a8-209">Im Dialogfeld werden vom Benutzer eingegebene Dateinamen automatisch überprüft, um sicherzustellen, dass die Namen nur gültige Zeichen enthalten.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-209">The dialog box automatically validates file names typed by the user to ensure that the names contain only valid characters.</span></span> <span data-ttu-id="9e2a8-210">Um die Überprüfung von Dateinamenzeichen zu überschreiben, legen Sie das **FLAG OFN \_ NOVALIDATE** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-210">To override the file name character validation, set the **OFN\_NOVALIDATE** flag.</span></span>

<span data-ttu-id="9e2a8-211">Um zu erzwingen, dass das Dialogfeld überprüft, ob der Benutzer den Namen einer vorhandenen Datei angegeben hat, legen Sie das **FLAG OFN \_ FILEMUSTEXIST** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-211">To force the dialog box to verify that the user specified the name of an existing file, set the **OFN\_FILEMUSTEXIST** flag.</span></span> <span data-ttu-id="9e2a8-212">Um die Überprüfung zu erzwingen, ob der angegebene Pfad vorhanden ist, legen Sie das **FLAG OFN \_ PATHMUSTEXIST** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-212">To force verification that the specified path exists, set the **OFN\_PATHMUSTEXIST** flag.</span></span> <span data-ttu-id="9e2a8-213">Wenn Sie das **FLAG OFN \_ CREATEPROMPT** festlegen, fordert das Dialogfeld den Benutzer zur Berechtigung zum Erstellen einer nicht vorhandenen Datei auf.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-213">If you set the **OFN\_CREATEPROMPT** flag, the dialog box prompts the user for permission to create a nonexistent file.</span></span> <span data-ttu-id="9e2a8-214">Wenn dieses Flag festgelegt ist und der Benutzer eine neue Datei erstellt, wird das Dialogfeld geschlossen, und die Funktion gibt den angegebenen Namen zurück.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-214">If this flag is set and the user chooses to create a new file, the dialog box closes, and the function returns the specified name.</span></span> <span data-ttu-id="9e2a8-215">Andernfalls bleibt das Dialogfeld geöffnet.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-215">Otherwise, the dialog box remains open.</span></span>

<span data-ttu-id="9e2a8-216">Wenn Sie das Dialogfeld **Speichern unter** verwenden, können Sie das Dialogfeld anweisen, den Benutzer zur Eingabe der Berechtigung zum Überschreiben einer vorhandenen Datei aufzufordern, indem Sie das **FLAG OFN \_ OVERWRITEPROMPT** festlegen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-216">When using the **Save As** dialog box, you can direct the dialog box to prompt the user for permission to overwrite an existing file by setting the **OFN\_OVERWRITEPROMPT** flag.</span></span>

<span data-ttu-id="9e2a8-217">Standardmäßig erstellt das Dialogfeld eine Testdatei der Länge 0 (null), um zu bestimmen, ob eine neue Datei im ausgewählten Verzeichnis erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-217">By default, the dialog box creates a zero-length test file to determine whether a new file can be created in the selected directory.</span></span> <span data-ttu-id="9e2a8-218">Um die Erstellung dieser Testdatei zu verhindern, legen Sie das **FLAG OFN \_ NOTESTFILECREATE** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-218">To prevent the creation of this test file, set the **OFN\_NOTESTFILECREATE** flag.</span></span>

<span data-ttu-id="9e2a8-219">Wenn Sie eine Hookprozedur aktivieren, benachrichtigt das Dialogfeld Ihre Hookprozedur, wenn eine Netzwerkfreigabeverletzung für den vom Benutzer angegebenen Dateinamen auftritt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-219">If you enable a hook procedure, the dialog box notifies your hook procedure when a network sharing violation occurs for the file name specified by the user.</span></span> <span data-ttu-id="9e2a8-220">Wenn Sie das **\_ OFN-EXPLORER-Flag** festlegen, sendet das Dialogfeld die [**CDN \_ SHAREVIOLATION-Nachricht**](cdn-shareviolation.md) an die Hookprozedur.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-220">If you set the **OFN\_EXPLORER** flag, the dialog box sends the [**CDN\_SHAREVIOLATION**](cdn-shareviolation.md) message to the hook procedure.</span></span> <span data-ttu-id="9e2a8-221">Wenn Sie **OFN \_ EXPLORER** nicht festlegen, sendet das Dialogfeld die registrierte [**SHAREVISTRING-Nachricht**](sharevistring.md) an die Hookprozedur.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-221">If you do not set **OFN\_EXPLORER**, the dialog box sends the [**SHAREVISTRING**](sharevistring.md) registered message to the hook procedure.</span></span> <span data-ttu-id="9e2a8-222">Um zu verhindern, dass das Dialogfeld Benachrichtigungen zu Freigabeverletzungen sendet, legen Sie das **OFN \_ SHAREAWARE-Flag** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-222">To prevent the dialog box from sending any notifications for sharing violations, set the **OFN\_SHAREAWARE** flag.</span></span>

<span data-ttu-id="9e2a8-223">Wenn der Benutzer das Kontrollkästchen Schreibgeschützt aktiviert, legt das Dialogfeld das **FLAG OFN \_ READONLY** bei der Rückgabe fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-223">If the user selects the read-only check box, the dialog box sets the **OFN\_READONLY** flag on return.</span></span> <span data-ttu-id="9e2a8-224">Um das Kontrollkästchen Als schreibgeschützt **öffnen** auszublenden, legen Sie das **FLAG OFN \_ HIDEREADONLY** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-224">To hide the **Open As Read Only** check box, set the **OFN\_HIDEREADONLY** flag.</span></span> <span data-ttu-id="9e2a8-225">Um zu verhindern, dass das Dialogfeld Namen vorhandener Dateien mit dem schreibgeschützten Attribut zurücksendet, legen Sie das **OFN \_ NOREADONLYRETURN-Flag** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-225">To prevent the dialog box from returning names of existing files that have the read-only attribute, set the **OFN\_NOREADONLYRETURN** flag.</span></span>

<span data-ttu-id="9e2a8-226">Um zu verhindern, dass das Dialogfeld Linkdateien dereferenziert, legen Sie **den OFN \_ NODEREFERENCELINKS-Wert** fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-226">To prevent the dialog box from dereferencing link files, set the **OFN\_NODEREFERENCELINKS** value.</span></span> <span data-ttu-id="9e2a8-227">In diesem Fall gibt das Dialogfeld anstelle des Namens der Datei, auf die die Linkdatei verweist, den Namen der Linkdatei zurück.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-227">In this case, the dialog box returns the name of the link file rather than the name of the file referenced by the link file.</span></span>

## <a name="open-and-save-as-dialog-box-customization"></a><span data-ttu-id="9e2a8-228">Anpassen des Dialogfelds "Öffnen und Speichern unter"</span><span class="sxs-lookup"><span data-stu-id="9e2a8-228">Open and Save As Dialog Box Customization</span></span>

<span data-ttu-id="9e2a8-229">Sie können ein Dialogfeld **Öffnen oder** **Speichern unter** anpassen, indem Sie eine Hookprozedur, eine benutzerdefinierte Vorlage oder beides bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-229">You can customize an **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="9e2a8-230">Die Versionen der Dialogfelder im Explorer-Stil und im alten Stil unterscheiden sich jedoch in der Verwendung benutzerdefinierter Vorlagen und Hook-Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-230">However, the Explorer-style and old-style versions of the dialog boxes differ in their use of custom templates and hook procedures.</span></span>

<span data-ttu-id="9e2a8-231">Informationen zum Anpassen eines Dialogfelds im Explorer-Stil finden Sie unter Hook-Prozeduren im [Explorer-Stil,](#explorer-style-hook-procedures)benutzerdefinierte Vorlagen im [Explorer-Stil](#explorer-style-custom-templates)und [Steuerelementbezeichner im Explorer-Stil.](#explorer-style-control-identifiers)</span><span class="sxs-lookup"><span data-stu-id="9e2a8-231">For information about customizing an Explorer-style dialog box, see [Explorer-Style Hook Procedures](#explorer-style-hook-procedures), [Explorer-Style Custom Templates](#explorer-style-custom-templates), and [Explorer-Style Control Identifiers](#explorer-style-control-identifiers).</span></span> <span data-ttu-id="9e2a8-232">Informationen zum Anpassen eines Dialogfelds im alten Stil finden Sie unter Anpassen Old-Style [Dialogfeldern](#customizing-old-style-dialog-boxes).</span><span class="sxs-lookup"><span data-stu-id="9e2a8-232">For information about customizing an old-style dialog box, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="9e2a8-233">In der folgenden Tabelle sind die Unterschiede zwischen den beiden Stilen zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-233">The following table summarizes the differences between the two styles.</span></span>



| <span data-ttu-id="9e2a8-234">Anpassung</span><span class="sxs-lookup"><span data-stu-id="9e2a8-234">Customization</span></span>                  | <span data-ttu-id="9e2a8-235">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="9e2a8-235">Description</span></span>                                                                                                                                                                                                                                                                          |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9e2a8-236">Hookprozedur im Explorer-Stil</span><span class="sxs-lookup"><span data-stu-id="9e2a8-236">Explorer-style Hook procedure</span></span>  | <span data-ttu-id="9e2a8-237">Die Hookprozedur empfängt Benachrichtigungsmeldungen, die vom allgemeinen Dialogfeld gesendet werden, sowie Meldungen für alle zusätzlichen Steuerelemente, die Sie durch Angeben einer untergeordneten Dialogvorlage definiert haben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-237">The hook procedure receives notification messages sent from the common dialog box and messages for any additional controls that you defined by specifying a child dialog template.</span></span> <span data-ttu-id="9e2a8-238">Die Hookprozedur erhält keine Nachrichten für die Standardsteuerelemente des Standarddialogfelds.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-238">The hook procedure does not receive messages for the standard controls of the default dialog box.</span></span> |
| <span data-ttu-id="9e2a8-239">Benutzerdefinierte Vorlage im Explorer-Stil</span><span class="sxs-lookup"><span data-stu-id="9e2a8-239">Explorer-style Custom template</span></span> | <span data-ttu-id="9e2a8-240">Das System verwendet die benutzerdefinierte Vorlage, um ein untergeordnetes Dialogfeld zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-240">The system uses the custom template to create a child dialog box.</span></span> <span data-ttu-id="9e2a8-241">Die Vorlage kann zusätzliche Steuerelemente definieren und den Speicherort des Clusters von Standardsteuerelementen angeben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-241">The template can define additional controls, and can specify the location of the cluster of standard controls.</span></span> <span data-ttu-id="9e2a8-242">Die benutzerdefinierte Vorlage ersetzt nicht die Standardvorlage.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-242">The custom template does not replace the default template.</span></span>                                          |
| <span data-ttu-id="9e2a8-243">Hookprozedur im alten Stil</span><span class="sxs-lookup"><span data-stu-id="9e2a8-243">Old-style Hook procedure</span></span>       | <span data-ttu-id="9e2a8-244">Die Hookprozedur empfängt alle nachrichten, die an das Dialogfeld gesendet werden, einschließlich Nachrichten für die Standardsteuerelemente und alle benutzerdefinierten Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-244">The hook procedure receives all messages sent to the dialog box, including messages for the standard controls and any custom controls.</span></span> <span data-ttu-id="9e2a8-245">Die Hookprozedur empfängt auch registrierte Nachrichten, die vom allgemeinen Dialogfeld gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-245">The hook procedure also receives registered messages sent from the common dialog box.</span></span>                                                         |
| <span data-ttu-id="9e2a8-246">Benutzerdefinierte Vorlage im alten Stil</span><span class="sxs-lookup"><span data-stu-id="9e2a8-246">Old-style Custom template</span></span>      | <span data-ttu-id="9e2a8-247">Die benutzerdefinierte Vorlage ersetzt die Standardvorlage.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-247">The custom template replaces the default template.</span></span> <span data-ttu-id="9e2a8-248">Erstellen Sie die benutzerdefinierte Vorlage, indem Sie die in der Datei Fileopen.dlg angegebene Standardvorlage ändern.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-248">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span>                                                                                                                                  |



 

<span data-ttu-id="9e2a8-249">Der Standardtitel für Dialogfelder im Explorer- und alten Stil ist entweder **"Öffnen"** oder **"Speichern unter".**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-249">The default title for both Explorer-style and old-style dialog boxes is either "**Open**" or "**Save As**."</span></span> <span data-ttu-id="9e2a8-250">Um den Titel zu ändern, geben Sie den neuen Titel im **lpstrTitle-Member** der [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) an.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-250">To change the title, specify the new title in the **lpstrTitle** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="9e2a8-251">Die Registrierungsstruktur **HKEY \_ CURRENT \_ USER** eines Benutzers kann Werte enthalten,  die den Inhalt der Dialogfelder Öffnen und Speichern unter im **Explorer-Stil** anpassen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-251">A user's **HKEY\_CURRENT\_USER** registry hive can contain values that customize the contents of the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="9e2a8-252">Diese Registrierungseinträge wirken sich nur auf die Dialogfelder aus, die für den Benutzer angezeigt werden, der der Registrierungsstruktur zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-252">These registry entries affect only the dialog boxes displayed for the user associated with the registry hive.</span></span>

<span data-ttu-id="9e2a8-253">Ein Administrator kann die  Werte  in der folgenden Tabelle unter diesem Unterschlüssel festlegen, um Funktionen von Dialogfeldern im Explorer-Stil zu öffnen und speichern unter auszublenden:</span><span class="sxs-lookup"><span data-stu-id="9e2a8-253">To hide features of Explorer-style **Open** and **Save As** dialog boxes, an administrator can set the values in the following table under this subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
```



| <span data-ttu-id="9e2a8-254">Wertname</span><span class="sxs-lookup"><span data-stu-id="9e2a8-254">Value name</span></span>       | <span data-ttu-id="9e2a8-255">Wert</span><span class="sxs-lookup"><span data-stu-id="9e2a8-255">Value</span></span> | <span data-ttu-id="9e2a8-256">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="9e2a8-256">Meaning</span></span>                                  |
|------------------|-------|------------------------------------------|
| <span data-ttu-id="9e2a8-257">**NoPlacesBar**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-257">**NoPlacesBar**</span></span>  | <span data-ttu-id="9e2a8-258">1</span><span class="sxs-lookup"><span data-stu-id="9e2a8-258">1</span></span>     | <span data-ttu-id="9e2a8-259">Blendet die Stellenleiste aus.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-259">Hides the places bar.</span></span>                    |
| <span data-ttu-id="9e2a8-260">**NoFileMRU**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-260">**NoFileMRU**</span></span>    | <span data-ttu-id="9e2a8-261">1</span><span class="sxs-lookup"><span data-stu-id="9e2a8-261">1</span></span>     | <span data-ttu-id="9e2a8-262">Blendet die Liste Zuletzt verwendet (MRU) aus.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-262">Hides the Most Recently Used (MRU) list.</span></span> |
| <span data-ttu-id="9e2a8-263">**NoBackButton**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-263">**NoBackButton**</span></span> | <span data-ttu-id="9e2a8-264">1</span><span class="sxs-lookup"><span data-stu-id="9e2a8-264">1</span></span>     | <span data-ttu-id="9e2a8-265">Blendet die **Schaltfläche Zurück** aus.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-265">Hides the **Back** button.</span></span>               |



 

<span data-ttu-id="9e2a8-266">Der Inhalt der **Leiste Orte** wird durch den Inhalt des folgenden Unterschlüssels bestimmt:</span><span class="sxs-lookup"><span data-stu-id="9e2a8-266">The contents of the **Places** bar are determined by the contents of the following subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
                     Placesbar
```

<span data-ttu-id="9e2a8-267">Derzeit können unter diesem Schlüssel nur fünf Einträge enthalten sein, und der Wert-/Namensindex ist null-basiert.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-267">Currently, there can only be five entries under this key, and the value/name index is zero-based.</span></span> <span data-ttu-id="9e2a8-268">Die Namen für die Einträge sollten Place0, Place1, Place2, Place3 und Place4 sein.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-268">The names for the entries should be Place0, Place1, Place2,Place3, and Place4.</span></span> <span data-ttu-id="9e2a8-269">Die Werte der Einträge können **REG \_ DWORD-,** **REG \_ SZ-** oder **REG EXPAND \_ \_ SZ-Werte** sein, die Orte identifizieren, die in die Stellenleiste ein-/ausdehnen sollen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-269">The values of the entries can be **REG\_DWORD**, **REG\_SZ**, or **REG\_EXPAND\_SZ** values that identify locations to include in the places bar.</span></span>



| <span data-ttu-id="9e2a8-270">Werttyp</span><span class="sxs-lookup"><span data-stu-id="9e2a8-270">Value type</span></span>                         | <span data-ttu-id="9e2a8-271">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="9e2a8-271">Meaning</span></span>                                                                                                   |
|------------------------------------|-----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9e2a8-272">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-272">**REG\_DWORD**</span></span>                     | <span data-ttu-id="9e2a8-273">Ein CSIDL-Wert, der einen Ordner identifiziert.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-273">A CSIDL value that identifies a folder.</span></span> <span data-ttu-id="9e2a8-274">Eine Liste der CSIDL-Werte finden Sie unter [**CSIDL-Werte.**](../shell/csidl.md)</span><span class="sxs-lookup"><span data-stu-id="9e2a8-274">For a list of CSIDL values, see [**CSIDL values**](../shell/csidl.md).</span></span> |
| <span data-ttu-id="9e2a8-275">**REG \_ SZ** oder **REG EXPAND \_ \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-275">**REG\_SZ** or **REG\_EXPAND\_SZ**</span></span> | <span data-ttu-id="9e2a8-276">Eine auf NULL endende Zeichenfolge, die einen gültigen Pfad angibt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-276">A null-terminated string that specifies a valid path.</span></span>                                                     |



 

## <a name="explorer-style-hook-procedures"></a><span data-ttu-id="9e2a8-277">Explorer-Style Hookprozessen</span><span class="sxs-lookup"><span data-stu-id="9e2a8-277">Explorer-Style Hook Procedures</span></span>

<span data-ttu-id="9e2a8-278">Sie können das Dialogfeld **Öffnen** oder **Speichern** unter im Explorer-Stil anpassen, indem Sie eine Hookprozedur, eine benutzerdefinierte Vorlage oder beides bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-278">You can customize an Explorer-style **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="9e2a8-279">Wenn Sie eine Hookprozedur für ein Dialogfeld im Explorer-Stil bereitstellen, erstellt das System ein Dialogfeld, das ein untergeordnetes Element des Standarddialogfelds ist.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-279">If you provide a hook procedure for an Explorer-style dialog box, the system creates a dialog box that is a child of the default dialog box.</span></span> <span data-ttu-id="9e2a8-280">Die Hookprozedur fungiert als Dialogprozedur für das untergeordnete Dialogfeld.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-280">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="9e2a8-281">Dieses untergeordnete Dialogfeld basiert auf der benutzerdefinierten Vorlage oder auf einer Standardvorlage, wenn keine bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-281">This child dialog box is based on the custom template, or on a default template if none is provided.</span></span> <span data-ttu-id="9e2a8-282">Weitere Informationen finden Sie unter Benutzerdefinierte Vorlagen im [Explorer-Stil.](#explorer-style-custom-templates)</span><span class="sxs-lookup"><span data-stu-id="9e2a8-282">For more information, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

<span data-ttu-id="9e2a8-283">Um eine Hookprozedur für ein **Dialogfeld** im Explorer-Stil **zu** aktivieren, verwenden Sie beim Erstellen des Dialogfelds die [**OPENFILENAME-Struktur.**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)</span><span class="sxs-lookup"><span data-stu-id="9e2a8-283">To enable a hook procedure for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="9e2a8-284">Legen Sie die **FLAGS OFN \_ ENABLEHOOK** und **OFN \_ EXPLORER** im **Flags-Member** fest, und geben Sie die Adresse einer [**OFNHookProc-Hookprozedur**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) im **lpfnHook-Member** an.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-284">Set the **OFN\_ENABLEHOOK** and **OFN\_EXPLORER** flags in the **Flags** member and specify the address of an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="9e2a8-285">Wenn Sie eine Hookprozedur angeben und das **\_ OFN-EXPLORER-Flag** weglassen, müssen Sie eine [**OFNHookProcOldStyle-Hookprozedur**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) verwenden, und Sie erhalten die Benutzeroberfläche im alten Stil.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-285">If you provide a hook procedure and omit the **OFN\_EXPLORER** flag, you must use an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and you will get the old-style user-interface.</span></span> <span data-ttu-id="9e2a8-286">Weitere Informationen finden Sie unter [Anpassen von Old-Style Dialogfeldern.](#customizing-old-style-dialog-boxes)</span><span class="sxs-lookup"><span data-stu-id="9e2a8-286">For more information, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="9e2a8-287">Eine Hookprozedur im Explorer-Stil empfängt eine Vielzahl von Nachrichten, während das Dialogfeld geöffnet ist.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-287">An Explorer-style hook procedure receives a variety of messages while the dialog box is open.</span></span> <span data-ttu-id="9e2a8-288">Dabei handelt es sich z. B. um:</span><span class="sxs-lookup"><span data-stu-id="9e2a8-288">These include the following:</span></span>

-   <span data-ttu-id="9e2a8-289">Die [**WM \_ INITDIALOG-Nachricht**](wm-initdialog.md) und andere Standarddialogfeldmeldungen, z. B. die [**WM \_ CTLCOLORDLG-Steuerelementfarbmeldung.**](wm-ctlcolordlg.md)</span><span class="sxs-lookup"><span data-stu-id="9e2a8-289">The [**WM\_INITDIALOG**](wm-initdialog.md) message and other standard dialog box messages such as the [**WM\_CTLCOLORDLG**](wm-ctlcolordlg.md) control color message.</span></span>
-   <span data-ttu-id="9e2a8-290">Eine Reihe von [**WM NOTIFY-Benachrichtigungsmeldungen, \_**](../controls/wm-notify.md) die auf Aktionen hinweisen, die vom Benutzer oder anderen Dialogfeldereignissen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-290">A set of [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user or other dialog box events.</span></span>
-   <span data-ttu-id="9e2a8-291">Meldungen für alle zusätzlichen Steuerelemente, die Sie durch Angeben einer Vorlage für untergeordnete Dialoge definiert haben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-291">Messages for any additional controls that you defined by specifying a child dialog template.</span></span>

<span data-ttu-id="9e2a8-292">Darüber hinaus gibt es eine Reihe von Nachrichten, die Sie an ein Dialogfeld im Explorer-Stil senden können, um Informationen abzurufen oder das Verhalten und die Darstellung des Dialogfelds zu steuern.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-292">In addition, there is a set of messages that you can send to an Explorer-style dialog box to get information or to control the behavior and appearance of the dialog box.</span></span>

<span data-ttu-id="9e2a8-293">Wenn Sie eine Hookprozedur für ein Dialogfeld im Explorer-Stil bereitstellen, erstellt die Standarddialogfeldprozedur ein untergeordnetes Dialogfeld, wenn die Standarddialogprozedur die [**WM \_ INITDIALOG-Meldung**](wm-initdialog.md) verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-293">If you provide a hook procedure for an Explorer-style dialog box, the default dialog box procedure creates a child dialog box when the default dialog procedure is processing its [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="9e2a8-294">Die Hookprozedur fungiert als Dialogprozedur für das untergeordnete Dialogfeld.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-294">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="9e2a8-295">Zu diesem Zeitpunkt empfängt die Hookprozedur eine eigene **WM \_ INITDIALOG-Nachricht,** bei der der *lParam-Parameter* auf die Adresse der [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) festgelegt ist, die zum Initialisieren des Dialogfelds verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-295">At this time, the hook procedure receives its own **WM\_INITDIALOG** message with the *lParam* parameter set to the address of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure used to initialize the dialog box.</span></span> <span data-ttu-id="9e2a8-296">Nachdem der untergeordnete Dialog die Verarbeitung seiner eigenen **WM \_ INITDIALOG-Nachricht** abgeschlossen hat, verschiebt die Standarddialogprozedur bei Bedarf die Standardsteuerelemente, um Platz für zusätzliche Steuerelemente des untergeordneten Dialogfelds zu machen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-296">After the child dialog finishes processing its own **WM\_INITDIALOG** message, the default dialog procedure moves the standard controls, if necessary, to make room for any additional controls of the child dialog box.</span></span> <span data-ttu-id="9e2a8-297">Die Standarddialogprozedur sendet dann die [**CDN \_ INITDONE-Benachrichtigungsnachricht**](cdn-initdone.md) an die Hookprozedur.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-297">The default dialog procedure then sends the [**CDN\_INITDONE**](cdn-initdone.md) notification message to the hook procedure.</span></span>

<span data-ttu-id="9e2a8-298">Die Hookprozedur [**empfängt WM \_ NOTIFY-Benachrichtigungen,**](../controls/wm-notify.md) die vom Benutzer im Dialogfeld durchgeführte Aktionen angeben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-298">The hook procedure receives [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user in the dialog box.</span></span> <span data-ttu-id="9e2a8-299">Sie können einige dieser Meldungen verwenden, um das Verhalten des Dialogfelds zu steuern.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-299">You can use some of these messages to control the behavior of the dialog box.</span></span> <span data-ttu-id="9e2a8-300">Beispielsweise empfängt die Hookprozedur die [**CDN \_ FILEOK-Meldung,**](cdn-fileok.md) wenn der Benutzer einen Dateinamen auswählt und auf die **Schaltfläche OK** klickt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-300">For example, the hook procedure receives the [**CDN\_FILEOK**](cdn-fileok.md) message when the user chooses a file name and clicks the **OK** button.</span></span> <span data-ttu-id="9e2a8-301">Als Reaktion auf diese Meldung kann die Hookprozedur die [**SetWindowLong-Funktion**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) verwenden, um den ausgewählten Namen abzulehnen und zu erzwingen, dass das Dialogfeld geöffnet bleibt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-301">In response to this message, the hook procedure can use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to reject the selected name and force the dialog box to remain open.</span></span>

<span data-ttu-id="9e2a8-302">Der *lParam-Parameter* für jede [**WM \_ NOTIFY-Nachricht**](../controls/wm-notify.md) ist ein Zeiger auf eine [**OFNOTIFY-**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) oder [**OFNOTIFYEX-Struktur,**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) die die Aktion definiert.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-302">The *lParam* parameter for each [**WM\_NOTIFY**](../controls/wm-notify.md) message is a pointer to an [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) or [**OFNOTIFYEX**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) structure that defines the action.</span></span> <span data-ttu-id="9e2a8-303">Der **Code** member im Header dieser Struktur enthält eine der folgenden Benachrichtigungsmeldungen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-303">The **code** member in the header of this structure contains one of the following notification messages.</span></span>



| <span data-ttu-id="9e2a8-304">Nachricht</span><span class="sxs-lookup"><span data-stu-id="9e2a8-304">Message</span></span>                                           | <span data-ttu-id="9e2a8-305">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="9e2a8-305">Meaning</span></span>                                                                                                                                                                                                                                                                                        |
|---------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9e2a8-306">**CDN \_ FILEOK**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-306">**CDN\_FILEOK**</span></span>](cdn-fileok.md)                 | <span data-ttu-id="9e2a8-307">Der Benutzer hat auf die Schaltfläche **OK** geklickt. Das Dialogfeld wird geschlossen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-307">The user clicked the **OK** button; the dialog box is about to close.</span></span>                                                                                                                                                                                                                          |
| [<span data-ttu-id="9e2a8-308">**CDN \_ FOLDERCHANGE**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-308">**CDN\_FOLDERCHANGE**</span></span>](cdn-folderchange.md)     | <span data-ttu-id="9e2a8-309">Der Benutzer hat einen neuen Ordner oder ein neues Verzeichnis geöffnet.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-309">The user opened a new folder or directory.</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="9e2a8-310">**\_CDN-HILFE**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-310">**CDN\_HELP**</span></span>](cdn-help.md)                     | <span data-ttu-id="9e2a8-311">Der Benutzer hat auf die Schaltfläche **Hilfe** geklickt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-311">The user clicked the **Help** button.</span></span>                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="9e2a8-312">**CDN \_ INCLUDEITEM**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-312">**CDN\_INCLUDEITEM**</span></span>](cdn-includeitem.md)       | <span data-ttu-id="9e2a8-313">Bestimmt, ob ein Element angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-313">Determines whether an item should be displayed.</span></span> <span data-ttu-id="9e2a8-314">Wenn der Benutzer einen neuen Ordner oder ein neues Verzeichnis öffnet, sendet das System diese Benachrichtigung für jedes Element im Ordner oder Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-314">When the user opens a new folder or directory, the system sends this notification for each item in the folder or directory.</span></span> <span data-ttu-id="9e2a8-315">Das System sendet diese Benachrichtigung nur, wenn das **FLAG OFN \_ ENABLEINCLUDENOTIFY** festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-315">The system sends this notification only if the **OFN\_ENABLEINCLUDENOTIFY** flag was set.</span></span>                          |
| [<span data-ttu-id="9e2a8-316">**CDN \_ INITDONE**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-316">**CDN\_INITDONE**</span></span>](cdn-initdone.md)             | <span data-ttu-id="9e2a8-317">Das System hat die Initialisierung des Dialogfelds abgeschlossen, und das Dialogfeld hat die Verarbeitung der [**WM \_ INITDIALOG-Meldung**](wm-initdialog.md) abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-317">The system has finished initializing the dialog box, and the dialog box has finished processing the [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="9e2a8-318">Außerdem hat das System die Anordnung von Steuerelementen im allgemeinen Dialogfeld abgeschlossen, um Platz für die Steuerelemente des untergeordneten Dialogfelds zu schaffen (sofern vorhanden).</span><span class="sxs-lookup"><span data-stu-id="9e2a8-318">Also, the system has finished arranging controls in the common dialog box to make room for the controls of the child dialog box (if any).</span></span> |
| [<span data-ttu-id="9e2a8-319">**CDN \_ SELCHANGE**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-319">**CDN\_SELCHANGE**</span></span>](cdn-selchange.md)           | <span data-ttu-id="9e2a8-320">Der Benutzer hat eine neue Datei oder einen neuen Ordner aus der Dateiliste ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-320">The user selected a new file or folder from the file list.</span></span>                                                                                                                                                                                                                                     |
| [<span data-ttu-id="9e2a8-321">**CDN \_ SHAREVIOLATION**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-321">**CDN\_SHAREVIOLATION**</span></span>](cdn-shareviolation.md) | <span data-ttu-id="9e2a8-322">Im allgemeinen Dialogfeld ist ein Freigabeverstoß für die Datei aufgetreten, die zurückgegeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-322">The common dialog box encountered a sharing violation on the file about to be returned.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="9e2a8-323">**CDN \_ TYPECHANGE**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-323">**CDN\_TYPECHANGE**</span></span>](cdn-typechange.md)         | <span data-ttu-id="9e2a8-324">Der Benutzer hat einen neuen Dateityp aus der Liste der Dateitypen ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-324">The user selected a new file type from the list of file types.</span></span>                                                                                                                                                                                                                                 |



 

<span data-ttu-id="9e2a8-325">Diese [**WM \_ NOTIFY-Meldungen**](../controls/wm-notify.md) ersetzen die registrierten Meldungen [**FILEOKSTRING,**](fileokstring.md) [**LBSELCHSTRING,**](lbselchstring.md) [**SHAREVISTRING**](sharevistring.md)und [**HELPMSGSTRING,**](helpmsgstring.md) die von früheren Versionen der Dialogfelder **Öffnen** und **Speichern unter** verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-325">These [**WM\_NOTIFY**](../controls/wm-notify.md) messages supersede the [**FILEOKSTRING**](fileokstring.md), [**LBSELCHSTRING**](lbselchstring.md), [**SHAREVISTRING**](sharevistring.md), and [**HELPMSGSTRING**](helpmsgstring.md) registered messages used by previous versions of the **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="9e2a8-326">Die Hookprozedur empfängt jedoch auch die abgelöste Nachricht nach der **WM \_ NOTIFY-Nachricht,** wenn die **WM \_ NOTIFY-Verarbeitung** [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) nicht verwendet, um einen **\_ DWL-MSGRESULT-Wert** ungleich 0 festzulegen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-326">However, the hook procedure also receives the superseded message after the **WM\_NOTIFY** message if the **WM\_NOTIFY** processing does not use [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) to set a nonzero **DWL\_MSGRESULT** value.</span></span>

<span data-ttu-id="9e2a8-327">Um Informationen zum Status des Dialogfelds abzurufen oder das Verhalten und die Darstellung des Dialogfelds zu steuern, kann die Hookprozedur die folgenden Meldungen an das Dialogfeld senden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-327">To retrieve information about the status of the dialog box or to control the behavior and appearance of the dialog box, the hook procedure can send the following messages to the dialog box.</span></span>



| <span data-ttu-id="9e2a8-328">Nachricht</span><span class="sxs-lookup"><span data-stu-id="9e2a8-328">Message</span></span>                                             | <span data-ttu-id="9e2a8-329">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="9e2a8-329">Meaning</span></span>                                                                                                                                                                                                                  |
|-----------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9e2a8-330">**CDM \_ GETFILEPATH**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-330">**CDM\_GETFILEPATH**</span></span>](cdm-getfilepath.md)         | <span data-ttu-id="9e2a8-331">Ruft den Pfad und den Dateinamen der ausgewählten Datei ab.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-331">Retrieves the path and file name of the selected file.</span></span>                                                                                                                                                                   |
| [<span data-ttu-id="9e2a8-332">**CDM \_ GETFOLDERIDLIST**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-332">**CDM\_GETFOLDERIDLIST**</span></span>](cdm-getfolderidlist.md) | <span data-ttu-id="9e2a8-333">Ruft die Elementbezeichnerliste ab, die dem aktuellen Ordner entspricht, den das Dialogfeld geöffnet hat.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-333">Retrieves the item identifier list corresponding to the current folder that the dialog box has open.</span></span> <span data-ttu-id="9e2a8-334">Weitere Informationen zu Elementbezeichnerlisten finden Sie unter [Einführung in den Shellnamespace](/windows/desktop/shell/namespace-intro).</span><span class="sxs-lookup"><span data-stu-id="9e2a8-334">For more information about item identifier lists, see [Introduction to the Shell Namespace](/windows/desktop/shell/namespace-intro).</span></span> |
| [<span data-ttu-id="9e2a8-335">**CDM \_ GETFOLDERPATH**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-335">**CDM\_GETFOLDERPATH**</span></span>](cdm-getfolderpath.md)     | <span data-ttu-id="9e2a8-336">Ruft den Pfad des aktuellen Ordners oder Verzeichnisses für das Dialogfeld ab.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-336">Retrieves the path of the current folder or directory for the dialog box.</span></span>                                                                                                                                                |
| [<span data-ttu-id="9e2a8-337">**CDM \_ GETSPEC**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-337">**CDM\_GETSPEC**</span></span>](cdm-getspec.md)                 | <span data-ttu-id="9e2a8-338">Ruft den Dateinamen (ohne den Pfad) der datei ab, die derzeit im Dialogfeld ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-338">Retrieves the file name (not including the path) of the file currently selected in the dialog box.</span></span>                                                                                                                       |
| [<span data-ttu-id="9e2a8-339">**CDM \_ HIDECONTROL**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-339">**CDM\_HIDECONTROL**</span></span>](cdm-hidecontrol.md)         | <span data-ttu-id="9e2a8-340">Blendet das angegebene Steuerelement aus.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-340">Hides the specified control.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="9e2a8-341">**CDM \_ SETCONTROLTEXT**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-341">**CDM\_SETCONTROLTEXT**</span></span>](cdm-setcontroltext.md)   | <span data-ttu-id="9e2a8-342">Legt den Text im angegebenen Steuerelement fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-342">Sets the text in the specified control.</span></span>                                                                                                                                                                                  |
| [<span data-ttu-id="9e2a8-343">**CDM \_ SETDEFEXT**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-343">**CDM\_SETDEFEXT**</span></span>](cdm-setdefext.md)             | <span data-ttu-id="9e2a8-344">Legt die Standarddateinamenerweiterung für das Dialogfeld fest.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-344">Sets the default file name extension for the dialog box.</span></span>                                                                                                                                                                 |



 

## <a name="explorer-style-custom-templates"></a><span data-ttu-id="9e2a8-345">Explorer-Style von benutzerdefinierten Vorlagen</span><span class="sxs-lookup"><span data-stu-id="9e2a8-345">Explorer-Style Custom Templates</span></span>

<span data-ttu-id="9e2a8-346">Verwenden Sie zum Definieren zusätzlicher  Steuerelemente für das Dialogfeld Öffnen oder Speichern unter im Explorer-Stil die [**OPENFILENAME-Struktur,**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) um eine Vorlage für ein untergeordnetes Dialogfeld anzugeben, das die zusätzlichen Steuerelemente enthält. </span><span class="sxs-lookup"><span data-stu-id="9e2a8-346">To define additional controls for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a template for a child dialog box that contains the additional controls.</span></span> <span data-ttu-id="9e2a8-347">Wenn Ihre untergeordnete Dialogvorlage eine Ressource in einer Anwendung oder Dynamic Link Library ist, legen Sie das **OFN \_ ENABLETEMPLATE-Flag** im **Flags-Element** fest, und verwenden Sie die **Elemente hInstance** und **lpTemplateName** der Struktur, um das Modul und den Ressourcennamen zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-347">If your child dialog template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="9e2a8-348">Wenn sich die Vorlage bereits im Arbeitsspeicher befindet, legen Sie das **OFN \_ ENABLETEMPLATEHANDLE-Flag** fest, und verwenden Sie den **hInstance-Member,** um das Speicherobjekt zu identifizieren, das die Vorlage enthält.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-348">If the template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="9e2a8-349">Wenn Sie eine untergeordnete Dialogfeldvorlage für ein Dialogfeld im Explorer-Stil bereitstellen, müssen Sie auch das **\_ OFN-EXPLORER-Flag** festlegen. Andernfalls geht das System davon aus, dass Sie eine Ersatzvorlage für ein Dialogfeld im alten Stil bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-349">When providing a child dialog template for an Explorer-style dialog box, you must also set the **OFN\_EXPLORER** flag; otherwise, the system assumes you are providing a replacement template for an old-style dialog box.</span></span> <span data-ttu-id="9e2a8-350">Wenn Sie zusätzliche Steuerelemente bereitstellen, müssen Sie in der Regel auch eine Hookprozedur im [Explorer-Stil](#explorer-style-hook-procedures) bereitstellen, um Nachrichten für die neuen Steuerelemente zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-350">Typically, if you provide additional controls, you must also provide an [Explorer-style hook procedure](#explorer-style-hook-procedures) to process messages for the new controls.</span></span>

<span data-ttu-id="9e2a8-351">Sie können ihre untergeordnete Dialogfeldvorlage wie jede andere Vorlage erstellen, mit der Ausnahme, dass Sie die **Formate WS \_ CHILD** und **WS \_ CLIPSIBLINGS** angeben müssen und die **Stile DS \_ 3DLOOK** und **DS \_ CONTROL** angeben sollten.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-351">You can create your child dialog box template as you do any other template, except that you must specify the **WS\_CHILD** and **WS\_CLIPSIBLINGS** styles and should specify the **DS\_3DLOOK** and **DS\_CONTROL** styles.</span></span> <span data-ttu-id="9e2a8-352">Das System erfordert den **WS \_ CHILD-Stil,** da Ihre Vorlage ein untergeordnetes Dialogfeld des Standarddialogfelds **Öffnen** oder **Speichern unter** definiert.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-352">The system requires the **WS\_CHILD** style because your template defines a child dialog of the default **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="9e2a8-353">Der **WS \_ CLIPSIBLINGS-Stil** stellt sicher, dass das untergeordnete Dialogfeld keine Steuerelemente im Standarddialogfeld zeichnet.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-353">The **WS\_CLIPSIBLINGS** style ensures that the child dialog box does not paint over any of the controls in the default dialog box.</span></span> <span data-ttu-id="9e2a8-354">Der **DS \_ 3DLOOK-Stil** stellt sicher, dass die Darstellung der Steuerelemente im untergeordneten Dialogfeld mit den Steuerelementen im Standarddialogfeld konsistent ist.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-354">The **DS\_3DLOOK** style makes sure that the appearance of the controls in the child dialog box is consistent with the controls in the default dialog box.</span></span> <span data-ttu-id="9e2a8-355">Der **DS \_ CONTROL-Stil** stellt sicher, dass der Benutzer die TAB-TASTE und andere Navigationsschlüssel verwenden kann, um zwischen allen Steuerelementen (Standard oder benutzerdefiniert) im benutzerdefinierten Dialogfeld zu wechseln.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-355">The **DS\_CONTROL** style makes sure that the user can use the TAB and other navigation keys to move between all controls, default or custom, in the customized dialog box.</span></span>

<span data-ttu-id="9e2a8-356">Um Platz für die neuen Steuerelemente zu schaffen, erweitert das System das Standarddialogfeld um die Breite und Höhe des benutzerdefinierten Dialogfelds.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-356">To make room for the new controls, the system expands the default dialog box by the width and height of the custom dialog box.</span></span> <span data-ttu-id="9e2a8-357">Standardmäßig werden alle Steuerelemente aus dem benutzerdefinierten Dialogfeld unterhalb der Steuerelemente im Standarddialogfeld positioniert.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-357">By default, all controls from the custom dialog box are positioned below the controls in the default dialog box.</span></span> <span data-ttu-id="9e2a8-358">Sie können diese Standardpositionierung jedoch überschreiben, indem Sie ein statisches Textsteuerelement in Ihre benutzerdefinierte Dialogfeldvorlage einschließen und ihm den Steuerelementbezeichnerwert **stc32** zuweisen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-358">However, you can override this default positioning by including a static text control in your custom dialog box template and assigning it the control identifier value of **stc32**.</span></span> <span data-ttu-id="9e2a8-359">(Dieser Wert wird in der Headerdatei Dlgs.h definiert.) In diesem Fall verwendet das System das -Steuerelement als Bezugspunkt, um zu bestimmen, wo die neuen Steuerelemente positioniert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-359">(This value is defined in the Dlgs.h header file.) In this case, the system uses the control as the point of reference for determining where to position the new controls.</span></span> <span data-ttu-id="9e2a8-360">Alle neuen Steuerelemente oberhalb und links vom **stc32-Steuerelement** werden in der gleichen Menge oberhalb und links von den Steuerelementen im Standarddialogfeld positioniert.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-360">All new controls above and to the left of the **stc32** control are positioned the same amount above and to the left of the controls in the default dialog box.</span></span> <span data-ttu-id="9e2a8-361">Neue Steuerelemente unten und rechts vom **stc32-Steuerelement** befinden sich unten und rechts neben den Standardsteuerelementen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-361">New controls below and to the right of the **stc32** control are positioned below and to the right of the default controls.</span></span> <span data-ttu-id="9e2a8-362">Im Allgemeinen wird jedes neue Steuerelement so positioniert, dass es relativ zu den Standardsteuerelementen die gleiche Position hat wie das **stc32-Steuerelement.**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-362">In general, each new control is positioned so that it has the same position relative to the default controls as it had to the **stc32** control.</span></span> <span data-ttu-id="9e2a8-363">Um Platz für diese neuen Steuerelemente zu schaffen, fügt das System nach Bedarf Platz auf der linken, rechten, unteren und oberen Seite des Standarddialogfelds hinzu.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-363">To make room for these new controls, the system adds space to the left, right, bottom, and top of the default dialog box as needed.</span></span>

<span data-ttu-id="9e2a8-364">Das System erfordert die Hookprozedur, um alle Für das benutzerdefinierte Dialogfeld vorgesehenen Nachrichten zu verarbeiten, und sendet daher die gleichen Fenstermeldungen an die Hookprozedur wie für jede andere Dialogfeldprozedur.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-364">The system requires the hook procedure to process all messages intended for the custom dialog box and therefore sends the same window messages to the hook procedure as to any other dialog box procedure.</span></span> <span data-ttu-id="9e2a8-365">Beispielsweise empfängt die Hookprozedur [**WM \_ COMMAND-Meldungen,**](/windows/desktop/menurc/wm-command) wenn der Benutzer im benutzerdefinierten Dialogfeld auf Schaltflächensteuerelemente klickt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-365">For example, the hook procedure receives [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages when the user clicks on button controls in the custom dialog box.</span></span> <span data-ttu-id="9e2a8-366">Die Hookprozedur ist für das Initialisieren dieser Steuerelemente und das Abrufen von Werten aus den Steuerelementen zuständig, wenn das Dialogfeld geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-366">The hook procedure is responsible for initializing these controls and retrieving values from the controls when the dialog box is closed.</span></span> <span data-ttu-id="9e2a8-367">Beachten Sie, dass das System die Steuerelemente noch nicht an die endgültigen Positionen verschoben hat, wenn die Hookprozedur die [**WM \_ INITDIALOG-Meldung**](wm-initdialog.md) empfängt.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-367">Note that when the hook procedure receives the [**WM\_INITDIALOG**](wm-initdialog.md) message, the system has not yet moved the controls to their final positions.</span></span>

<span data-ttu-id="9e2a8-368">Die Standarddialogfeldprozedur verarbeitet Meldungen für alle Steuerelemente im Standarddialogfeld, aber die Hookprozedur empfängt die Benachrichtigungsmeldungen für Benutzeraktionen für diese Steuerelemente, wie unter Hookprozeduren im [Explorer-Stil beschrieben.](#explorer-style-hook-procedures)</span><span class="sxs-lookup"><span data-stu-id="9e2a8-368">The default dialog box procedure handles messages for all the controls in the default dialog box, but the hook procedure receives the notification messages for user actions on these controls as described in [Explorer-Style Hook Procedures](#explorer-style-hook-procedures).</span></span>

## <a name="explorer-style-control-identifiers"></a><span data-ttu-id="9e2a8-369">Explorer-Style Steuerelementbezeichner</span><span class="sxs-lookup"><span data-stu-id="9e2a8-369">Explorer-Style Control Identifiers</span></span>

<span data-ttu-id="9e2a8-370">Das Windows Software Development Kit (SDK) stellt die Standarddialogfeldvorlage für die Dialogfelder im alten Stil bereit, enthält jedoch nicht die Standardvorlage für die Dialogfelder im Explorer-Stil.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-370">The Windows Software Development Kit (SDK) provides the default dialog box template for the old-style dialog boxes, but does not include the default template for the Explorer-style dialog boxes.</span></span> <span data-ttu-id="9e2a8-371">Dies liegt daran, dass Sie in den Dialogfeldern im Explorer-Stil eigene Steuerelemente hinzufügen können, aber das Ändern der Vorlage für die Standardsteuerelemente nicht unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-371">This is because the Explorer-style dialog boxes allow you to add your own controls but do not support modifying the template for the standard controls.</span></span> <span data-ttu-id="9e2a8-372">In einigen Fällen müssen Sie jedoch möglicherweise die Steuerelementbezeichner kennen, die in den Standardvorlagen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-372">However, in some cases, you may need to know the control identifiers used in the default templates.</span></span> <span data-ttu-id="9e2a8-373">Beispielsweise erfordern die [**CDM \_ HIDECONTROL-**](cdm-hidecontrol.md) und [**CDM \_ SETCONTROLTEXT-Meldungen**](cdm-setcontroltext.md) einen Steuerelementbezeichner.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-373">For example, the [**CDM\_HIDECONTROL**](cdm-hidecontrol.md) and [**CDM\_SETCONTROLTEXT**](cdm-setcontroltext.md) messages require a control identifier.</span></span>

<span data-ttu-id="9e2a8-374">Die folgende Tabelle zeigt die Bezeichner der Standardsteuerelemente in den Dialogfeldern Öffnen und **Speichern** unter im Explorer-Stil. </span><span class="sxs-lookup"><span data-stu-id="9e2a8-374">The following table shows the identifiers of the standard controls in the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="9e2a8-375">Die Bezeichner sind Konstanten, die in Dlgs.h und Winuser.h definiert sind.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-375">The identifiers are constants defined in Dlgs.h and Winuser.h.</span></span>



| <span data-ttu-id="9e2a8-376">Steuerelementbezeichner</span><span class="sxs-lookup"><span data-stu-id="9e2a8-376">Control identifier</span></span> | <span data-ttu-id="9e2a8-377">Beschreibung des Steuerelements</span><span class="sxs-lookup"><span data-stu-id="9e2a8-377">Control description</span></span>                                                                                                                                                                                                                                                                        |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9e2a8-378">**chx1**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-378">**chx1**</span></span>           | <span data-ttu-id="9e2a8-379">Das Kontrollkästchen "Schreibgeschützt"</span><span class="sxs-lookup"><span data-stu-id="9e2a8-379">The read-only check box</span></span>                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="9e2a8-380">**cmb1**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-380">**cmb1**</span></span>           | <span data-ttu-id="9e2a8-381">Dropdown-Kombinationsfeld, in dem die Liste der Dateitypfilter angezeigt wird</span><span class="sxs-lookup"><span data-stu-id="9e2a8-381">Drop-down combo box that displays the list of file type filters</span></span>                                                                                                                                                                                                                            |
| <span data-ttu-id="9e2a8-382">**stc2**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-382">**stc2**</span></span>           | <span data-ttu-id="9e2a8-383">Bezeichnung für das **Kombinationsfeld cmb1**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-383">Label for the **cmb1** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="9e2a8-384">**cmb2**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-384">**cmb2**</span></span>           | <span data-ttu-id="9e2a8-385">Dropdown-Kombinationsfeld, das das aktuelle Laufwerk oder den aktuellen Ordner anzeigt und es dem Benutzer ermöglicht, ein Laufwerk oder einen Ordner auszuwählen, das geöffnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-385">Drop-down combo box that displays the current drive or folder, and that allows the user to select a drive or folder to open</span></span>                                                                                                                                                                |
| <span data-ttu-id="9e2a8-386">**stc4**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-386">**stc4**</span></span>           | <span data-ttu-id="9e2a8-387">Bezeichnung für das **Kombinationsfeld cmb2**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-387">Label for the **cmb2** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="9e2a8-388">**cmb13**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-388">**cmb13**</span></span>          | <span data-ttu-id="9e2a8-389">Dropdown-Kombinationsfeld, in dem der Name der aktuellen Datei angezeigt wird, der Benutzer den Namen einer zu öffnenden Datei eingeben und eine Datei auswählen kann, die vor Kurzem geöffnet oder gespeichert wurde.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-389">Drop-down combo box that displays the name of the current file, allows the user to type the name of a file to open, and select a file that has been opened or saved recently.</span></span> <span data-ttu-id="9e2a8-390">Dies gilt für frühere Explorer-kompatible Anwendungen ohne Hook- oder Dialogvorlage.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-390">This is for earlier Explorer-compatible applications without hook or dialog template.</span></span> <span data-ttu-id="9e2a8-391">Vergleichen Sie mit **edt1**.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-391">Compare with **edt1**.</span></span> |
| <span data-ttu-id="9e2a8-392">**edt1**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-392">**edt1**</span></span>           | <span data-ttu-id="9e2a8-393">Bearbeitungssteuerelement, das den Namen der aktuellen Datei anzeigt oder es dem Benutzer ermöglicht, den Namen der zu öffnende Datei einzugeben.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-393">Edit control that displays the name of the current file, or allows the user to type the name of the file to open.</span></span> <span data-ttu-id="9e2a8-394">Vergleichen Sie mit **cmb13**.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-394">Compare with **cmb13**.</span></span>                                                                                                                                                  |
| <span data-ttu-id="9e2a8-395">**stc3**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-395">**stc3**</span></span>           | <span data-ttu-id="9e2a8-396">Bezeichnung für das **Kombinationsfeld cmb13** und das edt1-Bearbeitungssteuerelement</span><span class="sxs-lookup"><span data-stu-id="9e2a8-396">Label for the **cmb13** combo box and the edt1 edit control</span></span>                                                                                                                                                                                                                                |
| <span data-ttu-id="9e2a8-397">**lst1**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-397">**lst1**</span></span>           | <span data-ttu-id="9e2a8-398">Listenfeld, in dem der Inhalt des aktuellen Laufwerks oder Ordners angezeigt wird</span><span class="sxs-lookup"><span data-stu-id="9e2a8-398">List box that displays the contents of the current drive or folder</span></span>                                                                                                                                                                                                                         |
| <span data-ttu-id="9e2a8-399">**stc1**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-399">**stc1**</span></span>           | <span data-ttu-id="9e2a8-400">Bezeichnung für das Listenfeld **lst1**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-400">Label for the **lst1** list box</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="9e2a8-401">**IDOK**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-401">**IDOK**</span></span>           | <span data-ttu-id="9e2a8-402">Die Befehlsschaltfläche **OK** (Schaltfläche "Push")</span><span class="sxs-lookup"><span data-stu-id="9e2a8-402">The **OK** command button (push button)</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="9e2a8-403">**IDCANCEL**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-403">**IDCANCEL**</span></span>       | <span data-ttu-id="9e2a8-404">Schaltfläche **"Befehl abbrechen"** (Schaltfläche "Push")</span><span class="sxs-lookup"><span data-stu-id="9e2a8-404">The **Cancel** command button (push button)</span></span>                                                                                                                                                                                                                                                |
| <span data-ttu-id="9e2a8-405">**pshHelp**</span><span class="sxs-lookup"><span data-stu-id="9e2a8-405">**pshHelp**</span></span>        | <span data-ttu-id="9e2a8-406">Schaltfläche **"Hilfebefehl"** (Schaltfläche "Push")</span><span class="sxs-lookup"><span data-stu-id="9e2a8-406">The **Help** command button (push button)</span></span>                                                                                                                                                                                                                                                  |



 

## <a name="customizing-old-style-dialog-boxes"></a><span data-ttu-id="9e2a8-407">Anpassen Old-Style Dialogfeldern</span><span class="sxs-lookup"><span data-stu-id="9e2a8-407">Customizing Old-Style Dialog Boxes</span></span>

<span data-ttu-id="9e2a8-408">Sie können ein altes  Dialogfeld **"Öffnen"** oder "Speichern unter" anpassen, indem Sie eine [*OFNHookProcOldStyle-Hookprozedur*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) bereitstellen, die Nachrichten oder Benachrichtigungen empfängt, die für die Standarddialogfeldprozedur vorgesehen sind.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-408">You can customize an old-style **Open** or **Save As** dialog box by providing an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure that receives messages or notifications intended for the default dialog box procedure.</span></span> <span data-ttu-id="9e2a8-409">Sie können auch eine benutzerdefinierte Vorlage bereitstellen, die statt der Standardvorlage verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-409">You can also provide a custom template to use in place of the default template.</span></span> <span data-ttu-id="9e2a8-410">Die hook-Prozeduren und -Vorlagen, die mit den Dialogfeldern im alten Stil verwendet werden, ähneln denen, die mit den anderen allgemeinen Dialogfeldern verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-410">The hook procedures and templates used with the old-style dialog boxes are similar to those used with the other common dialog boxes.</span></span> <span data-ttu-id="9e2a8-411">Weitere Informationen finden Sie unter [Hook procedures for Common Dialog Boxes (Hookverfahren für allgemeine Dialogfelder)](customizing-common-dialog-boxes.md) und Custom Templates [(Benutzerdefinierte Vorlagen).](customizing-common-dialog-boxes.md)</span><span class="sxs-lookup"><span data-stu-id="9e2a8-411">For more information, see [Hook Procedures for Common Dialog Boxes](customizing-common-dialog-boxes.md) and [Custom Templates](customizing-common-dialog-boxes.md).</span></span>

<span data-ttu-id="9e2a8-412">Verwenden Sie beim Erstellen des  Dialogfelds  die [**OPENFILENAME-Struktur,**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) um eine Hookprozedur für ein Altes Dialogfeld "Öffnen" oder "Speichern unter" zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-412">To enable a hook procedure for an old-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="9e2a8-413">Legen Sie **das OFN \_ ENABLEHOOK-Flag** im **Flags-Member** fest, und geben Sie die Adresse einer [*OFNHookProcOldStyle-Hookprozedur*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) im **lpfnHook-Member** an.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-413">Set the **OFN\_ENABLEHOOK** flag in the **Flags** member and specify the address of an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="9e2a8-414">Die Dialogfeldprozedur sendet eine [**WM \_ INITDIALOG-Nachricht**](wm-initdialog.md) an die Hookprozedur, bei der der *Parameter Param* auf die Adresse der **OPENFILENAME-Struktur** festgelegt ist, die zum Initialisieren des Dialogfelds verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-414">The dialog box procedure sends a [**WM\_INITDIALOG**](wm-initdialog.md) message to the hook procedure with the *Param* parameter set to the address of the **OPENFILENAME** structure used to initialize the dialog box.</span></span>

<span data-ttu-id="9e2a8-415">Sie können die [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) verwenden,  um  eine benutzerdefinierte Vorlage anzugeben, die im Dialogfeld Öffnen oder Speichern unter statt der Standardvorlage verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-415">You can use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a custom template for the **Open** or **Save As** dialog box to use in place of the default template.</span></span> <span data-ttu-id="9e2a8-416">Wenn Ihre benutzerdefinierte Vorlage eine Ressource in einer Anwendung oder Dynamic Link Library ist, legen Sie das **OFN \_ ENABLETEMPLATE-Flag** im **Flags-Element** fest, und verwenden Sie die **Elemente hInstance** und **lpTemplateName** der Struktur, um das Modul und den Ressourcennamen zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-416">If your custom template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="9e2a8-417">Wenn sich Ihre benutzerdefinierte Vorlage bereits im Arbeitsspeicher befindet, legen Sie das **OFN \_ ENABLETEMPLATEHANDLE-Flag** fest, und verwenden Sie das **hInstance-Element,** um das Speicherobjekt zu identifizieren, das die Vorlage enthält.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-417">If your custom template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="9e2a8-418">Erstellen Sie die benutzerdefinierte Vorlage, indem Sie die in der Datei Fileopen.dlg angegebene Standardvorlage ändern.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-418">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span> <span data-ttu-id="9e2a8-419">Die Steuerelementbezeichner, die in den Standardmäßigen Dialogfeldvorlagen suchen und ersetzen verwendet werden, werden in der Datei Dlgs.h definiert.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-419">The control identifiers used in the default Find and Replace dialog templates are defined in the Dlgs.h file.</span></span>

<span data-ttu-id="9e2a8-420">Standardmäßig zeigen die Funktionen [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) und [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) die Dialogfelder im Explorer-Stil an.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-420">By default, the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) and [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions display the Explorer-style dialog boxes.</span></span> <span data-ttu-id="9e2a8-421">Wenn Sie ein Dialogfeld im alten Stil anzeigen möchten, müssen Sie eine [**OFNHookProcOldStyle-Hookprozedur**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) bereitstellen und sicherstellen, dass das **\_ OFN-EXPLORER-Flag** nicht im **Flags-Member** der [**OPENFILENAME-Struktur**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-421">If you want to display an old-style dialog box, you must provide an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and ensure that the **OFN\_EXPLORER** flag is not set in the **Flags** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="9e2a8-422">Wenn Sie das **\_ OFN-EXPLORER-Flag** festlegen, behandelt das System eine Hookprozedur oder eine benutzerdefinierte Vorlage als Anpassung im Explorer-Stil.</span><span class="sxs-lookup"><span data-stu-id="9e2a8-422">If you set the **OFN\_EXPLORER** flag, the system treats a hook procedure or custom template as an Explorer-style customization.</span></span> <span data-ttu-id="9e2a8-423">Informationen zum Anpassen eines Dialogfelds im Explorer-Stil finden Sie unter Benutzerdefinierte Vorlagen im [Explorer-Stil.](#explorer-style-custom-templates)</span><span class="sxs-lookup"><span data-stu-id="9e2a8-423">For information about customizing an Explorer-style dialog box, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

## <a name="see-also"></a><span data-ttu-id="9e2a8-424">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="9e2a8-424">See also</span></span>

* [<span data-ttu-id="9e2a8-425">Beispiel für Datei wird verwendet</span><span class="sxs-lookup"><span data-stu-id="9e2a8-425">File is in use sample</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse)