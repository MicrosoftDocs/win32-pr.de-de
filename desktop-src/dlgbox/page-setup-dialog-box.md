---
title: Seite einrichten (Dialogfeld)
description: Zeigt ein modales Dialogfeld an, in dem der Benutzereinstellungen auswählen kann, die den Papiertyp, die Papier Quelle, die Seitenausrichtung und die Breite der Seitenränder einschließen.
ms.assetid: debde0a0-07d4-46ed-a936-e517eab1852d
keywords:
- Windows-Benutzeroberfläche, Benutzereingabe
- Windows-Benutzeroberfläche, allgemeine Dialog Feld Bibliothek
- Benutzereingabe, allgemeine Dialog Feld Bibliothek
- Erfassen von Benutzereingaben, allgemeine Dialog Feld Bibliothek
- Allgemeine Dialog Feld Bibliothek
- Allgemeine Dialogfelder
- Seite einrichten (Dialogfeld)
- Dialogfeld "Seite einrichten" anpassen
- Hooks, Dialogfeld "Seite einrichten"
- vordefinierte Dialogfelder
- Dialogfelder, Seite einrichten
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4b9a8f7f30a8313017dc3a124cdccb7d00c872b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104102299"
---
# <a name="page-setup-dialog-box"></a><span data-ttu-id="5878c-114">Seite einrichten (Dialogfeld)</span><span class="sxs-lookup"><span data-stu-id="5878c-114">Page Setup Dialog Box</span></span>

<span data-ttu-id="5878c-115">Zeigt ein modales Dialogfeld an, in dem der Benutzer die folgenden Attribute der gedruckten Seite festlegen kann:</span><span class="sxs-lookup"><span data-stu-id="5878c-115">Displays a modal dialog box that allows the user to set the following attributes of the printed page:</span></span>

-   <span data-ttu-id="5878c-116">Der Papiertyp (Umschlag, rechts, Buchstabe usw.)</span><span class="sxs-lookup"><span data-stu-id="5878c-116">The paper type (envelope, legal, letter, and so on)</span></span>
-   <span data-ttu-id="5878c-117">Die Papier Quelle (manueller Feed, Traktoren Feed, Blatt Anleger usw.)</span><span class="sxs-lookup"><span data-stu-id="5878c-117">The paper source (manual feed, tractor feed, sheet feeder, and so on)</span></span>
-   <span data-ttu-id="5878c-118">Die Seitenausrichtung (Hochformat oder Querformat)</span><span class="sxs-lookup"><span data-stu-id="5878c-118">The page orientation (portrait or landscape)</span></span>
-   <span data-ttu-id="5878c-119">Die Breite der Seitenränder.</span><span class="sxs-lookup"><span data-stu-id="5878c-119">The width of the page margins</span></span>

<span data-ttu-id="5878c-120">Sie erstellen und zeigen ein Dialogfeld für die **Seiten Einrichtung** an, indem Sie eine [**pagesetupdlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) -Struktur initialisieren und die Struktur an die [**pagesetupdlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) -Funktion übergeben.</span><span class="sxs-lookup"><span data-stu-id="5878c-120">You create and display a **Page Setup** dialog box by initializing a [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure and passing the structure to the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function.</span></span> <span data-ttu-id="5878c-121">Die im Dialogfeld dargestellten Attribute variieren jedoch je nach den Funktionen des Druckers.</span><span class="sxs-lookup"><span data-stu-id="5878c-121">However, the attributes presented in the dialog box vary, depending on the capabilities of the printer.</span></span> <span data-ttu-id="5878c-122">Die folgende Abbildung zeigt ein typisches Dialogfeld für die **Seiten Einrichtung** .</span><span class="sxs-lookup"><span data-stu-id="5878c-122">The following illustration shows a typical **Page Setup** dialog box.</span></span>

![Dialogfeld "Seite einrichten"](images/pagesetupdialogboxxp.png)

<span data-ttu-id="5878c-124">Wenn der Benutzer auf die Schaltfläche **OK** klickt, gibt [**pagesetupdlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) **true** zurück, nachdem verschiedene Member in der [**pagesetupdlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) -Struktur festgelegt wurden, um die Auswahl des Benutzers anzugeben.</span><span class="sxs-lookup"><span data-stu-id="5878c-124">If the user clicks the **OK** button, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **TRUE** after setting various members in the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to specify the user's selections.</span></span> <span data-ttu-id="5878c-125">Die **ptpapersize** -und **rtmargin** -Elemente enthalten die Werte, die vom Benutzer angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="5878c-125">The **ptPaperSize** and **rtMargin** members contain the values specified by the user.</span></span> <span data-ttu-id="5878c-126">Die Member **hDevMode** und **hDevNames** enthalten globale Speicher Handles für die [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) -und [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) -Strukturen.</span><span class="sxs-lookup"><span data-stu-id="5878c-126">The **hDevMode** and **hDevNames** members contain global memory handles for the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="5878c-127">Diese Strukturen enthalten zusätzliche Seiten Informationen sowie Informationen über den Drucker.</span><span class="sxs-lookup"><span data-stu-id="5878c-127">These structures contain additional page information as well as information about the printer.</span></span> <span data-ttu-id="5878c-128">Mit diesen Informationen können Sie die Ausgabe vorbereiten, die an den ausgewählten Drucker gesendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="5878c-128">You can use this information to prepare the output to be sent to the selected printer.</span></span>

<span data-ttu-id="5878c-129">Wenn der Benutzer das Dialogfeld **Seite einrichten** abbricht oder ein Fehler auftritt, gibt [**pagesetupdlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) den Wert **false** zurück.</span><span class="sxs-lookup"><span data-stu-id="5878c-129">If the user cancels the **Page Setup** dialog box or an error occurs, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="5878c-130">Um die Ursache des Fehlers zu ermitteln, rufen Sie die [**kommdlgextendecoderror**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) -Funktion auf, um den erweiterten Fehlerwert abzurufen.</span><span class="sxs-lookup"><span data-stu-id="5878c-130">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="5878c-131">In diesem Abschnitt werden die folgenden Themen behandelt.</span><span class="sxs-lookup"><span data-stu-id="5878c-131">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="5878c-132">Das Dialog Feld "Seite einrichten" wird initialisiert.</span><span class="sxs-lookup"><span data-stu-id="5878c-132">Initializing the Page Setup Dialog Box</span></span>](#initializing-the-page-setup-dialog-box)
-   [<span data-ttu-id="5878c-133">Anpassen des Dialog Felds "Seite einrichten"</span><span class="sxs-lookup"><span data-stu-id="5878c-133">Customizing the Page Setup Dialog Box</span></span>](#customizing-the-page-setup-dialog-box)
-   [<span data-ttu-id="5878c-134">Anpassen der Beispielseite</span><span class="sxs-lookup"><span data-stu-id="5878c-134">Customizing the Sample Page</span></span>](#customizing-the-sample-page)

## <a name="initializing-the-page-setup-dialog-box"></a><span data-ttu-id="5878c-135">Das Dialog Feld "Seite einrichten" wird initialisiert.</span><span class="sxs-lookup"><span data-stu-id="5878c-135">Initializing the Page Setup Dialog Box</span></span>

<span data-ttu-id="5878c-136">Standardmäßig werden im Dialogfeld **Seite einrichten** Informationen zum aktuellen Standarddrucker angezeigt.</span><span class="sxs-lookup"><span data-stu-id="5878c-136">By default, the **Page Setup** dialog box displays information about the current default printer.</span></span> <span data-ttu-id="5878c-137">Um das Dialogfeld anzuweisen, Informationen zu einem bestimmten Drucker anzuzeigen, legen Sie die Elemente einer [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) -oder [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) -Struktur fest, und weisen Sie die globalen Speicher Handles dieser Strukturen dem entsprechenden Member in [**pagesetupdlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga)zu.</span><span class="sxs-lookup"><span data-stu-id="5878c-137">To direct the dialog box to display information about a specific printer, set the members of a [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) or [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handles of these structures to the corresponding member in [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span></span> <span data-ttu-id="5878c-138">Wenn Sie den Namen eines Druckers angeben, der zurzeit nicht installiert ist, wird im Dialogfeld eine Fehlermeldung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="5878c-138">If you specify the name of a printer that is not currently installed, the dialog box displays an error message.</span></span> <span data-ttu-id="5878c-139">Verwenden Sie den Wert " **PSD \_ NoWarning** ", um zu verhindern, dass das Dialogfeld Fehlermeldungen anzeigt.</span><span class="sxs-lookup"><span data-stu-id="5878c-139">To prevent the dialog box from displaying error messages, use the **PSD\_NOWARNING** value.</span></span> <span data-ttu-id="5878c-140">Wenn Sie Informationen zum Standarddrucker abrufen möchten, ohne das Dialogfeld **Seite einrichten** anzuzeigen, verwenden Sie den Wert von " **PSD \_ returndefault** ".</span><span class="sxs-lookup"><span data-stu-id="5878c-140">To retrieve information about the default printer without displaying the **Page Setup** dialog box, use the **PSD\_RETURNDEFAULT** value.</span></span>

<span data-ttu-id="5878c-141">Wenn das Standard Messsystem Zoll ist, verwendet das Dialogfeld Tausendstel Zoll als Standard Maßeinheit.</span><span class="sxs-lookup"><span data-stu-id="5878c-141">If the default measurement system is inches, the dialog box uses thousandths of inches as the default unit of measurement.</span></span> <span data-ttu-id="5878c-142">Wenn das Standard Messungs System eine Metrik ist, werden im Dialogfeld Hundertstel Millimeter als Standard Maßeinheit verwendet.</span><span class="sxs-lookup"><span data-stu-id="5878c-142">If the default measurement system is metric, the dialog box uses hundredths of millimeters as the default unit of measurement.</span></span> <span data-ttu-id="5878c-143">Wenn Sie die Standard Maßeinheit überschreiben möchten, legen Sie das-Flag " **PSD \_ inhundertstel thsofmillimeter** " oder " **PSD \_ intausendandthsofinches** " im **Flags** -Member der [**pagesetupdlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) -Struktur fest.</span><span class="sxs-lookup"><span data-stu-id="5878c-143">To override the default unit of measurement, set the **PSD\_INHUNDREDTHSOFMILLIMETERS** or **PSD\_INTHOUSANDTHSOFINCHES** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>

<span data-ttu-id="5878c-144">Die Anfangswerte für die Ränder sind standardmäßig 1 Zoll.</span><span class="sxs-lookup"><span data-stu-id="5878c-144">The initial values for the margins are one inch, by default.</span></span> <span data-ttu-id="5878c-145">Wenn Sie das Flag für die **PSD- \_ Ränder** festlegen, werden im Dialogfeld die anfänglichen Rand Werte angezeigt, die im **rtmargin** -Element angegeben sind.</span><span class="sxs-lookup"><span data-stu-id="5878c-145">If you set the **PSD\_MARGINS** flag, the dialog box displays the initial margin values specified in the **rtMargin** member.</span></span> <span data-ttu-id="5878c-146">Die Standard minimalen Werte, die der Benutzer für die Ränder angeben kann, sind die vom Drucker zulässigen minimalen Ränder.</span><span class="sxs-lookup"><span data-stu-id="5878c-146">The default minimum values that the user can specify for the margins are the minimum margins allowed by the printer.</span></span> <span data-ttu-id="5878c-147">Wenn Sie das **PSD \_ minmargin** -Flag festlegen, werden im Dialogfeld die im **rtminmargin** -Member angegebenen minimalen Ränder erzwungen.</span><span class="sxs-lookup"><span data-stu-id="5878c-147">If you set the **PSD\_MINMARGINS** flag, the dialog box enforces the minimum margins specified in the **rtMinMargin** member.</span></span>

<span data-ttu-id="5878c-148">Um zu verhindern, dass Benutzer bestimmte Optionen auswählen, legen Sie eine beliebige Kombination der folgenden Flags fest, um die entsprechenden Steuerelemente zu deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="5878c-148">To prevent users from selecting certain options, set any combination of the following flags to disable the corresponding controls.</span></span>



| <span data-ttu-id="5878c-149">Flag</span><span class="sxs-lookup"><span data-stu-id="5878c-149">Flag</span></span>                        | <span data-ttu-id="5878c-150">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="5878c-150">Meaning</span></span>                                                                  |
|-----------------------------|--------------------------------------------------------------------------|
| <span data-ttu-id="5878c-151">**PSD- \_ Deaktivierungs Ränder**</span><span class="sxs-lookup"><span data-stu-id="5878c-151">**PSD\_DISABLEMARGINS**</span></span>     | <span data-ttu-id="5878c-152">Deaktiviert die Bearbeitungs Steuerelemente, in denen der Benutzer die Rand Einstellungen eingibt.</span><span class="sxs-lookup"><span data-stu-id="5878c-152">Disables the edit controls in which the user enters the margin settings.</span></span> |
| <span data-ttu-id="5878c-153">**PSD- \_ disableorientation**</span><span class="sxs-lookup"><span data-stu-id="5878c-153">**PSD\_DISABLEORIENTATION**</span></span> | <span data-ttu-id="5878c-154">Deaktiviert **die Options** Felder "Hochformat" und " **quer** Format".</span><span class="sxs-lookup"><span data-stu-id="5878c-154">Disables the **Portrait** and **Landscape** radio buttons.</span></span>               |
| <span data-ttu-id="5878c-155">**PSD- \_ disablepaper**</span><span class="sxs-lookup"><span data-stu-id="5878c-155">**PSD\_DISABLEPAPER**</span></span>       | <span data-ttu-id="5878c-156">Deaktiviert die Steuerelemente zum Auswählen des Papier Umfangs und der Papier Quelle.</span><span class="sxs-lookup"><span data-stu-id="5878c-156">Disables the controls for selecting the paper size and paper source.</span></span>     |
| <span data-ttu-id="5878c-157">**PSD \_ disableprinter**</span><span class="sxs-lookup"><span data-stu-id="5878c-157">**PSD\_DISABLEPRINTER**</span></span>     | <span data-ttu-id="5878c-158">Deaktiviert die Schaltfläche **Drucker** .</span><span class="sxs-lookup"><span data-stu-id="5878c-158">Disables the **Printer** button.</span></span>                                         |



 

## <a name="customizing-the-page-setup-dialog-box"></a><span data-ttu-id="5878c-159">Anpassen des Dialog Felds "Seite einrichten"</span><span class="sxs-lookup"><span data-stu-id="5878c-159">Customizing the Page Setup Dialog Box</span></span>

<span data-ttu-id="5878c-160">Sie können für das Dialogfeld **Seite einrichten** eine benutzerdefinierte Vorlage bereitstellen, z. b. Wenn Sie zusätzliche Steuerelemente einschließen möchten, die für Ihre Anwendung eindeutig sind.</span><span class="sxs-lookup"><span data-stu-id="5878c-160">You can provide a custom template for the **Page Setup** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="5878c-161">Die [**pagesetupdlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) -Funktion verwendet anstelle der Standardvorlage Ihre benutzerdefinierte Vorlage.</span><span class="sxs-lookup"><span data-stu-id="5878c-161">The [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="5878c-162">**So stellen Sie eine benutzerdefinierte Vorlage für das Dialogfeld "Seite einrichten" bereit**</span><span class="sxs-lookup"><span data-stu-id="5878c-162">**To provide a custom template for the Page Setup dialog box**</span></span>

1.  <span data-ttu-id="5878c-163">Erstellen Sie die benutzerdefinierte Vorlage, indem Sie die in der Datei prnsetup. DLG angegebene Standardvorlage ändern.</span><span class="sxs-lookup"><span data-stu-id="5878c-163">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="5878c-164">Die Steuerelement-IDs, die in der standardmäßigen **Seite Setup** -Dialogfeld Vorlage verwendet werden, werden in der Datei Dlgs. h definiert.</span><span class="sxs-lookup"><span data-stu-id="5878c-164">The control identifiers used in the default **Page Setup** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="5878c-165">Verwenden Sie die [**pagesetupdlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) -Struktur, um die Vorlage wie folgt zu aktivieren:</span><span class="sxs-lookup"><span data-stu-id="5878c-165">Use the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to enable the template as follows:</span></span>
    -   -   <span data-ttu-id="5878c-166">Wenn Ihre benutzerdefinierte Vorlage eine Ressource in einer Anwendung oder einer Dynamic Link Library ist, legen Sie das " **PSD \_ enablepagesetuptemplate** "-Flag im **Flags** -Member fest.</span><span class="sxs-lookup"><span data-stu-id="5878c-166">If your custom template is a resource in an application or dynamic-link library, set the **PSD\_ENABLEPAGESETUPTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="5878c-167">Verwenden Sie die **HINSTANCE** -und **lppagesetuptemplatename** -Member der-Struktur, um das Modul und den Ressourcennamen zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="5878c-167">Use the **hInstance** and **lpPageSetupTemplateName** members of the structure to identify the module and resource name.</span></span>

            <span data-ttu-id="5878c-168">-Oder-</span><span class="sxs-lookup"><span data-stu-id="5878c-168">-Or-</span></span>

        -   <span data-ttu-id="5878c-169">Wenn die benutzerdefinierte Vorlage bereits im Arbeitsspeicher vorhanden ist, legen Sie das Flag " **\_ enablepagesetuptemplatehandle** " für PSD fest.</span><span class="sxs-lookup"><span data-stu-id="5878c-169">If your custom template is already in memory, set the **PSD\_ENABLEPAGESETUPTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="5878c-170">Verwenden Sie den Member **hpagesetuptemplate** , um das Speicher Objekt zu identifizieren, das die Vorlage enthält.</span><span class="sxs-lookup"><span data-stu-id="5878c-170">Use the **hPageSetupTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="5878c-171">Zum Filtern von Nachrichten, die an die Dialogfeld Prozedur gesendet werden, können Sie eine [**pgesetuphook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) -Hook-Prozedur bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="5878c-171">To filter messages sent to the dialog box procedure, you can provide a [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="5878c-172">Wenn Sie eine benutzerdefinierte Vorlage verwenden, um zusätzliche Steuerelemente zu definieren, müssen Sie eine **pgesetuphook** -Hook-Prozedur bereitstellen, um Eingaben für die Steuerelemente zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="5878c-172">If you use a custom template to define additional controls, you must provide a **PageSetupHook** hook procedure to process input for your controls.</span></span> <span data-ttu-id="5878c-173">Außerdem können Sie eine [**pagepainthook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) -Hook-Prozedur bereitstellen, um die Inhalte der Beispielseite anzupassen, die im Dialogfeld **Seite einrichten** angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="5878c-173">In addition, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the contents of the sample page displayed by the **Page Setup** dialog box.</span></span> <span data-ttu-id="5878c-174">Weitere Informationen zur **pagepainthook** -Hook-Prozedur finden Sie unter [Anpassen der Beispielseite](#customizing-the-sample-page).</span><span class="sxs-lookup"><span data-stu-id="5878c-174">For more information about the **PagePaintHook** hook procedure, see [Customizing the Sample Page](#customizing-the-sample-page).</span></span>

<span data-ttu-id="5878c-175">**So aktivieren Sie eine pgesetuphook-Hook-Prozedur**</span><span class="sxs-lookup"><span data-stu-id="5878c-175">**To enable a PageSetupHook hook procedure**</span></span>

1.  <span data-ttu-id="5878c-176">Legen Sie das " **PSD \_ enablepagesetuphook** "-Flag im **Flags** -Member der [**pagesetupdlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) -Struktur fest.</span><span class="sxs-lookup"><span data-stu-id="5878c-176">Set the **PSD\_ENABLEPAGESETUPHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="5878c-177">Geben Sie die Adresse der Hook-Prozedur im **lpfnbingesetuphook** -Member an.</span><span class="sxs-lookup"><span data-stu-id="5878c-177">Specify the address of the hook procedure in the **lpfnPageSetupHook** member.</span></span>

<span data-ttu-id="5878c-178">Nach der Verarbeitung der " [**WM \_ InitDialog**](wm-initdialog.md) "-Meldung sendet die Dialogfeld Prozedur eine " **WM \_ InitDialog** "-Meldung an die " [**pgesetuphook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) "-Hook-Prozedur.</span><span class="sxs-lookup"><span data-stu-id="5878c-178">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="5878c-179">Der *LPARAM* -Parameter dieser Nachricht ist ein Zeiger auf die [**pagesetupdlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) -Struktur, die verwendet wird, um das Dialogfeld zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="5878c-179">The *lParam* parameter of this message is a pointer to the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure used to initialize the dialog box.</span></span>

## <a name="customizing-the-sample-page"></a><span data-ttu-id="5878c-180">Anpassen der Beispielseite</span><span class="sxs-lookup"><span data-stu-id="5878c-180">Customizing the Sample Page</span></span>

<span data-ttu-id="5878c-181">Das Dialogfeld **Seite einrichten** enthält ein Bild einer Beispielseite, das zeigt, wie sich die Auswahl des Benutzers auf die Darstellung der gedruckten Ausgabe auswirkt.</span><span class="sxs-lookup"><span data-stu-id="5878c-181">The **Page Setup** dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output.</span></span> <span data-ttu-id="5878c-182">Das Bild besteht aus einem Rechteck, das das ausgewählte Papier oder den Umschlag Typ darstellt, mit einem gepunkteten Linien Rechteck, das die aktuellen Ränder darstellt, und partiellen (griechischen Text) Zeichen, um anzuzeigen, wie Text auf der gedruckten Seite aussieht.</span><span class="sxs-lookup"><span data-stu-id="5878c-182">The image consists of a rectangle that represents the selected paper or envelope type, with a dotted-line rectangle representing the current margins, and partial (Greek text) characters to show how text looks on the printed page.</span></span>

<span data-ttu-id="5878c-183">Wenn Sie die [**pagesetupdlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) -Funktion aufrufen, können Sie eine [**pagepainthook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) -Hook-Prozedur bereitstellen, um die Darstellung der Beispielseite anzupassen.</span><span class="sxs-lookup"><span data-stu-id="5878c-183">When you call the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the appearance of the sample page.</span></span>

<span data-ttu-id="5878c-184">**So aktivieren Sie eine pagepainthook-Hook-Prozedur**</span><span class="sxs-lookup"><span data-stu-id="5878c-184">**To enable a PagePaintHook hook procedure**</span></span>

1.  <span data-ttu-id="5878c-185">Legen Sie das " **PSD \_ enablepagepainthook** "-Flag im **Flags** -Member der [**pagesetupdlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) -Struktur fest.</span><span class="sxs-lookup"><span data-stu-id="5878c-185">Set the **PSD\_ENABLEPAGEPAINTHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="5878c-186">Geben Sie die Adresse der Hook-Prozedur im **lpfnpagepainthook** -Member an.</span><span class="sxs-lookup"><span data-stu-id="5878c-186">Specify the address of the hook procedure in the **lpfnPagePaintHook** member.</span></span>

<span data-ttu-id="5878c-187">Wenn im Dialogfeld der Inhalt der Beispielseite gezeichnet wird, empfängt die Hook-Prozedur die folgenden Meldungen in der Reihenfolge, in der Sie aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="5878c-187">Whenever the dialog box is about to draw the contents of the sample page, the hook procedure receives the following messages in the order in which they are listed.</span></span>



| <span data-ttu-id="5878c-188">Nachricht</span><span class="sxs-lookup"><span data-stu-id="5878c-188">Message</span></span>                                                  | <span data-ttu-id="5878c-189">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="5878c-189">Meaning</span></span>                                                                                                                                          |
|----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5878c-190">**WM- \_ PSD \_ pagesetupdlg**</span><span class="sxs-lookup"><span data-stu-id="5878c-190">**WM\_PSD\_PAGESETUPDLG**</span></span>](wm-psd-pagesetupdlg.md)     | <span data-ttu-id="5878c-191">Im Dialogfeld wird die Beispielseite gezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5878c-191">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="5878c-192">Die Hook-Prozedur kann diese Nachricht verwenden, um das Zeichnen des Inhalts der Beispielseite vorzubereiten.</span><span class="sxs-lookup"><span data-stu-id="5878c-192">The hook procedure can use this message to prepare to draw the contents of the sample page.</span></span>     |
| [<span data-ttu-id="5878c-193">**WM- \_ PSD \_ fullpagerup**</span><span class="sxs-lookup"><span data-stu-id="5878c-193">**WM\_PSD\_FULLPAGERECT**</span></span>](wm-psd-fullpagerect.md)     | <span data-ttu-id="5878c-194">Im Dialogfeld wird die Beispielseite gezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5878c-194">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="5878c-195">Diese Meldung gibt das umgebende Rechteck der Beispielseite an.</span><span class="sxs-lookup"><span data-stu-id="5878c-195">This message specifies the bounding rectangle of the sample page.</span></span>                               |
| [<span data-ttu-id="5878c-196">**WM- \_ PSD \_ minmarginrect**</span><span class="sxs-lookup"><span data-stu-id="5878c-196">**WM\_PSD\_MINMARGINRECT**</span></span>](wm-psd-minmarginrect.md)   | <span data-ttu-id="5878c-197">Im Dialogfeld wird die Beispielseite gezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5878c-197">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="5878c-198">Diese Meldung gibt das Rand Rechteck an.</span><span class="sxs-lookup"><span data-stu-id="5878c-198">This message specifies the margin rectangle.</span></span>                                                    |
| [<span data-ttu-id="5878c-199">**WM \_ PSD \_ marginrect**</span><span class="sxs-lookup"><span data-stu-id="5878c-199">**WM\_PSD\_MARGINRECT**</span></span>](wm-psd-marginrect.md)         | <span data-ttu-id="5878c-200">Im Dialogfeld wird das Rand Rechteck gezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5878c-200">The dialog box is about to draw the margin rectangle.</span></span>                                                                                            |
| [<span data-ttu-id="5878c-201">**WM- \_ PSD \_ greektextrect**</span><span class="sxs-lookup"><span data-stu-id="5878c-201">**WM\_PSD\_GREEKTEXTRECT**</span></span>](wm-psd-greektextrect.md)   | <span data-ttu-id="5878c-202">Im Dialogfeld wird der griechische Text innerhalb des Rand Rechtecks gezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5878c-202">The dialog box is about to draw the Greek text inside the margin rectangle.</span></span>                                                                      |
| [<span data-ttu-id="5878c-203">**WM- \_ PSD- \_ präct**</span><span class="sxs-lookup"><span data-stu-id="5878c-203">**WM\_PSD\_ENVSTAMPRECT**</span></span>](wm-psd-envstamprect.md)     | <span data-ttu-id="5878c-204">Das Dialogfeld wird gerade im Umschlag Stempel Rechteck einer Umschlag Beispielseite gezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5878c-204">The dialog box is about to draw in the envelope-stamp rectangle of an envelope sample page.</span></span> <span data-ttu-id="5878c-205">Diese Meldung wird nur für Umschläge gesendet.</span><span class="sxs-lookup"><span data-stu-id="5878c-205">This message is sent for envelopes only.</span></span>             |
| [<span data-ttu-id="5878c-206">**WM- \_ PSD \_ yafullpagtory**</span><span class="sxs-lookup"><span data-stu-id="5878c-206">**WM\_PSD\_YAFULLPAGERECT**</span></span>](wm-psd-yafullpagerect.md) | <span data-ttu-id="5878c-207">Im Dialogfeld wird der Rückgabe Adress Teil einer Umschlag Beispielseite gezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5878c-207">The dialog box is about to draw the return address portion of an envelope sample page.</span></span> <span data-ttu-id="5878c-208">Diese Meldung wird für Umschläge und andere Papiergrößen gesendet.</span><span class="sxs-lookup"><span data-stu-id="5878c-208">This message is sent for envelopes and other paper sizes.</span></span> |



 

<span data-ttu-id="5878c-209">Wenn die Hook-Prozedur für eine der ersten drei Nachrichten einer Zeichnungs Sequenz " **true** " zurückgibt ("[**WM \_ PSD \_ papdlg**](wm-psd-pagesetupdlg.md)", " [**WM \_ PSD \_ fullpagance"**](wm-psd-fullpagerect.md)oder " [**WM \_ PSD \_ minmarginrect**](wm-psd-minmarginrect.md)"), werden im Dialogfeld keine weiteren Nachrichten mehr angezeigt, und es wird erst dann auf der Beispielseite gezeichnet, wenn das System die Beispielseite neu zeichnen muss.</span><span class="sxs-lookup"><span data-stu-id="5878c-209">If the hook procedure returns **TRUE** for any of the first three messages of a drawing sequence ([**WM\_PSD\_PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM\_PSD\_FULLPAGERECT**](wm-psd-fullpagerect.md), or [**WM\_PSD\_MINMARGINRECT**](wm-psd-minmarginrect.md)) the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page.</span></span> <span data-ttu-id="5878c-210">Wenn die Hook-Prozedur für alle drei Nachrichten **false** zurückgibt, sendet das Dialogfeld die übrigen Nachrichten der Zeichnungs Sequenz.</span><span class="sxs-lookup"><span data-stu-id="5878c-210">If the hook procedure returns **FALSE** for all three messages, the dialog box sends the remaining messages of the drawing sequence.</span></span>

<span data-ttu-id="5878c-211">Wenn die Hook-Prozedur für eine der verbleibenden Nachrichten in einer Zeichnungs Sequenz **true** zurückgibt, wird das Dialogfeld nicht den entsprechenden Teil der Beispielseite zeichnen.</span><span class="sxs-lookup"><span data-stu-id="5878c-211">If the hook procedure returns **TRUE** for any of the remaining messages in a drawing sequence, the dialog box does not draw the corresponding portion of the sample page.</span></span> <span data-ttu-id="5878c-212">Wenn die Hook-Prozedur für eine dieser Nachrichten **false** zurückgibt, wird dieser Teil der Beispielseite im Dialogfeld gezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5878c-212">If the hook procedure returns **FALSE** for any of these messages, the dialog box draws that portion of the sample page.</span></span>

<span data-ttu-id="5878c-213">Um zu verhindern, dass im Dialogfeld der Inhalt der Beispielseite gezeichnet wird, können Sie das " **PSD \_ disablepagedrawing** "-Flag festlegen.</span><span class="sxs-lookup"><span data-stu-id="5878c-213">To prevent the dialog box from drawing the contents of the sample page, you can set the **PSD\_DISABLEPAGEPAINTING** flag.</span></span> <span data-ttu-id="5878c-214">Dieses Flag wirkt sich nicht auf Ihre [**pagepainthook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) -Hook-Prozedur aus, die immer noch alle **WM- \_ PSD \_ \*** -Nachrichten empfängt und den Inhalt der Beispielseite zeichnen kann.</span><span class="sxs-lookup"><span data-stu-id="5878c-214">This flag does not affect your [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure, which still receives all the **WM\_PSD\_\*** messages and can draw the sample page contents.</span></span>

 

 