---
title: Zwischenablage Vorgänge
description: Ein Fenster sollte die Zwischenablage beim Ausschnitten, kopieren oder Einfügen von Daten verwenden. Ein Fenster platziert Daten für Ausschneide-und Kopiervorgänge in der Zwischenablage und ruft Daten für Einfügevorgänge aus der Zwischenablage ab.
ms.assetid: 27f9142c-3154-4de5-aea6-3c53f7e940ec
keywords:
- Windows-Benutzeroberfläche, Zwischenablage
- Zwischenablage, Fenster
- Zwischenablage, Daten werden abgeschnitten
- Zwischenablage, Kopieren von Daten
- Zwischenablage, Einfügen von Daten
- Zwischenablage, Besitzer Fenster
- Zwischenablage, verzögertes Rendering
- Zwischenablage, Arbeitsspeicher
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5cb2c3451cf562b35b976e137a974e19892acbb3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104316214"
---
# <a name="clipboard-operations"></a><span data-ttu-id="50b35-112">Zwischenablage Vorgänge</span><span class="sxs-lookup"><span data-stu-id="50b35-112">Clipboard Operations</span></span>

<span data-ttu-id="50b35-113">Ein Fenster sollte die Zwischenablage beim Ausschnitten, kopieren oder Einfügen von Daten verwenden.</span><span class="sxs-lookup"><span data-stu-id="50b35-113">A window should use the clipboard when cutting, copying, or pasting data.</span></span> <span data-ttu-id="50b35-114">Ein Fenster platziert Daten für Ausschneide-und Kopiervorgänge in der Zwischenablage und ruft Daten für Einfügevorgänge aus der Zwischenablage ab.</span><span class="sxs-lookup"><span data-stu-id="50b35-114">A window places data on the clipboard for cut and copy operations and retrieves data from the clipboard for paste operations.</span></span> <span data-ttu-id="50b35-115">In den folgenden Abschnitten werden diese Vorgänge und zugehörigen Probleme beschrieben.</span><span class="sxs-lookup"><span data-stu-id="50b35-115">The following sections describe these operations and related issues.</span></span>

<span data-ttu-id="50b35-116">Zum Platzieren von Daten oder zum Abrufen von Daten aus der Zwischenablage muss ein Fenster die Zwischenablage zunächst mithilfe der [**OpenClipboard**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) -Funktion öffnen.</span><span class="sxs-lookup"><span data-stu-id="50b35-116">To place data on or retrieve data from the clipboard, a window must first open the clipboard by using the [**OpenClipboard**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) function.</span></span> <span data-ttu-id="50b35-117">Nur in einem Fenster kann die Zwischenablage gleichzeitig geöffnet sein.</span><span class="sxs-lookup"><span data-stu-id="50b35-117">Only one window can have the clipboard open at a time.</span></span> <span data-ttu-id="50b35-118">Um herauszufinden, in welchem Fenster die Zwischenablage geöffnet ist, können Sie die [**getopenclipboardwindow**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="50b35-118">To find out which window has the clipboard open, call the [**GetOpenClipboardWindow**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) function.</span></span> <span data-ttu-id="50b35-119">Nachdem der Vorgang abgeschlossen ist, muss das Fenster die Zwischenablage schließen, indem die [**CloseClipboard**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) -Funktion aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="50b35-119">When it has finished, the window must close the clipboard by calling the [**CloseClipboard**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) function.</span></span>

<span data-ttu-id="50b35-120">Die folgenden Themen werden in diesem Abschnitt erläutert.</span><span class="sxs-lookup"><span data-stu-id="50b35-120">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="50b35-121">Ausschneide-und Kopiervorgänge</span><span class="sxs-lookup"><span data-stu-id="50b35-121">Cut and Copy Operations</span></span>](#cut-and-copy-operations)
-   [<span data-ttu-id="50b35-122">Einfügevorgänge</span><span class="sxs-lookup"><span data-stu-id="50b35-122">Paste Operations</span></span>](#paste-operations)
-   [<span data-ttu-id="50b35-123">Besitz der Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="50b35-123">Clipboard Ownership</span></span>](#clipboard-ownership)
-   [<span data-ttu-id="50b35-124">Verzögertes Rendering</span><span class="sxs-lookup"><span data-stu-id="50b35-124">Delayed Rendering</span></span>](#delayed-rendering)
-   [<span data-ttu-id="50b35-125">Arbeitsspeicher und Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="50b35-125">Memory and the Clipboard</span></span>](#memory-and-the-clipboard)

## <a name="cut-and-copy-operations"></a><span data-ttu-id="50b35-126">Ausschneide-und Kopiervorgänge</span><span class="sxs-lookup"><span data-stu-id="50b35-126">Cut and Copy Operations</span></span>

<span data-ttu-id="50b35-127">Zum Platzieren von Informationen in der Zwischenablage löscht ein Fenster zuerst den vorherigen Inhalt der Zwischenablage mithilfe der [**EmptyClipboard**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="50b35-127">To place information on the clipboard, a window first clears any previous clipboard content by using the [**EmptyClipboard**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="50b35-128">Diese Funktion sendet die [**WM \_ destroyclipboard**](wm-destroyclipboard.md) -Nachricht an den vorherigen Besitzer der Zwischenablage, gibt Ressourcen frei, die Daten in der Zwischenablage zugeordnet sind, und weist den Zwischenablage Besitz dem Fenster zu, in dem die Zwischenablage geöffnet ist.</span><span class="sxs-lookup"><span data-stu-id="50b35-128">This function sends the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message to the previous clipboard owner, frees resources associated with data on the clipboard, and assigns clipboard ownership to the window that has the clipboard open.</span></span> <span data-ttu-id="50b35-129">Um herauszufinden, welches Fenster die Zwischenablage besitzt, können Sie die [**getclipboardowner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="50b35-129">To find out which window owns the clipboard, call the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function.</span></span>

<span data-ttu-id="50b35-130">Nach dem leeren der Zwischenablage platziert das Fenster Daten in der Zwischenablage in so vielen Zwischenablage Formaten wie möglich, geordnet nach dem am besten beschreibenden Zwischenablage Format.</span><span class="sxs-lookup"><span data-stu-id="50b35-130">After emptying the clipboard, the window places data on the clipboard in as many clipboard formats as possible, ordered from the most descriptive clipboard format to the least descriptive.</span></span> <span data-ttu-id="50b35-131">Für jedes Format Ruft das Fenster die [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) -Funktion auf und gibt den Format Bezeichner und ein globales Speicher Handle an.</span><span class="sxs-lookup"><span data-stu-id="50b35-131">For each format, the window calls the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function, specifying the format identifier and a global memory handle.</span></span> <span data-ttu-id="50b35-132">Das Speicher Handle kann NULL sein, was bedeutet, dass das Fenster die Daten bei der Anforderung rendert.</span><span class="sxs-lookup"><span data-stu-id="50b35-132">The memory handle can be NULL, indicating that the window renders the data on request.</span></span> <span data-ttu-id="50b35-133">Weitere Informationen finden Sie unter [Verzögertes Rendering](#delayed-rendering).</span><span class="sxs-lookup"><span data-stu-id="50b35-133">For more information, see [Delayed Rendering](#delayed-rendering).</span></span>

## <a name="paste-operations"></a><span data-ttu-id="50b35-134">Einfügevorgänge</span><span class="sxs-lookup"><span data-stu-id="50b35-134">Paste Operations</span></span>

<span data-ttu-id="50b35-135">Um Einfüge Informationen aus der Zwischenablage abzurufen, bestimmt ein Fenster zuerst das abzurufende Zwischenablage Format.</span><span class="sxs-lookup"><span data-stu-id="50b35-135">To retrieve paste information from the clipboard, a window first determines the clipboard format to retrieve.</span></span> <span data-ttu-id="50b35-136">In der Regel listet ein Fenster die verfügbaren Zwischenablage Formate mithilfe der [**enumclipboardformats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) -Funktion auf und verwendet das erste Format, das es erkennt.</span><span class="sxs-lookup"><span data-stu-id="50b35-136">Typically, a window enumerates the available clipboard formats by using the [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) function and uses the first format it recognizes.</span></span> <span data-ttu-id="50b35-137">Diese Methode wählt das beste verfügbare Format gemäß dem Prioritäts Satz aus, wenn die Daten in der Zwischenablage platziert wurden.</span><span class="sxs-lookup"><span data-stu-id="50b35-137">This method selects the best available format according to the priority set when the data was placed on the clipboard.</span></span>

<span data-ttu-id="50b35-138">Alternativ kann ein Fenster die [**getpriorityclipboardformat**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) -Funktion verwenden.</span><span class="sxs-lookup"><span data-stu-id="50b35-138">Alternatively, a window can use the [**GetPriorityClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) function.</span></span> <span data-ttu-id="50b35-139">Diese Funktion identifiziert das beste verfügbare Zwischenablage Format entsprechend einer angegebenen Priorität.</span><span class="sxs-lookup"><span data-stu-id="50b35-139">This function identifies the best available clipboard format according to a specified priority.</span></span> <span data-ttu-id="50b35-140">Ein Fenster, das nur ein Zwischenablage Format erkennt, kann einfach bestimmen, ob dieses Format mithilfe der [**isclipboardformatavailable**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) -Funktion verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="50b35-140">A window that recognizes only one clipboard format can simply determine whether that format is available by using the [**IsClipboardFormatAvailable**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) function.</span></span>

<span data-ttu-id="50b35-141">Nachdem Sie das zu verwendende Zwischenablage Format festgelegt haben, Ruft ein Fenster die [**GetClipboardData**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) -Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="50b35-141">After determining the clipboard format to use, a window calls the [**GetClipboardData**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) function.</span></span> <span data-ttu-id="50b35-142">Diese Funktion gibt das Handle für ein globales Speicher Objekt zurück, das Daten im angegebenen Format enthält.</span><span class="sxs-lookup"><span data-stu-id="50b35-142">This function returns the handle to a global memory object containing data in the specified format.</span></span> <span data-ttu-id="50b35-143">Ein Fenster kann das Speicher Objekt kurz sperren, um die Daten zu überprüfen oder zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="50b35-143">A window can briefly lock the memory object in order to examine or copy the data.</span></span> <span data-ttu-id="50b35-144">Ein Fenster sollte das Objekt jedoch nicht freigeben oder für einen längeren Zeitraum gesperrt bleiben.</span><span class="sxs-lookup"><span data-stu-id="50b35-144">However, a window should not free the object or leave it locked for a long period of time.</span></span>

## <a name="clipboard-ownership"></a><span data-ttu-id="50b35-145">Besitz der Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="50b35-145">Clipboard Ownership</span></span>

<span data-ttu-id="50b35-146">Der *Besitzer der Zwischenablage* ist das Fenster, das den Informationen in der Zwischenablage zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="50b35-146">The *clipboard owner* is the window associated with the information on the clipboard.</span></span> <span data-ttu-id="50b35-147">Ein Fenster wird zum Besitzer der Zwischenablage, wenn Daten in der Zwischenablage platziert werden, insbesondere wenn die [**EmptyClipboard**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) -Funktion aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="50b35-147">A window becomes the clipboard owner when it places data on the clipboard, specifically, when it calls the [**EmptyClipboard**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="50b35-148">Das Fenster bleibt der Besitzer der Zwischenablage, bis es geschlossen wird oder ein anderes Fenster die Zwischenablage leert.</span><span class="sxs-lookup"><span data-stu-id="50b35-148">The window remains the clipboard owner until it is closed or another window empties the clipboard.</span></span>

<span data-ttu-id="50b35-149">Wenn die Zwischenablage geleert wird, empfängt der Besitzer der Zwischenablage eine [**WM \_ destroyclipboard**](wm-destroyclipboard.md) -Nachricht.</span><span class="sxs-lookup"><span data-stu-id="50b35-149">When the clipboard is emptied, the clipboard owner receives a [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="50b35-150">Es folgen einige Gründe, warum ein Fenster diese Nachricht verarbeiten kann:</span><span class="sxs-lookup"><span data-stu-id="50b35-150">Following are some reasons why a window might process this message:</span></span>

-   <span data-ttu-id="50b35-151">Das Fenster verzögerte Rendering von einem oder mehreren Zwischenablage Formaten.</span><span class="sxs-lookup"><span data-stu-id="50b35-151">The window delayed rendering of one or more clipboard formats.</span></span> <span data-ttu-id="50b35-152">Als Antwort auf die Meldung " [**WM \_ destroyclipboard**](wm-destroyclipboard.md) " gibt das Fenster möglicherweise Ressourcen frei, die ihm zugeordnet wurden, um Daten auf Anforderung zu Rendering.</span><span class="sxs-lookup"><span data-stu-id="50b35-152">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had allocated in order to render data on request.</span></span> <span data-ttu-id="50b35-153">Weitere Informationen zum Rendern von Daten finden Sie unter [Verzögertes Rendering](#delayed-rendering).</span><span class="sxs-lookup"><span data-stu-id="50b35-153">For more information about the rendering of data, see [Delayed Rendering](#delayed-rendering).</span></span>
-   <span data-ttu-id="50b35-154">Das Fenster hat Daten in der Zwischenablage in einem privaten Zwischenablage Format abgelegt.</span><span class="sxs-lookup"><span data-stu-id="50b35-154">The window placed data on the clipboard in a private clipboard format.</span></span> <span data-ttu-id="50b35-155">Die Daten für private Zwischenablage Formate werden vom System nicht freigegeben, wenn die Zwischenablage geleert wird.</span><span class="sxs-lookup"><span data-stu-id="50b35-155">The data for private clipboard formats is not freed by the system when the clipboard is emptied.</span></span> <span data-ttu-id="50b35-156">Daher sollte der Besitzer der Zwischenablage die Daten beim Empfang der [**WM \_ destroyclipboard**](wm-destroyclipboard.md) -Nachricht freigeben.</span><span class="sxs-lookup"><span data-stu-id="50b35-156">Therefore, the clipboard owner should free the data upon receiving the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="50b35-157">Weitere Informationen zu privaten Zwischenablage Formaten finden Sie unter [Zwischenablage Formate](clipboard-formats.md).</span><span class="sxs-lookup"><span data-stu-id="50b35-157">For more information about private clipboard formats, see [Clipboard Formats](clipboard-formats.md).</span></span>
-   <span data-ttu-id="50b35-158">Das Fenster hat Daten in der Zwischenablage mithilfe des CF-Besitzer **\_ Anzeige** -Zwischenablage Formats platziert.</span><span class="sxs-lookup"><span data-stu-id="50b35-158">The window placed data on the clipboard using the **CF\_OWNERDISPLAY** clipboard format.</span></span> <span data-ttu-id="50b35-159">Als Antwort auf die [**WM \_ destroyclipboard**](wm-destroyclipboard.md) -Nachricht gibt das Fenster möglicherweise Ressourcen frei, die für die Anzeige von Informationen im Fenster der Zwischenablage Anzeige verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="50b35-159">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had used to display information in the clipboard viewer window.</span></span> <span data-ttu-id="50b35-160">Weitere Informationen zu diesem alternativen Format finden Sie unter [Anzeige Format des Besitzers](about-the-clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="50b35-160">For more information about this alternative format, see [Owner Display Format](about-the-clipboard.md).</span></span>

## <a name="delayed-rendering"></a><span data-ttu-id="50b35-161">Verzögertes Rendering</span><span class="sxs-lookup"><span data-stu-id="50b35-161">Delayed Rendering</span></span>

<span data-ttu-id="50b35-162">Wenn Sie ein Zwischenablage Format in der Zwischenablage platzieren, kann ein Fenster das Rendern der Daten in diesem Format verzögern, bis die Daten benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="50b35-162">When placing a clipboard format on the clipboard, a window can delay rendering the data in that format until the data is needed.</span></span> <span data-ttu-id="50b35-163">Zu diesem Zweck kann eine Anwendung **null** für den *hdata* -Parameter der [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) -Funktion angeben.</span><span class="sxs-lookup"><span data-stu-id="50b35-163">To do so, an application can specify **NULL** for the *hData* parameter of the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function.</span></span> <span data-ttu-id="50b35-164">Dies ist hilfreich, wenn die Anwendung mehrere Zwischenablage Formate unterstützt, von denen einige oder alle zeitaufwändig zum Renderingformat sind.</span><span class="sxs-lookup"><span data-stu-id="50b35-164">This is useful if the application supports several clipboard formats, some or all of which are time-consuming to render.</span></span> <span data-ttu-id="50b35-165">Durch die Übergabe eines **null** -Handles rendert ein Fenster komplexe Zwischenablage Formate nur dann, wenn Sie benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="50b35-165">By passing a **NULL** handle, a window renders complex clipboard formats only when and if they are needed.</span></span>

<span data-ttu-id="50b35-166">Wenn ein Fenster das Rendern eines Zwischenablage Formats verzögert, muss es darauf vorbereitet sein, das Format auf Anforderung zu rendern, solange es der Besitzer der Zwischenablage ist.</span><span class="sxs-lookup"><span data-stu-id="50b35-166">If a window delays rendering a clipboard format, it must be prepared to render the format upon request for as long as it is the clipboard owner.</span></span> <span data-ttu-id="50b35-167">Das System sendet dem Besitzer der Zwischenablage eine [**WM- \_ Renderformat**](wm-renderformat.md) -Nachricht, wenn eine Anforderung für ein bestimmtes Format empfangen wird, das nicht gerendert wurde.</span><span class="sxs-lookup"><span data-stu-id="50b35-167">The system sends the clipboard owner a [**WM\_RENDERFORMAT**](wm-renderformat.md) message when a request is received for a specific format that has not been rendered.</span></span> <span data-ttu-id="50b35-168">Beim Empfang dieser Nachricht sollte das Fenster die [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) -Funktion aufrufen, um ein globales Speicher Handle in der Zwischenablage im angeforderten Format zu platzieren.</span><span class="sxs-lookup"><span data-stu-id="50b35-168">Upon receiving this message, the window should call the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function to place a global memory handle on the clipboard in the requested format.</span></span>

<span data-ttu-id="50b35-169">Eine Anwendung darf die Zwischenablage vor dem Aufruf von [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) nicht als Antwort auf die [**WM- \_ Renderformat**](wm-renderformat.md) -Meldung öffnen.</span><span class="sxs-lookup"><span data-stu-id="50b35-169">An application must not open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) in response to the [**WM\_RENDERFORMAT**](wm-renderformat.md) message.</span></span> <span data-ttu-id="50b35-170">Das Öffnen der Zwischenablage ist nicht erforderlich, und jeder Versuch, dies zu tun, schlägt fehl, da die Zwischenablage derzeit von der Anwendung geöffnet wird, die das Rendern des Formats angefordert hat.</span><span class="sxs-lookup"><span data-stu-id="50b35-170">Opening the clipboard is not necessary, and any attempt to do so will fail because the clipboard is currently being held open by the application that requested the format to be rendered.</span></span>

<span data-ttu-id="50b35-171">Wenn der Besitzer der Zwischenablage zerstört wird und einige oder alle Zwischenablage Formate verzögert rendern, empfängt er die [**WM- \_ renderallformats**](wm-renderallformats.md) -Nachricht.</span><span class="sxs-lookup"><span data-stu-id="50b35-171">If the clipboard owner is about to be destroyed and has delayed rendering some or all clipboard formats, it receives the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message.</span></span> <span data-ttu-id="50b35-172">Beim Empfang dieser Nachricht sollte das Fenster die Zwischenablage öffnen, überprüfen, ob es weiterhin der Besitzer der Zwischenablage mit der [**getclipboardowner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) -Funktion ist, und dann gültige Speicher Handles für alle Zwischenablage Formate in der Zwischenablage platzieren.</span><span class="sxs-lookup"><span data-stu-id="50b35-172">Upon receiving this message, the window should open the clipboard, check that it is still the clipboard owner with the the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function, and then place valid memory handles on the clipboard for all clipboard formats that it provides.</span></span> <span data-ttu-id="50b35-173">Dadurch wird sichergestellt, dass diese Formate verfügbar bleiben, nachdem der Besitzer der Zwischenablage zerstört wurde.</span><span class="sxs-lookup"><span data-stu-id="50b35-173">This ensures that these formats remain available after the clipboard owner is destroyed.</span></span>

<span data-ttu-id="50b35-174">Anders als bei [**WM \_ Renderformat**](wm-renderformat.md)sollte eine Anwendung, die auf [**WM \_ renderallformats**](wm-renderallformats.md) antwortet, die Zwischenablage öffnen, bevor [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) aufgerufen wird, um globale Speicher Handles in der Zwischenablage zu platzieren.</span><span class="sxs-lookup"><span data-stu-id="50b35-174">Unlike with [**WM\_RENDERFORMAT**](wm-renderformat.md), an application responding to [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) should open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) to place any global memory handles on the clipboard.</span></span>

<span data-ttu-id="50b35-175">Alle Zwischenablage Formate, die nicht als Antwort auf die [**WM- \_ renderallformats**](wm-renderallformats.md) -Nachricht gerendert werden, sind für andere Anwendungen nicht mehr verfügbar und werden nicht mehr durch die Zwischenablage Funktionen aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="50b35-175">Any clipboard formats that are not rendered in response to the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message cease to be available to other applications and are no longer enumerated by the clipboard functions.</span></span>

## <a name="memory-and-the-clipboard"></a><span data-ttu-id="50b35-176">Arbeitsspeicher und Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="50b35-176">Memory and the Clipboard</span></span>

<span data-ttu-id="50b35-177">Ein Speicher Objekt, das in der Zwischenablage platziert werden soll, muss mithilfe der [**globalzuzuordnungs**](/windows/desktop/api/winbase/nf-winbase-globalalloc) -Funktion mit dem für **GMEM Verschieb \_ baren** Flag zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="50b35-177">A memory object that is to be placed on the clipboard should be allocated by using the [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) function with the **GMEM\_MOVEABLE** flag.</span></span>

<span data-ttu-id="50b35-178">Nachdem ein Speicher Objekt in der Zwischenablage abgelegt wurde, wird der Besitz dieses Speicher Handles an das System übertragen.</span><span class="sxs-lookup"><span data-stu-id="50b35-178">After a memory object is placed on the clipboard, ownership of that memory handle is transferred to the system.</span></span> <span data-ttu-id="50b35-179">Wenn die Zwischenablage geleert wird und das Speicher Objekt eines der folgenden Zwischenablage Formate aufweist, gibt das System das Speicher Objekt frei, indem die angegebene Funktion aufgerufen wird:</span><span class="sxs-lookup"><span data-stu-id="50b35-179">When the clipboard is emptied and the memory object has one of the following clipboard formats, the system frees the memory object by calling the specified function:</span></span>



| <span data-ttu-id="50b35-180">Funktion zum freien Objekt</span><span class="sxs-lookup"><span data-stu-id="50b35-180">Function to free object</span></span>                             | <span data-ttu-id="50b35-181">Zwischenablage Format</span><span class="sxs-lookup"><span data-stu-id="50b35-181">Clipboard format</span></span>                                                                                                                                               |
|-----------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="50b35-182">**DeleteMetaFile**</span><span class="sxs-lookup"><span data-stu-id="50b35-182">**DeleteMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deletemetafile)<br/> | <span data-ttu-id="50b35-183">**CF \_ dspenhmetafile**</span><span class="sxs-lookup"><span data-stu-id="50b35-183">**CF\_DSPENHMETAFILE**</span></span><br/> <span data-ttu-id="50b35-184">**CF \_ dspmetafilepict**</span><span class="sxs-lookup"><span data-stu-id="50b35-184">**CF\_DSPMETAFILEPICT**</span></span><br/> <span data-ttu-id="50b35-185">**CF \_ enhmetafile**</span><span class="sxs-lookup"><span data-stu-id="50b35-185">**CF\_ENHMETAFILE**</span></span><br/> <span data-ttu-id="50b35-186">**CF- \_ MetafilePict**</span><span class="sxs-lookup"><span data-stu-id="50b35-186">**CF\_METAFILEPICT**</span></span><br/>                            |
| [<span data-ttu-id="50b35-187">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="50b35-187">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)<br/>     | <span data-ttu-id="50b35-188">**CF- \_ Bitmap**</span><span class="sxs-lookup"><span data-stu-id="50b35-188">**CF\_BITMAP**</span></span><br/> <span data-ttu-id="50b35-189">**CF- \_ dspbitmap**</span><span class="sxs-lookup"><span data-stu-id="50b35-189">**CF\_DSPBITMAP**</span></span><br/> <span data-ttu-id="50b35-190">**CF- \_ Palette**</span><span class="sxs-lookup"><span data-stu-id="50b35-190">**CF\_PALETTE**</span></span><br/>                                                                              |
| [<span data-ttu-id="50b35-191">**GlobalFree**</span><span class="sxs-lookup"><span data-stu-id="50b35-191">**GlobalFree**</span></span>](/windows/desktop/api/winbase/nf-winbase-globalfree)<br/>        | <span data-ttu-id="50b35-192">**CF- \_ DIB**</span><span class="sxs-lookup"><span data-stu-id="50b35-192">**CF\_DIB**</span></span><br/> <span data-ttu-id="50b35-193">**CF \_ DIBV5**</span><span class="sxs-lookup"><span data-stu-id="50b35-193">**CF\_DIBV5**</span></span><br/> <span data-ttu-id="50b35-194">**CF- \_ dsptext**</span><span class="sxs-lookup"><span data-stu-id="50b35-194">**CF\_DSPTEXT**</span></span><br/> <span data-ttu-id="50b35-195">**CF- \_ OemText**</span><span class="sxs-lookup"><span data-stu-id="50b35-195">**CF\_OEMTEXT**</span></span><br/> <span data-ttu-id="50b35-196">**CF- \_ Text**</span><span class="sxs-lookup"><span data-stu-id="50b35-196">**CF\_TEXT**</span></span><br/> <span data-ttu-id="50b35-197">**CF \_ UnicodeText**</span><span class="sxs-lookup"><span data-stu-id="50b35-197">**CF\_UNICODETEXT**</span></span><br/>   |
| <span data-ttu-id="50b35-198">none</span><span class="sxs-lookup"><span data-stu-id="50b35-198">none</span></span><br/>                                     | <span data-ttu-id="50b35-199">**CF-Besitzer \_ Anzeige**</span><span class="sxs-lookup"><span data-stu-id="50b35-199">**CF\_OWNERDISPLAY**</span></span><br/> <span data-ttu-id="50b35-200">Wenn die Zwischenablage von einem CF-Besitzer **\_ Anzeige** Objekt geleert wird, muss die Anwendung selbst das Speicher Objekt freigeben.</span><span class="sxs-lookup"><span data-stu-id="50b35-200">When the clipboard is emptied of a **CF\_OWNERDISPLAY** object, the application itself must free the memory object.</span></span><br/> |



 

 

