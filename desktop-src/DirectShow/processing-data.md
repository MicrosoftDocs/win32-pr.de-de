---
description: Verarbeiten von Daten
ms.assetid: 823615df-ce50-4e20-957a-f83d3be66658
title: Verarbeiten von Daten
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9bbece449df36c2de88414f313d477b8a16ba896
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "106343138"
---
# <a name="processing-data"></a><span data-ttu-id="b4d75-103">Verarbeiten von Daten</span><span class="sxs-lookup"><span data-stu-id="b4d75-103">Processing Data</span></span>

<span data-ttu-id="b4d75-104">**Die Mediendaten werden verarbeitet.**</span><span class="sxs-lookup"><span data-stu-id="b4d75-104">**Parsing Media Data**</span></span>

<span data-ttu-id="b4d75-105">Wenn der Filtermedien Daten analysiert, dürfen Sie keine Header oder anderen selbst beschreibenden Daten im Inhalt als vertrauenswürdig einstufen.</span><span class="sxs-lookup"><span data-stu-id="b4d75-105">If your filter parses media data, do not trust headers or other self-describing data in the content.</span></span> <span data-ttu-id="b4d75-106">Geben Sie z. b. keine Vertrauenswürdigkeit von Größen Werten an, die in AVI-Riff Blöcken oder MPEG-Paketen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b4d75-106">For example, do not trust size values that appear in AVI RIFF chunks or MPEG packets.</span></span> <span data-ttu-id="b4d75-107">Häufige Beispiele für diese Art von Fehler sind:</span><span class="sxs-lookup"><span data-stu-id="b4d75-107">Common examples of this kind of error include:</span></span>

-   <span data-ttu-id="b4d75-108">Lesen von *n* Bytes an Daten, bei denen der Wert von *N* aus dem Inhalt stammt, ohne die tatsächliche Puffergröße zu *überprüfen.*</span><span class="sxs-lookup"><span data-stu-id="b4d75-108">Reading *N* bytes of data, where the value of *N* came from the content, without checking *N* against the actual size of your buffer.</span></span>
-   <span data-ttu-id="b4d75-109">Springen zu einem Byte Offset innerhalb eines Puffers, ohne zu überprüfen, ob der Offset innerhalb des Puffers liegt.</span><span class="sxs-lookup"><span data-stu-id="b4d75-109">Jumping to a byte offset within a buffer, without verifying that the offset falls within the buffer.</span></span>

<span data-ttu-id="b4d75-110">Eine weitere häufige Fehler Klasse besteht darin, dass die im Inhalt gefundenen Format Beschreibungen nicht überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="b4d75-110">Another common class of errors involves not validating format descriptions that are found in the content.</span></span> <span data-ttu-id="b4d75-111">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="b4d75-111">For example:</span></span>

-   <span data-ttu-id="b4d75-112">Auf eine [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) -Struktur kann eine Farbtabelle folgen.</span><span class="sxs-lookup"><span data-stu-id="b4d75-112">A [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) structure can be followed by a color table.</span></span> <span data-ttu-id="b4d75-113">Die **BitmapInfo** -Struktur wird als **BITMAPINFOHEADER** -Struktur, gefolgt von einem Array von **rgbquad** -Werten, die die Farbtabelle bilden, definiert.</span><span class="sxs-lookup"><span data-stu-id="b4d75-113">The **BITMAPINFO** structure is defined as a **BITMAPINFOHEADER** structure followed by an array of **RGBQUAD** values that make up the color table.</span></span> <span data-ttu-id="b4d75-114">Die Größe des Arrays wird durch den Wert von " **biclrused**" bestimmt.</span><span class="sxs-lookup"><span data-stu-id="b4d75-114">The size of the array is determined by the value of **biClrUsed**.</span></span> <span data-ttu-id="b4d75-115">Kopieren Sie niemals eine Farbtabelle in eine **BitmapInfo** , ohne zuvor die Größe des Puffers zu überprüfen, der für die **BitmapInfo** -Struktur reserviert wurde.</span><span class="sxs-lookup"><span data-stu-id="b4d75-115">Never copy a color table into a **BITMAPINFO** without first checking the size of the buffer that was allocated for the **BITMAPINFO** structure.</span></span>
-   <span data-ttu-id="b4d75-116">Einer [**WaveFormatEx**](/previous-versions/dd757713(v=vs.85)) -Struktur können zusätzliche Formatierungsinformationen an die Struktur angehängt werden.</span><span class="sxs-lookup"><span data-stu-id="b4d75-116">A [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85)) structure might have extra format information appended to the structure.</span></span> <span data-ttu-id="b4d75-117">Der **CBSIZE** -Member gibt die Größe der zusätzlichen Informationen an.</span><span class="sxs-lookup"><span data-stu-id="b4d75-117">The **cbSize** member specifies the size of the extra information.</span></span>

<span data-ttu-id="b4d75-118">Während der Pin-Verbindung sollte ein Filter überprüfen, ob alle Format Strukturen wohl geformt sind und sinnvolle Werte enthalten.</span><span class="sxs-lookup"><span data-stu-id="b4d75-118">During pin connection, a filter should verify that all format structures are well-formed and contain reasonable values.</span></span> <span data-ttu-id="b4d75-119">Falls nicht, lehnen Sie die Verbindung ab.</span><span class="sxs-lookup"><span data-stu-id="b4d75-119">If not, reject the connection.</span></span> <span data-ttu-id="b4d75-120">Im Code, der die Format Struktur überprüft, achten Sie besonders auf den arithmetischen Überlauf.</span><span class="sxs-lookup"><span data-stu-id="b4d75-120">In the code that validates the format structure, be especially careful about arithmetic overflow.</span></span> <span data-ttu-id="b4d75-121">In einem **BITMAPINFOHEADER** sind z. b. Breite und Höhe 32 **-Bit-** Werte, aber die Bildgröße (die eine Funktion des Produkts zweier ist) ist nur ein **DWORD** -Wert.</span><span class="sxs-lookup"><span data-stu-id="b4d75-121">For example, in a **BITMAPINFOHEADER**, the width and height are 32-bit **long** values but the image size (which is a function of the product of the two) is only a **DWORD** value.</span></span>

<span data-ttu-id="b4d75-122">Wenn die Format Daten aus der Quelle größer sind als der zugeordnete Puffer, kürzen Sie die Quelldaten nicht, um Sie in den Puffer zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="b4d75-122">If format data from the source is larger than your allocated buffer, do not truncate the source data in order to copy it into your buffer.</span></span> <span data-ttu-id="b4d75-123">Dadurch kann eine Struktur erstellt werden, deren implizite Größe größer ist als die tatsächliche Größe.</span><span class="sxs-lookup"><span data-stu-id="b4d75-123">Doing so can create a structure whose implicit size is larger than its actual size.</span></span> <span data-ttu-id="b4d75-124">Beispielsweise kann ein Bitmapheader eine Palettentabelle angeben, die nicht mehr vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="b4d75-124">For example, a bitmap header might specify a palette table which no longer exists.</span></span> <span data-ttu-id="b4d75-125">Ordnen Sie stattdessen den Puffer neu zu, oder führen Sie einfach die Verbindung aus.</span><span class="sxs-lookup"><span data-stu-id="b4d75-125">Instead, reallocate the buffer or simply fail the connection.</span></span>

<span data-ttu-id="b4d75-126">**Fehler beim Streaming**</span><span class="sxs-lookup"><span data-stu-id="b4d75-126">**Errors During Streaming**</span></span>

<span data-ttu-id="b4d75-127">Wenn das Diagramm ausgeführt wird und der Filter falsch formatierten Inhalt empfängt, sollte das Streaming beendet werden.</span><span class="sxs-lookup"><span data-stu-id="b4d75-127">When the graph is running, if your filter receives malformed content, it should terminate streaming.</span></span> <span data-ttu-id="b4d75-128">Führen Sie folgende Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="b4d75-128">Do the following:</span></span>

-   <span data-ttu-id="b4d75-129">Gibt einen Fehlercode von **Receive** zurück.</span><span class="sxs-lookup"><span data-stu-id="b4d75-129">Return an error code from **Receive**.</span></span>
-   <span data-ttu-id="b4d75-130">Nennen Sie [**IPin:: EndOfStream für den downstreamfilter**](/windows/desktop/api/Strmif/nf-strmif-ipin-endofstream) .</span><span class="sxs-lookup"><span data-stu-id="b4d75-130">Call [**IPin::EndOfStream**](/windows/desktop/api/Strmif/nf-strmif-ipin-endofstream) on the downstream filter.</span></span>
-   <span data-ttu-id="b4d75-131">Aufrufen von [**cbasefilter:: notifyEvent**](cbasefilter-notifyevent.md) zum Veröffentlichen eines [**EC \_ errorabort**](ec-errorabort.md) -Ereignisses.</span><span class="sxs-lookup"><span data-stu-id="b4d75-131">Call [**CBaseFilter::NotifyEvent**](cbasefilter-notifyevent.md) to post an [**EC\_ERRORABORT**](ec-errorabort.md) event.</span></span>

<span data-ttu-id="b4d75-132">**Formatieren von Änderungen**</span><span class="sxs-lookup"><span data-stu-id="b4d75-132">**Format Changes**</span></span>

<span data-ttu-id="b4d75-133">Für Filter zum Ändern von Formaten in der Mitte des Streams sind mehrere Mechanismen vorhanden.</span><span class="sxs-lookup"><span data-stu-id="b4d75-133">Several mechanisms exist for filters to change formats mid-stream.</span></span> <span data-ttu-id="b4d75-134">Jede dieser Komponenten umfasst mehr als einen Schritt, der das Potenzial für falsche Annahmen erzeugt.</span><span class="sxs-lookup"><span data-stu-id="b4d75-134">Each of them involves more than one step, which creates the potential for false acceptances.</span></span> <span data-ttu-id="b4d75-135">Wenn der Filter eine Anforderung für eine Änderung des dynamischen Formats erhält, muss die Anforderung entweder abgelehnt werden, oder das neue Format wird beim Eintreffen berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="b4d75-135">If your filter gets a request for a dynamic format change, then it must either reject the request, or else honor the new format when it arrives.</span></span> <span data-ttu-id="b4d75-136">Ändern Sie auch nie Formate, es sei denn, der andere Filter stimmt überein.</span><span class="sxs-lookup"><span data-stu-id="b4d75-136">Similarly, never switch formats unless the other filter agrees.</span></span> <span data-ttu-id="b4d75-137">Weitere Informationen finden Sie unter [dynamische Format Änderungen](dynamic-format-changes.md).</span><span class="sxs-lookup"><span data-stu-id="b4d75-137">For more information, see [Dynamic Format Changes](dynamic-format-changes.md).</span></span>

 

 
