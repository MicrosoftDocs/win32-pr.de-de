---
description: Aushandeln von Zuweisungen
ms.assetid: fe13477c-1a7b-4098-9d0f-c54783102bc9
title: Aushandeln von Zuweisungen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2faa393ba9fcd8585d68947cec172d4cfca6decf
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "106344316"
---
# <a name="negotiating-allocators"></a><span data-ttu-id="70a09-103">Aushandeln von Zuweisungen</span><span class="sxs-lookup"><span data-stu-id="70a09-103">Negotiating Allocators</span></span>

<span data-ttu-id="70a09-104">Wenn zwei Pins eine Verbindung herstellen, benötigen Sie einen Mechanismus zum Austauschen von Mediendaten.</span><span class="sxs-lookup"><span data-stu-id="70a09-104">When two pins connect, they need a mechanism for exchanging media data.</span></span> <span data-ttu-id="70a09-105">Dieser Mechanismus wird als *Transport* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="70a09-105">This mechanism is called the *transport*.</span></span> <span data-ttu-id="70a09-106">Im Allgemeinen ist die DirectShow-Architektur in Bezug auf Transporte neutral.</span><span class="sxs-lookup"><span data-stu-id="70a09-106">In general, the DirectShow architecture is neutral about transports.</span></span> <span data-ttu-id="70a09-107">Zwei Filter können eine Verbindung mit einem beliebigen von beiden unterstützten Transport herstellen.</span><span class="sxs-lookup"><span data-stu-id="70a09-107">Two filters can agree to connect using any transport that both support.</span></span>

<span data-ttu-id="70a09-108">Der häufigste Transport ist der *lokale Speicher* Transport, in dem sich die Mediendaten im Hauptspeicher befinden.</span><span class="sxs-lookup"><span data-stu-id="70a09-108">The most common transport is the *local memory* transport, in which the media data resides in main memory.</span></span> <span data-ttu-id="70a09-109">Es sind zwei Varianten des lokalen Speicher Transports vorhanden: das *Push-Modell* und das *Pull-Modell*.</span><span class="sxs-lookup"><span data-stu-id="70a09-109">Two flavors of local memory transport exist, the *push model* and the *pull model*.</span></span> <span data-ttu-id="70a09-110">Im Push-Modell überträgt der Quell Filterdaten mithilfe der [**IMemInputPin**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin) -Schnittstelle auf die Eingabe-PIN des downstreamfilters an den downstreamfilter.</span><span class="sxs-lookup"><span data-stu-id="70a09-110">In the push model, the source filter pushes data to the downstream filter, using the [**IMemInputPin**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin) interface on the downstream filter's input pin.</span></span> <span data-ttu-id="70a09-111">Im Pull-Modell fordert der Downstream-Filterdaten aus dem Quell Filter an und verwendet dabei die [**iasynkreader**](/windows/desktop/api/Strmif/nn-strmif-iasyncreader) -Schnittstelle in der Ausgabe-PIN des Quell Filters.</span><span class="sxs-lookup"><span data-stu-id="70a09-111">In the pull model, the downstream filter requests data from the source filter, using the [**IAsyncReader**](/windows/desktop/api/Strmif/nn-strmif-iasyncreader) interface on the source filter's output pin.</span></span> <span data-ttu-id="70a09-112">Weitere Informationen zu diesen beiden Datenfluss Modellen finden Sie unter [Datenfluss im Filter Diagramm](data-flow-in-the-filter-graph.md).</span><span class="sxs-lookup"><span data-stu-id="70a09-112">For more information on these two data-flow models, see [Data Flow in the Filter Graph](data-flow-in-the-filter-graph.md).</span></span>

<span data-ttu-id="70a09-113">Beim lokalen Speicher Transport wird das für die Zuordnung von Speicher Puffern verantwortliche Objekt als *Zuweisungs* Name bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="70a09-113">In local memory transport, the object responsible for allocating memory buffers is called the *allocator*.</span></span> <span data-ttu-id="70a09-114">Eine Zuweisung unterstützt die [**imemzuordcator**](/windows/desktop/api/Strmif/nn-strmif-imemallocator) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="70a09-114">An allocator supports the [**IMemAllocator**](/windows/desktop/api/Strmif/nn-strmif-imemallocator) interface.</span></span> <span data-ttu-id="70a09-115">Beide Pins haben einen einzelnen Zuweiser gemeinsam.</span><span class="sxs-lookup"><span data-stu-id="70a09-115">Both pins share a single allocator.</span></span> <span data-ttu-id="70a09-116">Beide Pins können eine Zuweisung bereitstellen, aber die Ausgabe-PIN wählt aus, welche Zuweisung verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="70a09-116">Either pin can provide an allocator, but the output pin selects which allocator to use.</span></span>

<span data-ttu-id="70a09-117">Mit der Ausgabe-PIN werden auch die Zuweisungs Eigenschaften festgelegt, die bestimmen, wie viele Puffer von der Zuweisung, der Größe der einzelnen Puffer und der Arbeitsspeicher Ausrichtung erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="70a09-117">The output pin also sets the allocator properties, which determine how many buffers are created by the allocator, the size of each buffer, and the memory alignment.</span></span> <span data-ttu-id="70a09-118">Die Ausgabe-PIN kann die Eingabe-PIN für die Puffer Anforderungen verzögern.</span><span class="sxs-lookup"><span data-stu-id="70a09-118">The output pin might defer to the input pin for the buffer requirements.</span></span>

<span data-ttu-id="70a09-119">In einer **IMemInputPin** -Verbindung funktioniert die Zuordnungs Aushandlung wie folgt:</span><span class="sxs-lookup"><span data-stu-id="70a09-119">In an **IMemInputPin** connection, allocator negotiation works as follows:</span></span>

1.  <span data-ttu-id="70a09-120">Optional Ruft die Ausgabe-PIN [**IMemInputPin:: getallogorrequirements**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-getallocatorrequirements)auf.</span><span class="sxs-lookup"><span data-stu-id="70a09-120">Optionally, the output pin calls [**IMemInputPin::GetAllocatorRequirements**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-getallocatorrequirements).</span></span> <span data-ttu-id="70a09-121">Diese Methode ruft die Puffer Anforderungen der Eingabe-PIN ab, z. b. die Arbeitsspeicher Ausrichtung.</span><span class="sxs-lookup"><span data-stu-id="70a09-121">This method retrieves the input pin's buffer requirements, such as memory alignment.</span></span> <span data-ttu-id="70a09-122">Im Allgemeinen sollte die Ausgabe-PIN die Anforderung der Eingabe-PIN beachten, es sei denn, es gibt keinen guten Grund, warum dies nicht der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="70a09-122">In general, the output pin should honor the input pin's request, unless there is a good reason not to.</span></span>
2.  <span data-ttu-id="70a09-123">Optional Ruft die Ausgabe-PIN [**IMemInputPin:: getallocator**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-getallocator)auf.</span><span class="sxs-lookup"><span data-stu-id="70a09-123">Optionally, the output pin calls [**IMemInputPin::GetAllocator**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-getallocator).</span></span> <span data-ttu-id="70a09-124">Diese Methode fordert eine Zuweisung von der eingabepin an.</span><span class="sxs-lookup"><span data-stu-id="70a09-124">This method requests an allocator from the input pin.</span></span> <span data-ttu-id="70a09-125">Die Eingabe-PIN stellt eine bereit, oder es wird ein Fehlercode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="70a09-125">The input pin provides one, or returns an error code.</span></span>
3.  <span data-ttu-id="70a09-126">Mit dem Ausgabepin wird eine Zuweisung ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="70a09-126">The output pin selects an allocator.</span></span> <span data-ttu-id="70a09-127">Sie kann eine von der Eingabe-PIN bereitgestellte verwenden oder eine eigene erstellen.</span><span class="sxs-lookup"><span data-stu-id="70a09-127">It can use one provided by the input pin, or create its own.</span></span>
4.  <span data-ttu-id="70a09-128">Die Ausgabe-PIN ruft [**imemzuzucator:: SetProperties**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-setproperties) auf, um die zuordnereigenschaften festzulegen.</span><span class="sxs-lookup"><span data-stu-id="70a09-128">The output pin calls [**IMemAllocator::SetProperties**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-setproperties) to set the allocator properties.</span></span> <span data-ttu-id="70a09-129">Die Zuweisung berücksichtigt die angeforderten Eigenschaften jedoch möglicherweise nicht.</span><span class="sxs-lookup"><span data-stu-id="70a09-129">However, the allocator might not honor the requested properties.</span></span> <span data-ttu-id="70a09-130">(Dies kann beispielsweise der Fall sein, wenn die Eingabe-PIN die Zuweisung bereitstellt.) Die Zuweisung gibt die tatsächlichen Eigenschaften als Ausgabeparameter in der **SetProperties** -Methode zurück.</span><span class="sxs-lookup"><span data-stu-id="70a09-130">(For example, this can happen if the input pin provides the allocator.) The allocator returns the actual properties as an output parameter in the **SetProperties** method.</span></span>
5.  <span data-ttu-id="70a09-131">Mit dem outpin wird [**IMemInputPin:: notifyzuweisung**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-notifyallocator) aufgerufen, um die Eingabe-PIN der Auswahl zu informieren.</span><span class="sxs-lookup"><span data-stu-id="70a09-131">The outpin calls [**IMemInputPin::NotifyAllocator**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-notifyallocator) to inform the input pin of the selection.</span></span>
6.  <span data-ttu-id="70a09-132">Die eingabepin muss [**imemzucator:: GetProperties**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-getproperties) aufrufen, um zu überprüfen, ob die zuordnereigenschaften zulässig sind.</span><span class="sxs-lookup"><span data-stu-id="70a09-132">The input pin should call [**IMemAllocator::GetProperties**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-getproperties) to verify whether the allocator properties are acceptable.</span></span>
7.  <span data-ttu-id="70a09-133">Die Ausgabe-PIN ist für das committen und das Debuggen der Zuweisung verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="70a09-133">The output pin is responsible for committing and decommitting the allocator.</span></span> <span data-ttu-id="70a09-134">Dies tritt auf, wenn das Streaming gestartet und beendet wird.</span><span class="sxs-lookup"><span data-stu-id="70a09-134">This occurs when streaming starts and stops.</span></span>

<span data-ttu-id="70a09-135">In einer **iasynkreader** -Verbindung funktioniert die Zuordnungs Aushandlung wie folgt:</span><span class="sxs-lookup"><span data-stu-id="70a09-135">In an **IAsyncReader** connection, allocator negotiation works as follows:</span></span>

1.  <span data-ttu-id="70a09-136">Die eingabepin ruft [**iasynkreader:: requestzuweisung**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-requestallocator) in der Ausgabe-PIN auf.</span><span class="sxs-lookup"><span data-stu-id="70a09-136">The input pin calls [**IAsyncReader::RequestAllocator**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-requestallocator) on the output pin.</span></span> <span data-ttu-id="70a09-137">Die Eingabe-PIN gibt die Puffer Anforderungen an und stellt optional eine Zuweisung bereit.</span><span class="sxs-lookup"><span data-stu-id="70a09-137">The input pin specifies its buffer requirements and, optionally, provides an allocator.</span></span>
2.  <span data-ttu-id="70a09-138">Mit dem Ausgabepin wird eine Zuweisung ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="70a09-138">The output pin selects an allocator.</span></span> <span data-ttu-id="70a09-139">Sie kann die von der Eingabe-PIN bereitgestellte, sofern vorhanden, oder eine eigene erstellen.</span><span class="sxs-lookup"><span data-stu-id="70a09-139">It can use the one provided by the input pin, if any, or create its own.</span></span>
3.  <span data-ttu-id="70a09-140">Die Ausgabe-PIN gibt die Zuweisung als ausgehenden Parameter in der **requestzuweisung** -Methode zurück.</span><span class="sxs-lookup"><span data-stu-id="70a09-140">The output pin returns the allocator as an outgoing parameter in the **RequestAllocator** method.</span></span> <span data-ttu-id="70a09-141">Die eingabepin sollte die zuordnereigenschaften überprüfen.</span><span class="sxs-lookup"><span data-stu-id="70a09-141">The input pin should check the allocator properties.</span></span>
4.  <span data-ttu-id="70a09-142">Die eingabepin ist für das committen und das committen der Zuweisung verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="70a09-142">The input pin is responsible for committing and decommitting the allocator.</span></span>
5.  <span data-ttu-id="70a09-143">Während des zuordneraushandlungs Prozesses kann jede PIN jederzeit einen Fehler bei der Verbindung herstellen.</span><span class="sxs-lookup"><span data-stu-id="70a09-143">At any time during the allocator negotiation process, either pin can fail the connection.</span></span>
6.  <span data-ttu-id="70a09-144">Wenn die Ausgabepin die Zuweisung der Eingabe-PIN verwendet, kann Sie diese Zuweisung nur für die Bereitstellung von Beispielen an diese Eingabe-PIN verwenden.</span><span class="sxs-lookup"><span data-stu-id="70a09-144">If the output pin uses the input pin's allocator, it can use that allocator only to deliver samples to that input pin.</span></span> <span data-ttu-id="70a09-145">Der besitzende Filter darf die Zuweisung nicht verwenden, um Stichproben an andere Pins zu übermitteln.</span><span class="sxs-lookup"><span data-stu-id="70a09-145">The owning filter must not use the allocator to deliver samples to other pins.</span></span>

## <a name="related-topics"></a><span data-ttu-id="70a09-146">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="70a09-146">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="70a09-147">Bereitstellen einer benutzerdefinierten Zuweisung</span><span class="sxs-lookup"><span data-stu-id="70a09-147">Providing a Custom Allocator</span></span>](providing-a-custom-allocator.md)
</dt> </dl>

 

 



