---
description: Koordinaten Zuordnung in der VMR
ms.assetid: f0821b90-51d1-4e77-8aed-04337a3dd623
title: Koordinaten Zuordnung in der VMR
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c18b38249471e6e68e36f1b9051f51e920f62b31
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "103860112"
---
# <a name="coordinate-mapping-in-the-vmr"></a><span data-ttu-id="b6b38-103">Koordinaten Zuordnung in der VMR</span><span class="sxs-lookup"><span data-stu-id="b6b38-103">Coordinate Mapping in the VMR</span></span>

<span data-ttu-id="b6b38-104">In diesem Abschnitt werden die fünf Transformationen beschrieben, die auf ein Quell Abbild angewendet werden, bevor es von VMR auf das endgültige Ausgabe Bild zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="b6b38-104">This section describes the five transformations that are applied to a source image before it is mapped by the VMR onto the final output image.</span></span>

1.  <span data-ttu-id="b6b38-105">Die Transformation *T (src)* ordnet das Quell Rechteck dem Ziel Rechteck zu.</span><span class="sxs-lookup"><span data-stu-id="b6b38-105">The transformation *T(Src)* maps the source rectangle to the destination rectangle.</span></span> <span data-ttu-id="b6b38-106">Diese werden von den **rcSource** -und **rctarget** -Membern der [**videoinfoheader**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) -oder [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) -Struktur im Medientyp angegeben.</span><span class="sxs-lookup"><span data-stu-id="b6b38-106">These are specified by the **rcSource** and **rcTarget** members of the [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) or [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) structure in the media type.</span></span> <span data-ttu-id="b6b38-107">Diese Zuordnung führt das Quell Abbild vor, wenn es an den VMR weitergeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="b6b38-107">This mapping preprocesses the source image as it passes to the VMR.</span></span>
2.  <span data-ttu-id="b6b38-108">Die Transformation *T (Flag)* führt alle Bildmanipulationen aus, die von Flags im Medien Beispiel angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="b6b38-108">The transformation *T(Flag)* performs any image manipulations specified by flags in the media sample.</span></span> <span data-ttu-id="b6b38-109">Diese enthielten Transformationen, wie z. b. die vertikale Übersetzung und Skalierung, um die Bob-damit-Flags</span><span class="sxs-lookup"><span data-stu-id="b6b38-109">These included transformations such as the vertical translation and scale to accommodate the bob interlace flags.</span></span> <span data-ttu-id="b6b38-110">Die damit-Transformation verdoppelt die Bildhöhe und übersetzt das Bild möglicherweise um die Hälfte einer videolinie, wenn Sie sich im ungeraden Feld befindet.</span><span class="sxs-lookup"><span data-stu-id="b6b38-110">The interlace transformation doubles the image height and possibly translates the image by half of a video line if it is in the odd field.</span></span>
3.  <span data-ttu-id="b6b38-111">Die Transformation *T (AR)* passt das Bild basierend auf dem Bildseiten Verhältnis an quadratische Pixel an.</span><span class="sxs-lookup"><span data-stu-id="b6b38-111">The transformation *T(AR)* adjusts the image to square pixels, based on the image aspect ratio.</span></span> <span data-ttu-id="b6b38-112">Für **videoinfoheader** -Medientypen wird das Seitenverhältnis durch die Bildgröße bestimmt.</span><span class="sxs-lookup"><span data-stu-id="b6b38-112">For **VIDEOINFOHEADER** media types, the aspect ratio is determined by the image size.</span></span> <span data-ttu-id="b6b38-113">Für **VIDEOINFOHEADER2** -Typen wird das Seitenverhältnis durch die Felder **dwpictaspectratiox** und **dwpictaspectratioy** bestimmt, es sei denn, die Felder amcontrol \_ Pad \_ auf \_ 16x9 oder amcontrol \_ Pad \_ bis \_ 4X3 werden festgelegt.</span><span class="sxs-lookup"><span data-stu-id="b6b38-113">For **VIDEOINFOHEADER2** types, the aspect ratio is determined by the **dwPictAspectRatioX** and **dwPictAspectRatioY** fields, unless the AMCONTROL\_PAD\_TO\_16x9 or AMCONTROL\_PAD\_TO\_4x3 flags are set.</span></span> <span data-ttu-id="b6b38-114">Diese Transformation geht davon aus, dass die Anzeige Einstellung des Monitors mit dem physischen Seitenverhältnis des Monitors übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="b6b38-114">This transformation assumes that the monitor display setting matches the physical aspect ratio of the monitor.</span></span> <span data-ttu-id="b6b38-115">Wenn der Benutzer beispielsweise über einen Monitor mit 4 x 3-Seitenverhältnis verfügt, aber die Anzeige auf 1280 x 768 Pixel (5 x 3) festlegt, weist das Bild nicht das richtige Seitenverhältnis auf.</span><span class="sxs-lookup"><span data-stu-id="b6b38-115">For example, if the user has a monitor with 4 x 3 aspect ratio, but sets the display to 1280 x 768 pixels (5 x 3), the image will not have the correct aspect ratio.</span></span>
4.  <span data-ttu-id="b6b38-116">Die Transformation *T (Mix)* transformiert das Bild innerhalb des Ziel Bilds und verwendet dabei die normalisierten Rechtecke, die in den [**ivmrmixercontrol**](/windows/desktop/api/Strmif/nn-strmif-ivmrmixercontrol) -Methoden angegeben sind.</span><span class="sxs-lookup"><span data-stu-id="b6b38-116">The transformation *T(Mix)* transforms positions the image within the destination image, using the normalized rectangles specified in the [**IVMRMixerControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrmixercontrol) methods.</span></span> <span data-ttu-id="b6b38-117">Mit den normalisierten Rechtecke kann die Anwendung organisieren, wie die Quelldaten Ströme zueinander positioniert und skaliert werden.</span><span class="sxs-lookup"><span data-stu-id="b6b38-117">The normalized rectangles enable the application to organize how the source streams are positioned and scaled relative to each other.</span></span> <span data-ttu-id="b6b38-118">Der VMR berechnet das Zielbild, indem es die maximalen Dimensionen aller Quell Images berechnet und jede innerhalb eines allgemeinen umgebenden Rechtecks zentriert.</span><span class="sxs-lookup"><span data-stu-id="b6b38-118">The VMR computes the destination image by computing the maximum dimensions of all the source images and centering each inside an overall bounding rectangle.</span></span> <span data-ttu-id="b6b38-119">Den Ecken des umgebenden Rechtecks wird der Bereich (0,0) zugewiesen (1, 1).</span><span class="sxs-lookup"><span data-stu-id="b6b38-119">The corners of the bounding rectangle are assigned the range (0,0) to (1,1).</span></span> <span data-ttu-id="b6b38-120">Das umgebende Rechteck wird vor dem Ausführen des Diagramms korrigiert und bleibt auch dann konstant, wenn Streams hinzugefügt oder gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="b6b38-120">The bounding rectangle is fixed before the graph runs and remains constant even if streams are added or deleted.</span></span> <span data-ttu-id="b6b38-121">Die Ziel Rechtecke für jeden Stream können außerhalb des Bereichs (0,0) bis (1, 1) liegen und sind immer noch gültig.</span><span class="sxs-lookup"><span data-stu-id="b6b38-121">Destination rectangles for each stream can lie outside of the range (0,0) to (1,1) and still be valid.</span></span>
5.  <span data-ttu-id="b6b38-122">Schließlich kann ein Teil des gemischten Bilds von der Zuordnung *T (DST)* transformiert werden, die von den Quell-und Ziel Rechtecke in der [**ibasicvideo**](/windows/desktop/api/Control/nn-control-ibasicvideo) -Schnittstelle in der VMR festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="b6b38-122">Finally, a portion of the mixed image can be transformed by the mapping *T(Dst)*, specified by the source and destination rectangles in the [**IBasicVideo**](/windows/desktop/api/Control/nn-control-ibasicvideo) interface on the VMR.</span></span> <span data-ttu-id="b6b38-123">Wenn die Allocator-Presenter ersetzt wird und die **ibasicvideo** -Schnittstelle nicht verwendet wird, muss die Anwendung die [**ivmrwindowlesscontrol**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) -Schnittstelle implementieren und die Koordinaten wieder einem linearen 2D-Bereich zuordnen.</span><span class="sxs-lookup"><span data-stu-id="b6b38-123">If the Allocator-Presenter is replaced and the **IBasicVideo** interface is not used, the application must implement the [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) interface and map the coordinates back into a 2D linear space.</span></span> <span data-ttu-id="b6b38-124">Die an den DVD-Navigator zurückgegebenen Maus Koordinaten müssen sich ebenfalls in diesem Bereich befinden.</span><span class="sxs-lookup"><span data-stu-id="b6b38-124">The mouse coordinates returned to the DVD navigator must also be in this space.</span></span> <span data-ttu-id="b6b38-125">Wenn eine Anwendung z. b. Video auf einem drehenden Cube rendert, würde Sie die gesamte Anzeige für das fensterlose Steuerelement zurückgeben und die Maus Koordinaten relativ zur Anzeige zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="b6b38-125">For example, if an application renders video onto a spinning cube, they would report back the entire display for the windowless control and return mouse coordinates relative to the display.</span></span>

<span data-ttu-id="b6b38-126">Die Transformation für das Gesamtbild von den Quelldaten zum endgültigen Renderer lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="b6b38-126">The overall image transformation from the source data to the final renderer is:</span></span>

<span data-ttu-id="b6b38-127">T = t (src) \* t (Flag) t (AR) t (Mix) \* t (DST)\*</span><span class="sxs-lookup"><span data-stu-id="b6b38-127">T = T(Src)\* T(Flag)T(Ar)T(Mix)\* T(Dst)\*</span></span>

<span data-ttu-id="b6b38-128">\*dabei gibt an, dass das Bild in dieser Phase auf das Zielbild zugeschnitten werden konnte.</span><span class="sxs-lookup"><span data-stu-id="b6b38-128">where \* indicates that the image could be clipped to the destination image at that stage.</span></span> <span data-ttu-id="b6b38-129">Beachten Sie, dass es sich hierbei um affine Transformationen handelt, sodass die VMR Sie in einer einzigen Transformation kombinieren kann.</span><span class="sxs-lookup"><span data-stu-id="b6b38-129">Note that these are all affine transformations, so the VMR can combine them into a single transformation.</span></span>

<span data-ttu-id="b6b38-130">Die Umkehrung der Transformation ist:</span><span class="sxs-lookup"><span data-stu-id="b6b38-130">The inverse of the transformation is:</span></span>

![umgekehrte Transformation](images/vmrmapping-t-1.png)

<span data-ttu-id="b6b38-132">Der Faktor t (src) t (Flag) t (AR) ist relativ zur Quell Auflösung.</span><span class="sxs-lookup"><span data-stu-id="b6b38-132">The factor T(Src) T(Flag) T(Ar) is relative to the source resolution.</span></span> <span data-ttu-id="b6b38-133">Im Faktor T (Mix) ist das normalisierte Quell Rechteck relativ zum Bild, das mit einem Aspekt korrigiert wurde.</span><span class="sxs-lookup"><span data-stu-id="b6b38-133">In the factor T(Mix), the normalized source rectangle is relative to the aspect-corrected image.</span></span> <span data-ttu-id="b6b38-134">Das normalisierte Ziel Rechteck ist relativ zur Ausgabeauflösung.</span><span class="sxs-lookup"><span data-stu-id="b6b38-134">The normalized destination rectangle is relative to the output resolution.</span></span> <span data-ttu-id="b6b38-135">Das folgende Diagramm zeigt diese Beziehungen.</span><span class="sxs-lookup"><span data-stu-id="b6b38-135">The following diagram shows these relationships.</span></span>

![Schritte zur Bild Transformation](images/vmrmapping-transform-steps.png)

## <a name="related-topics"></a><span data-ttu-id="b6b38-137">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="b6b38-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b6b38-138">Verwenden von VMR für DirectShow-Filter Entwickler</span><span class="sxs-lookup"><span data-stu-id="b6b38-138">Using the VMR for DirectShow Filter Developers</span></span>](using-the-vmr-for-directshow-filter-developers.md)
</dt> </dl>

 

 



