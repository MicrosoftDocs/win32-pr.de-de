---
description: Verarbeiten von Format Änderungen vom Videorenderer
ms.assetid: ac7d7b1c-3c9a-4693-87ea-0a10a8ab915c
title: Verarbeiten von Format Änderungen vom Videorenderer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d731ac4b9d6985cf5ad92f642b6d8262209fa91d
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "106346597"
---
# <a name="handling-format-changes-from-the-video-renderer"></a><span data-ttu-id="7fae7-103">Verarbeiten von Format Änderungen vom Videorenderer</span><span class="sxs-lookup"><span data-stu-id="7fae7-103">Handling Format Changes from the Video Renderer</span></span>

<span data-ttu-id="7fae7-104">In diesem Abschnitt wird beschrieben, wie ein Decoderfilter oder Transformations Filter Formatänderungen vom Videorenderer behandeln soll.</span><span class="sxs-lookup"><span data-stu-id="7fae7-104">This section describes how a decoder filter or transform filter should handle format changes from the video renderer.</span></span>

<span data-ttu-id="7fae7-105">**Videorenderer-Filter**</span><span class="sxs-lookup"><span data-stu-id="7fae7-105">**Video Renderer Filter**</span></span>

<span data-ttu-id="7fae7-106">Wenn der alte [Videorendererfilter](video-renderer-filter.md) eine Verbindung herstellt, ist ein RGB-Format erforderlich, das mit dem Anzeige Format des primären Monitors übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="7fae7-106">When the old [Video Renderer](video-renderer-filter.md) filter connects, it requires an RGB format that matches the display format of the primary monitor.</span></span> <span data-ttu-id="7fae7-107">Dies ermöglicht es, GDI zum Rendern zu verwenden, wenn DirectDraw nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="7fae7-107">This enables it to use GDI for rendering if DirectDraw is not available.</span></span> <span data-ttu-id="7fae7-108">Wenn die Wiedergabe gestartet wird, kann der Videorenderer zu einem DirectDraw-kompatiblen Format wechseln.</span><span class="sxs-lookup"><span data-stu-id="7fae7-108">When playback starts, the Video Renderer may switch to a DirectDraw-compatible format.</span></span> <span data-ttu-id="7fae7-109">Um zu vereinigen, ob der upstreamfilter das neue Format unterstützen kann, ruft der Videorenderer [**IPin:: queryaccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) in der Ausgabe-PIN des Upstream-Filters auf.</span><span class="sxs-lookup"><span data-stu-id="7fae7-109">To verfify whether the upstream filter can support the new format, the Video Renderer calls [**IPin::QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) on the upstream filter's output pin.</span></span> <span data-ttu-id="7fae7-110">Wenn der upstreamfilter das neue Format annimmt, gibt die **queryaccept** -Methode S \_ OK zurück.</span><span class="sxs-lookup"><span data-stu-id="7fae7-110">If the upstream filter accepts the new format, the **QueryAccept** method returns S\_OK.</span></span> <span data-ttu-id="7fae7-111">Der Videorenderer schaltet Formate durch Anfügen eines Medientyps mit dem neuen Format an das nächste Medien Beispiel, das von seiner Zuweisung zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="7fae7-111">The Video Renderer switches formats by attaching a media type with the new format to the next media sample returned by its allocator.</span></span> <span data-ttu-id="7fae7-112">Der upstreamfilter sollte überprüfen, ob Formatänderungen vorliegen, indem [**imediasample:: getmediatype**](/windows/desktop/api/Strmif/nf-strmif-imediasample-getmediatype) für jedes Beispiel aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7fae7-112">The upstream filter should check for format changes by calling [**IMediaSample::GetMediaType**](/windows/desktop/api/Strmif/nf-strmif-imediasample-getmediatype) on each sample.</span></span> <span data-ttu-id="7fae7-113">Der Videorenderer kann während des Streamings jederzeit zwischen dem ursprünglichen Format und dem neuen Format wechseln.</span><span class="sxs-lookup"><span data-stu-id="7fae7-113">The Video Renderer may switch back and forth between the original format and new format at any time during streaming.</span></span> <span data-ttu-id="7fae7-114">**Queryaccept** wird nach der ersten Formatänderung nicht aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="7fae7-114">It does not call **QueryAccept** after the first format change.</span></span> <span data-ttu-id="7fae7-115">Nachdem der upstreamfilter das neue Format akzeptiert hat, muss es in der Lage sein, hin und her zu wechseln.</span><span class="sxs-lookup"><span data-stu-id="7fae7-115">Once the upstream filter has accepted the new format, it must be able to switch back and forth.</span></span>

<span data-ttu-id="7fae7-116">Der upstreamfilter kann die Formatänderung ablehnen, indem er \_ von **queryaccept** den Wert "false" zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="7fae7-116">The upstream filter can reject the format change by returning S\_FALSE from **QueryAccept**.</span></span> <span data-ttu-id="7fae7-117">In diesem Fall verwendet der Videorenderer weiterhin GDI im ursprünglichen Format.</span><span class="sxs-lookup"><span data-stu-id="7fae7-117">In that case, the Video Renderer continues to use GDI with the original format.</span></span>

<span data-ttu-id="7fae7-118">**Filter für Video Mischungs Renderer**</span><span class="sxs-lookup"><span data-stu-id="7fae7-118">**Video Mixing Renderer Filter**</span></span>

<span data-ttu-id="7fae7-119">Der Filter für den videomischungs-Renderer (VMR-7 und VMR-9) stellt eine Verbindung mit einem beliebigen Format her, das von der Grafikhardware des Systems unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="7fae7-119">The Video Mixing Renderer filter (VMR-7 and VMR-9) will connect with any format that is supported by the graphics hardware on the system.</span></span> <span data-ttu-id="7fae7-120">VMR-7 verwendet immer DirectDraw zum Rendern und ordnet die zugrunde liegenden DirectDraw-Oberflächen zu, wenn der upstreamfilter eine Verbindung herstellt.</span><span class="sxs-lookup"><span data-stu-id="7fae7-120">The VMR-7 always uses DirectDraw for rendering, and allocates the underlying DirectDraw surfaces when the upstream filter connects.</span></span> <span data-ttu-id="7fae7-121">VMR-9 verwendet immer Direct3D zum Rendern und ordnet die zugrunde liegenden Direct3D-Oberflächen zu, wenn der upstreamfilter eine Verbindung herstellt.</span><span class="sxs-lookup"><span data-stu-id="7fae7-121">The VMR-9 always uses Direct3D for rendering, and allocates the underlying Direct3D surfaces when the upstream filter connects.</span></span>

<span data-ttu-id="7fae7-122">Die Grafikhardware erfordert möglicherweise eine größere Angriffsfläche als die Breite des Bilds.</span><span class="sxs-lookup"><span data-stu-id="7fae7-122">The graphics hardware may require a larger surface stride than the image width.</span></span> <span data-ttu-id="7fae7-123">In diesem Fall fordert VMR ein neues Format durch Aufrufen von **queryaccept** an.</span><span class="sxs-lookup"><span data-stu-id="7fae7-123">In that case, the VMR requests a new format by calling **QueryAccept**.</span></span> <span data-ttu-id="7fae7-124">Er meldet den Oberflächen Schritt im **biwidth** -Member von [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) im Videoformat.</span><span class="sxs-lookup"><span data-stu-id="7fae7-124">It reports the surface stride in the **biWidth** member of the [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) in the video format.</span></span> <span data-ttu-id="7fae7-125">Wenn der upstreamfilter nicht S \_ OK aus **queryaccept** zurückgibt, lehnt VMR das Format ab und versucht, eine Verbindung herzustellen, indem das nächste vom upstreamfilter angekündigte Format verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="7fae7-125">If the upstream filter does not return S\_OK from **QueryAccept**, the VMR rejects the format and tries to connect using the next format advertised by the upstream filter.</span></span> <span data-ttu-id="7fae7-126">Der VMR fügt den Medientyp mit dem neuen Format an das erste Medien Beispiel an.</span><span class="sxs-lookup"><span data-stu-id="7fae7-126">The VMR attaches the media type with the new format to the first media sample.</span></span> <span data-ttu-id="7fae7-127">Nach dem ersten Beispiel bleibt das Format konstant. bei der Ausführung des Diagramms werden die Formate von VMR nicht gewechselt.</span><span class="sxs-lookup"><span data-stu-id="7fae7-127">After the first sample, the format remains constant; the VMR will not switch formats while the graph is running.</span></span>

<span data-ttu-id="7fae7-128">**Verbessertes Video Rendering (EVR)**</span><span class="sxs-lookup"><span data-stu-id="7fae7-128">**Enhanced Video Render (EVR)**</span></span>

<span data-ttu-id="7fae7-129">Der EVR verwendet immer Direct3D für das Rendering.</span><span class="sxs-lookup"><span data-stu-id="7fae7-129">The EVR always uses Direct3D for rendering.</span></span> <span data-ttu-id="7fae7-130">Wenn ein größerer Oberflächen Schritt erforderlich ist, verwendet der EVR denselben **queryaccept** -Mechanismus wie VMR.</span><span class="sxs-lookup"><span data-stu-id="7fae7-130">If a larger surface stride is needed, the EVR uses the same **QueryAccept** mechanism as the VMR.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7fae7-131">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="7fae7-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7fae7-132">Queryaccept (Upstream)</span><span class="sxs-lookup"><span data-stu-id="7fae7-132">QueryAccept (Upstream)</span></span>](queryaccept--upstream.md)
</dt> </dl>

 

 



