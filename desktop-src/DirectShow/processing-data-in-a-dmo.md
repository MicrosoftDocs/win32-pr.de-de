---
description: Verarbeiten von Daten in einem DMO
ms.assetid: 715482d9-23f4-40d0-9c09-7a81e148c543
title: Verarbeiten von Daten in einem DMO
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea9f5d5d820dc1467c25f9d411d46a9c66935e8b
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "103860320"
---
# <a name="processing-data-in-a-dmo"></a><span data-ttu-id="f4d7f-103">Verarbeiten von Daten in einem DMO</span><span class="sxs-lookup"><span data-stu-id="f4d7f-103">Processing Data in a DMO</span></span>

<span data-ttu-id="f4d7f-104">In diesem Abschnitt wird erläutert, wie ein Datenstrom mithilfe eines DMO verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-104">This section explains how to process a stream of data using a DMO.</span></span> <span data-ttu-id="f4d7f-105">Die in diesem Abschnitt aufgeführten Schritte sind das Standardverhalten. Alle DMOS müssen die hier beschriebenen Methoden unterstützen.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-105">The steps listed in this section are the default behavior; all DMOs must support the methods described here.</span></span> <span data-ttu-id="f4d7f-106">Diese Methoden verwenden separate Puffer für die Eingabe und die Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-106">These methods use separate buffers for input and output.</span></span> <span data-ttu-id="f4d7f-107">Einige DMOS unterstützen auch die direkte Verarbeitung mithilfe eines einzelnen Puffers.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-107">Some DMOs also support in-place processing, using a single buffer.</span></span> <span data-ttu-id="f4d7f-108">Weitere Informationen zur direkten Verarbeitung finden Sie unter direkte [Verarbeitung](in-place-processing.md).</span><span class="sxs-lookup"><span data-stu-id="f4d7f-108">For more information about in-place processing, see [In-Place Processing](in-place-processing.md).</span></span>

<span data-ttu-id="f4d7f-109">**Puffer werden zugewiesen.**</span><span class="sxs-lookup"><span data-stu-id="f4d7f-109">**Allocating Buffers**</span></span>

<span data-ttu-id="f4d7f-110">Der Client ist für die gesamte Puffer Zuordnung verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-110">The client is responsible for all buffer allocation.</span></span> <span data-ttu-id="f4d7f-111">Nachdem Sie die Medientypen im DMO festgelegt haben, Fragen Sie den DMO nach den Puffer Anforderungen jedes Streams ab.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-111">After you set the media types on the DMO, query the DMO for each stream's buffer requirements.</span></span> <span data-ttu-id="f4d7f-112">Diese können je nach Medientyp geändert werden.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-112">These can change depending on the media type.</span></span> <span data-ttu-id="f4d7f-113">Für jeden Stream wird die [**imediaobject:: getinputsizeinfo**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputsizeinfo) -Methode oder die [**imediaobject:: getoutputsizeinfo**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputsizeinfo) -Methode aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-113">For each stream, call the [**IMediaObject::GetInputSizeInfo**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputsizeinfo) or [**IMediaObject::GetOutputSizeInfo**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputsizeinfo) method.</span></span> <span data-ttu-id="f4d7f-114">Diese Methoden geben die folgenden Informationen zurück:</span><span class="sxs-lookup"><span data-stu-id="f4d7f-114">These methods return the following information:</span></span>

-   <span data-ttu-id="f4d7f-115">Minimale Puffergröße in Bytes.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-115">Minimum buffer size, in bytes.</span></span>
-   <span data-ttu-id="f4d7f-116">Ausrichtungs Anforderungen, falls vorhanden.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-116">Alignment requirements, if any.</span></span> <span data-ttu-id="f4d7f-117">Ein Puffer wird ausgerichtet, wenn die Startadresse ein Vielfaches einer angegebenen ganzen Zahl ist.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-117">A buffer is aligned if the start address is a multiple of some specified integer.</span></span>
-   <span data-ttu-id="f4d7f-118">Die maximale Datenmenge, die das DMO für Lookahead hält.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-118">The maximum amount of data the DMO will hold for lookahead.</span></span> <span data-ttu-id="f4d7f-119">Diese Zahl gilt nur für Eingabestreams.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-119">This number applies only to input streams.</span></span> <span data-ttu-id="f4d7f-120">Für einige Arten von Daten (z. b. MPEG-Codierung) muss ein DMO möglicherweise im Stream nach vorn suchen.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-120">For some kinds of data (for example, MPEG encoding), a DMO might need to look forward in the stream.</span></span> <span data-ttu-id="f4d7f-121">Der lookaheadwert gibt an, wie viele Eingabedaten der DMO benötigt, bevor eine Ausgabe erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-121">The lookahead value indicates how much input data the DMO will require before it can produce output.</span></span>

<span data-ttu-id="f4d7f-122">Der Client muss Puffer zuordnen, die diesen Anforderungen entsprechen.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-122">The client must allocate buffers that match these requirements.</span></span> <span data-ttu-id="f4d7f-123">Darüber hinaus kann der DMO Anforderungen darüber haben, wie der Client die Eingabedaten verpackt.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-123">In addition, the DMO might have requirements about how the client packages the input data.</span></span> <span data-ttu-id="f4d7f-124">Der DMO könnte z. b. erfordern, dass jeder Puffer genau ein Beispiel (oder einen Video Frame) enthält.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-124">For example, the DMO might require each buffer to contain exactly one sample (or video frame).</span></span> <span data-ttu-id="f4d7f-125">Um diese Anforderungen zu ermitteln, müssen Sie die [**imediaobject:: getinputstreaminfo**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputstreaminfo) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-125">To determine these requirements, call the [**IMediaObject::GetInputStreamInfo**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputstreaminfo) method.</span></span> <span data-ttu-id="f4d7f-126">Die [**imediaobject:: getoutputstreaminfo**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputstreaminfo) -Methode gibt ähnliche Informationen über einen Ausgabestream zurück.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-126">The [**IMediaObject::GetOutputStreamInfo**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputstreaminfo) method returns similar information about an output stream.</span></span>

<span data-ttu-id="f4d7f-127">Im standardstreamingmodell übergibt der Client keine rohpuffer Zeiger an den DMO.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-127">In the default streaming model, the client does not pass raw buffer pointers to the DMO.</span></span> <span data-ttu-id="f4d7f-128">Stattdessen wird ein Lightweight com-Objekt verwendet, das die [**imediabuffer**](/previous-versions/windows/desktop/api/Mediaobj/nn-mediaobj-imediabuffer) -Schnittstelle verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-128">Instead, it uses a lightweight COM object that exposes the [**IMediaBuffer**](/previous-versions/windows/desktop/api/Mediaobj/nn-mediaobj-imediabuffer) interface.</span></span> <span data-ttu-id="f4d7f-129">Die **imediabuffer** -Schnittstelle fungiert als COM-Wrapper für einen Speicherblock.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-129">The **IMediaBuffer** interface acts as a COM wrapper for a block of memory.</span></span> <span data-ttu-id="f4d7f-130">Da es sich um ein COM-Objekt handelt, wird die Verweis Zählung unterstützt, wodurch sichergestellt wird, dass Puffer nicht freigegeben werden, während Sie noch verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-130">Because it is a COM object, it supports reference counting, which helps to ensure that buffers are not released while still in use.</span></span>

> [!Note]  
> <span data-ttu-id="f4d7f-131">Die **imediabuffer** -Schnittstelle stellt eine Funktion ähnlich der **imediasample** -Schnittstelle in DirectShow dar.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-131">The **IMediaBuffer** interface serves a function similar to the **IMediaSample** interface in DirectShow.</span></span>

 

<span data-ttu-id="f4d7f-132">Der Client muss das **imediabuffer** -Objekt implementieren.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-132">The client must implement the **IMediaBuffer** object.</span></span> <span data-ttu-id="f4d7f-133">Weitere Informationen finden Sie unter [Implementieren von imediabuffer](implementing-imediabuffer.md).</span><span class="sxs-lookup"><span data-stu-id="f4d7f-133">For more information, see [Implementing IMediaBuffer](implementing-imediabuffer.md).</span></span>

<span data-ttu-id="f4d7f-134">**Verarbeiten der Daten**</span><span class="sxs-lookup"><span data-stu-id="f4d7f-134">**Processing the Data**</span></span>

<span data-ttu-id="f4d7f-135">Gehen Sie zum Verarbeiten von Daten wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="f4d7f-135">To process data, do the following:</span></span>

1.  <span data-ttu-id="f4d7f-136">Füllen Sie für jeden Eingabedaten Strom einen Puffer mit Eingabedaten aus.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-136">For each input stream, fill a buffer with input data.</span></span>
2.  <span data-ttu-id="f4d7f-137">Aufrufen von [**imediaobject::P rocessinput**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-processinput) , um jeden Puffer zu übermitteln.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-137">Call [**IMediaObject::ProcessInput**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-processinput) to deliver each buffer.</span></span>
3.  <span data-ttu-id="f4d7f-138">Nennen Sie [**imediaobject::P rocess Output**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-processoutput) , um die Daten zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-138">Call [**IMediaObject::ProcessOutput**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-processoutput) to process the data.</span></span> <span data-ttu-id="f4d7f-139">Diese Methode nimmt für jeden Ausgabestream ein Array von Puffern an.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-139">This method takes an array of buffers, one for each output stream.</span></span>
4.  <span data-ttu-id="f4d7f-140">Wiederholen Sie den Vorgang, bis keine weiteren Eingabedaten vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-140">Repeat until there is no more input data.</span></span>

<span data-ttu-id="f4d7f-141">Die **ProcessInput** -Methode akzeptiert Eingaben für einen Stream gleichzeitig.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-141">The **ProcessInput** method accepts input for one stream at a time.</span></span> <span data-ttu-id="f4d7f-142">In der Regel gibt die Methode sofort zurück, und der DMO enthält einen Verweis Zähler für das **imediabuffer** -Objekt.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-142">Typically the method returns immediately, and the DMO holds a reference count on the **IMediaBuffer** object.</span></span> <span data-ttu-id="f4d7f-143">Das Objekt wird freigegeben, nachdem alle Daten im Puffer verarbeitet wurden, oder wenn die Anwendung den DMO leert.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-143">It releases the object after it processes all of the data in the buffer, or when the application flushes the DMO.</span></span> <span data-ttu-id="f4d7f-144">Verwenden Sie den Puffer erst wieder, wenn er vom DMO freigegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-144">Do not re-use a buffer until the DMO has released it.</span></span> <span data-ttu-id="f4d7f-145">Um zu ermitteln, ob ein Eingabedaten Strom mehr Daten akzeptieren kann, müssen Sie die [**imediaobject:: getinputstatus**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputstatus) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-145">To determine whether an input stream can accept more data, call the [**IMediaObject::GetInputStatus**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputstatus) method.</span></span> <span data-ttu-id="f4d7f-146">Diese Methode gibt das DMO- \_ Eingabe- \_ statusf \_ Accept Data-Flag zurück, \_ Wenn der Stream mehr Eingaben akzeptieren kann.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-146">This method returns the DMO\_INPUT\_STATUSF\_ACCEPT\_DATA flag if the stream can accept more input.</span></span>

<span data-ttu-id="f4d7f-147">Die **ProcessOutput** -Methode generiert die Ausgabe für alle Ausgabedaten Ströme gleichzeitig.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-147">The **ProcessOutput** method generates output for all of the output streams at once.</span></span> <span data-ttu-id="f4d7f-148">Die Anwendung übergibt ein Array von [**DMO- \_ Ausgabe \_ Daten \_ Puffer**](/previous-versions/windows/desktop/api/Mediaobj/ns-mediaobj-dmo_output_data_buffer) Strukturen, eines für jeden Ausgabestream.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-148">The application passes in an array of [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/Mediaobj/ns-mediaobj-dmo_output_data_buffer) structures, one for each output stream.</span></span> <span data-ttu-id="f4d7f-149">Jede Struktur im Array verfügt über einen Zeiger auf ein **imediabuffer** -Objekt.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-149">Each structure in the array has a pointer to an **IMediaBuffer** object.</span></span> <span data-ttu-id="f4d7f-150">Der DMO schreibt so viele Ausgabedaten wie möglich in die Puffer.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-150">The DMO writes as much output data as it can into the buffers.</span></span> <span data-ttu-id="f4d7f-151">Außerdem werden verschiedene Flags festgelegt, um den Status des Vorgangs zu melden.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-151">It also sets various flags to report the status of the operation.</span></span> <span data-ttu-id="f4d7f-152">Das Flag DMO- \_ ausgabedatenbufferf \_ \_ \_ unvollständig gibt an, dass der DMO eine höhere Ausgabe der vorhandenen Eingabe verursachen kann.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-152">The DMO\_OUTPUT\_DATA\_BUFFERF\_INCOMPLETE flag indicates the DMO can produce more output from the existing input.</span></span> <span data-ttu-id="f4d7f-153">In diesem Fall kann der Client **ProcessOutput** erneut aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-153">In that case, the client can call **ProcessOutput** again.</span></span> <span data-ttu-id="f4d7f-154">Andernfalls sollte **ProcessInput** mit weiteren Eingabedaten aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-154">Otherwise, it should call **ProcessInput** with more input data.</span></span> <span data-ttu-id="f4d7f-155">Der DMO ändert die Daten in den Eingabe Puffern nie. Er schreibt nur in die Ausgabepuffer.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-155">The DMO never modifies the data in the input buffers; it writes only to the output buffers.</span></span>

<span data-ttu-id="f4d7f-156">Nachdem Sie alle Daten in einen Eingabestream übermittelt haben, können Sie die [**imediaobject::D iscontinuity**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-discontinuity) -Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-156">After you have delivered all of the data to an input stream, call the [**IMediaObject::Discontinuity**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-discontinuity) method.</span></span> <span data-ttu-id="f4d7f-157">Der DMO akzeptiert keine weiteren Eingaben für diesen Stream, bis Sie die verbleibende Ausgabe verarbeiten (oder den DMO leeren).</span><span class="sxs-lookup"><span data-stu-id="f4d7f-157">The DMO does not accept further input to that stream until you process the remaining output (or flush the DMO).</span></span>

<span data-ttu-id="f4d7f-158">Zu jedem Zeitpunkt nach dem Start des Streamings kann der DMO Eingaben empfangen oder eine Ausgabe oder beides liefern.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-158">At any point after streaming begins, the DMO is able to receive input or produce output, or both.</span></span> <span data-ttu-id="f4d7f-159">Daher gibt entweder **getinputstatus** die DMO- \_ Eingabe \_ statusf \_ Accept-Daten zurück \_ , oder **ProcessOutput** gibt die DMO- \_ Ausgabedaten- \_ \_ bufferf \_ unvollständig zurück.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-159">Therefore, either **GetInputStatus** returns DMO\_INPUT\_STATUSF\_ACCEPT\_DATA, or **ProcessOutput** returns DMO\_OUTPUT\_DATA\_BUFFERF\_INCOMPLETE.</span></span> <span data-ttu-id="f4d7f-160">Die Anwendung speichert Datenfluss, indem Sie diese Flags testet und **ProcessInput** oder **ProcessOutput** entsprechend anfordert.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-160">The application keeps data flowing by testing for these flags and calling **ProcessInput** or **ProcessOutput** accordingly.</span></span> <span data-ttu-id="f4d7f-161">Um den Datenfluss zu unterbrechen, müssen Sie die [**imediaobject:: Flush**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-flush) -Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-161">To interrupt the data flow, call the [**IMediaObject::Flush**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-flush) method.</span></span> <span data-ttu-id="f4d7f-162">Diese Methode bewirkt, dass der DMO alle Puffer, die er intern hält, verwirft.</span><span class="sxs-lookup"><span data-stu-id="f4d7f-162">This method causes the DMO to discard any buffers it is holding internally.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f4d7f-163">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="f4d7f-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f4d7f-164">Direktes Hosting eines DMO</span><span class="sxs-lookup"><span data-stu-id="f4d7f-164">Directly Hosting a DMO</span></span>](directly-hosting-a-dmo.md)
</dt> <dt>

[<span data-ttu-id="f4d7f-165">Direkte Verarbeitung</span><span class="sxs-lookup"><span data-stu-id="f4d7f-165">In-Place Processing</span></span>](in-place-processing.md)
</dt> </dl>

 

 



