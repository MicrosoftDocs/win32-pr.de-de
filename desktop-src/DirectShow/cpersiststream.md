---
description: Cpersiststream ist die Basisklasse für persistente Eigenschaften von Filtern (d. h. Filtereigenschaften in gespeicherten Diagrammen).
ms.assetid: 8073e2be-aaf9-4b01-a7d5-bab5c1dcc19b
title: Cpersiststream-Klasse
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- CPersistStream
api_type:
- COM
api_location: ''
ms.openlocfilehash: 690a0f45fab7c3612d215a859798460abc81728e
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "104520784"
---
# <a name="cpersiststream-class"></a><span data-ttu-id="4ff5a-103">Cpersiststream-Klasse</span><span class="sxs-lookup"><span data-stu-id="4ff5a-103">CPersistStream class</span></span>

![cpersiststream-Klassenhierarchie](images/pstrm01.png)

<span data-ttu-id="4ff5a-105">`CPersistStream` ist die Basisklasse für persistente Eigenschaften von Filtern (d. h. Filtereigenschaften in gespeicherten Diagrammen).</span><span class="sxs-lookup"><span data-stu-id="4ff5a-105">`CPersistStream` is the base class for persistent properties of filters (that is, filter properties in saved graphs).</span></span>

<span data-ttu-id="4ff5a-106">Die einfachste Möglichkeit zur Verwendung `CPersistStream` von ist:</span><span class="sxs-lookup"><span data-stu-id="4ff5a-106">The simplest way to use `CPersistStream` is to:</span></span>

1.  <span data-ttu-id="4ff5a-107">Ordnen Sie den Filter an, um diese Klasse zu erben.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-107">Arrange for your filter to inherit this class.</span></span>
2.  <span data-ttu-id="4ff5a-108">Implementieren Sie " [**Write-to-Stream**](cpersiststream-writetostream.md) " und "read [**FromStream**](cpersiststream-readfromstream.md) " in ihrer Klasse.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-108">Implement [**WriteToStream**](cpersiststream-writetostream.md) and [**ReadFromStream**](cpersiststream-readfromstream.md) in your class.</span></span> <span data-ttu-id="4ff5a-109">Diese Funktionen überschreiben hier die Funktionen, die nur als Platzhalter fungieren.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-109">These will override the functions here, which do nothing but act as placeholders.</span></span>
3.  <span data-ttu-id="4ff5a-110">Ändern Sie die **nondelegatingqueryinterface** so, dass **IPersistStream** verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-110">Change your **NonDelegatingQueryInterface** to handle **IPersistStream**.</span></span>
4.  <span data-ttu-id="4ff5a-111">Implementieren Sie [**sizemax**](cpersiststream-sizemax.md) , um eine obere Grenze für die Anzahl der Daten Bytes zurückzugeben, die Sie speichern.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-111">Implement [**SizeMax**](cpersiststream-sizemax.md) to return an upper bound on the number of bytes of data you save.</span></span>

    <span data-ttu-id="4ff5a-112">Wenn Sie Unicode-™ Daten speichern, denken Sie daran, dass es sich bei WCHAR um 2 Bytes handelt.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-112">If you save Unicode™ data, remember that a WCHAR is 2 bytes.</span></span>

5.  <span data-ttu-id="4ff5a-113">Wenn sich die Daten ändern, müssen Sie [**SetDirty**](cpersiststream-setdirty.md)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-113">When your data changes, call [**SetDirty**](cpersiststream-setdirty.md).</span></span>

## <a name="version-numbers"></a><span data-ttu-id="4ff5a-114">Versionsnummern</span><span class="sxs-lookup"><span data-stu-id="4ff5a-114">Version Numbers</span></span>

<span data-ttu-id="4ff5a-115">An einem bestimmten Punkt können Sie sich entscheiden, das Format der Daten zu ändern oder zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-115">At some point you might decide to alter or extend the format of your data.</span></span> <span data-ttu-id="4ff5a-116">Sie haben dann die Möglichkeit, eine Versionsnummer in allen alten gespeicherten Streams zu haben, damit Sie feststellen können, ob Sie das alte oder neue Formular darstellen.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-116">You will then wish you had a version number in all the old saved streams so you can tell, when you read them, whether they represent the old or new form.</span></span> <span data-ttu-id="4ff5a-117">Zur Unterstützung dieser Klasse wird eine Versionsnummer geschrieben und gelesen.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-117">To assist you, this class writes and reads a version number.</span></span> <span data-ttu-id="4ff5a-118">Beim Schreiben wird [**getsoftwareversion**](cpersiststream-getsoftwareversion.md) aufgerufen, um die Version der derzeit verwendeten Software zu übermitteln.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-118">When it writes, it calls [**GetSoftwareVersion**](cpersiststream-getsoftwareversion.md) to inquire as to the version of the software being used at the moment.</span></span> <span data-ttu-id="4ff5a-119">(Dies ist tatsächlich eine Versionsnummer des Daten Layouts in der Datei.) Dies wird als erstes in den Daten geschrieben.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-119">(In effect, this is a version number of the data layout in the file.) It writes this as the first thing in the data.</span></span> <span data-ttu-id="4ff5a-120">Wenn Sie die Version ändern möchten, implementieren Sie " **getsoftwareversion**" (außer Kraft setzen).</span><span class="sxs-lookup"><span data-stu-id="4ff5a-120">If you want to change the version, implement (override) **GetSoftwareVersion**.</span></span> <span data-ttu-id="4ff5a-121">Vor dem Aufrufen von [**readfromstream**](cpersiststream-readfromstream.md)liest Sie die Versionsnummer aus der Datei in **mPS \_ dwfileversion** , sodass Sie in **readfromstream** die **MPS \_ dwfileversion** überprüfen können, um festzustellen, ob Sie eine alte Versionsdatei lesen.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-121">It reads the version number from the file into **mPS\_dwFileVersion** before calling [**ReadFromStream**](cpersiststream-readfromstream.md), so in **ReadFromStream** you can check **mPS\_dwFileVersion** to see if you are reading an old version file.</span></span> <span data-ttu-id="4ff5a-122">Normalerweise sollten Sie Dateien akzeptieren, deren Version nicht neuer ist als die Softwareversion, die Sie liest.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-122">Usually you should accept files whose version is no newer than the software version that is reading them.</span></span>

<span data-ttu-id="4ff5a-123">**Cpersiststream** implementiert [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span><span class="sxs-lookup"><span data-stu-id="4ff5a-123">**CPersistStream** implements [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span></span> <span data-ttu-id="4ff5a-124">Weitere Implementierungs Informationen finden Sie in der com-Referenz im Microsoft Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-124">For more implementation information, see the COM Reference in the Microsoft Platform SDK.</span></span>



| <span data-ttu-id="4ff5a-125">Geschützte Datenmember</span><span class="sxs-lookup"><span data-stu-id="4ff5a-125">Protected Data Members</span></span>                                          | <span data-ttu-id="4ff5a-126">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="4ff5a-126">Description</span></span>                                                                   |
|-----------------------------------------------------------------|-------------------------------------------------------------------------------|
| <span data-ttu-id="4ff5a-127">mPS \_ dwfileversion</span><span class="sxs-lookup"><span data-stu-id="4ff5a-127">mPS\_dwFileVersion</span></span>                                              | <span data-ttu-id="4ff5a-128">Versionsnummer der Datei.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-128">Version number of the file.</span></span>                                                   |
| <span data-ttu-id="4ff5a-129">mPS-fehlerhaft \_</span><span class="sxs-lookup"><span data-stu-id="4ff5a-129">mPS\_fDirty</span></span>                                                     | <span data-ttu-id="4ff5a-130">Die Daten für diesen Stream müssen gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-130">Data for this stream must be saved.</span></span>                                           |
| <span data-ttu-id="4ff5a-131">Elementfunktionen</span><span class="sxs-lookup"><span data-stu-id="4ff5a-131">Member Functions</span></span>                                                | <span data-ttu-id="4ff5a-132">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="4ff5a-132">Description</span></span>                                                                   |
| [<span data-ttu-id="4ff5a-133">**Cpersiststream**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-133">**CPersistStream**</span></span>](cpersiststream-cpersiststream.md)         | <span data-ttu-id="4ff5a-134">Erstellt ein **cpersiststream** -Objekt.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-134">Constructs a **CPersistStream** object.</span></span>                                       |
| [<span data-ttu-id="4ff5a-135">**SetDirty**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-135">**SetDirty**</span></span>](cpersiststream-setdirty.md)                     | <span data-ttu-id="4ff5a-136">Gibt an, dass das Objekt im Stream gespeichert werden muss.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-136">Indicates that the object must be saved to the stream.</span></span>                        |
| <span data-ttu-id="4ff5a-137">Über schreibbare Member-Funktionen</span><span class="sxs-lookup"><span data-stu-id="4ff5a-137">Overridable Member Functions</span></span>                                    | <span data-ttu-id="4ff5a-138">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="4ff5a-138">Description</span></span>                                                                   |
| [<span data-ttu-id="4ff5a-139">**GetClassID**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-139">**GetClassID**</span></span>](cpersiststream-getclassid.md)                 | <span data-ttu-id="4ff5a-140">Ruft den Klassen Bezeichner dieses Streams ab.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-140">Retrieves the class identifier of this stream.</span></span>                                |
| [<span data-ttu-id="4ff5a-141">**Getsoftwareversion**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-141">**GetSoftwareVersion**</span></span>](cpersiststream-getsoftwareversion.md) | <span data-ttu-id="4ff5a-142">Ruft die Versionsnummer für dieses Dateiformat ab.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-142">Retrieves the version number for this file format.</span></span>                            |
| [<span data-ttu-id="4ff5a-143">**"Read FromStream"**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-143">**ReadFromStream**</span></span>](cpersiststream-readfromstream.md)         | <span data-ttu-id="4ff5a-144">Liest die Filterdaten aus dem Datenstrom.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-144">Reads the filter's data from the stream.</span></span>                                      |
| [<span data-ttu-id="4ff5a-145">**Sizemax**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-145">**SizeMax**</span></span>](cpersiststream-sizemax.md)                       | <span data-ttu-id="4ff5a-146">Ruft die Anzahl der Bytes ab, die für Daten benötigt werden (nicht einschließlich der Versionsnummer).</span><span class="sxs-lookup"><span data-stu-id="4ff5a-146">Retrieves the number of bytes needed for data (not including version number).</span></span> |
| [<span data-ttu-id="4ff5a-147">**Schreiben von Datenstrom**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-147">**WriteToStream**</span></span>](cpersiststream-writetostream.md)           | <span data-ttu-id="4ff5a-148">Schreibt die Filterdaten in den Stream.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-148">Writes the filter's data to the stream.</span></span>                                       |
| <span data-ttu-id="4ff5a-149">IPersistStream-Methoden</span><span class="sxs-lookup"><span data-stu-id="4ff5a-149">IPersistStream Methods</span></span>                                          | <span data-ttu-id="4ff5a-150">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="4ff5a-150">Description</span></span>                                                                   |
| [<span data-ttu-id="4ff5a-151">**GetSizeMax**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-151">**GetSizeMax**</span></span>](cpersiststream-getsizemax.md)                 | <span data-ttu-id="4ff5a-152">Ruft die Anzahl der Bytes ab, die für Daten benötigt werden (einschließlich der Versionsnummer).</span><span class="sxs-lookup"><span data-stu-id="4ff5a-152">Retrieves the number of bytes needed for data (including version number).</span></span>     |
| [<span data-ttu-id="4ff5a-153">**IsDirty**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-153">**IsDirty**</span></span>](cpersiststream-isdirty.md)                       | <span data-ttu-id="4ff5a-154">Überprüft, ob das Objekt gespeichert werden muss.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-154">Checks if the object must be saved.</span></span>                                           |
| [<span data-ttu-id="4ff5a-155">**Laden**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-155">**Load**</span></span>](cpersiststream-load.md)                             | <span data-ttu-id="4ff5a-156">Lädt die Daten aus dem Stream in den Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-156">Loads the data from the stream into memory.</span></span>                                   |
| [<span data-ttu-id="4ff5a-157">**Speichern**</span><span class="sxs-lookup"><span data-stu-id="4ff5a-157">**Save**</span></span>](cpersiststream-save.md)                             | <span data-ttu-id="4ff5a-158">Speichert die Daten aus dem Arbeitsspeicher in den Stream.</span><span class="sxs-lookup"><span data-stu-id="4ff5a-158">Saves the data from memory to the stream.</span></span>                                     |



 

 

 
