---
description: Implementieren Sie Unterstützung für die Medientypaushandlung als Teil des Schreibens eines Transformationsfilters. Der Medientyp beschreibt das Format der Daten.
ms.assetid: b2b5dafc-d38d-4ec3-a390-55229495b4f9
title: 'Schritt 3: Medientypaushandlung unterstützen'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3a23784e70330f751325fc5f780463d5a3904d20
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/19/2021
ms.locfileid: "112410043"
---
# <a name="step-3-support-media-type-negotiation"></a><span data-ttu-id="ad74a-105">Schritt 3:</span><span class="sxs-lookup"><span data-stu-id="ad74a-105">Step 3.</span></span> <span data-ttu-id="ad74a-106">Medientypaushandlung unterstützen</span><span class="sxs-lookup"><span data-stu-id="ad74a-106">Support Media Type Negotiation</span></span>

<span data-ttu-id="ad74a-107">Dies ist Schritt 3 des Tutorials [Schreiben von Transformationsfiltern](writing-transform-filters.md).</span><span class="sxs-lookup"><span data-stu-id="ad74a-107">This is step 3 of the tutorial [Writing Transform Filters](writing-transform-filters.md).</span></span>

<span data-ttu-id="ad74a-108">Wenn zwei Stecknadeln verbunden sind, müssen sie sich auf einen Medientyp für die Verbindung einigen.</span><span class="sxs-lookup"><span data-stu-id="ad74a-108">When two pins connect, they must agree on a media type for the connection.</span></span> <span data-ttu-id="ad74a-109">Der Medientyp beschreibt das Format der Daten.</span><span class="sxs-lookup"><span data-stu-id="ad74a-109">The media type describes the format of the data.</span></span> <span data-ttu-id="ad74a-110">Ohne den Medientyp kann ein Filter eine Art von Daten liefern, nur um einen anderen Filter als etwas anderes behandeln zu lassen.</span><span class="sxs-lookup"><span data-stu-id="ad74a-110">Without the media type, a filter might deliver one kind of data, only to have another filter treat it as something else.</span></span>

<span data-ttu-id="ad74a-111">Der grundlegende Mechanismus zum Aushandeln von Medientypen ist die [**IPin::ReceiveConnection-Methode.**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection)</span><span class="sxs-lookup"><span data-stu-id="ad74a-111">The basic mechanism for negotiating media types is the [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) method.</span></span> <span data-ttu-id="ad74a-112">Der Ausgabepin ruft diese Methode auf dem Eingabepin mit einem vorgeschlagenen Medientyp auf.</span><span class="sxs-lookup"><span data-stu-id="ad74a-112">The output pin calls this method on the input pin with a proposed media type.</span></span> <span data-ttu-id="ad74a-113">Der Eingabepin akzeptiert die Verbindung oder lehnt sie ab.</span><span class="sxs-lookup"><span data-stu-id="ad74a-113">The input pin accepts the connection or rejects it.</span></span> <span data-ttu-id="ad74a-114">Wenn die Verbindung abgelehnt wird, kann der Ausgabepin einen anderen Medientyp ausprobieren.</span><span class="sxs-lookup"><span data-stu-id="ad74a-114">If it rejects the connection, the output pin can try another media type.</span></span> <span data-ttu-id="ad74a-115">Wenn keine geeigneten Typen gefunden werden, schlägt die Verbindung fehl.</span><span class="sxs-lookup"><span data-stu-id="ad74a-115">If no suitable types are found, the connection fails.</span></span> <span data-ttu-id="ad74a-116">Optional kann der Eingabepin über die [**IPin::EnumMediaTypes-Methode**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) eine Liste der bevorzugten Typen anordnen.</span><span class="sxs-lookup"><span data-stu-id="ad74a-116">Optionally, the input pin can advertise a list of types that it prefers, through the [**IPin::EnumMediaTypes**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) method.</span></span> <span data-ttu-id="ad74a-117">Der Ausgabepin kann diese Liste verwenden, wenn medientypen vorgeschlagen werden, obwohl dies nicht der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="ad74a-117">The output pin can use this list when it proposes media types, although it does not have to.</span></span>

<span data-ttu-id="ad74a-118">Die **CTransformFilter-Klasse** implementiert wie folgt ein allgemeines Framework für diesen Prozess:</span><span class="sxs-lookup"><span data-stu-id="ad74a-118">The **CTransformFilter** class implements a general framework for this process, as follows:</span></span>

-   <span data-ttu-id="ad74a-119">Der Eingabepin hat keine bevorzugten Medientypen.</span><span class="sxs-lookup"><span data-stu-id="ad74a-119">The input pin has no preferred media types.</span></span> <span data-ttu-id="ad74a-120">Es basiert vollständig auf dem Upstreamfilter, um den Medientyp vorzuschlagen.</span><span class="sxs-lookup"><span data-stu-id="ad74a-120">It relies entirely on the upstream filter to propose the media type.</span></span> <span data-ttu-id="ad74a-121">Für Videodaten ist dies sinnvoll, da der Medientyp die Bildgröße und die Bildfrequenz enthält.</span><span class="sxs-lookup"><span data-stu-id="ad74a-121">For video data, this makes sense, because the media type includes the image size and the frame rate.</span></span> <span data-ttu-id="ad74a-122">In der Regel müssen diese Informationen von einem Upstreamquellenfilter oder Parserfilter bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="ad74a-122">Typically, that information must be supplied by an upstream source filter or parser filter.</span></span> <span data-ttu-id="ad74a-123">Im Fall von Audiodaten ist der Satz möglicher Formate kleiner, daher kann es für den Eingabepin praktisch sein, einige bevorzugte Typen zu bieten.</span><span class="sxs-lookup"><span data-stu-id="ad74a-123">In the case of audio data, the set of possible formats is smaller, so it may be practical for the input pin to offer some preferred types.</span></span> <span data-ttu-id="ad74a-124">Überschreiben Sie in diesem Fall [**CBasePin::GetMediaType**](cbasepin-getmediatype.md) für den Eingabepin.</span><span class="sxs-lookup"><span data-stu-id="ad74a-124">In that case, override [**CBasePin::GetMediaType**](cbasepin-getmediatype.md) on the input pin.</span></span>
-   <span data-ttu-id="ad74a-125">Wenn der Upstreamfilter einen Medientyp vorschlägt, ruft der Eingabepin die [**CTransformFilter::CheckInputType-Methode**](ctransformfilter-checkinputtype.md) auf, die den Typ akzeptiert oder ablehnt.</span><span class="sxs-lookup"><span data-stu-id="ad74a-125">When the upstream filter proposes a media type, the input pin calls the [**CTransformFilter::CheckInputType**](ctransformfilter-checkinputtype.md) method, which accepts or rejects the type.</span></span>
-   <span data-ttu-id="ad74a-126">Der Ausgabepin wird nur verbunden, wenn der Eingabepin zuerst verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="ad74a-126">The output pin will not connect unless the input pin is connected first.</span></span> <span data-ttu-id="ad74a-127">Dieses Verhalten ist typisch für Transformationsfilter.</span><span class="sxs-lookup"><span data-stu-id="ad74a-127">This behavior is typical for transform filters.</span></span> <span data-ttu-id="ad74a-128">In den meisten Fällen muss der Filter den Eingabetyp bestimmen, bevor er den Ausgabetyp festlegen kann.</span><span class="sxs-lookup"><span data-stu-id="ad74a-128">In most cases, the filter must determine the input type before it can set the output type.</span></span>
-   <span data-ttu-id="ad74a-129">Wenn der Ausgabepin eine Verbindung hergestellt hat, verfügt er über eine Liste von Medientypen, die er dem Downstreamfilter vorschlägt.</span><span class="sxs-lookup"><span data-stu-id="ad74a-129">When the output pin does connect, it has a list of media types that it proposes to the downstream filter.</span></span> <span data-ttu-id="ad74a-130">Sie ruft die [**CTransformFilter::GetMediaType-Methode**](ctransformfilter-getmediatype.md) auf, um diese Liste zu generieren.</span><span class="sxs-lookup"><span data-stu-id="ad74a-130">It calls the [**CTransformFilter::GetMediaType**](ctransformfilter-getmediatype.md) method to generate this list.</span></span> <span data-ttu-id="ad74a-131">Der Ausgabepin versucht auch alle Medientypen, die vom Downstreamfilter vorgeschlagen werden.</span><span class="sxs-lookup"><span data-stu-id="ad74a-131">The output pin will also try any media types that the downstream filter proposes.</span></span>
-   <span data-ttu-id="ad74a-132">Um zu überprüfen, ob ein bestimmter Ausgabetyp mit dem Eingabetyp kompatibel ist, ruft der Ausgabepin die [**CTransformFilter::CheckTransform-Methode**](ctransformfilter-checktransform.md) auf.</span><span class="sxs-lookup"><span data-stu-id="ad74a-132">To check whether a particular output type is compatible with the input type, the output pin calls the [**CTransformFilter::CheckTransform**](ctransformfilter-checktransform.md) method.</span></span>

<span data-ttu-id="ad74a-133">Die drei **zuvor aufgeführten CTransformFilter-Methoden** sind reine virtuelle Methoden, sodass Ihre abgeleitete Klasse sie implementieren muss.</span><span class="sxs-lookup"><span data-stu-id="ad74a-133">The three **CTransformFilter** methods listed previously are pure virtual methods, so your derived class must implement them.</span></span> <span data-ttu-id="ad74a-134">Keine dieser Methoden gehört zu einer COM-Schnittstelle. sie sind einfach Teil der Implementierung, die von den Basisklassen bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ad74a-134">None of these methods belongs to a COM interface; they are simply part of the implementation provided by the base classes.</span></span>

<span data-ttu-id="ad74a-135">In den folgenden Abschnitten wird jede Methode ausführlicher beschrieben:</span><span class="sxs-lookup"><span data-stu-id="ad74a-135">The following sections describe each method in more detail:</span></span>

-   [<span data-ttu-id="ad74a-136">Schritt 3A. Implementieren der CheckInputType-Methode</span><span class="sxs-lookup"><span data-stu-id="ad74a-136">Step 3A. Implement the CheckInputType Method</span></span>](step-3a--implement-the-checkinputtype-method.md)
-   [<span data-ttu-id="ad74a-137">Schritt 3B. Implementieren der GetMediaType-Methode</span><span class="sxs-lookup"><span data-stu-id="ad74a-137">Step 3B. Implement the GetMediaType Method</span></span>](step-3b--implement-the-getmediatype-method.md)
-   [<span data-ttu-id="ad74a-138">Schritt 3C. Implementieren der CheckTransform-Methode</span><span class="sxs-lookup"><span data-stu-id="ad74a-138">Step 3C. Implement the CheckTransform Method</span></span>](step-3c--implement-the-checktransform-method.md)

## <a name="related-topics"></a><span data-ttu-id="ad74a-139">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ad74a-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ad74a-140">Herstellen einer Verbindung mit Filtern</span><span class="sxs-lookup"><span data-stu-id="ad74a-140">How Filters Connect</span></span>](how-filters-connect.md)
</dt> <dt>

[<span data-ttu-id="ad74a-141">Schreiben von DirectShow-Filtern</span><span class="sxs-lookup"><span data-stu-id="ad74a-141">Writing DirectShow Filters</span></span>](writing-directshow-filters.md)
</dt> </dl>

 

 



