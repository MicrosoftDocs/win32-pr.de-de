---
description: 'Schritt 3:'
ms.assetid: b2b5dafc-d38d-4ec3-a390-55229495b4f9
title: 'Schritt 3: Unterstützung der Medientyp Aushandlung'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: eb3ff8539d0d7de2c9b7300ddb90ad86ca471710
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/03/2021
ms.locfileid: "103869508"
---
# <a name="step-3-support-media-type-negotiation"></a><span data-ttu-id="ead40-104">Schritt 3:</span><span class="sxs-lookup"><span data-stu-id="ead40-104">Step 3.</span></span> <span data-ttu-id="ead40-105">Unterstützung der Medientyp Aushandlung</span><span class="sxs-lookup"><span data-stu-id="ead40-105">Support Media Type Negotiation</span></span>

<span data-ttu-id="ead40-106">Dies ist Schritt 3 des Tutorials zum [Schreiben von Transformations Filtern](writing-transform-filters.md).</span><span class="sxs-lookup"><span data-stu-id="ead40-106">This is step 3 of the tutorial [Writing Transform Filters](writing-transform-filters.md).</span></span>

<span data-ttu-id="ead40-107">Wenn zwei Pins eine Verbindung herstellen, müssen Sie einem Medientyp für die Verbindung zustimmen.</span><span class="sxs-lookup"><span data-stu-id="ead40-107">When two pins connect, they must agree on a media type for the connection.</span></span> <span data-ttu-id="ead40-108">Der Medientyp beschreibt das Format der Daten.</span><span class="sxs-lookup"><span data-stu-id="ead40-108">The media type describes the format of the data.</span></span> <span data-ttu-id="ead40-109">Ohne den Medientyp stellt ein Filter möglicherweise eine Art von Daten bereit, sodass er nur von einem anderen Filter als etwas anderes behandelt werden kann.</span><span class="sxs-lookup"><span data-stu-id="ead40-109">Without the media type, a filter might deliver one kind of data, only to have another filter treat it as something else.</span></span>

<span data-ttu-id="ead40-110">Der grundlegende Mechanismus für das Aushandeln von Medientypen ist die [**IPin:: receiveconnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) -Methode.</span><span class="sxs-lookup"><span data-stu-id="ead40-110">The basic mechanism for negotiating media types is the [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) method.</span></span> <span data-ttu-id="ead40-111">Die Ausgabe-PIN ruft diese Methode für die Eingabe-PIN mit einem vorgeschlagenen Medientyp auf.</span><span class="sxs-lookup"><span data-stu-id="ead40-111">The output pin calls this method on the input pin with a proposed media type.</span></span> <span data-ttu-id="ead40-112">Die Eingabe-PIN akzeptiert die Verbindung oder lehnt sie ab.</span><span class="sxs-lookup"><span data-stu-id="ead40-112">The input pin accepts the connection or rejects it.</span></span> <span data-ttu-id="ead40-113">Wenn die Verbindung abgelehnt wird, kann die Ausgabe-PIN einen anderen Medientyp ausprobieren.</span><span class="sxs-lookup"><span data-stu-id="ead40-113">If it rejects the connection, the output pin can try another media type.</span></span> <span data-ttu-id="ead40-114">Wenn keine geeigneten Typen gefunden werden, tritt bei der Verbindung ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="ead40-114">If no suitable types are found, the connection fails.</span></span> <span data-ttu-id="ead40-115">Optional kann die Eingabe-PIN über die [**IPin:: enummediatypes**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) -Methode eine Liste der von ihr bevorzugten Typen ankündigen.</span><span class="sxs-lookup"><span data-stu-id="ead40-115">Optionally, the input pin can advertise a list of types that it prefers, through the [**IPin::EnumMediaTypes**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) method.</span></span> <span data-ttu-id="ead40-116">Die Ausgabepin kann diese Liste verwenden, wenn Sie Medientypen vorschlägt, obwohl dies nicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="ead40-116">The output pin can use this list when it proposes media types, although it does not have to.</span></span>

<span data-ttu-id="ead40-117">Die **ctransformfilter** -Klasse implementiert wie folgt ein allgemeines Framework für diesen Prozess:</span><span class="sxs-lookup"><span data-stu-id="ead40-117">The **CTransformFilter** class implements a general framework for this process, as follows:</span></span>

-   <span data-ttu-id="ead40-118">Die eingabepin weist keine bevorzugten Medientypen auf.</span><span class="sxs-lookup"><span data-stu-id="ead40-118">The input pin has no preferred media types.</span></span> <span data-ttu-id="ead40-119">Er basiert ausschließlich auf dem Upstream-Filter, um den Medientyp vorzuschlagen.</span><span class="sxs-lookup"><span data-stu-id="ead40-119">It relies entirely on the upstream filter to propose the media type.</span></span> <span data-ttu-id="ead40-120">Für Videodaten ist dies sinnvoll, da der Medientyp die Bildgröße und die Framerate enthält.</span><span class="sxs-lookup"><span data-stu-id="ead40-120">For video data, this makes sense, because the media type includes the image size and the frame rate.</span></span> <span data-ttu-id="ead40-121">Normalerweise müssen diese Informationen von einem Upstream-Quell Filter oder Parserfilter bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="ead40-121">Typically, that information must be supplied by an upstream source filter or parser filter.</span></span> <span data-ttu-id="ead40-122">Im Fall von Audiodaten ist der Satz möglicher Formate kleiner, sodass es für die Eingabe-PIN möglicherweise sinnvoll ist, einige bevorzugte Typen anzubieten.</span><span class="sxs-lookup"><span data-stu-id="ead40-122">In the case of audio data, the set of possible formats is smaller, so it may be practical for the input pin to offer some preferred types.</span></span> <span data-ttu-id="ead40-123">Überschreiben Sie in diesem Fall [**cbasepin:: getmediatype**](cbasepin-getmediatype.md) in der Eingabe-PIN.</span><span class="sxs-lookup"><span data-stu-id="ead40-123">In that case, override [**CBasePin::GetMediaType**](cbasepin-getmediatype.md) on the input pin.</span></span>
-   <span data-ttu-id="ead40-124">Wenn der upstreamfilter einen Medientyp vorschlägt, ruft die Eingabe-PIN die [**ctransformfilter:: checkinputtype**](ctransformfilter-checkinputtype.md) -Methode auf, die den Typ akzeptiert oder ablehnt.</span><span class="sxs-lookup"><span data-stu-id="ead40-124">When the upstream filter proposes a media type, the input pin calls the [**CTransformFilter::CheckInputType**](ctransformfilter-checkinputtype.md) method, which accepts or rejects the type.</span></span>
-   <span data-ttu-id="ead40-125">Die Ausgabe-PIN wird nur dann verbunden, wenn die Eingabe-PIN zuerst verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="ead40-125">The output pin will not connect unless the input pin is connected first.</span></span> <span data-ttu-id="ead40-126">Dieses Verhalten ist für Transformations Filter typisch.</span><span class="sxs-lookup"><span data-stu-id="ead40-126">This behavior is typical for transform filters.</span></span> <span data-ttu-id="ead40-127">In den meisten Fällen muss der Filter den Eingabetyp bestimmen, bevor der Ausgabetyp festgelegt werden kann.</span><span class="sxs-lookup"><span data-stu-id="ead40-127">In most cases, the filter must determine the input type before it can set the output type.</span></span>
-   <span data-ttu-id="ead40-128">Wenn die Ausgabe-PIN eine Verbindung herstellt, enthält Sie eine Liste der Medientypen, die Sie dem downstreamfilter vorschlägt.</span><span class="sxs-lookup"><span data-stu-id="ead40-128">When the output pin does connect, it has a list of media types that it proposes to the downstream filter.</span></span> <span data-ttu-id="ead40-129">Sie ruft die [**ctransformfilter:: getmediatype**](ctransformfilter-getmediatype.md) -Methode auf, um diese Liste zu generieren.</span><span class="sxs-lookup"><span data-stu-id="ead40-129">It calls the [**CTransformFilter::GetMediaType**](ctransformfilter-getmediatype.md) method to generate this list.</span></span> <span data-ttu-id="ead40-130">Mit der Ausgabe-PIN werden auch alle Medientypen ausprobiert, die vom downstreamfilter vorgeschlagen werden.</span><span class="sxs-lookup"><span data-stu-id="ead40-130">The output pin will also try any media types that the downstream filter proposes.</span></span>
-   <span data-ttu-id="ead40-131">Um zu überprüfen, ob ein bestimmter Ausgabetyp mit dem Eingabetyp kompatibel ist, ruft die Ausgabe-PIN die [**ctransformfilter:: checktransform**](ctransformfilter-checktransform.md) -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="ead40-131">To check whether a particular output type is compatible with the input type, the output pin calls the [**CTransformFilter::CheckTransform**](ctransformfilter-checktransform.md) method.</span></span>

<span data-ttu-id="ead40-132">Die drei oben aufgeführten **ctransformfilter** -Methoden sind reine virtuelle Methoden, sodass Sie von ihrer abgeleiteten Klasse implementiert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="ead40-132">The three **CTransformFilter** methods listed previously are pure virtual methods, so your derived class must implement them.</span></span> <span data-ttu-id="ead40-133">Keine dieser Methoden gehört zu einer COM-Schnittstelle. Sie sind einfach Teil der Implementierung, die von den Basisklassen bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ead40-133">None of these methods belongs to a COM interface; they are simply part of the implementation provided by the base classes.</span></span>

<span data-ttu-id="ead40-134">In den folgenden Abschnitten werden die einzelnen Methoden ausführlicher beschrieben:</span><span class="sxs-lookup"><span data-stu-id="ead40-134">The following sections describe each method in more detail:</span></span>

-   [<span data-ttu-id="ead40-135">Schritt 3a. Implementieren der checkinputtype-Methode</span><span class="sxs-lookup"><span data-stu-id="ead40-135">Step 3A. Implement the CheckInputType Method</span></span>](step-3a--implement-the-checkinputtype-method.md)
-   [<span data-ttu-id="ead40-136">Schritt 3B. Implementieren der getmediatype-Methode</span><span class="sxs-lookup"><span data-stu-id="ead40-136">Step 3B. Implement the GetMediaType Method</span></span>](step-3b--implement-the-getmediatype-method.md)
-   [<span data-ttu-id="ead40-137">Schritt 3C: Implementieren der checktransform-Methode</span><span class="sxs-lookup"><span data-stu-id="ead40-137">Step 3C. Implement the CheckTransform Method</span></span>](step-3c--implement-the-checktransform-method.md)

## <a name="related-topics"></a><span data-ttu-id="ead40-138">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ead40-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ead40-139">Herstellen der Verbindung von Filtern</span><span class="sxs-lookup"><span data-stu-id="ead40-139">How Filters Connect</span></span>](how-filters-connect.md)
</dt> <dt>

[<span data-ttu-id="ead40-140">Schreiben von DirectShow-Filtern</span><span class="sxs-lookup"><span data-stu-id="ead40-140">Writing DirectShow Filters</span></span>](writing-directshow-filters.md)
</dt> </dl>

 

 



