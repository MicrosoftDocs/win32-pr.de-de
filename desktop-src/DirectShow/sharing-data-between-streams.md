---
description: Freigeben von Daten zwischen Streams
ms.assetid: e18eecf8-9475-420a-9a60-4b1b5f8fd43a
title: Freigeben von Daten zwischen Streams
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee0b2f53fe1952bbc16711f7c7e39c3182ba94a7
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "104481974"
---
# <a name="sharing-data-between-streams"></a><span data-ttu-id="e2bc0-103">Freigeben von Daten zwischen Streams</span><span class="sxs-lookup"><span data-stu-id="e2bc0-103">Sharing Data Between Streams</span></span>

> [!Note]  
> <span data-ttu-id="e2bc0-104">Diese APIs sind veraltet.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-104">These APIs are deprecated.</span></span> <span data-ttu-id="e2bc0-105">Anwendungen sollten den [**Beispiel-Grabber**](sample-grabber-filter.md) Filter verwenden oder einen benutzerdefinierten Filter implementieren, um Daten aus einem DirectShow-Filter Diagramm zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-105">Applications should use the [**Sample Grabber**](sample-grabber-filter.md) filter or implement a custom filter to get data from a DirectShow filter graph.</span></span>

 

<span data-ttu-id="e2bc0-106">Die Verarbeitung von Multimedia-Daten erfordert in der Regel sehr viele Systemressourcen. Daher sollten Sie möglichst vermeiden, Daten zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-106">Processing multimedia data typically requires a great deal of system resources; therefore, you should avoid copying data whenever possible.</span></span> <span data-ttu-id="e2bc0-107">Die streamingarchitektur unterstützt freigegebene streambeispiele, einen Mechanismus, der Daten aus einem Stream in einen anderen verschiebt, ohne ihn zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-107">The streaming architecture supports shared stream samples, a mechanism that moves data from one stream to another without copying it.</span></span> <span data-ttu-id="e2bc0-108">Dieser Puffer ermöglicht den effizienten Datentransport zwischen zwei Datenströmen, auch wenn der Zielstream das zugrunde liegende Datenformat nicht explizit unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-108">This buffer enables the efficient transportation of data between two streams even if the destination stream doesn't specifically support the underlying data format.</span></span>

<span data-ttu-id="e2bc0-109">Nehmen Sie beispielsweise an, dass Sie über einen Multimedia-Stream mit drei Datenströmen verfügen: Video und Audiodaten und URL-Daten mit Zeitstempel, um den Videoinhalten zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-109">For example, assume that you have a multimedia stream with three data streams: video and audio, and URL data time-stamped to match the video content.</span></span> <span data-ttu-id="e2bc0-110">Sie möchten eine Anwendung schreiben, die für jeden Videoframe einen Copyright Hinweis hinzufügt und die Daten für den Speicher in einen anderen Stream schreibt, aber die Anwendung versteht keine Datenformate außer dem Videostream.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-110">You want to write an application that adds a copyright notice on every video frame and writes the data to another stream for storage, but your application doesn't understand any data formats except the video stream.</span></span> <span data-ttu-id="e2bc0-111">Für den Videostream erstellen Sie ein Beispiel, das an die gewünschte DirectDraw-Oberfläche angefügt ist.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-111">For the video stream, you create a sample attached to the desired DirectDraw surface.</span></span> <span data-ttu-id="e2bc0-112">Sie können dann einen Ausgabestream erstellen, indem Sie entweder die [**idirectdrawmediastream:: createsample**](/previous-versions/windows/desktop/api/ddstream/nf-ddstream-idirectdrawmediastream-createsample) -Methode mit diesem Zeiger auf dieselbe Oberfläche oder [**imediastream:: createsharedsample**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-createsharedsample)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-112">You can then create an output stream by calling either the [**IDirectDrawMediaStream::CreateSample**](/previous-versions/windows/desktop/api/ddstream/nf-ddstream-idirectdrawmediastream-createsample) method with that pointer to the same surface, or [**IMediaStream::CreateSharedSample**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-createsharedsample).</span></span> <span data-ttu-id="e2bc0-113">In beiden Fällen verwenden die Eingabe-und Ausgabestreams die DirectDraw-Oberfläche.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-113">In both cases, the input and output streams share the DirectDraw surface.</span></span> <span data-ttu-id="e2bc0-114">Da Sie das Videoformat verstanden haben, können Sie nach Bedarf auf diese Oberfläche zugreifen.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-114">Because you understand the video format, you can access this surface as needed.</span></span>

<span data-ttu-id="e2bc0-115">Zum Abrufen der anderen quellstreamzeiger (Audiodatei und URL) zählen Sie den quellcontainerstream auf und rufen Zeiger auf die nicht-Videostreams auf.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-115">To retrieve the other source stream pointers (audio and URL), enumerate the source container stream and grab pointers to the nonvideo streams.</span></span> <span data-ttu-id="e2bc0-116">Jedem dieser Quelldaten Ströme ist ein Ausgabedatenstrom im Ausgabedatenstrom Container zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-116">Each of these source streams has an associated output stream in the output stream container.</span></span> <span data-ttu-id="e2bc0-117">Rufen Sie diese Ausgabe Zeiger ab, indem Sie die [**imultimediastream:: getmediastream**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-getmediastream) -Methode für den Ausgabe Container mit jedem der Quelldaten Strom Zeiger aufrufen.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-117">Retrieve these output pointers by calling the [**IMultiMediaStream::GetMediaStream**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-getmediastream) method on the output container with each of the source stream pointers.</span></span> <span data-ttu-id="e2bc0-118">Dieser Vorgang wird in den folgenden Schritten beschrieben.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-118">The following steps describe this process.</span></span>

1.  <span data-ttu-id="e2bc0-119">Rufen Sie [**imultimediastream:: enummediastreams**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-enummediastreams) auf, um einen Zeiger auf einen Quelldaten Strom abzurufen.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-119">Call [**IMultiMediaStream::EnumMediaStreams**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-enummediastreams) to retrieve a pointer to a source stream.</span></span> <span data-ttu-id="e2bc0-120">Stellen Sie sicher, dass es sich nicht um den Videostream handelt, da Ihre Anwendung das Format bereits versteht.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-120">Make sure that it's not the video stream, because your application already understands its format.</span></span>
2.  <span data-ttu-id="e2bc0-121">Aufrufen von [**imultimediastream:: getmediastream**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-getmediastream) für den Ausgabe Container-Stream mit dem Zeiger aus Schritt 1.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-121">Call [**IMultiMediaStream::GetMediaStream**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-getmediastream) on the output container stream with the pointer from step 1.</span></span> <span data-ttu-id="e2bc0-122">Dadurch wird ein Zeiger auf den gewünschten Ausgabestream zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-122">This returns a pointer to the desired output stream.</span></span>
3.  <span data-ttu-id="e2bc0-123">Für den Quellstream wird "" [**zugeordnet**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-allocatesample) .</span><span class="sxs-lookup"><span data-stu-id="e2bc0-123">Call [**AllocateSample**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-allocatesample) on the source stream.</span></span>
4.  <span data-ttu-id="e2bc0-124">Aufrufen von " [**kreatesharedsample**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-createsharedsample) " für den Ausgabestream.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-124">Call [**CreateSharedSample**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-createsharedsample) on the output stream.</span></span>
5.  <span data-ttu-id="e2bc0-125">Ruft [**Update**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-istreamsample-update) für den Quellstream auf, um die Daten zu lesen.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-125">Call [**Update**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-istreamsample-update) on the source stream to read the data.</span></span>
6.  <span data-ttu-id="e2bc0-126">Ruft [**Update**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-istreamsample-update) für den Ausgabestream auf, um die Daten zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-126">Call [**Update**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-istreamsample-update) on the output stream to write the data.</span></span>

<span data-ttu-id="e2bc0-127">Wiederholen Sie diese Schritte für jeden Stream, dessen Format Sie nicht unterstützen.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-127">Repeat these steps for each stream whose format you don't support.</span></span> <span data-ttu-id="e2bc0-128">Wenn die Aktualisierung beider Beispiele abgeschlossen ist, enthält der Ausgabestream alle Daten aus dem Quelldaten Strom, und Sie sind fertig.</span><span class="sxs-lookup"><span data-stu-id="e2bc0-128">When both samples finish updating, the output stream has all data from the source stream and you are done.</span></span>

 

 



