---
description: Bereitstellung von Beispielen
ms.assetid: 31aabb6d-dec6-41fa-b24d-35a77b67bc4a
title: Bereitstellung von Beispielen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 083bc8c88649c04bdf9f93f86ebcc277ee48e75e
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "104392897"
---
# <a name="delivering-samples"></a><span data-ttu-id="7d43e-103">Bereitstellung von Beispielen</span><span class="sxs-lookup"><span data-stu-id="7d43e-103">Delivering Samples</span></span>

<span data-ttu-id="7d43e-104">In diesem Artikel wird beschrieben, wie ein Filter eine Stichprobe liefert.</span><span class="sxs-lookup"><span data-stu-id="7d43e-104">This article describes how a filter delivers a sample.</span></span> <span data-ttu-id="7d43e-105">Sie beschreibt sowohl das Push-Modell als auch die [**IMemInputPin**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin) -Methoden und das Pull-Modell mithilfe von [**iasynkreader**](/windows/desktop/api/Strmif/nn-strmif-iasyncreader).</span><span class="sxs-lookup"><span data-stu-id="7d43e-105">It describes both the push model, using [**IMemInputPin**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin) methods, and the pull model, using [**IAsyncReader**](/windows/desktop/api/Strmif/nn-strmif-iasyncreader).</span></span>

<span data-ttu-id="7d43e-106">**Pushmodell: Bereitstellung eines Beispiels**</span><span class="sxs-lookup"><span data-stu-id="7d43e-106">**Push Model: Delivering a Sample**</span></span>

<span data-ttu-id="7d43e-107">Die Ausgabe-PIN liefert ein Beispiel, indem die [**IMemInputPin:: Receive**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receive) -Methode oder die [**IMemInputPin:: receivemultiple**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receivemultiple) -Methode aufgerufen wird, die gleichwertig ist, aber ein Array von Beispielen liefert.</span><span class="sxs-lookup"><span data-stu-id="7d43e-107">The output pin delivers a sample by calling the [**IMemInputPin::Receive**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receive) method or the [**IMemInputPin::ReceiveMultiple**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receivemultiple) method, which is equivalent but delivers an array of samples.</span></span> <span data-ttu-id="7d43e-108">Die Eingabe-PIN kann innerhalb von **Receive** (oder **receivemultiple**) blockiert werden.</span><span class="sxs-lookup"><span data-stu-id="7d43e-108">The input pin can block inside **Receive** (or **ReceiveMultiple**).</span></span> <span data-ttu-id="7d43e-109">Wenn die PIN blockiert werden kann, sollte die [**IMemInputPin:: receivecanblock**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receivecanblock) -Methode S OK zurückgeben \_ .</span><span class="sxs-lookup"><span data-stu-id="7d43e-109">If the pin might block, its [**IMemInputPin::ReceiveCanBlock**](/windows/desktop/api/Strmif/nf-strmif-imeminputpin-receivecanblock) method should return S\_OK.</span></span> <span data-ttu-id="7d43e-110">Wenn die PIN garantiert, dass nie blockiert wird, sollte **receivecanblock** den Wert S false zurückgeben \_ .</span><span class="sxs-lookup"><span data-stu-id="7d43e-110">If the pin guarantees never to block, **ReceiveCanBlock** should return S\_FALSE.</span></span> <span data-ttu-id="7d43e-111">Der \_ Rückgabewert S OK bedeutet nicht, dass **Receive** immer blockiert, genau dass dies möglich ist.</span><span class="sxs-lookup"><span data-stu-id="7d43e-111">The S\_OK return value does not mean that **Receive** always blocks, just that it might.</span></span>

<span data-ttu-id="7d43e-112">Obwohl **Receive** die Möglichkeit blockieren kann, auf die Verfügbarkeit einer Ressource zu warten, sollte nicht blockiert werden, um auf weitere Daten aus dem upstreamfilter zu warten.</span><span class="sxs-lookup"><span data-stu-id="7d43e-112">Although **Receive** can block to wait for a resource to become available, it should not block to wait for more data from the upstream filter.</span></span> <span data-ttu-id="7d43e-113">Dies kann zu einem Deadlock führen, bei dem der Upstream-Filter darauf wartet, dass der downstreamfilter das Beispiel freigibt. Dies geschieht nie, weil der Downstream-Filter auf den upstreamfilter wartet.</span><span class="sxs-lookup"><span data-stu-id="7d43e-113">Doing so can cause a deadlock where the upstream filter waits for the downstream filter to release the sample, which never happens because the downstream filter is waiting on the upstream filter.</span></span> <span data-ttu-id="7d43e-114">Wenn ein Filter über mehrere Eingabe Pins verfügt, kann eine PIN jedoch auf den Empfang von Daten durch eine andere Pin warten.</span><span class="sxs-lookup"><span data-stu-id="7d43e-114">If a filter has multiple input pins, however, one pin can wait for another pin to receive data.</span></span> <span data-ttu-id="7d43e-115">Der [AVI MUX](avi-mux-filter.md) -Filter führt dies z. b. so aus, dass er Audio-und Videodaten interhinterlegen kann.</span><span class="sxs-lookup"><span data-stu-id="7d43e-115">For example, the [AVI Mux](avi-mux-filter.md) filter does this so that it can interleave audio and video data.</span></span>

<span data-ttu-id="7d43e-116">Eine PIN könnte eine Stichprobe aus mehreren Gründen ablehnen:</span><span class="sxs-lookup"><span data-stu-id="7d43e-116">A pin might reject a sample for a number of reasons:</span></span>

-   <span data-ttu-id="7d43e-117">Die PIN wird geleert [(siehe leeren](flushing.md)).</span><span class="sxs-lookup"><span data-stu-id="7d43e-117">The pin is flushing (see [Flushing](flushing.md)).</span></span>
-   <span data-ttu-id="7d43e-118">Die PIN ist nicht verbunden.</span><span class="sxs-lookup"><span data-stu-id="7d43e-118">The pin is not connected.</span></span>
-   <span data-ttu-id="7d43e-119">Der Filter wurde beendet.</span><span class="sxs-lookup"><span data-stu-id="7d43e-119">The filter is stopped.</span></span>
-   <span data-ttu-id="7d43e-120">Ein anderer Fehler ist aufgetreten.</span><span class="sxs-lookup"><span data-stu-id="7d43e-120">Some other error occurred.</span></span>

<span data-ttu-id="7d43e-121">Die **Receive** -Methode sollte \_ im ersten Fall S false und in anderen Fällen einen Fehlercode zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="7d43e-121">The **Receive** method should return S\_FALSE in the first case, and a failure code in the other cases.</span></span> <span data-ttu-id="7d43e-122">Der upstreamfilter sollte das Senden von Beispielen beenden, wenn der Rückgabecode etwas anderes als S \_ OK ist.</span><span class="sxs-lookup"><span data-stu-id="7d43e-122">The upstream filter should stop sending samples when the return code is anything other than S\_OK.</span></span>

<span data-ttu-id="7d43e-123">Die ersten drei Fälle können als "erwartete" Fehler angesehen werden, in dem Sinne, dass sich der Filter im falschen Zustand befunden hat, um Beispiele zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="7d43e-123">You can consider the first three cases to be "expected" failures, in the sense that the filter was in the wrong state to receive samples.</span></span> <span data-ttu-id="7d43e-124">Ein unerwarteter Fehler ist eine, die bewirkt, dass die PIN eine Stichprobe ablehnt, auch wenn sich die PIN in einem empfangenden Zustand befindet.</span><span class="sxs-lookup"><span data-stu-id="7d43e-124">An unexpected failure would be one that causes the pin to reject a sample even though the pin is in a receiving state.</span></span> <span data-ttu-id="7d43e-125">Wenn ein Fehler dieses Typs auftritt, sollte die PIN eine downstreambenachrichtigung senden und ein [**EC \_ errorabort**](ec-errorabort.md) -Ereignis an den Filter Graph-Manager senden.</span><span class="sxs-lookup"><span data-stu-id="7d43e-125">If an error of this type occurs, the pin should send an end-of-stream notification downstream, and send an [**EC\_ERRORABORT**](ec-errorabort.md) event to the Filter Graph Manager.</span></span>

<span data-ttu-id="7d43e-126">In den DirectShow-Basisklassen überprüft die [**cbaseinputpin:: checkstreaming**](cbaseinputpin-checkstreaming.md) -Methode die allgemeinen Fehlerfälle – leeren, beendeten usw.</span><span class="sxs-lookup"><span data-stu-id="7d43e-126">In the DirectShow base classes, the [**CBaseInputPin::CheckStreaming**](cbaseinputpin-checkstreaming.md) method checks for the general failure cases—flushing, stopped, and so forth.</span></span> <span data-ttu-id="7d43e-127">Die abgeleitete Klasse muss auf Fehler prüfen, die für den Filter spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="7d43e-127">The derived class will need to check for failures that are specific to the filter.</span></span> <span data-ttu-id="7d43e-128">Wenn ein Fehler auftritt, sendet die [**cbaseinputpin:: Receive**](cbaseinputpin-receive.md) -Methode die datenstreambenachrichtigung und das EC \_ errorabort-Ereignis.</span><span class="sxs-lookup"><span data-stu-id="7d43e-128">In case of an error, the [**CBaseInputPin::Receive**](cbaseinputpin-receive.md) method sends the end-of-stream notification and the EC\_ERRORABORT event.</span></span>

<span data-ttu-id="7d43e-129">**Pull-Modell: Anfordern einer Stichprobe**</span><span class="sxs-lookup"><span data-stu-id="7d43e-129">**Pull Model: Requesting a Sample**</span></span>

<span data-ttu-id="7d43e-130">In der **iasyncreader** -Schnittstelle fordert die Eingabe-PIN Stichproben aus der Ausgabe-PIN an, indem eine der folgenden Methoden aufgerufen wird:</span><span class="sxs-lookup"><span data-stu-id="7d43e-130">In the **IAsyncReader** interface, the input pin requests samples from the output pin by calling one of the following methods:</span></span>

-   [<span data-ttu-id="7d43e-131">**Iasynkreader:: Request**</span><span class="sxs-lookup"><span data-stu-id="7d43e-131">**IAsyncReader::Request**</span></span>](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-request)
-   [<span data-ttu-id="7d43e-132">**Iasynkreader:: synkread**</span><span class="sxs-lookup"><span data-stu-id="7d43e-132">**IAsyncReader::SyncRead**</span></span>](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-syncread)
-   [<span data-ttu-id="7d43e-133">**Iasynkreader:: synkreadausgerichteten**</span><span class="sxs-lookup"><span data-stu-id="7d43e-133">**IAsyncReader::SyncReadAligned**</span></span>](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-syncreadaligned)

<span data-ttu-id="7d43e-134">Die **Anforderungs** Methode ist asynchron. die Eingabe-PIN ruft [**iasynkreader:: waitfornext**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-waitfornext) auf, um auf den Abschluss der Anforderung zu warten.</span><span class="sxs-lookup"><span data-stu-id="7d43e-134">The **Request** method is asynchronous; the input pin calls [**IAsyncReader::WaitForNext**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-waitfornext) to wait for the request to complete.</span></span> <span data-ttu-id="7d43e-135">Die anderen beiden Methoden sind synchron.</span><span class="sxs-lookup"><span data-stu-id="7d43e-135">The other two methods are synchronous.</span></span>

<span data-ttu-id="7d43e-136">**Bereitstellung von Daten**</span><span class="sxs-lookup"><span data-stu-id="7d43e-136">**When to Deliver Data**</span></span>

<span data-ttu-id="7d43e-137">Ein Filter liefert immer Beispiele, während er sich im Status wird ausgeführt befindet.</span><span class="sxs-lookup"><span data-stu-id="7d43e-137">A filter always delivers samples while it is in the running state.</span></span> <span data-ttu-id="7d43e-138">In den meisten Fällen werden bei angehaltenen Filtern auch Beispiele angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7d43e-138">In most cases, a filter also delivers samples while paused.</span></span> <span data-ttu-id="7d43e-139">Dies ermöglicht es dem Diagramm, die Daten zu überprüfen, sodass die Wiedergabe sofort beim Aufrufen von **Run** gestartet wird (siehe [Filter Zustände](filter-states.md)).</span><span class="sxs-lookup"><span data-stu-id="7d43e-139">This enables the graph to cue up the data so that playback starts immediately when **Run** is called (see [Filter States](filter-states.md)).</span></span> <span data-ttu-id="7d43e-140">Wenn der Filter keine Daten bereitstellt, während Sie angehalten werden, sollte die **imediafilter:: GetState** -Methode des Filters den VFW s-Fehler \_ im \_ \_ angehaltenen Zustand zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="7d43e-140">If your filter does not deliver data while paused, the filter's **IMediaFilter::GetState** method should return VFW\_S\_CANT\_CUE in the paused state.</span></span> <span data-ttu-id="7d43e-141">Dieser Rückgabecode signalisiert dem Filter Diagramm, nicht auf Daten aus dem Filter zu warten, bevor der Pausen Übergang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="7d43e-141">This return code signals the filter graph not to wait for data from your filter before it completes the pause transition.</span></span> <span data-ttu-id="7d43e-142">Andernfalls wird die **Pause** -Methode unbegrenzt blockiert.</span><span class="sxs-lookup"><span data-stu-id="7d43e-142">Otherwise, the **Pause** method will block indefinitely.</span></span> <span data-ttu-id="7d43e-143">Beispielcode finden Sie unter [**cbasefilter:: GetState**](cbasefilter-getstate.md).</span><span class="sxs-lookup"><span data-stu-id="7d43e-143">For example code, see [**CBaseFilter::GetState**](cbasefilter-getstate.md).</span></span>

<span data-ttu-id="7d43e-144">Im folgenden finden Sie einige Beispiele für den Fall, dass ein Filter möglicherweise einen VFW-nicht-Hinweis zurückgibt \_ \_ \_ :</span><span class="sxs-lookup"><span data-stu-id="7d43e-144">Here are some examples of when a filter might need to return VFW\_S\_CANT\_CUE:</span></span>

-   <span data-ttu-id="7d43e-145">Live Quellen, z. b. Erfassungs Filter, sollten keine Daten senden, während Sie angehalten werden.</span><span class="sxs-lookup"><span data-stu-id="7d43e-145">Live sources, such as capture filters, should not send data while paused.</span></span> <span data-ttu-id="7d43e-146">Siehe [Erstellen von Daten in einem Erfassungs Filter](producing-data-in-a-capture-filter.md).</span><span class="sxs-lookup"><span data-stu-id="7d43e-146">See [Producing Data in a Capture Filter](producing-data-in-a-capture-filter.md).</span></span>
-   <span data-ttu-id="7d43e-147">Abhängig von der Implementierung kann es vorkommen, dass ein Splitter Filterdaten an die Warteschlange sendet.</span><span class="sxs-lookup"><span data-stu-id="7d43e-147">A splitter filter might or might not send data while paused, depending on the implementation.</span></span> <span data-ttu-id="7d43e-148">Wenn der Filter separate Threads verwendet, um Daten für jede Ausgabepin in die Warteschlange zu stellen, kann er Daten senden, während Sie angehalten werden</span><span class="sxs-lookup"><span data-stu-id="7d43e-148">If the filter uses separate threads to queue data on each output pin, then it can send data while paused.</span></span> <span data-ttu-id="7d43e-149">Wenn der Filter jedoch einen einzelnen Thread für jede Ausgabepin verwendet, blockiert die erste Pin den Thread, wenn er **Receive** aufruft, wodurch verhindert wird, dass die anderen Pins Daten senden.</span><span class="sxs-lookup"><span data-stu-id="7d43e-149">But if the filter uses a single thread for every output pin, the first pin might block the thread when it calls **Receive**, which will prevent the other pins from sending data.</span></span> <span data-ttu-id="7d43e-150">In diesem Fall sollten Sie VFW S cant-Hinweis zurückgeben \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="7d43e-150">In that case, you should return VFW\_S\_CANT\_CUE.</span></span>
-   <span data-ttu-id="7d43e-151">Ein Filter kann sporadisch Daten bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="7d43e-151">A filter might deliver data sporadically.</span></span> <span data-ttu-id="7d43e-152">Beispielsweise kann ein benutzerdefinierter Datenstrom analysiert und einige Pakete herausgefiltert werden, während andere Benutzer bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="7d43e-152">For example, it might parse a custom data stream and filter out some packets while delivering others.</span></span> <span data-ttu-id="7d43e-153">In diesem Fall ist es unter Umständen nicht garantiert, dass der Filterdaten bereitstellt, während Sie angehalten werden.</span><span class="sxs-lookup"><span data-stu-id="7d43e-153">In that case, the filter may not be guaranteed to deliver data while paused.</span></span>

<span data-ttu-id="7d43e-154">Ein Quell Filter (mit dem Push-Modell) oder ein Parserfilter (mithilfe des Push/Pull-Modells) erstellt mindestens einen streamingingthread, der Beispiele so schnell wie möglich liefert.</span><span class="sxs-lookup"><span data-stu-id="7d43e-154">A source filter (using the push model) or a parser filter (using the push/pull model) creates one or more streaming threads, which deliver samples as quickly as possible.</span></span> <span data-ttu-id="7d43e-155">Downstreamfilter, z. b. Decoder und Transformationen, senden Daten in der Regel nur, wenn **Receive** auf Ihren Eingabe Pins aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7d43e-155">Downstream filters, such as decoders and transforms, typically send data only when **Receive** is called on their input pins.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7d43e-156">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="7d43e-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7d43e-157">Empfangen und Bereitstellung von Beispielen</span><span class="sxs-lookup"><span data-stu-id="7d43e-157">Receiving and Delivering Samples</span></span>](receiving-and-delivering-samples.md)
</dt> </dl>

 

 



