---
description: Verwenden der DMO-Klassen Vorlage
ms.assetid: 5193ad08-aaee-47e3-93eb-a126a66d8f23
title: Verwenden der DMO-Klassen Vorlage
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4db80017372f11f6c928e0e6a83b591967a84ee7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104042561"
---
# <a name="using-the-dmo-class-template"></a><span data-ttu-id="1e39a-103">Verwenden der DMO-Klassen Vorlage</span><span class="sxs-lookup"><span data-stu-id="1e39a-103">Using the DMO Class Template</span></span>

<span data-ttu-id="1e39a-104">DirectShow enthält eine Klassen Vorlage, [**imediaobjectimpl**](imediaobjectimpl-class-template.md), für die Implementierung von dmos.</span><span class="sxs-lookup"><span data-stu-id="1e39a-104">DirectShow includes a class template, [**IMediaObjectImpl**](imediaobjectimpl-class-template.md), for implementing DMOs.</span></span> <span data-ttu-id="1e39a-105">Die Vorlage behandelt viele der Buchhaltungsaufgaben, z. b. die Validierung von Eingabe Parametern.</span><span class="sxs-lookup"><span data-stu-id="1e39a-105">The template handles many of the "bookkeeping" tasks, such as validating input parameters.</span></span> <span data-ttu-id="1e39a-106">Mithilfe der Vorlage können Sie sich auf die Funktionen konzentrieren, die für Ihren DMO spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="1e39a-106">By using the template, you can focus on the functionality that is specific to your DMO.</span></span> <span data-ttu-id="1e39a-107">Außerdem hilft Ihnen die Vorlage dabei, sicherzustellen, dass Sie eine robuste Implementierung erstellen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-107">In addition, the template helps to ensure that you create a robust implementation.</span></span> <span data-ttu-id="1e39a-108">Die Vorlage wird in der Header Datei "dmuimpl. h" definiert, die sich im Include-Verzeichnis des SDK befindet.</span><span class="sxs-lookup"><span data-stu-id="1e39a-108">The template is defined in the header file Dmoimpl.h, located in the Include directory of the SDK.</span></span>

<span data-ttu-id="1e39a-109">Die **imediaobjectimpl** -Vorlage erbt die [**imediaobject**](/previous-versions/windows/desktop/api/Mediaobj/nn-mediaobj-imediaobject) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="1e39a-109">The **IMediaObjectImpl** template inherits the [**IMediaObject**](/previous-versions/windows/desktop/api/Mediaobj/nn-mediaobj-imediaobject) interface.</span></span> <span data-ttu-id="1e39a-110">Zum Erstellen eines DMO mithilfe der Vorlage definieren Sie eine neue Klasse, die von **imediaobjectimpl** abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="1e39a-110">To create a DMO using the template, define a new class that derives from **IMediaObjectImpl**.</span></span> <span data-ttu-id="1e39a-111">Die Vorlage implementiert alle **imediaobject** -Methoden.</span><span class="sxs-lookup"><span data-stu-id="1e39a-111">The template implements all of the **IMediaObject** methods.</span></span> <span data-ttu-id="1e39a-112">In den meisten Fällen ruft die Vorlage eine entsprechende private Methode für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-112">In most cases, the template calls a corresponding private method on the derived class.</span></span> <span data-ttu-id="1e39a-113">Die Vorlage bietet die folgenden Features:</span><span class="sxs-lookup"><span data-stu-id="1e39a-113">The template provides the following features:</span></span>

-   <span data-ttu-id="1e39a-114">Grundlegende Parameter Überprüfung.</span><span class="sxs-lookup"><span data-stu-id="1e39a-114">Basic parameter checking.</span></span> <span data-ttu-id="1e39a-115">Die Vorlagen Methoden überprüfen, ob erforderliche Parameter nicht **null** sind, dass sich streamindizes innerhalb des Bereichs befinden und dass Flags gültig sind.</span><span class="sxs-lookup"><span data-stu-id="1e39a-115">The template methods verify that required parameters are not **NULL**, that stream indexes are within range, and that flags are valid.</span></span>
-   <span data-ttu-id="1e39a-116">Gelungen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-116">Locking.</span></span> <span data-ttu-id="1e39a-117">Mit den Vorlagen Methoden werden zwei interne Methoden, **Lock** und **Unlock**, aufgerufen, um Vorgänge für den DMO zu serialisieren.</span><span class="sxs-lookup"><span data-stu-id="1e39a-117">The template methods call two internal methods, **Lock** and **Unlock**, to serialize operations on the DMO.</span></span> <span data-ttu-id="1e39a-118">Mit dieser Funktion wird sichergestellt, dass das DMO Thread sicher ist.</span><span class="sxs-lookup"><span data-stu-id="1e39a-118">This feature ensures that the DMO is thread-safe.</span></span>
-   <span data-ttu-id="1e39a-119">Medientypen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-119">Media types.</span></span> <span data-ttu-id="1e39a-120">In der Vorlage werden die vom Client festgelegten Medientypen gespeichert und Accessormethoden für die Medientypen bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="1e39a-120">The template stores the media types set by the client, and provides accessor methods for the media types.</span></span>
-   <span data-ttu-id="1e39a-121">-.</span><span class="sxs-lookup"><span data-stu-id="1e39a-121">Streaming.</span></span> <span data-ttu-id="1e39a-122">Die Vorlage verhindert das Streaming, bis der Client Medientypen für alle nicht optionalen Streams festgelegt hat.</span><span class="sxs-lookup"><span data-stu-id="1e39a-122">The template prevents streaming until the client has set media types for all non-optional streams.</span></span> <span data-ttu-id="1e39a-123">Außerdem wird sichergestellt, dass die Methode [**imediaobject:: Zuordnungs**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources) Methode aufgerufen wird, bevor das Streaming beginnt, wodurch sichergestellt wird, dass Ressourcen zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="1e39a-123">It also ensures that the [**IMediaObject::AllocateStreamingResources**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources) method is called before streaming begins, which guarantees that resources are allocated.</span></span>

<span data-ttu-id="1e39a-124">Die abgeleitete Klasse muss die **IUnknown** -Schnittstelle implementieren. Diese Schnittstelle wird von der Vorlage nicht bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="1e39a-124">The derived class must implement the **IUnknown** interface; the template does not provide this interface.</span></span> <span data-ttu-id="1e39a-125">Sie können die Active Template Library (ATL) verwenden, um **IUnknown** zu implementieren, oder Sie können eine andere Implementierung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-125">You can use the Active Template Library (ATL) to implement **IUnknown**, or you can provide some other implementation.</span></span> <span data-ttu-id="1e39a-126">Die Vorlage implementiert auch nicht den Sperrmechanismus.</span><span class="sxs-lookup"><span data-stu-id="1e39a-126">The template also does not implement the locking mechanism.</span></span> <span data-ttu-id="1e39a-127">Die abgeleitete Klasse muss die **Lock** -und **Unlock** -Methoden implementieren.</span><span class="sxs-lookup"><span data-stu-id="1e39a-127">The derived class must implement the **Lock** and **Unlock** methods.</span></span> <span data-ttu-id="1e39a-128">Wenn Sie die Klasse mithilfe von ATL erstellen, können Sie die standardmäßigen ATL-Implementierungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="1e39a-128">If you create your class using ATL, you can use the default ATL implementations.</span></span>

<span data-ttu-id="1e39a-129">**Deklaration der abgeleiteten Klasse**</span><span class="sxs-lookup"><span data-stu-id="1e39a-129">**Declaring the Derived Class**</span></span>

<span data-ttu-id="1e39a-130">Die **imediaobjectimpl** -Klassen Vorlage wird wie folgt deklariert:</span><span class="sxs-lookup"><span data-stu-id="1e39a-130">The **IMediaObjectImpl** class template is declared as follows:</span></span>


```C++
template <class _DERIVED_, int NUMBEROFINPUTS, int NUMBEROFOUTPUTS>
class IMediaObjectImpl : public ImediaObject
```



<span data-ttu-id="1e39a-131">Die drei Vorlagen Parameter sind \_ abgeleitet \_ , "zahlofinputs" und "nummerierungsausgaben".</span><span class="sxs-lookup"><span data-stu-id="1e39a-131">The three template parameters are \_DERIVED\_, NUMBEROFINPUTS, and NUMBEROFOUTPUTS.</span></span> <span data-ttu-id="1e39a-132">\_Der abgeleitete Satz \_ entspricht dem Namen der Klasse.</span><span class="sxs-lookup"><span data-stu-id="1e39a-132">Set \_DERIVED\_ equal to the name of your class.</span></span> <span data-ttu-id="1e39a-133">Mit den beiden anderen Parametern wird die Anzahl der Eingabedaten Ströme und der Ausgabedaten Ströme im DMO definiert.</span><span class="sxs-lookup"><span data-stu-id="1e39a-133">The other two parameters define the number of input streams and output streams on the DMO.</span></span> <span data-ttu-id="1e39a-134">Verwenden Sie beispielsweise die folgende Deklaration, um eine DMO-Klasse mit dem Namen cmydmo zu erstellen, die einen Eingabedaten Strom und zwei Ausgabedaten Ströme unterstützt:</span><span class="sxs-lookup"><span data-stu-id="1e39a-134">For example, to create a DMO class named CMyDmo that supports one input stream and two output streams, use the following declaration:</span></span>


```C++
class CMyDmo : public IMediaObjectImpl<CMyDmo, 1, 2>
```



<span data-ttu-id="1e39a-135">Im restlichen Teil dieses Abschnitts wird beschrieben, wie die verschiedenen Methoden in **imediaobject** von der Vorlage implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="1e39a-135">The remainder of this section describes how the template implements the various methods in **IMediaObject**.</span></span>

<span data-ttu-id="1e39a-136">**Methoden zum Festlegen von Medientypen**</span><span class="sxs-lookup"><span data-stu-id="1e39a-136">**Methods for Setting Media Types**</span></span>

<span data-ttu-id="1e39a-137">Die folgenden Methoden legen Medientypen im DMO fest oder rufen Sie ab:</span><span class="sxs-lookup"><span data-stu-id="1e39a-137">The following methods set or retrieve media types on the DMO:</span></span>

-   <span data-ttu-id="1e39a-138">**Getinputtype**, **getoutputtype**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-138">**GetInputType**, **GetOutputType**.</span></span> <span data-ttu-id="1e39a-139">Diese Methoden geben bevorzugte Medientypen nach streamnummer und Typindex zurück.</span><span class="sxs-lookup"><span data-stu-id="1e39a-139">These methods return preferred media types, by stream number and type index.</span></span> <span data-ttu-id="1e39a-140">Die Vorlage ruft **internalgetinputtype** oder **internalgetoutputtype** für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-140">The template calls **InternalGetInputType** or **InternalGetOutputType** on the derived class.</span></span>
-   <span data-ttu-id="1e39a-141">**Setinputtype**, **setoutputtype**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-141">**SetInputType**, **SetOutputType**.</span></span> <span data-ttu-id="1e39a-142">Diese Methoden legen den Medientyp für einen Stream fest, testen einen Medientyp oder löschen einen Medientyp.</span><span class="sxs-lookup"><span data-stu-id="1e39a-142">These methods set the media type on a stream, test a media type, or clear a media type.</span></span> <span data-ttu-id="1e39a-143">Um den Medientyp zu validieren, ruft die Vorlage **internalcheckinputtype** oder **internalcheckoutputtype** für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-143">To validate the media type, the template calls **InternalCheckInputType** or **InternalCheckOutputType** on the derived class.</span></span> <span data-ttu-id="1e39a-144">Die abgeleitete Klasse gibt S \_ OK zurück, um den Typ oder DMO \_ E \_ invalidtype zu akzeptieren, um den Typ abzulehnen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-144">The derived class returns S\_OK to accept the type or DMO\_E\_INVALIDTYPE to reject the type.</span></span> <span data-ttu-id="1e39a-145">Die Vorlage behandelt das Festlegen oder Löschen des Medientyps.</span><span class="sxs-lookup"><span data-stu-id="1e39a-145">The template handles setting or clearing the media type.</span></span>
-   <span data-ttu-id="1e39a-146">**Getinputcurrenttype**, **getoutputcurrenttype**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-146">**GetInputCurrentType**, **GetOutputCurrentType**.</span></span> <span data-ttu-id="1e39a-147">Diese Methoden geben den aktuellen Medientyp für einen Stream zurück, oder der DMO \_ E- \_ Typ \_ \_ wird nicht festgelegt, wenn kein Typ festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="1e39a-147">These methods return the current media type for a stream, or DMO\_E\_TYPE\_NOT\_SET if no type is set.</span></span> <span data-ttu-id="1e39a-148">Diese Methoden werden von der Vorlage vollständig implementiert.</span><span class="sxs-lookup"><span data-stu-id="1e39a-148">The template completely implements these methods.</span></span>

<span data-ttu-id="1e39a-149">**Informationsmethoden**</span><span class="sxs-lookup"><span data-stu-id="1e39a-149">**Informational Methods**</span></span>

<span data-ttu-id="1e39a-150">Die folgenden Methoden stellen Informationen über den DMO bereit.</span><span class="sxs-lookup"><span data-stu-id="1e39a-150">The following methods provide information about the DMO.</span></span>

-   <span data-ttu-id="1e39a-151">**Getinputmaxlatency**, \* **tinputmaxlatency**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-151">**GetInputMaxLatency**, **SetInputMaxLatency**.</span></span> <span data-ttu-id="1e39a-152">Mit diesen Methoden wird die maximale Latenzzeit abgerufen oder festgelegt.</span><span class="sxs-lookup"><span data-stu-id="1e39a-152">These methods retrieve or set the maximum latency.</span></span> <span data-ttu-id="1e39a-153">Die Vorlage ruft **internalgetinputmaxlatency** oder **internalsettinputmaxlatency** für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-153">The template calls **InternalGetInputMaxLatency** or **InternalSetInputMaxLatency** on the derived class.</span></span>
-   <span data-ttu-id="1e39a-154">**Getinputsizone FO**, **getoutputsizone FO**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-154">**GetInputSizeInfo**, **GetOutputSizeInfo**.</span></span> <span data-ttu-id="1e39a-155">Diese Methoden geben die Puffer Anforderungen des DMO für einen angegebenen Stream zurück.</span><span class="sxs-lookup"><span data-stu-id="1e39a-155">These methods return the DMO's buffer requirements for a specified stream.</span></span> <span data-ttu-id="1e39a-156">Wenn kein Medientyp für diesen Stream festgelegt wurde, gibt die Vorlage den DMO \_ E- \_ Typ \_ nicht \_ festgelegt zurück.</span><span class="sxs-lookup"><span data-stu-id="1e39a-156">If no media type has been set on that stream, the template returns DMO\_E\_TYPE\_NOT\_SET.</span></span> <span data-ttu-id="1e39a-157">Andernfalls wird **internalgetinputsizone FO** oder **internalgetoutputsizone Info** für die abgeleitete Klasse aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-157">Otherwise, it calls **InternalGetInputSizeInfo** or **InternalGetOutputSizeInfo** on the derived class.</span></span>
-   <span data-ttu-id="1e39a-158">**Getinputstreaminfo**, **getoutputstreaminfo**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-158">**GetInputStreamInfo**, **GetOutputStreamInfo**.</span></span> <span data-ttu-id="1e39a-159">Diese Methoden geben verschiedene Flags zurück, die angeben, wie der Client die Daten formatieren soll.</span><span class="sxs-lookup"><span data-stu-id="1e39a-159">These methods return various flags that indicate how the client should format the data.</span></span> <span data-ttu-id="1e39a-160">Die Vorlage ruft **internalgetinputstreaminfo** oder **internalgetoutputstreaminfo** für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-160">The template calls **InternalGetInputStreamInfo** or **InternalGetOutputStreamInfo** on the derived class.</span></span>
-   <span data-ttu-id="1e39a-161">**Getstreamcount**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-161">**GetStreamCount**.</span></span> <span data-ttu-id="1e39a-162">Diese Methode gibt die Anzahl von Eingabe-und Ausgabestreams zurück.</span><span class="sxs-lookup"><span data-stu-id="1e39a-162">This method returns the number of input and output streams.</span></span> <span data-ttu-id="1e39a-163">Die Vorlage implementiert diese Methode mit den Vorlagen Parametern.</span><span class="sxs-lookup"><span data-stu-id="1e39a-163">The template implements this method, using the template parameters.</span></span>

<span data-ttu-id="1e39a-164">**Methoden für die Ressourcen Zuordnung**</span><span class="sxs-lookup"><span data-stu-id="1e39a-164">**Methods for Resource Allocation**</span></span>

-   <span data-ttu-id="1e39a-165">Die Methode "Methode **zuweisen** " weist alle Ressourcen zu, die die DMO benötigt, bevor das Streaming beginnt.</span><span class="sxs-lookup"><span data-stu-id="1e39a-165">The **AllocateStreamingResources** method allocates any resources the DMO needs before streaming begins.</span></span> <span data-ttu-id="1e39a-166">Die Methode " **freestreamingresources** " gibt dieselben Ressourcen frei.</span><span class="sxs-lookup"><span data-stu-id="1e39a-166">The **FreeStreamingResources** method releases the same resources.</span></span> <span data-ttu-id="1e39a-167">Die Vorlage ruft **internaldepaseestreamingresources** bzw. **internalfreestreamingresources** auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-167">The template calls **InternalAllocateStreamingResources** and **InternalFreeStreamingResources**, respectively.</span></span>

<span data-ttu-id="1e39a-168">Der DMO-Client muss diese Methoden nicht aufrufen, aber die **Vorlage ruft vor** dem Streaming automatisch "" "" "".</span><span class="sxs-lookup"><span data-stu-id="1e39a-168">The client of the DMO is not required to call these methods, but the template automatically calls **AllocateStreamingResources** before streaming starts.</span></span> <span data-ttu-id="1e39a-169">Daher kann der DMO davon ausgehen, dass Ressourcen ordnungsgemäß zugeordnet wurden, wenn **ProcessInput** aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="1e39a-169">Therefore, the DMO can assume that resources are have been allocated correctly by the time **ProcessInput** is called.</span></span> <span data-ttu-id="1e39a-170">Der DMO sollte im Dekonstruktor " **freestreamingresources** " aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-170">The DMO should call **FreeStreamingResources** in its destructor.</span></span>

<span data-ttu-id="1e39a-171">Wenn die Vorlage **internalzuzugestreamingresources** aufruft, legt Sie außerdem ein internes Flag fest, sodass diese Methode erst wieder aufgerufen wird, wenn **internalfreestreamingresources** aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="1e39a-171">Also, when the template calls **InternalAllocateStreamingResources**, it sets an internal flag, so that it does not call that method again until calling **InternalFreeStreamingResources**.</span></span> <span data-ttu-id="1e39a-172">Dadurch wird sichergestellt, dass Ressourcen nicht versehentlich erneut zugewiesen werden, was zu Speicher Verlusten führen kann.</span><span class="sxs-lookup"><span data-stu-id="1e39a-172">This ensures that resources are not re-allocated accidentally, which could cause memory leaks.</span></span>

<span data-ttu-id="1e39a-173">**Methoden für das Streaming**</span><span class="sxs-lookup"><span data-stu-id="1e39a-173">**Methods for Streaming**</span></span>

<span data-ttu-id="1e39a-174">Zum Streamen von Daten werden die folgenden Methoden verwendet:</span><span class="sxs-lookup"><span data-stu-id="1e39a-174">The following methods are used to stream data:</span></span>

-   <span data-ttu-id="1e39a-175">**Getinputstatus**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-175">**GetInputStatus**.</span></span> <span data-ttu-id="1e39a-176">Diese Methode gibt an, ob der DMO zu diesem Zeitpunkt Eingaben akzeptieren kann.</span><span class="sxs-lookup"><span data-stu-id="1e39a-176">This method indicates whether the DMO can accept input at this time.</span></span> <span data-ttu-id="1e39a-177">Die Vorlage ruft **internalakzeptinginput** für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-177">The template calls **InternalAcceptingInput** on the derived class.</span></span> <span data-ttu-id="1e39a-178">Wenn der DMO Eingaben akzeptieren kann, gibt die abgeleitete Klasse "S OK" zurück, \_ und die Vorlage legt das DMO-Eingabe-Daten-Daten Satz- \_ Accept- \_ \_ \_ Daten Bit im *dwFlags* -Parameter fest.</span><span class="sxs-lookup"><span data-stu-id="1e39a-178">If the DMO can accept input, the derived class returns S\_OK and the template sets the DMO\_INPUT\_STATUSF\_ACCEPT\_DATA bit in the *dwFlags* parameter.</span></span> <span data-ttu-id="1e39a-179">Andernfalls gibt die abgeleitete Klasse den Wert "false" zurück \_ , und die Vorlage legt *dwFlags* auf NULL fest.</span><span class="sxs-lookup"><span data-stu-id="1e39a-179">Otherwise, the derived class returns S\_FALSE and the template sets *dwFlags* to zero.</span></span>
-   <span data-ttu-id="1e39a-180">**ProcessInput**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-180">**ProcessInput**.</span></span> <span data-ttu-id="1e39a-181">Diese Methode verarbeitet einen Eingabepuffer.</span><span class="sxs-lookup"><span data-stu-id="1e39a-181">This method processes an input buffer.</span></span> <span data-ttu-id="1e39a-182">Die **Vorlage ruft "**" "" "" "" "" "".</span><span class="sxs-lookup"><span data-stu-id="1e39a-182">The template calls **AllocateStreamingResources**, described previously.</span></span> <span data-ttu-id="1e39a-183">Anschließend wird **internalakzeptinginput** für die abgeleitete Klasse aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-183">Then it calls **InternalAcceptingInput** on the derived class.</span></span> <span data-ttu-id="1e39a-184">Wenn der DMO neue Eingaben akzeptieren kann, ruft die Vorlage **internalprocessinput** auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-184">If the DMO can accept new input, the template calls **InternalProcessInput**.</span></span>
-   <span data-ttu-id="1e39a-185">**ProcessOutput**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-185">**ProcessOutput**.</span></span> <span data-ttu-id="1e39a-186">Diese Methode verarbeitet einen Satz von Ausgabe Puffern, einen Puffer für jeden Ausgabestream.</span><span class="sxs-lookup"><span data-stu-id="1e39a-186">This method processes a set of output buffers, one buffer for each output stream.</span></span> <span data-ttu-id="1e39a-187">Die Vorlage ruft " **depaseestreamingresources** " und dann " **internalprocessoutput**" auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-187">The template calls **AllocateStreamingResources** and then **InternalProcessOutput**.</span></span>
-   <span data-ttu-id="1e39a-188">**Diskontinuität**.</span><span class="sxs-lookup"><span data-stu-id="1e39a-188">**Discontinuity**.</span></span> <span data-ttu-id="1e39a-189">Diese Methode signalisiert eine Diskontinuität in einem Eingabedaten Strom.</span><span class="sxs-lookup"><span data-stu-id="1e39a-189">This method signals a discontinuity in an input stream.</span></span> <span data-ttu-id="1e39a-190">Die Vorlage ruft **internalakzeptinginput** für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-190">The template calls **InternalAcceptingInput** on the derived class.</span></span> <span data-ttu-id="1e39a-191">Wenn diese Methode S OK zurückgibt \_ , ruft die Vorlage **internaldiscontinuity** für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-191">If that method returns S\_OK, the template calls **InternalDiscontinuity** on the derived class.</span></span>
-   <span data-ttu-id="1e39a-192">Leeren.</span><span class="sxs-lookup"><span data-stu-id="1e39a-192">**Flush**.</span></span> <span data-ttu-id="1e39a-193">Diese Methode leert den DMO.</span><span class="sxs-lookup"><span data-stu-id="1e39a-193">This method flushes the DMO.</span></span> <span data-ttu-id="1e39a-194">Die Vorlage ruft **internalflush** für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-194">The template calls **InternalFlush** on the derived class.</span></span> <span data-ttu-id="1e39a-195">Der DMO sollte alle Eingabepuffer verwerfen, die noch verarbeitet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-195">The DMO should discard any input buffers that it still holds to be processed.</span></span>

<span data-ttu-id="1e39a-196">Die Vorlage bietet keine direkte Unterstützung für die [**imediaobjectinplace**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobjectinplace) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="1e39a-196">The template does not provide any direct support for the [**IMediaObjectInPlace**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobjectinplace) interface.</span></span>

<span data-ttu-id="1e39a-197">**Methoden zum Sperren**</span><span class="sxs-lookup"><span data-stu-id="1e39a-197">**Methods for Locking**</span></span>

<span data-ttu-id="1e39a-198">Sperren werden verwendet, um den Status von DMO in einer Multithread-Umgebung zu schützen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-198">Locking is used to protect the DMO's state in a multithreaded environment.</span></span> <span data-ttu-id="1e39a-199">In einem ATL-Projekt verursacht die [**imediaobject:: Lock**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-lock) -Methode einen namens Konflikt mit der ATL- **Sperr** Methode.</span><span class="sxs-lookup"><span data-stu-id="1e39a-199">In an ATL project, the [**IMediaObject::Lock**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-lock) method causes a name conflict with the ATL **Lock** method.</span></span> <span data-ttu-id="1e39a-200">Um den Konflikt aufzulösen, benennt die Vorlage die **imediaobject** -Methode in **dmolock** um.</span><span class="sxs-lookup"><span data-stu-id="1e39a-200">To resolve the conflict, the template renames the **IMediaObject** method to **DMOLock**.</span></span> <span data-ttu-id="1e39a-201">Wenn Sie die abgeleitete Klasse kompilieren, definieren \_ Sie \_ den Namen der fixsperre, bevor Sie die Header Datei "DMO. h" einschließen:</span><span class="sxs-lookup"><span data-stu-id="1e39a-201">When you compile the derived class, define FIX\_LOCK\_NAME before including the header file Dmo.h:</span></span>


```C++
#define FIX_LOCK_NAME
#include <dmo.h>
```



<span data-ttu-id="1e39a-202">Diese Direktive bewirkt, dass der Präprozessor **dmolock** zur **Sperre** in der Deklaration der **imediaobject** -Schnittstelle ersetzt.</span><span class="sxs-lookup"><span data-stu-id="1e39a-202">This directive causes the preprocessor to substitute **DMOLock** for **Lock** in the declaration of the **IMediaObject** interface.</span></span> <span data-ttu-id="1e39a-203">Anwendungen können die Methode weiterhin mithilfe der namens **Sperre** aufrufen, da sich die Vtable-Reihenfolge nicht ändert.</span><span class="sxs-lookup"><span data-stu-id="1e39a-203">Applications can still invoke the method using the name **Lock**, because the vtable order does not change.</span></span> <span data-ttu-id="1e39a-204">Die **dmolock** -Methode ruft **Lock** oder **Unlock** für die abgeleitete Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-204">The **DMOLock** method calls **Lock** or **Unlock** on the derived class.</span></span> <span data-ttu-id="1e39a-205">Wenn Sie ATL verwenden, um die abgeleitete Klasse zu implementieren, werden diese Methoden bereits von ATL definiert, sodass kein zusätzlicher Code erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="1e39a-205">If you are using ATL to implement the derived class, these methods are already defined by ATL, so no additional code is necessary.</span></span> <span data-ttu-id="1e39a-206">Wenn Sie ATL nicht verwenden, müssen Sie in der abgeleiteten Klasse **Lock** -und **Unlock** -Methoden bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-206">If you are not using ATL, you must provide **Lock** and **Unlock** methods in your derived class.</span></span>

<span data-ttu-id="1e39a-207">Die Vorlage sperrt den DMO automatisch in jeder der **imediaobject** -Methoden.</span><span class="sxs-lookup"><span data-stu-id="1e39a-207">The template automatically locks the DMO in each of the **IMediaObject** methods.</span></span> <span data-ttu-id="1e39a-208">Die abgeleitete Klasse muss möglicherweise den DMO in anderen öffentlichen Methoden sperren, die Sie implementiert (z. b. Wenn Sie **imediaobjectinplace** unterstützt).</span><span class="sxs-lookup"><span data-stu-id="1e39a-208">The derived class might need to lock the DMO inside other public methods that it implements (for example, if it supports **IMediaObjectInPlace**).</span></span> <span data-ttu-id="1e39a-209">Die Klassen Vorlage bietet auch eine interne Hilfsklasse, [**imediaobjectimpl:: LockIT**](imediaobjectimpl-lockit.md), die zum Sperren und Entsperren des DMO nützlich ist.</span><span class="sxs-lookup"><span data-stu-id="1e39a-209">The class template also provides an internal helper class, [**IMediaObjectImpl::LockIt**](imediaobjectimpl-lockit.md), which is useful for locking and unlocking the DMO.</span></span>

<span data-ttu-id="1e39a-210">**Zusammenfassung**</span><span class="sxs-lookup"><span data-stu-id="1e39a-210">**Summary**</span></span>

<span data-ttu-id="1e39a-211">Für die folgenden **imediaobject** -Methoden Ruft die Vorlage eine entsprechende Methode mit derselben Signatur in der abgeleiteten Klasse auf.</span><span class="sxs-lookup"><span data-stu-id="1e39a-211">For the following **IMediaObject** methods, the template calls a corresponding method with the same signature on the derived class.</span></span> <span data-ttu-id="1e39a-212">Die abgeleitete Klasse muss jede der in der zweiten Spalte gezeigten Methoden implementieren.</span><span class="sxs-lookup"><span data-stu-id="1e39a-212">The derived class must implement each of the methods shown in the second column.</span></span>



| <span data-ttu-id="1e39a-213">Imediaobject-Methode</span><span class="sxs-lookup"><span data-stu-id="1e39a-213">IMediaObject Method</span></span>            | <span data-ttu-id="1e39a-214">Methode der abgeleiteten Klasse</span><span class="sxs-lookup"><span data-stu-id="1e39a-214">Derived Class Method</span></span>                   |
|--------------------------------|----------------------------------------|
| <span data-ttu-id="1e39a-215">**"" Zugeordnet**</span><span class="sxs-lookup"><span data-stu-id="1e39a-215">**AllocateStreamingResources**</span></span> | <span data-ttu-id="1e39a-216">**Internaldeperestreamingresources**</span><span class="sxs-lookup"><span data-stu-id="1e39a-216">**InternalAllocateStreamingResources**</span></span> |
| <span data-ttu-id="1e39a-217">**Diskontinuität**</span><span class="sxs-lookup"><span data-stu-id="1e39a-217">**Discontinuity**</span></span>              | <span data-ttu-id="1e39a-218">**Internaldiscontinuity**</span><span class="sxs-lookup"><span data-stu-id="1e39a-218">**InternalDiscontinuity**</span></span>              |
| <span data-ttu-id="1e39a-219">**Leerung**</span><span class="sxs-lookup"><span data-stu-id="1e39a-219">**Flush**</span></span>                      | <span data-ttu-id="1e39a-220">**Internalflush**</span><span class="sxs-lookup"><span data-stu-id="1e39a-220">**InternalFlush**</span></span>                      |
| <span data-ttu-id="1e39a-221">**Freestreamingresources**</span><span class="sxs-lookup"><span data-stu-id="1e39a-221">**FreeStreamingResources**</span></span>     | <span data-ttu-id="1e39a-222">**Internalfreestreamingresources**</span><span class="sxs-lookup"><span data-stu-id="1e39a-222">**InternalFreeStreamingResources**</span></span>     |
| <span data-ttu-id="1e39a-223">**Getinputmaxlatency**</span><span class="sxs-lookup"><span data-stu-id="1e39a-223">**GetInputMaxLatency**</span></span>         | <span data-ttu-id="1e39a-224">**Internalgetinputmaxlatency**</span><span class="sxs-lookup"><span data-stu-id="1e39a-224">**InternalGetInputMaxLatency**</span></span>         |
| <span data-ttu-id="1e39a-225">**Getinputsizone FO**</span><span class="sxs-lookup"><span data-stu-id="1e39a-225">**GetInputSizeInfo**</span></span>           | <span data-ttu-id="1e39a-226">**Internalgetinputsizone FO**</span><span class="sxs-lookup"><span data-stu-id="1e39a-226">**InternalGetInputSizeInfo**</span></span>           |
| <span data-ttu-id="1e39a-227">**Getinputstreaminfo**</span><span class="sxs-lookup"><span data-stu-id="1e39a-227">**GetInputStreamInfo**</span></span>         | <span data-ttu-id="1e39a-228">**Internalgetinputstreaminfo**</span><span class="sxs-lookup"><span data-stu-id="1e39a-228">**InternalGetInputStreamInfo**</span></span>         |
| <span data-ttu-id="1e39a-229">**Getinputtype**</span><span class="sxs-lookup"><span data-stu-id="1e39a-229">**GetInputType**</span></span>               | <span data-ttu-id="1e39a-230">**Internalgetinputtype**</span><span class="sxs-lookup"><span data-stu-id="1e39a-230">**InternalGetInputType**</span></span>               |
| <span data-ttu-id="1e39a-231">**Getoutputsizone FO**</span><span class="sxs-lookup"><span data-stu-id="1e39a-231">**GetOutputSizeInfo**</span></span>          | <span data-ttu-id="1e39a-232">**Internalgetoutputsizone FO**</span><span class="sxs-lookup"><span data-stu-id="1e39a-232">**InternalGetOutputSizeInfo**</span></span>          |
| <span data-ttu-id="1e39a-233">**Getoutputstreaminfo**</span><span class="sxs-lookup"><span data-stu-id="1e39a-233">**GetOutputStreamInfo**</span></span>        | <span data-ttu-id="1e39a-234">**Internalgetoutputstreaminfo**</span><span class="sxs-lookup"><span data-stu-id="1e39a-234">**InternalGetOutputStreamInfo**</span></span>        |
| <span data-ttu-id="1e39a-235">**Getoutputtype**</span><span class="sxs-lookup"><span data-stu-id="1e39a-235">**GetOutputType**</span></span>              | <span data-ttu-id="1e39a-236">**Internalgetoutputtype**</span><span class="sxs-lookup"><span data-stu-id="1e39a-236">**InternalGetOutputType**</span></span>              |
| <span data-ttu-id="1e39a-237">**ProcessInput**</span><span class="sxs-lookup"><span data-stu-id="1e39a-237">**ProcessInput**</span></span>               | <span data-ttu-id="1e39a-238">**Internalprocessinput**</span><span class="sxs-lookup"><span data-stu-id="1e39a-238">**InternalProcessInput**</span></span>               |
| <span data-ttu-id="1e39a-239">**ProcessOutput**</span><span class="sxs-lookup"><span data-stu-id="1e39a-239">**ProcessOutput**</span></span>              | <span data-ttu-id="1e39a-240">**Internalprocessoutput**</span><span class="sxs-lookup"><span data-stu-id="1e39a-240">**InternalProcessOutput**</span></span>              |
| <span data-ttu-id="1e39a-241">**"* Tinputmaxlatency"*\*</span><span class="sxs-lookup"><span data-stu-id="1e39a-241">**SetInputMaxLatency**</span></span>         | <span data-ttu-id="1e39a-242">**Internal* tinputmaxlatency*\*</span><span class="sxs-lookup"><span data-stu-id="1e39a-242">**InternalSetInputMaxLatency**</span></span>         |



 

<span data-ttu-id="1e39a-243">Für die verbleibenden **imediaobject** -Methoden gibt es keine eins-zu-eins-Entsprechung zwischen Vorlagen Methoden und Methoden für abgeleitete Klassen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-243">For the remaining **IMediaObject** methods, there is not a one-to-one correspondence between template methods and derived-class methods.</span></span> <span data-ttu-id="1e39a-244">In der folgenden Tabelle ist zusammengefasst, welche Methoden von der Vorlage vollständig implementiert werden und welche Methoden andere Methoden in der abgeleiteten Klasse aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="1e39a-244">The following table summarizes which methods are fully implemented by the template, and which methods call other methods on the derived class.</span></span>



| <span data-ttu-id="1e39a-245">Imediaobject-Methode</span><span class="sxs-lookup"><span data-stu-id="1e39a-245">IMediaObject Method</span></span>                   | <span data-ttu-id="1e39a-246">Methode der abgeleiteten Klasse</span><span class="sxs-lookup"><span data-stu-id="1e39a-246">Derived Class Method</span></span>                                                             |
|---------------------------------------|----------------------------------------------------------------------------------|
| <span data-ttu-id="1e39a-247">**Getinputcurrenttype**</span><span class="sxs-lookup"><span data-stu-id="1e39a-247">**GetInputCurrentType**</span></span>               | <span data-ttu-id="1e39a-248">Vollständig implementiert</span><span class="sxs-lookup"><span data-stu-id="1e39a-248">Fully implemented</span></span>                                                                |
| <span data-ttu-id="1e39a-249">**Getoutputcurrenttype**</span><span class="sxs-lookup"><span data-stu-id="1e39a-249">**GetOutputCurrentType**</span></span>              | <span data-ttu-id="1e39a-250">Vollständig implementiert</span><span class="sxs-lookup"><span data-stu-id="1e39a-250">Fully implemented</span></span>                                                                |
| <span data-ttu-id="1e39a-251">**Getstreamcount**</span><span class="sxs-lookup"><span data-stu-id="1e39a-251">**GetStreamCount**</span></span>                    | <span data-ttu-id="1e39a-252">Vollständig implementiert</span><span class="sxs-lookup"><span data-stu-id="1e39a-252">Fully implemented</span></span>                                                                |
| <span data-ttu-id="1e39a-253">**Getinputstatus**</span><span class="sxs-lookup"><span data-stu-id="1e39a-253">**GetInputStatus**</span></span>                    | <span data-ttu-id="1e39a-254">[**Internalakzeptinginput**](/previous-versions/ms809095(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="1e39a-254">[**InternalAcceptingInput**](/previous-versions/ms809095(v=msdn.10))</span></span>        |
| <span data-ttu-id="1e39a-255">**Lock** (implementiert als **dmolock**)</span><span class="sxs-lookup"><span data-stu-id="1e39a-255">**Lock** (implemented as **DMOLock**)</span></span> | <span data-ttu-id="1e39a-256">[**Sperren**](/previous-versions/ms809100(v=msdn.10)), [ **entsperren**](/previous-versions/ms809101(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="1e39a-256">[**Lock**](/previous-versions/ms809100(v=msdn.10)), [**Unlock**](/previous-versions/ms809101(v=msdn.10))</span></span> |
| <span data-ttu-id="1e39a-257">**"Ttinputtype"**</span><span class="sxs-lookup"><span data-stu-id="1e39a-257">**SetInputType**</span></span>                      | <span data-ttu-id="1e39a-258">[**Internalcheckinputtype**](/previous-versions/ms809096(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="1e39a-258">[**InternalCheckInputType**](/previous-versions/ms809096(v=msdn.10))</span></span>        |
| <span data-ttu-id="1e39a-259">**Setoutputtype**</span><span class="sxs-lookup"><span data-stu-id="1e39a-259">**SetOutputType**</span></span>                     | <span data-ttu-id="1e39a-260">[**Internalcheckoutputtype**](/previous-versions/ms809098(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="1e39a-260">[**InternalCheckOutputType**](/previous-versions/ms809098(v=msdn.10))</span></span>      |



 

## <a name="related-topics"></a><span data-ttu-id="1e39a-261">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1e39a-261">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1e39a-262">**Imediaobjectimpl-Klassen Vorlage**</span><span class="sxs-lookup"><span data-stu-id="1e39a-262">**IMediaObjectImpl Class Template**</span></span>](imediaobjectimpl-class-template.md)
</dt> <dt>

[<span data-ttu-id="1e39a-263">Schreiben eines DMO</span><span class="sxs-lookup"><span data-stu-id="1e39a-263">Writing a DMO</span></span>](writing-a-dmo.md)
</dt> </dl>

 

 
