---
description: In diesem Thema wird beschrieben, wie eine DLL für einen DirectShow-Filter mithilfe der DirectShow-Basisklassen implementiert wird.
ms.assetid: d47980d1-6d0c-4b0d-a875-7b072562944a
title: Klassen-und factoryvorlagen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e02699a8ff0740ddcf1d86b8514fd45dac9e32ed
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/06/2021
ms.locfileid: "104563951"
---
# <a name="class-factories-and-factory-templates"></a><span data-ttu-id="5b180-103">Klassen-und factoryvorlagen</span><span class="sxs-lookup"><span data-stu-id="5b180-103">Class Factories and Factory Templates</span></span>

<span data-ttu-id="5b180-104">In diesem Thema wird beschrieben, wie eine DLL für einen DirectShow-Filter mithilfe der [DirectShow-Basisklassen](directshow-base-classes.md)implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="5b180-104">This topic describes how to implement a DLL for a DirectShow filter, using the [DirectShow Base Classes](directshow-base-classes.md).</span></span>

<span data-ttu-id="5b180-105">Bevor ein Client eine Instanz eines COM-Objekts erstellt, erstellt er mithilfe eines Aufrufens der [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) -Funktion eine Instanz der Klassenfactory des Objekts.</span><span class="sxs-lookup"><span data-stu-id="5b180-105">Before a client creates an instance of a COM object, it creates an instance of the object's class factory, using a call to the [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) function.</span></span> <span data-ttu-id="5b180-106">Der Client ruft dann die **IClassFactory:: | ateinstance** -Methode der Klassenfactory auf.</span><span class="sxs-lookup"><span data-stu-id="5b180-106">The client then calls the class factory's **IClassFactory::CreateInstance** method.</span></span> <span data-ttu-id="5b180-107">Die Klassenfactory erstellt die Komponente und gibt einen Zeiger auf die angeforderte Schnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="5b180-107">It is the class factory that actually creates the component and returns a pointer to the requested interface.</span></span> <span data-ttu-id="5b180-108">(Die [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion kombiniert diese Schritte innerhalb des Funktions Aufrufes.)</span><span class="sxs-lookup"><span data-stu-id="5b180-108">(The [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function combines these steps, inside the function call.)</span></span>

<span data-ttu-id="5b180-109">Die folgende Abbildung zeigt die Abfolge von Methoden aufrufen.</span><span class="sxs-lookup"><span data-stu-id="5b180-109">The following illustration shows the sequence of method calls.</span></span>

![Methodenaufrufe zum Erstellen einer Klassenfactory](images/classfactory.png)

<span data-ttu-id="5b180-111">[**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) Ruft die [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) -Funktion auf, die in der dll definiert ist.</span><span class="sxs-lookup"><span data-stu-id="5b180-111">[**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) calls the [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) function, which is defined in the DLL.</span></span> <span data-ttu-id="5b180-112">Diese Funktion erstellt die Klassenfactory und gibt einen Zeiger auf eine Schnittstelle in der Klassenfactory zurück.</span><span class="sxs-lookup"><span data-stu-id="5b180-112">This function creates the class factory and returns a pointer to an interface on the class factory.</span></span> <span data-ttu-id="5b180-113">DirectShow implementiert **DllGetClassObject** für Sie, aber die Funktion verwendet den Code auf eine bestimmte Weise.</span><span class="sxs-lookup"><span data-stu-id="5b180-113">DirectShow implements **DllGetClassObject** for you, but the function relies on your code in a specific way.</span></span> <span data-ttu-id="5b180-114">Um zu verstehen, wie es funktioniert, müssen Sie verstehen, wie DirectShow Klassenfactorys implementiert.</span><span class="sxs-lookup"><span data-stu-id="5b180-114">To understand how it works, you must understand how DirectShow implements class factories.</span></span>

<span data-ttu-id="5b180-115">Eine Klassenfactory ist ein COM-Objekt, das zum Erstellen eines anderen COM-Objekts dient</span><span class="sxs-lookup"><span data-stu-id="5b180-115">A class factory is a COM object dedicated to creating another COM object.</span></span> <span data-ttu-id="5b180-116">Jede Klassenfactory hat einen Objekttyp, den Sie erstellt.</span><span class="sxs-lookup"><span data-stu-id="5b180-116">Each class factory has one type of object that it creates.</span></span> <span data-ttu-id="5b180-117">In DirectShow ist jede Klassenfactory eine Instanz der gleichen C++-Klasse, **cclassfactory**.</span><span class="sxs-lookup"><span data-stu-id="5b180-117">In DirectShow, every class factory is an instance of the same C++ class, **CClassFactory**.</span></span> <span data-ttu-id="5b180-118">Klassenfactorys werden mithilfe einer anderen Klasse, [**cfactorytemplate**](cfactorytemplate.md), spezialisiert, auch als Factoryvorlage bezeichnet. </span><span class="sxs-lookup"><span data-stu-id="5b180-118">Class factories are specialized by means of another class, [**CFactoryTemplate**](cfactorytemplate.md), also called the *factory template*.</span></span> <span data-ttu-id="5b180-119">Jede Klassenfactory enthält einen Zeiger auf eine Factoryvorlage.</span><span class="sxs-lookup"><span data-stu-id="5b180-119">Each class factory holds a pointer to a factory template.</span></span> <span data-ttu-id="5b180-120">Die Factoryvorlage enthält Informationen zu einer bestimmten Komponente, z. b. den Klassen Bezeichner (CLSID) der Komponente und einen Zeiger auf eine Funktion, die die Komponente erstellt.</span><span class="sxs-lookup"><span data-stu-id="5b180-120">The factory template contains information about a specific component, such as the component's class identifier (CLSID), and a pointer to a function that creates the component.</span></span>

<span data-ttu-id="5b180-121">Die dll deklariert ein globales Array von Factory-Vorlagen, eines für jede Komponente in der dll.</span><span class="sxs-lookup"><span data-stu-id="5b180-121">The DLL declares a global array of factory templates, one for each component in the DLL.</span></span> <span data-ttu-id="5b180-122">Wenn [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) eine neue Klassenfactory erstellt, durchsucht Sie das Array nach einer Vorlage mit einer entsprechenden CLSID.</span><span class="sxs-lookup"><span data-stu-id="5b180-122">When [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) makes a new class factory, it searches the array for a template with a matching CLSID.</span></span> <span data-ttu-id="5b180-123">Wenn Sie einen gefunden hat, wird eine Klassenfactory erstellt, die einen Zeiger auf die entsprechende Vorlage enthält.</span><span class="sxs-lookup"><span data-stu-id="5b180-123">Assuming it finds one, it creates a class factory that holds a pointer to the matching template.</span></span> <span data-ttu-id="5b180-124">Wenn der Client **IClassFactory:: kreateinstance** aufruft, ruft die Klassenfactory die in der Vorlage definierte instanzizierungsfunktion auf.</span><span class="sxs-lookup"><span data-stu-id="5b180-124">When the client calls **IClassFactory::CreateInstance**, the class factory calls the instantiation function defined in the template.</span></span>

<span data-ttu-id="5b180-125">Die folgende Abbildung zeigt die Abfolge von Methoden aufrufen.</span><span class="sxs-lookup"><span data-stu-id="5b180-125">The following illustration shows the sequence of method calls.</span></span>

![klassenfactoryvorlagen in einer dll](images/classfactory2.png)

<span data-ttu-id="5b180-127">Der Vorteil dieser Architektur besteht darin, dass Sie nur einige wenige Dinge definieren können, die für Ihre Komponente spezifisch sind, z. b. die instanzizierungsfunktion, ohne die gesamte Klassenfactory zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="5b180-127">The benefit of this architecture is that you can define just a few things that are specific to your component, such as the instantiation function, without implementing the entire class factory.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5b180-128">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="5b180-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5b180-129">Erstellen einer DirectShow-Filter-dll</span><span class="sxs-lookup"><span data-stu-id="5b180-129">How to Create a DirectShow Filter DLL</span></span>](how-to-create-a-dll.md)
</dt> </dl>

 

 
