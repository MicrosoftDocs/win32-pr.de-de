---
description: Die Enumeration der sicherheitsidentitäts Wechsel \_ \_ Ebene definiert vier Identitätswechsel Ebenen, die bestimmen, welche Vorgänge ein Server im Client Kontext ausführen kann.
ms.assetid: ae152dbf-44f0-417f-a85e-09bf60dcfcb0
title: Identitätswechsel Ebenen (Autorisierung)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b91654f42a86e5c47069197bed084df56f5445dd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106359483"
---
# <a name="impersonation-levels-authorization"></a><span data-ttu-id="acbec-103">Identitätswechsel Ebenen (Autorisierung)</span><span class="sxs-lookup"><span data-stu-id="acbec-103">Impersonation Levels (Authorization)</span></span>

<span data-ttu-id="acbec-104">Die Enumeration der [**sicherheitsidentitäts Wechsel \_ \_ Ebene**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) definiert vier Identitätswechsel Ebenen, die bestimmen, welche Vorgänge ein Server im Kontext des Clients durchführen kann.</span><span class="sxs-lookup"><span data-stu-id="acbec-104">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) enumeration defines four impersonation levels that determine the operations a server can perform in the client's context.</span></span>



| <span data-ttu-id="acbec-105">Ebene des Identitätswechsels</span><span class="sxs-lookup"><span data-stu-id="acbec-105">Impersonation level</span></span>    | <span data-ttu-id="acbec-106">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="acbec-106">Description</span></span>                                                                                      |
|------------------------|--------------------------------------------------------------------------------------------------|
| <span data-ttu-id="acbec-107">Securityanonymous</span><span class="sxs-lookup"><span data-stu-id="acbec-107">SecurityAnonymous</span></span>      | <span data-ttu-id="acbec-108">Der Server kann den Client nicht annehmen oder ihn identifizieren.</span><span class="sxs-lookup"><span data-stu-id="acbec-108">The server cannot impersonate or identify the client.</span></span>                                            |
| <span data-ttu-id="acbec-109">SecurityIdentification</span><span class="sxs-lookup"><span data-stu-id="acbec-109">SecurityIdentification</span></span> | <span data-ttu-id="acbec-110">Der Server kann die Identität und die Berechtigungen des Clients erhalten, kann jedoch nicht die Identität des Clients annehmen.</span><span class="sxs-lookup"><span data-stu-id="acbec-110">The server can get the identity and privileges of the client, but cannot impersonate the client.</span></span> |
| <span data-ttu-id="acbec-111">Securityidentitäts Wechsel</span><span class="sxs-lookup"><span data-stu-id="acbec-111">SecurityImpersonation</span></span>  | <span data-ttu-id="acbec-112">Der Server kann den Sicherheitskontext des Clients auf dem lokalen System imitieren.</span><span class="sxs-lookup"><span data-stu-id="acbec-112">The server can impersonate the client's security context on the local system.</span></span>                    |
| <span data-ttu-id="acbec-113">SecurityDelegation</span><span class="sxs-lookup"><span data-stu-id="acbec-113">SecurityDelegation</span></span>     | <span data-ttu-id="acbec-114">Der Server kann den Sicherheitskontext des Clients auf Remote Systemen imitieren.</span><span class="sxs-lookup"><span data-stu-id="acbec-114">The server can impersonate the client's security context on remote systems.</span></span>                      |



 

<span data-ttu-id="acbec-115">Der Client einer Named Pipe-, RPC-oder DDE-Verbindung kann die Identitätswechsel Ebene steuern.</span><span class="sxs-lookup"><span data-stu-id="acbec-115">The client of a named pipe, RPC, or DDE connection can control the impersonation level.</span></span> <span data-ttu-id="acbec-116">Ein Named Pipe Client kann z. b. die [**Funktion "**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) -Funktion" aufrufen, um ein Handle für eine Named Pipe zu öffnen und die Identitätswechsel Ebene des Servers anzugeben.</span><span class="sxs-lookup"><span data-stu-id="acbec-116">For example, a named pipe client can call the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function to open a handle to a named pipe and specify the server's impersonation level.</span></span>

<span data-ttu-id="acbec-117">Wenn die Named Pipe-, RPC-oder DDE-Verbindung Remote ist, werden die Flags, die an die " [**kreatefile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) " übergeben werden, um die Identitätswechsel Ebene festzulegen, ignoriert</span><span class="sxs-lookup"><span data-stu-id="acbec-117">When the named pipe, RPC, or DDE connection is remote, the flags passed to [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) to set the impersonation level are ignored.</span></span> <span data-ttu-id="acbec-118">In diesem Fall wird die Identitätswechsel Ebene des Clients durch die vom Server aktivierten Identitätswechsel Ebenen bestimmt, der durch ein Flag für das Konto des Servers im Verzeichnisdienst festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="acbec-118">In this case, the impersonation level of the client is determined by the impersonation levels enabled by the server, which is set by a flag on the server's account in the directory service.</span></span> <span data-ttu-id="acbec-119">Wenn z. b. der Server für die Delegierung aktiviert ist, wird die Identitätswechsel Ebene des Clients auch auf Delegierung festgelegt, auch wenn die Flags, die an " **anatefile** " übergeben werden, die Identitäts Identitätswechsel Ebene angeben.</span><span class="sxs-lookup"><span data-stu-id="acbec-119">For example, if the server is enabled for delegation, the client's impersonation level will also be set to delegation even if the flags passed to **CreateFile** specify the identification impersonation level.</span></span>

<span data-ttu-id="acbec-120">DDE-Clients verwenden die [**ddesetqualityofservice**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) -Funktion mit der [**Security \_ Quality \_ of \_ Service**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) -Struktur, um die Identitätswechsel Ebene anzugeben.</span><span class="sxs-lookup"><span data-stu-id="acbec-120">DDE clients use the [**DdeSetQualityOfService**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) function with the [**SECURITY\_QUALITY\_OF\_SERVICE**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) structure to specify the impersonation level.</span></span> <span data-ttu-id="acbec-121">Die Security-Identitätswechsel Ebene ist die Standardeinstellung für Named Pipe-, RPC-und DDE-Server.</span><span class="sxs-lookup"><span data-stu-id="acbec-121">The SecurityImpersonation level is the default for named pipe, RPC, and DDE servers.</span></span> <span data-ttu-id="acbec-122">Die Funktionen Identität [**ateself**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**duplicatetoken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken)und [**duplicatetokenex**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) ermöglichen es dem Aufrufer, eine Identitätswechsel Ebene anzugeben.</span><span class="sxs-lookup"><span data-stu-id="acbec-122">The [**ImpersonateSelf**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**DuplicateToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken), and [**DuplicateTokenEx**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) functions allow the caller to specify an impersonation level.</span></span> <span data-ttu-id="acbec-123">Verwenden Sie die [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) -Funktion, um die Identitätswechsel Ebene eines [*Zugriffs*](/windows/desktop/SecGloss/a-gly)Tokens abzurufen.</span><span class="sxs-lookup"><span data-stu-id="acbec-123">Use the [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) function to retrieve the impersonation level of an [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="acbec-124">Auf der Security-Identitätswechsel Ebene treten die meisten Aktionen des Threads im Sicherheitskontext des Identitätswechsel Tokens des Threads auf [*, nicht im*](/windows/desktop/SecGloss/i-gly) [*primären Token*](/windows/desktop/SecGloss/p-gly) des [*Prozesses*](/windows/desktop/SecGloss/p-gly) , der den Thread besitzt.</span><span class="sxs-lookup"><span data-stu-id="acbec-124">At the SecurityImpersonation level, most of the thread's actions occur in the security context of the thread's [*impersonation token*](/windows/desktop/SecGloss/i-gly) rather than in the [*primary token*](/windows/desktop/SecGloss/p-gly) of the [*process*](/windows/desktop/SecGloss/p-gly) that owns the thread.</span></span> <span data-ttu-id="acbec-125">Wenn ein Identitätswechsel Thread z. b. ein Sicherungs [fähiges Objekt](securable-objects.md)öffnet, verwendet das System das Identitätswechsel Token, um den Thread Zugriff zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="acbec-125">For example, if an impersonating thread opens a [securable object](securable-objects.md), the system uses the impersonation token to check the thread's access.</span></span> <span data-ttu-id="acbec-126">Wenn ein Identitätswechsel Thread z. b. ein neues Objekt erstellt, z. b. durch Aufrufen der [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) -Funktion, ist der Besitzer des neuen Objekts der Standard Besitzer aus dem [*Zugriffs Token*](/windows/desktop/SecGloss/a-gly)des Clients.</span><span class="sxs-lookup"><span data-stu-id="acbec-126">Similarly, if an impersonating thread creates a new object, for example by calling the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function, the owner of the new object is the default owner from the client's [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="acbec-127">Das System verwendet jedoch das primäre Token des Prozesses anstelle des Identitätswechsel Tokens des aufrufenden Threads in den folgenden Situationen:</span><span class="sxs-lookup"><span data-stu-id="acbec-127">However, the system uses the primary token of the process rather than the impersonation token of the calling thread in the following situations:</span></span>

-   <span data-ttu-id="acbec-128">Wenn ein Identitätswechsel Thread die Funktion " [**forateprocess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) " aufruft, erbt der neue Prozess immer das primäre Token des Prozesses.</span><span class="sxs-lookup"><span data-stu-id="acbec-128">If an impersonating thread calls the [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function, the new process always inherits the primary token of the process.</span></span>
-   <span data-ttu-id="acbec-129">Für Funktionen, die die "SE \_ TCB Name"-Berechtigung erfordern (z. b. \_ die [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) -Funktion), prüft das System immer, ob die Berechtigung im primären Token des Prozesses besteht.</span><span class="sxs-lookup"><span data-stu-id="acbec-129">For functions that require the SE\_TCB\_NAME privilege, such as the [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="acbec-130">Für Funktionen, die die Berechtigung "SE \_ Audit Name" erfordern \_ , wie z. b. die [**objectopenauditalarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) -Funktion, prüft das System immer, ob die Berechtigung im primären Token des Prozesses besteht.</span><span class="sxs-lookup"><span data-stu-id="acbec-130">For functions that require the SE\_AUDIT\_NAME privilege, such as the [**ObjectOpenAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="acbec-131">Bei einem Aufrufen der [**openthumtotokenfunktion**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) kann ein Thread angeben, ob die Funktion das Identitätswechsel Token oder das primäre Token verwendet, um zu bestimmen, ob der angeforderte Zugriff gewährt werden soll.</span><span class="sxs-lookup"><span data-stu-id="acbec-131">In a call to the [**OpenThreadToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) function, a thread can specify whether the function uses the impersonation token or the primary token to determine whether to grant the requested access.</span></span>

 

 
