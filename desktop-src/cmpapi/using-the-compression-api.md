---
description: Viele Anwendungen müssen Verlust lose Datenkomprimierung und-Komprimierung verwenden. Die Komprimierungs-API vereinfacht dies durch die Bereitstellung von Windows-Komprimierungs Algorithmen über eine öffentliche API.
ms.assetid: D603A7DE-D4A1-4515-9702-B03C81504661
title: Verwenden der Komprimierungs-API
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 01eff163f4ea1ccf03e1cd4ac9cb16a26afeb265
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104127413"
---
# <a name="using-the-compression-api"></a><span data-ttu-id="e73df-104">Verwenden der Komprimierungs-API</span><span class="sxs-lookup"><span data-stu-id="e73df-104">Using the Compression API</span></span>

<span data-ttu-id="e73df-105">Viele Anwendungen müssen Verlust lose Datenkomprimierung und-Komprimierung verwenden.</span><span class="sxs-lookup"><span data-stu-id="e73df-105">Many applications need to use lossless data compression and decompression.</span></span> <span data-ttu-id="e73df-106">Die Komprimierungs-API vereinfacht dies durch die Bereitstellung von Windows-Komprimierungs Algorithmen über eine öffentliche API.</span><span class="sxs-lookup"><span data-stu-id="e73df-106">The Compression API simplifies this by exposing Windows compression algorithms through a public API.</span></span> <span data-ttu-id="e73df-107">Jeder Komprimierungs Algorithmus verfügt über eine Reihe von Eigenschaften, die das Verhalten steuern.</span><span class="sxs-lookup"><span data-stu-id="e73df-107">Each compression algorithm has a set of properties that controls its behavior.</span></span> <span data-ttu-id="e73df-108">Die Komprimierungs-API macht eine Schnittstelle verfügbar, die es dem Entwickler ermöglicht, die Werte dieser Eigenschaften festzulegen oder abzufragen.</span><span class="sxs-lookup"><span data-stu-id="e73df-108">The Compression API exposes an interface that enables the developer to set or query the values of these properties.</span></span> <span data-ttu-id="e73df-109">Alle Eigenschaften für die unterstützten Komprimierungs Algorithmen verfügen über Standardwerte, die häufig verwendete Werte dieser Eigenschaften darstellen.</span><span class="sxs-lookup"><span data-stu-id="e73df-109">All properties for the supported compression algorithms have default values representing commonly used values of these properties.</span></span> <span data-ttu-id="e73df-110">Wenn eine Eigenschaft sowohl für die Komprimierung als auch für die Komprimierung erforderlich ist, sind die Standardwerte identisch und stellen sicher, dass identische Werte für die Komprimierung und die Komprimierung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e73df-110">If a property is required for both compression and decompression, the default values will be identical, ensuring identical values are used for compression and decompression.</span></span>

## <a name="selecting-the-compression-algorithm"></a><span data-ttu-id="e73df-111">Auswählen des Komprimierungs Algorithmus</span><span class="sxs-lookup"><span data-stu-id="e73df-111">Selecting the compression algorithm</span></span>

<span data-ttu-id="e73df-112">Nachdem ein Entwickler entschieden hat, dass eine Anwendung Daten komprimieren oder Dekomprimieren muss, besteht der nächste Schritt darin, einen Komprimierungs Algorithmus auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="e73df-112">After a developer decides that an application needs to compress or decompress data, the next step is to choose a compression algorithm.</span></span> <span data-ttu-id="e73df-113">Dies hängt möglicherweise von Tests ab, um die optimale Kombination aus Geschwindigkeit, Komprimierungs Verhältnis und Arbeitsspeicher Anforderung für eine bestimmte Anwendung zu finden.</span><span class="sxs-lookup"><span data-stu-id="e73df-113">This may depend upon tests to find the best performing combination of speed, compression ratio, and memory requirement for a particular application.</span></span> <span data-ttu-id="e73df-114">Die folgende Liste enthält einen relativen Vergleich der Komprimierungs Algorithmen, die derzeit von der Komprimierungs-API unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="e73df-114">The following list gives a relative comparison of the compression algorithms currently supported by the Compression API.</span></span> <span data-ttu-id="e73df-115">Nicht jede Option ist für jeden Komprimierungs Algorithmus verfügbar, und der Vergleich ist ungefähre Werte, da die Leistung von den Eingabedaten abhängen kann.</span><span class="sxs-lookup"><span data-stu-id="e73df-115">Not every option is available for every compression algorithm, and the comparison is approximate because performance can depend on the input data.</span></span>

<span data-ttu-id="e73df-116">Xpress (**Komprimierungs \_ Algorithmus \_ Xpress**)</span><span class="sxs-lookup"><span data-stu-id="e73df-116">XPRESS (**COMPRESS\_ALGORITHM\_XPRESS**)</span></span>

-   <span data-ttu-id="e73df-117">Sehr schnell mit geringen Ressourcenanforderungen</span><span class="sxs-lookup"><span data-stu-id="e73df-117">Very fast with low resource requirements</span></span>
-   <span data-ttu-id="e73df-118">Verhältnis für mittlere Komprimierung</span><span class="sxs-lookup"><span data-stu-id="e73df-118">Medium compression ratio</span></span>
-   <span data-ttu-id="e73df-119">Hohe Komprimierungs-und Komprimierungs Geschwindigkeiten</span><span class="sxs-lookup"><span data-stu-id="e73df-119">High compression and decompression speeds</span></span>
-   <span data-ttu-id="e73df-120">Wenig Arbeitsspeicher erforderlich</span><span class="sxs-lookup"><span data-stu-id="e73df-120">Low memory requirement</span></span>
-   <span data-ttu-id="e73df-121">Unterstützt die in der [**Klasse "Komprimieren von \_ Informations \_ Klassen**](/windows/desktop/api/compressapi/ne-compressapi-compress_information_class) " verfügbare Option auf **\_ \_ Klassen \_ Ebene komprimieren** .</span><span class="sxs-lookup"><span data-stu-id="e73df-121">Supports the **COMPRESS\_INFORMATION\_CLASS\_LEVEL** option available in the [**COMPRESS\_INFORMATION\_CLASS**](/windows/desktop/api/compressapi/ne-compressapi-compress_information_class) enumeration.</span></span> <span data-ttu-id="e73df-122">Der Standardwert ist **(DWORD) 0**.</span><span class="sxs-lookup"><span data-stu-id="e73df-122">The default value is **(DWORD)0**.</span></span> <span data-ttu-id="e73df-123">Für einige Daten kann der Wert **(DWORD) 1** das Komprimierungs Verhältnis mit einer etwas langsameren Komprimierungs Geschwindigkeit verbessern.</span><span class="sxs-lookup"><span data-stu-id="e73df-123">For some data, the value **(DWORD)1** can improve the compression ratio with a slightly slower compression speed.</span></span>

<span data-ttu-id="e73df-124">Xpress mit Huffman Encoding (**Komprimieren von \_ Algorithmus \_ Xpress \_ Huff**)</span><span class="sxs-lookup"><span data-stu-id="e73df-124">XPRESS with Huffman encoding (**COMPRESS\_ALGORITHM\_XPRESS\_HUFF**)</span></span>

-   <span data-ttu-id="e73df-125">Das Komprimierungs Verhältnis ist höher als der **Komprimierungs \_ Algorithmus \_ Xpress**</span><span class="sxs-lookup"><span data-stu-id="e73df-125">Compression ratio is higher than **COMPRESS\_ALGORITHM\_XPRESS**</span></span>
-   <span data-ttu-id="e73df-126">Verhältnis für mittlere Komprimierung</span><span class="sxs-lookup"><span data-stu-id="e73df-126">Medium compression ratio</span></span>
-   <span data-ttu-id="e73df-127">Geschwindigkeiten für mittlere bis hohe Komprimierung und-Komprimierung</span><span class="sxs-lookup"><span data-stu-id="e73df-127">Medium to high compression and decompression speeds</span></span>
-   <span data-ttu-id="e73df-128">Wenig Arbeitsspeicher erforderlich</span><span class="sxs-lookup"><span data-stu-id="e73df-128">Low memory requirement</span></span>
-   <span data-ttu-id="e73df-129">Unterstützt die Option " **\_ Informationen auf \_ Klassen \_ Ebene komprimieren** " in der " [**Compress \_ Information \_ Class**](/windows/desktop/api/compressapi/ne-compressapi-compress_information_class) "-Enumeration.</span><span class="sxs-lookup"><span data-stu-id="e73df-129">Supports the **COMPRESS\_INFORMATION\_CLASS\_LEVEL** option in the [**COMPRESS\_INFORMATION\_CLASS**](/windows/desktop/api/compressapi/ne-compressapi-compress_information_class) enumeration.</span></span> <span data-ttu-id="e73df-130">Der Standardwert ist **(DWORD) 0**.</span><span class="sxs-lookup"><span data-stu-id="e73df-130">The default value is **(DWORD)0**.</span></span> <span data-ttu-id="e73df-131">Für einige Daten kann der Wert **(DWORD) 1** das Komprimierungs Verhältnis mit einer etwas langsameren Komprimierungs Geschwindigkeit verbessern.</span><span class="sxs-lookup"><span data-stu-id="e73df-131">For some data, the value **(DWORD)1** can improve the compression ratio with a slightly slower compression speed.</span></span>

<span data-ttu-id="e73df-132">mszip (**\_ Algorithmus mit \_ mszip komprimieren**)</span><span class="sxs-lookup"><span data-stu-id="e73df-132">MSZIP (**COMPRESS\_ALGORITHM\_MSZIP**)</span></span>

-   <span data-ttu-id="e73df-133">Verwendet mehr Ressourcen als " **Komprimieren von \_ Algorithmus \_ Xpress \_ Huff** ".</span><span class="sxs-lookup"><span data-stu-id="e73df-133">Uses more resources than **COMPRESS\_ALGORITHM\_XPRESS\_HUFF**</span></span>
-   <span data-ttu-id="e73df-134">Generiert einen komprimierten Block ähnlich RFC 1951.</span><span class="sxs-lookup"><span data-stu-id="e73df-134">Generates a compressed block similar to RFC 1951.</span></span>
-   <span data-ttu-id="e73df-135">Verhältnis zwischen mittlerer und hoher Komprimierung</span><span class="sxs-lookup"><span data-stu-id="e73df-135">Medium to high compression ratio</span></span>
-   <span data-ttu-id="e73df-136">Geschwindigkeit mittlerer Komprimierung und hohe Komprimierungs Geschwindigkeit</span><span class="sxs-lookup"><span data-stu-id="e73df-136">Medium compression speed and high decompression speed</span></span>
-   <span data-ttu-id="e73df-137">Mittlere Arbeitsspeicher Anforderung</span><span class="sxs-lookup"><span data-stu-id="e73df-137">Medium memory requirement</span></span>

<span data-ttu-id="e73df-138">lzms (**\_ Algorithmus- \_ lzms komprimieren**)</span><span class="sxs-lookup"><span data-stu-id="e73df-138">LZMS (**COMPRESS\_ALGORITHM\_LZMS**)</span></span>

-   <span data-ttu-id="e73df-139">Guter Algorithmus, wenn die Größe der zu komprimierenden Daten größer als 2 MB ist.</span><span class="sxs-lookup"><span data-stu-id="e73df-139">Good algorithm if the size of the data to be compressed is over 2MB.</span></span>
-   <span data-ttu-id="e73df-140">Hohes Komprimierungs Verhältnis</span><span class="sxs-lookup"><span data-stu-id="e73df-140">High compression ratio</span></span>
-   <span data-ttu-id="e73df-141">Geschwindigkeit bei niedriger Komprimierung und hohe Komprimierungs Geschwindigkeit</span><span class="sxs-lookup"><span data-stu-id="e73df-141">Low compression speed and high decompression speed</span></span>
-   <span data-ttu-id="e73df-142">Anforderung für mittlere und hohe Arbeitsspeicher</span><span class="sxs-lookup"><span data-stu-id="e73df-142">Medium to high memory requirement</span></span>
-   <span data-ttu-id="e73df-143">Unterstützt die Option " **\_ Informationen \_ Klassen \_ Block \_ Größe komprimieren** " in der " [**Compress \_ Information \_ Class**](/windows/desktop/api/compressapi/ne-compressapi-compress_information_class) "-Enumeration.</span><span class="sxs-lookup"><span data-stu-id="e73df-143">Supports the **COMPRESS\_INFORMATION\_CLASS\_BLOCK\_SIZE** option in the [**COMPRESS\_INFORMATION\_CLASS**](/windows/desktop/api/compressapi/ne-compressapi-compress_information_class) enumeration.</span></span> <span data-ttu-id="e73df-144">Eine minimale Größe von 1 MB wird empfohlen, um ein besseres Komprimierungs Verhältnis zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="e73df-144">A minimum size of 1 MB is suggested to get a better compression ratio.</span></span>

## <a name="deciding-which-compression-api-mode-to-use"></a><span data-ttu-id="e73df-145">Entscheiden, welcher Komprimierungs-API-Modus verwendet werden soll</span><span class="sxs-lookup"><span data-stu-id="e73df-145">Deciding which Compression API mode to use</span></span>

<span data-ttu-id="e73df-146">Nachdem ein Entwickler den Komprimierungs Algorithmus ausgewählt hat, ist die nächste Entscheidung, welche der beiden Modi der Komprimierungs-API verwendet werden soll: Puffer Modus oder Block Modus.</span><span class="sxs-lookup"><span data-stu-id="e73df-146">After a developer selects the compression algorithm, the next decision is which of the two modes of the Compression API to use: buffer mode or block mode.</span></span> <span data-ttu-id="e73df-147">Der Puffer Modus wurde zur einfachen Verwendung entwickelt und wird in den meisten Fällen empfohlen.</span><span class="sxs-lookup"><span data-stu-id="e73df-147">Buffer mode was developed for ease of use and is recommended for most cases.</span></span>

<span data-ttu-id="e73df-148">Der Puffer Modus teilt automatisch den Eingabepuffer in Blöcke einer Größe auf, die für den ausgewählten Komprimierungs Algorithmus geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="e73df-148">Buffer mode automatically splits up the input buffer into blocks of a size that is appropriate for the selected compression algorithm.</span></span> <span data-ttu-id="e73df-149">Der Puffer Modus formatiert und speichert automatisch die nicht komprimierte Puffergröße im komprimierten Puffer.</span><span class="sxs-lookup"><span data-stu-id="e73df-149">The buffer mode automatically formats and stores the uncompressed buffer size in the compressed buffer.</span></span> <span data-ttu-id="e73df-150">Die Größe des komprimierten Puffers wird nicht automatisch gespeichert, und die Anwendung muss dies für die Komprimierung speichern.</span><span class="sxs-lookup"><span data-stu-id="e73df-150">The size of the compressed buffer is not automatically saved, and the application needs to save this for decompression.</span></span> <span data-ttu-id="e73df-151">Schließen Sie das Flag zum **Komprimieren von \_ Rohdaten** nicht in den Algorithmusparameter ein, wenn Sie zum Verwenden des Puffer Modus "  [**kreatecompressor**](/windows/desktop/api/compressapi/nf-compressapi-createcompressor) " und " [**kreatede**](/windows/desktop/api/compressapi/nf-compressapi-createdecompressor)</span><span class="sxs-lookup"><span data-stu-id="e73df-151">Do not include the **COMPRESS\_RAW** flag in the *Algorithm* parameter when you call [**CreateCompressor**](/windows/desktop/api/compressapi/nf-compressapi-createcompressor) and [**CreateDecompressor**](/windows/desktop/api/compressapi/nf-compressapi-createdecompressor) to use buffer mode.</span></span> <span data-ttu-id="e73df-152">Ein Codebeispiel für eine puffermodusanwendung finden Sie im Abschnitt [Verwenden der Komprimierungs-API im Puffer Modus](using-the-compression-api-in-buffer-mode.md) .</span><span class="sxs-lookup"><span data-stu-id="e73df-152">For a code example of a buffer mode application, see the [Using the Compression API in buffer mode](using-the-compression-api-in-buffer-mode.md) section.</span></span>

<span data-ttu-id="e73df-153">Der Block Modus ermöglicht es dem Entwickler, die Blockgröße zu steuern, erfordert jedoch mehr Arbeit durch die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="e73df-153">Block mode enables the developer to control the block size, but requires more work be done by the application.</span></span> <span data-ttu-id="e73df-154">Wenn Sie den Block Modus verwenden, muss die Anwendung die Eingabedaten bei der Komprimierung in ordnungsgemäß formatierte Teile aufteilen und Sie dann beim Dekomprimieren wieder zusammensetzen.</span><span class="sxs-lookup"><span data-stu-id="e73df-154">When using block mode, the application has to break the input data into appropriately sized pieces when compressing and then put the pieces back together when decompressing.</span></span> <span data-ttu-id="e73df-155">Der Block Modus schlägt fehl, wenn die Größe des Eingabe Puffers größer als die interne Blockgröße des Komprimierungs Algorithmus ist.</span><span class="sxs-lookup"><span data-stu-id="e73df-155">The block mode fails if the size of the input buffer is greater than the internal block size of the compression algorithm.</span></span> <span data-ttu-id="e73df-156">Die interne Blockgröße beträgt 32 KB für mszip und 1 GB für die Xpress-Komprimierungs Algorithmen.</span><span class="sxs-lookup"><span data-stu-id="e73df-156">The internal block size is 32KB for the MSZIP and 1GB for the XPRESS compression algorithms.</span></span> <span data-ttu-id="e73df-157">Die interne Blockgröße für lzms kann bis zu 64 GB mit einer entsprechenden Erhöhung der Arbeitsspeicher Nutzung konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="e73df-157">The internal block size for LZMS is configurable up to 64GB with a corresponding increase in memory use.</span></span> <span data-ttu-id="e73df-158">Die Größe des komprimierten Puffers wird nicht automatisch gespeichert, und die Anwendung muss dies auch für die Komprimierung speichern.</span><span class="sxs-lookup"><span data-stu-id="e73df-158">The size of the compressed buffer is not automatically saved, and the application also needs to save this for decompression.</span></span> <span data-ttu-id="e73df-159">Der Wert des *uncompressedbuffersize* -Parameters von [**Decompress**](/windows/desktop/api/compressapi/nf-compressapi-decompress) muss genau gleich der ursprünglichen Größe der nicht komprimierten Daten und nicht nur der Größe des Ausgabepuffers sein.</span><span class="sxs-lookup"><span data-stu-id="e73df-159">The value of *UncompressedBufferSize* parameter of [**Decompress**](/windows/desktop/api/compressapi/nf-compressapi-decompress) must be exactly equal to the original size of the uncompressed data and not just the size of the output buffer.</span></span> <span data-ttu-id="e73df-160">Dies bedeutet, dass Ihre Anwendung bei Verwendung des Block Modus die genaue ursprüngliche Größe der nicht komprimierten Daten sowie die komprimierten Daten und die komprimierte Größe speichern sollte.</span><span class="sxs-lookup"><span data-stu-id="e73df-160">This means your application should save the exact original size of the uncompressed data, as well as the compressed data and compressed size, when using block mode.</span></span> <span data-ttu-id="e73df-161">Schließen Sie das Flag zum **Komprimieren von \_ Rohdaten** in den Algorithmusparameter ein, wenn Sie sowohl " [**kreatecompressor**](/windows/desktop/api/compressapi/nf-compressapi-createcompressor) " als auch " [**anatedekompressor**](/windows/desktop/api/compressapi/nf-compressapi-createdecompressor) " für </span><span class="sxs-lookup"><span data-stu-id="e73df-161">Include the **COMPRESS\_RAW** flag in the *Algorithm* parameter when you call both [**CreateCompressor**](/windows/desktop/api/compressapi/nf-compressapi-createcompressor) and [**CreateDecompressor**](/windows/desktop/api/compressapi/nf-compressapi-createdecompressor) to use block mode.</span></span> <span data-ttu-id="e73df-162">Ein Codebeispiel für eine blockmodusanwendung finden Sie im Abschnitt [using the Compression API in Block Mode](using-the-compression-api-in-block-mode.md) .</span><span class="sxs-lookup"><span data-stu-id="e73df-162">For a code example of a block mode application, see the [Using the Compression API in block mode](using-the-compression-api-in-block-mode.md) section.</span></span>

## <a name="custom-memory-allocation"></a><span data-ttu-id="e73df-163">Benutzerdefinierte Speicher Belegung</span><span class="sxs-lookup"><span data-stu-id="e73df-163">Custom memory allocation</span></span>

<span data-ttu-id="e73df-164">Puffer-und blockmodusanwendungen haben die Möglichkeit, eine benutzerdefinierte Speicher Belegungs Routine anzugeben, wenn Sie " [**kreatecompressor**](/windows/desktop/api/compressapi/nf-compressapi-createcompressor) " und " [**kreatedekompressor**](/windows/desktop/api/compressapi/nf-compressapi-createdecompressor)" aufrufen.</span><span class="sxs-lookup"><span data-stu-id="e73df-164">Buffer and block mode applications have the option to specify a custom memory allocation routine when they call [**CreateCompressor**](/windows/desktop/api/compressapi/nf-compressapi-createcompressor) and [**CreateDecompressor**](/windows/desktop/api/compressapi/nf-compressapi-createdecompressor).</span></span> <span data-ttu-id="e73df-165">Der *allocationroutinen* -Parameter gibt die Struktur der [**komprimieren- \_ Zuordnungs \_ Routinen**](/windows/desktop/api/compressapi/ns-compressapi-compress_allocation_routines) an, die die Speicher Belegungs Routine enthält.</span><span class="sxs-lookup"><span data-stu-id="e73df-165">The *AllocationRoutines* parameter specifies the [**COMPRESS\_ALLOCATION\_ROUTINES**](/windows/desktop/api/compressapi/ns-compressapi-compress_allocation_routines) structure that contains the memory allocation routine.</span></span> <span data-ttu-id="e73df-166">Die Anwendung kann dann die Blockgröße für den Kompressor mithilfe von [**setcompressorinformation**](/windows/desktop/api/compressapi/nf-compressapi-setcompressorinformation)festlegen.</span><span class="sxs-lookup"><span data-stu-id="e73df-166">The application can then set the block size for the compressor using [**SetCompressorInformation**](/windows/desktop/api/compressapi/nf-compressapi-setcompressorinformation).</span></span> <span data-ttu-id="e73df-167">Ein Beispiel für eine einfache, angepasste Zuordnungs Routine finden Sie im Abschnitt [Verwenden des Komprimierungs-API im Block Modus](using-the-compression-api-in-block-mode.md) .</span><span class="sxs-lookup"><span data-stu-id="e73df-167">See the [Using the Compression API in block mode](using-the-compression-api-in-block-mode.md) section for an example of a simple customized allocation routine.</span></span>

 

 



