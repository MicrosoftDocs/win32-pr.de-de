---
description: Empfehlungen für optimale Dateisystem Transaktionen.
ms.assetid: 847939ff-5322-4023-8ef7-9d845e80d65c
title: Überlegungen zur Leistung von transaktionalen NTFS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3a71f7e100e1ddd8524932a4a259a12092bddcb6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "103960394"
---
# <a name="performance-considerations-for-transactional-ntfs"></a><span data-ttu-id="be884-103">Überlegungen zur Leistung von transaktionalen NTFS</span><span class="sxs-lookup"><span data-stu-id="be884-103">Performance Considerations for Transactional NTFS</span></span>

<span data-ttu-id="be884-104">Transaktionale NTFS (TxF) wurde sorgfältig für die Leistung entwickelt und führt in der Regel eine bessere Leistung als allgemeine Transaktions Alternativen in ähnlichen Szenarien aus.</span><span class="sxs-lookup"><span data-stu-id="be884-104">Transactional NTFS (TxF) has been carefully designed for performance and will typically perform better than general-purpose transactional alternatives under similar scenarios.</span></span> <span data-ttu-id="be884-105">Dateisystem Transaktionen haben jedoch mehr Aufwand als nicht transaktive Vorgänge, und eine gewisse Verringerung der e/a-Leistung im Vergleich zu nicht transaktionalen e/a-Vorgängen ist zu erwarten.</span><span class="sxs-lookup"><span data-stu-id="be884-105">However, file system transactions have more overhead than non-transacted operations, and some reduction in I/O performance compared to non-transacted I/O is to be expected.</span></span> <span data-ttu-id="be884-106">Leistungskritische Anwendungen sollten einen Einführungs Zeitraum für die Technologie Einführung durchführen und die Auswirkungen auf die Leistung von transaktiven Dateisystem Vorgängen auswerten.</span><span class="sxs-lookup"><span data-stu-id="be884-106">Performance-critical applications should perform a technology adoption qualification cycle, evaluating the performance impact of transacted file system operations.</span></span>

## <a name="overview-of-txf-operations"></a><span data-ttu-id="be884-107">Übersicht über TxF-Vorgänge</span><span class="sxs-lookup"><span data-stu-id="be884-107">Overview of TxF Operations</span></span>

<span data-ttu-id="be884-108">TxF verwendet die *Rückgängig* -Protokollierung zum Aufzeichnen der Änderungen, die erforderlich sind, um das Dateisystem wieder in einen konsistenten Zustand zu versetzen, der auch als Rollback bezeichnet wird, wenn ein Transaktions Abbruch auftritt.</span><span class="sxs-lookup"><span data-stu-id="be884-108">TxF uses *undo* logging to record the changes necessary to put the file system back into a consistent state, also referred to as a rollback, should a transaction abort occur.</span></span> <span data-ttu-id="be884-109">Diese rückgängig-Protokollierung generiert zusätzliche e/a-Vorgänge und ist die Quelle des TxF-Leistungs Aufwands im Vergleich zu nicht transaktionalen Dateisystem Vorgängen.</span><span class="sxs-lookup"><span data-stu-id="be884-109">This undo logging generates additional I/O and is the source of TxF performance overhead compared to non-transactional file system operations.</span></span>

<span data-ttu-id="be884-110">Eine allgemeine Zusammenfassung der Funktionsweise von TxF sieht wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="be884-110">A high-level summary of how TxF operates is as follows:</span></span>

-   <span data-ttu-id="be884-111">Im Verlauf einer Transaktion schreibt TxF *Rückgängig* -Datensätze für jede Änderung, die Sie an das Dateisystem vornimmt, in die zugehörige Protokolldatei.</span><span class="sxs-lookup"><span data-stu-id="be884-111">As a transaction progresses, TxF writes *undo* records into its log file for each modification it makes to the file system.</span></span> <span data-ttu-id="be884-112">Wenn ein Abbruch auftritt, werden diese rückgängig-Datensätze analysiert, um das Dateisystem wieder in den Zustand zu versetzen, in dem es sich vor Beginn der Transaktion befand.</span><span class="sxs-lookup"><span data-stu-id="be884-112">If an abort occurs, these undo records are parsed to put the file system back in the state it was before the transaction began.</span></span>
-   <span data-ttu-id="be884-113">Ein rückgängig-Datensatz für *Metadatenänderungen* beschreibt eine Änderung nur für die Metadaten des Dateisystems.</span><span class="sxs-lookup"><span data-stu-id="be884-113">A *metadata change* undo record describes a change only to the file system's metadata.</span></span> <span data-ttu-id="be884-114">Einige Beispiele hierfür sind verschiebe-, Umbenennungs-, appends-und Attribut Änderungen.</span><span class="sxs-lookup"><span data-stu-id="be884-114">Some examples of this are moves, renames, appends, and attribute changes.</span></span> <span data-ttu-id="be884-115">Bei der rückgängig-Datensätze für Metadatenänderungen werden alle zum Rückgängigmachen der Änderung erforderlichen Informationen im Datensatz gespeichert und in der Protokolldatei gespeichert.</span><span class="sxs-lookup"><span data-stu-id="be884-115">For metadata change undo records, all of the information necessary to undo the change is in the record and stored in the log file.</span></span>
-   <span data-ttu-id="be884-116">Ein rückgängig-Datensatz über *Schreiben* beschreibt das Überschreiben eines Teils einer Datei.</span><span class="sxs-lookup"><span data-stu-id="be884-116">An *overwrite* undo record describes an overwrite of a portion of a file.</span></span> <span data-ttu-id="be884-117">Wenn eine Datei überschrieben wird, werden die ursprünglichen Inhalte der Datei in einer speziellen Rückgängigdatei in einem ausgeblendeten Verzeichnis gespeichert, und das Überschreibungs Daten Satz-Datensatz verweist auf diese Datei.</span><span class="sxs-lookup"><span data-stu-id="be884-117">When a file overwrite occurs, the file's original contents are stored in a special undo file in a hidden directory and the overwrite undo record points to this file.</span></span> <span data-ttu-id="be884-118">Wenn Datei Updates schließlich vom Cache auf den Datenträger geleert werden, muss auch der Inhalt der rückgängig-Datei geleert werden, sodass eine transaktive Datei Überschreibung bis zu zwei zusätzliche zufällige e/a-Vorgänge generieren kann: eine zum Lesen der alten Daten und eine, um Sie in die rückgängig-Datei zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="be884-118">When file updates are eventually flushed from cache to disk, the contents of the undo file must also be flushed, so a transacted file overwrite could generate up to two extra random I/O operations: one to read the old data and one to write it to the undo file.</span></span> <span data-ttu-id="be884-119">Diese zusätzlichen e/a-Vorgänge sind Leistungskosten von TxF.</span><span class="sxs-lookup"><span data-stu-id="be884-119">These extra I/O operations are a performance cost of TxF.</span></span>
-   <span data-ttu-id="be884-120">Wenn ein Commit ausgeführt wird, leert TxF zuerst alle Rückgängig-Informationen, leert dann die eigentlichen Dateiänderungen und schreibt und leert einen Commitdatensatz.</span><span class="sxs-lookup"><span data-stu-id="be884-120">When a commit occurs, TxF first flushes all undo information, then flushes the actual file changes, and then writes and flushes a commit record.</span></span> <span data-ttu-id="be884-121">Wenn keine rückgängig-Dateien geleert werden sollen, ist der einzige zusätzliche TxF-mehr Aufwand im Verhältnis zu nicht transaktionalen e/a-Vorgängen, dass das Protokoll selbst geleert wird.</span><span class="sxs-lookup"><span data-stu-id="be884-121">If there are no undo files to flush, the only additional TxF overhead relative to non-transacted I/O is the log flushes themselves.</span></span> <span data-ttu-id="be884-122">Protokoll Leerungen führen jedoch zu effizienten großen sequenziellen Schreibvorgängen, sodass die Leistungskosten minimal sind.</span><span class="sxs-lookup"><span data-stu-id="be884-122">However, log flushes result in efficient large sequential writes so the performance cost is minimal.</span></span>
-   <span data-ttu-id="be884-123">TxF ist für den Commit optimiert.</span><span class="sxs-lookup"><span data-stu-id="be884-123">TxF is optimized for commit.</span></span> <span data-ttu-id="be884-124">Es wird erwartet, dass die meisten Transaktionen erfolgreich sind und kein Rollback ausgeführt werden muss. Daher werden alle rückgängig-Datensätze für eine Transaktion nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="be884-124">It is expected that most transactions will succeed and not need to rollback, therefore all undo records for a transaction are expected to go unused.</span></span> <span data-ttu-id="be884-125">Im Hinblick auf die Leistung sind TxF-Commit-Vorgänge schnell und Rollbacks sind ressourcenintensiv.</span><span class="sxs-lookup"><span data-stu-id="be884-125">From a performance perspective, TxF commit operations are fast and rollbacks are resource-intensive.</span></span>
-   <span data-ttu-id="be884-126">Ein Rollback ist ressourcenintensiver als Commit.</span><span class="sxs-lookup"><span data-stu-id="be884-126">Rollback is more resource-intensive than commit.</span></span> <span data-ttu-id="be884-127">Während des Rollbacks müssen alle Änderungen, die in der Transaktion vorgenommen wurden, nicht ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="be884-127">During rollback, all the changes that were made in the transaction have to be un-done.</span></span> <span data-ttu-id="be884-128">Im Allgemeinen kann die Rollback-Dauer ungefähr so lange dauern, bis die Änderungen ursprünglich vorgenommen wurden.</span><span class="sxs-lookup"><span data-stu-id="be884-128">In general, rollback duration can be approximately the same it took to originally make the changes.</span></span> <span data-ttu-id="be884-129">Wenn z. b. 1 Sekunde benötigt wird, um alle Änderungen vorzunehmen, kann es ungefähr 1 Sekunde dauern, bis die Änderungen rückgängig gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="be884-129">For example, if it took 1 second to make all the changes then it could take about 1 second to undo them.</span></span> <span data-ttu-id="be884-130">Bei sehr langen Transaktionen kann das Rollback zu zusätzlichen Leistungsbeeinträchtigungen führen.</span><span class="sxs-lookup"><span data-stu-id="be884-130">For very long transactions, rollback can create additional performance impacts.</span></span> <span data-ttu-id="be884-131">Beispielsweise kann die Systemstart Zeit verzögert werden, wenn das System automatisch ein Rollback für eine Transaktion ausführen muss, falls das System nicht mehr reagiert und einen nicht geplanten Neustart ausführen muss.</span><span class="sxs-lookup"><span data-stu-id="be884-131">For example, system boot time can be delayed if the system must automatically rollback a transaction in the event that the system stops responding and must perform an unscheduled restart.</span></span>

<span data-ttu-id="be884-132">Im folgenden finden Sie eine Übersicht über die Leistung, die aus der vorherigen Liste gezeichnet werden kann:</span><span class="sxs-lookup"><span data-stu-id="be884-132">The summary conclusions about performance that can be drawn from the previous list are as follows:</span></span>

-   <span data-ttu-id="be884-133">Die Leistungseinbußen von TxF für Transaktionen, die Datei Überschreibungen betreffen, können signifikant sein.</span><span class="sxs-lookup"><span data-stu-id="be884-133">The performance cost of TxF for transactions involving file overwrites can be significant.</span></span>
-   <span data-ttu-id="be884-134">Die Leistungseinbußen von TxF für Transaktionen, die nur Metadatenvorgänge betreffen, können relativ gering sein, sofern große Transaktionen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="be884-134">The performance cost of TxF for transactions involving only metadata operations can be relatively low, provided large transactions be used.</span></span> <span data-ttu-id="be884-135">Eine große Transaktion ist, wenn für jeden Commitdatensatz viele rückgängig-Datensätze vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="be884-135">A large transaction is when there are many undo records for every commit record.</span></span>

## <a name="recommendations-for-best-performance"></a><span data-ttu-id="be884-136">Empfehlungen für eine optimale Leistung</span><span class="sxs-lookup"><span data-stu-id="be884-136">Recommendations For Best Performance</span></span>

<span data-ttu-id="be884-137">Amortisieren Sie den TxF-Aufwand für größere Transaktionen.</span><span class="sxs-lookup"><span data-stu-id="be884-137">Amortize TxF overhead over larger transactions.</span></span> <span data-ttu-id="be884-138">Wenn Sie z. b. über *n* Gruppen von Änderungen verfügen, bei denen jede Änderung über *m* Schritte verfügt, und Sie die Möglichkeit haben, dies entweder als *N* Transaktionen von *m* Schritten auszuführen, oder alles als einzelne Transaktion mit *M* \* *N* Schritten auszuführen, wäre die zweite Option effizienter.</span><span class="sxs-lookup"><span data-stu-id="be884-138">For example, if you have *N* sets of changes to make where each change has *M* steps and you have the option to either do this as *N* transactions of *M* steps each or do it all as a single transaction with *M*\**N* steps, the latter option would be more efficient.</span></span>

<span data-ttu-id="be884-139">Beachten Sie die möglichen Auswirkungen auf das Starten von sehr großen Transaktionen.</span><span class="sxs-lookup"><span data-stu-id="be884-139">Consider the possible impact on boot of very large transactions.</span></span> <span data-ttu-id="be884-140">Wie bereits erwähnt, kann ein Rollback langsam sein und die Startzeit verzögern, wenn das System automatische Rollbacks als Startzeit ausführen muss.</span><span class="sxs-lookup"><span data-stu-id="be884-140">As previously stated, rollback can be slow and will delay boot time if the system needs to perform automatic rollbacks as boot time.</span></span> <span data-ttu-id="be884-141">Je größer die Transaktion ist, desto länger ist die Verzögerung.</span><span class="sxs-lookup"><span data-stu-id="be884-141">The larger the transaction, the longer the delay.</span></span>

<span data-ttu-id="be884-142">Behalten Sie Transaktionen vor allem bei metadatenvorgängen bei.</span><span class="sxs-lookup"><span data-stu-id="be884-142">Keep transactions to mostly metadata operations.</span></span> <span data-ttu-id="be884-143">Dies ist die Optimierung von TxF für und im Allgemeinen ist die Leistung ungefähr identisch mit der nicht transaktiven Datei-e/a für große metadatentransaktionen.</span><span class="sxs-lookup"><span data-stu-id="be884-143">This is what TxF is optimized for and, in general, the performance is about the same as non-transacted file I/O for large metadata transactions.</span></span> <span data-ttu-id="be884-144">Beispiele für effiziente metadatentxf-Funktionen sind " [**fivefiletransaktive**](/windows/desktop/api/WinBase/nf-winbase-movefiletransacteda)", " [**setfileattributestransagiert**](/windows/desktop/api/WinBase/nf-winbase-setfileattributestransacteda)", " [**copyfiletransktive**](/windows/desktop/api/WinBase/nf-winbase-copyfiletransacteda)", " [**deletefiletransktive**](/windows/desktop/api/WinBase/nf-winbase-deletefiletransacteda)", " [**kreatehardlinktransktive**](/windows/desktop/api/WinBase/nf-winbase-createhardlinktransacteda)" und "angefügte Schreibvorgänge" (Aufrufe der Funktion " [**Write File**](/windows/desktop/api/FileAPI/nf-fileapi-writefile) ", wenn der Dateizeiger am Ende der Datei oder " *EOF*</span><span class="sxs-lookup"><span data-stu-id="be884-144">Examples of efficient metadata TxF functions are [**MoveFileTransacted**](/windows/desktop/api/WinBase/nf-winbase-movefiletransacteda), [**SetFileAttributesTransacted**](/windows/desktop/api/WinBase/nf-winbase-setfileattributestransacteda), [**CopyFileTransacted**](/windows/desktop/api/WinBase/nf-winbase-copyfiletransacteda), [**DeleteFileTransacted**](/windows/desktop/api/WinBase/nf-winbase-deletefiletransacteda), [**CreateHardLinkTransacted**](/windows/desktop/api/WinBase/nf-winbase-createhardlinktransacteda), and appended writes (calls to the [**WriteFile**](/windows/desktop/api/FileAPI/nf-fileapi-writefile) function when the file pointer as at the end the file, or *EOF*).</span></span> <span data-ttu-id="be884-145">Ein Beispiel für ressourcenintensive nicht-Metadatenvorgänge sind Aufrufe der Funktion " **Write File** ", wenn sich der Dateizeiger nicht am EOF-Element befindet.</span><span class="sxs-lookup"><span data-stu-id="be884-145">An example of resource-intensive non-metadata operations are calls to the **WriteFile** function when the file pointer is not at the EOF.</span></span>

## <a name="summary-of-txf-performance-expectations"></a><span data-ttu-id="be884-146">Zusammenfassung der TxF-Leistungserwartungen</span><span class="sxs-lookup"><span data-stu-id="be884-146">Summary of TxF Performance Expectations</span></span>

<span data-ttu-id="be884-147">Bei direkten Updates sind über Schreibungen in einen Abschnitt einer Datei viel langsamer als nicht transaktive Datei-e/a-Vorgänge, während die TxF-Leistung für Dateisystem-Metadatenvorgänge (z. b. Create, Move und Append) mit nicht transaktionalen Datei-e/a für große Transaktionen vergleichbar ist.</span><span class="sxs-lookup"><span data-stu-id="be884-147">For in-place updates, overwrites to a section of a file will be much slower than non-transacted file I/O, while TxF performance for file system metadata operations (for example, create, move, and append) is comparable to non-transacted file I/O for large transactions.</span></span>

 

 



