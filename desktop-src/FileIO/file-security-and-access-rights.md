---
description: Da es sich bei Dateien um Sicherungs fähige Objekte handelt, wird der Zugriff darauf durch das Zugriffs Steuerungsmodell reguliert, das den Zugriff auf alle anderen Sicherungs fähigen Objekte in Windows steuert.
ms.assetid: 991d7d94-fae7-406f-b2e3-dee811279366
title: Datei Sicherheit und Zugriffsrechte
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b161dd78c7585cf6de2781d7339787a22bde95dc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106347080"
---
# <a name="file-security-and-access-rights"></a><span data-ttu-id="3b2cb-103">Datei Sicherheit und Zugriffsrechte</span><span class="sxs-lookup"><span data-stu-id="3b2cb-103">File Security and Access Rights</span></span>

<span data-ttu-id="3b2cb-104">Da es sich bei Dateien um Sicherungs [fähige Objekte](/windows/desktop/SecAuthZ/securable-objects)handelt, wird der Zugriff darauf durch das Zugriffs Steuerungsmodell reguliert, das den Zugriff auf alle anderen Sicherungs fähigen Objekte in Windows steuert.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-104">Because files are [securable objects](/windows/desktop/SecAuthZ/securable-objects), access to them is regulated by the access-control model that governs access to all other securable objects in Windows.</span></span> <span data-ttu-id="3b2cb-105">Eine ausführliche Erläuterung dieses Modells finden Sie unter [Access Control](/windows/desktop/SecAuthZ/access-control).</span><span class="sxs-lookup"><span data-stu-id="3b2cb-105">For a detailed explanation of this model, see [Access Control](/windows/desktop/SecAuthZ/access-control).</span></span>

<span data-ttu-id="3b2cb-106">Sie können eine [Sicherheits Beschreibung](/windows/desktop/api/winnt/ns-winnt-security_descriptor) für eine Datei oder ein Verzeichnis [**angeben, wenn Sie die Funktion**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea)"up", " [**kreatedirectory**](/windows/desktop/api/FileAPI/nf-fileapi-createdirectorya)" oder " [**kreatedirectoryex**](/windows/desktop/api/WinBase/nf-winbase-createdirectoryexa) " aufrufen.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-106">You can specify a [security descriptor](/windows/desktop/api/winnt/ns-winnt-security_descriptor) for a file or directory when you call the [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea), [**CreateDirectory**](/windows/desktop/api/FileAPI/nf-fileapi-createdirectorya), or [**CreateDirectoryEx**](/windows/desktop/api/WinBase/nf-winbase-createdirectoryexa) function.</span></span> <span data-ttu-id="3b2cb-107">Wenn Sie für den *lpsecurityattribute* -Parameter **null** angeben, erhält die Datei oder das Verzeichnis eine Standard Sicherheits Beschreibung.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-107">If you specify **NULL** for the *lpSecurityAttributes* parameter, the file or directory gets a default security descriptor.</span></span> <span data-ttu-id="3b2cb-108">Die Zugriffs Steuerungs Listen (Access Control Lists, ACL) in der Standard Sicherheits Beschreibung für eine Datei oder ein Verzeichnis werden von ihrem übergeordneten Verzeichnis geerbt.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-108">The access control lists (ACL) in the default security descriptor for a file or directory are inherited from its parent directory.</span></span> <span data-ttu-id="3b2cb-109">Beachten Sie, dass eine Standard Sicherheits Beschreibung nur zugewiesen wird, wenn eine Datei oder ein Verzeichnis neu erstellt wird, und nicht, wenn Sie umbenannt oder verschoben wird.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-109">Note that a default security descriptor is assigned only when a file or directory is newly created, and not when it is renamed or moved.</span></span>

<span data-ttu-id="3b2cb-110">Um die Sicherheits Beschreibung eines Datei-oder Verzeichnis Objekts abzurufen, rufen Sie die [**GetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getnamedsecurityinfoa) -oder [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) -Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-110">To retrieve the security descriptor of a file or directory object, call the [**GetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getnamedsecurityinfoa) or [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) function.</span></span> <span data-ttu-id="3b2cb-111">Um die Sicherheits Beschreibung eines Datei-oder Verzeichnis Objekts zu ändern, müssen Sie die Funktion [**SetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setnamedsecurityinfoa) oder [**setsecurityinfo**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) aufrufen.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-111">To change the security descriptor of a file or directory object, call the [**SetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setnamedsecurityinfoa) or [**SetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) function.</span></span>

<span data-ttu-id="3b2cb-112">Zu den gültigen Zugriffsrechten für Dateien und Verzeichnisse gehören die Berechtigungen **Löschen**, **Lese \_ Steuerung**, **Schreib- \_ DAC**, **\_ Besitzer schreiben** und [Standard Zugriff](/windows/desktop/SecAuthZ/standard-access-rights) **Synchronisieren** .</span><span class="sxs-lookup"><span data-stu-id="3b2cb-112">The valid access rights for files and directories include the **DELETE**, **READ\_CONTROL**, **WRITE\_DAC**, **WRITE\_OWNER**, and **SYNCHRONIZE** [standard access rights](/windows/desktop/SecAuthZ/standard-access-rights).</span></span> <span data-ttu-id="3b2cb-113">In der Tabelle unter [**Datei Zugriffsrechte Konstanten**](file-access-rights-constants.md) werden die Zugriffsrechte aufgelistet, die für Dateien und Verzeichnisse spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-113">The table in [**File Access Rights Constants**](file-access-rights-constants.md) lists the access rights that are specific to files and directories.</span></span>

<span data-ttu-id="3b2cb-114">Obwohl das **Synchronisierungs** Zugriffsrecht in der [Standard-Zugriffsrechte](/windows/desktop/SecAuthZ/standard-access-rights) Liste als Recht zum Angeben eines Datei Handles in einer der Warte Funktionen definiert ist, sollten Sie bei Verwendung asynchroner Datei-e/a-Vorgänge auf das Ereignis Handle warten, das in einer ordnungsgemäß konfigurierten [**über**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) Lapp enden Struktur enthalten ist, anstatt das Datei Handle mit dem **Synchronisierungs** Zugriffsrecht für die Synchronisierung zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-114">Although the **SYNCHRONIZE** access right is defined within the [standard access rights](/windows/desktop/SecAuthZ/standard-access-rights) list as the right to specify a file handle in one of the wait functions, when using asynchronous file I/O operations you should wait on the event handle contained in a properly configured [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure rather than using the file handle with the **SYNCHRONIZE** access right for synchronization.</span></span>

<span data-ttu-id="3b2cb-115">Im folgenden finden Sie die [allgemeinen Zugriffsrechte](/windows/desktop/SecAuthZ/generic-access-rights) für Dateien und Verzeichnisse.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-115">The following are the [generic access rights](/windows/desktop/SecAuthZ/generic-access-rights) for files and directories.</span></span>



<table>
<thead>
<tr class="header">
<th><span data-ttu-id="3b2cb-116">Zugriffsrecht</span><span class="sxs-lookup"><span data-stu-id="3b2cb-116">Access right</span></span></th>
<th><span data-ttu-id="3b2cb-117">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="3b2cb-117">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="3b2cb-118"><strong>FILE_GENERIC_EXECUTE</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-118"><strong>FILE_GENERIC_EXECUTE</strong></span></span></td>
<td><dl> <span data-ttu-id="3b2cb-119"><strong>FILE_EXECUTE</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-119"><strong>FILE_EXECUTE</strong></span></span><br /><span data-ttu-id="3b2cb-120">
<strong>FILE_READ_ATTRIBUTES</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-120">
<strong>FILE_READ_ATTRIBUTES</strong></span></span><br /><span data-ttu-id="3b2cb-121">
<strong>STANDARD_RIGHTS_EXECUTE</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-121">
<strong>STANDARD_RIGHTS_EXECUTE</strong></span></span><br /><span data-ttu-id="3b2cb-122">
<strong>SYNCHRONIZE</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-122">
<strong>SYNCHRONIZE</strong></span></span><br />
</dl></td>
</tr>
<tr class="even">
<td><span data-ttu-id="3b2cb-123"><strong>FILE_GENERIC_READ</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-123"><strong>FILE_GENERIC_READ</strong></span></span></td>
<td><dl> <span data-ttu-id="3b2cb-124"><strong>FILE_READ_ATTRIBUTES</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-124"><strong>FILE_READ_ATTRIBUTES</strong></span></span><br /><span data-ttu-id="3b2cb-125">
<strong>FILE_READ_DATA</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-125">
<strong>FILE_READ_DATA</strong></span></span><br /><span data-ttu-id="3b2cb-126">
<strong>FILE_READ_EA</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-126">
<strong>FILE_READ_EA</strong></span></span><br /><span data-ttu-id="3b2cb-127">
<strong>STANDARD_RIGHTS_READ</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-127">
<strong>STANDARD_RIGHTS_READ</strong></span></span><br /><span data-ttu-id="3b2cb-128">
<strong>SYNCHRONIZE</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-128">
<strong>SYNCHRONIZE</strong></span></span><br />
</dl></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="3b2cb-129"><strong>FILE_GENERIC_WRITE</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-129"><strong>FILE_GENERIC_WRITE</strong></span></span></td>
<td><dl> <span data-ttu-id="3b2cb-130"><strong>FILE_APPEND_DATA</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-130"><strong>FILE_APPEND_DATA</strong></span></span><br /><span data-ttu-id="3b2cb-131">
<strong>FILE_WRITE_ATTRIBUTES</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-131">
<strong>FILE_WRITE_ATTRIBUTES</strong></span></span><br /><span data-ttu-id="3b2cb-132">
<strong>FILE_WRITE_DATA</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-132">
<strong>FILE_WRITE_DATA</strong></span></span><br /><span data-ttu-id="3b2cb-133">
<strong>FILE_WRITE_EA</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-133">
<strong>FILE_WRITE_EA</strong></span></span><br /><span data-ttu-id="3b2cb-134">
<strong>STANDARD_RIGHTS_WRITE</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-134">
<strong>STANDARD_RIGHTS_WRITE</strong></span></span><br /><span data-ttu-id="3b2cb-135">
<strong>SYNCHRONIZE</strong></span><span class="sxs-lookup"><span data-stu-id="3b2cb-135">
<strong>SYNCHRONIZE</strong></span></span><br />
</dl></td>
</tr>
</tbody>
</table>



 

<span data-ttu-id="3b2cb-136">Windows vergleicht die angeforderten Zugriffsrechte und die Informationen im Zugriffs Token des Threads mit den Informationen in der Sicherheits Beschreibung des Datei-oder Verzeichnis Objekts.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-136">Windows compares the requested access rights and the information in the thread's access token with the information in the file or directory object's security descriptor.</span></span> <span data-ttu-id="3b2cb-137">Wenn beim Vergleich nicht alle angeforderten Zugriffsrechte erteilt werden, wird ein Handle für das Objekt an den Thread zurückgegeben, und die Zugriffsrechte werden gewährt.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-137">If the comparison does not prohibit all of the requested access rights from being granted, a handle to the object is returned to the thread and the access rights are granted.</span></span> <span data-ttu-id="3b2cb-138">Weitere Informationen zu diesem Prozess finden Sie unter [Interaktion zwischen Threads und Sicherungs fähigen Objekten](/windows/desktop/SecAuthZ/interaction-between-threads-and-securable-objects).</span><span class="sxs-lookup"><span data-stu-id="3b2cb-138">For more information about this process, see [Interaction between Threads and Securable Objects](/windows/desktop/SecAuthZ/interaction-between-threads-and-securable-objects).</span></span>

<span data-ttu-id="3b2cb-139">Standardmäßig wird die Autorisierung für den Zugriff auf eine Datei oder ein Verzeichnis strikt durch die ACLs in der Sicherheits Beschreibung gesteuert, die mit dieser Datei oder diesem Verzeichnis verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-139">By default, authorization for access to a file or directory is controlled strictly by the ACLs in the security descriptor associated with that file or directory.</span></span> <span data-ttu-id="3b2cb-140">Insbesondere wird die Sicherheits Beschreibung eines übergeordneten Verzeichnisses nicht verwendet, um den Zugriff auf untergeordnete Dateien oder Verzeichnisse zu steuern.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-140">In particular, the security descriptor of a parent directory is not used to control access to any child file or directory.</span></span> <span data-ttu-id="3b2cb-141">Das [Zugriffsrecht](/windows/desktop/SecAuthZ/access-rights-and-access-masks) " **Datei \_** durchlaufen" kann erzwungen werden, indem die **Umgehungs \_ \_ Überprüfungs** [Berechtigung](/windows/desktop/SecAuthZ/privileges) "Bypass" von Benutzern entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-141">The **FILE\_TRAVERSE** [access right](/windows/desktop/SecAuthZ/access-rights-and-access-masks) can be enforced by removing the **BYPASS\_TRAVERSE\_CHECKING** [privilege](/windows/desktop/SecAuthZ/privileges) from users.</span></span> <span data-ttu-id="3b2cb-142">Dies wird im Allgemeinen nicht empfohlen, da viele Programme Verzeichnis Durchlauf Fehler nicht ordnungsgemäß behandeln.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-142">This is not recommended in the general case, as many programs do not correctly handle directory traversal errors.</span></span> <span data-ttu-id="3b2cb-143">Der primäre Verwendungszweck des **Datei \_** Zugriffs auf Verzeichnisse besteht darin, die Konformität mit bestimmten IEEE-und ISO POSIX-Standards zu aktivieren, wenn die Interoperabilität mit UNIX-Systemen erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-143">The primary use for the **FILE\_TRAVERSE** access right on directories is to enable conformance to certain IEEE and ISO POSIX standards when interoperability with Unix systems is a requirement.</span></span>

<span data-ttu-id="3b2cb-144">Das Windows-Sicherheitsmodell bietet die Möglichkeit, ein untergeordnetes Verzeichnis zu erben bzw. zu verhindern, dass eines oder mehrere der ACEs in der Sicherheits Beschreibung des übergeordneten Verzeichnisses vererbt werden.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-144">The Windows security model provides a way for a child directory to inherit, or to be prevented from inheriting, one or more of the ACEs in the parent directory's security descriptor.</span></span> <span data-ttu-id="3b2cb-145">Jeder ACE enthält Informationen, die bestimmen, wie er geerbt werden kann, und ob er Auswirkungen auf das erbende Verzeichnis Objekt hat.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-145">Each ACE contains information that determines how it can be inherited, and whether it will have an effect on the inheriting directory object.</span></span> <span data-ttu-id="3b2cb-146">Einige geerbte ACEs Steuern beispielsweise den Zugriff auf das geerbte Verzeichnis Objekt, und diese werden als *effektive ACEs* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-146">For example, some inherited ACEs control access to the inherited directory object, and these are called *effective ACEs*.</span></span> <span data-ttu-id="3b2cb-147">Alle anderen ACEs werden als *Vererbung-only-ACEs* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-147">All other ACEs are called *inherit-only ACEs*.</span></span>

<span data-ttu-id="3b2cb-148">Das Windows-Sicherheitsmodell erzwingt auch die automatische Vererbung von ACEs zu untergeordneten Objekten gemäß den [ACE-Vererbungs Regeln](/windows/desktop/SecAuthZ/ace-inheritance-rules).</span><span class="sxs-lookup"><span data-stu-id="3b2cb-148">The Windows security model also enforces the automatic inheritance of ACEs to child objects according to the [ACE inheritance rules](/windows/desktop/SecAuthZ/ace-inheritance-rules).</span></span> <span data-ttu-id="3b2cb-149">Diese automatische Vererbung bestimmt zusammen mit den Vererbungs Informationen in jedem ACE, wie Sicherheitseinschränkungen in der Verzeichnishierarchie nach unten weitergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-149">This automatic inheritance, along with the inheritance information in each ACE, determines how security restrictions are passed down the directory hierarchy.</span></span>

<span data-ttu-id="3b2cb-150">Beachten Sie, dass Sie einen Access-denied-ACE nicht verwenden können, um nur den **generischen \_ Lese** Zugriff oder nur den **generischen \_ Schreib** Zugriff auf eine Datei abzulehnen</span><span class="sxs-lookup"><span data-stu-id="3b2cb-150">Note that you cannot use an access-denied ACE to deny only **GENERIC\_READ** or only **GENERIC\_WRITE** access to a file.</span></span> <span data-ttu-id="3b2cb-151">Dies liegt daran, dass bei Datei Objekten die generischen Zuordnungen sowohl für den **generischen \_ Lese** -als auch für den **generischen \_ Schreib** Zugriff das **Synchronisierungs** Zugriffsrecht</span><span class="sxs-lookup"><span data-stu-id="3b2cb-151">This is because for file objects, the generic mappings for both **GENERIC\_READ** or **GENERIC\_WRITE** include the **SYNCHRONIZE** access right.</span></span> <span data-ttu-id="3b2cb-152">Wenn ein ACE **generischen \_ Schreib** Zugriff auf einen Vertrauens nehmer verweigert und der Treuhänder **generischen \_ Lese** Zugriff anfordert, schlägt die Anforderung fehl, da die Anforderung implizit den **Synchronisierungs** Zugriff einschließt, der vom ACE implizit verweigert wird, und umgekehrt.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-152">If an ACE denies **GENERIC\_WRITE** access to a trustee, and the trustee requests **GENERIC\_READ** access, the request will fail because the request implicitly includes **SYNCHRONIZE** access which is implicitly denied by the ACE, and vice versa.</span></span> <span data-ttu-id="3b2cb-153">Anstatt Zugriffs Verweigerungs-ACEs zu verwenden, verwenden Sie Zugriffs zulässige ACEs, um die zulässigen Zugriffsrechte explizit zuzulassen.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-153">Instead of using access-denied ACEs, use access-allowed ACEs to explicitly allow the permitted access rights.</span></span>

<span data-ttu-id="3b2cb-154">Eine weitere Möglichkeit, den Zugriff auf Speicher Objekte zu verwalten, ist die Verschlüsselung.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-154">Another means of managing access to storage objects is encryption.</span></span> <span data-ttu-id="3b2cb-155">Bei der Implementierung der Dateisystem Verschlüsselung in Windows handelt es sich um das verschlüsselte Dateisystem (EFS).</span><span class="sxs-lookup"><span data-stu-id="3b2cb-155">The implementation of file system encryption in Windows is the Encrypted File System, or EFS.</span></span> <span data-ttu-id="3b2cb-156">EFS verschlüsselt nur Dateien und keine Verzeichnisse.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-156">EFS encrypts only files and not directories.</span></span> <span data-ttu-id="3b2cb-157">Der Vorteil der Verschlüsselung besteht darin, dass Sie zusätzlichen Schutz für Dateien bietet, die auf die Medien angewendet werden, nicht über das Dateisystem und die standardmäßige Windows-Zugriffs Steuerungsarchitektur.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-157">The advantage of encryption is that it provides additional protection to files that is applied on the media and not through the file system and the standard Windows access control architecture.</span></span> <span data-ttu-id="3b2cb-158">Weitere Informationen zur Dateiverschlüsselung finden Sie unter [Dateiverschlüsselung](file-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="3b2cb-158">For more information on file encryption, see [File Encryption](file-encryption.md).</span></span>

<span data-ttu-id="3b2cb-159">In den meisten Fällen ist die Möglichkeit, die Sicherheitseinstellungen eines Datei-oder Verzeichnis Objekts zu lesen und zu schreiben, auf Kernel Modus-Prozesse beschränkt.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-159">In most cases, the ability to read and write the security settings of a file or directory object is restricted to kernel-mode processes.</span></span> <span data-ttu-id="3b2cb-160">Es ist natürlich nicht ratsam, dass ein Benutzer Prozess in der Lage ist, den Besitz oder die Zugriffsbeschränkung für die private Datei oder das Verzeichnis zu ändern.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-160">Clearly, you would not want any user process to be able to change the ownership or access restriction on your private file or directory.</span></span> <span data-ttu-id="3b2cb-161">Allerdings kann eine Sicherungs Anwendung die Sicherung der Datei nicht durchführen, wenn die Zugriffsbeschränkungen, die Sie für die Datei oder das Verzeichnis festgelegt haben, den Benutzermodusprozess der Anwendung nicht zulassen.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-161">However, a backup application would not be able to complete its job of backing up your file if the access restrictions you have placed on your file or directory does not allow the application's user-mode process to read it.</span></span> <span data-ttu-id="3b2cb-162">Sicherungs Anwendungen müssen in der Lage sein, die Sicherheitseinstellungen von Datei-und Verzeichnis Objekten außer Kraft zu setzen, um eine komplette Sicherung sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-162">Backup applications must be able to override the security settings of file and directory objects to ensure a complete backup.</span></span> <span data-ttu-id="3b2cb-163">Wenn eine Sicherungs Anwendung versucht, eine Sicherungskopie der Datei über die Datenträger residente Kopie zu schreiben, und Sie explizit Schreibberechtigungen für den Sicherungs Anwendungsprozess verweigern, kann der Wiederherstellungs Vorgang nicht beendet werden.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-163">Similarly, if a backup application attempts to write a backup copy of your file over the disk-resident copy, and you explicitly deny write privileges to the backup application process, the restore operation cannot complete.</span></span> <span data-ttu-id="3b2cb-164">In diesem Fall muss die Sicherungs Anwendung in der Lage sein, die Zugriffs Steuerungseinstellungen der Datei zu überschreiben.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-164">In this case also, the backup application must be able to override the access control settings of your file.</span></span>

<span data-ttu-id="3b2cb-165">Die Berechtigungen " **SE \_ Backup \_ Name** " und " **SE \_ Restore \_ Name** Access" wurden speziell erstellt, um die Möglichkeit zum Sichern von Anwendungen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-165">The **SE\_BACKUP\_NAME** and **SE\_RESTORE\_NAME** access privileges were specifically created to provide this ability to backup applications.</span></span> <span data-ttu-id="3b2cb-166">Wenn diese Berechtigungen im Zugriffs Token des Sicherungs Anwendungsprozesses erteilt und aktiviert wurden, kann Sie dann die Datei oder das Verzeichnis für die [**Sicherung aufrufen,**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) um die Datei oder das Verzeichnis für die Sicherung zu öffnen. dabei wird der standardmäßige **Lese \_ Steuer** Element-Zugriffsrecht als Wert des *dwDesiredAccess* -Parameters angegeben.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-166">If these privileges have been granted and enabled in the access token of the backup application process, it can then call [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) to open your file or directory for backup, specifying the standard **READ\_CONTROL** access right as the value of the *dwDesiredAccess* parameter.</span></span> <span data-ttu-id="3b2cb-167">Um den aufrufenden Prozess jedoch als Sicherungsprozess zu identifizieren, muss der Aufruf von **CreateFile** das **Dateiflag für die \_ \_ Sicherungs \_ Semantik** in den *dwflagsandattributs-Parameter* einschließen.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-167">However, to identify the calling process as a backup process, the call to **CreateFile** must include the **FILE\_FLAG\_BACKUP\_SEMANTICS** flag in the *dwFlagsAndAttributes* parameter.</span></span> <span data-ttu-id="3b2cb-168">Die vollständige Syntax des Funktions Aufrufes lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="3b2cb-168">The full syntax of the function call is the following:</span></span>


```C++
HANDLE hFile = CreateFile( fileName,                   // lpFileName
                           READ_CONTROL,               // dwDesiredAccess
                           0,                          // dwShareMode
                           NULL,                       // lpSecurityAttributes
                           OPEN_EXISTING,              // dwCreationDisposition
                           FILE_FLAG_BACKUP_SEMANTICS, // dwFlagsAndAttributes
                           NULL );                     // hTemplateFile
```



<span data-ttu-id="3b2cb-169">Dadurch kann der Sicherungs Anwendungsprozess Ihre Datei öffnen und die Standard Sicherheitsüberprüfung außer Kraft setzen.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-169">This will allow the backup application process to open your file and override the standard security checking.</span></span> <span data-ttu-id="3b2cb-170">Zum Wiederherstellen der Datei verwendet die Sicherungs Anwendung die folgende Syntax [](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) des aufrufungsdateiaufrufes, wenn Sie die Datei öffnen, die geschrieben werden soll.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-170">To restore your file, the backup application would use the following [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) call syntax when opening your file to be written.</span></span>


```C++
HANDLE hFile = CreateFile( fileName,                   // lpFileName
                           WRITE_OWNER | WRITE_DAC,    // dwDesiredAccess
                           0,                          // dwShareMode
                           NULL,                       // lpSecurityAttributes
                           CREATE_ALWAYS,              // dwCreationDisposition
                           FILE_FLAG_BACKUP_SEMANTICS, // dwFlagsAndAttributes
                           NULL );                     // hTemplateFile
```



<span data-ttu-id="3b2cb-171">Es gibt Situationen, in denen eine Sicherungs Anwendung in der Lage sein muss, die Zugriffs Steuerungseinstellungen einer Datei oder eines Verzeichnisses zu ändern.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-171">There are situations when a backup application must be able to change the access control settings of a file or directory.</span></span> <span data-ttu-id="3b2cb-172">Dies ist beispielsweise der Fall, wenn sich die Zugriffs Steuerungseinstellungen der Datenträger Residenten Kopie einer Datei oder eines Verzeichnisses von der Sicherungskopie unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-172">An example is when the access control settings of the disk-resident copy of a file or directory is different from the backup copy.</span></span> <span data-ttu-id="3b2cb-173">Dies wäre der Fall, wenn diese Einstellungen geändert wurden, nachdem die Datei oder das Verzeichnis gesichert wurde, oder wenn Sie beschädigt war.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-173">This would happen if these settings were changed after the file or directory was backed up, or if it was corrupted.</span></span>

<span data-ttu-id="3b2cb-174">Das Flag für die **\_ \_ Sicherungs \_ Semantik der Datei** Kennzeichen, das im Aufrufen von " [**anatefile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) " angegeben wird, erteilt der Sicherungs Anwendungsprozess Berechtigung zum Lesen der Zugriffs Steuerungseinstellungen der Datei oder des Verzeichnisses.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-174">The **FILE\_FLAG\_BACKUP\_SEMANTICS** flag specified in the call to [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea) gives the backup application process permission to read the access-control settings of the file or directory.</span></span> <span data-ttu-id="3b2cb-175">Mit dieser Berechtigung kann der Sicherungs Anwendungsprozess [**getkernelobjectsecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getkernelobjectsecurity) und [**setkernelobjectsecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-setkernelobjectsecurity) aufrufen, um die Einstellungen für die Zugriffs Steuerung zu lesen und zu übersetzen.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-175">With this permission, the backup application process can then call [**GetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-getkernelobjectsecurity) and [**SetKernelObjectSecurity**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-setkernelobjectsecurity) to read and than reset the access-control settings.</span></span>

<span data-ttu-id="3b2cb-176">Wenn eine Sicherungs Anwendung Zugriff auf die Einstellungen für die [Zugriffs Steuerung](/windows/desktop/SecAuthZ/access-control-lists)auf Systemebene haben muss, muss das Sicherheitskennzeichen des **Zugriffs \_ \_ Systems** im *dwDesiredAccess* -Parameterwert angegeben werden, der an " [**kreatefile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea)" übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-176">If a backup application must have access to the system-level [access control settings](/windows/desktop/SecAuthZ/access-control-lists), the **ACCESS\_SYSTEM\_SECURITY** flag must be specified in the *dwDesiredAccess* parameter value passed to [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea).</span></span>

<span data-ttu-id="3b2cb-177">Sicherungs Anwendungen rufen [**BackupRead**](/windows/desktop/api/winbase/nf-winbase-backupread) auf, um die Dateien und Verzeichnisse zu lesen, die für den Wiederherstellungs Vorgang angegeben wurden, und [**BackupWrite**](/windows/desktop/api/winbase/nf-winbase-backupwrite) , um Sie zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="3b2cb-177">Backup applications call [**BackupRead**](/windows/desktop/api/winbase/nf-winbase-backupread) to read the files and directories specified for the restore operation, and [**BackupWrite**](/windows/desktop/api/winbase/nf-winbase-backupwrite) to write them.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3b2cb-178">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="3b2cb-178">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3b2cb-179">Standard Zugriffsrechte</span><span class="sxs-lookup"><span data-stu-id="3b2cb-179">standard access rights</span></span>](/windows/desktop/SecAuthZ/standard-access-rights)
</dt> </dl>

 

 
