---
description: Die Unterbrechung einer opportunistischen Sperre ist der Prozess der Herabwürdigung der Sperre, die ein Client in einer Datei hat, damit ein anderer Client die Datei mit oder ohne opportunistische Sperre öffnen kann.
ms.assetid: 0356c167-2973-4820-85a9-bc14abcbf163
title: Unterbrechen opportunistischer Sperren
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1a29b6bd36d8c000b5288ea2408897415547c802
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106363368"
---
# <a name="breaking-opportunistic-locks"></a><span data-ttu-id="f04e3-103">Unterbrechen opportunistischer Sperren</span><span class="sxs-lookup"><span data-stu-id="f04e3-103">Breaking Opportunistic Locks</span></span>

<span data-ttu-id="f04e3-104">Die Unterbrechung einer opportunistischen Sperre ist der Prozess der Herabwürdigung der Sperre, die ein Client in einer Datei hat, damit ein anderer Client die Datei mit oder ohne opportunistische Sperre öffnen kann.</span><span class="sxs-lookup"><span data-stu-id="f04e3-104">Breaking an opportunistic lock is the process of degrading the lock that one client has on a file so that another client can open the file, with or without an opportunistic lock.</span></span> <span data-ttu-id="f04e3-105">Wenn der andere Client den Öffnungsvorgang anfordert, verzögert der Server den Öffnungsvorgang und benachrichtigt den Client, der die opportunistische Sperre aufrecht erhält.</span><span class="sxs-lookup"><span data-stu-id="f04e3-105">When the other client requests the open operation, the server delays the open operation and notifies the client holding the opportunistic lock.</span></span>

<span data-ttu-id="f04e3-106">Der Client, der die Sperre hält, führt dann Aktionen aus, die für den Sperrentyp geeignet sind, z. b. auslassen von Lese Puffern, Schließen der Datei usw.</span><span class="sxs-lookup"><span data-stu-id="f04e3-106">The client holding the lock then takes actions appropriate to the type of lock, for example abandoning read buffers, closing the file, and so on.</span></span> <span data-ttu-id="f04e3-107">Nur wenn der Server, der die opportunistische Sperre aufrecht erhält, den Server benachrichtigt, dass er abgeschlossen ist, öffnet der Server die Datei für den Client, der den Öffnungsvorgang anfordert.</span><span class="sxs-lookup"><span data-stu-id="f04e3-107">Only when the client holding the opportunistic lock notifies the server that it is done does the server open the file for the client requesting the open operation.</span></span> <span data-ttu-id="f04e3-108">Wenn jedoch eine Sperre der Ebene 2 getrennt ist, meldet der Server dem Client, dass er beschädigt wurde, jedoch nicht auf eine Bestätigung wartet, da keine zwischengespeicherten Daten auf den Server geleert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="f04e3-108">However, when a level 2 lock is broken, the server reports to the client that it has been broken but does not wait for any acknowledgment, as there is no cached data to be flushed to the server.</span></span>

<span data-ttu-id="f04e3-109">Wenn Sie eine Unterbrechung einer exklusiven Sperre (Filter, Ebene 1 oder Batch) bestätigen, kann der Inhaber einer gesperrten Sperre keine weitere exklusive Sperre anfordern.</span><span class="sxs-lookup"><span data-stu-id="f04e3-109">In acknowledging a break of any exclusive lock (filter, level 1, or batch), the holder of a broken lock cannot request another exclusive lock.</span></span> <span data-ttu-id="f04e3-110">Eine exklusive Sperre kann auf eine Sperre der Ebene 2 oder gar keine Sperre herabgestuft werden.</span><span class="sxs-lookup"><span data-stu-id="f04e3-110">It can degrade an exclusive lock to a level 2 lock or no lock at all.</span></span> <span data-ttu-id="f04e3-111">Der Halter gibt in der Regel die Sperre frei und schließt die Datei, wenn die Datei trotzdem geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="f04e3-111">The holder typically releases the lock and closes the file when it is about to close the file anyway.</span></span>

<span data-ttu-id="f04e3-112">Anwendungen werden benachrichtigt, dass eine opportunistische Sperre durch die Verwendung des **hevent** -Members der [**über**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) Lapp enden Struktur, die der Datei zugeordnet ist, in der die Sperre beschädigt ist, getrennt wird.</span><span class="sxs-lookup"><span data-stu-id="f04e3-112">Applications are notified that an opportunistic lock is broken by using the **hEvent** member of the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure associated with the file on which the lock is broken.</span></span> <span data-ttu-id="f04e3-113">Anwendungen können auch Funktionen wie [**gedeverlappedresult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) und [**hasoverlappedioabgeschlossene**](/windows/desktop/api/winbase/nf-winbase-hasoverlappediocompleted)verwenden.</span><span class="sxs-lookup"><span data-stu-id="f04e3-113">Applications may also use functions such as [**GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) and [**HasOverlappedIoCompleted**](/windows/desktop/api/winbase/nf-winbase-hasoverlappediocompleted).</span></span>

 

 
