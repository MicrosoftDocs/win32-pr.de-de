---
title: Registrierungs Reflektion
description: Der Registrierungs Redirector isoliert 32-Bit-und 64-Bit-Anwendungen, indem er separate logische Sichten bestimmter Teile der Registrierung auf WOW64 bereitstellt. Allerdings müssen die Werte einiger Registrierungsschlüssel in den 32-Bit-und 64-Bit-Sichten identisch sein.
ms.assetid: eac9038b-9f59-4ac7-8974-f94a4a62a257
keywords:
- Registrierungs Reflektion 64-Bit-Windows-Programmierung
- Reflektion 64-Bit-Windows-Programmierung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 523041004d9570bbdf101050e30f5d9139031913
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "106337445"
---
# <a name="registry-reflection"></a><span data-ttu-id="4a8a1-106">Registrierungs Reflektion</span><span class="sxs-lookup"><span data-stu-id="4a8a1-106">Registry Reflection</span></span>

<span data-ttu-id="4a8a1-107">\[Die Informationen in diesem Thema gelten für Windows Server 2008, Windows Vista, Windows Server 2003 und Windows XP.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-107">\[The information in this topic applies to Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP.</span></span> <span data-ttu-id="4a8a1-108">Ab Windows 7 und Windows Server 2008 R2 verwendet WOW64 nicht mehr die Registrierungs Reflektion, und früher reflektierte Schlüssel werden stattdessen freigegeben.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-108">Starting with Windows 7 and Windows Server 2008 R2, WOW64 no longer uses registry reflection and formerly reflected keys are shared instead.</span></span> <span data-ttu-id="4a8a1-109">Weitere Informationen finden Sie unter [Registrierungsschlüssel, die von WOW64 betroffen sind](shared-registry-keys.md).\]</span><span class="sxs-lookup"><span data-stu-id="4a8a1-109">For more information, see [Registry Keys Affected by WOW64](shared-registry-keys.md).\]</span></span>

<span data-ttu-id="4a8a1-110">Der [Registrierungs Redirector](registry-redirector.md) isoliert 32-Bit-und 64-Bit-Anwendungen, indem er separate logische Sichten bestimmter Teile der Registrierung auf WOW64 bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-110">The [registry redirector](registry-redirector.md) isolates 32-bit and 64-bit applications by providing separate logical views of certain portions of the registry on WOW64.</span></span> <span data-ttu-id="4a8a1-111">Allerdings müssen die Werte einiger Registrierungsschlüssel in den 32-Bit-und 64-Bit-Sichten identisch sein.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-111">However, the values of some registry keys must be the same in both the 32-bit and 64-bit views.</span></span>

<span data-ttu-id="4a8a1-112">Der Prozess der *Registrierungs Reflektion* kopiert Registrierungsschlüssel und-Werte zwischen zwei Registrierungs Sichten, um sie synchron zu halten.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-112">The process of *registry reflection* copies registry keys and values between two registry views to keep them synchronized.</span></span> <span data-ttu-id="4a8a1-113">Jede Ansicht verfügt über eine separate physische Kopie jedes reflektierten Registrierungsschlüssels, eine für die 32-Bit-Registrierungs Ansicht und die andere für die 64-Bit-Registrierungs Ansicht.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-113">Each view has a separate physical copy of each reflected registry key, one for the 32-bit registry view and the other for the 64-bit registry view.</span></span>

<span data-ttu-id="4a8a1-114">Eine reflektierte Taste wird kopiert, wenn eine Taste durch Aufrufen von [**RegCloseKey**](/windows/desktop/api/winreg/nf-winreg-regclosekey)geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-114">A reflected key is copied when a key is closed by calling [**RegCloseKey**](/windows/desktop/api/winreg/nf-winreg-regclosekey).</span></span> <span data-ttu-id="4a8a1-115">Beachten Sie, dass dies zu einer möglichen Racebedingung führt: Wenn der reflektierte Schlüssel von mehr als einem Prozess geändert wird, bestimmt der letzte **RegCloseKey** -Rückruf den endgültigen Wert des Schlüssels.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-115">Note that this gives rise to a possible race condition: if more than one process changes the reflected key, the last **RegCloseKey** call determines the key's final value.</span></span>

<span data-ttu-id="4a8a1-116">Der Reflektor kopiert com-Aktivierungsdaten für lokale Server zwischen den Sichten, kopiert jedoch keine Prozess internen Daten, 32/64 da eine Prozess interne Daten Mischung in 64-Bit-Fenstern nicht zulässig ist.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-116">The reflector copies COM activation data for Local servers between the views, but it does not copy in-process data because 32/64 in-process data mixing is not permitted on 64-bit Windows.</span></span>

<span data-ttu-id="4a8a1-117">Die Reflektion ist nicht für freigegebene Registrierungsschlüssel oder für Registrierungsschlüssel aktiviert, die nicht umgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-117">Reflection is not enabled for shared registry keys or for registry keys that are not redirected.</span></span> <span data-ttu-id="4a8a1-118">Beispielsweise ist die Reflektion für den **System Schlüssel des \_ lokalen \_ \\ HKEY** -Computers nicht aktiviert.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-118">For example, reflection is not enabled for the **HKEY\_LOCAL\_MACHINE\\System** key.</span></span> <span data-ttu-id="4a8a1-119">Eine Liste der Registrierungsschlüssel, die umgeleitet, freigegeben oder reflektiert werden, finden Sie unter [von WOW64 betroffene Registrierungsschlüssel](shared-registry-keys.md).</span><span class="sxs-lookup"><span data-stu-id="4a8a1-119">For a list of registry keys that are redirected, shared, or reflected, see [Registry Keys Affected by WOW64](shared-registry-keys.md).</span></span>

<span data-ttu-id="4a8a1-120">Die Registrierungs Reflektion verwendet eine "Last Writer WINS"-Richtlinie, wie im folgenden Beispiel veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="4a8a1-120">Registry reflection uses a "last writer wins" policy as illustrated in the following example:</span></span>

-   <span data-ttu-id="4a8a1-121">Nach einer Neuinstallation von 64-Bit-Windows wird 64-Bit-Wordpad.exe für die Verarbeitung von doc-Dateien registriert.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-121">After a clean installation of 64-bit Windows, 64-bit Wordpad.exe is registered to handle .doc files.</span></span> <span data-ttu-id="4a8a1-122">Der Reflektor kopiert die doc-Registrierung aus der 64-Bit-Registrierungs Ansicht in die 32-Bit-Registrierungs Ansicht.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-122">The reflector copies the .doc registration from the 64-bit registry view into the 32-bit registry view.</span></span>
-   <span data-ttu-id="4a8a1-123">Ein Administrator installiert 32-Bit-Office, das 32-Bit-Winword.exe registriert, um doc-Dateien in der 32-Bit-Registrierungs Ansicht zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-123">An administrator installs 32-bit Office, which registers 32-bit Winword.exe to handle .doc files in the 32-bit registry view.</span></span> <span data-ttu-id="4a8a1-124">Der Registrierungs Reflektor kopiert diese Informationen in die 64-Bit-Registrierungs Ansicht, sodass sowohl 32-Bit-als auch 64-Bit-Anwendungen die 32-Bit-Version von Winword.exe für doc-Dateien starten.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-124">The registry reflector copies this information into the 64-bit registry view, so both 32-bit and 64-bit applications launch the 32-bit version of Winword.exe for .doc files.</span></span>
-   <span data-ttu-id="4a8a1-125">Ein Administrator installiert 64-Bit-Office, das 64-Bit-Winword.exe registriert, um doc-Dateien in der 64-Bit-Registrierungs Ansicht zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-125">An administrator installs 64-bit Office, which registers 64-bit Winword.exe to handle .doc files in the 64-bit registry view.</span></span> <span data-ttu-id="4a8a1-126">Der Registrierungs Reflektor kopiert diese Informationen in die 32-Bit-Registrierung, sodass sowohl 32-Bit-als auch 64-Bit-Anwendungen die 64-Bit-Version von Winword.exe für doc-Dateien starten.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-126">The registry reflector copies this information into the 32-bit registry, so both 32-bit and 64-bit applications launch the 64-bit version of Winword.exe for .doc files.</span></span>

<span data-ttu-id="4a8a1-127">Aus diesem Grund werden die Datei Zuordnungs Informationen für die zuletzt installierte Anwendung beibehalten.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-127">Therefore, the file association information is preserved for the most recently installed application.</span></span>

<span data-ttu-id="4a8a1-128">Es kann nützlich sein, wenn 32-Bit-und 64-Bit-Anwendungen bestimmte Registrierungsschlüssel Werte gemeinsam verwenden, die normalerweise in separate Registrierungs Sichten geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-128">It can be useful for 32-bit and 64-bit applications to share specific registry key values that are normally written to separate registry views.</span></span> <span data-ttu-id="4a8a1-129">Beispielsweise könnte ein 32-Bit-OLE-Server, der Anforderungen von 32-Bit-und 64-Bit-Clients bedienen kann, seine 32-Bit-Registrierungsdaten für die 64-Bit-Ansicht der Systemregistrierung verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-129">For example, a 32-bit OLE server that can serve requests from both 32-bit and 64-bit clients could make its 32-bit registry data available to the 64-bit view of the system registry.</span></span>

<span data-ttu-id="4a8a1-130">Wenn eine Komponente Daten in die Systemregistrierung schreibt, analysiert WOW64 die Informationen und erstellt bei Bedarf eine Kopie der Daten in der alternativen Ansicht der Registrierung.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-130">When a component writes data in the system registry, WOW64 analyzes the information and makes a copy of the data in the alternate view of the registry when appropriate.</span></span> <span data-ttu-id="4a8a1-131">In der Regel werden bei diesem Prozess zwei separate physische Kopien derselben Registrierungsschlüssel sowohl in der Registrierung als auch als Registrierungs Reflektion oder als Registrierungs Spiegelung bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-131">Typically, this process keeps two separate physical copies of the same registry keys in both views in the registry, and is called registry reflection or registry mirroring.</span></span>

<span data-ttu-id="4a8a1-132">Die meisten Schlüssel unter dem Klassen Stamm befinden sich in dieser Kategorie.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-132">Most of the keys under the classes root are in this category.</span></span> <span data-ttu-id="4a8a1-133">Updates der Schlüssel werden wiedergegeben, wenn das Update abgeschlossen und das Handle für den Schlüssel geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-133">Updates to the keys are reflected when the update completes and the handle to the key closes.</span></span> <span data-ttu-id="4a8a1-134">In bestimmten Fällen werden Schreibvorgänge in einen Schlüssel nicht widergespiegelt, wenn der Schlüssel eine gewisse Bielle Abhängigkeit aufweist.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-134">In specific cases, writes to a key are not reflected if the key has some bitness dependency.</span></span> <span data-ttu-id="4a8a1-135">Beispielsweise ist der 32-Bit-InprocServer32-Schlüssel für 64-Bit-Anwendungen nicht relevant, sodass der InprocServer32-Schlüssel nicht in der 64-Bit-Registrierungs Ansicht widergespiegelt wird.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-135">For example, the 32-bit InprocServer32 key is not relevant for 64-bit applications, so the InprocServer32 key is not reflected to the 64-bit registry view.</span></span> <span data-ttu-id="4a8a1-136">64-Bit-Anwendungen können jedoch den 32-Bit-LocalServer32-Schlüssel verwenden, und die LocalServer32-Taste wird reflektiert.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-136">However, 64-bit applications can use the 32-bit LocalServer32 key and the LocalServer32 key gets reflected.</span></span>

<span data-ttu-id="4a8a1-137">Für **HKEY \_ - \_ \\ Softwareverteilungs-Software \\ Klassen \\ CLSID** und **HKEY \_ Current \_ User \\ Software \\ Classes \\ CLSID** werden nur CLSIDs reflektiert, die InprocServer32 oder InprocHandler32 nicht angeben.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-137">For **HKEY\_LOCAL\_MACHINE\\Software\\Classes\\CLSID** and **HKEY\_CURRENT\_USER\\Software\\Classes\\CLSID**, only CLSIDs that do not specify InprocServer32 or InprocHandler32 are reflected.</span></span> <span data-ttu-id="4a8a1-138">Nur LocalServer32 CLSIDs werden reflektiert, da Sie außerhalb des Prozesses ausgeführt werden und entweder mit 32-oder 64-Bit-Anwendungen aktiviert werden können.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-138">Only LocalServer32 CLSIDs are reflected because they run out-of-process and can be activated by either 32- or 64-bit applications.</span></span> <span data-ttu-id="4a8a1-139">InprocServer32 CLSIDs werden nicht widergespiegelt, weil es nicht möglich ist, eine 32-Bit-DLL für die Ausführung in einem 64-Bit-Prozess oder eine 64-Bit-DLL für die Ausführung in einem 32-Bit-Prozess zu laden.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-139">InProcServer32 CLSIDs are not reflected because it is not possible to load a 32-bit DLL for execution in a 64-bit process, or a 64-bit DLL for execution in a 32-bit process.</span></span>

<span data-ttu-id="4a8a1-140">Für **HKEY \_ - \_ Software Klassen des lokalen Computers \\ \\ \\ AppID** und **HKEY \_ Current \_ User \\ Software \\ Classes \\ AppID** werden die Registrierungs Werte [dllersatz](../com/dllsurrogate.md) und [dllsurrogateexe]( ../com/dllsurrogateexecutable.md) nicht widergespiegelt, wenn ihr Wert eine leere Zeichenfolge ist.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-140">For **HKEY\_LOCAL\_MACHINE\\Software\\Classes\\Appid** and **HKEY\_CURRENT\_USER\\Software\\Classes\\Appid**, the [DllSurrogate](../com/dllsurrogate.md) and [DllSurrogateExecutable]( ../com/dllsurrogateexecutable.md) registry values are not reflected if their value is an empty string.</span></span>

<span data-ttu-id="4a8a1-141">Um die Registrierungs Reflektion für einen bestimmten reflektierten Schlüssel zu deaktivieren und zu aktivieren, verwenden Sie die Funktionen [**regdisablereflectionkey**](/windows/desktop/api/winreg/nf-winreg-regdisablereflectionkey) und [**regenablereflectionkey**](/windows/desktop/api/winreg/nf-winreg-regenablereflectionkey) .</span><span class="sxs-lookup"><span data-stu-id="4a8a1-141">To disable and enable registry reflection for a particular reflected key, use the [**RegDisableReflectionKey**](/windows/desktop/api/winreg/nf-winreg-regdisablereflectionkey) and [**RegEnableReflectionKey**](/windows/desktop/api/winreg/nf-winreg-regenablereflectionkey) functions.</span></span> <span data-ttu-id="4a8a1-142">Diese Funktionen wirken sich nicht auf Schlüssel aus, die weiter oben in diesem Thema nicht in der Liste der reflektierten Schlüssel aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-142">These functions do not affect keys that are not on the list of reflected keys earlier in this topic.</span></span> <span data-ttu-id="4a8a1-143">Anwendungen sollten die Reflektion nur für die von Ihnen erstellten Registrierungsschlüssel deaktivieren und nicht versuchen, die Reflektion für die vordefinierten Schlüssel zu deaktivieren, wie z. b. **HKEY \_ local \_ Machine** oder **HKEY \_ Current \_ User**.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-143">Applications should disable reflection only for the registry keys that they create and not attempt to disable reflection for the predefined keys such as **HKEY\_LOCAL\_MACHINE** or **HKEY\_CURRENT\_USER**.</span></span> <span data-ttu-id="4a8a1-144">Verwenden Sie die [**regqueryreflectionkey**](/windows/desktop/api/winreg/nf-winreg-regqueryreflectionkey) -Funktion, um zu bestimmen, ob die Schlüssel für die reflektionsliste deaktiviert wurden.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-144">To determine whether the keys on the reflection list have been disabled, use the [**RegQueryReflectionKey**](/windows/desktop/api/winreg/nf-winreg-regqueryreflectionkey) function.</span></span>

<span data-ttu-id="4a8a1-145">Reflektierte Schlüssel sollten nicht in transaktiven Registrierungs Vorgängen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-145">Reflected keys should not be used in transacted registry operations.</span></span> <span data-ttu-id="4a8a1-146">Das Schreiben in reflektierte Schlüssel während einer Transaktion kann dazu führen, dass die Transaktion fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="4a8a1-146">Writing to reflected keys during a transaction can cause the transaction to fail.</span></span> <span data-ttu-id="4a8a1-147">Weitere Informationen zu Transaktionen finden Sie unter [Kerneltransaktions-Manager](/windows/desktop/Ktm/kernel-transaction-manager-portal).</span><span class="sxs-lookup"><span data-stu-id="4a8a1-147">For more information about transactions, see [Kernel Transaction Manager](/windows/desktop/Ktm/kernel-transaction-manager-portal).</span></span>

## <a name="related-topics"></a><span data-ttu-id="4a8a1-148">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="4a8a1-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4a8a1-149">Registrierungs Redirector</span><span class="sxs-lookup"><span data-stu-id="4a8a1-149">Registry Redirector</span></span>](registry-redirector.md)
</dt> <dt>

[<span data-ttu-id="4a8a1-150">Registrierungs Reflektion in Windows</span><span class="sxs-lookup"><span data-stu-id="4a8a1-150">Registry Reflection in Windows</span></span>](/windows-hardware/drivers/display/microsoft-windows-vista-display-driver-64-bit-issues)
</dt> <dt>

[<span data-ttu-id="4a8a1-151">Registrierungsschlüssel, die von WOW64 betroffen sind</span><span class="sxs-lookup"><span data-stu-id="4a8a1-151">Registry Keys Affected by WOW64</span></span>](shared-registry-keys.md)
</dt> </dl>

 

 