---
title: Ändern einer vorhandenen Schnittstelle
description: Implementieren Sie nach Möglichkeit eine neue Schnittstelle für Ihre Anwendung, anstatt Änderungen an einer vorhandenen Anwendung vorzunehmen.
ms.assetid: 29845cf5-445c-403d-b298-d4e07c3536b7
keywords:
- Ändern vorhandener Schnittstellen 64-Bit-Windows-Programmierung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 51a656ee768dcc2e88725d2cff0ddc5604fd771f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104516919"
---
# <a name="changing-an-existing-interface"></a><span data-ttu-id="e2d06-104">Ändern einer vorhandenen Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="e2d06-104">Changing an Existing Interface</span></span>

<span data-ttu-id="e2d06-105">Implementieren Sie nach Möglichkeit eine neue Schnittstelle für Ihre Anwendung, anstatt Änderungen an einer vorhandenen Anwendung vorzunehmen.</span><span class="sxs-lookup"><span data-stu-id="e2d06-105">Whenever possible, implement a new interface for your application, rather than making changes to an existing one.</span></span> <span data-ttu-id="e2d06-106">Wenn Sie die Änderung einer vorhandenen Schnittstelle nicht vermeiden können, verwenden Sie neue Datentypen nur in neuen Methoden.</span><span class="sxs-lookup"><span data-stu-id="e2d06-106">If you cannot avoid changing an existing interface, use new data types in new methods only.</span></span> <span data-ttu-id="e2d06-107">Das Einführen eines neuen Datentyps oder das Ändern eines vorhandenen Typs ist die häufigste Quelle für Inkompatibilitäts Probleme.</span><span class="sxs-lookup"><span data-stu-id="e2d06-107">Introducing a new data type or modifying an existing type is the most common source of incompatibility problems.</span></span> <span data-ttu-id="e2d06-108">Das RPC-Lauf Zeitmodell geht davon aus, dass die empfangende Anwendung die Datentypen kennt, die Sie empfängt, sodass Daten ohne generische Daten Beschreibung in das Netzwerk eingefügt werden.</span><span class="sxs-lookup"><span data-stu-id="e2d06-108">The RPC run-time model assumes that the receiving application knows about the types of data that it receives, so data is put onto the wire without a generic data description.</span></span> <span data-ttu-id="e2d06-109">Wenn der Empfänger einen anderen Datentyp erwartet als den Absender, den der Absender eingegeben hat, löst der Stub eine Ausnahme aus (oder die Übertragung schlägt in anderer Weise weniger ordnungsgemäß vor).</span><span class="sxs-lookup"><span data-stu-id="e2d06-109">When the recipient expects a different data type than what the sender has put on the wire, the stub raises an exception (or transmission fails in some other less graceful manner).</span></span>

<span data-ttu-id="e2d06-110">Eine RPC-Schnittstelle wird durch die UUID und die Haupt-und neben Versionsnummern definiert.</span><span class="sxs-lookup"><span data-stu-id="e2d06-110">An RPC interface is defined by its UUID and its major and minor version numbers.</span></span> <span data-ttu-id="e2d06-111">Wenn Sie eine vorhandene Schnittstelle ändern, sollten Sie die neuen Methoden am Ende der Schnittstelle hinzufügen und die neben Versionsnummer ändern.</span><span class="sxs-lookup"><span data-stu-id="e2d06-111">When you change an existing interface, you should add the new methods at the end of the interface and change the minor version number.</span></span> <span data-ttu-id="e2d06-112">Wenn Sie an einem anderen Ort Methoden hinzufügen oder andere Änderungen an der Schnittstelle vornehmen, müssen Sie auch die Hauptversionsnummer ändern.</span><span class="sxs-lookup"><span data-stu-id="e2d06-112">If you add methods anywhere else or make any other changes to the interface, you will also need to change the major version number.</span></span>

<span data-ttu-id="e2d06-113">Normalerweise gibt es Zeiten, in denen Sie sogar die neben Versionsnummer nicht ändern können, da ein neuer Client nicht mit einem alten Server kommunizieren kann und Sie den Server nicht aktualisieren können.</span><span class="sxs-lookup"><span data-stu-id="e2d06-113">Realistically, there are times when you cannot change even the minor version number, because a new client will not be able to communicate with an old server and you cannot update the server.</span></span> <span data-ttu-id="e2d06-114">Die RPC-Laufzeit löst eine Ausnahme aus, die RPC \_ S \_ procnum \_ außerhalb \_ des gültigen \_ Bereichs, wenn ein Client eine Methode aufruft, die über diejenigen hinausgeht, die für die Schnittstelle mit dem Server angegeben sind.</span><span class="sxs-lookup"><span data-stu-id="e2d06-114">The RPC run time raises an exception, RPC\_S\_PROCNUM\_OUT\_OF\_RANGE, when a client calls a method beyond the ones specified for its interface with the server.</span></span> <span data-ttu-id="e2d06-115">Die Problem Umgehung besteht darin, die Versionsnummern unverändert zu lassen und den Client Code zu schreiben, um diese Ausnahme ordnungsgemäß zu behandeln – durch den Client, wodurch die Leistung herabgestuft wird, z. b. oder durch die für Ihre Anwendung geeigneten Mittel.</span><span class="sxs-lookup"><span data-stu-id="e2d06-115">The workaround is to leave the version numbers unchanged and write your client code to handle this exception gracefully—by the client degrading its performance, for example, or by whatever means are appropriate for your application.</span></span>

<span data-ttu-id="e2d06-116">Es gibt eine ähnliche Problem Umgehung für einen besonderen Fall, dass ein Datentyp in einer vorhandenen Methode geändert wird.</span><span class="sxs-lookup"><span data-stu-id="e2d06-116">There is a similar workaround for one special case of changing a data type in an existing method.</span></span> <span data-ttu-id="e2d06-117">Wenn Sie über eine [**Union**](/windows/desktop/Midl/union) verfügen, deren Verzweigungen Zeiger sind und nicht über einen standardbranch für unbekannte Typen verfügen, können Sie einen neuen Branch hinzufügen, der den neuen Datentyp verwendet.</span><span class="sxs-lookup"><span data-stu-id="e2d06-117">If you have a [**union**](/windows/desktop/Midl/union) whose branches are pointers and that does not have a default branch for unrecognized types, you can add a new branch that uses the new data type.</span></span> <span data-ttu-id="e2d06-118">Dadurch wird die Größe der Datenstruktur nicht geändert.</span><span class="sxs-lookup"><span data-stu-id="e2d06-118">This will not change the size of the data structure.</span></span> <span data-ttu-id="e2d06-119">Wenn Ihr Client mit einem neuen Server kommuniziert, kann er den neuen Datentyp verwenden.</span><span class="sxs-lookup"><span data-stu-id="e2d06-119">When your client talks to a new server, it can use the new data type.</span></span> <span data-ttu-id="e2d06-120">Wenn der Client jedoch mit einem alten Server kommuniziert, gibt die Laufzeit das \_ ungültige RPC S- \_ Tag aus \_ .</span><span class="sxs-lookup"><span data-stu-id="e2d06-120">However, when your client talks to an old server, the run time will raise the exception RPC\_S\_INVALID\_TAG.</span></span> <span data-ttu-id="e2d06-121">Auch hier müssen Sie den Client Code so schreiben, dass diese Ausnahme entsprechend behandelt wird.</span><span class="sxs-lookup"><span data-stu-id="e2d06-121">Again, you will need to write your client code to handle this exception appropriately.</span></span>

<span data-ttu-id="e2d06-122">Eine DCOM-Schnittstelle wird durch ihre GUID identifiziert.</span><span class="sxs-lookup"><span data-stu-id="e2d06-122">A DCOM interface is identified by its GUID.</span></span> <span data-ttu-id="e2d06-123">In DCOM sind Schnittstellen als unveränderlich zu sehen, und Sie können Änderungen vornehmen, indem Sie eine neue Schnittstelle erstellen, die von der alten erbt.</span><span class="sxs-lookup"><span data-stu-id="e2d06-123">In DCOM, interfaces are considered immutable and you can make changes only by creating a new interface that inherits from the old one.</span></span> <span data-ttu-id="e2d06-124">Diese Regeln stellen sicher, dass Clients und Server kompatibel bleiben.</span><span class="sxs-lookup"><span data-stu-id="e2d06-124">These rules ensure that clients and servers remain compatible.</span></span>

 

 