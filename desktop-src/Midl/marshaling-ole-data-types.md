---
title: Marshalling von OLE-Datentypen
description: Marshalling von Automatisierungs-und OLE-Datentypen.
ms.assetid: 0cab4208-d40d-40a1-88f2-4933b52c0c29
keywords:
- Mittel l und com-Mittell, Mars Hallen von OLE-Datentypen
- Marshalling von mittlerer l
- OLE-Daten-Mittelwert
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5970c6e0fef9d0fc88b8a0a11a087fa4396d7a7c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "103725153"
---
# <a name="marshaling-ole-data-types"></a><span data-ttu-id="caf4e-106">Marshalling von OLE-Datentypen</span><span class="sxs-lookup"><span data-stu-id="caf4e-106">Marshaling OLE Data Types</span></span>

<span data-ttu-id="caf4e-107">Um die Verwendung bestimmter Automatisierungs-und OLE-Datentypen sowie einiger in com häufig verwendeter System Handles zu vereinfachen, sind Typedefs für diese Datentypen und die zugehörigen Hilfsfunktionen verfügbar, wenn Sie Windows-IDL-Dateien importieren und mit den OLE-und Automatisierungs-dll-Dateien verknüpfen.</span><span class="sxs-lookup"><span data-stu-id="caf4e-107">To make it easier to use certain Automation and OLE data types, as well as some system handles frequently used in COM, typedefs for these data types and their related helper functions are available by importing Windows IDL files and linking to the OLE and Automation DLL files.</span></span> <span data-ttu-id="caf4e-108">Diese Dateien werden automatisch auf Ihrem System installiert.</span><span class="sxs-lookup"><span data-stu-id="caf4e-108">These files are automatically installed on your system.</span></span>

-   <span data-ttu-id="caf4e-109">Wenn Sie den [**BSTR**](/previous-versions/windows/desktop/automat/bstr) -Datentyp in Remote Prozedur aufrufen verwenden möchten, importieren Sie die Wtypes. IDL-Datei in die IDL-Datei (Interface Definition), und verknüpfen Sie Sie mit Oleaut32. lib, wenn Sie die verteilte Anwendung aufbauen.</span><span class="sxs-lookup"><span data-stu-id="caf4e-109">To use the [**BSTR**](/previous-versions/windows/desktop/automat/bstr) data type in remote procedure calls, import the wtypes.idl file into your interface definition (IDL) file and link to Oleaut32.lib when building your distributed application.</span></span> <span data-ttu-id="caf4e-110">Dies ermöglicht Ihren Stub die Verwendung der vorgefertigten Hilfsfunktionen **BSTR \_ usersize**, **BSTR \_ usermarshal**, **BSTR \_ userunmarshal** und **BSTR \_ userfree**.</span><span class="sxs-lookup"><span data-stu-id="caf4e-110">This will let your stubs use the ready-made helper functions **BSTR\_UserSize**, **BSTR\_UserMarshal**, **BSTR\_UserUnmarshal**, and **BSTR\_UserFree**.</span></span>
-   <span data-ttu-id="caf4e-111">Um andere Automatisierungs Datentypen (z. b. [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) und [**SAFEARRAY**](/windows/win32/api/oaidl/ns-oaidl-safearray)) oder Typen zu verwenden, die diese Typen verwenden (z. b. [**dispparameams**](/windows/win32/api/oaidl/ns-oaidl-dispparams) und [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), importieren Sie die objidl. IDL-Datei in Ihre IDL-Datei, und verknüpfen Sie Sie zur Buildzeit mit Oleaut32. lib.</span><span class="sxs-lookup"><span data-stu-id="caf4e-111">To use other Automation data types, such as [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) and [**SAFEARRAY**](/windows/win32/api/oaidl/ns-oaidl-safearray), or types that use those types (for example, [**DISPPARAMS**](/windows/win32/api/oaidl/ns-oaidl-dispparams) and [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), import the objidl.idl file into your IDL file and link to the oleaut32.lib at build time.</span></span> <span data-ttu-id="caf4e-112">Auf diese Weise können Sie die entsprechenden Hilfsroutinen verwenden.</span><span class="sxs-lookup"><span data-stu-id="caf4e-112">This will allow you to use the appropriate helper routines.</span></span>
-   <span data-ttu-id="caf4e-113">Um OLE-Datentypen (z. b. clipFormat) zu verwenden, "SNB", "STGMEDIUM", "Async \_ STGMEDIUM") oder System Handles (z. b. "HMETAFILE \_ PICT", "HENHMETAFILE", "HMETAFILE", "HBITMAP", "hpalette" und "HGLOBAL") importieren Sie die Datei "objidl</span><span class="sxs-lookup"><span data-stu-id="caf4e-113">To use OLE data types (such as CLIPFORMAT, SNB, STGMEDIUM, ASYNC\_STGMEDIUM), or system handles (such as HMETAFILE\_PICT, HENHMETAFILE, HMETAFILE, HBITMAP, HPALETTE, and HGLOBAL), import the objidl.idl file into your interface definition file and link to the ole32.lib at build time.</span></span>
-   <span data-ttu-id="caf4e-114">Die folgenden OLE-Handles werden ebenfalls mit dem **\[ Wire \_ Marshal \]** -Attribut definiert, jedoch nur als Handles innerhalb eines Computers, da Sie zurzeit nicht in Remote Prozedur aufrufen an andere Computer verwendet werden können: HWND, HMENU, haccel, HDC, hFont, HICON und hBrush.</span><span class="sxs-lookup"><span data-stu-id="caf4e-114">The following OLE handles are also defined with the **\[wire\_marshal\]** attribute, but only as handles within a computer since they cannot be used in remote procedure calls to other computers at this time: HWND, HMENU, HACCEL, HDC, HFONT, HICON, HBRUSH.</span></span> <span data-ttu-id="caf4e-115">Importieren Sie die objidl. IDL-Datei in Ihre IDL-Datei, und verknüpfen Sie Sie zur Buildzeit mit ole32. lib, um diese Handles bei der prozessübergreifenden Kommunikation auf einem einzelnen Computer zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="caf4e-115">Import the objidl.idl file into your IDL file and link to ole32.lib at build time to use these handles in interprocess communication on a single computer.</span></span>

<span data-ttu-id="caf4e-116">Weitere Informationen finden Sie unter [dem Wire \_ Marshal-Attribut](/windows/desktop/Rpc/the-wire-marshal-attribute), [der Type \_ usersize-Funktion](/windows/desktop/Rpc/the-type-usersize-function), [der Type \_ usermarshal](/windows/desktop/Rpc/the-type-usermarshal-function)-Funktion, [der Type \_ userunmarshal-Funktion](/windows/desktop/Rpc/the-type-userunmarshal-function), [der Type \_ userfree-Funktion](/windows/desktop/Rpc/the-type-userfree-function)und der [Zielplattform-Stub für bestimmte 32-Bit-oder 64-Bit-Plattformen](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md).</span><span class="sxs-lookup"><span data-stu-id="caf4e-116">For more information, see [The wire\_marshal Attribute](/windows/desktop/Rpc/the-wire-marshal-attribute), [The type\_UserSize Function](/windows/desktop/Rpc/the-type-usersize-function), [The type\_UserMarshal Function](/windows/desktop/Rpc/the-type-usermarshal-function), [The type\_UserUnmarshal Function](/windows/desktop/Rpc/the-type-userunmarshal-function), [The type\_UserFree Function](/windows/desktop/Rpc/the-type-userfree-function), and [Targeting Stubs for Specific 32-bit or 64-bit Platforms](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md).</span></span>

 

 