---
description: Eine Anwendung kann für die Verwaltung von Teilmengen von Prozessen mithilfe von mit einem Netz ersteten Aufträgen arbeiten Durch die Verwendung von geclusterte Aufträgen kann eine Anwendung, die Aufträge verwendet, andere Anwendungen hosten, die auch Aufträge verwenden.
ms.assetid: FA22493B-CD29-49A7-BDAC-349FA96B8C9E
title: Genetzte Aufträge
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: abf105c70ec8e83b395fcce56c6274d4838358bc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104561176"
---
# <a name="nested-jobs"></a><span data-ttu-id="d047e-104">Genetzte Aufträge</span><span class="sxs-lookup"><span data-stu-id="d047e-104">Nested Jobs</span></span>

<span data-ttu-id="d047e-105">Eine Anwendung kann für die Verwaltung von Teilmengen von Prozessen mithilfe von mit einem Netz ersteten Aufträgen arbeiten</span><span class="sxs-lookup"><span data-stu-id="d047e-105">An application can use nested jobs to manage subsets of processes.</span></span> <span data-ttu-id="d047e-106">Durch die Verwendung von geclusterte Aufträgen kann eine Anwendung, die Aufträge verwendet, andere Anwendungen hosten, die auch Aufträge verwenden.</span><span class="sxs-lookup"><span data-stu-id="d047e-106">Nested jobs also enable an application that uses jobs to host other applications that also use jobs.</span></span>

<span data-ttu-id="d047e-107">**Windows 7, Windows Server 2008 R2, Windows XP mit SP3, Windows Server 2008, Windows Vista und Windows Server 2003:** Ein Prozess kann nur einem einzelnen Auftrag zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="d047e-107">**Windows 7, Windows Server 2008 R2, Windows XP with SP3, Windows Server 2008, Windows Vista and Windows Server 2003:** A process can be associated with only a single job.</span></span> <span data-ttu-id="d047e-108">In Windows 8 und Windows Server 2012 wurden in der Liste eingefügte Aufträge eingeführt.</span><span class="sxs-lookup"><span data-stu-id="d047e-108">Nested jobs were introduced in Windows 8 and Windows Server 2012.</span></span>

<span data-ttu-id="d047e-109">Dieses Thema enthält eine Übersicht über die Auftrags Schachtelung und das Verhalten geschachtelter Aufträge:</span><span class="sxs-lookup"><span data-stu-id="d047e-109">This topic provides an overview of job nesting and behavior of nested jobs:</span></span>

-   [<span data-ttu-id="d047e-110">Hierarchien von in einem Netz erten Auftrag</span><span class="sxs-lookup"><span data-stu-id="d047e-110">Nested Job Hierarchies</span></span>](#nested-job-hierarchies)
-   [<span data-ttu-id="d047e-111">Erstellen einer Hierarchie mit einem Hierarchie</span><span class="sxs-lookup"><span data-stu-id="d047e-111">Creating a Nested Job Hierarchy</span></span>](#creating-a-nested-job-hierarchy)
-   [<span data-ttu-id="d047e-112">Auftrags Limits und Benachrichtigungen für geclusterte Aufträge</span><span class="sxs-lookup"><span data-stu-id="d047e-112">Job Limits and Notifications for Nested Jobs</span></span>](#job-limits-and-notifications-for-nested-jobs)
-   [<span data-ttu-id="d047e-113">Ressourcen Erfassung für genetztete Aufträge</span><span class="sxs-lookup"><span data-stu-id="d047e-113">Resource Accounting for Nested Jobs</span></span>](#resource-accounting-for-nested-jobs)
-   [<span data-ttu-id="d047e-114">Beendigung von in der Liste</span><span class="sxs-lookup"><span data-stu-id="d047e-114">Termination of Nested Jobs</span></span>](#termination-of-nested-jobs)

<span data-ttu-id="d047e-115">Allgemeine Informationen zu Aufträgen und Auftrags Objekten finden Sie unter [Auftrags Objekte](job-objects.md).</span><span class="sxs-lookup"><span data-stu-id="d047e-115">For general information about jobs and job objects, see [Job Objects](job-objects.md).</span></span>

## <a name="nested-job-hierarchies"></a><span data-ttu-id="d047e-116">Hierarchien von in einem Netz erten Auftrag</span><span class="sxs-lookup"><span data-stu-id="d047e-116">Nested Job Hierarchies</span></span>

<span data-ttu-id="d047e-117">Bei der über-/Unterordnungsbeziehung der einzelnen untergeordneten Aufträge werden in einem untergeordneten Auftrag eine Teilmenge der Prozesse in seinem übergeordneten Auftrag enthalten.</span><span class="sxs-lookup"><span data-stu-id="d047e-117">Nested jobs have a parent-child relationship in which each child job contains a subset of the processes in its parent job.</span></span> <span data-ttu-id="d047e-118">Wenn ein Prozess, der bereits in einem Auftrag vorhanden ist, einem anderen Auftrag hinzugefügt wird, sind die Aufträge standardmäßig aktiviert, wenn das System eine gültige Auftrags Hierarchie bilden kann und keines der beiden Aufträge die Benutzeroberflächen Limits festlegt ([**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) mit **jobobjectbasicuirestrictions**).</span><span class="sxs-lookup"><span data-stu-id="d047e-118">If a process that is already in a job is added to another job, the jobs are nested by default if the system can form a valid job hierarchy and neither job sets UI limits ([**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) with **JobObjectBasicUIRestrictions**).</span></span>

<span data-ttu-id="d047e-119">Abbildung 1 zeigt eine Auftrags Hierarchie, die eine Struktur von Prozessen mit der Bezeichnung P0 bis P7 enthält.</span><span class="sxs-lookup"><span data-stu-id="d047e-119">Figure 1 shows a job hierarchy that contains a tree of processes labeled P0 through P7.</span></span> <span data-ttu-id="d047e-120">Job 1 ist der über *geordnete Auftrag* von Job 2 und Job 4 und ist ein *Vorgänger* von Job 3.</span><span class="sxs-lookup"><span data-stu-id="d047e-120">Job 1 is the *parent job* of Job 2 and Job 4, and it is an *ancestor* of Job 3.</span></span> <span data-ttu-id="d047e-121">Auftrag 2 ist das *unmittelbar übergeordnete* Element von Job 3; Job 3 ist das *unmittelbare* untergeordnete Element von Job 2.</span><span class="sxs-lookup"><span data-stu-id="d047e-121">Job 2 is the *immediate parent* of Job 3; Job 3 is the *immediate child* of Job 2.</span></span> <span data-ttu-id="d047e-122">Die Aufträge 1, 2 und 3 bilden eine *Auftrags Kette* , in der die Aufträge 1 und 2 die über *geordnete Auftrags Kette* von Auftrag 3 sind.</span><span class="sxs-lookup"><span data-stu-id="d047e-122">Jobs 1, 2, and 3 form a *job chain* in which Jobs 1 and 2 are the *parent job chain* of Job 3.</span></span> <span data-ttu-id="d047e-123">Der Endauftrag in einer Auftrags Kette ist der *unmittelbare Auftrag* der Prozesse in diesem Auftrag.</span><span class="sxs-lookup"><span data-stu-id="d047e-123">The end job in a job chain is the *immediate job* of the processes in that job.</span></span> <span data-ttu-id="d047e-124">In Abbildung 1 ist Job 3 der unmittelbare Auftrag der Prozesse P2, P3 und P4.</span><span class="sxs-lookup"><span data-stu-id="d047e-124">In Figure 1, Job 3 is the immediate job of processes P2, P3, and P4.</span></span>

![Abbildung 1.](images/nested-jobs-a.png)

<span data-ttu-id="d047e-127">Mithilfe von mit einem Namen verknüpften Aufträgen können auch Gruppen von Peer Prozessen verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="d047e-127">Nested jobs can also be used to manage groups of peer processes.</span></span> <span data-ttu-id="d047e-128">In der in Abbildung 2 gezeigten Auftrags Hierarchie ist Auftrag 1 der übergeordnete Auftrag von Auftrag 2.</span><span class="sxs-lookup"><span data-stu-id="d047e-128">In the job hierarchy shown in Figure 2, Job 1 is the parent job of Job 2.</span></span> <span data-ttu-id="d047e-129">Beachten Sie, dass eine Auftrags Hierarchie nur einen Teil eines Prozess Baums enthalten kann.</span><span class="sxs-lookup"><span data-stu-id="d047e-129">Note that a job hierarchy might contain only part of a process tree.</span></span> <span data-ttu-id="d047e-130">In Abbildung 2 ist P0 nicht in der Hierarchie, aber die untergeordneten Prozesse P1 bis P5 sind.</span><span class="sxs-lookup"><span data-stu-id="d047e-130">In Figure 2, P0 is not in the hierarchy, but its child processes P1 through P5 are.</span></span>

![Abbildung 2.](images/nested-jobs-b.png)

## <a name="creating-a-nested-job-hierarchy"></a><span data-ttu-id="d047e-133">Erstellen einer Hierarchie mit einem Hierarchie</span><span class="sxs-lookup"><span data-stu-id="d047e-133">Creating a Nested Job Hierarchy</span></span>

<span data-ttu-id="d047e-134">Prozesse in einer Auftrags Hierarchie sind entweder explizit einem Auftrags [**Objekt zugeordnet, indem die Funktion**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) "Zuordnungs Funktion" oder "implizit" während der Prozesserstellung zugeordnet wird. Dies gilt auch für eigenständige Aufträge.</span><span class="sxs-lookup"><span data-stu-id="d047e-134">Processes in a job hierarchy are either explicitly associated with a job object using the [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) function or implicitly associated during process creation, same as for standalone jobs.</span></span> <span data-ttu-id="d047e-135">Die Reihenfolge, in der Aufträge erstellt und Prozesse zugewiesen werden, bestimmt, ob eine Hierarchie erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="d047e-135">The order in which jobs are created and processes are assigned determines whether a hierarchy can be created.</span></span>

<span data-ttu-id="d047e-136">Zum Erstellen einer Auftrags Hierarchie mithilfe der expliziten Zuordnung müssen alle Auftrags Objekte mithilfe von " [**foratejobobject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta)" erstellt werden. Anschließend muss "zuordnungsesstojobobject" für jeden Prozess mehrmals aufgerufen werden, um den Prozess jedem Auftrag zuzuordnen, zu dem er gehören soll. [](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject)</span><span class="sxs-lookup"><span data-stu-id="d047e-136">To build a job hierarchy using explicit association, all job objects must be created using [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta), then [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) must be called multiple times for each process to associate the process with each job it should belong to.</span></span> <span data-ttu-id="d047e-137">Um sicherzustellen, dass die Auftrags Hierarchie gültig ist, weisen Sie zunächst alle Prozesse dem Auftrag im Stammverzeichnis der Hierarchie zu, und weisen Sie dann dem direkt untergeordneten Auftrags Objekt eine Teilmenge von Prozessen zu usw.</span><span class="sxs-lookup"><span data-stu-id="d047e-137">To ensure that the job hierarchy is valid, first assign all processes to the job at the root of the hierarchy, then assign a subset of processes to the immediate child job object, and so on.</span></span> <span data-ttu-id="d047e-138">Wenn Prozesse in dieser Reihenfolge Aufträgen zugewiesen werden, verfügt ein untergeordneter Auftrag immer über eine Teilmenge der Prozesse in seinem übergeordneten Auftrag, während die Hierarchie erstellt wird, die für die Schachtelung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="d047e-138">If processes are assigned to jobs in this order, a child job will always have a subset of processes in its parent job while the hierarchy is being created, which is required for nesting.</span></span> <span data-ttu-id="d047e-139">Wenn Prozesse Aufträgen in zufälliger Reihenfolge zugewiesen werden, verfügt ein untergeordneter Auftrag über Prozesse, die sich nicht in seinem übergeordneten Auftrag befinden.</span><span class="sxs-lookup"><span data-stu-id="d047e-139">If processes are assigned to jobs in random order, at some point a child job will have processes that are not in its parent job.</span></span> <span data-ttu-id="d047e-140">Dies ist durch die Schachtelung nicht zulässig und bewirkt, dass "zubei **zutragprocesstojobobject** " fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="d047e-140">This is not allowed by nesting and it will cause **AssignProcessToJobObject** to fail.</span></span>

<span data-ttu-id="d047e-141">Wenn Prozesse während der Prozesserstellung implizit einem Auftrag zugeordnet sind, wird jedem Auftrag in der Auftrags Kette des übergeordneten Prozesses ein untergeordneter Prozess zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="d047e-141">When processes are implicitly associated with a job during process creation, a child process is associated with every job in the job chain of its parent process.</span></span> <span data-ttu-id="d047e-142">Wenn das unmittelbare Auftrags Objekt einen Abbruch zulässt, wird der untergeordnete Prozess vom unmittelbaren Auftrags Objekt und von jedem Auftrag in der übergeordneten Auftrags Kette unterbrochen. die Hierarchie wird so lange verschoben, bis ein Auftrag erreicht wird, der keine Breakaway zulässt.</span><span class="sxs-lookup"><span data-stu-id="d047e-142">If the immediate job object allows breakaway, the child process breaks away from the immediate job object and from each job in the parent job chain, moving up the hierarchy until it reaches a job that does not permit breakaway.</span></span> <span data-ttu-id="d047e-143">Wenn das unmittelbare Auftrags Objekt keinen Abbruch zulässt, wird der untergeordnete Prozess nicht unterbrochen, auch wenn Aufträge in der übergeordneten Auftrags Kette dies zulassen.</span><span class="sxs-lookup"><span data-stu-id="d047e-143">If the immediate job object does not allow breakaway, the child process does not break away even if jobs in its parent job chain allow it.</span></span>

## <a name="job-limits-and-notifications-for-nested-jobs"></a><span data-ttu-id="d047e-144">Auftrags Limits und Benachrichtigungen für geclusterte Aufträge</span><span class="sxs-lookup"><span data-stu-id="d047e-144">Job Limits and Notifications for Nested Jobs</span></span>

<span data-ttu-id="d047e-145">Für bestimmte Ressourcen Limits bestimmt der für Aufträge in einer übergeordneten Auftrags Kette festgelegte Grenzwert das *effektive Limit* , das für einen untergeordneten Auftrag erzwungen wird.</span><span class="sxs-lookup"><span data-stu-id="d047e-145">For certain resource limits, the limit set for jobs in a parent job chain determine the *effective limit* that is enforced for a child job.</span></span> <span data-ttu-id="d047e-146">Das effektive Limit für untergeordnete Aufträge kann restriktiver sein als die Begrenzung des übergeordneten Auftrags, kann jedoch nicht weniger restriktiv sein.</span><span class="sxs-lookup"><span data-stu-id="d047e-146">The effective limit for child job can be more restrictive than the limit of its parent, but it cannot be less restrictive.</span></span> <span data-ttu-id="d047e-147">Wenn die Prioritäts Klasse eines untergeordneten Auftrags beispielsweise oberhalb der \_ normalen \_ Prioritäts Klasse \_ und die Prioritäts Klasse des übergeordneten Auftrags eine normale \_ Prioritäts Klasse ist \_ , ist der effektive Grenzwert für Prozesse im untergeordneten Auftrag die normale \_ Prioritäts \_ Klasse.</span><span class="sxs-lookup"><span data-stu-id="d047e-147">For example, if a child job's priority class is ABOVE\_NORMAL\_PRIORITY\_CLASS and its parent job's priority class is NORMAL\_PRIORITY\_CLASS, the effective limit for processes in the child job is NORMAL\_PRIORITY\_CLASS.</span></span> <span data-ttu-id="d047e-148">Wenn die Prioritäts Klasse des untergeordneten Auftrags jedoch unter der \_ normalen \_ Prioritäts Klasse liegt \_ , liegt das effektive Limit für Prozesse im untergeordneten Auftrag unter der \_ normalen \_ Prioritäts \_ Klasse.</span><span class="sxs-lookup"><span data-stu-id="d047e-148">However, if the child job's priority class is BELOW\_NORMAL\_PRIORITY\_CLASS, the effective limit for processes in the child job is BELOW\_NORMAL\_PRIORITY\_CLASS.</span></span> <span data-ttu-id="d047e-149">Effektive Grenzwerte werden für die Prioritäts Klasse, Affinität, Commit-Gebühr, prozessübergreifende Ausführungszeit Limit, Zeit Limit für die Planung und Workingset (minimal und Maximum) erzwungen.</span><span class="sxs-lookup"><span data-stu-id="d047e-149">Effective limits are enforced for priority class, affinity, commit charge, per-process execution time limit, scheduling class limit, and working set minimum and maximum.</span></span> <span data-ttu-id="d047e-150">Weitere Informationen zu bestimmten Ressourcen Limits finden Sie unter [ **SetInformationJobObject.**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject)</span><span class="sxs-lookup"><span data-stu-id="d047e-150">For more information about specific resource limits, see [**SetInformationJobObject.**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject)</span></span>

<span data-ttu-id="d047e-151">Wenn bestimmte Ereignisse auftreten, z. b. eine neue Prozesserstellung oder eine Verletzung des Ressourcen Limits, wird eine Nachricht an den e/a-Abschlussport gesendet, der einem Auftrag zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="d047e-151">When certain events occur, such as new process creation or resource limit violation, a message is sent to the I/O completion port associated with a job.</span></span> <span data-ttu-id="d047e-152">Ein Auftrag kann auch registriert werden, um Benachrichtigungen zu empfangen, wenn bestimmte Grenzwerte überschritten werden.</span><span class="sxs-lookup"><span data-stu-id="d047e-152">A job can also register to receive notifications when certain limits are exceeded.</span></span> <span data-ttu-id="d047e-153">Bei einem nicht-in-netsted-Auftrag wird die Nachricht an den e/a-Abschlussport gesendet, der dem Auftrag zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="d047e-153">For a non-nested job, the message is sent to the I/O completion port associated with the job.</span></span> <span data-ttu-id="d047e-154">Bei einem in einem Vorgang ausgefallenen Auftrag wird die Nachricht an jeden e/a-Abschlussport gesendet, der einem Auftrag in der übergeordneten Auftrags Kette des Auftrags zugeordnet ist, der die Nachricht ausgelöst hat.</span><span class="sxs-lookup"><span data-stu-id="d047e-154">For a nested job, the message is sent to every I/O completion port associated with any job in the parent job chain of the job that triggered the message.</span></span> <span data-ttu-id="d047e-155">Einem untergeordneten Auftrag muss kein e/a-Abschlussport zugeordnet sein, damit Nachrichten, die er auslöst, an die e/a-Abschlussports der übergeordneten Aufträge in der Auftrags Kette gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="d047e-155">A child job does not need to have an associated I/O completion port for messages it triggers to be sent to the I/O completion ports of parent jobs higher in the job chain.</span></span> <span data-ttu-id="d047e-156">Weitere Informationen zu bestimmten Nachrichten finden Sie unter [**JobObject \_ Zuordnen des \_ Vervollständigungs \_ Ports**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span><span class="sxs-lookup"><span data-stu-id="d047e-156">For more information about specific messages, see [**JOBOBJECT\_ASSOCIATE\_COMPLETION\_PORT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span></span>

## <a name="resource-accounting-for-nested-jobs"></a><span data-ttu-id="d047e-157">Ressourcen Erfassung für genetztete Aufträge</span><span class="sxs-lookup"><span data-stu-id="d047e-157">Resource Accounting for Nested Jobs</span></span>

<span data-ttu-id="d047e-158">Informationen zur Ressourcen Erfassung für einen in einem Zusammenhang eingefügten Auftrag beschreiben die Verwendung jedes Prozesses, der diesem Auftrag zugeordnet ist, einschließlich der Prozesse in untergeordneten Aufträgen.</span><span class="sxs-lookup"><span data-stu-id="d047e-158">Resource accounting information for a nested job describes the usage of every process associated with that job, including processes in child jobs.</span></span> <span data-ttu-id="d047e-159">Jeder Auftrag in einer Auftrags Kette stellt daher die aggregierten Ressourcen dar, die von den eigenen Prozessen und den Prozessen der einzelnen untergeordneten Aufträge in der Auftrags Kette verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d047e-159">Each job in a job chain therefore represents the aggregated resources used by its own processes and the processes of every child job below it in the job chain.</span></span>

## <a name="termination-of-nested-jobs"></a><span data-ttu-id="d047e-160">Beendigung von in der Liste</span><span class="sxs-lookup"><span data-stu-id="d047e-160">Termination of Nested Jobs</span></span>

<span data-ttu-id="d047e-161">Wenn ein Auftrag in einer Auftrags Hierarchie beendet wird, beendet das System Prozesse in diesem Auftrag und alle seine untergeordneten Aufträge, beginnend mit dem untergeordneten Auftrag unten in der Hierarchie.</span><span class="sxs-lookup"><span data-stu-id="d047e-161">When a job in a job hierarchy is terminated, the system terminates processes in that job and all of its child jobs, starting with the child job at the bottom of the hierarchy.</span></span> <span data-ttu-id="d047e-162">Ausstehende Ressourcen, die von jedem beendeten Prozess verwendet werden, werden dem übergeordneten Auftrag in Rechnung gestellt.</span><span class="sxs-lookup"><span data-stu-id="d047e-162">Outstanding resources used by each terminated process are charged to the parent job.</span></span>

<span data-ttu-id="d047e-163">Für das Auftrags Handle muss das Auftrags \_ Objekt das \_ Zugriffsrecht beenden, wie bei eigenständigen Aufträgen.</span><span class="sxs-lookup"><span data-stu-id="d047e-163">The job handle must have the JOB\_OBJECT\_TERMINATE access right, same as for standalone jobs.</span></span>

 

 
