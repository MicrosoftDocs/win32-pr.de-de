---
description: Ein untergeordneter Prozess kann mehrere Eigenschaften und Ressourcen von seinem übergeordneten Prozess erben.
ms.assetid: c530e723-2d40-4022-a259-dfc650604e44
title: Vererbung (Prozesse und Threads)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4713fe398360b510fab3c66f5cf74dc07b642dac
ms.sourcegitcommit: 3d718d8f69d3f86eaecf94c5705d761c5a9ef4a1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/20/2020
ms.locfileid: "106341753"
---
# <a name="inheritance"></a><span data-ttu-id="35590-103">Vererbung</span><span class="sxs-lookup"><span data-stu-id="35590-103">Inheritance</span></span>

<span data-ttu-id="35590-104">Ein untergeordneter Prozess kann mehrere Eigenschaften und Ressourcen von seinem übergeordneten Prozess erben.</span><span class="sxs-lookup"><span data-stu-id="35590-104">A child process can inherit several properties and resources from its parent process.</span></span> <span data-ttu-id="35590-105">Sie können auch verhindern, dass ein untergeordneter Prozess Eigenschaften aus dem übergeordneten Prozess erbt.</span><span class="sxs-lookup"><span data-stu-id="35590-105">You can also prevent a child process from inheriting properties from its parent process.</span></span> <span data-ttu-id="35590-106">Folgendes kann geerbt werden:</span><span class="sxs-lookup"><span data-stu-id="35590-106">The following can be inherited:</span></span>

-   <span data-ttu-id="35590-107">Geöffnete Handles, die von der Funktion "up [**File**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) " zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="35590-107">Open handles returned by the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span> <span data-ttu-id="35590-108">Dies umfasst Handles für Dateien, Konsolen Eingabepuffer, Konsolenbildschirm Puffer, Named Pipes, serielle Kommunikationsgeräte und Postfächer.</span><span class="sxs-lookup"><span data-stu-id="35590-108">This includes handles to files, console input buffers, console screen buffers, named pipes, serial communication devices, and mailslots.</span></span>
-   <span data-ttu-id="35590-109">Öffnende Handles zum verarbeiten, Thread, Mutex, Ereignis, Semaphore, Named Pipe, anonymen Pipe und Datei Zuordnungsobjekten.</span><span class="sxs-lookup"><span data-stu-id="35590-109">Open handles to process, thread, mutex, event, semaphore, named-pipe, anonymous-pipe, and file-mapping objects.</span></span> <span data-ttu-id="35590-110">Diese werden von den Funktionen " [**forateprocess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)", " [**foratethread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread)", " [**foratemutex**](/windows/desktop/api/synchapi/nf-synchapi-createmutexa)", "up [**Event**](/windows/desktop/api/synchapi/nf-synchapi-createeventa)", " [**foratesemaphore**](/windows/desktop/api/winbase/nf-winbase-createsemaphorea)", " [**foratenamedpipe**](/windows/desktop/api/winbase/nf-winbase-createnamedpipea)", " [**foratepipe**](/windows/desktop/api/namedpipeapi/nf-namedpipeapi-createpipe)" und " [**foratefilemapping**](/windows/desktop/api/winbase/nf-winbase-createfilemappinga) " zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="35590-110">These are returned by the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa), [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread), [**CreateMutex**](/windows/desktop/api/synchapi/nf-synchapi-createmutexa), [**CreateEvent**](/windows/desktop/api/synchapi/nf-synchapi-createeventa), [**CreateSemaphore**](/windows/desktop/api/winbase/nf-winbase-createsemaphorea), [**CreateNamedPipe**](/windows/desktop/api/winbase/nf-winbase-createnamedpipea), [**CreatePipe**](/windows/desktop/api/namedpipeapi/nf-namedpipeapi-createpipe), and [**CreateFileMapping**](/windows/desktop/api/winbase/nf-winbase-createfilemappinga) functions, respectively.</span></span>
-   <span data-ttu-id="35590-111">Umgebungsvariablen.</span><span class="sxs-lookup"><span data-stu-id="35590-111">Environment variables.</span></span>
-   <span data-ttu-id="35590-112">Das aktuelle Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="35590-112">The current directory.</span></span>
-   <span data-ttu-id="35590-113">Die Konsole, es sei denn, der Prozess ist getrennt, oder es wird eine neue Konsole erstellt.</span><span class="sxs-lookup"><span data-stu-id="35590-113">The console, unless the process is detached or a new console is created.</span></span> <span data-ttu-id="35590-114">Bei einem untergeordneten Konsolen Prozess können auch die Standard Handles des übergeordneten Elements sowie der Zugriff auf den Eingabepuffer und den aktiven Bildschirm Puffer vererbt werden.</span><span class="sxs-lookup"><span data-stu-id="35590-114">A child console process can also inherit the parent's standard handles, as well as access to the input buffer and the active screen buffer.</span></span>
-   <span data-ttu-id="35590-115">Der Fehler Modus, wie von der [**SetErrorMode**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-seterrormode) -Funktion festgelegt.</span><span class="sxs-lookup"><span data-stu-id="35590-115">The error mode, as set by the [**SetErrorMode**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-seterrormode) function.</span></span>
-   <span data-ttu-id="35590-116">Die Prozessor Affinitäts Maske.</span><span class="sxs-lookup"><span data-stu-id="35590-116">The processor affinity mask.</span></span>
-   <span data-ttu-id="35590-117">Die Zuordnung zu einem Auftrag.</span><span class="sxs-lookup"><span data-stu-id="35590-117">The association with a job.</span></span>

<span data-ttu-id="35590-118">Der untergeordnete Prozess erbt nicht Folgendes:</span><span class="sxs-lookup"><span data-stu-id="35590-118">The child process does not inherit the following:</span></span>

-   <span data-ttu-id="35590-119">Prioritäts Klasse.</span><span class="sxs-lookup"><span data-stu-id="35590-119">Priority class.</span></span>
-   <span data-ttu-id="35590-120">Handles, die von " [**localzuweisung**](/windows/desktop/api/winbase/nf-winbase-localalloc)", " [**Globalzuweisung**](/windows/desktop/api/winbase/nf-winbase-globalalloc)", " [**HeapCreate**](/windows/desktop/api/heapapi/nf-heapapi-heapcreate)" und " [**Heapzuweisung**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc)" zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="35590-120">Handles returned by [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc), [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc), [**HeapCreate**](/windows/desktop/api/heapapi/nf-heapapi-heapcreate), and [**HeapAlloc**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc).</span></span>
-   <span data-ttu-id="35590-121">Pseudo Handles, wie in den Handles, die von der [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess) -Funktion oder der [**GetCurrentThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthread) -Funktion zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="35590-121">Pseudo handles, as in the handles returned by the [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess) or [**GetCurrentThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthread) function.</span></span> <span data-ttu-id="35590-122">Diese Handles sind nur für den aufrufenden Prozess gültig.</span><span class="sxs-lookup"><span data-stu-id="35590-122">These handles are valid only for the calling process.</span></span>
-   <span data-ttu-id="35590-123">Von der [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) -Funktion zurückgegebene dll-Modul Handles.</span><span class="sxs-lookup"><span data-stu-id="35590-123">DLL module handles returned by the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function.</span></span>
-   <span data-ttu-id="35590-124">GDI oder Benutzer Handles, z. b. **hBitmap** oder **HMENU**.</span><span class="sxs-lookup"><span data-stu-id="35590-124">GDI or USER handles, such as **HBITMAP** or **HMENU**.</span></span>

## <a name="inheriting-handles"></a><span data-ttu-id="35590-125">Erben von Handles</span><span class="sxs-lookup"><span data-stu-id="35590-125">Inheriting Handles</span></span>

<span data-ttu-id="35590-126">Ein untergeordneter Prozess kann einige der übergeordneten Handles erben, aber keine anderen erben.</span><span class="sxs-lookup"><span data-stu-id="35590-126">A child process can inherit some of its parent's handles, but not inherit others.</span></span> <span data-ttu-id="35590-127">Um die Vererbung eines Handles zu bewirken, müssen Sie zwei Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="35590-127">To cause a handle to be inherited, you must do two things:</span></span>

-   <span data-ttu-id="35590-128">Geben Sie an, dass das Handle geerbt werden soll, wenn Sie das Handle erstellen, öffnen oder duplizieren.</span><span class="sxs-lookup"><span data-stu-id="35590-128">Specify that the handle is to be inherited when you create, open, or duplicate the handle.</span></span> <span data-ttu-id="35590-129">Erstellungs Funktionen verwenden in der Regel den **binherithandle** -Member einer Struktur von [**Sicherheits \_ Attributen**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) zu diesem Zweck.</span><span class="sxs-lookup"><span data-stu-id="35590-129">Creation functions typically use the **bInheritHandle** member of a [**SECURITY\_ATTRIBUTES**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) structure for this purpose.</span></span> <span data-ttu-id="35590-130">[**Duplialisiehandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) verwendet den *binherithandles* -Parameter.</span><span class="sxs-lookup"><span data-stu-id="35590-130">[**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) uses the *bInheritHandles* parameter.</span></span>
-   <span data-ttu-id="35590-131">Gibt an, dass vererbbare Handles geerbt werden sollen, indem der *binherithandles* -Parameter beim Aufrufen der [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) -Funktion auf true festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="35590-131">Specify that inheritable handles are to be inherited by setting the *bInheritHandles* parameter to TRUE when calling the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function.</span></span> <span data-ttu-id="35590-132">Außerdem muss der **dwFlags** -Member der [**STARTUPINFO**](/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa) -Struktur Startf-usestdhandles enthalten, um die Standardeingabe, Standardausgabe und Standardfehler Handles zu erben \_ .</span><span class="sxs-lookup"><span data-stu-id="35590-132">Additionally, to inherit the standard input, standard output, and standard error handles, the **dwFlags** member of the [**STARTUPINFO**](/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa) structure must include STARTF\_USESTDHANDLES.</span></span>

<span data-ttu-id="35590-133">Um eine Liste der Handles anzugeben, die von einem bestimmten untergeordneten Prozess geerbt werden sollen, müssen Sie die Funktion [**updateprocthreadattribute**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) mit dem *PROC_THREAD_ATTRIBUTE_HANDLE_LIST* -Flag aufrufen.</span><span class="sxs-lookup"><span data-stu-id="35590-133">To specify a list of the handles that should be inherited by a specific child process, call the [**UpdateProcThreadAttribute**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) function with the *PROC_THREAD_ATTRIBUTE_HANDLE_LIST* flag.</span></span>

<span data-ttu-id="35590-134">Ein geerbtes Handle verweist auf das gleiche Objekt im untergeordneten Prozess wie im übergeordneten Prozess.</span><span class="sxs-lookup"><span data-stu-id="35590-134">An inherited handle refers to the same object in the child process as it does in the parent process.</span></span> <span data-ttu-id="35590-135">Außerdem verfügt sie über dieselben Werte und Zugriffsberechtigungen.</span><span class="sxs-lookup"><span data-stu-id="35590-135">It also has the same value and access privileges.</span></span> <span data-ttu-id="35590-136">Wenn ein Prozess den Status des Objekts ändert, wirkt sich die Änderung daher auf beide Prozesse aus.</span><span class="sxs-lookup"><span data-stu-id="35590-136">Therefore, when one process changes the state of the object, the change affects both processes.</span></span> <span data-ttu-id="35590-137">Um ein Handle zu verwenden, muss der untergeordnete Prozess den Handle-Wert abrufen und das Objekt, auf das es verweist, "wissen".</span><span class="sxs-lookup"><span data-stu-id="35590-137">To use a handle, the child process must retrieve the handle value and "know" the object to which it refers.</span></span> <span data-ttu-id="35590-138">Normalerweise kommuniziert der übergeordnete Prozess diese Informationen über die Befehlszeile, den Umgebungsblock oder eine Form der [prozessübergreifenden Kommunikation](/windows/desktop/ipc/interprocess-communications)an den untergeordneten Prozess.</span><span class="sxs-lookup"><span data-stu-id="35590-138">Usually, the parent process communicates this information to the child process through its command line, environment block, or some form of [interprocess communication](/windows/desktop/ipc/interprocess-communications).</span></span>

<span data-ttu-id="35590-139">Verwenden Sie [**die Funktion**](/windows/win32/api/handleapi/nf-handleapi-sethandleinformation) "-Funktion", um zu steuern, ob ein vorhandenes handle vererbbar ist.</span><span class="sxs-lookup"><span data-stu-id="35590-139">Use the [**SetHandleInformation**](/windows/win32/api/handleapi/nf-handleapi-sethandleinformation) function to control if an existing handle is inheritable or not.</span></span>

## <a name="inheriting-environment-variables"></a><span data-ttu-id="35590-140">Erbt Umgebungsvariablen</span><span class="sxs-lookup"><span data-stu-id="35590-140">Inheriting Environment Variables</span></span>

<span data-ttu-id="35590-141">Ein untergeordneter Prozess erbt die Umgebungsvariablen des übergeordneten Prozesses standardmäßig.</span><span class="sxs-lookup"><span data-stu-id="35590-141">A child process inherits the environment variables of its parent process by default.</span></span> <span data-ttu-id="35590-142">Allerdings [**kann der**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) übergeordnete Prozess über den übergeordneten Prozess einen anderen Block von Umgebungsvariablen angeben.</span><span class="sxs-lookup"><span data-stu-id="35590-142">However, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) enables the parent process to specify a different block of environment variables.</span></span> <span data-ttu-id="35590-143">Weitere Informationen finden Sie unter [Umgebungsvariablen](environment-variables.md).</span><span class="sxs-lookup"><span data-stu-id="35590-143">For more information, see [Environment Variables](environment-variables.md).</span></span>

## <a name="inheriting-the-current-directory"></a><span data-ttu-id="35590-144">Erbt das aktuelle Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="35590-144">Inheriting the Current Directory</span></span>

<span data-ttu-id="35590-145">Die [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) -Funktion Ruft das aktuelle Verzeichnis des aufrufenden Prozesses ab.</span><span class="sxs-lookup"><span data-stu-id="35590-145">The [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) function retrieves the current directory of the calling process.</span></span> <span data-ttu-id="35590-146">Ein untergeordneter Prozess erbt standardmäßig das aktuelle Verzeichnis seines übergeordneten Prozesses.</span><span class="sxs-lookup"><span data-stu-id="35590-146">A child process inherits the current directory of its parent process by default.</span></span> <span data-ttu-id="35590-147">Allerdings [**ermöglicht der übergeordnete Prozess dem**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) übergeordneten Prozess das Angeben eines anderen aktuellen Verzeichnisses für den untergeordneten Prozess.</span><span class="sxs-lookup"><span data-stu-id="35590-147">However, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) enables the parent process to specify a different current directory for the child process.</span></span> <span data-ttu-id="35590-148">Verwenden Sie die [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) -Funktion, um das aktuelle Verzeichnis des aufrufenden Prozesses zu ändern.</span><span class="sxs-lookup"><span data-stu-id="35590-148">To change the current directory of the calling process, use the [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) function.</span></span>
