---
description: 'Das Beenden eines Prozesses hat die folgenden Ergebnisse: alle verbleibenden Threads im Prozess werden für die Beendigung markiert. Alle vom Prozess zugewiesenen Ressourcen werden freigegeben. Alle Kernel Objekte werden geschlossen. Der Prozess Code wird aus dem Arbeitsspeicher entfernt. Der Prozessexitcode wird festgelegt. Das Prozess Objekt wird signalisiert.'
ms.assetid: af24d157-2719-4052-8029-1eb8010047cc
title: Beenden eines Prozesses
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2010f1d4332a575c8ee94cf1b0f196e00ba7fb9f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106347582"
---
# <a name="terminating-a-process"></a><span data-ttu-id="919b8-103">Beenden eines Prozesses</span><span class="sxs-lookup"><span data-stu-id="919b8-103">Terminating a Process</span></span>

<span data-ttu-id="919b8-104">Das Beenden eines Prozesses hat die folgenden Ergebnisse:</span><span class="sxs-lookup"><span data-stu-id="919b8-104">Terminating a process has the following results:</span></span>

-   <span data-ttu-id="919b8-105">Alle verbleibenden Threads im Prozess werden für die Beendigung gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="919b8-105">Any remaining threads in the process are marked for termination.</span></span>
-   <span data-ttu-id="919b8-106">Alle vom Prozess zugewiesenen Ressourcen werden freigegeben.</span><span class="sxs-lookup"><span data-stu-id="919b8-106">Any resources allocated by the process are freed.</span></span>
-   <span data-ttu-id="919b8-107">Alle Kernel Objekte werden geschlossen.</span><span class="sxs-lookup"><span data-stu-id="919b8-107">All kernel objects are closed.</span></span>
-   <span data-ttu-id="919b8-108">Der Prozess Code wird aus dem Arbeitsspeicher entfernt.</span><span class="sxs-lookup"><span data-stu-id="919b8-108">The process code is removed from memory.</span></span>
-   <span data-ttu-id="919b8-109">Der Prozessexitcode wird festgelegt.</span><span class="sxs-lookup"><span data-stu-id="919b8-109">The process exit code is set.</span></span>
-   <span data-ttu-id="919b8-110">Das Prozess Objekt wird signalisiert.</span><span class="sxs-lookup"><span data-stu-id="919b8-110">The process object is signaled.</span></span>

<span data-ttu-id="919b8-111">Während geöffnete Handles für Kernel Objekte automatisch geschlossen werden, wenn ein Prozess beendet wird, sind die Objekte selbst so lange vorhanden, bis alle geöffneten Handles geschlossen sind.</span><span class="sxs-lookup"><span data-stu-id="919b8-111">While open handles to kernel objects are closed automatically when a process terminates, the objects themselves exist until all open handles to them are closed.</span></span> <span data-ttu-id="919b8-112">Daher bleibt ein Objekt gültig, nachdem ein Prozess, von dem es verwendet wird, beendet wird, wenn ein anderer Prozess über ein geöffnetes Handle verfügt.</span><span class="sxs-lookup"><span data-stu-id="919b8-112">Therefore, an object will remain valid after a process that is using it terminates if another process has an open handle to it.</span></span>

<span data-ttu-id="919b8-113">Die [**GetExitCodeProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodeprocess) -Funktion gibt den Beendigungs Status eines Prozesses zurück.</span><span class="sxs-lookup"><span data-stu-id="919b8-113">The [**GetExitCodeProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodeprocess) function returns the termination status of a process.</span></span> <span data-ttu-id="919b8-114">Während der Ausführung eines Prozesses ist der Beendigungs Status immer noch \_ aktiv.</span><span class="sxs-lookup"><span data-stu-id="919b8-114">While a process is executing, its termination status is STILL\_ACTIVE.</span></span> <span data-ttu-id="919b8-115">Wenn ein Prozess beendet wird, ändert sich der Beendigungs Status von noch \_ aktiv in den Exitcode des Prozesses.</span><span class="sxs-lookup"><span data-stu-id="919b8-115">When a process terminates, its termination status changes from STILL\_ACTIVE to the exit code of the process.</span></span>

<span data-ttu-id="919b8-116">Wenn ein Prozess beendet wird, wird der Status des Prozess Objekts signalisiert und alle Threads freigegeben, die auf das Beenden des Prozesses gewartet haben.</span><span class="sxs-lookup"><span data-stu-id="919b8-116">When a process terminates, the state of the process object becomes signaled, releasing any threads that had been waiting for the process to terminate.</span></span> <span data-ttu-id="919b8-117">Weitere Informationen zur Synchronisierung finden Sie unter [Synchronisieren der Ausführung mehrerer Threads](synchronizing-execution-of-multiple-threads.md).</span><span class="sxs-lookup"><span data-stu-id="919b8-117">For more about synchronization, see [Synchronizing Execution of Multiple Threads](synchronizing-execution-of-multiple-threads.md).</span></span>

<span data-ttu-id="919b8-118">Wenn das System einen Prozess beendet, werden keine untergeordneten Prozesse beendet, die vom Prozess erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="919b8-118">When the system is terminating a process, it does not terminate any child processes that the process has created.</span></span> <span data-ttu-id="919b8-119">Beim Beenden eines Prozesses werden keine Benachrichtigungen für die \_ CBT-Hook-Prozeduren von WH generiert</span><span class="sxs-lookup"><span data-stu-id="919b8-119">Terminating a process does not generate notifications for WH\_CBT hook procedures.</span></span>

<span data-ttu-id="919b8-120">Verwenden Sie die Funktion [**setprocessshutdownparameters**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setprocessshutdownparameters) , um bestimmte Aspekte der Prozess Beendigung beim Herunterfahren des Systems anzugeben, z. b. Wenn ein Prozess relativ zu den anderen Prozessen im System beendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="919b8-120">Use the [**SetProcessShutdownParameters**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setprocessshutdownparameters) function to specify certain aspects of the process termination at system shutdown, such as when a process should terminate relative to the other processes in the system.</span></span>

## <a name="how-processes-are-terminated"></a><span data-ttu-id="919b8-121">Beenden von Prozessen</span><span class="sxs-lookup"><span data-stu-id="919b8-121">How Processes are Terminated</span></span>

<span data-ttu-id="919b8-122">Ein Prozess wird ausgeführt, bis eines der folgenden Ereignisse eintritt:</span><span class="sxs-lookup"><span data-stu-id="919b8-122">A process executes until one of the following events occurs:</span></span>

-   <span data-ttu-id="919b8-123">Jeder Thread des Prozesses Ruft die [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) -Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="919b8-123">Any thread of the process calls the [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) function.</span></span> <span data-ttu-id="919b8-124">Beachten Sie, dass bei einer Implementierung der C-Lauf Zeit Bibliothek (CRT) **ExitProcess** aufgerufen wird, wenn der primäre Thread des Prozesses zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="919b8-124">Note that some implementation of the C run-time library (CRT) call **ExitProcess** if the primary thread of the process returns.</span></span>
-   <span data-ttu-id="919b8-125">Der letzte Thread des Prozesses wird beendet.</span><span class="sxs-lookup"><span data-stu-id="919b8-125">The last thread of the process terminates.</span></span>
-   <span data-ttu-id="919b8-126">Jeder Thread ruft die Funktion [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) mit einem Handle für den Prozess auf.</span><span class="sxs-lookup"><span data-stu-id="919b8-126">Any thread calls the [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) function with a handle to the process.</span></span>
-   <span data-ttu-id="919b8-127">Für Konsolen Prozesse ruft der [standardkonsolen-Steuerelement Handler](/windows/console/console-control-handlers) [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) auf, wenn die Konsole das Signal STRG + C oder STRG + UNTBR empfängt.</span><span class="sxs-lookup"><span data-stu-id="919b8-127">For console processes, the default [console control handler](/windows/console/console-control-handlers) calls [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) when the console receives a CTRL+C or CTRL+BREAK signal.</span></span>
-   <span data-ttu-id="919b8-128">Der Benutzer fährt das System herunter oder meldet sich ab.</span><span class="sxs-lookup"><span data-stu-id="919b8-128">The user shuts down the system or logs off.</span></span>

<span data-ttu-id="919b8-129">Beenden Sie keinen Prozess, es sei denn, seine Threads befinden sich in einem bekannten Zustand.</span><span class="sxs-lookup"><span data-stu-id="919b8-129">Do not terminate a process unless its threads are in known states.</span></span> <span data-ttu-id="919b8-130">Wenn ein Thread auf ein Kernel Objekt wartet, wird es erst beendet, wenn der Warte Vorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="919b8-130">If a thread is waiting on a kernel object, it will not be terminated until the wait has completed.</span></span> <span data-ttu-id="919b8-131">Dies kann dazu führen, dass die Anwendung nicht mehr reagiert.</span><span class="sxs-lookup"><span data-stu-id="919b8-131">This can cause the application to stop responding.</span></span>

<span data-ttu-id="919b8-132">Der primäre Thread kann das Beenden anderer Threads vermeiden, indem er Sie an den [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread) -Befehl weiterleitet, bevor der Prozess beendet wird (Weitere Informationen finden Sie unter [Beenden eines Threads](terminating-a-thread.md)).</span><span class="sxs-lookup"><span data-stu-id="919b8-132">The primary thread can avoid terminating other threads by directing them to call [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread) before causing the process to terminate (for more information, see [Terminating a Thread](terminating-a-thread.md)).</span></span> <span data-ttu-id="919b8-133">Der primäre Thread kann später weiterhin [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) aufzurufen, um sicherzustellen, dass alle Threads beendet werden.</span><span class="sxs-lookup"><span data-stu-id="919b8-133">The primary thread can still call [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) afterwards to ensure that all threads are terminated.</span></span>

<span data-ttu-id="919b8-134">Der [**Exitcode**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) für einen Prozess ist entweder der Wert, der im ExitProcess-oder [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess)-Befehl angegeben ist, oder der von der Main-oder [**WinMain**](/windows/win32/api/winbase/nf-winbase-winmain) -Funktion des Prozesses zurückgegebene Wert.</span><span class="sxs-lookup"><span data-stu-id="919b8-134">The exit code for a process is either the value specified in the call to [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) or [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess), or the value returned by the main or [**WinMain**](/windows/win32/api/winbase/nf-winbase-winmain) function of the process.</span></span> <span data-ttu-id="919b8-135">Wenn ein Prozess aufgrund einer schwerwiegenden Ausnahme beendet wird, ist der Exitcode der Wert der Ausnahme, die die Beendigung verursacht hat.</span><span class="sxs-lookup"><span data-stu-id="919b8-135">If a process is terminated due to a fatal exception, the exit code is the value of the exception that caused the termination.</span></span> <span data-ttu-id="919b8-136">Außerdem wird dieser Wert als Exitcode für alle Threads verwendet, die ausgeführt wurden, als die Ausnahme aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="919b8-136">In addition, this value is used as the exit code for all the threads that were executing when the exception occurred.</span></span>

<span data-ttu-id="919b8-137">Wenn ein Prozess von [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess)beendet wird, ruft das System die Einstiegspunkt Funktion der einzelnen angefügten dll mit einem Wert auf, der angibt, dass der Prozess von der DLL getrennt wird.</span><span class="sxs-lookup"><span data-stu-id="919b8-137">If a process is terminated by [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess), the system calls the entry-point function of each attached DLL with a value indicating that the process is detaching from the DLL.</span></span> <span data-ttu-id="919b8-138">DLLs werden nicht benachrichtigt, wenn ein Prozess von [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess)beendet wird.</span><span class="sxs-lookup"><span data-stu-id="919b8-138">DLLs are not notified when a process is terminated by [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess).</span></span> <span data-ttu-id="919b8-139">Weitere Informationen zu DLLs finden Sie unter [Dynamic Link Libraries (Dynamic Link Libraries](../dlls/dynamic-link-libraries.md)).</span><span class="sxs-lookup"><span data-stu-id="919b8-139">For more information about DLLs, see [Dynamic-Link Libraries](../dlls/dynamic-link-libraries.md).</span></span>

<span data-ttu-id="919b8-140">Wenn ein Prozess von [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess)beendet wird, werden alle Threads des Prozesses sofort beendet, ohne dass zusätzlicher Code ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="919b8-140">If a process is terminated by [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess), all threads of the process are terminated immediately with no chance to run additional code.</span></span> <span data-ttu-id="919b8-141">Dies bedeutet, dass der Thread Code in Beendigungs handlerblöcken nicht ausführt.</span><span class="sxs-lookup"><span data-stu-id="919b8-141">This means that the thread does not execute code in termination handler blocks.</span></span> <span data-ttu-id="919b8-142">Außerdem werden keine angefügten DLLs benachrichtigt, wenn der Prozess getrennt wird.</span><span class="sxs-lookup"><span data-stu-id="919b8-142">In addition, no attached DLLs are notified that the process is detaching.</span></span> <span data-ttu-id="919b8-143">Wenn ein Prozess einen anderen Prozess beenden muss, bieten die folgenden Schritte eine bessere Lösung:</span><span class="sxs-lookup"><span data-stu-id="919b8-143">If you need to have one process terminate another process, the following steps provide a better solution:</span></span>

-   <span data-ttu-id="919b8-144">Lassen Sie beide Prozesse die [**RegisterWindowMessage**](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea) -Funktion aufrufen, um eine private Nachricht zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="919b8-144">Have both processes call the [**RegisterWindowMessage**](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea) function to create a private message.</span></span>
-   <span data-ttu-id="919b8-145">Ein Prozess kann den anderen Prozess beenden, indem er eine private Nachricht mithilfe der [**broadcastsystemmessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) -Funktion wie folgt sendet:</span><span class="sxs-lookup"><span data-stu-id="919b8-145">One process can terminate the other process by broadcasting a private message using the [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) function as follows:</span></span>

    ``` syntax
     DWORD dwRecipients = BSM_APPLICATIONS;
        UINT uMessage = PM_MYMSG;
        WPARAM wParam = 0;
        LPARAM lParam = 0;

        BroadcastSystemMessage( 
            BSF_IGNORECURRENTTASK, // do not send message to this process
            &dwRecipients,         // broadcast only to applications
            uMessage,              // registered private message
            wParam,                // message-specific value
            lParam );              // message-specific value
    ```

-   <span data-ttu-id="919b8-146">Der Prozess, der die private Nachricht empfängt, ruft [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) auf, um die Ausführung zu beenden.</span><span class="sxs-lookup"><span data-stu-id="919b8-146">The process receiving the private message calls [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) to terminate its execution.</span></span>

<span data-ttu-id="919b8-147">Die Ausführung der Funktionen " [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess)", " [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread)", " [**foratethread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread)", " [**forateremotethread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread)" und " [**forateprocess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) " wird innerhalb eines Adressraums serialisiert.</span><span class="sxs-lookup"><span data-stu-id="919b8-147">The execution of the [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess), [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread), [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread), [**CreateRemoteThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread), and [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) functions is serialized within an address space.</span></span> <span data-ttu-id="919b8-148">Es gelten folgende Einschränkungen:</span><span class="sxs-lookup"><span data-stu-id="919b8-148">The following restrictions apply:</span></span>

-   <span data-ttu-id="919b8-149">Während der Prozessstart-und dll-Initialisierungs Routinen können neue Threads erstellt werden. Sie beginnen jedoch erst mit der Ausführung, wenn die Initialisierung der DLL für den Prozess abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="919b8-149">During process startup and DLL initialization routines, new threads can be created, but they do not begin execution until DLL initialization is finished for the process.</span></span>
-   <span data-ttu-id="919b8-150">Nur ein Thread kann sich in einer DLL-Initialisierungs-oder-Trenn Routine befinden.</span><span class="sxs-lookup"><span data-stu-id="919b8-150">Only one thread at a time can be in a DLL initialization or detach routine.</span></span>
-   <span data-ttu-id="919b8-151">Die [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) -Funktion wird erst zurückgegeben, wenn die dll-Initialisierungs-oder Trenn Routinen vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="919b8-151">The [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) function does not return until there are no threads are in their DLL initialization or detach routines.</span></span>

 

 
