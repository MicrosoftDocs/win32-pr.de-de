---
title: QueryInterface-Navigation in einem Objekt
description: QueryInterface-Navigation in einem Objekt
ms.assetid: 7dec015f-7609-40eb-a71e-f6e9c9b9f8ff
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3dbd44d200bf0a992f47bc375d0782bdadacf6a3
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/29/2020
ms.locfileid: "104314076"
---
# <a name="queryinterface-navigating-in-an-object"></a><span data-ttu-id="8456a-103">QueryInterface: Navigieren in einem Objekt</span><span class="sxs-lookup"><span data-stu-id="8456a-103">QueryInterface: Navigating in an Object</span></span>

<span data-ttu-id="8456a-104">Nachdem Sie einen anfänglichen Zeiger auf eine Schnittstelle für ein Objekt haben, verfügt com über einen sehr einfachen Mechanismus, um herauszufinden, ob das Objekt eine andere bestimmte Schnittstelle unterstützt, und wenn dies der Fall ist, um einen Zeiger darauf zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="8456a-104">After you have an initial pointer to an interface on an object, COM has a very simple mechanism to find out whether the object supports another specific interface and, if so, to get a pointer to it.</span></span> <span data-ttu-id="8456a-105">(Informationen zum erhalten eines ersten Zeigers auf eine Schnittstelle für ein Objekt finden Sie unter " [erhalten eines Zeigers auf ein Objekt](getting-a-pointer-to-an-object.md)"). Dieser Mechanismus ist die [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) -Methode der [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="8456a-105">(For information about getting an initial pointer to an interface on an object, see [Getting a Pointer to an Object](getting-a-pointer-to-an-object.md).) This mechanism is the [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method of the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="8456a-106">Wenn das Objekt die angeforderte Schnittstelle unterstützt, muss die Methode einen Zeiger auf diese Schnittstelle zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="8456a-106">If the object supports the requested interface, the method must return a pointer to that interface.</span></span> <span data-ttu-id="8456a-107">Dies ermöglicht es einem Objekt, durch die von einem Objekt unterstützten Schnittstellen frei zu navigieren.</span><span class="sxs-lookup"><span data-stu-id="8456a-107">This permits an object to navigate freely through the interfaces that an object supports.</span></span> <span data-ttu-id="8456a-108">**QueryInterface** trennt die Anforderung "unterstützen Sie einen bestimmten Vertrag?"</span><span class="sxs-lookup"><span data-stu-id="8456a-108">**QueryInterface** separates the request "Do you support a given contract?"</span></span> <span data-ttu-id="8456a-109">von der leistungsstarken Verwendung dieses Vertrags, wenn die Verhandlungen erfolgreich waren.</span><span class="sxs-lookup"><span data-stu-id="8456a-109">from the high-performance use of that contract once negotiations have been successful.</span></span>

<span data-ttu-id="8456a-110">Wenn ein Client anfänglich auf ein Objekt zugreifen kann, empfängt der Client mindestens einen [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Schnittstellen Zeiger (die grundlegendste Schnittstelle), über den er die Lebensdauer des Objekts steuern kann – indem er das Objekt mit dem Objekt – teilt und [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))aufruft.</span><span class="sxs-lookup"><span data-stu-id="8456a-110">When a client initially gains access to an object, that client will receive, at a minimum, an [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface pointer (the most fundamental interface) through which it can control the lifetime of the object—by telling the object when it is done using the object—and invoke [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span> <span data-ttu-id="8456a-111">Der Client ist so programmiert, dass jedes Objekt, das es verwaltet, zum Ausführen einiger Vorgänge aufgefordert wird, aber die **IUnknown** -Schnittstelle verfügt über keine Funktionen für diese Vorgänge.</span><span class="sxs-lookup"><span data-stu-id="8456a-111">The client is programmed to ask each object it manages to perform some operations, but the **IUnknown** interface has no functions for those operations.</span></span> <span data-ttu-id="8456a-112">Stattdessen werden diese Vorgänge über andere Schnittstellen ausgedrückt.</span><span class="sxs-lookup"><span data-stu-id="8456a-112">Instead, those operations are expressed through other interfaces.</span></span> <span data-ttu-id="8456a-113">Der Client ist daher so programmiert, dass er mit Objekten für diese Schnittstellen aushandelt.</span><span class="sxs-lookup"><span data-stu-id="8456a-113">The client is thus programmed to negotiate with objects for those interfaces.</span></span> <span data-ttu-id="8456a-114">Insbesondere ruft der Client **QueryInterface** auf, um ein Objekt für eine Schnittstelle anzufordern, über die der Client die gewünschten Vorgänge aufrufen kann.</span><span class="sxs-lookup"><span data-stu-id="8456a-114">Specifically, the client will call **QueryInterface** to ask an object for an interface through which the client may invoke the desired operations.</span></span>

<span data-ttu-id="8456a-115">Da das-Objekt [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))implementiert, ist es in der Lage, die Anforderung zu akzeptieren oder abzulehnen.</span><span class="sxs-lookup"><span data-stu-id="8456a-115">Because the object implements [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), it has the ability to accept or reject the request.</span></span> <span data-ttu-id="8456a-116">Wenn das Objekt die Anforderung des Clients annimmt, gibt **QueryInterface** einen neuen Zeiger auf die angeforderte Schnittstelle an den Client zurück.</span><span class="sxs-lookup"><span data-stu-id="8456a-116">If the object accepts the client's request, **QueryInterface** returns a new pointer to the requested interface to the client.</span></span> <span data-ttu-id="8456a-117">Über diesen Schnittstellen Zeiger hat der Client Zugriff auf die Methoden dieser Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="8456a-117">Through that interface pointer, the client has access to the methods of that interface.</span></span> <span data-ttu-id="8456a-118">Wenn hingegen das Objekt die Anforderung des Clients zurückweist, gibt **QueryInterface** einen NULL-Zeiger zurück – einen Fehler –, und der Client hat keinen Zeiger, über den die gewünschten Funktionen aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="8456a-118">If, on the other hand, the object rejects the client's request, **QueryInterface** returns a null pointer—an error—and the client has no pointer through which to call the desired functions.</span></span> <span data-ttu-id="8456a-119">In diesem Fall muss der Client diese Möglichkeit ordnungsgemäß behandeln.</span><span class="sxs-lookup"><span data-stu-id="8456a-119">In this case, the client must deal gracefully with that possibility.</span></span> <span data-ttu-id="8456a-120">Angenommen, ein Client verfügt über einen Zeiger auf die Schnittstelle a für ein Objekt und fordert die Schnittstellen b und C an. nehmen Sie auch an, dass das Objekt Schnittstelle b unterstützt, aber Schnittstelle C nicht unterstützt. Das Ergebnis ist, dass das-Objekt einen Zeiger auf B zurückgibt und meldet, dass C nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="8456a-120">For example, suppose a client has a pointer to interface A on an object and asks for interfaces B and C. Suppose also that the object supports interface B but does not support interface C. The result is that the object returns a pointer to B and reports that C is not supported.</span></span>

<span data-ttu-id="8456a-121">Ein wichtiger Punkt ist, dass der Client das Objekt nicht zum Ausführen der Vorgänge auffordern kann, die über die angeforderte Schnittstelle ausgedrückt werden, wenn ein Objekt einen aufzurufenden [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))-Rückruf ablehnt.</span><span class="sxs-lookup"><span data-stu-id="8456a-121">A key point is that when an object rejects a call to [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), it is impossible for the client to ask the object to perform the operations expressed through the requested interface.</span></span> <span data-ttu-id="8456a-122">Ein Client muss über einen Schnittstellen Zeiger verfügen, um Methoden in dieser Schnittstelle aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="8456a-122">A client must have an interface pointer to invoke methods in that interface.</span></span> <span data-ttu-id="8456a-123">Wenn das Objekt den angeforderten Zeiger nicht bereitstellen möchte, muss der Client für die Verwendung von vorbereitet sein, und zwar entweder durch das Ausführen eines anderen, was mit diesem Objekt beabsichtigt war, oder durch einen Versuch, auf eine andere, vielleicht weniger leistungsfähige Schnittstelle zurückzukommen.</span><span class="sxs-lookup"><span data-stu-id="8456a-123">If the object refuses to provide the requested pointer, the client must be prepared to do without, either by not doing whatever it had intended to do with that object or by attempting to fall back on another, perhaps less powerful, interface.</span></span> <span data-ttu-id="8456a-124">Diese Funktion der com-Funktionalität eignet sich gut für andere objektorientierte Systeme, bei denen Sie nicht wissen, ob eine Funktion funktioniert, bis Sie diese Funktion aufgerufen haben. selbst dann ist die Behandlung von Fehlern unsicher.</span><span class="sxs-lookup"><span data-stu-id="8456a-124">This feature of COM functionality works well in comparison with other object-oriented systems in which you cannot know whether a function will work until you call that function, and even then, handling failure is uncertain.</span></span> <span data-ttu-id="8456a-125">**QueryInterface** bietet eine zuverlässige und konsistente Möglichkeit zu wissen, ob ein Objekt eine Schnittstelle unterstützt, bevor versucht wird, seine Methoden aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="8456a-125">**QueryInterface** provides a reliable and consistent way to know whether an object supports an interface before attempting to call its methods.</span></span>

<span data-ttu-id="8456a-126">Die [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) -Methode bietet auch einen robusten und zuverlässigen Weg für ein Objekt, um anzugeben, dass ein bestimmter Vertrag nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="8456a-126">The [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method also provides a robust and reliable way for an object to indicate that it does not support a given contract.</span></span> <span data-ttu-id="8456a-127">Das heißt, wenn in einem Anruf von **QueryInterface** One ein "altes" Objekt anfordert, ob es eine "neue" Schnittstelle unterstützt (z. b., die nach dem Versenden des alten Objekts erfunden wurde), wird das alte Objekt zuverlässig, ohne einen Absturz zu verursachen, mit "Nein" beantwortet.</span><span class="sxs-lookup"><span data-stu-id="8456a-127">That is, if in a call to **QueryInterface** one asks an "old" object whether it supports a "new" interface (one, for example, that was invented after the old object had been shipped), the old object will reliably, without causing a crash, answer "no."</span></span> <span data-ttu-id="8456a-128">Die Technologie, die dies unterstützt, ist der Algorithmus, mit dem IIDs zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="8456a-128">The technology that supports this is the algorithm by which IIDs are allocated.</span></span> <span data-ttu-id="8456a-129">Dies mag ein kleiner Punkt sein, aber es ist äußerst wichtig für die allgemeine Architektur des Systems, und die Fähigkeit, Legacy Elemente zu neuen Funktionen zu befragen, ist überraschend ein Feature, das in den meisten anderen Objekt Architekturen nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="8456a-129">While this may seem like a small point, it is extremely important to the overall architecture of the system, and the ability to inquire of legacy elements about new functionality is, surprisingly, a feature not present in most other object architectures.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8456a-130">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="8456a-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8456a-131">Verwenden und Implementieren von IUnknown</span><span class="sxs-lookup"><span data-stu-id="8456a-131">Using and Implementing IUnknown</span></span>](using-and-implementing-iunknown.md)
</dt> </dl>

 

 




