---
title: Hilfsfunktionen für die Instanzerstellung
description: Hilfsfunktionen für die Instanzerstellung
ms.assetid: 0b9b7bcf-f0f0-42c4-945e-63a532640d4b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84956f6040aaba13b46dea92bea611a49d5d8de3
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104039653"
---
# <a name="instance-creation-helper-functions"></a><span data-ttu-id="5c5fb-103">Hilfsfunktionen für die Instanzerstellung</span><span class="sxs-lookup"><span data-stu-id="5c5fb-103">Instance Creation Helper Functions</span></span>

<span data-ttu-id="5c5fb-104">In früheren Versionen von com war der primäre Mechanismus, der zum Erstellen einer Objektinstanz verwendet wurde, die [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-104">In previous releases of COM, the primary mechanism used to create an object instance was the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function.</span></span> <span data-ttu-id="5c5fb-105">Diese Funktion kapselt den Prozess der Erstellung eines Klassen Objekts mithilfe dieses-Objekts, um eine neue-Instanz zu erstellen und das-Klassenobjekt freizugeben.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-105">This function encapsulates the process of creating a class object, using that to create a new instance and releasing the class object.</span></span> <span data-ttu-id="5c5fb-106">Eine weitere Funktion dieser Art ist die spezifischere [**olecreate**](/windows/desktop/api/ole/nf-ole-olecreate), das OLE-Verbund Dokument-Hilfsprogramm, das ein Klassenobjekt erstellt und einen Zeiger auf ein angefordertes Objekt abruft.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-106">Another function of this kind is the more specific [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate), the OLE compound document helper that creates a class object and retrieves a pointer to a requested object.</span></span>

<span data-ttu-id="5c5fb-107">Um den Prozess der Instanzerstellung auf verteilten Systemen zu glätten, hat com vier wichtige neue Instanzen Erstellungs Mechanismen eingeführt:</span><span class="sxs-lookup"><span data-stu-id="5c5fb-107">To smooth the process of instance creation on distributed systems, COM has introduced four important new instance creation mechanisms:</span></span>

-   <span data-ttu-id="5c5fb-108">Klassenmoniker und [ **iclassactivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span><span class="sxs-lookup"><span data-stu-id="5c5fb-108">Class monikers and [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span></span>
-   [<span data-ttu-id="5c5fb-109">**Cokreateingestanceex**</span><span class="sxs-lookup"><span data-stu-id="5c5fb-109">**CoCreateInstanceEx**</span></span>](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)
-   [<span data-ttu-id="5c5fb-110">**CoGetInstanceFromFile**</span><span class="sxs-lookup"><span data-stu-id="5c5fb-110">**CoGetInstanceFromFile**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile)
-   [<span data-ttu-id="5c5fb-111">**Cogetinstancefromistorage**</span><span class="sxs-lookup"><span data-stu-id="5c5fb-111">**CoGetInstanceFromIStorage**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage)

<span data-ttu-id="5c5fb-112">Ein klassenmoniker ermöglicht es Ihnen, die Klasse eines Objekts zu identifizieren, und wird in der Regel mit einem anderen Moniker verwendet, wie z. b. einem dateimoniker, um den Speicherort des Objekts anzugeben.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-112">A class moniker permits you to identify the class of an object and is typically used with another moniker, like a file moniker, to indicate the location of the object.</span></span> <span data-ttu-id="5c5fb-113">Dies ermöglicht es Ihnen, an ein Objekt zu binden und den Server anzugeben, der für dieses Objekt gestartet werden soll.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-113">This permits you to bind to an object and specify the server that is to be launched for that object.</span></span> <span data-ttu-id="5c5fb-114">Klassenmoniker können auch rechts von Monikern zusammengesetzt werden, die die Bindung an die [**iclassactivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) -Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-114">Class monikers may also be composed to the right of monikers supporting binding to the [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) interface.</span></span> <span data-ttu-id="5c5fb-115">Weitere Informationen finden Sie unter [klassenmoniker](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="5c5fb-115">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="5c5fb-116">[**Cokreateinstanceex**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) erweitert [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) so, dass es möglich ist, ein einzelnes nicht initialisiertes Objekt zu erstellen, das mit der angegebenen CLSID auf einem angegebenen Remote Computer verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) extends [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) to make it possible to create a single uninitialized object associated with the given CLSID on a specified remote machine.</span></span> <span data-ttu-id="5c5fb-117">Anstatt eine einzelne Schnittstelle anzufordern und einen einzelnen Zeiger auf diese Schnittstelle zu erhalten, können Sie mit **cokreateinstanceex** außerdem mehrere Schnittstellen Abfragen und (falls verfügbar) Zeiger auf Sie in einem einzigen Roundtrip abrufen, wodurch weniger Roundtrips zwischen Computern zulässig sind.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-117">In addition, rather than requesting a single interface and obtaining a single pointer to that interface, **CoCreateInstanceEx** makes it possible to query for multiple interfaces and (if available) receive pointers to them in a single round-trip, thus permitting fewer round-trips between machines.</span></span> <span data-ttu-id="5c5fb-118">Dadurch kann die Remote Objekt Interaktion wesentlich effizienter werden.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-118">This can make remote object interaction much more efficient.</span></span> <span data-ttu-id="5c5fb-119">Zu diesem Zweck verwendet die-Funktion ein Array von [**\_ multiqi**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) -Strukturen.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-119">To do this, the function uses an array of [**MULTI\_QI**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) structures.</span></span>

<span data-ttu-id="5c5fb-120">Das Erstellen eines Objekts über [**cokreateinstanceex**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) erfordert weiterhin, dass das Objekt durch einen Aufrufen einer der Initialisierungs Schnittstellen (z. b. [**IPersistStorage:: Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)) initialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-120">Creating an object through [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) still requires that the object be initialized through a call to one of the initialization interfaces (such as [**IPersistStorage::Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span></span> <span data-ttu-id="5c5fb-121">Die Hilfsfunktionen [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) und [**cogetinstancefromistorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) Kapseln sowohl die Instanzen Erstellungs Potenz von **cokreateinstanceex** als auch die Initialisierung, das erste aus einer Datei und das letztere aus einem Speicher.</span><span class="sxs-lookup"><span data-stu-id="5c5fb-121">The helper functions [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) and [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) encapsulate both the instance creation power of **CoCreateInstanceEx** and the initialization, the former from a file and the latter from a storage.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5c5fb-122">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="5c5fb-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5c5fb-123">Erstellen eines Objekts über ein Klassenobjekt</span><span class="sxs-lookup"><span data-stu-id="5c5fb-123">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 