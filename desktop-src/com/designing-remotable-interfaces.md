---
title: Entwerfen von Remote fähigen Schnittstellen
description: Mit der Einführung des Objektmodells für verteilte Komponenten ist es wichtig, dass die benutzerdefinierte Schnittstelle Remote fähig ist, auch wenn Sie Sie nur in-Process verwenden möchten.
ms.assetid: 2ee4d950-dfd5-4965-bd77-a600e878be59
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3502604d62e6a5129ca3e3538761722909c0198f
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/29/2020
ms.locfileid: "103857952"
---
# <a name="designing-remotable-interfaces"></a><span data-ttu-id="50e37-103">Entwerfen von Remote fähigen Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="50e37-103">Designing Remotable Interfaces</span></span>

<span data-ttu-id="50e37-104">Mit der Einführung des Objektmodells für verteilte Komponenten ist es wichtig, dass die benutzerdefinierte Schnittstelle Remote fähig ist, auch wenn Sie Sie nur in-Process verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="50e37-104">With the advent of the distributed component object model, it is important that your custom interface be remotable, even if you intend to use it in-process only.</span></span>

<span data-ttu-id="50e37-105">Die Mittel l ist mehr als nur eine Möglichkeit zum Generieren von Header Dateien für ihre Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="50e37-105">MIDL is more than just a way to generate header files for your interfaces.</span></span> <span data-ttu-id="50e37-106">Es handelt sich um eine Programmiersprache für Remoting, mit der Sie Ihre Schnittstellen über die verschiedenen Computer-, Prozess-und Thread Grenzen hinweg verwenden können.</span><span class="sxs-lookup"><span data-stu-id="50e37-106">It is a programming language for remoting that allows you to use your interfaces across machine, process, and thread boundaries.</span></span> <span data-ttu-id="50e37-107">Dies bedeutet, dass Sie das Verhalten ihrer Mittelwert definierten Schnittstellen unter diesen Bedingungen überprüfen müssen, bevor Sie Ihr Programm für Kunden freigeben.</span><span class="sxs-lookup"><span data-stu-id="50e37-107">This means that you need to verify the behavior of your MIDL-defined interfaces under those conditions before you release your program to customers.</span></span> <span data-ttu-id="50e37-108">Wenn Sie in ihrer IDL einen Fehler gemacht haben und die Schnittstelle nicht ordnungsgemäß Remote ist, kann es schwierig sein, diesen Fehler zu beheben.</span><span class="sxs-lookup"><span data-stu-id="50e37-108">If you made a mistake in your IDL and the interface is not remoted correctly, it can be difficult to remedy that mistake.</span></span> <span data-ttu-id="50e37-109">Entweder müssen Sie Ihre Schnittstelle mit einer neuen IID überarbeiten und die alte in aus Gründen der Abwärtskompatibilität belassen, oder Sie müssen jeden Client und jeden Server Computer gleichzeitig konvertieren.</span><span class="sxs-lookup"><span data-stu-id="50e37-109">Either you have to revise your interface with a new IID and leave the old one in for backward compatibility or you have to convert every client and every server machine everywhere at the same time.</span></span>

<span data-ttu-id="50e37-110">Auch wenn Ihre Schnittstelle nie außerhalb des Prozesses verwendet wird, kann Sie Thread übergreifend verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="50e37-110">Even if your interface will never be used out-of-process, it may be used cross-thread.</span></span> <span data-ttu-id="50e37-111">Das schlimmste Problem für eine nicht überprüfte IDL-Datei kann für Prozess interne Server auftreten, die mehrere [Single Thread-Apartments](single-threaded-apartments.md)nicht unterstützen.</span><span class="sxs-lookup"><span data-stu-id="50e37-111">The worst problem for an unchecked IDL file can arise for in-process servers that do not support multiple [single-threaded apartments](single-threaded-apartments.md)).</span></span> <span data-ttu-id="50e37-112">Ein Server, der kein Threading Modell angibt, ist implizit Single Thread.</span><span class="sxs-lookup"><span data-stu-id="50e37-112">A server that does not specify a threading model is implicitly single-threaded.</span></span> <span data-ttu-id="50e37-113">Alles markierte als Single Thread wird für den Thread erzwungen, der zuerst [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) oder [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex)aufgerufen hat.</span><span class="sxs-lookup"><span data-stu-id="50e37-113">Everything marked single-threaded is forced over to the thread that first called [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span></span> <span data-ttu-id="50e37-114">Wenn es sich bei einem anderen Thread um den Thread handelt, der das Objekt aktiviert hat, müssen alle Schnittstellen auf diesem Single Thread-Server auf den Aktivierungs Thread zurückgesetzt werden. Dies kann zu einer Rückgabe von RegDB \_ E \_ iidnotreg als Reaktion auf einen aufzurufenden [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))-Auflistungen führen.</span><span class="sxs-lookup"><span data-stu-id="50e37-114">If some other thread was the one that activated the object, all the interfaces on that single-threaded server must be remoted back to the activating thread, which can result in a return of REGDB\_E\_IIDNOTREG in response to a call to [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))).</span></span> <span data-ttu-id="50e37-115">Es sei denn, Sie können sicherstellen, dass Ihre Schnittstelle in-Process ist und immer im gleichen Thread aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="50e37-115">Unless you can absolutely assert that your interface is both in-process and always going to be called on the same thread, you will get remoted at some time.</span></span>

<span data-ttu-id="50e37-116">Als Schnittstellen Designer müssen Sie schließlich die Verwendung Ihrer Schnittstelle durch Client Anwendungen in Erwägung gezogen werden.</span><span class="sxs-lookup"><span data-stu-id="50e37-116">Finally, as an interface designer, you need to consider how client applications will use your interface.</span></span> <span data-ttu-id="50e37-117">Zwei Dinge bestimmen, ob eine Schnittstelle über Prozess-und Computer Grenzen hinweg effizient sein wird: die Häufigkeit von Methoden aufrufen über die Schnittstellen Grenze hinweg und die Menge an Daten, die in einem bestimmten Methodenaufruf übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="50e37-117">Two things, together, determine whether an interface will be efficient across process and machine boundaries: the frequency of method calls across the interface boundary, and the amount of data to be transferred in a given method call.</span></span> <span data-ttu-id="50e37-118">Obwohl com prozessübergreifende und Netzwerk übergreifende Aufrufe für Programme transparent macht, kann der Aufruf von hoch-und Hochbandbreite nicht über Adressräume hinweg effizient erfolgen.</span><span class="sxs-lookup"><span data-stu-id="50e37-118">Although COM makes cross-process and cross-network calls transparent to programs, it cannot make high-frequency and high-bandwidth calls efficient across address spaces.</span></span> <span data-ttu-id="50e37-119">In einigen Fällen ist es besser, Schnittstellen zu entwerfen, die normalerweise nur als Prozess interne Server implementiert werden, während andere Schnittstellen besser für die Remote Verwendung geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="50e37-119">In some cases, it is more appropriate to design interfaces that will normally be implemented only as in-process servers while other interfaces are more appropriate for remote use.</span></span>

 

 




