---
title: Datenübertragung Schnittstellen
description: Datenübertragung Schnittstellen
ms.assetid: c42e65a4-7b77-4f39-8323-04fa60c5b140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 448e1a580880c7202ec67d12965f6db7e0be99d0
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "106341560"
---
# <a name="data-transfer-interfaces"></a><span data-ttu-id="99819-103">Datenübertragung Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="99819-103">Data Transfer Interfaces</span></span>

<span data-ttu-id="99819-104">Die [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) -Schnittstelle stellt Consumer von Daten mit Methoden zum Abrufen und Festlegen der Daten eines Objekts, zum Bestimmen der vom Objekt unterstützten Formate und zum Registrieren und empfangen von Benachrichtigungen, wenn sich die Daten im Objekt ändern.</span><span class="sxs-lookup"><span data-stu-id="99819-104">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface provides consumers of data with methods for getting and setting an object's data, determining which formats the object supports, and registering for and receiving notifications when data in the object changes.</span></span> <span data-ttu-id="99819-105">Beim Abrufen von Daten kann ein Aufrufer das Format angeben, in dem die Daten dargestellt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="99819-105">When obtaining data, a caller can specify the format in which it wants to render the data.</span></span> <span data-ttu-id="99819-106">Die Quelle der Daten bestimmt jedoch das Speichermedium, das in einem vom Aufrufer bereitgestellten out-Parameter zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="99819-106">The source of the data, however, determines the storage medium, which it returns in an out parameter provided by the caller.</span></span>

<span data-ttu-id="99819-107">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) bietet alle Tools, die Sie zum Implementieren von Windows-Zwischenablage Übertragungen oder Verbund Dokumenten Übertragungen in Ihren Anwendungen benötigen.</span><span class="sxs-lookup"><span data-stu-id="99819-107">By itself, [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) supplies all the tools you need to implement Windows clipboard transfers or compound document transfers in your applications.</span></span> <span data-ttu-id="99819-108">Wenn Sie auch Drag & Drop-Übertragungen unterstützen möchten, müssen Sie die [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) -Schnittstelle und die [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) -Schnittstelle zusammen mit **IDataObject** implementieren.</span><span class="sxs-lookup"><span data-stu-id="99819-108">If you also want to support drag and drop transfers, you need to implement the [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) and [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) interfaces along with **IDataObject**.</span></span>

<span data-ttu-id="99819-109">Die [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) -Schnittstelle, kombiniert mit OLE-Zwischenablage-APIs, bietet alle Funktionen der Windows-Zwischenablage-APIs.</span><span class="sxs-lookup"><span data-stu-id="99819-109">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface combined with OLE clipboard APIs provide all the capabilities of the Windows clipboard APIs.</span></span> <span data-ttu-id="99819-110">Es ist in der Regel nicht erforderlich, beide Zwischenablage-APIs zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="99819-110">It is not generally necessary to use both clipboard APIs.</span></span> <span data-ttu-id="99819-111">Datenlieferanten, die Drag & Drop-Übertragungen oder OLE-Verbund Dokumente unterstützen, müssen die **IDataObject** -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="99819-111">Data suppliers that support either drag and drop transfers or OLE compound documents must implement the **IDataObject** interface.</span></span> <span data-ttu-id="99819-112">Wenn Ihre Anwendung jetzt nur Zwischenablage Übertragungen unterstützt, Sie jedoch beabsichtigen, Drag & Drop-oder Verbund Dokumente in späteren Releases hinzuzufügen, sollten Sie **IDataObject** und die OLE-Zwischenablage-APIs jetzt implementieren, um die Zeitspanne zu verringern, die für das Wiederherstellen und Debuggen später aufgewendet wird.</span><span class="sxs-lookup"><span data-stu-id="99819-112">If your application supports only clipboard transfers now, but you intend to add drag and drop or compound documents in later releases, you may want to implement **IDataObject** and the OLE clipboard APIs now in order to minimize the amount of time spent recoding and debugging later.</span></span> <span data-ttu-id="99819-113">Möglicherweise möchten Sie auch **IDataObject** implementieren, um ein anderes Übertragungsmedium als den globalen Arbeitsspeicher zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="99819-113">You may also want to implement **IDataObject** in order to utilize transfer media other than global memory.</span></span>

<span data-ttu-id="99819-114">In der folgenden Tabelle wird zusammengefasst, welche Typen von Datenübertragungen Sie verwenden möchten:</span><span class="sxs-lookup"><span data-stu-id="99819-114">The following table summarizes which ones to use, depending on what types of data transfer you want to support:</span></span>



| <span data-ttu-id="99819-115">Zur Unterstützung von</span><span class="sxs-lookup"><span data-stu-id="99819-115">To support</span></span>                                                                       | <span data-ttu-id="99819-116">Zweck</span><span class="sxs-lookup"><span data-stu-id="99819-116">Use</span></span>                                                                                                                                                                         |
|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="99819-117">Verbund Dokumente</span><span class="sxs-lookup"><span data-stu-id="99819-117">Compound documents</span></span><br/>                                                    | [<span data-ttu-id="99819-118">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="99819-118">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="99819-119">Übertragungen per Drag & Drop</span><span class="sxs-lookup"><span data-stu-id="99819-119">Drag and drop transfers</span></span><br/>                                               | <span data-ttu-id="99819-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (oder das Äquivalent)</span><span class="sxs-lookup"><span data-stu-id="99819-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (or the equivalent)</span></span><br/> |
| <span data-ttu-id="99819-121">Zwischenablage Übertragungen ausschließlich mit globalem Speicher</span><span class="sxs-lookup"><span data-stu-id="99819-121">Clipboard transfers using global memory exclusively</span></span><br/>                   | [<span data-ttu-id="99819-122">Zwischenablage-API</span><span class="sxs-lookup"><span data-stu-id="99819-122">Clipboard API</span></span>](../dataxchg/clipboard.md)<br/>                                                                                                                            |
| <span data-ttu-id="99819-123">Zwischenablage Übertragungen mit anderen Exchange-Medien als dem globalen Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="99819-123">Clipboard transfers using exchange mediums other than global memory.</span></span><br/>  | [<span data-ttu-id="99819-124">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="99819-124">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="99819-125">Zwischenablage Übertragungen jetzt, jedoch später per Drag & Drop oder Verbund Dokumenten</span><span class="sxs-lookup"><span data-stu-id="99819-125">Clipboard transfers now but drag and drop or compound documents later</span></span><br/> | <span data-ttu-id="99819-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) und die oben aufgelisteten Schnittstellen und Funktionen für "Drag & Drop-Übertragungen"</span><span class="sxs-lookup"><span data-stu-id="99819-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and the interfaces and function listed above for "Drag and drop transfers"</span></span><br/>                                                    |



 

<span data-ttu-id="99819-127">Wenn ein Benutzer einen Datenübertragungs Vorgang initiiert, erstellt die Quell Anwendung eine Instanz von [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) und macht die Daten in einem oder mehreren Formaten verfügbar.</span><span class="sxs-lookup"><span data-stu-id="99819-127">When a user initiates a data transfer operation, the source application creates an instance of [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and through it makes the data available in one or more formats.</span></span> <span data-ttu-id="99819-128">Bei einer Übertragung der Zwischenablage Ruft die Anwendung die [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) -Funktion auf, um einen Datenobjekt Zeiger an OLE zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="99819-128">In a clipboard transfer, the application calls the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function to pass a data-object pointer to OLE.</span></span> <span data-ttu-id="99819-129">(**OleSetClipboard** bietet auch Standarddaten Formate der Zwischenablage sowohl für OLE-Version 1 als auch für nicht-OLE-Anwendungen.) Bei einer Drag & Drop-Übertragung Ruft die Anwendung stattdessen die [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) -Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="99819-129">(**OleSetClipboard** also offers standard clipboard data formats for both OLE version 1 and non-OLE applications.) In a drag and drop transfer, the application calls the [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) function instead.</span></span>

<span data-ttu-id="99819-130">Auf der Empfangsseite der Übertragung empfängt das Ziel den [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) -Zeiger entweder als Argument für einen Aufruf von [**IDropTarget::D ROP**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) oder durch Aufrufen der [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) -Funktion, je nachdem, ob die Übertragung per Drag & Drop oder der Zwischenablage erfolgt.</span><span class="sxs-lookup"><span data-stu-id="99819-130">On the receiving side of the transfer, the destination receives the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer either as an argument to an invocation of [**IDropTarget::Drop**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) or by calling the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function, depending on whether the transfer is by means of drag and drop or the clipboard.</span></span> <span data-ttu-id="99819-131">Nachdem dieser Zeiger abgerufen wurde, ruft das Ziel [**IDataObject:: enumformatusw**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) . auf, um zu erfahren, welche Formate für den Abruf verfügbar sind und welche Arten von Medien abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="99819-131">Having obtained this pointer, the destination calls [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) to learn what formats are available for retrieval and on what types of media they can be obtained.</span></span> <span data-ttu-id="99819-132">Mit diesen Informationen, fordert die empfangende Anwendung die Daten mit einem [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata)-Aufrufen an.</span><span class="sxs-lookup"><span data-stu-id="99819-132">Armed with this information, the receiving application requests the data with a call to [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span></span>

## <a name="related-topics"></a><span data-ttu-id="99819-133">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="99819-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="99819-134">Datenübertragung</span><span class="sxs-lookup"><span data-stu-id="99819-134">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

