---
title: Persistenzschnittstellen
description: Persistenzschnittstellen
ms.assetid: a93582b3-bdbf-430d-b4a6-c0df7bc35dc0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e72ef5f7381c6d58b9025f983ecd852b83661030
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104102451"
---
# <a name="persistence-interfaces"></a><span data-ttu-id="ce8c5-103">Persistenzschnittstellen</span><span class="sxs-lookup"><span data-stu-id="ce8c5-103">Persistence Interfaces</span></span>

<span data-ttu-id="ce8c5-104">Objekte mit einem permanenten Zustand einer beliebigen Art müssen mindestens eine ipersistent- \* Schnittstelle und vorzugsweise mehrere Schnittstellen implementieren, um dem Container die flexibelste Wahl zu bieten, wie der Zustand eines Steuer Elements gespeichert werden soll.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-104">Objects that have a persistent state of any kind must implement at least one IPersist\* interface, and preferably multiple interfaces, in order to provide the container with the most flexible choice of how it wishes to save a control's state.</span></span>

<span data-ttu-id="ce8c5-105">Wenn ein Steuerelement einen persistenten Zustand aufweist, muss es als Minimalwert entweder [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) oder [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) implementieren (beide schließen sich gegenseitig aus und sollten für den größten Teil nicht gemeinsam implementiert werden).</span><span class="sxs-lookup"><span data-stu-id="ce8c5-105">If a control has any persistent state whatsoever, it must, as a minimum, implement either [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) or [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) (the two are mutually exclusive and shouldn't be implemented together for the most part).</span></span> <span data-ttu-id="ce8c5-106">Letzteres wird verwendet, wenn ein Steuerelement wissen möchte, wenn es neu erstellt wird, anstatt von einem vorhandenen persistenten Zustand neu geladen zu werden (**IPersistStream** verfügt nicht über die erstellte neue Funktion).</span><span class="sxs-lookup"><span data-stu-id="ce8c5-106">The latter is used when a control wishes to know when it is created new as opposed to reloaded from an existing persistent state (**IPersistStream** does not have the created new capability).</span></span> <span data-ttu-id="ce8c5-107">Das vorhanden sein einer der beiden Schnittstellen gibt an, dass das Steuerelement seinen permanenten Zustand speichern und in einen Stream laden kann, d. h. eine Instanz von [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span><span class="sxs-lookup"><span data-stu-id="ce8c5-107">The existence of either interface indicates that the control can save and load its persistent state into a stream, that is, an instance of [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span></span>

<span data-ttu-id="ce8c5-108">Über diese beiden streambasierten Schnittstellen hinaus \* können die in der folgenden Tabelle aufgeführten ipersistent-Schnittstellen optional bereitgestellt werden, um die Persistenz an anderen Speicherorten als einem erweiterbaren [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream)zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-108">Beyond these two stream-based interfaces, the IPersist\* interfaces listed in the following table can be optionally provided in order to support persistence to locations other than an expandable [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span></span>

<span data-ttu-id="ce8c5-109">Eine Reihe von Komponenten Kategorien wird identifiziert, um die Unterstützung für Persistenz-Schnittstellen abzudecken. siehe [Komponenten Kategorien](component-categories.md).</span><span class="sxs-lookup"><span data-stu-id="ce8c5-109">A set of component categories is identified to cover the support for persistency interfaces see [Component Categories](component-categories.md).</span></span>



| <span data-ttu-id="ce8c5-110">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="ce8c5-110">Interface</span></span>                                                              | <span data-ttu-id="ce8c5-111">Verbrauch</span><span class="sxs-lookup"><span data-stu-id="ce8c5-111">Usage</span></span>                                                                                                                                                                                                                                                                                                                                                       |
|------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ce8c5-112">[**Ipersistmemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="ce8c5-112">[**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))</span></span><br/>           | <span data-ttu-id="ce8c5-113">Das Objekt kann seinen Zustand speichern und in ein sequenzielles Bytearray mit fester Länge (im Arbeitsspeicher) laden.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-113">The object can save and load its state into a fixed-length sequential byte array (in memory).</span></span><br/>                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="ce8c5-114">**IPersistStorage**</span><span class="sxs-lookup"><span data-stu-id="ce8c5-114">**IPersistStorage**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)<br/>                  | <span data-ttu-id="ce8c5-115">Das Objekt kann seinen Zustand speichern und in eine [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) -Instanz laden.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-115">The object can save and load its state into an [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) instance.</span></span> <span data-ttu-id="ce8c5-116">Steuerelemente, die als "Insertable" markiert werden sollen, als andere Verbund Dokument Objekte (für Einfügevorgänge in Container ohne Kontrolle) müssen diese Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-116">Controls that wish to be marked Insertable as other compound document objects (for insertion into non-control aware containers) must support this interface.</span></span><br/>                                                                                               |
| <span data-ttu-id="ce8c5-117">[**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="ce8c5-117">[**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85))</span></span><br/> | <span data-ttu-id="ce8c5-118">Das Objekt kann seinen Zustand als einzelne Eigenschaften speichern und laden, die in IPropertyBag geschrieben werden, die der Container implementiert.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-118">The object can save and load its state as individual properties written to IPropertyBag which the container implements.</span></span> <span data-ttu-id="ce8c5-119">Diese wird für die Funktion "Speichern als Text" in einigen Containern verwendet.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-119">This is used for Save As Text functionality in some containers.</span></span><br/>                                                                                                                                                          |
| <span data-ttu-id="ce8c5-120">[**Ipersistmoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="ce8c5-120">[**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))</span></span><br/>  | <span data-ttu-id="ce8c5-121">Das Objekt kann seinen Zustand speichern und in einen Speicherort laden, der von einem Moniker benannt wird.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-121">The object can save and load its state to a location named by a moniker.</span></span> <span data-ttu-id="ce8c5-122">Das Steuerelement ruft [**IMoniker:: BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) auf, um die erforderliche Speicherschnittstelle abzurufen, z. b. [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream), [**ILockBytes**](/windows/desktop/api/objidl/nn-objidl-ilockbytes), [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)usw.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-122">The control calls [**IMoniker::BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) to retrieve the storage interface it requires, such as [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream), [**ILockBytes**](/windows/desktop/api/objidl/nn-objidl-ilockbytes), [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), etc.</span></span><br/> |



 

<span data-ttu-id="ce8c5-123">Die Unterstützung für [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85)) ist zwar optional, aber es wird dringend empfohlen, als Optimierung für Container mit Funktionen zum Speichern als Text zu empfehlen, wie z. b. Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-123">While support for [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85)) is optional, it is strongly recommended as an optimization for containers with Save As Text features, such as Visual Basic.</span></span>

<span data-ttu-id="ce8c5-124">Mit Ausnahme von [**IPersistStream:: GetSizeMax**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststream-getsizemax), [**IPersistStreamInit:: GetSizeMax**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-getsizemax)und [**ipersistmemory:: GetSizeMax**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768208(v=vs.85))müssen alle Methoden jeder Schnittstelle vollständig implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="ce8c5-124">With the exception of [**IPersistStream::GetSizeMax**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststream-getsizemax), [**IPersistStreamInit::GetSizeMax**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-getsizemax), and [**IPersistMemory::GetSizeMax**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768208(v=vs.85)), all methods of each interface must be fully implemented.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ce8c5-125">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ce8c5-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ce8c5-126">Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="ce8c5-126">Controls</span></span>](controls.md)
</dt> </dl>

 

