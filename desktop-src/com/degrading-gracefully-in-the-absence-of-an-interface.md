---
title: Herabsetzen ordnungsgemäß bei Fehlen einer Schnittstelle
description: Da ein Steuerelement möglicherweise keine andere Schnittstelle als IUnknown unterstützt, muss ein Container ordnungsgemäß heruntergestuft werden, wenn eine bestimmte Schnittstelle fehlt.
ms.assetid: 1b833900-2357-4b39-b88d-5ee6321f488e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fef1b329faa2d4da333cf2e201fc887764af96bc5ea2573060f41774b57c0d56
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/11/2021
ms.locfileid: "119501274"
---
# <a name="degrading-gracefully-in-the-absence-of-an-interface"></a>Herabsetzen ordnungsgemäß bei Fehlen einer Schnittstelle

Da ein Steuerelement möglicherweise keine andere Schnittstelle als [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown)unterstützt, muss ein Container ordnungsgemäß heruntergestuft werden, wenn eine bestimmte Schnittstelle fehlt.

Man könnte die Nützlichkeit eines Steuerelements mit nur [**IUnknown in Frage stellen.**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) Berücksichtigen Sie jedoch die Vorteile, die ein Steuerelement von der visuellen Programmierumgebung eines Containers (z. B. VB) erhält, wenn der Container das Objekt als Steuerelement erkennt:

-   Eine Schaltfläche für das -Objekt wird in einer Toolbox angezeigt.
-   Sie können ein Objekt erstellen, indem Sie es aus der Toolbox auf ein Formular ziehen.
-   Sie können dem Objekt einen Namen geben, der in der visuellen Programmierumgebung erkannt wird.
-   Der gleiche Name in (3) oben kann sofort verwendet werden, um anderen Code für Steuerelemente im gleichen Formular (oder sogar in einer anderen Form) zu schreiben.
-   Der Container kann automatisch Codeeinstiegspunkte für alle Ereignisse bereitstellen, die über dieses Objekt verfügbar sind.
-   Der Container stellt eine eigene Benutzeroberfläche zum Durchsuchen von Eigenschaften für alle verfügbaren Eigenschaften bereit.

Wenn ein Objekt nicht als Steuerelement erkannt wird, verliert es möglicherweise alle diese sehr leistungsstarken und nützlichen Integrationsfeatures. In Visual Basic 4.0 ist es beispielsweise sehr schwierig, ein zufälliges Objekt zu integrieren, das im vollständigen Sinn kein Steuerelement ist, aber möglicherweise immer noch Eigenschaften und Ereignisse aufweist. Da Visual Basic 4 die Idee eines Steuerelements sehr restriktiv ist, hat das Objekt keine der oben genannten Integrationsfunktionen. Aber auch ein Steuerelement mit [**IUnknown,**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown)bei dem die Lebensdauer des Steuerelements das Vorhandensein einer Ressource bestimmt, sollte in der Lage sein, die oben beschriebenen Integrationsfunktionen zu erhalten.

Da aktuelle Tools einen großen Satz von Steuerelementschnittstellen erfordern, um einen beliebigen Vorteil zu erzielen, werden Steuerelemente im Allgemeinen zu einer Überimplementierung geführt, damit sie mehr Code enthalten, als sie wirklich benötigen. Steuerelemente, die 7K sein können, können 25.000 sein, was in Bereichen wie dem Internet ein großes Leistungsproblem darstellt. Dies hat auch zu der Erkenntnis geführt, dass ein Steuerelement nur mit einem Tool wie dem CDK implementiert werden kann, da die Implementierung aller Schnittstellen komplex ist. Dies hat Auswirkungen, wenn eine große DLL wie OC30.DLL für ein solches Steuerelement erforderlich ist, was das Arbeitsset erhöht. Wenn nicht alle Schnittstellen erforderlich sind, können viele Entwickler sehr kleine und helle Steuerelemente mit geradem OLE oder auch mit anderen Tools schreiben, um den Mehraufwand für jedes Steuerelement zu minimieren.

Aus diesem Grund erkennt dieser Anhang ein Steuerelement als beliebiges Objekt mit einer CLSID und einer [**IUnknown-Schnittstelle.**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) Selbst bei nur IUnknown sollte ein Container mit einer Programmierumgebung mindestens die Features 3 und ) für den Registrierungseintrag bereitstellen können. Er erhält 1 und \# \# \# 2. Wenn das -Objekt [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (und [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) im Allgemeinen) für einen Ereignissatz liefert, erhält es 5, und wenn \# es **IDispatch** für Eigenschaften und Methoden unterstützt, erhält es 6 sowie eine bessere Codeintegration \# im Container.

Kurz gesagt, ein Objekt sollte so wenig implementieren können wie **IDispatch** und ein Ereignissatz, der über [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) verfügbar gemacht wird, um alle oben genannten visuellen Features zu erhalten.

Vor diesem Hintergrund wird in der folgenden Tabelle beschrieben, was ein Container tun kann, wenn keine mögliche Schnittstelle verfügbar ist. Beachten Sie, dass nur diese Schnittstellen aufgeführt sind, die der Container direkt über [**QueryInterface erhält.**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) Andere Schnittstellen wie [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject)werden auf andere Mittel erhalten.



| Schnittstelle                                                                                                             | Bedeutung des Fehlens der Schnittstelle                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                       | Das Steuerelement verfügt über keine visuellen Elemente, die es selbst zeichnen wird, sodass keine bestimmten Zusicherungen möglich sind. Zur Laufzeit versucht der Container einfach nicht, etwas zu zeichnen, wenn diese Schnittstelle nicht vorhanden ist. Zur Entwurfszeit muss der Container mindestens eine Art Standardrechteck mit einem Namen für ein solches Steuerelement zeichnen, damit ein Benutzer in einer visuellen Programmierumgebung das Objekt auswählen und seine Eigenschaften, Methoden und Ereignisse auschecken kann. Die Behandlung des Fehlens von [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) ist entscheidend für eine gute Unterstützung der visuellen Programmierung.<br/> |
| [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                           | Das Steuerelement benötigt weder die Website noch nimmt es an einer Aushandlung des eingebetteten Objektlayouts teil. Alle Informationen (z. B. Steuerungen), die ein Container von dieser Schnittstelle erwarten kann, sollten mit vom Container bereitgestellten Standardwerten ausgefüllt werden.<br/>                                                                                                                                                                                                                                                                                                       |
| [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                             | Das Steuerelement wird nicht direkt aktiv (z. B. eine Bezeichnung) und versucht daher nie, auf diese Weise zu aktivieren. Die einzige Aktivierung kann die Eigenschaftenseiten sein.<br/>                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                         | Das Steuerelement verfügt über keine mnemonischen Und keine Verwendung von Umgebungseigenschaften und ist nicht von Bennisse, wenn der Container Ereignisse ignoriert. Wenn diese Schnittstelle nicht verfügbar ist, werden die Methoden des Containers einfach nicht aufruft.<br/>                                                                                                                                                                                                                                                                                                                                                                         |
| [**Idataobject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                         | Das -Steuerelement stellt weder Eigenschaftensätze noch visuelle Renderings bereit, die zwischengespeichert werden könnten. Daher würde der Container eine Standardpräsentation ohne diese Schnittstelle zwischenspeichern (insbesondere Unterstützung für CF METAFILEPICT) und alle eigenschaftensatzbezogenen Funktionen \_ deaktivieren.<br/>                                                                                                                                                                                                                                                                            |
| **IDispatch**<br/>                                                                                              | Das -Steuerelement verfügt über keine benutzerdefinierten Eigenschaften oder Methoden. Der Container muss in diesem Fall keine Steuerelementeigenschaften anzeigen und sollte benutzerdefinierte Methodenaufrufe, die der Container nicht erkennt, als zu seinen eigenen erweiterten Steuerelementen gehören (die möglicherweise Methoden und Eigenschaften unterstützen) nicht unterstützen. Da erweiterte Steuerelemente im Allgemeinen bestimmte **IDispatch-Aufrufe** an das Steuerelement delegieren, sollte ein erweitertes Steuerelement nicht erwarten, dass das Steuerelement **überhaupt IDispatch** hat.<br/>                                                                                          |
| [**Iconnectionpointcontainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                             | Das -Steuerelement verfügt über keine Ereignisse, daher muss der Container keines behandeln.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/> | Das Steuerelement enthält entweder keine Typinformationen oder Ereignisse, oder der Container muss über die Registrierungseinträge des Steuerelements in die Typinformationen des Steuerelements wechseln. Das Vorhandensein dieser Schnittstelle ist eine Optimierung.<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**Ispecifypropertypages**](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                     | Das Steuerelement verfügt über keine Eigenschaftenseiten. Wenn der Container also über eine Benutzeroberfläche verfügt, die sie aufrufen würde, sollte der Container diese Benutzeroberfläche deaktivieren.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**IPerPropertyBrowsing**](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                       | Das Steuerelement verfügt über keinen Anzeigenamen selbst, keine vordefinierten Zeichenfolgen und Werte und keine Eigenschaft zur Seitenzuordnung. Diese Schnittstelle wird fast immer zum Generieren der Containerbenutzeroberfläche verwendet, sodass solche Benutzeroberflächenelemente ohne diese Schnittstelle deaktiviert werden würden.<br/>                                                                                                                                                                                                                                                                                                 |
| Ipersist\*<br/>                                                                                                 | Das Steuerelement verfügt über keinen permanenten Zustand, von dem die Rede sein kann, sodass der Container sich keine Gedanken über das Speichern steuerelementspezifischer Daten machen muss. Der Container wird natürlich seine eigenen Informationen über das Steuerelement in seiner eigenen Form oder in seinem eigenen Dokument speichern, aber das Steuerelement selbst hat nichts, um zu diesen Informationen beizutragen.<br/>                                                                                                                                                                                                                                                        |
| [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                 | Das -Objekt unterstützt keine Zwischenspeicherung. Ein Container kann das Zwischenspeichern weiterhin unterstützen, indem er einfach einen Datencache selbst mit [**createDataCache erstellt.**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache)<br/>                                                                                                                                                                                                                                                                                                                                                                                                    |



 

## <a name="related-topics"></a>Zugehörige Themen

<dl> <dt>

[Container](containers.md)
</dt> </dl>

 

 





