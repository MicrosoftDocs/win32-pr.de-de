---
title: Nicht ordnungsgemäß herabstufen, wenn eine Schnittstelle fehlt
description: Da ein Steuerelement keine andere Schnittstelle als IUnknown unterstützt, muss ein Container ordnungsgemäß herabgestuft werden, wenn eine bestimmte Schnittstelle nicht vorhanden ist.
ms.assetid: 1b833900-2357-4b39-b88d-5ee6321f488e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 26618e00f2d959cccfd7ab4d2948fac9c1a3f020
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/29/2020
ms.locfileid: "106338434"
---
# <a name="degrading-gracefully-in-the-absence-of-an-interface"></a>Nicht ordnungsgemäß herabstufen, wenn eine Schnittstelle fehlt

Da ein Steuerelement keine andere Schnittstelle als [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown)unterstützt, muss ein Container ordnungsgemäß herabgestuft werden, wenn eine bestimmte Schnittstelle nicht vorhanden ist.

Eine Frage kann die Nützlichkeit eines Steuer Elements mit nichts mehr als [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown)hinterfragen. Beachten Sie jedoch die Vorteile, die ein Steuerelement von der visuellen Programmierumgebung eines Containers erhält (z. b. vb), wenn der Container das Objekt als Steuerelement erkennt:

-   Eine Schaltfläche für das-Objekt wird in einer Toolbox angezeigt.
-   Ein Objekt kann erstellt werden, indem es aus der Toolbox auf ein Formular gezogen wird.
-   Sie können dem Objekt einen Namen übergeben, der in der visuellen Programmierumgebung erkannt wird.
-   Der gleiche Name in (3) oben kann direkt beim Schreiben beliebigen anderen Codes für Steuerelemente in derselben Form (oder sogar in einer anderen Form) verwendet werden.
-   Der Container kann automatisch Code Einstiegspunkte für alle von diesem Objekt verfügbaren Ereignisse bereitstellen.
-   Der Container bietet eine eigene Benutzeroberfläche für das Durchsuchen von Eigenschaften für alle verfügbaren Eigenschaften.

Wenn ein Objekt nicht als Steuerelement erkannt wird, verliert es möglicherweise alle diese sehr leistungsfähigen und nützlichen Integrations Features. Beispielsweise ist es in Visual Basic 4,0 sehr schwierig, ein zufälliges Objekt, das kein Steuerelement ist, tatsächlich in den vollständigen Sinn zu integrieren, aber es können weiterhin Eigenschaften und Ereignisse vorhanden sein. Da Visual Basic 4-Idee eines Steuer Elements sehr restriktiv ist, erhält das Objekt keine der oben genannten Integrations Features. Aber auch ein Steuerelement mit [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), bei dem die bloße Lebensdauer des Steuer Elements das vorhanden sein einer Ressource bestimmt, sollte in der Lage sein, die oben beschriebenen Integrationsfunktionen zu nutzen.

Da aktuelle Tools einen großen Satz von Steuerungs Schnittstellen benötigen, um einen beliebigen Vorteil zu erzielen, werden Steuerelemente im Allgemeinen zu einer über-Implementierung geführt, sodass Sie mehr Code enthalten, als Sie tatsächlich benötigen. Steuerelemente, die ggf. 7K sein könnten, können 25 KB betragen. Dies ist ein großes Leistungsproblem in Bereichen wie dem Internet. Dies hat auch zur Wahrnehmung geführt, dass ein Steuerelement nur mit einem Tool wie dem CDK implementiert werden kann, da alle Schnittstellen implementiert werden. Dies hat Auswirkungen, wenn eine große dll wie OC30.DLL für ein solches Steuerelement erforderlich ist und das Workingset erhöht. Wenn nicht alle Schnittstellen erforderlich sind, werden dadurch viele Entwickler geöffnet, um sehr kleine und helle Steuerelemente mit der geraden OLE oder mit anderen Tools zu schreiben, sodass der mehr Aufwand für die einzelnen Steuerelemente minimiert wird.

Daher wird in diesem Anhang ein Steuerelement als beliebiges Objekt mit einer CLSID und einer [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Schnittstelle erkannt. Auch wenn es nicht mehr als IUnknown gibt, sollte ein Container mit einer Programmierumgebung mindestens die Features \# 3 und) Registrierungs Eintrag bereitstellen können, er erhält \# 1 und \# 2. Wenn das Objekt für einen Ereignis Satz [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (und [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) ) bereitstellt, wird \# 5 erzielt, und wenn **IDispatch** für Eigenschaften und Methoden unterstützt wird, wird der Wert 6 erzielt und eine \# bessere Code Integration in den Container erzielt.

Kurz gesagt, ein Objekt sollte in der Lage sein, nur so wenig wie **IDispatch** und einen Ereignis Satz zu implementieren, der über [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) verfügbar gemacht wird, um alle diese visuellen Features zu erhalten.

In der folgenden Tabelle wird in der folgenden Tabelle beschrieben, was ein Container möglicherweise ohne eine beliebige Schnittstelle macht. Beachten Sie, dass nur diese Schnittstellen aufgelistet werden, dass der Container direkt über [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))abgerufen wird. Andere Schnittstellen, wie z. b. [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject), werden auf andere Weise abgerufen.



| Schnittstelle                                                                                                             | Bedeutung der Schnittstellen Abwesenheit                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                       | Das Steuerelement verfügt über keine visuellen Elemente, die es selbst zeichnet, sodass es keine eindeutigen Blöcke bereitstellt. In der Laufzeit versucht der Container einfach nicht, etwas zu zeichnen, wenn diese Schnittstelle nicht vorhanden ist. In der Entwurfszeit muss der Container zumindest eine Art Standard Rechtecks mit einem Namen für ein solches Steuerelement zeichnen, sodass ein Benutzer in einer visuellen Programmierumgebung das Objekt auswählen und seine Eigenschaften, Methoden und Ereignisse Auschecken können. Das Fehlen von [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) ist wichtig für eine gute Unterstützung der visuellen Programmierung.<br/> |
| [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                           | Das-Steuerelement benötigt die Website nicht, und es nimmt auch keine Teilnahme an einer eingebetteten objektlayoutaushandlung vor. Alle Informationen (wie z. b. Steuerelement Blöcke), die ein Container von dieser Schnittstelle erwarten kann, sollten mit vom Container bereitgestellten Standardwerten ausgefüllt werden.<br/>                                                                                                                                                                                                                                                                                                       |
| [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                             | Das Steuerelement wird nicht direkt aktiv (z. b. eine Bezeichnung) und daher nie versucht, auf diese Weise zu aktivieren. Die einzige Aktivierung kann die Eigenschaften Seiten sein.<br/>                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                         | Das Steuerelement hat keine mnetmonics und keine Umgebungs Eigenschaften. es ist nicht wichtig, wenn der Container Ereignisse ignoriert. Wenn diese Schnittstelle nicht vorhanden ist, ruft der Container nur seine Methoden auf.<br/>                                                                                                                                                                                                                                                                                                                                                                         |
| [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                         | Das-Steuerelement stellt keine Eigenschaften Sätze und keine visuellen Renderings bereit, die zwischengespeichert werden können. Daher wählt der Container eine Standarddarstellung aus, wenn diese Schnittstelle nicht vorhanden ist (insbesondere Unterstützung für CF \_ -MetafilePict) und alle Eigenschaften Satz bezogenen Funktionen zu deaktivieren.<br/>                                                                                                                                                                                                                                                                            |
| **IDispatch**<br/>                                                                                              | Das-Steuerelement verfügt über keine benutzerdefinierten Eigenschaften oder Methoden. Der Container muss in diesem Fall keine Steuerelement Eigenschaften anzeigen und sollte keine benutzerdefinierten Methodenaufrufe zulassen, die vom Container nicht als zu seinen eigenen erweiterten Steuerelementen gehörend erkannt werden (die möglicherweise Methoden und Eigenschaften unterstützen). Wenn erweiterte Steuerelemente im allgemeinen bestimmte **IDispatch** -Aufrufe an das Steuerelement delegieren, sollte ein erweitertes Steuerelement nicht erwarten, dass das Steuerelement über **IDispatch** verfügt.<br/>                                                                                          |
| [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                             | Das-Steuerelement verfügt über keine Ereignisse, sodass der Container nicht mit der Behandlung von-Elementen in Frage kommt.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/> | Das Steuerelement verfügt entweder nicht über Typinformationen oder Ereignisse, oder der Container muss über die Registrierungseinträge des Steuer Elements in die Typinformationen des Steuer Elements gelangen. Das vorhanden sein dieser Schnittstelle ist eine Optimierung.<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**ISpecifyPropertyPages**](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                     | Das Steuerelement verfügt über keine Eigenschaften Seiten. wenn der Container also über eine Benutzeroberfläche verfügt, die Sie aufrufen würde, sollte der Container die Benutzeroberfläche deaktivieren.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**IPerPropertyBrowsing**](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                       | Das Steuerelement hat keinen anzeigen Amen, keine vordefinierten Zeichen folgen und Werte und keine Eigenschaft für die Seiten Zuordnung. Diese Schnittstelle wird fast immer zum Erstellen einer Container Benutzeroberfläche verwendet, sodass solche Elemente der Benutzeroberfläche deaktiviert werden, wenn diese Schnittstelle nicht vorhanden ist.<br/>                                                                                                                                                                                                                                                                                                 |
| IPersist\*<br/>                                                                                                 | Das-Steuerelement hat keinen persistenten Zustand, von dem gesprochen werden muss, sodass sich der Container nicht um die Speicherung von Steuerelement spezifischen Daten kümmern muss. Der Container speichert natürlich seine eigenen Informationen über das Steuerelement in einem eigenen Formular oder Dokument, aber das Steuerelement selbst hat nichts, um zu diesen Informationen beizutragen.<br/>                                                                                                                                                                                                                                                        |
| [**Iolecache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                 | Das-Objekt unterstützt das Caching nicht. Ein Container kann das Caching weiterhin unterstützen, indem er einfach einen Daten [**Cache mithilfe von**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache)"|" erstellt.<br/>                                                                                                                                                                                                                                                                                                                                                                                                    |



 

## <a name="related-topics"></a>Zugehörige Themen

<dl> <dt>

[Container](containers.md)
</dt> </dl>

 

 





