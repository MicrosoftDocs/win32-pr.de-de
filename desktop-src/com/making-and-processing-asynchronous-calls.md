---
title: Erstellen und Verarbeiten von asynchronen Aufrufen
description: COM-Objekte können asynchronen Aufruf von unterstützen.
ms.assetid: bf7f9f8e-66ce-41a4-854c-62dbe840a89e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 059f55cc64a70f130e7fb654426803edbe8b7209
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "106341562"
---
# <a name="making-and-processing-asynchronous-calls"></a><span data-ttu-id="1c525-103">Erstellen und Verarbeiten von asynchronen Aufrufen</span><span class="sxs-lookup"><span data-stu-id="1c525-103">Making and Processing Asynchronous Calls</span></span>

<span data-ttu-id="1c525-104">COM-Objekte können asynchronen Aufruf von unterstützen.</span><span class="sxs-lookup"><span data-stu-id="1c525-104">COM objects can support asynchronous calling.</span></span> <span data-ttu-id="1c525-105">Wenn ein Client einen asynchronen Rückruf ausführt, wird die Steuerung sofort an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="1c525-105">When a client makes an asynchronous call, control returns to the client immediately.</span></span> <span data-ttu-id="1c525-106">Während der Server den-Befehl verarbeitet, kann der-Client andere Aufgaben ausführen.</span><span class="sxs-lookup"><span data-stu-id="1c525-106">While the server processes the call, the client is free to do other work.</span></span> <span data-ttu-id="1c525-107">Wenn der Client nicht mehr ohne die Ergebnisse des Aufrufes aufgerufen werden kann, kann er die Ergebnisse des Aufrufes zu diesem Zeitpunkt abrufen.</span><span class="sxs-lookup"><span data-stu-id="1c525-107">When the client can no longer proceed without the results of the call, it can get the results of the call at that time.</span></span>

<span data-ttu-id="1c525-108">Beispielsweise kann eine Anforderung eines großen oder komplexen Recordsets zeitaufwändig sein.</span><span class="sxs-lookup"><span data-stu-id="1c525-108">For example, a request for a large or complex recordset can be time-consuming.</span></span> <span data-ttu-id="1c525-109">Ein Client kann das Recordset durch einen asynchronen-Rückruf anfordern und dann andere Aufgaben ausführen.</span><span class="sxs-lookup"><span data-stu-id="1c525-109">A client can request the recordset by an asynchronous call and then do other work.</span></span> <span data-ttu-id="1c525-110">Wenn das Recordset verfügbar ist, kann der Client es ohne Blockierung schnell abrufen.</span><span class="sxs-lookup"><span data-stu-id="1c525-110">When the recordset is available, the client can obtain it quickly without blocking.</span></span>

<span data-ttu-id="1c525-111">Clients führen keine asynchronen Aufrufe direkt für das Server Objekt aus.</span><span class="sxs-lookup"><span data-stu-id="1c525-111">Clients do not make asynchronous calls directly on the server object.</span></span> <span data-ttu-id="1c525-112">Stattdessen erhalten Sie ein Callcenter, das eine asynchrone Version einer synchronen Schnittstelle auf dem Server Objekt implementiert.</span><span class="sxs-lookup"><span data-stu-id="1c525-112">Instead, they obtain a call object that implements an asynchronous version of a synchronous interface on the server object.</span></span> <span data-ttu-id="1c525-113">Die asynchrone Schnittstelle des callobjekts hat den Namen "Async *interfakename*".</span><span class="sxs-lookup"><span data-stu-id="1c525-113">The asynchronous interface on the call object has a name of the form Async *InterfaceName*.</span></span> <span data-ttu-id="1c525-114">Wenn ein Server Objekt z. b. eine synchrone Schnittstelle namens IMyInterface implementiert, gibt es ein-Rückruf Objekt, das eine asynchrone Schnittstelle mit dem Namen asyncimyinterface implementiert.</span><span class="sxs-lookup"><span data-stu-id="1c525-114">For example, if a server object implements a synchronous interface named IMyInterface, there will be a call object that implements an asynchronous interface named AsyncIMyInterface.</span></span>

> [!Note]  
> <span data-ttu-id="1c525-115">Die asynchrone Unterstützung ist für **IDispatch** oder für Schnittstellen, die **IDispatch** erben, nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="1c525-115">Asynchronous support is not available for **IDispatch** or for interfaces that inherit **IDispatch**.</span></span>

 

<span data-ttu-id="1c525-116">Server Objekte, die asynchrone Aufrufe unterstützen, implementieren die [**icallfactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="1c525-116">Server objects that support asynchronous calls implement the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface.</span></span> <span data-ttu-id="1c525-117">Diese Schnittstelle macht eine einzelne Methode (" [**anatecall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall)") verfügbar, mit der eine Instanz eines angegebenen Anruf Objekts erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="1c525-117">This interface exposes a single method, [**CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), which creates an instance of a specified call object.</span></span> <span data-ttu-id="1c525-118">Clients können **icallfactory** Abfragen, um zu bestimmen, ob ein-Objekt asynchrone Aufrufe unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1c525-118">Clients can query for **ICallFactory** to determine whether an object supports asynchronous calling.</span></span>

<span data-ttu-id="1c525-119">Für jede Methode in einer synchronen Schnittstelle implementiert die zugehörige asynchrone Schnittstelle zwei Methoden.</span><span class="sxs-lookup"><span data-stu-id="1c525-119">For each method on a synchronous interface, the corresponding asynchronous interface implements two methods.</span></span> <span data-ttu-id="1c525-120">Diese Methoden fügen die Präfixe "BEGIN" \_ und "Finish" \_ an den Namen der synchronen Methode an.</span><span class="sxs-lookup"><span data-stu-id="1c525-120">These methods attach the prefixes Begin\_ and Finish\_ to the name of the synchronous method.</span></span> <span data-ttu-id="1c525-121">Wenn eine Schnittstelle mit dem Namen isimplestream z. b. über eine Read-Methode verfügt, verfügt die asyncisimplestream-Schnittstelle über die Read \_ -Methode Begin und Finish Read \_ .</span><span class="sxs-lookup"><span data-stu-id="1c525-121">For example, if an interface named ISimpleStream has a Read method, the AsyncISimpleStream interface will have a Begin\_Read and a Finish\_Read method.</span></span> <span data-ttu-id="1c525-122">Zum Starten eines asynchronen Aufrufs ruft der Client die BEGIN- \_ Methode auf.</span><span class="sxs-lookup"><span data-stu-id="1c525-122">To begin an asynchronous call, the client calls the Begin\_ method.</span></span>

<span data-ttu-id="1c525-123">Wenn Sie ein Server Objekt implementieren, müssen Sie kein-Objekt für jede Schnittstelle bereitstellen, die das Objekt implementiert.</span><span class="sxs-lookup"><span data-stu-id="1c525-123">When you implement a server object, you do not have to provide a call object for every interface the object implements.</span></span> <span data-ttu-id="1c525-124">Wenn das Server Objekt die [**icallfactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) -Schnittstelle implementiert und Standard-Marshalling verwendet, kann ein gemarshallter Client immer ein Proxy Aufruf Objekt abrufen, auch wenn kein Aufruf Objekt auf der Serverseite vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="1c525-124">If the server object implements the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface and uses standard marshaling, a marshaled client can always obtain a proxy call object, even if there is no call object on the server side.</span></span> <span data-ttu-id="1c525-125">Dieser Proxy marshallt die BEGIN- \_ Methode als synchronen Aufruf, der Server verarbeitet den Aufruf synchron, und der Client kann die Out-Parameter abrufen, indem er die Finish- \_ Methode aufruft.</span><span class="sxs-lookup"><span data-stu-id="1c525-125">This proxy will marshal the Begin\_ method as a synchronous call, the server will process the call synchronously, and the client can obtain the out parameters by calling the Finish\_ method.</span></span>

<span data-ttu-id="1c525-126">Wenn ein Client dagegen einen gemarshallten synchronen Aufrufvorgang an eine Schnittstelle sendet, für die ein Rückruf Objekt auf der Serverseite vorhanden ist, verarbeitet der Server den-Rückruf immer asynchron.</span><span class="sxs-lookup"><span data-stu-id="1c525-126">Conversely, if a client makes a marshaled synchronous call on an interface for which there is a call object on the server side, the server will always process the call asynchronously.</span></span> <span data-ttu-id="1c525-127">Dieses Verhalten ist für den Client nicht offensichtlich, da der Client dieselben out-Parameter und denselben Rückgabewert erhält, den er von der synchronen Methode erhalten hätte.</span><span class="sxs-lookup"><span data-stu-id="1c525-127">This behavior will not be apparent to the client, because the client will receive the same out parameters and the same return value it would have received from the synchronous method.</span></span>

<span data-ttu-id="1c525-128">In beiden Fällen wird die Interaktion zwischen Client und Server gemarshallt, als ob der-Befehl synchron wäre: die Ausgabe von synchronen und asynchronen Proxys ist nicht unter scheidbar, ebenso wie die Ausgabe der entsprechenden Stubdateien.</span><span class="sxs-lookup"><span data-stu-id="1c525-128">In either case, the interaction between client and server is marshaled as if the call were synchronous: The output of synchronous and asynchronous proxies is indistinguishable, as is the output of the corresponding stubs.</span></span> <span data-ttu-id="1c525-129">Dieses Verhalten vereinfacht das Programmiermodell sowohl von Clients als auch von Servern erheblich.</span><span class="sxs-lookup"><span data-stu-id="1c525-129">This behavior greatly simplifies the programming model both of clients and of servers.</span></span> <span data-ttu-id="1c525-130">Wenn ein Server Objekt [**icallfactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory)implementiert, muss ein gemarshallter Client nicht versuchen, ein Aufruf Objekt zu erstellen, das möglicherweise nicht verfügbar ist – für den Client ist ein Aufruf Objekt immer verfügbar.</span><span class="sxs-lookup"><span data-stu-id="1c525-130">If a server object implements [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), a marshaled client does not have to attempt to create a call object that may not be available — to the client, a call object is always available.</span></span>

<span data-ttu-id="1c525-131">Wenn sich Client und Server im selben Apartment befinden, verarbeitet das Server Objekt den vom Client vorgerichteten Rückruf.</span><span class="sxs-lookup"><span data-stu-id="1c525-131">When client and server are in the same apartment, the server object will process whichever call the client makes.</span></span> <span data-ttu-id="1c525-132">Wenn kein calltobjekt verfügbar ist, muss der Client explizit die synchrone-Schnittstelle abrufen und einen synchronen-Befehl ausführen.</span><span class="sxs-lookup"><span data-stu-id="1c525-132">If a call object is not available, the client must explicitly obtain the synchronous interface and make a synchronous call.</span></span>

<span data-ttu-id="1c525-133">Weitere Informationen finden Sie unter den folgenden Themen:</span><span class="sxs-lookup"><span data-stu-id="1c525-133">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="1c525-134">Ausführen eines asynchronen Aufrufes</span><span class="sxs-lookup"><span data-stu-id="1c525-134">Making an Asynchronous Call</span></span>](making-an-asynchronous-call.md)
-   [<span data-ttu-id="1c525-135">Abbrechen eines asynchronen Aufrufes</span><span class="sxs-lookup"><span data-stu-id="1c525-135">Canceling an Asynchronous Call</span></span>](canceling-an-asynchronous-call.md)
-   [<span data-ttu-id="1c525-136">Abbrechen von Methoden aufrufen</span><span class="sxs-lookup"><span data-stu-id="1c525-136">Canceling Method Calls</span></span>](canceling-method-calls.md)
-   [<span data-ttu-id="1c525-137">Rückruf Synchronisierung</span><span class="sxs-lookup"><span data-stu-id="1c525-137">Call Synchronization</span></span>](call-synchronization.md)

 

 