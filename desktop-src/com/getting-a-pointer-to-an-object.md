---
title: Einen Zeiger auf ein Objekt zu erhalten
description: Einen Zeiger auf ein Objekt zu erhalten
ms.assetid: 4af9d356-402b-4e69-9f6e-8589057d3ac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0476d36390e7077e7fdd75eef8d95e8173683891
ms.sourcegitcommit: 307b14e9847ced354a52a1ac12d7f659722d99bb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/06/2020
ms.locfileid: "106338046"
---
# <a name="getting-a-pointer-to-an-object"></a><span data-ttu-id="a322d-103">Einen Zeiger auf ein Objekt zu erhalten</span><span class="sxs-lookup"><span data-stu-id="a322d-103">Getting a Pointer to an Object</span></span>

<span data-ttu-id="a322d-104">Da com nicht über ein Strict-Klassenmodell verfügt, gibt es vier Möglichkeiten, wie ein Client instanziieren oder einen Zeiger auf eine Schnittstelle für ein Objekt erhalten kann:</span><span class="sxs-lookup"><span data-stu-id="a322d-104">Because COM does not have a strict class model, there are four ways that a client can instantiate or get a pointer to an interface on an object:</span></span>

-   <span data-ttu-id="a322d-105">Ruft eine com-Bibliotheksfunktion auf, die ein Objekt eines vordefinierten Typs erstellt. Das heißt, die Funktion gibt einen Zeiger auf eine bestimmte Schnittstelle für eine bestimmte Objektklasse zurück.</span><span class="sxs-lookup"><span data-stu-id="a322d-105">Call a COM library function that creates an object of a predetermined type; that is, the function will return a pointer to only one specific interface for a specific object class.</span></span>
-   <span data-ttu-id="a322d-106">Rufen Sie eine com-Bibliotheksfunktion auf, die ein Objekt auf der Grundlage eines Klassen Bezeichners (CLSID) erstellen kann, und der jeden angeforderten angeforderte Typ von Schnittstellen Zeiger zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="a322d-106">Call a COM library function that can create an object based on a class identifier (CLSID) and that returns any type of interface pointer requested.</span></span>
-   <span data-ttu-id="a322d-107">Ruft eine Methode einer Schnittstelle auf, die ein anderes Objekt erstellt (oder eine Verbindung mit einer vorhandenen herstellt) und einen Schnittstellen Zeiger für dieses separate Objekt zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="a322d-107">Call a method of some interface that creates another object (or connects to an existing one) and returns an interface pointer on that separate object.</span></span>
-   <span data-ttu-id="a322d-108">Implementieren Sie ein Objekt mit einer Schnittstelle, über die andere Objekte ihren Schnittstellen Zeiger direkt an den Client übergeben.</span><span class="sxs-lookup"><span data-stu-id="a322d-108">Implement an object with an interface through which other objects pass their interface pointer to the client directly.</span></span>

<span data-ttu-id="a322d-109">Weitere Informationen zum Abrufen von Zeigern auf andere Schnittstellen eines Objekts, nachdem Sie das erste-Objekt erhalten haben, finden Sie unter [QueryInterface: Navigation in einem Objekt](queryinterface--navigating-in-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="a322d-109">For information on getting pointers to other interfaces on an object after you have the first one, see [QueryInterface: Navigating in an Object](queryinterface--navigating-in-an-object.md).</span></span>

## <a name="creating-an-object-of-a-predetermined-type"></a><span data-ttu-id="a322d-110">Erstellen eines Objekts eines vordefinierten Typs</span><span class="sxs-lookup"><span data-stu-id="a322d-110">Creating an Object of a Predetermined Type</span></span>

<span data-ttu-id="a322d-111">Es gibt zahlreiche com-Funktionen, wie z. b. [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), die Zeiger auf bestimmte Schnittstellen Implementierungen zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="a322d-111">There are numerous COM functions, such as [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), that return pointers to specific interface implementations.</span></span> <span data-ttu-id="a322d-112">(**CoGetMalloc** Ruft einen Zeiger auf die Standard-com-Speicherzuweisung ab.) Die meisten dieser Funktionen sind Hilfsfunktionen, und die meisten dieser Funktionen werden in den Referenz Abschnitten dieser Dokumentation unter dem jeweiligen Bereich beschrieben, mit dem Sie verknüpft sind, wie z. b. Speicher oder Datenübertragung.</span><span class="sxs-lookup"><span data-stu-id="a322d-112">(**CoGetMalloc** retrieves a pointer to the standard COM memory allocator.) Most of these are helper functions, and most of these functions are described in the reference sections of this documentation, under the specific area they are related to, such as storage or data transfer.</span></span>

## <a name="creating-an-object-based-on-a-clsid"></a><span data-ttu-id="a322d-113">Erstellen eines Objekts auf der Grundlage einer CLSID</span><span class="sxs-lookup"><span data-stu-id="a322d-113">Creating an Object Based on a CLSID</span></span>

<span data-ttu-id="a322d-114">Es gibt mehrere Funktionen, die bei einer CLSID von einem Client aufgerufen werden können, um eine Objektinstanz zu erstellen und einen Zeiger darauf zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a322d-114">There are several functions that, given a CLSID, a client can call to create an object instance and get a pointer to it.</span></span> <span data-ttu-id="a322d-115">Alle diese Funktionen basieren auf der Funktion [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), die ein Klassenobjekt erstellt und einen Zeiger auf eine Schnittstelle bereitstellt, die Ihnen ermöglicht, Instanzen dieser Klasse zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a322d-115">All of these functions are based on the function [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which creates a class object and supplies a pointer to an interface that allows you to create instances of that class.</span></span> <span data-ttu-id="a322d-116">Es müssen zwar Informationen vorhanden sein, auf denen sich der Server befindet, aber es ist nicht erforderlich, dass diese Informationen im Client enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="a322d-116">While there must be information that says which system the server resides on, there is no need for that information to be contained in the client.</span></span> <span data-ttu-id="a322d-117">Der Client muss nur die CLSID und nie den absoluten Pfad des Server Codes kennen.</span><span class="sxs-lookup"><span data-stu-id="a322d-117">The client needs to know only the CLSID and never the absolute path of the server code.</span></span> <span data-ttu-id="a322d-118">Weitere Informationen finden Sie unter [Erstellen eines Objekts mit einem Klassenobjekt](creating-an-object-through-a-class-object.md).</span><span class="sxs-lookup"><span data-stu-id="a322d-118">For more information, see [Creating an Object Through a Class Object](creating-an-object-through-a-class-object.md).</span></span>

## <a name="returning-a-pointer-to-a-separate-object"></a><span data-ttu-id="a322d-119">Zurückgeben eines Zeigers auf ein separates Objekt</span><span class="sxs-lookup"><span data-stu-id="a322d-119">Returning a Pointer to a Separate Object</span></span>

<span data-ttu-id="a322d-120">Zu den zahlreichen Schnittstellen Methoden, die einen Zeiger auf ein separates Objekt zurückgeben, handelt es sich um mehrere, die erstellen und einen Zeiger auf ein *Enumeratorobjekt* zurückgeben, mit dem Sie bestimmen können, wie viele Elemente eines bestimmten Typs von einem Objekt verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="a322d-120">Among the many interface methods that return a pointer to a separate object are several that create and return a pointer to an *enumerator object*, which allows you to determine how many items of a given type an object maintains.</span></span> <span data-ttu-id="a322d-121">COM definiert Schnittstellen zum Auflisten einer Vielzahl von Elementen, z. b. Zeichen folgen, wichtige Strukturen, Moniker und [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Schnittstellen Zeiger.</span><span class="sxs-lookup"><span data-stu-id="a322d-121">COM defines interfaces for enumerating a wide variety of items, such as strings, important structures, monikers, and [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface pointers.</span></span> <span data-ttu-id="a322d-122">Die typische Methode zum Erstellen einer Enumeratorinstanz und zum Abrufen eines Zeigers auf die-Schnittstelle besteht darin, eine Methode von einer anderen Schnittstelle aus aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="a322d-122">The typical way to create an enumerator instance and get a pointer to its interface is to call a method from another interface.</span></span> <span data-ttu-id="a322d-123">Die [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) -Schnittstelle definiert z. b. zwei Methoden, [**enumdrat**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) und [**enumformatusw**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc)., die Zeiger auf Schnittstellen für zwei unterschiedliche enumerationsobjekte zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="a322d-123">For example, the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface defines two methods, [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) and [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), that return pointers to interfaces on two different enumeration objects.</span></span> <span data-ttu-id="a322d-124">Es gibt viele weitere Beispiele in com von Methoden, die Zeiger auf Objekte zurückgeben, z. b. die OLE-Verbund Dokument Schnittstelle [**IOleObject:: GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), die bei Aufruf für das eingebettete oder verknüpfte Objekt einen Zeiger auf die Implementierung von [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite)des Container Objekts zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="a322d-124">There are many other examples in COM of methods that return pointers to objects, such as the OLE compound document interface [**IOleObject::GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), which, when called on the embedded or linked object, returns a pointer to the container object's implementation of [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite).</span></span>

## <a name="implementing-an-object-through-which-to-pass-an-interface-pointer-directly-to-the-client"></a><span data-ttu-id="a322d-125">Implementieren eines Objekts, über das ein Schnittstellen Zeiger direkt an den Client übergeben wird</span><span class="sxs-lookup"><span data-stu-id="a322d-125">Implementing an Object Through Which to Pass an Interface Pointer Directly to the Client</span></span>

<span data-ttu-id="a322d-126">Wenn zwei-Objekte, z. b. ein OLE-Verbund Dokument Container und-Server, eine bidirektionale Kommunikation benötigen, wird jedes Objekt implementiert, das eine Schnittstellen Methode enthält, über die ein Schnittstellen Zeiger an das andere Objekt übergeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="a322d-126">When two objects, such as an OLE compound document container and server, need bidirectional communication, each implements an object containing an interface method through which it can pass an interface pointer to the other object.</span></span> <span data-ttu-id="a322d-127">Das implementierende Objekt, das auch der Client des erstellten Objekts ist, kann dann die-Methode aufzurufen und den Zeiger abrufen, der weitergegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="a322d-127">The implementing object, which is also the client of the created object, can then call the method and get the pointer that was passed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a322d-128">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="a322d-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a322d-129">COM-Clients und-Server</span><span class="sxs-lookup"><span data-stu-id="a322d-129">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="a322d-130">Zuständigkeiten von com-Servern</span><span class="sxs-lookup"><span data-stu-id="a322d-130">COM Server Responsibilities</span></span>](com-server-responsibilities.md)
</dt> </dl>

 

 




