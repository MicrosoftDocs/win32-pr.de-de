---
title: Technische Übersicht über com
ms.assetid: 519c87cc-b442-4187-af2a-124a1e4e8b49
description: 'Weitere Informationen: Technische Übersicht über com'
keywords:
- Com Technical Overview com
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: be5dc95ffae5166d86cd8110cab1a6b90e6ffa5c
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104126607"
---
# <a name="com-technical-overview"></a><span data-ttu-id="45c9f-104">Technische Übersicht über com</span><span class="sxs-lookup"><span data-stu-id="45c9f-104">COM Technical Overview</span></span>

<span data-ttu-id="45c9f-105">Dieses Thema enthält eine Übersicht über die Microsoft Component Object Model (com):</span><span class="sxs-lookup"><span data-stu-id="45c9f-105">This topic provides an overview of the Microsoft Component Object Model (COM):</span></span>

-   [<span data-ttu-id="45c9f-106">Einführung in COM</span><span class="sxs-lookup"><span data-stu-id="45c9f-106">Introduction to COM</span></span>](#introduction-to-com)
-   [<span data-ttu-id="45c9f-107">Objekte und Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="45c9f-107">Objects and Interfaces</span></span>](#objects-and-interfaces)
-   [<span data-ttu-id="45c9f-108">Schnittstellen Implementierung</span><span class="sxs-lookup"><span data-stu-id="45c9f-108">Interface implementation</span></span>](#interface-implementation)
-   [<span data-ttu-id="45c9f-109">Die IUnknown-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="45c9f-109">The IUnknown Interface</span></span>](#the-iunknown-interface)
-   [<span data-ttu-id="45c9f-110">Das Client/Server-Modell</span><span class="sxs-lookup"><span data-stu-id="45c9f-110">The Client/Server Model</span></span>](#the-clientserver-model)
-   [<span data-ttu-id="45c9f-111">Dienststeuerungs-Manager</span><span class="sxs-lookup"><span data-stu-id="45c9f-111">Service Control Manager</span></span>](#service-control-manager)
-   [<span data-ttu-id="45c9f-112">Wiederverwendbarkeit</span><span class="sxs-lookup"><span data-stu-id="45c9f-112">Reusability</span></span>](#reusability)
-   [<span data-ttu-id="45c9f-113">Speicher-und Streamobjekte</span><span class="sxs-lookup"><span data-stu-id="45c9f-113">Storage and Stream Objects</span></span>](#storage-and-stream-objects)
-   [<span data-ttu-id="45c9f-114">Datenübertragung</span><span class="sxs-lookup"><span data-stu-id="45c9f-114">Data Transfer</span></span>](#data-transfer)
-   [<span data-ttu-id="45c9f-115">Remoting</span><span class="sxs-lookup"><span data-stu-id="45c9f-115">Remoting</span></span>](#remoting)
-   [<span data-ttu-id="45c9f-116">Security</span><span class="sxs-lookup"><span data-stu-id="45c9f-116">Security</span></span>](#security)
-   [<span data-ttu-id="45c9f-117">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="45c9f-117">Related topics</span></span>](#related-topics)

## <a name="introduction-to-com"></a><span data-ttu-id="45c9f-118">Einführung in COM</span><span class="sxs-lookup"><span data-stu-id="45c9f-118">Introduction to COM</span></span>

<span data-ttu-id="45c9f-119">Der Microsoft Component Object Model (com) definiert einen binären Interoperabilitäts Standard zum Erstellen von wiederverwendbaren Software Bibliotheken, die zur Laufzeit interagieren.</span><span class="sxs-lookup"><span data-stu-id="45c9f-119">The Microsoft Component Object Model (COM) defines a binary interoperability standard for creating reusable software libraries that interact at run time.</span></span> <span data-ttu-id="45c9f-120">Sie können com-Bibliotheken verwenden, ohne dass diese in Ihre Anwendung kompiliert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-120">You can use COM libraries without the requirement of compiling them into your application.</span></span> <span data-ttu-id="45c9f-121">COM ist die Grundlage für eine Reihe von Microsoft-Produkten und-Technologien, wie z. b. Windows Media Player und Windows Server.</span><span class="sxs-lookup"><span data-stu-id="45c9f-121">COM is the foundation for a number of Microsoft products and technologies, such as Windows Media Player and Windows Server.</span></span>

<span data-ttu-id="45c9f-122">COM definiert einen binären Standard, der für viele Betriebssysteme und Hardwareplattformen gilt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-122">COM defines a binary standard that applies to many operating systems and hardware platforms.</span></span> <span data-ttu-id="45c9f-123">Für das Netzwerk Computing definiert com ein Standard-Wire-Format und-Protokoll für die Interaktion zwischen Objekten, die auf unterschiedlichen Hardwareplattformen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-123">For network computing, COM defines a standard wire format and protocol for interaction among objects that run on different hardware platforms.</span></span> <span data-ttu-id="45c9f-124">Com ist von der Implementierungssprache unabhängig, was bedeutet, dass Sie com-Bibliotheken mithilfe verschiedener Programmiersprachen erstellen können, wie z. b. C++ und denen in der .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="45c9f-124">COM is independent of implementation language, which means that you can create COM libraries by using different programming languages, such as C++ and those in the .NET Framework.</span></span>

<span data-ttu-id="45c9f-125">Die com-Spezifikation bietet alle grundlegenden Konzepte, die die plattformübergreifende Wiederverwendung von Software ermöglichen:</span><span class="sxs-lookup"><span data-stu-id="45c9f-125">The COM specification provides all of the fundamental concepts that enable cross-platform software reuse:</span></span>

-   <span data-ttu-id="45c9f-126">Ein binärer Standard für Funktionsaufrufe zwischen Komponenten.</span><span class="sxs-lookup"><span data-stu-id="45c9f-126">A binary standard for function calls between components.</span></span>
-   <span data-ttu-id="45c9f-127">Eine Bereitstellung für stark typisierte Gruppierungen von Funktionen in Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-127">A provision for strongly-typed groupings of functions into interfaces.</span></span>
-   <span data-ttu-id="45c9f-128">Eine Basisschnittstelle, die Polymorphie, die Funktions Ermittlung und die Überwachung der Objekt Lebensdauer bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-128">A base interface that provides polymorphism, feature discovery, and object lifetime tracking.</span></span>
-   <span data-ttu-id="45c9f-129">Ein Mechanismus, mit dem Komponenten und ihre Schnittstellen eindeutig identifiziert werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-129">A mechanism that uniquely identifies components and their interfaces.</span></span>
-   <span data-ttu-id="45c9f-130">Ein Komponenten Lade Modul, das Komponenten Instanzen aus einer Bereitstellung erstellt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-130">A component loader that creates component instances from a deployment.</span></span>

<span data-ttu-id="45c9f-131">COM hat eine Reihe von Teilen, die zusammenarbeiten, um die Erstellung von Anwendungen zu ermöglichen, die aus wiederverwendbaren Komponenten erstellt werden:</span><span class="sxs-lookup"><span data-stu-id="45c9f-131">COM has a number of parts that work together to enable the creation of applications that are built from reusable components:</span></span>

-   <span data-ttu-id="45c9f-132">Ein *Host System* , das eine Laufzeitumgebung bereitstellt, die der com-Spezifikation entspricht.</span><span class="sxs-lookup"><span data-stu-id="45c9f-132">A *host system* that provides a run-time environment that conforms to the COM specification.</span></span>
-   <span data-ttu-id="45c9f-133">*Schnittstellen* , die Funktions Verträge definieren, sowie *Komponenten* , die Schnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="45c9f-133">*Interfaces* that define feature contracts, and *components* that implement interfaces.</span></span>
-   <span data-ttu-id="45c9f-134">*Server* , die Komponenten für das System bereitstellen, und *Clients* , von denen die von-Komponenten bereitgestellten Funktionen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-134">*Servers* that provide components to the system, and *clients* that use the features provided by components.</span></span>
-   <span data-ttu-id="45c9f-135">Eine *Registrierung* , die nachverfolgt, wo-Komponenten auf lokalen und Remote Hosts bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-135">A *registry* that tracks where components are deployed on local and remote hosts.</span></span>
-   <span data-ttu-id="45c9f-136">Ein *Dienststeuerungs-Manager* , der-Komponenten auf lokalen und Remote Hosts findet und Server mit Clients verbindet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-136">A *Service Control Manager* that locates components on local and remote hosts and connects servers to clients.</span></span>
-   <span data-ttu-id="45c9f-137">Ein *strukturiertes Speicher* Protokoll, das definiert, wie der Inhalt von Dateien im Dateisystem des Hosts navigiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="45c9f-137">A *structured storage* protocol that defines how to navigate the contents of files on the host's file system.</span></span>

<span data-ttu-id="45c9f-138">Das Aktivieren der erneuten Verwendung von Code über Hosts und Plattformen hinweg ist für com von zentraler Bedeutung.</span><span class="sxs-lookup"><span data-stu-id="45c9f-138">Enabling code re-use across hosts and platforms is central to COM.</span></span> <span data-ttu-id="45c9f-139">Eine wiederverwendbare Schnittstellen Implementierung wird als *Komponente*, als *Komponenten Objekt* oder als *com-Objekt* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-139">A reusable interface implementation is named a *component*, a *component object*, or a *COM object*.</span></span> <span data-ttu-id="45c9f-140">Eine Komponente implementiert mindestens eine COM-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="45c9f-140">A component implements one or more COM interfaces.</span></span>

<span data-ttu-id="45c9f-141">Sie definieren eine benutzerdefinierte COM-Bibliothek durch Entwerfen der Schnittstellen, die von der Bibliothek implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-141">You define a custom COM library by designing the interfaces that your library implements.</span></span> <span data-ttu-id="45c9f-142">Consumer Ihrer Bibliothek können Ihre Features entdecken und verwenden, ohne dass Sie wissen über die Bereitstellungs-und Implementierungsdetails Ihrer Bibliothek verfügen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-142">Consumers of your library can discover and use its features without any knowledge of your library's deployment and implementation details.</span></span>

## <a name="objects-and-interfaces"></a><span data-ttu-id="45c9f-143">Objekte und Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="45c9f-143">Objects and Interfaces</span></span>

<span data-ttu-id="45c9f-144">Ein COM-Objekt macht seine Funktionen über eine *Schnittstelle* verfügbar, bei der es sich um eine Auflistung von Element Funktionen handelt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-144">A COM object exposes its features through an *interface*, which is a collection of member functions.</span></span> <span data-ttu-id="45c9f-145">Eine COM-Schnittstelle definiert das erwartete Verhalten und die Verantwortlichkeiten einer Komponente und gibt einen stark typisierten Vertrag an, der einen kleinen Satz verwandter Vorgänge bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-145">A COM interface defines the expected behavior and responsibilities of a component, and it specifies a strongly-typed contract that provides a small set of related operations.</span></span> <span data-ttu-id="45c9f-146">Die gesamte Kommunikation zwischen COM-Komponenten erfolgt über Schnittstellen, und alle von einer Komponente angebotenen Dienste werden über die Schnittstelle verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="45c9f-146">All communication among COM components occurs through interfaces, and all services offered by a component are exposed through its interface.</span></span> <span data-ttu-id="45c9f-147">Ein Aufrufer kann nur auf die Schnittstellenmember-Funktionen zugreifen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-147">A caller can access only the interface member functions.</span></span> <span data-ttu-id="45c9f-148">Der interne Status ist für einen Aufrufer nur verfügbar, wenn er in der Schnittstelle verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-148">Internal state is unavailable to a caller unless it is exposed in the interface.</span></span>

<span data-ttu-id="45c9f-149">Schnittstellen sind stark typisiert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-149">Interfaces are strongly typed.</span></span> <span data-ttu-id="45c9f-150">Jede Schnittstelle verfügt über einen eigenen eindeutigen Schnittstellen Bezeichner, der als IID bezeichnet wird, wodurch Konflikte vermieden werden, die mit lesbaren Namen auftreten können.</span><span class="sxs-lookup"><span data-stu-id="45c9f-150">Every interface has its own unique interface identifier, named an IID, which eliminates collisions that could occur with human-readable names.</span></span> <span data-ttu-id="45c9f-151">Die IID ist eine Globally Unique Identifier (GUID), die mit der universellen eindeutigen ID (UUID) identisch ist, die von der DCE (Open Software Foundation) definiert wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-151">The IID is a globally unique identifier (GUID), which is the same as the Universally Unique ID (UUID) defined by the Open Software Foundation (OSF) Distributed Computing Environment (DCE).</span></span> <span data-ttu-id="45c9f-152">Wenn Sie eine neue Schnittstelle erstellen, müssen Sie einen neuen Bezeichner für diese Schnittstelle erstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-152">When you create a new interface, you must create a new identifier for that interface.</span></span> <span data-ttu-id="45c9f-153">Wenn ein Aufrufer eine Schnittstelle verwendet, muss er den eindeutigen Bezeichner verwenden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-153">When a caller uses an interface, it must use the unique identifier.</span></span> <span data-ttu-id="45c9f-154">Diese explizite Identifizierung verbessert die Stabilität, indem Benennungs Konflikte vermieden werden, die zu Laufzeitfehlern führen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-154">This explicit identification improves robustness by eliminating naming conflicts that would result in run-time failure.</span></span>

<span data-ttu-id="45c9f-155">Wenn Sie eine neue Schnittstelle definieren, können Sie eine Schnittstellen Definition mithilfe der Schnittstellen Definitions Sprache (IDL) erstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-155">When you define a new interface, you can create an interface definition by using the interface definition language (IDL).</span></span> <span data-ttu-id="45c9f-156">Aus dieser Schnittstellen Definition generiert der Microsoft IDL-Compiler Header Dateien, die von Anwendungen verwendet werden, die die-Schnittstelle verwenden, und Quellcode, um Remote Prozedur Aufrufe zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="45c9f-156">From this interface definition, the Microsoft IDL compiler generates header files for use by applications using the interface, and source code to handle remote procedure calls.</span></span> <span data-ttu-id="45c9f-157">Die von Microsoft bereitgestellte IDL basiert auf einfachen Erweiterungen der DCE-IDL, einem Industriestandard für Remote Prozedur Aufrufe (RPC)-basiertes verteiltes Computing.</span><span class="sxs-lookup"><span data-stu-id="45c9f-157">The IDL supplied by Microsoft is based on simple extensions to DCE IDL, an industry standard for Remote Procedure Call (RPC)-based distributed computing.</span></span> <span data-ttu-id="45c9f-158">IDL ist ein Tool zum Zweck der Benutzeroberflächen-Designer und ist nicht für die COM-Interoperabilität von zentraler Bedeutung.</span><span class="sxs-lookup"><span data-stu-id="45c9f-158">IDL is a tool for the convenience of the interface designer and is not central to COM interoperability.</span></span> <span data-ttu-id="45c9f-159">Mit IDL müssen Sie keine Header Dateien für jede Programmierumgebung manuell erstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-159">With IDL, you do not need to create header files manually for each programming environment.</span></span> <span data-ttu-id="45c9f-160">Weitere Informationen finden Sie unter [Definieren von COM-Schnittstellen](defining-com-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-160">For more information, see [Defining COM Interfaces](defining-com-interfaces.md).</span></span>

<span data-ttu-id="45c9f-161">Vererbung wird in COM-Schnittstellen sparsam verwendet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-161">Inheritance is used sparingly in COM interfaces.</span></span> <span data-ttu-id="45c9f-162">COM unterstützt die Schnittstellen Vererbung nur zur Wiederverwendung eines mit einer Basisschnittstelle verknüpften Vertrags.</span><span class="sxs-lookup"><span data-stu-id="45c9f-162">COM supports interface inheritance only to reuse a contract associated with a base interface.</span></span> <span data-ttu-id="45c9f-163">COM unterstützt keine selektive Vererbung. Wenn eine Schnittstelle von einer anderen Klasse erbt, enthält Sie daher alle Funktionen, die von der Basisschnittstelle definiert werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-163">COM does not support selective inheritance; therefore, if one interface inherits from another, it includes all of the functions that the base interface defines.</span></span> <span data-ttu-id="45c9f-164">Außerdem wird Durchschnitt stellen nur eine einzelne Vererbung anstelle mehrerer Vererbung zum Abrufen von Funktionen von einer Basisschnittstelle verwendet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-164">In addition, interfaces use only single inheritance, instead of multiple inheritance, to obtain functions from a base interface.</span></span>

## <a name="interface-implementation"></a><span data-ttu-id="45c9f-165">Schnittstellen Implementierung</span><span class="sxs-lookup"><span data-stu-id="45c9f-165">Interface implementation</span></span>

<span data-ttu-id="45c9f-166">Eine Instanz einer COM-Schnittstelle kann nicht allein erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-166">You cannot create an instance of a COM interface by itself.</span></span> <span data-ttu-id="45c9f-167">Stattdessen erstellen Sie eine Instanz einer Klasse, die die-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-167">Instead, you create an instance of a class that implements the interface.</span></span> <span data-ttu-id="45c9f-168">In C++ wird eine COM-Schnittstelle als *abstrakte Basisklasse* modelliert. Dies bedeutet, dass es sich bei der Schnittstelle um eine C++-Klasse handelt, die nur reine virtuelle Member-Funktionen enthält.</span><span class="sxs-lookup"><span data-stu-id="45c9f-168">In C++, a COM interface is modeled as an *abstract base class*, which means that the interface is a C++ class that contains only pure virtual member functions.</span></span> <span data-ttu-id="45c9f-169">Eine C++-Bibliothek implementiert com-Objekte, indem die Member-Funktions Signaturen von einer oder mehreren Schnittstellen geerbt werden, wobei die einzelnen Element Funktionen überschrieben werden und eine Implementierung für jede Funktion bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-169">A C++ library implements COM objects by inheriting the member function signatures from one or more interfaces, overriding each member function, and providing an implementation for each function.</span></span>

<span data-ttu-id="45c9f-170">Sie können jede beliebige Programmiersprache verwenden, die das Konzept der Funktionszeiger unterstützt, um eine COM-Schnittstelle zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="45c9f-170">You can use any programming language that supports the concept of function pointers to implement a COM interface.</span></span> <span data-ttu-id="45c9f-171">In C ist eine Schnittstelle z. b. eine Struktur, die einen Zeiger auf eine Tabelle mit Funktions Zeigern enthält, eine für jede Methode in der Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="45c9f-171">For example, in C, an interface is a structure containing a pointer to a table of function pointers, one for each method in the interface.</span></span>

<span data-ttu-id="45c9f-172">Wenn Sie eine Schnittstelle implementieren, muss Ihre Klasse eine Implementierung für jede Funktion in der Schnittstelle bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-172">When you implement an interface, your class must provide an implementation for every function in the interface.</span></span> <span data-ttu-id="45c9f-173">Wenn die Klasse in einer Schnittstellenfunktion keine Arbeit hat, kann die Implementierung eine einzelne Return-Anweisung sein.</span><span class="sxs-lookup"><span data-stu-id="45c9f-173">If the class has no work to do in an interface function, the implementation may be a single return statement.</span></span>

<span data-ttu-id="45c9f-174">Eine COM-Klasse wird mit einer eindeutigen 128-Bit-Klassen-ID (CLSID) identifiziert, die einer bestimmten Bereitstellung im Dateisystem eine Klasse zuordnet, bei der es sich für Windows um eine DLL oder exe handelt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-174">A COM class is identified by using a unique 128-bit Class ID (CLSID) that associates a class with a particular deployment in the file system, which for Windows is a DLL or EXE.</span></span> <span data-ttu-id="45c9f-175">Eine CLSID ist eine GUID, was bedeutet, dass keine andere Klasse dieselbe CLSID hat.</span><span class="sxs-lookup"><span data-stu-id="45c9f-175">A CLSID is a GUID, which means that no other class has the same CLSID.</span></span> <span data-ttu-id="45c9f-176">Die Verwendung eindeutiger Klassen Bezeichner verhindert Namenskollisionen zwischen Klassen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-176">The use of unique class identifiers prevents name collisions among classes.</span></span> <span data-ttu-id="45c9f-177">Beispielsweise können zwei verschiedene Lieferanten eine Klasse mit dem Namen cstack schreiben, beide Klassen verfügen jedoch über eine eindeutige CLSID, sodass die Möglichkeit einer Kollision vermieden wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-177">For example, two different vendors can write a class named CStack, but both classes have a unique CLSID, so any possibility of a collision is avoided.</span></span>

<span data-ttu-id="45c9f-178">Sie erhalten eine neue CLSID mithilfe der [**cokreateguid**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateguid) -Funktion oder mit einem com Authoring Tool, wie z. b. Visual Studio, das diese Funktion intern aufruft.</span><span class="sxs-lookup"><span data-stu-id="45c9f-178">You obtain a new CLSID by using the [**CoCreateGuid**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateguid) function or by using a COM authoring tool, such as Visual Studio, that calls this function internally.</span></span>

## <a name="the-iunknown-interface"></a><span data-ttu-id="45c9f-179">Die IUnknown-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="45c9f-179">The IUnknown Interface</span></span>

<span data-ttu-id="45c9f-180">Alle COM-Schnittstellen erben von der [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="45c9f-180">All COM interfaces inherit from the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="45c9f-181">Die **IUnknown** -Schnittstelle enthält die grundlegenden com-Vorgänge für die Verwaltung von Polymorphie und Instanzen Lebensdauer.</span><span class="sxs-lookup"><span data-stu-id="45c9f-181">The **IUnknown** interface contains the fundamental COM operations for polymorphism and instance lifetime management.</span></span> <span data-ttu-id="45c9f-182">Die **IUnknown** -Schnittstelle verfügt über drei Element Funktionen mit den Namen [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), [**adressf**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref)und [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release).</span><span class="sxs-lookup"><span data-stu-id="45c9f-182">The **IUnknown** interface has three member functions, named [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref), and [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release).</span></span> <span data-ttu-id="45c9f-183">Alle COM-Objekte sind erforderlich, um die **IUnknown** -Schnittstelle zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="45c9f-183">All COM objects are required to implement the **IUnknown** interface.</span></span>

<span data-ttu-id="45c9f-184">Die [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) -Member-Funktion stellt Polymorphie für com bereit.</span><span class="sxs-lookup"><span data-stu-id="45c9f-184">The [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) member function provides polymorphism for COM.</span></span> <span data-ttu-id="45c9f-185">Ruft **QueryInterface** auf, um zur Laufzeit zu bestimmen, ob ein COM-Objekt eine bestimmte Schnittstelle unterstützt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-185">Call **QueryInterface** to determine at run time whether a COM object supports a particular interface.</span></span> <span data-ttu-id="45c9f-186">Das COM-Objekt gibt einen Schnittstellen Zeiger im- `ppvObject` Parameter zurück, wenn die angeforderte Schnittstelle implementiert wird; andernfalls wird zurückgegeben `NULL` .</span><span class="sxs-lookup"><span data-stu-id="45c9f-186">The COM object returns an interface pointer in the `ppvObject` parameter if it implements the requested interface, otherwise it returns `NULL`.</span></span> <span data-ttu-id="45c9f-187">Die **QueryInterface** -Member-Funktion ermöglicht die Navigation zwischen allen Schnittstellen, die ein COM-Objekt unterstützt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-187">The **QueryInterface** member function enables navigation among all of the interfaces that a COM object supports.</span></span>

<span data-ttu-id="45c9f-188">Die Lebensdauer einer com-Objektinstanz wird durch Ihren *Verweis Zähler* gesteuert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-188">The lifetime of a COM object instance is controlled by its *reference count*.</span></span> <span data-ttu-id="45c9f-189">Die Anzahl der [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Member-Funktionen, die [**Adressierung**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) und [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) steuern.</span><span class="sxs-lookup"><span data-stu-id="45c9f-189">The [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) member functions [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) and [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) control the count.</span></span> <span data-ttu-id="45c9f-190">**Adressierungen** erhöht die Anzahl, und die **Freigabe** verringert die Anzahl.</span><span class="sxs-lookup"><span data-stu-id="45c9f-190">**AddRef** increments the count and **Release** decrements the count.</span></span> <span data-ttu-id="45c9f-191">Wenn der Verweis Zähler Null erreicht, kann die **releasemember** -Funktion die Instanz freigeben, da Sie von keinen Aufrufern verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-191">When the reference count reaches zero, the **Release** member function may free the instance, because no callers are using it.</span></span>

## <a name="the-clientserver-model"></a><span data-ttu-id="45c9f-192">Das Client/Server-Modell</span><span class="sxs-lookup"><span data-stu-id="45c9f-192">The Client/Server Model</span></span>

<span data-ttu-id="45c9f-193">Eine COM-Klasse implementiert eine Reihe von COM-Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-193">A COM class implements a number of COM interfaces.</span></span> <span data-ttu-id="45c9f-194">Die-Implementierung besteht aus Binärdateien, die ausgeführt werden, wenn ein Aufrufer mit einer Instanz der com-Klasse interagiert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-194">The implementation consists of binaries that run when a caller interacts with an instance of the COM class.</span></span> <span data-ttu-id="45c9f-195">COM ermöglicht die Verwendung einer Klasse in verschiedenen Anwendungen, einschließlich Anwendungen, die ohne Kenntnis einer bestimmten Klasse geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-195">COM enables using a class in different applications, including applications written without knowledge of a particular class.</span></span> <span data-ttu-id="45c9f-196">Auf einer Windows-Plattform sind Klassen entweder in einer Dynamic-Linked Library (dll) oder in einer anderen Anwendung (exe) vorhanden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-196">On a Windows platform, classes exist either in a dynamic-linked library (DLL) or in another application (EXE).</span></span>

<span data-ttu-id="45c9f-197">Auf dem Host System verwaltet com eine Registrierungsdatenbank aller CLSIDs für die auf dem System installierten COM-Objekte.</span><span class="sxs-lookup"><span data-stu-id="45c9f-197">On its host system, COM maintains a registration database of all the CLSIDs for the COM objects installed on the system.</span></span> <span data-ttu-id="45c9f-198">Die Registrierungsdatenbank ist eine Zuordnung zwischen jeder CLSID und dem Speicherort der DLL oder exe, die die entsprechende Klasse enthält.</span><span class="sxs-lookup"><span data-stu-id="45c9f-198">The registration database is a mapping between each CLSID and the location of the DLL or EXE that houses the corresponding class.</span></span> <span data-ttu-id="45c9f-199">COM fragt diese Datenbank immer dann ab, wenn ein Aufrufer eine Instanz einer com-Klasse erstellen möchte.</span><span class="sxs-lookup"><span data-stu-id="45c9f-199">COM queries this database whenever a caller wants to create an instance of a COM class.</span></span> <span data-ttu-id="45c9f-200">Der Aufrufer muss nur die CLSID kennen, um eine neue Instanz der-Klasse anzufordern.</span><span class="sxs-lookup"><span data-stu-id="45c9f-200">The caller needs to know only the CLSID to request a new instance of the class.</span></span>

<span data-ttu-id="45c9f-201">Die Interaktion zwischen einem COM-Objekt und seinen Aufrufern wird als Client/Server-Beziehung modelliert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-201">The interaction between a COM object and its callers is modeled as a client/server relationship.</span></span> <span data-ttu-id="45c9f-202">Der Client ist der Aufrufer, der ein COM-Objekt vom System anfordert, und der Server ist das Modul, das COM-Objekte enthält, die Dienste für Clients bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-202">The client is the caller that requests a COM object from the system, and the server is the module that houses COM objects that provides services to clients.</span></span>

<span data-ttu-id="45c9f-203">Ein com-Client ist ein beliebiger Aufrufer, der eine CLSID an das System übergibt, um eine Instanz eines COM-Objekts anzufordern.</span><span class="sxs-lookup"><span data-stu-id="45c9f-203">A COM client is any caller that passes a CLSID to the system to request an instance of a COM object.</span></span> <span data-ttu-id="45c9f-204">Die einfachste Möglichkeit zum Erstellen einer Instanz besteht darin, die com-Funktion [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance)aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-204">The simplest way to create an instance is to call the COM function, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span></span>

<span data-ttu-id="45c9f-205">Die [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion erstellt eine Instanz der angegebenen CLSID und gibt einen Schnittstellen Zeiger des Typs zurück, der vom Client angefordert wurde.</span><span class="sxs-lookup"><span data-stu-id="45c9f-205">The [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function creates one instance of the specified CLSID and returns an interface pointer of the type requested by the client.</span></span> <span data-ttu-id="45c9f-206">Der Client ist verantwortlich für die Verwaltung der Lebensdauer der-Instanz, indem er seine [**releasefunktion**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) aufgerufen, wenn der Client die Verwendung nicht mehr benötigt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-206">The client is responsible for managing the lifetime of the instance by calling its [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) function when the client has finished using it.</span></span> <span data-ttu-id="45c9f-207">Wenn Sie mehrere Objekte auf Grundlage einer einzelnen CLSID erstellen möchten, rufen Sie die [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) -Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="45c9f-207">To create multiple objects based on a single CLSID, call the [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) function.</span></span> <span data-ttu-id="45c9f-208">Um eine Verbindung mit einem Objekt herzustellen, das bereits erstellt wurde und ausgeführt wird, müssen Sie die [**GetActiveObject**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-getactiveobject) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-208">To connect to an object that is already created and running, call the [**GetActiveObject**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-getactiveobject) function.</span></span>

<span data-ttu-id="45c9f-209">Ein com-Server stellt eine com-Implementierung für das System bereit.</span><span class="sxs-lookup"><span data-stu-id="45c9f-209">A COM server provides a COM implementation to the system.</span></span> <span data-ttu-id="45c9f-210">Ein Server ordnet eine CLSID einer com-Klasse zu, enthält die Implementierung der-Klasse, implementiert eine Klassenfactory zum Erstellen von Instanzen der-Klasse und ermöglicht das Entladen des Servers.</span><span class="sxs-lookup"><span data-stu-id="45c9f-210">A server associates a CLSID with a COM class, houses the implementation of the class, implements a class factory for creating instances of the class, and provides for unloading the server.</span></span>

> [!Note]  
> <span data-ttu-id="45c9f-211">Ein com-Server ist nicht mit dem COM-Objekt identisch, das es dem System bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-211">A COM server is not the same as the COM object that it provides to the system.</span></span>

 

<span data-ttu-id="45c9f-212">Um das Erstellen eines COM-Objekts zu aktivieren, muss ein com-Server eine Implementierung der [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) -Schnittstelle bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-212">To enable creating a COM object, a COM server must provide an implementation of the [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface.</span></span> <span data-ttu-id="45c9f-213">Clients können die Methode " [**feateinstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) " aufrufen, um eine neue Instanz eines COM-Objekts anzufordern, aber in der Regel sind diese Anforderungen in der [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion gekapselt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-213">Clients can call the [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) method to request a new instance of a COM object, but usually such requests are encapsulated in the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function.</span></span>

<span data-ttu-id="45c9f-214">Sie können einen com-Server entweder als freigegebene Bibliothek bereitstellen, die zur Laufzeit in den Client Prozess geladen wird (dll auf Windows-Plattformen), oder als ausführbares Modul (exe auf Windows-Plattformen).</span><span class="sxs-lookup"><span data-stu-id="45c9f-214">You can deploy a COM server either as a shared library that is loaded into the client's process at run time (DLL on Windows platforms) or as an executable module (EXE on Windows platforms).</span></span> <span data-ttu-id="45c9f-215">Weitere Informationen finden Sie unter [Registrieren von com-Anwendungen](registering-com-applications.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-215">For more information, see [Registering COM Applications](registering-com-applications.md).</span></span>

## <a name="service-control-manager"></a><span data-ttu-id="45c9f-216">Dienststeuerungs-Manager</span><span class="sxs-lookup"><span data-stu-id="45c9f-216">Service Control Manager</span></span>

<span data-ttu-id="45c9f-217">Der Dienststeuerungs-Manager (Service Control Manager, SCM) verarbeitet die Client Anforderung für eine Instanz eines COM-Objekts.</span><span class="sxs-lookup"><span data-stu-id="45c9f-217">The Service Control Manager (SCM) handles the client request for an instance of a COM object.</span></span> <span data-ttu-id="45c9f-218">Die folgende Liste zeigt die Abfolge der Ereignisse:</span><span class="sxs-lookup"><span data-stu-id="45c9f-218">The following list shows the sequence of events:</span></span>

-   <span data-ttu-id="45c9f-219">Ein Client fordert einen Schnittstellen Zeiger auf ein COM-Objekt von der com-Bibliothek an, indem er eine Funktion wie z. b. [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) mit der CLSID des COM-Objekts aufruft.</span><span class="sxs-lookup"><span data-stu-id="45c9f-219">A client requests an interface pointer to a COM object from the COM Library by calling a function such as [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) with the CLSID of the COM object.</span></span>
-   <span data-ttu-id="45c9f-220">Die com-Bibliothek fragt den SCM ab, um den Server zu finden, der der angeforderten CLSID entspricht.</span><span class="sxs-lookup"><span data-stu-id="45c9f-220">The COM Library queries the SCM to find the server that corresponds with the requested CLSID.</span></span>
-   <span data-ttu-id="45c9f-221">Der SCM sucht den Server und fordert die Erstellung des COM-Objekts aus der Klassenfactory an, die vom Server bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-221">The SCM locates the server and requests the creation of the COM object from the class factory that is provided by the server.</span></span>
-   <span data-ttu-id="45c9f-222">Bei erfolgreicher Ausführung gibt die com-Bibliothek einen Schnittstellen Zeiger an den Client zurück.</span><span class="sxs-lookup"><span data-stu-id="45c9f-222">If successful, the COM Library returns an interface pointer to the client.</span></span>

<span data-ttu-id="45c9f-223">Nachdem das com-System eine Verbindung zwischen einem Server Objekt und einem Client hergestellt hat, kommunizieren der Client und das Objekt direkt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-223">After the COM system connects a server object to a client, the client and object communicate directly.</span></span> <span data-ttu-id="45c9f-224">Es gibt keinen zusätzlichen mehr Aufwand, der durch den Aufruf von über eine Vermittler Laufzeit verursacht wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-224">There is no added overhead from calling through an intermediary run time.</span></span>

<span data-ttu-id="45c9f-225">Wenn Sie einen com-Server beim Host System registrieren, können Sie verschiedene Möglichkeiten angeben, wie der Server aktiviert werden soll.</span><span class="sxs-lookup"><span data-stu-id="45c9f-225">When you register a COM server with the host system, you can specify different ways for the server to be activated.</span></span> <span data-ttu-id="45c9f-226">In der folgenden Liste werden die drei Möglichkeiten angezeigt, mit denen der SCM einen com-Server aktivieren kann:</span><span class="sxs-lookup"><span data-stu-id="45c9f-226">The following list shows the three ways that the SCM can activate a COM server:</span></span>

-   <span data-ttu-id="45c9f-227">In-Process: der SCM gibt den Dateipfad der DLL zurück, die die Implementierung des Objekt Servers enthält.</span><span class="sxs-lookup"><span data-stu-id="45c9f-227">In-process: The SCM returns the file path of the DLL that contains the object server implementation.</span></span> <span data-ttu-id="45c9f-228">Die com-Bibliothek lädt die dll und fragt Sie nach Ihrem Klassenfactory-Schnittstellen Zeiger ab.</span><span class="sxs-lookup"><span data-stu-id="45c9f-228">The COM Library loads the DLL and queries it for its class factory interface pointer.</span></span>
-   <span data-ttu-id="45c9f-229">Local: der SCM startet die lokale ausführbare Datei, die beim Start eine Klassenfactory registriert, und der Schnittstellen Zeiger ist für das System und die Clients verfügbar.</span><span class="sxs-lookup"><span data-stu-id="45c9f-229">Local: The SCM starts the local executable which registers a class factory on startup, and its interface pointer is available to the system and clients.</span></span>
-   <span data-ttu-id="45c9f-230">Remote: der lokale SCM erhält einen klassenfactoryschnittstellen Zeiger von dem SCM, der auf einem Remote Computer ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-230">Remote: The local SCM acquires a class factory interface pointer from the SCM that is running on a remote computer.</span></span>

<span data-ttu-id="45c9f-231">Wenn ein Client ein COM-Objekt anfordert, kontaktiert die com-Bibliothek den SCM auf dem lokalen Host.</span><span class="sxs-lookup"><span data-stu-id="45c9f-231">When a client requests a COM object, the COM Library contacts the SCM on the local host.</span></span> <span data-ttu-id="45c9f-232">Der SCM findet den entsprechenden com-Server, der lokal oder Remote sein kann, und der Server gibt einen Schnittstellen Zeiger auf die Klassenfactory des Servers zurück.</span><span class="sxs-lookup"><span data-stu-id="45c9f-232">The SCM locates the appropriate COM server, which may be local or remote, and the server returns an interface pointer to the server's class factory.</span></span> <span data-ttu-id="45c9f-233">Wenn die Klassenfactory verfügbar ist, kann die com-Bibliothek oder der Client die Klassenfactory verwenden, um das angeforderte Objekt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-233">When the class factory is available, the COM Library or the client can use the class factory to create the requested object.</span></span> <span data-ttu-id="45c9f-234">Weitere Informationen finden Sie unter [Implementieren von IClassFactory](implementing-iclassfactory.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-234">For more information, see [Implementing IClassFactory](implementing-iclassfactory.md).</span></span>

## <a name="reusability"></a><span data-ttu-id="45c9f-235">Wiederverwendbarkeit</span><span class="sxs-lookup"><span data-stu-id="45c9f-235">Reusability</span></span>

<span data-ttu-id="45c9f-236">COM unterstützt die *Wiederverwendbarkeit von Blackbox*, was bedeutet, dass die Implementierungsdetails einer wiederverwendbaren Komponente nicht für Clients verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-236">COM supports *black-box reusability*, which means that the implementation details of a reusable component are not exposed to clients.</span></span> <span data-ttu-id="45c9f-237">Um die Wiederverwendbarkeit von Blackbox zu erreichen, unterstützt com zwei Mechanismen, durch die ein Objekt ein anderes wieder verwenden kann.</span><span class="sxs-lookup"><span data-stu-id="45c9f-237">To achieve black-box reusability, COM supports two mechanisms through which one object may reuse another.</span></span> <span data-ttu-id="45c9f-238">Die zwei Arten der Wiederverwendung werden als *Containment* und *Aggregation* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-238">The two forms of reuse are named *containment* and *aggregation*.</span></span> <span data-ttu-id="45c9f-239">Gemäß der Konvention wird das Objekt, das wieder verwendet wird, das *innere Objekt* genannt, und das Objekt, das das innere Objekt verwendet, wird als *Äußeres Objekt* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-239">By convention, the object being reused is named the *inner object*, and the object that is making use of the inner object is named the *outer object*.</span></span>

<span data-ttu-id="45c9f-240">In Containment verhält sich das äußere Objekt als Client des inneren Objekts.</span><span class="sxs-lookup"><span data-stu-id="45c9f-240">In containment, the outer object behaves as a client of the inner object.</span></span> <span data-ttu-id="45c9f-241">Das äußere Objekt ist ein logischer Container für das innere Objekt, und wenn das äußere Objekt die Dienste des inneren Objekts verwendet, delegiert das äußere Objekt die Implementierung an die Schnittstellen des inneren Objekts.</span><span class="sxs-lookup"><span data-stu-id="45c9f-241">The outer object is a logical container for the inner object, and when the outer object uses the services of the inner object, the outer object delegates implementation to the inner object's interfaces.</span></span> <span data-ttu-id="45c9f-242">Dies bedeutet, dass das äußere Objekt in Bezug auf die Dienste des inneren Objekts implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-242">This means that the outer object is implemented in terms of the inner object's services.</span></span> <span data-ttu-id="45c9f-243">Das äußere Objekt unterstützt möglicherweise nicht die gleichen Schnittstellen wie das innere Objekt, und das äußere Objekt kann die Schnittstelle eines inneren Objekts verwenden, um die Implementierung von Teilen einer anderen Schnittstelle für das äußere Objekt zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-243">The outer object may not support the same interfaces as the inner object, and the outer object may use an inner object's interface to help with implementing parts of a different interface on the outer object.</span></span>

<span data-ttu-id="45c9f-244">In Aggregationen macht das äußere Objekt Schnittstellen vom inneren Objekt verfügbar, als wären Sie auf dem äußeren Objekt implementiert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-244">In aggregation, the outer object exposes interfaces from the inner object as if they were implemented on the outer object.</span></span> <span data-ttu-id="45c9f-245">Dies ist hilfreich, wenn das äußere Objekt immer jeden Aufruf an einer seiner Schnittstellen an dieselbe Schnittstelle des inneren Objekts delegiert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-245">This is useful when the outer object would always delegate every call on one of its interfaces to the same interface of the inner object.</span></span> <span data-ttu-id="45c9f-246">Die Aggregation ist eine einfache Möglichkeit, die es dem äußeren Objekt ermöglicht, zusätzlichen Implementierungsaufwand zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-246">Aggregation is a convenience that enables the outer object to avoid extra implementation overhead.</span></span>

<span data-ttu-id="45c9f-247">Weitere Informationen finden Sie unter [wieder verwenden von Objekten](reusing-objects.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-247">For more information, see [Reusing Objects](reusing-objects.md).</span></span>

## <a name="storage-and-stream-objects"></a><span data-ttu-id="45c9f-248">Speicher-und Streamobjekte</span><span class="sxs-lookup"><span data-stu-id="45c9f-248">Storage and Stream Objects</span></span>

<span data-ttu-id="45c9f-249">COM-Objekte speichern den Zustand in einer Datei unter Verwendung von *strukturiertem Speicher*, bei dem es sich um eine Form eines permanenten Speichers handelt, der die Navigation zum Inhalt einer Datei mithilfe der Semantik des Dateisystems ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="45c9f-249">COM objects save state to a file by using *structured storage*, which is a form of persistent storage that enables navigation of a file's contents by using file system semantics.</span></span> <span data-ttu-id="45c9f-250">Wenn Sie den Inhalt einer Datei auf diese Weise behandeln, werden Funktionen wie inkrementeller Zugriff, Transaktionen und Freigabe zwischen Prozessen ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="45c9f-250">Treating a file's contents in this manner enables features such as incremental access, transactions, and sharing among processes.</span></span>

<span data-ttu-id="45c9f-251">Die permanente com-Speicher Spezifikation bietet zwei Typen von Speicherelementen: Speicher Objekte und Streamobjekte.</span><span class="sxs-lookup"><span data-stu-id="45c9f-251">The COM persistent storage specification provides for two types of storage elements: storage objects and stream objects.</span></span> <span data-ttu-id="45c9f-252">Diese Objekte werden von der com-Bibliothek implementiert, und Benutzer Anwendungen implementieren diese Speicherelemente selten.</span><span class="sxs-lookup"><span data-stu-id="45c9f-252">These objects are implemented by the COM Library, and user applications rarely implement these storage elements.</span></span> <span data-ttu-id="45c9f-253">Speicher Objekte implementieren die [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) -Schnittstelle, und Stream-Objekte implementieren die [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="45c9f-253">Storage objects implement the [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) interface, and stream objects implement the [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) interface.</span></span>

<span data-ttu-id="45c9f-254">Ein Stream-Objekt enthält Daten und ist konzeptionell ähnlich wie eine einzelne Datei in einem Dateisystem.</span><span class="sxs-lookup"><span data-stu-id="45c9f-254">A stream object contains data and is conceptually similar to a single file in a file system.</span></span> <span data-ttu-id="45c9f-255">Jeder Stream verfügt über Zugriffsrechte und einen einzelnen Such Zeiger.</span><span class="sxs-lookup"><span data-stu-id="45c9f-255">Each stream has access rights and a single seek pointer.</span></span> <span data-ttu-id="45c9f-256">Über die [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) -Schnittstelle können Sie die zugrunde liegenden Daten des Streams lesen, schreiben, suchen und andere Vorgänge ausführen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-256">Through the [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) interface, you can read, write, seek, and perform other operations on the stream's underlying data.</span></span> <span data-ttu-id="45c9f-257">Ein Datenstrom wird mit einer Text Zeichenfolge benannt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-257">A stream is named by using a text string.</span></span> <span data-ttu-id="45c9f-258">Sie kann eine beliebige interne Struktur enthalten, da es sich um einen flatstream von Bytes handelt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-258">It can contain any internal structure, because it is a flat stream of bytes.</span></span> <span data-ttu-id="45c9f-259">Außerdem ähneln die Funktionen in der **IStream** -Schnittstelle den Standardfunktionen, die auf Datei Handles basieren, wie z. b. denen in der ANSI C-Lauf Zeit Bibliothek.</span><span class="sxs-lookup"><span data-stu-id="45c9f-259">In addition, the functions in the **IStream** interface are similar to standard file-handle based functions, such as those in the ANSI C run-time library.</span></span>

<span data-ttu-id="45c9f-260">Ein Speicher Objekt ähnelt konzeptionell einem Verzeichnis in einem Dateisystem.</span><span class="sxs-lookup"><span data-stu-id="45c9f-260">A storage object is conceptually similar to a directory in a file system.</span></span> <span data-ttu-id="45c9f-261">Jeder Speicher kann eine beliebige Anzahl von unter Speicher Objekten und eine beliebige Anzahl von Streams enthalten.</span><span class="sxs-lookup"><span data-stu-id="45c9f-261">Each storage can contain any number of sub-storage objects and any number of streams.</span></span> <span data-ttu-id="45c9f-262">Jeder Speicher verfügt über eigene Zugriffsrechte.</span><span class="sxs-lookup"><span data-stu-id="45c9f-262">Each storage has its own access rights.</span></span> <span data-ttu-id="45c9f-263">Über die [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) -Schnittstelle können Sie Vorgänge ausführen, z. b. das aufzählen, verschieben, kopieren, umbenennen, erstellen und Löschen von Elementen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-263">Through the [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) interface, you can perform operations such as enumerating, moving, copying, renaming, creating, and deleting elements.</span></span> <span data-ttu-id="45c9f-264">Ein Speicher Objekt speichert keine Anwendungs definierten Daten, sondern speichert implizit die Namen der Elemente (Storages und Streams), die darin enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="45c9f-264">A storage object does not store application-defined data, but it stores implicitly the names of the elements (storages and streams) that it contains.</span></span>

<span data-ttu-id="45c9f-265">Speicher-und Streamobjekte sind für Prozesse freigegeben, wenn Sie gemäß der com-Spezifikation auf einer Host Plattform implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-265">Storage and stream objects are sharable among processes when they are implemented according to the COM specification on a host platform.</span></span> <span data-ttu-id="45c9f-266">Dies ermöglicht, dass Objekte, die in-Process oder außerhalb des Prozesses ausgeführt werden, gleichen inkrementellen Zugriff auf Ihren Dateispeicher haben.</span><span class="sxs-lookup"><span data-stu-id="45c9f-266">This enables objects that are running in-process or out-of-process to have equal incremental access to their file storage.</span></span> <span data-ttu-id="45c9f-267">Da com in jeden Prozess separat geladen wird, werden vom Betriebssystem unterstützte Shared Memory-Mechanismen verwendet, um den Zustand der geöffneten Elemente und deren Zugriffs Modi zwischen Prozessen zu übermitteln.</span><span class="sxs-lookup"><span data-stu-id="45c9f-267">Because COM is loaded into each process separately, it uses operating-system supported shared memory mechanisms to communicate the state of opened elements and their access modes between processes.</span></span>

<span data-ttu-id="45c9f-268">Jedes Speicher-und Streamobjekt in einer strukturierten Datei hat einen Namen, um es zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="45c9f-268">Every storage and stream object in a structured file has a name to identify it.</span></span> <span data-ttu-id="45c9f-269">Der Name ist eine Zeichenfolge, die einer bestimmten Konvention folgt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-269">The name is a string that follows a particular convention.</span></span> <span data-ttu-id="45c9f-270">Weitere Informationen finden Sie unter [Benennungs Konventionen für Speicher Objekte](/windows/desktop/Stg/storage-object-naming-conventions).</span><span class="sxs-lookup"><span data-stu-id="45c9f-270">For more information, see [Storage Object Naming Conventions](/windows/desktop/Stg/storage-object-naming-conventions).</span></span> <span data-ttu-id="45c9f-271">Der Name wird an [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) -Funktionen weitergegeben, um anzugeben, auf welchem Element im Speicher gearbeitet werden soll.</span><span class="sxs-lookup"><span data-stu-id="45c9f-271">The name is passed to [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) functions to specify which element in the storage to operate on.</span></span> <span data-ttu-id="45c9f-272">Namen von Stamm Speicher Objekten sind identisch mit den Dateinamen im zugrunde liegenden Dateisystem, und diese Namen müssen den Konventionen und Einschränkungen des Dateisystems entsprechen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-272">Names of root storage objects are the same as file names in the underlying file system, and these names must follow the file system's conventions and restrictions.</span></span> <span data-ttu-id="45c9f-273">An speicherbezogene Funktionen übergebenen Zeichen folgen, die namens Dateien ohne Interpretation oder Änderungen an das Dateisystem übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-273">Strings passed to storage-related functions which name files are passed through to the file system without interpretation or changes.</span></span>

<span data-ttu-id="45c9f-274">Namen von Elementen, die in Speicher Objekten enthalten sind, werden von der Implementierung des betreffenden bestimmten Speicher Objekts verwaltet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-274">Names of elements that are contained within storage objects are managed by the implementation of the particular storage object in question.</span></span> <span data-ttu-id="45c9f-275">Alle Implementierungen von Speicher Objekten müssen Elementnamen unterstützen, die 32 Zeichen lang sind, und einige Implementierungen unterstützen möglicherweise längere Namen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-275">All implementations of storage objects must support element names that are 32 characters in length, and some implementations may support longer names.</span></span> <span data-ttu-id="45c9f-276">Namen werden mit der Groß-/Kleinschreibung gespeichert, aber Sie werden mit der Groß-/Kleinschreibung verglichen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-276">Names are stored with case preserved, but they are compared as case-insensitive.</span></span> <span data-ttu-id="45c9f-277">Anwendungen, die Speicher Elementnamen definieren, müssen Namen auswählen, die in beiden Situationen funktionieren.</span><span class="sxs-lookup"><span data-stu-id="45c9f-277">Applications that define storage element names must choose names that work in either situation.</span></span>

<span data-ttu-id="45c9f-278">Sie können auf jedes Element in einer strukturierten Speicherdatei zugreifen, indem Sie Funktionen und Schnittstellen verwenden, die von com implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-278">You access every element in a structured storage file by using functions and interfaces that are implemented by COM.</span></span> <span data-ttu-id="45c9f-279">Dies bedeutet, dass andere Anwendungen die Datei durchsuchen können, indem Sie mit den [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) -Schnittstellen Funktionen navigieren, die Verzeichnis ähnliche Dienste bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-279">This means that other applications can browse the file by navigating with the [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) interface functions that provide directory-like services.</span></span> <span data-ttu-id="45c9f-280">Außerdem können andere Anwendungen die Datei Daten verwenden, ohne dass die Anwendung ausgeführt werden muss, die die Datei geschrieben hat.</span><span class="sxs-lookup"><span data-stu-id="45c9f-280">Also, other applications can use the file's data, without having to run the application that wrote the file.</span></span> <span data-ttu-id="45c9f-281">Wenn eine COM-Anwendung auf die strukturierten Speicherdateien einer anderen Anwendung zugreift, gelten standardmäßige Windows-Zugriffsrechte, und die Anwendung muss über ausreichende Berechtigungen verfügen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-281">When a COM application accesses the structured storage files of another application, standard Windows access rights apply, and the application must have sufficient privileges.</span></span>

<span data-ttu-id="45c9f-282">Ein COM-Objekt kann sich selbst lesen und in persistenten Speicher schreiben.</span><span class="sxs-lookup"><span data-stu-id="45c9f-282">A COM object can read and write itself to persistent storage.</span></span> <span data-ttu-id="45c9f-283">Ein Client fragt abhängig vom Kontext des Vorgangs eine der persistenzbezogenen Schnittstellen für das COM-Objekt ab.</span><span class="sxs-lookup"><span data-stu-id="45c9f-283">A client queries for one of the persistence-related interfaces on the COM object, depending on the context of the operation.</span></span> <span data-ttu-id="45c9f-284">COM-Objekte können eine beliebige Kombination der folgenden Schnittstellen implementieren:</span><span class="sxs-lookup"><span data-stu-id="45c9f-284">COM objects can implement any combination of the following interfaces:</span></span>

-   <span data-ttu-id="45c9f-285">[**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage): das COM-Objekt liest seinen permanenten Zustand und schreibt ihn in ein Speicher Objekt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-285">[**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage): The COM object reads and writes its persistent state to a storage object.</span></span> <span data-ttu-id="45c9f-286">Der Client stellt über diese Schnittstelle einen [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) -Zeiger für das-Objekt bereit.</span><span class="sxs-lookup"><span data-stu-id="45c9f-286">The client provides the object with an [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) pointer through this interface.</span></span> <span data-ttu-id="45c9f-287">Dies ist die einzige Dauerhaftigkeits Schnittstelle, die Semantik für inkrementellen Zugriff einschließt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-287">This is the only persistence interface that includes semantics for incremental access.</span></span>
-   <span data-ttu-id="45c9f-288">[**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream): das COM-Objekt liest seinen permanenten Zustand und schreibt ihn in ein Datenstrom Objekt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-288">[**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream): The COM object reads and writes its persistent state to a stream object.</span></span> <span data-ttu-id="45c9f-289">Der Client stellt über diese Schnittstelle einen [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) -Zeiger für das-Objekt bereit.</span><span class="sxs-lookup"><span data-stu-id="45c9f-289">The client provides the object with an [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) pointer through this interface.</span></span>
-   <span data-ttu-id="45c9f-290">[**IPersistFile**](/windows/desktop/api/ObjIdl/nn-objidl-ipersistfile): das COM-Objekt liest und schreibt seinen permanenten Zustand direkt in eine Datei auf dem zugrunde liegenden System.</span><span class="sxs-lookup"><span data-stu-id="45c9f-290">[**IPersistFile**](/windows/desktop/api/ObjIdl/nn-objidl-ipersistfile): The COM object reads and writes its persistent state directly to a file on the underlying system.</span></span> <span data-ttu-id="45c9f-291">Diese Schnittstelle bezieht sich nicht auf [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) oder [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) , es sei denn, der Zugriff auf die zugrunde liegende Datei erfolgt über diese Schnittstellen, aber die Schnittstelle **IPersistFile** hat keine Semantik für Speicher und Streams.</span><span class="sxs-lookup"><span data-stu-id="45c9f-291">This interface does not involve [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) unless the underlying file is accessed through these interfaces, but the **IPersistFile** interface has no semantics for storages and streams.</span></span> <span data-ttu-id="45c9f-292">Der Client stellt dem-Objekt einen Dateinamen bereit und ruft die [**Speicher**](/windows/desktop/api/ObjIdl/nf-objidl-ipersistfile-save) -oder [**Lade**](/windows/desktop/api/ObjIdl/nf-objidl-ipersistfile-load) Funktionen auf.</span><span class="sxs-lookup"><span data-stu-id="45c9f-292">The client provides the object with a file name and calls the [**Save**](/windows/desktop/api/ObjIdl/nf-objidl-ipersistfile-save) or [**Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersistfile-load) functions.</span></span>

## <a name="data-transfer"></a><span data-ttu-id="45c9f-293">Datenübertragung</span><span class="sxs-lookup"><span data-stu-id="45c9f-293">Data Transfer</span></span>

<span data-ttu-id="45c9f-294">Die strukturierte Speicherung stellt die Grundlage für den Datenaustausch zwischen COM-Objekten und-Prozessen dar, die als *einheitliche Datenübertragungs Daten* bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-294">Structured storage provides the basis for data exchange between COM objects and processes, which is named *uniform data transfer*.</span></span> <span data-ttu-id="45c9f-295">Bevor com in OLE 2 implementiert wurde, wurde die Datenübertragung unter Windows durch *Übertragungsprotokolle*, wie z. b. die Zwischenablage und die Drag-Drop-Protokolle, festgelegt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-295">Before COM was implemented in OLE 2, data transfer on Windows was specified by *transfer protocols*, such as the clipboard and drag-drop protocols.</span></span> <span data-ttu-id="45c9f-296">Jedes Übertragungsprotokoll besaß einen eigenen Funktions Satz, der das Protokoll an die Abfrage gebunden hat, und es war spezifischer Code erforderlich, um die verschiedenen Protokolle und Exchange-Prozeduren verarbeiten zu können.</span><span class="sxs-lookup"><span data-stu-id="45c9f-296">Each transfer protocol had its own set of functions that bound the protocol to the query, and specific code was required to handle each different protocol and exchange procedure.</span></span> <span data-ttu-id="45c9f-297">Die einheitliche Datenübertragung stellt alle Datenübertragungen mithilfe der [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) -Schnittstelle dar, die allgemeine Datenaustausch Vorgänge vom Übertragungsprotokoll trennt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-297">Uniform data transfer represents all data transfers by using the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface, which separates common data exchange operations from the transfer protocol.</span></span>

<span data-ttu-id="45c9f-298">Die [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) -Schnittstelle kapselt die standardmäßigen Get-und Set-Vorgänge für Daten, Abfragen und Enumerationen sowie Benachrichtigungen, die erkennen, wenn sich Daten in einem Objekt ändern.</span><span class="sxs-lookup"><span data-stu-id="45c9f-298">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface encapsulates the standard get and set operations on data, queries and enumerations, and notifications that detect when data changes in an object.</span></span> <span data-ttu-id="45c9f-299">Die einheitliche Datenübertragung ermöglicht umfassende Beschreibungen von Datenformaten sowie die Verwendung unterschiedlicher Speichermedien für die Datenübertragung.</span><span class="sxs-lookup"><span data-stu-id="45c9f-299">Uniform data transfer enables rich descriptions of data formats, as well as the use of different storage media for the data transfer.</span></span>

<span data-ttu-id="45c9f-300">Während der gleichmäßigen Datenübertragung tauschen alle Protokolle einen Zeiger auf eine [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) -Schnittstelle aus.</span><span class="sxs-lookup"><span data-stu-id="45c9f-300">During uniform data transfer, all protocols exchange a pointer to an [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="45c9f-301">Der Server ist die Quelle der Daten und implementiert ein Datenobjekt, das in jedem Datenaustausch Protokoll verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="45c9f-301">The server is the source of the data and implements one data object, which is usable in any data exchange protocol.</span></span> <span data-ttu-id="45c9f-302">Der Client verarbeitet die Daten und fordert Daten von einem Datenobjekt an, wenn ein **IDataObject** -Zeiger von einem beliebigen Protokoll empfangen wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-302">The client consumes the data and requests data from a data object when it receives an **IDataObject** pointer from any protocol.</span></span> <span data-ttu-id="45c9f-303">Nachdem der Zeiger Austausch aufgetreten ist, verarbeiten beide Seiten den Datenaustausch auf einheitliche Weise über die **IDataObject** -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="45c9f-303">After the pointer exchange has occurred, both sides handle data exchange in a uniform fashion, through the **IDataObject** interface.</span></span>

<span data-ttu-id="45c9f-304">COM definiert zwei Datenstrukturen, die eine einheitliche Datenübertragung ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-304">COM defines two data structures that enable uniform data transfer.</span></span> <span data-ttu-id="45c9f-305">Die [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur stellt ein generalisiertes Zwischenablage Format dar, und die [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur stellt das Übertragungsmedium als Speicher Handle dar.</span><span class="sxs-lookup"><span data-stu-id="45c9f-305">The [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure represents a generalized clipboard format, and the [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure represents the transfer medium as a memory handle.</span></span>

<span data-ttu-id="45c9f-306">Der Client erstellt eine [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, um den Datentyp anzugeben, der von einer Datenquelle angefordert wird, und er wird von der Datenquelle verwendet, um zu beschreiben, welche Formate er bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-306">The client creates a [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to indicate the type of data that it requests from a data source, and it is used by the data source to describe what formats it provides.</span></span> <span data-ttu-id="45c9f-307">Der Client fragt eine Datenquelle nach den verfügbaren Formaten ab, indem er die [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) -Schnittstelle anfordert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-307">The client queries a data source for its available formats by requesting its [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) interface.</span></span> <span data-ttu-id="45c9f-308">Weitere Informationen finden Sie in [der FORMATETC-Struktur](the-formatetc-structure.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-308">For more information, see [The FORMATETC Structure](the-formatetc-structure.md).</span></span>

<span data-ttu-id="45c9f-309">Der Client erstellt eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur und übergibt sie an die [**GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) -Methode, und das Datenobjekt gibt die Daten in der bereitgestellten **STGMEDIUM** -Struktur zurück.</span><span class="sxs-lookup"><span data-stu-id="45c9f-309">The client creates a [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure and passes it to the [**GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) method, and the data object returns the data in the provided **STGMEDIUM** structure.</span></span>

<span data-ttu-id="45c9f-310">Mit der [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur können sowohl Clients als auch Datenquellen das effizienteste Exchange-Medium auswählen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-310">The [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure enables both clients and data sources to choose the most efficient exchange medium.</span></span> <span data-ttu-id="45c9f-311">Wenn beispielsweise die auszutauschenden Daten sehr groß sind, kann die Datenquelle ein Datenträger basiertes Medium als bevorzugtes Format anstelle des Hauptspeichers angeben.</span><span class="sxs-lookup"><span data-stu-id="45c9f-311">For example, if the data to be exchanged is very large, the data source can indicate a disk-based medium as its preferred format, instead of main memory.</span></span> <span data-ttu-id="45c9f-312">Diese Flexibilität ermöglicht einen effizienten Datenaustausch, der so schnell sein kann wie das Übergeben eines Zeigers an einen [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) oder einen [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span><span class="sxs-lookup"><span data-stu-id="45c9f-312">This flexibility enables efficient data exchanges that can be as fast as passing a pointer to an [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) or an [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span></span> <span data-ttu-id="45c9f-313">Weitere Informationen finden Sie in [der STGMEDIUM-Struktur](the-stgmedium-structure.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-313">For more information, see [The STGMEDIUM Structure](the-stgmedium-structure.md).</span></span>

<span data-ttu-id="45c9f-314">Ein Client einer Datenquelle erfordert möglicherweise eine Benachrichtigung, wenn sich die Daten ändern.</span><span class="sxs-lookup"><span data-stu-id="45c9f-314">A client of a data source may require notification when the data changes.</span></span> <span data-ttu-id="45c9f-315">COM verarbeitet Daten Änderungs Benachrichtigungen mithilfe eines *beratungsenke* -Objekts, das die [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) -Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-315">COM handles data-change notifications by using an *advise sink* object, which implements the [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interface.</span></span> <span data-ttu-id="45c9f-316">Das "advisink"-Objekt und die **IAdviseSink** -Schnittstelle werden vom Client implementiert, der einen **IAdviseSink** -Zeiger an die Datenquelle übergibt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-316">The advise sink object and the **IAdviseSink** interface are implemented by the client, which passes an **IAdviseSink** pointer to the data source.</span></span> <span data-ttu-id="45c9f-317">Wenn die Datenquelle eine Änderung in den zugrunde liegenden Daten erkennt, ruft Sie eine **IAdviseSink** -Methode auf, um den Client zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-317">When the data source detects a change in the underlying data, it calls an **IAdviseSink** method to notify the client.</span></span> <span data-ttu-id="45c9f-318">Weitere Informationen finden Sie unter [Daten Benachrichtigung](data-notification.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-318">For more information, see [Data Notification](data-notification.md).</span></span>

## <a name="remoting"></a><span data-ttu-id="45c9f-319">Remoting</span><span class="sxs-lookup"><span data-stu-id="45c9f-319">Remoting</span></span>

<span data-ttu-id="45c9f-320">COM ermöglicht eine Remote-und verteilte Berechnung.</span><span class="sxs-lookup"><span data-stu-id="45c9f-320">COM enables remote and distributed computation.</span></span> <span data-ttu-id="45c9f-321">Mit *Interface Remoting* kann eine Member-Funktion einen Schnittstellen Zeiger auf ein COM-Objekt zurückgeben, das sich in einem anderen Prozess oder auf einem anderen Host Computer befindet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-321">*Interface remoting* enables a member function to return an interface pointer to a COM object that is in a different process or on a different host computer.</span></span> <span data-ttu-id="45c9f-322">Die Infrastruktur, die das Schnittstellen Remoting ausführt, ist sowohl für den Client als auch den Objekt Server transparent.</span><span class="sxs-lookup"><span data-stu-id="45c9f-322">The infrastructure that performs the interface remoting is transparent to both the client and the object server.</span></span> <span data-ttu-id="45c9f-323">Weder der Client noch der Server benötigt die Bereitstellungs Details eines anderen, um über eine Remote Schnittstelle zu kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="45c9f-323">Neither the client nor the server need one another's deployment details to communicate through a remoted interface.</span></span> <span data-ttu-id="45c9f-324">Ein Client ruft Member-Funktionen für die gleiche Schnittstelle auf, um mit einem COM-Objekt zu kommunizieren, das in-Process, außerhalb des Prozesses auf dem lokalen Host oder auf einem Remote Computer ist.</span><span class="sxs-lookup"><span data-stu-id="45c9f-324">A client calls member functions on the same interface to communicate with a COM object that is in-process, out-of-process on the local host, or on a remote computer.</span></span> <span data-ttu-id="45c9f-325">Lokale und Remote Aufrufe an derselben Schnittstelle sind nicht für den Client unterschieden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-325">Local and remote calls on the same interface are indistinguishable to the client.</span></span>

<span data-ttu-id="45c9f-326">Für die Kommunikation mit einem COM-Objekt ruft ein Client immer eine Prozess interne Implementierung auf.</span><span class="sxs-lookup"><span data-stu-id="45c9f-326">To communicate with a COM object, a client always calls an in-process implementation.</span></span> <span data-ttu-id="45c9f-327">Wenn das COM-Objekt in Bearbeitung ist, wird der-Befehl direkt aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-327">If the COM object is in-process, the call is direct.</span></span> <span data-ttu-id="45c9f-328">Wenn das COM-Objekt out-of-Process oder Remote ist, bietet com eine *Proxy* Implementierung, die den Aufruf an das-Objekt weiterleitet, indem das RPC-Protokoll (Remote Procedure Aufruf) verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-328">If the COM object is out-of-process or remote, COM provides a *proxy* implementation that forwards the call to the object by using the Remote Procedure Call (RPC) protocol.</span></span>

<span data-ttu-id="45c9f-329">Ein COM-Objekt empfängt immer Aufrufe von einem Client über eine Prozess interne Implementierung.</span><span class="sxs-lookup"><span data-stu-id="45c9f-329">A COM object always receives calls from a client through an in-process implementation.</span></span> <span data-ttu-id="45c9f-330">Wenn der Aufrufer in Bearbeitung ist, ist der Aufruf Direct.</span><span class="sxs-lookup"><span data-stu-id="45c9f-330">If the caller is in-process, the call is direct.</span></span> <span data-ttu-id="45c9f-331">Wenn der Aufrufer außerhalb des Prozesses oder Remote ist, stellt com eine *Stub* -Implementierung bereit, die den Remote Prozedur Aufruf vom Proxy im Client Prozess empfängt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-331">If the caller is out-of-process or remote, COM provides a *stub* implementation that receives the remote procedure call from the proxy in the client process.</span></span>

<span data-ttu-id="45c9f-332">Das Marshalling *ist das* Verfahren zum Verpacken der-Ereignis Stapel für die Übertragung vom Proxy zum Stub.</span><span class="sxs-lookup"><span data-stu-id="45c9f-332">*Marshaling* is the procedure for packaging the call stack for transmission from proxy to stub.</span></span> <span data-ttu-id="45c9f-333">Das *nicht-Marshalling ist das* entpacken, das am empfangenden Ende erfolgt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-333">*Unmarshaling* is the unpackaging that occurs at the receiving end.</span></span> <span data-ttu-id="45c9f-334">Rückgabewerte werden gemarshallt und aus dem Stub in den Proxy gemarshallt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-334">Return values are marshaled and unmarshaled from the stub to the proxy.</span></span> <span data-ttu-id="45c9f-335">Diese Art der Kommunikation wird auch als Senden eines Anrufe *über das* Netzwerk bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-335">This kind of communication is also referred to as sending a call *over the wire*.</span></span>

<span data-ttu-id="45c9f-336">Jeder Datentyp hat Regeln für das Mars Hallen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-336">Each different data type has rules for marshaling.</span></span> <span data-ttu-id="45c9f-337">Schnittstellen Zeiger verfügen auch über ein marshallingprotokoll, das in der [**comarshalinterface**](/windows/desktop/api/combaseapi/nf-combaseapi-comarshalinterface) -Funktion gekapselt ist.</span><span class="sxs-lookup"><span data-stu-id="45c9f-337">Interface pointers also have a marshaling protocol, which is encapsulated in the [**CoMarshalInterface**](/windows/desktop/api/combaseapi/nf-combaseapi-comarshalinterface) function.</span></span> <span data-ttu-id="45c9f-338">In den meisten Fällen ist das Marshalling von *Standardschnittstellen*, das vom System bereitgestellt wird, ausreichend, aber ein COM-Objekt kann optional *benutzerdefiniertes Schnittstellen* Marshalling implementieren, um die Erstellung von Remote Objektproxys in sich selbst zu steuern.</span><span class="sxs-lookup"><span data-stu-id="45c9f-338">In most cases, *standard interface marshaling*, which is provided by the system, is sufficient, but a COM object optionally may implement *custom interface marshaling* to control the creation of remote object proxies to itself.</span></span> <span data-ttu-id="45c9f-339">Weitere Informationen finden Sie unter [Kommunikation zwischen Objekten](inter-object-communication.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-339">For more information, see [Inter-Object Communication](inter-object-communication.md).</span></span>

## <a name="security"></a><span data-ttu-id="45c9f-340">Sicherheit</span><span class="sxs-lookup"><span data-stu-id="45c9f-340">Security</span></span>

<span data-ttu-id="45c9f-341">COM bietet zwei Formen der Anwendungssicherheit.</span><span class="sxs-lookup"><span data-stu-id="45c9f-341">COM provides two forms of application security.</span></span> <span data-ttu-id="45c9f-342">Eine ist die *Aktivierungs Sicherheit*, die angibt, wie neue Objekte erstellt werden, wie Clients eine Verbindung mit neuen und vorhandenen Objekten herstellen und wie bestimmte öffentliche Dienste, wie z. b. die Klassen Tabelle und die laufende Objekttabelle, gesichert werden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-342">One is *activation security*, which specifies how new objects are created, how clients connect to new and existing objects, and how certain public services, such as the Class Table and the Running Object Table are secured.</span></span> <span data-ttu-id="45c9f-343">Die andere ist " *callsecurity*", die angibt, wie die Sicherheit in einer eingerichteten Verbindung zwischen einem Client und einem COM-Objekt funktioniert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-343">The other is *call security*, which specifies how security operates in an established connection between a client to a COM object.</span></span>

<span data-ttu-id="45c9f-344">Die Aktivierungs Sicherheit wird automatisch vom Dienststeuerungs-Manager (Service Control Manager, SCM) angewendet.</span><span class="sxs-lookup"><span data-stu-id="45c9f-344">Activation security is applied automatically by the Service Control Manager (SCM).</span></span> <span data-ttu-id="45c9f-345">Wenn der SCM eine Anforderung zum Abrufen eines COM-Objekts empfängt, wird die Anforderung anhand der in der Registrierung gespeicherten Sicherheitsinformationen überprüft.</span><span class="sxs-lookup"><span data-stu-id="45c9f-345">When the SCM receives a request to retrieve a COM object, it checks the request against security information that is stored in the registry.</span></span>

<span data-ttu-id="45c9f-346">SCM-Implementierungen bieten in der Regel Registrierungs gesteuerte Konfiguration für die Verwaltung bereitgestellter Klassen und für bestimmte Benutzerkonten auf dem Host.</span><span class="sxs-lookup"><span data-stu-id="45c9f-346">SCM implementations usually offer registry-driven configuration for administering deployed classes and for specific user accounts on the host.</span></span> <span data-ttu-id="45c9f-347">Weitere Informationen finden Sie unter [Activation Security](activation-security.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-347">For more information, see [Activation Security](activation-security.md).</span></span>

<span data-ttu-id="45c9f-348">Die Rückruf Sicherheit wird automatisch angewendet oder von der Anwendung erzwungen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-348">Call security is applied automatically or is enforced by the application.</span></span> <span data-ttu-id="45c9f-349">Wenn die Anwendung Setup Informationen bereitstellt, führt com die erforderlichen Überprüfungen aus, um die Anwendung zu schützen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-349">If the application provides setup information, COM performs the necessary checks to secure the application.</span></span>

<span data-ttu-id="45c9f-350">Der automatische Mechanismus prüft die Sicherheit für den Prozess, jedoch nicht für einzelne Objekte oder Methoden.</span><span class="sxs-lookup"><span data-stu-id="45c9f-350">The automatic mechanism checks security for the process, but not for individual objects or methods.</span></span> <span data-ttu-id="45c9f-351">Wenn eine Anwendung eine präzisere Sicherheit erfordert, bietet com Funktionen, die von Anwendungen verwendet werden können, um eine eigene Sicherheitsüberprüfung durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-351">If an application requires more fine-grained security, COM provides functions that applications may use do their own security checking.</span></span>

<span data-ttu-id="45c9f-352">Die automatischen und benutzerdefinierten Mechanismen können gleichzeitig verwendet werden, sodass eine Anwendung com dazu auffordern kann, eine automatische Sicherheitsüberprüfung durchzuführen und dann eine eigene zu durchführen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-352">The automatic and custom mechanisms can be used together, so an application may ask COM to perform automatic security checking and then perform its own.</span></span>

<span data-ttu-id="45c9f-353">COM-Aufrufe-Sicherheitsdienste sind in die folgenden Kategorien unterteilt:</span><span class="sxs-lookup"><span data-stu-id="45c9f-353">COM call security services are divided into the following categories:</span></span>

-   <span data-ttu-id="45c9f-354">Allgemeine Funktionen, die von Clients und Servern aufgerufen werden, sodass der automatische Sicherheitsmechanismus initialisiert und automatische Authentifizierungsdienste registriert werden können.</span><span class="sxs-lookup"><span data-stu-id="45c9f-354">General functions that are called by both clients and servers, which enable the automatic security mechanism to be initialized and automatic authentication services to be registered.</span></span> <span data-ttu-id="45c9f-355">Die allgemeinen aufrufssicherheits-APIs sind die [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) -und [**coqueryauthenticationservices**](/windows/desktop/api/combaseapi/nf-combaseapi-coqueryauthenticationservices) -Funktionen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-355">The general call security APIs are the [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) and [**CoQueryAuthenticationServices**](/windows/desktop/api/combaseapi/nf-combaseapi-coqueryauthenticationservices) functions.</span></span>
-   <span data-ttu-id="45c9f-356">Schnittstellen auf Client Proxys, die es dem Client ermöglichen, die Sicherheit bei Aufrufen von einzelnen Schnittstellen zu steuern.</span><span class="sxs-lookup"><span data-stu-id="45c9f-356">Interfaces on client proxies, which enable the client to control the security on calls to individual interfaces.</span></span> <span data-ttu-id="45c9f-357">Die [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) -Schnittstelle und die Funktionen " [**coqueryproxyblanket**](/windows/desktop/api/combaseapi/nf-combaseapi-coqueryproxyblanket)", " [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket)" und " [**cocopyproxy**](/windows/desktop/api/combaseapi/nf-combaseapi-cocopyproxy) " bieten die Sicherheit von Aufrufen für ein Remote Objekt.</span><span class="sxs-lookup"><span data-stu-id="45c9f-357">The [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) interface and the [**CoQueryProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-coqueryproxyblanket), [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket), and [**CoCopyProxy**](/windows/desktop/api/combaseapi/nf-combaseapi-cocopyproxy) functions provide call security on a remote object.</span></span>
-   <span data-ttu-id="45c9f-358">Serverseitige Funktionen und Aufruf Kontext Schnittstellen, die dem Server das Abrufen von Sicherheitsinformationen zu einem Aufruf und das Annehmen der Identität des Aufrufers ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-358">Server-side functions and call-context interfaces, which enable the server to retrieve security information about a call and to impersonate the caller.</span></span> <span data-ttu-id="45c9f-359">Die [**IServerSecurity**](/windows/win32/api/objidlbase/nn-objidlbase-iserversecurity) -Schnittstelle und die Funktionen " [**CoGetCallContext**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetcallcontext)", " [**CoImpersonateClient**](/windows/desktop/api/combaseapi/nf-combaseapi-coimpersonateclient)" und " [**corevertstoself**](/windows/desktop/api/combaseapi/nf-combaseapi-coreverttoself) " bieten serverseitige Aufruf Sicherheit.</span><span class="sxs-lookup"><span data-stu-id="45c9f-359">The [**IServerSecurity**](/windows/win32/api/objidlbase/nn-objidlbase-iserversecurity) interface and the [**CoGetCallContext**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetcallcontext), [**CoImpersonateClient**](/windows/desktop/api/combaseapi/nf-combaseapi-coimpersonateclient), and [**CoRevertToSelf**](/windows/desktop/api/combaseapi/nf-combaseapi-coreverttoself) functions provide server-side call security.</span></span>

<span data-ttu-id="45c9f-360">Häufig fragt der Client das COM-Objekt für die [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) -Schnittstelle ab, die lokal von der Remote Schicht implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-360">Often, the client queries the COM object for the [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) interface, which is implemented locally by the remoting layer.</span></span> <span data-ttu-id="45c9f-361">Der Client verwendet diese Schnittstelle, um die Sicherheit einzelner Schnittstellen Proxys auf dem COM-Objekt zu steuern, bevor er eine der Schnittstellen aufruft.</span><span class="sxs-lookup"><span data-stu-id="45c9f-361">The client uses this interface to control the security of individual interface proxies on the COM object before making a call on one of the interfaces.</span></span>

<span data-ttu-id="45c9f-362">Wenn ein Anruf beim Server eingeht, ruft der Server möglicherweise die [**CoGetCallContext**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetcallcontext) -Funktion auf, um eine [**IServerSecurity**](/windows/win32/api/objidlbase/nn-objidlbase-iserversecurity) -Schnittstelle abzurufen, die es dem Server ermöglicht, die Authentifizierung des Clients zu überprüfen und ggf. die Identität des Clients anzunehmen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-362">When a call arrives at the server, the server may call the [**CoGetCallContext**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetcallcontext) function to retrieve an [**IServerSecurity**](/windows/win32/api/objidlbase/nn-objidlbase-iserversecurity) interface, which allows the server to check the client's authentication and to impersonate the client, if necessary.</span></span> <span data-ttu-id="45c9f-363">Das **IServerSecurity** -Objekt ist für die Dauer des Aufrufes gültig.</span><span class="sxs-lookup"><span data-stu-id="45c9f-363">The **IServerSecurity** object is valid for the duration of the call.</span></span>

<span data-ttu-id="45c9f-364">Ruft die [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) -Funktion auf, um die Sicherheitsebene zu initialisieren und die angegebenen Werte als Sicherheitsstandard festzulegen.</span><span class="sxs-lookup"><span data-stu-id="45c9f-364">Call the [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) function to initialize the security layer and set the specified values as the security default.</span></span> <span data-ttu-id="45c9f-365">Wenn ein Prozess nicht **CoInitializeSecurity** aufruft, ruft com ihn automatisch auf, wenn eine Schnittstelle zum ersten Mal gemarshallt oder gemarshallt wird. dabei wird die System Standard Sicherheit registriert.</span><span class="sxs-lookup"><span data-stu-id="45c9f-365">If a process does not call **CoInitializeSecurity**, COM calls it automatically the first time an interface is marshaled or unmarshaled, registering the system default security.</span></span> <span data-ttu-id="45c9f-366">Die **CoInitializeSecurity** -Funktion ermöglicht es dem Client, eine standardmäßige aufrufssicherheit für den Prozess einzurichten, wodurch die Verwendung von [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) in einzelnen Proxys vermieden wird.</span><span class="sxs-lookup"><span data-stu-id="45c9f-366">The **CoInitializeSecurity** function allows the client to establish default call security for the process, which avoids the use of [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) on individual proxies.</span></span> <span data-ttu-id="45c9f-367">Die **CoInitializeSecurity** -Funktion ermöglicht es einem Server, automatische Authentifizierungsdienste für den Prozess zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="45c9f-367">The **CoInitializeSecurity** function enables a server to register automatic authentication services for the process.</span></span> <span data-ttu-id="45c9f-368">Weitere Informationen finden Sie unter [festlegen Process-Wide Sicherheit mit CoInitializeSecurity](setting-processwide-security-with-coinitializesecurity.md).</span><span class="sxs-lookup"><span data-stu-id="45c9f-368">For more information, see [Setting Process-Wide Security with CoInitializeSecurity](setting-processwide-security-with-coinitializesecurity.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="45c9f-369">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="45c9f-369">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="45c9f-370">COM-Clients und-Server</span><span class="sxs-lookup"><span data-stu-id="45c9f-370">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="45c9f-371">Definieren von COM-Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="45c9f-371">Defining COM Interfaces</span></span>](defining-com-interfaces.md)
</dt> <dt>

[<span data-ttu-id="45c9f-372">Registrieren von com-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="45c9f-372">Registering COM Applications</span></span>](registering-com-applications.md)
</dt> <dt>

[<span data-ttu-id="45c9f-373">Sicherheit in com</span><span class="sxs-lookup"><span data-stu-id="45c9f-373">Security in COM</span></span>](security-in-com.md)
</dt> <dt>

[<span data-ttu-id="45c9f-374">Prozesse, Threads und Apartments</span><span class="sxs-lookup"><span data-stu-id="45c9f-374">Processes, Threads, and Apartments</span></span>](processes--threads--and-apartments.md)
</dt> </dl>

 

 
