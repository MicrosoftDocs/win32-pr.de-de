---
title: Verwenden von IConnectionPointContainer
description: Verwenden von IConnectionPointContainer
ms.assetid: a87afb25-4d45-4ce2-9b27-840da5107bce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4d0b7c691e1ba6a8445af56978b43a2ccbf33e7
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/29/2020
ms.locfileid: "106341701"
---
# <a name="using-iconnectionpointcontainer"></a><span data-ttu-id="1a249-103">Verwenden von IConnectionPointContainer</span><span class="sxs-lookup"><span data-stu-id="1a249-103">Using IConnectionPointContainer</span></span>

<span data-ttu-id="1a249-104">Ein Verbindungs fähigen-Objekt implementiert [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (und macht es über [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))verfügbar), um anzugeben, dass ausgehende Schnittstellen vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="1a249-104">A connectable object implements [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (and exposes it through [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))) to indicate the existence of outgoing interfaces.</span></span> <span data-ttu-id="1a249-105">Für jede ausgehende Schnittstelle verwaltet das Verbindungs fähigen-Objekt ein Verbindungspunkt-unter Objekt, das [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint)implementiert.</span><span class="sxs-lookup"><span data-stu-id="1a249-105">For each outgoing interface, the connectable object manages a connection point sub-object, which itself implements [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint).</span></span> <span data-ttu-id="1a249-106">Das Verbindungs fähigen-Objekt enthält daher die Verbindungspunkte, daher die Benennung von **IConnectionPointContainer** und **IConnectionPoint**.</span><span class="sxs-lookup"><span data-stu-id="1a249-106">The connectable object therefore contains the connection points, hence the naming of **IConnectionPointContainer** and **IConnectionPoint**.</span></span>

<span data-ttu-id="1a249-107">Über [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)kann ein Client zwei Vorgänge ausführen.</span><span class="sxs-lookup"><span data-stu-id="1a249-107">Through [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer), a client can perform two operations.</span></span> <span data-ttu-id="1a249-108">Wenn der Client bereits über die IID für eine ausgehende Schnittstelle verfügt, die er unterstützt, kann er zunächst den entsprechenden Verbindungspunkt für die IID mithilfe von [**IConnectionPointContainer:: FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint)finden.</span><span class="sxs-lookup"><span data-stu-id="1a249-108">First, if the client already has the IID for an outgoing interface that it supports, it can locate the corresponding connection point for the IID using [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span> <span data-ttu-id="1a249-109">Der Client kann den Verbindungspunkt nicht direkt Abfragen, weil die Container/enthaltene Beziehung zwischen dem Verbindungs fähigen-Objekt und den darin enthaltenen Verbindungs Punkten besteht.</span><span class="sxs-lookup"><span data-stu-id="1a249-109">The client cannot query for the connection point directly because of the container/contained relationship between the connectable object and its contained connection points.</span></span> <span data-ttu-id="1a249-110">Im Grunde ist **FindConnectionPoint** die [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) für ausgehende Schnittstellen, wenn die IID dem Client bekannt ist.</span><span class="sxs-lookup"><span data-stu-id="1a249-110">Basically, **FindConnectionPoint** is the [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for outgoing interfaces when the IID is known to the client.</span></span>

<span data-ttu-id="1a249-111">Zweitens kann der Client alle Verbindungspunkte innerhalb des Verbindungs fähigen Objekts über [**IConnectionPointContainer:: EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints)auflisten.</span><span class="sxs-lookup"><span data-stu-id="1a249-111">Second, the client can enumerate all connection points within the connectable object through [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="1a249-112">Diese Methode gibt einen [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) -Schnittstellen Zeiger für ein separates Enumeratorobjekt zurück.</span><span class="sxs-lookup"><span data-stu-id="1a249-112">This method returns an [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) interface pointer for a separate enumerator object.</span></span> <span data-ttu-id="1a249-113">Über [**IEnumConnectionPoints:: Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next)kann der Client [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) -Schnittstellen Zeiger auf jeden Verbindungspunkt abrufen.</span><span class="sxs-lookup"><span data-stu-id="1a249-113">Through [**IEnumConnectionPoints::Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next), the client can obtain [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface pointers to each connection point.</span></span>

<span data-ttu-id="1a249-114">Nachdem der Client die [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) -Schnittstelle abgerufen hat, muss er [**IConnectionPoint:: GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) aufrufen, um die IID der ausgehenden Schnittstelle zu ermitteln, die von den einzelnen Verbindungs Punkten unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="1a249-114">After the client obtains the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface, it must call [**IConnectionPoint::GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) to determine the IID of the outgoing interface supported by each connection point.</span></span> <span data-ttu-id="1a249-115">Wenn der Client diese ausgehende Schnittstelle bereits unterstützt, kann er eine Verbindung herstellen.</span><span class="sxs-lookup"><span data-stu-id="1a249-115">If the client already supports that outgoing interface, it can establish a connection.</span></span> <span data-ttu-id="1a249-116">Andernfalls kann die ausgehende Schnittstelle weiterhin unterstützt werden, indem Informationen aus der Typbibliothek des Verbindungs fähigen-Objekts verwendet werden, um zur Laufzeit Unterstützung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="1a249-116">Otherwise, it may still be able to support the outgoing interface by using information from the connectable object's type library to provide support at run time.</span></span> <span data-ttu-id="1a249-117">Diese Technik erfordert, dass das Verbindungs fähigen-Objekt die [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) -Schnittstelle unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1a249-117">This technique requires that the connectable object support the [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) interface.</span></span> <span data-ttu-id="1a249-118">(Weitere Informationen finden [Sie unter Verwenden von IProvideClassInfo](using-iprovideclassinfo.md).)</span><span class="sxs-lookup"><span data-stu-id="1a249-118">(See [Using IProvideClassInfo](using-iprovideclassinfo.md).)</span></span>

<span data-ttu-id="1a249-119">Da der Enumerator ein separates Objekt ist, muss der Client **IEnumConnectionPoints:: Release** abrufen, wenn der Enumerator nicht mehr benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="1a249-119">Because the enumerator is a separate object, the client must call **IEnumConnectionPoints::Release** when the enumerator is no longer needed.</span></span> <span data-ttu-id="1a249-120">Außerdem ist jeder Verbindungspunkt ein Objekt mit einem separaten Verweis Zähler aus dem enthaltenden Verbindungs fähigen-Objekt.</span><span class="sxs-lookup"><span data-stu-id="1a249-120">In addition, each connection point is an object with a separate reference count from the containing connectable object.</span></span> <span data-ttu-id="1a249-121">Daher muss der Client auch IConnectionPoint:: Release für jeden Verbindungspunkt aufrufen, auf den über den Enumerator oder durch [**FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint)zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="1a249-121">Therefore, the client must also call IConnectionPoint::Release for each connection point accessed either through the enumerator or through [**FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1a249-122">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1a249-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1a249-123">Verbindungs fähige Objekt Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="1a249-123">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




