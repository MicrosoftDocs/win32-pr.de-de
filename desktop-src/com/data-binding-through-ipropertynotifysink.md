---
title: Datenbindung über IPropertyNotifySink
description: Datenbindung über IPropertyNotifySink
ms.assetid: 275a84b3-65d8-43de-bfba-72e3e5ee59fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d39c7277d27f0df6c185fc35a926aa98b77b91a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "103714262"
---
# <a name="data-binding-through-ipropertynotifysink"></a><span data-ttu-id="efd6f-103">Datenbindung über IPropertyNotifySink</span><span class="sxs-lookup"><span data-stu-id="efd6f-103">Data Binding through IPropertyNotifySink</span></span>

<span data-ttu-id="efd6f-104">Objekte, die Eigenschaften unterstützen, z. b. über die OLE-Automatisierung und die **IDispatch** -Schnittstelle, möchten möglicherweise, dass Clients benachrichtigt werden, wenn bestimmte Eigenschaften den Wert ändern.</span><span class="sxs-lookup"><span data-stu-id="efd6f-104">Objects that support properties, for example, through OLE Automation and the **IDispatch** interface, may want to allow clients to be notified when certain properties change value.</span></span> <span data-ttu-id="efd6f-105">Eine solche Eigenschaft wird als bindbare Eigenschaft bezeichnet, da die Benachrichtigungen es einem Client ermöglichen, seine eigene Anzeige der aktuellen Eigenschaftswerte des Objekts zu synchronisieren.</span><span class="sxs-lookup"><span data-stu-id="efd6f-105">Such a property is called a bindable property because the notifications allow a client to synchronize its own display of the object's current property values.</span></span> <span data-ttu-id="efd6f-106">Außerdem kann es sein, dass ein Client die gleichen Objekte steuern kann, wenn bestimmte Eigenschaften geändert werden dürfen.</span><span class="sxs-lookup"><span data-stu-id="efd6f-106">In addition, the same objects may wish to allow a client to control when certain properties are allowed to change.</span></span> <span data-ttu-id="efd6f-107">Diese Eigenschaften werden als Eigenschaften für die Anforderungs Bearbeitung bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="efd6f-107">Such properties are called request edit properties.</span></span>

<span data-ttu-id="efd6f-108">[**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) ist eine Standard Benachrichtigungs Schnittstelle, die bindbare und Anforderungs Bearbeitungseigenschaften unterstützt.</span><span class="sxs-lookup"><span data-stu-id="efd6f-108">The [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) is a standard notification interface that supports bindable and request-edit properties.</span></span> <span data-ttu-id="efd6f-109">**IPropertyNotifySink** wird von einem Objekt mit Eigenschaften als ausgehende Schnittstelle unterstützt.</span><span class="sxs-lookup"><span data-stu-id="efd6f-109">**IPropertyNotifySink** is supported from an object with properties as an outgoing interface.</span></span> <span data-ttu-id="efd6f-110">Das heißt, die Schnittstelle selbst wird durch das Senkenobjekt eines Clients implementiert, und der Client verbindet die Senke über den zuvor beschriebenen Verbindungspunkt Mechanismus mit dem unterstützenden Objekt.</span><span class="sxs-lookup"><span data-stu-id="efd6f-110">That is, the interface itself is implemented by a client's sink object, and the client connects the sink to the supporting object through the connection point mechanism described earlier.</span></span> <span data-ttu-id="efd6f-111">**IPropertyNotifySink** ist wie folgt definiert:</span><span class="sxs-lookup"><span data-stu-id="efd6f-111">The **IPropertyNotifySink** is defined as follows:</span></span>

``` syntax
interface IPropertyNotifySink : IUnknown 
  { 
    HRESULT OnChanged([in] DISPID dispID); 
    HRESULT OnRequestEdit([in] DISPID dispID); 
  } 
 
```

<span data-ttu-id="efd6f-112">Wenn ein Objekt seine verbundenen senken Benachrichtigen möchte, dass eine bindbare Eigenschaft, die mit einer bestimmten DISPID identifiziert wurde, geändert wurde, ruft es [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged)auf.</span><span class="sxs-lookup"><span data-stu-id="efd6f-112">When an object wishes to notify its connected sinks that a bindable property identified with a given DISPID has changed, it calls [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="efd6f-113">Wenn ein Objekt mehrere Eigenschaften gleichzeitig ändert, kann es "DISPID \_ unknown" an " **OnChanged** " übergeben. in diesem Fall aktualisiert der Client den Cache aller Eigenschaftswerte, die von Interesse sind.</span><span class="sxs-lookup"><span data-stu-id="efd6f-113">If an object changes multiple properties at once, it can pass DISPID\_UNKNOWN to **OnChanged** in which case a client refreshes its cache of all property values of interest.</span></span>

<span data-ttu-id="efd6f-114">Wenn eine Eigenschaft zum Bearbeiten der Anforderung geändert wird, kann ein Objekt den Client bitten, den Client so zu ändern, dass er diese Änderung zulässt.</span><span class="sxs-lookup"><span data-stu-id="efd6f-114">When a request edit property is about to change, an object can ask the client whether it will allow that change to occur.</span></span> <span data-ttu-id="efd6f-115">Das Objekt ruft [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) auf und übergibt die DispID der fraglichen Eigenschaft (oder DISPID \_ unbekannt, um alle Eigenschaften zu identifizieren).</span><span class="sxs-lookup"><span data-stu-id="efd6f-115">The object calls [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) passing the DISPID of the property in question (or DISPID\_UNKNOWN to identify all properties).</span></span> <span data-ttu-id="efd6f-116">Die Senke des Clients gibt s \_ OK zurück, um anzugeben, dass die Änderung zulässig ist, oder s \_ false (oder einen Fehler), um anzugeben, dass eine Änderung nicht zulässig ist.</span><span class="sxs-lookup"><span data-stu-id="efd6f-116">The client's sink returns S\_OK to indicate that the change is allowed, or S\_FALSE (or an error) to indicate that change is not allowed.</span></span> <span data-ttu-id="efd6f-117">Wenn ein Objekt **OnRequestEdit** aufruft, müssen die Anforderungen des Clients befolgt werden, indem die genaue Semantik der ' false ' \_ -und ' \_ false '-Rückgabewerte befolgt wird.</span><span class="sxs-lookup"><span data-stu-id="efd6f-117">When an object calls **OnRequestEdit**, it is required to obey the client's wishes by following the exact semantics of S\_OK and S\_FALSE return values.</span></span>

<span data-ttu-id="efd6f-118">Beachten Sie, dass " [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) " nicht zur Datenüberprüfung verwendet werden kann, da der neue Wert der Eigenschaft zum Zeitpunkt des Aufrufes noch nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="efd6f-118">Note that [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) cannot be used for data validation because at the time of the call, the new value of the property is not yet available.</span></span> <span data-ttu-id="efd6f-119">Die Benachrichtigung kann nur zum Steuern eines schreibgeschützten Zustands für eine Eigenschaft verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="efd6f-119">The notification can only be used to control a read-only state for a property.</span></span>

<span data-ttu-id="efd6f-120">-Objekte steuern, welche Eigenschaften gebunden werden können und wie Sie diese Eigenschaften in den Typinformationen des Objekts bearbeiten und markieren.</span><span class="sxs-lookup"><span data-stu-id="efd6f-120">Objects control which properties are bindable and request edit and mark such properties in the object's type information.</span></span> <span data-ttu-id="efd6f-121">In den Typinformationen markiert das Attribut bindbare eine Eigenschaft als Unterstützung von [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="efd6f-121">In the type information, the attribute bindable marks a property as supporting [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="efd6f-122">Das Attribut requestedit markiert eine Eigenschaft als Unterstützung von [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span><span class="sxs-lookup"><span data-stu-id="efd6f-122">The attribute requestedit marks a property as supporting [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span></span>

<span data-ttu-id="efd6f-123">Eine Eigenschaft kann beide Verhalten unterstützen. in diesem Fall wird [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) zuerst aufgerufen, und nur wenn die Änderung zulässig ist, wird " [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) " aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="efd6f-123">One property can support both behaviors in which case [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) is called first, and only if change is allowed is [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) called.</span></span>

<span data-ttu-id="efd6f-124">Die einzige Ausnahme beim Verhalten solcher Eigenschaften besteht darin, dass keine Benachrichtigungen als Ergebnis der Initialisierungs-oder lade Prozeduren eines Objekts gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="efd6f-124">The one exception to the behavior of such properties is that no notifications are sent as a result of an object's initialization or loading procedures.</span></span> <span data-ttu-id="efd6f-125">Dabei wird davon ausgegangen, dass alle Eigenschaften geändert werden und dass alle geändert werden dürfen.</span><span class="sxs-lookup"><span data-stu-id="efd6f-125">At such times, it is assumed that all properties change and that all must be allowed to change.</span></span> <span data-ttu-id="efd6f-126">Benachrichtigungen an diese Schnittstelle sind daher nur im Kontext eines vollständig initialisierten/geladenen Objekts sinnvoll.</span><span class="sxs-lookup"><span data-stu-id="efd6f-126">Notifications to this interface are therefore only meaningful in the context of a fully initialized/loaded object.</span></span>

<span data-ttu-id="efd6f-127">Zwei weitere Attribute können auf Eigenschaften in den Typinformationen eines Objekts angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="efd6f-127">Two other attributes can be applied to properties in an object's type information.</span></span> <span data-ttu-id="efd6f-128">Das Defaultbind-Attribut kennzeichnet eine bindbare Eigenschaft als eine Eigenschaft, die den Status des Objekts als Ganzes am besten darstellt.</span><span class="sxs-lookup"><span data-stu-id="efd6f-128">The defaultbind attribute marks a bindable property as being the one that best represents the state of the object as a whole.</span></span> <span data-ttu-id="efd6f-129">Das Display BIND-Attribut markiert eine bindbare Eigenschaft, die für die Anzeige in der eigenen Benutzeroberfläche eines Clients geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="efd6f-129">The displaybind attribute marks a bindable property as suitable for display in a client's own user interface.</span></span>

## <a name="related-topics"></a><span data-ttu-id="efd6f-130">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="efd6f-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="efd6f-131">Eigenschaften Seiten und Eigenschaften Blätter</span><span class="sxs-lookup"><span data-stu-id="efd6f-131">Property Pages and Property Sheets</span></span>](property-pages-and-property-sheets.md)
</dt> </dl>

 

 




