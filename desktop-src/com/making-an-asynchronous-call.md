---
title: Ausführen eines asynchronen Aufrufes
description: Die Vorgehensweise zum Ausführen eines synchronen Aufrufs besteht darin, dass der Client einen Schnittstellen Zeiger auf das Server Objekt erhält und Methoden über diesen Zeiger aufruft. Der asynchrone Aufruf umfasst ein Call-Objekt und umfasst daher einige weitere Schritte.
ms.assetid: ab65d38d-836a-48d4-87c1-8812cbc8ff92
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22dcd7a6509cd07e12357a96222baa04f9e4c942
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104391083"
---
# <a name="making-an-asynchronous-call"></a><span data-ttu-id="0e8f8-104">Ausführen eines asynchronen Aufrufes</span><span class="sxs-lookup"><span data-stu-id="0e8f8-104">Making an Asynchronous Call</span></span>

<span data-ttu-id="0e8f8-105">Die Vorgehensweise zum Ausführen eines synchronen Aufrufs ist unkompliziert: der Client ruft einen Schnittstellen Zeiger auf das Server Objekt ab und ruft Methoden über diesen Zeiger auf.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-105">The procedure for making a synchronous call is straightforward: The client obtains an interface pointer on the server object and calls methods through that pointer.</span></span> <span data-ttu-id="0e8f8-106">Der asynchrone Aufruf umfasst ein Call-Objekt und umfasst daher einige weitere Schritte.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-106">Asynchronous calling involves a call object, so it involves a few more steps.</span></span>

<span data-ttu-id="0e8f8-107">Für jede Methode in einer synchronen Schnittstelle implementiert die zugehörige asynchrone Schnittstelle zwei Methoden.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-107">For each method on a synchronous interface, the corresponding asynchronous interface implements two methods.</span></span> <span data-ttu-id="0e8f8-108">Diese Methoden fügen die Präfixe "BEGIN" \_ und "Finish" \_ an den Namen der synchronen Methode an.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-108">These methods attach the prefixes Begin\_ and Finish\_ to the name of the synchronous method.</span></span> <span data-ttu-id="0e8f8-109">Wenn eine Schnittstelle mit dem Namen isimplestream z. b. über eine Read-Methode verfügt, verfügt die asyncisimplestream-Schnittstelle über die Read \_ -Methode Begin und Finish Read \_ .</span><span class="sxs-lookup"><span data-stu-id="0e8f8-109">For example, if an interface named ISimpleStream has a Read method, the AsyncISimpleStream interface will have a Begin\_Read and a Finish\_Read method.</span></span> <span data-ttu-id="0e8f8-110">Zum Starten eines asynchronen Aufrufs ruft der Client die BEGIN- \_ Methode auf.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-110">To begin an asynchronous call, the client calls the Begin\_ method.</span></span>

<span data-ttu-id="0e8f8-111">**So beginnen Sie einen asynchronen Aufrufvorgang**</span><span class="sxs-lookup"><span data-stu-id="0e8f8-111">**To begin an asynchronous call**</span></span>

1.  <span data-ttu-id="0e8f8-112">Fragen Sie das Server Objekt für die [**icallfactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) -Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-112">Query the server object for the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface.</span></span> <span data-ttu-id="0e8f8-113">Wenn [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) E \_ nointerface zurückgibt, unterstützt das Server Objekt keinen asynchronen Aufruf.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-113">If [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) returns E\_NOINTERFACE, the server object does not support asynchronous calling.</span></span>

2.  <span data-ttu-id="0e8f8-114">Rufen Sie [**icallfactory:: kreatecall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall) auf, um ein Aufruf Objekt zu erstellen, das der gewünschten Schnittstelle entspricht, und geben Sie dann den Zeiger auf [**icallfactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory)frei.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-114">Call [**ICallFactory::CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall) to create a call object corresponding to the interface you want, and then release the pointer to [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory).</span></span>

3.  <span data-ttu-id="0e8f8-115">Wenn Sie keinen Zeiger auf die asynchrone Schnittstelle aus dem Aufrufen von " [**anatecall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall)" angefordert haben, Fragen Sie das calljekt für die asynchrone Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-115">If you did not request a pointer to the asynchronous interface from the call to [**CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), query the call object for the asynchronous interface.</span></span>

4.  <span data-ttu-id="0e8f8-116">Ruft die entsprechende BEGIN- \_ Methode auf.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-116">Call the appropriate Begin\_ method.</span></span>

<span data-ttu-id="0e8f8-117">Das Server Objekt verarbeitet nun den asynchronen-Befehl, und der Client kann andere Aufgaben ausführen, bis die Ergebnisse des Aufrufes benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-117">The server object is now processing the asynchronous call, and the client is free to do other work until it needs the results of the call.</span></span>

<span data-ttu-id="0e8f8-118">Ein Aufruf Objekt kann jeweils nur einen asynchronen Aufruf verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-118">A call object can process only one asynchronous call at a time.</span></span> <span data-ttu-id="0e8f8-119">Wenn derselbe oder ein zweiter Client eine BEGIN- \_ Methode aufruft, bevor ein ausstehender asynchroner Aufruf abgeschlossen ist, gibt die BEGIN- \_ Methode einen ausstehenden RPC-E- \_ \_ Aufruf \_ aus.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-119">If the same or a second client calls a Begin\_ method before a pending asynchronous call is finished, the Begin\_ method will return RPC\_E\_CALL\_PENDING.</span></span>

<span data-ttu-id="0e8f8-120">Wenn der Client die Ergebnisse der Begin-Methode nicht benötigt \_ , kann er das-Rückruf Objekt am Ende dieses Verfahrens freigeben.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-120">If the client does not need the results of the Begin\_ method, it can release the call object at the end of this procedure.</span></span> <span data-ttu-id="0e8f8-121">COM erkennt diese Bedingung und bereinigt den-Befehl.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-121">COM detects this condition and cleans up the call.</span></span> <span data-ttu-id="0e8f8-122">Die Finish \_ -Methode wird nicht aufgerufen, und der Client ruft keine out-Parameter oder einen Rückgabewert ab.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-122">The Finish\_ method is not called, and the client does not get any out parameters or a return value.</span></span>

<span data-ttu-id="0e8f8-123">Wenn das Server Objekt bereit ist, von der BEGIN- \_ Methode zurückzukehren, signalisiert es dem aufzurufenden-Objekt.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-123">When the server object is ready to return from the Begin\_ method, it signals the call object that it is done.</span></span> <span data-ttu-id="0e8f8-124">Wenn der Client bereit ist, wird überprüft, ob das Objekt des Aufrufes signalisiert wurde.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-124">When the client is ready, it checks to see whether the call object has been signaled.</span></span> <span data-ttu-id="0e8f8-125">Wenn dies der Fall ist, kann der Client den asynchronen-Aufrufvorgang beenden.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-125">If so, the client can complete the asynchronous call.</span></span>

<span data-ttu-id="0e8f8-126">Der Mechanismus für diese Signalisierung und Prüfung zwischen Client und Server ist die [**isynchronize**](/windows/win32/api/objidlbase/nn-objidlbase-isynchronize) -Schnittstelle für das calljekt.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-126">The mechanism for this signaling and checking between client and server is the [**ISynchronize**](/windows/win32/api/objidlbase/nn-objidlbase-isynchronize) interface on the call object.</span></span> <span data-ttu-id="0e8f8-127">Das callsobjekt implementiert diese Schnittstelle normalerweise durch aggregierten eines vom System bereitgestellten Synchronisierungs Objekts.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-127">The call object normally implements this interface by aggregating a system-supplied synchronization object.</span></span> <span data-ttu-id="0e8f8-128">Das Synchronisierungs Objekt umschließt ein Ereignis handle, das der Server unmittelbar vor der Rückgabe von der Begin-Methode anzeigt, \_ indem [**isynchronize:: Signal**](/windows/win32/api/objidlbase/nf-objidlbase-isynchronize-signal)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-128">The synchronization object wraps an event handle, which the server signals just before returning from the Begin\_ method by calling [**ISynchronize::Signal**](/windows/win32/api/objidlbase/nf-objidlbase-isynchronize-signal).</span></span>

<span data-ttu-id="0e8f8-129">**So vervollständigen Sie einen asynchronen-Befehl**</span><span class="sxs-lookup"><span data-stu-id="0e8f8-129">**To complete an asynchronous call**</span></span>

1.  <span data-ttu-id="0e8f8-130">Fragen Sie das calltobjekt für die [**isynchronize**](/windows/win32/api/objidlbase/nn-objidlbase-isynchronize) -Schnittstelle ab.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-130">Query the call object for the [**ISynchronize**](/windows/win32/api/objidlbase/nn-objidlbase-isynchronize) interface.</span></span>

2.  <span data-ttu-id="0e8f8-131">Nennen Sie [**isynchronize:: Wait**](/windows/win32/api/objidlbase/nf-objidlbase-isynchronize-wait).</span><span class="sxs-lookup"><span data-stu-id="0e8f8-131">Call [**ISynchronize::Wait**](/windows/win32/api/objidlbase/nf-objidlbase-isynchronize-wait).</span></span>

3.  <span data-ttu-id="0e8f8-132">Wenn der [**warte**](/windows/win32/api/objidlbase/nf-objidlbase-isynchronize-wait) Vorgang RPC \_ E Timeout zurückgibt \_ , ist die Verarbeitung der BEGIN- \_ Methode noch nicht abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-132">If [**Wait**](/windows/win32/api/objidlbase/nf-objidlbase-isynchronize-wait) returns RPC\_E\_TIMEOUT, the Begin\_ method is not finished processing.</span></span> <span data-ttu-id="0e8f8-133">Der Client kann mit anderen Arbeiten fortfahren und später erneut auf den **warte Vorgang warten** .</span><span class="sxs-lookup"><span data-stu-id="0e8f8-133">The client can continue with other work and call **Wait** again later.</span></span> <span data-ttu-id="0e8f8-134">Die "Finish"-Methode kann erst aufgerufen werden, \_ Wenn der **warte** Vorgang OK zurückgibt \_</span><span class="sxs-lookup"><span data-stu-id="0e8f8-134">It cannot call the Finish\_ method until **Wait** returns S\_OK.</span></span>

    <span data-ttu-id="0e8f8-135">Wenn [**Wait**](/windows/win32/api/objidlbase/nf-objidlbase-isynchronize-wait) den Wert S OK zurückgibt \_ , hat die BEGIN- \_ Methode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-135">If [**Wait**](/windows/win32/api/objidlbase/nf-objidlbase-isynchronize-wait) returns S\_OK, the Begin\_ method has returned.</span></span> <span data-ttu-id="0e8f8-136">Ruft die entsprechende Finish- \_ Methode auf.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-136">Call the appropriate Finish\_ method.</span></span>

<span data-ttu-id="0e8f8-137">Die \_ Methode Finish übergibt den Client alle out-Parameter.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-137">The Finish\_ method passes the client any out parameters.</span></span> <span data-ttu-id="0e8f8-138">Das Verhalten der asynchronen Methoden, einschließlich des Rückgabewerts der Finish- \_ Methode, sollte genau mit der der entsprechenden synchronen Methode übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-138">The behavior of the asynchronous methods, including the return value of the Finish\_ method, should match exactly that of the corresponding synchronous method.</span></span>

<span data-ttu-id="0e8f8-139">Der Client kann das Aufruf Objekt freigeben, sobald die Methode "Finish" \_ zurückgibt, oder es kann einen Zeiger auf das Aufruf Objekt enthalten, um zusätzliche Aufrufe durchführen zu können.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-139">The client can release the call object as soon as the Finish\_ method returns, or it can hold a pointer to the call object to make additional calls.</span></span> <span data-ttu-id="0e8f8-140">In beiden Fällen ist der Client für die Freigabe des calljektobjekts verantwortlich, wenn das Objekt nicht mehr benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-140">In either case, the client is responsible for releasing the call object when the object is no longer needed.</span></span>

<span data-ttu-id="0e8f8-141">Wenn Sie eine Finish- \_ Methode aufgerufen werden, wenn kein Aufruf ausgeführt wird, gibt die Methode den RPC- \_ E- \_ Aufruf \_ Complete zurück.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-141">If you call a Finish\_ method when no call is in progress, the method will return RPC\_E\_CALL\_COMPLETE.</span></span>

> [!Note]  
> <span data-ttu-id="0e8f8-142">Wenn sich die Client-und Server Objekte im selben Apartment befinden, ist der Aufruf von [**icallfactory:: | atecall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall) nicht garantiert.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-142">If the client and server objects are in the same apartment, calls to [**ICallFactory::CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall) are not guaranteed to succeed.</span></span> <span data-ttu-id="0e8f8-143">Wenn das Server Objekt keinen asynchronen Aufruf für eine bestimmte Schnittstelle unterstützt, schlägt der Versuch, ein Call-Objekt zu erstellen, fehl, und der Client muss die synchrone-Schnittstelle verwenden.</span><span class="sxs-lookup"><span data-stu-id="0e8f8-143">If the server object does not support asynchronous calling on a particular interface, the attempt to create a call object will fail and the client must use the synchronous interface.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="0e8f8-144">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="0e8f8-144">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0e8f8-145">Abbrechen eines asynchronen Aufrufes</span><span class="sxs-lookup"><span data-stu-id="0e8f8-145">Canceling an Asynchronous Call</span></span>](canceling-an-asynchronous-call.md)
</dt> <dt>

[<span data-ttu-id="0e8f8-146">Client Sicherheit während eines asynchronen Aufrufes</span><span class="sxs-lookup"><span data-stu-id="0e8f8-146">Client Security During an Asynchronous Call</span></span>](client-security-during-an-asynchronous-call.md)
</dt> <dt>

[<span data-ttu-id="0e8f8-147">Identitätswechsel und asynchrone Aufrufe</span><span class="sxs-lookup"><span data-stu-id="0e8f8-147">Impersonation and Asynchronous Calls</span></span>](impersonation-and-asynchronous-calls.md)
</dt> </dl>

 

 