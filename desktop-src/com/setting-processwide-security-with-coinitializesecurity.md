---
title: Festlegen der Process-Wide Sicherheit mit CoInitializeSecurity
description: Mit der CoInitializeSecurity-Funktion können Sie komplexe Sicherheitsszenarien steuern, indem Sie die Sicherheit für eine Anwendung Programm gesteuert festlegen.
ms.assetid: 20b66868-fb9a-489f-97a2-59a8a825c8d9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 567a6dfaf47dbd278fc248558cd25969c733b24a
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104391076"
---
# <a name="setting-process-wide-security-with-coinitializesecurity"></a><span data-ttu-id="47336-103">Festlegen der Process-Wide Sicherheit mit CoInitializeSecurity</span><span class="sxs-lookup"><span data-stu-id="47336-103">Setting Process-Wide Security with CoInitializeSecurity</span></span>

<span data-ttu-id="47336-104">Mit der [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) -Funktion können Sie komplexe Sicherheitsszenarien steuern, indem Sie die Sicherheit für eine Anwendung Programm gesteuert festlegen.</span><span class="sxs-lookup"><span data-stu-id="47336-104">The [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) function allows you to control complex security scenarios by setting security for an application programmatically.</span></span> <span data-ttu-id="47336-105">In diesem Thema werden Szenarien beschrieben, in denen **CoInitializeSecurity** verwendet werden kann, und es werden einige Details zur Verwendung beschrieben.</span><span class="sxs-lookup"><span data-stu-id="47336-105">This topic describes scenarios when you might use **CoInitializeSecurity** and provides some details on how you use it.</span></span>

<span data-ttu-id="47336-106">Es gibt mehrere Gründe, warum Sie [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) verwenden möchten, um die Prozess weite Sicherheit innerhalb des Programms festzulegen.</span><span class="sxs-lookup"><span data-stu-id="47336-106">There are several reasons why you might want to use [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to set process-wide security within your program.</span></span> <span data-ttu-id="47336-107">Obwohl Sie die Authentifizierungs Ebene und die Zugriffsberechtigungen für die Anwendung mithilfe von dcomcnfg.exe festlegen können, ist die standardmäßige Identitätswechsel Ebene für den Computer möglicherweise nicht die für den Prozess gewünschte.</span><span class="sxs-lookup"><span data-stu-id="47336-107">For example, although you can set the authentication level and the access permissions for the application using dcomcnfg.exe, the default impersonation level for the computer might not be the one you want for your process.</span></span> <span data-ttu-id="47336-108">Die einzige Möglichkeit, diese Einstellung für Ihren Prozess zu ändern, besteht darin, **CoInitializeSecurity** aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="47336-108">The only way to change this setting for your process is to call **CoInitializeSecurity**.</span></span>

<span data-ttu-id="47336-109">Wenn Sie den SChannel-Sicherheitsanbieter verwenden möchten, müssen Sie ihn in einem [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity)-Rückruf als Authentifizierungsdienst angeben.</span><span class="sxs-lookup"><span data-stu-id="47336-109">If you want to use the Schannel security provider, you must specify it as an authentication service in a call to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity).</span></span>

<span data-ttu-id="47336-110">Ein weiteres häufiges Szenario, in dem Sie die Prozess weite Sicherheit Programm gesteuert festlegen können, ist, wenn Sie die Standard Sicherheit für den gesamten Prozess festlegen möchten, aber über ein oder mehrere Objekte innerhalb dieses Prozesses verfügen, die Schnittstellen mit speziellen Sicherheitsanforderungen verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="47336-110">Another common scenario in which you might set process-wide security programmatically is when you would like to set default security for the entire process but you have one or more objects within that process that expose interfaces with special security requirements.</span></span> <span data-ttu-id="47336-111">In diesem Fall können Sie [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) so einrichten, dass die Sicherheit für den Prozess festgelegt wird, sodass com den größten Teil der Sicherheitsüberprüfungen ermöglicht und andere Methoden aufgerufen werden können, um die Sicherheit für die Objekte mit speziellen Sicherheitsanforderungen festzulegen.</span><span class="sxs-lookup"><span data-stu-id="47336-111">In this case, you can call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to set security for the process, allowing COM to handle most of the security checks, and you can call other methods to set security for the objects with special security needs.</span></span> <span data-ttu-id="47336-112">Das Aufrufen dieser Methoden und Funktionen wird unter [Festlegen der Sicherheit auf der Ebene der Schnittstellen Proxys](setting-security-at-the-interface-proxy-level.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="47336-112">Calling these methods and functions is described in [Setting Security at the Interface Proxy Level](setting-security-at-the-interface-proxy-level.md).</span></span>

<span data-ttu-id="47336-113">Wenn Ihre Anwendung über sehr spezielle Sicherheitsanforderungen verfügt, z. b. das zulassen, dass bestimmte Gruppen Zugriff auf verschiedene Objekte haben, hängt von der Tageszeit ab, sollten Sie die gesamte Sicherheit Programm gesteuert verarbeiten und sicherstellen, dass com keinerlei automatische Überprüfung durchführt.</span><span class="sxs-lookup"><span data-stu-id="47336-113">If your application has very specialized security requirements, such as allowing certain groups access to different objects depending on the time of day, you might want to handle all of your security programmatically, ensuring that COM does no automatic checking for you at all.</span></span> <span data-ttu-id="47336-114">Zu diesem Zweck müssen Sie [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity)aufrufen und den *dwauthnlevel* -Parameter auf None und den *pVoid* -Parameter auf **null** festlegen.</span><span class="sxs-lookup"><span data-stu-id="47336-114">To do this, you must call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity), setting the *dwAuthnLevel* parameter to none and the *pVoid* parameter to **NULL**.</span></span> <span data-ttu-id="47336-115">Wenn Sie über ein eigenes Sicherheitspaket verfügen, müssen Sie es auch im *pauthnsvc* -Parameter registrieren.</span><span class="sxs-lookup"><span data-stu-id="47336-115">If you have your own security package you would also need to register it in the *pAuthnSvc* parameter.</span></span> <span data-ttu-id="47336-116">Anschließend können Sie die gesamte eigene Sicherheit Programm gesteuert über Aufrufe der Proxy-Level-Schnittstelle und der Funktionen verarbeiten, [die unter Festlegen der Sicherheit auf der Schnittstellen Proxy Ebene](setting-security-at-the-interface-proxy-level.md)beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="47336-116">Then you can handle all of your own security programmatically through calls to the proxy-level interface and functions described in [Setting Security at the Interface Proxy Level](setting-security-at-the-interface-proxy-level.md).</span></span>

<span data-ttu-id="47336-117">[**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) bietet einen umfangreichen Satz an Funktionen.</span><span class="sxs-lookup"><span data-stu-id="47336-117">[**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) offers a rich set of capabilities.</span></span> <span data-ttu-id="47336-118">Wenn Sie **CoInitializeSecurity** aufzurufen, werden die Registrierungs Werte ignoriert, und die an den-Befehl übergebenen sicherheitsinitialisierungs Werte werden stattdessen verwendet.</span><span class="sxs-lookup"><span data-stu-id="47336-118">If you call **CoInitializeSecurity**, the registry values are ignored and the security initialization values you pass in to the call are used instead.</span></span> <span data-ttu-id="47336-119">Abhängig vom gewünschten Ergebnis kann der erste Parameter ( *pVoid*) auf drei verschiedene Werttypen verweisen: eine [**Sicherheits \_ Beschreibung**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) , ein [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) -Objekt oder ein Zeiger auf eine AppID.</span><span class="sxs-lookup"><span data-stu-id="47336-119">Depending on the result you want, the first parameter, *pVoid*, can point to three different types of values: a [**SECURITY\_DESCRIPTOR**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) , an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object, or a pointer to an AppID.</span></span> <span data-ttu-id="47336-120">In den meisten Fällen verwenden Sie Windows-Funktionen, um eine **Sicherheits \_ Beschreibung** zu erstellen, auf die *pVoid* verweist.</span><span class="sxs-lookup"><span data-stu-id="47336-120">In most cases, you will use Windows functions to create a **SECURITY\_DESCRIPTOR** that *pVoid* will point to.</span></span>

<span data-ttu-id="47336-121">*PVoid* kann jedoch auch auf ein [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) -Objekt verweisen.</span><span class="sxs-lookup"><span data-stu-id="47336-121">However, *pVoid* can also point to an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object.</span></span>

<span data-ttu-id="47336-122">Um [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) anzugeben, dass Sie ein [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) -Objekt an *pVoid* übergeben, müssen Sie den Wert der eoac- \_ Zugriffs \_ Steuerung an den *dwfunktionen* -Parameter übergeben.</span><span class="sxs-lookup"><span data-stu-id="47336-122">To indicate to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) that you are passing an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object to *pVoid*, you must pass the EOAC\_ACCESS\_CONTROL value to the *dwCapabilities* parameter.</span></span> <span data-ttu-id="47336-123">Da **CoInitializeSecurity** die Ergebnisse von Zugriffs Überprüfungen zwischenspeichert, darf die Zugriffs Steuerungs Liste nach dem Aufrufen von **CoInitializeSecurity** nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="47336-123">Since **CoInitializeSecurity** caches the results of access checks, the access control list must not be changed after calling **CoInitializeSecurity**.</span></span>

<span data-ttu-id="47336-124">Ein anderer Typ von Wert, den Sie an den *pVoid* -Parameter übergeben können, ist ein Zeiger auf eine GUID, die die AppID der Anwendung ist.</span><span class="sxs-lookup"><span data-stu-id="47336-124">Another type of value you can pass to the *pVoid* parameter is a pointer to a GUID, which is the AppID of your application.</span></span> <span data-ttu-id="47336-125">Wenn *pVoid* ein Zeiger auf eine AppID ist, müssen Sie die eoac- \_ AppID im *pFunctions* -Parameter angeben, damit die Funktion weiß, welcher Wert in *pVoid* zu erwarten ist.</span><span class="sxs-lookup"><span data-stu-id="47336-125">If *pVoid* is a pointer to an AppID, you must specify EOAC\_APPID in the *pCapabilities* parameter so that the function knows what value to expect in *pVoid*.</span></span> <span data-ttu-id="47336-126">Wenn *pVoid* auf eine AppID verweist, verwendet [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) nur die Registrierung für Authentifizierungs Werte und ignoriert alle anderen Parameter für **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="47336-126">If *pVoid* points to an AppID, [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) uses only the registry for authentication values and ignores all other parameters to **CoInitializeSecurity**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="47336-127">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="47336-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="47336-128">Festlegen Process-Wide Sicherheit</span><span class="sxs-lookup"><span data-stu-id="47336-128">Setting Process-Wide Security</span></span>](setting-processwide-security.md)
</dt> </dl>

 

 