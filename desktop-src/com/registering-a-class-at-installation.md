---
title: Registrieren einer Klasse bei der Installation
description: Wenn eine Klasse für Clients jederzeit verfügbar sein soll, wie es bei den meisten Anwendungen der Fall ist, registrieren Sie Sie in der Regel über ein Installations-und Setup Programm.
ms.assetid: 6d78c2ce-56d8-4866-9801-35125ec9cac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4253c40cb3feb7e737368c947c0b20715f5becbd
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104316551"
---
# <a name="registering-a-class-at-installation"></a><span data-ttu-id="0c3f7-103">Registrieren einer Klasse bei der Installation</span><span class="sxs-lookup"><span data-stu-id="0c3f7-103">Registering a Class at Installation</span></span>

<span data-ttu-id="0c3f7-104">Wenn eine Klasse für Clients jederzeit verfügbar sein soll, wie es bei den meisten Anwendungen der Fall ist, registrieren Sie Sie in der Regel über ein Installations-und Setup Programm.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-104">If a class is intended to be available to clients at any time, as most applications are, you usually register it through an installation and setup program.</span></span> <span data-ttu-id="0c3f7-105">Dies bedeutet, dass Sie Informationen über die Anwendung in die Registrierung einfügen, einschließlich der Art und Weise, in der die Objekte instanziiert werden.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-105">This means putting information about the application into the registry, including how and where its objects are to be instantiated.</span></span> <span data-ttu-id="0c3f7-106">Diese Informationen müssen für alle CLSIDs registriert werden.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-106">This information must be registered for all CLSIDs.</span></span> <span data-ttu-id="0c3f7-107">Weitere Informationen sind optional.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-107">Other information is optional.</span></span> <span data-ttu-id="0c3f7-108">Tools wie regsvr32 vereinfachen das Schreiben eines Setup Programms, mit dem Server bei der Installation registriert werden.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-108">Tools such as Regsvr32 make it simple to write a setup program that registers servers at installation.</span></span>

<span data-ttu-id="0c3f7-109">Wenn Sie nicht auf die System Standardwerte Vertrauen, gibt es zwei wichtige Schlüssel in der Registrierung: die CLSID und die AppID.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-109">If you are not relying on system defaults, there are two important keys in the registry: the CLSID and the AppID.</span></span> <span data-ttu-id="0c3f7-110">Zu den wichtigen Informationen unter diesen Schlüsseln gehört, wie das Objekt instanziiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-110">Among the important pieces of information under these keys is how the object is to be instantiated.</span></span> <span data-ttu-id="0c3f7-111">Objekte können als Prozess interne, out-of-Process-oder out-of-Process-Remote festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-111">Objects can be designated as in-process, out-of-process local, or out-of-process remote.</span></span>

<span data-ttu-id="0c3f7-112">Unter dem Schlüssel "AppID" sind mehrere Werte, die für diese Anwendung spezifische Informationen definieren.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-112">Under the AppID key are several values that define information specific to that application.</span></span> <span data-ttu-id="0c3f7-113">Dabei handelt es sich um [Remoteservername](remoteservername.md) und [activateatstorage](activateatstorage.md). beide können verwendet werden, um einem Client das Erstellen eines Objekts zu gestatten, wobei der Client nicht über das integrierte Wissen zum Speicherort des Servers verfügt.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-113">Among these are [RemoteServerName](remoteservername.md) and [ActivateAtStorage](activateatstorage.md), both of which can be used to permit a client to create an object, with the client having no built-in knowledge of the location of the server.</span></span> <span data-ttu-id="0c3f7-114">(Weitere Informationen zur Remote Instanziierung finden Sie untersuchen [eines Remote Objekts](locating-a-remote-object.md) und [Hilfsfunktionen zum Erstellen von Instanzen](instance-creation-helper-functions.md).)</span><span class="sxs-lookup"><span data-stu-id="0c3f7-114">(For more information about remote instantiation, see [Locating a Remote Object](locating-a-remote-object.md) and [Instance Creation Helper Functions](instance-creation-helper-functions.md).)</span></span>

<span data-ttu-id="0c3f7-115">Ein Server kann auch als Dienst installiert werden oder unter einem bestimmten Benutzerkonto ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-115">A server can also be installed as a service, or to run under a specific user account.</span></span> <span data-ttu-id="0c3f7-116">Weitere Informationen finden Sie unter [Installieren von as-a-Service-Anwendungen](installing-as-a-service-application.md).</span><span class="sxs-lookup"><span data-stu-id="0c3f7-116">For more information, see [Installing as a Service Application](installing-as-a-service-application.md).</span></span>

<span data-ttu-id="0c3f7-117">Ein Server-oder ein rot-Objekt, das kein-Dienst ist oder unter einem bestimmten Benutzerkonto ausgeführt wird, kann als Server "aktivieren als Aktivator" bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-117">A server or ROT object that is not a service or running under a specific user account can be referred to as an "activate as activator" server.</span></span> <span data-ttu-id="0c3f7-118">Für diese Server müssen der Sicherheitskontext und die Fenster Station/der Desktop des Clients mit dem des Servers identisch sein.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-118">For these servers, the security context and the window station/desktop of the client must match the server's.</span></span> <span data-ttu-id="0c3f7-119">Ein Client, der versucht, eine Verbindung mit einem Remote Server herzustellen, wird als **null** -Fenster Station/Desktop betrachtet, sodass nur der Server Sicherheitskontext in dieser Instanz verglichen wird.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-119">A client attempting to connect to a remote server is considered to have a **NULL** window station/desktop, so only the server security context is compared in this instance.</span></span> <span data-ttu-id="0c3f7-120">(Weitere Informationen zu SIDs finden Sie unter [Sicherheit in com](security-in-com.md).) COM speichert die Fenster Station/den Desktop eines Prozesses zwischen, wenn der Prozess zum ersten Mal eine Verbindung mit dem verteilten com-Dienst herstellt.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-120">(For more information about SIDs, see [Security in COM](security-in-com.md).) COM caches the window station/desktop of a process when the process first connects to the distributed COM service.</span></span> <span data-ttu-id="0c3f7-121">Daher sollten com-Clients und-Server die Fenster Station oder die Thread Desktops des Prozesses nicht ändern, nachdem [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) oder [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex)aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-121">Therefore, COM clients and servers should not change their window station or thread desktops of the process after calling [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span></span>

<span data-ttu-id="0c3f7-122">Wenn eine Klasse als Prozess interne Registrierung registriert wird, wird ein Aufruf von [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) zum Erstellen des Klassen Objekts automatisch von com an die [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) -Funktion übergeben, die von der Klasse implementiert werden muss, um dem aufrufenden Objekt einen Zeiger auf das zugehörige Klassenobjekt zu verleihen.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-122">When a class is registered as in-process, a call to [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) to create its class object is automatically passed by COM to the [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) function, which the class must implement to give the calling object a pointer to its class object.</span></span>

<span data-ttu-id="0c3f7-123">Klassen, die in ausführbaren Dateien implementiert werden, können angeben, dass com Ihren Prozess ausführen soll, und warten, bis der Prozess die [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) -Schnittstelle Ihres Klassen Objekts über einen Aufrufen der [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) -Funktion registriert.</span><span class="sxs-lookup"><span data-stu-id="0c3f7-123">Classes implemented in executables can specify that COM should execute their process and wait for the process to register their class object's [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface through a call to the [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0c3f7-124">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="0c3f7-124">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0c3f7-125">COM-Registrierungsschlüssel</span><span class="sxs-lookup"><span data-stu-id="0c3f7-125">COM Registry Keys</span></span>](com-registry-keys.md)
</dt> <dt>

[<span data-ttu-id="0c3f7-126">Installieren von als Dienst Anwendung</span><span class="sxs-lookup"><span data-stu-id="0c3f7-126">Installing as a Service Application</span></span>](installing-as-a-service-application.md)
</dt> <dt>

[<span data-ttu-id="0c3f7-127">Registrieren eines ausführenden exe-Servers</span><span class="sxs-lookup"><span data-stu-id="0c3f7-127">Registering a Running EXE Server</span></span>](registering-a-running-exe-server.md)
</dt> <dt>

[<span data-ttu-id="0c3f7-128">Registrieren von Komponenten</span><span class="sxs-lookup"><span data-stu-id="0c3f7-128">Registering Components</span></span>](registering-components.md)
</dt> <dt>

[<span data-ttu-id="0c3f7-129">Registrieren von Objekten in der rot</span><span class="sxs-lookup"><span data-stu-id="0c3f7-129">Registering Objects in the ROT</span></span>](registering-objects-in-the-rot.md)
</dt> <dt>

[<span data-ttu-id="0c3f7-130">Selbstregistrierung</span><span class="sxs-lookup"><span data-stu-id="0c3f7-130">Self-Registration</span></span>](self-registration.md)
</dt> </dl>

 

 