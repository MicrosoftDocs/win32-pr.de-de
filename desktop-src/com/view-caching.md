---
title: Zwischenspeichern anzeigen
description: Zwischenspeichern anzeigen
ms.assetid: d19c111c-1367-43a2-97a9-35dc0ff5dcc8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 592c5bc2555e907cdc4e600465b807387c3a5548
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104391048"
---
# <a name="view-caching"></a><span data-ttu-id="1d4b9-103">Zwischenspeichern anzeigen</span><span class="sxs-lookup"><span data-stu-id="1d4b9-103">View Caching</span></span>

<span data-ttu-id="1d4b9-104">Eine Containeranwendung muss in der Lage sein, eine Darstellung eines Objekts zu erhalten, um Sie für Benutzer anzuzeigen oder zu drucken, wenn das Dokument geöffnet ist, die Serveranwendung des Objekts jedoch nicht ausgeführt wird oder nicht auf dem Computer des Benutzers installiert ist.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-104">A container application must be able to obtain a presentation of an object for the purpose of displaying or printing it for users when the document is open but the object's server application is not running or is not installed on the user's machine.</span></span> <span data-ttu-id="1d4b9-105">Es wird jedoch davon ausgegangen, dass die Server für alle Objekte, die möglicherweise in einem Dokument gefunden werden, auf dem Computer jedes Benutzers installiert sind und immer Bedarfs gesteuert ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-105">To assume, however, that the servers for all the objects that might conceivably be found in a document are installed on every user's machine and can always run on demand is unrealistic.</span></span> <span data-ttu-id="1d4b9-106">Der Standard Objekt Handler, der jederzeit verfügbar ist, löst dieses Problem durch Zwischenspeichern von Objekt Präsentationen im Speicher des Dokuments und Bearbeiten dieser Präsentationen auf allen Plattformen, unabhängig von der Verfügbarkeit des Objekt Servers auf einer bestimmten Installation des Containers.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-106">The default object handler, which is available at all times, solves this dilemma by caching object presentations in the document's storage and manipulating these presentations on any platform regardless of the availablility of the object server on any particular installation of the container.</span></span>

<span data-ttu-id="1d4b9-107">Container können Zeichnungs Präsentationen für ein oder mehrere bestimmte Zielgeräte verwalten, zusätzlich zu dem, das für die Verwaltung des Objekts auf dem Bildschirm erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-107">Containers can maintain drawing presentations for one or more specific target devices in addition to the one required to maintain the object on screen.</span></span> <span data-ttu-id="1d4b9-108">Wenn Sie das Objekt von einer Plattform zu einem anderen portieren, werden die Datenformate des Objekts von OLE automatisch in diejenigen konvertiert, die auf der neuen Plattform unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-108">Moreover, if you port the object from one platform to another, OLE automatically converts the object's data formats to ones supported on the new platform.</span></span> <span data-ttu-id="1d4b9-109">Wenn Sie z. b. ein Objekt von Windows in den Macintosh-Code verschieben, konvertiert OLE seine metadateipräsentationen in PICT-Formate.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-109">For example, if you move an object from Windows to the Macintosh, OLE will convert its metafile presentations to PICT formats.</span></span>

<span data-ttu-id="1d4b9-110">Um dem Benutzer eine exakte Darstellung eines eingebetteten Objekts zu präsentieren, initiiert die Containeranwendung des Objekts einen Dialog mit dem Objekt Handler, der Daten und Zeichen Anweisungen anfordert.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-110">In order to present an accurate representation of an embedded object to the user, the object's container application initiates a dialog with the object handler, requesting data and drawing instructions.</span></span> <span data-ttu-id="1d4b9-111">Der Handler muss die [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)-, [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)-und [**iolecache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) -Schnittstellen implementieren, um die Anforderungen des Containers erfüllen zu können.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-111">To be able to fulfill the container's requests, the handler must implement the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2), and [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) interfaces.</span></span>

<span data-ttu-id="1d4b9-112">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) ermöglicht es einer OLE-Containeranwendung, Daten aus den eingebetteten oder verknüpften Objekten zu erhalten und Daten zu senden.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-112">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) enables an OLE container application to get data from and send data to its embedded or linked objects.</span></span> <span data-ttu-id="1d4b9-113">Wenn sich Daten in einem Objekt ändern, bietet diese Schnittstelle eine Möglichkeit für das Objekt, die neuen Daten für den Container verfügbar zu machen, und stellt dem Container eine Möglichkeit zum Aktualisieren der Daten in der zugehörigen Kopie des Objekts bereit.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-113">When data changes in an object, this interface provides a way for the object to make its new data available to its container and provides the container with a way to update the data in its copy of the object.</span></span> <span data-ttu-id="1d4b9-114">(Eine Erörterung der Datenübertragung im Allgemeinen finden Sie in Kapitel 4, Datenübertragung.)</span><span class="sxs-lookup"><span data-stu-id="1d4b9-114">(For a discussion of data transfer in general, see Chapter 4, Data Transfer.)</span></span>

<span data-ttu-id="1d4b9-115">Die [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) -Schnittstelle ähnelt der [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) -Schnittstelle, mit der Ausnahme, dass Sie ein Objekt anfordert, sich selbst in einem Gerätekontext zu zeichnen, z. b. einem Bildschirm, einem Drucker oder einer Metadatei, anstatt die Daten in den Arbeitsspeicher oder ein anderes Übertragungsmedium zu verschieben</span><span class="sxs-lookup"><span data-stu-id="1d4b9-115">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface is very much like the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface except that it asks an object to draw itself on a device context, such as a screen, printer, or metafile, rather than move or copy its data to memory or some other transfer medium.</span></span> <span data-ttu-id="1d4b9-116">Der Zweck der-Schnittstelle besteht darin, einen OLE-Container zu aktivieren, um alternative bildliche Darstellungen der eingebetteten Objekte zu erhalten, deren Daten bereits vorhanden sind. auf diese Weise wird der Aufwand vermieden, bei dem eine vollständige Übertragung völlig neuer Instanzen derselben Datenobjekte erforderlich ist, um neue Zeichnungs Anweisungen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-116">The purpose of the interface is to enable an OLE container to obtain alternative pictorial representations of its embedded objects, whose data it already has, thereby avoiding the overhead of having to transfer entirely new instances of the same data objects simply to obtain new drawing instructions.</span></span> <span data-ttu-id="1d4b9-117">Stattdessen ermöglicht die **IViewObject2**-Schnittstelle dem Container, ein Objekt zu bitten, eine Darstellung von sich selbst bereitzustellen, indem es auf einem vom Container angegebenen Gerätekontext gezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-117">Instead, the **IViewObject2** interface enables the container to ask an object to provide a pictorial representation of itself by drawing on a device context specified by the container.</span></span>

<span data-ttu-id="1d4b9-118">Beim Aufrufen der [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) -Schnittstelle kann eine Containeranwendung auch angeben, dass sich das Objekt auf einem anderen Zielgerät als dem, auf dem es tatsächlich gerendert wird, zeichnen soll.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-118">When calling the [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface, a container application can also specify that the object draw itself on a target device different than the one on which it will actually be rendered.</span></span> <span data-ttu-id="1d4b9-119">Dies ermöglicht es dem Container nach Bedarf, unterschiedliche Renderings von einem einzelnen Objekt zu generieren.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-119">This enables the container, as needed, to generate different renderings from a single object.</span></span> <span data-ttu-id="1d4b9-120">Der Aufrufer könnte das Objekt z. b. auffordern, sich selbst für einen Drucker zu verfassen, auch wenn die resultierende Zeichnung auf dem Bildschirm gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-120">For example, the caller could ask the object to compose itself for a printer even though the resulting drawing will be rendered on screen.</span></span> <span data-ttu-id="1d4b9-121">Das Ergebnis ist natürlich eine Druckvorschau des Objekts.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-121">The result, of course, would be a print-preview of the object.</span></span>

<span data-ttu-id="1d4b9-122">Die [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)-Schnittstelle stellt auch Methoden bereit, mit denen sich Container für Ansichts Änderungs Benachrichtigungen registrieren können.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-122">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)interface also provides methods that enable containers to register for view-change notifications.</span></span> <span data-ttu-id="1d4b9-123">Wie bei Daten-und OLE-Empfehlungen ermöglicht eine Ansichts Beratungs Verbindung einem Container, seine Renderings eines Objekts zu einem eigenen Zweck zu aktualisieren und nicht als Reaktion auf einen-Befehl aus dem-Objekt.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-123">As with data and OLE advisories, a view advisory connection enables a container to update its renderings of an object at its own convenience rather than in response to a call from the object.</span></span> <span data-ttu-id="1d4b9-124">Wenn z. b. eine neue Version der Serveranwendung eines Objekts zusätzliche Sichten derselben Daten bereitstellen würde, würde der Standard Handler des Objekts die Implementierung von [**IAdviseSink:: OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) für jeden Container aufrufen, um Sie darüber zu informieren, dass die neuen Präsentationen verfügbar waren.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-124">For example, if a new version of an object's server application were to offer additional views of the same data, the object's default handler would call each container's implementation of [**IAdviseSink::OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) to let them know that the new presentations were available.</span></span> <span data-ttu-id="1d4b9-125">Der Container würde diese Informationen nur bei Bedarf von der Benachrichtigungs Senke abrufen.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-125">The container would retrieve this information from the advise sink only when needed.</span></span>

<span data-ttu-id="1d4b9-126">Da Windows-Geräte Kontexte nur innerhalb eines einzelnen Prozesses Bedeutung haben, können Sie [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) -Zeiger nicht über Prozess Grenzen hinweg übergeben.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-126">Because Windows device contexts have meaning only within a single process, you cannot pass [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) pointers across process boundaries.</span></span> <span data-ttu-id="1d4b9-127">Folglich haben OLE-lokale und Remote Server keine Notwendigkeit, die Schnittstelle zu implementieren, die selbst dann nicht ordnungsgemäß funktioniert, wenn dies der Fall war.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-127">As a result, OLE local and remote servers have no need whatsoever to implement the interface, which wouldn't work properly even if they did.</span></span> <span data-ttu-id="1d4b9-128">Die **IViewObject2**-Schnittstelle wird nur von Objekt Handlern und Prozess internen Servern implementiert.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-128">Only object handlers and in-process servers implement the **IViewObject2** interface.</span></span> <span data-ttu-id="1d4b9-129">OLE bietet eine Standard Implementierung, die Sie in ihren eigenen OLE-Prozess Servern und Objekt Handlern verwenden können, indem Sie einfach den OLE-Standard Handler aggregierten.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-129">OLE provides a default implementation, which you can use in your own OLE in-process servers and object handlers simply by aggregating the OLE default handler.</span></span> <span data-ttu-id="1d4b9-130">Oder Sie können eine eigene Implementierung von **IViewObject2** schreiben.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-130">Or you can write your own implementation of **IViewObject2**.</span></span>

<span data-ttu-id="1d4b9-131">Ein Objekt implementiert die [**iolecache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) -Schnittstelle, damit der Handler weiß, welche Funktionen zwischengespeichert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-131">An object implements the [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) interface in order to let the handler know what capabilities it should cache.</span></span> <span data-ttu-id="1d4b9-132">Der Objekt Handler besitzt auch den Cache und stellt sicher, dass er auf dem neuesten Stand gehalten wird.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-132">The object handler also owns the cache and ensures it is kept up to date.</span></span> <span data-ttu-id="1d4b9-133">Wenn das eingebettete Objekt in den Zustand "wird ausgeführt" wechselt, richtet der Handler entsprechende Beratungs Verbindungen für das Server Objekt ein, wobei er sich selbst als Senke verhält.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-133">As the embedded object enters the running state, the handler sets up appropriate advisory connections on the server object, with itself acting as the sink.</span></span> <span data-ttu-id="1d4b9-134">Die [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) -und [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)-Schnittstellen Implementierungen arbeiten aus Daten, die auf der Clientseite zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-134">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)interface implementations operate out of data cached on the client side.</span></span> <span data-ttu-id="1d4b9-135">Die Implementierung von **IViewObject2** des Handlers ist dafür verantwortlich, zu bestimmen, welche Datenformate zwischengespeichert werden sollen, um Client Zeichnungs Anforderungen zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-135">The handler's implementation of **IViewObject2** is responsible for determining what data formats to cache in order to satisfy client draw requests.</span></span> <span data-ttu-id="1d4b9-136">Die Implementierung von **IDataObject** des Handlers ist dafür verantwortlich, Daten in verschiedenen Formaten usw. zwischen Arbeitsspeicher und der zugrunde liegenden [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) -Instanz des eingebetteten Objekts zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-136">The handler's implementation of **IDataObject** is responsible for getting data in various formats, etc., between memory and the underlying [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) instance of the embedded object.</span></span> <span data-ttu-id="1d4b9-137">Benutzerdefinierte Handler können diese Implementierungen verwenden, indem Sie den Standard Handler aggregierten.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-137">Custom handlers can use these implementations by aggregating on the default handler.</span></span>

> [!Note]  
> <span data-ttu-id="1d4b9-138">Die [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) -Schnittstelle ist eine einfache funktionale Erweiterung von [**IViewObject**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) und sollte anstelle der letzteren Schnittstelle implementiert werden, die mittlerweile veraltet ist.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-138">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface is a simple functional extension of [**IViewObject**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) and should be implemented instead of the latter interface, which is now obsolete.</span></span> <span data-ttu-id="1d4b9-139">Zusätzlich zur Bereitstellung der **IViewObject** -Methoden bietet die **IViewObject2** -Schnittstelle ein einzelnes zusätzliches Element, [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent), das es einer Containeranwendung ermöglicht, die Größe der Darstellung eines Objekts aus dem Cache abzurufen, ohne dass das Objekt zuerst mit einem [**IOleObject:: GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent)-Befehl in den Ausführungs Zustand verschoben werden muss.</span><span class="sxs-lookup"><span data-stu-id="1d4b9-139">In addition to providing the **IViewObject** methods, the **IViewObject2** interface provides a single additional member, [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent), which enables a container application to get the size of an object's presentation from the cache without first having to move the object into the running state with a call to [**IOleObject::GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="1d4b9-140">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1d4b9-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1d4b9-141">Verbund Dokumente</span><span class="sxs-lookup"><span data-stu-id="1d4b9-141">Compound Documents</span></span>](compound-documents.md)
</dt> </dl>

 

 