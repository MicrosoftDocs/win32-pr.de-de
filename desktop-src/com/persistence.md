---
title: Persistenz
description: Persistenz
ms.assetid: 4916ea52-a21c-4938-81cb-392b5ca1f6c1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7ba5fc0c8e389c7babdf80b76719b39fc02d5604
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104039704"
---
# <a name="persistence"></a><span data-ttu-id="9d296-103">Persistenz</span><span class="sxs-lookup"><span data-stu-id="9d296-103">Persistence</span></span>

<span data-ttu-id="9d296-104">Ein Steuerelement implementiert eine oder mehrere der persistenzschnittstellen, um die Persistenz seines Zustands zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9d296-104">A control implements one or more of several persistence interfaces to support persistence of its state.</span></span> <span data-ttu-id="9d296-105">Beispielsweise unterstützt die [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) -Schnittstelle die streambasierte Persistenz des Zustands des Steuer Elements.</span><span class="sxs-lookup"><span data-stu-id="9d296-105">For example, the [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) interface supports stream-based persistence of the control's state.</span></span> <span data-ttu-id="9d296-106">**IPersistStreamInit** ist ein Ersatz für [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) und fügt eine Initialisierungs Methode, [**InitNew**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew), hinzu.</span><span class="sxs-lookup"><span data-stu-id="9d296-106">**IPersistStreamInit** is a replacement for [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) and adds an initialization method, [**InitNew**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew).</span></span> <span data-ttu-id="9d296-107">Die anderen Methoden sind in beiden Schnittstellen identisch.</span><span class="sxs-lookup"><span data-stu-id="9d296-107">The other methods are the same in both interfaces.</span></span> <span data-ttu-id="9d296-108">**IPersistStreamInit** ist nicht von **IPersistStream** abgeleitet. ein-Objekt unterstützt nur eine der beiden Schnittstellen, je nachdem, ob es die Möglichkeit erfordert, neue Instanzen von sich selbst zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="9d296-108">**IPersistStreamInit** is not derived from **IPersistStream**; an object supports only one of the two interfaces based on whether it requires the ability to initialize new instances of itself.</span></span>

<span data-ttu-id="9d296-109">Zu den anderen persistenzschnittstellen, die ein Steuerelement anbieten kann, gehören: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**ipersistmemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85)), [**ipersistmoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="9d296-109">Other persistence interfaces that a control can offer include: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85)), [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span></span> <span data-ttu-id="9d296-110">Die Implementierung des Steuer Elements muss entscheiden, welche Arten von Persistenz am wichtigsten sind, und die entsprechenden persistenzschnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="9d296-110">The control implementer must decide what kinds of persistence are most important and implement the appropriate persistence interfaces.</span></span> <span data-ttu-id="9d296-111">Die Implementierung des Steuer Elements entscheidet auch, was gespeichert werden soll.</span><span class="sxs-lookup"><span data-stu-id="9d296-111">The control implementer also decides what to save.</span></span> <span data-ttu-id="9d296-112">Ein Steuerelement kann z. b. die aktuellen Werte der zugehörigen Eigenschaften oder deren Position und Größe in seinem Container speichern.</span><span class="sxs-lookup"><span data-stu-id="9d296-112">For example, a control can save the current values of its properties or its location and size within its container.</span></span> <span data-ttu-id="9d296-113">Der Client entscheidet, welche Schnittstelle er bevorzugt verwenden soll.</span><span class="sxs-lookup"><span data-stu-id="9d296-113">The client decides which interface it prefers to use.</span></span>

<span data-ttu-id="9d296-114">Bevor ein-Steuerelement aus seinem permanenten Zustand geladen wird, kann ein Client das OLEMISC \_ setclientsitefirst-Flag überprüfen, um zu bestimmen, ob das Steuerelement das Aufrufen seiner Client Site und Ambient-Eigenschaften vor dem Laden seines permanenten Zustands unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9d296-114">Before loading a control from its persistent state, a client can check the OLEMISC\_SETCLIENTSITEFIRST flag to determine if the control supports getting its client site and ambient properties before loading its persistent state.</span></span> <span data-ttu-id="9d296-115">Diese Optimierung kann Zeit sparen, wenn ein Steuerelement instanziiert wird, da das Steuerelement dann seine permanenten Werte ignorieren kann, anstatt Sie nur zu laden, damit Sie von Umgebungs Eigenschaften, die vom Client bereitgestellt werden, überschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="9d296-115">This optimization can save time when instantiating a control since the control is then free to ignore its persistent values rather than loading them only to have them overridden by ambient properties supplied by the client.</span></span>

<span data-ttu-id="9d296-116">Ein Steuerelement kann auch das Speichern und Wiederherstellen seines Zustands in einem OLE-Eigenschaften Satz, einem Satz von bezeichnerwerten und Werten in einem angegebenen Format unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9d296-116">A control can also support saving and restoring its state in an OLE property set, a set of identifiers and values in a specified format.</span></span> <span data-ttu-id="9d296-117">Diese Funktion kann für Container wie Visual Basic nützlich sein, die ihre Programme in Textform speichert.</span><span class="sxs-lookup"><span data-stu-id="9d296-117">This feature can be useful with containers such as Visual Basic, which saves its programs in a textual form.</span></span> <span data-ttu-id="9d296-118">Ein Steuerelement, das diese Funktion unterstützen möchte, implementiert [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) und [**IDataObject:: SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) , um die Eigenschaftswerte an bzw. aus dem Container zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="9d296-118">A control that wants to support this feature implements [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) and [**IDataObject::SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) to pass its property values to and from the container, respectively.</span></span> <span data-ttu-id="9d296-119">Es ist die Aufgabe des Containers, diese Informationen in Text zu konvertieren und zu speichern.</span><span class="sxs-lookup"><span data-stu-id="9d296-119">It is the container's job to convert this information to text and save it.</span></span> <span data-ttu-id="9d296-120">Die vom Steuerelement verwendeten Bezeichner entsprechen den Eigenschaften Namen und den Werten des Steuer Elements.</span><span class="sxs-lookup"><span data-stu-id="9d296-120">The identifiers used by the control correspond to the control's property names and the values.</span></span> <span data-ttu-id="9d296-121">Sehen Sie sich das OLE CDK für die Definition dieses Eigenschaften Satzes an.</span><span class="sxs-lookup"><span data-stu-id="9d296-121">See the OLE CDK for the definition of this property set.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9d296-122">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="9d296-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9d296-123">ActiveX-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="9d296-123">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 