---
title: Persistenz
description: Persistenz
ms.assetid: 4916ea52-a21c-4938-81cb-392b5ca1f6c1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6cffab1c9a0f2746e57e356a90698caf9903deb
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/27/2021
ms.locfileid: "110549285"
---
# <a name="persistence"></a><span data-ttu-id="4ce96-103">Persistenz</span><span class="sxs-lookup"><span data-stu-id="4ce96-103">Persistence</span></span>

<span data-ttu-id="4ce96-104">Ein Steuerelement implementiert eine oder mehrere von mehreren Persistenzschnittstellen, um die Persistenz des Zustands zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="4ce96-104">A control implements one or more of several persistence interfaces to support persistence of its state.</span></span> <span data-ttu-id="4ce96-105">Die [**IPersistStreamInit-Schnittstelle unterstützt**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) beispielsweise die streambasierte Persistenz des Zustands des Steuerelements.</span><span class="sxs-lookup"><span data-stu-id="4ce96-105">For example, the [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) interface supports stream-based persistence of the control's state.</span></span> <span data-ttu-id="4ce96-106">**IPersistStreamInit ist** ein Ersatz für [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) und fügt die Initialisierungsmethode [**InitNew hinzu.**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew)</span><span class="sxs-lookup"><span data-stu-id="4ce96-106">**IPersistStreamInit** is a replacement for [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) and adds an initialization method, [**InitNew**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew).</span></span> <span data-ttu-id="4ce96-107">Die anderen Methoden sind in beiden Schnittstellen identisch.</span><span class="sxs-lookup"><span data-stu-id="4ce96-107">The other methods are the same in both interfaces.</span></span> <span data-ttu-id="4ce96-108">**IPersistStreamInit** wird nicht von **IPersistStream abgeleitet.** Ein -Objekt unterstützt nur eine der beiden Schnittstellen, je darauf, ob es die Möglichkeit erfordert, neue Instanzen von sich selbst zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="4ce96-108">**IPersistStreamInit** is not derived from **IPersistStream**; an object supports only one of the two interfaces based on whether it requires the ability to initialize new instances of itself.</span></span>

<span data-ttu-id="4ce96-109">Weitere Persistenzschnittstellen, die ein Steuerelement bieten kann, sind: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag), [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="4ce96-109">Other persistence interfaces that a control can offer include: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag), [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span></span> <span data-ttu-id="4ce96-110">Der Implementer des Steuerelements muss entscheiden, welche Arten von Persistenz am wichtigsten sind, und die entsprechenden Persistenzschnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="4ce96-110">The control implementer must decide what kinds of persistence are most important and implement the appropriate persistence interfaces.</span></span> <span data-ttu-id="4ce96-111">Der Implementer des Steuerelements entscheidet auch, was zu speichern ist.</span><span class="sxs-lookup"><span data-stu-id="4ce96-111">The control implementer also decides what to save.</span></span> <span data-ttu-id="4ce96-112">Beispielsweise kann ein Steuerelement die aktuellen Werte seiner Eigenschaften oder seine Position und Größe in seinem Container speichern.</span><span class="sxs-lookup"><span data-stu-id="4ce96-112">For example, a control can save the current values of its properties or its location and size within its container.</span></span> <span data-ttu-id="4ce96-113">Der Client entscheidet, welche Schnittstelle er bevorzugt.</span><span class="sxs-lookup"><span data-stu-id="4ce96-113">The client decides which interface it prefers to use.</span></span>

<span data-ttu-id="4ce96-114">Vor dem Laden eines Steuerelements aus seinem persistenten Zustand kann ein Client das OLEMISC SETCLIENTSITEFIRST-Flag überprüfen, um zu ermitteln, ob das Steuerelement das Abrufen seiner Clientstandort- und Umgebungseigenschaften unterstützt, bevor der persistente Zustand geladen \_ wird.</span><span class="sxs-lookup"><span data-stu-id="4ce96-114">Before loading a control from its persistent state, a client can check the OLEMISC\_SETCLIENTSITEFIRST flag to determine if the control supports getting its client site and ambient properties before loading its persistent state.</span></span> <span data-ttu-id="4ce96-115">Diese Optimierung kann beim Instanziieren eines Steuerelements Zeit sparen, da das Steuerelement dann seine persistenten Werte ignorieren kann, anstatt sie nur zu laden, damit sie von umgebungseigenschaften überschrieben werden, die vom Client bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="4ce96-115">This optimization can save time when instantiating a control since the control is then free to ignore its persistent values rather than loading them only to have them overridden by ambient properties supplied by the client.</span></span>

<span data-ttu-id="4ce96-116">Ein Steuerelement kann auch das Speichern und Wiederherstellen seines Zustands in einem OLE-Eigenschaftensatz, einem Satz von Bezeichnern und Werten in einem angegebenen Format, unterstützen.</span><span class="sxs-lookup"><span data-stu-id="4ce96-116">A control can also support saving and restoring its state in an OLE property set, a set of identifiers and values in a specified format.</span></span> <span data-ttu-id="4ce96-117">Dieses Feature kann bei Containern wie Visual Basic nützlich sein, die seine Programme in Textform speichern.</span><span class="sxs-lookup"><span data-stu-id="4ce96-117">This feature can be useful with containers such as Visual Basic, which saves its programs in a textual form.</span></span> <span data-ttu-id="4ce96-118">Ein Steuerelement, das dieses Feature unterstützen möchte, implementiert [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) und [**IDataObject::SetData,**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) um dessen Eigenschaftswerte an bzw. aus dem Container zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="4ce96-118">A control that wants to support this feature implements [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) and [**IDataObject::SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) to pass its property values to and from the container, respectively.</span></span> <span data-ttu-id="4ce96-119">Es ist aufgabe des Containers, diese Informationen in Text zu konvertieren und zu speichern.</span><span class="sxs-lookup"><span data-stu-id="4ce96-119">It is the container's job to convert this information to text and save it.</span></span> <span data-ttu-id="4ce96-120">Die vom Steuerelement verwendeten Bezeichner entsprechen den Eigenschaftennamen des Steuerelements und den Werten.</span><span class="sxs-lookup"><span data-stu-id="4ce96-120">The identifiers used by the control correspond to the control's property names and the values.</span></span> <span data-ttu-id="4ce96-121">Die Definition dieses Eigenschaftensatzes finden Sie im OLE CDK.</span><span class="sxs-lookup"><span data-stu-id="4ce96-121">See the OLE CDK for the definition of this property set.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4ce96-122">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="4ce96-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4ce96-123">ActiveX-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="4ce96-123">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 