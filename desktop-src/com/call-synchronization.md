---
title: Rückruf Synchronisierung
description: Rückruf Synchronisierung
ms.assetid: e74407ef-f500-4d13-aef4-ca6bb37d5858
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ec9254aceaaa8a6fa26d56d4a86987cc955b90dc
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104039673"
---
# <a name="call-synchronization"></a><span data-ttu-id="39919-103">Rückruf Synchronisierung</span><span class="sxs-lookup"><span data-stu-id="39919-103">Call Synchronization</span></span>

<span data-ttu-id="39919-104">COM-Anwendungen müssen in der Lage sein, bei der Verarbeitung eines oder mehrerer Aufrufe von com oder des Betriebssystems ordnungsgemäß mit Benutzereingaben umzugehen.</span><span class="sxs-lookup"><span data-stu-id="39919-104">COM applications must be able to deal correctly with user input while processing one or more calls from COM or the operating system.</span></span> <span data-ttu-id="39919-105">COM bietet nur eine Synchronisierung für Single Thread-Apartments.</span><span class="sxs-lookup"><span data-stu-id="39919-105">COM provides call synchronization for single-threaded apartments only.</span></span> <span data-ttu-id="39919-106">Multithreadwohnungen (die frei Thread-Threads enthalten) empfangen beim Aufrufen von aufrufen (im gleichen Thread) keine Aufrufe.</span><span class="sxs-lookup"><span data-stu-id="39919-106">Multithreaded apartments (containing free-threaded threads) do not receive calls while making calls (on the same thread).</span></span> <span data-ttu-id="39919-107">Multithread-Apartments können keine Synchronisierungs Aufrufe durchführen.</span><span class="sxs-lookup"><span data-stu-id="39919-107">Multithreaded apartments cannot make input synchronized calls.</span></span> <span data-ttu-id="39919-108">Asynchrone Aufrufe werden in Multithread-Apartments in synchrone Aufrufe konvertiert.</span><span class="sxs-lookup"><span data-stu-id="39919-108">Asynchronous calls are converted to synchronous calls in multithreaded apartments.</span></span> <span data-ttu-id="39919-109">Der Nachrichtenfilter wird nicht für einen Thread in einem Multithread-Apartment aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="39919-109">The message filter is not called for any thread in a multithreaded apartment.</span></span> <span data-ttu-id="39919-110">Weitere Informationen zu Threading Problemen finden Sie unter [Prozesse, Threads und Apartments](processes--threads--and-apartments.md).</span><span class="sxs-lookup"><span data-stu-id="39919-110">For more information about threading issues, see [Processes, Threads, and Apartments](processes--threads--and-apartments.md).</span></span>

<span data-ttu-id="39919-111">COM-Aufrufe zwischen Prozessen können wie folgt in drei Kategorien unterteilt werden:</span><span class="sxs-lookup"><span data-stu-id="39919-111">COM calls between processes fall into three categories, as follows:</span></span>

<dl> <dt>

<span data-ttu-id="39919-112"><span id="Synchronous_calls"></span><span id="synchronous_calls"></span><span id="SYNCHRONOUS_CALLS"></span>*Synchrone Aufrufe*</span><span class="sxs-lookup"><span data-stu-id="39919-112"><span id="Synchronous_calls"></span><span id="synchronous_calls"></span><span id="SYNCHRONOUS_CALLS"></span>*Synchronous calls*</span></span>
</dt> <dd>

<span data-ttu-id="39919-113">Der größte Teil der Kommunikation, die innerhalb von com stattfindet, ist synchron.</span><span class="sxs-lookup"><span data-stu-id="39919-113">Most of the communication that takes place within COM is synchronous.</span></span> <span data-ttu-id="39919-114">Beim Ausführen synchroner Aufrufe wartet der Aufrufer auf die Antwort, bevor er fortgesetzt wird, und kann eingehende Nachrichten empfangen.</span><span class="sxs-lookup"><span data-stu-id="39919-114">When making synchronous calls, the caller waits for the reply before continuing and can receive incoming messages while waiting.</span></span> <span data-ttu-id="39919-115">COM gibt eine modale Schleife für das warten auf die Antwort, das empfangen und weiterleiten anderer Nachrichten in einer kontrollierten Weise ein.</span><span class="sxs-lookup"><span data-stu-id="39919-115">COM enters a modal loop to wait for the reply, receiving and dispatching other messages in a controlled manner.</span></span>

</dd> <dt>

<span data-ttu-id="39919-116"><span id="Asynchronous_notifications"></span><span id="asynchronous_notifications"></span><span id="ASYNCHRONOUS_NOTIFICATIONS"></span>*Asynchrone Benachrichtigungen*</span><span class="sxs-lookup"><span data-stu-id="39919-116"><span id="Asynchronous_notifications"></span><span id="asynchronous_notifications"></span><span id="ASYNCHRONOUS_NOTIFICATIONS"></span>*Asynchronous notifications*</span></span>
</dt> <dd>

<span data-ttu-id="39919-117">Beim Senden von asynchronen Benachrichtigungen wartet der Aufrufer nicht auf die Antwort.</span><span class="sxs-lookup"><span data-stu-id="39919-117">When sending asynchronous notifications, the caller does not wait for the reply.</span></span> <span data-ttu-id="39919-118">COM verwendet [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) oder Ereignisse auf hoher Ebene, um asynchrone Benachrichtigungen zu senden, abhängig von der Plattform.</span><span class="sxs-lookup"><span data-stu-id="39919-118">COM uses [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) or high-level events to send asynchronous notifications, depending on the platform.</span></span> <span data-ttu-id="39919-119">COM definiert fünf asynchrone Methoden von [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink):</span><span class="sxs-lookup"><span data-stu-id="39919-119">COM defines five asynchronous methods of [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink):</span></span>

-   [<span data-ttu-id="39919-120">**OnDataChange**</span><span class="sxs-lookup"><span data-stu-id="39919-120">**OnDataChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange)
-   [<span data-ttu-id="39919-121">**OnViewChange**</span><span class="sxs-lookup"><span data-stu-id="39919-121">**OnViewChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange)
-   [<span data-ttu-id="39919-122">**Onrename**</span><span class="sxs-lookup"><span data-stu-id="39919-122">**OnRename**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename)
-   [<span data-ttu-id="39919-123">**OnSave**</span><span class="sxs-lookup"><span data-stu-id="39919-123">**OnSave**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)
-   [<span data-ttu-id="39919-124">**OnClose**</span><span class="sxs-lookup"><span data-stu-id="39919-124">**OnClose**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)

> [!Note]  
> <span data-ttu-id="39919-125">Während com einen asynchronen Aufruf verarbeitet, können keine synchronen Aufrufe durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="39919-125">While COM is processing an asynchronous call, synchronous calls cannot be made.</span></span> <span data-ttu-id="39919-126">Beispielsweise kann die Implementierung von [**OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) einer Containeranwendung keinen [**IPersistStorage:: Save**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-save)-Rückruf enthalten.</span><span class="sxs-lookup"><span data-stu-id="39919-126">For example, a container application's implementation of [**OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) cannot contain a call to [**IPersistStorage::Save**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-save).</span></span> <span data-ttu-id="39919-127">Diese Aufrufe sind die einzigen asynchronen Aufrufe, die von com unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="39919-127">These calls are the only asynchronous calls supported by COM.</span></span> <span data-ttu-id="39919-128">Es gibt keine Möglichkeit, eine benutzerdefinierte Schnittstelle zu erstellen, die zu diesem Zeitpunkt asynchron ist.</span><span class="sxs-lookup"><span data-stu-id="39919-128">There is no way to create a custom interface that is asynchronous at this time.</span></span>

 

</dd> <dt>

<span data-ttu-id="39919-129"><span id="Input-synchronized_calls"></span><span id="input-synchronized_calls"></span><span id="INPUT-SYNCHRONIZED_CALLS"></span>*Eingabe synchronisierte Aufrufe*</span><span class="sxs-lookup"><span data-stu-id="39919-129"><span id="Input-synchronized_calls"></span><span id="input-synchronized_calls"></span><span id="INPUT-SYNCHRONIZED_CALLS"></span>*Input-synchronized calls*</span></span>
</dt> <dd>

<span data-ttu-id="39919-130">Beim Durchführen von Eingabe synchronisierten aufrufen muss das Objekt, das aufgerufen wird, den Aufruf vor der Rückgabe der Steuerung vervollständigen.</span><span class="sxs-lookup"><span data-stu-id="39919-130">When making input-synchronized calls, the object called must complete the call before yielding control.</span></span> <span data-ttu-id="39919-131">Dadurch wird sichergestellt, dass die Fokus Verwaltung ordnungsgemäß funktioniert und dass die vom Benutzer eingegebenen Daten entsprechend verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="39919-131">This helps ensure that focus management works correctly and that data entered by the user is processed appropriately.</span></span> <span data-ttu-id="39919-132">Diese Aufrufe werden von com über die [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) -Funktion durchgeführt, ohne dass eine modale Schleife eingegeben wird.</span><span class="sxs-lookup"><span data-stu-id="39919-132">These calls are made by COM through the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function, without entering a modal loop.</span></span> <span data-ttu-id="39919-133">Beim Verarbeiten eines Eingabe synchronisierten Aufrufs darf das aufgerufene Objekt keine Funktion oder Methode (einschließlich synchroner Methoden) aufrufen, die möglicherweise die Kontrolle übertragen.</span><span class="sxs-lookup"><span data-stu-id="39919-133">While processing an input-synchronized call, the object called must not call any function or method (including synchronous methods) that might yield control.</span></span> <span data-ttu-id="39919-134">Die folgenden Methoden sind für die Eingabe synchronisiert.</span><span class="sxs-lookup"><span data-stu-id="39919-134">The following methods are input synchronized</span></span>

-   [<span data-ttu-id="39919-135">**IOleWindow:: GetWindow**</span><span class="sxs-lookup"><span data-stu-id="39919-135">**IOleWindow::GetWindow**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-getwindow)
-   [<span data-ttu-id="39919-136">**IOleInPlaceActiveObject:: onframewindowaktivierungs**</span><span class="sxs-lookup"><span data-stu-id="39919-136">**IOleInPlaceActiveObject::OnFrameWindowActivate**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate)
-   [<span data-ttu-id="39919-137">**IOleInPlaceActiveObject:: ondocwindowaktivierungs**</span><span class="sxs-lookup"><span data-stu-id="39919-137">**IOleInPlaceActiveObject::OnDocWindowActivate**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceactiveobject-ondocwindowactivate)
-   [<span data-ttu-id="39919-138">**IOleInPlaceActiveObject:: resizeborder**</span><span class="sxs-lookup"><span data-stu-id="39919-138">**IOleInPlaceActiveObject::ResizeBorder**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceactiveobject-resizeborder)
-   [<span data-ttu-id="39919-139">**Ioleingeplaceuiwindow:: GetBorder**</span><span class="sxs-lookup"><span data-stu-id="39919-139">**IOleInPlaceUIWindow::GetBorder**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceuiwindow-getborder)
-   [<span data-ttu-id="39919-140">**Ioleingeplaceuiwindow:: RequestBorderSpace**</span><span class="sxs-lookup"><span data-stu-id="39919-140">**IOleInPlaceUIWindow::RequestBorderSpace**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceuiwindow-requestborderspace)
-   [<span data-ttu-id="39919-141">**Ioleingeplaceuiwindow:: SetBorderSpace**</span><span class="sxs-lookup"><span data-stu-id="39919-141">**IOleInPlaceUIWindow::SetBorderSpace**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceuiwindow-setborderspace)
-   [<span data-ttu-id="39919-142">**IOleInPlaceFrame:: setMenu**</span><span class="sxs-lookup"><span data-stu-id="39919-142">**IOleInPlaceFrame::SetMenu**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceframe-setmenu)
-   [<span data-ttu-id="39919-143">**IOleInPlaceFrame:: SetStatusText**</span><span class="sxs-lookup"><span data-stu-id="39919-143">**IOleInPlaceFrame::SetStatusText**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceframe-setstatustext)
-   [<span data-ttu-id="39919-144">**IOleInPlaceObject:: SetObjectRects**</span><span class="sxs-lookup"><span data-stu-id="39919-144">**IOleInPlaceObject::SetObjectRects**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects)

</dd> </dl>

<span data-ttu-id="39919-145">Um Probleme zu minimieren, die bei der asynchronen Nachrichtenverarbeitung auftreten können, sind die meisten com-Methodenaufrufe synchron.</span><span class="sxs-lookup"><span data-stu-id="39919-145">To minimize problems that can arise from asynchronous message processing, the majority of COM method calls are synchronous.</span></span> <span data-ttu-id="39919-146">Bei synchroner Kommunikation ist kein spezieller Code erforderlich, um eingehende Nachrichten zu verteilen und zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="39919-146">With synchronous communication, there is no need for special code to dispatch and handle incoming messages.</span></span> <span data-ttu-id="39919-147">Wenn eine Anwendung einen synchronen Methoden Aufrufvorgang durchführt, wechselt com in eine modale Warteschleife, die die erforderlichen Antworten verarbeitet und eingehende Nachrichten an Anwendungen sendet, die Sie verarbeiten können.</span><span class="sxs-lookup"><span data-stu-id="39919-147">When an application makes a synchronous method call, COM enters a modal wait loop that handles the required replies and dispatches incoming messages to applications capable of processing them.</span></span>

<span data-ttu-id="39919-148">COM verwaltet Methodenaufrufe durch Zuweisen eines Bezeichners, der als *logische Thread-ID* bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="39919-148">COM manages method calls by assigning an identifier called a *logical thread ID*.</span></span> <span data-ttu-id="39919-149">Ein neues wird zugewiesen, wenn ein Benutzer einen Menübefehl auswählt oder wenn die Anwendung einen neuen com-Vorgang initiiert.</span><span class="sxs-lookup"><span data-stu-id="39919-149">A new one is assigned when a user selects a menu command or when the application initiates a new COM operation.</span></span> <span data-ttu-id="39919-150">Nachfolgenden Aufrufen, die sich auf den anfänglichen com-Aufruf beziehen, wird dieselbe logische Thread-ID wie der erste Aufruf zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="39919-150">Subsequent calls that relate to the initial COM call are assigned the same logical thread ID as the initial call.</span></span>

 

 