---
title: Der Lightweight Client-Side-Handler
description: Mithilfe von Lightweight-Client seitigen Handlern können Sie allgemeine Client seitige Handler beliebiger Größe erstellen, damit Sie eine beliebige Art von Standard Aufgabe ausführen können.
ms.assetid: b712237c-55d7-4f52-9cf6-19c6e5fb3182
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f1e8df5be24e8773a660a4d0208b27a2f585e32
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "103730537"
---
# <a name="the-lightweight-client-side-handler"></a><span data-ttu-id="80327-103">Der Lightweight Client-Side-Handler</span><span class="sxs-lookup"><span data-stu-id="80327-103">The Lightweight Client-Side Handler</span></span>

<span data-ttu-id="80327-104">Mithilfe von Lightweight-Client seitigen Handlern können Sie allgemeine Client seitige Handler beliebiger Größe erstellen, damit Sie eine beliebige Art von Standard Aufgabe ausführen können.</span><span class="sxs-lookup"><span data-stu-id="80327-104">Lightweight client-side handlers allow you to create general client-side handlers of any size, to help you do any kind of standard task.</span></span> <span data-ttu-id="80327-105">Als Handler können diese von mehr als einem Client verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="80327-105">As handlers, these are usable by more than one client.</span></span> <span data-ttu-id="80327-106">Sie unterscheiden sich von OLE-Handlern darin, dass Sie nicht vor dem Start des Servers erstellt werden können und ihre Lebensdauer an die des Proxy-Managers gebunden ist. Dadurch wird eine mögliche Racebedingung verhindert, bei der der Handler andernfalls vorzeitig freigegeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="80327-106">They differ from OLE handlers in that they cannot be created before the server is launched, and their lifetime is tied to that of the proxy manager, preventing a possible race condition in which the handler could otherwise be prematurely released.</span></span>

<span data-ttu-id="80327-107">Der Proxy-Manager ist das vom System erstellte Objekt, das die [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) -Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="80327-107">The proxy manager is the system-created object that implements the [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) interface.</span></span> <span data-ttu-id="80327-108">Wenn Sie das Standardmarshalling verwenden, erstellt das System es für Sie, wenn Sie [**cogetstandardmarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (oder [**cogetstdmarshalex**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex)zum Erstellen eines aggregierten Mars Haller für Lightweight-Handler) aufrufen und außerdem die [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) -und [**imultiqi**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) -Schnittstellen für das-Objekt implementieren.</span><span class="sxs-lookup"><span data-stu-id="80327-108">If you use standard marshaling, the system creates it for you when you call [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (or [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex), for creating an aggregated marshaler for lightweight handlers) and also implements the [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) and [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) interfaces on the object.</span></span> <span data-ttu-id="80327-109">Auf der Serverseite ist ein entsprechendes Systemobjekt vorhanden, das auch " **IMarshal**" implementiert.</span><span class="sxs-lookup"><span data-stu-id="80327-109">On the server side, there is a corresponding system object that also implements **IMarshal**.</span></span> <span data-ttu-id="80327-110">Diese Objekte verarbeiten das Marshalling für Sie transparent.</span><span class="sxs-lookup"><span data-stu-id="80327-110">These objects handle marshaling for you transparently.</span></span>

<span data-ttu-id="80327-111">Es gibt zwei allgemeine Arten von Handlern, die Sie implementieren können:</span><span class="sxs-lookup"><span data-stu-id="80327-111">There are two general types of these handlers that you may want to implement:</span></span>

-   <span data-ttu-id="80327-112">Ein Handler, der einen Dienst ausführt, der keine zusätzlichen Daten vom Server benötigt.</span><span class="sxs-lookup"><span data-stu-id="80327-112">A handler that performs a service that requires no extra data from the server</span></span>
-   <span data-ttu-id="80327-113">Ein Handler, der zusätzliche Daten vom Server verwendet.</span><span class="sxs-lookup"><span data-stu-id="80327-113">A handler that uses extra data from the server</span></span>

<span data-ttu-id="80327-114">Einige potenzielle Verwendungsmöglichkeiten der zusätzlichen Daten im Stream, die vom Server bereitgestellt werden, lauten wie folgt:</span><span class="sxs-lookup"><span data-stu-id="80327-114">Some potential uses of the extra data in the stream supplied by the server are as follows:</span></span>

-   <span data-ttu-id="80327-115">Statische Daten vom Server.</span><span class="sxs-lookup"><span data-stu-id="80327-115">Static data from server.</span></span> <span data-ttu-id="80327-116">Unabhängig von der bestimmten Schnittstelle, die gemarshallt wird, schreibt der Server dieselben Daten in den Stream.</span><span class="sxs-lookup"><span data-stu-id="80327-116">Regardless of the particular interface being marshaled, the server writes the same data into the stream.</span></span>
-   <span data-ttu-id="80327-117">Pro Schnittstelle Daten vom Server.</span><span class="sxs-lookup"><span data-stu-id="80327-117">Per-interface data from server.</span></span> <span data-ttu-id="80327-118">Je nachdem, welche bestimmte Schnittstelle gemarshallt wird, schreibt der Server möglicherweise andere Daten in den Stream.</span><span class="sxs-lookup"><span data-stu-id="80327-118">Depending on which particular interface is being marshaled, the server may write different data into the stream.</span></span>
-   <span data-ttu-id="80327-119">Pro Schnittstellen-Hilfsprogramme.</span><span class="sxs-lookup"><span data-stu-id="80327-119">Per-interface helpers.</span></span> <span data-ttu-id="80327-120">Pro Schnittstelle COM-Komponenten, die in den Client Handler aggregiert und an den Standard Proxy delegiert werden.</span><span class="sxs-lookup"><span data-stu-id="80327-120">Per-interface COM components aggregated into the client handler and delegating to the standard proxy.</span></span> <span data-ttu-id="80327-121">Um z. b. die Netzwerkleistung zu verbessern, könnte eine COM-Komponente für [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) das Client seitige Zwischenspeichern von Daten, Read-Ahead, Write-Behind, op-Sperrung usw. durchführen.</span><span class="sxs-lookup"><span data-stu-id="80327-121">For example, to improve network performance, a COM component for [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) could do client-side caching of data, read-ahead, write-behind, op-locking, and so forth.</span></span>
-   <span data-ttu-id="80327-122">Netzwerk Version einer Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="80327-122">Network version of an interface.</span></span> <span data-ttu-id="80327-123">Die Netzwerk Version der Schnittstelle unterscheidet sich von der Schnittstelle, die vom Client-und Server Anwendungscode verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="80327-123">The network version of the interface is different from the interface exposed by the client and server application code.</span></span> <span data-ttu-id="80327-124">Es ist z. b. möglich, über die gleiche Netzwerkschnittstelle wie der Einbettungs Server Handler über die gleiche Netzwerkschnittstelle wie den Einbettungs Server zu übermitteln.</span><span class="sxs-lookup"><span data-stu-id="80327-124">It is possible, for example, to multiplex exposed interfaces IA and IB over the same network interface INetAB, the way the embedding server handler does.</span></span> <span data-ttu-id="80327-125">Beispielsweise kann eine Daten Übertragungs Schnittstelle in eine Netzwerkschnittstelle konvertiert werden, die Pipes für die effiziente Datenübertragung verwendet.</span><span class="sxs-lookup"><span data-stu-id="80327-125">For example, one could convert a data transfer interface into a network interface that uses pipes for efficient data transfer.</span></span>

<span data-ttu-id="80327-126">Downlevelclients können aus zwei Gründen die Verwendung von Schnittstellen, die über benutzerdefinierte Handler verfügen, nicht Mars Hallen: Erstens können Sie die CLSID, die im benutzerdefinierten gemarshallten Paket verwendet wird, nicht verstehen, wenn der Server Handler aggregiert wird und das Objekt einen Handler wünscht.</span><span class="sxs-lookup"><span data-stu-id="80327-126">Down-level clients may not have the capability of unmarshaling interfaces that have custom handlers, for two reasons: First, they may not understand the CLSID used in the custom marshaled packet when the server handler is aggregated and the object wants a handler.</span></span> <span data-ttu-id="80327-127">Zweitens kann der Handlercode nicht einmal auf der Clientseite ausgeführt werden, wenn er neue Funktionen von com zum Erstellen des aggregierten Standard-Mars Haller und zum Ausführen von [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) -Remote aufrufen erfordert.</span><span class="sxs-lookup"><span data-stu-id="80327-127">Second, the handler code may not even run on the client side if it requires new functionality from COM to create the aggregated standard marshaler and to do remote [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) calls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="80327-128">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="80327-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="80327-129">Der OLE-Handler</span><span class="sxs-lookup"><span data-stu-id="80327-129">The OLE Handler</span></span>](the-ole-handler.md)
</dt> </dl>

 

 