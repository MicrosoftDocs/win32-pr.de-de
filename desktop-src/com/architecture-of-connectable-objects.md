---
title: Architektur von Verbindungs fähigen Objekten
description: Architektur von Verbindungs fähigen Objekten
ms.assetid: 69949a3b-3ab8-4054-84d8-9256fbf39c7b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e9d8d2909942d1c04aed972e7891a6f4ae3f730
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/03/2021
ms.locfileid: "106373402"
---
# <a name="architecture-of-connectable-objects"></a><span data-ttu-id="191cc-103">Architektur von Verbindungs fähigen Objekten</span><span class="sxs-lookup"><span data-stu-id="191cc-103">Architecture of Connectable Objects</span></span>

<span data-ttu-id="191cc-104">Das Verbindungs fähigen-Objekt ist nur ein Teil der allgemeinen Architektur von Verbindungs fähigen Objekten.</span><span class="sxs-lookup"><span data-stu-id="191cc-104">The connectable object is only one piece of the overall architecture of connectable objects.</span></span> <span data-ttu-id="191cc-105">Diese Technologie umfasst die folgenden Elemente:</span><span class="sxs-lookup"><span data-stu-id="191cc-105">This technology includes the following elements:</span></span>

-   <span data-ttu-id="191cc-106">**Connectable-Objekt.**</span><span class="sxs-lookup"><span data-stu-id="191cc-106">**Connectable object.**</span></span> <span data-ttu-id="191cc-107">Implementiert die [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) -Schnittstelle. erstellt mindestens ein Verbindungspunkt Objekt. definiert eine ausgehende Schnittstelle für den Client.</span><span class="sxs-lookup"><span data-stu-id="191cc-107">Implements the [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) interface; creates at least one connection point object; defines an outgoing interface for the client.</span></span>
-   <span data-ttu-id="191cc-108">**Ent.**</span><span class="sxs-lookup"><span data-stu-id="191cc-108">**Client.**</span></span> <span data-ttu-id="191cc-109">Fragt das Objekt für [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) ab, um zu bestimmen, ob das Objekt eine Verbindung herstellt. erstellt ein Sink-Objekt, um die vom Verbindungs fähigen-Objekt definierte ausgehende Schnittstelle zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="191cc-109">Queries the object for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to determine whether the object is connectable; creates a sink object to implement the outgoing interface defined by the connectable object.</span></span>
-   <span data-ttu-id="191cc-110">**Sink-Objekt.**</span><span class="sxs-lookup"><span data-stu-id="191cc-110">**Sink object.**</span></span> <span data-ttu-id="191cc-111">Implementiert die ausgehende Schnittstelle. wird verwendet, um eine Verbindung mit dem Verbindungs fähigen-Objekt herzustellen.</span><span class="sxs-lookup"><span data-stu-id="191cc-111">Implements the outgoing interface; used to establish a connection to the connectable object.</span></span>
-   <span data-ttu-id="191cc-112">**Verbindungspunkt Objekt.**</span><span class="sxs-lookup"><span data-stu-id="191cc-112">**Connection point object.**</span></span> <span data-ttu-id="191cc-113">Implementiert die [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) -Schnittstelle und verwaltet die Verbindung mit der Senke des Clients.</span><span class="sxs-lookup"><span data-stu-id="191cc-113">Implements the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface and manages connection with the client's sink.</span></span>

<span data-ttu-id="191cc-114">Die Beziehungen zwischen Client, Verbindungs fähiges Objekt, Verbindungspunkt und Senke werden im folgenden Diagramm veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="191cc-114">The relationships between client, connectable object, a connection point, and a sink are illustrated in the following diagram:</span></span>

![Diagramm, das die Verbindungspunkte zwischen dem Client und dem Verbindungs fähigen Objekt anzeigt.](images/1cd44fec-5d2c-4427-846b-ccab7ec0b08a.png)

<span data-ttu-id="191cc-116">Bevor das Verbindungspunkt Objektmethoden in der Sink-Schnittstelle in Schritt 3 im vorangehenden Diagramm aufruft, muss es [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) für die jeweilige erforderliche Schnittstelle sein, auch wenn der Zeiger bereits im Schritt 2-Aufruf der Methode " [**Empfehlung**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) " weitergegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="191cc-116">Before the connection point object calls methods in the sink interface in step 3 in the preceding diagram, it must [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for the specific interface required, even if the pointer was already passed in the step 2 call to the [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) method.</span></span>

<span data-ttu-id="191cc-117">Zwei Enumeratorobjekte sind auch an dieser Architektur beteiligt, aber in der Abbildung nicht dargestellt.</span><span class="sxs-lookup"><span data-stu-id="191cc-117">Two enumerator objects are also involved in this architecture though not shown in the illustration.</span></span> <span data-ttu-id="191cc-118">Eine wird von einer Methode in [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) erstellt, um die Verbindungspunkte innerhalb des Verbindungs fähigen Objekts aufzulisten.</span><span class="sxs-lookup"><span data-stu-id="191cc-118">One is created by a method in [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to enumerate the connection points within the connectable object.</span></span> <span data-ttu-id="191cc-119">Der andere wird von einer Methode in [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) erstellt, um die Verbindungen aufzulisten, die derzeit mit diesem Verbindungspunkt hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="191cc-119">The other is created by a method in [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) to enumerate the connections currently established to that connection point.</span></span> <span data-ttu-id="191cc-120">Ein Verbindungspunkt kann mehrere verbundene Sink-Schnittstellen unterstützen und die Liste der Verbindungen jedes Mal durchlaufen, wenn ein Methodenaufruf an diese Schnittstelle erfolgt.</span><span class="sxs-lookup"><span data-stu-id="191cc-120">One connection point can support multiple connected sink interfaces, and it should iterate through the list of connections each time it makes a method call on that interface.</span></span> <span data-ttu-id="191cc-121">Dieser Prozess wird als Multicasting bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="191cc-121">This process is known as multicasting.</span></span>

<span data-ttu-id="191cc-122">Beim Arbeiten mit Verbindungs fähigen Objekten ist es wichtig zu verstehen, dass das Verbindungs fähige Objekt, jeder Verbindungspunkt, jede Senke und alle Enumeratoren separate Objekte mit separaten [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Implementierungen, separaten Verweis Zählungen und separaten Lebens dauern aufweisen.</span><span class="sxs-lookup"><span data-stu-id="191cc-122">When working with connectable objects, it is important to understand that the connectable object, each connection point, each sink, and all enumerators are separate objects with separate [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) implementations, separate reference counts, and separate lifetimes.</span></span> <span data-ttu-id="191cc-123">Ein Client, der diese Objekte verwendet, ist immer für die Freigabe aller Verweis Zähler zuständig, die er besitzt.</span><span class="sxs-lookup"><span data-stu-id="191cc-123">A client using these objects is always responsible for releasing all reference counts it owns.</span></span>

> [!Note]  
> <span data-ttu-id="191cc-124">Ein Verbindungs fähiges Objekt kann mehr als einen Client unterstützen und mehrere senken innerhalb eines Clients unterstützen.</span><span class="sxs-lookup"><span data-stu-id="191cc-124">A connectable object can support more than one client and can support multiple sinks within a client.</span></span> <span data-ttu-id="191cc-125">Ebenso kann eine Senke mit mehr als einem Verbindungs fähigen Objekt verbunden werden.</span><span class="sxs-lookup"><span data-stu-id="191cc-125">Likewise, a sink can be connected to more than one connectable object.</span></span>

 

<span data-ttu-id="191cc-126">Die Schritte zum Herstellen einer Verbindung zwischen einem Client und einem Verbindungs fähigen Objekt lauten wie folgt:</span><span class="sxs-lookup"><span data-stu-id="191cc-126">The steps for establishing a connection between a client and a connectable object are as follows:</span></span>

1.  <span data-ttu-id="191cc-127">Der Client fragt [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) für das-Objekt ab, um zu bestimmen, ob das Objekt verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="191cc-127">The client queries for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) on the object to determine whether the object is connectable.</span></span> <span data-ttu-id="191cc-128">Wenn dieser Vorgang erfolgreich ist, enthält der Client einen Zeiger auf die **IConnectionPointContainer** -Schnittstelle für das Verbindungs fähigen-Objekt, und der Verbindungs fähigen-Objekt Verweis-Counter wurde inkrementiert.</span><span class="sxs-lookup"><span data-stu-id="191cc-128">If this call is successful, the client holds a pointer to the **IConnectionPointContainer** interface on the connectable object and the connectable object reference counter has been incremented.</span></span> <span data-ttu-id="191cc-129">Andernfalls ist das Objekt nicht Verbindungs fähigen und unterstützt keine ausgehenden Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="191cc-129">Otherwise, the object is not connectable and does not support outgoing interfaces.</span></span>
2.  <span data-ttu-id="191cc-130">Wenn das Objekt verbunden ist, versucht der Client als nächstes, einen Zeiger auf die [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) -Schnittstelle an einem Verbindungspunkt innerhalb des Verbindungs fähigen Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="191cc-130">If the object is connectable, the client next tries to obtain a pointer to the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface on a connection point within the connectable object.</span></span> <span data-ttu-id="191cc-131">Es gibt zwei Methoden zum Abrufen dieses Zeigers: sowohl in [**IConnectionPointContainer:: FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) als auch in [**IConnectionPointContainer:: EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span><span class="sxs-lookup"><span data-stu-id="191cc-131">There are two methods for obtaining this pointer, both in [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) and in [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="191cc-132">Wenn ' **EnumConnectionPoints** ' verwendet wird, sind einige zusätzliche Schritte erforderlich.</span><span class="sxs-lookup"><span data-stu-id="191cc-132">There are a few additional steps needed if **EnumConnectionPoints** is used.</span></span> <span data-ttu-id="191cc-133">(Weitere Informationen finden [Sie unter Verwenden von IConnectionPointContainer](using-iconnectionpointcontainer.md) .) Wenn der Vorgang erfolgreich ist, unterstützen das Verbindungs fähige Objekt und der Client die gleiche ausgehende Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="191cc-133">(See [Using IConnectionPointContainer](using-iconnectionpointcontainer.md) for more information.) If successful, the connectable object and the client both support the same outgoing interface.</span></span> <span data-ttu-id="191cc-134">Das Verbindungs fähige Objekt definiert es und ruft es auf, und der Client implementiert es.</span><span class="sxs-lookup"><span data-stu-id="191cc-134">The connectable object defines it and calls it, and the client implements it.</span></span> <span data-ttu-id="191cc-135">Der Client kann dann über den Verbindungspunkt innerhalb des Verbindungs fähigen Objekts kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="191cc-135">The client can then communicate through the connection point within the connectable object.</span></span>
3.  <span data-ttu-id="191cc-136">Der Client ruft dann die [**Empfehlung**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) auf dem Verbindungspunkt auf, um eine Verbindung zwischen der Senke-Schnittstelle und dem Verbindungspunkt des Objekts herzustellen.</span><span class="sxs-lookup"><span data-stu-id="191cc-136">The client then calls [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) on the connection point to establish a connection between its sink interface and the object's connection point.</span></span> <span data-ttu-id="191cc-137">Nach diesem-Befehl enthält der Verbindungspunkt des Objekts einen Zeiger auf die ausgehende Schnittstelle in der Senke.</span><span class="sxs-lookup"><span data-stu-id="191cc-137">After this call, the object's connection point holds a pointer to the outgoing interface on the sink.</span></span>
4.  <span data-ttu-id="191cc-138">Der Code in der [**Empfehlung**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) ruft [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) für den übergebenen Schnittstellen Zeiger auf und fragt den spezifischen Schnittstellen Bezeichner ab, mit dem eine Verbindung hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="191cc-138">The code inside [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) calls [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) on the interface pointer that is passed in, asking for the specific interface identifier to which it connects.</span></span>
5.  <span data-ttu-id="191cc-139">Das-Objekt ruft bei Bedarf Methoden auf der-Schnittstelle der Senke auf und verwendet dabei den Zeiger, der vom Verbindungspunkt gehalten wird.</span><span class="sxs-lookup"><span data-stu-id="191cc-139">The object calls methods on the sink's interface as needed, using the pointer held by its connection point.</span></span>
6.  <span data-ttu-id="191cc-140">Der Client ruft [**unempfehlung**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) auf, um die Verbindung zu beenden.</span><span class="sxs-lookup"><span data-stu-id="191cc-140">The client calls [**Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) to terminate the connection.</span></span> <span data-ttu-id="191cc-141">Dann ruft der Client **IConnectionPoint:: Release** auf, um seinen Halt für den Verbindungspunkt freizugeben, und somit auch das Haupt Verbindungs fähige Objekt.</span><span class="sxs-lookup"><span data-stu-id="191cc-141">Then the client calls **IConnectionPoint::Release** to free its hold on the connection point and, therefore, the main connectable object also.</span></span> <span data-ttu-id="191cc-142">Der Client muss auch **IConnectionPointContainer:: Release** anrufen, um seinen Halt für das zentrale Verbindungs fähigen-Objekt freizugeben.</span><span class="sxs-lookup"><span data-stu-id="191cc-142">The client must also call **IConnectionPointContainer::Release** to free its hold on the main connectable object.</span></span>

## <a name="related-topics"></a><span data-ttu-id="191cc-143">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="191cc-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="191cc-144">Verbindungs fähige Objekt Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="191cc-144">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




