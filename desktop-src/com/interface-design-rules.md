---
title: Schnittstellen Entwurfs Regeln
description: Dieser Abschnitt enthält eine kurze Zusammenfassung der Schnittstellen Entwurfs Regeln und-Richtlinien.
ms.assetid: c43fc385-bcd6-45fc-91b2-ad9827fdb15c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5c1cde73527ac79a2e4442910e3053ed96748337
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104102383"
---
# <a name="interface-design-rules"></a><span data-ttu-id="21965-103">Schnittstellen Entwurfs Regeln</span><span class="sxs-lookup"><span data-stu-id="21965-103">Interface Design Rules</span></span>

<span data-ttu-id="21965-104">Dieser Abschnitt enthält eine kurze Zusammenfassung der Schnittstellen Entwurfs Regeln und-Richtlinien.</span><span class="sxs-lookup"><span data-stu-id="21965-104">This section provides a short summary of interface design rules and guidelines.</span></span> <span data-ttu-id="21965-105">Einige dieser Regeln gelten speziell für die com-Architektur, während andere Einschränkungen von der Programmiersprache "Interface", "Mittel l", verursacht werden.</span><span class="sxs-lookup"><span data-stu-id="21965-105">Some of these rules are specific to the COM architecture, while others are restrictions imposed by the interface design language, MIDL.</span></span> <span data-ttu-id="21965-106">Details zum Design der COM-Schnittstelle finden Sie unter [Anatomie einer IDL-Datei](anatomy-of-an-idl-file.md).</span><span class="sxs-lookup"><span data-stu-id="21965-106">For details of COM interface design, see [Anatomy of an IDL File](anatomy-of-an-idl-file.md).</span></span>

<span data-ttu-id="21965-107">Definitionsgemäß ist ein Objekt kein COM-Objekt, es sei denn, es implementiert entweder die [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Schnittstelle oder eine Schnittstelle, die von **IUnknown** abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="21965-107">By definition, an object is not a COM object unless it implements either the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface or an interface that is derived from **IUnknown**.</span></span> <span data-ttu-id="21965-108">Außerdem gelten die folgenden Regeln für alle für ein COM-Objekt implementierten Schnittstellen:</span><span class="sxs-lookup"><span data-stu-id="21965-108">In addition, the following rules apply to all interfaces implemented on a COM object:</span></span>

-   <span data-ttu-id="21965-109">Sie müssen über einen eindeutigen Schnittstellen Bezeichner (IID) verfügen.</span><span class="sxs-lookup"><span data-stu-id="21965-109">They must have a unique interface identifier (IID).</span></span>
-   <span data-ttu-id="21965-110">Sie müssen unveränderlich sein.</span><span class="sxs-lookup"><span data-stu-id="21965-110">They must be immutable.</span></span> <span data-ttu-id="21965-111">Nachdem Sie erstellt und veröffentlicht wurden, kann sich kein Teil ihrer Definition ändern.</span><span class="sxs-lookup"><span data-stu-id="21965-111">Once they are created and published, no part of their definition may change.</span></span>
-   <span data-ttu-id="21965-112">Alle Schnittstellen Methoden müssen einen **HRESULT** -Wert zurückgeben, damit die Teile des Systems, die die Remote Verarbeitung verarbeiten, RPC-Fehler melden können.</span><span class="sxs-lookup"><span data-stu-id="21965-112">All interface methods must return an **HRESULT** value so that the portions of the system that handle remote processing can report RPC errors.</span></span>
-   <span data-ttu-id="21965-113">Alle Zeichen folgen Parameter in Schnittstellen Methoden müssen Unicode sein.</span><span class="sxs-lookup"><span data-stu-id="21965-113">All string parameters in interface methods must be Unicode.</span></span>
-   <span data-ttu-id="21965-114">Die Datentypen müssen Remote fähig sein.</span><span class="sxs-lookup"><span data-stu-id="21965-114">Your data types must be remotable.</span></span> <span data-ttu-id="21965-115">Wenn Sie einen-Datentyp nicht in einen Remote fähigen Typ konvertieren können, müssen Sie eigene Marshalling-und Marshallingroutinen erstellen.</span><span class="sxs-lookup"><span data-stu-id="21965-115">If you cannot convert a data type to a remotable type, you will have to create your own marshaling and unmarshaling routines.</span></span> <span data-ttu-id="21965-116">Außerdem hat **LPVOID** oder **void \*** keine Bedeutung auf einem Remote Computer.</span><span class="sxs-lookup"><span data-stu-id="21965-116">Also, **LPVOID**, or **void \***, has no meaning on a remote computer.</span></span> <span data-ttu-id="21965-117">Verwenden Sie ggf. einen Zeiger auf [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="21965-117">Use a pointer to [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), if necessary.</span></span>

> [!Note]  
> <span data-ttu-id="21965-118">Die aktuelle Implementierung von "Mittel l" verarbeitet keine Funktions Überladung oder mehrfache Vererbung.</span><span class="sxs-lookup"><span data-stu-id="21965-118">The current implementation of MIDL does not handle function overloading or multiple inheritance.</span></span>

 

## <a name="other-interface-design-considerations"></a><span data-ttu-id="21965-119">Weitere Überlegungen zur Schnittstellen Entwicklung</span><span class="sxs-lookup"><span data-stu-id="21965-119">Other Interface Design Considerations</span></span>

<span data-ttu-id="21965-120">Verwenden Sie Verweise auf Daten sehr sorgfältig.</span><span class="sxs-lookup"><span data-stu-id="21965-120">Use pointers to data very carefully.</span></span> <span data-ttu-id="21965-121">Um die Daten im Adressraum des aufgerufenen Prozesses neu zu erstellen, muss die RPC-Laufzeit die genaue Größe der Daten kennen.</span><span class="sxs-lookup"><span data-stu-id="21965-121">To re-create the data in the address space of the process that is called, the RPC run time must know the exact size of the data.</span></span> <span data-ttu-id="21965-122">Wenn z. b. ein **Char \*** -Parameter auf einen Puffer von Zeichen anstelle eines einzelnen Zeichens zeigt, können die Daten nicht ordnungsgemäß neu erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="21965-122">If, for example, a **CHAR \*** parameter points to a buffer of characters rather than to a single character, the data cannot be correctly re-created.</span></span> <span data-ttu-id="21965-123">Verwenden Sie die Syntax, die in der mittleren l verfügbar ist, um die durch ihre Typdefinitionen dargestellten Datenstrukturen genau zu beschreiben.</span><span class="sxs-lookup"><span data-stu-id="21965-123">Use the syntax available with MIDL to accurately describe the data structures represented by your type definitions.</span></span>

<span data-ttu-id="21965-124">Die Initialisierung ist für Zeiger von Bedeutung, die in Arrays und Strukturen eingebettet sind und über Prozess Grenzen hinweg übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="21965-124">Initialization is essential for pointers that are embedded in arrays and structures and passed across process boundaries.</span></span> <span data-ttu-id="21965-125">Nicht initialisierte Zeiger funktionieren möglicherweise, wenn Sie an ein Programm im selben Prozessbereich übermittelt werden, Proxys und stubvorgänge gehen jedoch davon aus, dass alle Zeiger mit gültigen Adressen initialisiert werden oder NULL sind.</span><span class="sxs-lookup"><span data-stu-id="21965-125">Uninitialized pointers may work when passed to a program in the same process space, but proxies and stubs assume that all pointers are initialized with valid addresses or are null.</span></span>

<span data-ttu-id="21965-126">Gehen Sie beim Aliasing von Zeigern vorsichtig vor (sodass Zeiger auf denselben Arbeitsspeicher zeigen).</span><span class="sxs-lookup"><span data-stu-id="21965-126">Be careful when aliasing pointers (allowing pointers to point to the same piece of memory).</span></span> <span data-ttu-id="21965-127">Wenn das Aliasing beabsichtigt ist, sollten diese Zeiger in der IDL-Datei als Alias deklariert werden.</span><span class="sxs-lookup"><span data-stu-id="21965-127">If the aliasing is intentional, these pointers should be declared aliased in the IDL file.</span></span> <span data-ttu-id="21965-128">Zeiger, die als nicht-Alias deklariert sind, sollten niemals einander als Alias aufweisen.</span><span class="sxs-lookup"><span data-stu-id="21965-128">Pointers declared as nonaliased should never alias each other.</span></span>

<span data-ttu-id="21965-129">Achten Sie darauf, wie Sie Arbeitsspeicher zuordnen und freigeben.</span><span class="sxs-lookup"><span data-stu-id="21965-129">Pay attention to how you allocate and free memory.</span></span> <span data-ttu-id="21965-130">Wenn Sie ein COM-Objekt (mithilfe des Attributs " [**zuordnen**](/windows/desktop/Midl/allocate) ") nicht explizit angeben, um eine Datenstruktur, die während eines Out-of-Process-Aufrufes erstellt wurde, nicht freizugeben, wird diese Struktur beim Abschluss des Aufrufes zerstört.</span><span class="sxs-lookup"><span data-stu-id="21965-130">Remember that, unless you explicitly tell a COM object (by using the [**allocate**](/windows/desktop/Midl/allocate) attribute) not to free a data structure that was created during an out-of-process call, that structure will be destroyed when the call completes.</span></span> <span data-ttu-id="21965-131">Beachten Sie auch den potenziell destruktiven Aufwand, der durch eine ineffiziente Zuordnung von Datenstrukturen entsteht, die jetzt gemarshallt und gemarshallt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="21965-131">Also, consider the potentially destructive overhead created by inefficient allocation of data structures that now need to be marshaled and unmarshaled.</span></span>

<span data-ttu-id="21965-132">Beachten Sie abschließend beim Definieren der **HRESULT** -Rückgabewerte, dass Sie keine Fehlercodes erstellen, die mit com-definierten Einrichtung-Codes in Konflikt \_ stehen (Werte zwischen 0x0000 und 0x01ff sind reserviert) oder die mit anderen **HRESULT** -Werten mit demselben Wert in Konflikt stehen.</span><span class="sxs-lookup"><span data-stu-id="21965-132">Finally, be careful when defining your **HRESULT** return values so that you don't create error codes that conflict with COM-defined FACILITY\_ITF codes (values between 0x0000 and 0x01FF are reserved) or that conflict with other **HRESULT** values with the same value.</span></span> <span data-ttu-id="21965-133">Verwenden Sie nach Möglichkeit die Rückgabewerte für den universellen com-Erfolg und den Fehler, und verwenden [**Sie einen Out**](/windows/desktop/Midl/out-idl) -Parameter anstelle eines **HRESULT**, um spezifische Informationen für den Funktionsaufruf zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="21965-133">Whenever possible, use the universal COM success and failure return values, and use an [**out**](/windows/desktop/Midl/out-idl) parameter, rather than an **HRESULT**, to return information specific to the function call.</span></span>

<span data-ttu-id="21965-134">Weitere Informationen finden Sie unter den folgenden Themen:</span><span class="sxs-lookup"><span data-stu-id="21965-134">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="21965-135">Entwerfen von Remote fähigen Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="21965-135">Designing Remotable Interfaces</span></span>](designing-remotable-interfaces.md)
-   [<span data-ttu-id="21965-136">Verwenden einer COM-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="21965-136">Using a COM Interface</span></span>](using-a-com-interface.md)

## <a name="related-topics"></a><span data-ttu-id="21965-137">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="21965-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="21965-138">Schnittstellendefinitionen und Typbibliotheken</span><span class="sxs-lookup"><span data-stu-id="21965-138">Interface Definitions and Type Libraries</span></span>](/windows/desktop/Midl/interface-definitions-and-type-libraries)
</dt> </dl>

 

 