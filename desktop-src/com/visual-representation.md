---
title: Visuelle Darstellung
description: Ein Steuerelement unterstützt die Positionierung und Anzeige innerhalb des Containers mithilfe von Verbund Dokumenten Technologie und OLE-Drag & Drop-Technologie, die sowohl das Steuerelement als auch den zugehörigen Container umfasst.
ms.assetid: a7940560-360c-4c0d-9ac1-d051adb0b83e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9711dccbc7aa17f0b4a2ff228b2e2e4421e5083b
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "103714418"
---
# <a name="visual-representation"></a><span data-ttu-id="a1ecf-103">Visuelle Darstellung</span><span class="sxs-lookup"><span data-stu-id="a1ecf-103">Visual Representation</span></span>

<span data-ttu-id="a1ecf-104">Ein Steuerelement unterstützt die Positionierung und Anzeige innerhalb des Containers mithilfe von Verbund Dokumenten Technologie und OLE-Drag & Drop-Technologie, die sowohl das Steuerelement als auch den zugehörigen Container umfasst.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-104">A control supports positioning and displaying itself within its container through compound document technology and OLE drag and drop technology that involves both the control and its container.</span></span> <span data-ttu-id="a1ecf-105">Das Steuerelement muss sich selbst zeichnen können, während der Container die Position des Steuer Elements und seine Größe verwaltet.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-105">The control must be able to draw itself while the container manages the position of the control and its size.</span></span>

<span data-ttu-id="a1ecf-106">Steuerelemente werden zu den grundlegenden Funktionen von OLE-Dokumenten hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-106">Controls add to the basic functions provided by OLE documents.</span></span> <span data-ttu-id="a1ecf-107">Ein-Steuerelement ruft die [**IOleClientSite:: requestnewobjectlayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout) -Methode des Clients auf, um dem Container mitzuteilen, dass seine Größe geändert werden soll.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-107">A control calls its client's [**IOleClientSite::RequestNewObjectLayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout) method to tell its container that it wants to change its size.</span></span> <span data-ttu-id="a1ecf-108">Der Client ruft das [**IOleObject:: GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent) -Element des Steuer Elements auf, um die neue Größe zu erhalten, und ruft [**IOleInPlaceObject:: SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects) auf, um das Steuerelement auf seine neue Größe festzulegen.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-108">The client calls the control's [**IOleObject::GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent) to get the new size and calls [**IOleInPlaceObject::SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects) to set the control to its new size.</span></span>

<span data-ttu-id="a1ecf-109">Steuerelemente, die nur [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) oder [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) unterstützen, unterstützen das Caching über [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) nicht, da der Cache Unterstützung für [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)benötigt.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-109">Controls that support only [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) or [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) do not support caching through [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) because the cache requires support for [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage).</span></span> <span data-ttu-id="a1ecf-110">Diese Steuerelemente sollten jedoch die Möglichkeit bieten, das Steuerelement durch [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) zu rendernden, damit der Client optional seinen eigenen Cache der Präsentationsdaten für das Steuerelement erstellen und verwalten kann.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-110">However, these controls should provide a way for the client to render the control through [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) so the client can optionally create and manage its own cache of the presentation data for the control.</span></span>

<span data-ttu-id="a1ecf-111">Steuerelemente verwenden den HIMETRIC-Typ für Ihre Koordinaten.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-111">Controls use the HIMETRIC type for its coordinates.</span></span> <span data-ttu-id="a1ecf-112">Für verschiedene Container können jedoch unterschiedliche Koordinatensysteme verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-112">However, different containers can use different coordinate systems.</span></span> <span data-ttu-id="a1ecf-113">Der Container möchte Koordinaten in seinem eigenen System empfangen, aber das Steuerelement weiß nicht unbedingt, welche Koordinaten sein Container verwendet.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-113">The container wants to receive coordinates in its own system, but the control does not necessarily know what coordinates its container is using.</span></span> <span data-ttu-id="a1ecf-114">Für eine erfolgreiche Kommunikation benötigt das Steuerelement eine Möglichkeit zum Konvertieren von Werten in die Koordinaten des Containers.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-114">To communicate successfully, the control needs a way to convert values to its container's coordinates.</span></span> <span data-ttu-id="a1ecf-115">Der Container stellt ein Site Objekt mit der [**iolecontrolsite:: transformcoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) -Methode bereit.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-115">The container provides a site object with the [**IOleControlSite::TransformCoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) method.</span></span> <span data-ttu-id="a1ecf-116">Das-Steuerelement ruft diese Methode zuerst auf der Client Site des Containers auf, um seine Koordinaten in die entsprechenden Koordinaten für den Container zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-116">The control calls this method on its container's client site first to convert its coordinates into the appropriate coordinates for the container.</span></span> <span data-ttu-id="a1ecf-117">Anschließend können die konvertierten Koordinaten an den Container übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-117">Then, it can pass the converted coordinates to the container.</span></span>

<span data-ttu-id="a1ecf-118">Steuerelemente können [**iolecontrolsite:: lockinplaceactive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) im Site-Objekt des Containers abrufen, um zu verhindern, dass der Container versucht, das Steuerelement aus dem direkten aktiven Zustand herabzusetzen.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-118">Controls can call [**IOleControlSite::LockInPlaceActive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) in the container's site object to prevent the container from attempting to demote the control out of the in-place active state.</span></span> <span data-ttu-id="a1ecf-119">Wenn Sie das Steuerelement auf diese Weise herabstufen, wird das Steuerelement deaktiviert, und das Fenster wird zerstört, sodass das Steuerelement das Fenster für eine bekannte Dauer beibehalten **muss, um seinen Zustand zu Gewähr** leisten.</span><span class="sxs-lookup"><span data-stu-id="a1ecf-119">Demoting the control in this way causes the control to be deactivated and its window destroyed, so if the control must maintain its window for a known duration it can call **LockInPlaceActive** to guarantee its state.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a1ecf-120">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="a1ecf-120">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a1ecf-121">ActiveX-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="a1ecf-121">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 




