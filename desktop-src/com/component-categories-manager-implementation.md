---
title: Implementierung des Komponenten Kategorien-Managers
description: Wenn die Anzahl der verfügbaren Komponenten zunimmt, wird es zunehmend schwieriger, diese Komponenten zu verwalten. Im Hinblick auf die Schnittstellen, die Sie verfügbar machen, und die Aufgaben, die Sie ausführen, bieten viele Komponenten eine ähnliche Funktionalität.
ms.assetid: c2c67129-bf19-465b-8354-193922aeafaa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2414567beba159c05ea08b3561f0a97ddda1cb70
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "103948068"
---
# <a name="component-categories-manager-implementation"></a><span data-ttu-id="ee8a9-104">Implementierung des Komponenten Kategorien-Managers</span><span class="sxs-lookup"><span data-stu-id="ee8a9-104">Component Categories Manager Implementation</span></span>

<span data-ttu-id="ee8a9-105">Wenn die Anzahl der verfügbaren Komponenten zunimmt, wird es zunehmend schwieriger, diese Komponenten zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-105">As the number of available components grows, it becomes increasingly difficult to manage these components.</span></span> <span data-ttu-id="ee8a9-106">Im Hinblick auf die Schnittstellen, die Sie verfügbar machen, und die Aufgaben, die Sie ausführen, bieten viele Komponenten eine ähnliche Funktionalität.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-106">In terms of the interfaces they expose as well as the tasks they perform, many components offer similar functionality.</span></span>

<span data-ttu-id="ee8a9-107">Häufig müssen die Komponenten aufgelistet werden, die in einem bestimmten Kontext verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-107">It is often necessary to enumerate the components that can be used in a certain context.</span></span> <span data-ttu-id="ee8a9-108">Beispiele hierfür sind das Dialogfeld " **Objekt einfügen** ", das in OLE-Verbund Dokumenten verwendet wird, und das Dialogfeld " **Steuerelement einfügen** " in OLE-Steuerelementen</span><span class="sxs-lookup"><span data-stu-id="ee8a9-108">Examples of this are the **Insert Object** dialog box used in OLE compound documents and the **Insert Control** dialog box used in OLE controls.</span></span> <span data-ttu-id="ee8a9-109">In diesen Dialogfeldern werden alle Komponenten aufgelistet, die die Schnittstellen Verträge für Verbund Dokumente oder Steuerelemente erfüllen (oder den Anspruch darauf erfüllen).</span><span class="sxs-lookup"><span data-stu-id="ee8a9-109">These dialog boxes list all components that fulfill (or claim to fulfill) the interface contracts for compound documents or controls.</span></span> <span data-ttu-id="ee8a9-110">Diese vorhandenen Kategorien (OLE-Dokument, OLE-Steuerelement) implizieren keine exakte Schnittstellen Signatur.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-110">These existing categories (OLE document, OLE control) do not imply an exact interface signature.</span></span> <span data-ttu-id="ee8a9-111">OLE-Dokumente müssen einen bestimmten Satz von Kern Schnittstellen (z. b. [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) oder [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)) verfügbar machen, können aber auch zusätzliche Schnittstellen wie [**iolelink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink)verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-111">OLE documents have to expose a certain set of core interfaces (for example, [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) or [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)) but can also expose additional interfaces such as [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span></span>

<span data-ttu-id="ee8a9-112">In der Vergangenheit wurden Komponenten gekennzeichnet, indem ein lesbarer Name ("Insertable", "Control" usw.) als Unterschlüssel für die Stamm- **\_ \_ \\ CLSID \\ {...} der HKEY-Klassen** hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-112">In the past, components have been tagged by adding a human-readable name ("Insertable", "Control", and so on) as a subkey to the **HKEY\_CLASSES\_ROOT\\CLSID\\{...}**</span></span> <span data-ttu-id="ee8a9-113">Registrierungsschlüssel, der der Komponente entspricht.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-113">registry key corresponding to the component.</span></span> <span data-ttu-id="ee8a9-114">Dies funktioniert gut für eine zentrale Definition von Kategorien, birgt jedoch Risiken Namenskollisionen, wenn viele unabhängige Parteien neue Kategorien definieren.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-114">This works well for a central definition of categories but risks name collisions when many independent parties define new categories.</span></span> <span data-ttu-id="ee8a9-115">Wie in anderen Bereichen von com liegt die Lösung zur Bereitstellung eines erweiterbaren Namespace in der Verwendung von GUIDs (Global Unique Identifier).</span><span class="sxs-lookup"><span data-stu-id="ee8a9-115">As in other areas of COM, the solution to providing an extensible namespace lies in the use of globally unique identifiers (GUIDs).</span></span> <span data-ttu-id="ee8a9-116">Anstatt einen lesbaren Namen zu verwenden, wird jeder Kategorie eine eindeutige Zahl (CATID) zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-116">Instead of using a human-readable name, a unique number (CATID) is assigned to each category.</span></span>

<span data-ttu-id="ee8a9-117">Eine weitere Einschränkung bei der vorhandenen Kategorisierung besteht darin, dass Sie auf das Ausdrücken der Funktionen der Komponente selbst beschränkt ist.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-117">Another limitation with the existing categorization is that it is limited to expressing the capabilities of the component itself.</span></span> <span data-ttu-id="ee8a9-118">Viele Komponenten erfordern bestimmte Funktionen aus den Containern.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-118">Many components require certain capabilities from the containers.</span></span> <span data-ttu-id="ee8a9-119">Wenn eine solche Komponente in einen Container eingefügt wird, kann die Einfügung fehlschlagen oder sich unerwartet Verhalten, auch wenn die Komponente die Verträge erfüllt, die von einer ihrer Kategorien impliziert werden.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-119">When such a component is inserted into a container, the insertion can fail or behave unexpectedly, even though the component fulfills the contracts implied by one of its categories.</span></span> <span data-ttu-id="ee8a9-120">Zum Auflisten der Komponenten, die in bestimmten Situationen erfolgreich verwendet werden können, müssen die Funktionen der Komponente und des Containers berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-120">To enumerate the components that can be used successfully in certain situations, the capabilities of both the component and the container must be considered.</span></span>

<span data-ttu-id="ee8a9-121">Aufgrund dieser Überlegungen wurden die folgenden Änderungen an der vorhandenen Kategorisierung vorgenommen:</span><span class="sxs-lookup"><span data-stu-id="ee8a9-121">Because of these considerations, the following changes were made to the existing categorization:</span></span>

-   <span data-ttu-id="ee8a9-122">Kategorien werden mithilfe von CATIDs angegeben, die global eindeutige Bezeichner sind.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-122">Categories are indicated by using CATIDs that are globally unique identifiers.</span></span>
-   <span data-ttu-id="ee8a9-123">Unter dem **Komponenten** Unterschlüssel des Stamm- **\_ \_ \\ CLSID** -Registrierungsschlüssels der HKEY-Klassen wurden zwei separate Unterschlüssel ("implementierte Kategorien" und "erforderliche Kategorien") entwickelt.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-123">Under the **Components** subkey of the **HKEY\_CLASSES\_ROOT\\CLSID** registry key, two separate subkeys, "Implemented Categories" and "Required Categories", were developed.</span></span> <span data-ttu-id="ee8a9-124">Diese Unterschlüssel enthalten die Listen der CATIDs, die von der Komponente bereitgestellt werden, oder die der Container der Komponente bereitstellen muss.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-124">These subkeys contain the lists of CATIDs that are provided by the component or that the container of the component must provide.</span></span>

<span data-ttu-id="ee8a9-125">Um die Verwaltung der Komponenten Kategorien zu vereinfachen, werden Kategorien an einem zentralen Ort in der Registrierung aufgeführt: **HKEY- \_ Klassen Stamm \_ \\ Komponenten Kategorien**.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-125">To ease managing the component categories, categories are listed in a central place in the registry: **HKEY\_CLASSES\_ROOT\\Component Categories**.</span></span> <span data-ttu-id="ee8a9-126">Mit diesem Schlüssel werden die installierten Kategorien sowohl mit ihrer CATID als auch mit lokalisierten, lesbaren Namen aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="ee8a9-126">This key lists the installed categories both with their CATID and with localized, human-readable names.</span></span>

<span data-ttu-id="ee8a9-127">Weitere Informationen finden Sie unter den folgenden Themen:</span><span class="sxs-lookup"><span data-stu-id="ee8a9-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="ee8a9-128">Kategorisierung nach Komponenten Funktionen</span><span class="sxs-lookup"><span data-stu-id="ee8a9-128">Categorizing by Component Capabilities</span></span>](categorizing-by-component-capabilities.md)
-   [<span data-ttu-id="ee8a9-129">Kategorisierung nach Container Funktionen</span><span class="sxs-lookup"><span data-stu-id="ee8a9-129">Categorizing by Container Capabilities</span></span>](categorizing-by-container-capabilities.md)
-   [<span data-ttu-id="ee8a9-130">Der Komponenten Kategorien-Manager</span><span class="sxs-lookup"><span data-stu-id="ee8a9-130">The Component Categories Manager</span></span>](the-component-categories-manager.md)
-   [<span data-ttu-id="ee8a9-131">Standardklassen und-Zuordnungen</span><span class="sxs-lookup"><span data-stu-id="ee8a9-131">Default Classes and Associations</span></span>](default-classes-and-associations.md)
-   [<span data-ttu-id="ee8a9-132">Definieren von Komponenten Kategorien</span><span class="sxs-lookup"><span data-stu-id="ee8a9-132">Defining Component Categories</span></span>](defining-component-categories.md)
-   [<span data-ttu-id="ee8a9-133">Zuordnen von Symbolen zu einer Kategorie</span><span class="sxs-lookup"><span data-stu-id="ee8a9-133">Associating Icons with a Category</span></span>](associating-icons-with-a-category.md)

 

 




