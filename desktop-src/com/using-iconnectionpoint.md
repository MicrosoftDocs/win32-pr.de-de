---
title: Verwenden von IConnectionPoint
description: Verwenden von IConnectionPoint
ms.assetid: afd50b84-1fd6-47ad-a3ef-e8b4a725b72b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe7aa758ec1bd40233b1cc41a6c375ed296fc167
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104039633"
---
# <a name="using-iconnectionpoint"></a><span data-ttu-id="7da1d-103">Verwenden von IConnectionPoint</span><span class="sxs-lookup"><span data-stu-id="7da1d-103">Using IConnectionPoint</span></span>

<span data-ttu-id="7da1d-104">Wenn der Client einen Zeiger auf einen Verbindungspunkt hat, kann er die folgenden Vorgänge ausführen, wie über [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint)ausgedrückt:</span><span class="sxs-lookup"><span data-stu-id="7da1d-104">When the client has a pointer to a connection point, it can perform the following operations as expressed through [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint):</span></span>

-   <span data-ttu-id="7da1d-105">Zuerst ruft [**IConnectionPoint:: GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) die IID der ausgehenden Schnittstelle ab, die vom Verbindungspunkt unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="7da1d-105">First, [**IConnectionPoint::GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) retrieves the outgoing interface IID supported by the connection point.</span></span> <span data-ttu-id="7da1d-106">Bei Verwendung in Verbindung mit [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints)ermöglicht diese Methode dem Client, die IIDs aller ausgehenden Schnittstellen zu überprüfen, die für das Verbindungs fähige Objekt unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="7da1d-106">When used in conjunction with [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints), this method allows the client to examine the IIDs of all outgoing interfaces supported on the connectable object.</span></span>
-   <span data-ttu-id="7da1d-107">Zweitens kann ein Client über die [**IConnectionPoint:: GetConnectionPointContainer**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectionpointcontainer) -Methode vom Verbindungspunkt zurück zur [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) -Schnittstelle des Verbindungs fähigen-Objekts navigieren.</span><span class="sxs-lookup"><span data-stu-id="7da1d-107">Second, a client can navigate from the connection point back to the connectable object's [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) interface through the [**IConnectionPoint::GetConnectionPointContainer**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectionpointcontainer) method.</span></span>
-   <span data-ttu-id="7da1d-108">Drittens sind die interessantesten Methoden für den Client [**IConnectionPoint:: Rat**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) und [**IConnectionPoint:: Unrat**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise).</span><span class="sxs-lookup"><span data-stu-id="7da1d-108">Third, the most interesting methods for the client are [**IConnectionPoint::Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) and [**IConnectionPoint::Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise).</span></span> <span data-ttu-id="7da1d-109">Wenn ein Client ein eigenes Sink-Objekt mit dem Verbindungs fähigen-Objekt verbinden möchte, übergibt der Client den [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Zeiger der Senke (oder einen anderen Schnittstellen Zeiger auf das gleiche Objekt), um zu **informieren**.</span><span class="sxs-lookup"><span data-stu-id="7da1d-109">When a client wishes to connect its own sink object to the connectable object, the client passes the sink's [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) pointer (or any other interface pointer on the same object) to **Advise**.</span></span> <span data-ttu-id="7da1d-110">Der Verbindungspunkt fragt die Senke nach der spezifischen ausgehenden Schnittstelle ab, die erwartet wird.</span><span class="sxs-lookup"><span data-stu-id="7da1d-110">The connection point queries the sink for the specific outgoing interface that is expected.</span></span> <span data-ttu-id="7da1d-111">Wenn diese Schnittstelle in der Senke verfügbar ist, speichert der Verbindungspunkt den Schnittstellen Zeiger.</span><span class="sxs-lookup"><span data-stu-id="7da1d-111">If that interface is available on the sink, the connection point then stores the interface pointer.</span></span> <span data-ttu-id="7da1d-112">Ab diesem **Punkt führt das** Verbindungs fähigen-Objekt über diese Schnittstelle Aufrufe an die Senke, wenn Ereignisse auftreten.</span><span class="sxs-lookup"><span data-stu-id="7da1d-112">From this point until **Unadvise** is called, the connectable object will make calls to the sink through this interface when events occur.</span></span> <span data-ttu-id="7da1d-113">Um die Senke vom Verbindungspunkt aus zu trennen, übergibt der Client einen von der **Empfehlung** zurückgegebenen Schlüssel an die **unempfehlung** -Methode.</span><span class="sxs-lookup"><span data-stu-id="7da1d-113">To disconnect the sink from the connection point, the client passes a key returned from **Advise** to the **Unadvise** method.</span></span> <span data-ttu-id="7da1d-114">**Nicht Empfehlung** muss [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) auf der Senke-Schnittstelle aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="7da1d-114">**Unadvise** must call [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) on the sink interface.</span></span>
-   <span data-ttu-id="7da1d-115">Zum Schluss kann ein Client einen Verbindungspunkt anweisen, alle Verbindungen mit ihm aufzulisten, die über [**IConnectionPoint:: EnumConnections**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections)vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="7da1d-115">Finally, a client can ask a connection point to enumerate all the connections to it that exist through [**IConnectionPoint::EnumConnections**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections).</span></span> <span data-ttu-id="7da1d-116">Diese Methode erstellt ein Enumeratorobjekt (mit einem separaten Verweis Zähler), das einen [**IEnumConnections**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) -Zeiger darauf zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="7da1d-116">This method creates an enumerator object (with a separate reference count) returning an [**IEnumConnections**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) pointer to it.</span></span> <span data-ttu-id="7da1d-117">Der Client muss [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) aufzurufen, wenn der Enumerator nicht mehr benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="7da1d-117">The client must call [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) when the enumerator is no longer needed.</span></span> <span data-ttu-id="7da1d-118">Außerdem gibt der Enumerator eine Reihe von [**CONNECTDATA**](/windows/win32/api/ocidl/ns-ocidl-connectdata) -Strukturen zurück, jeweils eine für jede Verbindung.</span><span class="sxs-lookup"><span data-stu-id="7da1d-118">Additionally, the enumerator returns a series of [**CONNECTDATA**](/windows/win32/api/ocidl/ns-ocidl-connectdata) structures, one for each connection.</span></span> <span data-ttu-id="7da1d-119">Jede Struktur beschreibt eine Verbindung mithilfe des [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Zeigers der Senke und des ursprünglich von der [**Empfehlung**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise)zurückgegebenen Verbindungs Schlüssels.</span><span class="sxs-lookup"><span data-stu-id="7da1d-119">Each structure describes one connection using the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) pointer of the sink as well as the connection key originally returned from [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise).</span></span> <span data-ttu-id="7da1d-120">Wenn diese Senke-Schnittstellen Zeiger erreicht werden, muss der Client **Release** für jeden Zeiger, der in einer **CONNECTDATA** -Struktur zurückgegeben wird, abrufen.</span><span class="sxs-lookup"><span data-stu-id="7da1d-120">When done with these sink interface pointers, the client must call **Release** on each pointer returned in a **CONNECTDATA** structure.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7da1d-121">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="7da1d-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7da1d-122">Verbindungs fähige Objekt Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="7da1d-122">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 