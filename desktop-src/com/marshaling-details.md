---
title: Marshalling von Details
description: Wenn Sie das standardmäßige Marshalling verwenden, werden alle hier beschriebenen Details von com behandelt.
ms.assetid: bf3fe212-648e-4d00-ad1d-43d2e5e6a7ae
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f4d0fd46ee29c712c6f2b5b286df76a30f1047e6
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/03/2021
ms.locfileid: "106366350"
---
# <a name="marshaling-details"></a><span data-ttu-id="df8e4-103">Marshalling von Details</span><span class="sxs-lookup"><span data-stu-id="df8e4-103">Marshaling Details</span></span>

<span data-ttu-id="df8e4-104">Wenn Sie das standardmäßige Marshalling verwenden, werden alle hier beschriebenen Details von com behandelt.</span><span class="sxs-lookup"><span data-stu-id="df8e4-104">If you use standard marshaling, COM handles all of the details described here for you.</span></span> <span data-ttu-id="df8e4-105">Es gibt jedoch einige Programmierer, die diese Details benötigen, und für diejenigen, die an den zugrunde liegenden Informationen interessiert sind.</span><span class="sxs-lookup"><span data-stu-id="df8e4-105">However, there are those few programmers who need these details and for those interested in the underlying information.</span></span> <span data-ttu-id="df8e4-106">Beim Marshalling handelt es sich um das Verpacken und entpacken von Parametern, sodass ein Remote Prozedur Aufrufvorgang erfolgen kann.</span><span class="sxs-lookup"><span data-stu-id="df8e4-106">Marshaling is the process of packaging and unpackaging parameters so a remote procedure call can take place.</span></span>

<span data-ttu-id="df8e4-107">Unterschiedliche Parametertypen werden auf unterschiedliche Weise gemarshallt.</span><span class="sxs-lookup"><span data-stu-id="df8e4-107">Different parameter types are marshaled in different ways.</span></span> <span data-ttu-id="df8e4-108">Das Marshalling eines ganzzahligen Parameters umfasst z. b. das einfache Kopieren des Werts in den Nachrichten Puffer.</span><span class="sxs-lookup"><span data-stu-id="df8e4-108">For example, marshaling an integer parameter involves simply copying the value into the message buffer.</span></span> <span data-ttu-id="df8e4-109">(Obwohl es auch in diesem einfachen Fall Probleme gibt, wie z. b. die Byte-Reihenfolge bei Computer übergreifenden aufrufen.) Das Marshalling eines Arrays ist jedoch komplexer.</span><span class="sxs-lookup"><span data-stu-id="df8e4-109">(Although even in this simple case, there are issues such as byte ordering to deal with in cross-computer calls.) Marshaling an array, however, is a more complex process.</span></span> <span data-ttu-id="df8e4-110">Arraymember werden in einer bestimmten Reihenfolge kopiert, sodass das Array von der anderen Seite exakt rekonstruiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="df8e4-110">Array members are copied in a specific order so that the other side can reconstruct the array exactly.</span></span> <span data-ttu-id="df8e4-111">Wenn ein Zeiger gemarshallt wird, werden die Daten, auf die der Zeiger verweist, nach den Regeln und Konventionen für den Umgang mit schsted-Zeigern in Strukturen kopiert.</span><span class="sxs-lookup"><span data-stu-id="df8e4-111">When a pointer is marshaled, the data that the pointer is pointing to is copied following rules and conventions for dealing with nested pointers in structures.</span></span> <span data-ttu-id="df8e4-112">Eindeutige Funktionen sind vorhanden, um das Marshalling der einzelnen Parametertypen zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="df8e4-112">Unique functions exist to handle the marshaling of each parameter type.</span></span>

<span data-ttu-id="df8e4-113">Beim Standardmarshalling sind die Proxys und stubys systemweite Ressourcen für die Schnittstelle, und Sie interagieren mit dem Kanal über ein Standardprotokoll.</span><span class="sxs-lookup"><span data-stu-id="df8e4-113">With standard marshaling, the proxies and stubs are systemwide resources for the interface and they interact with the channel through a standard protocol.</span></span> <span data-ttu-id="df8e4-114">Standardmäßiges Marshalling kann sowohl durch COM-Standardschnittstellen als auch durch benutzerdefinierte Schnittstellen verwendet werden, wie im folgenden dargestellt:</span><span class="sxs-lookup"><span data-stu-id="df8e4-114">Standard marshaling can be used both by standard COM-defined interfaces and by custom interfaces, as follows:</span></span>

-   <span data-ttu-id="df8e4-115">Bei den meisten COM-Schnittstellen sind die Proxys und stubvorgänge für das Standardmarshalling Prozess interne Komponenten Objekte, die aus einer systemweiten dll geladen werden, die von com in Ole32.dll bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="df8e4-115">In the case of most COM interfaces, the proxies and stubs for standard marshaling are in-process component objects which are loaded from a systemwide DLL provided by COM in Ole32.dll.</span></span>
-   <span data-ttu-id="df8e4-116">Im Fall von benutzerdefinierten Schnittstellen werden die Proxys und stufys für das Standard-Marshalling vom Schnittstellen-Designer generiert, in der Regel mit der mittleren l.</span><span class="sxs-lookup"><span data-stu-id="df8e4-116">In the case of custom interfaces, the proxies and stubs for standard marshaling are generated by the interface designer, typically with MIDL.</span></span> <span data-ttu-id="df8e4-117">Diese Proxys und stubys werden statisch in der Registrierung konfiguriert, sodass jeder potenzielle Client die benutzerdefinierte Schnittstelle über Prozess Grenzen hinweg verwenden kann.</span><span class="sxs-lookup"><span data-stu-id="df8e4-117">These proxies and stubs are statically configured in the registry, so any potential client can use the custom interface across process boundaries.</span></span> <span data-ttu-id="df8e4-118">Diese Proxys und stubys werden mithilfe der Schnittstellen-ID (IID) für die benutzerdefinierte Schnittstelle, die Sie marshallt, aus einer DLL geladen, die sich über die Systemregistrierung befindet.</span><span class="sxs-lookup"><span data-stu-id="df8e4-118">These proxies and stubs are loaded from a DLL that is located via the system registry, using the interface ID (IID) for the custom interface they marshal.</span></span>
-   <span data-ttu-id="df8e4-119">Eine Alternative zur Verwendung von "Mittell" zum Generieren von Proxys und stuften für benutzerdefinierte Schnittstellen kann stattdessen eine Typbibliothek generiert werden, und das vom System bereitgestellte System, das vom System bereitgestellt wird, wird die Schnittstelle Mars Hallen.</span><span class="sxs-lookup"><span data-stu-id="df8e4-119">An alternative to using MIDL to generate proxies and stubs for custom interfaces, a type library can be generated instead and the system provided, type-libraryâ€“driven marshaling engine will marshal the interface.</span></span>

<span data-ttu-id="df8e4-120">Als Alternative zum Standard-Marshalling kann eine Schnittstelle (Standard oder Benutzer definiert) benutzerdefiniertes Marshalling verwenden.</span><span class="sxs-lookup"><span data-stu-id="df8e4-120">As an alternative to standard marshaling, an interface (standard or custom) can use custom marshaling.</span></span> <span data-ttu-id="df8e4-121">Beim benutzerdefinierten Marshalling implementiert ein Objekt die Proxys zur Laufzeit dynamisch für jede Schnittstelle, die es unterstützt.</span><span class="sxs-lookup"><span data-stu-id="df8e4-121">With custom marshaling, an object dynamically implements the proxies at run time for each interface that it supports.</span></span> <span data-ttu-id="df8e4-122">Für eine beliebige Schnittstelle kann das Objekt von com bereitgestelltes Standard Marshalling oder benutzerdefiniertes Marshalling auswählen.</span><span class="sxs-lookup"><span data-stu-id="df8e4-122">For any given interface, the object can select COM-provided standard marshaling or custom marshaling.</span></span> <span data-ttu-id="df8e4-123">Diese Auswahl erfolgt durch das-Objekt auf Schnittstellen Basis.</span><span class="sxs-lookup"><span data-stu-id="df8e4-123">This choice is made by the object on an interface-by-interface basis.</span></span> <span data-ttu-id="df8e4-124">Nachdem die Auswahl für eine bestimmte Schnittstelle getroffen wurde, bleibt Sie während der Lebensdauer des Objekts wirksam.</span><span class="sxs-lookup"><span data-stu-id="df8e4-124">Once the choice is made for a given interface, it remains in effect during the object's lifetime.</span></span> <span data-ttu-id="df8e4-125">Eine Schnittstelle für ein Objekt kann jedoch ein benutzerdefiniertes Marshalling verwenden, während ein anderes Standardmäßiges Marshalling verwendet.</span><span class="sxs-lookup"><span data-stu-id="df8e4-125">However, one interface on an object can use custom marshaling while another uses standard marshaling.</span></span>

<span data-ttu-id="df8e4-126">Das benutzerdefinierte Marshalling ist von Natur aus eindeutig für das Objekt, das es implementiert.</span><span class="sxs-lookup"><span data-stu-id="df8e4-126">Custom marshaling is inherently unique to the object that implements it.</span></span> <span data-ttu-id="df8e4-127">Sie verwendet Proxys, die vom-Objekt implementiert werden, und wird für die Anforderung zur Laufzeit dem System bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="df8e4-127">It uses proxies implemented by the object and provided to the system on request at run time.</span></span> <span data-ttu-id="df8e4-128">Objekte, die das benutzerdefinierte Marshalling implementieren, müssen die [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) -Schnittstelle implementieren, wohingegen Objekte, die das Standardmarshalling unterstützen, nicht.</span><span class="sxs-lookup"><span data-stu-id="df8e4-128">Objects that implement custom marshaling must implement the [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) interface, whereas objects that support standard marshaling do not.</span></span>

<span data-ttu-id="df8e4-129">Wenn Sie sich dafür entscheiden, eine benutzerdefinierte Schnittstelle zu schreiben, müssen Sie Marshalling unterstützen.</span><span class="sxs-lookup"><span data-stu-id="df8e4-129">If you decide to write a custom interface, you must provide marshaling support for it.</span></span> <span data-ttu-id="df8e4-130">In der Regel stellen Sie eine standardmäßige Marshalling-DLL für die von Ihnen entworfene Schnittstelle bereit.</span><span class="sxs-lookup"><span data-stu-id="df8e4-130">Typically, you will provide a standard marshaling DLL for the interface you design.</span></span> <span data-ttu-id="df8e4-131">Sie können den Proxy-/Stubcode und die Proxy-/Stub-DLL erstellen, oder Sie können eine Typbibliothek erstellen, mit der com das datengesteuerte Marshalling durchführt (mithilfe der Daten in der Typbibliothek).</span><span class="sxs-lookup"><span data-stu-id="df8e4-131">You can create the proxy/stub code and the proxy/stub DLL, or you can create a type library that COM will use to do data-driven marshaling (using the data in the type library).</span></span>

<span data-ttu-id="df8e4-132">Damit ein Client eine Schnittstellen Methode in einem-Objekt in einem anderen Prozess aufruft, umfasst die Zusammenarbeit mehrerer-Komponenten.</span><span class="sxs-lookup"><span data-stu-id="df8e4-132">For a client to make a call to an interface method in an object in another process involves the cooperation of several components.</span></span> <span data-ttu-id="df8e4-133">Der Standard Proxy ist ein Teil Schnittstellen spezifischer Code, der sich im Prozessbereich des Clients befindet und die Schnittstellenparameter für die Übertragung vorbereitet.</span><span class="sxs-lookup"><span data-stu-id="df8e4-133">The standard proxy is a piece of interface-specific code that resides in the client's process space and prepares the interface parameters for transmittal.</span></span> <span data-ttu-id="df8e4-134">Sie verpackt oder Marshalls Sie so, dass Sie im Empfangs Prozess neu erstellt und verstanden werden können.</span><span class="sxs-lookup"><span data-stu-id="df8e4-134">It packages, or marshals, them in such a way that they can be re-created and understood in the receiving process.</span></span> <span data-ttu-id="df8e4-135">Der standardstub, auch ein Teil Schnittstellen spezifischer Code, befindet sich im Prozessbereich des Servers und kehrt die Arbeit des Proxys um.</span><span class="sxs-lookup"><span data-stu-id="df8e4-135">The standard stub, also a piece of interface-specific code, resides in the server's process space and reverses the work of the proxy.</span></span> <span data-ttu-id="df8e4-136">Der Stub entpackt die gesendeten Parameter und leitet Sie an die Objekt Anwendung weiter.</span><span class="sxs-lookup"><span data-stu-id="df8e4-136">The stub unpackages, or unmarshals, the sent parameters and forwards them to the object application.</span></span> <span data-ttu-id="df8e4-137">Außerdem werden Antwortinformationen verpackt, die an den Client zurückgesendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="df8e4-137">It also packages reply information to send back to the client.</span></span>

> [!Note]  
> <span data-ttu-id="df8e4-138">Leser, die mit RPC als com vertraut sind, können verwendet werden, um die Begriffe Client-Stub und Server-Stub zu sehen.</span><span class="sxs-lookup"><span data-stu-id="df8e4-138">Readers more familiar with RPC than COM may be used to seeing the terms client stub and server stub.</span></span> <span data-ttu-id="df8e4-139">Diese Begriffe sind analog zu Proxy und Stub.</span><span class="sxs-lookup"><span data-stu-id="df8e4-139">These terms are analogous to proxy and stub.</span></span>

 

## <a name="components-of-interprocess-communications"></a><span data-ttu-id="df8e4-140">Komponenten der prozessübergreifenden Kommunikation</span><span class="sxs-lookup"><span data-stu-id="df8e4-140">Components of Interprocess Communications</span></span>

<span data-ttu-id="df8e4-141">Das folgende Diagramm zeigt den Kommunikationsfluss zwischen den beteiligten Komponenten.</span><span class="sxs-lookup"><span data-stu-id="df8e4-141">The following diagram shows the flow of communication between the components involved.</span></span> <span data-ttu-id="df8e4-142">Auf der Clientseite der Prozess Grenze durchläuft der Methodenaufrufe des Clients den Proxy und dann auf den Kanal, der Teil der com-Bibliothek ist.</span><span class="sxs-lookup"><span data-stu-id="df8e4-142">On the client side of the process boundary, the client's method call goes through the proxy and then onto the channel, which is part of the COM library.</span></span> <span data-ttu-id="df8e4-143">Der Kanal sendet den Puffer mit den gemarshallten Parametern an die RPC-Lauf Zeit Bibliothek, die ihn über die Prozess Grenze überträgt.</span><span class="sxs-lookup"><span data-stu-id="df8e4-143">The channel sends the buffer containing the marshaled parameters to the RPC run-time library, which transmits it across the process boundary.</span></span> <span data-ttu-id="df8e4-144">Die RPC-Laufzeit und die com-Bibliotheken sind auf beiden Seiten des Prozesses vorhanden.</span><span class="sxs-lookup"><span data-stu-id="df8e4-144">The RPC run time and the COM libraries exist on both sides of the process.</span></span> <span data-ttu-id="df8e4-145">Der Unterschied zwischen dem Kanal und der RPC-Laufzeit ist ein Merkmal dieser Implementierung und ist nicht Teil des Programmiermodells oder des konzeptionellen Modells für com-Client/Server-Objekte.</span><span class="sxs-lookup"><span data-stu-id="df8e4-145">The distinction between the channel and the RPC run time is a characteristic of this implementation and is not part of the programming model or the conceptual model for COM client/server objects.</span></span> <span data-ttu-id="df8e4-146">COM-Server sehen nur den Proxy oder den Stub und, indirekt, den Kanal.</span><span class="sxs-lookup"><span data-stu-id="df8e4-146">COM servers see only the proxy or stub and, indirectly, the channel.</span></span> <span data-ttu-id="df8e4-147">In zukünftigen Implementierungen können unter dem Kanal oder ohne Ebenen unterschiedliche Ebenen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="df8e4-147">Future implementations may use different layers below the channel or no layers.</span></span>

![Diagramm, das die Client.exe-und Server.exe Flows auf jeder Seite mit der Prozess Grenze anzeigt.](images/457036c1-98b8-4f35-aebe-70de38112b83.png)

## <a name="related-topics"></a><span data-ttu-id="df8e4-149">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="df8e4-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="df8e4-150">Kanal</span><span class="sxs-lookup"><span data-stu-id="df8e4-150">Channel</span></span>](channel.md)
</dt> <dt>

[<span data-ttu-id="df8e4-151">Kommunikation zwischen Objekten</span><span class="sxs-lookup"><span data-stu-id="df8e4-151">Inter-Object Communication</span></span>](inter-object-communication.md)
</dt> <dt>

[<span data-ttu-id="df8e4-152">Microsoft RPC</span><span class="sxs-lookup"><span data-stu-id="df8e4-152">Microsoft RPC</span></span>](microsoft-rpc.md)
</dt> <dt>

[<span data-ttu-id="df8e4-153">Proxy</span><span class="sxs-lookup"><span data-stu-id="df8e4-153">Proxy</span></span>](proxy.md)
</dt> <dt>

[<span data-ttu-id="df8e4-154">Stub</span><span class="sxs-lookup"><span data-stu-id="df8e4-154">Stub</span></span>](stub.md)
</dt> </dl>

 

 