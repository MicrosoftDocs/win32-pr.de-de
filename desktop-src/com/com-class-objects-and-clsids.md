---
title: COM-Klassen Objekte und CLSIDs
description: Ein com-Server wird als com-Klasse implementiert.
ms.assetid: 0073acdf-38a8-4f1a-aa26-379456a95fca
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1bbfde2f379c4c7589db4cde283c8c67d720b21d
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "106341334"
---
# <a name="com-class-objects-and-clsids"></a><span data-ttu-id="66b4f-103">COM-Klassen Objekte und CLSIDs</span><span class="sxs-lookup"><span data-stu-id="66b4f-103">COM Class Objects and CLSIDs</span></span>

<span data-ttu-id="66b4f-104">Ein com-Server wird als com-Klasse implementiert.</span><span class="sxs-lookup"><span data-stu-id="66b4f-104">A COM server is implemented as a COM class.</span></span> <span data-ttu-id="66b4f-105">Eine *com-Klasse* ist eine Implementierung einer Gruppe von Schnittstellen im Code, die ausgeführt wird, wenn Sie mit einem bestimmten Objekt interagieren.</span><span class="sxs-lookup"><span data-stu-id="66b4f-105">A *COM class* is an implementation of a group of interfaces in code executed whenever you interact with a given object.</span></span> <span data-ttu-id="66b4f-106">Es gibt einen wichtigen Unterschied zwischen einer C++-Klasse und einer com-Klasse: in C++ handelt es sich bei einer Klasse um einen-Typ, während eine COM-Klasse lediglich eine Definition des-Objekts ist und keinen Typ aufweist, obwohl ein C++-Programmierer ihn mithilfe einer C++-Klasse implementieren kann.</span><span class="sxs-lookup"><span data-stu-id="66b4f-106">There is an important distinction between a C++ class and a COM class: In C++, a class is a type, while a COM class is simply a definition of the object and carries no type, although a C++ programmer might implement it by using a C++ class.</span></span> <span data-ttu-id="66b4f-107">COM ist so konzipiert, dass eine Klasse von verschiedenen Anwendungen verwendet werden kann, einschließlich Anwendungen, die ohne Kenntnis der Existenz der jeweiligen Klasse geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="66b4f-107">COM is designed to allow a class to be used by different applications, including applications written without knowledge of that particular class's existence.</span></span> <span data-ttu-id="66b4f-108">Daher ist der Klassen Code für einen bestimmten Objekttyp entweder in einer Dynamic Linked Library (dll) oder in einer anderen ausführbaren Anwendung (exe) vorhanden.</span><span class="sxs-lookup"><span data-stu-id="66b4f-108">Therefore, class code for a given type of object exists either in a dynamic linked library (DLL) or in another executable application (EXE).</span></span>

<span data-ttu-id="66b4f-109">Jede com-Klasse wird durch eine *CLSID* identifiziert, eine eindeutige 128-Bit-GUID, die vom Server registriert werden muss.</span><span class="sxs-lookup"><span data-stu-id="66b4f-109">Each COM class is identified by a *CLSID*, a unique 128-bit GUID, which the server must register.</span></span> <span data-ttu-id="66b4f-110">COM verwendet diese CLSID bei der Anforderung eines Clients, um der DLL oder exe, die den Code enthält, der die-Klasse implementiert, bestimmte Daten zuzuordnen und so eine Instanz des-Objekts zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="66b4f-110">COM uses this CLSID, at the request of a client, to associate specific data with the DLL or EXE containing the code that implements the class, thus creating an instance of the object.</span></span>

<span data-ttu-id="66b4f-111">Für Clients und Server auf demselben Computer ist die CLSID des Servers alles, was der Client jemals benötigt.</span><span class="sxs-lookup"><span data-stu-id="66b4f-111">For clients and servers on the same computer, the CLSID of the server is all the client ever needs.</span></span> <span data-ttu-id="66b4f-112">Auf jedem Computer verwaltet com eine Datenbank (die Systemregistrierung auf Microsoft Windows-und Macintosh-Plattformen nutzt) aller CLSIDs für die auf dem System installierten Server.</span><span class="sxs-lookup"><span data-stu-id="66b4f-112">On each computer, COM maintains a database (it makes use of the system registry on Microsoft Windows and Macintosh platforms) of all the CLSIDs for the servers installed on the system.</span></span> <span data-ttu-id="66b4f-113">Dabei handelt es sich um eine Zuordnung zwischen jeder CLSID und dem Speicherort der DLL oder exe-Datei, die den Code für diese CLSID enthält.</span><span class="sxs-lookup"><span data-stu-id="66b4f-113">This is a mapping between each CLSID and the location of the DLL or EXE that houses the code for that CLSID.</span></span> <span data-ttu-id="66b4f-114">COM konsultiert diese Datenbank immer dann, wenn ein Client eine Instanz einer com-Klasse erstellen und seine Dienste verwenden möchte, damit der Client niemals den absoluten Speicherort des Codes auf dem Computer kennen muss.</span><span class="sxs-lookup"><span data-stu-id="66b4f-114">COM consults this database whenever a client wants to create an instance of a COM class and use its services, so the client never needs to know the absolute location of the code on the computer.</span></span>

<span data-ttu-id="66b4f-115">Bei verteilten Systemen stellt com Registrierungseinträge bereit, mit denen sich ein Remote Server selbst für die Verwendung durch einen Client registrieren kann.</span><span class="sxs-lookup"><span data-stu-id="66b4f-115">For distributed systems, COM provides registry entries that allow a remote server to register itself for use by a client.</span></span> <span data-ttu-id="66b4f-116">Obwohl Anwendungen nur eine CLSID eines Servers benötigen, da Sie sich auf die Registrierung des Servers verlassen können, ermöglicht com Clients das Überschreiben von Registrierungs Einträgen und das Angeben von Serverstandorten, um das Netzwerk in vollem Umfang zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="66b4f-116">While applications need know only a server's CLSID, because they can rely on the registry to locate the server, COM allows clients to override registry entries and to specify server locations, to take full advantage of the network.</span></span> <span data-ttu-id="66b4f-117">(Siehe suchen [eines Remote Objekts](locating-a-remote-object.md).)</span><span class="sxs-lookup"><span data-stu-id="66b4f-117">(See [Locating a Remote Object](locating-a-remote-object.md).)</span></span>

<span data-ttu-id="66b4f-118">Die grundlegende Möglichkeit zum Erstellen einer Instanz einer-Klasse ist die Verwendung eines com- *Klassen Objekts*.</span><span class="sxs-lookup"><span data-stu-id="66b4f-118">The basic way to create an instance of a class is through a COM *class object*.</span></span> <span data-ttu-id="66b4f-119">Dabei handelt es sich einfach um ein zwischen Objekt, das Funktionen unterstützt, die zum Erstellen neuer Instanzen einer bestimmten Klasse gemeinsam sind.</span><span class="sxs-lookup"><span data-stu-id="66b4f-119">This is simply an intermediate object that supports functions common to creating new instances of a given class.</span></span> <span data-ttu-id="66b4f-120">Die meisten Klassen Objekte, die zum Erstellen von Objekten aus einer CLSID verwendet werden, unterstützen die [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) -Schnittstelle, eine Schnittstelle mit der wichtigen Methode " [**kreateinstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) "</span><span class="sxs-lookup"><span data-stu-id="66b4f-120">Most class objects used to create objects from a CLSID support the [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, an interface that includes the important [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) method.</span></span> <span data-ttu-id="66b4f-121">Sie implementieren eine **IClassFactory** -Schnittstelle für jede Objektklasse, die Sie instanziiert werden.</span><span class="sxs-lookup"><span data-stu-id="66b4f-121">You implement an **IClassFactory** interface for each class of object that you offer to be instantiated.</span></span> <span data-ttu-id="66b4f-122">(Weitere Informationen zum Implementieren von **IClassFactory** finden Sie unter [Implementieren von IClassFactory](implementing-iclassfactory.md).)</span><span class="sxs-lookup"><span data-stu-id="66b4f-122">(For more information about implementing **IClassFactory**, see [Implementing IClassFactory](implementing-iclassfactory.md).)</span></span>

> [!Note]  
> <span data-ttu-id="66b4f-123">Server, die eine andere benutzerdefinierte Klassenfactoryschnittstelle unterstützen, müssen [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) nicht speziell unterstützen.</span><span class="sxs-lookup"><span data-stu-id="66b4f-123">Servers that support some other custom class factory interface are not required to support [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) specifically.</span></span> <span data-ttu-id="66b4f-124">Aufrufe von anderen Aktivierungs Funktionen als [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (z. b. [**cokreateinstanceex**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) erfordern jedoch, dass der Server **IClassFactory** unterstützt.</span><span class="sxs-lookup"><span data-stu-id="66b4f-124">However, calls to activation functions other than [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (such as [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) require that the server support **IClassFactory**.</span></span>

 

<span data-ttu-id="66b4f-125">Wenn ein Client eine Instanz des Server Objekts erstellen möchte, verwendet er die CLSID des gewünschten Objekts in einem Aufrufen von [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span><span class="sxs-lookup"><span data-stu-id="66b4f-125">When a client wants to create an instance of the server's object, it uses the desired object's CLSID in a call to [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span></span> <span data-ttu-id="66b4f-126">(Dieser-Befehl kann entweder direkt oder implizit über eine der Hilfsfunktionen für die Objekt Erstellung erfolgen.) Diese Funktion dient zum Lokalisieren des mit der CLSID verknüpften Codes, erstellt ein Klassenobjekt und stellt einen Zeiger auf die angeforderte-Schnittstelle bereit.</span><span class="sxs-lookup"><span data-stu-id="66b4f-126">(This call can be either direct or implicit, through one of the object creation helper functions.) This function locates the code associated with the CLSID, and creates a class object, and supplies a pointer to the interface requested.</span></span> <span data-ttu-id="66b4f-127">(**CoGetClassObject** nimmt einen *riid* -Parameter an, der den gewünschten Schnittstellen Zeiger des Clients angibt.)</span><span class="sxs-lookup"><span data-stu-id="66b4f-127">(**CoGetClassObject** takes a *riid* param that specifies the client's desired interface pointer.)</span></span>

> [!Note]  
> <span data-ttu-id="66b4f-128">COM verfügt nur über einige Funktionen, auf denen viele der anderen erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="66b4f-128">COM has just a few functions upon which many of the others are built.</span></span> <span data-ttu-id="66b4f-129">Die wichtigste davon ist wahrscheinlich [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), das allen Instanzen Erstellungs Funktionen zugrunde liegt.</span><span class="sxs-lookup"><span data-stu-id="66b4f-129">The most important of these is probably [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which underlies all of the instance creation functions.</span></span>

 

<span data-ttu-id="66b4f-130">Mit diesem Zeiger kann der Aufrufer eine Instanz des Objekts erstellen und einen Zeiger auf eine angeforderte Schnittstelle für das Objekt abrufen.</span><span class="sxs-lookup"><span data-stu-id="66b4f-130">With this pointer, the caller can create an instance of the object and retrieve a pointer to a requested interface on the object.</span></span> <span data-ttu-id="66b4f-131">Dabei handelt es sich normalerweise um eine Initialisierungs Schnittstelle, mit der das Objekt aktiviert (in den Zustand "wird ausgeführt" versetzt wird), sodass der Client die Arbeit mit dem gewünschten Objekt erledigen kann.</span><span class="sxs-lookup"><span data-stu-id="66b4f-131">This is usually an initialization interface, used to activate the object (put it in the running state) so that the client can do whatever work with the object that it wants to.</span></span> <span data-ttu-id="66b4f-132">Mit den grundlegenden Funktionen von com muss der Client auch darauf achten, alle Objekt Zeiger freizugeben.</span><span class="sxs-lookup"><span data-stu-id="66b4f-132">Using COM's basic functions, the client must also take care to release all object pointers.</span></span>

<span data-ttu-id="66b4f-133">Ein weiterer Mechanismus zum Aktivieren von Objektinstanzen ist der klassenmoniker.</span><span class="sxs-lookup"><span data-stu-id="66b4f-133">Another mechanism for activating object instances is through the class moniker.</span></span> <span data-ttu-id="66b4f-134">Klassenmoniker binden an das Klassenobjekt der Klasse, für die Sie erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="66b4f-134">Class monikers bind to the class object of the class for which they are created.</span></span> <span data-ttu-id="66b4f-135">Weitere Informationen finden Sie unter [klassenmoniker](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="66b4f-135">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="66b4f-136">COM bietet mehrere Hilfsfunktionen, die das Erstellen von Objektinstanzen reduzieren.</span><span class="sxs-lookup"><span data-stu-id="66b4f-136">COM provides several helper functions that reduce the work of creating object instances.</span></span> <span data-ttu-id="66b4f-137">Diese werden in [Hilfsfunktionen](instance-creation-helper-functions.md)für die Instanzerstellung beschrieben.</span><span class="sxs-lookup"><span data-stu-id="66b4f-137">These are described in [Instance Creation Helper Functions](instance-creation-helper-functions.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="66b4f-138">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="66b4f-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="66b4f-139">Erstellen eines Objekts über ein Klassenobjekt</span><span class="sxs-lookup"><span data-stu-id="66b4f-139">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 