---
title: Definieren von COM-Schnittstellen
description: Microsoft definiert viele COM-Schnittstellen. In den meisten Fällen können Sie diese generischen Schnittstellen wieder verwenden. Allerdings gelten für einige Anwendungen bestimmte Anforderungen, die es wünschenswert machen, ihre eigenen Objekt Schnittstellen zu definieren.
ms.assetid: 8a94bd7d-d101-411c-97de-9e9a46bf9591
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 516c02a2c337b2c76229094b0e42d75b44f65d16
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104102402"
---
# <a name="defining-com-interfaces"></a><span data-ttu-id="ef9e7-105">Definieren von COM-Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="ef9e7-105">Defining COM Interfaces</span></span>

<span data-ttu-id="ef9e7-106">Microsoft definiert viele COM-Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-106">Microsoft defines many COM interfaces.</span></span> <span data-ttu-id="ef9e7-107">In den meisten Fällen können Sie diese generischen Schnittstellen wieder verwenden.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-107">In most cases, you can reuse these generic interfaces.</span></span> <span data-ttu-id="ef9e7-108">Allerdings gelten für einige Anwendungen bestimmte Anforderungen, die es wünschenswert machen, ihre eigenen Objekt Schnittstellen zu definieren.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-108">However, some applications have specific requirements that make it desirable or necessary to define your own object interfaces.</span></span>

<span data-ttu-id="ef9e7-109">Alle COM-Schnittstellen müssen direkt oder indirekt von der [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) -Schnittstelle abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-109">All COM interfaces must derive, directly or indirectly, from the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="ef9e7-110">Innerhalb dieser Einschränkung kann die benutzerdefinierte Schnittstelle fast jede Methode oder jeden Parameter unterstützen, einschließlich asynchroner Methoden.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-110">Within that constraint, your custom interface can support almost any method or parameter, including asynchronous methods.</span></span> <span data-ttu-id="ef9e7-111">Sie können auch eine Typbibliothek für die benutzerdefinierten Schnittstellen generieren, damit Clients zur Laufzeit auf Informationen zu den Methoden des Objekts zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-111">You can also generate a type library for your custom interfaces so that clients can access information about your object's methods at run time.</span></span> <span data-ttu-id="ef9e7-112">Nachdem Sie eine Schnittstelle definiert haben, beschreiben Sie Sie in Microsoft Interface Definition Language (mittlerer l), kompilieren und registrieren Sie Sie wie jede generische Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-112">After you define an interface, describe it in Microsoft Interface Definition Language (MIDL), compile and register it, you use it just like any generic interface.</span></span> <span data-ttu-id="ef9e7-113">Mit verteiltem com sind Schnittstellen Methoden sowohl für Remote Prozesse als auch für andere Prozesse auf dem gleichen Computer verfügbar.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-113">With distributed COM, interface methods are available both to remote processes and to other processes on the same computer.</span></span>

<span data-ttu-id="ef9e7-114">Zum Schluss erfordert das Entwickeln von COM-Schnittstellen eine Entwicklungsumgebung, die einen C/C++-Compiler und den Midl.exe Compiler umfasst.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-114">Finally, building COM interfaces requires a development environment that includes a C/C++ compiler and the Midl.exe compiler.</span></span>

<span data-ttu-id="ef9e7-115">Die Schritte zum Erstellen einer COM-Schnittstelle lauten wie folgt:</span><span class="sxs-lookup"><span data-stu-id="ef9e7-115">The steps in creating a COM interface are as follows:</span></span>

-   <span data-ttu-id="ef9e7-116">Entscheiden Sie, wie Sie marshalingunterstützung für Ihre Schnittstelle bereitstellen möchten. entweder mit einem Typbibliotheks gesteuerten Marshalling oder mit einer Proxy-/Stub-DLL.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-116">Decide how you want to provide marshaling support for your interface; either with type-library driven marshaling or with a proxy/stub DLL.</span></span> <span data-ttu-id="ef9e7-117">Sogar in-Process-Schnittstellen müssen gemarshallt werden, wenn Sie über Apartment Grenzen hinweg verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-117">Even in-process interfaces must be marshaled if they are to be used across apartment boundaries.</span></span> <span data-ttu-id="ef9e7-118">Es empfiehlt sich, die Marshalling-Unterstützung für jede com-Schnittstelle zu entwickeln, auch wenn Sie nicht glauben, dass Sie Sie benötigen.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-118">It is a good idea to build marshaling support into every COM interface, even if you don't think you will need it.</span></span> <span data-ttu-id="ef9e7-119">Weitere Informationen finden Sie unter [Interface Marshaling.](interface-marshaling.md)</span><span class="sxs-lookup"><span data-stu-id="ef9e7-119">See [Interface Marshaling](interface-marshaling.md) for more information.</span></span>
-   <span data-ttu-id="ef9e7-120">Beschreiben Sie die Schnittstelle oder Schnittstellen in einer Schnittstellen Definitionsdatei (IDL).</span><span class="sxs-lookup"><span data-stu-id="ef9e7-120">Describe the interface or interfaces in an interface definition (IDL) file.</span></span> <span data-ttu-id="ef9e7-121">Außerdem können Sie bestimmte lokale Aspekte Ihrer Schnittstelle in einer Anwendungs Konfigurationsdatei (ACF) angeben.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-121">In addition, you can specify certain local aspects of your interface in an application configuration file (ACF).</span></span> <span data-ttu-id="ef9e7-122">Wenn Sie das Typbibliotheks gesteuerte Marshalling verwenden, fügen Sie eine [**Library**](/windows/desktop/Midl/library) -Anweisung hinzu, die auf die Schnittstellen verweist, für die Sie Typinformationen generieren möchten.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-122">If you are using type-library driven marshaling, add a [**library**](/windows/desktop/Midl/library) statement that references the interfaces for which you want to generate type information.</span></span>
-   <span data-ttu-id="ef9e7-123">Verwenden Sie den Mittelwert Compiler, um eine Typbibliotheks Datei und eine Header Datei zu generieren, bzw. Proxy-/Stubdateien für die C-Sprache, die dll-Datendatei und die Header Datei.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-123">Use the MIDL compiler to generate a type library file and header file, or C-language proxy/stub files, interface identifier file, DLL data file and header file.</span></span> <span data-ttu-id="ef9e7-124">Weitere Informationen finden Sie unter [Mittel l-Kompilierung](midl-compilation.md) .</span><span class="sxs-lookup"><span data-stu-id="ef9e7-124">See [MIDL Compilation](midl-compilation.md) for more information.</span></span>
-   <span data-ttu-id="ef9e7-125">Abhängig von der gewählten Marshallingmethode schreiben Sie eine Modul Definitionsdatei (DEF), kompilieren Sie alle in der Mitte generierten Dateien, und verknüpfen Sie Sie mit einer einzelnen Proxy-dll, und registrieren Sie die Schnittstelle in der Systemregistrierung, oder registrieren Sie die Typbibliothek.</span><span class="sxs-lookup"><span data-stu-id="ef9e7-125">Depending on the marshaling method you chose, write a module definition (DEF) file, compile and link all the MIDL-generated files into a single proxy DLL, and register the interface in the system registry, or register the type library.</span></span> <span data-ttu-id="ef9e7-126">Weitere Informationen finden Sie unter [Laden und Registrieren einer Typbibliothek](loading-and-registering-a-type-library.md) und entwickeln [und Registrieren einer Proxy-dll](building-and-registering-a-proxy-dll.md) .</span><span class="sxs-lookup"><span data-stu-id="ef9e7-126">See [Loading and Registering a Type Library](loading-and-registering-a-type-library.md) and [Building and Registering a Proxy DLL](building-and-registering-a-proxy-dll.md) for more information.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ef9e7-127">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ef9e7-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ef9e7-128">Anatomie einer IDL-Datei</span><span class="sxs-lookup"><span data-stu-id="ef9e7-128">Anatomy of an IDL File</span></span>](anatomy-of-an-idl-file.md)
</dt> <dt>

[<span data-ttu-id="ef9e7-129">COM-Clients und-Server</span><span class="sxs-lookup"><span data-stu-id="ef9e7-129">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="ef9e7-130">Schnittstellen Entwurfs Regeln</span><span class="sxs-lookup"><span data-stu-id="ef9e7-130">Interface Design Rules</span></span>](interface-design-rules.md)
</dt> <dt>

[<span data-ttu-id="ef9e7-131">Das Component Object Model</span><span class="sxs-lookup"><span data-stu-id="ef9e7-131">The Component Object Model</span></span>](the-component-object-model.md)
</dt> </dl>

 

 