---
title: Identitätswechsel
description: Der Identitätswechsel ist die Fähigkeit eines Threads, in einem Sicherheitskontext auszuführen, der sich von dem Kontext des Prozesses unterscheidet, der den Thread besitzt.
ms.assetid: b33ca3b0-0423-4338-b3d6-4bb3db3d3e1b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a735fa12e175ecec5dc2a7ed741843d713532e19
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "104039683"
---
# <a name="impersonation"></a><span data-ttu-id="cd77b-103">Identitätswechsel</span><span class="sxs-lookup"><span data-stu-id="cd77b-103">Impersonation</span></span>

<span data-ttu-id="cd77b-104">Der Identitätswechsel ist die Fähigkeit eines Threads, in einem Sicherheitskontext auszuführen, der sich von dem Kontext des Prozesses unterscheidet, der den Thread besitzt.</span><span class="sxs-lookup"><span data-stu-id="cd77b-104">Impersonation is the ability of a thread to execute in a security context that is different from the context of the process that owns the thread.</span></span> <span data-ttu-id="cd77b-105">Bei der Ausführung im Sicherheitskontext des Clients ist der Server in gewissem Maße der Client.</span><span class="sxs-lookup"><span data-stu-id="cd77b-105">When running in the client's security context, the server "is" the client, to some degree.</span></span> <span data-ttu-id="cd77b-106">Der Server Thread verwendet ein Zugriffs Token, das die Anmelde Informationen des Clients darstellt, um Zugriff auf die Objekte zu erhalten, auf die der Client Zugriff hat.</span><span class="sxs-lookup"><span data-stu-id="cd77b-106">The server thread uses an access token representing the client's credentials to obtain access to the objects to which the client has access.</span></span>

<span data-ttu-id="cd77b-107">Der Hauptgrund für einen Identitätswechsel besteht darin, Zugriffsprüfungen für die Identität des Clients zu initiieren.</span><span class="sxs-lookup"><span data-stu-id="cd77b-107">The primary reason for impersonation is to cause access checks to be performed against the client's identity.</span></span> <span data-ttu-id="cd77b-108">Wird die Identität des Clients für Zugriffsprüfungen verwendet, kann der Zugriff je nach den Berechtigungen des Clients entweder eingeschränkt oder erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="cd77b-108">Using the client's identity for access checks can cause access to be either restricted or expanded, depending on what the client has permission to do.</span></span> <span data-ttu-id="cd77b-109">Nehmen wir beispielsweise an, dass ein Dateiserver über Dateien mit vertraulichen Informationen verfügt und jede dieser Dateien durch eine ACL geschützt wird.</span><span class="sxs-lookup"><span data-stu-id="cd77b-109">For example, suppose a file server has files containing confidential information and that each of these files is protected by an ACL.</span></span> <span data-ttu-id="cd77b-110">Um zu verhindern, dass ein Client nicht autorisierten Zugriff auf Informationen in diesen Dateien erhält, kann der Server die Identität des Clients annehmen, bevor er auf die Dateien zugreift.</span><span class="sxs-lookup"><span data-stu-id="cd77b-110">To help prevent a client from obtaining unauthorized access to information in these files, the server can impersonate the client before accessing the files.</span></span>

## <a name="access-tokens-for-impersonation"></a><span data-ttu-id="cd77b-111">Zugriffs Token für Identitätswechsel</span><span class="sxs-lookup"><span data-stu-id="cd77b-111">Access Tokens for Impersonation</span></span>

<span data-ttu-id="cd77b-112">Zugriffs Token sind Objekte, die den Sicherheitskontext eines Prozesses oder Threads beschreiben.</span><span class="sxs-lookup"><span data-stu-id="cd77b-112">Access tokens are objects that describe the security context of a process or thread.</span></span> <span data-ttu-id="cd77b-113">Sie stellen Informationen bereit, die die Identität eines Benutzerkontos und eine Teilmenge der Berechtigungen enthalten, die für das Benutzerkonto verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="cd77b-113">They provide information that includes the identity of a user account and a subset of the privileges available to the user account.</span></span> <span data-ttu-id="cd77b-114">Jeder Prozess verfügt über ein *Primäres Zugriffs Token* , das den Sicherheitskontext des Benutzerkontos beschreibt, das dem Prozess zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="cd77b-114">Every process has a *primary access token* that describes the security context of the user account associated with the process.</span></span> <span data-ttu-id="cd77b-115">Standardmäßig verwendet das System das primäre Token, wenn ein Thread des Prozesses mit einem Sicherungs fähigen Objekt interagiert.</span><span class="sxs-lookup"><span data-stu-id="cd77b-115">By default, the system uses the primary token when a thread of the process interacts with a securable object.</span></span> <span data-ttu-id="cd77b-116">Wenn jedoch ein Thread die Identität eines Clients annimmt, verfügt der Identitätswechsel Thread sowohl über ein primäres Zugriffs Token als auch über ein Identitätswechsel *Token*.</span><span class="sxs-lookup"><span data-stu-id="cd77b-116">However, when a thread impersonates a client, the impersonating thread has both a primary access token and an *impersonation token*.</span></span> <span data-ttu-id="cd77b-117">Das Identitätswechsel Token stellt den Sicherheitskontext des Clients dar, und dieses Zugriffs Token ist das Zugriffs Token, das während des Identitäts Wechsels für Zugriffs Überprüfungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="cd77b-117">The impersonation token represents the client's security context, and this access token is the one that is used for access checks during impersonation.</span></span> <span data-ttu-id="cd77b-118">Wenn sich der Identitätswechsel übersteigt, verwendet der Thread nur das primäre Zugriffs Token.</span><span class="sxs-lookup"><span data-stu-id="cd77b-118">When impersonation is over, the thread reverts to using only the primary access token.</span></span>

<span data-ttu-id="cd77b-119">Sie können die [**OpenProcessToken**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openprocesstoken) -Funktion verwenden, um ein Handle für das primäre Token eines Prozesses zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="cd77b-119">You can use the [**OpenProcessToken**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openprocesstoken) function to get a handle to the primary token of a process.</span></span> <span data-ttu-id="cd77b-120">Verwenden Sie die [**openthletotokenfunktion**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) , um ein Handle für das Identitätswechsel Token eines Threads zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="cd77b-120">Use the [**OpenThreadToken**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) function to get a handle to the impersonation token of a thread.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cd77b-121">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="cd77b-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cd77b-122">Zugriffs Token</span><span class="sxs-lookup"><span data-stu-id="cd77b-122">Access Tokens</span></span>](/windows/desktop/SecAuthZ/access-tokens)
</dt> <dt>

[<span data-ttu-id="cd77b-123">Delegierung und Identitätswechsel</span><span class="sxs-lookup"><span data-stu-id="cd77b-123">Delegation and Impersonation</span></span>](delegation-and-impersonation.md)
</dt> </dl>

 

 