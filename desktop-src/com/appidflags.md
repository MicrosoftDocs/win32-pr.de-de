---
title: Appidflags
description: Ein Satz von Flags, die das Aktivierungs Verhalten eines COM-Servers steuern.
ms.assetid: ab98e7d3-85c6-4328-84c4-1d4583df69ce
keywords:
- Appidflags-Registrierungs Wert com
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cdad2b80625d6a60460d43f242d7897e0ae7eb40
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "106339517"
---
# <a name="appidflags"></a><span data-ttu-id="57647-104">Appidflags</span><span class="sxs-lookup"><span data-stu-id="57647-104">AppIDFlags</span></span>

<span data-ttu-id="57647-105">Ein Satz von Flags, die das Aktivierungs Verhalten eines COM-Servers steuern.</span><span class="sxs-lookup"><span data-stu-id="57647-105">A set of flags that control the activation behavior of a COM server.</span></span>

## <a name="registry-entry"></a><span data-ttu-id="57647-106">Registrierungseintrag</span><span class="sxs-lookup"><span data-stu-id="57647-106">Registry Entry</span></span>

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      AppIDFlags = flags
```

## <a name="remarks"></a><span data-ttu-id="57647-107">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="57647-107">Remarks</span></span>

<span data-ttu-id="57647-108">Dies ist ein **reg \_ DWORD** -Wert.</span><span class="sxs-lookup"><span data-stu-id="57647-108">This is a **REG\_DWORD** value.</span></span>



| <span data-ttu-id="57647-109">Flagwert</span><span class="sxs-lookup"><span data-stu-id="57647-109">Flag Value</span></span> | <span data-ttu-id="57647-110">Konstante</span><span class="sxs-lookup"><span data-stu-id="57647-110">Constant</span></span>                                              |
|------------|-------------------------------------------------------|
| <span data-ttu-id="57647-111">0x1</span><span class="sxs-lookup"><span data-stu-id="57647-111">0x1</span></span>        | <span data-ttu-id="57647-112">appidregflags \_ Aktivieren von \_ iuserver \_ indesktop</span><span class="sxs-lookup"><span data-stu-id="57647-112">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP</span></span>          |
| <span data-ttu-id="57647-113">0x2</span><span class="sxs-lookup"><span data-stu-id="57647-113">0x2</span></span>        | <span data-ttu-id="57647-114">appidregflags \_ Secure \_ Server \_ Process \_ SD \_ und \_ Bind</span><span class="sxs-lookup"><span data-stu-id="57647-114">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND</span></span> |
| <span data-ttu-id="57647-115">0x4</span><span class="sxs-lookup"><span data-stu-id="57647-115">0x4</span></span>        | <span data-ttu-id="57647-116">appidregflags- \_ Ausgabe- \_ \_ RPC \_ bei \_ Identifizierung</span><span class="sxs-lookup"><span data-stu-id="57647-116">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY</span></span>   |



 

### <a name="appidregflags_activate_iuserver_indesktop-description"></a><span data-ttu-id="57647-117">Appidregflags \_ Aktivieren Sie \_ iuserver \_ indesktop Description.</span><span class="sxs-lookup"><span data-stu-id="57647-117">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP Description</span></span>

<span data-ttu-id="57647-118">Wenn **appidregflags das \_ iuserver-Flag " \_ \_ indesktop" aktivieren** , wird es in **appidflags** gelöscht, oder **appidflags** ist nicht vorhanden. der Client in einer Terminal Server Sitzung, die eine Aktivierungs Anforderung für einen [interaktiven Benutzer](interactive-user.md) -com-Server durchführt, bindet entweder an den com-Server im "Standard"-Desktop der "WinSta0"- [Fenster Station](/windows/desktop/winstation/window-stations) der Sitzung in der Aktivierungs Anforderung und bindet ihn an.</span><span class="sxs-lookup"><span data-stu-id="57647-118">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is cleared in **AppIDFlags** or if **AppIDFlags** is not present, the client in a terminal server session making an activation request for an [Interactive User](interactive-user.md) COM server, will either bind to, or launch and bind to, the COM server in the "default" desktop of the "winsta0" [window station](/windows/desktop/winstation/window-stations) of the session in the activation request.</span></span> <span data-ttu-id="57647-119">Wenn z. b. auf dem Client "WinSta0 \\ desktop1" der Sitzung 3 ausgeführt wird, wird die Aktivierungs Anforderung für Sitzung 3 entweder an den com-Server in "WinSta0 default" der Sitzung 3 gebunden oder gestartet und an diesen gebunden, \\ auch wenn eine Instanz des COM-Servers bereits in "WinSta0 \\ desktop1" der Sitzung 3 ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="57647-119">For example, if the client is running "winsta0\\desktop1" of session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\default" of session 3, even if an instance of the COM server is already running in "winsta0\\desktop1" of session 3.</span></span>

<span data-ttu-id="57647-120">Wenn das **appidregflags-Flag " \_ \_ iuserver \_ indesktop** " im **appidflags** -Wert aktiviert ist, bindet com entweder den Server Prozess, der auf dem Desktop des Clients ausgeführt wird, und bindet ihn an den Server Prozess, der in der Aktivierungs Anforderung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="57647-120">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is set in the **AppIDFlags** value, COM will either bind to, or launch and bind to, the server process running in the client's desktop and the session in the activation request.</span></span> <span data-ttu-id="57647-121">Wenn z. b. auf dem Client "WinSta0 \\ desktop1" in Sitzung 3 ausgeführt wird, wird die Aktivierungs Anforderung für Sitzung 3 entweder an den com-Server in "WinSta0 desktop1" in Sitzung 3 gebunden oder gestartet und an diesen gebunden \\ , auch wenn eine Instanz des COM-Servers bereits in "WinSta0 \\ default" in Sitzung 3 ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="57647-121">For example, if the client is running "winsta0\\desktop1" in session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\desktop1" in session 3, even if an instance of the COM server is already running in "winsta0\\default" in session 3.</span></span>

<span data-ttu-id="57647-122">Der-Client kann den [sitzungsmoniker](/windows/desktop/TermServ/session-monikers) verwenden, um eine andere Sitzung als die Sitzung des Clients anzugeben, wenn die Aktivierungs Anforderung erfolgt.</span><span class="sxs-lookup"><span data-stu-id="57647-122">The client can use the [session moniker](/windows/desktop/TermServ/session-monikers) to specify a session different than the client's session when it makes the activation request.</span></span>

<span data-ttu-id="57647-123">Das Flag " **\_ \_ iuserver \_ indesktop aktivieren" von "appidregflags** " gilt nur für com-Server, die als "[interaktiver Benutzer](interactive-user.md)" konfiguriert sind.</span><span class="sxs-lookup"><span data-stu-id="57647-123">The **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag applies only to COM servers that are configured to RunAs "[Interactive User](interactive-user.md)".</span></span>

### <a name="appidregflags_secure_server_process_sd_and_bind-description"></a><span data-ttu-id="57647-124">Appidregflags \_ Secure \_ Server \_ Process \_ SD \_ und \_ Bind Description</span><span class="sxs-lookup"><span data-stu-id="57647-124">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND Description</span></span>

<span data-ttu-id="57647-125">Wenn **appidregflags \_ Secure \_ Server \_ Process \_ SD und das \_ \_ Bind-** Flag in **appidflags** festgelegt sind, werden com-Server, die für die Ausführung von "Activator" konfiguriert sind, mit einem Prozess Sicherheits Deskriptor gestartet, der den [ \_ gesamten \_ Zugriff](/windows/desktop/ProcThread/process-security-and-access-rights) auf die LogonId-SID des Prozess Tokens ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="57647-125">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "Activator" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) to the LogonID SID of the process token.</span></span> <span data-ttu-id="57647-126">Außerdem wird der Besitzer der Sicherheits Beschreibung auf die LogonId-SID des Prozess Tokens festgelegt.</span><span class="sxs-lookup"><span data-stu-id="57647-126">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span>

<span data-ttu-id="57647-127">Wenn **appidregflags \_ Secure \_ Server \_ Process \_ SD und das \_ \_ Bind-** Flag in **appidflags** festgelegt sind, werden com-Server, die für die Ausführung von "this user" konfiguriert sind, mit einer Prozess Sicherheits Beschreibung gestartet, die den [ \_ gesamten \_ Zugriff](/windows/desktop/ProcThread/process-security-and-access-rights) in der LogonId-SID des Prozess Tokens ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="57647-127">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "This User" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) in the LogonID SID of the process token.</span></span> <span data-ttu-id="57647-128">Außerdem wird der Besitzer der Sicherheits Beschreibung auf die LogonId-SID des Prozess Tokens festgelegt.</span><span class="sxs-lookup"><span data-stu-id="57647-128">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span> <span data-ttu-id="57647-129">Außerdem ändert der com-Dienststeuerungs-Manager (SCM) das Token des com-Server Prozesses wie folgt:</span><span class="sxs-lookup"><span data-stu-id="57647-129">Further, the COM Service Control Manager (SCM) modifies the token of the COM server process as follows:</span></span>

-   <span data-ttu-id="57647-130">Dem Token wird eine AppID-sid hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="57647-130">It adds an APPID SID to the token.</span></span> <span data-ttu-id="57647-131">Sie gewährt der AppID-sid Vollzugriff in der standardmäßigen Zugriffs Steuerungs Liste (DACL) des Tokens.</span><span class="sxs-lookup"><span data-stu-id="57647-131">It grants the APPID SID full access in the token default discretionary access control list (DACL).</span></span> <span data-ttu-id="57647-132">In Windows Vista und höheren Versionen von Windows wird die Berechtigung "Besitzer Rechte-sid lesen" \_ in der tokenstandarddacl erteilt.</span><span class="sxs-lookup"><span data-stu-id="57647-132">In Windows Vista and later versions of Windows, it grants the OwnerRights SID READ\_CONTROL permission in the token default DACL.</span></span> <span data-ttu-id="57647-133">In Versionen von Windows Vista vor Windows Vista wird der Tokenbesitzer auf die AppID-sid festgelegt.</span><span class="sxs-lookup"><span data-stu-id="57647-133">In pre-Windows Vista versions of Windows, it sets the token owner to the APPID SID.</span></span>

<span data-ttu-id="57647-134">Die folgenden Sicherheitsaspekte müssen berücksichtigt werden, wenn die **appidregflags \_ Secure \_ Server \_ Process \_ SD und das \_ \_ Bind-** Flag verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="57647-134">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag:</span></span>

-   <span data-ttu-id="57647-135">Die **appidregflags \_ Secure \_ Server \_ Process \_ SD \_ und das \_ Bind-** Flag sollen von com-Servern festgelegt werden, die unter einem der integrierten Dienst Sicherheits Kontexte gestartet werden, entweder dem NetworkService-Konto oder dem LocalService-Konto.</span><span class="sxs-lookup"><span data-stu-id="57647-135">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is meant to be set by COM servers that are launched under one of the built-in service security contexts; either the NetworkService or the LocalService accounts.</span></span> <span data-ttu-id="57647-136">Wenn die Server die Identität privilegierter Clients annehmen und der **appidregflags \_ Secure \_ Server \_ Process \_ SD \_ -und \_ Bind-** Flag nicht festgelegt ist, kann bösartiger Code, der in anderen Prozessen mit demselben Sicherheitskontext ausgeführt wird, die Berechtigung erhöhen, indem die Identitätswechsel Token der privilegierten Clients vom com-Server Prozess übernommen werden.</span><span class="sxs-lookup"><span data-stu-id="57647-136">If the servers impersonate privileged clients and if the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is not set, malicious code running in other processes with the same security context can elevate privilege by hijacking the impersonation tokens of the privileged clients from the COM server process.</span></span>
-   <span data-ttu-id="57647-137">Wenn **appidregflags \_ Secure \_ Server \_ Process \_ SD \_ und \_ Bind** Flag festgelegt ist, wird die Sicherheits Beschreibung des Process-Objekts von com bei der Ausführung von "Activator"-com-Servern mit com vergrößert.</span><span class="sxs-lookup"><span data-stu-id="57647-137">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "Activator" COM servers.</span></span> <span data-ttu-id="57647-138">Bei solchen Servern soll der com-Client das Token, das für die COM-Aktivierung verwendet wird, Härten.</span><span class="sxs-lookup"><span data-stu-id="57647-138">For such servers, the COM client is expected to harden the token that it uses for the COM activation.</span></span>
-   <span data-ttu-id="57647-139">Wenn die **appidregflags \_ Secure \_ Server \_ Process \_ SD \_ -und \_ Bind-** Flag festgelegt ist, wird die Sicherheits Beschreibung des Prozess Objekts von com bei den com-Servern des runas "this user" festgelegt.</span><span class="sxs-lookup"><span data-stu-id="57647-139">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "This User" COM servers.</span></span> <span data-ttu-id="57647-140">Außerdem wird das Prozess Token des COM-Servers festgeschrieben, da es sich bei dem com-SCM um die Entität handelt, die das Token erstellt.</span><span class="sxs-lookup"><span data-stu-id="57647-140">It also hardens the process token of the COM server since the COM SCM is the entity that creates the token.</span></span>

<span data-ttu-id="57647-141">**Appidregflags \_ Secure \_ Server \_ Process \_ SD \_ und \_ Bind-** Flag werden in Windows XP, Windows Server 2003, Windows Vista und Windows Server 2008 nur unterstützt, wenn der MSRC8322-Patch ([Sicherheitsbulletin MS09-012](https://support.microsoft.com/kb/959454)) angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="57647-141">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is supported in Windows XP, Windows Server 2003, Windows Vista, and Windows Server 2008 only when the MSRC8322 patch ([security bulletin MS09-012](https://support.microsoft.com/kb/959454)) is applied.</span></span> <span data-ttu-id="57647-142">Sie wird in Windows 7 und höheren Versionen von Windows nativ unterstützt.</span><span class="sxs-lookup"><span data-stu-id="57647-142">It is natively supported in Windows 7 and later versions of Windows.</span></span>

<span data-ttu-id="57647-143">**Appidregflags \_ Secure \_ Server \_ Process \_ SD \_ und \_ Bind-** Flag gelten nur für com-Server, die für die Ausführung von "Activator" oder "this user" konfiguriert sind.</span><span class="sxs-lookup"><span data-stu-id="57647-143">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag applies only to COM servers that are configured to RunAs "Activator" or "This User".</span></span> <span data-ttu-id="57647-144">Es gilt nicht für com-Server, bei denen es sich um NT-Dienste handelt.</span><span class="sxs-lookup"><span data-stu-id="57647-144">It does not apply to COM servers that are NT services.</span></span>

### <a name="appidregflags_issue_activation_rpc_at_identify-description"></a><span data-ttu-id="57647-145">Appidregflags- \_ Problem \_ Aktivierung \_ RPC \_ bei Identifizierung der \_ Beschreibung</span><span class="sxs-lookup"><span data-stu-id="57647-145">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY Description</span></span>

<span data-ttu-id="57647-146">Wenn das **appidregflags- \_ Problem \_ bei der Aktivierung von \_ RPC \_ unter \_ identifizierungsflag** in **appidflags** festgelegt ist, gibt der com-SCM Objekt Aktivierungs Anforderungen an den com-Server Prozess mit einer Identitätswechsel Ebene der [RPC-C- \_ \_ \_ Ebene \_ Identifizierung](impersonation-levels.md)aus.</span><span class="sxs-lookup"><span data-stu-id="57647-146">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is set in **AppIDFlags**, the COM SCM will issue object activation requests to the COM server process using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md).</span></span>

<span data-ttu-id="57647-147">Wenn das **appidregflags- \_ Problem \_ bei der Aktivierung der RPC-Aktivierung bei einem \_ \_ \_ identifizierungsflag** nicht festgelegt ist, gibt der com-SCM Objekt Aktivierungs Anforderungen an die com-Server Prozesse mithilfe einer Identitätswechsel Ebene von RPC-C- [ \_ \_ \_ Ebene \_](impersonation-levels.md)für Identitätswechsel aus.</span><span class="sxs-lookup"><span data-stu-id="57647-147">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is not set, the COM SCM will issue object activation requests to the COM server processes using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IMPERSONATE](impersonation-levels.md).</span></span>

<span data-ttu-id="57647-148">Die folgenden Sicherheitsüberlegungen müssen berücksichtigt werden, wenn die **appidregflags- \_ \_ Aktivierungs- \_ RPC \_ bei der \_ identifizierungsflag** verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="57647-148">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag:</span></span>

-   <span data-ttu-id="57647-149">Das **appidregflags- \_ Problem \_ bei der Aktivierung der RPC- \_ \_ unter \_ Identifizierung** ist für die Verwendung durch com-Server vorgesehen, die keine Arbeit im Auftrag von Clients in Objekt Aktivierungs Anforderungen ausführen.</span><span class="sxs-lookup"><span data-stu-id="57647-149">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is meant to be used by COM servers that do not perform work on behalf of clients in object activation requests.</span></span> <span data-ttu-id="57647-150">Bei solchen Servern wird durch das vorhanden sein von com SCM-Objekt Aktivierungs Anforderungen auf [RPC- \_ C- \_ IMP- \_ Ebene \_](impersonation-levels.md) die Wahrscheinlichkeit minimiert, dass privilegierte Token mit der [**\_ \_ namens**](/windows/desktop/SecAuthZ/privilege-constants) Ebene "SE Identitätswechsel" im Prozess angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="57647-150">For such servers, having the COM SCM issue object activation requests at [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md) minimizes the chances of privileged tokens with [**SE\_IMPERSONATE\_NAME**](/windows/desktop/SecAuthZ/privilege-constants) level appearing in the process.</span></span>

<span data-ttu-id="57647-151">Das Flag zur **\_ Aktivierung der RPC- \_ Ausgabe \_ \_ von \_ appidregflags** in Windows 7 und höheren Versionen von Windows wird unterstützt.</span><span class="sxs-lookup"><span data-stu-id="57647-151">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is supported in Windows 7 and later versions of Windows.</span></span>

## <a name="related-topics"></a><span data-ttu-id="57647-152">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="57647-152">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="57647-153">Desktops</span><span class="sxs-lookup"><span data-stu-id="57647-153">Desktops</span></span>](/windows/desktop/winstation/desktops)
</dt> <dt>

[<span data-ttu-id="57647-154">Identitätswechsel Ebenen</span><span class="sxs-lookup"><span data-stu-id="57647-154">Impersonation Levels</span></span>](impersonation-levels.md)
</dt> <dt>

[<span data-ttu-id="57647-155">Interaktiver Benutzer</span><span class="sxs-lookup"><span data-stu-id="57647-155">Interactive User</span></span>](interactive-user.md)
</dt> <dt>

[<span data-ttu-id="57647-156">Sitzungsmoniker</span><span class="sxs-lookup"><span data-stu-id="57647-156">Session Monikers</span></span>](/windows/desktop/TermServ/session-monikers)
</dt> <dt>

[<span data-ttu-id="57647-157">Fenster Stationen</span><span class="sxs-lookup"><span data-stu-id="57647-157">Window Stations</span></span>](/windows/desktop/winstation/window-stations)
</dt> </dl>

 

 