---
title: Die com-Bibliothek
description: Die com-Bibliothek
ms.assetid: 51d4db4a-ad88-4627-8140-2f7906945752
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a285a89ca659907c37f92b7d00f3e3e04d0acf51
ms.sourcegitcommit: 307b14e9847ced354a52a1ac12d7f659722d99bb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/06/2020
ms.locfileid: "103948493"
---
# <a name="the-com-library"></a><span data-ttu-id="d636e-103">Die com-Bibliothek</span><span class="sxs-lookup"><span data-stu-id="d636e-103">The COM Library</span></span>

<span data-ttu-id="d636e-104">Jeder Prozess, der com verwendet, muss die com-Bibliothek initialisieren und die Initialisierung der com-Bibliothek deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="d636e-104">Any process that uses COM must both initialize and uninitialize the COM library.</span></span> <span data-ttu-id="d636e-105">Zusätzlich zu einer Spezifikation implementiert com auch einige wichtige Dienste in dieser Bibliothek.</span><span class="sxs-lookup"><span data-stu-id="d636e-105">In addition to being a specification, COM also implements some important services in this library.</span></span> <span data-ttu-id="d636e-106">Die com-Bibliothek bietet Folgendes als einen Satz von DLLs und EXEs (Primär Ole32.dll und Rpcss.exe) in Microsoft Windows:</span><span class="sxs-lookup"><span data-stu-id="d636e-106">Provided as a set of DLLs and EXEs (primarily Ole32.dll and Rpcss.exe) in Microsoft Windows, the COM library includes the following:</span></span>

-   <span data-ttu-id="d636e-107">Eine kleine Anzahl grundlegender Funktionen, die die Erstellung von com-Anwendungen vereinfachen, sowohl Client als auch Server.</span><span class="sxs-lookup"><span data-stu-id="d636e-107">A small number of fundamental functions that facilitate the creation of COM applications, both client and server.</span></span> <span data-ttu-id="d636e-108">Für-Clients stellt com grundlegende Funktionen zum Erstellen von-Objekten bereit.</span><span class="sxs-lookup"><span data-stu-id="d636e-108">For clients, COM supplies basic functions for creating objects.</span></span> <span data-ttu-id="d636e-109">Bei-Servern bietet com die Möglichkeit, Ihre Objekte verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="d636e-109">For servers, COM supplies the means of exposing their objects.</span></span>

-   <span data-ttu-id="d636e-110">Implementierungs-Locator-Dienste, über die com von einem eindeutigen Klassen Bezeichner (CLSID) bestimmt, welcher Server diese Klasse implementiert und wo sich der Server befindet.</span><span class="sxs-lookup"><span data-stu-id="d636e-110">Implementation-locator services through which COM determines, from a unique class identifier (CLSID), which server implements that class and where that server is located.</span></span> <span data-ttu-id="d636e-111">Dieser Dienst umfasst Unterstützung für eine dereferenzierungsstufe, normalerweise eine Systemregistrierung, zwischen der Identität einer Objektklasse und der Verpackung der Implementierung, sodass Clients unabhängig von der Verpackung sind, die sich in der Zukunft ändern können.</span><span class="sxs-lookup"><span data-stu-id="d636e-111">This service includes support for a level of indirection, usually a system registry, between the identity of an object class and the packaging of the implementation so that clients are independent of the packaging, which can change in the future.</span></span>

-   <span data-ttu-id="d636e-112">Transparente Remote Prozedur Aufrufe, wenn ein Objekt auf einem lokalen Server oder Remote Server ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d636e-112">Transparent remote procedure calls when an object is running in a local or remote server.</span></span>

-   <span data-ttu-id="d636e-113">Ein Standardmechanismus, mit dem eine Anwendung steuern kann, wie der Arbeitsspeicher innerhalb des Prozesses zugewiesen wird. Dies gilt insbesondere für Arbeitsspeicher, der zwischen den zusammengesetzten Objekten übermittelt werden muss, damit Sie ordnungsgemäß freigegeben werden</span><span class="sxs-lookup"><span data-stu-id="d636e-113">A standard mechanism to allow an application to control how memory is allocated within its process, particularly memory that needs to be passed between cooperating objects so that it can be freed properly.</span></span>

<span data-ttu-id="d636e-114">Um grundlegende COM-Dienste verwenden zu können, müssen alle com-Threads der Ausführung in Clients und Prozess externen Servern entweder die [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) -Funktion oder die [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) -Funktion aufrufen, bevor Sie eine andere com-Funktion außer Speicher Belegungs aufrufen aufrufen können.</span><span class="sxs-lookup"><span data-stu-id="d636e-114">To use basic COM services, all COM threads of execution in clients and out-of-process servers must call either the [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or the [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) function before calling any other COM function except memory allocation calls.</span></span> <span data-ttu-id="d636e-115">**CoInitializeEx** ersetzt die andere Funktion und fügt einen Parameter hinzu, der es Ihnen ermöglicht, das Threading Modell des Threads anzugeben: entweder Apartment Thread oder frei Thread.</span><span class="sxs-lookup"><span data-stu-id="d636e-115">**CoInitializeEx** replaces the other function, adding a parameter that allows you to specify the threading model of the thread: either apartment-threaded or free-threaded.</span></span> <span data-ttu-id="d636e-116">Durch einen **CoInitialize** -Rückruf wird das Threading Modell einfach auf Apartment Thread festgelegt.</span><span class="sxs-lookup"><span data-stu-id="d636e-116">A call to **CoInitialize** simply sets the threading model to apartment-threaded.</span></span>

<span data-ttu-id="d636e-117">OLE-Verbund Dokument Anwendungen rufen die [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize) -Funktion auf, die [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) aufruft und auch einige für Verbund Dokumente erforderliche Initialisierung durchführt.</span><span class="sxs-lookup"><span data-stu-id="d636e-117">OLE compound document applications call the [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize) function, which calls [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) and also does some initialization required for compound documents.</span></span> <span data-ttu-id="d636e-118">Daher können Threads, die **OleInitialize** aufzurufen, nicht freigegeben werden.</span><span class="sxs-lookup"><span data-stu-id="d636e-118">Therefore, threads that call **OleInitialize** cannot be free-threaded.</span></span> <span data-ttu-id="d636e-119">Weitere Informationen zum Threading in Clients und Servern finden Sie unter [Prozesse, Threads und Apartments](processes--threads--and-apartments.md).</span><span class="sxs-lookup"><span data-stu-id="d636e-119">For information on threading in clients and servers, see [Processes, Threads, and Apartments](processes--threads--and-apartments.md).</span></span>

<span data-ttu-id="d636e-120">Prozess interne Server nennen die Initialisierungs Funktionen nicht, da Sie in einen Prozess geladen werden, der bereits abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="d636e-120">In-process servers do not call the initialization functions because they are being loaded into a process that has already done so.</span></span> <span data-ttu-id="d636e-121">Daher müssen Prozess interne Server Ihr Threading Modell in der Registrierung unter dem Schlüssel [InProcServer32](inprocserver32.md) festlegen.</span><span class="sxs-lookup"><span data-stu-id="d636e-121">As a result, in-process servers must set their threading model in the registry under the [InprocServer32](inprocserver32.md) key.</span></span> <span data-ttu-id="d636e-122">Ausführliche Informationen zu Threading Problemen bei Prozess internen Servern finden Sie unter [Prozess interne Server Threading Probleme](in-process-server-threading-issues.md).</span><span class="sxs-lookup"><span data-stu-id="d636e-122">For detailed information on threading issues in in-process servers, see [In-Process Server Threading Issues](in-process-server-threading-issues.md).</span></span>

<span data-ttu-id="d636e-123">Es ist auch wichtig, die Initialisierung der Bibliothek zu deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="d636e-123">It is also important to uninitialize the library.</span></span> <span data-ttu-id="d636e-124">Für jeden Aufrufen von [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) oder [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex)muss ein entsprechender [**CallInitialize**](/windows/desktop/api/combaseapi/nf-combaseapi-couninitialize)-Befehl vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="d636e-124">For each call to [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex), there must be a corresponding call to [**CoUninitialize**](/windows/desktop/api/combaseapi/nf-combaseapi-couninitialize).</span></span> <span data-ttu-id="d636e-125">Für jeden Aufrufe von [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize)muss ein entsprechender [**etuninitialize**](/windows/desktop/api/Ole2/nf-ole2-oleuninitialize)-aufrufswert vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="d636e-125">For each call to [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize), there must be a corresponding call to [**OleUninitialize**](/windows/desktop/api/Ole2/nf-ole2-oleuninitialize).</span></span>

<span data-ttu-id="d636e-126">Prozess interne Server können davon ausgehen, dass der Prozess, in den Sie geladen werden, diese Schritte bereits ausgeführt hat.</span><span class="sxs-lookup"><span data-stu-id="d636e-126">In-process servers can assume that the process they are being loaded into has already performed these steps.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d636e-127">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="d636e-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d636e-128">Das Component Object Model</span><span class="sxs-lookup"><span data-stu-id="d636e-128">The Component Object Model</span></span>](the-component-object-model.md)
</dt> </dl>

 

 




