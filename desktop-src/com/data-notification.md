---
title: Daten Benachrichtigung
description: Objekte, die Daten aus einer externen Quelle nutzen, müssen manchmal informiert werden, wenn sich Daten in dieser Quelle ändern.
ms.assetid: 286a1ecf-5255-4443-a17d-5ffa55ed0be1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49df9e6bb7d9b15192473b18114fe7fcd69ecedf
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/21/2020
ms.locfileid: "106338495"
---
# <a name="data-notification"></a><span data-ttu-id="fbbb9-103">Daten Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="fbbb9-103">Data Notification</span></span>

<span data-ttu-id="fbbb9-104">Objekte, die Daten aus einer externen Quelle nutzen, müssen manchmal informiert werden, wenn sich Daten in dieser Quelle ändern.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-104">Objects that consume data from an external source sometimes need to be informed when data in that source changes.</span></span> <span data-ttu-id="fbbb9-105">Beispielsweise muss ein Aktien Ticker-Band-Viewer, der auf Daten in einem Arbeitsblatt basiert, benachrichtigt werden, wenn sich die Daten ändern, um die Anzeige zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-105">For example, a stock ticker tape viewer that relies on data in some spreadsheet needs to be notified when that data changes so it can update its display.</span></span> <span data-ttu-id="fbbb9-106">Ebenso benötigt ein Verbund Dokument Informationen zu Datenänderungen in seinen eingebetteten Objekten, damit es seine Daten Caches aktualisieren kann.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-106">Similarly, a compound document needs information about data changes in its embedded objects so that it can update its data caches.</span></span> <span data-ttu-id="fbbb9-107">In solchen Fällen, in denen das dynamische Aktualisieren von Daten wünschenswert ist, benötigen Datenquellen einen Mechanismus, mit dem Daten Consumer von Änderungen benachrichtigt werden, wenn Sie auftreten, ohne dass die Consumer dazu verpflichtet werden, alles zu löschen, um Ihre Daten zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-107">In cases such as this, where dynamic updating of data is desirable, sources of data require some mechanism of notifying data consumers of changes as they occur without obligating the consumers to drop everything in order to update their data.</span></span> <span data-ttu-id="fbbb9-108">Im Idealfall kann ein Konsumierende Objekt bei seiner Freizeit eine aktualisierte Kopie anfordern, um benachrichtigt zu werden, dass eine Änderung in der Datenquelle aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-108">Ideally, having been notified that a change has occurred in the data source, a consuming object can ask for an updated copy at its leisure.</span></span>

<span data-ttu-id="fbbb9-109">Der Mechanismus von com für die Behandlung von asynchronen Benachrichtigungen dieses Typs ist ein Objekt, das als "Hinweis Senke [**" bezeichnet wird. hierbei**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink)handelt es sich um ein beliebiges COM-Objekt, das eine Schnittstelle mit dem Namen</span><span class="sxs-lookup"><span data-stu-id="fbbb9-109">COM's mechanism for handling asynchronous notifications of this type is an object called an advise sink, which is simply any COM object that implements an interface called [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span></span> <span data-ttu-id="fbbb9-110">Consumer von Daten implementieren **IAdviseSink**.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-110">Consumers of data implement the **IAdviseSink**.</span></span> <span data-ttu-id="fbbb9-111">Sie registrieren sich für den Empfang von Benachrichtigungen, indem Sie einen Zeiger an das relevante Datenobjekt übergeben.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-111">They register to receive notifications by handing a pointer to the data object of interest.</span></span>

<span data-ttu-id="fbbb9-112">Die [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) -Schnittstellen stellen die folgenden Methoden für den Empfang von asynchronen Benachrichtigungen bereit:</span><span class="sxs-lookup"><span data-stu-id="fbbb9-112">The [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interfaces exposes the following methods for receiving asynchronous notifications:</span></span>



| <span data-ttu-id="fbbb9-113">Methode</span><span class="sxs-lookup"><span data-stu-id="fbbb9-113">Method</span></span>                                                      | <span data-ttu-id="fbbb9-114">Benachrichtigt die Empfehlung-Senke, dass</span><span class="sxs-lookup"><span data-stu-id="fbbb9-114">Notifies the advise sink that</span></span>                                            |
|-------------------------------------------------------------|--------------------------------------------------------------------------|
| [<span data-ttu-id="fbbb9-115">**OnDataChange**</span><span class="sxs-lookup"><span data-stu-id="fbbb9-115">**OnDataChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange)<br/> | <span data-ttu-id="fbbb9-116">Die Daten des aufrufenden Objekts wurden geändert.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-116">The calling object's data has changed.</span></span><br/>                        |
| [<span data-ttu-id="fbbb9-117">**OnViewChange**</span><span class="sxs-lookup"><span data-stu-id="fbbb9-117">**OnViewChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange)<br/> | <span data-ttu-id="fbbb9-118">Die Anweisungen zum Zeichnen des aufrufenden Objekts haben sich geändert.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-118">The instructions for drawing the calling object have changed.</span></span><br/> |
| [<span data-ttu-id="fbbb9-119">**Onrename**</span><span class="sxs-lookup"><span data-stu-id="fbbb9-119">**OnRename**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename)<br/>         | <span data-ttu-id="fbbb9-120">Der Moniker des aufrufenden Objekts hat sich geändert.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-120">The calling object's moniker has changed.</span></span><br/>                     |
| [<span data-ttu-id="fbbb9-121">**OnSave**</span><span class="sxs-lookup"><span data-stu-id="fbbb9-121">**OnSave**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)<br/>             | <span data-ttu-id="fbbb9-122">Das aufrufende Objekt wurde im permanenten Speicher gespeichert.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-122">The calling object has been saved to persistent storage.</span></span><br/>      |
| [<span data-ttu-id="fbbb9-123">**OnClose**</span><span class="sxs-lookup"><span data-stu-id="fbbb9-123">**OnClose**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)<br/>           | <span data-ttu-id="fbbb9-124">Das aufrufenden Objekt wurde geschlossen.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-124">The calling object has been closed.</span></span><br/>                           |



 

<span data-ttu-id="fbbb9-125">Wie die Tabelle zeigt, macht die [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) -Schnittstelle Methoden zum Benachrichtigen der Hinweis Senke anderer Ereignisse als Änderungen in den Daten des aufrufenden Objekts verfügbar.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-125">As the table indicates, the [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interface exposes methods for notifying the advise sink of events other than changes in the calling object's data.</span></span> <span data-ttu-id="fbbb9-126">Das aufrufende Objekt kann die Senke auch benachrichtigen, wenn sich die Art und Weise ändert, in der sich das Objekt selbst zeichnet, oder es umbenannt, gespeichert oder geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-126">The calling object can also notify the sink when the way in which it draws itself changes, or it is renamed, saved, or closed.</span></span> <span data-ttu-id="fbbb9-127">Diese anderen Benachrichtigungen werden hauptsächlich oder vollständig im Zusammenhang mit Verbund Dokumenten verwendet, obwohl der Benachrichtigungs Mechanismus identisch ist.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-127">These other notifications are used mainly or entirely in the context of compound documents, although the notification mechanism is identical.</span></span> <span data-ttu-id="fbbb9-128">Weitere Informationen zu Verbund Dokument Benachrichtigungen finden Sie unter "Verbund Dokumente".</span><span class="sxs-lookup"><span data-stu-id="fbbb9-128">For more information on compound-document notifications, see "Compound Documents."</span></span>

<span data-ttu-id="fbbb9-129">Um die Empfehlung-Senke zu nutzen, muss eine Datenquelle [**IDataObject::D-Empfehlung**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::D UN-Empfehlung**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)und [**IDataObject:: enumdrat**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise)implementieren.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-129">In order to take advantage of the advise sink, a data source must implement [**IDataObject::DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise), and [**IDataObject::EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span></span> <span data-ttu-id="fbbb9-130">Ein Datenconsumer Ruft den **dempfehlung** -Thread auf, um ein Datenobjekt zu benachrichtigen, dass es benachrichtigt werden soll, wenn sich die Daten des Objekts ändern.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-130">A data consumer calls the **DAdvise** mothod to notify a data object that it wishes to be notified when the object's data changes.</span></span> <span data-ttu-id="fbbb9-131">Das Konsumierende Objekt ruft die **dunempfehlung** -Methode auf, um diese Verbindung zu beenden.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-131">The consuming object calls the **DUnadvise** method to tear down this connection.</span></span> <span data-ttu-id="fbbb9-132">Alle interessierten Parteien können die **enumdadvisory** -Methode aufrufen, um die Anzahl der Objekte zu erlernen, die über eine Beratungs Verbindung mit einem Datenobjekt verfügen.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-132">Any interested party can call the **EnumDAdvise** method to learn the number of objects having an advisory connection with a data object.</span></span>

<span data-ttu-id="fbbb9-133">Wenn sich Daten an der Quelle ändern, ruft das Datenobjekt [**IAdviseSink:: OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) für alle Datenconsumer auf, die sich für den Empfang von Benachrichtigungen registriert haben.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-133">When data changes at the source, the data object calls [**IAdviseSink::OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) on all data consumers that have registered to receive notifications.</span></span> <span data-ttu-id="fbbb9-134">Um Beratungs Verbindungen nachzuverfolgen und das Versenden von Benachrichtigungen zu verwalten, basieren Datenquellen auf einem Objekt, das als Daten Anmelde *Inhaber* bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-134">To keep track of advisory connections and manage the dispatch of notifications, data sources rely on an object called a *data advise holder*.</span></span> <span data-ttu-id="fbbb9-135">Sie können einen eigenen Daten anrathalter erstellen, indem Sie die [**idataadvisegholder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-135">You can create your own data advise holder by implementing the [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) interface.</span></span> <span data-ttu-id="fbbb9-136">Oder Sie können com das tun, indem Sie die Hilfsfunktion [**createdataadvicholder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="fbbb9-136">Or, you can let COM do it for you by calling the helper function [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span></span>

## <a name="related-topics"></a><span data-ttu-id="fbbb9-137">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="fbbb9-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fbbb9-138">Datenübertragung</span><span class="sxs-lookup"><span data-stu-id="fbbb9-138">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

