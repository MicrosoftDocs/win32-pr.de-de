---
title: Implementieren der Eigenschaften Seite für ein DSP-Plug-in
description: Implementieren der Eigenschaften Seite für ein DSP-Plug-in
ms.assetid: 3dd3e547-fd06-4f01-8731-da1f8c958a32
keywords:
- Windows Media Player-Plug-ins, audiodsp
- Plug-ins, audiodsp
- Plug-Ins für die digitale Signalverarbeitung, Audioeigenschaften
- DSP-Plug-ins, Audioeigenschaften
- audiodsp-Plug-ins, Eigenschaften
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aec87318b77fec4e9218398c1cb43dd5954a49e0
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "103855799"
---
# <a name="implementing-the-property-page-for-a-dsp-plug-in"></a><span data-ttu-id="8c4e9-108">Implementieren der Eigenschaften Seite für ein DSP-Plug-in</span><span class="sxs-lookup"><span data-stu-id="8c4e9-108">Implementing the Property Page for a DSP Plug-in</span></span>

<span data-ttu-id="8c4e9-109">Windows Media Player kann eine Eigenschaften Seite für jedes DSP-Plug-in anzeigen, um Benutzern das Festlegen von Werten zu ermöglichen, die das Verhalten des Plug-ins ändern.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-109">Windows Media Player can display a property page for each DSP plug-in to enable users to set values that change the behavior of the plug-in.</span></span> <span data-ttu-id="8c4e9-110">Benutzer können auf die Eigenschaften Seite über die Registerkarte **Plug-ins** des Dialog Felds Optionen zugreifen, indem Sie auf den Namen des DSP-Plug-Ins klicken, um es auszuwählen, und dann auf **Eigenschaften** klicken.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-110">Users can access the property page from the **Plug-ins** tab of the Options dialog box by clicking the name of the DSP plug-in to select it and then clicking **Properties**.</span></span>

<span data-ttu-id="8c4e9-111">Der Beispielcode für den Windows Media Player-Plug-in-Assistenten stellt eine Standard Implementierung einer Eigenschaften Seite bereit, die ein einzelnes Bearbeitungsfeld enthält, das vom Benutzer einen Wert empfängt, der einen Skalierungsfaktor für das audiovolume darstellt.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-111">The Windows Media Player Plug-in Wizard sample code provides a default implementation of a property page that includes a single edit box that receives from the user a value representing a scale factor for the audio volume.</span></span> <span data-ttu-id="8c4e9-112">Wenn der Benutzer auf **anwenden** klickt, übergibt die Eigenschaften Seite diesen Wert an das Plug-in-Objekt, sodass das Plug-in den Wert ändern kann, der zum Skalieren des Volumes während der Verarbeitung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-112">When the user clicks **Apply**, the property page passes this value to the plug-in object so the plug-in can change the value it uses to scale the volume during processing.</span></span>

## <a name="about-the-property-page-object"></a><span data-ttu-id="8c4e9-113">Informationen zum Eigenschaften Seiten Objekt</span><span class="sxs-lookup"><span data-stu-id="8c4e9-113">About the Property Page Object</span></span>

<span data-ttu-id="8c4e9-114">Das Eigenschaften Seiten Objekt ist ein COM-Objekt, das die **IPropertyPage** -Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-114">The property page object is a COM object that implements the **IPropertyPage** interface.</span></span> <span data-ttu-id="8c4e9-115">Der Beispielcode, der vom Plug-in-Assistenten generiert wird, verwendet die ATL-Implementierung von **IPropertyPage**, die in der Visual C++-Dokumentation auf MSDN dokumentiert ist.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-115">The sample code generated by the plug-in wizard uses the ATL implementation of **IPropertyPage**, which is documented in the Visual C++ documentation on MSDN.</span></span> <span data-ttu-id="8c4e9-116">Der Code sollte zumindest Überschreibungs Implementierungen für **IPropertyPage:: OnInitDialog** bereitstellen, der das Ereignis behandelt, das beim Öffnen der Eigenschaften Seite auftritt, und **IPropertyPage:: apply**, das das Ereignis behandelt, das auftritt, wenn der Benutzer auf **anwenden** klickt.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-116">Your code at least should provide override implementations for **IPropertyPage::OnInitDialog**, which handles the event that occurs when the property page opens, and **IPropertyPage::Apply**, which handles the event that occurs when the user clicks **Apply**.</span></span> <span data-ttu-id="8c4e9-117">Der Plug-in-Assistent generiert Beispielcode für jeden dieser Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-117">The plug-in wizard generates sample code for each of these event handlers.</span></span> <span data-ttu-id="8c4e9-118">Die Beispiel Implementierung von **OnInitDialog** Ruft einen Wert aus der Registrierung ab, sodass die aktuelle Skalierungsfaktor Einstellung angezeigt werden kann.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-118">The sample implementation of **OnInitDialog** retrieves a value from the registry so that it can display the current scale factor setting.</span></span> <span data-ttu-id="8c4e9-119">Die Beispiel Implementierung von **Apply** überprüft die Benutzereingaben, indem Sie testet, um sicherzustellen, dass Sie in einen angegebenen Bereich fällt, speichert den Wert dann in der Registrierung und übergibt dann den Wert (falls gültig) an die "DSP"-Plug-in-Eigenschaft Put-Methode mit dem Namen " **Put \_ Scale**".</span><span class="sxs-lookup"><span data-stu-id="8c4e9-119">The sample implementation of **Apply** validates the user input by testing to ensure that it falls within a specified range, then persists the value to the registry, and then passes the value (if valid) to the DSP plug-in property put method, named **put\_scale**.</span></span>

<span data-ttu-id="8c4e9-120">Außerdem müssen Sie Code hinzufügen, um das Ereignis zu behandeln, das auftritt, wenn der Benutzer einen Wert in einem Steuerelement ändert, das Sie auf der Eigenschaften Seite angeben.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-120">Additionally, you will need to add code to handle the event that occurs when the user changes a value in a control you provide in the property page.</span></span> <span data-ttu-id="8c4e9-121">Der Plug-in-Assistent implementiert beispielsweise eine Funktion mit dem Namen " **onchangescale**", die einfach die Schaltfläche " **anwenden** " aktiviert, wenn der Benutzer den Text im Bearbeitungsfeld auf der Eigenschaften Seite ändert, indem er die **SetDirty** -Methode mit dem Argument Wert **true** aufruft.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-121">For example, the plug-in wizard implements a function named **OnChangeScale**, which simply enables the **Apply** button when the user changes the text in the edit box on the property page by calling the **SetDirty** method with an argument value of **TRUE**.</span></span>

## <a name="about-the-property-page-dialog-resource"></a><span data-ttu-id="8c4e9-122">Informationen über die Eigenschaften Seiten-Dialog Ressource</span><span class="sxs-lookup"><span data-stu-id="8c4e9-122">About the Property Page Dialog Resource</span></span>

<span data-ttu-id="8c4e9-123">Die Benutzeroberfläche für die Eigenschaften Seite wird als Dialog Ressource gespeichert.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-123">The user interface for the property page is stored as a dialog resource.</span></span> <span data-ttu-id="8c4e9-124">Sie können das Dialogfeld "Eigenschaften Seite" auf einfache Weise in Visual Studio anzeigen und bearbeiten, indem Sie im Fenster "Projekt Arbeitsbereich" die Registerkarte " **resourceview** " auswählen und dann den **Dialog** Ordner öffnen und dann auf den Ressourcennamen der Eigenschaften Seite doppelklicken.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-124">You can easily view and edit the property page dialog in Visual Studio by selecting the **ResourceView** tab in the Project Workspace window, then opening the **Dialog** folder, and then double-clicking the property page resource name.</span></span> <span data-ttu-id="8c4e9-125">Der Dialogfeld Ressourcen-Editor in Visual Studio stellt Ihnen die Tools zur Verfügung, die Sie zum Hinzufügen von Steuerelementen zum Dialogfeld der Eigenschaften Seite und zum Erstellen von Ereignis Handlern benötigen, die den entsprechenden Windows-Meldungen zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-125">The dialog resource editor in Visual Studio provides you with the tools you need to add controls to the property page dialog and to create event handlers that are mapped to the appropriate Windows messages.</span></span> <span data-ttu-id="8c4e9-126">Ausführliche Informationen zur Verwendung des Ressourcen-Editors in Visual Studio finden Sie in der Hilfe zu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-126">For details about how to use the resource editor in Visual Studio, refer to Visual Studio Help.</span></span>

## <a name="about-ispecifypropertypages"></a><span data-ttu-id="8c4e9-127">Informationen zu ISpecifyPropertyPages</span><span class="sxs-lookup"><span data-stu-id="8c4e9-127">About ISpecifyPropertyPages</span></span>

<span data-ttu-id="8c4e9-128">Wenn ein DSP-Plug-in eine Eigenschaften Seite bereitstellt, muss das Plug-in die **ISpecifyPropertyPages** -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-128">If a DSP plug-in provides a property page, the plug-in must implement the **ISpecifyPropertyPages** interface.</span></span> <span data-ttu-id="8c4e9-129">Diese Schnittstelle enthält nur eine Methode: **ISpecifyPropertyPages:: GetPages**.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-129">This interface contains only one method: **ISpecifyPropertyPages::GetPages**.</span></span> <span data-ttu-id="8c4e9-130">Dies ist die Methode, die die Eigenschaften Seite dem DSP-Plug-in zuordnet.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-130">This is the method that associates the property page with the DSP plug-in.</span></span> <span data-ttu-id="8c4e9-131">Windows Media Player ruft diese Methode auf, wenn der Benutzer die Eigenschaften Seite aufruft und dabei einen Parameter vom Typ cauuid übergibt, bei dem es sich um ein Gezähltes Array von GUIDs handelt.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-131">Windows Media Player calls this method when the user invokes the property page, passing a parameter of type CAUUID, which is a counted array of GUIDs.</span></span> <span data-ttu-id="8c4e9-132">Die Plug-in-Beispiel Implementierung von **GetPages** füllt diese Struktur mit einer einzelnen GUID, die die Klassen-ID des Plug-in-Eigenschaften Seiten Objekts ist.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-132">The sample plug-in implementation of **GetPages** fills this structure with a single GUID that is the class id of the plug-in property page object.</span></span> <span data-ttu-id="8c4e9-133">Windows Media Player verwendet dann die Klassen-ID, um das Objekt der Eigenschaften Seite zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-133">Windows Media Player then uses the class id to create the property page object.</span></span>

<span data-ttu-id="8c4e9-134">Sie werden feststellen, dass die Beispiel Implementierung von **GetPages** die Verwendung von **CoTaskMemAlloc** zum Zuweisen von Arbeitsspeicher für die GUID-Struktur verwendet.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-134">You might notice that the sample implementation of **GetPages** uses **CoTaskMemAlloc** to allocate memory for the GUID structure.</span></span> <span data-ttu-id="8c4e9-135">Es liegt in der Verantwortung des Aufrufers, in diesem Fall Windows Media Player, den Arbeitsspeicher mit " **CoTaskMemFree** " freizugeben.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-135">It is the responsibility of the caller, in this case Windows Media Player, to use **CoTaskMemFree** to release the memory.</span></span> <span data-ttu-id="8c4e9-136">Ausführliche Informationen zur cauuid-Struktur finden Sie in der Platform SDK-Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-136">For details about the CAUUID structure, see the Platform SDK documentation.</span></span>

## <a name="about-the-proxystub-dll"></a><span data-ttu-id="8c4e9-137">Informationen zur Proxy-/Stub-DLL</span><span class="sxs-lookup"><span data-stu-id="8c4e9-137">About the Proxy/Stub DLL</span></span>

<span data-ttu-id="8c4e9-138">Damit ein DSP-Plug-in in Windows Media Player 11 unter Windows Vista ausgeführt werden kann, müssen Sie eine Proxy-/Stub-DLL für benutzerdefinierte Schnittstellen bereitstellen, die zum Übermitteln von Änderungen an Einstellungen über ein Eigenschaften Seiten Dialogfeld an die Plug-in-Klasse verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-138">For a DSP plug-in to work in Windows Media Player 11 running on Windows Vista, you must provide a proxy/stub DLL for custom interfaces used to communicate changes in settings from a property page dialog box to the plug-in class.</span></span> <span data-ttu-id="8c4e9-139">Methodenaufrufe über diese Schnittstellen müssen gemarshallt werden, wenn die Aufrufe über Prozess-oder Apartment Grenzen hinweg erfolgen.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-139">Method calls made through such interfaces must be marshaled when the calls are made across process or apartment boundaries.</span></span> <span data-ttu-id="8c4e9-140">Mit der neuesten Version des Plug-in-Assistenten wird ein Beispiel für ein Proxy-/Stub-DLL-Projekt erstellt.</span><span class="sxs-lookup"><span data-stu-id="8c4e9-140">The latest version of the plug-in wizard creates a sample proxy/stub DLL project.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8c4e9-141">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="8c4e9-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8c4e9-142">**Implementieren eines audiodsp-Plug-ins**</span><span class="sxs-lookup"><span data-stu-id="8c4e9-142">**Implementing an Audio DSP Plug-in**</span></span>](implementing-an-audio-dsp-plug-in.md)
</dt> </dl>

 

 




