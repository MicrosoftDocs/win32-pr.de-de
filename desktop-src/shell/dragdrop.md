---
description: Viele Anwendungen ermöglichen es Benutzern, Daten in eine andere Anwendung zu übertragen, indem Sie die Daten mit der Maus ziehen und ablegen oder indem Sie die Zwischenablage verwenden.
title: Übertragen von shellobjekten mit Drag & Drop und der Zwischenablage
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bd73098b-2f69-48a4-bb06-e1e0a452e69d
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: b04523d0ae22eac7bef68f37a6d22ac94b21e303
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104979745"
---
# <a name="transferring-shell-objects-with-drag-and-drop-and-the-clipboard"></a><span data-ttu-id="6d340-103">Übertragen von shellobjekten mit Drag & Drop und der Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="6d340-103">Transferring Shell Objects with Drag-and-Drop and the Clipboard</span></span>

<span data-ttu-id="6d340-104">Viele Anwendungen ermöglichen es Benutzern, Daten in eine andere Anwendung zu übertragen, indem Sie die Daten mit der Maus ziehen und ablegen oder indem Sie die Zwischenablage verwenden.</span><span class="sxs-lookup"><span data-stu-id="6d340-104">Many applications allow users to transfer data to another application by dragging and dropping the data with the mouse, or by using the Clipboard.</span></span> <span data-ttu-id="6d340-105">Zu den vielen Typen von Daten, die übertragen werden können, zählen Shellobjekte wie z. b. Dateien oder Ordner.</span><span class="sxs-lookup"><span data-stu-id="6d340-105">Among the many types of data that can be transferred are Shell objects such as files or folders.</span></span> <span data-ttu-id="6d340-106">Shell-Datenübertragungen können zwischen zwei Anwendungen erfolgen, Benutzer können jedoch auch shelldaten auf den oder den Desktop oder Windows-Explorer übertragen.</span><span class="sxs-lookup"><span data-stu-id="6d340-106">Shell data transfer can take place between two applications, but users can also transfer Shell data to or from the desktop or Windows Explorer.</span></span>

<span data-ttu-id="6d340-107">Obwohl es sich bei den Dateien um das am häufigsten übertragene Shellobjekt handelt, kann die Shell-Datenübertragung eine beliebige Anzahl von Objekten im [Shellnamespace](namespace-intro.md)enthalten.</span><span class="sxs-lookup"><span data-stu-id="6d340-107">Although files are the most commonly transferred Shell object, Shell data transfer can involve any of the variety of objects found in the [Shell namespace](namespace-intro.md).</span></span> <span data-ttu-id="6d340-108">Beispielsweise muss Ihre Anwendung möglicherweise eine Datei in einen virtuellen Ordner, z. b. den Papierkorb, übertragen oder ein Objekt aus einer nicht von Microsoft abhängigen Namespace Erweiterung akzeptieren.</span><span class="sxs-lookup"><span data-stu-id="6d340-108">For instance, your application might need to transfer a file to a virtual folder such as the Recycle Bin, or accept an object from a non-Microsoft namespace extension.</span></span> <span data-ttu-id="6d340-109">Wenn Sie eine Namespace Erweiterung implementieren, muss Sie in der Lage sein, sich ordnungsgemäß als Drop Source und Target zu Verhalten.</span><span class="sxs-lookup"><span data-stu-id="6d340-109">If you are implementing a namespace extension, it must be able to behave properly as a drop source and target.</span></span>

<span data-ttu-id="6d340-110">In diesem Dokument wird erläutert, wie Anwendungen Drag & amp; Drop-und Zwischenablage-Datenübertragungen mit shellobjekten implementieren können.</span><span class="sxs-lookup"><span data-stu-id="6d340-110">This document discusses how applications can implement drag-and-drop and Clipboard data transfers with Shell objects.</span></span>

-   [<span data-ttu-id="6d340-111">Das shelldatenobjekt</span><span class="sxs-lookup"><span data-stu-id="6d340-111">The Shell Data Object</span></span>](dataobject.md)
-   [<span data-ttu-id="6d340-112">Shellzwischenablage Formate</span><span class="sxs-lookup"><span data-stu-id="6d340-112">Shell Clipboard Formats</span></span>](clipboard.md)
-   [<span data-ttu-id="6d340-113">Behandeln von Shelldatenübertragungs-Szenarien</span><span class="sxs-lookup"><span data-stu-id="6d340-113">Handling Shell Data Transfer Scenarios</span></span>](datascenarios.md)

## <a name="how-drag-and-drop-works-with-shell-objects"></a><span data-ttu-id="6d340-114">Funktionsweise von Drag & amp; Drop mit shellobjekten</span><span class="sxs-lookup"><span data-stu-id="6d340-114">How Drag-and-Drop Works with Shell Objects</span></span>

<span data-ttu-id="6d340-115">Anwendungen müssen häufig den Benutzern eine Möglichkeit zum Übertragen von shelldaten bieten.</span><span class="sxs-lookup"><span data-stu-id="6d340-115">Applications often need to provide users with a way to transfer Shell data.</span></span> <span data-ttu-id="6d340-116">Hier einige Beispiele:</span><span class="sxs-lookup"><span data-stu-id="6d340-116">Some examples are:</span></span>

-   <span data-ttu-id="6d340-117">Ziehen Sie eine Datei aus Windows Explorer oder dem Desktop, und löschen Sie Sie in einer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="6d340-117">Dragging a file from Windows Explorer or the desktop and dropping it on an application.</span></span>
-   <span data-ttu-id="6d340-118">Kopieren einer Datei in die Zwischenablage in Windows-Explorer und Einfügen in eine Anwendung.</span><span class="sxs-lookup"><span data-stu-id="6d340-118">Copying a file to the Clipboard in Windows Explorer and pasting it into an application.</span></span>
-   <span data-ttu-id="6d340-119">Ziehen einer Datei aus einer Anwendung in den Papierkorb.</span><span class="sxs-lookup"><span data-stu-id="6d340-119">Dragging a file from an application to the Recycle Bin.</span></span>

<span data-ttu-id="6d340-120">Ausführliche Informationen zur Handhabung dieser und anderer Szenarien finden Sie unter [Handling Shell Datenübertragung Szenarios](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="6d340-120">For a detailed discussion of how to handle these and other scenarios, see [Handling Shell Data Transfer Scenarios](datascenarios.md).</span></span> <span data-ttu-id="6d340-121">Dieses Dokument konzentriert sich auf die allgemeinen Prinzipien hinter der Shell-Datenübertragung.</span><span class="sxs-lookup"><span data-stu-id="6d340-121">This document focuses on the general principles behind Shell data transfer.</span></span>

<span data-ttu-id="6d340-122">Windows bietet zwei Standardmethoden für die Übertragung von shelldaten durch Anwendungen:</span><span class="sxs-lookup"><span data-stu-id="6d340-122">Windows provides two standard ways for applications to transfer Shell data:</span></span>

-   <span data-ttu-id="6d340-123">Ein Benutzer schneidet shelldaten (z. b. eine oder mehrere Dateien) in der Zwischenablage ab oder kopiert sie.</span><span class="sxs-lookup"><span data-stu-id="6d340-123">A user cuts or copies Shell data, such as one or more files, to the Clipboard.</span></span> <span data-ttu-id="6d340-124">Die andere Anwendung ruft die Daten aus der Zwischenablage ab.</span><span class="sxs-lookup"><span data-stu-id="6d340-124">The other application retrieves the data from the Clipboard.</span></span>
-   <span data-ttu-id="6d340-125">Ein Benutzer zieht ein Symbol, das die Daten aus der Quell Anwendung darstellt, und löscht das Symbol in einem Fenster, das dem Ziel gehört.</span><span class="sxs-lookup"><span data-stu-id="6d340-125">A user drags an icon that represents the data from the source application and drops the icon on a window owned by the target.</span></span>

<span data-ttu-id="6d340-126">In beiden Fällen sind die übertragenen Daten in einem *Datenobjekt* enthalten.</span><span class="sxs-lookup"><span data-stu-id="6d340-126">In both cases, the transferred data is contained in a *data object*.</span></span> <span data-ttu-id="6d340-127">Datenobjekte sind Component Object Model (com)-Objekte, die die [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Schnittstelle verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="6d340-127">Data objects are Component Object Model (COM) objects that expose the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="6d340-128">Schematisch gibt es drei wesentliche Schritte, die alle shelldatenübertragungen ausführen müssen:</span><span class="sxs-lookup"><span data-stu-id="6d340-128">Schematically, there are three essential steps that all Shell data transfers must follow:</span></span>

1.  <span data-ttu-id="6d340-129">Die Quelle erstellt ein Datenobjekt, das die zu übertragenden Daten darstellt.</span><span class="sxs-lookup"><span data-stu-id="6d340-129">The source creates a data object that represents the data that is to be transferred.</span></span>
2.  <span data-ttu-id="6d340-130">Das Ziel erhält einen Zeiger auf die [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Schnittstelle des Datenobjekts.</span><span class="sxs-lookup"><span data-stu-id="6d340-130">The target receives a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
3.  <span data-ttu-id="6d340-131">Das Ziel Ruft die [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Schnittstelle auf, um die Daten daraus zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="6d340-131">The target calls the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface to extract the data from it.</span></span>

<span data-ttu-id="6d340-132">Der Unterschied zwischen der Zwischenablage und den Drag & Drop-Datenübertragungen liegt in erster Linie darin, wie der [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Zeiger von der Quelle zum Ziel übertragen wird.</span><span class="sxs-lookup"><span data-stu-id="6d340-132">The difference between Clipboard and drag-and-drop data transfers lies primarily in how the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer is transferred from the source to the target.</span></span>

### <a name="clipboard-data-transfers"></a><span data-ttu-id="6d340-133">Zwischenablage-Datenübertragungen</span><span class="sxs-lookup"><span data-stu-id="6d340-133">Clipboard Data Transfers</span></span>

<span data-ttu-id="6d340-134">Die Zwischenablage ist die einfachste Methode zum Übertragen von shelldaten.</span><span class="sxs-lookup"><span data-stu-id="6d340-134">The Clipboard is the simplest way to transfer Shell data.</span></span> <span data-ttu-id="6d340-135">Das grundlegende Verfahren ähnelt den standardmäßigen Zwischenablage Datenübertragungen.</span><span class="sxs-lookup"><span data-stu-id="6d340-135">The basic procedure is similar to standard Clipboard data transfers.</span></span> <span data-ttu-id="6d340-136">Da Sie jedoch einen Zeiger auf ein Datenobjekt, nicht die Daten selbst, übertragen, müssen Sie die OLE-Zwischenablage-API anstelle der Standard-Zwischenablage-API verwenden.</span><span class="sxs-lookup"><span data-stu-id="6d340-136">However, because you are transferring a pointer to a data object, not the data itself, you must use the OLE clipboard API instead of the standard clipboard API.</span></span> <span data-ttu-id="6d340-137">Im folgenden Verfahren wird erläutert, wie die OLE-Zwischenablage-API zum Übertragen von shelldaten mit der Zwischenablage verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="6d340-137">The following procedure outlines how to use the OLE clipboard API to transfer Shell data with the Clipboard:</span></span>

1.  <span data-ttu-id="6d340-138">Die Datenquelle erstellt ein Datenobjekt, das die Daten enthält.</span><span class="sxs-lookup"><span data-stu-id="6d340-138">The data source creates a data object to contain the data.</span></span>
2.  <span data-ttu-id="6d340-139">Die Datenquelle ruft [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard)auf, wodurch ein Zeiger auf die [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Schnittstelle des Datenobjekts in der Zwischenablage platziert wird.</span><span class="sxs-lookup"><span data-stu-id="6d340-139">The data source calls [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), which places a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface on the Clipboard.</span></span>
3.  <span data-ttu-id="6d340-140">Das Ziel ruft [**olegetclipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) auf, um den Zeiger auf die [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Schnittstelle des Datenobjekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="6d340-140">The target calls [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) to retrieve the pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
4.  <span data-ttu-id="6d340-141">Das Ziel extrahiert die Daten, indem die [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) -Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="6d340-141">The target extracts the data by calling the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span>
5.  <span data-ttu-id="6d340-142">Bei einigen shelldatenübertragungen muss das Ziel möglicherweise auch die [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) -Methode des Datenobjekts aufrufen, um dem Datenobjekt für das Ergebnis der Datenübertragung Feedback zu geben.</span><span class="sxs-lookup"><span data-stu-id="6d340-142">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the data object on the outcome of the data transfer.</span></span> <span data-ttu-id="6d340-143">Ein Beispiel für diese Art von Vorgang finden Sie unter [Handling optimierte](datascenarios.md) Verschiebungs Vorgänge.</span><span class="sxs-lookup"><span data-stu-id="6d340-143">See [Handling Optimized Move Operations](datascenarios.md) for an example of this type of operation.</span></span>

### <a name="drag-and-drop-data-transfers"></a><span data-ttu-id="6d340-144">Datenübertragungen per Drag & Drop</span><span class="sxs-lookup"><span data-stu-id="6d340-144">Drag-and-Drop Data Transfers</span></span>

<span data-ttu-id="6d340-145">Die Datenübertragung mit Drag & Drop ist zwar etwas komplexer, bietet jedoch einige bedeutende Vorteile gegenüber der Zwischenablage:</span><span class="sxs-lookup"><span data-stu-id="6d340-145">While somewhat more complex to implement, drag-and-drop data transfer has some significant advantages over the Clipboard:</span></span>

-   <span data-ttu-id="6d340-146">Drag & Drop-Übertragungen können mit einer einfachen Mausbewegung durchgeführt werden, sodass der Betrieb flexibler und intuitiver ist als die Zwischenablage.</span><span class="sxs-lookup"><span data-stu-id="6d340-146">Drag-and-drop transfers can be done with a simple mouse movement, making operation more flexible and intuitive to use than the Clipboard.</span></span>
-   <span data-ttu-id="6d340-147">Durch Drag & amp; Drop erhält der Benutzer eine visuelle Darstellung des Vorgangs.</span><span class="sxs-lookup"><span data-stu-id="6d340-147">Drag-and-drop provides the user with a visual representation of the operation.</span></span> <span data-ttu-id="6d340-148">Der Benutzer kann dem Symbol folgen, wenn es von der Quelle zum Ziel wechselt.</span><span class="sxs-lookup"><span data-stu-id="6d340-148">The user can follow the icon as it moves from source to target.</span></span>
-   <span data-ttu-id="6d340-149">Durch Drag & amp; Drop wird das Ziel benachrichtigt, wenn die Daten verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="6d340-149">Drag-and-drop notifies the target when the data is available.</span></span>

<span data-ttu-id="6d340-150">Bei Drag & Drop-Vorgängen werden auch Datenobjekte verwendet, um Daten zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="6d340-150">Drag-and-drop operations also use data objects to transfer data.</span></span> <span data-ttu-id="6d340-151">Allerdings muss die Drop-Quelle über die für Zwischenablage Übertragungen erforderliche Funktionalität hinaus bereitstellen:</span><span class="sxs-lookup"><span data-stu-id="6d340-151">However, the drop source must provide functionality beyond that required for Clipboard transfers:</span></span>

-   <span data-ttu-id="6d340-152">Die Drop-Quelle muss außerdem ein Objekt erstellen, das eine [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) -Schnittstelle verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="6d340-152">The drop source must also create an object that exposes an [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface.</span></span> <span data-ttu-id="6d340-153">Das System verwendet **IDropSource** , um mit der Quelle zu kommunizieren, während der Vorgang ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="6d340-153">The system uses **IDropSource** to communicate with the source while the operation is in progress.</span></span>
-   <span data-ttu-id="6d340-154">Das Drag & amp; Drop-Datenobjekt ist für die Überwachung der Cursor Bewegung und die Anzeige eines Symbols zur Darstellung des Datenobjekts verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="6d340-154">The drag-and-drop data object is responsible for tracking cursor movement and displaying an icon to represent the data object.</span></span>

<span data-ttu-id="6d340-155">Drop Targets muss auch mehr Funktionalität bereitstellen, als für die Verarbeitung von Zwischenablage Übertragungen erforderlich ist:</span><span class="sxs-lookup"><span data-stu-id="6d340-155">Drop targets must also provide more functionality than is needed to handle Clipboard transfers:</span></span>

-   <span data-ttu-id="6d340-156">Das Ablage Ziel muss eine [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) -Schnittstelle verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="6d340-156">The drop target must expose an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="6d340-157">Wenn sich der Cursor über einem Zielfenster befindet, verwendet das System **IDropTarget** , um dem Ziel Informationen, wie z. b. die Cursorposition, bereitzustellen und Sie zu benachrichtigen, wenn die Daten gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="6d340-157">When the cursor is over a target window, the system uses **IDropTarget** to provide the target with information such as the cursor position, and to notify it when the data is dropped.</span></span>
-   <span data-ttu-id="6d340-158">Das Ablage Ziel muss sich selbst beim System registrieren, indem [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="6d340-158">The drop target must register itself with the system by calling [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span></span> <span data-ttu-id="6d340-159">Diese Funktion stellt dem System das Handle für ein Zielfenster und einen Zeiger auf die [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) -Schnittstelle der Zielanwendung bereit.</span><span class="sxs-lookup"><span data-stu-id="6d340-159">This function provides the system with the handle to a target window and a pointer to the target application's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span>

> [!Note]  
> <span data-ttu-id="6d340-160">Bei Drag & Drop-Vorgängen muss Ihre Anwendung com mit [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize)initialisieren, nicht mit [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span><span class="sxs-lookup"><span data-stu-id="6d340-160">For drag-and-drop operations, your application must initialize COM with [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), not [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span></span>

 

<span data-ttu-id="6d340-161">Im folgenden Verfahren werden die wesentlichen Schritte erläutert, die in der Regel zum Übertragen von shelldaten per Drag & Drop verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="6d340-161">The following procedure outlines the essential steps that are typically used to transfer Shell data with drag-and-drop:</span></span>

1.  <span data-ttu-id="6d340-162">Das Ziel ruft [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) auf, um dem System einen Zeiger auf seine [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) -Schnittstelle zu übergeben und ein Fenster als Ablage Ziel zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="6d340-162">The target calls [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) to give the system a pointer to its [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface and register a window as a drop target.</span></span>
2.  <span data-ttu-id="6d340-163">Wenn der Benutzer einen Drag & Drop-Vorgang startet, erstellt die Quelle ein Datenobjekt und initiiert eine *Drag-Schleife* durch Aufrufen von [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span><span class="sxs-lookup"><span data-stu-id="6d340-163">When the user starts a drag-and-drop operation, the source creates a data object and initiates a *drag loop* by calling [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span></span>
3.  <span data-ttu-id="6d340-164">Wenn sich der Cursor über dem Zielfenster befindet, benachrichtigt das System das Ziel, indem es eine der [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) -Methoden des Ziels aufruft.</span><span class="sxs-lookup"><span data-stu-id="6d340-164">When the cursor is over the target window, the system notifies the target by calling one of the target's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) methods.</span></span> <span data-ttu-id="6d340-165">Das System ruft [**IDropTarget::D ragenter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) auf, wenn der Cursor das Zielfenster eingibt, und [**IDropTarget::D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) , wenn der Cursor über das Zielfenster bewegt wird.</span><span class="sxs-lookup"><span data-stu-id="6d340-165">The system calls [**IDropTarget::DragEnter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) when the cursor enters the target window, and [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) as the cursor passes over the target window.</span></span> <span data-ttu-id="6d340-166">Beide Methoden stellen das Ablage Ziel mit der aktuellen Cursorposition und dem Zustand von Tastatur-modifiziererschlüsseln, wie z. b. STRG oder alt, bereit.</span><span class="sxs-lookup"><span data-stu-id="6d340-166">Both methods provide the drop target with the current cursor position and the state of keyboard modifier keys such as CTRL or ALT.</span></span> <span data-ttu-id="6d340-167">Wenn der Cursor das Zielfenster verlässt, benachrichtigt das System das Ziel durch Aufrufen von [**IDropTarget::D ragleave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span><span class="sxs-lookup"><span data-stu-id="6d340-167">When the cursor leaves the target window, the system notifies the target by calling [**IDropTarget::DragLeave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span></span> <span data-ttu-id="6d340-168">Wenn eine dieser Methoden zurückgibt, ruft das System die [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) -Schnittstelle auf, um den Rückgabewert an die Quelle zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="6d340-168">When any of these methods return, the system calls the [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface to pass the return value to the source.</span></span>
4.  <span data-ttu-id="6d340-169">Wenn der Benutzer die Maustaste loslässt, um die Daten zu löschen, ruft das System die [**IDropTarget::D ROP**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) -Methode des Ziels auf.</span><span class="sxs-lookup"><span data-stu-id="6d340-169">When the user releases the mouse button to drop the data, the system calls the target's [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) method.</span></span> <span data-ttu-id="6d340-170">Neben den Parametern der Methode ist ein Zeiger auf die [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Schnittstelle des Datenobjekts.</span><span class="sxs-lookup"><span data-stu-id="6d340-170">Among the method's parameters is a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
5.  <span data-ttu-id="6d340-171">Das Ziel Ruft die [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) -Methode des Datenobjekts auf, um die Daten zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="6d340-171">The target calls the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to extract the data.</span></span>
6.  <span data-ttu-id="6d340-172">Bei einigen shelldatenübertragungen muss das Ziel möglicherweise auch die [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) -Methode des Datenobjekts aufrufen, um der Quelle Feedback für das Ergebnis der Datenübertragung zu geben.</span><span class="sxs-lookup"><span data-stu-id="6d340-172">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the source on the outcome of the data transfer.</span></span>
7.  <span data-ttu-id="6d340-173">Wenn das Ziel mit dem Datenobjekt fertig ist, wird es von [**IDropTarget::D ROP**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop)zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6d340-173">When the target is finished with the data object, it returns from [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span></span> <span data-ttu-id="6d340-174">Das System gibt den [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) -Anrufe der Quelle zurück, um die Quelle zu benachrichtigen, dass die Datenübertragung beendet ist.</span><span class="sxs-lookup"><span data-stu-id="6d340-174">The system returns the source's [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) call to notify the source that the data transfer is complete.</span></span>
8.  <span data-ttu-id="6d340-175">Abhängig vom jeweiligen [Datenübertragungs Szenario](datascenarios.md)muss die Quelle möglicherweise zusätzliche Maßnahmen ergreifen, basierend auf dem von [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) zurückgegebenen Wert und den Werten, die vom Ziel an das Datenobjekt übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="6d340-175">Depending on the particular [data transfer scenario](datascenarios.md), the source might need to take additional action based on the value returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) and the values that are passed to the data object by the target.</span></span> <span data-ttu-id="6d340-176">Wenn beispielsweise eine Datei verschoben wird, muss die Quelle diese Werte überprüfen, um zu bestimmen, ob Sie die ursprüngliche Datei löschen muss.</span><span class="sxs-lookup"><span data-stu-id="6d340-176">For instance, when a file is moved, the source must check these values to determine whether it must delete the original file.</span></span>
9.  <span data-ttu-id="6d340-177">Die Quelle gibt das Datenobjekt frei.</span><span class="sxs-lookup"><span data-stu-id="6d340-177">The source releases the data object.</span></span>

<span data-ttu-id="6d340-178">Obwohl die oben beschriebenen Prozeduren ein gutes allgemeines Modell für Shell-Datenübertragungen darstellen, gibt es viele verschiedene Arten von Daten, die in einem shelldatenobjekt enthalten sein können.</span><span class="sxs-lookup"><span data-stu-id="6d340-178">While the procedures outlined above provide a good general model for Shell data transfer, there are many different types of data that can be contained in a Shell data object.</span></span> <span data-ttu-id="6d340-179">Es gibt auch eine Reihe verschiedener Datenübertragungs Szenarien, die Ihre Anwendung möglicherweise verarbeiten muss.</span><span class="sxs-lookup"><span data-stu-id="6d340-179">There are also a number of different data transfer scenarios that your application might need to handle.</span></span> <span data-ttu-id="6d340-180">Jeder Datentyp und jedes Szenario erfordert einen etwas anderen Ansatz für drei wichtige Schritte in der Prozedur:</span><span class="sxs-lookup"><span data-stu-id="6d340-180">Each data type and scenario requires a somewhat different approach to three key steps in the procedure:</span></span>

-   <span data-ttu-id="6d340-181">Gibt an, wie eine Quelle ein Datenobjekt erstellt, das die shelldaten enthalten soll.</span><span class="sxs-lookup"><span data-stu-id="6d340-181">How a source constructs a data object to contain the Shell data.</span></span>
-   <span data-ttu-id="6d340-182">Gibt an, wie ein Ziel shelldaten aus dem Datenobjekt extrahiert.</span><span class="sxs-lookup"><span data-stu-id="6d340-182">How a target extracts Shell data from the data object.</span></span>
-   <span data-ttu-id="6d340-183">Gibt an, wie der Daten Übertragungsvorgang von der Quelle abgeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="6d340-183">How the source completes the data transfer operation.</span></span>

<span data-ttu-id="6d340-184">Das [Shell-Datenobjekt](dataobject.md) bietet eine allgemeine Erörterung der Art und Weise, wie eine Quelle ein shelldatenobjekt erstellt und wie dieses Datenobjekt vom Ziel behandelt werden kann.</span><span class="sxs-lookup"><span data-stu-id="6d340-184">The [Shell Data Object](dataobject.md) provides a general discussion of how a source constructs a Shell data object, and how that data object can be handled by the target.</span></span> <span data-ttu-id="6d340-185">Bei der [Behandlung von Shell-Datenübertragung Szenarios](datascenarios.md) wird ausführlich erläutert, wie eine Reihe allgemeiner Shell-Datenübertragungs Szenarien behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="6d340-185">[Handling Shell Data Transfer Scenarios](datascenarios.md) discusses in detail how to handle a number of common Shell data transfer scenarios.</span></span>

 

 
