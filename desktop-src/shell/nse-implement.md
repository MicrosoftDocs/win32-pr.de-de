---
description: Die Vorgehensweise zum Implementieren einer Namespace Erweiterung ähnelt der Vorgehensweise für alle anderen in-Process-Component Object Model (com)-Objekte.
title: Implementieren der grundlegenden Ordner Objekt Schnittstellen
ms.topic: article
ms.date: 05/31/2018
ms.assetid: a45b8011-5355-429b-8935-4a7bdb5d2316
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: c05f5d2e4c21a923856c7324ad2d407230fa7595
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104980001"
---
# <a name="implementing-the-basic-folder-object-interfaces"></a><span data-ttu-id="159f1-103">Implementieren der grundlegenden Ordner Objekt Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="159f1-103">Implementing the Basic Folder Object Interfaces</span></span>

<span data-ttu-id="159f1-104">Die Vorgehensweise zum Implementieren einer Namespace Erweiterung ähnelt der Vorgehensweise für alle anderen in-Process-Component Object Model (com)-Objekte.</span><span class="sxs-lookup"><span data-stu-id="159f1-104">The procedure for implementing a namespace extension is similar to that for any other in-process Component Object Model (COM) object.</span></span> <span data-ttu-id="159f1-105">Alle Erweiterungen müssen drei primäre Schnittstellen unterstützen, die Windows-Explorer die grundlegenden Informationen bereitstellen, die erforderlich sind, um die Ordner der Erweiterung in der Strukturansicht anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="159f1-105">All extensions must support three primary interfaces that provide Windows Explorer with the basic information needed to display the extension's folders in the tree view.</span></span> <span data-ttu-id="159f1-106">Um die Funktionen von Windows Explorer vollständig nutzen zu können, muss Ihre Erweiterung aber auch eine oder mehrere optionale Schnittstellen verfügbar machen, die komplexere Features unterstützen, wie z. b. Kontextmenüs oder Drag & amp; Drop, und eine Ordneransicht bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-106">However, to make full use of the capabilities of Windows Explorer, your extension must also expose one or more optional interfaces that support more sophisticated features, such as shortcut menus or drag-and-drop, and provide a folder view.</span></span>

<span data-ttu-id="159f1-107">In diesem Dokument wird erläutert, wie die primären und optionalen Schnittstellen implementiert werden, die Windows Explorer zum Aufrufen von Informationen über die Inhalte ihrer Erweiterung aufruft.</span><span class="sxs-lookup"><span data-stu-id="159f1-107">This document discusses how to implement the primary and optional interfaces that Windows Explorer calls for information about the contents of your extension.</span></span> <span data-ttu-id="159f1-108">Eine Erläuterung zur Implementierung einer Ordneransicht und zum Anpassen von Windows-Explorer finden Sie unter [Implementieren einer Ordneransicht](../lwef/nse-folderview.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-108">For a discussion of how to implement a folder view and how to customize Windows Explorer, see [Implementing a Folder View](../lwef/nse-folderview.md).</span></span>

-   [<span data-ttu-id="159f1-109">Grundlegende Implementierung und Registrierung</span><span class="sxs-lookup"><span data-stu-id="159f1-109">Basic Implementation and Registration</span></span>](#basic-implementation-and-registration)
    -   [<span data-ttu-id="159f1-110">Registrieren einer Erweiterung</span><span class="sxs-lookup"><span data-stu-id="159f1-110">Registering an Extension</span></span>](#registering-an-extension)
-   [<span data-ttu-id="159f1-111">Behandeln von pidls</span><span class="sxs-lookup"><span data-stu-id="159f1-111">Handling PIDLs</span></span>](#handling-pidls)
    -   [<span data-ttu-id="159f1-112">Erstellen einer shitemid-Struktur</span><span class="sxs-lookup"><span data-stu-id="159f1-112">Creating an SHITEMID Structure</span></span>](#creating-an-shitemid-structure)
    -   [<span data-ttu-id="159f1-113">Erstellen einer PIDL</span><span class="sxs-lookup"><span data-stu-id="159f1-113">Constructing a PIDL</span></span>](#constructing-a-pidl)
    -   [<span data-ttu-id="159f1-114">Interpretieren von pidls</span><span class="sxs-lookup"><span data-stu-id="159f1-114">Interpreting PIDLs</span></span>](#interpreting-pidls)
-   [<span data-ttu-id="159f1-115">Implementieren der primären Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="159f1-115">Implementing the Primary Interfaces</span></span>](#implementing-the-primary-interfaces)
    -   [<span data-ttu-id="159f1-116">Ipersistfolder-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="159f1-116">IPersistFolder Interface</span></span>](#ipersistfolder-interface)
    -   [<span data-ttu-id="159f1-117">IShellFolder-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="159f1-117">IShellFolder Interface</span></span>](#ishellfolder-interface)
    -   [<span data-ttu-id="159f1-118">Ienumittellist-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="159f1-118">IEnumIDList Interface</span></span>](#ienumidlist-interface)
-   [<span data-ttu-id="159f1-119">Implementieren der optionalen Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="159f1-119">Implementing the Optional Interfaces</span></span>](#implementing-the-optional-interfaces)
    -   [<span data-ttu-id="159f1-120">Iextracticon</span><span class="sxs-lookup"><span data-stu-id="159f1-120">IExtractIcon</span></span>](#iextracticon)
    -   [<span data-ttu-id="159f1-121">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="159f1-121">IContextMenu</span></span>](#icontextmenu)
    -   [<span data-ttu-id="159f1-122">Iqueryinfo</span><span class="sxs-lookup"><span data-stu-id="159f1-122">IQueryInfo</span></span>](#iqueryinfo)
    -   [<span data-ttu-id="159f1-123">IDataObject und IDropTarget</span><span class="sxs-lookup"><span data-stu-id="159f1-123">IDataObject and IDropTarget</span></span>](#idataobject-and-idroptarget)
-   [<span data-ttu-id="159f1-124">Arbeiten mit der standardmäßigen Shell-Ordner Ansichts Implementierung</span><span class="sxs-lookup"><span data-stu-id="159f1-124">Working With the Default Shell Folder View Implementation</span></span>](#working-with-the-default-shell-folder-view-implementation)

## <a name="basic-implementation-and-registration"></a><span data-ttu-id="159f1-125">Grundlegende Implementierung und Registrierung</span><span class="sxs-lookup"><span data-stu-id="159f1-125">Basic Implementation and Registration</span></span>

<span data-ttu-id="159f1-126">Als Prozess interner com-Server muss die DLL mehrere Standardfunktionen und-Schnittstellen verfügbar machen:</span><span class="sxs-lookup"><span data-stu-id="159f1-126">As an in-process COM server, your DLL must expose several standard functions and interfaces:</span></span>

-   [<span data-ttu-id="159f1-127">**DllCanUnloadNow**</span><span class="sxs-lookup"><span data-stu-id="159f1-127">**DllCanUnloadNow**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)
-   [<span data-ttu-id="159f1-128">**DllGetClassObject**</span><span class="sxs-lookup"><span data-stu-id="159f1-128">**DllGetClassObject**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)
-   [<span data-ttu-id="159f1-129">**IClassFactory**</span><span class="sxs-lookup"><span data-stu-id="159f1-129">**IClassFactory**</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)
-   [<span data-ttu-id="159f1-130">**IUnknown**</span><span class="sxs-lookup"><span data-stu-id="159f1-130">**IUnknown**</span></span>](/windows/win32/api/unknwn/nn-unknwn-iunknown)

<span data-ttu-id="159f1-131">Diese Funktionen und Schnittstellen werden auf die gleiche Weise wie für die meisten anderen COM-Objekte implementiert.</span><span class="sxs-lookup"><span data-stu-id="159f1-131">These functions and interfaces are implemented in the same way as they are for most other COM objects.</span></span> <span data-ttu-id="159f1-132">Weitere Informationen finden Sie in der [com-Dokumentation](../com/the-component-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-132">For details, see the [COM documentation](../com/the-component-object-model.md).</span></span>

### <a name="registering-an-extension"></a><span data-ttu-id="159f1-133">Registrieren einer Erweiterung</span><span class="sxs-lookup"><span data-stu-id="159f1-133">Registering an Extension</span></span>

<span data-ttu-id="159f1-134">Wie bei allen COM-Objekten müssen Sie eine GUID für die Klassen-ID (CLSID) für die Erweiterung erstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-134">As with all COM objects, you must create a class identifier (CLSID) GUID for your extension.</span></span> <span data-ttu-id="159f1-135">Registrieren Sie das Objekt, indem Sie einen Unterschlüssel der **HKEY \_ Classes \_ root** \\ **CLSID** mit dem Namen für die CLSID der Erweiterung erstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-135">Register the object by creating a subkey of **HKEY\_CLASSES\_ROOT**\\**CLSID** named for the CLSID of your extension.</span></span> <span data-ttu-id="159f1-136">Die dll muss als Prozess interner Server registriert sein und das Apartment Thread Modell angeben.</span><span class="sxs-lookup"><span data-stu-id="159f1-136">The DLL should be registered as an in-process server and should specify the apartment threading model.</span></span> <span data-ttu-id="159f1-137">Sie können das Verhalten des Stamm Ordners einer Erweiterung anpassen, indem Sie dem CLSID-Schlüssel der Erweiterung eine Vielzahl von unter Schlüsseln und Werten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="159f1-137">You can customize the behavior of an extension's root folder by adding a variety of subkeys and values to the extension's CLSID key.</span></span>

<span data-ttu-id="159f1-138">Einige dieser Werte gelten nur für Erweiterungen mit virtuellen Verknüpfungs Punkten.</span><span class="sxs-lookup"><span data-stu-id="159f1-138">Several of these values apply only to extensions with virtual junction points.</span></span> <span data-ttu-id="159f1-139">Diese Werte gelten nicht für Erweiterungen, deren Verknüpfungs Punkte Dateisystem Ordner sind.</span><span class="sxs-lookup"><span data-stu-id="159f1-139">These values do not apply to extensions whose junction points are file system folders.</span></span> <span data-ttu-id="159f1-140">Weitere Informationen finden Sie unter [angeben des Speicher Orts einer Namespace Erweiterung](nse-junction.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-140">For further discussion, see [Specifying a Namespace Extension's Location](nse-junction.md).</span></span> <span data-ttu-id="159f1-141">Um das Verhalten einer Erweiterung mit einem virtuellen Verknüpfungs Punkt zu ändern, fügen Sie dem CLSID-Schlüssel der Erweiterung mindestens einen der folgenden Werte hinzu:</span><span class="sxs-lookup"><span data-stu-id="159f1-141">To modify the behavior of an extension with a virtual junction point, add one or more of the following values to the extension's CLSID key:</span></span>

-   <span data-ttu-id="159f1-142">Wantsforparamesing.</span><span class="sxs-lookup"><span data-stu-id="159f1-142">WantsFORPARSING.</span></span> <span data-ttu-id="159f1-143">Der namens Name für eine Erweiterung mit einem virtuellen Verknüpfungs Punkt weist normalerweise das folgende Format auf: {*GUID*}.</span><span class="sxs-lookup"><span data-stu-id="159f1-143">The parsing name for an extension with a virtual junction point will normally have the form ::{*GUID*}.</span></span> <span data-ttu-id="159f1-144">Erweiterungen dieses Typs enthalten normalerweise virtuelle Elemente.</span><span class="sxs-lookup"><span data-stu-id="159f1-144">Extensions of this type normally contain virtual items.</span></span> <span data-ttu-id="159f1-145">Einige Erweiterungen, z. b. eigene Dokumente, entsprechen jedoch tatsächlich Dateisystem Ordnern, auch wenn Sie über virtuelle Verknüpfungs Punkte verfügen.</span><span class="sxs-lookup"><span data-stu-id="159f1-145">However, some extensions, such as My Documents, actually correspond to file system folders, even though they have virtual junction points.</span></span> <span data-ttu-id="159f1-146">Wenn die Erweiterung Dateisystem Objekte auf diese Weise darstellt, können Sie den Wert wantsforbising festlegen.</span><span class="sxs-lookup"><span data-stu-id="159f1-146">If your extension represents file system objects in this way, you can set the WantsFORPARSING value.</span></span> <span data-ttu-id="159f1-147">Windows-Explorer fordert dann den Namen des Stamm Ordners an, indem er die [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) -Methode des Ordner Objekts mit *uFlags* , die auf **shgdn- \_ forcsing** festgelegt sind, und *PIDL* auf einen einzelnen leeren Zeiger auf eine Element Bezeichner-Liste (PIDL) festgelegt hat.</span><span class="sxs-lookup"><span data-stu-id="159f1-147">Windows Explorer will then request your root folder's parsing name by calling the folder object's [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method with *uFlags* set to **SHGDN\_FORPARSING** and *pidl* set to a single empty pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="159f1-148">Eine leere PIDL enthält nur ein Terminator.</span><span class="sxs-lookup"><span data-stu-id="159f1-148">An empty PIDL contains only a terminator.</span></span> <span data-ttu-id="159f1-149">Die Methode sollte dann den Namen des Stamm Ordners:: {*GUID*}-Parser zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="159f1-149">Your method should then return the root folder's ::{*GUID*} parsing name.</span></span>
-   <span data-ttu-id="159f1-150">Hidefolderverbs.</span><span class="sxs-lookup"><span data-stu-id="159f1-150">HideFolderVerbs.</span></span> <span data-ttu-id="159f1-151">Die Verben, die unter **HKEY \_ Classes \_ root** \\ **Folder** registriert sind, sind normalerweise allen Erweiterungen zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="159f1-151">The verbs registered under **HKEY\_CLASSES\_ROOT**\\**Folder** normally are associated with all extensions.</span></span> <span data-ttu-id="159f1-152">Sie werden im Kontextmenü der Erweiterung angezeigt und können von [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea)aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-152">They appear on the extension's shortcut menu and can be invoked by [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea).</span></span> <span data-ttu-id="159f1-153">Um zu verhindern, dass diese Verben ihrer Erweiterung zugeordnet werden, legen Sie den Wert hidefolderverbs fest.</span><span class="sxs-lookup"><span data-stu-id="159f1-153">To prevent any of these verbs from being associated with your extension, set the HideFolderVerbs value.</span></span>
-   <span data-ttu-id="159f1-154">Hideasdelete.</span><span class="sxs-lookup"><span data-stu-id="159f1-154">HideAsDelete.</span></span> <span data-ttu-id="159f1-155">Wenn ein Benutzer versucht, die Erweiterung zu löschen, wird die Erweiterung stattdessen von Windows-Explorer ausgeblendet.</span><span class="sxs-lookup"><span data-stu-id="159f1-155">If a user attempts to delete your extension, Windows Explorer will instead hide the extension.</span></span>
-   <span data-ttu-id="159f1-156">Hideasdeleteperuser.</span><span class="sxs-lookup"><span data-stu-id="159f1-156">HideAsDeletePerUser.</span></span> <span data-ttu-id="159f1-157">Dieser Wert hat die gleiche Wirkung wie hideasdelete, aber auf Benutzerbasis.</span><span class="sxs-lookup"><span data-stu-id="159f1-157">This value has the same effect as HideAsDelete but on a per-user basis.</span></span> <span data-ttu-id="159f1-158">Die Erweiterung ist nur für Benutzer verborgen, die versucht haben, Sie zu löschen.</span><span class="sxs-lookup"><span data-stu-id="159f1-158">The extension is hidden only for those users who have attempted to delete it.</span></span> <span data-ttu-id="159f1-159">Die Erweiterung ist für alle anderen Benutzer sichtbar.</span><span class="sxs-lookup"><span data-stu-id="159f1-159">The extension is visible to all other users.</span></span>
-   <span data-ttu-id="159f1-160">Queryforoverlay.</span><span class="sxs-lookup"><span data-stu-id="159f1-160">QueryForOverlay.</span></span> <span data-ttu-id="159f1-161">Legen Sie diesen Wert fest, um anzugeben, dass das Symbol des Stamm Ordners eine Symbol Überlagerung aufweisen kann.</span><span class="sxs-lookup"><span data-stu-id="159f1-161">Set this value to indicate that the root folder's icon can have an icon overlay.</span></span> <span data-ttu-id="159f1-162">Das Folder-Objekt muss die [**ishellienoverlay**](/windows/win32/api/shlobj_core/nn-shlobj_core-ishelliconoverlay) -Schnittstelle unterstützen.</span><span class="sxs-lookup"><span data-stu-id="159f1-162">The folder object must support the [**IShellIconOverlay**](/windows/win32/api/shlobj_core/nn-shlobj_core-ishelliconoverlay) interface.</span></span> <span data-ttu-id="159f1-163">Bevor Windows Explorer das Symbol des Stamm Ordners anzeigt, wird ein Überlagerungs Symbol angefordert, indem eine der beiden **ishellienoverlay** -Methoden aufgerufen wird, bei der *pidlitem* auf eine leere PIDL festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-163">Before Windows Explorer displays the root folder's icon, it will request an overlay icon by calling one of the two **IShellIconOverlay** methods with *pidlItem* set to an empty PIDL.</span></span>

<span data-ttu-id="159f1-164">Die verbleibenden Werte und Unterschlüssel gelten für alle Erweiterungen:</span><span class="sxs-lookup"><span data-stu-id="159f1-164">The remaining values and subkeys apply to all extensions:</span></span>

-   <span data-ttu-id="159f1-165">Um den anzeigen amen des Ordners für den Verknüpfungs Punkt der Erweiterung anzugeben, legen Sie den Standardwert des CLSID-unter Schlüssels der Erweiterung auf eine entsprechende Zeichenfolge fest.</span><span class="sxs-lookup"><span data-stu-id="159f1-165">To specify the display name of the extension's junction point folder, set the default value of the extension's CLSID subkey to an appropriate string.</span></span>
-   <span data-ttu-id="159f1-166">Wenn der Cursor auf einen Ordner zeigt, wird in der Regel ein InfoTipp angezeigt, in dem der Inhalt des Ordners beschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="159f1-166">When the cursor hovers over a folder, an infotip is typically displayed that describes the contents of the folder.</span></span> <span data-ttu-id="159f1-167">Um einen InfoTipp für den Stamm Ordner Ihrer Erweiterung anzugeben, erstellen Sie einen InfoTipp **reg \_ SZ** -Wert für den CLSID-Schlüssel der Erweiterung, und legen Sie ihn auf eine entsprechende Zeichenfolge fest.</span><span class="sxs-lookup"><span data-stu-id="159f1-167">To provide an infotip for your extension's root folder, create an InfoTip **REG\_SZ** value for the extension's CLSID key, and set it to an appropriate string.</span></span>
-   <span data-ttu-id="159f1-168">Um ein benutzerdefiniertes Symbol für den Stamm Ordner Ihrer Erweiterung anzugeben, erstellen Sie einen Unterschlüssel für den CLSID-Unterschlüssel der Erweiterung namens **DefaultIcon**.</span><span class="sxs-lookup"><span data-stu-id="159f1-168">To specify a custom icon for your extension's root folder, create a subkey of the extension's CLSID subkey named **DefaultIcon**.</span></span> <span data-ttu-id="159f1-169">Legen Sie den Standardwert von **DefaultIcon** auf einen **reg \_ SZ** -Wert fest, der den Namen der Datei enthält, in der das Symbol enthalten ist, gefolgt von einem Komma, gefolgt von einem Minuszeichen, gefolgt vom Index des Symbols in dieser Datei.</span><span class="sxs-lookup"><span data-stu-id="159f1-169">Set the default value of **DefaultIcon** to a **REG\_SZ** value containing the name of the file that contains the icon, followed by a comma, followed by a minus sign, followed by the index of the icon in that file.</span></span>
-   <span data-ttu-id="159f1-170">Standardmäßig enthält das Kontextmenü des Stamm Ordners der Erweiterung die Elemente, die unter **HKEY \_ Classes \_ root \\ Folder** definiert sind.</span><span class="sxs-lookup"><span data-stu-id="159f1-170">By default, the shortcut menu of your extension's root folder will contain the items defined under **HKEY\_CLASSES\_ROOT\\Folder**.</span></span> <span data-ttu-id="159f1-171">Wenn Sie die entsprechenden sfgao xxx-Flags festgelegt haben, werden die Elemente **Löschen**, **Umbenennen** und **Eigenschaften** hinzugefügt \_ .</span><span class="sxs-lookup"><span data-stu-id="159f1-171">The **Delete**, **Rename**, and **Properties** items are added if you have set the appropriate SFGAO\_XXX flags.</span></span> <span data-ttu-id="159f1-172">Sie können dem Kontextmenü des Stamm Ordners weitere Elemente hinzufügen oder vorhandene Elemente außer Kraft setzen, ähnlich wie für einen [Dateityp](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-172">You can add other items to the root folder's shortcut menu, or override existing items, much as you would for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="159f1-173">Erstellen Sie unter dem CLSID-Schlüssel der Erweiterung einen **shellunterschlüssel** , und definieren Sie die Befehle, wie unter Erweitern von Kontext [Menüs](context.md)erläutert.</span><span class="sxs-lookup"><span data-stu-id="159f1-173">Create a **Shell** subkey under the extension's CLSID key, and define commands as discussed in [Extending Shortcut Menus](context.md).</span></span>
-   <span data-ttu-id="159f1-174">Wenn Sie eine flexiblere Methode zum Behandeln des Kontextmenüs des Stamm Ordners benötigen, können Sie einen Kontext [Menü Handler](context-menu-handlers.md)implementieren.</span><span class="sxs-lookup"><span data-stu-id="159f1-174">If you need a more flexible way to handle the root folder's shortcut menu, you can implement a [shortcut menu handler](context-menu-handlers.md).</span></span> <span data-ttu-id="159f1-175">Um den Kontextmenü Handler zu registrieren, erstellen Sie unter dem CLSID-Schlüssel der Erweiterung einen **shellex** -Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="159f1-175">To register the shortcut menu handler, create a **ShellEx** key under the extension's CLSID key.</span></span> <span data-ttu-id="159f1-176">Registrieren Sie die CLSID des Handlers wie bei einem herkömmlichen [Erstellen von Shellerweiterungs Handlern](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-176">Register the handler's CLSID as you would for a conventional [Creating Shell Extension Handlers](handlers.md).</span></span>
-   <span data-ttu-id="159f1-177">Wenn Sie dem Eigenschaften Blatt des Stamm Ordners eine Seite hinzufügen möchten, geben Sie dem Ordner das **sfgao \_ haspropsheet** -Attribut, und implementieren Sie einen [Eigenschaften Blatt Handler](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-177">To add a page to the root folder's Properties property sheet, give the folder the **SFGAO\_HASPROPSHEET** attribute and implement a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="159f1-178">Um den Eigenschaften Blatt Handler zu registrieren, erstellen Sie unter dem CLSID-Schlüssel der Erweiterung einen **shellex** -Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="159f1-178">To register the property sheet handler, create a **ShellEx** key under the extension's CLSID key.</span></span> <span data-ttu-id="159f1-179">Registrieren Sie die CLSID des Handlers wie bei einem herkömmlichen [Erstellen von Shellerweiterungs Handlern](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-179">Register the handler's CLSID as you would for a conventional [Creating Shell Extension Handlers](handlers.md).</span></span>
-   <span data-ttu-id="159f1-180">Fügen Sie dem CLSID-Unterschlüssel der Erweiterung einen **ShellFolder** -Unterschlüssel hinzu, um die Attribute des Stamm Ordners anzugeben.</span><span class="sxs-lookup"><span data-stu-id="159f1-180">To specify the attributes of the root folder, add a **ShellFolder** subkey to the extension's CLSID subkey.</span></span> <span data-ttu-id="159f1-181">Erstellen Sie einen Attribut Wert, und legen Sie ihn auf die geeignete Kombination von [**sfgao \_ xxx**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) -Flags fest.</span><span class="sxs-lookup"><span data-stu-id="159f1-181">Create an Attributes value, and set it to the appropriate combination of [**SFGAO\_XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) flags.</span></span>

<span data-ttu-id="159f1-182">In der folgenden Tabelle werden einige häufig verwendete Attribute für Stamm Ordner aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="159f1-182">The following table lists some commonly used attributes for root folders.</span></span>



| <span data-ttu-id="159f1-183">Flag</span><span class="sxs-lookup"><span data-stu-id="159f1-183">Flag</span></span>                | <span data-ttu-id="159f1-184">Wert</span><span class="sxs-lookup"><span data-stu-id="159f1-184">Value</span></span>      | <span data-ttu-id="159f1-185">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="159f1-185">Description</span></span>                                                                                                                                                                                                                                                                                                       |
|---------------------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="159f1-186">sfgao- \_ Ordner</span><span class="sxs-lookup"><span data-stu-id="159f1-186">SFGAO\_FOLDER</span></span>       | <span data-ttu-id="159f1-187">0x20000000</span><span class="sxs-lookup"><span data-stu-id="159f1-187">0x20000000</span></span> | <span data-ttu-id="159f1-188">Der Stamm Ordner der Erweiterung enthält ein oder mehrere Elemente.</span><span class="sxs-lookup"><span data-stu-id="159f1-188">The extension's root folder contains one or more items.</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="159f1-189">sfgao \_ hassubfolder</span><span class="sxs-lookup"><span data-stu-id="159f1-189">SFGAO\_HASSUBFOLDER</span></span> | <span data-ttu-id="159f1-190">0x80000000</span><span class="sxs-lookup"><span data-stu-id="159f1-190">0x80000000</span></span> | <span data-ttu-id="159f1-191">Der Stamm Ordner der Erweiterung enthält mindestens einen Unterordner.</span><span class="sxs-lookup"><span data-stu-id="159f1-191">The extension's root folder contains one or more subfolders.</span></span> <span data-ttu-id="159f1-192">In Windows-Explorer wird ein Pluszeichen (+) neben dem Ordnersymbol platziert.</span><span class="sxs-lookup"><span data-stu-id="159f1-192">Windows Explorer will place a plus sign ( + ) next to the folder icon.</span></span>                                                                                                                                                                               |
| <span data-ttu-id="159f1-193">sfgao- \_ Kerzen</span><span class="sxs-lookup"><span data-stu-id="159f1-193">SFGAO\_CANDELETE</span></span>    | <span data-ttu-id="159f1-194">0x00000020</span><span class="sxs-lookup"><span data-stu-id="159f1-194">0x00000020</span></span> | <span data-ttu-id="159f1-195">Der Stamm Ordner der Erweiterung kann vom Benutzer gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-195">The extension's root folder can be deleted by the user.</span></span> <span data-ttu-id="159f1-196">Das Kontextmenü des Ordners enthält ein Element **Löschen** .</span><span class="sxs-lookup"><span data-stu-id="159f1-196">The folder's shortcut menu will have a **Delete** item.</span></span> <span data-ttu-id="159f1-197">Dieses Flag sollte für Verknüpfungs Punkte festgelegt werden, die unter einem der [virtuellen Ordner](nse-junction.md)abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-197">This flag should be set for junction points that are placed under one of the [virtual folders](nse-junction.md).</span></span>                                                                                 |
| <span data-ttu-id="159f1-198">sfgao \_ canrename</span><span class="sxs-lookup"><span data-stu-id="159f1-198">SFGAO\_CANRENAME</span></span>    | <span data-ttu-id="159f1-199">0x00000010</span><span class="sxs-lookup"><span data-stu-id="159f1-199">0x00000010</span></span> | <span data-ttu-id="159f1-200">Der Stamm Ordner der Erweiterung kann vom Benutzer umbenannt werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-200">The extension's root folder can be renamed by the user.</span></span> <span data-ttu-id="159f1-201">Das Kontextmenü des Ordners enthält ein Element zum **Umbenennen** .</span><span class="sxs-lookup"><span data-stu-id="159f1-201">The folder's shortcut menu will have a **Rename** item.</span></span>                                                                                                                                                                                                   |
| <span data-ttu-id="159f1-202">sfgao \_ haspropsheet</span><span class="sxs-lookup"><span data-stu-id="159f1-202">SFGAO\_HASPROPSHEET</span></span> | <span data-ttu-id="159f1-203">0x00000040</span><span class="sxs-lookup"><span data-stu-id="159f1-203">0x00000040</span></span> | <span data-ttu-id="159f1-204">Der Stamm Ordner der Erweiterung verfügt über ein Eigenschaften Blatt " **Eigenschaften** ".</span><span class="sxs-lookup"><span data-stu-id="159f1-204">The extension's root folder has a **Properties** property sheet.</span></span> <span data-ttu-id="159f1-205">Das Kontextmenü des Ordners enthält ein **Eigenschaften** Element.</span><span class="sxs-lookup"><span data-stu-id="159f1-205">The folder's shortcut menu will have a **Properties** item.</span></span> <span data-ttu-id="159f1-206">Um das Eigenschaften Blatt bereitzustellen, müssen Sie einen [Eigenschaften Blatt Handler](propsheet-handlers.md)implementieren.</span><span class="sxs-lookup"><span data-stu-id="159f1-206">To provide the property sheet, you must implement a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="159f1-207">Registrieren Sie den Handler unter dem CLSID-Schlüssel der Erweiterung, wie bereits erläutert.</span><span class="sxs-lookup"><span data-stu-id="159f1-207">Register the handler under the extension's CLSID key, as discussed previously.</span></span> |



 

<span data-ttu-id="159f1-208">Das folgende Beispiel zeigt den CLSID-Registrierungs Eintrag für eine Erweiterung mit dem anzeigen Amen MyExtension.</span><span class="sxs-lookup"><span data-stu-id="159f1-208">The following example shows the CLSID registry entry for an extension with a display name of MyExtension.</span></span> <span data-ttu-id="159f1-209">Die Erweiterung verfügt über ein benutzerdefiniertes Symbol, das in der dll der Erweiterung mit einem Index von 1 enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-209">The extension has a custom icon that is contained in the extension's DLL with an index of 1.</span></span> <span data-ttu-id="159f1-210">Der **sfgao- \_ Ordner**, **sfgao \_ hassubfolder** und **sfgao- \_ Kerzen** Attribute werden festgelegt.</span><span class="sxs-lookup"><span data-stu-id="159f1-210">The **SFGAO\_FOLDER**, **SFGAO\_HASSUBFOLDER**, and **SFGAO\_CANDELETE** attributes are set.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {Extension CLSID}
         (Default) = MyExtension
         InfoTip = Some appropriate text
      DefaultIcon
         (Default) = c:\MyDir\MyExtension.dll,-1
      InProcServer32
         (Default) = c:\MyDir\MyExtension.dll
         ThreadingModel = Apartment
      ShellFolder
         Attributes = 0xA00000020
```

## <a name="handling-pidls"></a><span data-ttu-id="159f1-211">Behandeln von pidls</span><span class="sxs-lookup"><span data-stu-id="159f1-211">Handling PIDLs</span></span>

<span data-ttu-id="159f1-212">Jedes Element im Shellnamespace muss eine eindeutige PIDL aufweisen.</span><span class="sxs-lookup"><span data-stu-id="159f1-212">Every item in the Shell namespace must have a unique PIDL.</span></span> <span data-ttu-id="159f1-213">Windows-Explorer weist Ihrem Stamm Ordner eine PIDL zu und übergibt den Wert während der Initialisierung an Ihre Erweiterung.</span><span class="sxs-lookup"><span data-stu-id="159f1-213">Windows Explorer assigns a PIDL to your root folder and passes the value to your extension during initialization.</span></span> <span data-ttu-id="159f1-214">Ihre Erweiterung ist dann dafür verantwortlich, jedem Ihrer Objekte eine ordnungsgemäß konstruierte PIDL zuzuweisen und diese pidls auf Anforderung an Windows-Explorer zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="159f1-214">Your extension is then responsible for assigning a properly constructed PIDL to each of its objects and providing those PIDLs to Windows Explorer on request.</span></span> <span data-ttu-id="159f1-215">Wenn die Shell eine PIDL verwendet, um eines der Objekte der Erweiterung zu identifizieren, muss die Erweiterung die PIDL interpretieren und das jeweilige Objekt identifizieren können.</span><span class="sxs-lookup"><span data-stu-id="159f1-215">When the Shell uses a PIDL to identify one of your extension's objects, your extension must be able to interpret the PIDL and identify the particular object.</span></span> <span data-ttu-id="159f1-216">In ihrer Erweiterung müssen jedem Objekt auch ein [**Anzeige Name**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-setnameof) und ein *namens Name* zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-216">Your extension must also assign a [**display name**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-setnameof) and a *parsing name* to each object.</span></span> <span data-ttu-id="159f1-217">Da pidls von praktisch jeder Ordner Schnittstelle verwendet werden, implementieren Erweiterungen in der Regel einen einzelnen *PIDL-Manager* , um all diese Aufgaben auszuführen.</span><span class="sxs-lookup"><span data-stu-id="159f1-217">Because PIDLs are used by virtually every folder interface, extensions commonly implement a single *PIDL manager* to handle all these tasks.</span></span>

<span data-ttu-id="159f1-218">Der Begriff PIDL ist für eine [**itemittellist**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) -Struktur oder einen Zeiger auf eine solche Struktur, abhängig vom Kontext, kurz.</span><span class="sxs-lookup"><span data-stu-id="159f1-218">The term PIDL is short for an [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure or a pointer to such a structure, depending on context.</span></span> <span data-ttu-id="159f1-219">Wie deklariert, verfügt eine **itemidlist** -Struktur über einen einzelnen Member, eine [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="159f1-219">As declared, an **ITEMIDLIST** structure has a single member, an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="159f1-220">Die **itemidlist** -Struktur eines Objekts ist tatsächlich ein gepacktes Array aus zwei oder mehr **shitemid** -Strukturen.</span><span class="sxs-lookup"><span data-stu-id="159f1-220">An object's **ITEMIDLIST** structure is actually a packed array of two or more **SHITEMID** structures.</span></span> <span data-ttu-id="159f1-221">Die Reihenfolge dieser Strukturen definiert einen Pfad über den Namespace, ähnlich wie c: \\ mydirectory \\ MyFile einen Pfad durch das Dateisystem definiert.</span><span class="sxs-lookup"><span data-stu-id="159f1-221">The order of these structures defines a path through the namespace, in much the same way that c:\\MyDirectory\\MyFile defines a path through the file system.</span></span> <span data-ttu-id="159f1-222">In der Regel besteht die PIDL eines Objekts aus einer Reihe von **shitemid** -Strukturen, die den Ordnern entsprechen, die den Namespace Pfad definieren, gefolgt von der **shitemid** -Struktur des Objekts, gefolgt von einem Abschluss Zeichen.</span><span class="sxs-lookup"><span data-stu-id="159f1-222">Typically, an object's PIDL will consist of a series of **SHITEMID** structures that correspond to the folders that define the namespace path, followed by the object's **SHITEMID** structure, followed by a terminator.</span></span>

<span data-ttu-id="159f1-223">Das Abschluss Zeichen ist eine [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur, bei der der *CB* -Member auf **null** festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-223">The terminator is an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, with the *cb* member set to **NULL**.</span></span> <span data-ttu-id="159f1-224">Das Abschluss Zeichen ist erforderlich, da die Anzahl der **shitemid** -Strukturen in der PIDL eines Objekts von der Position des Objekts im Shellnamespace und vom Startpunkt des Pfads abhängt.</span><span class="sxs-lookup"><span data-stu-id="159f1-224">The terminator is necessary because the number of **SHITEMID** structures in an object's PIDL depends on the location of the object in the Shell namespace, and the starting point of the path.</span></span> <span data-ttu-id="159f1-225">Außerdem kann die Größe der verschiedenen **shitemid** -Strukturen variieren.</span><span class="sxs-lookup"><span data-stu-id="159f1-225">In addition, the size of the various **SHITEMID** structures can vary.</span></span> <span data-ttu-id="159f1-226">Wenn Sie eine PIDL erhalten, haben Sie keine einfache Möglichkeit, ihre Größe oder sogar die Gesamtzahl der **shitemid** -Strukturen zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="159f1-226">When you receive a PIDL, you have no simple way of determining its size or even the total number of **SHITEMID** structures.</span></span> <span data-ttu-id="159f1-227">Stattdessen müssen Sie das gepackte Array (Struktur nach Struktur) "durchlaufen", bis Sie das Abschluss Zeichen erreichen.</span><span class="sxs-lookup"><span data-stu-id="159f1-227">Instead, you must "walk" the packed array, structure by structure, until you reach the terminator.</span></span>

<span data-ttu-id="159f1-228">Zum Erstellen einer PIDL muss Ihre Anwendung folgende Aktionen ausführen:</span><span class="sxs-lookup"><span data-stu-id="159f1-228">To create a PIDL, your application needs to:</span></span>

1.  <span data-ttu-id="159f1-229">Erstellen Sie für jedes seiner Objekte eine [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="159f1-229">Create an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure for each of its objects.</span></span>
2.  <span data-ttu-id="159f1-230">Assemblieren Sie die relevanten [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Strukturen in eine PIDL.</span><span class="sxs-lookup"><span data-stu-id="159f1-230">Assemble the relevant [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures into a PIDL.</span></span>

### <a name="creating-an-shitemid-structure"></a><span data-ttu-id="159f1-231">Erstellen einer shitemid-Struktur</span><span class="sxs-lookup"><span data-stu-id="159f1-231">Creating an SHITEMID Structure</span></span>

<span data-ttu-id="159f1-232">Die [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur eines Objekts identifiziert das Objekt in seinem Ordner eindeutig.</span><span class="sxs-lookup"><span data-stu-id="159f1-232">An object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure uniquely identifies the object within its folder.</span></span> <span data-ttu-id="159f1-233">Tatsächlich besteht ein PIDL-Typ, der von vielen der [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Methoden verwendet wird, nur aus der **shitemid** -Struktur des Objekts, gefolgt von einem Abschluss Zeichen.</span><span class="sxs-lookup"><span data-stu-id="159f1-233">In fact, a type of PIDL used by many of the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods consists of just the object's **SHITEMID** structure, followed by a terminator.</span></span> <span data-ttu-id="159f1-234">Die Definition einer **shitemid** -Struktur lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="159f1-234">The definition of an **SHITEMID** structure is:</span></span>


```C++
typedef struct _SHITEMID { 
    USHORT cb; 
    BYTE   abID[1]; 
} SHITEMID, * LPSHITEMID;
```



<span data-ttu-id="159f1-235">Der *Abid* -Member ist der Bezeichner des Objekts.</span><span class="sxs-lookup"><span data-stu-id="159f1-235">The *abID* member is the object's identifier.</span></span> <span data-ttu-id="159f1-236">Da die Länge von *Abid* nicht definiert ist und variieren kann, wird das *CB* -Element auf die Größe der [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur in Bytes festgelegt.</span><span class="sxs-lookup"><span data-stu-id="159f1-236">Because the length of *abID* is not defined and can vary, the *cb* member is set to the size of the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, in bytes.</span></span>

<span data-ttu-id="159f1-237">Da weder die Länge noch der Inhalt von *Abid* standardisiert ist, können Sie ein beliebiges Schema verwenden, das Sie Ihren Objekten *Abid* -Werte zuweisen möchten.</span><span class="sxs-lookup"><span data-stu-id="159f1-237">Because neither the length nor the content of *abID* is standardized, you can use any scheme you want to assign *abID* values to your objects.</span></span> <span data-ttu-id="159f1-238">Die einzige Anforderung besteht darin, dass Sie nicht zwei Objekte im gleichen Ordner mit identischen Werten haben können.</span><span class="sxs-lookup"><span data-stu-id="159f1-238">The only requirement is that you cannot have two objects in the same folder with identical values.</span></span> <span data-ttu-id="159f1-239">Aus Leistungsgründen sollte die [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur jedoch **DWORD**-bündig sein.</span><span class="sxs-lookup"><span data-stu-id="159f1-239">However, for performance reasons, your [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure should be **DWORD**-aligned.</span></span> <span data-ttu-id="159f1-240">Mit anderen Worten, Sie sollten Ihre *Abid* -Werte so erstellen, dass *CB* ein ganzzahliges Vielfaches von 4 ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-240">In other words, you should construct your *abID* values such that *cb* is an integral multiple of 4.</span></span>

<span data-ttu-id="159f1-241">In der Regel verweist *Abid* auf eine Erweiterungs definierte Struktur.</span><span class="sxs-lookup"><span data-stu-id="159f1-241">Typically, *abID* points to an extension-defined structure.</span></span> <span data-ttu-id="159f1-242">Zusätzlich zur Objekt-ID wird diese Struktur häufig verwendet, um eine Vielzahl von verknüpften Informationen, wie z. b. den Typ oder die Attribute des Objekts, zu speichern.</span><span class="sxs-lookup"><span data-stu-id="159f1-242">In addition to the object's ID, this structure is often used to hold a variety of related information, such as the object's type or attributes.</span></span> <span data-ttu-id="159f1-243">Die Ordner Objekte Ihrer Erweiterung können dann schnell die Informationen aus der PIDL extrahieren, anstatt Sie Abfragen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="159f1-243">Your extension's folder objects can then quickly extract the information from the PIDL instead of having to query for it.</span></span>

> [!Note]  
> <span data-ttu-id="159f1-244">Einer der wichtigsten Aspekte beim Entwerfen einer Datenstruktur für eine PIDL ist, dass die Struktur dauerhaft und transportierbar ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-244">One of the most important aspects of designing a data structure for a PIDL is to make the structure persistable and transportable.</span></span> <span data-ttu-id="159f1-245">Im Kontext von pidls lautet die Bedeutung dieser Begriffe:</span><span class="sxs-lookup"><span data-stu-id="159f1-245">In the context of PIDLs, the meaning of these terms is:</span></span>
>
> -   <span data-ttu-id="159f1-246">Permanenten.</span><span class="sxs-lookup"><span data-stu-id="159f1-246">Persistable.</span></span> <span data-ttu-id="159f1-247">Das System platziert häufig pidls in verschiedenen Typen von langfristiger Speicherung, wie z. b. Verknüpfungs Dateien.</span><span class="sxs-lookup"><span data-stu-id="159f1-247">The system frequently places PIDLs in various types of long-term storage, such as shortcut files.</span></span> <span data-ttu-id="159f1-248">Anschließend können diese pidls später aus dem Speicher wieder hergestellt werden, möglicherweise nachdem das System neu gestartet wurde.</span><span class="sxs-lookup"><span data-stu-id="159f1-248">It can then recover these PIDLs from storage later, possibly after the system has been rebooted.</span></span> <span data-ttu-id="159f1-249">Eine PIDL, die aus dem Speicher wieder hergestellt wurde, muss weiterhin gültig und für Ihre Erweiterung aussagekräftig sein.</span><span class="sxs-lookup"><span data-stu-id="159f1-249">A PIDL that has been recovered from storage must still be valid and meaningful to your extension.</span></span> <span data-ttu-id="159f1-250">Diese Anforderung bedeutet beispielsweise, dass Sie keine Zeiger oder Handles in der PIDL-Struktur verwenden sollten.</span><span class="sxs-lookup"><span data-stu-id="159f1-250">This requirement means, for instance, that you should not use pointers or handles in your PIDL structure.</span></span> <span data-ttu-id="159f1-251">Pidls, die diesen Datentyp enthalten, sind normalerweise bedeutungslos, wenn Sie vom System später aus dem Speicher wieder hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-251">PIDLs containing this type of data will normally be meaningless when the system later recovers them from storage.</span></span>
> -   <span data-ttu-id="159f1-252">Austauschen.</span><span class="sxs-lookup"><span data-stu-id="159f1-252">Transportable.</span></span> <span data-ttu-id="159f1-253">Eine PIDL muss beim Transport von einem Computer zu einem anderen sinnvoll bleiben.</span><span class="sxs-lookup"><span data-stu-id="159f1-253">A PIDL must remain meaningful when transported from one computer to another.</span></span> <span data-ttu-id="159f1-254">Beispielsweise kann eine PIDL in eine Verknüpfungs Datei geschrieben, auf eine Diskette kopiert und auf einen anderen Computer übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-254">For example, a PIDL can be written to a shortcut file, copied to a floppy disk, and transported to another computer.</span></span> <span data-ttu-id="159f1-255">Diese PIDL sollte weiterhin für Ihre Erweiterung sinnvoll sein, die auf dem zweiten Computer ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="159f1-255">That PIDL should still be meaningful to your extension running on the second computer.</span></span> <span data-ttu-id="159f1-256">Um beispielsweise sicherzustellen, dass Ihre pidls transportierbar sind, verwenden Sie entweder ANSI-oder Unicode-Zeichen explizit.</span><span class="sxs-lookup"><span data-stu-id="159f1-256">For instance, to ensure that your PIDLs are transportable, use either ANSI or Unicode characters explicitly.</span></span> <span data-ttu-id="159f1-257">Vermeiden Sie Datentypen wie **TCHAR** oder **LPTSTR**.</span><span class="sxs-lookup"><span data-stu-id="159f1-257">Avoid data types such as **TCHAR** or **LPTSTR**.</span></span> <span data-ttu-id="159f1-258">Wenn Sie diese Datentypen verwenden, kann eine auf einem Computer mit einer Unicode-Version der Erweiterung erstellte PIDL nicht durch eine ANSI-Version dieser Erweiterung gelesen werden, die auf einem anderen Computer ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="159f1-258">If you use those data types, a PIDL created on a computer running a Unicode version of your extension will not be readable by an ANSI version of that extension running on a different computer.</span></span>

 

<span data-ttu-id="159f1-259">Die folgende Deklaration zeigt ein einfaches Beispiel für eine Datenstruktur.</span><span class="sxs-lookup"><span data-stu-id="159f1-259">The following declaration shows a simple example of a data structure.</span></span>


```C++
typedef struct tagMYPIDLDATA {
  USHORT cb;
  DWORD dwType;
  WCHAR wszDisplayName[40];
} MYPIDLDATA, *LPMYPIDLDATA;
```



<span data-ttu-id="159f1-260">Das **CB** -Element wird auf die Größe der **mypidldata** -Struktur festgelegt.</span><span class="sxs-lookup"><span data-stu-id="159f1-260">The **cb** member is set to the size of the **MYPIDLDATA** structure.</span></span> <span data-ttu-id="159f1-261">Dieser Member macht **mypidldata** zu einer gültigen [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur in und von sich selbst.</span><span class="sxs-lookup"><span data-stu-id="159f1-261">This member makes **MYPIDLDATA** a valid [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, in and of itself.</span></span> <span data-ttu-id="159f1-262">Die restlichen Member entsprechen dem **Abid** -Element einer **shitemid** -Struktur und enthalten private Daten.</span><span class="sxs-lookup"><span data-stu-id="159f1-262">The rest of the members are equivalent to the **abID** member of an **SHITEMID** structure and hold private data.</span></span> <span data-ttu-id="159f1-263">Der **dwType** -Member ist ein Erweiterungs definierter Wert, der den Objekttyp angibt.</span><span class="sxs-lookup"><span data-stu-id="159f1-263">The **dwType** member is an extension-defined value that indicates the type of object.</span></span> <span data-ttu-id="159f1-264">In diesem Beispiel wird **dwType** für Ordner auf **true** und andernfalls **false** festgelegt.</span><span class="sxs-lookup"><span data-stu-id="159f1-264">For this example, **dwType** is set to **TRUE** for folders and **FALSE** otherwise.</span></span> <span data-ttu-id="159f1-265">Mit diesem Member können Sie beispielsweise schnell feststellen, ob es sich bei dem Objekt um einen Ordner handelt.</span><span class="sxs-lookup"><span data-stu-id="159f1-265">This member allows you, for instance, to quickly determine whether the object is a folder or not.</span></span> <span data-ttu-id="159f1-266">Der **wszdisplayname** -Member enthält den anzeigen amen des Objekts.</span><span class="sxs-lookup"><span data-stu-id="159f1-266">The **wszDisplayName** member contains the object's display name.</span></span> <span data-ttu-id="159f1-267">Da Sie nicht denselben anzeigen Amen zwei verschiedenen Objekten im selben Ordner zuweisen würden, fungiert der Anzeige Name auch als Objekt-ID.</span><span class="sxs-lookup"><span data-stu-id="159f1-267">Since you would not assign the same display name to two different objects in the same folder, the display name also serves as the object ID.</span></span> <span data-ttu-id="159f1-268">In diesem Beispiel ist **wszdisplayname** auf 40 Zeichen festgelegt, um sicherzustellen, dass die **shitemid** -Struktur **DWORD**-ausgerichtet wird.</span><span class="sxs-lookup"><span data-stu-id="159f1-268">In this example, **wszDisplayName** is set to 40 characters to guarantee that the **SHITEMID** structure will be **DWORD**-aligned.</span></span> <span data-ttu-id="159f1-269">Wenn Sie die Größe Ihrer pidls begrenzen möchten, können Sie stattdessen ein Zeichen Array variabler Länge verwenden und den Wert von CB entsprechend anpassen.</span><span class="sxs-lookup"><span data-stu-id="159f1-269">To limit the size of your PIDLs, you can instead use a variable-length character array and adjust the value of cb accordingly.</span></span> <span data-ttu-id="159f1-270">Füllt die Anzeige \\ Zeichenfolge mit ausreichenden ' 0 '-Zeichen auf, um die **DWORD** -Ausrichtung der Struktur beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="159f1-270">Pad the display string with enough '\\0' characters to maintain the structure's **DWORD** alignment.</span></span> <span data-ttu-id="159f1-271">Andere Member, die nützlich sein können, um in die Struktur einzufügen, beinhalten die Größe, Attribute oder den Namen des Objekts.</span><span class="sxs-lookup"><span data-stu-id="159f1-271">Other members that might be useful to put in the structure include the object's size, attributes, or parsing name.</span></span>

### <a name="constructing-a-pidl"></a><span data-ttu-id="159f1-272">Erstellen einer PIDL</span><span class="sxs-lookup"><span data-stu-id="159f1-272">Constructing a PIDL</span></span>

<span data-ttu-id="159f1-273">Nachdem Sie [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Strukturen für Ihre Objekte definiert haben, können Sie diese verwenden, um eine PIDL zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-273">Once you have defined [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures for your objects, you can then use them to construct a PIDL.</span></span> <span data-ttu-id="159f1-274">Pidls können für eine Vielzahl von Zwecken erstellt werden, aber die meisten Aufgaben verwenden einen von zwei Arten von PIDL.</span><span class="sxs-lookup"><span data-stu-id="159f1-274">PIDLs can be constructed for a variety of purposes, but most tasks use one of two types of PIDL.</span></span> <span data-ttu-id="159f1-275">Die einfachste, eine PIDL auf einzelner Ebene, identifiziert das Objekt relativ zum übergeordneten Ordner.</span><span class="sxs-lookup"><span data-stu-id="159f1-275">The simplest, a single-level PIDL, identifies the object relative to its parent folder.</span></span> <span data-ttu-id="159f1-276">Diese Art von PIDL wird von vielen der [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Methoden verwendet.</span><span class="sxs-lookup"><span data-stu-id="159f1-276">This type of PIDL is used by many of the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods.</span></span> <span data-ttu-id="159f1-277">Eine PIDL einer einzelnen Ebene enthält die **shitemid** -Struktur des Objekts, gefolgt von einem Abschluss Zeichen.</span><span class="sxs-lookup"><span data-stu-id="159f1-277">A single-level PIDL contains the object's **SHITEMID** structure, followed by a terminator.</span></span> <span data-ttu-id="159f1-278">Eine voll qualifizierte PIDL definiert einen Pfad der Namespace Hierarchie vom Desktop zum Objekt.</span><span class="sxs-lookup"><span data-stu-id="159f1-278">A fully qualified PIDL defines a path through the namespace hierarchy from the desktop to the object.</span></span> <span data-ttu-id="159f1-279">Diese Art von PIDL beginnt beim Desktop und enthält eine **shitemid** -Struktur für jeden Ordner im Pfad, gefolgt vom-Objekt und dem-Abschluss Zeichen.</span><span class="sxs-lookup"><span data-stu-id="159f1-279">This type of PIDL starts at the desktop and contains one **SHITEMID** structure for each folder in the path, followed by the object and the terminator.</span></span> <span data-ttu-id="159f1-280">Eine voll qualifizierte PIDL identifiziert das Objekt innerhalb des gesamten shellnamespaces eindeutig.</span><span class="sxs-lookup"><span data-stu-id="159f1-280">A fully qualified PIDL uniquely identifies the object within the entire Shell namespace.</span></span>

<span data-ttu-id="159f1-281">Die einfachste Möglichkeit zum Erstellen einer PIDL besteht darin, direkt mit der [**itemittel List**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) -Struktur zu arbeiten.</span><span class="sxs-lookup"><span data-stu-id="159f1-281">The simplest way to construct a PIDL is to work directly with the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure itself.</span></span> <span data-ttu-id="159f1-282">Erstellen Sie eine **itemidlist** -Struktur, und weisen Sie ausreichend Arbeitsspeicher zu, um alle [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Strukturen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="159f1-282">Create an **ITEMIDLIST** structure, but allocate enough memory to hold all the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures.</span></span> <span data-ttu-id="159f1-283">Die Adresse dieser Struktur verweist auf die anfängliche **shitemid** -Struktur.</span><span class="sxs-lookup"><span data-stu-id="159f1-283">The address of this structure will point to the initial **SHITEMID** structure.</span></span> <span data-ttu-id="159f1-284">Definieren Sie Werte für die Elemente dieser anfangs Struktur, und fügen Sie dann beliebig viele zusätzliche **shitemid** -Strukturen in der entsprechenden Reihenfolge an.</span><span class="sxs-lookup"><span data-stu-id="159f1-284">Define values for the members of this initial structure, and then append as many additional **SHITEMID** structures as you need, in the appropriate order.</span></span> <span data-ttu-id="159f1-285">Im folgenden Verfahren wird das Erstellen einer PIDL auf einer einzelnen Ebene beschrieben.</span><span class="sxs-lookup"><span data-stu-id="159f1-285">The following procedure outlines how to create a single-level PIDL.</span></span> <span data-ttu-id="159f1-286">Sie enthält zwei **shitemid** -Strukturen – eine **mypidldata** -Struktur gefolgt von einem Abschluss Zeichen:</span><span class="sxs-lookup"><span data-stu-id="159f1-286">It contains two **SHITEMID** structures—a **MYPIDLDATA** structure followed by a terminator:</span></span>

1.  <span data-ttu-id="159f1-287">Verwenden Sie die [**CoTaskMemAlloc**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc) -Funktion, um Arbeitsspeicher für die PIDL zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="159f1-287">Use the [**CoTaskMemAlloc**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc) function to allocate memory for the PIDL.</span></span> <span data-ttu-id="159f1-288">Weisen Sie ausreichend Arbeitsspeicher für Ihre privaten Daten sowie einen **UShort** (zwei Bytes) für das Abschluss Zeichen zu.</span><span class="sxs-lookup"><span data-stu-id="159f1-288">Allocate enough memory for your private data plus a **USHORT** (two bytes) for the terminator.</span></span> <span data-ttu-id="159f1-289">Wandeln Sie das Ergebnis in lpmypidldata um.</span><span class="sxs-lookup"><span data-stu-id="159f1-289">Cast the result to LPMYPIDLDATA.</span></span>
2.  <span data-ttu-id="159f1-290">Legen Sie den CB-Member der ersten **mypidldata** -Struktur auf die Größe der Struktur fest.</span><span class="sxs-lookup"><span data-stu-id="159f1-290">Set the cb member of the first **MYPIDLDATA** structure to the size of that structure.</span></span> <span data-ttu-id="159f1-291">In diesem Beispiel würden Sie **CB** auf sizeof (mypidldata) festlegen.</span><span class="sxs-lookup"><span data-stu-id="159f1-291">For this example, you would set **cb** to sizeof(MYPIDLDATA).</span></span> <span data-ttu-id="159f1-292">Wenn Sie eine Struktur mit variabler Länge verwenden möchten, müssen Sie den Wert von **CB** berechnen.</span><span class="sxs-lookup"><span data-stu-id="159f1-292">If you want to use a variable-length structure, you will have to calculate the value of **cb**.</span></span>
3.  <span data-ttu-id="159f1-293">Weisen Sie den privaten Datenmembern geeignete Werte zu.</span><span class="sxs-lookup"><span data-stu-id="159f1-293">Assign appropriate values to the private data members.</span></span>
4.  <span data-ttu-id="159f1-294">Berechnen Sie die Adresse der nächsten [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="159f1-294">Calculate the address of the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="159f1-295">Wandeln Sie die Adresse der aktuellen mypidldata-Struktur in LPBYTE um, und fügen Sie diesen Wert dem Wert von **CB** hinzu, der in Schritt 3 festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="159f1-295">Cast the address of the current MYPIDLDATA structure to LPBYTE, and add that value to the value of **cb** determined in step 3.</span></span>
5.  <span data-ttu-id="159f1-296">In diesem Fall ist die nächste [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur das Abschluss Zeichen.</span><span class="sxs-lookup"><span data-stu-id="159f1-296">In this case, the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure is the terminator.</span></span> <span data-ttu-id="159f1-297">Legen Sie den **CB** -Member der-Struktur auf NULL fest.</span><span class="sxs-lookup"><span data-stu-id="159f1-297">Set the structure's **cb** member to zero.</span></span>

<span data-ttu-id="159f1-298">Für längere pidls weisen Sie ausreichenden Arbeitsspeicher zu, und wiederholen Sie die Schritte 3-5 für jede weitere [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="159f1-298">For longer PIDLs, allocate sufficient memory and repeat steps 3-5 for each additional [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span>

<span data-ttu-id="159f1-299">Die folgende Beispiel Funktion nimmt den Typ und den anzeigen Amen eines Objekts an und gibt die PIDL der einzelnen Ebene des-Objekts zurück.</span><span class="sxs-lookup"><span data-stu-id="159f1-299">The following sample function takes an object's type and display name and returns the object's single-level PIDL.</span></span> <span data-ttu-id="159f1-300">Die-Funktion geht davon aus, dass der Anzeige Name, einschließlich des abschließenden **null** -Zeichens, nicht die Anzahl von Zeichen überschreitet, die für die **mypidldata** -Struktur deklariert wurden.</span><span class="sxs-lookup"><span data-stu-id="159f1-300">The function assumes that the display name, including its terminating **null** character, does not exceed the number of characters declared for the **MYPIDLDATA** structure.</span></span> <span data-ttu-id="159f1-301">Wenn sich diese Annahme als fehlerhaft herausstellt, schneidet die [**stringcbcopyw**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) -Funktion den anzeigen Amen ab.</span><span class="sxs-lookup"><span data-stu-id="159f1-301">If that assumption turns out to be erroneous, the [**StringCbCopyW**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) function will truncate the display name.</span></span> <span data-ttu-id="159f1-302">Die Variable " **g \_ pmalloc** " ist ein [**imzuordnungszeiger**](/windows/win32/api/objidlbase/nn-objidlbase-imalloc) , der an anderer Stelle erstellt und in einer globalen Variablen gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="159f1-302">The **g\_pMalloc** variable is an [**IMalloc**](/windows/win32/api/objidlbase/nn-objidlbase-imalloc) pointer created elsewhere and stored in a global variable.</span></span>


```C++
LPITEMIDLIST CreatePIDL(DWORD dwType, LPCWSTR pwszDisplayName)
{
    LPMYPIDLDATA   pidlOut;
    USHORT         uSize;

    pidlOut = NULL;

    //Calculate the size of the MYPIDLDATA structure.
    uSize = sizeof(MYPIDLDATA);

    // Allocate enough memory for the PIDL to hold a MYPIDLDATA structure 
    // plus the terminator
    pidlOut = (LPMYPIDLDATA)m_pMalloc->Alloc(uSize + sizeof(USHORT));

    if(pidlOut)
    {
       //Assign values to the members of the MYPIDLDATA structure
       //that is the PIDL's first SHITEMID structure
       pidlOut->cb = uSize;
       pidlOut->dwType = dwType;
       hr = StringCbCopyW(pidlOut->wszDisplayName, 
                          sizeof(pidlOut->wszDisplayName), pwszDisplayName);
       
       // TODO: Add error handling here to verify the HRESULT returned 
       // by StringCbCopyW.

       //Advance the pointer to the start of the next SHITEMID structure.
       pidlOut = (LPMYPIDLDATA)((LPBYTE)pidlOut + pidlOut->cb);

       //Create the terminating null character by setting cb to 0.
       pidlOut->cb = 0;
    }

    return pidlOut;
```



<span data-ttu-id="159f1-303">Eine voll qualifizierte PIDL muss über [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Strukturen für jedes Objekt vom Desktop zum Objekt verfügen.</span><span class="sxs-lookup"><span data-stu-id="159f1-303">A fully qualified PIDL must have [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures for every object from the desktop to your object.</span></span> <span data-ttu-id="159f1-304">Die Erweiterung erhält eine voll qualifizierte PIDL für Ihren Stamm Ordner, wenn die Shell [**ipersistfolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize)aufruft.</span><span class="sxs-lookup"><span data-stu-id="159f1-304">Your extension receives a fully qualified PIDL for your root folder when the Shell calls [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize).</span></span> <span data-ttu-id="159f1-305">Um eine voll qualifizierte PIDL für ein Objekt zu erstellen, nehmen Sie die PIDL, die die Shell dem Stamm Ordner zugewiesen hat, an, und fügen Sie die **shitemid** -Strukturen an, die erforderlich sind, um Sie aus dem Stamm Ordner zum Objekt zu gelangen.</span><span class="sxs-lookup"><span data-stu-id="159f1-305">To construct a fully qualified PIDL for an object, take the PIDL that the Shell has assigned to your root folder, and append the **SHITEMID** structures that are needed to take you from the root folder to the object.</span></span>

### <a name="interpreting-pidls"></a><span data-ttu-id="159f1-306">Interpretieren von pidls</span><span class="sxs-lookup"><span data-stu-id="159f1-306">Interpreting PIDLs</span></span>

<span data-ttu-id="159f1-307">Wenn die Shell oder eine Anwendung eine der Schnittstellen der Erweiterung aufruft, um Informationen zu einem Objekt anzufordern, wird das Objekt in der Regel durch eine PIDL identifiziert.</span><span class="sxs-lookup"><span data-stu-id="159f1-307">When the Shell or an application calls one of your extension's interfaces to request information about an object, it will usually identify the object by a PIDL.</span></span> <span data-ttu-id="159f1-308">Einige Methoden, z. b. [**IShellFolder:: getuiobjectof**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof), verwenden pidls, die relativ zum übergeordneten Ordner sind und leicht interpretiert werden können.</span><span class="sxs-lookup"><span data-stu-id="159f1-308">Some methods, such as [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof), use PIDLs that are relative to the parent folder and are straightforward to interpret.</span></span> <span data-ttu-id="159f1-309">Allerdings erhält Ihre Erweiterung wahrscheinlich auch voll qualifizierte pidls.</span><span class="sxs-lookup"><span data-stu-id="159f1-309">However, your extension will probably also receive fully qualified PIDLs.</span></span> <span data-ttu-id="159f1-310">Der PIDL-Manager muss dann bestimmen, auf welche Objekte die PIDL verweist.</span><span class="sxs-lookup"><span data-stu-id="159f1-310">Your PIDL manager must then determine which of your objects that PIDL is referring to.</span></span>

<span data-ttu-id="159f1-311">Was die Aufgabe der Zuordnung eines Objekts zu einer voll qualifizierten PIDL erschwert, besteht darin, dass eine oder mehrere der anfänglichen [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Strukturen in der PIDL zu Objekten gehören können, die sich außerhalb ihrer Erweiterung im Shell-Namespace befinden.</span><span class="sxs-lookup"><span data-stu-id="159f1-311">What complicates the task of associating an object with a fully qualified PIDL is that one or more of the initial [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures in the PIDL might belong to objects that lie outside your extension in the Shell namespace.</span></span> <span data-ttu-id="159f1-312">Sie haben keine Möglichkeit, die Bedeutung des *Abid* -Members dieser Strukturen zu interpretieren.</span><span class="sxs-lookup"><span data-stu-id="159f1-312">You have no way of interpreting the meaning of the *abID* member of those structures.</span></span> <span data-ttu-id="159f1-313">Die Erweiterung muss die Liste der **shitemid** -Strukturen "durchlaufen", bis Sie die Struktur erreichen, die dem Stamm Ordner entspricht.</span><span class="sxs-lookup"><span data-stu-id="159f1-313">What your extension must do is to "walk" the list of **SHITEMID** structures, until you reach the structure that corresponds to your root folder.</span></span> <span data-ttu-id="159f1-314">Danach wissen Sie, wie die Informationen in den **shitemid** -Strukturen interpretiert werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-314">From then on, you will know how to interpret the information in the **SHITEMID** structures.</span></span>

<span data-ttu-id="159f1-315">Nehmen Sie zum Durchlaufen der PIDL den ersten *CB* -Wert an, und fügen Sie ihn der Adresse der PIDL hinzu, um den Zeiger auf den Anfang der nächsten [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur zu setzen.</span><span class="sxs-lookup"><span data-stu-id="159f1-315">To walk the PIDL, take the first *cb* value and add it to the address of the PIDL to advance the pointer to the start of the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="159f1-316">Er zeigt dann auf das *CB* -Element dieser Struktur, das Sie verwenden können, um den Zeiger auf den Anfang der nächsten **shitemid** -Struktur zu verschieben, usw.</span><span class="sxs-lookup"><span data-stu-id="159f1-316">It then will be pointing to that structure's *cb* member, which you can use to advance the pointer to the start of the next **SHITEMID** structure, and so on.</span></span> <span data-ttu-id="159f1-317">Überprüfen Sie jedes Mal, wenn Sie den Zeiger verschieben, die **shitemid** -Struktur, um zu bestimmen, ob Sie den Stamm des Namespace ihrer Erweiterung erreicht haben.</span><span class="sxs-lookup"><span data-stu-id="159f1-317">Each time you advance the pointer, examine the **SHITEMID** structure to determine whether you have reached the root of your extension's namespace.</span></span>

## <a name="implementing-the-primary-interfaces"></a><span data-ttu-id="159f1-318">Implementieren der primären Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="159f1-318">Implementing the Primary Interfaces</span></span>

<span data-ttu-id="159f1-319">Wie bei allen COM-Objekten ist das Implementieren einer Erweiterung größtenteils eine Frage der Implementierung einer Auflistung von Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-319">As with all COM objects, implementing an extension is largely a matter of implementing a collection of interfaces.</span></span> <span data-ttu-id="159f1-320">In diesem Abschnitt werden die drei primären Schnittstellen erläutert, die von allen Erweiterungen implementiert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="159f1-320">This section discusses the three primary interfaces that must be implemented by all extensions.</span></span> <span data-ttu-id="159f1-321">Sie werden für die Initialisierung und zum Bereitstellen von grundlegenden Informationen zum Inhalt der Erweiterung in Windows-Explorer verwendet.</span><span class="sxs-lookup"><span data-stu-id="159f1-321">They are used for initialization and to provide Windows Explorer with basic information about the contents of the extension.</span></span> <span data-ttu-id="159f1-322">Diese Schnittstellen und eine [Ordneransicht](../lwef/nse-folderview.md)sind alles, was für eine funktionale Erweiterung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-322">These interfaces, plus a [folder view](../lwef/nse-folderview.md), are all that is required for a functional extension.</span></span> <span data-ttu-id="159f1-323">Um jedoch die Features von Windows Explorer voll ausnutzen zu können, implementieren die meisten Erweiterungen auch eine oder mehrere optionale Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-323">However, to fully exploit the features of Windows Explorer, most extensions also implement one or more of the optional interfaces.</span></span>

### <a name="ipersistfolder-interface"></a><span data-ttu-id="159f1-324">Ipersistfolder-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="159f1-324">IPersistFolder Interface</span></span>

<span data-ttu-id="159f1-325">Die [**ipersistfolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) -Schnittstelle wird aufgerufen, um ein neues Ordner Objekt zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="159f1-325">The [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) interface is called to initialize a new folder object.</span></span> <span data-ttu-id="159f1-326">Die [**ipersistfolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) -Methode weist dem neuen-Objekt eine voll qualifizierte PIDL zu.</span><span class="sxs-lookup"><span data-stu-id="159f1-326">The [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) method assigns a fully qualified PIDL to the new object.</span></span> <span data-ttu-id="159f1-327">Diese PIDL für die spätere Verwendung speichern.</span><span class="sxs-lookup"><span data-stu-id="159f1-327">Store this PIDL for later use.</span></span> <span data-ttu-id="159f1-328">Beispielsweise muss ein Ordner Objekt diese PIDL verwenden, um voll qualifizierte pidls für die untergeordneten Elemente des Objekts zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-328">For instance, a folder object must use this PIDL to construct fully qualified PIDLs for the object's children.</span></span> <span data-ttu-id="159f1-329">Der Ersteller des Ordner Objekts kann auch [**ipersistent:: GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) aufrufen, um die CLSID des Objekts anzufordern.</span><span class="sxs-lookup"><span data-stu-id="159f1-329">The folder object's creator can also call [**IPersist::GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) to request the object's CLSID.</span></span>

<span data-ttu-id="159f1-330">In der Regel wird ein Ordner Objekt von der [**IShellFolder:: BindTo Object**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) -Methode des übergeordneten Ordners erstellt und initialisiert.</span><span class="sxs-lookup"><span data-stu-id="159f1-330">Typically, a folder object is created and initialized by its parent folder's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="159f1-331">Wenn ein Benutzer jedoch die Erweiterung durchsucht, erstellt und initialisiert Windows-Explorer das Stamm Ordner Objekt der Erweiterung.</span><span class="sxs-lookup"><span data-stu-id="159f1-331">However, when a user browses into your extension, Windows Explorer creates and initializes the extension's root folder object.</span></span> <span data-ttu-id="159f1-332">Die PIDL, die das Stamm Ordner Objekt über [**ipersistfolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) empfängt, enthält den Pfad vom Desktop zum Stamm Ordner, den Sie benötigen, um voll qualifizierte pidls für Ihre Erweiterung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-332">The PIDL that the root folder object receives through [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) contains the path from the desktop to the root folder that you will need to construct fully qualified PIDLs for your extension.</span></span>

### <a name="ishellfolder-interface"></a><span data-ttu-id="159f1-333">IShellFolder-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="159f1-333">IShellFolder Interface</span></span>

<span data-ttu-id="159f1-334">Die Shell behandelt eine Erweiterung als hierarchisch sortiertes Auflistung von Ordner Objekten.</span><span class="sxs-lookup"><span data-stu-id="159f1-334">The Shell treats an extension as a hierarchically ordered collection of folder objects.</span></span> <span data-ttu-id="159f1-335">Die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle ist das Kernstück jeder Erweiterungs Implementierung.</span><span class="sxs-lookup"><span data-stu-id="159f1-335">The [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface is the core of any extension implementation.</span></span> <span data-ttu-id="159f1-336">Es stellt ein Ordner Objekt dar und bietet Windows-Explorer einen Großteil der Informationen, die erforderlich sind, um den Inhalt des Ordners anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="159f1-336">It represents a folder object and provides Windows Explorer with much of the information needed to display the contents of the folder.</span></span>

<span data-ttu-id="159f1-337">" [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) " ist in der Regel die einzige andere Ordner Schnittstelle als " [**ipersistfolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) ", die direkt von einem Ordner Objekt verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="159f1-337">[**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) is typically the only folder interface other than [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) that is directly exposed by a folder object.</span></span> <span data-ttu-id="159f1-338">Während Windows-Explorer eine Vielzahl von erforderlichen und optionalen Schnittstellen verwendet, um Informationen über den Inhalt des Ordners abzurufen, erhält er mithilfe von **IShellFolder** Zeiger auf diese Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-338">While Windows Explorer uses a variety of required and optional interfaces to obtain information about the contents of the folder, it obtains pointers to those interfaces through **IShellFolder**.</span></span>

<span data-ttu-id="159f1-339">Windows-Explorer Ruft die CLSID des Stamm Ordners ihrer Erweiterung auf verschiedene Weise ab.</span><span class="sxs-lookup"><span data-stu-id="159f1-339">Windows Explorer obtains the CLSID of your extension's root folder in a variety of ways.</span></span> <span data-ttu-id="159f1-340">Weitere Informationen finden Sie unter Angeben des Speicher [Orts einer Namespace Erweiterung](nse-junction.md) oder [Anzeigen einer Self-Contained Sicht einer Namespace Erweiterung](nse-view.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-340">For details, see [Specifying a Namespace Extension's Location](nse-junction.md) or [Displaying a Self-Contained View of a Namespace Extension](nse-view.md).</span></span> <span data-ttu-id="159f1-341">Windows-Explorer verwendet diese CLSID dann, um eine Instanz des Stamm Ordners zu erstellen und zu initialisieren und eine [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle abzufragen.</span><span class="sxs-lookup"><span data-stu-id="159f1-341">Windows Explorer then uses that CLSID to create and initialize an instance of the root folder and query for an [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="159f1-342">Die Erweiterung erstellt ein Ordner Objekt, das den Stamm Ordner darstellt, und gibt die **IShellFolder** -Schnittstelle des Objekts zurück.</span><span class="sxs-lookup"><span data-stu-id="159f1-342">Your extension creates a folder object to represent the root folder and returns the object's **IShellFolder** interface.</span></span> <span data-ttu-id="159f1-343">Ein Großteil der übrigen Interaktionen zwischen ihrer Erweiterung und Windows Explorer erfolgt über **IShellFolder**.</span><span class="sxs-lookup"><span data-stu-id="159f1-343">Much of the remainder of the interaction between your extension and Windows Explorer then takes place through **IShellFolder**.</span></span> <span data-ttu-id="159f1-344">Der Windows-Explorer ruft **IShellFolder** auf:</span><span class="sxs-lookup"><span data-stu-id="159f1-344">Windows Explorer calls **IShellFolder** to:</span></span>

-   <span data-ttu-id="159f1-345">Fordern Sie ein Objekt an, das den Inhalt des Stamm Ordners aufzählen kann.</span><span class="sxs-lookup"><span data-stu-id="159f1-345">Request an object that can enumerate the contents of the root folder.</span></span>
-   <span data-ttu-id="159f1-346">Abrufen verschiedener Arten von Informationen über den Inhalt des Stamm Ordners.</span><span class="sxs-lookup"><span data-stu-id="159f1-346">Obtain various types of information about the contents of the root folder.</span></span>
-   <span data-ttu-id="159f1-347">Fordern Sie ein Objekt an, das eine der optionalen Schnittstellen verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="159f1-347">Request an object that exposes one of the optional interfaces.</span></span> <span data-ttu-id="159f1-348">Diese Schnittstellen können dann nach zusätzlichen Informationen, z. b. Symbolen oder Kontextmenüs, abgefragt werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-348">Those interfaces can then be queried for additional information, such as icons or shortcut menus.</span></span>
-   <span data-ttu-id="159f1-349">Fordern Sie ein Ordner Objekt an, das einen Unterordner des Stamm Ordners darstellt.</span><span class="sxs-lookup"><span data-stu-id="159f1-349">Request a folder object that represents a subfolder of the root folder.</span></span>

<span data-ttu-id="159f1-350">Wenn ein Benutzer einen Unterordner des Stamm Ordners öffnet, ruft Windows Explorer [**IShellFolder:: bindtoken Object**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject)auf.</span><span class="sxs-lookup"><span data-stu-id="159f1-350">When a user opens a subfolder of the root folder, Windows Explorer calls [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject).</span></span> <span data-ttu-id="159f1-351">Die Erweiterung erstellt und initialisiert ein neues Ordner Objekt, um den Unterordner darzustellen, und gibt die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="159f1-351">Your extension creates and initializes a new folder object to represent the subfolder and returns its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="159f1-352">Windows-Explorer ruft diese Schnittstelle dann für verschiedene Arten von Informationen auf, usw., bis der Benutzer beschließt, an einer anderen Stelle im Shell-Namespace zu navigieren oder Windows-Explorer zu schließen.</span><span class="sxs-lookup"><span data-stu-id="159f1-352">Windows Explorer then calls this interface for various types of information, and so on until the user decides to navigate elsewhere in the Shell namespace or close Windows Explorer.</span></span>

<span data-ttu-id="159f1-353">Im restlichen Teil dieses Abschnitts werden die wichtigeren [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Methoden und deren Implementierung kurz erläutert.</span><span class="sxs-lookup"><span data-stu-id="159f1-353">The remainder of this section briefly discusses the more important [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods and how to implement them.</span></span>

### <a name="enumobjects"></a><span data-ttu-id="159f1-354">EnumObjects</span><span class="sxs-lookup"><span data-stu-id="159f1-354">EnumObjects</span></span>

<span data-ttu-id="159f1-355">Vor dem Anzeigen des Inhalts eines Ordners in der Strukturansicht muss Windows-Explorer zunächst ermitteln, was der Ordner enthält, indem er die [**IShellFolder:: erumubjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="159f1-355">Before displaying the contents of a folder in the tree view, Windows Explorer must first determine what the folder contains by calling the [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method.</span></span> <span data-ttu-id="159f1-356">Diese Methode erstellt ein Standardmäßiges OLE-Enumerationsobjekt, das eine [**ienumittellist**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) -Schnittstelle verfügbar macht und den Schnittstellen Zeiger zurückgibt</span><span class="sxs-lookup"><span data-stu-id="159f1-356">This method creates a standard OLE enumeration object that exposes an [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface and returns that interface pointer.</span></span> <span data-ttu-id="159f1-357">Die **ienumittellist** -Schnittstelle ermöglicht Windows-Explorer das Abrufen der pidls aller Objekte, die im Ordner enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="159f1-357">The **IEnumIDList** interface allows Windows Explorer to obtain the PIDLs of all the objects contained by the folder.</span></span> <span data-ttu-id="159f1-358">Diese pidls werden dann verwendet, um Informationen über die Objekte zu erhalten, die im Ordner enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="159f1-358">These PIDLs are then used to obtain information about the objects contained by the folder.</span></span> <span data-ttu-id="159f1-359">Weitere Informationen finden Sie unter [ienumittellist-Schnittstelle](#ienumidlist-interface).</span><span class="sxs-lookup"><span data-stu-id="159f1-359">For further details, see [IEnumIDList Interface](#ienumidlist-interface).</span></span>

> [!Note]  
> <span data-ttu-id="159f1-360">Die [**ienumittellist:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) -Methode sollte nur pidls zurückgeben, die relativ zum übergeordneten Ordner sind.</span><span class="sxs-lookup"><span data-stu-id="159f1-360">The [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) method should only return PIDLs that are relative to the parent folder.</span></span> <span data-ttu-id="159f1-361">Die PIDL sollte nur die [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur des Objekts, gefolgt von einem Abschluss Zeichen, enthalten.</span><span class="sxs-lookup"><span data-stu-id="159f1-361">The PIDL should contain only the object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, followed by a terminator.</span></span>

 

### <a name="createviewobject"></a><span data-ttu-id="159f1-362">"Ansichts Objekt"</span><span class="sxs-lookup"><span data-stu-id="159f1-362">CreateViewObject</span></span>

<span data-ttu-id="159f1-363">Bevor der Inhalt eines Ordners angezeigt wird, ruft Windows-Explorer diese Methode auf, um einen Zeiger auf eine [**ishellview**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) -Schnittstelle anzufordern.</span><span class="sxs-lookup"><span data-stu-id="159f1-363">Before the contents of a folder are displayed, Windows Explorer calls this method to request a pointer to an [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="159f1-364">Diese Schnittstelle wird von Windows-Explorer zum Verwalten der Ordneransicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="159f1-364">This interface is used by Windows Explorer to manage the folder view.</span></span> <span data-ttu-id="159f1-365">Erstellen Sie ein Ordner Ansichts Objekt, und geben Sie dessen **ishellview** -Schnittstelle zurück</span><span class="sxs-lookup"><span data-stu-id="159f1-365">Create a folder view object and return its **IShellView** interface.</span></span>

<span data-ttu-id="159f1-366">Die [**IShellFolder:: deateviewobject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) -Methode wird auch aufgerufen, um eine der optionalen Schnittstellen (z. b. [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu)) für den Ordner selbst anzufordern.</span><span class="sxs-lookup"><span data-stu-id="159f1-366">The [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) method is also called to request one of the optional interfaces, such as [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), for the folder itself.</span></span> <span data-ttu-id="159f1-367">Die Implementierung dieser Methode sollte ein Objekt erstellen, das die angeforderte Schnittstelle verfügbar macht und den Schnittstellen Zeiger zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="159f1-367">Your implementation of this method should create an object that exposes the requested interface and returns the interface pointer.</span></span> <span data-ttu-id="159f1-368">Wenn Windows-Explorer eine optionale Schnittstelle für eines der im Ordner enthaltenen Objekte benötigt, wird [**IShellFolder:: getuiobjectof**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof)aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="159f1-368">If Windows Explorer needs an optional interface for one of the objects contained by the folder, it will call [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof).</span></span>

### <a name="getuiobjectof"></a><span data-ttu-id="159f1-369">Getuiobjectof</span><span class="sxs-lookup"><span data-stu-id="159f1-369">GetUIObjectOf</span></span>

<span data-ttu-id="159f1-370">Obwohl grundlegende Informationen über den Inhalt eines Ordners über die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Methoden verfügbar sind, kann Ihre Erweiterung Windows-Explorer auch verschiedene Arten zusätzlicher Informationen bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-370">While basic information about the contents of a folder is available through the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods, your extension can also provide Windows Explorer with various kinds of additional information.</span></span> <span data-ttu-id="159f1-371">Beispielsweise können Sie Symbole für den Inhalt eines Ordners oder das Kontextmenü eines Objekts angeben.</span><span class="sxs-lookup"><span data-stu-id="159f1-371">For instance, you can specify icons for the contents of a folder or an object's shortcut menu.</span></span> <span data-ttu-id="159f1-372">Windows-Explorer Ruft die [**IShellFolder:: getuiobjectof**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) -Methode auf, um zu versuchen, zusätzliche Informationen über ein Objekt abzurufen, das in einem Ordner enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-372">Windows Explorer calls the [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) method to attempt to retrieve additional information about an object that is contained by a folder.</span></span> <span data-ttu-id="159f1-373">Windows-Explorer gibt an, für welches Objekt die Informationen und die IID der entsprechenden Schnittstelle benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-373">Windows Explorer specifies which object it wants the information for, and the IID of the relevant interface.</span></span> <span data-ttu-id="159f1-374">Das Folder-Objekt erstellt dann ein-Objekt, das die angeforderte Schnittstelle verfügbar macht und den Schnittstellen Zeiger zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="159f1-374">The folder object then creates an object that exposes the requested interface and returns the interface pointer.</span></span>

<span data-ttu-id="159f1-375">Wenn die Erweiterung Benutzern das Übertragen von Objekten mit Drag & Drop oder der Zwischenablage ermöglicht, ruft Windows-Explorer [**IShellFolder:: getuiobjectof**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) auf, um eine [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -oder [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) -Schnittstelle anzufordern.</span><span class="sxs-lookup"><span data-stu-id="159f1-375">If your extension allows users to transfer objects with drag-and-drop or the clipboard, Windows Explorer will call [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) to request an [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) or [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="159f1-376">Weitere Informationen finden Sie unter [übertragen von shellobjekten mit Drag & Drop und der Zwischenablage](dragdrop.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-376">For details, see [Transferring Shell Objects with Drag-and-Drop and the Clipboard](dragdrop.md).</span></span>

<span data-ttu-id="159f1-377">Windows-Explorer ruft [**IShellFolder:: deateviewobject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) auf, wenn die gleiche Art von Informationen zum Ordner selbst benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="159f1-377">Windows Explorer calls [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) when it wants the same sort of information about the folder itself.</span></span>

### <a name="bindtoobject"></a><span data-ttu-id="159f1-378">Bindjeobject</span><span class="sxs-lookup"><span data-stu-id="159f1-378">BindToObject</span></span>

<span data-ttu-id="159f1-379">Windows-Explorer Ruft die [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) -Methode auf, wenn ein Benutzer versucht, einen der Unterordner ihrer Erweiterung zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="159f1-379">Windows Explorer calls the [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method when a user attempts to open one of your extension's subfolders.</span></span> <span data-ttu-id="159f1-380">Wenn *riid* auf IID \_ IShellFolder festgelegt ist, sollten Sie ein Ordner Objekt, das den Unterordner darstellt, erstellen und initialisieren und die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle des Objekts zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="159f1-380">If *riid* is set to IID\_IShellFolder, you should create and initialize a folder object that represents the subfolder and return the object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

> [!Note]  
> <span data-ttu-id="159f1-381">Zurzeit ruft Windows-Explorer diese Methode nur auf, um eine [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle anzufordern.</span><span class="sxs-lookup"><span data-stu-id="159f1-381">At present, Windows Explorer calls this method only to request an [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="159f1-382">Gehen Sie jedoch nicht davon aus, dass dies immer der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-382">However, do not assume that this will always be the case.</span></span> <span data-ttu-id="159f1-383">Sie sollten den Wert von *riid* immer überprüfen, bevor Sie fortfahren.</span><span class="sxs-lookup"><span data-stu-id="159f1-383">You should always check the value of *riid* before proceeding.</span></span>

 

### <a name="getdisplaynameof"></a><span data-ttu-id="159f1-384">GetDisplayNameOf</span><span class="sxs-lookup"><span data-stu-id="159f1-384">GetDisplayNameOf</span></span>

<span data-ttu-id="159f1-385">Windows-Explorer Ruft die [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) -Methode auf, um die PIDL von einem der Objekte des Ordners in einen Namen zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="159f1-385">Windows Explorer calls the [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method to convert the PIDL of one of the folder's objects into a name.</span></span> <span data-ttu-id="159f1-386">Diese PIDL muss relativ zum übergeordneten Ordner des Objekts sein.</span><span class="sxs-lookup"><span data-stu-id="159f1-386">That PIDL must be relative to the object's parent folder.</span></span> <span data-ttu-id="159f1-387">Das heißt, es muss eine einzelne [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur aufweisen, die nicht **null** ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-387">In other words, it must contain a single non-**NULL** [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="159f1-388">Da es mehr als eine Möglichkeit gibt, Objekte zu benennen, gibt Windows-Explorer den Typ des Namens an, indem ein oder mehrere [**shgdnf**](/windows/win32/api/shobjidl_core/ne-shobjidl_core-_shgdnf) -Flags im *uFlags* -Parameter festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-388">Because there is more than one possible way to name objects, Windows Explorer specifies the type of name by setting one or more [**SHGDNF**](/windows/win32/api/shobjidl_core/ne-shobjidl_core-_shgdnf) flags in the *uFlags* parameter.</span></span> <span data-ttu-id="159f1-389">Einer von zwei Werten, **shgdn \_ Normal** oder **shgdn \_ InFolder**, wird festgelegt, um anzugeben, ob der Name relativ zum Ordner oder relativ zum Desktop sein soll.</span><span class="sxs-lookup"><span data-stu-id="159f1-389">One of two values, **SHGDN\_NORMAL** or **SHGDN\_INFOLDER**, will be set to specify whether the name should be relative to the folder or relative to the desktop.</span></span> <span data-ttu-id="159f1-390">Einer der anderen drei Werte: **shgdn \_ forediting**, **shgdn \_ foraddressbar** oder **shgdn \_ fortiersing** kann festgelegt werden, um anzugeben, wofür der Name verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="159f1-390">One of the other three values, **SHGDN\_FOREDITING**, **SHGDN\_FORADDRESSBAR**, or **SHGDN\_FORPARSING**, can be set to specify what the name will be used for.</span></span>

<span data-ttu-id="159f1-391">Sie müssen den Namen in Form einer Struktur vom Typ " [**Strauch**](/windows/desktop/api/Shtypes/ns-shtypes-strret) " zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="159f1-391">You must return the name in the form of an [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure.</span></span> <span data-ttu-id="159f1-392">Wenn die **shgdn- \_ Bearbeitung**, die **shgdn- \_ foraddressbar** und die **shgdn- \_ forenverarbeitung** nicht festgelegt sind, geben Sie den anzeigen amen des Objekts zurück.</span><span class="sxs-lookup"><span data-stu-id="159f1-392">If **SHGDN\_FOREDITING**, **SHGDN\_FORADDRESSBAR**, and **SHGDN\_FORPARSING** are not set, return the object's display name.</span></span> <span data-ttu-id="159f1-393">Wenn das Flag " **shgdn \_ forparamesing** " festgelegt ist, fordert Windows-Explorer einen Namen für die Unterzeichnung an.</span><span class="sxs-lookup"><span data-stu-id="159f1-393">If the **SHGDN\_FORPARSING** flag is set, Windows Explorer is requesting a parsing name.</span></span> <span data-ttu-id="159f1-394">Analyse Namen werden an [**IShellFolder übergeben::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) , um die PIDL eines Objekts abzurufen, auch wenn Sie sich möglicherweise mindestens eine Ebene unterhalb des aktuellen Ordners in der Namespace Hierarchie befindet.</span><span class="sxs-lookup"><span data-stu-id="159f1-394">Parsing names are passed to [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) to obtain an object's PIDL, even though it might be located one or more levels below the current folder in the namespace hierarchy.</span></span> <span data-ttu-id="159f1-395">Der namens Name eines Dateisystem Objekts ist beispielsweise der Pfad.</span><span class="sxs-lookup"><span data-stu-id="159f1-395">For example, the parsing name of a file system object is its path.</span></span> <span data-ttu-id="159f1-396">Sie können den voll qualifizierten Pfad eines beliebigen Objekts im Dateisystem an die **IShellFolder::P arsedisplayname** -Methode des Desktops übergeben, und die voll qualifizierte PIDL des Objekts wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="159f1-396">You can pass the fully qualified path of any object in the file system to the desktop's **IShellFolder::ParseDisplayName** method, and it will return the object's fully qualified PIDL.</span></span>

<span data-ttu-id="159f1-397">Obwohl es sich bei den namens Namen um Text Zeichenfolgen handelt, müssen Sie den anzeigen Amen nicht unbedingt einschließen.</span><span class="sxs-lookup"><span data-stu-id="159f1-397">While parsing names are text strings, they do not necessarily have to include the display name.</span></span> <span data-ttu-id="159f1-398">Sie sollten Analyse Namen basierend auf dem, was effizient funktioniert, wenn [**IShellFolder::P armendisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) aufgerufen wird, zuweisen.</span><span class="sxs-lookup"><span data-stu-id="159f1-398">You should assign parsing names based on what will work most efficiently when [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) is called.</span></span> <span data-ttu-id="159f1-399">Beispielsweise sind viele virtuelle Ordner der Shell nicht Teil des Dateisystems und verfügen nicht über einen voll qualifizierten Pfad.</span><span class="sxs-lookup"><span data-stu-id="159f1-399">For instance, many of the Shell's virtual folders are not part of the file system and do not have a fully qualified path.</span></span> <span data-ttu-id="159f1-400">Stattdessen wird jedem Ordner eine GUID zugewiesen, und der namens Name hat folgendes Format:: {GUID}.</span><span class="sxs-lookup"><span data-stu-id="159f1-400">Instead, each folder is assigned a GUID and the parsing name takes the form ::{GUID}.</span></span> <span data-ttu-id="159f1-401">Unabhängig davon, welches Schema Sie verwenden, sollte es in der Lage sein, eine zuverlässige "Roundtrip" zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="159f1-401">Regardless of what scheme you use, it should be able to reliably "round trip."</span></span> <span data-ttu-id="159f1-402">Wenn ein Aufrufer beispielsweise einen Analyse Namen an **IShellFolder::P arsedisplayname** übergibt, um die PIDL eines Objekts abzurufen, und diese PIDL an [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) übergibt, wobei das Flag für die **shgdn \_** -Enumeration festgelegt ist, sollte der Aufrufer den ursprünglichen Analyse Namen wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="159f1-402">For instance, if a caller passes a parsing name to **IShellFolder::ParseDisplayName** to retrieve an object's PIDL, and then passes that PIDL to [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) with the **SHGDN\_FORPARSING** flag set, the caller should recover the original parsing name.</span></span>

### <a name="getattributesof"></a><span data-ttu-id="159f1-403">Getattributesof</span><span class="sxs-lookup"><span data-stu-id="159f1-403">GetAttributesOf</span></span>

<span data-ttu-id="159f1-404">Windows-Explorer Ruft die [**IShellFolder:: getattributesof**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) -Methode auf, um die Attribute von einem oder mehreren Elementen zu bestimmen, die in einem Ordner Objekt enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="159f1-404">Windows Explorer calls the [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) method to determine the attributes of one or more items contained by a folder object.</span></span> <span data-ttu-id="159f1-405">Der Wert von *cidl* gibt die Anzahl der Elemente in der Abfrage an, und *apidl* verweist auf eine Liste Ihrer pidls.</span><span class="sxs-lookup"><span data-stu-id="159f1-405">The value of *cidl* gives the number of items in the query, and *aPidl* points to a list of their PIDLs.</span></span>

<span data-ttu-id="159f1-406">Da das Testen einiger Attribute zeitaufwändig sein kann, schränkt Windows-Explorer die Abfrage in der Regel auf eine Teilmenge der verfügbaren Flags ein, indem ihre Werte in *rfginout* festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-406">Because testing for some attributes can be time consuming, Windows Explorer typically restricts the query to a subset of the available flags by setting their values in *rfgInOut*.</span></span> <span data-ttu-id="159f1-407">Ihre Methode sollte nur auf die Attribute testen, deren Flags in *rfginout* festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="159f1-407">Your method should test for only those attributes whose flags are set in *rfgInOut*.</span></span> <span data-ttu-id="159f1-408">Lassen Sie die gültigen Flags festgelegt, und löschen Sie den Rest.</span><span class="sxs-lookup"><span data-stu-id="159f1-408">Leave the valid flags set and clear the remainder.</span></span> <span data-ttu-id="159f1-409">Wenn mehr als ein Element in der Abfrage enthalten ist, legen Sie nur die Flags fest, die für alle Elemente gelten.</span><span class="sxs-lookup"><span data-stu-id="159f1-409">If more than one item is included in the query, set only those flags that apply to all items.</span></span>

> [!Note]  
> <span data-ttu-id="159f1-410">Die Attribute müssen ordnungsgemäß festgelegt werden, damit ein Element ordnungsgemäß angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="159f1-410">The attributes must be properly set for an item to be correctly displayed.</span></span> <span data-ttu-id="159f1-411">Wenn es sich bei einem Element beispielsweise um einen Ordner mit Unterordnern handelt, müssen Sie das **sfgao \_ hassubfolder** -Flag festlegen.</span><span class="sxs-lookup"><span data-stu-id="159f1-411">For instance, if an item is a folder that contains subfolders, you must set the **SFGAO\_HASSUBFOLDER** flag.</span></span> <span data-ttu-id="159f1-412">Andernfalls zeigt Windows-Explorer in der Strukturansicht nicht neben dem Symbol des Elements ein Pluszeichen an.</span><span class="sxs-lookup"><span data-stu-id="159f1-412">Otherwise, Windows Explorer will not display a + next to the item's icon in the tree view.</span></span>

 

### <a name="parsedisplayname"></a><span data-ttu-id="159f1-413">Name des Parametern</span><span class="sxs-lookup"><span data-stu-id="159f1-413">ParseDisplayName</span></span>

<span data-ttu-id="159f1-414">Die [**IShellFolder::P arcdisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) -Methode ist in gewisser Hinsicht ein Spiegelbild von [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span><span class="sxs-lookup"><span data-stu-id="159f1-414">The [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method is in some sense a mirror image of [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span></span> <span data-ttu-id="159f1-415">Diese Methode wird am häufigsten verwendet, um den Namen des-Objekts in die zugeordnete PIDL zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="159f1-415">The most common use of this method is to convert an object's parsing name into the associated PIDL.</span></span> <span data-ttu-id="159f1-416">Der namens Name kann auf jedes Objekt verweisen, das sich unterhalb des Ordners in der Namespace Hierarchie befindet.</span><span class="sxs-lookup"><span data-stu-id="159f1-416">The parsing name can refer to any object that lies below the folder in the namespace hierarchy.</span></span> <span data-ttu-id="159f1-417">Die zurückgegebene PIDL ist relativ zum Ordner Objekt, das die Methode verfügbar macht und in der Regel nicht voll qualifiziert ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-417">The returned PIDL is relative to the folder object that exposes the method and is usually not fully qualified.</span></span> <span data-ttu-id="159f1-418">Mit anderen Worten: Obwohl die PIDL mehrere [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Strukturen enthalten kann, ist der erste Wert der des Objekts selbst oder der erste Unterordner im Pfad vom Ordner zum Objekt.</span><span class="sxs-lookup"><span data-stu-id="159f1-418">In other words, although the PIDL can contain several [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures, the first will either be that of the object itself or the first subfolder in the path from the folder to the object.</span></span> <span data-ttu-id="159f1-419">Der Aufrufer muss diese PIDL an die voll qualifizierte PIDL des Ordners anfügen, um eine voll qualifizierte PIDL für das Objekt zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="159f1-419">The caller will have to append this PIDL to the folder's fully qualified PIDL to obtain a fully qualified PIDL for the object.</span></span>

<span data-ttu-id="159f1-420">[**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) kann auch aufgerufen werden, um die Attribute eines Objekts anzufordern.</span><span class="sxs-lookup"><span data-stu-id="159f1-420">[**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) can also be called to request an object's attributes.</span></span> <span data-ttu-id="159f1-421">Da das Ermitteln aller anwendbaren Attribute zeitaufwändig sein kann, legt der Aufrufer nur die [**sfgao \_ xxx**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) -Flags fest, die Informationen darstellen, an denen der Aufrufer interessiert ist.</span><span class="sxs-lookup"><span data-stu-id="159f1-421">Because determining all the applicable attributes can be time consuming, the caller will set only those [**SFGAO\_XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) flags that represent information that the caller is interested in.</span></span> <span data-ttu-id="159f1-422">Sie sollten bestimmen, welche dieser Attribute für das Objekt zutreffen, und die verbleibenden Flags löschen.</span><span class="sxs-lookup"><span data-stu-id="159f1-422">You should determine which of those attributes are true for the object, and clear the remaining flags.</span></span>

### <a name="ienumidlist-interface"></a><span data-ttu-id="159f1-423">Ienumittellist-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="159f1-423">IEnumIDList Interface</span></span>

<span data-ttu-id="159f1-424">Wenn Windows Explorer die Objekte auflisten muss, die in einem Ordner enthalten sind, ruft er [**IShellFolder:: enumerationsobjekte**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects)auf.</span><span class="sxs-lookup"><span data-stu-id="159f1-424">When Windows Explorer needs to enumerate the objects that are contained by a folder, it calls [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects).</span></span> <span data-ttu-id="159f1-425">Das Folder-Objekt muss ein Enumerationsobjekt erstellen, das die [**ienumittellist**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) -Schnittstelle verfügbar macht und diesen Schnittstellen Zeiger zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="159f1-425">The folder object must create an enumeration object that exposes the [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface and return that interface pointer.</span></span> <span data-ttu-id="159f1-426">Der Windows-Explorer verwendet in der Regel **ienumittellist** , um die pidls aller im Ordner enthaltenen Objekte aufzulisten.</span><span class="sxs-lookup"><span data-stu-id="159f1-426">Windows Explorer will then typically use **IEnumIDList** to enumerate the PIDLs of all the objects contained by the folder.</span></span>

<span data-ttu-id="159f1-427">[**Ienumittellist**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) ist eine standardmäßige OLE-Enumerationsschnittstelle und wird auf die übliche Weise implementiert.</span><span class="sxs-lookup"><span data-stu-id="159f1-427">[**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) is a standard OLE enumeration interface and is implemented in the usual way.</span></span> <span data-ttu-id="159f1-428">Beachten Sie jedoch, dass die von Ihnen zurückgegebenen pidls relativ zum Ordner sein müssen und nur die [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Struktur des Objekts und ein Abschluss Zeichen enthalten müssen.</span><span class="sxs-lookup"><span data-stu-id="159f1-428">Remember, however, that the PIDLs that you return must be relative to the folder and contain only the object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure and a terminator.</span></span>

## <a name="implementing-the-optional-interfaces"></a><span data-ttu-id="159f1-429">Implementieren der optionalen Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="159f1-429">Implementing the Optional Interfaces</span></span>

<span data-ttu-id="159f1-430">Es gibt eine Reihe optionaler Shellschnittstellen, die von den Ordner Objekten der Erweiterung unterstützt werden können.</span><span class="sxs-lookup"><span data-stu-id="159f1-430">There are a number of optional Shell interfaces that your extension's folder objects can support.</span></span> <span data-ttu-id="159f1-431">Viele von Ihnen, wie z. b. [**iextracticon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona), ermöglichen es Ihnen, verschiedene Aspekte der Art und Weise anzupassen, in der der Benutzer die Erweiterung anzeigt.</span><span class="sxs-lookup"><span data-stu-id="159f1-431">Many of them, such as [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona), allow you to customize various aspects of the way the user views your extension.</span></span> <span data-ttu-id="159f1-432">Andere, wie z. b. [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), ermöglichen es ihrer Erweiterung, Features wie Drag & Drop zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="159f1-432">Others, such as [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), allow your extension to support features such as drag-and-drop.</span></span>

<span data-ttu-id="159f1-433">Keine der optionalen Schnittstellen wird direkt von einem Ordner Objekt verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="159f1-433">None of the optional interfaces are exposed directly by a folder object.</span></span> <span data-ttu-id="159f1-434">Stattdessen ruft Windows Explorer eine von zwei [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Methoden auf, um eine Schnittstelle anzufordern:</span><span class="sxs-lookup"><span data-stu-id="159f1-434">Instead, Windows Explorer calls one of two [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods to request an interface:</span></span>

-   <span data-ttu-id="159f1-435">Windows-Explorer Ruft den [**IShellFolder:: getuiobjectof**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) eines Ordner Objekts auf, um eine Schnittstelle für eines der im Ordner enthaltenen Objekte anzufordern.</span><span class="sxs-lookup"><span data-stu-id="159f1-435">Windows Explorer calls a folder object's [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) to request an interface for one of the objects contained by the folder.</span></span>
-   <span data-ttu-id="159f1-436">Windows-Explorer Ruft das [**IShellFolder::**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) -Objekt eines Ordner Objekts auf, um eine Schnittstelle für den Ordner selbst anzufordern.</span><span class="sxs-lookup"><span data-stu-id="159f1-436">Windows Explorer calls a folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) to request an interface for the folder itself.</span></span>

<span data-ttu-id="159f1-437">Um die Informationen bereitzustellen, erstellt das Ordner Objekt ein Objekt, das die angeforderte Schnittstelle verfügbar macht und den Schnittstellen Zeiger zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="159f1-437">To provide the information, the folder object creates an object that exposes the requested interface and returns the interface pointer.</span></span> <span data-ttu-id="159f1-438">Windows-Explorer ruft dann diese Schnittstelle auf, um die erforderlichen Informationen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="159f1-438">Windows Explorer then calls that interface to retrieve the needed information.</span></span> <span data-ttu-id="159f1-439">In diesem Abschnitt werden die am häufigsten verwendeten optionalen Schnittstellen erläutert.</span><span class="sxs-lookup"><span data-stu-id="159f1-439">This section discusses the most commonly used optional interfaces.</span></span>

### <a name="iextracticon"></a><span data-ttu-id="159f1-440">Iextracticon</span><span class="sxs-lookup"><span data-stu-id="159f1-440">IExtractIcon</span></span>

<span data-ttu-id="159f1-441">Windows-Explorer fordert eine [**iextracticon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) -Schnittstelle an, bevor der Inhalt eines Ordners angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="159f1-441">Windows Explorer requests an [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) interface before it displays the contents of a folder.</span></span> <span data-ttu-id="159f1-442">Die-Schnittstelle ermöglicht der Erweiterung die Angabe benutzerdefinierter Symbole für die Objekte, die im Ordner enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="159f1-442">The interface allows your extension to specify custom icons for the objects that are contained by the folder.</span></span> <span data-ttu-id="159f1-443">Andernfalls werden die standardmäßigen Datei-und Ordner Symbole verwendet.</span><span class="sxs-lookup"><span data-stu-id="159f1-443">Otherwise, the standard file and folder icons will be used.</span></span> <span data-ttu-id="159f1-444">Um ein benutzerdefiniertes Symbol bereitzustellen, erstellen Sie ein Symbol Extraktions Objekt, das **iextracticon** verfügbar macht und einen Zeiger auf diese Schnittstelle zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="159f1-444">To provide a custom icon, create an icon extraction object that exposes **IExtractIcon** and return a pointer to that interface.</span></span> <span data-ttu-id="159f1-445">Weitere Informationen finden Sie in der Referenz Dokumentation zu **iextracticon** oder [Erstellen von Symbol Handlern](./how-to-create-icon-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-445">For further discussion, see the **IExtractIcon** reference documentation or [Creating Icon Handlers](./how-to-create-icon-handlers.md).</span></span>

### <a name="icontextmenu"></a><span data-ttu-id="159f1-446">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="159f1-446">IContextMenu</span></span>

<span data-ttu-id="159f1-447">Wenn ein Benutzer mit der rechten Maustaste auf ein Objekt klickt, fordert Windows Explorer eine [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) -Schnittstelle an.</span><span class="sxs-lookup"><span data-stu-id="159f1-447">When a user right-clicks an object, Windows Explorer requests an [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) interface.</span></span> <span data-ttu-id="159f1-448">Um Kontextmenüs für die Objekte bereitzustellen, erstellen Sie ein menühandlerobjekt, und geben Sie seine **IContextMenu** -Schnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="159f1-448">To provide shortcut menus for your objects, create a menu handler object and return its **IContextMenu** interface.</span></span>

<span data-ttu-id="159f1-449">Die Prozeduren zum Erstellen eines menühandlerobjekts ähneln denen, die zum Erstellen einer menühandlershellerweiterung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="159f1-449">The procedures for creating a menu handler object are very similar to those used to create a menu handler Shell extension.</span></span> <span data-ttu-id="159f1-450">Weitere Informationen finden Sie unter [Erstellen von Kontextmenü Handlern](context-menu-handlers.md) oder der [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu)-, [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2)-oder [**IContextMenu3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3) -Referenz.</span><span class="sxs-lookup"><span data-stu-id="159f1-450">For details, see [Creating Context Menu Handlers](context-menu-handlers.md) or the [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2), or [**IContextMenu3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3) reference.</span></span>

### <a name="iqueryinfo"></a><span data-ttu-id="159f1-451">Iqueryinfo</span><span class="sxs-lookup"><span data-stu-id="159f1-451">IQueryInfo</span></span>

<span data-ttu-id="159f1-452">Windows Explorer Ruft die [**iqueryinfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) -Schnittstelle auf, um eine Infotipp-Text Zeichenfolge abzurufen.</span><span class="sxs-lookup"><span data-stu-id="159f1-452">Windows Explorer calls the [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) interface to retrieve an infotip text string.</span></span>

### <a name="idataobject-and-idroptarget"></a><span data-ttu-id="159f1-453">IDataObject und IDropTarget</span><span class="sxs-lookup"><span data-stu-id="159f1-453">IDataObject and IDropTarget</span></span>

<span data-ttu-id="159f1-454">Wenn Ihre Objekte von Windows Explorer angezeigt werden, kann ein Ordner Objekt nicht direkt erkennen, wenn ein Benutzer versucht, ein Objekt auszuschneiden, zu kopieren oder zu ziehen.</span><span class="sxs-lookup"><span data-stu-id="159f1-454">When your objects are displayed by Windows Explorer, a folder object has no direct way to know when a user is attempting to cut, copy, or drag an object.</span></span> <span data-ttu-id="159f1-455">Stattdessen fordert Windows Explorer eine [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Schnittstelle an.</span><span class="sxs-lookup"><span data-stu-id="159f1-455">Instead, Windows Explorer requests an [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="159f1-456">Um zuzulassen, dass das Objekt übertragen werden kann, erstellen Sie ein Datenobjekt und geben einen Zeiger auf seine **IDataObject** -Schnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="159f1-456">To allow the object to be transferred, create a data object and return a pointer to its **IDataObject** interface.</span></span>

<span data-ttu-id="159f1-457">Ebenso kann ein Benutzer versuchen, ein Datenobjekt in einer Windows Explorer-Darstellung eines ihrer Objekte zu löschen, z. b. als Symbol oder Adress leisten Pfad.</span><span class="sxs-lookup"><span data-stu-id="159f1-457">Similarly, a user might attempt to drop a data object on a Windows Explorer representation of one of your objects, such as an icon or address bar path.</span></span> <span data-ttu-id="159f1-458">Windows-Explorer fordert dann eine [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) -Schnittstelle an.</span><span class="sxs-lookup"><span data-stu-id="159f1-458">Windows Explorer then requests an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="159f1-459">Damit das Datenobjekt gelöscht werden kann, erstellen Sie ein Objekt, das eine **IDropTarget** -Schnittstelle verfügbar macht und den Schnittstellen Zeiger zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="159f1-459">To allow the data object to be dropped, create an object that exposes an **IDropTarget** interface and return the interface pointer.</span></span>

<span data-ttu-id="159f1-460">Die Verarbeitung von Datenübertragungen ist einer der schwierigeren Aspekte beim Schreiben von Namespace Erweiterungen.</span><span class="sxs-lookup"><span data-stu-id="159f1-460">Handling data transfer is one of the trickier aspects of writing namespace extensions.</span></span> <span data-ttu-id="159f1-461">Eine ausführliche Erläuterung finden Sie unter [übertragen von shellobjekten mit Drag & Drop und der Zwischenablage](dragdrop.md).</span><span class="sxs-lookup"><span data-stu-id="159f1-461">For a detailed discussion, see [Transferring Shell Objects with Drag-and-Drop and the Clipboard](dragdrop.md).</span></span>

## <a name="working-with-the-default-shell-folder-view-implementation"></a><span data-ttu-id="159f1-462">Arbeiten mit der standardmäßigen Shell-Ordner Ansichts Implementierung</span><span class="sxs-lookup"><span data-stu-id="159f1-462">Working With the Default Shell Folder View Implementation</span></span>

<span data-ttu-id="159f1-463">Datenquellen, die das standardmäßige shellordneransichtsobjekt (defview) verwenden, müssen diese Schnittstellen implementieren:</span><span class="sxs-lookup"><span data-stu-id="159f1-463">Data sources that use the default Shell folder view object (DefView) must implement these interfaces:</span></span>

-   [<span data-ttu-id="159f1-464">**IShellFolder**</span><span class="sxs-lookup"><span data-stu-id="159f1-464">**IShellFolder**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder)
-   [<span data-ttu-id="159f1-465">**IShellFolder2**</span><span class="sxs-lookup"><span data-stu-id="159f1-465">**IShellFolder2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellfolder2)
-   [<span data-ttu-id="159f1-466">**Ipersistfolder**</span><span class="sxs-lookup"><span data-stu-id="159f1-466">**IPersistFolder**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder)
-   [<span data-ttu-id="159f1-467">**IPersistFolder2**</span><span class="sxs-lookup"><span data-stu-id="159f1-467">**IPersistFolder2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)

<span data-ttu-id="159f1-468">Optional können Sie auch [**IPersistFolder3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3)implementieren.</span><span class="sxs-lookup"><span data-stu-id="159f1-468">Optionally, they can also implement [**IPersistFolder3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span></span>

 

 
