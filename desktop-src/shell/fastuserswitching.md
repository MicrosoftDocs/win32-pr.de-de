---
description: Windows XP-Benutzerkonten ermöglichen es, dass mehrere Benutzer gleichzeitig angemeldet sind, jeweils mit ihren eigenen Einstellungen und jeweils mit ihren eigenen Anwendungen.
ms.assetid: bc404afc-f73e-404d-854d-faab5cf205a5
title: Benutzerkonten mit schneller Benutzerumschaltung und Remotedesktop
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fc26471bcf56efce79fb5ccc91a78c24e43ae312
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104994767"
---
# <a name="user-accounts-with-fast-user-switching-and-remote-desktop"></a><span data-ttu-id="8b73b-103">Benutzerkonten mit schneller Benutzerumschaltung und Remotedesktop</span><span class="sxs-lookup"><span data-stu-id="8b73b-103">User Accounts with Fast User Switching and Remote Desktop</span></span>

<span data-ttu-id="8b73b-104">Windows XP-Benutzerkonten ermöglichen es, dass mehrere Benutzer gleichzeitig angemeldet sind, jeweils mit ihren eigenen Einstellungen und jeweils mit ihren eigenen Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-104">Windows XP user accounts enable multiple users to be logged on simultaneously, each with his or her own settings and each running his or her own applications.</span></span> <span data-ttu-id="8b73b-105">Da sich ein Benutzer nicht anmelden muss, um den Zugriff auf einen anderen Benutzer zuzulassen, kann auf den Desktop eines Benutzers problemlos mithilfe der Funktion für schnelles Benutzer wechseln zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="8b73b-105">Because one user does not have to log off to allow access to another user, each user's desktop is easily accessed using the fast user switching feature.</span></span> <span data-ttu-id="8b73b-106">Benutzerkonten enthalten auch die persönliche Terminal Server Funktion oder Remotedesktop, mit der Benutzer über Remote Systeme auf Ihr Desktop Konto zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="8b73b-106">User accounts also include the Personal Terminal Server feature, or Remote Desktop, which enables users to access their desktop account from remote systems.</span></span>

<span data-ttu-id="8b73b-107">Die folgenden Themen werden erörtert.</span><span class="sxs-lookup"><span data-stu-id="8b73b-107">The following topics are discussed.</span></span>

-   [<span data-ttu-id="8b73b-108">Anforderungen an die Infrastruktur Verwendung</span><span class="sxs-lookup"><span data-stu-id="8b73b-108">Infrastructure Usage Requirements</span></span>](#infrastructure-usage-requirements)
-   [<span data-ttu-id="8b73b-109">Kompatibilität mit vorhandenen Anwendungen</span><span class="sxs-lookup"><span data-stu-id="8b73b-109">Compatibility with Existing Applications</span></span>](#compatibility-with-existing-applications)
-   [<span data-ttu-id="8b73b-110">Registrieren für Sitzungs Wechsel Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="8b73b-110">Registering for Session Switching Notification</span></span>](#registering-for-session-switching-notification)
-   [<span data-ttu-id="8b73b-111">Es wird sichergestellt, dass nur eine Instanz der Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8b73b-111">Ensuring Only One Instance of Your Application Is Running</span></span>](#ensuring-only-one-instance-of-your-application-is-running)
-   [<span data-ttu-id="8b73b-112">Herunterfahren der Anwendung über alle Sitzungen hinweg</span><span class="sxs-lookup"><span data-stu-id="8b73b-112">Shutting Down Your Application Across All Sessions</span></span>](#shutting-down-your-application-across-all-sessions)
-   [<span data-ttu-id="8b73b-113">Interaktion mit System Diensten</span><span class="sxs-lookup"><span data-stu-id="8b73b-113">Interaction with System Services</span></span>](#interaction-with-system-services)
-   [<span data-ttu-id="8b73b-114">Remotedesktop und Bandbreite</span><span class="sxs-lookup"><span data-stu-id="8b73b-114">Remote Desktop and Bandwidth</span></span>](#remote-desktop-and-bandwidth)

## <a name="infrastructure-usage-requirements"></a><span data-ttu-id="8b73b-115">Anforderungen an die Infrastruktur Verwendung</span><span class="sxs-lookup"><span data-stu-id="8b73b-115">Infrastructure Usage Requirements</span></span>

<span data-ttu-id="8b73b-116">Die zugrunde liegende Infrastruktur, die von Windows 2000 geerbt wird, unterstützt die Zustands Trennung von Benutzerdaten, Benutzereinstellungen und Computereinstellungen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-116">Underlying infrastructure inherited from Windows 2000 supports state separation of user data, user settings, and computer settings.</span></span> <span data-ttu-id="8b73b-117">Wenn Sie diese Infrastruktur nutzen, sind die folgenden Schritte erforderlich, um Ihre Anwendung unter Windows XP erfolgreich auszuführen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-117">Taking advantage of this infrastructure, the following are required to successfully run your application under Windows XP.</span></span>

-   <span data-ttu-id="8b73b-118">Standardmäßig den Ordner " **eigene** Dateien" für die Speicherung von Benutzer erstellten Daten.</span><span class="sxs-lookup"><span data-stu-id="8b73b-118">Default to the **My Documents** folder for storage of user-created data.</span></span>
-   <span data-ttu-id="8b73b-119">Klassifizieren und Speichern von Anwendungsdaten ordnungsgemäß.</span><span class="sxs-lookup"><span data-stu-id="8b73b-119">Classify and store application data correctly.</span></span>
-   <span data-ttu-id="8b73b-120">"Zugriff verweigert"-Meldungen ordnungsgemäß herabstufen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-120">Degrade gracefully on "Access Denied" messages.</span></span>

<span data-ttu-id="8b73b-121">Temporäre Dateien, im Speicher abgebildete Dateien und Dokumente sollten im entsprechenden Unterverzeichnis des Benutzerprofil Verzeichnisses gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="8b73b-121">Temporary files, memory-mapped files, and documents should all be stored in the appropriate subdirectory of the user's profile directory.</span></span> <span data-ttu-id="8b73b-122">Verwenden Sie " [**shgetfolderlocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) " oder " [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) ", um den entsprechenden Speicherort für diese Dateien zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="8b73b-122">Use [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) or [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) to determine the appropriate storage location for these files.</span></span> <span data-ttu-id="8b73b-123">Wenn Sie das [**CSIDL \_ AppData**](csidl.md) -Flag an diese Funktionen übergeben, wird der Pfad eines Dateisystem Verzeichnisses zurückgegeben, das als gängiges Repository für anwendungsspezifische Daten fungiert.</span><span class="sxs-lookup"><span data-stu-id="8b73b-123">Passing the [**CSIDL\_APPDATA**](csidl.md) flag to these functions returns the path of a file system directory that serves as a common repository for application-specific data.</span></span> <span data-ttu-id="8b73b-124">Verwenden Sie das Flag [**CSIDL \_ local \_ AppData**](csidl.md) anstelle von **CSIDL \_ AppData** für Daten, die sich ändern sollen, wenn sich der Benutzer ändert, z. b. temporäre Dateien.</span><span class="sxs-lookup"><span data-stu-id="8b73b-124">Use the flag [**CSIDL\_LOCAL\_APPDATA**](csidl.md) in place of **CSIDL\_APPDATA** for data that should change when the user changes, such as temporary files.</span></span>

<span data-ttu-id="8b73b-125">Bei den oben aufgeführten Anforderungen handelt es sich um eine Teilmenge der im Microsoft-Zertifizierungsprogramm aufgeführten Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-125">The requirements listed above are a subset of those in the Microsoft Certification program.</span></span> <span data-ttu-id="8b73b-126">Weitere Informationen finden Sie auf der Seite " **Certified for Windows Program** " unter https://www.microsoft.com/windowsserver2003/partners/isvs/cfw.mspx .</span><span class="sxs-lookup"><span data-stu-id="8b73b-126">For more information, see the **Certified for Windows Program** page at https://www.microsoft.com/windowsserver2003/partners/isvs/cfw.mspx.</span></span>

## <a name="compatibility-with-existing-applications"></a><span data-ttu-id="8b73b-127">Kompatibilität mit vorhandenen Anwendungen</span><span class="sxs-lookup"><span data-stu-id="8b73b-127">Compatibility with Existing Applications</span></span>

<span data-ttu-id="8b73b-128">Sowohl der schnelle Benutzerwechsel als auch der persönliche Terminal Server verwenden die Terminaldienstetechnologie und sind daher mit den meisten früheren Microsoft Win32-Anwendungen kompatibel.</span><span class="sxs-lookup"><span data-stu-id="8b73b-128">Both fast user switching and Personal Terminal Server use Terminal Services technology and therefore are compatible with most earlier Microsoft Win32 applications.</span></span> <span data-ttu-id="8b73b-129">Wenn eine Anwendung mit Windows 2000-Logo kompatibel ist und die grundlegenden profile Trennung und Energie Verwaltungsfunktionen implementiert, sollte diese Anwendung ordnungsgemäß unter den einzelnen Windows XP-Benutzerkonten ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="8b73b-129">If an application is Windows 2000 Logo compliant, implementing basic profile separation and power management features, that application should run properly under individual Windows XP user accounts.</span></span>

## <a name="registering-for-session-switching-notification"></a><span data-ttu-id="8b73b-130">Registrieren für Sitzungs Wechsel Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="8b73b-130">Registering for Session Switching Notification</span></span>

<span data-ttu-id="8b73b-131">In der Regel muss eine Anwendung nicht benachrichtigt werden, wenn ein Desktop Switch auftritt.</span><span class="sxs-lookup"><span data-stu-id="8b73b-131">Typically, an application does not need to be notified when a desktop switch occurs.</span></span> <span data-ttu-id="8b73b-132">Anwendungen, die benachrichtigt werden müssen, wenn das Konto, unter dem Sie ausgeführt werden, der aktuelle Desktop ist, z. b. Anwendungen, die auf den seriellen Anschluss oder andere freigegebene Ressourcen zugreifen, können sich für die Benachrichtigung über den Desktop Switch registrieren.</span><span class="sxs-lookup"><span data-stu-id="8b73b-132">However, applications that must be notified when the account under which they are running is the current desktop, such as applications that access the serial port or other shared resources, can register for desktop switch notification.</span></span> <span data-ttu-id="8b73b-133">Um sich für eine Benachrichtigung zu registrieren, verwenden Sie die [**Wout registersessionnotification**](/windows/win32/api/wtsapi32/nf-wtsapi32-wtsregistersessionnotification) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="8b73b-133">To register for a notification, use the [**WTSRegisterSessionNotification**](/windows/win32/api/wtsapi32/nf-wtsapi32-wtsregistersessionnotification) function.</span></span>

<span data-ttu-id="8b73b-134">Nachdem diese Funktion aufgerufen wurde, wird das Fenster mit dem *HWND* -handle registriert, um eine [**WM- \_ wtssession- \_ Änderungs**](../termserv/wm-wtssession-change.md) Nachricht über seine **WndProc** -Funktion zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-134">Once that function has been called, the window with handle *hWnd* is registered to receive a [**WM\_WTSSESSION\_CHANGE**](../termserv/wm-wtssession-change.md) message through its **WndProc** function.</span></span> <span data-ttu-id="8b73b-135">Die Sitzungs-ID wird im **LPARAM** -Parameter gesendet, und ein Code, der das Ereignis angibt, das die Nachricht generiert hat, wird in **wParam** als eines der folgenden Flags gesendet.</span><span class="sxs-lookup"><span data-stu-id="8b73b-135">The session ID is sent in the **lParam** parameter, and a code that indicates the event that generated the message is sent in **wParam** as one of the following flags.</span></span>

-   <span data-ttu-id="8b73b-136">WTS \_ Console \_ Connect</span><span class="sxs-lookup"><span data-stu-id="8b73b-136">WTS\_CONSOLE\_CONNECT</span></span>
-   <span data-ttu-id="8b73b-137">Trennen der WTS- \_ Konsole \_</span><span class="sxs-lookup"><span data-stu-id="8b73b-137">WTS\_CONSOLE\_DISCONNECT</span></span>
-   <span data-ttu-id="8b73b-138">WTS \_ Remote \_ Connect</span><span class="sxs-lookup"><span data-stu-id="8b73b-138">WTS\_REMOTE\_CONNECT</span></span>
-   <span data-ttu-id="8b73b-139">WTS \_ Remote \_ Disconnect</span><span class="sxs-lookup"><span data-stu-id="8b73b-139">WTS\_REMOTE\_DISCONNECT</span></span>
-   <span data-ttu-id="8b73b-140">Logo der WTS- \_ Sitzung \_</span><span class="sxs-lookup"><span data-stu-id="8b73b-140">WTS\_SESSION\_LOGOFF</span></span>
-   <span data-ttu-id="8b73b-141">Anmelde der WTS- \_ Sitzung \_</span><span class="sxs-lookup"><span data-stu-id="8b73b-141">WTS\_SESSION\_LOGON</span></span>

<span data-ttu-id="8b73b-142">Anwendungen können diese Nachricht verwenden, um Ihren Status zu überprüfen und um Konsolen spezifische Ressourcen freizugeben und zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="8b73b-142">Applications can use this message to track their state, as well as to release and acquire console-specific resources.</span></span> <span data-ttu-id="8b73b-143">Benutzer Desktops können zwischen Remote-und Konsolen Steuerung dynamisch gewechselt werden.</span><span class="sxs-lookup"><span data-stu-id="8b73b-143">User desktops can be dynamically switched between remote and console control.</span></span> <span data-ttu-id="8b73b-144">Anwendungen sollten die [**WM- \_ wtssession- \_ Änderungs**](../termserv/wm-wtssession-change.md) Meldung verwenden, um eine Synchronisierung mit dem Remote-oder lokalen Verbindungsstatus auszuführen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-144">Applications should use the [**WM\_WTSSESSION\_CHANGE**](../termserv/wm-wtssession-change.md) message to synchronize with the remote or local connection state.</span></span>

<span data-ttu-id="8b73b-145">Wenn Ihr Prozess diese Benachrichtigungen nicht mehr benötigt oder beendet wird, sollte [**WTSUnRegisterSessionNotification**](/windows/win32/api/wtsapi32/nf-wtsapi32-wtsunregistersessionnotification) aufgerufen werden, um die Registrierung der Benachrichtigung aufzuheben.</span><span class="sxs-lookup"><span data-stu-id="8b73b-145">When your process no longer requires these notifications or is terminating, it should call [**WTSUnRegisterSessionNotification**](/windows/win32/api/wtsapi32/nf-wtsapi32-wtsunregistersessionnotification) to unregister its notification.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8b73b-146">Die an [**wzregistersessionnotification**](/windows/win32/api/wtsapi32/nf-wtsapi32-wtsregistersessionnotification) weiter gegebenen **HWND** -Werte sind Verweis gezählt. Daher müssen Sie die gleiche Anzahl von Aufrufen an [**WTSUnRegisterSessionNotification**](/windows/win32/api/wtsapi32/nf-wtsapi32-wtsunregistersessionnotification) vornehmen, um die Freigabe aller zugeordneten Ressourcen sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-146">The **hWnd** values passed to [**WTSRegisterSessionNotification**](/windows/win32/api/wtsapi32/nf-wtsapi32-wtsregistersessionnotification) are reference counted, so you must make an equal number of calls to [**WTSUnRegisterSessionNotification**](/windows/win32/api/wtsapi32/nf-wtsapi32-wtsunregistersessionnotification) to ensure the release of all allocated resources.</span></span>

 

## <a name="ensuring-only-one-instance-of-your-application-is-running"></a><span data-ttu-id="8b73b-147">Es wird sichergestellt, dass nur eine Instanz der Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8b73b-147">Ensuring Only One Instance of Your Application Is Running</span></span>

<span data-ttu-id="8b73b-148">Viele Anwendungen müssen sicherstellen, dass nur eine Instanz ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8b73b-148">Many applications must ensure that they have only one instance running.</span></span> <span data-ttu-id="8b73b-149">Es gibt mehrere Möglichkeiten, dies in Windows XP zu tun.</span><span class="sxs-lookup"><span data-stu-id="8b73b-149">There are several ways to do this in Windows XP.</span></span> <span data-ttu-id="8b73b-150">Dazu zählen die folgenden:</span><span class="sxs-lookup"><span data-stu-id="8b73b-150">Among them are the following:</span></span>

-   <span data-ttu-id="8b73b-151">Verwenden Sie [**FindWindow**](/windows/win32/api/winuser/nf-winuser-findwindowa) oder [**FindWindowEx**](/windows/win32/api/winuser/nf-winuser-findwindowexa) , um nach einem bekannten Fenster zu suchen, das von der Anwendung geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="8b73b-151">Use [**FindWindow**](/windows/win32/api/winuser/nf-winuser-findwindowa) or [**FindWindowEx**](/windows/win32/api/winuser/nf-winuser-findwindowexa) to search for a known window that your application opens.</span></span> <span data-ttu-id="8b73b-152">Wenn dieses Fenster bereits geöffnet ist, können Sie es als Hinweis darauf verwenden, dass die Anwendung bereits ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8b73b-152">If that window is already open, you can use that as an indication that the application is already running.</span></span>
-   <span data-ttu-id="8b73b-153">Erstellen Sie ein Mutex-oder Semaphor-Objekt, wenn die Anwendung geöffnet ist, und schließen Sie dieses Objekt, wenn die Anwendung beendet wird.</span><span class="sxs-lookup"><span data-stu-id="8b73b-153">Create a mutex or semaphore object when your application is opened, and close that object when the application terminates.</span></span> <span data-ttu-id="8b73b-154">Der globale Objekt Namespace ist für jeden Desktop getrennt und ermöglicht eine eindeutige Liste von Mutex-und Semaphor-Objekten.</span><span class="sxs-lookup"><span data-stu-id="8b73b-154">The global object namespace is separated for each desktop, allowing a unique list of mutex and semaphore objects for each.</span></span>

## <a name="shutting-down-your-application-across-all-sessions"></a><span data-ttu-id="8b73b-155">Herunterfahren der Anwendung über alle Sitzungen hinweg</span><span class="sxs-lookup"><span data-stu-id="8b73b-155">Shutting Down Your Application Across All Sessions</span></span>

<span data-ttu-id="8b73b-156">Eine Anwendung muss möglicherweise über alle Sitzungen hinweg heruntergefahren werden.</span><span class="sxs-lookup"><span data-stu-id="8b73b-156">An application might need to shut itself down across all sessions.</span></span> <span data-ttu-id="8b73b-157">Beispielsweise kann eine Anwendung, die in zwei oder mehr Sitzungen gleichzeitig ausgeführt wird, eine neue Datei aus dem Web herunterladen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-157">For example, an application running in two or more sessions simultaneously might download a new file from the web.</span></span> <span data-ttu-id="8b73b-158">Anschließend muss er sich selbst schließen und mit den aktualisierten Bits neu starten.</span><span class="sxs-lookup"><span data-stu-id="8b73b-158">Then it might need to close itself and restart with the updated bits.</span></span> <span data-ttu-id="8b73b-159">Dies müsste natürlich in allen laufenden Sitzungen erfolgen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-159">This, of course, would need to be done in all running sessions.</span></span> <span data-ttu-id="8b73b-160">Die Anwendung muss so geschrieben werden, dass Sie ordnungsgemäß beendet wird, wenn eine Benachrichtigung empfangen wird.</span><span class="sxs-lookup"><span data-stu-id="8b73b-160">Your application should be written so that it exits cleanly when a notification is received.</span></span>

## <a name="interaction-with-system-services"></a><span data-ttu-id="8b73b-161">Interaktion mit System Diensten</span><span class="sxs-lookup"><span data-stu-id="8b73b-161">Interaction with System Services</span></span>

<span data-ttu-id="8b73b-162">Aus programmatischen Sicht müssen die folgenden Fälle behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="8b73b-162">From a programmatic standpoint, the following cases need to be addressed.</span></span>

-   <span data-ttu-id="8b73b-163">Der Server Prozess empfängt eine direkte Anforderung von einem Client Prozess.</span><span class="sxs-lookup"><span data-stu-id="8b73b-163">The server process receives a direct request from a client process.</span></span>

    <span data-ttu-id="8b73b-164">In diesem Fall wird die Nachricht wahrscheinlich mithilfe eines lokalen Prozedur Aufrufs (Local Procedure Call, LPC) oder eines Remote Prozedur Aufrufs (RPC) übertragen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-164">In this case, the message is probably transmitted using a local procedure call (LPC) or a remote procedure call (RPC).</span></span> <span data-ttu-id="8b73b-165">Es gibt APIs für den LPC oder RPC, die das Abrufen des Client Tokens ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-165">There are APIs for either LPC or RPC that enable retrieval of the client token.</span></span> <span data-ttu-id="8b73b-166">Sobald das Client Token abgerufen wurde, kann der Server es in einem aufzurufenden aufrufungsserver [**verwenden.**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessasusera)</span><span class="sxs-lookup"><span data-stu-id="8b73b-166">Once the client token is obtained, the server can use it in a call to [**CreateProcessAsUser**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessasusera).</span></span> <span data-ttu-id="8b73b-167">Dadurch wird der Prozess auf der richtigen Fenster Station angezeigt, vorausgesetzt, dass das Client Benutzer Token über ein Sitzungstag verfügt.</span><span class="sxs-lookup"><span data-stu-id="8b73b-167">This brings up the process on the correct window station, assuming that the client user token has a session tag, which it should.</span></span>

    > [!Note]  
    > <span data-ttu-id="8b73b-168">" [**Comateprocessasuser**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessasusera) " unterstützt zu diesem Zeitpunkt keine Sitzungs übergreifende Vererbung.</span><span class="sxs-lookup"><span data-stu-id="8b73b-168">[**CreateProcessAsUser**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessasusera) does not support handle inheritance across sessions at this time.</span></span>

     

-   <span data-ttu-id="8b73b-169">Der Server Prozess erhält eine Benachrichtigung und muss die Benutzeroberfläche anzeigen, die Anzeige muss sich jedoch nicht im Kontext des aktuellen Benutzers befinden.</span><span class="sxs-lookup"><span data-stu-id="8b73b-169">The server process receives a notification and needs to display the UI, but the display does not have to be in the current user's context.</span></span>

    <span data-ttu-id="8b73b-170">In diesem Fall kann der Server Prozess sein primäres Prozess Token duplizieren und den fraglichen Sitzungs Bezeichner so ändern, dass er mit dem aktuellen Sitzungs Bezeichner identisch ist.</span><span class="sxs-lookup"><span data-stu-id="8b73b-170">In this case, the server process can duplicate its primary process token and change the session identifier in question to match the current session identifier.</span></span> <span data-ttu-id="8b73b-171">Der aktuelle Sitzungs Bezeichner kann mithilfe der [**wzgetactiveconsolesessionid**](/windows/win32/api/winbase/nf-winbase-wtsgetactiveconsolesessionid) -Funktion abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="8b73b-171">The current session identifier can be obtained by using the [**WTSGetActiveConsoleSessionId**](/windows/win32/api/winbase/nf-winbase-wtsgetactiveconsolesessionid) function.</span></span>

    > [!Note]  
    > <span data-ttu-id="8b73b-172">Um die tokensitzungs-ID festzulegen, benötigen Sie die **SE \_ TCB- \_ Berechtigung**.</span><span class="sxs-lookup"><span data-stu-id="8b73b-172">To set the token session ID, you need the **SE\_TCB\_PRIVILEGE**.</span></span> <span data-ttu-id="8b73b-173">Dies erfolgt nur als Dienst, der im NT Authority System ausgeführt wird \\ .</span><span class="sxs-lookup"><span data-stu-id="8b73b-173">You will have this only as a service running in NT AUTHORITY\\SYSTEM.</span></span>

     

## <a name="remote-desktop-and-bandwidth"></a><span data-ttu-id="8b73b-174">Remotedesktop und Bandbreite</span><span class="sxs-lookup"><span data-stu-id="8b73b-174">Remote Desktop and Bandwidth</span></span>

<span data-ttu-id="8b73b-175">Durch das Hinzufügen des Remotedesktop Features zu Windows XP sollten Anwendungen nicht mehr Bandbreite als nötig verwenden, sodass Sie umfassende Bildschirm Zeichnungen und Animationseffekte vermeiden, wenn der Desktop Remote verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="8b73b-175">With the addition of the Remote Desktop feature to Windows XP, applications should make an effort not to use more bandwidth than needed, avoiding extensive screen drawings and animation effects if the desktop is connected remotely.</span></span> <span data-ttu-id="8b73b-176">Um zu ermitteln, ob die aktuelle Sitzung Remote ist, können Sie [**GetSystemMetrics**](/windows/win32/api/winuser/nf-winuser-getsystemmetrics) mit **SM \_ remotesession** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="8b73b-176">To determine whether the current session is remote, you can call [**GetSystemMetrics**](/windows/win32/api/winuser/nf-winuser-getsystemmetrics) with **SM\_REMOTESESSION**.</span></span> <span data-ttu-id="8b73b-177">Beachten Sie jedoch, dass dieser-Befehl nicht zwischen Remote und getrennt unterscheidet.</span><span class="sxs-lookup"><span data-stu-id="8b73b-177">Be aware, however, that this call does not distinguish between remote and disconnected.</span></span>

 

 
