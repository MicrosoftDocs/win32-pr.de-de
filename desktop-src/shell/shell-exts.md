---
description: In diesen Themen wird erläutert, wie die Erweiterungs Handler implementiert werden, mit denen Sie eine Vielzahl von shellaktionen ändern können.
ms.assetid: 794b6369-665f-49a9-a263-7c736c5ce8ac
title: Arbeiten mit Shellerweiterungen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbb696f4536cdb0fb6869be073771d431bd8d2de
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104980649"
---
# <a name="working-with-shell-extensions"></a><span data-ttu-id="664c8-103">Arbeiten mit Shellerweiterungen</span><span class="sxs-lookup"><span data-stu-id="664c8-103">Working with Shell Extensions</span></span>

<span data-ttu-id="664c8-104">Die Funktionen der Shell können mit Registrierungs Einträgen und INI-Dateien erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="664c8-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="664c8-105">Diese Vorgehensweise zur Erweiterung der Shell ist einfach und für viele Zwecke ausreichend, Sie ist jedoch begrenzt.</span><span class="sxs-lookup"><span data-stu-id="664c8-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="664c8-106">Wenn Sie z. b. die Registrierung verwenden, um ein benutzerdefiniertes Symbol für einen Dateityp anzugeben, wird das gleiche Symbol für jede Datei dieses Typs angezeigt.</span><span class="sxs-lookup"><span data-stu-id="664c8-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="664c8-107">Wenn Sie die Shell mit der Registrierung erweitern, können Sie das Symbol für verschiedene Member des Dateityps nicht verändern.</span><span class="sxs-lookup"><span data-stu-id="664c8-107">Extending the Shell with the registry does not allow you to vary the icon for different members of the file type.</span></span> <span data-ttu-id="664c8-108">Andere Aspekte der Shell, wie z. b. das **Eigenschaften Blatt Eigenschaften** , das angezeigt werden kann, wenn mit der rechten Maustaste auf eine Datei geklickt wird, können überhaupt nicht mit der Registrierung geändert werden.</span><span class="sxs-lookup"><span data-stu-id="664c8-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="664c8-109">Eine leistungsfähigere und flexiblere Methode zur Erweiterung der Shell ist die Implementierung von *Shellerweiterungs Handlern*.</span><span class="sxs-lookup"><span data-stu-id="664c8-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="664c8-110">Diese Handler können für eine Reihe von Aktionen implementiert werden, die die Shell ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="664c8-110">These handlers can be implemented for a variety of actions that the Shell can take.</span></span> <span data-ttu-id="664c8-111">Vor dem Ausführen der Aktion fragt die Shell den Erweiterungs Handler ab und gibt ihm die Möglichkeit, die Aktion zu ändern.</span><span class="sxs-lookup"><span data-stu-id="664c8-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="664c8-112">Ein gängiges Beispiel ist ein Erweiterungs Handler für den Kontextmenü.</span><span class="sxs-lookup"><span data-stu-id="664c8-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="664c8-113">Wenn eine Datei für einen Dateityp implementiert ist, wird Sie jedes Mal abgefragt, wenn auf eine der Dateien mit der rechten Maustaste geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="664c8-114">Der Handler kann dann zusätzliche Menü Elemente auf Datei Basis angeben, anstatt denselben Satz für alle Dateien dieses Dateityps zu haben.</span><span class="sxs-lookup"><span data-stu-id="664c8-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for all files of that file type.</span></span>

<span data-ttu-id="664c8-115">In diesen Themen wird erläutert, wie die Erweiterungs Handler implementiert werden, mit denen Sie eine Vielzahl von shellaktionen ändern können.</span><span class="sxs-lookup"><span data-stu-id="664c8-115">This set of topics discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="664c8-116">Die folgenden Handler sind einem bestimmten Dateityp zugeordnet und ermöglichen es Ihnen, Datei-für-Datei-Basis anzugeben.</span><span class="sxs-lookup"><span data-stu-id="664c8-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis.</span></span>



| <span data-ttu-id="664c8-117">Handler</span><span class="sxs-lookup"><span data-stu-id="664c8-117">Handler</span></span>                                               | <span data-ttu-id="664c8-118">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="664c8-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="664c8-119">Kontextmenü Handler</span><span class="sxs-lookup"><span data-stu-id="664c8-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="664c8-120">Wird aufgerufen, bevor das Kontextmenü einer Datei angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="664c8-121">Sie ermöglicht das Hinzufügen von Elementen zum Kontextmenü auf Datei Basis.</span><span class="sxs-lookup"><span data-stu-id="664c8-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="664c8-122">Daten Handler</span><span class="sxs-lookup"><span data-stu-id="664c8-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="664c8-123">Wird aufgerufen, wenn ein Drag & Drop-Vorgang für Shellobjekte ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-123">Called when a drag-and-drop operation is performed on Shell objects.</span></span> <span data-ttu-id="664c8-124">Sie ermöglicht es Ihnen, zusätzliche Zwischenablage Formate für das Ablage Ziel bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="664c8-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                            |
| [<span data-ttu-id="664c8-125">Drop-Handler</span><span class="sxs-lookup"><span data-stu-id="664c8-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="664c8-126">Wird aufgerufen, wenn ein Datenobjekt in einer Datei gezogen oder gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="664c8-127">Sie ermöglicht es Ihnen, eine Datei in ein Ablage Ziel zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="664c8-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="664c8-128">Symbol Handler</span><span class="sxs-lookup"><span data-stu-id="664c8-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="664c8-129">Wird aufgerufen, bevor das Symbol einer Datei angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="664c8-130">Dadurch können Sie das Standard Symbol der Datei durch ein benutzerdefiniertes Symbol auf Datei Basis ersetzen.</span><span class="sxs-lookup"><span data-stu-id="664c8-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="664c8-131">Eigenschaftenblatthandler</span><span class="sxs-lookup"><span data-stu-id="664c8-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="664c8-132">Wird aufgerufen, bevor das **Eigenschaften** Blatt eines Objekts angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="664c8-133">Sie können Seiten hinzufügen oder ersetzen.</span><span class="sxs-lookup"><span data-stu-id="664c8-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="664c8-134">**Miniatur Ansichts Bild Handler**</span><span class="sxs-lookup"><span data-stu-id="664c8-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="664c8-135">Stellt ein Bild bereit, das das Element darstellt.</span><span class="sxs-lookup"><span data-stu-id="664c8-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="664c8-136">**QuickInfo-Handler**</span><span class="sxs-lookup"><span data-stu-id="664c8-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="664c8-137">Stellt Popup Text bereit, wenn der Benutzer mit dem Mauszeiger auf das-Objekt zeigt.</span><span class="sxs-lookup"><span data-stu-id="664c8-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="664c8-138">**Metadatenhandler**</span><span class="sxs-lookup"><span data-stu-id="664c8-138">**Metadata handler**</span></span>](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)       | <span data-ttu-id="664c8-139">Bietet Lese-und Schreibzugriff auf Metadaten (Eigenschaften), die in einer Datei gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="664c8-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="664c8-140">Dies kann verwendet werden, um die Detailansicht, die Infotipps, die Eigenschaften Seite und die Gruppierungsfunktionen zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="664c8-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="664c8-141">Andere sind keinem bestimmten Dateityp zugeordnet, werden jedoch vor einigen shellvorgängen aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="664c8-141">Others are not associated with a particular file type but are called before some Shell operations.</span></span>



| <span data-ttu-id="664c8-142">Handler</span><span class="sxs-lookup"><span data-stu-id="664c8-142">Handler</span></span>                                                            | <span data-ttu-id="664c8-143">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="664c8-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="664c8-144">Spaltenhandler</span><span class="sxs-lookup"><span data-stu-id="664c8-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="664c8-145">Wird von Windows Explorer aufgerufen, bevor die Detailansicht eines Ordners angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="664c8-146">Damit können Sie der Detailansicht benutzerdefinierte Spalten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="664c8-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="664c8-147">Hook-Handler kopieren</span><span class="sxs-lookup"><span data-stu-id="664c8-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="664c8-148">Wird aufgerufen, wenn ein Ordner oder ein Drucker Objekt verschoben, kopiert, gelöscht oder umbenannt wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="664c8-149">Dies ermöglicht es Ihnen, den Vorgang zu genehmigen oder zu überstehen.</span><span class="sxs-lookup"><span data-stu-id="664c8-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="664c8-150">Drag &amp;amp; Drop-Handler</span><span class="sxs-lookup"><span data-stu-id="664c8-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="664c8-151">Wird aufgerufen, wenn eine Datei mit der rechten Maustaste gezogen wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="664c8-152">Es ermöglicht Ihnen, das angezeigte Kontextmenü zu ändern.</span><span class="sxs-lookup"><span data-stu-id="664c8-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="664c8-153">Symbol Überlagerungs Handler</span><span class="sxs-lookup"><span data-stu-id="664c8-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="664c8-154">Wird aufgerufen, bevor das Symbol einer Datei angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="664c8-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="664c8-155">Damit können Sie ein Overlay für das Symbol der Datei angeben.</span><span class="sxs-lookup"><span data-stu-id="664c8-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="664c8-156">Such Handler</span><span class="sxs-lookup"><span data-stu-id="664c8-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="664c8-157">Wird aufgerufen, um eine Suchmaschine zu starten.</span><span class="sxs-lookup"><span data-stu-id="664c8-157">Called to launch a search engine.</span></span> <span data-ttu-id="664c8-158">Damit können Sie eine benutzerdefinierte Suchmaschine implementieren, auf die Sie über das **Startmenü** oder den Windows-Explorer zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="664c8-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="664c8-159">Die Details zur Implementierung bestimmter Erweiterungs Handler werden in den oben aufgeführten Abschnitten behandelt.</span><span class="sxs-lookup"><span data-stu-id="664c8-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="664c8-160">Erörterung der Implementierungsprobleme, die allen Shellerweiterungs Handlern gemeinsam sind, finden Sie in den folgenden Themen:</span><span class="sxs-lookup"><span data-stu-id="664c8-160">For discussions of implementation issues that are common to all Shell extension handlers, see these topics:</span></span>

-   [<span data-ttu-id="664c8-161">Initialisieren von Shellerweiterungs Handlern</span><span class="sxs-lookup"><span data-stu-id="664c8-161">Initializing Shell Extension Handlers</span></span>](int-shell-exts.md)
-   [<span data-ttu-id="664c8-162">Registrieren von Shellerweiterungs Handlern</span><span class="sxs-lookup"><span data-stu-id="664c8-162">Registering Shell Extension Handlers</span></span>](reg-shell-exts.md)

 

 
