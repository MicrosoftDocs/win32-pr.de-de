---
description: In diesem Thema werden die spezifischen Schnittstellen und Methoden erläutert, die zum Erstellen eines Vorschau Handlers erforderlich sind.
ms.assetid: 6c240a63-c184-4b65-9483-794f5de4d695
title: Entwickeln von Vorschau Handlern
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a309873cf082071d5f426ce0ba6d039107c59665
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104342849"
---
# <a name="building-preview-handlers"></a><span data-ttu-id="9aa65-103">Entwickeln von Vorschau Handlern</span><span class="sxs-lookup"><span data-stu-id="9aa65-103">Building Preview Handlers</span></span>

<span data-ttu-id="9aa65-104">In diesem Thema werden die spezifischen Schnittstellen und Methoden erläutert, die zum Erstellen eines Vorschau Handlers erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="9aa65-104">This topic discusses the specific interfaces and methods required to create a preview handler.</span></span>

<span data-ttu-id="9aa65-105">Ein Vorschau Handler muss die folgenden Schnittstellen implementieren:</span><span class="sxs-lookup"><span data-stu-id="9aa65-105">A preview handler must implement the following interfaces:</span></span>

-   <span data-ttu-id="9aa65-106">[IInitializeWithStream:: Initialize](#iinitializewithstreaminitialize) (stark bevorzugt), [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile)oder [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)</span><span class="sxs-lookup"><span data-stu-id="9aa65-106">[IInitializeWithStream::Initialize](#iinitializewithstreaminitialize) (strongly preferred), [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile), or [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)</span></span>
-   [<span data-ttu-id="9aa65-107">IObjectWithSite</span><span class="sxs-lookup"><span data-stu-id="9aa65-107">IObjectWithSite</span></span>](#iobjectwithsite)
-   [<span data-ttu-id="9aa65-108">IOleWindow</span><span class="sxs-lookup"><span data-stu-id="9aa65-108">IOleWindow</span></span>](#iolewindow)
-   [<span data-ttu-id="9aa65-109">IPreviewHandler</span><span class="sxs-lookup"><span data-stu-id="9aa65-109">IPreviewHandler</span></span>](#ipreviewhandler)

<span data-ttu-id="9aa65-110">Wenn Ihr Vorschau Handler visuelle Einstellungen unterstützt, die vom Host bereitgestellt werden, z. b. Hintergrundfarbe und Schriftart, muss auch die folgende Schnittstelle implementiert werden:</span><span class="sxs-lookup"><span data-stu-id="9aa65-110">If your preview handler supports visual settings provided by the host such as background color and font, it must also implement the following interface:</span></span>

-   [<span data-ttu-id="9aa65-111">IPreviewHandlerVisuals</span><span class="sxs-lookup"><span data-stu-id="9aa65-111">IPreviewHandlerVisuals</span></span>](#ipreviewhandlervisuals)

<span data-ttu-id="9aa65-112">In diesem Thema wird davon ausgegangen, dass der Vorschau Handler mit einem Stream initialisiert ist und für eine bestimmte Dateinamenerweiterung registriert ist.</span><span class="sxs-lookup"><span data-stu-id="9aa65-112">This topic assumes that the preview handler is initialized with a stream and is registered for a particular file name extension.</span></span>

## <a name="iinitializewithstreaminitialize"></a><span data-ttu-id="9aa65-113">IInitializeWithStream:: Initialize</span><span class="sxs-lookup"><span data-stu-id="9aa65-113">IInitializeWithStream::Initialize</span></span>

<span data-ttu-id="9aa65-114">Speichern Sie die Parameter [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) und Mode, damit Sie die Daten des Elements lesen können, wenn Sie bereit sind, das Element in der Vorschau anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="9aa65-114">Store the [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) and mode parameters so that you can read the item's data when you are ready to preview the item.</span></span> <span data-ttu-id="9aa65-115">Laden Sie die Daten nicht in [**Initialize**](/windows/desktop/api/Propsys/nf-propsys-iinitializewithstream-initialize).</span><span class="sxs-lookup"><span data-stu-id="9aa65-115">Do not load the data in [**Initialize**](/windows/desktop/api/Propsys/nf-propsys-iinitializewithstream-initialize).</span></span> <span data-ttu-id="9aa65-116">Laden Sie die Daten in [**IPreviewHandler::D opreview**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-dopreview) direkt vor dem Rendering.</span><span class="sxs-lookup"><span data-stu-id="9aa65-116">Load the data in [**IPreviewHandler::DoPreview**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-dopreview) just before you render.</span></span>

## <a name="iobjectwithsite"></a><span data-ttu-id="9aa65-117">IObjectWithSite</span><span class="sxs-lookup"><span data-stu-id="9aa65-117">IObjectWithSite</span></span>

-   [<span data-ttu-id="9aa65-118">IObjectWithSite:: SetSite</span><span class="sxs-lookup"><span data-stu-id="9aa65-118">IObjectWithSite::SetSite</span></span>](#iobjectwithsitesetsite)
-   [<span data-ttu-id="9aa65-119">IObjectWithSite:: GetSite</span><span class="sxs-lookup"><span data-stu-id="9aa65-119">IObjectWithSite::GetSite</span></span>](#iobjectwithsitegetsite)

### <a name="iobjectwithsitesetsite"></a><span data-ttu-id="9aa65-120">IObjectWithSite:: SetSite</span><span class="sxs-lookup"><span data-stu-id="9aa65-120">IObjectWithSite::SetSite</span></span>

<span data-ttu-id="9aa65-121">Speichert den [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) -Zeiger für den späteren Zugriff.</span><span class="sxs-lookup"><span data-stu-id="9aa65-121">Store the [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) pointer for later access.</span></span>

<span data-ttu-id="9aa65-122">Wenn Sie derzeit über einen Verweis auf ein [**IPreviewHandlerFrame**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandlerframe) -Objekt verfügen, geben Sie es frei.</span><span class="sxs-lookup"><span data-stu-id="9aa65-122">If you currently have a reference to an [**IPreviewHandlerFrame**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandlerframe) object, release it.</span></span> <span data-ttu-id="9aa65-123">Verwenden Sie den gespeicherten [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) -Zeiger, um [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) für einen neuen **IPreviewHandlerFrame** -Verweis auf der Website aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="9aa65-123">Use the stored [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) pointer to call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on the site for a new **IPreviewHandlerFrame** reference.</span></span>

<span data-ttu-id="9aa65-124">Wenn Sie derzeit über eine Zugriffstasten Tabelle verfügen, zerstören Sie Sie.</span><span class="sxs-lookup"><span data-stu-id="9aa65-124">If you currently have an accelerator table, destroy it.</span></span> <span data-ttu-id="9aa65-125">Rufen Sie [**IPreviewHandlerFrame:: GetWindowContext**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-getwindowcontext) auf, um eine neue Zugriffstasten Tabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="9aa65-125">Call [**IPreviewHandlerFrame::GetWindowContext**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-getwindowcontext) to get a new accelerator table.</span></span> <span data-ttu-id="9aa65-126">Speichern Sie diese Tabelle.</span><span class="sxs-lookup"><span data-stu-id="9aa65-126">Store this table.</span></span> <span data-ttu-id="9aa65-127">Beachten Sie, dass Sie nur als Liste von Zugriffstasten verwendet wird, die vom Frame unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="9aa65-127">Note that it is used only as a list of accelerator keys that the frame supports.</span></span> <span data-ttu-id="9aa65-128">Befehle in den Zugriffstasten Einträgen werden ignoriert.</span><span class="sxs-lookup"><span data-stu-id="9aa65-128">Commands in the accelerator entries are ignored.</span></span>

### <a name="iobjectwithsitegetsite"></a><span data-ttu-id="9aa65-129">IObjectWithSite:: GetSite</span><span class="sxs-lookup"><span data-stu-id="9aa65-129">IObjectWithSite::GetSite</span></span>

<span data-ttu-id="9aa65-130">Gibt den Website Zeiger zurück.</span><span class="sxs-lookup"><span data-stu-id="9aa65-130">Return the site pointer, whatever it is.</span></span>

## <a name="iolewindow"></a><span data-ttu-id="9aa65-131">IOleWindow</span><span class="sxs-lookup"><span data-stu-id="9aa65-131">IOleWindow</span></span>

-   [<span data-ttu-id="9aa65-132">IOleWindow:: ContextSensitiveHelp</span><span class="sxs-lookup"><span data-stu-id="9aa65-132">IOleWindow::ContextSensitiveHelp</span></span>](#iolewindowcontextsensitivehelp)
-   [<span data-ttu-id="9aa65-133">IOleWindow:: GetWindow</span><span class="sxs-lookup"><span data-stu-id="9aa65-133">IOleWindow::GetWindow</span></span>](#iolewindowgetwindow)

### <a name="iolewindowcontextsensitivehelp"></a><span data-ttu-id="9aa65-134">IOleWindow:: ContextSensitiveHelp</span><span class="sxs-lookup"><span data-stu-id="9aa65-134">IOleWindow::ContextSensitiveHelp</span></span>

<span data-ttu-id="9aa65-135">Gibt E \_ notimpl für diese Methode zurück.</span><span class="sxs-lookup"><span data-stu-id="9aa65-135">Return E\_NOTIMPL for this method.</span></span>

### <a name="iolewindowgetwindow"></a><span data-ttu-id="9aa65-136">IOleWindow:: GetWindow</span><span class="sxs-lookup"><span data-stu-id="9aa65-136">IOleWindow::GetWindow</span></span>

<span data-ttu-id="9aa65-137">Wenn das Fenster des Vorschau Handlers aktuell vorhanden ist, geben Sie das **HWND** dieses Fensters und s \_ OK zurück.</span><span class="sxs-lookup"><span data-stu-id="9aa65-137">If the preview handler's window currently exists, return the **HWND** of that window and S\_OK.</span></span> <span data-ttu-id="9aa65-138">Wenn das Fenster nicht vorhanden ist, wird "E Fail" zurückgegeben \_ .</span><span class="sxs-lookup"><span data-stu-id="9aa65-138">If the window does not exist, return E\_FAIL.</span></span>

## <a name="ipreviewhandler"></a><span data-ttu-id="9aa65-139">IPreviewHandler</span><span class="sxs-lookup"><span data-stu-id="9aa65-139">IPreviewHandler</span></span>

-   [<span data-ttu-id="9aa65-140">IPreviewHandler:: SetWindow</span><span class="sxs-lookup"><span data-stu-id="9aa65-140">IPreviewHandler::SetWindow</span></span>](#ipreviewhandlersetwindow)
-   [<span data-ttu-id="9aa65-141">IPreviewHandler:: SetRect</span><span class="sxs-lookup"><span data-stu-id="9aa65-141">IPreviewHandler::SetRect</span></span>](#ipreviewhandlersetrect)
-   [<span data-ttu-id="9aa65-142">IPreviewHandler::D opreview</span><span class="sxs-lookup"><span data-stu-id="9aa65-142">IPreviewHandler::DoPreview</span></span>](#ipreviewhandlerdopreview)
-   [<span data-ttu-id="9aa65-143">IPreviewHandler:: SetFocus</span><span class="sxs-lookup"><span data-stu-id="9aa65-143">IPreviewHandler::SetFocus</span></span>](#ipreviewhandlersetfocus)
-   [<span data-ttu-id="9aa65-144">IPreviewHandler:: QueryFocus</span><span class="sxs-lookup"><span data-stu-id="9aa65-144">IPreviewHandler::QueryFocus</span></span>](#ipreviewhandlerqueryfocus)
-   [<span data-ttu-id="9aa65-145">IPreviewHandler:: TranslateAccelerator</span><span class="sxs-lookup"><span data-stu-id="9aa65-145">IPreviewHandler::TranslateAccelerator</span></span>](#ipreviewhandlertranslateaccelerator)
-   [<span data-ttu-id="9aa65-146">IPreviewHandler:: entladen</span><span class="sxs-lookup"><span data-stu-id="9aa65-146">IPreviewHandler::Unload</span></span>](#ipreviewhandlerunload)

### <a name="ipreviewhandlersetwindow"></a><span data-ttu-id="9aa65-147">IPreviewHandler:: SetWindow</span><span class="sxs-lookup"><span data-stu-id="9aa65-147">IPreviewHandler::SetWindow</span></span>

<span data-ttu-id="9aa65-148">Legen Sie den *HWND* -Parameter dieser Methode auf das übergeordnete Element des **HWND** Ihres Vorschau Handlers fest.</span><span class="sxs-lookup"><span data-stu-id="9aa65-148">Set the *hwnd* parameter of this method to the parent of your preview handler's **HWND**.</span></span> <span data-ttu-id="9aa65-149">Diese Methode kann mehrmals aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="9aa65-149">This method can be called multiple times.</span></span> <span data-ttu-id="9aa65-150">Ändern Sie die Größe Ihrer Vorschau, sodass Sie nur in dem Bereich gerendert wird, der vom *PRC* -Parameter beschrieben wird</span><span class="sxs-lookup"><span data-stu-id="9aa65-150">Resize your preview so that it renders only in the area described by the *prc* parameter.</span></span>

<span data-ttu-id="9aa65-151">Wenn der Vorschau gerade gerendert wird, verwenden Sie die [**IPreviewHandler:: SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow) -Methode, um das übergeordnete Element der Vorschau zu ändern.</span><span class="sxs-lookup"><span data-stu-id="9aa65-151">If the previewer is in the process of rendering, use the [**IPreviewHandler::SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow) method to change the parent of the previewer.</span></span> <span data-ttu-id="9aa65-152">Ändern Sie auch den Bereich, in dem der Vorschau gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="9aa65-152">Also change the area in which the previewer is rendering.</span></span>

### <a name="ipreviewhandlersetrect"></a><span data-ttu-id="9aa65-153">IPreviewHandler:: SetRect</span><span class="sxs-lookup"><span data-stu-id="9aa65-153">IPreviewHandler::SetRect</span></span>

<span data-ttu-id="9aa65-154">Ändern Sie die Größe Ihrer Vorschau, sodass Sie nur in dem von der Volks *Republik China* beschriebenen Bereich gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="9aa65-154">Resize your preview so that it only renders in the area described by this method's *prc*.</span></span>

<span data-ttu-id="9aa65-155">Wenn der Vorschau gerade gerendert wird, ändern Sie den Bereich, in dem der Vorschau gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="9aa65-155">If the previewer is in the process of rendering, change the area in which your previewer renders.</span></span>

### <a name="ipreviewhandlerdopreview"></a><span data-ttu-id="9aa65-156">IPreviewHandler::D opreview</span><span class="sxs-lookup"><span data-stu-id="9aa65-156">IPreviewHandler::DoPreview</span></span>

<span data-ttu-id="9aa65-157">An dieser Stelle wird die eigentliche Arbeit erledigt.</span><span class="sxs-lookup"><span data-stu-id="9aa65-157">This is where the real work is done.</span></span> <span data-ttu-id="9aa65-158">Da eine Vorschau dynamisch ist, sollte der Vorschau Inhalt nur geladen werden, wenn er benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="9aa65-158">Since a preview is dynamic, the preview content should only be loaded when it is needed.</span></span> <span data-ttu-id="9aa65-159">Laden Sie keinen Inhalt in die Initialisierung.</span><span class="sxs-lookup"><span data-stu-id="9aa65-159">Do not load content in the initialization.</span></span>

<span data-ttu-id="9aa65-160">Wenn das vorschauhandlerfenster nicht vorhanden ist, erstellen Sie es.</span><span class="sxs-lookup"><span data-stu-id="9aa65-160">If the preview handler window does not exist, create it.</span></span> <span data-ttu-id="9aa65-161">Die Fenster Ihres Vorschau Handlers sollten untergeordnete Elemente des Fensters sein, das von [**IPreviewHandler:: SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow)bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="9aa65-161">Your preview handler's windows should be children of the window provided by [**IPreviewHandler::SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow).</span></span> <span data-ttu-id="9aa65-162">Sie sollten die Größe aufweisen, die von **IPreviewHandler:: SetWindow** und [**IPreviewHandler:: SetRect**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setrect) bereitgestellt wird (je nachdem, was zuletzt aufgerufen wurde).</span><span class="sxs-lookup"><span data-stu-id="9aa65-162">They should be the size provided by **IPreviewHandler::SetWindow** and [**IPreviewHandler::SetRect**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setrect) (whichever was called most recently).</span></span>

<span data-ttu-id="9aa65-163">Wenn Sie über ein Fenster verfügen, laden Sie die Daten aus dem [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) , mit dem der Vorschau Handler initialisiert wurde, und Rendering Sie diese Daten im Fenster des Vorschau Handlers.</span><span class="sxs-lookup"><span data-stu-id="9aa65-163">Once you have a window, load the data from the [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) that the preview handler was initialized with, and render that data to your preview handler's window.</span></span>

### <a name="ipreviewhandlersetfocus"></a><span data-ttu-id="9aa65-164">IPreviewHandler:: SetFocus</span><span class="sxs-lookup"><span data-stu-id="9aa65-164">IPreviewHandler::SetFocus</span></span>

<span data-ttu-id="9aa65-165">Diese Methode wird aufgerufen, wenn der Fokus über eine Tabstopp Aktion in den Lesebereich wechselt.</span><span class="sxs-lookup"><span data-stu-id="9aa65-165">This method is called when the focus enters the reading pane through a tab action.</span></span> <span data-ttu-id="9aa65-166">Da es als vorwärts Registerkarte oder umgekehrte Registerkarte eingegeben werden kann, verwenden Sie den aktuellen Zustand der UMSCHALTTASTE, um zu entscheiden, ob der erste oder letzte Tabstopp im Lesebereich den Fokus erhalten soll.</span><span class="sxs-lookup"><span data-stu-id="9aa65-166">Since it can be entered as a forward tab or reverse tab, use the current state of the SHIFT key to decide whether the first or last tab stop in the reading pane should receive the focus.</span></span>

### <a name="ipreviewhandlerqueryfocus"></a><span data-ttu-id="9aa65-167">IPreviewHandler:: QueryFocus</span><span class="sxs-lookup"><span data-stu-id="9aa65-167">IPreviewHandler::QueryFocus</span></span>

<span data-ttu-id="9aa65-168">Diese Methode sollte die [**GetFocus**](/windows/win32/api/winuser/nf-winuser-getfocus) -Funktion aufrufen und das Ergebnis dieses Aufrufes im *phwnd* -Parameter zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="9aa65-168">This method should call the [**GetFocus**](/windows/win32/api/winuser/nf-winuser-getfocus) function and return the result of that call in the *phwnd* parameter.</span></span>

### <a name="ipreviewhandlertranslateaccelerator"></a><span data-ttu-id="9aa65-169">IPreviewHandler:: TranslateAccelerator</span><span class="sxs-lookup"><span data-stu-id="9aa65-169">IPreviewHandler::TranslateAccelerator</span></span>

<span data-ttu-id="9aa65-170">Diese Methode wird von der Meldungs Pumpe des vorschauhandlerprozesses (unabhängig davon, ob prevhost.exe oder ein benutzerdefinierter lokaler Server) als Reaktion auf Benutzer Tastatureingaben aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="9aa65-170">This method is called by the message pump of the preview handler's process (whether prevhost.exe or a custom local server) in response to user keystrokes.</span></span> <span data-ttu-id="9aa65-171">Vorschau Handler sollten diese Tastatureingaben verarbeiten oder entsprechend dem unten beschriebenen Algorithmus an Ihren Host weiterleiten.</span><span class="sxs-lookup"><span data-stu-id="9aa65-171">Preview handlers should handle these keystrokes or forward them to their host according to the algorithm detailed below.</span></span>

<span data-ttu-id="9aa65-172">Da Vorschau Versionen jedoch schreibgeschützt sind, sollten Tastatureingaben minimal sein, und Optimierungen wie diese sind in vielen Fällen nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="9aa65-172">However, because previews are read-only, keyboard input should be minimal and optimizations such as this are not needed in many cases.</span></span>

<span data-ttu-id="9aa65-173">Wenn die Zugriffstaste, die an diese Methode über die Meldungs Pumpe übergeben wird, eine Zugriffstaste ist, die der Vorschau Handler annimmt, dann verarbeiten und S OK zurückgeben \_ .</span><span class="sxs-lookup"><span data-stu-id="9aa65-173">If the keyboard accelerator passed to this method through the message pump is an accelerator that your preview handler accepts, then process it and return S\_OK.</span></span> <span data-ttu-id="9aa65-174">Wenn Ihr Handler diese Zugriffstaste nicht akzeptiert, kann die Zugriffstasten Meldung zurückgesendet werden, wenn der Frame behandelt wird.</span><span class="sxs-lookup"><span data-stu-id="9aa65-174">If your handler does not accept that accelerator, the accelerator message can be sent back as far as the frame to be handled.</span></span>

<span data-ttu-id="9aa65-175">Es gibt zwei Optionen für die Weiterleitung von Tastatur Accelerators an den Frame:</span><span class="sxs-lookup"><span data-stu-id="9aa65-175">There are two options for forwarding keyboard accelerators back to the frame:</span></span>

<span data-ttu-id="9aa65-176">Das einfachste Modell besteht darin, mithilfe von [**IPreviewHandlerFrame:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-translateaccelerator)alle Tastatureingaben an den Host weiterzuleiten.</span><span class="sxs-lookup"><span data-stu-id="9aa65-176">The simplest model is to forward all keystrokes to the host using [**IPreviewHandlerFrame::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-translateaccelerator).</span></span> <span data-ttu-id="9aa65-177">Dies erfolgt im Vorschau handlerbeispiel, das mit dem Windows Software Development Kit (SDK) bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="9aa65-177">This is done in the preview handler sample provided with the Windows Software Development Kit (SDK).</span></span> <span data-ttu-id="9aa65-178">Alle Vorschau Handler mit niedriger Integrität müssen dieses Modell verwenden.</span><span class="sxs-lookup"><span data-stu-id="9aa65-178">All low-integrity preview handlers must use this model.</span></span> <span data-ttu-id="9aa65-179">Wenn die Zugriffstaste nicht von Ihrem Vorschau Handler behandelt wird, rufen Sie **IPreviewHandlerFrame:: TranslateAccelerator** auf, und geben Sie das Ergebnis zurück.</span><span class="sxs-lookup"><span data-stu-id="9aa65-179">If the accelerator is not handled by your preview handler, call **IPreviewHandlerFrame::TranslateAccelerator** and return its result.</span></span>

<span data-ttu-id="9aa65-180">Das andere Modell ist die Verwendung einer Zugriffstasten Tabelle als Optimierung, um zu vermeiden, dass zu viele Tastatureingaben über Prozess Grenzen hinweg gesendet werden:</span><span class="sxs-lookup"><span data-stu-id="9aa65-180">The other model is to use an accelerator table as an optimization to avoid sending too many keystrokes across process boundaries:</span></span>

1.  <span data-ttu-id="9aa65-181">Wenn [**IObjectWithSite:: SetSite**](/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-setsite) für Ihren Vorschau Handler aufgerufen wird, rufen Sie die Zugriffstasten Tabelle über [**IPreviewHandlerFrame:: GetWindowContext**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-getwindowcontext)ab.</span><span class="sxs-lookup"><span data-stu-id="9aa65-181">When [**IObjectWithSite::SetSite**](/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-setsite) is called on your preview handler, acquire the accelerator table through [**IPreviewHandlerFrame::GetWindowContext**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-getwindowcontext).</span></span> <span data-ttu-id="9aa65-182">(Achten Sie darauf, das Handle für die Zugriffstasten Tabelle freizugeben, wenn der Vorschau zerstört wird.)</span><span class="sxs-lookup"><span data-stu-id="9aa65-182">(Be sure to free the handle to the accelerator table when your previewer is destroyed.)</span></span>
2.  <span data-ttu-id="9aa65-183">Wenn die Zugriffstaste von Ihrem Vorschau Handler behandelt wird, behandeln Sie Sie, und geben Sie "S OK" zurück \_ .</span><span class="sxs-lookup"><span data-stu-id="9aa65-183">If the accelerator is handled by your preview handler, handle it and return S\_OK.</span></span>
3.  <span data-ttu-id="9aa65-184">Wenn die Zugriffstaste nicht von Ihrem Vorschau Handler behandelt wird, vergleichen Sie die Nachricht mithilfe von [**isaccelerator**](/windows/win32/api/ole2/nf-ole2-isaccelerator) mit der erworbenen Zugriffstasten Tabelle.</span><span class="sxs-lookup"><span data-stu-id="9aa65-184">If the accelerator is not handled by your preview handler, compare the message using [**IsAccelerator**](/windows/win32/api/ole2/nf-ole2-isaccelerator) against the accelerator table acquired.</span></span>
4.  <span data-ttu-id="9aa65-185">Wenn die Zugriffstaste mit einem Eintrag in der Zugriffstasten Tabelle übereinstimmt, rufen Sie [**IPreviewHandlerFrame:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-translateaccelerator) auf, und geben Sie das Ergebnis zurück.</span><span class="sxs-lookup"><span data-stu-id="9aa65-185">If the accelerator matches an entry in that accelerator table, call [**IPreviewHandlerFrame::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-translateaccelerator) and return its result.</span></span>
5.  <span data-ttu-id="9aa65-186">Wenn die Zugriffstaste keinem Eintrag in der Zugriffstasten Tabelle entspricht, gibt S \_ false zurück.</span><span class="sxs-lookup"><span data-stu-id="9aa65-186">If the accelerator does not match any entry in the accelerator table, return S\_FALSE.</span></span>

### <a name="ipreviewhandlerunload"></a><span data-ttu-id="9aa65-187">IPreviewHandler:: entladen</span><span class="sxs-lookup"><span data-stu-id="9aa65-187">IPreviewHandler::Unload</span></span>

<span data-ttu-id="9aa65-188">Wenn diese Methode aufgerufen wird, beenden Sie jedes Rendering, geben Sie alle Ressourcen frei, die durch das Lesen von Daten aus dem Stream zugeordnet sind, und geben Sie den [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) selbst frei.</span><span class="sxs-lookup"><span data-stu-id="9aa65-188">When this method is called, stop any rendering, release any resources allocated by reading data from the stream, and release the [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) itself.</span></span>

<span data-ttu-id="9aa65-189">Nachdem diese Methode aufgerufen wurde, muss der Handler erneut initialisiert werden, bevor versucht wird, [**IPreviewHandler::D opreview**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-dopreview) erneut aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="9aa65-189">Once this method is called, the handler must be reinitialized before any attempt to call [**IPreviewHandler::DoPreview**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-dopreview) again.</span></span>

## <a name="ipreviewhandlervisuals"></a><span data-ttu-id="9aa65-190">IPreviewHandlerVisuals</span><span class="sxs-lookup"><span data-stu-id="9aa65-190">IPreviewHandlerVisuals</span></span>

-   [<span data-ttu-id="9aa65-191">IPreviewHandlerVisuals:: SetBackgroundColor</span><span class="sxs-lookup"><span data-stu-id="9aa65-191">IPreviewHandlerVisuals::SetBackgroundColor</span></span>](#ipreviewhandlervisualssetbackgroundcolor)
-   [<span data-ttu-id="9aa65-192">IPreviewHandlerVisuals:: SetFont</span><span class="sxs-lookup"><span data-stu-id="9aa65-192">IPreviewHandlerVisuals::SetFont</span></span>](#ipreviewhandlervisualssetfont)
-   [<span data-ttu-id="9aa65-193">IPreviewHandlerVisuals:: SetTextColor</span><span class="sxs-lookup"><span data-stu-id="9aa65-193">IPreviewHandlerVisuals::SetTextColor</span></span>](#ipreviewhandlervisualssettextcolor)

<span data-ttu-id="9aa65-194">Diese Methoden sollten implementiert werden, wenn der Vorschau Handler so umgeleitet wird, dass er auf die Farb-und Schriftart Schemas des Hosts antwortet.</span><span class="sxs-lookup"><span data-stu-id="9aa65-194">These methods should be implemented when directing the preview handler to respond to the host's color and font schemes.</span></span> <span data-ttu-id="9aa65-195">Der Host fragt den Handler nach [**IPreviewHandlerVisuals**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandlervisuals)ab.</span><span class="sxs-lookup"><span data-stu-id="9aa65-195">The host queries the handler for [**IPreviewHandlerVisuals**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandlervisuals).</span></span> <span data-ttu-id="9aa65-196">Wenn die Unterstützung gefunden wird, stellt der Host die Farbe, die Schriftart und die Textfarbe bereit.</span><span class="sxs-lookup"><span data-stu-id="9aa65-196">If found to be supported, the host provides it with color, font, and text color.</span></span>

### <a name="ipreviewhandlervisualssetbackgroundcolor"></a><span data-ttu-id="9aa65-197">IPreviewHandlerVisuals:: SetBackgroundColor</span><span class="sxs-lookup"><span data-stu-id="9aa65-197">IPreviewHandlerVisuals::SetBackgroundColor</span></span>

<span data-ttu-id="9aa65-198">Speichern Sie diese Farbe, und verwenden Sie Sie während des Renderings, wenn Sie eine Hintergrundfarbe bereitstellen möchten.</span><span class="sxs-lookup"><span data-stu-id="9aa65-198">Store this color and use it during rendering when you want to provide a background color.</span></span> <span data-ttu-id="9aa65-199">Zum Beispiel, um das Fenster auszufüllen, wenn der Handler in einen Bereich gerendert wird, der kleiner als der von [**IPreviewHandler:: SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow) und [**IPreviewHandler:: SetRect**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setrect)bereitgestellte Bereich ist.</span><span class="sxs-lookup"><span data-stu-id="9aa65-199">For instance, to fill the window when the handler renders to an area smaller than the area provided by [**IPreviewHandler::SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow) and [**IPreviewHandler::SetRect**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setrect).</span></span> <span data-ttu-id="9aa65-200">Beachten Sie jedoch, dass Sie nicht außerhalb des Bereichs, der von diesen Methoden bereitgestellt wird, zeichnen sollten.</span><span class="sxs-lookup"><span data-stu-id="9aa65-200">Note, however, that you should not draw outside the area provided by those methods.</span></span>

<span data-ttu-id="9aa65-201">Wenn diese Methode aufgerufen wird, während die Vorschau bereits gerendert wird, sollte das Rendering mit dieser Hintergrundfarbe neu gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="9aa65-201">If this method is called while the preview is already being rendered, the rendering should be restarted using this background color.</span></span>

### <a name="ipreviewhandlervisualssetfont"></a><span data-ttu-id="9aa65-202">IPreviewHandlerVisuals:: SetFont</span><span class="sxs-lookup"><span data-stu-id="9aa65-202">IPreviewHandlerVisuals::SetFont</span></span>

<span data-ttu-id="9aa65-203">Speichern Sie diese Schriftart Informationen, und verwenden Sie Sie während des Renderings, wenn Sie Text in Übereinstimmung mit den aktuellen Windows Vista-Einstellungen anzeigen möchten.</span><span class="sxs-lookup"><span data-stu-id="9aa65-203">Store this font information and use it during rendering when you want to display text consistent with the current Windows Vista settings.</span></span>

### <a name="ipreviewhandlervisualssettextcolor"></a><span data-ttu-id="9aa65-204">IPreviewHandlerVisuals:: SetTextColor</span><span class="sxs-lookup"><span data-stu-id="9aa65-204">IPreviewHandlerVisuals::SetTextColor</span></span>

<span data-ttu-id="9aa65-205">Speichern Sie diese Text Farbinformationen, und verwenden Sie Sie während des Renderings, wenn Sie Text in Übereinstimmung mit den aktuellen Windows Vista-Einstellungen anzeigen möchten.</span><span class="sxs-lookup"><span data-stu-id="9aa65-205">Store this text color information and use it during rendering when you want to display text consistent with the current Windows Vista settings.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9aa65-206">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="9aa65-206">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9aa65-207">Vorschau Handler und Shell-Vorschau Host</span><span class="sxs-lookup"><span data-stu-id="9aa65-207">Preview Handlers and Shell Preview Host</span></span>](preview-handlers.md)
</dt> <dt>

[<span data-ttu-id="9aa65-208">Registrieren eines Vorschau Handlers</span><span class="sxs-lookup"><span data-stu-id="9aa65-208">How to Register a Preview Handler</span></span>](how-to-register-a-preview-handler.md)
</dt> <dt>

[<span data-ttu-id="9aa65-209">Vorschau der handlerrichtlinien</span><span class="sxs-lookup"><span data-stu-id="9aa65-209">Preview Handler Guidelines</span></span>](preview-handler-guidelines.md)
</dt> </dl>

 

 
