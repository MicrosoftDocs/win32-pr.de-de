---
description: 'Dieses Thema ist wie folgt organisiert:'
title: Bewährte Methoden für Kontextmenü Handler und mehrere Verben
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 4D352ECB-6214-4f6e-A3E5-F79E154D090A
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: f8b47807c4647aec274e64dbcd137833d13e23cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104980216"
---
# <a name="best-practices-for-shortcut-menu-handlers-and-multiple-verbs"></a><span data-ttu-id="eaa09-103">Bewährte Methoden für Kontextmenü Handler und mehrere Verben</span><span class="sxs-lookup"><span data-stu-id="eaa09-103">Best Practices for Shortcut Menu Handlers and Multiple Verbs</span></span>

<span data-ttu-id="eaa09-104">Dieses Thema ist wie folgt organisiert:</span><span class="sxs-lookup"><span data-stu-id="eaa09-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="eaa09-105">Bewährte Methoden</span><span class="sxs-lookup"><span data-stu-id="eaa09-105">Best Practices</span></span>](#best-practices-for-shortcut-menu-handlers-and-multiple-verbs)
    -   [<span data-ttu-id="eaa09-106">Bewährte Methoden für Verb Implementierungen</span><span class="sxs-lookup"><span data-stu-id="eaa09-106">Best Practices for Verb Implementations</span></span>](#best-practices-for-verb-implementations)
-   [<span data-ttu-id="eaa09-107">Bewährte Methoden für Mehrfachauswahl Verben</span><span class="sxs-lookup"><span data-stu-id="eaa09-107">Best Practices for Multiple Selection Verbs</span></span>](#best-practices-for-multiple-selection-verbs)
    -   [<span data-ttu-id="eaa09-108">Heterogene Auswahl</span><span class="sxs-lookup"><span data-stu-id="eaa09-108">Heterogenous Selections</span></span>](#heterogenous-selections)
-   [<span data-ttu-id="eaa09-109">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="eaa09-109">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="eaa09-110">Bewährte Methoden</span><span class="sxs-lookup"><span data-stu-id="eaa09-110">Best Practices</span></span>

<span data-ttu-id="eaa09-111">Statisches Verb sind einfachste Verben, die implementiert werden können, und stellen umfassende Funktionen bereit.</span><span class="sxs-lookup"><span data-stu-id="eaa09-111">Static verb are simplest verbs to implement, and provide rich functionality.</span></span> <span data-ttu-id="eaa09-112">Wir empfehlen Ihnen dringend, ein Verb mit einer der statischen Verb-Methoden zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="eaa09-112">We strongly encourage you to implement a verb using one of the static verb methods.</span></span>

### <a name="best-practices-for-verb-implementations"></a><span data-ttu-id="eaa09-113">Bewährte Methoden für Verb Implementierungen</span><span class="sxs-lookup"><span data-stu-id="eaa09-113">Best Practices for Verb Implementations</span></span>

<span data-ttu-id="eaa09-114">Die folgende Liste stellt bewährte Methoden für Verb Implementierungen dar:</span><span class="sxs-lookup"><span data-stu-id="eaa09-114">The following list represents best practices for verb implementations:</span></span>

-   <span data-ttu-id="eaa09-115">Wählen Sie immer die einfachste Verb Methode aus, die Ihren Anforderungen entspricht.</span><span class="sxs-lookup"><span data-stu-id="eaa09-115">Always chose the simplest verb method that meets your needs.</span></span>
-   <span data-ttu-id="eaa09-116">Verwenden Sie nach Möglichkeit eine statische Verb-Methode.</span><span class="sxs-lookup"><span data-stu-id="eaa09-116">Use a static verb method, if possible.</span></span>
-   <span data-ttu-id="eaa09-117">Führen Sie keine ressourcenintensiven Vorgänge oder e/a-Vorgänge im UI-Thread aus.</span><span class="sxs-lookup"><span data-stu-id="eaa09-117">Do not perform resource-intensive operations or I/O on the UI thread.</span></span> <span data-ttu-id="eaa09-118">Sowohl [**ishellextinit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) als auch [**IContextMenu:: querycontextmenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) müssen bei der Arbeit, die Sie ausführen, sehr konservativ sein.</span><span class="sxs-lookup"><span data-stu-id="eaa09-118">Both [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) need to be very conservative in the work they perform.</span></span> <span data-ttu-id="eaa09-119">[**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) muss in einem anderen Prozess ausgeführt werden, oder Sie müssen einen neuen Thread erstellen, um die Blockierung des Aufrufers zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="eaa09-119">[**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) must be performed in another process, or you must create a new thread to avoid blocking the caller.</span></span>
-   <span data-ttu-id="eaa09-120">Präfix Verben mit dem ISV-Namen (Independent Software Vendor) wie folgt: `ISVName.verb` .</span><span class="sxs-lookup"><span data-stu-id="eaa09-120">Prefix verbs with the independent software vendor (ISV) name as follows, `ISVName.verb`.</span></span> <span data-ttu-id="eaa09-121">Die Verwendung von nicht qualifizierten Namen kann zu Konflikten mit mehreren ISVs führen, die denselben Verb Namen ausgewählt haben.</span><span class="sxs-lookup"><span data-stu-id="eaa09-121">Using unqualified names can result in collisions with multiple ISVs that chose the same verb name.</span></span>
-   <span data-ttu-id="eaa09-122">Verwenden Sie immer eine anwendungsspezifische ProgID.</span><span class="sxs-lookup"><span data-stu-id="eaa09-122">Always use an application-specific ProgID.</span></span> <span data-ttu-id="eaa09-123">Da einige Elementtypen diese Zuordnung nicht verwenden, ist es erforderlich, dass Hersteller eindeutige Namen besitzen.</span><span class="sxs-lookup"><span data-stu-id="eaa09-123">Because some item types do not use this mapping, there is a need for vendor-unique names.</span></span>
-   <span data-ttu-id="eaa09-124">Positionieren Sie die Benutzeroberfläche relativ zur aufrufenden Methode, aber nicht in einem aufrufenden Thread.</span><span class="sxs-lookup"><span data-stu-id="eaa09-124">Position the UI relative to the invoking method, but do not run on an invoker thread.</span></span>
-   <span data-ttu-id="eaa09-125">Akzeptieren Sie den Rückgabewert **S \_ OK** für kanonische Verben, die an die [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) -Methode übermittelt wurden.</span><span class="sxs-lookup"><span data-stu-id="eaa09-125">Do not accept the return value **S\_OK** for canonical verbs passed to the [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) method.</span></span> <span data-ttu-id="eaa09-126">Andernfalls tritt ein Fehler auf, wenn die wirkliche Verb-Implementierung aufgerufen wird, und es wird ein Fehlercode für kanonische Verben zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="eaa09-126">Doing so causes a failure for the real verb implementation to be invoked, and returns a failure code for canonical verbs.</span></span> <span data-ttu-id="eaa09-127">Wenn Sie kanonische Verben nicht unterstützen, wird ein Fehler zurückgegeben, wenn ein HIWORD-Wert (lpverb) ungleich 0 (null) gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="eaa09-127">If you do not support canonical verbs, then return failure when a nonzero HIWORD(lpVerb) value is encountered.</span></span>
-   <span data-ttu-id="eaa09-128">Vermeiden Sie die Verwendung von **rundll32.exe** als Host für Ihr Verb.</span><span class="sxs-lookup"><span data-stu-id="eaa09-128">Avoid the use of **rundll32.exe** as the host for your verb.</span></span>
-   <span data-ttu-id="eaa09-129">Geben Sie bei der Implementierung von [**IContextMenu:: querycontextmenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) die Anzahl der Verben zurück, die dem Menü über den **HRESULT** -Wert mithilfe des resultfromshort-Makros hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="eaa09-129">When implementing [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) be sure to return the number of verbs that have been added to the menu through the **HRESULT** value using the ResultFromShort macro.</span></span>
-   <span data-ttu-id="eaa09-130">Wenn Sie sich für einen der folgenden Registrierungsschlüssel Einträge registrieren, gehen Sie vorsichtig vor, und stellen Sie sicher, dass Sie den Handler für den spezifischsten Typ registrieren, um die möglicherweise unbeabsichtigten Folgen zu verringern:</span><span class="sxs-lookup"><span data-stu-id="eaa09-130">If you register on one of the following registry key entries, then exercise caution and be sure to register your handler on the most specific type to reduce the possibly unintended consequences:</span></span>
    -   <span data-ttu-id="eaa09-131">\**HKEY \_ \_Klassen \\ Stamm _ \**</span><span class="sxs-lookup"><span data-stu-id="eaa09-131">\**HKEY\_CLASSES\_ROOT\\\** _</span></span>
    -   <span data-ttu-id="eaa09-132">_ *HKEY- \_ Klassen \_ root \\ AllFilesystemObjects*\*</span><span class="sxs-lookup"><span data-stu-id="eaa09-132">_ *HKEY\_CLASSES\_ROOT\\AllFileSystemObjects*\*</span></span>
    -   <span data-ttu-id="eaa09-133">**Stamm Ordner der HKEY- \_ Klassen \_ \\**</span><span class="sxs-lookup"><span data-stu-id="eaa09-133">**HKEY\_CLASSES\_ROOT\\Folder**</span></span>
    -   <span data-ttu-id="eaa09-134">**Stammverzeichnis der HKEY- \_ Klassen \_ \\**</span><span class="sxs-lookup"><span data-stu-id="eaa09-134">**HKEY\_CLASSES\_ROOT\\Directory**</span></span>
-   <span data-ttu-id="eaa09-135">Legen Sie den Schlüssel " **maychangedefaultmenu** " nur fest, wenn Sie davon ausgehen, dass Sie möglicherweise das Standard Verb im Kontextmenü ändern müssen.</span><span class="sxs-lookup"><span data-stu-id="eaa09-135">Set the **MayChangeDefaultMenu** key only if you anticipate that you might need to change the default verb in the shortcut menu.</span></span> <span data-ttu-id="eaa09-136">Wenn Ihr Handler das Standardverb nicht ändert, sollten Sie diesen Schlüssel nicht festlegen, da dies dazu führt, dass das System die dll unnötig lädt.</span><span class="sxs-lookup"><span data-stu-id="eaa09-136">If your handler does not change the default verb, then you should not set this key because doing so causes the system to load your DLL unnecessarily.</span></span>
-   <span data-ttu-id="eaa09-137">Minimieren Sie die Arbeit, die Sie in [**ishellextinit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize)ausführen.</span><span class="sxs-lookup"><span data-stu-id="eaa09-137">Minimize the work you perform in [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize).</span></span> <span data-ttu-id="eaa09-138">Erfassen Sie bei Kontextmenü Handlern das an **ishellextinit:: Initialize** übergebenen Datenobjekt, und verarbeiten Sie es anschließend in [**IContextMenu:: querycontextmenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu)oder [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand).</span><span class="sxs-lookup"><span data-stu-id="eaa09-138">For shortcut menu handlers, capture the data object passed to **IShellExtInit::Initialize**, and then process it in [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu), or [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand).</span></span>

## <a name="best-practices-for-multiple-selection-verbs"></a><span data-ttu-id="eaa09-139">Bewährte Methoden für Mehrfachauswahl Verben</span><span class="sxs-lookup"><span data-stu-id="eaa09-139">Best Practices for Multiple Selection Verbs</span></span>

<span data-ttu-id="eaa09-140">Da die Anzahl der Elemente in einem Szenario mit Mehrfachauswahl Verb groß sein kann, ist es wichtig, dass Sie die Auswirkungen der Verb-Implementierungen auf die Leistung abwägen.</span><span class="sxs-lookup"><span data-stu-id="eaa09-140">Because the number of items in a multi-selection verb scenario can be large, it is important that you consider the performance implications of your verb implementations.</span></span> <span data-ttu-id="eaa09-141">Wenn ein Benutzer beispielsweise \* in einem Bereich, der eine große Anzahl von Elementen enthält, nach "" sucht und dann auf **Alle auswählen** und mit der rechten Maustaste klickt, wird das Verb mit einer Auswahl angezeigt, die Tausende Elemente enthalten kann.</span><span class="sxs-lookup"><span data-stu-id="eaa09-141">For example, when a user searches for "\*" over a scope that includes large numbers of items, and then clicks **Select All** and right-clicks, the verb is presented with a selection that can have thousands of items in it.</span></span> <span data-ttu-id="eaa09-142">Demzufolge sollten Verben nur das erste Element in der Auswahl und die Gesamtanzahl der Elemente berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="eaa09-142">As a result, verbs should only consider the first item in the selection, and the overall item count.</span></span> <span data-ttu-id="eaa09-143">Das erste Element wird entweder als Element am oberen Rand der Ansicht oder als Element definiert, auf das der Benutzer zuerst mit der rechten Maustaste geklickt hat.</span><span class="sxs-lookup"><span data-stu-id="eaa09-143">The first item is defined as either the item at the top of the view, or the item that the user first right-clicked.</span></span>

<span data-ttu-id="eaa09-144">In Windows 7 und höher ist die Anzahl der an ein Verb weiter gegebenen Elemente auf 16 begrenzt, wenn ein Kontextmenü abgefragt wird.</span><span class="sxs-lookup"><span data-stu-id="eaa09-144">In Windows 7 and later, the number of items passed to a verb is limited to 16 when a shortcut menu is queried.</span></span> <span data-ttu-id="eaa09-145">Das Verb wird dann neu erstellt und mit der vollständigen Auswahl erneut initialisiert, wenn dieses Verb aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="eaa09-145">The verb is then re-created and re-initialized with the full selection when that verb is invoked.</span></span>

<span data-ttu-id="eaa09-146">In einigen Fällen ist es sinnvoll, eine kleine Anzahl fester Elemente in Erwägung zu nehmen.</span><span class="sxs-lookup"><span data-stu-id="eaa09-146">It is appropriate in some cases to consider a small number of fixed items.</span></span> <span data-ttu-id="eaa09-147">Beispielsweise ist es angebracht, dass ein Verb "diff" nur die ersten beiden Elemente berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="eaa09-147">For example, it is appropriate for a "diff" verb to consider only the first two items.</span></span> <span data-ttu-id="eaa09-148">Im Allgemeinen müssen Sie nicht jedes Element in der Auswahl testen, um festzustellen, ob es sich um einen bestimmten Typ handelt, oder alle Elemente in der Auswahl für die zugehörigen Eigenschaften Abfragen.</span><span class="sxs-lookup"><span data-stu-id="eaa09-148">Generally, you need not test every item in the selection to see if it is a certain type, or query every item in the selection for its properties.</span></span> <span data-ttu-id="eaa09-149">Suchen Sie anstelle des ersten Elements, und entscheiden Sie, ob es angebracht ist, Ihr Verb hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="eaa09-149">Look rather at the first item and decide if it is appropriate to add your verb.</span></span>

### <a name="heterogenous-selections"></a><span data-ttu-id="eaa09-150">Heterogene Auswahl</span><span class="sxs-lookup"><span data-stu-id="eaa09-150">Heterogenous Selections</span></span>

<span data-ttu-id="eaa09-151">Optimistische Verben werden automatisch im Mehrfachauswahl Fall hinzugefügt, wobei angenommen wird, dass nicht geprüfte Elemente vom Verb verarbeitet werden können.</span><span class="sxs-lookup"><span data-stu-id="eaa09-151">Optimistic verbs are automatically added in the multi-selection case, assuming that uninspected items can be handled by the verb.</span></span> <span data-ttu-id="eaa09-152">Im Gegensatz dazu werden pessimistische Verben nicht hinzugefügt, wenn die Auswahl nicht geprüfte Elemente enthält. Sie werden nur in Fällen hinzugefügt, in denen die Anzahl der Elemente gering ist.</span><span class="sxs-lookup"><span data-stu-id="eaa09-152">In contrast, pessimistic verbs are not added when the selection contains uninspected items, and are only added in cases where the number of items is small.</span></span>

<span data-ttu-id="eaa09-153">Die Verben des Spielstils sollten optimistisch sein und die Elemente, die nicht behandelt werden, im Hintergrund überspringen.</span><span class="sxs-lookup"><span data-stu-id="eaa09-153">Player style verbs should be optimistic, and silently skip the items that are not handled.</span></span> <span data-ttu-id="eaa09-154">Wenn ein Fehler beim Bearbeiten von Elementen zu Datenverlust oder Verwirrung führen kann, sollte das Verb Benutzer vor Elementen warnen, die nicht verarbeitet werden können.</span><span class="sxs-lookup"><span data-stu-id="eaa09-154">If a failure to act on items can cause data loss or confusion, then the verb should warn users about items that cannot be processed.</span></span> <span data-ttu-id="eaa09-155">Ein "Backup"-Verb sollte beispielsweise angeben, dass einige Elemente nicht gesichert werden konnten.</span><span class="sxs-lookup"><span data-stu-id="eaa09-155">For example a "backup" verb should indicate that some items could not be backed up.</span></span>

## <a name="related-topics"></a><span data-ttu-id="eaa09-156">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="eaa09-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="eaa09-157">Auswählen eines statischen oder dynamischen Verbs für das Kontextmenü</span><span class="sxs-lookup"><span data-stu-id="eaa09-157">Choosing a Static or Dynamic Verb for your Shortcut Menu</span></span>](shortcut-choose-method.md)
</dt> <dt>

[<span data-ttu-id="eaa09-158">Erstellen von Kontextmenü Handlern</span><span class="sxs-lookup"><span data-stu-id="eaa09-158">Creating Shortcut Menu Handlers</span></span>](context-menu-handlers.md)
</dt> <dt>

[<span data-ttu-id="eaa09-159">Anpassen eines Kontextmenüs mithilfe dynamischer Verben</span><span class="sxs-lookup"><span data-stu-id="eaa09-159">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](shortcut-menu-using-dynamic-verbs.md)
</dt> <dt>

[<span data-ttu-id="eaa09-160">Kontextmenüs und Kontextmenü Handler</span><span class="sxs-lookup"><span data-stu-id="eaa09-160">Shortcut (Context) Menus and Shortcut Menu Handlers</span></span>](context-menu.md)
</dt> <dt>

[<span data-ttu-id="eaa09-161">Verben und Dateizuordnungen</span><span class="sxs-lookup"><span data-stu-id="eaa09-161">Verbs and File Associations</span></span>](fa-verbs.md)
</dt> <dt>

[<span data-ttu-id="eaa09-162">Verweis auf das Kontextmenü</span><span class="sxs-lookup"><span data-stu-id="eaa09-162">Shortcut Menu Reference</span></span>](context-menu-reference.md)
</dt> </dl>

 

 



