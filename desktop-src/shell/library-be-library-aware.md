---
description: In diesem Thema werden einige Aspekte beschrieben, die bei der Verwendung von Bibliotheken in Ihrem Programm zu beachten sind.
ms.assetid: 40ACC8F6-1416-4390-A8D7-8F924DC2C2FE
title: Verwenden von Bibliotheken in Ihrem Programm
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2812a66b148d9bd16fc3951efab64a4d37afaaff
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104350358"
---
# <a name="using-libraries-in-your-program"></a><span data-ttu-id="f7096-103">Verwenden von Bibliotheken in Ihrem Programm</span><span class="sxs-lookup"><span data-stu-id="f7096-103">Using Libraries in your Program</span></span>

<span data-ttu-id="f7096-104">In diesem Thema werden einige Aspekte beschrieben, die bei der Verwendung von Bibliotheken in Ihrem Programm zu beachten sind.</span><span class="sxs-lookup"><span data-stu-id="f7096-104">This topic describes some of the things to consider when using libraries in your program.</span></span>

<span data-ttu-id="f7096-105">In diesem Thema:</span><span class="sxs-lookup"><span data-stu-id="f7096-105">In this topic:</span></span>

-   [<span data-ttu-id="f7096-106">Übersicht über die Bibliothek Programmierung</span><span class="sxs-lookup"><span data-stu-id="f7096-106">Library programming overview</span></span>](#library-programming-overview)
-   [<span data-ttu-id="f7096-107">Programmieren mit Bibliotheken</span><span class="sxs-lookup"><span data-stu-id="f7096-107">Programming with Libraries</span></span>](#programming-with-libraries)
    -   [<span data-ttu-id="f7096-108">Verschieben von bekannten Ordnern in Bibliotheken</span><span class="sxs-lookup"><span data-stu-id="f7096-108">Moving from Known Folders to Libraries</span></span>](#moving-from-known-folders-to-libraries)
    -   [<span data-ttu-id="f7096-109">Heim Netzgruppe und freigegebene Bibliotheken</span><span class="sxs-lookup"><span data-stu-id="f7096-109">HomeGroup and shared libraries</span></span>](#homegroup-and-shared-libraries)
-   [<span data-ttu-id="f7096-110">Verwenden eines allgemeinen Datei Dialogfelds mit Bibliotheken</span><span class="sxs-lookup"><span data-stu-id="f7096-110">Using a common file dialog box with libraries</span></span>](#using-a-common-file-dialog-box-with-libraries)
-   [<span data-ttu-id="f7096-111">Aktivieren der Bibliotheks Auswahl über die Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="f7096-111">Enabling library selection from the user interface</span></span>](#enabling-library-selection-from-the-user-interface)
-   [<span data-ttu-id="f7096-112">Zugreifen auf Bibliotheksinhalte in einem Programm</span><span class="sxs-lookup"><span data-stu-id="f7096-112">Accessing library content in a program</span></span>](#accessing-library-content-in-a-program)
    -   [<span data-ttu-id="f7096-113">Zugreifen auf Bibliotheksinhalte mit der ishelllibrary-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="f7096-113">Accessing library content with the IShellLibrary interface</span></span>](#accessing-library-content-with-the-ishelllibrary-interface)
    -   [<span data-ttu-id="f7096-114">Zugreifen auf Bibliotheksinhalte mit den Shell-APIs</span><span class="sxs-lookup"><span data-stu-id="f7096-114">Accessing library content with the Shell APIs</span></span>](#accessing-library-content-with-the-shell-apis)
-   [<span data-ttu-id="f7096-115">Speichern von Benutzer Inhalt in einer Bibliothek</span><span class="sxs-lookup"><span data-stu-id="f7096-115">Saving user content in a library</span></span>](#saving-user-content-in-a-library)
-   [<span data-ttu-id="f7096-116">Unterstützen von Drag & Drop-Vorgängen in einer Bibliothek</span><span class="sxs-lookup"><span data-stu-id="f7096-116">Supporting drag-and-drop operations in a library</span></span>](#supporting-drag-and-drop-operations-in-a-library)
-   [<span data-ttu-id="f7096-117">Synchronisierung mit einer Bibliothek</span><span class="sxs-lookup"><span data-stu-id="f7096-117">Keeping in sync with a library</span></span>](#keeping-in-sync-with-a-library)
    -   [<span data-ttu-id="f7096-118">Massenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="f7096-118">Bulk Update</span></span>](#bulk-update)
    -   [<span data-ttu-id="f7096-119">Shell-API-Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="f7096-119">Shell API Notification</span></span>](#shell-api-notification)
    -   [<span data-ttu-id="f7096-120">Dateisystem-API-Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="f7096-120">File-system API Notification</span></span>](#file-system-api-notification)
-   [<span data-ttu-id="f7096-121">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="f7096-121">Related topics</span></span>](#related-topics)

## <a name="library-programming-overview"></a><span data-ttu-id="f7096-122">Übersicht über die Bibliothek Programmierung</span><span class="sxs-lookup"><span data-stu-id="f7096-122">Library programming overview</span></span>

<span data-ttu-id="f7096-123">Mithilfe von Bibliotheken können Benutzer ihren dateibasierten Inhalt auf eine Weise organisieren, die für Sie von Bedeutung ist und nicht durch die Organisation des Dateisystems eingeschränkt ist.</span><span class="sxs-lookup"><span data-stu-id="f7096-123">Libraries enable users to organize their file-based content in a way that is meaningful to them and not limited by the organization of the file system.</span></span> <span data-ttu-id="f7096-124">Wenn Ihr Programmbibliotheken unterstützt, ermöglicht es dem Benutzer, seinen Inhalt auf eine Weise zu finden, die für Sie sinnvoll ist, während eine Benutzeroberfläche angezeigt wird, die mit der Windows 7-Benutzeroberfläche konsistent ist.</span><span class="sxs-lookup"><span data-stu-id="f7096-124">When your program supports libraries, it allows the user to find their content in a way that makes sense to them while presenting a user interface that is consistent with the Windows 7 user experience.</span></span> <span data-ttu-id="f7096-125">Bibliotheken erleichtern es Ihrem Programm außerdem, dateibasierten Inhalt zu finden, der in anderen Ordnern oder auf unterschiedlichen Computern gespeichert ist.</span><span class="sxs-lookup"><span data-stu-id="f7096-125">Libraries also make it easier for your program to locate file-based content that is stored in different folders or on different machines.</span></span>

<span data-ttu-id="f7096-126">In den Themen in diesem Abschnitt wird beschrieben, wie Sie Ihrem Programm Bibliotheks Unterstützung hinzufügen und die neuen Funktionen nutzen können, die von Bibliotheken angeboten werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-126">The topics in this section describe how you can add library support to your program and take advantage of the new capabilities that libraries offer.</span></span> <span data-ttu-id="f7096-127">Windows 7 bietet standardmäßig einige dieser Unterstützung.</span><span class="sxs-lookup"><span data-stu-id="f7096-127">Windows 7 provides some of this support by default.</span></span> <span data-ttu-id="f7096-128">Wenn das Programm die üblichen Datei Dialogfelder, die derzeit verwendet werden, nicht ändert, ist es möglicherweise sehr wenig zusätzliche Programmierung erforderlich, um Bibliotheken zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="f7096-128">If your program does not modify the common file dialog boxes that it currently uses, it might require very little additional programming to support libraries.</span></span>

<span data-ttu-id="f7096-129">In diesem Abschnitt werden einige der wichtigsten Funktionen beschrieben, die von Bibliotheken bereitgestellt werden, sowie deren Unterstützung in Ihrem Programm.</span><span class="sxs-lookup"><span data-stu-id="f7096-129">This section describes some of the key features that libraries provide and how to support them in your program.</span></span> <span data-ttu-id="f7096-130">Mit diesen Informationen können Sie entscheiden, welche Features die beste Benutzer Leistung Ihres Programms bieten.</span><span class="sxs-lookup"><span data-stu-id="f7096-130">With this information, you can decide which features will provide the best user experience from your program.</span></span> <span data-ttu-id="f7096-131">Wenn das Programm die allgemeinen Datei Dialogfelder anpasst, können Sie anhand der Informationen in diesem Abschnitt festlegen, wie die neuen allgemeinen Datei Dialogfelder verwendet werden sollen, um Bibliotheken zu verwenden und entsprechende Funktionen in Windows 7 bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="f7096-131">If your program customizes the common file dialog boxes, the information in this section can help you determine how to use the new common file dialog boxes to use libraries and provide equivalent functionality in Windows 7.</span></span>

## <a name="programming-with-libraries"></a><span data-ttu-id="f7096-132">Programmieren mit Bibliotheken</span><span class="sxs-lookup"><span data-stu-id="f7096-132">Programming with Libraries</span></span>

<span data-ttu-id="f7096-133">Das Windows Shell-Programmiermodell beschreibt, wie ein Programm mit Windows Shell-Programmier Objekten interagiert.</span><span class="sxs-lookup"><span data-stu-id="f7096-133">The Windows Shell programming model describes how a program interacts with Windows Shell programming objects.</span></span> <span data-ttu-id="f7096-134">Dateisystem Objekte, z. b. Dateien und Verzeichnisse, werden von Windows-shellobjekten dargestellt, nicht jedoch alle Windows Shell-Objekte werden durch das Dateisystem dargestellt.</span><span class="sxs-lookup"><span data-stu-id="f7096-134">While file-system objects, such as files and directories, are represented by Windows Shell objects, not all Windows Shell objects are represented by the file-system.</span></span> <span data-ttu-id="f7096-135">Bibliotheken sind z. b. Windows-Shellobjekte, die keine Dateisystem Entsprechung aufweisen.</span><span class="sxs-lookup"><span data-stu-id="f7096-135">Libraries, for example, are Windows Shell objects that do not have a file-system equivalent.</span></span> <span data-ttu-id="f7096-136">Durch die Verwendung von Windows-shellobjekten in Ihrem Programm kann Ihr Programm auf alle Shellobjekte und nicht nur auf Dateisystem Objekte zugreifen.</span><span class="sxs-lookup"><span data-stu-id="f7096-136">Using Windows Shell objects in your program enables your program to access all Shell objects and not just file-system objects.</span></span>

<span data-ttu-id="f7096-137">Um die besten Ergebnisse zu erzielen, verwendet das Programm die [**shellbibliotheks-API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) , um mit Bibliotheken zu interagieren und auf ihren Inhalt zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="f7096-137">For the best results, your program would use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) to interact with libraries and access their contents.</span></span> <span data-ttu-id="f7096-138">Bibliotheken, die Dateisystem Elemente enthalten, wie z. b. Ordner und Dateien, sind Bibliotheken keine Dateisystem Elemente.</span><span class="sxs-lookup"><span data-stu-id="f7096-138">While libraries contain file-system items such as folders and files, libraries are not file-system items.</span></span> <span data-ttu-id="f7096-139">Daher können Dateisystem-APIs nicht für den Zugriff auf Bibliotheksfunktionen oder Bibliotheksinhalte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-139">As such, file-system APIs cannot be used to access library features or library contents.</span></span>

<span data-ttu-id="f7096-140">Wenn Sie über ein vorhandenes Programm verfügen, das zurzeit viele Dateisystem-APIs verwendet, kann Ihr Programm weiterhin Bibliotheksfunktionen nutzen.</span><span class="sxs-lookup"><span data-stu-id="f7096-140">If you have an existing program that currently uses many file-system APIs, your program can still take advantage of library features.</span></span> <span data-ttu-id="f7096-141">Die [**shellbibliotheks-API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) kann Dateisystem Verweise auf die Elemente bereitstellen, die in einer Bibliothek gefunden werden, und diese Dateisystem Verweise, wie z. b. der Dateiname und der Pfad, können an die vorhandenen Dateisystem-APIs in Ihrem vorhandenen Programm übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-141">The [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) can provide file-system references to the items that are found in a library and these file-system references, such as the file name and path, can be passed to the existing file-system APIs that are in your existing program.</span></span>

### <a name="moving-from-known-folders-to-libraries"></a><span data-ttu-id="f7096-142">Verschieben von bekannten Ordnern in Bibliotheken</span><span class="sxs-lookup"><span data-stu-id="f7096-142">Moving from Known Folders to Libraries</span></span>

<span data-ttu-id="f7096-143">Vor Windows 7 war es üblich, einen bekannten Ordner (z. b. den Ordner "eigene Dateien") als Standardordner in Datei speichern oder Datei Öffnungs Vorgängen zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="f7096-143">Before Windows 7 it was common to use a known folder, such as the My Documents folder, as the default folder in file save or file open operations.</span></span> <span data-ttu-id="f7096-144">In Windows 7 sollte die entsprechende Bibliothek verwendet werden, damit der Benutzer in Ihrem Programm genauso wie bei anderen Windows 7-Programmen wie Windows Explorer arbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="f7096-144">In Windows 7, the corresponding library should be used so the user will have the same experience in your program as they would with other Windows 7 programs, such as the Windows Explorer.</span></span>

<span data-ttu-id="f7096-145">Wenn Sie zurzeit die Windows-Shell-API in Ihrem Programm verwenden, ist das Hinzufügen von Bibliotheks Unterstützung unkompliziert.</span><span class="sxs-lookup"><span data-stu-id="f7096-145">If you are currently using the Windows Shell API in your program, adding library support is straightforward.</span></span> <span data-ttu-id="f7096-146">Wenn Sie z. b. zurzeit die Funktion " [**shgetknownfolderitem**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) " aufrufen, um den Speicherort des Ordners "eigene Dateien" abzurufen, können Sie den Wert von " [**KNOWNFOLDERID**](knownfolderid.md) " des bekannten Ordners "eigene Dokumente" durch den Wert " **KNOWNFOLDERID** " der entsprechenden Bibliothek ersetzen.</span><span class="sxs-lookup"><span data-stu-id="f7096-146">For example, if you currently call the [**SHGetKnownFolderItem**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) function to get the location of the My Documents folder, you can replace the [**KNOWNFOLDERID**](knownfolderid.md) value of the My Documents known folder with the **KNOWNFOLDERID** value of the corresponding library.</span></span>

<span data-ttu-id="f7096-147">In der folgenden Tabelle wird die Beziehung zwischen den [**KNOWNFOLDERID**](knownfolderid.md) -Werten bekannter Ordner und dem **KNOWNFOLDERID** -Wert der entsprechenden Bibliothek in Windows 7 angezeigt.</span><span class="sxs-lookup"><span data-stu-id="f7096-147">The following table shows the relationship between the [**KNOWNFOLDERID**](knownfolderid.md) values of known folders and the **KNOWNFOLDERID** value of the corresponding library in Windows 7.</span></span> 

| <span data-ttu-id="f7096-148">KNOWNFOLDERID-Werte bekannter Ordner</span><span class="sxs-lookup"><span data-stu-id="f7096-148">Known Folder KNOWNFOLDERID values</span></span> | <span data-ttu-id="f7096-149">Bibliothek KNOWNFOLDERID-Werte</span><span class="sxs-lookup"><span data-stu-id="f7096-149">Library KNOWNFOLDERID values</span></span> |
|-----------------------------------|------------------------------|
| <span data-ttu-id="f7096-150">Folderid- \_ Dokumente</span><span class="sxs-lookup"><span data-stu-id="f7096-150">FOLDERID\_Documents</span></span>               | <span data-ttu-id="f7096-151">Folderid \_ documentslibrary</span><span class="sxs-lookup"><span data-stu-id="f7096-151">FOLDERID\_DocumentsLibrary</span></span>   |
| <span data-ttu-id="f7096-152">Folderid- \_ Bilder</span><span class="sxs-lookup"><span data-stu-id="f7096-152">FOLDERID\_Pictures</span></span>                | <span data-ttu-id="f7096-153">Folderid \_ pictureslibrary</span><span class="sxs-lookup"><span data-stu-id="f7096-153">FOLDERID\_PicturesLibrary</span></span>    |
| <span data-ttu-id="f7096-154">Folderid- \_ Musik</span><span class="sxs-lookup"><span data-stu-id="f7096-154">FOLDERID\_Music</span></span>                   | <span data-ttu-id="f7096-155">Folderid \_ musiclibrary</span><span class="sxs-lookup"><span data-stu-id="f7096-155">FOLDERID\_MusicLibrary</span></span>       |
| <span data-ttu-id="f7096-156">Folderid \_ recordebug</span><span class="sxs-lookup"><span data-stu-id="f7096-156">FOLDERID\_RecordedTV</span></span>              | <span data-ttu-id="f7096-157">Folderid \_ recordedtvlibrary</span><span class="sxs-lookup"><span data-stu-id="f7096-157">FOLDERID\_RecordedTVLibrary</span></span>  |



 

### <a name="homegroup-and-shared-libraries"></a><span data-ttu-id="f7096-158">Heim Netzgruppe und freigegebene Bibliotheken</span><span class="sxs-lookup"><span data-stu-id="f7096-158">HomeGroup and shared libraries</span></span>

<span data-ttu-id="f7096-159">Das Hinzufügen von Bibliotheks Unterstützung zu Ihrem Programm ermöglicht die Unterstützung für freigegebene Bibliotheken in einer Heim Netzgruppe.</span><span class="sxs-lookup"><span data-stu-id="f7096-159">Adding library support to your program will enable support for shared libraries in a HomeGroup.</span></span> <span data-ttu-id="f7096-160">Die Heim Netzgruppe wird durch Ihren [**KNOWNFOLDERID**](knownfolderid.md) -Wert von [**folderid \_ HomeGroup**](knownfolderid.md)identifiziert.</span><span class="sxs-lookup"><span data-stu-id="f7096-160">The HomeGroup is identified by its [**KNOWNFOLDERID**](knownfolderid.md) value of [**FOLDERID\_HomeGroup**](knownfolderid.md).</span></span> <span data-ttu-id="f7096-161">Das Programm kann den privaten oder freigegebenen Standard Speicherort des Benutzers ermitteln, indem er den Wert von [**defaultsavefoldertype**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) beim Aufrufen der [**ishelllibrary:: getdefaultsavefolder**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) -Methode festlegt.</span><span class="sxs-lookup"><span data-stu-id="f7096-161">Your program can find identify the user's private or shared default save location by setting the [**DEFAULTSAVEFOLDERTYPE**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) value in the call to [**IShellLibrary::GetDefaultSaveFolder**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) method.</span></span>

## <a name="using-a-common-file-dialog-box-with-libraries"></a><span data-ttu-id="f7096-162">Verwenden eines allgemeinen Datei Dialogfelds mit Bibliotheken</span><span class="sxs-lookup"><span data-stu-id="f7096-162">Using a common file dialog box with libraries</span></span>

<span data-ttu-id="f7096-163">Mithilfe eines allgemeinen Datei Dialogfelds mit Bibliotheken wurde das Dialogfeld "common file" (Datei) für die Unterstützung von Bibliotheken in Windows 7 aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="f7096-163">Using a common file dialog box with libraries The common file dialog box has been updated to support libraries in Windows 7.</span></span> <span data-ttu-id="f7096-164">In der folgenden Abbildung wird gezeigt, wie das Dialogfeld für die gemeinsame Datei einem Benutzer in Windows 7 angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="f7096-164">The following illustration shows how the common file dialog box appears to a user in Windows 7.</span></span>

![Screenshot des Dialog Felds "allgemeine Datei" mit Bibliotheken](images/libraries-commonfiledialog.png)

<span data-ttu-id="f7096-166">In Windows 7 wird die neue Windows 7-Version des Dialog Felds automatisch angezeigt, wenn in Ihrem Programm derzeit ein gemeinsames Datei Dialogfeld angezeigt wird und die Dialogfeld Vorlage nicht geändert wird.</span><span class="sxs-lookup"><span data-stu-id="f7096-166">In Windows 7, if your program currently displays a common file dialog box and does not change the dialog box template or hook any of its events, it will display the new Windows 7 version of the dialog box automatically.</span></span> <span data-ttu-id="f7096-167">Insbesondere beim Aufrufen der Dialogfeld Funktion für allgemeine Dateien müssen die **lpfnhook**-, **HINSTANCE**-, **lptemplatename** -Member der [**OpenFileName**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) -Struktur **null** sein, und die **ofn \_ ENABLEHOOK** -und **ofn \_ ENABLETEMPLATE** -Flags müssen klar sein.</span><span class="sxs-lookup"><span data-stu-id="f7096-167">Specifically, in the call to the common file dialog box function, the **lpfnHook**, **hInstance**, **lpTemplatename** members of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must be **NULL** and the **OFN\_ENABLEHOOK** and **OFN\_ENABLETEMPLATE** flags must be clear.</span></span>

<span data-ttu-id="f7096-168">In Windows 7 ersetzen die [**ifiledialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-bezogenen Schnittstellen die Funktionen der allgemeinen Datei Dialogfelder, die in früheren Versionen von Windows verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="f7096-168">In Windows 7, the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces replace the common file dialog box functions that were used in earlier versions of Windows.</span></span> <span data-ttu-id="f7096-169">Die früheren Funktionen für Datei Dialogfelder werden in Windows 7 weiterhin unterstützt, bieten aber nicht die komplette Windows 7-Benutzerfunktion, und Sie unterstützen keine Bibliotheken.</span><span class="sxs-lookup"><span data-stu-id="f7096-169">The earlier common file dialog box functions are still supported in Windows 7 but they do not provide the complete Windows 7 user experience and they do not support libraries.</span></span> <span data-ttu-id="f7096-170">Zu den neuen Funktionen, die von den **ifiledialog**-bezogenen Schnittstellen unterstützt werden, gehören:</span><span class="sxs-lookup"><span data-stu-id="f7096-170">Some of the new features supported by the **IFileDialog**-related interfaces include:</span></span>

-   <span data-ttu-id="f7096-171">Der Benutzer kann auf die Dateieigenschaften zugreifen, die vom Windows-Explorer von Windows 7 unterstützt werden, um die Dateien zu suchen und auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="f7096-171">The user can access the file properties supported by the Windows 7 Windows Explorer to search and select the files.</span></span>
-   <span data-ttu-id="f7096-172">Das Programm kann Schnittstellen und Methoden aus der Shell-Namespace-API verwenden, um mit den Elementen zu arbeiten.</span><span class="sxs-lookup"><span data-stu-id="f7096-172">The program can use interfaces and methods from the Shell namespace API to work with the items.</span></span>
-   <span data-ttu-id="f7096-173">Das Programm kann ein Daten gesteuerungsanpassungs Modell anstelle eines Ressourcen Datei gesteuerten Anpassungs Modells verwenden, um den Dialogfeldern der allgemeinen Datei neue Steuerelemente hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="f7096-173">The program can use a data-driven customization model instead of a resource-file-driven customization model to add new controls to the common file dialog boxes.</span></span>

<span data-ttu-id="f7096-174">Sie sollten die [**ifiledialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-bezogenen Schnittstellen verwenden, wenn Folgendes der Fall ist:</span><span class="sxs-lookup"><span data-stu-id="f7096-174">You should use the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces when:</span></span>

-   <span data-ttu-id="f7096-175">Sie müssen das Dialogfeld "allgemeine Datei" für Ihr Programm in Windows 7 anpassen.</span><span class="sxs-lookup"><span data-stu-id="f7096-175">you need to customize the common file dialog box for your program in Windows 7.</span></span> <span data-ttu-id="f7096-176">Dies ermöglicht es Ihrem Programm, mit Bibliotheken zu arbeiten und die Anpassung des Dialog Felds zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="f7096-176">This will allow your program to work with libraries and support customizing your dialog box.</span></span>
-   <span data-ttu-id="f7096-177">Sie möchten, dass der Benutzer in der Lage ist, mehrere Dateien aus einem allgemeinen Datei Dialogfeld auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="f7096-177">you want the user to be able to select multiple files from a common file dialog box.</span></span> <span data-ttu-id="f7096-178">Dadurch wird sichergestellt, dass Sie die richtigen Pfade zum ausgewählten Objekt erhalten, da eine Bibliothek Inhalte enthalten kann, die in unterschiedlichen Ordnern gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="f7096-178">This will ensure you get the correct paths to the selected object because a library can have contents that are stored in different folders.</span></span>

<span data-ttu-id="f7096-179">Weitere Informationen zu den [**ifiledialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-bezogenen Schnittstellen finden Sie unter:</span><span class="sxs-lookup"><span data-stu-id="f7096-179">For more information on the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces, see:</span></span>

-   [<span data-ttu-id="f7096-180">**Ifiledialog**</span><span class="sxs-lookup"><span data-stu-id="f7096-180">**IFileDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)
-   [<span data-ttu-id="f7096-181">**IFileOpenDialog**</span><span class="sxs-lookup"><span data-stu-id="f7096-181">**IFileOpenDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)
-   [<span data-ttu-id="f7096-182">**IFileSaveDialog**</span><span class="sxs-lookup"><span data-stu-id="f7096-182">**IFileSaveDialog**</span></span>](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ifilesavedialog)
-   [<span data-ttu-id="f7096-183">**IFileDialogCustomize**</span><span class="sxs-lookup"><span data-stu-id="f7096-183">**IFileDialogCustomize**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)
-   [<span data-ttu-id="f7096-184">**IFileDialogEvents**</span><span class="sxs-lookup"><span data-stu-id="f7096-184">**IFileDialogEvents**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogevents)
-   [<span data-ttu-id="f7096-185">**Ifiledialogcontrolevents**</span><span class="sxs-lookup"><span data-stu-id="f7096-185">**IFileDialogControlEvents**</span></span>](/windows/desktop/api/Shobjidl/nn-shobjidl-ifiledialogcontrolevents)

## <a name="enabling-library-selection-from-the-user-interface"></a><span data-ttu-id="f7096-186">Aktivieren der Bibliotheks Auswahl über die Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="f7096-186">Enabling library selection from the user interface</span></span>

<span data-ttu-id="f7096-187">Wenn das Programm es dem Benutzer ermöglicht, einen Ordner (z. b. für Import-oder Exportfunktionen) in Windows 7 auszuwählen, sollte er es dem Benutzer ermöglichen, auch eine Bibliothek auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="f7096-187">If your program allows the user to select a folder, such as for import or export functions, in Windows 7, it should allow the user to select a library as well.</span></span> <span data-ttu-id="f7096-188">Mit der [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) -Schnittstelle und der [**shbrowsforfolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) -Funktion können Benutzer eine Bibliothek auswählen, wenn Sie aufgefordert werden, einen Ordner auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="f7096-188">The [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface and [**SHBrowseForFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) function allow the user to select a library when prompted to select a folder.</span></span> <span data-ttu-id="f7096-189">Die **IFileOpenDialog** -Schnittstelle wird von der **shbrowseforfolder** -Funktion bevorzugt, da **IFileOpenDialog** die Benutzeroberfläche von Windows 7 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="f7096-189">The **IFileOpenDialog** interface is preferred over the **SHBrowseForFolder** function because **IFileOpenDialog** supports the Windows 7 user interface.</span></span>

<span data-ttu-id="f7096-190">Um Benutzern das Auswählen von Ordnern bei Verwendung der [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) -Schnittstelle zu gestatten, nennen Sie "SetOptions" mit dem \_ festgelegten "Fos pickfolders"-Flag, und stellen Sie sicher, dass das Fos- \_ Flag für "</span><span class="sxs-lookup"><span data-stu-id="f7096-190">To allow users to select folders when using the [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface, call SetOptions with the FOS\_PICKFOLDERS flag set and make sure the FOS\_FORCEFILESYSTEM flag is clear.</span></span>


```C++
FILEOPENDIALOGOPTIONS fileOptions;

hr = fileOpenDialogBox->GetOptions(&fileOptions);
fileOptions = fileOptions | FOS_PICKFOLDERS | ~FOS_FORCEFILESYSTEM;
hr = fileOpenDialogBox->SetOptions(fileOptions);
```



<span data-ttu-id="f7096-191">Damit Benutzerordner auswählen können, wenn Sie die shbrowseforfolder-Funktion aufrufen, legen Sie im ulflags-Member der [**Browseinfo**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) -Struktur das BIF \_ usenewui-Flag fest, und deaktivieren Sie das Flag BIF-Rückrufe \_ .</span><span class="sxs-lookup"><span data-stu-id="f7096-191">To allow users to select folders when calling the SHBrowseForFolder function, in the ulFlags member of the [**BROWSEINFO**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) structure, set the BIF\_USENEWUI flag and clear the BIF\_RETURNONLYFSDIRS flag.</span></span>


```C++
BROWSEINFO    browseInfo;
browseInfo.ulFlags = BIF_USENEWUI | ~BIF_RETURNONLYFSDIRS;
// Set other member values
pidl = SHBrowseForFolder(&browseInfo);
```



## <a name="accessing-library-content-in-a-program"></a><span data-ttu-id="f7096-192">Zugreifen auf Bibliotheksinhalte in einem Programm</span><span class="sxs-lookup"><span data-stu-id="f7096-192">Accessing library content in a program</span></span>

<span data-ttu-id="f7096-193">Um auf den Inhalt einer Bibliothek zuzugreifen, müssen Sie die Windows-Shell-API verwenden.</span><span class="sxs-lookup"><span data-stu-id="f7096-193">To access the contents of a library, you must use the Windows Shell API.</span></span> <span data-ttu-id="f7096-194">Funktionen der Dateisystem-API können nicht für den Zugriff auf Bibliotheksinhalte verwendet werden, da es sich bei Bibliotheken nicht um Dateisystem Objekte handelt.</span><span class="sxs-lookup"><span data-stu-id="f7096-194">Functions of the file-system API cannot be used to access library contents because libraries are not file-system objects.</span></span> <span data-ttu-id="f7096-195">Wenn das Programm einen benutzerdefinierten Dateibrowser verwendet, der auf der Dateisystem-API basiert, ist es nicht möglich, Bibliotheken zu durchsuchen oder auf Bibliotheksinhalte zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="f7096-195">If your program uses a custom file browser that is based on the file-system API, it will not be able to browse libraries or access library content.</span></span>

<span data-ttu-id="f7096-196">In diesem Abschnitt wird beschrieben, wie Sie auf Bibliotheksinhalte zugreifen können, sodass Sie die beste Methode zum Aktualisieren des Programms für die Arbeit mit Bibliotheken auswählen können.</span><span class="sxs-lookup"><span data-stu-id="f7096-196">This section describes how you can access library content so that you can select the best way to update your program to work with libraries.</span></span>

### <a name="accessing-library-content-with-the-ishelllibrary-interface"></a><span data-ttu-id="f7096-197">Zugreifen auf Bibliotheksinhalte mit der ishelllibrary-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="f7096-197">Accessing library content with the IShellLibrary interface</span></span>

<span data-ttu-id="f7096-198">Die einfachste Möglichkeit für ein Programm, auf Bibliotheksinhalte zuzugreifen, ist die Verwendung der [**shellbibliotheks-API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary).</span><span class="sxs-lookup"><span data-stu-id="f7096-198">The easiest way for a program to access library content is to use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary).</span></span> <span data-ttu-id="f7096-199">Wenn Sie an einem Programm arbeiten, das die Dateisystem-API verwendet, kann die **shellbibliotheks-API** die Dateisystem Ordner einer Bibliothek zurückgeben, wodurch die Änderungen an Ihrem vorhandenen Programmcode minimiert werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-199">If you are working on a program that uses the file-system API, the **Shell Library API** can return the file-system folders of a library, which minimizes the change to your existing program code.</span></span>


```C++
IShellLibrary *picturesLibrary;

hr = SHLoadLibraryFromKnownFolder(FOLDERID_PicturesLibrary, 
                                  STGM_READ, 
                                  IID_PPV_ARGS(&picturesLibrary));

// picturesLibrary now points to the user's picture library
    
IShellItemArray *pictureFolders; 

hr = pslLibrary->GetFolders(LFF_FORCEFILESYSTEM, IID_PPV_ARGS(&pictureFolders));

// pictureFolders now contains an array of Shell items that
// represent the folders found in the user's pictures library
```



### <a name="accessing-library-content-with-the-shell-apis"></a><span data-ttu-id="f7096-200">Zugreifen auf Bibliotheksinhalte mit den Shell-APIs</span><span class="sxs-lookup"><span data-stu-id="f7096-200">Accessing library content with the Shell APIs</span></span>

<span data-ttu-id="f7096-201">Da die Bibliotheksobjekte Teil des shellprogrammierungs Modells sind, können Sie mit anderen Windows Shell-APIs verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-201">Because the library objects are part of the Shell programming model, they can be used with other Windows Shell APIs.</span></span> <span data-ttu-id="f7096-202">Beispielsweise können Sie die [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) -und [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle in Ihrem Programm zusammen mit zugehörigen Hilfsfunktionen verwenden, um auf die Inhalte einer Bibliothek auf die gleiche Weise zuzugreifen, wie Sie Ordner und Ordnerinhalte auflisten, um auf Inhalte mit den Dateisystem-APIs zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="f7096-202">For example you can use the [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) and [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interfaces in your program, along with related helper functions, to access the contents of a library in the same way as you would enumerate folders and folder contents to access content with the file system APIs.</span></span>

<span data-ttu-id="f7096-203">Die Windows-Shell-APIs unterstützen zwei enumerationsmodi, um auf den Inhalt einer Bibliothek zuzugreifen:</span><span class="sxs-lookup"><span data-stu-id="f7096-203">The Windows Shell APIs support two enumeration modes to access the contents of a library:</span></span>

-   <span data-ttu-id="f7096-204">**Enumeration durchsuchen**</span><span class="sxs-lookup"><span data-stu-id="f7096-204">**Browse enumeration**</span></span>

    <span data-ttu-id="f7096-205">Browse Enumeration ist der standardenumerationsmodus und listet den Inhalt eines Bibliotheks Ordners auf.</span><span class="sxs-lookup"><span data-stu-id="f7096-205">Browse enumeration is the default enumeration mode and enumerates the contents of a library folder.</span></span> <span data-ttu-id="f7096-206">Löschen Sie das shcontf-Navigations Aufzählungs \_ \_ Flag, um diesen Modus zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="f7096-206">Clear the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

-   <span data-ttu-id="f7096-207">**Navigationenumeration**</span><span class="sxs-lookup"><span data-stu-id="f7096-207">**Navigation enumeration**</span></span>

    <span data-ttu-id="f7096-208">Navigations Enumeration listet die Bibliotheks Ordner auf.</span><span class="sxs-lookup"><span data-stu-id="f7096-208">Navigation enumeration enumerates the library folders.</span></span> <span data-ttu-id="f7096-209">Legen Sie das shcontf- \_ Navigations- \_ enum-Flag auf diesen Modus fest.</span><span class="sxs-lookup"><span data-stu-id="f7096-209">Set the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

<span data-ttu-id="f7096-210">Wenn das Programm ein benutzerdefiniertes Struktur Steuerelement verwendet, um die Ordner des Benutzers zu durchsuchen, erhalten Sie durch das Auflisten der Ordner im Navigations-enumerationsmodus eine Liste der Ordner einer Bibliothek, die der Art und Weise entspricht, wie der Windows-Explorer Ordner in Windows 7 auflistet.</span><span class="sxs-lookup"><span data-stu-id="f7096-210">If your program uses a custom tree control to navigate the user's folders, enumerating the folders in the navigation enumeration mode will give you a list of a library's folders that is consistent with how the Windows Explorer enumerates folders in Windows 7.</span></span>

<span data-ttu-id="f7096-211">Beispiele dazu, wie diese Funktionen in einem Programm verwendet werden, finden Sie im shellstorage-Beispiel im Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="f7096-211">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="saving-user-content-in-a-library"></a><span data-ttu-id="f7096-212">Speichern von Benutzer Inhalt in einer Bibliothek</span><span class="sxs-lookup"><span data-stu-id="f7096-212">Saving user content in a library</span></span>

<span data-ttu-id="f7096-213">Das Programm kann Benutzerinhalte in einer Bibliothek und in einem Ordner in der Bibliothek speichern.</span><span class="sxs-lookup"><span data-stu-id="f7096-213">Your program can save user content to a library as well as to a folder in the library.</span></span> <span data-ttu-id="f7096-214">Ebenso kann der Benutzer in einem bestimmten Ordner in einer Bibliothek speichern oder einfach in der Bibliothek speichern.</span><span class="sxs-lookup"><span data-stu-id="f7096-214">Likewise, the user can save to a specific folder in a library or they can just save to the library.</span></span>

<span data-ttu-id="f7096-215">Jede Bibliothek verfügt über einen Ordner, der als Standard Speicherort festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="f7096-215">Every library has a folder that is designated as the default save location.</span></span> <span data-ttu-id="f7096-216">Der Standard Speicherort wird definiert, wenn die Bibliothek erstellt wird. Allerdings kann der Benutzer den Standard Speicherort erneut als einen beliebigen Ordner in der Bibliothek zuweisen.</span><span class="sxs-lookup"><span data-stu-id="f7096-216">The default save location is defined when the library is created; however the user can reassign the default save location to be any folder in the library.</span></span> <span data-ttu-id="f7096-217">Der Benutzer muss zwar keinen Standard Speicherort konfigurieren, er kann jedoch geändert werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-217">While the user does not need to configure a default save location, they have the option to change it.</span></span> <span data-ttu-id="f7096-218">Wenn der Benutzer den Ordner löscht, der derzeit als Standard Speicherort festgelegt ist, wird der nächste Ordner in der Bibliothek von der Bibliothek automatisch als Standard Speicherort konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="f7096-218">If the user deletes the folder that is currently set as the default save location, the library will automatically configure the next folder in the library to be the default save location.</span></span>

<span data-ttu-id="f7096-219">Es gibt mehrere Möglichkeiten, wie Sie Benutzerinhalte in einer Bibliothek speichern können.</span><span class="sxs-lookup"><span data-stu-id="f7096-219">There are several ways you can save user content to a library.</span></span>

-   <span data-ttu-id="f7096-220">**Shell-API**</span><span class="sxs-lookup"><span data-stu-id="f7096-220">**Shell API**</span></span>

    <span data-ttu-id="f7096-221">Wenn Sie das shellprogrammierungs Modell verwenden und ein shellelement, das von einem [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem)-, IStorage-oder IStream-Objekt dargestellt wird, in einem Bibliotheksobjekt speichern, wird das shellelement automatisch am Standard Speicherort der Bibliothek gespeichert.</span><span class="sxs-lookup"><span data-stu-id="f7096-221">If you are using the Shell programming model and save a Shell item, as represented by an [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem), IStorage, or IStream, to a library object, the Shell item will be automatically stored in the default save location of the library.</span></span>

-   <span data-ttu-id="f7096-222">**Dateisystem-API**</span><span class="sxs-lookup"><span data-stu-id="f7096-222">**File-system API**</span></span>

    <span data-ttu-id="f7096-223">Wenn Sie über ein vorhandenes Programm verfügen, das viele Dateisystem-API-Aufrufe verwendet, können Sie einen Pfad zu dem Ordner erhalten, der als Standard Speicherort der Bibliothek definiert ist.</span><span class="sxs-lookup"><span data-stu-id="f7096-223">If you have an existing program that uses many file-system API calls, you can get a path to the folder that is defined as the library's default save location.</span></span> <span data-ttu-id="f7096-224">Der Ordner Pfad kann dann an eine Dateisystem-API weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-224">The folder path can then be passed to a file-system API.</span></span>

<span data-ttu-id="f7096-225">Beispiele dazu, wie diese Funktionen in einem Programm verwendet werden, finden Sie im shellstorage-Beispiel im Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="f7096-225">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="supporting-drag-and-drop-operations-in-a-library"></a><span data-ttu-id="f7096-226">Unterstützen von Drag & Drop-Vorgängen in einer Bibliothek</span><span class="sxs-lookup"><span data-stu-id="f7096-226">Supporting drag-and-drop operations in a library</span></span>

<span data-ttu-id="f7096-227">Wenn das Programm Drag & amp; Drop-Aktionen unterstützt, sollten diese aktualisiert werden, um die korrekte Bibliotheks Interaktion zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="f7096-227">If your program supports drag-and-drop actions, those should be updated to support the correct library interaction.</span></span> <span data-ttu-id="f7096-228">Wenn eine Datei in einer Bibliothek abgelegt wird, sollte die gelöschte Datei am Standard Speicherort gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-228">If a file is dropped into a library, the dropped file should be saved in the default save location.</span></span> <span data-ttu-id="f7096-229">Wenn ein Ordner in einer Bibliothek abgelegt wird, sollte der gelöschte Ordner der Bibliothek als neuer Ordner hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-229">If a folder is dropped into a library, the dropped folder should be added as a new folder to the library.</span></span> <span data-ttu-id="f7096-230">Wenn eine Datei in einem vorhandenen Ordner abgelegt wird, der nicht der Standard Speicherort ist, muss die Datei dem ausgewählten Ordner hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-230">If a file is dropped into an existing folder that is not the default save location, the file should be added to the selected folder.</span></span>

<span data-ttu-id="f7096-231">Beispiele zum Hinzufügen von Bibliotheks Unterstützung für Ihre Programme Drag & amp; Drop-Funktionen finden Sie im Beispiel shelllibrarycommandline im Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="f7096-231">For examples of how to add library support for your programs drag-and-drop functionality, see the ShellLibraryCommandLine sample in the Windows SDK.</span></span>

## <a name="keeping-in-sync-with-a-library"></a><span data-ttu-id="f7096-232">Synchronisierung mit einer Bibliothek</span><span class="sxs-lookup"><span data-stu-id="f7096-232">Keeping in sync with a library</span></span>

<span data-ttu-id="f7096-233">In diesem Thema wird beschrieben, wie ein Programm den Inhalt einer Bibliothek auf dem neuesten standhalten kann.</span><span class="sxs-lookup"><span data-stu-id="f7096-233">This topic describes how a program can keep its view of a library's content up-to-date.</span></span>

### <a name="bulk-update"></a><span data-ttu-id="f7096-234">Massenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="f7096-234">Bulk Update</span></span>

<span data-ttu-id="f7096-235">Da der Benutzer die Ordner einer Bibliothek interaktiv ändern kann, wenn das Programm nicht ausgeführt wird, sollte das Programm " [**shresolvelibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) " aufrufen, wenn es beginnt, Änderungen an der Bibliothek zu ermitteln und zu speichern.</span><span class="sxs-lookup"><span data-stu-id="f7096-235">Because the user can modify the folders of a library interactively when your program is not running, your program should call [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) when it starts to discover and store any changes to the library.</span></span> <span data-ttu-id="f7096-236">Die Shell-API stellt die Funktion " **shresolvelibrary** " bereit, mit der ein Programm den aktuellen Inhalt einer Bibliothek und die aktuellen Speicherorte aller Ordner, die in der Bibliothek enthalten sein können, erhalten.</span><span class="sxs-lookup"><span data-stu-id="f7096-236">The Shell API provides the **SHResolveLibrary** function to enable a program to get the current contents of a library and the current locations of any folders the library might contain.</span></span>

<span data-ttu-id="f7096-237">Beachten Sie, dass " [**shresolvelibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) " eine blockierende Funktion ist, die abhängig von den Änderungen in der Bibliothek viel Zeit in Anspruch nehmen kann.</span><span class="sxs-lookup"><span data-stu-id="f7096-237">Note that [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) is a blocking function that could take a long time to return depending on what has changed in the library.</span></span> <span data-ttu-id="f7096-238">Daher sollte es nicht von einem UI-Thread aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-238">As such, it should not be called from a UI thread.</span></span>

<span data-ttu-id="f7096-239">Nachdem das Programm auf den neuesten Stand gebracht wurde, kann es sich für Änderungs Benachrichtigungen registrieren, um eine aktuelle Ansicht zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="f7096-239">After the program has been brought up-to-date, it can then register for change notifications to maintain a current view.</span></span>

### <a name="shell-api-notification"></a><span data-ttu-id="f7096-240">Shell-API-Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="f7096-240">Shell API Notification</span></span>

<span data-ttu-id="f7096-241">Die Windows-Shell-API stellt die [**shchangenotifyregister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) -Funktion bereit. Dies ist die bevorzugte Methode für nicht-Dienst Prozesse, um über eine Änderung in der Bibliothek benachrichtigt zu werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-241">The Windows Shell API provides the [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) function, which is the preferred way for non-service processes to be notified of a change in the library.</span></span>

<span data-ttu-id="f7096-242">Um Änderungen an Elementen in einer Bibliothek mithilfe der Windows-Shell-API zu erkennen, rufen Sie [**shchangenotifyregister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) auf, um das Programm für Benachrichtigungen über Änderungen an Elementen in einem Bibliotheks Ordner zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="f7096-242">To detect changes to items within a library using the Windows Shell API, call [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) to register your program for notifications of changes to items in a library folder.</span></span> <span data-ttu-id="f7096-243">Diese Funktion kann Ihr Programm Benachrichtigen, wenn eine Änderung in einer Bibliothek oder nur in einer bestimmten Bibliothek vorliegt.</span><span class="sxs-lookup"><span data-stu-id="f7096-243">This function can notify your program if there is a change in any library or just in a specific library.</span></span> <span data-ttu-id="f7096-244">Benachrichtigungen werden sofort gesendet, wenn eine Bibliothek geändert wird.</span><span class="sxs-lookup"><span data-stu-id="f7096-244">Notifications are sent immediately when a library is changed.</span></span>

### <a name="file-system-api-notification"></a><span data-ttu-id="f7096-245">Dateisystem-API-Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="f7096-245">File-system API Notification</span></span>

<span data-ttu-id="f7096-246">Dateisystem Benachrichtigungen müssen bei Dienst Vorgängen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-246">File system notifications must be used in service processes.</span></span>

<span data-ttu-id="f7096-247">Zum Erkennen von Änderungen an Elementen in einer Bibliothek mithilfe der Dateisystem-API können Sie die Ordner in der Bibliothek auflisten und [**findfirstchangenotififür**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) jeden zu überwachenden Ordner aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="f7096-247">To detect changes to items in a library using the file-system API, enumerate the folders in the library and call [**FindFirstChangeNotification**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) for each folder to monitor.</span></span> <span data-ttu-id="f7096-248">Das Programm empfängt eine Benachrichtigung, wenn sich ein überwachter Ordner ändert.</span><span class="sxs-lookup"><span data-stu-id="f7096-248">Your program will receive notification when a monitored folder changes.</span></span> <span data-ttu-id="f7096-249">Um die Datei mit den Dateien zu suchen, die sich im Ordner geändert haben, rufen Sie "read [**directorychangesw**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw)" auf.</span><span class="sxs-lookup"><span data-stu-id="f7096-249">To find the specific file of files that changed in the folder, call [**ReadDirectoryChangesW**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw).</span></span> <span data-ttu-id="f7096-250">Um Änderungen in der Bibliotheks Beschreibungsdatei zu erkennen, überwachen Sie den Ordner, in dem Sie enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="f7096-250">To detect changes in the library description file, monitor the folder that contains it.</span></span> <span data-ttu-id="f7096-251">Die Bibliotheks Beschreibungsdatei befindet sich im Ordner [**folderid \_ Libraries**](knownfolderid.md) .</span><span class="sxs-lookup"><span data-stu-id="f7096-251">The library description file can be found in the [**FOLDERID\_Libraries**](knownfolderid.md) folder.</span></span> <span data-ttu-id="f7096-252">Die Bibliotheks Beschreibungsdatei sollte jedoch nicht geöffnet oder geändert werden.</span><span class="sxs-lookup"><span data-stu-id="f7096-252">The library description file, however, should not be opened or modified.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f7096-253">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="f7096-253">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f7096-254">Informationen zu Bibliotheken</span><span class="sxs-lookup"><span data-stu-id="f7096-254">About Libraries</span></span>](library-leverage-to-manage-folders.md)
</dt> <dt>

[<span data-ttu-id="f7096-255">**Ishelllibrary**</span><span class="sxs-lookup"><span data-stu-id="f7096-255">**IShellLibrary**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary)
</dt> <dt>

[<span data-ttu-id="f7096-256">Shelllinks</span><span class="sxs-lookup"><span data-stu-id="f7096-256">Shell Links</span></span>](./links.md)
</dt> <dt>

[<span data-ttu-id="f7096-257">Bekannte Ordner</span><span class="sxs-lookup"><span data-stu-id="f7096-257">Known Folders</span></span>](known-folders.md)
</dt> <dt>

[<span data-ttu-id="f7096-258">Bibliotheks Beschreibungs Schema</span><span class="sxs-lookup"><span data-stu-id="f7096-258">Library Description Schema</span></span>](library-schema-entry.md)
</dt> <dt>

[<span data-ttu-id="f7096-259">**IID \_ PPV-Argumente \_**</span><span class="sxs-lookup"><span data-stu-id="f7096-259">**IID\_PPV\_ARGS**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-iid_ppv_args)
</dt> </dl>

 

 
