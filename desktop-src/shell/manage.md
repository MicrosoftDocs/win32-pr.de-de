---
description: Die Shell bietet eine Reihe von Methoden zum Verwalten von Dateisystemen.
ms.assetid: d9ffda6f-adc0-44a3-b410-e23bf5f4f165
title: Verwalten des Dateisystems
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 404b456ce1f26c128e6c3fc3bc9971672378a0d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104342429"
---
# <a name="managing-the-file-system"></a><span data-ttu-id="9d8b9-103">Verwalten des Dateisystems</span><span class="sxs-lookup"><span data-stu-id="9d8b9-103">Managing the File System</span></span>

<span data-ttu-id="9d8b9-104">Die Shell bietet eine Reihe von Methoden zum Verwalten von Dateisystemen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-104">The Shell provides a number of ways to manage file systems.</span></span> <span data-ttu-id="9d8b9-105">Die Shell stellt eine Funktion, " [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa)", bereit, die es einer Anwendung ermöglicht, Dateien Programm gesteuert zu verschieben, zu kopieren, umzubenennen und zu löschen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-105">The Shell provides a function, [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa), that allows an application to programmatically move, copy, rename, and delete files.</span></span> <span data-ttu-id="9d8b9-106">Die Shell unterstützt auch einige zusätzliche Dateiverwaltungsfunktionen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-106">The Shell also supports some additional file management capabilities.</span></span>

-   <span data-ttu-id="9d8b9-107">HTML-Dokumente können mit verwandten Dateien, z. b. Grafikdateien oder Stylesheets, *verbunden* werden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-107">HTML documents can be *connected* to related files, such as graphics files or style sheets.</span></span> <span data-ttu-id="9d8b9-108">Wenn das Dokument verschoben oder kopiert wird, werden die verbundenen Dateien auch automatisch verschoben oder kopiert.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-108">When the document is moved or copied, the connected files are automatically moved or copied as well.</span></span>
-   <span data-ttu-id="9d8b9-109">Für Systeme, die für mehr als einen Benutzer verfügbar sind, können Dateien pro Benutzer verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-109">For systems that are available to more than one user, files can be managed on a per-user basis.</span></span> <span data-ttu-id="9d8b9-110">Benutzer haben einfachen Zugriff auf Ihre Datendateien, jedoch nicht auf Dateien, die anderen Benutzern angehören.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-110">Users have easy access to their data files, but not to files belonging to other users.</span></span>
-   <span data-ttu-id="9d8b9-111">Wenn Dokument Dateien hinzugefügt oder geändert werden, können Sie der Liste der zuletzt geöffneten Dokumente der Shell hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-111">If document files are added or modified, they can be added to the Shell's list of recent documents.</span></span> <span data-ttu-id="9d8b9-112">Wenn der Benutzer im Startmenü auf den Befehl **Dokumente** klickt, wird eine Liste mit Links zu den Dokumenten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-112">When the user clicks the **Documents** command on the Start menu, a list of links to the documents appears.</span></span>

<span data-ttu-id="9d8b9-113">In diesem Dokument wird erläutert, wie diese Technologien zur Dateiverwaltung funktionieren.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-113">This document discusses how these file management technologies work.</span></span> <span data-ttu-id="9d8b9-114">Anschließend wird erläutert, wie die Shell zum Verschieben, kopieren, umbenennen und Löschen von Dateien und zum Verwalten von Objekten im Papierkorb verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-114">It then outlines how to use the Shell to move, copy, rename, and delete files, and how to manage objects in the Recycle Bin.</span></span>

-   [<span data-ttu-id="9d8b9-115">Dateiverwaltung pro Benutzer</span><span class="sxs-lookup"><span data-stu-id="9d8b9-115">Per-User File Management</span></span>](#per-user-file-management)
-   [<span data-ttu-id="9d8b9-116">Ordner "eigene Dokumente" und "eigene Bilder"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-116">My Documents and My Pictures Folders</span></span>](#my-documents-and-my-pictures-folders)
-   [<span data-ttu-id="9d8b9-117">Verbundene Dateien</span><span class="sxs-lookup"><span data-stu-id="9d8b9-117">Connected Files</span></span>](#connected-files)
-   [<span data-ttu-id="9d8b9-118">Verschieben, kopieren, umbenennen und Löschen von Dateien</span><span class="sxs-lookup"><span data-stu-id="9d8b9-118">Moving, Copying, Renaming, and Deleting Files</span></span>](#moving-copying-renaming-and-deleting-files)
    -   [<span data-ttu-id="9d8b9-119">Benachrichtigen der Shell</span><span class="sxs-lookup"><span data-stu-id="9d8b9-119">Notifying the Shell</span></span>](#notifying-the-shell)
-   [<span data-ttu-id="9d8b9-120">Einfaches Beispiel für die Verwaltung von Dateien mit SHFileOperation</span><span class="sxs-lookup"><span data-stu-id="9d8b9-120">Simple Example of Managing Files with SHFileOperation</span></span>](#simple-example-of-managing-files-with-shfileoperation)
-   [<span data-ttu-id="9d8b9-121">Hinzufügen von Dateien zur Liste der zuletzt geöffneten Dokumente in der Shell</span><span class="sxs-lookup"><span data-stu-id="9d8b9-121">Adding Files to the Shell's List of Recent Documents</span></span>](#adding-files-to-the-shells-list-of-recent-documents)

## <a name="per-user-file-management"></a><span data-ttu-id="9d8b9-122">Per-User Dateiverwaltung</span><span class="sxs-lookup"><span data-stu-id="9d8b9-122">Per-User File Management</span></span>

<span data-ttu-id="9d8b9-123">Mit der Windows 2000-Shell können Dateien einem bestimmten Benutzer zugeordnet werden, damit die Dateien von anderen Benutzern ausgeblendet werden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-123">The Windows 2000 Shell allows files to be associated with a particular user so the files remain hidden from other users.</span></span> <span data-ttu-id="9d8b9-124">Im Hinblick auf das Dateisystem werden die Dateien im Profilordner des Benutzers gespeichert, in der Regel C: \\ Dokumente und Einstellungen \\ *username* \\ auf Windows 2000-Systemen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-124">In terms of the file system, the files are stored under the user's profile folder, typically C:\\Documents and Settings\\*Username*\\ on Windows 2000 systems.</span></span> <span data-ttu-id="9d8b9-125">Diese Funktion ermöglicht es vielen Personen, denselben Computer zu verwenden, während der Datenschutz Ihrer Dateien von anderen Benutzern gewahrt bleibt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-125">This feature allows many individuals to use the same computer, while maintaining the privacy of their files from other users.</span></span> <span data-ttu-id="9d8b9-126">Verschiedene Benutzer können unterschiedliche Programme zur Verfügung stellen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-126">Different users can have different programs available.</span></span> <span data-ttu-id="9d8b9-127">Sie bietet außerdem eine einfache Möglichkeit für Administratoren und Anwendungen, wie z. b. Initialisierungsdateien (INI) oder Verknüpfungs Dateien (LNK-Dateien) zu speichern.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-127">It also provides a straightforward way for administrators and applications to store such things as initialization (.ini) or link (.lnk) files.</span></span> <span data-ttu-id="9d8b9-128">Anwendungen können auf diese Weise für jeden Benutzer einen anderen Zustand beibehalten und den jeweiligen Zustand bei Bedarf problemlos wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-128">Applications can thus preserve a different state for each user and easily recover that particular state when needed.</span></span> <span data-ttu-id="9d8b9-129">Es gibt auch einen Profilordner zum Speichern von Informationen, die allen Benutzern gemeinsam sind.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-129">There is also a profile folder for storing information that is common to all users.</span></span>

<span data-ttu-id="9d8b9-130">Da es nicht möglich ist, zu bestimmen, welcher Benutzer angemeldet ist und wo sich die Dateien befinden, sind die standardmäßigen benutzerspezifischen Ordner spezielle Ordner und werden durch eine [**CSIDL**](csidl.md)identifiziert.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-130">Because it is inconvenient to determine which user is logged in and where their files are located, the standard per-user folders are special folders and are identified by a [**CSIDL**](csidl.md).</span></span> <span data-ttu-id="9d8b9-131">Beispielsweise handelt es sich bei der CSIDL für den Ordner für benutzerspezifische Programmdateien um CSIDL- \_ Programme.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-131">For instance, the CSIDL for the per-user Program Files folder is CSIDL\_PROGRAMS.</span></span> <span data-ttu-id="9d8b9-132">Wenn Ihre Anwendung " [**shgetfolderlocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) " oder " [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) " mit einer der benutzerspezifischen CSIDLs aufruft, gibt die Funktion den Zeiger auf eine Element Bezeichner Liste (PIDL) oder einen Pfad zurück, der dem aktuell angemeldeten Benutzer entspricht.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-132">If your application calls [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) or [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with one of the per-user CSIDLs, the function returns the pointer to an item identifier list (PIDL) or path appropriate to the currently logged-in user.</span></span> <span data-ttu-id="9d8b9-133">Wenn die Anwendung den Pfad oder die PIDL des Profilordners abrufen muss, ist die zugehörige CSIDL **CSIDL- \_ Profil**.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-133">If your application needs to retrieve the path or PIDL of the profile folder, its CSIDL is **CSIDL\_PROFILE**.</span></span>

## <a name="my-documents-and-my-pictures-folders"></a><span data-ttu-id="9d8b9-134">Ordner "eigene Dokumente" und "eigene Bilder"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-134">My Documents and My Pictures Folders</span></span>

<span data-ttu-id="9d8b9-135">Eines der Standardsymbole, die auf dem Desktop gefunden werden, sind **meine Dokumente**.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-135">One of the standard icons found on the desktop is **My Documents**.</span></span> <span data-ttu-id="9d8b9-136">Wenn Sie diesen Ordner öffnen, enthält er die Dokument Dateien des aktuellen Benutzers.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-136">When you open this folder, it contains the current user's document files.</span></span> <span data-ttu-id="9d8b9-137">Die Desktop Instanz von "eigene Dokumente" ist ein virtueller Ordner – ein Alias zum Speicherort des Dateisystems, in dem die Dokumente des Benutzers physisch gespeichert werden –, der sich direkt unterhalb des Desktops in der Namespace Hierarchie befindet.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-137">The desktop instance of My Documents is a virtual folder—an alias to the file system location used to physically store the user's documents—located immediately below the desktop in the namespace hierarchy.</span></span>

<span data-ttu-id="9d8b9-138">Der Zweck der Ordner "eigene Dokumente" und "eigene Bilder" besteht darin, Benutzern eine einfache und sichere Möglichkeit zur Verfügung zu stellen, um den Benutzern den Zugriff auf Ihre Dokument-und Bilddateien auf einem System mit mehreren Benutzern zu ermöglichen</span><span class="sxs-lookup"><span data-stu-id="9d8b9-138">The purpose of the My Documents and My Pictures folders is to provide a straightforward and secure way for users to access their document and picture files on a system that might have multiple users.</span></span> <span data-ttu-id="9d8b9-139">Jedem Benutzer werden separate Dateisystem Ordner für seine Dateien zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-139">Each user is assigned separate file system folders for his or her files.</span></span> <span data-ttu-id="9d8b9-140">Beispielsweise ist der Speicherort des Ordners "Dokumente" eines Benutzers im Dateisystem in der Regel etwa "C: \\ Dokumente und Einstellungen \\ *username* \\ My Documents".</span><span class="sxs-lookup"><span data-stu-id="9d8b9-140">For example, the location of a user's documents folder in the file system is typically something like C:\\Documents and Settings\\*username*\\My Documents.</span></span> <span data-ttu-id="9d8b9-141">Es ist nicht erforderlich, dass Benutzer etwas über den physischen Speicherort Ihrer Dateisystem Ordner wissen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-141">There is no need for users to know anything about the physical location of their file system folders.</span></span> <span data-ttu-id="9d8b9-142">Der Zugriff auf die Dateien erfolgt einfach über das Symbol "eigene Dokumente".</span><span class="sxs-lookup"><span data-stu-id="9d8b9-142">They simply access their files through the My Documents icon.</span></span>

> [!Note]  
> <span data-ttu-id="9d8b9-143">Meine Dokumente ermöglicht einem Benutzer den Zugriff auf seine eigenen Dateien, jedoch nicht auf die eines anderen Benutzers.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-143">My Documents allows a user to access his or her own files but not those of any other user.</span></span> <span data-ttu-id="9d8b9-144">Wenn mehrere Benutzer denselben Computer verwenden, kann ein Administrator Benutzer aus dem Teil des Dateisystems, in dem die Dateien gespeichert werden, sperren.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-144">If multiple individuals use the same computer, an administrator can lock users out of the part of the file system where the actual files are stored.</span></span> <span data-ttu-id="9d8b9-145">Benutzer können daher mit ihren eigenen Dokumenten über den Ordner "eigene Dateien", aber nicht über Dokumente, die anderen Benutzern angehören, arbeiten.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-145">Users will thus be able to work on their own documents through the My Documents folder but not on documents that belong to any other users.</span></span>

 

<span data-ttu-id="9d8b9-146">Es ist in der Regel nicht erforderlich, dass eine Anwendung weiß, welcher Benutzer angemeldet ist oder wo sich der Ordner "eigene Dateien" des Benutzers befindet.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-146">There is usually no need for an application to know which user is logged in or where in the file system that user's My Documents folder is located.</span></span> <span data-ttu-id="9d8b9-147">Stattdessen kann die Anwendung die PIDL des Desktop Symbols "My Documents" abrufen, indem die [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) -Methode des Desktops aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-147">Instead, your application can retrieve the PIDL of the My Documents desktop icon by calling the desktop's [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method.</span></span> <span data-ttu-id="9d8b9-148">Der zum Identifizieren des Ordners "eigene Dokumente" verwendete namens Name ist kein Dateipfad, sondern: {450d8fba-ad25-11D0-98a8-0800361b1103}.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-148">The parsing name used to identify the My Documents folder is not a file path but rather ::{450d8fba-ad25-11d0-98a8-0800361b1103}.</span></span> <span data-ttu-id="9d8b9-149">Der Ausdruck in Klammern ist die Textform der GUID "eigene Dokumente".</span><span class="sxs-lookup"><span data-stu-id="9d8b9-149">The bracketed expression is the text form of the My Documents GUID.</span></span> <span data-ttu-id="9d8b9-150">Zum Abrufen der PIDL von "eigene Dokumente" sollte Ihre Anwendung z. b. diesen **IShellFolder::P arsedisplayname** verwenden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-150">For example, to retrieve the PIDL of My Documents, your application should use this call to **IShellFolder::ParseDisplayName**.</span></span>


```C++
hr = psfDeskTop->ParseDisplayName(NULL, 
                                  NULL, 
                                  L"::{450d8fba-ad25-11d0-98a8-0800361b1103}", 
                                  &chEaten, 
                                  &pidlDocFiles, 
                                  NULL);
```



<span data-ttu-id="9d8b9-151">Sobald Ihre Anwendung über die PIDL "eigene Dateien" verfügt, kann Sie den Ordner genauso behandeln wie einen normalen Dateisystem Ordner – das Aufzählen von Elementen, das Durchführen von Bindungen und das Ausführen beliebiger gültiger Ordner Vorgänge.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-151">Once your application has the My Documents PIDL, it can handle the folder just as it would a normal file system folder—enumerating items, parsing, binding, and performing any other valid folder operations.</span></span> <span data-ttu-id="9d8b9-152">Die Shell ordnet Änderungen in "eigene Dokumente" oder Unterordner den entsprechenden Dateisystem Ordnern automatisch zu.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-152">The Shell automatically maps changes in My Documents or its subfolders to the appropriate file system folders.</span></span>

<span data-ttu-id="9d8b9-153">Wenn Ihre Anwendung Zugriff auf den eigentlichen Dateisystem Ordner benötigt, der die Dokumente des aktuellen Benutzers enthält, übergeben Sie CSIDL \_ persönlich an [**shgetfolderlocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation).</span><span class="sxs-lookup"><span data-stu-id="9d8b9-153">If your application needs access to the actual file system folder that contains the current user's documents, pass CSIDL\_PERSONAL to [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation).</span></span> <span data-ttu-id="9d8b9-154">Die-Funktion gibt die PIDL des Dateisystem Ordners zurück, der im Ordner "eigene Dateien" des aktuellen Benutzers angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-154">The function returns the PIDL of the file system folder that is displayed in the current user's My Documents folder.</span></span>

## <a name="connected-files"></a><span data-ttu-id="9d8b9-155">Verbundene Dateien</span><span class="sxs-lookup"><span data-stu-id="9d8b9-155">Connected Files</span></span>

<span data-ttu-id="9d8b9-156">HTML-Dokumente verfügen häufig über eine Reihe von zugeordneten Grafikdateien, eine Stylesheet-Datei, mehrere Microsoft JScript-Dateien (kompatibel mit ECMA 262-Sprachspezifikation) usw.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-156">HTML documents often have a number of associated graphics files, a style sheet file, several Microsoft JScript (compatible with ECMA 262 language specification ) files, and so on.</span></span> <span data-ttu-id="9d8b9-157">Wenn Sie das primäre HTML-Dokument verschieben oder kopieren, sollten Sie auch die zugehörigen Dateien verschieben oder kopieren, um Unterbrechungen zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-157">When you move or copy the primary HTML document, you also usually want to move or copy its associated files to avoid breaking links.</span></span> <span data-ttu-id="9d8b9-158">Leider gab es bisher keine einfache Methode, um zu ermitteln, welche Dateien mit einem anderen HTML-Dokument verknüpft sind, außer durch die Analyse ihrer Inhalte.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-158">Unfortunately, there has been no easy way until now to determine which files are related to any given HTML document other than by analyzing their contents.</span></span> <span data-ttu-id="9d8b9-159">Um dieses Problem zu beheben, bietet Windows 2000 eine einfache Möglichkeit, ein primäres HTML-Dokument mit der zugehörigen Gruppe zugeordneter Dateien zu *verbinden* .</span><span class="sxs-lookup"><span data-stu-id="9d8b9-159">To alleviate this problem, Windows 2000 provides a simple way to *connect* a primary HTML document to its group of associated files.</span></span> <span data-ttu-id="9d8b9-160">Wenn die Dateiverbindung aktiviert ist und das Dokument verschoben oder kopiert wird, werden alle zugehörigen Dateien mit dem Dokument verknüpft.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-160">If file connection is enabled, when the document is moved or copied all its connected files go with it.</span></span>

<span data-ttu-id="9d8b9-161">Um eine Gruppe verbundener Dateien zu erstellen, muss das primäre Dokument die Dateinamenerweiterung ". htm" oder ". html" aufweisen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-161">To create a group of connected files, the primary document must have an .htm or .html file name extension.</span></span> <span data-ttu-id="9d8b9-162">Erstellen Sie einen Unterordner des übergeordneten Ordners des primären Dokuments.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-162">Create a subfolder of the primary document's parent folder.</span></span> <span data-ttu-id="9d8b9-163">Der Name des unter Ordners muss der Name des primären Dokuments sein, abzüglich der Erweiterung. htm oder. html, gefolgt von einer der unten aufgeführten Erweiterungen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-163">The subfolder's name must be the name of the primary document, minus the .htm or .html extension, followed by one of the extensions listed below.</span></span> <span data-ttu-id="9d8b9-164">Die am häufigsten verwendeten Erweiterungen sind ". Files" oder " \_ Files".</span><span class="sxs-lookup"><span data-stu-id="9d8b9-164">The most commonly used extensions are ".files" or "\_files".</span></span> <span data-ttu-id="9d8b9-165">Wenn das primäre Dokument beispielsweise MyDoc.htm benannt ist, wird durch Benennen des unter Ordners "MyDoc \_ Files" der Unterordner als Container für die verbundenen Dateien des Dokuments definiert.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-165">For instance, if the primary document is named MyDoc.htm, naming the subfolder "MyDoc\_files" defines the subfolder as the container for the document's connected files.</span></span> <span data-ttu-id="9d8b9-166">Wenn das primäre Dokument verschoben oder kopiert wird, werden auch der Unterordner und die zugehörigen Dateien verschoben oder kopiert.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-166">If the primary document is moved or copied, the subfolder and its files are moved or copied as well.</span></span>

<span data-ttu-id="9d8b9-167">Für einige Sprachen ist es möglich, eine lokalisierte Entsprechung von " \_ Files" zu verwenden, um einen Unterordner für verbundene Dateien zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-167">For some languages, it is possible to use a localized equivalent of "\_files" to create a subfolder for connected files.</span></span> <span data-ttu-id="9d8b9-168">In der folgenden Tabelle werden die gültigen Zeichen folgen aufgelistet, die an einen Dokumentnamen angehängt werden können, um einen Unterordner mit verbundenen Dateien zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-168">The following table lists the valid strings that can be appended to a document name to create a connected files subfolder.</span></span> <span data-ttu-id="9d8b9-169">Beachten Sie, dass einige dieser Zeichen folgen "-" als erstes Zeichen anstelle von " \_ " oder "." aufweisen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-169">Note that some of these strings have '-' as their first character rather than '\_' or '.'.</span></span>



|              |               |                 |               |
|--------------|---------------|-----------------|---------------|
| <span data-ttu-id="9d8b9-170">" \_ archivos"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-170">"\_archivos"</span></span> | <span data-ttu-id="9d8b9-171">" \_ Architekt"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-171">"\_arquivos"</span></span>  | <span data-ttu-id="9d8b9-172">" \_ bestanden"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-172">"\_bestanden"</span></span>   | <span data-ttu-id="9d8b9-173">" \_ bylos"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-173">"\_bylos"</span></span>     |
| <span data-ttu-id="9d8b9-174">"----Dateien"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-174">"-Dateien"</span></span>   | <span data-ttu-id="9d8b9-175">" \_ datoteke"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-175">"\_datoteke"</span></span>  | <span data-ttu-id="9d8b9-176">" \_ dosyalar"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-176">"\_dosyalar"</span></span>    | <span data-ttu-id="9d8b9-177">" \_ elemei"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-177">"\_elemei"</span></span>    |
| <span data-ttu-id="9d8b9-178">" \_ failid"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-178">"\_failid"</span></span>   | <span data-ttu-id="9d8b9-179">" \_ schlägt fehl"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-179">"\_fails"</span></span>     | <span data-ttu-id="9d8b9-180">" \_ fajlovi"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-180">"\_fajlovi"</span></span>     | <span data-ttu-id="9d8b9-181">" \_ fcheiros"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-181">"\_ficheiros"</span></span> |
| <span data-ttu-id="9d8b9-182">" \_ Filter"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-182">"\_fichiers"</span></span> | <span data-ttu-id="9d8b9-183">"-Filer"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-183">"-filer"</span></span>      | <span data-ttu-id="9d8b9-184">". Files"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-184">".files"</span></span>        | <span data-ttu-id="9d8b9-185">" \_ Dateien"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-185">"\_files"</span></span>     |
| <span data-ttu-id="9d8b9-186">" \_ file"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-186">"\_file"</span></span>     | <span data-ttu-id="9d8b9-187">" \_ fitxzer"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-187">"\_fitxers"</span></span>   | <span data-ttu-id="9d8b9-188">" \_ fitxategiak"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-188">"\_fitxategiak"</span></span> | <span data-ttu-id="9d8b9-189">" \_ Pliki"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-189">"\_pliki"</span></span>     |
| <span data-ttu-id="9d8b9-190">" \_ soubory"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-190">"\_soubory"</span></span>  | <span data-ttu-id="9d8b9-191">" \_ tiedostot"</span><span class="sxs-lookup"><span data-stu-id="9d8b9-191">"\_tiedostot"</span></span> |                 |               |



 

> [!Note]  
> <span data-ttu-id="9d8b9-192">Diese Funktion ist für den Fall der Erweiterung sensibel.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-192">This feature is sensitive to the case of the extension.</span></span> <span data-ttu-id="9d8b9-193">Beispielsweise wird für das oben genannte Beispiel ein Unterordner mit dem Namen "MyDoc \_ Files" nicht mit MyDoc.htm verbunden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-193">For instance, for the example given above, a subfolder named "MyDoc\_Files" will not be connected to MyDoc.htm.</span></span>

 

<span data-ttu-id="9d8b9-194">Ob die Dateiverbindung aktiviert oder deaktiviert ist, wird von einem **reg \_ DWORD** -Wert (nofilefolderconnection) des folgenden Registrierungsschlüssels gesteuert.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-194">Whether file connection is enabled or disabled is controlled by a **REG\_DWORD** value, NoFileFolderConnection, of the following registry key.</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
```

<span data-ttu-id="9d8b9-195">Dieser Wert ist normalerweise nicht definiert, und die Dateiverbindung ist aktiviert.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-195">This value normally is not defined, and file connection is enabled.</span></span> <span data-ttu-id="9d8b9-196">Falls erforderlich, können Sie die Dateiverbindung deaktivieren, indem Sie diesen Wert dem Schlüssel hinzufügen und ihn auf 1 festlegen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-196">If necessary, you can disable file connection by adding this value to the key and setting it to 1.</span></span> <span data-ttu-id="9d8b9-197">Legen Sie nofilefolderconnection auf NULL fest, um die Dateiverbindung erneut zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-197">To enable file connection again, set NoFileFolderConnection to zero.</span></span>

> [!Note]  
> <span data-ttu-id="9d8b9-198">Die Dateiverbindung sollte normalerweise aktiviert sein, da andere Anwendungen von ihr abhängig sein können.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-198">File connection should normally be enabled because other applications might depend on it.</span></span> <span data-ttu-id="9d8b9-199">Deaktivieren Sie die Dateiverbindung nur, wenn dies unbedingt erforderlich ist</span><span class="sxs-lookup"><span data-stu-id="9d8b9-199">Disable file connection only if absolutely necessary.</span></span>

 

## <a name="moving-copying-renaming-and-deleting-files"></a><span data-ttu-id="9d8b9-200">Verschieben, kopieren, umbenennen und Löschen von Dateien</span><span class="sxs-lookup"><span data-stu-id="9d8b9-200">Moving, Copying, Renaming, and Deleting Files</span></span>

<span data-ttu-id="9d8b9-201">Der Namespace ist nicht statisch, und Anwendungen müssen im Allgemeinen das Dateisystem verwalten, indem Sie einen der folgenden Vorgänge ausführen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-201">The namespace is not static, and applications commonly need to manage the file system by performing one of the following operations.</span></span>

-   <span data-ttu-id="9d8b9-202">Kopieren eines Objekts in einen anderen Ordner.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-202">Copying an object to another folder.</span></span>
-   <span data-ttu-id="9d8b9-203">Verschieben eines Objekts in einen anderen Ordner.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-203">Moving an object to another folder.</span></span>
-   <span data-ttu-id="9d8b9-204">Löschen eines Objekts.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-204">Deleting an object.</span></span>
-   <span data-ttu-id="9d8b9-205">Umbenennen eines Objekts.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-205">Renaming an object.</span></span>

<span data-ttu-id="9d8b9-206">Diese Vorgänge werden alle mit [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa)ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-206">These operations are all performed with [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span></span> <span data-ttu-id="9d8b9-207">Diese Funktion nimmt eine oder mehrere Quelldateien an und erzeugt entsprechende Zieldateien.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-207">This function takes one or more source files and produces corresponding destination files.</span></span> <span data-ttu-id="9d8b9-208">Im Fall des Löschvorgangs versucht das System, die gelöschten Dateien in den Papierkorb einzufügen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-208">In the case of the delete operation, the system attempts to put the deleted files into the Recycle Bin.</span></span>

<span data-ttu-id="9d8b9-209">Es ist auch möglich, Dateien mithilfe der [Drag & Drop](dragdrop.md) -Funktionalität zu verschieben.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-209">It is also possible to move files using the [drag-and-drop](dragdrop.md) functionality.</span></span>

<span data-ttu-id="9d8b9-210">Um die-Funktion zu verwenden, müssen Sie die Member einer [**shfileopstruct**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) -Struktur ausfüllen und an " [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa)" übergeben.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-210">To use the function, you must fill in the members of an [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) structure and pass it to [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa).</span></span> <span data-ttu-id="9d8b9-211">Die Schlüsselmember der Struktur sind **pfrom** und **PTO**.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-211">The key members of the structure are **pFrom** and **pTo**.</span></span>

<span data-ttu-id="9d8b9-212">Der **pfrom** -Member ist eine Zeichenfolge mit doppelten **null**-terminierten Zeichenfolge, die mindestens einen Quell Dateinamen enthält.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-212">The **pFrom** member is a double **null**-terminated string that contains one or more source file names.</span></span> <span data-ttu-id="9d8b9-213">Bei diesen Namen kann es sich entweder um voll qualifizierte Pfade oder um standardmäßige DOS-Platzhalter wie \* . \* handeln.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-213">These names can be either fully qualified paths or standard DOS wildcards such as \*.\*.</span></span> <span data-ttu-id="9d8b9-214">Obwohl dieser Member als eine **null**-terminierte Zeichenfolge deklariert ist, wird er als Puffer verwendet, um mehrere Dateinamen aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-214">Although this member is declared as a **null**-terminated string, it is used as a buffer to hold multiple file names.</span></span> <span data-ttu-id="9d8b9-215">Jeder Dateiname muss mit dem üblichen einzelnen **null** -Zeichen beendet werden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-215">Each file name must be terminated by the usual single **NULL** character.</span></span> <span data-ttu-id="9d8b9-216">Ein zusätzliches **null** -Zeichen muss an das Ende des endgültigen namens angehängt werden, um das Ende von **pfrom** anzugeben.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-216">An additional **NULL** character must be appended to the end of the final name to indicate the end of **pFrom**.</span></span>

<span data-ttu-id="9d8b9-217">Der **PTO** -Member ist eine Zeichenfolge mit doppelten **null**-terminierten Zeichen folgen, ähnlich wie **pfrom**.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-217">The **pTo** member is a double **null**-terminated string, much like **pFrom**.</span></span> <span data-ttu-id="9d8b9-218">Der **PTO** -Member enthält die Namen eines oder mehrerer voll qualifizierter Zielnamen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-218">The **pTo** member contains the names of one or more fully qualified destination names.</span></span> <span data-ttu-id="9d8b9-219">Sie werden auf die gleiche Weise wie für **pfrom** in **PTO** gepackt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-219">They are packed into **pTo** in the same way as they are for **pFrom**.</span></span> <span data-ttu-id="9d8b9-220">Wenn **PTO** mehrere Namen enthält, müssen Sie auch das **FOF \_ multidestfiles** -Flag im **fFlags** -Member festlegen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-220">If **pTo** contains multiple names, you must also set the **FOF\_MULTIDESTFILES** flag in the **fFlags** member.</span></span> <span data-ttu-id="9d8b9-221">Die Verwendung von **PTO** hängt von dem Vorgang ab, wie hier beschrieben.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-221">The usage of **pTo** depends on the operation as described here.</span></span>

-   <span data-ttu-id="9d8b9-222">Wenn bei Kopier-und Verschiebungs Vorgängen alle Dateien in ein einzelnes Verzeichnis gelangen, enthält **PTO** den voll qualifizierten Verzeichnisnamen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-222">For copy and move operations, if all the files are going to a single directory, **pTo** contains the fully qualified directory name.</span></span> <span data-ttu-id="9d8b9-223">Wenn die Dateien an verschiedene Ziele übergeben werden, kann **PTO** auch einen voll qualifizierten Verzeichnis-oder Dateinamen für jede Quelldatei enthalten.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-223">If the files are going to different destinations, **pTo** can also contain one fully qualified directory or file name for each source file.</span></span> <span data-ttu-id="9d8b9-224">Wenn ein Verzeichnis nicht vorhanden ist, wird es vom System erstellt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-224">If a directory does not exist, the system creates it.</span></span>
-   <span data-ttu-id="9d8b9-225">Für Umbenennungs Vorgänge enthält **PTO** einen voll qualifizierten Pfad für jede Quelldatei in **pfrom**.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-225">For rename operations, **pTo** contains one fully qualified path for each source file in **pFrom**.</span></span>
-   <span data-ttu-id="9d8b9-226">Für Löschvorgänge wird **PTO** nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-226">For delete operations, **pTo** is not used.</span></span>

### <a name="notifying-the-shell"></a><span data-ttu-id="9d8b9-227">Benachrichtigen der Shell</span><span class="sxs-lookup"><span data-stu-id="9d8b9-227">Notifying the Shell</span></span>

<span data-ttu-id="9d8b9-228">Benachrichtigen Sie die Shell über die Änderung, nachdem Sie mithilfe von [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) Dateien verschoben, kopiert, umbenannt oder gelöscht haben, oder nachdem Sie eine andere Aktion ausgeführt haben, die sich auf den-Namespace auswirkt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-228">Notify the Shell of the change after using [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) to move, copy, rename, or delete files, or after taking any other action that affects the namespace.</span></span> <span data-ttu-id="9d8b9-229">Zu den Aktionen, die von der Benachrichtigung begleitet werden sollten, gehören die folgenden:</span><span class="sxs-lookup"><span data-stu-id="9d8b9-229">Actions that should be accompanied by notification include the following:</span></span>

-   <span data-ttu-id="9d8b9-230">Hinzufügen oder Löschen von Dateien oder Ordnern.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-230">Adding or deleting files or folders.</span></span>
-   <span data-ttu-id="9d8b9-231">Verschieben, kopieren oder Umbenennen von Dateien oder Ordnern.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-231">Moving, copying, or renaming files or folders.</span></span>
-   <span data-ttu-id="9d8b9-232">Ändern einer Datei Zuordnung.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-232">Changing a file association.</span></span>
-   <span data-ttu-id="9d8b9-233">Ändern von Dateiattributen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-233">Changing file attributes.</span></span>
-   <span data-ttu-id="9d8b9-234">Hinzufügen oder Entfernen von Laufwerken oder Speichermedien.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-234">Adding or removing drives or storage media.</span></span>
-   <span data-ttu-id="9d8b9-235">Erstellen oder Deaktivieren eines freigegebenen Ordners.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-235">Creating or disabling a shared folder.</span></span>
-   <span data-ttu-id="9d8b9-236">Die System Abbild Liste wird geändert.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-236">Changing the system image list.</span></span>

<span data-ttu-id="9d8b9-237">Eine Anwendung benachrichtigt die Shell durch Aufrufen von [**shchangenotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) mit den Details zu geänderten Änderungen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-237">An application notifies the Shell by calling [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) with the details of what has changed.</span></span> <span data-ttu-id="9d8b9-238">Die Shell kann dann das Image des Namespaces aktualisieren, um den neuen Zustand exakt widerzuspiegeln.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-238">The Shell can then update its image of the namespace to accurately reflect its new state.</span></span>

## <a name="simple-example-of-managing-files-with-shfileoperation"></a><span data-ttu-id="9d8b9-239">Einfaches Beispiel für die Verwaltung von Dateien mit SHFileOperation</span><span class="sxs-lookup"><span data-stu-id="9d8b9-239">Simple Example of Managing Files with SHFileOperation</span></span>

<span data-ttu-id="9d8b9-240">Die folgende Beispiel Konsolenanwendung veranschaulicht die Verwendung von [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) zum Kopieren von Dateien aus einem Verzeichnis in ein anderes Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-240">The following sample console application illustrates the use of [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) to copy files from one directory to another.</span></span> <span data-ttu-id="9d8b9-241">Die Quell-und Zielverzeichnisse "c: \\ My \_ docs" und "c: \\ My Docs2" \_ sind aus Gründen der Einfachheit in der Anwendung hart codiert.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-241">The source and destination directories, C:\\My\_Docs and C:\\My\_Docs2, are hard-coded into the application for simplicity.</span></span>


```C++
#include <shlobj.h>
#include <shlwapi.h>
#include <strsafe.h>

int main(void)
{
    IShellFolder *psfDeskTop = NULL;
    IShellFolder *psfDocFiles = NULL;
    LPITEMIDLIST pidlDocFiles = NULL;
    LPITEMIDLIST pidlItems = NULL;
    IEnumIDList *ppenum = NULL;
    SHFILEOPSTRUCT sfo;
    STRRET strDispName;
    TCHAR szParseName[MAX_PATH];
    TCHAR szSourceFiles[256];
    int i;
    int iBufPos = 0;
    ULONG chEaten;
    ULONG celtFetched;
    size_t ParseNameSize = 0;
    HRESULT hr;
    

    szSourceFiles[0] = '\0';
    hr = SHGetDesktopFolder(&psfDeskTop);

    hr = psfDeskTop->ParseDisplayName(NULL, NULL, L"c:\\My_Docs", 
         &chEaten, &pidlDocFiles, NULL);
    hr = psfDeskTop->BindToObject(pidlDocFiles, NULL, IID_IShellFolder, 
         (LPVOID *) &psfDocFiles);
    hr = psfDeskTop->Release();

    hr = psfDocFiles->EnumObjects(NULL,SHCONTF_FOLDERS | SHCONTF_NONFOLDERS, 
         &ppenum);

    while( (hr = ppenum->Next(1,&pidlItems, &celtFetched)) == S_OK 
       && (celtFetched) == 1)
    {
        psfDocFiles->GetDisplayNameOf(pidlItems, SHGDN_FORPARSING, 
            &strDispName);
        StrRetToBuf(&strDispName, pidlItems, szParseName, MAX_PATH);
        
        hr = StringCchLength(szParseName, MAX_PATH, &ParseNameSize);
        
        if (SUCCEEDED(hr))
        {
            for(i=0; i<=ParseNameSize; i++)
            {
                szSourceFiles[iBufPos++] = szParseName[i];
            }
            CoTaskMemFree(pidlItems);
        }
    }
    ppenum->Release();
    
    szSourceFiles[iBufPos] = '\0';

    sfo.hwnd = NULL;
    sfo.wFunc = FO_COPY;
    sfo.pFrom = szSourceFiles;
    sfo.pTo = "c:\\My_Docs2\0";
    sfo.fFlags = FOF_SILENT | FOF_NOCONFIRMATION | FOF_NOCONFIRMMKDIR;

    hr = SHFileOperation(&sfo);
    
    SHChangeNotify(SHCNE_UPDATEDIR, SHCNF_PATH, (LPCVOID) "c:\\My_Docs2", 0);

    CoTaskMemFree(pidlDocFiles);
    psfDocFiles->Release();

    return 0;
}
```



<span data-ttu-id="9d8b9-242">Die Anwendung ruft zuerst einen Zeiger auf die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle des Desktops ab.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-242">The application first retrieves a pointer to the desktop's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="9d8b9-243">Anschließend ruft er die PIDL des Quell Verzeichnisses ab, indem er den voll qualifizierten Pfad an [**IShellFolder::P ar\displayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname)übergibt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-243">It then retrieves the source directory's PIDL by passing its fully qualified path to [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname).</span></span> <span data-ttu-id="9d8b9-244">Beachten Sie, dass **IShellFolder::P ARL Display Name** erfordert, dass der Pfad des Verzeichnisses eine Unicode-Zeichenfolge ist.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-244">Note that **IShellFolder::ParseDisplayName** requires the directory's path to be a Unicode string.</span></span> <span data-ttu-id="9d8b9-245">Die Anwendung bindet dann an das Quellverzeichnis und verwendet die **IShellFolder** -Schnittstelle zum Abrufen der [**ienumittellist**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) -Schnittstelle eines Enumeratorobjekts.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-245">The application then binds to the source directory and uses its **IShellFolder** interface to retrieve an enumerator object's [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span>

<span data-ttu-id="9d8b9-246">Bei der Enumeration der einzelnen Dateien im Quellverzeichnis wird [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) zum Abrufen des Namens verwendet.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-246">As each file in the source directory is enumerated, [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) is used to retrieve its name.</span></span> <span data-ttu-id="9d8b9-247">Das Flag "shgdn \_ forparamesing" ist festgelegt, was bewirkt, dass **IShellFolder:: GetDisplayNameOf** den voll qualifizierten Pfad der Datei zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-247">The SHGDN\_FORPARSING flag is set, which causes **IShellFolder::GetDisplayNameOf** to return the file's fully qualified path.</span></span> <span data-ttu-id="9d8b9-248">Die Dateipfade, einschließlich der abschließenden **null** -Zeichen, werden in einem einzelnen Array, *szsourcefiles*, verkettet.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-248">The file paths, including the terminating **NULL** characters, are concatenated into a single array, *szSourceFiles*.</span></span> <span data-ttu-id="9d8b9-249">Ein zweites **null** -Zeichen wird an den endgültigen Pfad angehängt, um das Array ordnungsgemäß zu beenden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-249">A second **NULL** character is appended to the final path to terminate the array properly.</span></span>

<span data-ttu-id="9d8b9-250">Nachdem die Enumeration fertiggestellt wurde, weist die Anwendung Werte einer [**shfi**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) -Struktur Struktur zu.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-250">Once the enumeration is complete, the application assigns values to an [**SHFILEOPSTRUCT**](/windows/desktop/api/Shellapi/ns-shellapi-shfileopstructa) structure.</span></span> <span data-ttu-id="9d8b9-251">Beachten Sie, dass das Array, das **PTO** zugewiesen ist, um das Ziel anzugeben, auch durch einen doppelten **null**-Wert beendet werden muss.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-251">Note that the array assigned to **pTo** to specify the destination must also be terminated by a double **NULL**.</span></span> <span data-ttu-id="9d8b9-252">In diesem Fall ist Sie einfach in der Zeichenfolge enthalten, die **PTO** zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-252">In this case, it is simply included in the string that is assigned to **pTo**.</span></span> <span data-ttu-id="9d8b9-253">Da es sich hierbei um eine Konsolenanwendung handelt, werden die Flags "FOF \_ Silent", "FOF \_ noconfirmation" und "FOF \_ noconfirmmkdir" so festgelegt, dass alle angezeigten Dialogfelder unterdrückt werden.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-253">Because this is a console application, the FOF\_SILENT, FOF\_NOCONFIRMATION, and FOF\_NOCONFIRMMKDIR flags are set to suppress any dialog boxes that might appear.</span></span> <span data-ttu-id="9d8b9-254">Nachdem [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) zurückgegeben wurde, wird [**shchangenotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) aufgerufen, um die Shell über die Änderung zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-254">After [**SHFileOperation**](/windows/desktop/api/Shellapi/nf-shellapi-shfileoperationa) returns, [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) is called to notify the Shell of the change.</span></span> <span data-ttu-id="9d8b9-255">Die Anwendung führt dann die übliche Bereinigung durch und gibt zurück.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-255">Then the application performs the usual cleanup and returns.</span></span>

## <a name="adding-files-to-the-shells-list-of-recent-documents"></a><span data-ttu-id="9d8b9-256">Hinzufügen von Dateien zur Liste der zuletzt geöffneten Dokumente in der Shell</span><span class="sxs-lookup"><span data-stu-id="9d8b9-256">Adding Files to the Shell's List of Recent Documents</span></span>

<span data-ttu-id="9d8b9-257">Die Shell verwaltet eine Liste der zuletzt hinzugefügten oder geänderten Dokumente für jeden Benutzer.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-257">The Shell maintains a list of recently added or modified documents for each user.</span></span> <span data-ttu-id="9d8b9-258">Der Benutzer kann eine Liste mit Links zu diesen Dateien anzeigen, indem er im Startmenü auf Dokumente klickt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-258">The user can display a list of links to these files by clicking Documents on the Start menu.</span></span> <span data-ttu-id="9d8b9-259">Wie bei meinen Dokumenten verfügt jeder Benutzer über ein Dateisystem Verzeichnis, um die tatsächlichen Verknüpfungen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-259">As with My Documents, each user has a file system directory to hold the actual links.</span></span> <span data-ttu-id="9d8b9-260">Zum Abrufen der PIDL des aktuellen Verzeichnisses des aktuellen Benutzers kann die Anwendung " [**shgetfolderlocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) " mit der aktuellen CSIDL-Datei aufrufen \_ oder " [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) " aufrufen, um den Pfad abzurufen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-260">To retrieve the PIDL of the current user's Recent directory, your application can call [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) with CSIDL\_RECENT, or call [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) to retrieve its path.</span></span>

<span data-ttu-id="9d8b9-261">Die Anwendung kann den Inhalt des aktuellen Ordners mithilfe der zuvor in diesem Dokument beschriebenen Techniken auflisten.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-261">Your application can enumerate the contents of the Recent folder using the techniques discussed earlier in this document.</span></span> <span data-ttu-id="9d8b9-262">Eine Anwendung sollte den Inhalt des Ordners jedoch nicht so ändern, als ob es sich um einen normalen Dateisystem Ordner handelt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-262">However, an application should not modify the contents of the folder as if it were a normal file system folder.</span></span> <span data-ttu-id="9d8b9-263">Wenn dies der Fall ist, wird die Liste der zuletzt geöffneten Dokumente der Shell nicht ordnungsgemäß aktualisiert, und die Änderungen werden im Startmenü nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-263">If it does so, the Shell's list of recent documents will not be updated properly, and the changes will not be reflected in the Start menu.</span></span> <span data-ttu-id="9d8b9-264">Stattdessen kann die Anwendung " [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs)" aufgerufen werden, um einen Dokument Link zum aktuellen Ordner eines Benutzers hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-264">Instead, to add a document link to a user's Recent folder, your application can call [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span></span> <span data-ttu-id="9d8b9-265">Die Shell fügt dem entsprechenden Dateisystem Ordner einen Link hinzu und aktualisiert die Liste der zuletzt geöffneten Dokumente und das Startmenü.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-265">The Shell will add a link to the appropriate file system folder, as well as updating its list of recent documents and the Start menu.</span></span> <span data-ttu-id="9d8b9-266">Sie können diese Funktion auch verwenden, um den Ordner zu löschen.</span><span class="sxs-lookup"><span data-stu-id="9d8b9-266">You can also use this function to clear the folder.</span></span>

 

 
