---
description: Im Abschnitt "erhalten eines Ordners" mit der ID "" werden zwei Ansätze erläutert, mit denen Sie den Zeiger eines Namespace Objekts auf eine Element Bezeichner-Liste (PIDL)
ms.assetid: c99a2f6c-3144-41ec-ad97-59a30bfec9ab
title: Erhalten von Informationen über den Inhalt eines Ordners
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7eb26e9df28af4811e74f2878eebb7af9d5c92a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104993686"
---
# <a name="getting-information-about-the-contents-of-a-folder"></a><span data-ttu-id="917ef-103">Erhalten von Informationen über den Inhalt eines Ordners</span><span class="sxs-lookup"><span data-stu-id="917ef-103">Getting Information About the Contents of a Folder</span></span>

<span data-ttu-id="917ef-104">Im Abschnitt " [erhalten eines Ordners](folder-id.md) " mit der ID "" werden zwei Ansätze erläutert, mit denen Sie den Zeiger eines Namespace Objekts auf eine Element Bezeichner-Liste (PIDL)</span><span class="sxs-lookup"><span data-stu-id="917ef-104">The [Getting a Folder's ID](folder-id.md) section discussed two approaches to getting a namespace object's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="917ef-105">Eine offensichtliche Frage ist: Wenn Sie über eine PIDL verfügen, was können Sie damit tun?</span><span class="sxs-lookup"><span data-stu-id="917ef-105">One obvious question is: Once you have a PIDL, what can you do with it?</span></span> <span data-ttu-id="917ef-106">Eine verwandte Frage ist: Was geschieht, wenn keiner der Ansätze funktioniert oder für Ihre Anwendung geeignet ist?</span><span class="sxs-lookup"><span data-stu-id="917ef-106">A related question is: What if neither approach works, or is suitable for your application?</span></span> <span data-ttu-id="917ef-107">Die Antwort auf beide Fragen erfordert einen genaueren Blick darauf, wie der Namespace implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="917ef-107">The answer to both questions requires taking a closer look at how the namespace is implemented.</span></span> <span data-ttu-id="917ef-108">Der Schlüssel ist die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="917ef-108">The key is the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

-   [<span data-ttu-id="917ef-109">Verwenden der IShellFolder-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="917ef-109">Using the IShellFolder Interface</span></span>](#using-the-ishellfolder-interface)
-   [<span data-ttu-id="917ef-110">Auflisten des Inhalts eines Ordners</span><span class="sxs-lookup"><span data-stu-id="917ef-110">Enumerating the Contents of a Folder</span></span>](#enumerating-the-contents-of-a-folder)
-   [<span data-ttu-id="917ef-111">Bestimmen von anzeigen Amen und anderen Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="917ef-111">Determining Display Names and Other Properties</span></span>](#determining-display-names-and-other-properties)
-   [<span data-ttu-id="917ef-112">Ein Zeiger auf die IShellFolder-Schnittstelle eines unter Ordners wird erhalten.</span><span class="sxs-lookup"><span data-stu-id="917ef-112">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>](#getting-a-pointer-to-a-subfolders-ishellfolder-interface)
-   [<span data-ttu-id="917ef-113">Bestimmen des übergeordneten Ordners eines Objekts</span><span class="sxs-lookup"><span data-stu-id="917ef-113">Determining an Object's Parent Folder</span></span>](#determining-an-objects-parent-folder)

## <a name="using-the-ishellfolder-interface"></a><span data-ttu-id="917ef-114">Verwenden der IShellFolder-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="917ef-114">Using the IShellFolder Interface</span></span>

<span data-ttu-id="917ef-115">An früherer Stelle in dieser Dokumentation wurden Namespace Ordner als Objekte bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="917ef-115">Earlier in this documentation, namespace folders were referred to as objects.</span></span> <span data-ttu-id="917ef-116">Obwohl der Begriff zu diesem Zeitpunkt in einem lockeren Sinn verwendet wurde, ist er auch in einem strengen Sinn.</span><span class="sxs-lookup"><span data-stu-id="917ef-116">Although, at that point, the term was used in a loose sense, it is actually true in a strict sense as well.</span></span> <span data-ttu-id="917ef-117">Jeder Namespace Ordner wird durch ein Component Object Model (com)-Objekt dargestellt.</span><span class="sxs-lookup"><span data-stu-id="917ef-117">Every namespace folder is represented by a Component Object Model (COM) object.</span></span> <span data-ttu-id="917ef-118">Jedes Ordner Objekt stellt eine Reihe von Schnittstellen zur Verfügung, die für eine Vielzahl von Aufgaben verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="917ef-118">Each folder object exposes a number of interfaces that can be used for a wide variety of tasks.</span></span> <span data-ttu-id="917ef-119">Einige optionale Schnittstellen werden möglicherweise nicht von allen Ordnern verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="917ef-119">Some interfaces that are optional may not be exposed by all folders.</span></span> <span data-ttu-id="917ef-120">Alle Ordner müssen jedoch die grundlegende Schnittstelle ( [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder)) verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="917ef-120">However, all folders must expose the fundamental interface, [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span></span>

<span data-ttu-id="917ef-121">Der erste Schritt bei der Verwendung eines Ordner Objekts besteht darin, einen Zeiger auf die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-121">The first step in using a folder object is to retrieve a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="917ef-122">Zusätzlich zur Bereitstellung des Zugriffs auf die anderen Schnittstellen des Objekts macht **IShellFolder** eine Gruppe von Methoden verfügbar, die eine Reihe allgemeiner Aufgaben verarbeiten, von denen einige in diesem Abschnitt erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="917ef-122">In addition to providing access to the object's other interfaces, **IShellFolder** exposes a group of methods that handle a number of common tasks, several of which are discussed in this section.</span></span>

<span data-ttu-id="917ef-123">Zum Abrufen eines Zeigers auf die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle eines Namespace Objekts müssen Sie zuerst [**shgetdesktopfolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-123">To retrieve a pointer to a namespace object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, you must first call [**SHGetDesktopFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder).</span></span> <span data-ttu-id="917ef-124">Diese Funktion gibt einen Zeiger auf die **IShellFolder** -Schnittstelle des Namespace Stamms, den Desktop, zurück.</span><span class="sxs-lookup"><span data-stu-id="917ef-124">This function returns a pointer to the **IShellFolder** interface of the namespace root, the desktop.</span></span> <span data-ttu-id="917ef-125">Wenn Sie über die **IShellFolder** -Schnittstelle des Desktops verfügen, gibt es eine Vielzahl von Möglichkeiten, um fortzufahren.</span><span class="sxs-lookup"><span data-stu-id="917ef-125">Once you have the desktop's **IShellFolder** interface, there a variety of ways to proceed.</span></span>

<span data-ttu-id="917ef-126">Wenn Sie bereits über die PIDL des Ordners verfügen, an dem Sie interessiert sind – beispielsweise durch Aufrufen von [**shgetfolderlocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation)– können Sie die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle abrufen, indem Sie die [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) -Methode des Desktops aufrufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-126">If you already have the PIDL of the folder you are interested in—for instance, by calling [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation)—you can retrieve its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface by calling the desktop's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="917ef-127">Wenn Sie über den Pfad eines Dateisystem Objekts verfügen, müssen Sie zuerst seine PIDL abrufen, indem Sie die [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) -Methode des Desktops aufrufen und dann **IShellFolder:: BindToObject** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-127">If you have the path of a file system object, you must first obtain its PIDL by calling the desktop's [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method and then call **IShellFolder::BindToObject**.</span></span> <span data-ttu-id="917ef-128">Wenn keiner dieser Ansätze zutrifft, können Sie andere **IShellFolder** -Methoden verwenden, um durch den Namespace zu navigieren.</span><span class="sxs-lookup"><span data-stu-id="917ef-128">If neither of these approaches is applicable, you can use other **IShellFolder** methods to navigate the namespace.</span></span> <span data-ttu-id="917ef-129">Weitere Informationen finden Sie unter [Navigieren im-Namespace](navigate.md).</span><span class="sxs-lookup"><span data-stu-id="917ef-129">For more information, see [Navigating the Namespace](navigate.md).</span></span>

## <a name="enumerating-the-contents-of-a-folder"></a><span data-ttu-id="917ef-130">Auflisten des Inhalts eines Ordners</span><span class="sxs-lookup"><span data-stu-id="917ef-130">Enumerating the Contents of a Folder</span></span>

<span data-ttu-id="917ef-131">Der erste Schritt, den Sie in der Regel mit einem Ordner durchführen möchten, besteht darin, herauszufinden, was darin enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="917ef-131">The first thing you usually want to do with a folder is to find out what it contains.</span></span> <span data-ttu-id="917ef-132">Sie müssen zuerst die [**IShellFolder:: erumujects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) -Methode des Ordners aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-132">You must first call the folder's [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method.</span></span> <span data-ttu-id="917ef-133">Im Ordner wird ein Standardmäßiges OLE-Enumerationsobjekt erstellt und dessen [**ienumittellist**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) -Schnittstelle zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="917ef-133">The folder will create a standard OLE enumeration object and return its [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span> <span data-ttu-id="917ef-134">Diese Schnittstelle stellt vier Standardmethoden –[**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset)und [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)– zur Verfügung, mit denen der Inhalt des Ordners aufgelistet werden kann.</span><span class="sxs-lookup"><span data-stu-id="917ef-134">This interface exposes four standard methods—[**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), and [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)—that can be used to enumerate the contents of the folder.</span></span>

<span data-ttu-id="917ef-135">Das grundlegende Verfahren zum Auflisten des Inhalts eines Ordners lautet:</span><span class="sxs-lookup"><span data-stu-id="917ef-135">The basic procedure for enumerating a folder's contents is:</span></span>

1.  <span data-ttu-id="917ef-136">Rufen Sie die Ordner [**IShellFolder:: enumubjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) -Methode auf, um einen Zeiger auf die [**ienumittellist**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) -Schnittstelle eines Enumerationsobjekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-136">Call the folders [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method to retrieve a pointer to an enumeration object's [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span>
2.  <span data-ttu-id="917ef-137">Übergeben Sie eine nicht zugeordnete PIDL an [**ienumittellist:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span><span class="sxs-lookup"><span data-stu-id="917ef-137">Pass an unallocated PIDL to [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="917ef-138">Im **nächsten** Schritt wird die Zuweisung der PIDL übernommen, aber die Anwendung muss die Zuordnung aufheben, wenn Sie nicht mehr benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="917ef-138">**Next** takes care of allocating the PIDL, but the application must deallocate it when it is no longer needed.</span></span> <span data-ttu-id="917ef-139">Wenn **Next** zurückgibt, enthält die PIDL nur die Element-ID des Objekts und die abschließenden **null** Zeichen.</span><span class="sxs-lookup"><span data-stu-id="917ef-139">When **Next** returns, the PIDL will contain just the object's item ID and the terminating **NULL** characters.</span></span> <span data-ttu-id="917ef-140">Das heißt, es handelt sich um eine PIDL auf einer Ebene, die relativ zum Ordner ist, nicht um eine voll qualifizierte PIDL.</span><span class="sxs-lookup"><span data-stu-id="917ef-140">In other words, it is a single-level PIDL, relative to the folder, not a fully qualified PIDL.</span></span>
3.  <span data-ttu-id="917ef-141">Wiederholen Sie Schritt 2, bis [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) den Wert false zurückgibt, \_ um anzugeben, dass alle Elemente aufgezählt wurden.</span><span class="sxs-lookup"><span data-stu-id="917ef-141">Repeat step 2 until [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) returns S\_FALSE to indicate that all items have been enumerated.</span></span>
4.  <span data-ttu-id="917ef-142">Ruft **ienumittellist:: Release** auf, um das Enumerationsobjekt freizugeben.</span><span class="sxs-lookup"><span data-stu-id="917ef-142">Call **IEnumIDList::Release** to release the enumeration object.</span></span>

> [!Note]  
> <span data-ttu-id="917ef-143">Es ist wichtig, zu verfolgen, ob Sie mit einer vollständigen oder relativen PIDL arbeiten.</span><span class="sxs-lookup"><span data-stu-id="917ef-143">It is important to keep track of whether you are working with a full or relative PIDL.</span></span> <span data-ttu-id="917ef-144">Einige Funktionen und Methoden akzeptieren beides, aber andere nehmen nur eine oder die andere auf.</span><span class="sxs-lookup"><span data-stu-id="917ef-144">Some functions and methods will accept either, but others will only take one or the other.</span></span>

 

<span data-ttu-id="917ef-145">Die verbleibenden drei [**ienumittellist**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) -Methoden ([**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)und [**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) sind hilfreich, wenn Sie wiederholte Enumerationen des Ordners ausführen müssen.</span><span class="sxs-lookup"><span data-stu-id="917ef-145">The remaining three [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) methods ([**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip), and [**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) are useful if you need to do repeated enumerations of the folder.</span></span> <span data-ttu-id="917ef-146">Sie ermöglichen es Ihnen, die Enumeration zurückzusetzen, ein oder mehrere Objekte zu überspringen und eine Kopie des Enumerationsobjekt zu erstellen, um seinen Zustand beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="917ef-146">They allow you to reset the enumeration, skip one or more objects, and make a copy of the enumeration object to preserve its state.</span></span>

## <a name="determining-display-names-and-other-properties"></a><span data-ttu-id="917ef-147">Bestimmen von anzeigen Amen und anderen Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="917ef-147">Determining Display Names and Other Properties</span></span>

<span data-ttu-id="917ef-148">Nachdem Sie alle pidls aufgezählt haben, die in einem Ordner enthalten sind, können Sie herausfinden, welche Art von Objekten Sie darstellen.</span><span class="sxs-lookup"><span data-stu-id="917ef-148">Once you have enumerated all the PIDLs that are contained by a folder, you can find out what sort of objects they represent.</span></span> <span data-ttu-id="917ef-149">Die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle bietet eine Reihe nützlicher Methoden, von denen zwei hier erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="917ef-149">The [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface provides a number of useful methods, two of which are discussed here.</span></span> <span data-ttu-id="917ef-150">Andere **IShellFolder** -Methoden und andere shellordnerschnittstellen werden später erläutert.</span><span class="sxs-lookup"><span data-stu-id="917ef-150">Other **IShellFolder** methods and other Shell folder interfaces are discussed later.</span></span>

<span data-ttu-id="917ef-151">Eine der nützlichsten Eigenschaften ist der Anzeige Name des Objekts.</span><span class="sxs-lookup"><span data-stu-id="917ef-151">One of the most useful properties is the object's display name.</span></span> <span data-ttu-id="917ef-152">Um den anzeigen Amen eines Objekts abzurufen, übergeben Sie seine PIDL an [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span><span class="sxs-lookup"><span data-stu-id="917ef-152">To retrieve the display name of an object, pass its PIDL to [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span></span> <span data-ttu-id="917ef-153">Obwohl das-Objekt sich an einer beliebigen Stelle unterhalb des übergeordneten Ordners im-Namespace befinden kann, muss seine PIDL relativ zum Ordner sein.</span><span class="sxs-lookup"><span data-stu-id="917ef-153">Although the object can be located anywhere below the parent folder in the namespace, its PIDL must be relative to the folder.</span></span>

<span data-ttu-id="917ef-154">[**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) gibt den anzeigen Amen als Teil einer " [**Strauch**](/windows/desktop/api/Shtypes/ns-shtypes-strret) Struktur" zurück.</span><span class="sxs-lookup"><span data-stu-id="917ef-154">[**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) returns the display name as part of of a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure.</span></span> <span data-ttu-id="917ef-155">Da das Extrahieren des anzeigen Amens aus einer " **strinret** "-Struktur etwas kompliziert sein kann, bietet die Shell zwei Funktionen, die den Auftrag für Sie ausführen: " [**strauretystr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) " und " [**Strauch**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa)".</span><span class="sxs-lookup"><span data-stu-id="917ef-155">Because extracting the display name from a **STRRET** structure can be a little tricky, the Shell provides two functions that do the job for you, [**StrRetToStr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) and [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa).</span></span> <span data-ttu-id="917ef-156">Beide Funktionen nehmen eine " **strinret** "-Struktur an und geben den anzeigen Amen als normale Zeichenfolge zurück.</span><span class="sxs-lookup"><span data-stu-id="917ef-156">Both functions take a **STRRET** structure, and return the display name as a normal string.</span></span> <span data-ttu-id="917ef-157">Sie unterscheiden sich nur in der Zuordnung der Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="917ef-157">They differ only in how the string is allocated.</span></span>

<span data-ttu-id="917ef-158">Neben dem anzeigen Amen kann ein Objekt über eine Reihe von Attributen verfügen, z. b. ob es sich um einen Ordner handelt oder ob es verschoben werden kann.</span><span class="sxs-lookup"><span data-stu-id="917ef-158">In addition to its display name, an object can have a number of attributes, such as whether it is a folder or whether it can be moved.</span></span> <span data-ttu-id="917ef-159">Sie können die Attribute eines Objekts abrufen, indem Sie die zugehörige PIDL an [**IShellFolder:: getattributesof**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof)übergeben.</span><span class="sxs-lookup"><span data-stu-id="917ef-159">You can retrieve an object's attributes by passing its PIDL to [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span> <span data-ttu-id="917ef-160">Die komplette Liste der Attribute ist recht groß. Daher sollte der Verweis auf Details angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="917ef-160">The complete list of attributes is quite large, so you should see the reference for details.</span></span> <span data-ttu-id="917ef-161">Beachten Sie, dass die PIDL, die Sie an **getattributesof** übergeben, eine einzelne Ebene aufweisen muss.</span><span class="sxs-lookup"><span data-stu-id="917ef-161">Note that the PIDL that you pass to **GetAttributesOf** must be single-level.</span></span> <span data-ttu-id="917ef-162">**IShellFolder:: getattributesof** akzeptiert insbesondere die pidls, die von [**ienumittellist:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next)zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="917ef-162">In particular, **IShellFolder::GetAttributesOf** will accept the PIDLs returned by [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="917ef-163">Sie können ein Array von pidls übergeben, und **getattributesof** gibt die Attribute zurück, die alle Objekte im Array gemeinsam haben.</span><span class="sxs-lookup"><span data-stu-id="917ef-163">You can pass in an array of PIDLs, and **GetAttributesOf** will return those attributes that all objects in the array have in common.</span></span>

<span data-ttu-id="917ef-164">Wenn Sie über den voll qualifizierten Pfad oder PIDL eines Objekts verfügen, stellt [**shgetfileinfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) eine einfache Möglichkeit zum Abrufen von Informationen zu einem Objekt bereit, das für viele Zwecke ausreicht.</span><span class="sxs-lookup"><span data-stu-id="917ef-164">If you have an object's fully qualified path or PIDL, [**SHGetFileInfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) provides a simple way to retrieve information about an object that is sufficient for many purposes.</span></span> <span data-ttu-id="917ef-165">**Shgetfileinfo** übernimmt einen voll qualifizierten Pfad oder eine PIDL und gibt eine Vielzahl von Informationen über das Objekt zurück, einschließlich:</span><span class="sxs-lookup"><span data-stu-id="917ef-165">**SHGetFileInfo** takes a fully qualified path or PIDL, and returns a variety of information about the object including:</span></span>

-   <span data-ttu-id="917ef-166">Der Anzeige Name des Objekts.</span><span class="sxs-lookup"><span data-stu-id="917ef-166">The object's display name</span></span>
-   <span data-ttu-id="917ef-167">Die Attribute des Objekts.</span><span class="sxs-lookup"><span data-stu-id="917ef-167">The object's attributes</span></span>
-   <span data-ttu-id="917ef-168">Handles für die Symbole des Objekts</span><span class="sxs-lookup"><span data-stu-id="917ef-168">Handles to the object's icons</span></span>
-   <span data-ttu-id="917ef-169">Ein Handle für die System Abbild Liste.</span><span class="sxs-lookup"><span data-stu-id="917ef-169">A handle to the system image list</span></span>
-   <span data-ttu-id="917ef-170">Der Pfad der Datei, die das Symbol des Objekts enthält.</span><span class="sxs-lookup"><span data-stu-id="917ef-170">The path of the file containing the object's icon</span></span>

## <a name="getting-a-pointer-to-a-subfolders-ishellfolder-interface"></a><span data-ttu-id="917ef-171">Ein Zeiger auf die IShellFolder-Schnittstelle eines unter Ordners wird erhalten.</span><span class="sxs-lookup"><span data-stu-id="917ef-171">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>

<span data-ttu-id="917ef-172">Sie können bestimmen, ob der Ordner Unterordner enthält, indem Sie [**IShellFolder:: getattributesof**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) aufrufen und überprüfen, ob das sfgao- \_ ordnerflag festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="917ef-172">You can determine whether your folder contains any subfolders by calling [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) and checking to see if the SFGAO\_FOLDER flag is set.</span></span> <span data-ttu-id="917ef-173">Wenn es sich bei einem Objekt um einen Ordner handelt, können Sie an das Objekt binden, um einen Zeiger auf seine [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="917ef-173">If an object is a folder, you can bind to it, which provides you with a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

<span data-ttu-id="917ef-174">Zum Binden an einen Unterordner müssen Sie die [**IShellFolder:: BindTo Object**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) -Methode des übergeordneten Ordners aufrufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-174">To bind to a subfolder, call the parent folder's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="917ef-175">Diese Methode nimmt die PIDL des unter Ordners an und gibt einen Zeiger auf die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="917ef-175">This method takes the subfolder's PIDL and returns a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="917ef-176">Sobald Sie über diesen Zeiger verfügen, können Sie die **IShellFolder** -Methoden verwenden, um den Inhalt der Unterordner aufzulisten, deren Eigenschaften zu bestimmen usw.</span><span class="sxs-lookup"><span data-stu-id="917ef-176">Once you have this pointer, you can use the **IShellFolder** methods to enumerate the subfolders contents, determine their properties, and so on.</span></span>

## <a name="determining-an-objects-parent-folder"></a><span data-ttu-id="917ef-177">Bestimmen des übergeordneten Ordners eines Objekts</span><span class="sxs-lookup"><span data-stu-id="917ef-177">Determining an Object's Parent Folder</span></span>

<span data-ttu-id="917ef-178">Wenn Sie über die PIDL eines Objekts verfügen, benötigen Sie möglicherweise ein Handle für eine der Schnittstellen, die vom übergeordneten Ordner verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="917ef-178">If you have an object's PIDL, you may need a handle to one of the interfaces exposed by its parent folder.</span></span> <span data-ttu-id="917ef-179">Wenn Sie z. b. den mit einer PIDL verknüpften anzeigen Amen mithilfe von [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof)bestimmen möchten, müssen Sie zuerst die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle des übergeordneten Elements des Objekts abrufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-179">For example, if you want to determine the display name associated with a PIDL by using [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof), you must first retrieve the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface of the object's parent.</span></span> <span data-ttu-id="917ef-180">Dies ist möglich, wenn Sie die in den vorherigen Abschnitten beschriebenen Verfahren verwenden.</span><span class="sxs-lookup"><span data-stu-id="917ef-180">It is possible to do this with the techniques discussed in the previous sections.</span></span> <span data-ttu-id="917ef-181">Ein viel einfacherer Ansatz ist jedoch die Verwendung der Shellfunktion " [**shbindtoparent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent)".</span><span class="sxs-lookup"><span data-stu-id="917ef-181">However, a much simpler approach is to use the Shell function, [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent).</span></span> <span data-ttu-id="917ef-182">Diese Funktion nimmt die voll qualifizierte PIDL eines Objekts an und gibt einen angegebenen Schnittstellen Zeiger für den übergeordneten Ordner zurück.</span><span class="sxs-lookup"><span data-stu-id="917ef-182">This function takes the fully qualified PIDL of an object and returns a specified interface pointer on the parent folder.</span></span> <span data-ttu-id="917ef-183">Optional gibt Sie auch die PIDL der einzelnen Ebene des Elements zur Verwendung in Methoden wie [**IShellFolder:: getattributesof**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof)zurück.</span><span class="sxs-lookup"><span data-stu-id="917ef-183">Optionally, it also returns the item's single-level PIDL for use in methods such as [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span>

<span data-ttu-id="917ef-184">Mit der folgenden Beispiel Konsolenanwendung wird die PIDL des speziellen System Ordners abgerufen und der Anzeige Name zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="917ef-184">The following sample console application retrieves the PIDL of the System special folder and returns its display name.</span></span>


```
#include <shlobj.h>
#include <shlwapi.h>
#include <iostream.h>
#include <objbase.h>

int main()
{
    IShellFolder *psfParent = NULL;
    LPITEMIDLIST pidlSystem = NULL;
    LPCITEMIDLIST pidlRelative = NULL;
    STRRET strDispName;
    TCHAR szDisplayName[MAX_PATH];
    HRESULT hr;

    hr = SHGetFolderLocation(NULL, CSIDL_SYSTEM, NULL, NULL, &pidlSystem);

    hr = SHBindToParent(pidlSystem, IID_IShellFolder, (void **) &psfParent, &pidlRelative);

    if(SUCCEEDED(hr))
    {
        hr = psfParent->GetDisplayNameOf(pidlRelative, SHGDN_NORMAL, &strDispName);
        hr = StrRetToBuf(&strDispName, pidlSystem, szDisplayName, sizeof(szDisplayName));
        cout << "SHGDN_NORMAL - " <<szDisplayName << '\n';
    }

    psfParent->Release();
    CoTaskMemFree(pidlSystem);

    return 0;
}
```



<span data-ttu-id="917ef-185">Die Anwendung verwendet zunächst [**shgetfolderlocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) , um die PIDL des System Ordners abzurufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-185">The application first uses [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) to retrieve the System folder's PIDL.</span></span> <span data-ttu-id="917ef-186">Anschließend wird " [**shbindtoparent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent)" aufgerufen, wodurch ein Zeiger auf die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle des übergeordneten Ordners und die PIDL des System Ordners relativ zum übergeordneten Element zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="917ef-186">It then calls [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent), which returns a pointer to the parent folder's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, and the System folder's PIDL relative to its parent.</span></span> <span data-ttu-id="917ef-187">Anschließend wird die [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) -Methode des übergeordneten Ordners verwendet, um den anzeigen amen des System Ordners abzurufen.</span><span class="sxs-lookup"><span data-stu-id="917ef-187">It then uses the parent folder's [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method to retrieve the display name of the System folder.</span></span> <span data-ttu-id="917ef-188">Da **GetDisplayNameOf** eine " [**strinret**](/windows/desktop/api/Shtypes/ns-shtypes-strret) "-Struktur zurückgibt, wird " [**strauretybuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) " verwendet, um den anzeigen Amen in eine normale Zeichenfolge zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="917ef-188">Because **GetDisplayNameOf** returns a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure, [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) is used to convert the display name into a normal string.</span></span> <span data-ttu-id="917ef-189">Nachdem der Anzeige Name angezeigt wurde, werden die Schnittstellen Zeiger freigegeben und die System-PIDL freigegeben.</span><span class="sxs-lookup"><span data-stu-id="917ef-189">After displaying the display name, the interface pointers are released and the System PIDL freed.</span></span> <span data-ttu-id="917ef-190">Beachten Sie, dass die von **shbindtoparent** zurückgegebene relative PIDL nicht freigegeben werden darf.</span><span class="sxs-lookup"><span data-stu-id="917ef-190">Note that you must not free the relative PIDL returned by **SHBindToParent**.</span></span>

 

 
