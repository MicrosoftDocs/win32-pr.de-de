---
description: Wenn ein Benutzer mit der rechten Maustaste auf ein Shellobjekt klickt, enthält das Kontextmenü, das normalerweise angezeigt wird, normalerweise ein Eigenschaften Element.
title: Eigenschaften Blatt Handler
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 72233ab5-212d-498c-8df1-1a96c8eda892
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 40ccb8d1cee0fffb993aef417b979816597cf707
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "103866151"
---
# <a name="property-sheet-handlers"></a><span data-ttu-id="bf375-103">Eigenschaften Blatt Handler</span><span class="sxs-lookup"><span data-stu-id="bf375-103">Property Sheet Handlers</span></span>

<span data-ttu-id="bf375-104">Wenn ein Benutzer mit der rechten Maustaste auf ein Shellobjekt klickt, enthält das Kontextmenü, das normalerweise angezeigt wird, normalerweise ein **Eigenschaften** Element.</span><span class="sxs-lookup"><span data-stu-id="bf375-104">When a user right-clicks a Shell object, the shortcut menu that is displayed normally includes a **Properties** item.</span></span> <span data-ttu-id="bf375-105">Wenn Sie dieses Element auswählen, wird ein Eigenschaften Blatt gestartet, das es dem Benutzer ermöglicht, die Eigenschaften des Objekts anzuzeigen und in einigen Fällen zu ändern.</span><span class="sxs-lookup"><span data-stu-id="bf375-105">Selecting that item launches a property sheet that allows the user to view, and in some cases modify, the object's properties.</span></span> <span data-ttu-id="bf375-106">Sie können dieses Eigenschaften Blatt anpassen, indem Sie einen *Eigenschaften Blatt Handler* implementieren und registrieren.</span><span class="sxs-lookup"><span data-stu-id="bf375-106">You can customize this property sheet by implementing and registering a *property sheet handler*.</span></span>

<span data-ttu-id="bf375-107">Die allgemeinen Verfahren zum Implementieren und Registrieren eines Shellerweiterungs Handlers werden unter [Erstellen von Shellerweiterungs Handlern](handlers.md)erläutert.</span><span class="sxs-lookup"><span data-stu-id="bf375-107">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="bf375-108">Dieses Dokument konzentriert sich auf die Aspekte der Implementierung, die für Eigenschaften Blatt Handler spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="bf375-108">This document focuses on those aspects of implementation that are specific to property sheet handlers.</span></span>

-   [<span data-ttu-id="bf375-109">Funktionsweise von Eigenschaften Blatt Handlern</span><span class="sxs-lookup"><span data-stu-id="bf375-109">How Property Sheet Handlers Work</span></span>](#how-property-sheet-handlers-work)
-   [<span data-ttu-id="bf375-110">Registrieren und Implementieren eines Eigenschaften Blatt Handlers für ein bereitgestelltes Laufwerk</span><span class="sxs-lookup"><span data-stu-id="bf375-110">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>](#registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive)
-   [<span data-ttu-id="bf375-111">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="bf375-111">Related topics</span></span>](#related-topics)

## <a name="how-property-sheet-handlers-work"></a><span data-ttu-id="bf375-112">Funktionsweise von Eigenschaften Blatt Handlern</span><span class="sxs-lookup"><span data-stu-id="bf375-112">How Property Sheet Handlers Work</span></span>

<span data-ttu-id="bf375-113">Die folgende Abbildung zeigt das Eigenschaften Blatt "Eigenschaften" für eine Windows XP-Textdatei.</span><span class="sxs-lookup"><span data-stu-id="bf375-113">The following illustration shows the Properties property sheet for a Windows XP text file.</span></span>

![Eigenschaften Blatt](images/propsheethandler1.jpg)

<span data-ttu-id="bf375-115">Diese Abbildung zeigt das Eigenschaften Blatt für Standardeigenschaften, das für jede Datei angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="bf375-115">This illustration shows the default Properties property sheet that is displayed for any file.</span></span> <span data-ttu-id="bf375-116">Für viele dieser Eigenschaften Blätter können Sie dem Eigenschaften Blatt eine oder mehrere Seiten hinzufügen, indem Sie einen Eigenschaften Blatt Handler implementieren und registrieren.</span><span class="sxs-lookup"><span data-stu-id="bf375-116">For many such property sheets, you can add one or more pages to the property sheet by implementing and registering a property sheet handler.</span></span>

<span data-ttu-id="bf375-117">Eigenschaften Blatt Handler werden am häufigsten für einen [Dateityp](fa-file-types.md)registriert.</span><span class="sxs-lookup"><span data-stu-id="bf375-117">Property sheet handlers are most commonly registered for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="bf375-118">Jeder Handler kann dem Eigenschaften Blatt Eigenschaften für die Klasse eine benutzerdefinierte Seite hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="bf375-118">Each handler can add one custom page to the Properties property sheet for the class.</span></span> <span data-ttu-id="bf375-119">Diese Seiten geben Benutzern in der Regel Zugriff auf Eigenschaften, die für den jeweiligen Dateityp spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="bf375-119">These pages typically give users access to properties that are specific to the particular file type.</span></span> <span data-ttu-id="bf375-120">Ein Dateityp, der aus Textdokumenten besteht, könnte z. b. eine Seite anzeigen, auf der Titel und Autor aufgelistet sind, sowie eine abstrakte des Dokuments.</span><span class="sxs-lookup"><span data-stu-id="bf375-120">A file type consisting of text documents could, for instance, display a page that listed the title and author, and an abstract of the document.</span></span> <span data-ttu-id="bf375-121">Ein Sonderfall dieses Typs eines Eigenschaften Blatt Handlers wird verwendet, um dem Eigenschaften Blatt Eigenschaften für ein bereitgestelltes Laufwerk eine Seite hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="bf375-121">A special case of this type of property sheet handler is used to add a page to the Properties property sheet for a mounted drive.</span></span>

<span data-ttu-id="bf375-122">Die andere Verwendung für Eigenschaften Blatt Handler ist das Ersetzen von Seiten in den Eigenschaften Blättern, die von System Steuerungsanwendungen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="bf375-122">The other use for property sheet handlers is to replace pages in the property sheets displayed by Control Panel applications.</span></span> <span data-ttu-id="bf375-123">Ein Maus Hersteller kann z. b. einen Eigenschaften Blatt Handler verwenden, um die **Schalt** Flächen Seite auf dem Eigenschaften Blatt für die **Maus Eigenschaften** der Systemsteuerung durch eine Seite zu ersetzen, die für die Merkmale der Maus angepasst ist.</span><span class="sxs-lookup"><span data-stu-id="bf375-123">A mouse manufacturer, for instance, can use a property sheet handler to replace the **Buttons** page on the Control Panel's **Mouse Properties** property sheet with a page that is customized for the characteristics of its mouse.</span></span>

<span data-ttu-id="bf375-124">Wie bei allen Shellerweiterungs Handlern sind Eigenschaften Blatt Handler in-Process-Component Object Model (com)-Objekten, die als DLLs implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="bf375-124">Like all Shell extension handlers, property sheet handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="bf375-125">Zusätzlich zu [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown)müssen beide Schnittstellen exportiert werden: [**ishellextinit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) und [**ishellpropsheetext**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span><span class="sxs-lookup"><span data-stu-id="bf375-125">They must export two interfaces in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) and [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span></span>

<span data-ttu-id="bf375-126">Die [**ishellextinit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) -Schnittstelle wird von der Shell verwendet, um den Handler zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="bf375-126">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface is used by the Shell to initialize the handler.</span></span> <span data-ttu-id="bf375-127">Wenn die Shell [**ishellextinit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize)aufruft, übergibt Sie ein Datenobjekt mit dem Namen des Objekts und den Zeiger auf eine Element Bezeichner-Liste (PIDL) des Ordners, der die Datei enthält.</span><span class="sxs-lookup"><span data-stu-id="bf375-127">When the Shell calls [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), it passes in a data object with the object's name, and the pointer to an item identifier list (PIDL) of the folder that contains the file.</span></span> <span data-ttu-id="bf375-128">Der *hregkey* -Parameter wird nicht mit Eigenschaften Blatt Handlern verwendet.</span><span class="sxs-lookup"><span data-stu-id="bf375-128">The *hRegKey* parameter is not used with property sheet handlers.</span></span> <span data-ttu-id="bf375-129">Die **ishellextinit:: Initialize** -Methode muss den Dateinamen aus dem Datenobjekt extrahieren und den Namen und die PIDL des Ordners für die spätere Verwendung speichern.</span><span class="sxs-lookup"><span data-stu-id="bf375-129">The **IShellExtInit::Initialize** method must extract the file name from the data object, and store the name and the folder's PIDL for later use.</span></span> <span data-ttu-id="bf375-130">Weitere Informationen finden Sie unter [Erstellen von Shellerweiterungs Handlern](handlers.md)im Abschnitt *Implementieren von ishellextinit* .</span><span class="sxs-lookup"><span data-stu-id="bf375-130">For further details, see the *Implementing IShellExtInit* section of [Creating Shell Extension Handlers](handlers.md).</span></span>

<span data-ttu-id="bf375-131">Der Rest des Vorgangs erfolgt über die [**ishellpropsheetext**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) -Schnittstelle des Handlers.</span><span class="sxs-lookup"><span data-stu-id="bf375-131">The remainder of the operation takes place through the handler's [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface.</span></span> <span data-ttu-id="bf375-132">Wenn das Eigenschaften Blatt einem Dateityp zugeordnet ist, ruft die Shell [**ishellpropsheetext:: addPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) auf, damit der Handler dem Eigenschaften Blatt eine Seite hinzufügen kann.</span><span class="sxs-lookup"><span data-stu-id="bf375-132">If the property sheet is associated with a file type, the Shell calls [**IShellPropSheetExt::AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) to allow the handler to add a page to the property sheet.</span></span> <span data-ttu-id="bf375-133">Wenn das Eigenschaften Blatt einer System Steuerungsanwendung zugeordnet ist, ruft die Shell [**ishellpropsheetext:: replacepage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) auf, damit der Handler eine Seite ersetzen kann.</span><span class="sxs-lookup"><span data-stu-id="bf375-133">If the property sheet is associated with a Control Panel application, the Shell calls [**IShellPropSheetExt::ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) to allow the handler to replace a page.</span></span>

## <a name="registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive"></a><span data-ttu-id="bf375-134">Registrieren und Implementieren eines Eigenschaften Blatt Handlers für ein bereitgestelltes Laufwerk</span><span class="sxs-lookup"><span data-stu-id="bf375-134">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>

<span data-ttu-id="bf375-135">Jedes eingebundene Laufwerk verfügt über ein Eigenschaften Blatt, das vom Benutzer angezeigt werden kann.</span><span class="sxs-lookup"><span data-stu-id="bf375-135">Each mounted drive has a Properties sheet that can be displayed by the user.</span></span> <span data-ttu-id="bf375-136">In der folgenden Abbildung ist ein Eigenschaften Blatt für die Eigenschaften eines CD-ROM-Laufwerks dargestellt.</span><span class="sxs-lookup"><span data-stu-id="bf375-136">The following illustration shows a Properties property sheet for a CD-ROM drive.</span></span>

![Eigenschaften Blatt "CD-ROM-Eigenschaften"](images/propsheethandler2.jpg)

<span data-ttu-id="bf375-138">Es gibt eine Vielzahl von Geräten, die als Laufwerke bereitgestellt werden können.</span><span class="sxs-lookup"><span data-stu-id="bf375-138">There are a wide variety of devices that can be mounted as drives.</span></span> <span data-ttu-id="bf375-139">Da das Standardeigenschaften Blatt, das für Laufwerke konzipiert ist, bei manchen Geräten möglicherweise nicht ausreicht, kann ein Eigenschaften Blatt Handler implementiert werden, um eine Seite hinzuzufügen, die für das bereitgestellte Gerät spezifisch ist.</span><span class="sxs-lookup"><span data-stu-id="bf375-139">Because the default property sheet, designed for disk drives, might not be sufficient for some devices, a property sheet handler can be implemented to add a page that is specific to the mounted device.</span></span> <span data-ttu-id="bf375-140">Die grundlegende Implementierung dieses Typs von Eigenschaften Blatt Handlers ist identisch mit dem, der unter [registrieren und Implementieren eines Eigenschaften Blatt Handlers für einen Dateityp](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)mit zwei Ausnahmen erläutert wird.</span><span class="sxs-lookup"><span data-stu-id="bf375-140">The basic implementation of this type of property sheet handler is identical to that discussed in [How to Register and Implement a Property Sheet Handler for a File Type](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), with two exceptions.</span></span>

-   <span data-ttu-id="bf375-141">Das Datenobjekt, das an die [**ishellextinit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) -Methode des Handlers übermittelt wird, kann den Laufwerks Pfad im [cfstr \_ mountedvolume](clipboard.md) -Format anstelle des [CF- \_ HDROP](clipboard.md) -Formats enthalten.</span><span class="sxs-lookup"><span data-stu-id="bf375-141">The data object passed to the handler's [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method may contain the drive path in the [CFSTR\_MOUNTEDVOLUME](clipboard.md) format instead of the [CF\_HDROP](clipboard.md) format.</span></span> <span data-ttu-id="bf375-142">Das CF- \_ HDROP-Format wird verwendet, wenn das Gerät in einen Laufwerk Buchstaben eingebunden wird.</span><span class="sxs-lookup"><span data-stu-id="bf375-142">The CF\_HDROP format is used when the device is mounted to a drive letter.</span></span> <span data-ttu-id="bf375-143">Das Format cfstr \_ mountedvolume wird mit NTFS-Dateisystemen verwendet, wenn das Remote Gerät in einen Ordner und nicht in einen Laufwerk Buchstaben eingebunden wird.</span><span class="sxs-lookup"><span data-stu-id="bf375-143">The CFSTR\_MOUNTEDVOLUME format is used with NTFS file systems when the remote device is mounted to a folder rather than to a drive letter.</span></span>
-   <span data-ttu-id="bf375-144">Die GUID des Handlers wird unter dem **HKEY \_ - \_ Klassen** Stamm \\ **Laufwerk** \\ **shellex** \\ **propertysheethandlers** Key registriert.</span><span class="sxs-lookup"><span data-stu-id="bf375-144">The handler's GUID is registered under the **HKEY\_CLASSES\_ROOT**\\**Drive**\\**shellex**\\**PropertySheetHandlers** key.</span></span>

## <a name="related-topics"></a><span data-ttu-id="bf375-145">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="bf375-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bf375-146">Registrieren und Implementieren eines Eigenschaften Blatt Handlers für einen Dateityp</span><span class="sxs-lookup"><span data-stu-id="bf375-146">How to Register and Implement a Property Sheet Handler for a File Type</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)
</dt> <dt>

[<span data-ttu-id="bf375-147">Registrieren und Implementieren eines Eigenschaften Blatt Handlers für eine System Steuerungsanwendung</span><span class="sxs-lookup"><span data-stu-id="bf375-147">How to Register and Implement a Property Sheet Handler for a Control Panel Application</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-control-panel-application.md)
</dt> </dl>

 

 
