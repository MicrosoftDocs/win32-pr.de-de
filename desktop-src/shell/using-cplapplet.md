---
description: Vor Windows Vista haben Sie ein System Steuerungselement erstellt, indem Sie eine DLL-Datei erstellen und diese mit der Erweiterung. cpl benennen.
ms.assetid: 258dae28-c054-4392-b0e9-99493f23c814
title: Verwenden von CPlApplet
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b1e59b29dd7c082822ed63d425dd4967a542b5d1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104979480"
---
# <a name="using-cplapplet"></a><span data-ttu-id="06cdc-103">Verwenden von CPlApplet</span><span class="sxs-lookup"><span data-stu-id="06cdc-103">Using CPLApplet</span></span>

<span data-ttu-id="06cdc-104">Vor Windows Vista haben Sie ein System Steuerungselement erstellt, indem Sie eine DLL-Datei erstellen und diese mit der Erweiterung. cpl benennen.</span><span class="sxs-lookup"><span data-stu-id="06cdc-104">Prior to Windows Vista, you created a Control Panel item by creating a .dll file and naming it with a .cpl extension.</span></span> <span data-ttu-id="06cdc-105">Diese Datei hat die [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) -Funktion exportiert.</span><span class="sxs-lookup"><span data-stu-id="06cdc-105">This file exported the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function.</span></span> <span data-ttu-id="06cdc-106">Dieses Schema wird weiterhin in Windows Vista und höheren Versionen unterstützt und wird in diesem Thema erläutert.</span><span class="sxs-lookup"><span data-stu-id="06cdc-106">This scheme is still supported in Windows Vista and later versions and is discussed in this topic.</span></span> <span data-ttu-id="06cdc-107">Die Richtlinien für neue System Steuerungselemente empfehlen jedoch einen einfacheren Ansatz mit dem System Steuerungselement, das als exe-Datei erstellt wurde, die ein Layout für den Aufgaben Fluss verwendet.</span><span class="sxs-lookup"><span data-stu-id="06cdc-107">However, the guidelines for new Control Panel items recommend a simpler approach with the Control Panel item built as a .exe file that uses a task flow layout.</span></span>

<span data-ttu-id="06cdc-108">Wenn die Systemsteuerung eine DLL-Datei (oder. cpl) lädt, ruft Sie die [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) -Funktion auf, um Informationen wie die Anzahl der System Steuerungselemente, die die Datei hostet, sowie Informationen zu den einzelnen Elementen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="06cdc-108">When Control Panel loads a .dll (or .cpl) file, it calls the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function to get information such as the number of Control Panel items the file hosts, as well as information about each item.</span></span> <span data-ttu-id="06cdc-109">Die Systemsteuerung ruft auch die-Funktion auf, wenn das Element Fenster initialisiert, geöffnet oder geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="06cdc-109">Control Panel also calls the function when the item's window is initialized, opened, or closed.</span></span>

<span data-ttu-id="06cdc-110">Wenn Windows das System Steuerungselement zum ersten Mal lädt, ruft es die Adresse der [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) -Funktion ab und verwendet diese Adresse anschließend zum Abrufen der Funktion und zum Übergeben von Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="06cdc-110">When Windows first loads the Control Panel item, it retrieves the address of the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function and subsequently uses that address to call the function and pass it messages.</span></span> <span data-ttu-id="06cdc-111">Möglicherweise werden die folgenden Nachrichten gesendet.</span><span class="sxs-lookup"><span data-stu-id="06cdc-111">It might send the following messages.</span></span>



| <span data-ttu-id="06cdc-112">`Message`</span><span class="sxs-lookup"><span data-stu-id="06cdc-112">Message</span></span>                                     | <span data-ttu-id="06cdc-113">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="06cdc-113">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="06cdc-114">**CPL- \_ dblclk**</span><span class="sxs-lookup"><span data-stu-id="06cdc-114">**CPL\_DBLCLK**</span></span>](cpl-dblclk.md)           | <span data-ttu-id="06cdc-115">Wird gesendet, um [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) zu benachrichtigen, dass der Benutzer das Symbol ausgewählt hat, das einem bestimmten System Steuerungselement zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="06cdc-115">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given Control Panel item.</span></span> <span data-ttu-id="06cdc-116">**CPlApplet** sollte das Dialogfeld für das angegebene Element anzeigen und alle benutzerdefinierten Tasks ausführen.</span><span class="sxs-lookup"><span data-stu-id="06cdc-116">**CPlApplet** should display the dialog box for the specified item and carry out any user-specified tasks.</span></span> <span data-ttu-id="06cdc-117">Der **CPlApplet** *lParam1* -Parameter ist eine ganze Zahl, die den NULL basierten Index des System Steuerungs Elements darstellt.</span><span class="sxs-lookup"><span data-stu-id="06cdc-117">The **CPlApplet** *lParam1* parameter is an integer that represents the zero-based index of the Control Panel item.</span></span> <span data-ttu-id="06cdc-118">Der *lParam2* -Parameter ist der **lpdata** -Zeiger, der in der [**cplinfo**](/windows/win32/api/cpl/ns-cpl-cplinfo) -oder [**newcplinfo**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) -Struktur in der [**cpl \_**](cpl-inquire.md) -oder der [**cpl- \_ newinquire**](cpl-newinquire.md) -Nachricht zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="06cdc-118">The *lParam2* parameter is the **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="06cdc-119">Der Rückgabewert wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="06cdc-119">The return value is ignored.</span></span>                                                                |
| [<span data-ttu-id="06cdc-120">**CPL- \_ Exit**</span><span class="sxs-lookup"><span data-stu-id="06cdc-120">**CPL\_EXIT**</span></span>](cpl-exit.md)               | <span data-ttu-id="06cdc-121">Wird nach der letzten cpl \_ -Stoppnachricht gesendet, und unmittelbar bevor Windows die [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) -Funktion verwendet, um die dll freizugeben, die das System Steuerungselement enthält.</span><span class="sxs-lookup"><span data-stu-id="06cdc-121">Sent after the last CPL\_STOP message and immediately before Windows uses the [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) function to free the DLL that contains the Control Panel item.</span></span> <span data-ttu-id="06cdc-122">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) muss den verbleibenden Arbeitsspeicher freigeben und die Schließung vorbereiten.</span><span class="sxs-lookup"><span data-stu-id="06cdc-122">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any remaining memory and prepare to close.</span></span> <span data-ttu-id="06cdc-123">Der Rückgabewert wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="06cdc-123">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="06cdc-124">**CPL- \_ GetCount**</span><span class="sxs-lookup"><span data-stu-id="06cdc-124">**CPL\_GETCOUNT**</span></span>](cpl-getcount.md)       | <span data-ttu-id="06cdc-125">Wird nach der CPL- \_ Init-Nachricht gesendet, um [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) aufzufordern, eine Zahl zurückzugeben, die angibt, wie viele Unterprogramme unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="06cdc-125">Sent after the CPL\_INIT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to return a number that indicates how many subprograms it supports.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="06cdc-126">**CPL- \_ Init**</span><span class="sxs-lookup"><span data-stu-id="06cdc-126">**CPL\_INIT**</span></span>](cpl-init.md)               | <span data-ttu-id="06cdc-127">Wird unmittelbar nach dem Laden der dll, die das System Steuerungselement enthält, gesendet.</span><span class="sxs-lookup"><span data-stu-id="06cdc-127">Sent immediately after the DLL that contains the Control Panel item is loaded.</span></span> <span data-ttu-id="06cdc-128">In der Meldung wird [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) aufgefordert, Initialisierungs Prozeduren auszuführen, einschließlich der Speicher Belegung.</span><span class="sxs-lookup"><span data-stu-id="06cdc-128">The message prompts [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to perform initialization procedures, including memory allocation.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="06cdc-129">**CPL- \_ Anfrage**</span><span class="sxs-lookup"><span data-stu-id="06cdc-129">**CPL\_INQUIRE**</span></span>](cpl-inquire.md)         | <span data-ttu-id="06cdc-130">Wird nach der CPL- \_ GetCount-Nachricht gesendet, um [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) aufzufordern, Informationen zu einem angegebenen untergeordneten Programm bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="06cdc-130">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified subprogram.</span></span> <span data-ttu-id="06cdc-131">Der *lParam1* -Wert ist eine ganze Zahl, die den NULL basierten Index des Unterprogramms darstellt, über das Informationen angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="06cdc-131">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="06cdc-132">Der *lParam2* -Parameter von **CPlApplet** verweist auf eine [**cplinfo**](/windows/win32/api/cpl/ns-cpl-cplinfo) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="06cdc-132">The *lParam2* parameter of **CPlApplet** points to a [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) structure.</span></span> <span data-ttu-id="06cdc-133">Der Rückgabewert wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="06cdc-133">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="06cdc-134">**CPL- \_ Netzdatei**</span><span class="sxs-lookup"><span data-stu-id="06cdc-134">**CPL\_NEWINQUIRE**</span></span>](cpl-newinquire.md)   | <span data-ttu-id="06cdc-135">Wird nach der CPL- \_ GetCount-Nachricht gesendet, um [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) aufzufordern, Informationen zu einem angegebenen System Steuerungselement bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="06cdc-135">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified Control Panel item.</span></span> <span data-ttu-id="06cdc-136">Der *lParam1* -Wert ist eine ganze Zahl, die den NULL basierten Index des Unterprogramms darstellt, über das Informationen angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="06cdc-136">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="06cdc-137">Der *lParam2* -Parameter ist ein Zeiger auf eine [**newcplinfo**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="06cdc-137">The *lParam2* parameter is a pointer to a [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure.</span></span> <span data-ttu-id="06cdc-138">CPL- \_ netwinquire sollte normalerweise ignoriert werden.</span><span class="sxs-lookup"><span data-stu-id="06cdc-138">CPL\_NEWINQUIRE normally should be ignored.</span></span> <span data-ttu-id="06cdc-139">In Ihrer Anwendung sollten nur cpl- \_ Anfragen auf Windows 95, Microsoft Windows NT 4,0 und höher verarbeitet werden, da die System Steuerungs Leistung bei Verwendung von cpl- \_ netzwinquire beeinträchtigt ist.</span><span class="sxs-lookup"><span data-stu-id="06cdc-139">Your application should process only CPL\_INQUIRE on Windows 95, Microsoft Windows NT 4.0, and later systems since Control Panel performance suffers when CPL\_NEWINQUIRE is used.</span></span> <span data-ttu-id="06cdc-140">Dies liegt daran, dass die zurückgegebenen Zeichen folgen und Symbole nicht zwischengespeichert werden können.</span><span class="sxs-lookup"><span data-stu-id="06cdc-140">This is because the returned strings and icons cannot be cached.</span></span> <span data-ttu-id="06cdc-141">Der Rückgabewert wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="06cdc-141">The return value is ignored.</span></span> |
| [<span data-ttu-id="06cdc-142">**CPL- \_ Auswahl**</span><span class="sxs-lookup"><span data-stu-id="06cdc-142">**CPL\_SELECT**</span></span>](cpl-select.md)           | <span data-ttu-id="06cdc-143">Veraltet.</span><span class="sxs-lookup"><span data-stu-id="06cdc-143">Obsolete.</span></span> <span data-ttu-id="06cdc-144">Diese Meldung wird von den aktuellen Versionen von Windows nicht gesendet.</span><span class="sxs-lookup"><span data-stu-id="06cdc-144">Current versions of Windows do not send this message.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="06cdc-145">**CPL \_ startwparamems**</span><span class="sxs-lookup"><span data-stu-id="06cdc-145">**CPL\_STARTWPARMS**</span></span>](cpl-startwparms.md) | <span data-ttu-id="06cdc-146">Wird gesendet, um das [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) zu benachrichtigen, dass der Benutzer das Symbol ausgewählt hat, das einem bestimmten Dialogfeld zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="06cdc-146">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given dialog box.</span></span> <span data-ttu-id="06cdc-147">**CPlApplet** sollte das entsprechende Dialogfeld anzeigen und alle benutzerdefinierten Tasks ausführen.</span><span class="sxs-lookup"><span data-stu-id="06cdc-147">**CPlApplet** should display the corresponding dialog box and carry out any user-specified tasks.</span></span> <span data-ttu-id="06cdc-148">Diese Meldung ähnelt cpl \_ dblclk, es gibt jedoch möglicherweise weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="06cdc-148">This message is similar to CPL\_DBLCLK, but there might be some additional information.</span></span> <span data-ttu-id="06cdc-149">Der *lParam1* -Parameter ist die System Steuerungselement-Nummer, und *lParam2* ist ein **LPCTSTR** zu allen zusätzlichen Richtungen, die ggf. erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="06cdc-149">The *lParam1* parameter is the Control Panel item number and *lParam2* is an **LPCTSTR** to any extra directions that might be necessary.</span></span> <span data-ttu-id="06cdc-150">Gibt **true** zurück, wenn diese Nachricht verarbeitet wird. andernfalls **false**.</span><span class="sxs-lookup"><span data-stu-id="06cdc-150">Return **TRUE** if this message is handled; otherwise, **FALSE**.</span></span> <span data-ttu-id="06cdc-151">Diese Nachricht ist für die [Version 5,00](versions.md) und höher von Shell32.dll gültig.</span><span class="sxs-lookup"><span data-stu-id="06cdc-151">This message is valid for [version 5.00](versions.md) and later of Shell32.dll.</span></span>                                                                                         |
| [<span data-ttu-id="06cdc-152">**CPL- \_ Beendigung**</span><span class="sxs-lookup"><span data-stu-id="06cdc-152">**CPL\_STOP**</span></span>](cpl-stop.md)               | <span data-ttu-id="06cdc-153">Wird einmal für jedes System Steuerungselement in der CPL-Datei gesendet, bevor Windows die System Steuerungs Erweiterung entlädt.</span><span class="sxs-lookup"><span data-stu-id="06cdc-153">Sent once for each Control Panel item in the .cpl file before Windows unloads the Control Panel extension.</span></span> <span data-ttu-id="06cdc-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) sollte jeden Arbeitsspeicher freigeben, der der in *lParam1* angegebenen Element Nummer zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="06cdc-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any memory associated with the item number provided in *lParam1*.</span></span> <span data-ttu-id="06cdc-155">Der *lParam2* -Parameter ist ein **lpdata** -Zeiger, der in der [**cplinfo**](/windows/win32/api/cpl/ns-cpl-cplinfo) -oder [**newcplinfo**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) -Struktur in der [**cpl \_**](cpl-inquire.md) -oder der [**cpl- \_ newinferenzierung**](cpl-newinquire.md) zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="06cdc-155">The *lParam2* parameter is **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="06cdc-156">Der Rückgabewert wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="06cdc-156">The return value is ignored.</span></span>                                                                                                                                                                                                       |



 

## <a name="related-topics"></a><span data-ttu-id="06cdc-157">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="06cdc-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="06cdc-158">System Steuerungselemente</span><span class="sxs-lookup"><span data-stu-id="06cdc-158">Control Panel Items</span></span>](control-panel-applications.md)
</dt> <dt>

[<span data-ttu-id="06cdc-159">Richtlinien zur Benutzerfreundlichkeit</span><span class="sxs-lookup"><span data-stu-id="06cdc-159">User Experience Guidelines</span></span>](user-experience-guidelines.md)
</dt> <dt>

[<span data-ttu-id="06cdc-160">System Steuerungselemente werden registriert</span><span class="sxs-lookup"><span data-stu-id="06cdc-160">Registering Control Panel Items</span></span>](registering-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="06cdc-161">Nachrichtenverarbeitung in der Systemsteuerung</span><span class="sxs-lookup"><span data-stu-id="06cdc-161">Control Panel Message Processing</span></span>](message-processing.md)
</dt> <dt>

[<span data-ttu-id="06cdc-162">Ausführen von System Steuerungselementen</span><span class="sxs-lookup"><span data-stu-id="06cdc-162">Executing Control Panel Items</span></span>](executing-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="06cdc-163">Erweitern von System Steuerungselementen</span><span class="sxs-lookup"><span data-stu-id="06cdc-163">Extending System Control Panel Items</span></span>](extending-system-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="06cdc-164">Zuweisen von System Steuerungs Kategorien</span><span class="sxs-lookup"><span data-stu-id="06cdc-164">Assigning Control Panel Categories</span></span>](assigning-control-panel-categories.md)
</dt> <dt>

[<span data-ttu-id="06cdc-165">Erstellen von durchsuchbaren Aufgaben Verknüpfungen für ein System Steuerungselement</span><span class="sxs-lookup"><span data-stu-id="06cdc-165">Creating Searchable Task Links for a Control Panel Item</span></span>](creating-searchable-task-links.md)
</dt> <dt>

[<span data-ttu-id="06cdc-166">Zugreifen auf die Systemsteuerung im abgesicherten Modus unter Windows Vista</span><span class="sxs-lookup"><span data-stu-id="06cdc-166">Accessing the Control Panel in Safe Mode under Windows Vista</span></span>](accessing-the-cp-in-safe-mode-under-vista.md)
</dt> </dl>

 

 
