---
description: App-Benutzer Modell-IDs (appusermudelids) werden von der Taskleiste in Windows 7-Systemen und späteren Systemen ausgiebig verwendet, um Prozesse, Dateien und Fenster einer bestimmten Anwendung zuzuordnen.
ms.assetid: ebce2d99-6f20-4545-9f12-d79cd8d0828f
title: Anwendungs Benutzer Modell-IDs (appusermudelids)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 46b79f0bdd7fb5e6c4d5c41caa3cd6be3f4fb57e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104525415"
---
# <a name="application-user-model-ids-appusermodelids"></a><span data-ttu-id="dabd3-103">Anwendungs Benutzer Modell-IDs (appusermudelids)</span><span class="sxs-lookup"><span data-stu-id="dabd3-103">Application User Model IDs (AppUserModelIDs)</span></span>

<span data-ttu-id="dabd3-104">App-Benutzer Modell-IDs (appusermudelids) werden von der Taskleiste in Windows 7-Systemen und späteren Systemen ausgiebig verwendet, um Prozesse, Dateien und Fenster einer bestimmten Anwendung zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-104">Application User Model IDs (AppUserModelIDs) are used extensively by the taskbar in Windows 7 and later systems to associate processes, files, and windows with a particular application.</span></span> <span data-ttu-id="dabd3-105">In einigen Fällen ist es ausreichend, die interne appusermodelid zu verlassen, die einem Prozess vom System zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="dabd3-105">In some cases, it is sufficient to rely on the internal AppUserModelID assigned to a process by the system.</span></span> <span data-ttu-id="dabd3-106">Allerdings muss eine Anwendung, die über mehrere Prozesse oder eine Anwendung verfügt, die in einem Host Prozess ausgeführt wird, möglicherweise explizit identifiziert werden, damit Sie die ansonsten ungleichen Fenster unter einer einzigen Task leisten Schaltfläche gruppieren und den Inhalt der Sprung Liste der Anwendung steuern kann.</span><span class="sxs-lookup"><span data-stu-id="dabd3-106">However, an application that owns multiple processes or an application that is running in a host process might need to explicitly identify itself so that it can group its otherwise disparate windows under a single taskbar button and control the contents of that application's Jump List.</span></span>

-   [<span data-ttu-id="dabd3-107">Anwendungs definierte und System-Defined appusermudelids</span><span class="sxs-lookup"><span data-stu-id="dabd3-107">Application-Defined and System-Defined AppUserModelIDs</span></span>](#application-defined-and-system-defined-appusermodelids)
-   [<span data-ttu-id="dabd3-108">So erstellen Sie eine Application-Defined "appusermodelid"</span><span class="sxs-lookup"><span data-stu-id="dabd3-108">How to Form an Application-Defined AppUserModelID</span></span>](#how-to-form-an-application-defined-appusermodelid)
-   [<span data-ttu-id="dabd3-109">Wo eine appusermodelid zugewiesen werden soll</span><span class="sxs-lookup"><span data-stu-id="dabd3-109">Where to Assign an AppUserModelID</span></span>](#where-to-assign-an-appusermodelid)
-   [<span data-ttu-id="dabd3-110">Registrieren einer Anwendung als Host Prozess</span><span class="sxs-lookup"><span data-stu-id="dabd3-110">Registering an Application as a Host Process</span></span>](#registering-an-application-as-a-host-process)
-   [<span data-ttu-id="dabd3-111">Ausschluss Listen für das Anheften und aktuelle/häufige Listen der Taskleiste</span><span class="sxs-lookup"><span data-stu-id="dabd3-111">Exclusion Lists for Taskbar Pinning and Recent/Frequent Lists</span></span>](#exclusion-lists-for-taskbar-pinning-and-recentfrequent-lists)
-   [<span data-ttu-id="dabd3-112">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="dabd3-112">Related topics</span></span>](#related-topics)

## <a name="application-defined-and-system-defined-appusermodelids"></a><span data-ttu-id="dabd3-113">Application-Defined und System-Defined appusermudelids</span><span class="sxs-lookup"><span data-stu-id="dabd3-113">Application-Defined and System-Defined AppUserModelIDs</span></span>

<span data-ttu-id="dabd3-114">Einige Anwendungen deklarieren keine explizite appusermodelid.</span><span class="sxs-lookup"><span data-stu-id="dabd3-114">Some applications do not declare an explicit AppUserModelID.</span></span> <span data-ttu-id="dabd3-115">Sie sind optional.</span><span class="sxs-lookup"><span data-stu-id="dabd3-115">They are optional.</span></span> <span data-ttu-id="dabd3-116">In diesem Fall verwendet das System eine Reihe von Heuristik, um eine interne appusermodelid zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-116">In that case, the system uses a series of heuristics to assign an internal AppUserModelID.</span></span> <span data-ttu-id="dabd3-117">Es gibt jedoch einen Leistungsvorteil, wenn diese Berechnungen vermieden werden und eine explizite appusermodelid die einzige Möglichkeit ist, eine exakte Benutzererfahrung zu gewährleisten.</span><span class="sxs-lookup"><span data-stu-id="dabd3-117">However, there is a performance benefit in avoiding those calculations and an explicit AppUserModelID is the only way to guarantee an exact user experience.</span></span> <span data-ttu-id="dabd3-118">Daher wird dringend empfohlen, eine explizite ID festzulegen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-118">Therefore, it is strongly recommended that an explicit ID be set.</span></span> <span data-ttu-id="dabd3-119">Anwendungen können keine vom System zugewiesene appusermodelid abrufen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-119">Applications cannot retrieve a system-assigned AppUserModelID.</span></span>

<span data-ttu-id="dabd3-120">Wenn eine Anwendung eine explizite appusermodelid verwendet, muss Sie auch allen laufenden Fenstern oder Prozessen, Verknüpfungen und Dateizuordnungen dieselbe appusermodelid zuweisen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-120">If an application uses an explicit AppUserModelID, it must also assign the same AppUserModelID to all running windows or processes, shortcuts, and file associations.</span></span> <span data-ttu-id="dabd3-121">Außerdem muss diese appusermodelid verwendet werden, wenn die Sprung Liste über [**ICustomDestinationList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icustomdestinationlist)und in allen Aufrufen von " [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs)" angepasst wird.</span><span class="sxs-lookup"><span data-stu-id="dabd3-121">It must also use that AppUserModelID when customizing its Jump List through [**ICustomDestinationList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icustomdestinationlist), and in any calls to [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span></span>

> [!Note]  
> <span data-ttu-id="dabd3-122">Wenn Anwendungen nicht über eine explizite appusermodelid verfügen, müssen Sie die Methoden " [**iapplicationdestination**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdestinations)", " [**iapplicationdocumentlists**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdocumentlists)" und " [**ICustomDestinationList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icustomdestinationlist) " sowie " [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs) " innerhalb der Anwendung abrufen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-122">If applications do not have an explicit AppUserModelID, they must call [**IApplicationDestinations**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdestinations), [**IApplicationDocumentLists**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdocumentlists), and [**ICustomDestinationList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icustomdestinationlist) methods as well as [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs) from within the application.</span></span> <span data-ttu-id="dabd3-123">Wenn diese Methoden von einem anderen Prozess aufgerufen werden, z. b. einem Installationsprogramm oder einem Deinstallationsprogramm, kann das System nicht die richtige appusermodelid generieren, und diese Aufrufe haben keine Auswirkung.</span><span class="sxs-lookup"><span data-stu-id="dabd3-123">If those methods are called from another process, such as an installer or uninstaller, the system cannot generate the correct AppUserModelID and those calls will have no effect.</span></span>

 

<span data-ttu-id="dabd3-124">Die folgenden Elemente beschreiben allgemeine Szenarien, die eine explizite appusermodelid erfordern.</span><span class="sxs-lookup"><span data-stu-id="dabd3-124">The following items describe common scenarios that require an explicit AppUserModelID.</span></span> <span data-ttu-id="dabd3-125">Außerdem zeigen Sie auf Fälle, in denen mehrere explizite appusermudelids verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-125">They also point out cases where multiple explicit AppUserModelIDs should be used.</span></span>

-   <span data-ttu-id="dabd3-126">Bei einer einzelnen ausführbaren Datei mit einer Benutzeroberfläche mit mehreren Modi, die dem Benutzer als separate Anwendungen angezeigt wird, sollten jedem Modus unterschiedliche appusermudelids zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-126">A single executable file with a UI with multiple modes that appear to the user as separate applications should assign different AppUserModelIDs to each mode.</span></span> <span data-ttu-id="dabd3-127">Beispielsweise sollte ein Teil einer Anwendung, der Benutzern als unabhängige Umgebung angezeigt wird, die Sie an die Taskleiste anheften und von der restlichen Anwendung aus starten können, über eine eigene appusermodelid verfügen, die von der Haupterfahrung getrennt ist.</span><span class="sxs-lookup"><span data-stu-id="dabd3-127">For instance, a portion of an application that users see as an independent experience that they can pin to and launch from the taskbar separately from the rest of the application should have its own AppUserModelID, separate from the main experience.</span></span>
-   <span data-ttu-id="dabd3-128">Mehrere Verknüpfungen mit unterschiedlichen Argumenten, die dazu führen, dass der Benutzer als dieselbe Anwendung angezeigt wird, sollten eine appusermodelid für alle Tastenkombinationen verwenden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-128">Multiple shortcuts with different arguments that all lead to what the user sees as the same application should use one AppUserModelID for all of the shortcuts.</span></span> <span data-ttu-id="dabd3-129">Windows Internet Explorer verfügt beispielsweise über unterschiedliche Verknüpfungen für verschiedene Modi (z. b. das Starten ohne Add-ons), aber Sie sollten für den Benutzer als eine einzelne Internet Explorer-Instanz angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-129">For example, Windows Internet Explorer has different shortcuts for different modes (such as launching without add-ons) but they should all appear to the user as a single Internet Explorer instance.</span></span>
-   <span data-ttu-id="dabd3-130">Eine ausführbare Datei, die als Host Prozess fungiert und Ziel Inhalt ausführt, da sich eine Anwendung als [Host Anwendung registrieren](#registering-an-application-as-a-host-process)muss. Anschließend kann Sie jeder erkannten Erfahrung, die Sie hostet, unterschiedliche appusermudelids zuweisen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-130">An executable that acts as a host process and runs target content as an application must [register as a host application](#registering-an-application-as-a-host-process), after which it can assign different AppUserModelIDs to each perceived experience that it hosts.</span></span> <span data-ttu-id="dabd3-131">Alternativ kann der Host Prozess dem gehosteten Programm ermöglichen, seine appusermudelids festzulegen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-131">Alternately, the host process can allow the hosted program to set its AppUserModelIDs.</span></span> <span data-ttu-id="dabd3-132">In jedem Fall muss der Host Prozess einen Datensatz der Quelle der appusermudelids (entweder selbst oder die gehostete Anwendung) beibehalten.</span><span class="sxs-lookup"><span data-stu-id="dabd3-132">In either case, the host process must keep a record of the source of the AppUserModelIDs, either itself or the hosted application.</span></span> <span data-ttu-id="dabd3-133">In diesem Fall gibt es keine primäre Benutzer Darstellung des Host Prozesses ohne den Ziel Inhalt.</span><span class="sxs-lookup"><span data-stu-id="dabd3-133">In this case, there is no primary user experience of the host process without the target content.</span></span> <span data-ttu-id="dabd3-134">Beispiele hierfür sind lokale Windows-Remote Anwendungen (Rail), die Java-Laufzeit, RunDLL32.exe oder DLLHost.exe.</span><span class="sxs-lookup"><span data-stu-id="dabd3-134">Examples are Windows Remote Applications Integrated Locally (RAIL) applications, the Java Runtime, RunDLL32.exe, or DLLHost.exe.</span></span>

    <span data-ttu-id="dabd3-135">Im Fall vorhandener gehosteter Anwendungen versucht das System, individuelle Erfahrungen zu identifizieren, aber neue Anwendungen sollten explizite appusermudelids verwenden, um die gewünschte Benutzererfahrung zu gewährleisten.</span><span class="sxs-lookup"><span data-stu-id="dabd3-135">In the case of existing hosted applications, the system attempts to identify individual experiences, but new applications should use explicit AppUserModelIDs to guarantee the intended user experience.</span></span>

-   <span data-ttu-id="dabd3-136">Kooperative oder verkettete Prozesse, die an den Benutzer Teil derselben Anwendung sind, sollten die gleiche appusermodelid für jeden Prozess anwenden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-136">Cooperative or chained processes that to the user are part of the same application should have the same AppUserModelID applied to each process.</span></span> <span data-ttu-id="dabd3-137">Beispiele hierfür sind Spiele mit einem Start Programmprozess (verkettete) und Microsoft Windows-Media Player, die in einem einzigen Prozess ausgeführt werden können, und die Hauptanwendung, die in einem anderen Prozess ausgeführt wird (kooperativ).</span><span class="sxs-lookup"><span data-stu-id="dabd3-137">Examples include games with a launcher process (chained) and Microsoft Windows Media Player, which has a first-run/setup experience running in one process and the main application running in another process (cooperative).</span></span>
-   <span data-ttu-id="dabd3-138">Eine Erweiterung des Shell-Namespace, die als separate Anwendung für mehr als das Durchsuchen und Verwalten von Inhalten in Windows-Explorer fungiert, sollte in den Ordnereigenschaften eine appusermodelid zuweisen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-138">A Shell namespace extension that acts as a separate application for more than browsing and managing content in Windows Explorer should assign an AppUserModelID in its folder properties.</span></span> <span data-ttu-id="dabd3-139">Ein Beispiel hierfür ist die Systemsteuerung.</span><span class="sxs-lookup"><span data-stu-id="dabd3-139">An example is the Control Panel.</span></span>
-   <span data-ttu-id="dabd3-140">In einer Virtualisierungsumgebung, wie z. b. einem Bereitstellungs Framework, sollte die Virtualisierungsumgebung jeder verwalteten Anwendung verschiedene appusermudelids zuweisen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-140">In a virtualization environment such as a deployment framework, the virtualization environment should assign different AppUserModelIDs to each application that it manages.</span></span> <span data-ttu-id="dabd3-141">In diesen Fällen verwendet ein Anwendungs Starter einen Vermittler Prozess zum Einrichten der Umgebung und übergibt dann den Vorgang an einen anderen Prozess zum Ausführen der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="dabd3-141">In these cases, an application launcher uses an intermediary process to set up the environment and then hands off the operation to a different process to run the application.</span></span> <span data-ttu-id="dabd3-142">Beachten Sie, dass das System dazu führt, dass der laufende Ziel Prozess nicht wieder mit der Verknüpfung verknüpft wird, da die Verknüpfung auf den Vermittler Prozess verweist.</span><span class="sxs-lookup"><span data-stu-id="dabd3-142">Note that this causes the system to be unable to relate the running target process back to the shortcut because the shortcut points to the intermediary process.</span></span>

    <span data-ttu-id="dabd3-143">Wenn eine Anwendung über mehrere Fenster, Verknüpfungen oder Prozesse verfügt, sollte die zugewiesene appusermodelid der Anwendung auch auf jedes dieser Teile von der Virtualisierungsumgebung angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-143">If any application has multiple windows, shortcuts, or processes, that application's assigned AppUserModelID should also be applied to each of those pieces by the virtualization environment.</span></span>

    <span data-ttu-id="dabd3-144">Ein Beispiel für diese Situation ist das ClickOnce-Framework, das appusermudelids ordnungsgemäß für die von ihm verwalteten Anwendungen zuweist.</span><span class="sxs-lookup"><span data-stu-id="dabd3-144">An example of this situation is the ClickOnce framework, which properly assigns AppUserModelIDs on behalf of the applications that it manages.</span></span> <span data-ttu-id="dabd3-145">Wie in allen solchen Umgebungen sollten Anwendungen, die von ClickOnce bereitgestellt und verwaltet werden, keine expliziten appusermudelids selbst zuweisen, da dies mit den von ClickOnce zugewiesenen appusermudelids in Konflikt steht und zu unerwarteten Ergebnissen führt.</span><span class="sxs-lookup"><span data-stu-id="dabd3-145">As in all such environments, applications deployed and managed by ClickOnce should not assign explicit AppUserModelIDs themselves, because doing so will conflict with the AppUserModelIDs assigned by ClickOnce and lead to unexpected results.</span></span>

## <a name="how-to-form-an-application-defined-appusermodelid"></a><span data-ttu-id="dabd3-146">So erstellen Sie eine Application-Defined "appusermodelid"</span><span class="sxs-lookup"><span data-stu-id="dabd3-146">How to Form an Application-Defined AppUserModelID</span></span>

<span data-ttu-id="dabd3-147">Eine Anwendung muss Ihre appusermodelid in der folgenden Form bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-147">An application must provide its AppUserModelID in the following form.</span></span> <span data-ttu-id="dabd3-148">Er darf nicht mehr als 128 Zeichen enthalten und darf keine Leerzeichen enthalten.</span><span class="sxs-lookup"><span data-stu-id="dabd3-148">It can have no more than 128 characters and cannot contain spaces.</span></span> <span data-ttu-id="dabd3-149">Jeder Abschnitt sollte mit Pascal-Schreib-und Schreib vor.</span><span class="sxs-lookup"><span data-stu-id="dabd3-149">Each section should be pascal-cased.</span></span>

`CompanyName.ProductName.SubProduct.VersionInformation`

<span data-ttu-id="dabd3-150">`CompanyName` und `ProductName` sollten immer verwendet werden, während die `SubProduct` `VersionInformation` Teile und optional sind und abhängig von den Anforderungen der Anwendung sind.</span><span class="sxs-lookup"><span data-stu-id="dabd3-150">`CompanyName` and `ProductName` should always be used, while the `SubProduct` and `VersionInformation` portions are optional and depend on the application's requirements.</span></span> <span data-ttu-id="dabd3-151">`SubProduct` ermöglicht einer Hauptanwendung, die aus mehreren untergeordneten Anwendungen besteht, eine separate Task leisten Schaltfläche für jede unter Anwendung und die zugehörigen Fenster bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-151">`SubProduct` allows a main application that consists of several subapplications to provide a separate taskbar button for each subapplication and its associated windows.</span></span> <span data-ttu-id="dabd3-152">`VersionInformation` ermöglicht die Koexistenz zweier Versionen einer Anwendung, während Sie als diskrete Entitäten betrachtet werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-152">`VersionInformation` allows two versions of an application to coexist while being seen as discrete entities.</span></span> <span data-ttu-id="dabd3-153">Wenn eine Anwendung nicht auf diese Weise verwendet werden soll, `VersionInformation` sollte ausgelassen werden, damit eine aktualisierte Version die gleiche appusermodelid wie die von ihr ersetzte Version verwenden kann.</span><span class="sxs-lookup"><span data-stu-id="dabd3-153">If an application is not intended to be used in that way, the `VersionInformation` should be omitted so that an upgraded version can use the same AppUserModelID as the version that it replaced.</span></span>

## <a name="where-to-assign-an-appusermodelid"></a><span data-ttu-id="dabd3-154">Wo eine appusermodelid zugewiesen werden soll</span><span class="sxs-lookup"><span data-stu-id="dabd3-154">Where to Assign an AppUserModelID</span></span>

<span data-ttu-id="dabd3-155">Wenn eine Anwendung eine oder mehrere explizite appusermudelids verwendet, sollte diese appusermudelids an den folgenden Orten und Situationen angewendet werden:</span><span class="sxs-lookup"><span data-stu-id="dabd3-155">When an application uses one or more explicit AppUserModelIDs, it should apply those AppUserModelIDs in the following locations and situations:</span></span>

-   <span data-ttu-id="dabd3-156">In der [System.AppUserModel.ID](../properties/props-system-appusermodel-id.md) -Eigenschaft der Verknüpfungs Datei der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="dabd3-156">In the [System.AppUserModel.ID](../properties/props-system-appusermodel-id.md) property of the application's shortcut file.</span></span> <span data-ttu-id="dabd3-157">Eine Verknüpfung (als [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka), CLSID \_ shelllink oder eine LNK-Datei) unterstützt Eigenschaften über [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) und andere in der Shell verwendete Mechanismen für die Eigenschafts Einstellung.</span><span class="sxs-lookup"><span data-stu-id="dabd3-157">A shortcut (as an [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka), CLSID\_ShellLink, or a .lnk file) supports properties through [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) and other property-setting mechanisms used throughout the Shell.</span></span> <span data-ttu-id="dabd3-158">Dadurch kann die Taskleiste die richtige Verknüpfung zum Anheften identifizieren und sicherstellen, dass Windows, das zum Prozess gehört, ordnungsgemäß mit der Schaltfläche der Taskleiste verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="dabd3-158">This allows the taskbar to identify the proper shortcut to pin and ensures that windows belonging to the process are appropriately associated with that taskbar button.</span></span>
    > [!Note]  
    > <span data-ttu-id="dabd3-159">Die [System.AppUserModel.ID](../properties/props-system-appusermodel-id.md) -Eigenschaft sollte auf eine Verknüpfung angewendet werden, wenn diese Verknüpfung erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="dabd3-159">The [System.AppUserModel.ID](../properties/props-system-appusermodel-id.md) property should be applied to a shortcut when that shortcut is created.</span></span> <span data-ttu-id="dabd3-160">Bei Verwendung der Microsoft Windows Installer (MSI) zum Installieren der Anwendung ermöglicht die [msishortcutproperty](../msi/msishortcutproperty-table.md) -Tabelle, dass appusermodelid auf die Verknüpfung angewendet wird, wenn Sie während der Installation erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="dabd3-160">When using the Microsoft Windows Installer (MSI) to install the application, the [MsiShortcutProperty](../msi/msishortcutproperty-table.md) table allows the AppUserModelID to be applied to the shortcut when it is created during installation.</span></span>

     

-   <span data-ttu-id="dabd3-161">Als Eigenschaft eines beliebigen Windows-Betriebs in der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="dabd3-161">As a property of any of the application's running windows.</span></span> <span data-ttu-id="dabd3-162">Dies kann auf zwei Arten festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="dabd3-162">This can be set in one of two ways:</span></span>

    1.  <span data-ttu-id="dabd3-163">Wenn verschiedene Fenster, die im Besitz eines Prozesses sind, unterschiedliche appusermudelids zum Steuern der Task leisten Gruppierung benötigen, verwenden Sie [**SHGetPropertyStoreForWindow**](/windows/win32/api/shellapi/nf-shellapi-shgetpropertystoreforwindow)), um den Eigenschaften Speicher des Fensters abzurufen und appusermodelid als Fenster Eigenschaft festzulegen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-163">If different windows owned by one process require different AppUserModelIDs to control taskbar grouping, use [**SHGetPropertyStoreForWindow**](/windows/win32/api/shellapi/nf-shellapi-shgetpropertystoreforwindow)) to retrieve the window's property store and set the AppUserModelID as a window property.</span></span>
    2.  <span data-ttu-id="dabd3-164">Wenn alle Fenster im Prozess die gleiche appusermodelid verwenden, legen Sie die appusermodelid für den Prozess fest, aber [**SetCurrentProcessExplicitAppUserModelID**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-setcurrentprocessexplicitappusermodelid).</span><span class="sxs-lookup"><span data-stu-id="dabd3-164">If all windows in the process use the same AppUserModelID, set the AppUserModelID on the process though [**SetCurrentProcessExplicitAppUserModelID**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-setcurrentprocessexplicitappusermodelid).</span></span> <span data-ttu-id="dabd3-165">Eine Anwendung muss **SetCurrentProcessExplicitAppUserModelID** aufrufen, um Ihre appusermodelid während der anfänglichen Start Routine einer Anwendung festzulegen, bevor die Anwendung eine Benutzeroberfläche anzeigt, eine Bearbeitung der Sprung Listen durchführt oder das System veranlasst, jeden beliebigen Aufrufe von " [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs)" auszuführen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-165">An application must call **SetCurrentProcessExplicitAppUserModelID** to set its AppUserModelID during an application's initial startup routine before the application presents any UI, makes any manipulation of its Jump Lists, or makes (or causes the system to make) any call to [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span></span>

    <span data-ttu-id="dabd3-166">Eine appusermodelid auf Fenster Ebene überschreibt eine appusermodelid auf Prozessebene.</span><span class="sxs-lookup"><span data-stu-id="dabd3-166">A window-level AppUserModelID overrides a process-level AppUserModelID.</span></span>

    <span data-ttu-id="dabd3-167">Wenn eine Anwendung eine explizite appusermodelid auf der Fenster Ebene festlegt, kann die Anwendung die Besonderheiten des Befehls zum Neustarten für die zugehörige Task leisten Schaltfläche bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-167">When an application sets an explicit AppUserModelID at the window level, the application can provide the specifics of its relaunch command for its taskbar button.</span></span> <span data-ttu-id="dabd3-168">Um diese Informationen bereitzustellen, werden die folgenden Eigenschaften verwendet:</span><span class="sxs-lookup"><span data-stu-id="dabd3-168">To supply that information, the following properties are used:</span></span>

    -   [<span data-ttu-id="dabd3-169">System. appusermodel. relaunchcommand</span><span class="sxs-lookup"><span data-stu-id="dabd3-169">System.AppUserModel.RelaunchCommand</span></span>](../properties/props-system-appusermodel-relaunchcommand.md)
    -   [<span data-ttu-id="dabd3-170">System. appusermodel. relaunchdisplaynameresource</span><span class="sxs-lookup"><span data-stu-id="dabd3-170">System.AppUserModel.RelaunchDisplayNameResource</span></span>](../properties/props-system-appusermodel-relaunchdisplaynameresource.md)
    -   [<span data-ttu-id="dabd3-171">System. appusermodel. relaunchienresource</span><span class="sxs-lookup"><span data-stu-id="dabd3-171">System.AppUserModel.RelaunchIconResource</span></span>](../properties/props-system-appusermodel-relaunchiconresource.md)

    > [!Note]  
    > <span data-ttu-id="dabd3-172">Wenn eine Verknüpfung vorhanden ist, um die Anwendung zu starten, sollte eine Anwendung appusermodelid als Eigenschaft der Verknüpfung anwenden, anstatt die Neustart Eigenschaften zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-172">If a shortcut exists to launch the application, an application should apply the AppUserModelID as a property of the shortcut instead of using the relaunch properties.</span></span> <span data-ttu-id="dabd3-173">In diesem Fall werden die Befehlszeile, das Symbol und der Text der Verknüpfung verwendet, um dieselben Informationen wie die Neustart Eigenschaften bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-173">In that case, the command line, icon, and text of the shortcut are used to supply the same information as the relaunch properties.</span></span>

     

    <span data-ttu-id="dabd3-174">Eine explizite appusermodelid auf Fenster Ebene kann auch die [System. appusermodel. preventpinning](../properties/props-system-appusermodel-preventpinning.md) -Eigenschaft verwenden, um anzugeben, dass Sie nicht zum Fixieren oder Neusenden verfügbar sein soll.</span><span class="sxs-lookup"><span data-stu-id="dabd3-174">A window-level explicit AppUserModelID can also use the [System.AppUserModel.PreventPinning](../properties/props-system-appusermodel-preventpinning.md) property to specify that it should not be available for pinning or relaunching.</span></span>

-   <span data-ttu-id="dabd3-175">Rufen Sie in einem Aufruf von anpassen oder aktualisieren ([**ICustomDestinationList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icustomdestinationlist)) die Sprung Liste der Anwendung ab ([**iapplicationdocumentlists**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdocumentlists)), oder löschen Sie Sie ([**iapplicationdestination**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdestinations)).</span><span class="sxs-lookup"><span data-stu-id="dabd3-175">In a call to customize or update ([**ICustomDestinationList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icustomdestinationlist)), retrieve ([**IApplicationDocumentLists**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdocumentlists)), or clear ([**IApplicationDestinations**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iapplicationdestinations)) the application's Jump List.</span></span>
-   <span data-ttu-id="dabd3-176">In der Datei Zuordnungs Registrierung (über die [ProgID](fa-progids.md)), wenn die Anwendung die automatisch generierten **aktuellen** oder **häufigen** Ziellisten des Systems verwendet.</span><span class="sxs-lookup"><span data-stu-id="dabd3-176">In file association registration (through its [ProgID](fa-progids.md)) if the application uses the system's automatically generated **Recent** or **Frequent** destination lists.</span></span> <span data-ttu-id="dabd3-177">Auf diese Zuordnungs Informationen wird von " [**shaddtor ecentdocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs)" verwiesen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-177">This association information is referenced by [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span></span> <span data-ttu-id="dabd3-178">Diese Informationen werden auch verwendet, wenn [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) -Ziele mithilfe von [**ICustomDestinationList:: AppendCategory**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icustomdestinationlist-appendcategory)zu benutzerdefinierten Sprung Listen hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-178">This information is also used when adding [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) destinations to custom Jump Lists through [**ICustomDestinationList::AppendCategory**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icustomdestinationlist-appendcategory).</span></span>
-   <span data-ttu-id="dabd3-179">In jedem beliebigen-Befehl stellt die Anwendung " [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs)" direkt zur Anwendung.</span><span class="sxs-lookup"><span data-stu-id="dabd3-179">In any call the application makes directly to [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs).</span></span> <span data-ttu-id="dabd3-180">Wenn die Anwendung vom allgemeinen Datei Dialogfeld abhängig ist, um in Ihrem Auftrag Aufrufe an " **SHAddToRecentDocs** " auszuführen, können diese Aufrufe nur dann die explizite appusermodelid ableiten, wenn die appusermodelid für den gesamten Prozess festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="dabd3-180">If the application depends on the common file dialog to make calls to **SHAddToRecentDocs** on its behalf, those calls can deduce the explicit AppUserModelID only if the AppUserModelID is set for the entire process.</span></span> <span data-ttu-id="dabd3-181">Wenn die Anwendung appuserwdelids in Ihrem Fenster anstelle von für den Prozess festlegt, muss die Anwendung alle Aufrufe von " **SHAddToRecentDocs** " selbst mit ihrer expliziten appusermodelid ausführen, und es wird verhindert, dass das allgemeine Datei Dialogfeld eigene Aufrufe durchführen kann.</span><span class="sxs-lookup"><span data-stu-id="dabd3-181">If the application sets AppUserModelIDs on its windows instead of on the process, the application must make all calls to **SHAddToRecentDocs** itself, with its explicit AppUserModelID, as well as preventing the common file dialog from making its own calls.</span></span> <span data-ttu-id="dabd3-182">Dies muss jedes Mal erfolgen, wenn ein Element geöffnet wird, um sicherzustellen, dass die **aktuellen** oder **häufigen** Abschnitte der Sprung Liste der Anwendung korrekt sind.</span><span class="sxs-lookup"><span data-stu-id="dabd3-182">This must be done any time an item is opened, to ensure the **Recent** or **Frequent** sections of the application's Jump List are accurate.</span></span>

<span data-ttu-id="dabd3-183">In den folgenden Abschnitten werden häufige Szenarien beschrieben, und es wird erläutert, wo explizite appusermudelids in diesen Szenarien angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-183">The following items describe common scenarios and where to apply explicit AppUserModelIDs in those scenarios.</span></span>

-   <span data-ttu-id="dabd3-184">Wenn ein einzelner Prozess mehrere Anwendungen enthält, rufen Sie mit [**SHGetPropertyStoreForWindow**](/windows/win32/api/shellapi/nf-shellapi-shgetpropertystoreforwindow) den Eigenschaften Speicher des Fensters ab, und legen Sie appusermodelid als Fenster Eigenschaft fest.</span><span class="sxs-lookup"><span data-stu-id="dabd3-184">When a single process contains multiple applications, use [**SHGetPropertyStoreForWindow**](/windows/win32/api/shellapi/nf-shellapi-shgetpropertystoreforwindow) to retrieve the window's property store and set the AppUserModelID as a window property.</span></span>
-   <span data-ttu-id="dabd3-185">Wenn eine Anwendung mehrere Prozesse verwendet, wenden Sie die appusermodelid auf jeden Prozess an.</span><span class="sxs-lookup"><span data-stu-id="dabd3-185">When an application uses multiple processes, apply the AppUserModelID to each process.</span></span> <span data-ttu-id="dabd3-186">Ob Sie für jeden Prozess dieselbe appusermodelid verwenden, hängt davon ab, ob jeder Prozess als Teil der Hauptanwendung oder als einzelne Entitäten angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="dabd3-186">Whether you use the same AppUserModelID on each process depends on whether you want each process to appear as part of the main application or as individual entities.</span></span>
-   <span data-ttu-id="dabd3-187">Wenn Sie bestimmte Fenster von einem Satz im gleichen Prozess trennen möchten, verwenden Sie den Eigenschaften Speicher des Fensters, um eine einzelne appusermodelid auf die Fenster anzuwenden, die Sie trennen möchten, und wenden Sie dann eine andere appusermodelid auf den Prozess an.</span><span class="sxs-lookup"><span data-stu-id="dabd3-187">To separate certain windows from a set in the same process, use the window's property store to apply a single AppUserModelID to those windows you want to separate, and then apply a different AppUserModelID to the process.</span></span> <span data-ttu-id="dabd3-188">Jedes Fenster in diesem Prozess, das nicht explizit mit der appusermodelid auf Fenster Ebene gekennzeichnet war, erbt die appusermodelid des Prozesses.</span><span class="sxs-lookup"><span data-stu-id="dabd3-188">Any window in that process that was not explicitly labeled with the window-level AppUserModelID inherits the AppUserModelID of the process.</span></span>
-   <span data-ttu-id="dabd3-189">Wenn ein Dateityp einer Anwendung zugeordnet ist, weisen Sie die appusermodelid in der [ProgID](fa-progids.md) -Registrierung des Dateityps zu.</span><span class="sxs-lookup"><span data-stu-id="dabd3-189">If a file type is associated with an application, assign the AppUserModelID in the file type's [ProgID](fa-progids.md) registration.</span></span> <span data-ttu-id="dabd3-190">Wenn eine einzelne ausführbare Datei in verschiedenen Modi gestartet wird, die dem Benutzer als unterschiedliche Anwendungen angezeigt werden, ist für jeden Modus eine separate appusermodelid erforderlich.</span><span class="sxs-lookup"><span data-stu-id="dabd3-190">If a single executable file is launched in different modes that appear to the user as distinct applications, a separate AppUserModelID is required for each mode.</span></span> <span data-ttu-id="dabd3-191">In diesem Fall müssen mehrere ProgID-Registrierungen für den Dateityp vorhanden sein, die jeweils über eine andere appusermodelid verfügen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-191">In that case, there must be multiple ProgID registrations for the file type, each with a different AppUserModelID.</span></span>
-   <span data-ttu-id="dabd3-192">Wenn mehrere Verknüpfungs Orte vorhanden sind, von denen ein Benutzer eine Anwendung starten kann (im **Startmenü** auf dem Desktop oder an einem anderen Ort), rufen Sie den Eigenschafts Speicher der Verknüpfung ab, um eine einzelne appusermodelid auf alle Verknüpfungen als Verknüpfungs Eigenschaften anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-192">When there are multiple shortcut locations from which a user can launch an application (in the **Start** menu, on the desktop, or elsewhere) retrieve the shortcut's property store to apply a single AppUserModelID to all of the shortcuts as shortcut properties.</span></span>
-   <span data-ttu-id="dabd3-193">Wenn von einer Anwendung ein expliziter Rückruf an " [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs) " erfolgt, verwenden Sie die appusermodelid im-Befehl.</span><span class="sxs-lookup"><span data-stu-id="dabd3-193">When an explicit call is made to [**SHAddToRecentDocs**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs) by an application, use the AppUserModelID in the call.</span></span> <span data-ttu-id="dabd3-194">Wenn das Dialogfeld "common file" verwendet wird, um Dateien zu öffnen oder zu speichern, wird " **shaddtor ecentdocs** " im Auftrag der Anwendung vom Dialog aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-194">When the common file dialog is used to open or save files, **SHAddToRecentDocs** is called by the dialog on behalf of the application.</span></span> <span data-ttu-id="dabd3-195">Dieser Befehl kann die explizite appusermodelid aus dem Prozess ableiten.</span><span class="sxs-lookup"><span data-stu-id="dabd3-195">That call can infer the explicit AppUserModelID from the process.</span></span> <span data-ttu-id="dabd3-196">Wenn jedoch eine explizite appusermodelid als Fenster Eigenschaft angewendet wird, kann das allgemeine Datei Dialogfeld die richtige appusermodelid nicht ermitteln.</span><span class="sxs-lookup"><span data-stu-id="dabd3-196">However, if an explicit AppUserModelID is applied as a window property, the common file dialog cannot determine the correct AppUserModelID.</span></span> <span data-ttu-id="dabd3-197">In diesem Fall muss die Anwendung selbst den Namen " **SHAddToRecentDocs** " explizit abrufen und die richtige "appusermodelid" bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-197">In that case, the application itself must explicitly call **SHAddToRecentDocs** and provide it with the correct AppUserModelID.</span></span> <span data-ttu-id="dabd3-198">Darüber hinaus muss die Anwendung verhindern, dass das Dialogfeld für die gemeinsame Datei in Ihrem Auftrag " **SHAddToRecentDocs** " aufrufen kann, indem das Flag "Fos \_ dontaddtorecent" in der **GetOptions** -Methode von [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) oder [**IFileSaveDialog**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ifilesavedialog)angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="dabd3-198">Additionally, the application must prevent the common file dialog from calling **SHAddToRecentDocs** on its behalf by setting the FOS\_DONTADDTORECENT flag in the **GetOptions** method of [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) or [**IFileSaveDialog**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ifilesavedialog).</span></span>

## <a name="registering-an-application-as-a-host-process"></a><span data-ttu-id="dabd3-199">Registrieren einer Anwendung als Host Prozess</span><span class="sxs-lookup"><span data-stu-id="dabd3-199">Registering an Application as a Host Process</span></span>

<span data-ttu-id="dabd3-200">Eine Anwendung kann den ishostapp-Registrierungs Eintrag so festlegen, dass der Prozess dieser ausführbaren Datei von der Taskleiste als Host Prozess angesehen wird.</span><span class="sxs-lookup"><span data-stu-id="dabd3-200">An application can set the IsHostApp registry entry to cause that executable's process to be considered a host process by the taskbar.</span></span> <span data-ttu-id="dabd3-201">Dies wirkt sich auf die Gruppierungs-und Standard Sprung Listeneinträge aus.</span><span class="sxs-lookup"><span data-stu-id="dabd3-201">This affects its grouping and default Jump List entries.</span></span>

<span data-ttu-id="dabd3-202">Das folgende Beispiel zeigt den erforderlichen Registrierungs Eintrag.</span><span class="sxs-lookup"><span data-stu-id="dabd3-202">The following example shows the required registry entry.</span></span> <span data-ttu-id="dabd3-203">Beachten Sie, dass dem Eintrag kein Wert zugewiesen ist. Das vorhanden sein ist alles, was erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="dabd3-203">Note that the entry is not assigned a value; its presence is all that is required.</span></span> <span data-ttu-id="dabd3-204">Dabei handelt es sich um einen reg- \_ NULL-Wert.</span><span class="sxs-lookup"><span data-stu-id="dabd3-204">It is a REG\_NULL value.</span></span>

```
HKEY_CLASSES_ROOT
   Applications
      example.exe
         IsHostApp
```

<span data-ttu-id="dabd3-205">Wenn entweder der Prozess selbst oder die zum Starten des Prozesses verwendete Verknüpfungs Datei über eine explizite appusermodelid verfügt, wird die Host Prozessliste ignoriert, und die Anwendung wird von der Taskleiste als normale Anwendung behandelt.</span><span class="sxs-lookup"><span data-stu-id="dabd3-205">If either the process itself or the shortcut file used to launch the process has an explicit AppUserModelID, then the host process list is ignored and the application is treated as a normal application by the taskbar.</span></span> <span data-ttu-id="dabd3-206">Die Betriebs Fenster der Anwendung werden in einer einzigen Task leisten Schaltfläche zusammengefasst, und die Anwendung kann an die Taskleiste angeheftet werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-206">The application's running windows are grouped together under a single taskbar button and the application can be pinned to the taskbar.</span></span>

<span data-ttu-id="dabd3-207">Wenn nur der ausführbare Name des ausführenden Prozesses ohne explizite appusermodelid bekannt ist und diese ausführbare Datei in der Liste der Host Prozesse enthalten ist, wird jede Instanz des Prozesses als separate Entität für die Task leisten Gruppierung behandelt.</span><span class="sxs-lookup"><span data-stu-id="dabd3-207">If only the running process' executable name is known, without an explicit AppUserModelID, and that executable is in the host process list, then each instance of the process is treated as a separate entity for taskbar grouping.</span></span> <span data-ttu-id="dabd3-208">In der Task leisten Schaltfläche, die einer bestimmten Instanz des Prozesses zugeordnet ist, wird keine PIN/unpin-Option oder ein Start Symbol für eine neue Instanz des Prozesses angezeigt.</span><span class="sxs-lookup"><span data-stu-id="dabd3-208">The taskbar button associated with any specific instance of the process does not display a pin/unpin option or a launch icon for a new instance of the process.</span></span> <span data-ttu-id="dabd3-209">Der Prozess kann auch nicht in die Liste der am häufigsten verwendeten (MFU) **Startmenüs** eingefügt werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-209">The process is also not eligible for inclusion in the **Start** menu's Most Frequently Used (MFU) list.</span></span> <span data-ttu-id="dabd3-210">Wenn der Prozess jedoch über eine Verknüpfung gestartet wurde, die Start Argumente enthält (in der Regel der Ziel Inhalt, der als "Anwendung" gehostet wird), kann das System die Identität ermitteln, und die Anwendung kann fixiert und neu gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-210">However, if the process was launched through a shortcut that contains launch arguments (usually the target content to host as the "application"), the system can determine identity and the application can be pinned and relaunched.</span></span>

## <a name="exclusion-lists-for-taskbar-pinning-and-recentfrequent-lists"></a><span data-ttu-id="dabd3-211">Ausschluss Listen für das Anheften und aktuelle/häufige Listen der Taskleiste</span><span class="sxs-lookup"><span data-stu-id="dabd3-211">Exclusion Lists for Taskbar Pinning and Recent/Frequent Lists</span></span>

<span data-ttu-id="dabd3-212">Anwendungen, Prozesse und Windows können auswählen, dass Sie sich selbst nicht für das **anheften** an die Taskleiste oder die Einbindung in die MFU-Liste des Start Menüs entscheiden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-212">Applications, processes, and windows can choose to make themselves unavailable for pinning to the taskbar or for inclusion in the **Start** menu's MFU list.</span></span> <span data-ttu-id="dabd3-213">Hierfür gibt es drei Mechanismen:</span><span class="sxs-lookup"><span data-stu-id="dabd3-213">There are three mechanisms to accomplish this:</span></span>

1.  <span data-ttu-id="dabd3-214">Fügen Sie den NoStartPage-Eintrag zur Registrierung der Anwendung hinzu, wie hier gezeigt:</span><span class="sxs-lookup"><span data-stu-id="dabd3-214">Add the NoStartPage entry to the application's registration as shown here:</span></span>

    ```
    HKEY_CLASSES_ROOT
       Applications
          Example.exe
             NoStartPage
    ```

    <span data-ttu-id="dabd3-215">Die dem NoStartPage-Eintrag zugeordneten Daten werden ignoriert.</span><span class="sxs-lookup"><span data-stu-id="dabd3-215">The data associated with the NoStartPage entry is ignored.</span></span> <span data-ttu-id="dabd3-216">Nur das vorhanden sein des Eintrags ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="dabd3-216">Only the presence of the entry is required.</span></span> <span data-ttu-id="dabd3-217">Daher ist der ideale Typ für NoStartPage "reg \_ None".</span><span class="sxs-lookup"><span data-stu-id="dabd3-217">Therefore, the ideal type for NoStartPage is REG\_NONE.</span></span>

    <span data-ttu-id="dabd3-218">Beachten Sie, dass jede Verwendung einer expliziten appusermodelid den NoStartPage-Eintrag überschreibt.</span><span class="sxs-lookup"><span data-stu-id="dabd3-218">Note that any use of an explicit AppUserModelID overrides the NoStartPage entry.</span></span> <span data-ttu-id="dabd3-219">Wenn eine explizite appusermodelid auf eine Verknüpfung, einen Prozess oder ein Fenster angewendet wird, wird Sie gepinckbar und ist für die MFU-Liste des **Start** Menüs geeignet.</span><span class="sxs-lookup"><span data-stu-id="dabd3-219">If an explicit AppUserModelID is applied to a shortcut, process, or window, it becomes pinnable and eligible for the **Start** menu MFU list.</span></span>

2.  <span data-ttu-id="dabd3-220">Legen Sie die [System. appusermodel. preventpinning](../properties/props-system-appusermodel-preventpinning.md) -Eigenschaft unter Windows und Verknüpfungen fest.</span><span class="sxs-lookup"><span data-stu-id="dabd3-220">Set the [System.AppUserModel.PreventPinning](../properties/props-system-appusermodel-preventpinning.md) property on windows and shortcuts.</span></span> <span data-ttu-id="dabd3-221">Diese Eigenschaft muss in einem Fenster vor der Eigenschaft [pkey \_ appusermodel \_ ID](../properties/props-system-appusermodel-id.md) festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-221">This property must be set on a window before the [PKEY\_AppUserModel\_ID](../properties/props-system-appusermodel-id.md) property.</span></span>
3.  <span data-ttu-id="dabd3-222">Fügen Sie eine explizite appusermodelid als Wert unter dem folgenden Registrierungs Unterschlüssel hinzu, wie hier gezeigt:</span><span class="sxs-lookup"><span data-stu-id="dabd3-222">Add an explicit AppUserModelID as a value under the following registry subkey as shown here:</span></span>

    ```
    HKEY_LOCAL_MACHINE
       Software
          Microsoft
             Windows
                CurrentVersion
                   Explorer
                      FileAssociation
                         NoStartPageAppUserModelIDs
                            AppUserModelID1
                            AppUserModelID2
                            AppUserModelID3
    ```

    <span data-ttu-id="dabd3-223">Jeder Eintrag ist ein reg- \_ NULL-Wert mit dem Namen der appusermodelid.</span><span class="sxs-lookup"><span data-stu-id="dabd3-223">Each entry is a REG\_NULL value with the name of the AppUserModelID.</span></span> <span data-ttu-id="dabd3-224">Alle in dieser Liste gefundenen appusermodelid-Werte können nicht in die MFU-Liste des **Start** Menüs aufgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-224">Any AppUserModelID found in this list is not pinnable and not eligible for inclusion in the **Start** menu MFU list.</span></span>

<span data-ttu-id="dabd3-225">Beachten Sie, dass bestimmte ausführbare Dateien und Verknüpfungen, die bestimmte Zeichen folgen in Ihrem Namen enthalten, automatisch vom anhechern und einschließen in die MFU-Liste ausgeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-225">Be aware that certain executable files as well as shortcuts that contain certain strings in their name are automatically excluded from pinning and inclusion in the MFU list.</span></span>

> [!Note]  
> <span data-ttu-id="dabd3-226">Dieser automatische Ausschluss kann überschrieben werden, indem eine explizite appusermodelid angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="dabd3-226">This automatic exclusion can be overridden by applying an explicit AppUserModelID.</span></span>

 

<span data-ttu-id="dabd3-227">Wenn eine der folgenden Zeichen folgen, unabhängig von der Groß-/Kleinschreibung, im Verknüpfungs Namen enthalten ist, kann das Programm nicht festgelegt werden und wird nicht in der am häufigsten verwendeten Liste angezeigt (gilt nicht für Windows 10):</span><span class="sxs-lookup"><span data-stu-id="dabd3-227">If any of the following strings, regardless of case, are included in the shortcut name, the program is not pinnable and is not displayed in the most frequently used list (not applicable to Windows 10):</span></span>

-   <span data-ttu-id="dabd3-228">Dokumentation</span><span class="sxs-lookup"><span data-stu-id="dabd3-228">Documentation</span></span>
-   <span data-ttu-id="dabd3-229">Hilfe</span><span class="sxs-lookup"><span data-stu-id="dabd3-229">Help</span></span>
-   <span data-ttu-id="dabd3-230">Installieren</span><span class="sxs-lookup"><span data-stu-id="dabd3-230">Install</span></span>
-   <span data-ttu-id="dabd3-231">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="dabd3-231">More Info</span></span>
-   <span data-ttu-id="dabd3-232">Lesezugriff</span><span class="sxs-lookup"><span data-stu-id="dabd3-232">Read me</span></span>
-   <span data-ttu-id="dabd3-233">Zuerst lesen</span><span class="sxs-lookup"><span data-stu-id="dabd3-233">Read First</span></span>
-   <span data-ttu-id="dabd3-234">Infodatei</span><span class="sxs-lookup"><span data-stu-id="dabd3-234">Readme</span></span>
-   <span data-ttu-id="dabd3-235">Remove (Entfernen)</span><span class="sxs-lookup"><span data-stu-id="dabd3-235">Remove</span></span>
-   <span data-ttu-id="dabd3-236">Einrichten</span><span class="sxs-lookup"><span data-stu-id="dabd3-236">Setup</span></span>
-   <span data-ttu-id="dabd3-237">Support</span><span class="sxs-lookup"><span data-stu-id="dabd3-237">Support</span></span>
-   <span data-ttu-id="dabd3-238">Neuerungen</span><span class="sxs-lookup"><span data-stu-id="dabd3-238">What's New</span></span>

<span data-ttu-id="dabd3-239">Die folgende Liste der Programme ist nicht pinckbar und wird aus der Liste der am häufigsten verwendeten Programme ausgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="dabd3-239">The following list of programs are not pinnable and are excluded from the most frequently used list.</span></span>

-   <span data-ttu-id="dabd3-240">Applaunch.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-240">Applaunch.exe</span></span>
-   <span data-ttu-id="dabd3-241">Control.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-241">Control.exe</span></span>
-   <span data-ttu-id="dabd3-242">Dfsvc.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-242">Dfsvc.exe</span></span>
-   <span data-ttu-id="dabd3-243">Dllhost.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-243">Dllhost.exe</span></span>
-   <span data-ttu-id="dabd3-244">Guestmodemsg.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-244">Guestmodemsg.exe</span></span>
-   <span data-ttu-id="dabd3-245">Hh.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-245">Hh.exe</span></span>
-   <span data-ttu-id="dabd3-246">Install.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-246">Install.exe</span></span>
-   <span data-ttu-id="dabd3-247">Isuninst.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-247">Isuninst.exe</span></span>
-   <span data-ttu-id="dabd3-248">Lnkstub.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-248">Lnkstub.exe</span></span>
-   <span data-ttu-id="dabd3-249">Mmc.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-249">Mmc.exe</span></span>
-   <span data-ttu-id="dabd3-250">Mshta.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-250">Mshta.exe</span></span>
-   <span data-ttu-id="dabd3-251">Msiexec.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-251">Msiexec.exe</span></span>
-   <span data-ttu-id="dabd3-252">Msoobe.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-252">Msoobe.exe</span></span>
-   <span data-ttu-id="dabd3-253">Rundll32.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-253">Rundll32.exe</span></span>
-   <span data-ttu-id="dabd3-254">Setup.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-254">Setup.exe</span></span>
-   <span data-ttu-id="dabd3-255">St5unst.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-255">St5unst.exe</span></span>
-   <span data-ttu-id="dabd3-256">Unwise.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-256">Unwise.exe</span></span>
-   <span data-ttu-id="dabd3-257">Unwise32.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-257">Unwise32.exe</span></span>
-   <span data-ttu-id="dabd3-258">Werfault.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-258">Werfault.exe</span></span>
-   <span data-ttu-id="dabd3-259">Winhlp32.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-259">Winhlp32.exe</span></span>
-   <span data-ttu-id="dabd3-260">Wlrmdr.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-260">Wlrmdr.exe</span></span>
-   <span data-ttu-id="dabd3-261">Wuapp.exe</span><span class="sxs-lookup"><span data-stu-id="dabd3-261">Wuapp.exe</span></span>

<span data-ttu-id="dabd3-262">Die vorangehenden Listen werden in den folgenden Registrierungs Werten gespeichert.</span><span class="sxs-lookup"><span data-stu-id="dabd3-262">The preceding lists are stored in the following registry values.</span></span>

> [!Note]  
> <span data-ttu-id="dabd3-263">Diese Listen sollten nicht von Anwendungen geändert werden.</span><span class="sxs-lookup"><span data-stu-id="dabd3-263">These lists should not be modified by applications.</span></span> <span data-ttu-id="dabd3-264">Verwenden Sie eine der zuvor aufgeführten Methoden der Ausschlussliste für die gleiche Funktion.</span><span class="sxs-lookup"><span data-stu-id="dabd3-264">Use one of the exclusion list methods listed previously for the same experience.</span></span>

 

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FileAssociation
                     AddRemoveApps
                     HostApps
```

## <a name="related-topics"></a><span data-ttu-id="dabd3-265">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="dabd3-265">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="dabd3-266">**SetCurrentProcessExplicitAppUserModelID**</span><span class="sxs-lookup"><span data-stu-id="dabd3-266">**SetCurrentProcessExplicitAppUserModelID**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-setcurrentprocessexplicitappusermodelid)
</dt> <dt>

[<span data-ttu-id="dabd3-267">**Getcurrentprocessexplicitappusermodelid**</span><span class="sxs-lookup"><span data-stu-id="dabd3-267">**GetCurrentProcessExplicitAppUserModelID**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-getcurrentprocessexplicitappusermodelid)
</dt> <dt>

[<span data-ttu-id="dabd3-268">Task leisten Erweiterungen</span><span class="sxs-lookup"><span data-stu-id="dabd3-268">Taskbar Extensions</span></span>](taskbar-extensions.md)
</dt> <dt>

[<span data-ttu-id="dabd3-269">**ICustomDestinationList:: "abtappid"**</span><span class="sxs-lookup"><span data-stu-id="dabd3-269">**ICustomDestinationList::SetAppID**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icustomdestinationlist-setappid)
</dt> <dt>

[<span data-ttu-id="dabd3-270">**Iapplicationdocumentlists:: abtappid**</span><span class="sxs-lookup"><span data-stu-id="dabd3-270">**IApplicationDocumentLists::SetAppID**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-iapplicationdocumentlists-setappid)
</dt> <dt>

[<span data-ttu-id="dabd3-271">**Iapplicationdestination:: abtappid**</span><span class="sxs-lookup"><span data-stu-id="dabd3-271">**IApplicationDestinations::SetAppID**</span></span>](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-iapplicationdestinations-setappid)
</dt> <dt>

[<span data-ttu-id="dabd3-272">**SHGetPropertyStoreForWindow**</span><span class="sxs-lookup"><span data-stu-id="dabd3-272">**SHGetPropertyStoreForWindow**</span></span>](/windows/win32/api/shellapi/nf-shellapi-shgetpropertystoreforwindow)
</dt> </dl>

 

 
