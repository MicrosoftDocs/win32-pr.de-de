---
description: Die CPlApplet-Rückruffunktion verarbeitet alle Nachrichten, die von Windows an ein System Steuerungselement gesendet werden. An die Funktion gesendete Nachrichten sind in einer bestimmten Reihenfolge angeordnet. Das CPL-Element erfordert, dass die Nachrichten auf eine bestimmte Weise verarbeitet werden.
ms.assetid: 70302698-f9d5-4de4-a662-4815002eea52
title: Nachrichtenverarbeitung in der Systemsteuerung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0b8b43c6e265030279a6644547f41e3630208325
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "103960291"
---
# <a name="control-panel-message-processing"></a><span data-ttu-id="a0448-105">Nachrichtenverarbeitung in der Systemsteuerung</span><span class="sxs-lookup"><span data-stu-id="a0448-105">Control Panel Message Processing</span></span>

<span data-ttu-id="a0448-106">Die [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) -Rückruffunktion verarbeitet alle Nachrichten, die von Windows an ein System Steuerungselement gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="a0448-106">The [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) callback function processes all messages sent to a Control Panel item by Windows.</span></span> <span data-ttu-id="a0448-107">An die Funktion gesendete Nachrichten sind in einer bestimmten Reihenfolge angeordnet.</span><span class="sxs-lookup"><span data-stu-id="a0448-107">Messages sent to the function are in a specific order.</span></span> <span data-ttu-id="a0448-108">Das CPL-Element erfordert, dass die Nachrichten auf eine bestimmte Weise verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="a0448-108">By the same token, the .cpl item requires the messages to be processed in a specific way.</span></span>

<span data-ttu-id="a0448-109">Zuerst empfängt die [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) -Funktion die CPL- \_ Init-Nachricht, wenn Windows das System Steuerungselement zum ersten Mal lädt.</span><span class="sxs-lookup"><span data-stu-id="a0448-109">First, the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function receives the CPL\_INIT message when Windows first loads the Control Panel item.</span></span> <span data-ttu-id="a0448-110">Die Funktion sollte jede Initialisierung durchführen, z. b. das belegen von Speicher und die Rückgabe ungleich 0 (null).</span><span class="sxs-lookup"><span data-stu-id="a0448-110">The function should carry out any initialization, such as allocating memory, and return nonzero.</span></span> <span data-ttu-id="a0448-111">Wenn das **CPlApplet** die Initialisierung nicht abschließen kann, muss es NULL zurückgeben und Windows zum Beenden der Kommunikation und zum Freigeben der dll weiterleiten.</span><span class="sxs-lookup"><span data-stu-id="a0448-111">If **CPlApplet** cannot complete the initialization, it must return zero, directing Windows to terminate communication and release the DLL.</span></span>

<span data-ttu-id="a0448-112">Wenn die CPL- \_ Init-Nachricht erfolgreich war, sendet Windows die CPL \_ GetCount-Nachricht.</span><span class="sxs-lookup"><span data-stu-id="a0448-112">Next, if the CPL\_INIT message succeeded, Windows sends the CPL\_GETCOUNT message.</span></span> <span data-ttu-id="a0448-113">Die Funktion muss dann die Anzahl der System Steuerungselemente zurückgeben, die von der DLL-Datei unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="a0448-113">The function must then return the number of Control Panel items supported by the .dll file.</span></span>

<span data-ttu-id="a0448-114">Die [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) -Funktion empfängt dann eine CPL \_ -Anfrage Nachricht und eine CPL- \_ newinquire-Nachricht für jedes System Steuerungselement, das von der DLL-Datei unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="a0448-114">The [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function then receives one CPL\_INQUIRE message and one CPL\_NEWINQUIRE message for each Control Panel item supported by the .dll file.</span></span> <span data-ttu-id="a0448-115">Die-Funktion füllt eine [**cplinfo**](/windows/win32/api/cpl/ns-cpl-cplinfo) -oder [**newcplinfo**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) -Struktur mit Informationen über Ihr Element aus, z. b. Name, Symbol und eine beschreibende Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="a0448-115">The function fills in a [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure with information about your item, such as its name, icon, and a descriptive string.</span></span> <span data-ttu-id="a0448-116">Die meisten Anwendungen sollten die CPL \_ -Anfrage Nachricht verarbeiten und die CPL- \_ Netzteil Nachricht ignorieren.</span><span class="sxs-lookup"><span data-stu-id="a0448-116">Most applications should process the CPL\_INQUIRE message and ignore the CPL\_NEWINQUIRE message.</span></span> <span data-ttu-id="a0448-117">Die CPL- \_ Anfrage Nachricht enthält Informationen in einer Form, die von Windows zwischengespeichert werden kann. Dies führt zu einer wesentlich besseren Leistung.</span><span class="sxs-lookup"><span data-stu-id="a0448-117">The CPL\_INQUIRE message provides information in a form that Windows can cache, which results in much better performance.</span></span> <span data-ttu-id="a0448-118">Die CPL- \_ Netzteil Meldung wird nur verwendet, wenn Sie das Symbol des Elements ändern oder Zeichen folgen basierend auf dem Zustand des Computers anzeigen müssen.</span><span class="sxs-lookup"><span data-stu-id="a0448-118">The CPL\_NEWINQUIRE message is used only if you need to change your item's icon or display strings based on the state of the computer.</span></span> <span data-ttu-id="a0448-119">System Steuerungselemente, die CPL- \_ Netzteile verwenden, können nicht über eine **Startmenü** Suche in Windows Vista gefunden werden, da Sie auf Caching basiert.</span><span class="sxs-lookup"><span data-stu-id="a0448-119">Control Panel items that use CPL\_NEWINQUIRE cannot be found by a **Start** menu search in Windows Vista because it relies on caching.</span></span>

<span data-ttu-id="a0448-120">Die Funktion [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) empfängt als nächstes eine CPL- \_ dblclk-Nachricht als Benachrichtigung, dass der Benutzer das Symbol ausgewählt hat, das das System Steuerungselement darstellt.</span><span class="sxs-lookup"><span data-stu-id="a0448-120">The [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function next receives a CPL\_DBLCLK message as a notification that the user has chosen the icon that represents the Control Panel item.</span></span> <span data-ttu-id="a0448-121">Die Funktion kann diese Nachricht beliebig oft empfangen.</span><span class="sxs-lookup"><span data-stu-id="a0448-121">The function might receive this message any number of times.</span></span> <span data-ttu-id="a0448-122">Die Meldung enthält den Element Bezeichner und den **lpdata** -Zeiger, der in der [**cplinfo**](/windows/win32/api/cpl/ns-cpl-cplinfo) -oder [**newcplinfo**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) -Struktur beim [**cpl \_**](cpl-inquire.md) -oder CPL-Befehl zurückgegeben wird. [**\_**](cpl-newinquire.md)</span><span class="sxs-lookup"><span data-stu-id="a0448-122">The message includes the item identifier and the **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the call to [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md).</span></span> <span data-ttu-id="a0448-123">Die Funktion sollte das entsprechende Dialogfeld anzeigen und nachfolgende Benutzereingaben verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="a0448-123">The function should display the corresponding dialog box and process subsequent user input.</span></span>

<span data-ttu-id="a0448-124">Zusätzlich zu cpl- \_ dblclk kann die CPL- \_ startwparser-Nachricht gesendet werden, wenn ein System Steuerungselement mit Eingabe Parametern aufgerufen wird, z. b. über eine Eingabeaufforderung oder ein anderes Programm.</span><span class="sxs-lookup"><span data-stu-id="a0448-124">Besides CPL\_DBLCLK, the CPL\_STARTWPARMS message can be sent if a Control Panel item is invoked with input parameters, such as from a command prompt or from another program.</span></span> <span data-ttu-id="a0448-125">Die Meldung enthält den Element Bezeichner sowie die zusätzliche Parameter Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="a0448-125">The message includes the item identifier along with the additional parameter string.</span></span>

<span data-ttu-id="a0448-126">Bevor die steuernde Anwendung beendet wird, empfängt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) die CPL-beendenden \_ Nachricht einmal für jedes System Steuerungselement, das von der DLL-Datei unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="a0448-126">Before the controlling application terminates, [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) receives the CPL\_STOP message once for each Control Panel item supported by the .dll file.</span></span> <span data-ttu-id="a0448-127">Die Meldung enthält den Bezeichner für das System Steuerungselement und den **lpdata** -Zeiger, der in der [**cplinfo**](/windows/win32/api/cpl/ns-cpl-cplinfo) -oder [**newcplinfo**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) -Struktur beim cpl-Anweisungs-oder CPL-Befehl zurückgegeben wird [**\_**](cpl-inquire.md) . [**\_**](cpl-newinquire.md)</span><span class="sxs-lookup"><span data-stu-id="a0448-127">The message includes the identifier for the Control Panel item and the **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the call to [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md).</span></span> <span data-ttu-id="a0448-128">Die Funktion sollte jeglichen Speicher freigeben, den Sie für das angegebene Dialogfeld zugeordnet hat.</span><span class="sxs-lookup"><span data-stu-id="a0448-128">The function should free any memory that it allocated for the specified dialog box.</span></span>

<span data-ttu-id="a0448-129">Nach der letzten cpl-Beendigungs \_ Meldung empfängt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) eine CPL-Beendigungs \_ Nachricht.</span><span class="sxs-lookup"><span data-stu-id="a0448-129">After the last CPL\_STOP message, [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) receives a CPL\_EXIT message.</span></span> <span data-ttu-id="a0448-130">Die Funktion sollte den verbleibenden zugeordneten Arbeitsspeicher freigeben und die Registrierung aller privaten Fenster Klassen aufheben, die Sie möglicherweise registriert hat.</span><span class="sxs-lookup"><span data-stu-id="a0448-130">The function should free all remaining allocated memory and unregister any private window classes that it might have registered.</span></span> <span data-ttu-id="a0448-131">Unmittelbar nach der Rückgabe der Funktion aus dieser Meldung gibt Windows das System Steuerungselement aus, indem die [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) -Funktion aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="a0448-131">Immediately after the function returns from this message, Windows releases the Control Panel item by calling the [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a0448-132">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="a0448-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a0448-133">System Steuerungselemente</span><span class="sxs-lookup"><span data-stu-id="a0448-133">Control Panel Items</span></span>](control-panel-applications.md)
</dt> <dt>

[<span data-ttu-id="a0448-134">Richtlinien zur Benutzerfreundlichkeit</span><span class="sxs-lookup"><span data-stu-id="a0448-134">User Experience Guidelines</span></span>](user-experience-guidelines.md)
</dt> <dt>

[<span data-ttu-id="a0448-135">System Steuerungselemente werden registriert</span><span class="sxs-lookup"><span data-stu-id="a0448-135">Registering Control Panel Items</span></span>](registering-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="a0448-136">Verwenden von CPlApplet</span><span class="sxs-lookup"><span data-stu-id="a0448-136">Using CPLApplet</span></span>](using-cplapplet.md)
</dt> <dt>

[<span data-ttu-id="a0448-137">Ausführen von System Steuerungselementen</span><span class="sxs-lookup"><span data-stu-id="a0448-137">Executing Control Panel Items</span></span>](executing-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="a0448-138">Erweitern von System Steuerungselementen</span><span class="sxs-lookup"><span data-stu-id="a0448-138">Extending System Control Panel Items</span></span>](extending-system-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="a0448-139">Zuweisen von System Steuerungs Kategorien</span><span class="sxs-lookup"><span data-stu-id="a0448-139">Assigning Control Panel Categories</span></span>](assigning-control-panel-categories.md)
</dt> <dt>

[<span data-ttu-id="a0448-140">Erstellen von durchsuchbaren Aufgaben Verknüpfungen für ein System Steuerungselement</span><span class="sxs-lookup"><span data-stu-id="a0448-140">Creating Searchable Task Links for a Control Panel Item</span></span>](creating-searchable-task-links.md)
</dt> <dt>

[<span data-ttu-id="a0448-141">Zugreifen auf die Systemsteuerung im abgesicherten Modus unter Windows Vista</span><span class="sxs-lookup"><span data-stu-id="a0448-141">Accessing the Control Panel in Safe Mode under Windows Vista</span></span>](accessing-the-cp-in-safe-mode-under-vista.md)
</dt> </dl>

 

 
