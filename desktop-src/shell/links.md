---
description: Ein shelllink ist ein Datenobjekt, das Informationen enthält, die für den Zugriff auf ein anderes Objekt im Namespace der Shell&8212 verwendet werden, d \# . h. alle Objekte, die über Windows Explorer sichtbar sind.
ms.assetid: 32ad306d-54bd-4130-ad30-08db50ef106e
title: Shelllinks
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 327bcb425f998bcc2a4c0714118d4461ded253ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104216610"
---
# <a name="shell-links"></a><span data-ttu-id="a3c45-103">Shelllinks</span><span class="sxs-lookup"><span data-stu-id="a3c45-103">Shell Links</span></span>

<span data-ttu-id="a3c45-104">Ein *shelllink* ist ein Datenobjekt, das Informationen enthält, die für den Zugriff auf ein anderes Objekt im-Namespace der Shell verwendet werden, d. –. alle Objekte, die über Windows Explorer sichtbar sind.</span><span class="sxs-lookup"><span data-stu-id="a3c45-104">A *Shell link* is a data object that contains information used to access another object in the Shell's namespace—that is, any object visible through Windows Explorer.</span></span> <span data-ttu-id="a3c45-105">Zu den Typen von Objekten, auf die über Shellverknüpfungen zugegriffen werden kann, gehören Dateien, Ordner, Laufwerke und Drucker.</span><span class="sxs-lookup"><span data-stu-id="a3c45-105">The types of objects that can be accessed through Shell links include files, folders, disk drives, and printers.</span></span> <span data-ttu-id="a3c45-106">Ein shelllink ermöglicht einem Benutzer oder einer Anwendung den Zugriff auf ein Objekt von einer beliebigen Stelle im Namespace aus.</span><span class="sxs-lookup"><span data-stu-id="a3c45-106">A Shell link allows a user or an application to access an object from anywhere in the namespace.</span></span> <span data-ttu-id="a3c45-107">Der Benutzer oder die Anwendung muss den aktuellen Namen und Speicherort des Objekts nicht kennen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-107">The user or application does not need to know the current name and location of the object.</span></span>

-   [<span data-ttu-id="a3c45-108">Informationen zu shelllinks</span><span class="sxs-lookup"><span data-stu-id="a3c45-108">About Shell Links</span></span>](#about-shell-links)
    -   [<span data-ttu-id="a3c45-109">Link Auflösung</span><span class="sxs-lookup"><span data-stu-id="a3c45-109">Link Resolution</span></span>](#link-resolution)
    -   [<span data-ttu-id="a3c45-110">Dateien verknüpfen</span><span class="sxs-lookup"><span data-stu-id="a3c45-110">Link Files</span></span>](#link-files)
    -   [<span data-ttu-id="a3c45-111">Element Bezeichner und bezeichnerlisten</span><span class="sxs-lookup"><span data-stu-id="a3c45-111">Item Identifiers and Identifier Lists</span></span>](#item-identifiers-and-identifier-lists)
-   [<span data-ttu-id="a3c45-112">Verwenden von shelllinks</span><span class="sxs-lookup"><span data-stu-id="a3c45-112">Using Shell Links</span></span>](#using-shell-links)
    -   [<span data-ttu-id="a3c45-113">Erstellen einer Verknüpfung und einer Ordner Verknüpfung zu einer Datei</span><span class="sxs-lookup"><span data-stu-id="a3c45-113">Creating a Shortcut and a Folder Shortcut to a File</span></span>](#creating-a-shortcut-and-a-folder-shortcut-to-a-file)
    -   [<span data-ttu-id="a3c45-114">Auflösen einer Verknüpfung</span><span class="sxs-lookup"><span data-stu-id="a3c45-114">Resolving a Shortcut</span></span>](#resolving-a-shortcut)
    -   [<span data-ttu-id="a3c45-115">Erstellen einer Verknüpfung mit einem nicht Datei Objekt</span><span class="sxs-lookup"><span data-stu-id="a3c45-115">Creating a Shortcut to a Nonfile Object</span></span>](#creating-a-shortcut-to-a-nonfile-object)

## <a name="about-shell-links"></a><span data-ttu-id="a3c45-116">Informationen zu shelllinks</span><span class="sxs-lookup"><span data-stu-id="a3c45-116">About Shell Links</span></span>

<span data-ttu-id="a3c45-117">Der Benutzer erstellt eine Shellverknüpfung, indem er im Kontextmenü eines Objekts den Befehl **Verknüpfung erstellen** auswählt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-117">The user creates a Shell link by choosing the **Create Shortcut** command from an object's shortcut menu.</span></span> <span data-ttu-id="a3c45-118">Das System erstellt automatisch ein Symbol für die Shellverknüpfung, indem das Symbol des Objekts mit einem kleinen Pfeil (als System definiertes Link Überlagerungs Symbol bezeichnet) kombiniert wird, das in der unteren linken Ecke des Symbols angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="a3c45-118">The system automatically creates an icon for the Shell link by combining the object's icon with a small arrow (known as the system-defined link overlay icon) that appears in the lower left corner of the icon.</span></span> <span data-ttu-id="a3c45-119">Ein shelllink mit einem Symbol wird als Verknüpfung bezeichnet. die Begriffe "shelllink" und "Verknüpfung" werden jedoch häufig austauschbar verwendet.</span><span class="sxs-lookup"><span data-stu-id="a3c45-119">A Shell link that has an icon is called a shortcut; however, the terms Shell link and shortcut are often used interchangeably.</span></span> <span data-ttu-id="a3c45-120">In der Regel erstellt der Benutzer Verknüpfungen, um schnellen Zugriff auf Objekte zu erhalten, die in Unterordnern oder in freigegebenen Ordnern auf anderen Computern gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="a3c45-120">Typically, the user creates shortcuts to gain quick access to objects stored in subfolders or in shared folders on other computers.</span></span> <span data-ttu-id="a3c45-121">Beispielsweise kann ein Benutzer eine Verknüpfung mit einem Microsoft Word-Dokument erstellen, das sich in einem Unterordner befindet, und das Verknüpfungs Symbol auf dem Desktop platzieren.</span><span class="sxs-lookup"><span data-stu-id="a3c45-121">For example, a user can create a shortcut to a Microsoft Word document that is located in a subfolder and place the shortcut icon on the desktop.</span></span> <span data-ttu-id="a3c45-122">Der Benutzer kann dann das Dokument öffnen, indem er auf das Verknüpfungs Symbol doppelklickt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-122">The user can then open the document by double-clicking the shortcut icon.</span></span> <span data-ttu-id="a3c45-123">Wenn das Dokument nach dem Erstellen der Verknüpfung verschoben oder umbenannt wird, versucht das System, die Verknüpfung zu aktualisieren, wenn der Benutzer das nächste Mal auswählt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-123">If the document is moved or renamed after the shortcut is created, the system will attempt to update the shortcut the next time the user selects it.</span></span>

<span data-ttu-id="a3c45-124">Anwendungen können auch shelllinks und Verknüpfungen erstellen und verwenden.</span><span class="sxs-lookup"><span data-stu-id="a3c45-124">Applications can also create and use Shell links and shortcuts.</span></span> <span data-ttu-id="a3c45-125">Beispielsweise kann eine Textverarbeitungsanwendung einen shelllink erstellen, um eine Liste der zuletzt verwendeten Dokumente zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="a3c45-125">For example, a word processing application might create a Shell link to implement a list of the most recently used documents.</span></span> <span data-ttu-id="a3c45-126">Eine Anwendung erstellt eine Shellverknüpfung, indem Sie die [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) -Schnittstelle zum Erstellen eines shelllinkobjekts verwendet.</span><span class="sxs-lookup"><span data-stu-id="a3c45-126">An application creates a Shell link by using the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface to create a Shell link object.</span></span> <span data-ttu-id="a3c45-127">Die Anwendung verwendet die [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) -oder [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) -Schnittstelle, um das Objekt in einer Datei oder einem Stream zu speichern.</span><span class="sxs-lookup"><span data-stu-id="a3c45-127">The application uses the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) interface to store the object in a file or stream.</span></span>

> [!Note]  
> <span data-ttu-id="a3c45-128">Sie können [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) nicht verwenden, um einen Link zu einer URL zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-128">You cannot use [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) to create a link to a URL.</span></span>

 

<span data-ttu-id="a3c45-129">In dieser Übersicht wird die [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) -Schnittstelle beschrieben und erläutert, wie Sie Sie zum Erstellen und Auflösen von Shellverknüpfungen in einer Microsoft Win32-basierten Anwendung verwenden können.</span><span class="sxs-lookup"><span data-stu-id="a3c45-129">This overview describes the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface and explains how to use it to create and resolve Shell links from within a Microsoft Win32-based application.</span></span> <span data-ttu-id="a3c45-130">Da der Entwurf von shelllinks auf der OLE-Component Object Model (com) basiert, sollten Sie sich mit den grundlegenden Konzepten der com-und OLE-Programmierung vertraut machen, bevor Sie diese Übersicht lesen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-130">Because the design of Shell links is based on the OLE Component Object Model (COM), you should be familiar with the basic concepts of COM and OLE programming before reading this overview.</span></span>

### <a name="link-resolution"></a><span data-ttu-id="a3c45-131">Link Auflösung</span><span class="sxs-lookup"><span data-stu-id="a3c45-131">Link Resolution</span></span>

<span data-ttu-id="a3c45-132">Wenn ein Benutzer eine Verknüpfung zu einem Objekt erstellt und der Name oder Speicherort des Objekts zu einem späteren Zeitpunkt geändert wird, führt das System automatisch Schritte aus, um die Verknüpfung zu aktualisieren oder aufzulösen, wenn der Benutzer das nächste Mal auswählt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-132">If a user creates a shortcut to an object and the name or location of the object is later changed, the system automatically takes steps to update, or resolve, the shortcut the next time the user selects it.</span></span> <span data-ttu-id="a3c45-133">Wenn eine Anwendung jedoch einen shelllink erstellt und in einem Stream speichert, versucht das System nicht automatisch, den Link aufzulösen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-133">However, if an application creates a Shell link and stores it in a stream, the system does not automatically attempt to resolve the link.</span></span> <span data-ttu-id="a3c45-134">Die Anwendung muss den Link auflösen, indem Sie die [**IShellLink:: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-134">The application must resolve the link by calling the [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) method.</span></span>

<span data-ttu-id="a3c45-135">Wenn ein shelllink erstellt wird, speichert das Systeminformationen über den Link.</span><span class="sxs-lookup"><span data-stu-id="a3c45-135">When a Shell link is created, the system saves information about the link.</span></span> <span data-ttu-id="a3c45-136">Beim Auflösen eines Links – entweder automatisch oder mit einem [**IShellLink:: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) -Befehl, ruft das System zuerst den dem shelllink zugeordneten Pfad ab, indem er einen Zeiger auf die bezeichnerliste des shelllinks verwendet.</span><span class="sxs-lookup"><span data-stu-id="a3c45-136">When resolving a link—either automatically or with an [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) call—the system first retrieves the path associated with the Shell link by using a pointer to the Shell link's identifier list.</span></span> <span data-ttu-id="a3c45-137">Weitere Informationen zur bezeichnerliste finden Sie unter [Element Bezeichner und bezeichnerlisten](#item-identifiers-and-identifier-lists).</span><span class="sxs-lookup"><span data-stu-id="a3c45-137">For more information about the identifier list, see [Item Identifiers and Identifier Lists](#item-identifiers-and-identifier-lists).</span></span> <span data-ttu-id="a3c45-138">Das System sucht in diesem Pfad nach dem zugeordneten Objekt und löst den Link auf, wenn das Objekt gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="a3c45-138">The system searches for the associated object in that path and, if it finds the object, resolves the link.</span></span> <span data-ttu-id="a3c45-139">Wenn das System das Objekt nicht finden kann, ruft es auf der [verteilten Link Verfolgung und](../fileio/distributed-link-tracking-and-object-identifiers.md) dem DLT-Dienst (Object Identifier, Objekt Bezeichner) auf, um das Objekt zu suchen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-139">If the system cannot find the object, it calls on the [Distributed Link Tracking and Object Identifiers](../fileio/distributed-link-tracking-and-object-identifiers.md) (DLT) service, if available, to locate the object.</span></span> <span data-ttu-id="a3c45-140">Wenn der DLT-Dienst nicht verfügbar ist oder das Objekt nicht finden kann, sucht das System im gleichen Verzeichnis nach einem Objekt mit derselben Datei Erstellungszeit und Attributen, aber mit einem anderen Namen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-140">If the DLT service is not available or cannot find the object, the system looks in the same directory for an object with the same file creation time and attributes but with a different name.</span></span> <span data-ttu-id="a3c45-141">Bei dieser Art von Suche wird ein Link zu einem Objekt aufgelöst, das umbenannt wurde.</span><span class="sxs-lookup"><span data-stu-id="a3c45-141">This type of search resolves a link to an object that has been renamed.</span></span>

<span data-ttu-id="a3c45-142">Wenn das System das Objekt immer noch nicht finden kann, durchsucht es die Verzeichnisse, den Desktop und die lokalen Volumes und sucht rekursiv nach der Verzeichnisstruktur für ein Objekt mit dem gleichen Namen oder der Erstellungszeit.</span><span class="sxs-lookup"><span data-stu-id="a3c45-142">If the system still cannot find the object, it searches the directories, the desktop, and local volumes, looking recursively though the directory tree for an object with either the same name or creation time.</span></span> <span data-ttu-id="a3c45-143">Wenn das System immer noch keine Entsprechung findet, wird ein Dialogfeld angezeigt, in dem der Benutzer zur Eingabe eines Orts aufgefordert wird.</span><span class="sxs-lookup"><span data-stu-id="a3c45-143">If the system still does not find a match, it displays a dialog box prompting the user for a location.</span></span> <span data-ttu-id="a3c45-144">Eine Anwendung kann das Dialogfeld unterdrücken, indem Sie den Wert der **\_ \_ Benutzeroberfläche ohne Benutzeroberfläche** in einem [**IShellLink:: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve)-Rückruf angibt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-144">An application can suppress the dialog box by specifying the **SLR\_NO\_UI** value in a call to [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve).</span></span>

### <a name="initialization-of-the-component-object-library"></a><span data-ttu-id="a3c45-145">Initialisierung der Komponenten Objektbibliothek</span><span class="sxs-lookup"><span data-stu-id="a3c45-145">Initialization of the Component Object Library</span></span>

<span data-ttu-id="a3c45-146">Bevor eine Anwendung Verknüpfungen erstellen und auflösen kann, muss Sie die Komponenten Objektbibliothek initialisieren, indem Sie die [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-146">Before an application can create and resolve shortcuts, it must initialize the component object library by calling the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function.</span></span> <span data-ttu-id="a3c45-147">Jeder **CoInitialize** -Rückruf erfordert einen entsprechenden-Rückruf für die Funktion " [**count**](/windows/win32/api/combaseapi/nf-combaseapi-couninitialize) ", der von einer Anwendung beim Beenden aufgerufen werden soll.</span><span class="sxs-lookup"><span data-stu-id="a3c45-147">Each call to **CoInitialize** requires a corresponding call to the [**CoUninitialize**](/windows/win32/api/combaseapi/nf-combaseapi-couninitialize) function, which an application should call when it terminates.</span></span> <span data-ttu-id="a3c45-148">Der **CallInitialize** -Befehl stellt sicher, dass die Anwendung nicht beendet wird, bis Sie alle ausstehenden Nachrichten empfangen hat.</span><span class="sxs-lookup"><span data-stu-id="a3c45-148">The call to **CoUninitialize** ensures that the application does not terminate until it has received all of its pending messages.</span></span>

### <a name="location-independent-names"></a><span data-ttu-id="a3c45-149">Location-Independent Namen</span><span class="sxs-lookup"><span data-stu-id="a3c45-149">Location-Independent Names</span></span>

<span data-ttu-id="a3c45-150">Das System stellt standortunabhängige Namen für shelllinks zu Objekten bereit, die in freigegebenen Ordnern gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="a3c45-150">The system provides location-independent names for Shell links to objects stored in shared folders.</span></span> <span data-ttu-id="a3c45-151">Wenn das-Objekt lokal gespeichert wird, stellt das System den lokalen Pfad und den Dateinamen für das-Objekt bereit.</span><span class="sxs-lookup"><span data-stu-id="a3c45-151">If the object is stored locally, the system provides the local path and file name for the object.</span></span> <span data-ttu-id="a3c45-152">Wenn das-Objekt remote gespeichert wird, stellt das System einen Universal Naming Convention (UNC)-Netzwerkressourcen Namen für das-Objekt bereit.</span><span class="sxs-lookup"><span data-stu-id="a3c45-152">If the object is stored remotely, the system provides a Universal Naming Convention (UNC) network resource name for the object.</span></span> <span data-ttu-id="a3c45-153">Da das Systemstandort unabhängige Namen bereitstellt, kann ein shelllink als universeller Name für eine Datei dienen, die auf andere Computer übertragen werden kann.</span><span class="sxs-lookup"><span data-stu-id="a3c45-153">Because the system provides location-independent names, a Shell link can serve as a universal name for a file that can be transferred to other computers.</span></span>

### <a name="link-files"></a><span data-ttu-id="a3c45-154">Dateien verknüpfen</span><span class="sxs-lookup"><span data-stu-id="a3c45-154">Link Files</span></span>

<span data-ttu-id="a3c45-155">Wenn der Benutzer eine Verknüpfung zu einem Objekt erstellt, indem er im Kontextmenü des Objekts den Befehl **Verknüpfung erstellen** auswählt, speichert Windows die Informationen, die er benötigt, um auf das Objekt in einer Linkdatei zuzugreifen – eine Binärdatei mit der Dateinamenerweiterung. lnk.</span><span class="sxs-lookup"><span data-stu-id="a3c45-155">When the user creates a shortcut to an object by choosing the **Create Shortcut** command from the object's shortcut menu, Windows stores the information it needs to access the object in a link file—a binary file that has the .lnk file name extension.</span></span> <span data-ttu-id="a3c45-156">Eine Linkdatei enthält die folgenden Informationen:</span><span class="sxs-lookup"><span data-stu-id="a3c45-156">A link file contains the following information:</span></span>

-   <span data-ttu-id="a3c45-157">Der Speicherort (Pfad) des Objekts, auf das durch die Verknüpfung verwiesen wird (als entsprechendes Objekt bezeichnet).</span><span class="sxs-lookup"><span data-stu-id="a3c45-157">The location (path) of the object referenced by the shortcut (called the corresponding object).</span></span>
-   <span data-ttu-id="a3c45-158">Das Arbeitsverzeichnis des entsprechenden Objekts.</span><span class="sxs-lookup"><span data-stu-id="a3c45-158">The working directory of the corresponding object.</span></span>
-   <span data-ttu-id="a3c45-159">Die Liste der Argumente, die das System an das entsprechende Objekt übergibt, wenn die [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) -Methode für die Verknüpfung aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="a3c45-159">The list of arguments that the system passes to the corresponding object when the [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) method is activated for the shortcut.</span></span>
-   <span data-ttu-id="a3c45-160">Der Show-Befehl, der verwendet wird, um den anfänglichen Anzeige Zustand des entsprechenden Objekts festzulegen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-160">The show command used to set the initial show state of the corresponding object.</span></span> <span data-ttu-id="a3c45-161">Dies ist einer der \_ in [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow)beschriebenen SW-Werte.</span><span class="sxs-lookup"><span data-stu-id="a3c45-161">This is one of the SW\_ values described in [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow).</span></span>
-   <span data-ttu-id="a3c45-162">Der Speicherort (Pfad und Index) des Symbol der Verknüpfung.</span><span class="sxs-lookup"><span data-stu-id="a3c45-162">The location (path and index) of the shortcut's icon.</span></span>
-   <span data-ttu-id="a3c45-163">Die Beschreibungs Zeichenfolge der Verknüpfung.</span><span class="sxs-lookup"><span data-stu-id="a3c45-163">The shortcut's description string.</span></span>
-   <span data-ttu-id="a3c45-164">Die Tastenkombination für die Verknüpfung.</span><span class="sxs-lookup"><span data-stu-id="a3c45-164">The keyboard shortcut for the shortcut.</span></span>

<span data-ttu-id="a3c45-165">Wenn eine Linkdatei gelöscht wird, ist das entsprechende Objekt nicht betroffen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-165">When a link file is deleted, the corresponding object is not affected.</span></span>

<span data-ttu-id="a3c45-166">Wenn Sie eine Verknüpfung zu einer anderen Verknüpfung erstellen, kopiert das System einfach die Linkdatei, anstatt eine neue Linkdatei zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-166">If you create a shortcut to another shortcut, the system simply copies the link file rather than creating a new link file.</span></span> <span data-ttu-id="a3c45-167">In diesem Fall sind die Verknüpfungen nicht unabhängig voneinander.</span><span class="sxs-lookup"><span data-stu-id="a3c45-167">In this case, the shortcuts will not be independent of each other.</span></span>

<span data-ttu-id="a3c45-168">Eine Anwendung kann eine Dateinamenerweiterung als Dateityp für die Verknüpfung registrieren.</span><span class="sxs-lookup"><span data-stu-id="a3c45-168">An application can register a file name extension as a shortcut file type.</span></span> <span data-ttu-id="a3c45-169">Wenn eine Datei eine Dateinamenerweiterung hat, die als Verknüpfungs Dateityp registriert wurde, fügt das System automatisch das System definierte Link Überlagerungs Symbol (ein kleiner Pfeil) zum Symbol der Datei hinzu.</span><span class="sxs-lookup"><span data-stu-id="a3c45-169">If a file has a file name extension that has been registered as a shortcut file type, the system automatically adds the system-defined link overlay icon (a small arrow) to the file's icon.</span></span> <span data-ttu-id="a3c45-170">Wenn Sie eine Dateinamenerweiterung als Verknüpfungs Dateityp registrieren möchten, müssen Sie den Wert IsShortcut der Registrierungs Beschreibung der Dateinamenerweiterung hinzufügen, wie im folgenden Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-170">To register a file name extension as a shortcut file type, you must add the IsShortcut value to the registry description of the file name extension, as shown in the example below.</span></span> <span data-ttu-id="a3c45-171">Beachten Sie, dass die Shell neu gestartet werden muss, damit das Überlagerungs Symbol wirksam wird.</span><span class="sxs-lookup"><span data-stu-id="a3c45-171">Note that the Shell must be restarted for the overlay icon to take effect.</span></span> <span data-ttu-id="a3c45-172">IsShortcut hat keinen Datenwert.</span><span class="sxs-lookup"><span data-stu-id="a3c45-172">IsShortcut has no data value.</span></span>

```
HKEY_CLASSES_ROOT
   .xyz
      (Default) = XYZApp
   XYZApp
      IsShortcut
```

### <a name="shortcut-names"></a><span data-ttu-id="a3c45-173">Verknüpfungs Namen</span><span class="sxs-lookup"><span data-stu-id="a3c45-173">Shortcut names</span></span>

<span data-ttu-id="a3c45-174">Der Name der Verknüpfung, bei der es sich um eine Zeichenfolge handelt, die unterhalb des shelllinksymbols angezeigt wird, ist tatsächlich der Dateiname der Verknüpfung.</span><span class="sxs-lookup"><span data-stu-id="a3c45-174">The shortcut's name, which is a string that appears below the Shell link icon, is actually the file name of the shortcut itself.</span></span> <span data-ttu-id="a3c45-175">Der Benutzer kann die Beschreibungs Zeichenfolge bearbeiten, indem er Sie auswählen und eine neue Zeichenfolge eingeben.</span><span class="sxs-lookup"><span data-stu-id="a3c45-175">The user can edit the description string by selecting it and entering a new string.</span></span>

### <a name="location-of-shortcuts-in-the-namespace"></a><span data-ttu-id="a3c45-176">Speicherort von Verknüpfungen im Namespace</span><span class="sxs-lookup"><span data-stu-id="a3c45-176">Location of shortcuts in the namespace</span></span>

<span data-ttu-id="a3c45-177">Eine Verknüpfung kann auf dem Desktop oder an einer beliebigen Stelle im-Namespace der Shell vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="a3c45-177">A shortcut can exist on the desktop or anywhere in the Shell's namespace.</span></span> <span data-ttu-id="a3c45-178">Ebenso kann das Objekt, das der Verknüpfung zugeordnet ist, auch an beliebiger Stelle im-Namespace der Shell vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="a3c45-178">Similarly, the object that is associated with the shortcut can also exist anywhere in the Shell's namespace.</span></span> <span data-ttu-id="a3c45-179">Eine Anwendung kann die [**IShellLink:: setpath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setpath) -Methode verwenden, um den Pfad und den Dateinamen für das zugeordnete Objekt festzulegen, und die [**IShellLink:: getpath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) -Methode, um den aktuellen Pfad und den Dateinamen für das Objekt abzurufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-179">An application can use the [**IShellLink::SetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setpath) method to set the path and file name for the associated object, and the [**IShellLink::GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) method to retrieve the current path and file name for the object.</span></span>

### <a name="shortcut-working-directory"></a><span data-ttu-id="a3c45-180">Arbeitsverzeichnis für die Verknüpfung</span><span class="sxs-lookup"><span data-stu-id="a3c45-180">Shortcut working directory</span></span>

<span data-ttu-id="a3c45-181">Das Arbeitsverzeichnis ist das Verzeichnis, in dem das entsprechende Objekt einer Verknüpfung Dateien lädt oder speichert, wenn der Benutzer kein bestimmtes Verzeichnis identifiziert.</span><span class="sxs-lookup"><span data-stu-id="a3c45-181">The working directory is the directory where the corresponding object of a shortcut loads or stores files when the user does not identify a specific directory.</span></span> <span data-ttu-id="a3c45-182">Eine Linkdatei enthält den Namen des Arbeitsverzeichnisses für das entsprechende Objekt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-182">A link file contains the name of the working directory for the corresponding object.</span></span> <span data-ttu-id="a3c45-183">Eine Anwendung kann den Namen des Arbeitsverzeichnisses für das entsprechende Objekt mithilfe der [**IShellLink:: setworkingdirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setworkingdirectory) -Methode festlegen und den Namen des aktuellen Arbeitsverzeichnisses für das entsprechende Objekt mithilfe der [**IShellLink:: GetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getworkingdirectory) -Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-183">An application can set the name of the working directory for the corresponding object by using the [**IShellLink::SetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setworkingdirectory) method and can retrieve the name of the current working directory for the corresponding object by using the [**IShellLink::GetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getworkingdirectory) method.</span></span>

### <a name="shortcut-command-line-arguments"></a><span data-ttu-id="a3c45-184">Befehlszeilenargumente für die Verknüpfung</span><span class="sxs-lookup"><span data-stu-id="a3c45-184">Shortcut command-line arguments</span></span>

<span data-ttu-id="a3c45-185">Eine Linkdatei enthält Befehlszeilenargumente, die die Shell an das entsprechende Objekt übergibt, wenn der Benutzer den Link auswählt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-185">A link file contains command-line arguments that the Shell passes to the corresponding object when the user selects the link.</span></span> <span data-ttu-id="a3c45-186">Eine Anwendung kann die Befehlszeilenargumente für eine Verknüpfung mithilfe der [**IShellLink:: setArguments**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setarguments) -Methode festlegen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-186">An application can set the command-line arguments for a shortcut by using the [**IShellLink::SetArguments**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setarguments) method.</span></span> <span data-ttu-id="a3c45-187">Es ist hilfreich, Befehlszeilenargumente festzulegen, wenn die entsprechende Anwendung, z. b. ein linker oder ein Compiler, spezielle Flags als Argumente annimmt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-187">It is useful to set command-line arguments when the corresponding application, such as a linker or compiler, takes special flags as arguments.</span></span> <span data-ttu-id="a3c45-188">Eine Anwendung kann die Befehlszeilenargumente mithilfe der [**IShellLink:: GetArguments**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-ishelllinka-getarguments) -Methode aus einer Verknüpfung abrufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-188">An application can retrieve the command-line arguments from a shortcut by using the [**IShellLink::GetArguments**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-ishelllinka-getarguments) method.</span></span>

### <a name="shortcut-show-commands"></a><span data-ttu-id="a3c45-189">Tastenkombinationen anzeigen</span><span class="sxs-lookup"><span data-stu-id="a3c45-189">Shortcut show commands</span></span>

<span data-ttu-id="a3c45-190">Wenn der Benutzer auf eine Verknüpfung doppelklickt, startet das System die Anwendung, die dem entsprechenden Objekt zugeordnet ist, und legt den anfänglichen Ansichts Zustand der Anwendung auf der Grundlage des durch die Verknüpfung angegebenen Befehls anzeigen fest.</span><span class="sxs-lookup"><span data-stu-id="a3c45-190">When the user double-clicks a shortcut, the system starts the application associated with the corresponding object and sets the initial show state of the application based on the show command specified by the shortcut.</span></span> <span data-ttu-id="a3c45-191">Der Show-Befehl kann einer der \_ in der Beschreibung der [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) -Funktion enthaltenen SW-Werte sein.</span><span class="sxs-lookup"><span data-stu-id="a3c45-191">The show command can be any of the SW\_ values included in the description of the [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) function.</span></span> <span data-ttu-id="a3c45-192">Eine Anwendung kann den Show-Befehl für eine Verknüpfung mithilfe der [**IShellLink:: setshowcmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setshowcmd) -Methode festlegen und kann den aktuellen Show-Befehl mithilfe der [**IShellLink:: getshowcmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getshowcmd) -Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-192">An application can set the show command for a shortcut by using the [**IShellLink::SetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setshowcmd) method and can retrieve the current show command by using the [**IShellLink::GetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getshowcmd) method.</span></span>

### <a name="shortcut-icons"></a><span data-ttu-id="a3c45-193">Tastenkombinationen</span><span class="sxs-lookup"><span data-stu-id="a3c45-193">Shortcut icons</span></span>

<span data-ttu-id="a3c45-194">Wie bei anderen shellobjekten weist eine Verknüpfung ein Symbol auf.</span><span class="sxs-lookup"><span data-stu-id="a3c45-194">Like other Shell objects, a shortcut has an icon.</span></span> <span data-ttu-id="a3c45-195">Der Benutzer greift auf das-Objekt zu, das einer Verknüpfung zugeordnet ist, indem er auf das Symbol der Verknüpfung doppelklickt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-195">The user accesses the object associated with a shortcut by double-clicking the shortcut's icon.</span></span> <span data-ttu-id="a3c45-196">Wenn das System ein Symbol für eine Verknüpfung erstellt, wird die Bitmap des entsprechenden Objekts verwendet, und das System definierte linküberlagerungs Symbol (ein kleiner Pfeil) wird in der unteren linken Ecke hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-196">When the system creates an icon for a shortcut, it uses the bitmap of the corresponding object and adds the system-defined link overlay icon (a small arrow) to the lower left corner.</span></span> <span data-ttu-id="a3c45-197">Eine Anwendung kann den Speicherort (Pfad und Index) des Symbols einer Verknüpfung mithilfe der [**IShellLink:: setikonlocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-seticonlocation) -Methode festlegen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-197">An application can set the location (path and index) of a shortcut's icon by using the [**IShellLink::SetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-seticonlocation) method.</span></span> <span data-ttu-id="a3c45-198">Eine Anwendung kann diesen Speicherort mithilfe der [**IShellLink:: getikonlocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-geticonlocation) -Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-198">An application can retrieve this location by using the [**IShellLink::GetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-geticonlocation) method.</span></span>

### <a name="shortcut-descriptions"></a><span data-ttu-id="a3c45-199">Verknüpfungs Beschreibungen</span><span class="sxs-lookup"><span data-stu-id="a3c45-199">Shortcut descriptions</span></span>

<span data-ttu-id="a3c45-200">Verknüpfungen verfügen über Beschreibungen, aber der Benutzer sieht diese nicht.</span><span class="sxs-lookup"><span data-stu-id="a3c45-200">Shortcuts have descriptions, but the user never sees them.</span></span> <span data-ttu-id="a3c45-201">Eine Anwendung kann eine Beschreibung verwenden, um Textinformationen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="a3c45-201">An application can use a description to store any text information.</span></span> <span data-ttu-id="a3c45-202">Beschreibungen werden mithilfe der [**IShellLink:: setDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) -Methode festgelegt und mithilfe der [**IShellLink:: GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) -Methode abgerufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-202">Descriptions are set using the [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) method and retrieved using the [**IShellLink::GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) method.</span></span>

### <a name="shortcut-keyboard-shortcuts"></a><span data-ttu-id="a3c45-203">Tastenkombinationen für Tastenkombinationen</span><span class="sxs-lookup"><span data-stu-id="a3c45-203">Shortcut Keyboard Shortcuts</span></span>

<span data-ttu-id="a3c45-204">Einem Verknüpfungs Objekt kann eine Tastenkombination zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="a3c45-204">A shortcut object can have a keyboard shortcut associated with it.</span></span> <span data-ttu-id="a3c45-205">Tastenkombinationen ermöglichen Benutzern das Drücken einer Tastenkombination, um eine Verknüpfung zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="a3c45-205">Keyboard shortcuts allow a user to press a combination of keys to activate a shortcut.</span></span> <span data-ttu-id="a3c45-206">Eine Anwendung kann die Tastenkombination für eine Verknüpfung mithilfe der [**IShellLink:: SetHotKey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-sethotkey) -Methode festlegen und die aktuelle Tastenkombination mithilfe der [**IShellLink:: GetHotKey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-gethotkey) -Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-206">An application can set the keyboard shortcut for a shortcut by using the [**IShellLink::SetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-sethotkey) method and can retrieve the current keyboard shortcut by using the [**IShellLink::GetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-gethotkey) method.</span></span>

### <a name="item-identifiers-and-identifier-lists"></a><span data-ttu-id="a3c45-207">Element Bezeichner und bezeichnerlisten</span><span class="sxs-lookup"><span data-stu-id="a3c45-207">Item Identifiers and Identifier Lists</span></span>

<span data-ttu-id="a3c45-208">Die Shell verwendet Objekt Bezeichner im-Namespace der Shell.</span><span class="sxs-lookup"><span data-stu-id="a3c45-208">The Shell uses object identifiers within the Shell's namespace.</span></span> <span data-ttu-id="a3c45-209">Alle Objekte, die in der Shell (Dateien, Verzeichnisse, Server, Arbeitsgruppen usw.) sichtbar sind, verfügen über eindeutige IDs zwischen den Objekten innerhalb ihres übergeordneten Ordners.</span><span class="sxs-lookup"><span data-stu-id="a3c45-209">All objects visible in the Shell (files, directories, servers, workgroups, and so on) have unique identifiers among the objects within their parent folder.</span></span> <span data-ttu-id="a3c45-210">Diese Bezeichner werden als Element Bezeichner bezeichnet und verfügen über den [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Datentyp, der in der Header Datei "shtypes. h" definiert ist.</span><span class="sxs-lookup"><span data-stu-id="a3c45-210">These identifiers are called item identifiers, and they have the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) data type as defined in the Shtypes.h header file.</span></span> <span data-ttu-id="a3c45-211">Ein Element Bezeichner ist ein Bytestream variabler Länge, der Informationen enthält, die ein Objekt in einem Ordner identifizieren.</span><span class="sxs-lookup"><span data-stu-id="a3c45-211">An item identifier is a variable-length byte stream that contains information that identifies an object within a folder.</span></span> <span data-ttu-id="a3c45-212">Nur der Ersteller eines Element Bezeichners kennt den Inhalt und das Format des Bezeichners.</span><span class="sxs-lookup"><span data-stu-id="a3c45-212">Only the creator of an item identifier knows the content and format of the identifier.</span></span> <span data-ttu-id="a3c45-213">Der einzige Teil eines Element Bezeichners, der von der Shell verwendet wird, sind die ersten zwei Bytes, die die Größe des Bezeichners angeben.</span><span class="sxs-lookup"><span data-stu-id="a3c45-213">The only part of an item identifier that the Shell uses is the first two bytes, which specify the size of the identifier.</span></span>

<span data-ttu-id="a3c45-214">Jeder übergeordnete Ordner verfügt über einen eigenen Element Bezeichner, der ihn innerhalb seines eigenen übergeordneten Ordners identifiziert.</span><span class="sxs-lookup"><span data-stu-id="a3c45-214">Each parent folder has its own item identifier that identifies it within its own parent folder.</span></span> <span data-ttu-id="a3c45-215">Folglich kann jedes Shellobjekt durch eine Liste von Element Bezeichner eindeutig identifiziert werden.</span><span class="sxs-lookup"><span data-stu-id="a3c45-215">Thus, any Shell object can be uniquely identified by a list of item identifiers.</span></span> <span data-ttu-id="a3c45-216">Ein übergeordneter Ordner speichert eine Liste der Bezeichner für die darin enthaltenen Elemente.</span><span class="sxs-lookup"><span data-stu-id="a3c45-216">A parent folder keeps a list of identifiers for the items it contains.</span></span> <span data-ttu-id="a3c45-217">Die Liste enthält den [**itemittellist**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) -Datentyp.</span><span class="sxs-lookup"><span data-stu-id="a3c45-217">The list has the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) data type.</span></span> <span data-ttu-id="a3c45-218">Elementbezeichnerlisten werden von der Shell zugeordnet und können über Shellschnittstellen, wie z. b. [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="a3c45-218">Item identifier lists are allocated by the Shell and may be passed across Shell interfaces, such as [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span></span> <span data-ttu-id="a3c45-219">Beachten Sie, dass jeder Bezeichner in der Liste der Element Bezeichner nur innerhalb des Kontexts seines übergeordneten Ordners sinnvoll ist.</span><span class="sxs-lookup"><span data-stu-id="a3c45-219">It is important to remember that each identifier in an item identifier list is only meaningful within the context of its parent folder.</span></span>

<span data-ttu-id="a3c45-220">Eine Anwendung kann die elementbezeichnerliste einer Verknüpfung mithilfe der [**IShellLink:: setidlist**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) -Methode festlegen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-220">An application can set a shortcut's item identifier list by using the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) method.</span></span> <span data-ttu-id="a3c45-221">Diese Methode ist nützlich, wenn Sie eine Verknüpfung zu einem Objekt festlegen, das keine Datei ist, z. b. ein Drucker oder ein Laufwerk.</span><span class="sxs-lookup"><span data-stu-id="a3c45-221">This method is useful when setting a shortcut to an object that is not a file, such as a printer or disk drive.</span></span> <span data-ttu-id="a3c45-222">Eine Anwendung kann die elementbezeichnerliste eines Verknüpfungs Elements mithilfe der [**IShellLink:: getidlist**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getidlist) -Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-222">An application can retrieve a shortcut's item identifier list by using the [**IShellLink::GetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getidlist) method.</span></span>

## <a name="using-shell-links"></a><span data-ttu-id="a3c45-223">Verwenden von shelllinks</span><span class="sxs-lookup"><span data-stu-id="a3c45-223">Using Shell Links</span></span>

<span data-ttu-id="a3c45-224">Dieser Abschnitt enthält Beispiele, die veranschaulichen, wie Verknüpfungen in einer Win32-basierten Anwendung erstellt und aufgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="a3c45-224">This section contains examples that demonstrate how to create and resolve shortcuts from within a Win32-based application.</span></span> <span data-ttu-id="a3c45-225">In diesem Abschnitt wird davon ausgegangen, dass Sie mit der Programmierung von Win32, C++ und OLE COM vertraut sind.</span><span class="sxs-lookup"><span data-stu-id="a3c45-225">This section assumes you are familiar with Win32, C++, and OLE COM programming.</span></span>

### <a name="creating-a-shortcut-and-a-folder-shortcut-to-a-file"></a><span data-ttu-id="a3c45-226">Erstellen einer Verknüpfung und einer Ordner Verknüpfung zu einer Datei</span><span class="sxs-lookup"><span data-stu-id="a3c45-226">Creating a Shortcut and a Folder Shortcut to a File</span></span>

<span data-ttu-id="a3c45-227">Mit der Funktion "Beispiel Funktion" im folgenden Beispiel wird eine Verknüpfung erstellt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-227">The CreateLink sample function in the following example creates a shortcut.</span></span> <span data-ttu-id="a3c45-228">Die Parameter enthalten einen Zeiger auf den Namen der Datei, mit der eine Verknüpfung hergestellt werden soll, einen Zeiger auf den Namen der zu erstellenden Verknüpfung und einen Zeiger auf die Beschreibung des Links.</span><span class="sxs-lookup"><span data-stu-id="a3c45-228">The parameters include a pointer to the name of the file to link to, a pointer to the name of the shortcut that you are creating, and a pointer to the description of the link.</span></span> <span data-ttu-id="a3c45-229">Die Beschreibung besteht aus der Zeichenfolge "Verknüpfung mit **Dateiname**", wobei " **Dateiname** " der Name der Datei ist, mit der eine Verknüpfung hergestellt werden soll.</span><span class="sxs-lookup"><span data-stu-id="a3c45-229">The description consists of the string, "Shortcut to **file name**," where **file name** is the name of the file to link to.</span></span>

<span data-ttu-id="a3c45-230">Rufen Sie zum Erstellen einer Ordner Verknüpfung mithilfe der Funktion "samatelink Sample" [**cokreateinstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) mithilfe \_ von CLSID foldershortcut auf, anstelle von CLSID \_ shelllink (CLSID \_ foldershortcut unterstützt IShellLink).</span><span class="sxs-lookup"><span data-stu-id="a3c45-230">To create a folder shortcut using the CreateLink sample function, call [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) using CLSID\_FolderShortcut, instead of CLSID\_ShellLink (CLSID\_FolderShortcut supports IShellLink).</span></span> <span data-ttu-id="a3c45-231">Der gesamte andere Code bleibt unverändert.</span><span class="sxs-lookup"><span data-stu-id="a3c45-231">All other code remains the same.</span></span>

<span data-ttu-id="a3c45-232">Da die [**CoInitialize**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion von "aliatelink" aufgerufen wird, wird davon ausgegangen, dass die [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) -Funktion bereits aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="a3c45-232">Because CreateLink calls the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function, it is assumed that the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function has already been called.</span></span> <span data-ttu-id="a3c45-233">"Kreatelink" verwendet die [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) -Schnittstelle zum Speichern der Verknüpfung und die [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) -Schnittstelle zum Speichern des Datei namens und der Beschreibung.</span><span class="sxs-lookup"><span data-stu-id="a3c45-233">CreateLink uses the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface to save the shortcut and the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface to store the file name and description.</span></span>


```C++
// CreateLink - Uses the Shell's IShellLink and IPersistFile interfaces 
//              to create and store a shortcut to the specified object. 
//
// Returns the result of calling the member functions of the interfaces. 
//
// Parameters:
// lpszPathObj  - Address of a buffer that contains the path of the object,
//                including the file name.
// lpszPathLink - Address of a buffer that contains the path where the 
//                Shell link is to be stored, including the file name.
// lpszDesc     - Address of a buffer that contains a description of the 
//                Shell link, stored in the Comment field of the link
//                properties.

#include "stdafx.h"
#include "windows.h"
#include "winnls.h"
#include "shobjidl.h"
#include "objbase.h"
#include "objidl.h"
#include "shlguid.h"

HRESULT CreateLink(LPCWSTR lpszPathObj, LPCSTR lpszPathLink, LPCWSTR lpszDesc) 
{ 
    HRESULT hres; 
    IShellLink* psl; 
 
    // Get a pointer to the IShellLink interface. It is assumed that CoInitialize
    // has already been called.
    hres = CoCreateInstance(CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, IID_IShellLink, (LPVOID*)&psl); 
    if (SUCCEEDED(hres)) 
    { 
        IPersistFile* ppf; 
 
        // Set the path to the shortcut target and add the description. 
        psl->SetPath(lpszPathObj); 
        psl->SetDescription(lpszDesc); 
 
        // Query IShellLink for the IPersistFile interface, used for saving the 
        // shortcut in persistent storage. 
        hres = psl->QueryInterface(IID_IPersistFile, (LPVOID*)&ppf); 
 
        if (SUCCEEDED(hres)) 
        { 
            WCHAR wsz[MAX_PATH]; 
 
            // Ensure that the string is Unicode. 
            MultiByteToWideChar(CP_ACP, 0, lpszPathLink, -1, wsz, MAX_PATH); 
            
            // Add code here to check return value from MultiByteWideChar 
            // for success.
 
            // Save the link by calling IPersistFile::Save. 
            hres = ppf->Save(wsz, TRUE); 
            ppf->Release(); 
        } 
        psl->Release(); 
    } 
    return hres; 
```



### <a name="resolving-a-shortcut"></a><span data-ttu-id="a3c45-234">Auflösen einer Verknüpfung</span><span class="sxs-lookup"><span data-stu-id="a3c45-234">Resolving a Shortcut</span></span>

<span data-ttu-id="a3c45-235">Eine Anwendung muss möglicherweise auf eine zuvor erstellte Verknüpfung zugreifen und diese bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="a3c45-235">An application may need to access and manipulate a shortcut that was previously created.</span></span> <span data-ttu-id="a3c45-236">Dieser Vorgang wird als Auflösen der Verknüpfung bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="a3c45-236">This operation is referred to as resolving the shortcut.</span></span>

<span data-ttu-id="a3c45-237">Durch die Anwendungs definierte resolveit-Funktion im folgenden Beispiel wird eine Verknüpfung aufgelöst.</span><span class="sxs-lookup"><span data-stu-id="a3c45-237">The application-defined ResolveIt function in the following example resolves a shortcut.</span></span> <span data-ttu-id="a3c45-238">Zu den Parametern gehören ein Fenster Handle, ein Zeiger auf den Pfad der Verknüpfung und die Adresse eines Puffers, der den neuen Pfad zum Objekt empfängt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-238">Its parameters include a window handle, a pointer to the path of the shortcut, and the address of a buffer that receives the new path to the object.</span></span> <span data-ttu-id="a3c45-239">Das Fenster Handle identifiziert das übergeordnete Fenster für alle Meldungs Felder, die die Shell möglicherweise anzeigen muss.</span><span class="sxs-lookup"><span data-stu-id="a3c45-239">The window handle identifies the parent window for any message boxes that the Shell may need to display.</span></span> <span data-ttu-id="a3c45-240">Beispielsweise kann die Shell ein Meldungs Feld anzeigen, wenn sich der Link auf nicht freigegebenen Medien befindet, wenn Netzwerkprobleme auftreten, wenn der Benutzer eine Diskette einfügen muss usw.</span><span class="sxs-lookup"><span data-stu-id="a3c45-240">For example, the Shell can display a message box if the link is on unshared media, if network problems occur, if the user needs to insert a floppy disk, and so on.</span></span>

<span data-ttu-id="a3c45-241">Die resolveit-Funktion Ruft die [**cokreatanstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion auf und geht davon aus, dass die [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) -Funktion bereits aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="a3c45-241">The ResolveIt function calls the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function and assumes that the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function has already been called.</span></span> <span data-ttu-id="a3c45-242">Beachten Sie, dass resolveit die [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) -Schnittstelle zum Speichern der Link Informationen verwenden muss.</span><span class="sxs-lookup"><span data-stu-id="a3c45-242">Note that ResolveIt needs to use the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface to store the link information.</span></span> <span data-ttu-id="a3c45-243">**IPersistFile** wird durch das [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) -Objekt implementiert.</span><span class="sxs-lookup"><span data-stu-id="a3c45-243">**IPersistFile** is implemented by the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) object.</span></span> <span data-ttu-id="a3c45-244">Die Link Informationen müssen geladen werden, bevor die Pfadinformationen abgerufen werden. Dies wird später im Beispiel dargestellt.</span><span class="sxs-lookup"><span data-stu-id="a3c45-244">The link information must be loaded before the path information is retrieved, which is shown later in the example.</span></span> <span data-ttu-id="a3c45-245">Wenn beim Laden der Link Informationen ein Fehler auftritt, werden die Aufrufe der Member-Funktionen [**IShellLink:: getpath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) und [**IShellLink:: GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-245">Failing to load the link information causes the calls to the [**IShellLink::GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) and [**IShellLink::GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) member functions to fail.</span></span>


```C++
// ResolveIt - Uses the Shell's IShellLink and IPersistFile interfaces 
//             to retrieve the path and description from an existing shortcut. 
//
// Returns the result of calling the member functions of the interfaces. 
//
// Parameters:
// hwnd         - A handle to the parent window. The Shell uses this window to 
//                display a dialog box if it needs to prompt the user for more 
//                information while resolving the link.
// lpszLinkFile - Address of a buffer that contains the path of the link,
//                including the file name.
// lpszPath     - Address of a buffer that receives the path of the link
                  target, including the file name.
// lpszDesc     - Address of a buffer that receives the description of the 
//                Shell link, stored in the Comment field of the link
//                properties.

#include "stdafx.h"
#include "windows.h"
#include "shobjidl.h"
#include "shlguid.h"
#include "strsafe.h"
                            
HRESULT ResolveIt(HWND hwnd, LPCSTR lpszLinkFile, LPWSTR lpszPath, int iPathBufferSize) 
{ 
    HRESULT hres; 
    IShellLink* psl; 
    WCHAR szGotPath[MAX_PATH]; 
    WCHAR szDescription[MAX_PATH]; 
    WIN32_FIND_DATA wfd; 
 
    *lpszPath = 0; // Assume failure 

    // Get a pointer to the IShellLink interface. It is assumed that CoInitialize
    // has already been called. 
    hres = CoCreateInstance(CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, IID_IShellLink, (LPVOID*)&psl); 
    if (SUCCEEDED(hres)) 
    { 
        IPersistFile* ppf; 
 
        // Get a pointer to the IPersistFile interface. 
        hres = psl->QueryInterface(IID_IPersistFile, (void**)&ppf); 
        
        if (SUCCEEDED(hres)) 
        { 
            WCHAR wsz[MAX_PATH]; 
 
            // Ensure that the string is Unicode. 
            MultiByteToWideChar(CP_ACP, 0, lpszLinkFile, -1, wsz, MAX_PATH); 
 
            // Add code here to check return value from MultiByteWideChar 
            // for success.
 
            // Load the shortcut. 
            hres = ppf->Load(wsz, STGM_READ); 
            
            if (SUCCEEDED(hres)) 
            { 
                // Resolve the link. 
                hres = psl->Resolve(hwnd, 0); 

                if (SUCCEEDED(hres)) 
                { 
                    // Get the path to the link target. 
                    hres = psl->GetPath(szGotPath, MAX_PATH, (WIN32_FIND_DATA*)&wfd, SLGP_SHORTPATH); 

                    if (SUCCEEDED(hres)) 
                    { 
                        // Get the description of the target. 
                        hres = psl->GetDescription(szDescription, MAX_PATH); 

                        if (SUCCEEDED(hres)) 
                        {
                            hres = StringCbCopy(lpszPath, iPathBufferSize, szGotPath);
                            if (SUCCEEDED(hres))
                            {
                                // Handle success
                            }
                            else
                            {
                                // Handle the error
                            }
                        }
                    }
                } 
            } 

            // Release the pointer to the IPersistFile interface. 
            ppf->Release(); 
        } 

        // Release the pointer to the IShellLink interface. 
        psl->Release(); 
    } 
    return hres; 
}
```



### <a name="creating-a-shortcut-to-a-nonfile-object"></a><span data-ttu-id="a3c45-246">Erstellen einer Verknüpfung mit einem nicht Datei Objekt</span><span class="sxs-lookup"><span data-stu-id="a3c45-246">Creating a Shortcut to a Nonfile Object</span></span>

<span data-ttu-id="a3c45-247">Das Erstellen einer Verknüpfung mit einem nicht Datei Objekt, wie z. b. einem Drucker, ähnelt dem Erstellen einer Verknüpfung zu einer Datei mit der Ausnahme, dass Sie die bezeichnerliste auf den Drucker festlegen müssen, anstatt den Pfad für die Datei festzulegen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-247">Creating a shortcut to a nonfile object, such as a printer, is similar to creating a shortcut to a file except that rather than setting the path to the file, you must set the identifier list to the printer.</span></span> <span data-ttu-id="a3c45-248">Um die bezeichnerliste festzulegen, wenden Sie die [**IShellLink:: setidlist**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) -Methode an, und geben Sie dabei die Adresse einer bezeichnerliste an.</span><span class="sxs-lookup"><span data-stu-id="a3c45-248">To set the identifier list, call the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) method, specifying the address of an identifier list.</span></span>

<span data-ttu-id="a3c45-249">Jedes-Objekt im-Namespace der Shell hat einen Element Bezeichner.</span><span class="sxs-lookup"><span data-stu-id="a3c45-249">Each object within the Shell's namespace has an item identifier.</span></span> <span data-ttu-id="a3c45-250">Die Shell verkettet häufig Element Bezeichner in mit NULL endenden Listen, die aus einer beliebigen Anzahl von Element bezeichaten bestehen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-250">The Shell often concatenates item identifiers into null-terminated lists consisting of any number of item identifiers.</span></span> <span data-ttu-id="a3c45-251">Weitere Informationen zu Element Bezeichnern finden Sie unter [Element Bezeichner und bezeichnerlisten](#item-identifiers-and-identifier-lists).</span><span class="sxs-lookup"><span data-stu-id="a3c45-251">For more information about item identifiers, see [Item Identifiers and Identifier Lists](#item-identifiers-and-identifier-lists).</span></span>

<span data-ttu-id="a3c45-252">Wenn Sie eine Verknüpfung zu einem Element festlegen müssen, das keinen Dateinamen hat (z. b. ein Drucker), verfügen Sie im allgemeinen bereits über einen Zeiger auf die [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) -Schnittstelle des Objekts.</span><span class="sxs-lookup"><span data-stu-id="a3c45-252">In general, if you need to set a shortcut to an item that does not have a file name, such as a printer, you will already have a pointer to the object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="a3c45-253">**IShellFolder** wird zum Erstellen von Namespace Erweiterungen verwendet.</span><span class="sxs-lookup"><span data-stu-id="a3c45-253">**IShellFolder** is used to create namespace extensions.</span></span>

<span data-ttu-id="a3c45-254">Sobald Sie den Klassen Bezeichner für [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder)haben, können Sie die [**cokreateinstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) -Funktion aufrufen, um die Adresse der Schnittstelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-254">Once you have the class identifier for [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), you can call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function to retrieve the address of the interface.</span></span> <span data-ttu-id="a3c45-255">Anschließend können Sie die-Schnittstelle aufrufen, um die Objekte im Ordner aufzuzählen und die Adresse des Element Bezeichners für das gesuchte Objekt abzurufen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-255">Then you can call the interface to enumerate the objects in the folder and retrieve the address of the item identifier for the object that you are searching for.</span></span> <span data-ttu-id="a3c45-256">Schließlich können Sie die Adresse in einem Aufrufe der [**IShellLink:: setidlist**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) -Member-Funktion verwenden, um eine Verknüpfung mit dem-Objekt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a3c45-256">Finally, you can use the address in a call to the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) member function to create a shortcut to the object.</span></span>

 

 
