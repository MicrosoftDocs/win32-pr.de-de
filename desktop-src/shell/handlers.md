---
description: Die Funktionen der Shell können mit Registrierungs Einträgen und INI-Dateien erweitert werden.
ms.assetid: 74a81e4f-7357-4901-a118-ba44e8892f25
title: Erstellen von Shellerweiterungshandlern
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 991f3c1684b7491e2ad29fae29f48164ffdd47cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104994702"
---
# <a name="creating-shell-extension-handlers"></a><span data-ttu-id="c0837-103">Erstellen von Shellerweiterungshandlern</span><span class="sxs-lookup"><span data-stu-id="c0837-103">Creating Shell Extension Handlers</span></span>

<span data-ttu-id="c0837-104">Die Funktionen der Shell können mit Registrierungs Einträgen und INI-Dateien erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="c0837-105">Diese Vorgehensweise zur Erweiterung der Shell ist einfach und für viele Zwecke ausreichend, Sie ist jedoch begrenzt.</span><span class="sxs-lookup"><span data-stu-id="c0837-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="c0837-106">Wenn Sie z. b. die Registrierung verwenden, um ein benutzerdefiniertes Symbol für einen Dateityp anzugeben, wird das gleiche Symbol für jede Datei dieses Typs angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c0837-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="c0837-107">Wenn Sie die Shell mit der Registrierung erweitern, können Sie das Symbol für verschiedene Dateien desselben Typs nicht verändern.</span><span class="sxs-lookup"><span data-stu-id="c0837-107">Extending the Shell with the registry does not allow you to vary the icon for different files of the same type.</span></span> <span data-ttu-id="c0837-108">Andere Aspekte der Shell, wie z. b. das **Eigenschaften Blatt Eigenschaften** , das angezeigt werden kann, wenn mit der rechten Maustaste auf eine Datei geklickt wird, können überhaupt nicht mit der Registrierung geändert werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="c0837-109">Eine leistungsfähigere und flexiblere Methode zur Erweiterung der Shell ist die Implementierung von *Shellerweiterungs Handlern*.</span><span class="sxs-lookup"><span data-stu-id="c0837-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="c0837-110">Diese Handler können für eine Reihe von Aktionen implementiert werden, die von der Shell durchgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="c0837-110">These handlers can be implemented for a variety of actions that the Shell can perform.</span></span> <span data-ttu-id="c0837-111">Vor dem Ausführen der Aktion fragt die Shell den Erweiterungs Handler ab und gibt ihm die Möglichkeit, die Aktion zu ändern.</span><span class="sxs-lookup"><span data-stu-id="c0837-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="c0837-112">Ein gängiges Beispiel ist ein Erweiterungs Handler für den Kontextmenü.</span><span class="sxs-lookup"><span data-stu-id="c0837-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="c0837-113">Wenn eine Datei für einen Dateityp implementiert ist, wird Sie jedes Mal abgefragt, wenn auf eine der Dateien mit der rechten Maustaste geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="c0837-114">Der Handler kann dann zusätzliche Menü Elemente auf Datei-für-Datei-Basis angeben, anstatt denselben Satz für den gesamten Dateityp zu haben.</span><span class="sxs-lookup"><span data-stu-id="c0837-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for the entire file type.</span></span>

<span data-ttu-id="c0837-115">In diesem Dokument wird erläutert, wie Sie die Erweiterungs Handler implementieren, mit denen Sie eine Vielzahl von shellaktionen ändern können.</span><span class="sxs-lookup"><span data-stu-id="c0837-115">This document discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="c0837-116">Die folgenden Handler sind einem bestimmten Dateityp zugeordnet und ermöglichen Ihnen die Angabe von Datei-für-Datei-Basis:</span><span class="sxs-lookup"><span data-stu-id="c0837-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis:</span></span>



| <span data-ttu-id="c0837-117">Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-117">Handler</span></span>                                               | <span data-ttu-id="c0837-118">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="c0837-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c0837-119">Kontextmenü Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="c0837-120">Wird aufgerufen, bevor das Kontextmenü einer Datei angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="c0837-121">Sie ermöglicht das Hinzufügen von Elementen zum Kontextmenü auf Datei Basis.</span><span class="sxs-lookup"><span data-stu-id="c0837-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="c0837-122">Daten Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="c0837-123">Wird aufgerufen, wenn ein Drag & Drop-Vorgang für dragshell-Objekte ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-123">Called when a drag-and-drop operation is performed on dragShell objects.</span></span> <span data-ttu-id="c0837-124">Sie ermöglicht es Ihnen, zusätzliche Zwischenablage Formate für das Ablage Ziel bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="c0837-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                        |
| [<span data-ttu-id="c0837-125">Drop-Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="c0837-126">Wird aufgerufen, wenn ein Datenobjekt in einer Datei gezogen oder gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="c0837-127">Sie ermöglicht es Ihnen, eine Datei in ein Ablage Ziel zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="c0837-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="c0837-128">Symbol Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="c0837-129">Wird aufgerufen, bevor das Symbol einer Datei angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="c0837-130">Dadurch können Sie das Standard Symbol der Datei durch ein benutzerdefiniertes Symbol auf Datei Basis ersetzen.</span><span class="sxs-lookup"><span data-stu-id="c0837-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="c0837-131">Eigenschaftenblatthandler</span><span class="sxs-lookup"><span data-stu-id="c0837-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="c0837-132">Wird aufgerufen, bevor das **Eigenschaften** Blatt eines Objekts angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="c0837-133">Sie können Seiten hinzufügen oder ersetzen.</span><span class="sxs-lookup"><span data-stu-id="c0837-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="c0837-134">**Miniatur Ansichts Bild Handler**</span><span class="sxs-lookup"><span data-stu-id="c0837-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="c0837-135">Stellt ein Bild bereit, das das Element darstellt.</span><span class="sxs-lookup"><span data-stu-id="c0837-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="c0837-136">**QuickInfo-Handler**</span><span class="sxs-lookup"><span data-stu-id="c0837-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="c0837-137">Stellt Popup Text bereit, wenn der Benutzer mit dem Mauszeiger auf das-Objekt zeigt.</span><span class="sxs-lookup"><span data-stu-id="c0837-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="c0837-138">**Metadatenhandler**</span><span class="sxs-lookup"><span data-stu-id="c0837-138">**Metadata handler**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)     | <span data-ttu-id="c0837-139">Bietet Lese-und Schreibzugriff auf Metadaten (Eigenschaften), die in einer Datei gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="c0837-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="c0837-140">Dies kann verwendet werden, um die Detailansicht, die Infotipps, die Eigenschaften Seite und die Gruppierungsfunktionen zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="c0837-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="c0837-141">Andere Handler sind keinem bestimmten Dateityp zugeordnet, werden jedoch vor einigen shellvorgängen aufgerufen:</span><span class="sxs-lookup"><span data-stu-id="c0837-141">Other handlers are not associated with a particular file type but are called before some Shell operations:</span></span>



| <span data-ttu-id="c0837-142">Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-142">Handler</span></span>                                                            | <span data-ttu-id="c0837-143">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="c0837-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c0837-144">Spaltenhandler</span><span class="sxs-lookup"><span data-stu-id="c0837-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="c0837-145">Wird von Windows Explorer aufgerufen, bevor die Detailansicht eines Ordners angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="c0837-146">Damit können Sie der Detailansicht benutzerdefinierte Spalten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c0837-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="c0837-147">Hook-Handler kopieren</span><span class="sxs-lookup"><span data-stu-id="c0837-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="c0837-148">Wird aufgerufen, wenn ein Ordner oder ein Drucker Objekt verschoben, kopiert, gelöscht oder umbenannt wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="c0837-149">Dies ermöglicht es Ihnen, den Vorgang zu genehmigen oder zu überstehen.</span><span class="sxs-lookup"><span data-stu-id="c0837-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="c0837-150">Drag &amp;amp; Drop-Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="c0837-151">Wird aufgerufen, wenn eine Datei mit der rechten Maustaste gezogen wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="c0837-152">Es ermöglicht Ihnen, das angezeigte Kontextmenü zu ändern.</span><span class="sxs-lookup"><span data-stu-id="c0837-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="c0837-153">Symbol Überlagerungs Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="c0837-154">Wird aufgerufen, bevor das Symbol einer Datei angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="c0837-155">Damit können Sie ein Overlay für das Symbol der Datei angeben.</span><span class="sxs-lookup"><span data-stu-id="c0837-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="c0837-156">Such Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="c0837-157">Wird aufgerufen, um eine Suchmaschine zu starten.</span><span class="sxs-lookup"><span data-stu-id="c0837-157">Called to launch a search engine.</span></span> <span data-ttu-id="c0837-158">Damit können Sie eine benutzerdefinierte Suchmaschine implementieren, auf die Sie über das **Startmenü** oder den Windows-Explorer zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="c0837-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="c0837-159">Die Details zur Implementierung bestimmter Erweiterungs Handler werden in den oben aufgeführten Abschnitten behandelt.</span><span class="sxs-lookup"><span data-stu-id="c0837-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="c0837-160">Im restlichen Teil dieses Dokuments werden einige Implementierungsprobleme behandelt, die allen Shellerweiterungs Handlern gemeinsam sind.</span><span class="sxs-lookup"><span data-stu-id="c0837-160">The remainder of this document covers some implementation issues that are common to all Shell extension handlers.</span></span>

-   [<span data-ttu-id="c0837-161">Implementieren von Shellerweiterungs Handlern</span><span class="sxs-lookup"><span data-stu-id="c0837-161">Implementing Shell Extension Handlers</span></span>](#implementing-shell-extension-handlers)
    -   [<span data-ttu-id="c0837-162">Implementieren von IPersistFile</span><span class="sxs-lookup"><span data-stu-id="c0837-162">Implementing IPersistFile</span></span>](#implementing-ipersistfile)
    -   [<span data-ttu-id="c0837-163">Implementieren von ishellextinit</span><span class="sxs-lookup"><span data-stu-id="c0837-163">Implementing IShellExtInit</span></span>](#implementing-ishellextinit)
    -   [<span data-ttu-id="c0837-164">Infotip-Anpassung</span><span class="sxs-lookup"><span data-stu-id="c0837-164">Infotip Customization</span></span>](#infotip-customization)
-   [<span data-ttu-id="c0837-165">Verbessern der Windows-Suche mit Shellerweiterungs Handlern</span><span class="sxs-lookup"><span data-stu-id="c0837-165">Enhancing Windows Search with Shell Extension Handlers</span></span>](#enhancing-windows-search-with-shell-extension-handlers)
-   [<span data-ttu-id="c0837-166">Registrieren von Shellerweiterungs Handlern</span><span class="sxs-lookup"><span data-stu-id="c0837-166">Registering Shell Extension Handlers</span></span>](#registering-shell-extension-handlers)
    -   [<span data-ttu-id="c0837-167">Handlernamen</span><span class="sxs-lookup"><span data-stu-id="c0837-167">Handler Names</span></span>](#handler-names)
    -   [<span data-ttu-id="c0837-168">Vordefinierte Shellobjekte</span><span class="sxs-lookup"><span data-stu-id="c0837-168">Predefined Shell Objects</span></span>](#predefined-shell-objects)
    -   [<span data-ttu-id="c0837-169">Beispiel für eine erweiterungshandlerregistrierung</span><span class="sxs-lookup"><span data-stu-id="c0837-169">Example of an Extension Handler Registration</span></span>](#example-of-an-extension-handler-registration)
-   [<span data-ttu-id="c0837-170">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="c0837-170">Related topics</span></span>](#related-topics)

## <a name="implementing-shell-extension-handlers"></a><span data-ttu-id="c0837-171">Implementieren von Shellerweiterungs Handlern</span><span class="sxs-lookup"><span data-stu-id="c0837-171">Implementing Shell Extension Handlers</span></span>

<span data-ttu-id="c0837-172">Ein Großteil der Implementierung eines Shellerweiterungs-Handlerobjekts hängt vom Typ ab.</span><span class="sxs-lookup"><span data-stu-id="c0837-172">Much of the implementation of a Shell extension handler object depends on its type.</span></span> <span data-ttu-id="c0837-173">Es gibt jedoch einige allgemeine Elemente.</span><span class="sxs-lookup"><span data-stu-id="c0837-173">There are, however, some common elements.</span></span> <span data-ttu-id="c0837-174">In diesem Abschnitt werden die Aspekte der Implementierung erläutert, die von allen Shellerweiterungs Handlern gemeinsam genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-174">This section discusses those aspects of implementation that are shared by all Shell extension handlers.</span></span>

<span data-ttu-id="c0837-175">Viele Shellerweiterungs Handler sind in-Process-Component Object Model (com)-Objekten.</span><span class="sxs-lookup"><span data-stu-id="c0837-175">Many Shell extension handlers are in-process Component Object Model (COM) objects.</span></span> <span data-ttu-id="c0837-176">Sie müssen eine GUID zugewiesen und wie unter Registrieren von Shellerweiterungs Handlern beschrieben registriert sein.</span><span class="sxs-lookup"><span data-stu-id="c0837-176">They must be assigned a GUID and registered as described in Registering Shell Extension Handlers.</span></span> <span data-ttu-id="c0837-177">Sie werden als DLLs implementiert und müssen die folgenden Standardfunktionen exportieren:</span><span class="sxs-lookup"><span data-stu-id="c0837-177">They are implemented as DLLs and must export the following standard functions:</span></span>

-   <span data-ttu-id="c0837-178">[**DllMain**](../dlls/dllmain.md).</span><span class="sxs-lookup"><span data-stu-id="c0837-178">[**DllMain**](../dlls/dllmain.md).</span></span> <span data-ttu-id="c0837-179">Der Standard Einstiegspunkt für die dll.</span><span class="sxs-lookup"><span data-stu-id="c0837-179">The standard entry point to the DLL.</span></span>
-   <span data-ttu-id="c0837-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span><span class="sxs-lookup"><span data-stu-id="c0837-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span></span> <span data-ttu-id="c0837-181">Macht die Klassenfactory des Objekts verfügbar.</span><span class="sxs-lookup"><span data-stu-id="c0837-181">Exposes the object's class factory.</span></span>
-   <span data-ttu-id="c0837-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span><span class="sxs-lookup"><span data-stu-id="c0837-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span></span> <span data-ttu-id="c0837-183">COM ruft diese Funktion auf, um zu bestimmen, ob das Objekt Clients bedient.</span><span class="sxs-lookup"><span data-stu-id="c0837-183">COM calls this function to determine whether the object is serving any clients.</span></span> <span data-ttu-id="c0837-184">Andernfalls kann das System die DLL entladen und den zugeordneten Speicher freigeben.</span><span class="sxs-lookup"><span data-stu-id="c0837-184">If not, the system can unload the DLL and free the associated memory.</span></span>

<span data-ttu-id="c0837-185">Wie alle COM-Objekte müssen Shellerweiterungs Handler eine [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) -Schnittstelle und eine [Klassenfactory](../com/implementing-iclassfactory.md)implementieren.</span><span class="sxs-lookup"><span data-stu-id="c0837-185">Like all COM objects, Shell extension handlers must implement an [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface and a [class factory](../com/implementing-iclassfactory.md).</span></span> <span data-ttu-id="c0837-186">Die meisten Erweiterungs Handler müssen in Windows XP oder früher entweder eine [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) -oder [**ishellextinit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="c0837-186">Most extension handlers must also implement either an [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface in Windows XP or earlier.</span></span> <span data-ttu-id="c0837-187">Diese wurden durch [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) und [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) in Windows Vista ersetzt.</span><span class="sxs-lookup"><span data-stu-id="c0837-187">These were replaced by [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) and [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) in Windows Vista.</span></span> <span data-ttu-id="c0837-188">Die Shell verwendet diese Schnittstellen, um den Handler zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="c0837-188">The Shell uses these interfaces to initialize the handler.</span></span>

<span data-ttu-id="c0837-189">Die [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) -Schnittstelle muss folgendermaßen implementiert werden:</span><span class="sxs-lookup"><span data-stu-id="c0837-189">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="c0837-190">Daten Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-190">Data handlers</span></span>
-   <span data-ttu-id="c0837-191">Drop Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-191">Drop handlers</span></span>

<span data-ttu-id="c0837-192">In der Vergangenheit waren auch Symbol Handler erforderlich, um [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)zu implementieren, dies ist jedoch nicht mehr der Fall.</span><span class="sxs-lookup"><span data-stu-id="c0837-192">In the past, icon handlers were also required to implement [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), but this is no longer true.</span></span> <span data-ttu-id="c0837-193">Bei Symbol Handlern ist **IPersistFile** jetzt optional, und andere Schnittstellen, wie z. b. [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) , werden bevorzugt.</span><span class="sxs-lookup"><span data-stu-id="c0837-193">For icon handlers, **IPersistFile** is now optional and other interfaces such as [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) are preferred.</span></span>

<span data-ttu-id="c0837-194">Die [**ishellextinit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) -Schnittstelle muss wie folgt implementiert werden:</span><span class="sxs-lookup"><span data-stu-id="c0837-194">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="c0837-195">Handler für Kontextmenü</span><span class="sxs-lookup"><span data-stu-id="c0837-195">Shortcut menu handlers</span></span>
-   <span data-ttu-id="c0837-196">Drag & Drop-Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-196">Drag-and-drop handlers</span></span>
-   <span data-ttu-id="c0837-197">Eigenschaften Blatt Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-197">Property sheet handlers</span></span>

### <a name="implementing-ipersistfile"></a><span data-ttu-id="c0837-198">Implementieren von IPersistFile</span><span class="sxs-lookup"><span data-stu-id="c0837-198">Implementing IPersistFile</span></span>

<span data-ttu-id="c0837-199">Die [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) -Schnittstelle soll es ermöglichen, ein Objekt aus einer Datenträger Datei zu laden oder in eine Datei zu speichern.</span><span class="sxs-lookup"><span data-stu-id="c0837-199">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface is intended to permit an object to be loaded from or saved to a disk file.</span></span> <span data-ttu-id="c0837-200">Sie verfügt über sechs Methoden, zusätzlich zu [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), fünf ihrer eigenen und der [**GetClassID-**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) Methode, die von [**ipersistent**](/windows/win32/api/objidl/nn-objidl-ipersist)erbt.</span><span class="sxs-lookup"><span data-stu-id="c0837-200">It has six methods in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), five of its own, and the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) method that it inherits from [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span></span> <span data-ttu-id="c0837-201">Bei Shellerweiterungen wird **ipersistent** nur zum Initialisieren eines Shellerweiterungs-Handlerobjekts verwendet.</span><span class="sxs-lookup"><span data-stu-id="c0837-201">With Shell extensions, **IPersist** is used only to initialize a Shell extension handler object.</span></span> <span data-ttu-id="c0837-202">Da in der Regel kein Lese-oder Schreibzugriff auf den Datenträger erforderlich ist, benötigen nur die Methoden **GetClassID** und [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) eine nicht Token-Implementierung.</span><span class="sxs-lookup"><span data-stu-id="c0837-202">Because there is typically no need to read from or write to the disk, only the **GetClassID** and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods require a nontoken implementation.</span></span>

<span data-ttu-id="c0837-203">Die Shell ruft zuerst [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) auf, und die-Funktion gibt den Klassen Bezeichner (CLSID) des Erweiterungs Handler-Objekts zurück.</span><span class="sxs-lookup"><span data-stu-id="c0837-203">The Shell calls [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) first, and the function returns the class identifier (CLSID) of the extension handler object.</span></span> <span data-ttu-id="c0837-204">Die Shell ruft dann [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) auf und übergibt zwei Werte.</span><span class="sxs-lookup"><span data-stu-id="c0837-204">The Shell then calls [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) and passes in two values.</span></span> <span data-ttu-id="c0837-205">Der erste, *pszFileName*, ist eine Unicode-Zeichenfolge mit dem Namen der Datei oder des Ordners, mit der die Shell arbeiten soll.</span><span class="sxs-lookup"><span data-stu-id="c0837-205">The first, *pszFileName*, is a Unicode string with the name of the file or folder that Shell is about to operate on.</span></span> <span data-ttu-id="c0837-206">Die zweite ist der *dwmode*, der den Datei Zugriffsmodus angibt.</span><span class="sxs-lookup"><span data-stu-id="c0837-206">The second is *dwMode*, which indicates the file access mode.</span></span> <span data-ttu-id="c0837-207">Da der Zugriff auf Dateien in der Regel nicht erforderlich ist, ist *dwmode* normalerweise 0 (null).</span><span class="sxs-lookup"><span data-stu-id="c0837-207">Because there is typically no need to access files, *dwMode* is usually zero.</span></span> <span data-ttu-id="c0837-208">Die-Methode speichert diese Werte nach Bedarf für den späteren Verweis.</span><span class="sxs-lookup"><span data-stu-id="c0837-208">The method stores these values as needed for later reference.</span></span>

<span data-ttu-id="c0837-209">Das folgende Code Fragment veranschaulicht, wie ein typischer shellerweiterungshandler die Methoden [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) und [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) implementiert.</span><span class="sxs-lookup"><span data-stu-id="c0837-209">The following code fragment illustrates how a typical Shell extension handler implements the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods.</span></span> <span data-ttu-id="c0837-210">Es ist für die Handhabung von ANSI oder Unicode konzipiert.</span><span class="sxs-lookup"><span data-stu-id="c0837-210">It is designed to handle either ANSI or Unicode.</span></span> <span data-ttu-id="c0837-211">CLSID \_ sampleexthandler ist die GUID des Erweiterungs Handler-Objekts, und csampleexthandler ist der Name der Klasse, die zum Implementieren der Schnittstelle verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-211">CLSID\_SampleExtHandler is the extension handler object's GUID, and CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="c0837-212">Die Variablen **m \_ szFilename** und **m \_ dwmode** sind private Variablen, die zum Speichern des Namens und der Zugriffsflags der Datei verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-212">The **m\_szFileName** and **m\_dwMode** variables are private variables that are used to store the file's name and access flags.</span></span>


```C++
wchar_t m_szFileName[MAX_PATH];    // The file name
DWORD m_dwMode;                  // The file access mode

CSampleExtHandler::GetClassID(CLSID *pCLSID)
{
    *pCLSID = CLSID_SampleExtHandler;
}

CSampleExtHandler::Load(PCWSTR pszFile, DWORD dwMode)
{
    m_dwMode = dwMode;
    return StringCchCopy(_szFileName, ARRAYSIZE(m_szFileName), pszFile);
}
```

### <a name="implementing-ishellextinit"></a><span data-ttu-id="c0837-213">Implementieren von ishellextinit</span><span class="sxs-lookup"><span data-stu-id="c0837-213">Implementing IShellExtInit</span></span>

<span data-ttu-id="c0837-214">Die [**ishellextinit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) -Schnittstelle verfügt über nur eine Methode, [**ishellextinit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), zusätzlich zu [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="c0837-214">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface has only one method, [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="c0837-215">Die-Methode verfügt über drei Parameter, die von der Shell verwendet werden können, um verschiedene Arten von Informationen zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="c0837-215">The method has three parameters that the Shell can use to pass in various types of information.</span></span> <span data-ttu-id="c0837-216">Welche Werte weitergegeben werden, hängt vom Typ des Handlers ab, und einige können auf **null** festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-216">The values passed in depend on the type of handler, and some can be set to **NULL**.</span></span>

-   <span data-ttu-id="c0837-217">*pidfolder* enthält einen Ordner Zeiger auf eine Element Bezeichner-Liste (PIDL).</span><span class="sxs-lookup"><span data-stu-id="c0837-217">*pIDFolder* holds a folder's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="c0837-218">Bei Eigenschaften Blatt Erweiterungen ist der Wert **null**.</span><span class="sxs-lookup"><span data-stu-id="c0837-218">For property sheet extensions, it is **NULL**.</span></span> <span data-ttu-id="c0837-219">Bei Kontextmenü Erweiterungen ist dies die PIDL des Ordners, der das Element enthält, dessen Kontextmenü angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-219">For shortcut menu extensions, it is the PIDL of the folder that contains the item whose shortcut menu is being displayed.</span></span> <span data-ttu-id="c0837-220">Bei nicht standardmäßigen Drag & Drop-Handlern ist dies die PIDL des Ziel Ordners.</span><span class="sxs-lookup"><span data-stu-id="c0837-220">For nondefault drag-and-drop handlers, it is the PIDL of the target folder.</span></span>
-   <span data-ttu-id="c0837-221">*pdataobject* enthält einen Zeiger auf die [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Schnittstelle eines Datenobjekts.</span><span class="sxs-lookup"><span data-stu-id="c0837-221">*pDataObject* holds a pointer to a data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="c0837-222">Das Datenobjekt enthält einen oder mehrere Dateinamen im [CF- \_ HDROP](dragdrop.md) -Format.</span><span class="sxs-lookup"><span data-stu-id="c0837-222">The data object holds one or more file names in [CF\_HDROP](dragdrop.md) format.</span></span>
-   <span data-ttu-id="c0837-223">*hregkey* enthält einen Registrierungsschlüssel für das Datei Objekt oder den Ordnertyp.</span><span class="sxs-lookup"><span data-stu-id="c0837-223">*hRegKey* holds a registry key for the file object or folder type.</span></span>

<span data-ttu-id="c0837-224">Die [**ishellextinit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) -Methode speichert den Dateinamen, den [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) -Zeiger und den Registrierungsschlüssel nach Bedarf für die spätere Verwendung.</span><span class="sxs-lookup"><span data-stu-id="c0837-224">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method stores the file name, [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer, and registry key as needed for later use.</span></span> <span data-ttu-id="c0837-225">Das folgende Code Fragment veranschaulicht die Implementierung von **ishellextinit:: Initialize**.</span><span class="sxs-lookup"><span data-stu-id="c0837-225">The following code fragment illustrates an implementation of **IShellExtInit::Initialize**.</span></span> <span data-ttu-id="c0837-226">Der Einfachheit halber wird in diesem Beispiel davon ausgegangen, dass das Datenobjekt nur eine einzelne Datei enthält.</span><span class="sxs-lookup"><span data-stu-id="c0837-226">For simplicity, this example assumes that the data object contains only a single file.</span></span> <span data-ttu-id="c0837-227">Im Allgemeinen kann es mehrere Dateien enthalten, die jeweils extrahiert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c0837-227">In general, it might contain multiple files that will each need to be extracted.</span></span>


```C++
LPCITEMIDLIST  m_pIDFolder;           //The folder's PIDL
wchar_t        m_szFile[MAX_PATH];    //The file name
IDataObject   *m_pDataObj;            //The IDataObject pointer
HKEY           m_hRegKey;             //The file or folder's registry key

STDMETHODIMP CShellExt::Initialize(LPCITEMIDLIST pIDFolder, 
                                   IDataObject *pDataObj, 
                                   HKEY hRegKey) 
{ 
    // If Initialize has already been called, release the old PIDL
    ILFree(m_pIDFolder);
    m_pIDFolder = nullptr;

    // Store the new PIDL.
    if (pIDFolder)
    {
        m_pIDFolder = ILClone(pIDFolder);
    }
    
    // If Initialize has already been called, release the old
    // IDataObject pointer.
    if (m_pDataObj)
    { 
        m_pDataObj->Release(); 
    }
     
    // If a data object pointer was passed in, save it and
    // extract the file name. 
    if (pDataObj) 
    { 
        m_pDataObj = pDataObj; 
        pDataObj->AddRef(); 
      
        STGMEDIUM   medium;
        FORMATETC   fe = {CF_HDROP, NULL, DVASPECT_CONTENT, -1, TYMED_HGLOBAL};
        UINT        uCount;

        if (SUCCEEDED(m_pDataObj->GetData(&fe, &medium)))
        {
            // Get the count of files dropped.
            uCount = DragQueryFile((HDROP)medium.hGlobal, (UINT)-1, NULL, 0);

            // Get the first file name from the CF_HDROP.
            if (uCount)
                DragQueryFile((HDROP)medium.hGlobal, 0, m_szFile, 
                              sizeof(m_szFile)/sizeof(TCHAR));

            ReleaseStgMedium(&medium);
        }
    }

    // Duplicate the registry handle. 
    if (hRegKey) 
        RegOpenKeyEx(hRegKey, nullptr, 0L, MAXIMUM_ALLOWED, &m_hRegKey); 
    return S_OK; 
}
```

<span data-ttu-id="c0837-228">Csampleexthandler ist der Name der Klasse, die verwendet wird, um die Schnittstelle zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="c0837-228">CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="c0837-229">Die Variablen " **m \_ pidfolder**", " **m \_ pdataobject**", " **m \_ szFilename**" und " **m \_ hregkey** " sind private Variablen, die zum Speichern der übergebenen Informationen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-229">The **m\_pIDFolder**, **m\_pDataObject**, **m\_szFileName**, and **m\_hRegKey** variables are private variables used to store the information that is passed in.</span></span> <span data-ttu-id="c0837-230">Der Einfachheit halber wird in diesem Beispiel davon ausgegangen, dass nur ein Dateiname vom Datenobjekt gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-230">For simplicity, this example assumes that only one file name will be held by the data object.</span></span> <span data-ttu-id="c0837-231">Nachdem die [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur aus dem Datenobjekt abgerufen wurde, wird [**dragqueryfile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) verwendet, um den Dateinamen aus dem **mittleren. HGLOBAL** -Member der **FORMATETC** -Struktur zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="c0837-231">After the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure is retrieved from the data object, [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) is used to extract the file name from the **FORMATETC** structure's **medium.hGlobal** member.</span></span> <span data-ttu-id="c0837-232">Wenn ein Registrierungsschlüssel an die-Methode übermittelt wird, verwendet die-Methode [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) , um den Schlüssel zu öffnen, und weist dem **m \_ hregkey** das Handle zu.</span><span class="sxs-lookup"><span data-stu-id="c0837-232">If a registry key is passed in, the method uses [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) to open the key and assigns the handle to **m\_hRegKey**.</span></span>

### <a name="infotip-customization"></a><span data-ttu-id="c0837-233">Infotip-Anpassung</span><span class="sxs-lookup"><span data-stu-id="c0837-233">Infotip Customization</span></span>

<span data-ttu-id="c0837-234">Es gibt zwei Möglichkeiten zum Anpassen von infotips:</span><span class="sxs-lookup"><span data-stu-id="c0837-234">There are two ways to customize infotips:</span></span>

-   <span data-ttu-id="c0837-235">Implementieren Sie ein Objekt, das [**iqueryinfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) unterstützt, und registrieren Sie dieses Objekt dann unter dem richtigen Unterschlüssel in der Registrierung (siehe [Registrieren von shellerweiterungshandlern](#registering-shell-extension-handlers) unten).</span><span class="sxs-lookup"><span data-stu-id="c0837-235">Implement an object that supports [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) and then register that object under the proper subkey in the registry (see [Registering Shell Extension Handlers](#registering-shell-extension-handlers) below).</span></span>
-   <span data-ttu-id="c0837-236">Geben Sie eine festgelegte Zeichenfolge oder eine Liste mit bestimmten Dateieigenschaften an, die angezeigt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="c0837-236">Specify a fixed string or a list of specific file properties to be displayed.</span></span>

<span data-ttu-id="c0837-237">Um eine Zeichenfolge fester Zeichenfolge für eine Namespace Erweiterung anzuzeigen, erstellen `InfoTip` Sie einen Eintrag mit dem Namen im *{CLSID}* -Schlüssel der Namespace Erweiterung.</span><span class="sxs-lookup"><span data-stu-id="c0837-237">To display a fixed string for a namespace extension, create an entry called `InfoTip` in the *{CLSID}* key of your namespace extension.</span></span> <span data-ttu-id="c0837-238">Legen Sie den Wert dieses Eintrags entweder auf die Literalzeichenfolge fest, die Sie anzeigen möchten, wie in diesem Beispiel gezeigt, oder eine indirekte Zeichenfolge, die eine Ressource und einen Index innerhalb dieser Ressource angibt (zu Lokalisierungs Zwecken).</span><span class="sxs-lookup"><span data-stu-id="c0837-238">Set the value of that entry to be either the literal string you want to display, as shown in this example, or an indirect string that specifies a resource and index within that resource (for localization purposes).</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {CLSID}
         InfoTip = InfoTip string for your namespace extension
```

<span data-ttu-id="c0837-239">Um eine festgelegte Zeichenfolge für einen Dateityp anzuzeigen, erstellen Sie einen Eintrag `InfoTip` mit dem Namen im *ProgID* -Schlüssel dieses Dateityps.</span><span class="sxs-lookup"><span data-stu-id="c0837-239">To display a fixed string for a file type, create an entry called `InfoTip` in the *ProgID* key of that file type.</span></span> <span data-ttu-id="c0837-240">Legen Sie den Wert dieses Eintrags entweder auf die Literale Zeichenfolge fest, die Sie anzeigen möchten, oder eine indirekte Zeichenfolge, die eine Ressource und einen Index innerhalb dieser Ressource (zu Lokalisierungs Zwecken) angibt, wie in diesem Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="c0837-240">Set the value of that entry to be either the literal string you want to display or an indirect string that specifies a resource and index within that resource (for localization purposes), as shown in this example.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = Resource.dll, 3
```

<span data-ttu-id="c0837-241">Wenn Sie möchten, dass die Shell bestimmte Dateieigenschaften im Infotipp für einen bestimmten Dateityp anzeigt, erstellen Sie `InfoTip` im *ProgID* -Schlüssel für diesen Dateityp einen Eintrag mit dem Namen.</span><span class="sxs-lookup"><span data-stu-id="c0837-241">If you want the Shell to display specific file properties in the infotip for a specific file type, create an entry called `InfoTip` in the *ProgID* key for that file type.</span></span> <span data-ttu-id="c0837-242">Legen Sie den Wert dieses Eintrags auf eine durch Semikolons getrennte Liste von kanonischen Eigenschaftsnamen, Format Bezeichnern (fmtid)/Property Identifier (PID)-Paaren oder beides fest.</span><span class="sxs-lookup"><span data-stu-id="c0837-242">Set the value of that entry to be a semicolon-delineated list of canonical property names, format identifier (FMTID)/property identifier (PID) pairs, or both.</span></span> <span data-ttu-id="c0837-243">Dieser Wert muss mit "prop:" beginnen, um ihn als Eigenschaften Listen Zeichenfolge zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="c0837-243">This value must begin with "prop:" to identify it as a property list string.</span></span> <span data-ttu-id="c0837-244">Wenn Sie "prop:" weglassen, wird der Wert als Literalzeichenfolge betrachtet und als solche angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c0837-244">If you omit "prop:", the value is seen as a literal string and displayed as such.</span></span>

<span data-ttu-id="c0837-245">Im folgenden Beispiel ist *propName* ein kanonischer Eigenschaften Name (z. b. System. Date) und *{fmtid}, PID* ist ein [**fmtid/PID-**](./objects.md) Paar.</span><span class="sxs-lookup"><span data-stu-id="c0837-245">In the following example, *propname* is a canonical property name (such as System.Date) and *{fmtid},pid* is an [**FMTID/PID**](./objects.md) pair.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = prop:propname;propname;{fmtid},pid;{fmtid},pid
```

<span data-ttu-id="c0837-246">Die folgenden Eigenschaften Namen können verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="c0837-246">The following property names can be used:</span></span>



| <span data-ttu-id="c0837-247">Eigenschaftenname</span><span class="sxs-lookup"><span data-stu-id="c0837-247">Property Name</span></span>    | <span data-ttu-id="c0837-248">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="c0837-248">Description</span></span>                   | <span data-ttu-id="c0837-249">Abgerufen von</span><span class="sxs-lookup"><span data-stu-id="c0837-249">Retrieved From</span></span>                                                                             |
|------------------|-------------------------------|--------------------------------------------------------------------------------------------|
| <span data-ttu-id="c0837-250">Autor</span><span class="sxs-lookup"><span data-stu-id="c0837-250">Author</span></span>           | <span data-ttu-id="c0837-251">Autor des Dokuments</span><span class="sxs-lookup"><span data-stu-id="c0837-251">Author of the document</span></span>        | [<span data-ttu-id="c0837-252">**pidsi- \_ Autor**</span><span class="sxs-lookup"><span data-stu-id="c0837-252">**PIDSI\_AUTHOR**</span></span>](../stg/the-summary-information-property-set.md)                              |
| <span data-ttu-id="c0837-253">Titel</span><span class="sxs-lookup"><span data-stu-id="c0837-253">Title</span></span>            | <span data-ttu-id="c0837-254">Titel des Dokuments</span><span class="sxs-lookup"><span data-stu-id="c0837-254">Title of the document</span></span>         | [<span data-ttu-id="c0837-255">**pidsi- \_ Titel**</span><span class="sxs-lookup"><span data-stu-id="c0837-255">**PIDSI\_TITLE**</span></span>](../stg/the-summary-information-property-set.md)                               |
| <span data-ttu-id="c0837-256">Subject</span><span class="sxs-lookup"><span data-stu-id="c0837-256">Subject</span></span>          | <span data-ttu-id="c0837-257">Themen Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="c0837-257">Subject summary</span></span>               | [<span data-ttu-id="c0837-258">**pidsi- \_ Betreff**</span><span class="sxs-lookup"><span data-stu-id="c0837-258">**PIDSI\_SUBJECT**</span></span>](../stg/the-summary-information-property-set.md)                             |
| <span data-ttu-id="c0837-259">Comment</span><span class="sxs-lookup"><span data-stu-id="c0837-259">Comment</span></span>          | <span data-ttu-id="c0837-260">Dokument Kommentare</span><span class="sxs-lookup"><span data-stu-id="c0837-260">Document comments</span></span>             | <span data-ttu-id="c0837-261">[**Pidsi \_ Kommentar**](../stg/the-summary-information-property-set.md) -oder Ordner-/Treibereigenschaften</span><span class="sxs-lookup"><span data-stu-id="c0837-261">[**PIDSI\_COMMENT**](../stg/the-summary-information-property-set.md) or folder/driver properties</span></span> |
| <span data-ttu-id="c0837-262">PageCount</span><span class="sxs-lookup"><span data-stu-id="c0837-262">PageCount</span></span>        | <span data-ttu-id="c0837-263">Anzahl von Seiten</span><span class="sxs-lookup"><span data-stu-id="c0837-263">Number of pages</span></span>               | [<span data-ttu-id="c0837-264">**pidsi \_ Page count**</span><span class="sxs-lookup"><span data-stu-id="c0837-264">**PIDSI\_PAGECOUNT**</span></span>](../stg/the-summary-information-property-set.md)                           |
| <span data-ttu-id="c0837-265">Name</span><span class="sxs-lookup"><span data-stu-id="c0837-265">Name</span></span>             | <span data-ttu-id="c0837-266">Anzeigename</span><span class="sxs-lookup"><span data-stu-id="c0837-266">Friendly name</span></span>                 | <span data-ttu-id="c0837-267">Standard Ordneransicht</span><span class="sxs-lookup"><span data-stu-id="c0837-267">Standard folder view</span></span>                                                                       |
| <span data-ttu-id="c0837-268">Ursprungs Zuordnung</span><span class="sxs-lookup"><span data-stu-id="c0837-268">OriginalLocation</span></span> | <span data-ttu-id="c0837-269">Speicherort der ursprünglichen Datei</span><span class="sxs-lookup"><span data-stu-id="c0837-269">Location of original file</span></span>     | <span data-ttu-id="c0837-270">Ordner "Briefkasten" und "Papierkorb"</span><span class="sxs-lookup"><span data-stu-id="c0837-270">Briefcase folder and Recycle Bin folder</span></span>                                                    |
| <span data-ttu-id="c0837-271">Datedeleted</span><span class="sxs-lookup"><span data-stu-id="c0837-271">DateDeleted</span></span>      | <span data-ttu-id="c0837-272">Die Datums Datei wurde gelöscht.</span><span class="sxs-lookup"><span data-stu-id="c0837-272">Date file was deleted</span></span>         | <span data-ttu-id="c0837-273">Papierkorb Ordner</span><span class="sxs-lookup"><span data-stu-id="c0837-273">Recycle Bin folder</span></span>                                                                         |
| <span data-ttu-id="c0837-274">type</span><span class="sxs-lookup"><span data-stu-id="c0837-274">Type</span></span>             | <span data-ttu-id="c0837-275">Dateityp</span><span class="sxs-lookup"><span data-stu-id="c0837-275">Type of file</span></span>                  | <span data-ttu-id="c0837-276">Ansicht "Standard Ordner Details"</span><span class="sxs-lookup"><span data-stu-id="c0837-276">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="c0837-277">Size</span><span class="sxs-lookup"><span data-stu-id="c0837-277">Size</span></span>             | <span data-ttu-id="c0837-278">Größe der Datei</span><span class="sxs-lookup"><span data-stu-id="c0837-278">Size of file</span></span>                  | <span data-ttu-id="c0837-279">Ansicht "Standard Ordner Details"</span><span class="sxs-lookup"><span data-stu-id="c0837-279">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="c0837-280">Synccopyin</span><span class="sxs-lookup"><span data-stu-id="c0837-280">SyncCopyIn</span></span>       | <span data-ttu-id="c0837-281">Identisch mit "Ursprungs Zuordnung"</span><span class="sxs-lookup"><span data-stu-id="c0837-281">Same as OriginalLocation</span></span>      | <span data-ttu-id="c0837-282">Identisch mit "Ursprungs Zuordnung"</span><span class="sxs-lookup"><span data-stu-id="c0837-282">Same as OriginalLocation</span></span>                                                                   |
| <span data-ttu-id="c0837-283">Geändert</span><span class="sxs-lookup"><span data-stu-id="c0837-283">Modified</span></span>         | <span data-ttu-id="c0837-284">Datum der letzten Änderung</span><span class="sxs-lookup"><span data-stu-id="c0837-284">Date last modified</span></span>            | <span data-ttu-id="c0837-285">Ansicht "Standard Ordner Details"</span><span class="sxs-lookup"><span data-stu-id="c0837-285">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="c0837-286">Erstellt</span><span class="sxs-lookup"><span data-stu-id="c0837-286">Created</span></span>          | <span data-ttu-id="c0837-287">Erstellungsdatum</span><span class="sxs-lookup"><span data-stu-id="c0837-287">Date created</span></span>                  | <span data-ttu-id="c0837-288">Ansicht "Standard Ordner Details"</span><span class="sxs-lookup"><span data-stu-id="c0837-288">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="c0837-289">Auf</span><span class="sxs-lookup"><span data-stu-id="c0837-289">Accessed</span></span>         | <span data-ttu-id="c0837-290">Datum des letzten Zugriffs</span><span class="sxs-lookup"><span data-stu-id="c0837-290">Date last accessed</span></span>            | <span data-ttu-id="c0837-291">Ansicht "Standard Ordner Details"</span><span class="sxs-lookup"><span data-stu-id="c0837-291">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="c0837-292">InFolder</span><span class="sxs-lookup"><span data-stu-id="c0837-292">InFolder</span></span>         | <span data-ttu-id="c0837-293">Verzeichnis, das die Datei enthält</span><span class="sxs-lookup"><span data-stu-id="c0837-293">Directory containing the file</span></span> | <span data-ttu-id="c0837-294">Dokument Suchergebnisse</span><span class="sxs-lookup"><span data-stu-id="c0837-294">Document search results</span></span>                                                                    |
| <span data-ttu-id="c0837-295">Rang</span><span class="sxs-lookup"><span data-stu-id="c0837-295">Rank</span></span>             | <span data-ttu-id="c0837-296">Qualität der Such Übereinstimmung</span><span class="sxs-lookup"><span data-stu-id="c0837-296">Quality of search match</span></span>       | <span data-ttu-id="c0837-297">Dokument Suchergebnisse</span><span class="sxs-lookup"><span data-stu-id="c0837-297">Document search results</span></span>                                                                    |
| <span data-ttu-id="c0837-298">FreeSpace</span><span class="sxs-lookup"><span data-stu-id="c0837-298">FreeSpace</span></span>        | <span data-ttu-id="c0837-299">Verfügbarer Speicherplatz</span><span class="sxs-lookup"><span data-stu-id="c0837-299">Available storage space</span></span>       | <span data-ttu-id="c0837-300">Laufwerke</span><span class="sxs-lookup"><span data-stu-id="c0837-300">Disk drives</span></span>                                                                                |
| <span data-ttu-id="c0837-301">Anzahl von besuchen</span><span class="sxs-lookup"><span data-stu-id="c0837-301">NumberOfVisits</span></span>   | <span data-ttu-id="c0837-302">Anzahl von Aufrufen</span><span class="sxs-lookup"><span data-stu-id="c0837-302">Number of visits</span></span>              | <span data-ttu-id="c0837-303">Ordner "Favoriten"</span><span class="sxs-lookup"><span data-stu-id="c0837-303">Favorites folder</span></span>                                                                           |
| <span data-ttu-id="c0837-304">Attributes</span><span class="sxs-lookup"><span data-stu-id="c0837-304">Attributes</span></span>       | <span data-ttu-id="c0837-305">Dateiattribute</span><span class="sxs-lookup"><span data-stu-id="c0837-305">File Attributes</span></span>               | <span data-ttu-id="c0837-306">Ansicht "Standard Ordner Details"</span><span class="sxs-lookup"><span data-stu-id="c0837-306">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="c0837-307">Company</span><span class="sxs-lookup"><span data-stu-id="c0837-307">Company</span></span>          | <span data-ttu-id="c0837-308">Unternehmensname</span><span class="sxs-lookup"><span data-stu-id="c0837-308">Company name</span></span>                  | [<span data-ttu-id="c0837-309">**piddsi- \_ Unternehmen**</span><span class="sxs-lookup"><span data-stu-id="c0837-309">**PIDDSI\_COMPANY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)    |
| <span data-ttu-id="c0837-310">Kategorie</span><span class="sxs-lookup"><span data-stu-id="c0837-310">Category</span></span>         | <span data-ttu-id="c0837-311">Dokument Kategorie</span><span class="sxs-lookup"><span data-stu-id="c0837-311">Document category</span></span>             | [<span data-ttu-id="c0837-312">**piddsi- \_ Kategorie**</span><span class="sxs-lookup"><span data-stu-id="c0837-312">**PIDDSI\_CATEGORY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)   |
| <span data-ttu-id="c0837-313">Copyright</span><span class="sxs-lookup"><span data-stu-id="c0837-313">Copyright</span></span>        | <span data-ttu-id="c0837-314">Medien Copyright</span><span class="sxs-lookup"><span data-stu-id="c0837-314">Media copyright</span></span>               | [<span data-ttu-id="c0837-315">**pidmsi \_ Copyright**</span><span class="sxs-lookup"><span data-stu-id="c0837-315">**PIDMSI\_COPYRIGHT**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)  |
| <span data-ttu-id="c0837-316">Htmlinfotipfile</span><span class="sxs-lookup"><span data-stu-id="c0837-316">HTMLInfoTipFile</span></span>  | <span data-ttu-id="c0837-317">HTML-infotip-Datei</span><span class="sxs-lookup"><span data-stu-id="c0837-317">HTML InfoTip file</span></span>             | <span data-ttu-id="c0837-318">Datei für Ordner Desktop.ini</span><span class="sxs-lookup"><span data-stu-id="c0837-318">Desktop.ini file for folder</span></span>                                                                |



 

## <a name="enhancing-windows-search-with-shell-extension-handlers"></a><span data-ttu-id="c0837-319">Verbessern der Windows-Suche mit Shellerweiterungs Handlern</span><span class="sxs-lookup"><span data-stu-id="c0837-319">Enhancing Windows Search with Shell Extension Handlers</span></span>

<span data-ttu-id="c0837-320">Shellerweiterungs Handler können verwendet werden, um die Benutzer Leistung eines Windows Search-Protokollhandler zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="c0837-320">Shell extension handlers may be used to enhance the user experience provided by a Windows Search protocol handler.</span></span> <span data-ttu-id="c0837-321">Um solche Erweiterungen zu ermöglichen, muss der Handler für die unterstützende Shellerweiterung so entworfen werden, dass er in den Such Protokollhandler als Datenquelle integriert wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-321">To enable such enhancements, the supporting Shell extension handler must be designed to integrate with the search protocol handler as a data source.</span></span> <span data-ttu-id="c0837-322">Weitere Informationen zum Verbessern eines Windows Search-Protokoll Handlers durch Integration in einen Shellerweiterungs Handler finden Sie unter [Hinzufügen von Symbolen, Vorschauen und Kontextmenüs](../search/-search-3x-wds-ph-ui-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="c0837-322">For information about how to enhance a Windows Search protocol handler through integration with a Shell extension handler, see [Adding Icons, Previews and Shortcut Menus](../search/-search-3x-wds-ph-ui-extensions.md).</span></span> <span data-ttu-id="c0837-323">Weitere Informationen zu Windows Search-Protokoll Handlern finden Sie unter [entwickeln von Protokoll Handlern](../search/-search-3x-wds-phaddins.md).</span><span class="sxs-lookup"><span data-stu-id="c0837-323">For more information about Windows Search protocol handlers, see [Developing Protocol Handlers](../search/-search-3x-wds-phaddins.md).</span></span>

## <a name="registering-shell-extension-handlers"></a><span data-ttu-id="c0837-324">Registrieren von Shellerweiterungs Handlern</span><span class="sxs-lookup"><span data-stu-id="c0837-324">Registering Shell Extension Handlers</span></span>

<span data-ttu-id="c0837-325">Ein shellerweiterungshandlerobjekt muss registriert werden, bevor es von der Shell verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="c0837-325">A Shell extension handler object must be registered before the Shell can use it.</span></span> <span data-ttu-id="c0837-326">In diesem Abschnitt wird die Registrierung eines Shellerweiterungs Handlers ausführlicher erläutert.</span><span class="sxs-lookup"><span data-stu-id="c0837-326">This section is a general discussion of how to register a Shell extension handler.</span></span>

<span data-ttu-id="c0837-327">Jedes Mal, wenn Sie einen Shellerweiterungs Handler erstellen oder ändern, ist es wichtig, das System zu benachrichtigen, dass Sie eine Änderung mit [**shchangenotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify)vorgenommen haben. dabei wird das Ereignis **shcne \_ assocchanged** angegeben.</span><span class="sxs-lookup"><span data-stu-id="c0837-327">Any time you create or change a Shell extension handler, it is important to notify the system that you have made a change with [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), specifying the **SHCNE\_ASSOCCHANGED** event.</span></span> <span data-ttu-id="c0837-328">Wenn Sie **shchangenotify** nicht aufrufen, wird die Änderung möglicherweise erst erkannt, wenn das System neu gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-328">If you do not call **SHChangeNotify**, the change might not be recognized until the system is rebooted.</span></span>

<span data-ttu-id="c0837-329">Wie bei allen COM-Objekten müssen Sie mithilfe eines Tools wie UUIDGEN.exe eine GUID für den Handler erstellen.</span><span class="sxs-lookup"><span data-stu-id="c0837-329">As with all COM objects, you must create a GUID for the handler using a tool such as UUIDGEN.exe.</span></span> <span data-ttu-id="c0837-330">Erstellen Sie einen Schlüssel unter **HKEY \_ Classes \_ root** \\ **CLSID** , deren Name die Zeichen folgen Form der GUID ist.</span><span class="sxs-lookup"><span data-stu-id="c0837-330">Create a key under **HKEY\_CLASSES\_ROOT**\\**CLSID** whose name is the string form of the GUID.</span></span> <span data-ttu-id="c0837-331">Da es sich bei Shellerweiterungs Handlern um Prozess interne Server handelt, müssen Sie einen **InProcServer32** -Schlüssel unter dem GUID-Schlüssel erstellen, wobei der Standardwert auf den Pfad der DLL des Handler festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="c0837-331">Because Shell extension handlers are in-process servers, you must create an **InProcServer32** key under the GUID key with the default value set to the path of the handler's DLL.</span></span> <span data-ttu-id="c0837-332">Verwenden Sie das Apartment Threading Modell.</span><span class="sxs-lookup"><span data-stu-id="c0837-332">Use the Apartment threading model.</span></span>

<span data-ttu-id="c0837-333">Jedes Mal, wenn die Shell eine Aktion ausführt, die einen Shellerweiterungs Handler einschließen kann, wird der entsprechende Registrierungsschlüssel überprüft.</span><span class="sxs-lookup"><span data-stu-id="c0837-333">Any time the Shell takes an action that can involve a Shell extension handler, it checks the appropriate registry key.</span></span> <span data-ttu-id="c0837-334">Der Schlüssel, unter dem ein Erweiterungs Handler registriert ist, steuert, wann er aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="c0837-334">The key under which an extension handler is registered thus controls when it will be called.</span></span> <span data-ttu-id="c0837-335">Beispielsweise ist es üblich, dass ein Kontextmenü Handler aufgerufen wird, wenn die Shell ein Kontextmenü für einen Member eines [Dateityps](fa-file-types.md)anzeigt.</span><span class="sxs-lookup"><span data-stu-id="c0837-335">For instance, it is a common practice to have a shortcut menu handler called when the Shell displays a shortcut menu for a member of a [file type](fa-file-types.md).</span></span> <span data-ttu-id="c0837-336">In diesem Fall muss der Handler unter dem **ProgID** -Schlüssel des Dateityps registriert werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-336">In this case, the handler must be registered under the file type's **ProgID** key.</span></span>

### <a name="handler-names"></a><span data-ttu-id="c0837-337">Handlernamen</span><span class="sxs-lookup"><span data-stu-id="c0837-337">Handler Names</span></span>

<span data-ttu-id="c0837-338">Erstellen Sie zum Aktivieren eines Shellerweiterungs Handlers einen Unterschlüssel mit dem Namen des unter Schlüssels des Handlers (siehe unten) unter dem **shellex** -Unterschlüssel der **ProgID** (für Dateitypen) oder dem shellobjekttypnamen (für [vordefinierte Shellobjekte](#predefined-shell-objects)).</span><span class="sxs-lookup"><span data-stu-id="c0837-338">To enable a Shell extension handler, create a subkey with the handler subkey name (see below) under the **ShellEx** subkey of either the **ProgID** (for file types) or the Shell object type name (for [Predefined Shell Objects](#predefined-shell-objects)).</span></span>

<span data-ttu-id="c0837-339">Wenn Sie z. b. einen Erweiterungs Handler für das Kontextmenü für MyProgram. 1 registrieren möchten, erstellen Sie zunächst den folgenden Unterschlüssel:</span><span class="sxs-lookup"><span data-stu-id="c0837-339">For example, if you wanted to register a shortcut menu extension handler for MyProgram.1, you would begin by creating the following subkey:</span></span>

```
HKEY_CLASSES_ROOT
   MyProgram.1
      ShellEx
         ContextMenuHandlers
```

<span data-ttu-id="c0837-340">Erstellen Sie für die folgenden Handler einen Unterschlüssel unter dem Schlüssel Name des unter Schlüssels "Handler", dessen Name die Zeichen folgen Version der CLSID der Shellerweiterung ist.</span><span class="sxs-lookup"><span data-stu-id="c0837-340">For the following handlers, create a subkey underneath the "Handler Subkey name" key whose name is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="c0837-341">Mehrere Erweiterungen können unter dem namens Schlüssel für den Unterschlüssel des Handlers registriert werden, indem mehrere Unterschlüssel erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-341">Multiple extensions can be registered under the handler subkey name key by creating multiple subkeys.</span></span>



| <span data-ttu-id="c0837-342">Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-342">Handler</span></span>                                               | <span data-ttu-id="c0837-343">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="c0837-343">Interface</span></span>          | <span data-ttu-id="c0837-344">Name des unter Schlüssels des Handlers</span><span class="sxs-lookup"><span data-stu-id="c0837-344">Handler Subkey Name</span></span>       |
|-------------------------------------------------------|--------------------|---------------------------|
| <span data-ttu-id="c0837-345">Kontextmenü Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-345">Shortcut menu handler</span></span>                                 | <span data-ttu-id="c0837-346">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="c0837-346">IContextMenu</span></span>       | <span data-ttu-id="c0837-347">**ContextMenuHandlers**</span><span class="sxs-lookup"><span data-stu-id="c0837-347">**ContextMenuHandlers**</span></span>   |
| <span data-ttu-id="c0837-348">Copyhook-Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-348">Copyhook handler</span></span>                                      | <span data-ttu-id="c0837-349">Icopyhook</span><span class="sxs-lookup"><span data-stu-id="c0837-349">ICopyHook</span></span>          | <span data-ttu-id="c0837-350">**Copyhuokhandlers**</span><span class="sxs-lookup"><span data-stu-id="c0837-350">**CopyHookHandlers**</span></span>      |
| <span data-ttu-id="c0837-351">Drag &amp; Drop-Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-351">Drag-and-drop handler</span></span>                                 | <span data-ttu-id="c0837-352">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="c0837-352">IContextMenu</span></span>       | <span data-ttu-id="c0837-353">**Dragdrophandlers**</span><span class="sxs-lookup"><span data-stu-id="c0837-353">**DragDropHandlers**</span></span>      |
| <span data-ttu-id="c0837-354">Eigenschaftenblatthandler</span><span class="sxs-lookup"><span data-stu-id="c0837-354">Property sheet handler</span></span>                                | <span data-ttu-id="c0837-355">Ishellpropsheetext</span><span class="sxs-lookup"><span data-stu-id="c0837-355">IShellPropSheetExt</span></span> | <span data-ttu-id="c0837-356">**Propertysheethandlers**</span><span class="sxs-lookup"><span data-stu-id="c0837-356">**PropertySheetHandlers**</span></span> |
| <span data-ttu-id="c0837-357">Spalten Anbieter Handler (in Windows Vista veraltet)</span><span class="sxs-lookup"><span data-stu-id="c0837-357">Column provider handler (deprecated in Windows Vista)</span></span> | <span data-ttu-id="c0837-358">Icolumnprovider</span><span class="sxs-lookup"><span data-stu-id="c0837-358">IColumnProvider</span></span>    | <span data-ttu-id="c0837-359">**Columnhandlers**</span><span class="sxs-lookup"><span data-stu-id="c0837-359">**ColumnHandlers**</span></span>        |



 

<span data-ttu-id="c0837-360">Bei den folgenden Handlern ist der Standardwert für den Schlüssel Name des unter Schlüssels "Handler" die Zeichen folgen Version der CLSID der Shellerweiterung.</span><span class="sxs-lookup"><span data-stu-id="c0837-360">For the following handlers, the default value of the "Handler Subkey Name" key is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="c0837-361">Für diese Handler kann nur eine Erweiterung registriert werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-361">Only one extension can be registered for these handlers.</span></span>



| <span data-ttu-id="c0837-362">Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-362">Handler</span></span>                 | <span data-ttu-id="c0837-363">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="c0837-363">Interface</span></span>                                         | <span data-ttu-id="c0837-364">Name des unter Schlüssels des Handlers</span><span class="sxs-lookup"><span data-stu-id="c0837-364">Handler Subkey Name</span></span>                        |
|-------------------------|---------------------------------------------------|--------------------------------------------|
| <span data-ttu-id="c0837-365">Daten Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-365">Data handler</span></span>            | <span data-ttu-id="c0837-366">IDataObject</span><span class="sxs-lookup"><span data-stu-id="c0837-366">IDataObject</span></span>                                       | <span data-ttu-id="c0837-367">**DataHandler**</span><span class="sxs-lookup"><span data-stu-id="c0837-367">**DataHandler**</span></span>                            |
| <span data-ttu-id="c0837-368">Drop-Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-368">Drop handler</span></span>            | <span data-ttu-id="c0837-369">IDropTarget</span><span class="sxs-lookup"><span data-stu-id="c0837-369">IDropTarget</span></span>                                       | <span data-ttu-id="c0837-370">**Drophandler**</span><span class="sxs-lookup"><span data-stu-id="c0837-370">**DropHandler**</span></span>                            |
| <span data-ttu-id="c0837-371">Symbol Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-371">Icon handler</span></span>            | <span data-ttu-id="c0837-372">Iextracticona/W</span><span class="sxs-lookup"><span data-stu-id="c0837-372">IExtractIconA/W</span></span>                                   | <span data-ttu-id="c0837-373">**Iconhandler**</span><span class="sxs-lookup"><span data-stu-id="c0837-373">**IconHandler**</span></span>                            |
| <span data-ttu-id="c0837-374">Bild Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-374">Image handler</span></span>           | <span data-ttu-id="c0837-375">Iextractimage</span><span class="sxs-lookup"><span data-stu-id="c0837-375">IExtractImage</span></span>                                     | <span data-ttu-id="c0837-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span><span class="sxs-lookup"><span data-stu-id="c0837-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span></span> |
| <span data-ttu-id="c0837-377">Miniatur Ansichts Bild Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-377">Thumbnail image handler</span></span> | <span data-ttu-id="c0837-378">IThumbnailProvider</span><span class="sxs-lookup"><span data-stu-id="c0837-378">IThumbnailProvider</span></span>                                | <span data-ttu-id="c0837-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span><span class="sxs-lookup"><span data-stu-id="c0837-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span></span> |
| <span data-ttu-id="c0837-380">QuickInfo-Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-380">Infotip handler</span></span>         | <span data-ttu-id="c0837-381">Iqueryinfo</span><span class="sxs-lookup"><span data-stu-id="c0837-381">IQueryInfo</span></span>                                        | <span data-ttu-id="c0837-382">**{00021500-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="c0837-382">**{00021500-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="c0837-383">Shelllink (ANSI)</span><span class="sxs-lookup"><span data-stu-id="c0837-383">Shell link (ANSI )</span></span>      | <span data-ttu-id="c0837-384">IShellLinkA</span><span class="sxs-lookup"><span data-stu-id="c0837-384">IShellLinkA</span></span>                                       | <span data-ttu-id="c0837-385">**{000214ee-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="c0837-385">**{000214EE-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="c0837-386">Shelllink (Unicode)</span><span class="sxs-lookup"><span data-stu-id="c0837-386">Shell link (UNICODE)</span></span>    | <span data-ttu-id="c0837-387">Ishelllinkw</span><span class="sxs-lookup"><span data-stu-id="c0837-387">IShellLinkW</span></span>                                       | <span data-ttu-id="c0837-388">**{0002149-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="c0837-388">**{000214F9-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="c0837-389">Strukturierter Speicher</span><span class="sxs-lookup"><span data-stu-id="c0837-389">Structured storage</span></span>      | <span data-ttu-id="c0837-390">IStorage</span><span class="sxs-lookup"><span data-stu-id="c0837-390">IStorage</span></span>                                          | <span data-ttu-id="c0837-391">**{0000000b-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="c0837-391">**{0000000B-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="c0837-392">Metadaten</span><span class="sxs-lookup"><span data-stu-id="c0837-392">Metadata</span></span>                | <span data-ttu-id="c0837-393">IPropertyStore</span><span class="sxs-lookup"><span data-stu-id="c0837-393">IPropertyStore</span></span>                                    | <span data-ttu-id="c0837-394">**Propertyhandler**</span><span class="sxs-lookup"><span data-stu-id="c0837-394">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="c0837-395">Metadaten</span><span class="sxs-lookup"><span data-stu-id="c0837-395">Metadata</span></span>                | <span data-ttu-id="c0837-396">IPropertySetStorage (in Windows Vista veraltet)</span><span class="sxs-lookup"><span data-stu-id="c0837-396">IPropertySetStorage (deprecated in Windows Vista)</span></span> | <span data-ttu-id="c0837-397">**Propertyhandler**</span><span class="sxs-lookup"><span data-stu-id="c0837-397">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="c0837-398">An Startmenü anheften</span><span class="sxs-lookup"><span data-stu-id="c0837-398">Pin to Start Menu</span></span>       | <span data-ttu-id="c0837-399">Istartmenupinnedlist</span><span class="sxs-lookup"><span data-stu-id="c0837-399">IStartMenuPinnedList</span></span>                              | <span data-ttu-id="c0837-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span><span class="sxs-lookup"><span data-stu-id="c0837-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span></span> |
| <span data-ttu-id="c0837-401">An Taskleiste anheften</span><span class="sxs-lookup"><span data-stu-id="c0837-401">Pin to Taskbar</span></span>          |                                                   | <span data-ttu-id="c0837-402">**{90aa3a4e-1cba-4233-B8BB-535773d48449}**</span><span class="sxs-lookup"><span data-stu-id="c0837-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span></span> |



 

<span data-ttu-id="c0837-403">Die angegebenen Unterschlüssel zum Hinzufügen einer **PIN zum Startmenü** und zum Anheften **an die Taskleiste** an das Kontextmenü eines Elements sind nur für Dateitypen erforderlich, die den [IsShortcut](./links.md) -Eintrag enthalten.</span><span class="sxs-lookup"><span data-stu-id="c0837-403">The subkeys specified to add **Pin to Start Menu** and **Pin to Taskbar** to an item's shortcut menu are only required for file types that include the [IsShortCut](./links.md) entry.</span></span>

<span data-ttu-id="c0837-404">Die Unterstützung von Spalten Anbieter Handlern wurde in Windows Vista entfernt.</span><span class="sxs-lookup"><span data-stu-id="c0837-404">Support for column provider handlers was removed in Windows Vista.</span></span> <span data-ttu-id="c0837-405">Außerdem wurde [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) ab Windows Vista zugunsten von [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)als veraltet eingestuft.</span><span class="sxs-lookup"><span data-stu-id="c0837-405">Also, as of Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) has been deprecated in favor of [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span>

<span data-ttu-id="c0837-406">Obwohl [**iextractimage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) weiterhin unterstützt wird, wird [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) für Windows Vista und höher bevorzugt.</span><span class="sxs-lookup"><span data-stu-id="c0837-406">While [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) remains supported, [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) is preferred for Windows Vista and later.</span></span>

### <a name="predefined-shell-objects"></a><span data-ttu-id="c0837-407">Vordefinierte Shellobjekte</span><span class="sxs-lookup"><span data-stu-id="c0837-407">Predefined Shell Objects</span></span>

<span data-ttu-id="c0837-408">Die Shell definiert zusätzliche Objekte unter **HKEY \_ Classes \_ root** , die auf die gleiche Weise wie Dateitypen erweitert werden können.</span><span class="sxs-lookup"><span data-stu-id="c0837-408">The Shell defines additional objects under **HKEY\_CLASSES\_ROOT** which can be extended in the same way as file types.</span></span> <span data-ttu-id="c0837-409">Wenn Sie z. b. einen Eigenschaften Blatt Handler für alle Dateien hinzufügen möchten, können Sie sich unter dem **propertysheethandlers** -Schlüssel registrieren.</span><span class="sxs-lookup"><span data-stu-id="c0837-409">For example, to add a property sheet handler for all files, you can register under the **PropertySheetHandlers** key.</span></span>

```
HKEY_CLASSES_ROOT
   *
      shellex
         PropertySheetHandlers
```

<span data-ttu-id="c0837-410">In der folgenden Tabelle sind die verschiedenen Unterschlüssel von **HKEY- \_ Klassen \_ root** , unter denen Erweiterungs Handler registriert werden können, zu finden.</span><span class="sxs-lookup"><span data-stu-id="c0837-410">The following table gives the various subkeys of **HKEY\_CLASSES\_ROOT** under which extension handlers can be registered.</span></span> <span data-ttu-id="c0837-411">Beachten Sie, dass viele Erweiterungs Handler nicht unter allen aufgelisteten unter Schlüsseln registriert werden können.</span><span class="sxs-lookup"><span data-stu-id="c0837-411">Note that many extension handlers cannot be registered under all of the listed subkeys.</span></span> <span data-ttu-id="c0837-412">Weitere Informationen finden Sie in der Dokumentation des jeweiligen Handlers.</span><span class="sxs-lookup"><span data-stu-id="c0837-412">For further details, see the specific handler's documentation.</span></span>



| <span data-ttu-id="c0837-413">Unterschlüssel</span><span class="sxs-lookup"><span data-stu-id="c0837-413">Subkey</span></span>                    | <span data-ttu-id="c0837-414">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="c0837-414">Description</span></span>                                                          | <span data-ttu-id="c0837-415">Mögliche Handler</span><span class="sxs-lookup"><span data-stu-id="c0837-415">Possible Handlers</span></span>                                | <span data-ttu-id="c0837-416">Version</span><span class="sxs-lookup"><span data-stu-id="c0837-416">Version</span></span> |
|---------------------------|----------------------------------------------------------------------|--------------------------------------------------|---------|
| <span data-ttu-id="c0837-417">\**\** _</span><span class="sxs-lookup"><span data-stu-id="c0837-417">\**\** _</span></span>                    | <span data-ttu-id="c0837-418">Alle Dateien</span><span class="sxs-lookup"><span data-stu-id="c0837-418">All files</span></span>                                                            | <span data-ttu-id="c0837-419">Kontextmenü, Eigenschaften Blatt, Verben (siehe unten)</span><span class="sxs-lookup"><span data-stu-id="c0837-419">Shortcut Menu, Property Sheet, Verbs (see below)</span></span> | <span data-ttu-id="c0837-420">All</span><span class="sxs-lookup"><span data-stu-id="c0837-420">All</span></span>     |
| <span data-ttu-id="c0837-421">_ *AllFilesystemObjects*\*</span><span class="sxs-lookup"><span data-stu-id="c0837-421">_ *AllFileSystemObjects*\*</span></span>  | <span data-ttu-id="c0837-422">Alle Dateien und Datei Ordner</span><span class="sxs-lookup"><span data-stu-id="c0837-422">All files and file folders</span></span>                                           | <span data-ttu-id="c0837-423">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-423">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-424">4.71</span><span class="sxs-lookup"><span data-stu-id="c0837-424">4.71</span></span>    |
| <span data-ttu-id="c0837-425">**Ordner**</span><span class="sxs-lookup"><span data-stu-id="c0837-425">**Folder**</span></span>                | <span data-ttu-id="c0837-426">Alle Ordner</span><span class="sxs-lookup"><span data-stu-id="c0837-426">All folders</span></span>                                                          | <span data-ttu-id="c0837-427">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-427">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-428">All</span><span class="sxs-lookup"><span data-stu-id="c0837-428">All</span></span>     |
| <span data-ttu-id="c0837-429">**Verzeichnis**</span><span class="sxs-lookup"><span data-stu-id="c0837-429">**Directory**</span></span>             | <span data-ttu-id="c0837-430">Datei Ordner</span><span class="sxs-lookup"><span data-stu-id="c0837-430">File folders</span></span>                                                         | <span data-ttu-id="c0837-431">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-431">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-432">All</span><span class="sxs-lookup"><span data-stu-id="c0837-432">All</span></span>     |
| <span data-ttu-id="c0837-433">**Verzeichnis \\ Hintergrund**</span><span class="sxs-lookup"><span data-stu-id="c0837-433">**Directory\\Background**</span></span> | <span data-ttu-id="c0837-434">Hintergrund des Datei Ordners</span><span class="sxs-lookup"><span data-stu-id="c0837-434">File folder background</span></span>                                               | <span data-ttu-id="c0837-435">Nur Kontextmenü</span><span class="sxs-lookup"><span data-stu-id="c0837-435">Shortcut Menu only</span></span>                               | <span data-ttu-id="c0837-436">4.71</span><span class="sxs-lookup"><span data-stu-id="c0837-436">4.71</span></span>    |
| <span data-ttu-id="c0837-437">**Laufwerk**</span><span class="sxs-lookup"><span data-stu-id="c0837-437">**Drive**</span></span>                 | <span data-ttu-id="c0837-438">Alle Laufwerke in "MyComputer", z. b. "C: \\ "</span><span class="sxs-lookup"><span data-stu-id="c0837-438">All drives in MyComputer, such as "C:\\"</span></span>                             | <span data-ttu-id="c0837-439">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-439">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-440">All</span><span class="sxs-lookup"><span data-stu-id="c0837-440">All</span></span>     |
| <span data-ttu-id="c0837-441">**Network**</span><span class="sxs-lookup"><span data-stu-id="c0837-441">**Network**</span></span>               | <span data-ttu-id="c0837-442">Gesamtes Netzwerk (unter "meine Netzwerk Plätze")</span><span class="sxs-lookup"><span data-stu-id="c0837-442">Entire network (under My Network Places)</span></span>                             | <span data-ttu-id="c0837-443">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-443">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-444">All</span><span class="sxs-lookup"><span data-stu-id="c0837-444">All</span></span>     |
| <span data-ttu-id="c0837-445">**\\Netzwerktyp\\\#**</span><span class="sxs-lookup"><span data-stu-id="c0837-445">**Network\\Type\\\#**</span></span>     | <span data-ttu-id="c0837-446">Alle Objekte des Typs \# (siehe unten)</span><span class="sxs-lookup"><span data-stu-id="c0837-446">All objects of type \# (see below)</span></span>                                   | <span data-ttu-id="c0837-447">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-447">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-448">4.71</span><span class="sxs-lookup"><span data-stu-id="c0837-448">4.71</span></span>    |
| <span data-ttu-id="c0837-449">**NetShare**</span><span class="sxs-lookup"><span data-stu-id="c0837-449">**NetShare**</span></span>              | <span data-ttu-id="c0837-450">Alle Netzwerkfreigaben</span><span class="sxs-lookup"><span data-stu-id="c0837-450">All network shares</span></span>                                                   | <span data-ttu-id="c0837-451">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-451">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-452">4.71</span><span class="sxs-lookup"><span data-stu-id="c0837-452">4.71</span></span>    |
| <span data-ttu-id="c0837-453">**Netserver**</span><span class="sxs-lookup"><span data-stu-id="c0837-453">**NetServer**</span></span>             | <span data-ttu-id="c0837-454">Alle Netzwerkserver</span><span class="sxs-lookup"><span data-stu-id="c0837-454">All network servers</span></span>                                                  | <span data-ttu-id="c0837-455">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-455">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-456">4.71</span><span class="sxs-lookup"><span data-stu-id="c0837-456">4.71</span></span>    |
| <span data-ttu-id="c0837-457">*Name des Netzwerk \_ Anbieters \_*</span><span class="sxs-lookup"><span data-stu-id="c0837-457">*network\_provider\_name*</span></span> | <span data-ttu-id="c0837-458">Alle Objekte, die vom Netzwerkanbieter "*Netzwerk \_ Anbieter \_ Name*" bereitgestellt werden</span><span class="sxs-lookup"><span data-stu-id="c0837-458">All objects provided by network provider "*network\_provider\_name*"</span></span> | <span data-ttu-id="c0837-459">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-459">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-460">All</span><span class="sxs-lookup"><span data-stu-id="c0837-460">All</span></span>     |
| <span data-ttu-id="c0837-461">**Drucker**</span><span class="sxs-lookup"><span data-stu-id="c0837-461">**Printers**</span></span>              | <span data-ttu-id="c0837-462">Alle Drucker</span><span class="sxs-lookup"><span data-stu-id="c0837-462">All printers</span></span>                                                         | <span data-ttu-id="c0837-463">Kontextmenü, Eigenschaften Blatt</span><span class="sxs-lookup"><span data-stu-id="c0837-463">Shortcut Menu, Property Sheet</span></span>                    | <span data-ttu-id="c0837-464">All</span><span class="sxs-lookup"><span data-stu-id="c0837-464">All</span></span>     |
| <span data-ttu-id="c0837-465">**AudioCD**</span><span class="sxs-lookup"><span data-stu-id="c0837-465">**AudioCD**</span></span>               | <span data-ttu-id="c0837-466">AudioCD in CD-Laufwerk</span><span class="sxs-lookup"><span data-stu-id="c0837-466">Audio CD in CD drive</span></span>                                                 | <span data-ttu-id="c0837-467">Nur Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-467">Verbs only</span></span>                                       | <span data-ttu-id="c0837-468">All</span><span class="sxs-lookup"><span data-stu-id="c0837-468">All</span></span>     |
| <span data-ttu-id="c0837-469">**DVD**</span><span class="sxs-lookup"><span data-stu-id="c0837-469">**DVD**</span></span>                   | <span data-ttu-id="c0837-470">DVD-Laufwerk (Windows 2000)</span><span class="sxs-lookup"><span data-stu-id="c0837-470">DVD drive (Windows 2000)</span></span>                                             | <span data-ttu-id="c0837-471">Kontextmenü, Eigenschaften Blatt, Verben</span><span class="sxs-lookup"><span data-stu-id="c0837-471">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="c0837-472">4.71</span><span class="sxs-lookup"><span data-stu-id="c0837-472">4.71</span></span>    |



 

<span data-ttu-id="c0837-473">Hinweise:</span><span class="sxs-lookup"><span data-stu-id="c0837-473">Notes:</span></span>

-   <span data-ttu-id="c0837-474">Der Zugriff auf das Kontextmenü des Datei Ordners wird durch einen Rechtsklick innerhalb eines Datei Ordners, aber nicht über den Inhalt des Ordners erreicht.</span><span class="sxs-lookup"><span data-stu-id="c0837-474">The file folder background shortcut menu is accessed by right-clicking within a file folder, but not over any of the folder's contents.</span></span>
-   <span data-ttu-id="c0837-475">"Verbs" sind spezielle Befehle, die unter **HKEY \_ Classes \_ root** \\ *subkey* \\ **Shell** \\ **Verb** registriert sind.</span><span class="sxs-lookup"><span data-stu-id="c0837-475">"Verbs" are special commands registered under **HKEY\_CLASSES\_ROOT**\\*Subkey*\\**Shell**\\**Verb** .</span></span>
-   <span data-ttu-id="c0837-476">Für den \\ **Netzwerktyp** \\ **\#** \# ist "" ein Netzwerk Anbietertyp Code in Dezimal.</span><span class="sxs-lookup"><span data-stu-id="c0837-476">For **Network**\\**Type**\\**\#** , "\#" is a network provider type code in decimal.</span></span> <span data-ttu-id="c0837-477">Der Typ Code des Netzwerk Anbieters ist das hohe Wort eines Netzwerk Typs.</span><span class="sxs-lookup"><span data-stu-id="c0837-477">The network provider type code is the high word of a network type.</span></span> <span data-ttu-id="c0837-478">Die Liste der Netzwerktypen wird in der "winnetwk. h"-Header Datei (wnnc \_ net \_ \* Values) angegeben.</span><span class="sxs-lookup"><span data-stu-id="c0837-478">The list of network types is given in the Winnetwk.h header file (WNNC\_NET\_\* values).</span></span> <span data-ttu-id="c0837-479">Beispielsweise ist wnnc \_ net \_ Shiva 0x00330000, daher wäre der entsprechende Typschlüssel **HKEY \_ Classes \_ root** \\ **Network** \\ **Type** \\ **51** .</span><span class="sxs-lookup"><span data-stu-id="c0837-479">For example, WNNC\_NET\_SHIVA is 0x00330000, so the corresponding type key would be **HKEY\_CLASSES\_ROOT**\\**Network**\\**Type**\\**51** .</span></span>
-   <span data-ttu-id="c0837-480">der *Name \_ des \_ Netzwerk Anbieters wird* von [**wnetgetprovidername**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea)angegeben, wobei die Leerzeichen in Unterstriche konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-480">"*network\_provider\_name*" is a network provider name as specified by [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), with the spaces converted into underscores.</span></span> <span data-ttu-id="c0837-481">Wenn z. b. der Microsoft-Netzwerk Netzwerkanbieter installiert ist, lautet sein Anbieter Name "Microsoft Windows-Netzwerk", und der entsprechende *Netzwerk \_ Anbieter \_ Name* lautet **Microsoft \_ Windows- \_ Netzwerk**.</span><span class="sxs-lookup"><span data-stu-id="c0837-481">For example, if the Microsoft Networking network provider is installed, its provider name is "Microsoft Windows Network", and the corresponding *network\_provider\_name* is **Microsoft\_Windows\_Network**.</span></span>

### <a name="example-of-an-extension-handler-registration"></a><span data-ttu-id="c0837-482">Beispiel für eine erweiterungshandlerregistrierung</span><span class="sxs-lookup"><span data-stu-id="c0837-482">Example of an Extension Handler Registration</span></span>

<span data-ttu-id="c0837-483">Um einen bestimmten Handler zu aktivieren, erstellen Sie unter dem Typ des erweiterungshandlers einen Unterschlüssel mit dem Namen des Handlers.</span><span class="sxs-lookup"><span data-stu-id="c0837-483">To enable a particular handler, create a subkey under the extension handler type key with the name of the handler.</span></span> <span data-ttu-id="c0837-484">Die Shell verwendet nicht den Namen des Handlers, aber Sie muss sich von allen anderen Namen unter diesem typunter Schlüssel unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="c0837-484">The Shell does not use the handler's name, but it must be different from all other names under that type subkey.</span></span> <span data-ttu-id="c0837-485">Legen Sie den Standardwert des Namens unter Schlüssels auf die Zeichen folgen Form der GUID des Handlers fest.</span><span class="sxs-lookup"><span data-stu-id="c0837-485">Set the default value of the name subkey to the string form of the handler's GUID.</span></span>

<span data-ttu-id="c0837-486">Das folgende Beispiel veranschaulicht Registrierungseinträge, die Erweiterungs Handler für Kontextmenü und Eigenschaften Blätter mit dem Dateityp example. MYP aktivieren:</span><span class="sxs-lookup"><span data-stu-id="c0837-486">The following example illustrates registry entries that enable shortcut menu and property sheet extension handlers, using an example .myp file type:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   CLSID
      {00000000-1111-2222-3333-444444444444}
         InProcServer32
            (Default) = C:\MyDir\MyCommand.dll
            ThreadingModel = Apartment
      {11111111-2222-3333-4444-555555555555}
         InProcServer32
            (Default) = C:\MyDir\MyPropSheet.dll
            ThreadingModel = Apartment
   MyProgram.1
      (Default) = MyProgram Application
      Shellex
         ContextMenuHandler
            MyCommand
               (Default) = {00000000-1111-2222-3333-444444444444}
         PropertySheetHandlers
            MyPropSheet
               (Default) = {11111111-2222-3333-4444-555555555555}
```

<span data-ttu-id="c0837-487">Das in diesem Abschnitt beschriebene Registrierungsverfahren muss für alle Windows-Systeme befolgt werden.</span><span class="sxs-lookup"><span data-stu-id="c0837-487">The registration procedure discussed in this section must be followed for all Windows systems.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c0837-488">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="c0837-488">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c0837-489">Leitfaden für die Implementierung von In-Process-Erweiterungen</span><span class="sxs-lookup"><span data-stu-id="c0837-489">Guidance for Implementing In-Process Extensions</span></span>](shell-and-managed-code.md)
</dt> </dl>

 

 
