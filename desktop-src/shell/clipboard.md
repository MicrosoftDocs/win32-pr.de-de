---
description: Shellzwischenablage Formate werden verwendet, um den Typ der shelldaten zu identifizieren, die über die Zwischenablage übertragen werden.
ms.assetid: fb8ce5d3-3215-4e05-a916-4d4a803464d2
title: Shellzwischenablage Formate
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 674ccc33db3a35a1a60abb549f5e1ab5b5c96760
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103750265"
---
# <a name="shell-clipboard-formats"></a><span data-ttu-id="4ec44-103">Shellzwischenablage Formate</span><span class="sxs-lookup"><span data-stu-id="4ec44-103">Shell Clipboard Formats</span></span>

<span data-ttu-id="4ec44-104">Shellzwischenablage Formate werden verwendet, um den Typ der shelldaten zu identifizieren, die über die Zwischenablage übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-104">Shell clipboard formats are used to identify the type of Shell data being transferred through the clipboard.</span></span> <span data-ttu-id="4ec44-105">Die meisten shellzwischenablage Formate identifizieren einen Datentyp, z. b. eine Liste mit Dateinamen oder Zeiger auf elementbezeichnerlisten (pidls).</span><span class="sxs-lookup"><span data-stu-id="4ec44-105">Most Shell clipboard formats identify a type of data, such as a list of file names or pointers to item identifier lists (PIDLs).</span></span> <span data-ttu-id="4ec44-106">Einige Formate werden jedoch für die Kommunikation zwischen Quelle und Ziel verwendet.</span><span class="sxs-lookup"><span data-stu-id="4ec44-106">However, some formats are used for communication between source and target.</span></span> <span data-ttu-id="4ec44-107">Sie können den Datenübertragungs Prozess beschleunigen, indem Sie Shellvorgänge wie [optimierte Verschiebung](datascenarios.md) und [delete_on_paste](datascenarios.md)unterstützen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-107">They can expedite the data transfer process by supporting Shell operations such as [optimized move](datascenarios.md) and [delete_on_paste](datascenarios.md).</span></span> <span data-ttu-id="4ec44-108">Shelldaten sind immer in einem [Datenobjekt](dataobject.md) enthalten, das eine [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur als allgemeinere Methode zum charakterisieren von Daten verwendet.</span><span class="sxs-lookup"><span data-stu-id="4ec44-108">Shell data is always contained in a [data object](dataobject.md) that uses a [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure as a more general way to characterize data.</span></span> <span data-ttu-id="4ec44-109">Der **cfFormat** -Member der Struktur wird für das jeweilige Datenelement auf das Zwischenablage Format festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-109">The structure's **cfFormat** member is set to the clipboard format for the particular item of data.</span></span> <span data-ttu-id="4ec44-110">Die anderen Mitglieder stellen zusätzliche Informationen bereit, z. b. den Datenübertragungsmechanismus.</span><span class="sxs-lookup"><span data-stu-id="4ec44-110">The other members provide additional information, such as the data transfer mechanism.</span></span> <span data-ttu-id="4ec44-111">Die Daten sind in einer zugehörigen [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur enthalten.</span><span class="sxs-lookup"><span data-stu-id="4ec44-111">The data is contained in an accompanying [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure.</span></span>

> [!Note]  
> <span data-ttu-id="4ec44-112">Standard Bezeichner für die Zwischenablage haben das Format CF_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="4ec44-112">Standard clipboard format identifiers have the form CF_ *XXX*.</span></span> <span data-ttu-id="4ec44-113">Ein gängiges Beispiel ist CF_TEXT, mit dem ANSI-Textdaten übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-113">A common example is CF_TEXT, which is used for transferring ANSI text data.</span></span> <span data-ttu-id="4ec44-114">Diese Bezeichner verfügen über vordefinierte Werte und können direkt mit [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) -Strukturen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-114">These identifiers have predefined values and can be used directly with [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structures.</span></span> <span data-ttu-id="4ec44-115">Mit Ausnahme von [CF_HDROP](#cf_hdrop)sind shellformatbezeichner nicht vordefiniert.</span><span class="sxs-lookup"><span data-stu-id="4ec44-115">With the exception of [CF_HDROP](#cf_hdrop), Shell format identifiers are not predefined.</span></span> <span data-ttu-id="4ec44-116">Mit der Ausnahme dragwindow haben Sie die Form CFSTR_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="4ec44-116">With the exception of DragWindow, they have the form CFSTR_ *XXX*.</span></span> <span data-ttu-id="4ec44-117">Um diese Werte von vordefinierten Formaten zu unterscheiden, werden Sie häufig als einfache *Formate* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="4ec44-117">To differentiate these values from predefined formats, they are often referred to as simply *formats*.</span></span> <span data-ttu-id="4ec44-118">Anders als bei vordefinierten Formaten müssen Sie jedoch sowohl von der Quelle als auch vom Ziel registriert werden, bevor Sie zum Übertragen von Daten verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="4ec44-118">However, unlike predefined formats, they must be registered by both source and target before they can be used to transfer data.</span></span> <span data-ttu-id="4ec44-119">Zum Registrieren eines shellformats schließen Sie die Header Datei "shlobj. h" ein, und übergeben Sie den Format Bezeichner "CFSTR_ *xxx* " an " [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata)".</span><span class="sxs-lookup"><span data-stu-id="4ec44-119">To register a Shell format, include the Shlobj.h header file and pass the CFSTR_ *XXX* format identifier to [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="4ec44-120">Diese Funktion gibt einen gültigen Wert für die Zwischenablage Format zurück, der dann als **cfFormat** -Member einer **FORMATETC** -Struktur verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="4ec44-120">This function returns a valid clipboard format value, which can then be used as the **cfFormat** member of a **FORMATETC** structure.</span></span>

 

<span data-ttu-id="4ec44-121">Die shellzwischenablage Formate sind hier in drei Gruppen angeordnet, je nachdem, wie Sie verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-121">The Shell clipboard formats are organized here into three groups, based on how they are used.</span></span>

-   [<span data-ttu-id="4ec44-122">Formate für das Übertragen von Datei System Objekten</span><span class="sxs-lookup"><span data-stu-id="4ec44-122">Formats for Transferring File System Objects</span></span>](#formats-for-transferring-file-system-objects)
    -   [<span data-ttu-id="4ec44-123">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="4ec44-123">CF_HDROP</span></span>](#cf_hdrop)
    -   [<span data-ttu-id="4ec44-124">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="4ec44-124">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
    -   [<span data-ttu-id="4ec44-125">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="4ec44-125">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
    -   [<span data-ttu-id="4ec44-126">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="4ec44-126">CFSTR_FILENAME</span></span>](#cfstr_filename)
    -   [<span data-ttu-id="4ec44-127">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="4ec44-127">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
    -   [<span data-ttu-id="4ec44-128">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="4ec44-128">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
    -   [<span data-ttu-id="4ec44-129">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="4ec44-129">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
    -   [<span data-ttu-id="4ec44-130">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="4ec44-130">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)
-   [<span data-ttu-id="4ec44-131">Formate für das Übertragen von virtuellen Objekten</span><span class="sxs-lookup"><span data-stu-id="4ec44-131">Formats for Transferring Virtual Objects</span></span>](#formats-for-transferring-virtual-objects)
    -   [<span data-ttu-id="4ec44-132">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="4ec44-132">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
    -   [<span data-ttu-id="4ec44-133">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="4ec44-133">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
    -   [<span data-ttu-id="4ec44-134">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="4ec44-134">CFSTR_INETURL</span></span>](#cfstr_ineturl)
    -   [<span data-ttu-id="4ec44-135">CFSTR_SHELLURL (veraltet)</span><span class="sxs-lookup"><span data-stu-id="4ec44-135">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)
-   [<span data-ttu-id="4ec44-136">Formate für die Kommunikation zwischen Quelle und Ziel</span><span class="sxs-lookup"><span data-stu-id="4ec44-136">Formats for Communication Between Source and Target</span></span>](#formats-for-communication-between-source-and-target)
    -   [<span data-ttu-id="4ec44-137">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="4ec44-137">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
    -   [<span data-ttu-id="4ec44-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="4ec44-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
    -   [<span data-ttu-id="4ec44-139">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="4ec44-139">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
    -   [<span data-ttu-id="4ec44-140">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="4ec44-140">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
    -   [<span data-ttu-id="4ec44-141">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="4ec44-141">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
    -   [<span data-ttu-id="4ec44-142">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="4ec44-142">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
    -   [<span data-ttu-id="4ec44-143">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="4ec44-143">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
    -   [<span data-ttu-id="4ec44-144">Dragwindow</span><span class="sxs-lookup"><span data-stu-id="4ec44-144">DragWindow</span></span>](#dragwindow)

## <a name="formats-for-transferring-file-system-objects"></a><span data-ttu-id="4ec44-145">Formate für das Übertragen von Datei System Objekten</span><span class="sxs-lookup"><span data-stu-id="4ec44-145">Formats for Transferring File System Objects</span></span>

<span data-ttu-id="4ec44-146">Diese Formate werden verwendet, um eine oder mehrere Dateien oder andere Shellobjekte zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-146">These formats are used to transfer one or more files or other Shell objects.</span></span>

-   [<span data-ttu-id="4ec44-147">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="4ec44-147">CF_HDROP</span></span>](#cf_hdrop)
-   [<span data-ttu-id="4ec44-148">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="4ec44-148">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
-   [<span data-ttu-id="4ec44-149">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="4ec44-149">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
-   [<span data-ttu-id="4ec44-150">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="4ec44-150">CFSTR_FILENAME</span></span>](#cfstr_filename)
-   [<span data-ttu-id="4ec44-151">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="4ec44-151">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
-   [<span data-ttu-id="4ec44-152">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="4ec44-152">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
-   [<span data-ttu-id="4ec44-153">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="4ec44-153">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
-   [<span data-ttu-id="4ec44-154">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="4ec44-154">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)

### <a name="cf_hdrop"></a><span data-ttu-id="4ec44-155">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="4ec44-155">CF_HDROP</span></span>

<span data-ttu-id="4ec44-156">Dieses Zwischenablage Format wird verwendet, wenn die Speicherorte einer Gruppe vorhandener Dateien übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-156">This clipboard format is used when transferring the locations of a group of existing files.</span></span> <span data-ttu-id="4ec44-157">Anders als bei den anderen shellformaten ist es vordefiniert, sodass es nicht erforderlich ist, [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata)aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-157">Unlike the other Shell formats, it is predefined, so there is no need to call [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="4ec44-158">Die Daten bestehen aus einer [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-158">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-159">Der **HGLOBAL** -Member der Struktur verweist auf eine [**dropfiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) -Struktur als sein **HGLOBAL** -Member.</span><span class="sxs-lookup"><span data-stu-id="4ec44-159">The structure's **hGlobal** member points to a [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure as its **hGlobal** member.</span></span>

<span data-ttu-id="4ec44-160">Der **pfiles** -Member der [**dropfiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) -Struktur enthält einen Offset zu einem Double- **null**-terminierten Zeichen Array, das die Dateinamen enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-160">The **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains an offset to a double **null**-terminated character array that contains the file names.</span></span> <span data-ttu-id="4ec44-161">Wenn Sie ein CF_HDROP Format aus einem Datenobjekt extrahieren, können Sie [**dragqueryfile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) verwenden, um einzelne Dateinamen aus dem globalen Speicher Objekt zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="4ec44-161">If you are extracting a CF_HDROP format from a data object, you can use [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) to extract individual file names from the global memory object.</span></span> <span data-ttu-id="4ec44-162">Wenn Sie ein CF_HDROP-Format erstellen, das in einem Datenobjekt platziert werden soll, müssen Sie das Dateinamen Array erstellen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-162">If you are creating a CF_HDROP format to place in a data object, you will need to construct the file name array.</span></span>

<span data-ttu-id="4ec44-163">Das Dateinamen Array besteht aus einer Reihe von Zeichen folgen, die jeweils den voll qualifizierten Pfad einer Datei enthalten, einschließlich des abschließenden **null** -Zeichens.</span><span class="sxs-lookup"><span data-stu-id="4ec44-163">The file name array consists of a series of strings, each containing one file's fully qualified path, including the terminating **NULL** character.</span></span> <span data-ttu-id="4ec44-164">Ein zusätzliches **null** -Zeichen wird an die endgültige Zeichenfolge angehängt, um das Array zu beenden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-164">An additional **null** character is appended to the final string to terminate the array.</span></span> <span data-ttu-id="4ec44-165">Wenn z. b. die Dateien c: \\temp1.txt und c: \\temp2.txt übertragen werden, sieht das Zeichen Array wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="4ec44-165">For example, if the files c:\\temp1.txt and c:\\temp2.txt are being transferred, the character array looks like this:</span></span>


```CMD
c:\temp1.txt'\0'c:\temp2.txt'\0''\0'
```

> [!Note]  
> <span data-ttu-id="4ec44-166">In diesem Beispiel wird " \\ 0" verwendet, um das **null** -Zeichen darzustellen, nicht die Literalzeichen, die eingeschlossen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-166">In this example, '\\0' is used to represent the **null** character, not the literal characters that should be included.</span></span>


<span data-ttu-id="4ec44-167">Wenn das Objekt als Teil eines Drag & Drop-Vorgangs in die Zwischenablage kopiert wurde, enthält der **PT** -Member der [**dropfiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) -Struktur die Koordinaten des Punkts, an dem das Objekt abgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="4ec44-167">If the object was copied to the clipboard as part of a drag-and-drop operation, the **pt** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains the coordinates of the point where the object was dropped.</span></span> <span data-ttu-id="4ec44-168">Sie können [**dragquerypoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) verwenden, um die Cursor Koordinaten zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="4ec44-168">You can use [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) to extract the cursor coordinates.</span></span>

<span data-ttu-id="4ec44-169">Wenn dieses Format in einem Datenobjekt vorhanden ist, simuliert eine OLE-Drag-Schleife [**WM_DROPFILES**](wm-dropfiles.md) Funktionen mit nicht-OLE-Ablage Zielen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-169">If this format is present in a data object, an OLE drag loop simulates [**WM_DROPFILES**](wm-dropfiles.md) functionality with non-OLE drop targets.</span></span> <span data-ttu-id="4ec44-170">Dies ist wichtig, wenn Ihre Anwendung die Quelle eines Drag & Drop-Vorgangs auf einem Windows 3,1-System ist.</span><span class="sxs-lookup"><span data-stu-id="4ec44-170">This is important if your application is the source of a drag-and-drop operation on a Windows 3.1 system.</span></span>

### <a name="cfstr_filecontents"></a><span data-ttu-id="4ec44-171">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="4ec44-171">CFSTR_FILECONTENTS</span></span>

<span data-ttu-id="4ec44-172">Dieser Format Bezeichner wird mit dem [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) -Format verwendet, um Daten zu übertragen, als ob es sich um eine Datei handelt, unabhängig davon, wie Sie tatsächlich gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-172">This format identifier is used with the [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format to transfer data as if it were a file, regardless of how it is actually stored.</span></span> <span data-ttu-id="4ec44-173">Die Daten bestehen aus einer [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die den Inhalt einer Datei darstellt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-173">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that represents the contents of one file.</span></span> <span data-ttu-id="4ec44-174">Die Datei wird normalerweise als Streamobjekt dargestellt, das den Inhalt der Datei nicht im Arbeitsspeicher platzieren muss.</span><span class="sxs-lookup"><span data-stu-id="4ec44-174">The file is normally represented as a stream object, which avoids having to place the contents of the file in memory.</span></span> <span data-ttu-id="4ec44-175">In diesem Fall wird der **TYMED** -Member der **STGMEDIUM** -Struktur auf TYMED_ISTREAM festgelegt, und die Datei wird durch eine [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) -Schnittstelle dargestellt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-175">In that case, the **tymed** member of the **STGMEDIUM** structure is set to TYMED_ISTREAM, and the file is represented by an [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) interface.</span></span> <span data-ttu-id="4ec44-176">Bei der Datei kann es sich auch um ein Speicher Objekt oder ein globales Speicher Objekt (TYMED_ISTORAGE oder TYMED_HGLOBAL) handeln.</span><span class="sxs-lookup"><span data-stu-id="4ec44-176">The file can also be a storage or global memory object (TYMED_ISTORAGE or TYMED_HGLOBAL).</span></span> <span data-ttu-id="4ec44-177">Das zugeordnete CFSTR_FILEDESCRIPTOR Format enthält eine [**Filedescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) -Struktur für jede Datei, die den Namen und die Attribute der Datei angibt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-177">The associated CFSTR_FILEDESCRIPTOR format contains a [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file that specifies the file's name and attributes.</span></span>

<span data-ttu-id="4ec44-178">Das Ziel behandelt die einem CFSTR_FILECONTENTS Format zugeordneten Daten so, als ob es sich um eine Datei handelt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-178">The target treats the data associated with a CFSTR_FILECONTENTS format as if it were a file.</span></span> <span data-ttu-id="4ec44-179">Wenn das Ziel [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) aufruft, um die Daten zu extrahieren, wird eine bestimmte Datei angegeben, indem der **Lindex** -Member der [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur auf den NULL basierten Index der [**Filedescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) -Struktur der Datei im zugehörigen [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) Format festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-179">When the target calls [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to extract the data, it specifies a particular file by setting the **lindex** member of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure in the accompanying [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format.</span></span> <span data-ttu-id="4ec44-180">Das Ziel verwendet dann den zurückgegebenen Schnittstellen Zeiger oder das globale Speicher handle, um die Daten zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="4ec44-180">The target then uses the returned interface pointer or global memory handle to extract the data.</span></span>

### <a name="cfstr_filedescriptor"></a><span data-ttu-id="4ec44-181">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="4ec44-181">CFSTR_FILEDESCRIPTOR</span></span>

<span data-ttu-id="4ec44-182">Dieser Format Bezeichner wird mit dem [CFSTR_FILECONTENTS](#cfstr_filecontents) -Format verwendet, um Daten als Gruppe von Dateien zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-182">This format identifier is used with the [CFSTR_FILECONTENTS](#cfstr_filecontents) format to transfer data as a group of files.</span></span> <span data-ttu-id="4ec44-183">Diese beiden Formate sind die bevorzugte Methode zum Übertragen von shellobjekten, die nicht als Dateisystem Dateien gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-183">These two formats are the preferred way to transfer Shell objects that are not stored as file-system files.</span></span> <span data-ttu-id="4ec44-184">Diese Formate können z. b. verwendet werden, um eine Gruppe von e-Mail-Nachrichten als einzelne Dateien zu übertragen, obwohl jede e-Mail-Adresse tatsächlich als Datenblock in einer Datenbank gespeichert ist.</span><span class="sxs-lookup"><span data-stu-id="4ec44-184">For example, these formats can be used to transfer a group of email messages as individual files, even though each email is actually stored as a block of data in a database.</span></span> <span data-ttu-id="4ec44-185">Die Daten bestehen aus einer [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-185">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-186">Der **HGLOBAL** -Member der Struktur verweist auf eine [**filegroupdescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) -Struktur, auf die ein Array folgt, das eine [**Filedescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) -Struktur für jede Datei in der Gruppe enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-186">The structure's **hGlobal** member points to a [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) structure that is followed by an array containing one [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file in the group.</span></span> <span data-ttu-id="4ec44-187">Für jede **Datei deskriptorstruktur** gibt es ein separates CFSTR_FILECONTENTS Format, das den Inhalt der Datei enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-187">For each **FILEDESCRIPTOR** structure, there is a separate CFSTR_FILECONTENTS format that contains the contents of the file.</span></span> <span data-ttu-id="4ec44-188">Legen Sie den **Lindex** -Wert der [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur auf den NULL basierten Index der **Filedescriptor** -Struktur der Datei fest, um das CFSTR_FILECONTENTS Format einer bestimmten Datei zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="4ec44-188">To identify a particular file's CFSTR_FILECONTENTS format, set the **lIndex** value of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's **FILEDESCRIPTOR** structure.</span></span>

<span data-ttu-id="4ec44-189">Das CFSTR_FILEDESCRIPTOR Format wird häufig verwendet, um Daten zu übertragen, als ob es sich um eine Gruppe von Dateien handelt, unabhängig davon, wie Sie tatsächlich gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-189">The CFSTR_FILEDESCRIPTOR format is commonly used to transfer data as if it were a group of files, regardless of how it is actually stored.</span></span> <span data-ttu-id="4ec44-190">Aus Sicht des Ziels stellt jedes CFSTR_FILECONTENTS Format eine einzelne Datei dar und wird entsprechend behandelt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-190">From the target's perspective, each CFSTR_FILECONTENTS format represents a single file and is treated accordingly.</span></span> <span data-ttu-id="4ec44-191">Die Quelle kann die Daten jedoch in beliebiger Weise speichern.</span><span class="sxs-lookup"><span data-stu-id="4ec44-191">However, the source can store the data in any way it chooses.</span></span> <span data-ttu-id="4ec44-192">Während ein CSFTR_FILECONTENTS Format einer einzelnen Datei entsprechen kann, kann es beispielsweise auch Daten darstellen, die von der Quelle aus einer Datenbank oder einem Textdokument extrahiert werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-192">While a CSFTR_FILECONTENTS format might correspond to a single file, it could also, for example, represent data extracted by the source from a database or text document.</span></span>

### <a name="cfstr_filename"></a><span data-ttu-id="4ec44-193">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="4ec44-193">CFSTR_FILENAME</span></span>

<span data-ttu-id="4ec44-194">Dieser Format Bezeichner wird verwendet, um eine einzelne Datei zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-194">This format identifier is used to transfer a single file.</span></span> <span data-ttu-id="4ec44-195">Die Daten bestehen aus einer [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-195">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-196">Der **HGLOBAL** -Member der Struktur verweist auf eine einzelne auf **null** endenden Zeichenfolge, die den voll qualifizierten Dateipfad der Datei enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-196">The structure's **hGlobal** member points to a single **null**-terminated string containing the file's fully qualified file path.</span></span> <span data-ttu-id="4ec44-197">Dieses Format wurde durch [CF_HDROP](#cf_hdrop)abgelöst, wird jedoch aus Gründen der Abwärtskompatibilität mit Windows 3,1-Anwendungen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-197">This format has been superseded by [CF_HDROP](#cf_hdrop), but it is supported for backward compatibility with Windows 3.1 applications.</span></span>

### <a name="cfstr_filenamemap"></a><span data-ttu-id="4ec44-198">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="4ec44-198">CFSTR_FILENAMEMAP</span></span>

<span data-ttu-id="4ec44-199">Dieser Format Bezeichner wird verwendet, wenn eine Gruppe von Dateien im [CF_HDROP](#cf_hdrop) Format umbenannt und übertragen wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-199">This format identifier is used when a group of files in [CF_HDROP](#cf_hdrop) format is being renamed as well as transferred.</span></span> <span data-ttu-id="4ec44-200">Die Daten bestehen aus einer [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-200">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-201">Der **HGLOBAL** -Member der Struktur verweist auf ein Double- **null**-terminiertes Zeichen Array.</span><span class="sxs-lookup"><span data-stu-id="4ec44-201">The structure's **hGlobal** member points to a double **null**-terminated character array.</span></span> <span data-ttu-id="4ec44-202">Dieses Array enthält einen neuen Namen für jede Datei in derselben Reihenfolge, in der die Dateien im zugehörigen CF_HDROP Format aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="4ec44-202">This array contains a new name for each file, in the same order that the files are listed in the accompanying CF_HDROP format.</span></span> <span data-ttu-id="4ec44-203">Das Format des Zeichen Arrays ist identisch mit dem, das von CF_HDROP zum Auflisten der übertragenen Dateien verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-203">The format of the character array is the same as that used by CF_HDROP to list the transferred files.</span></span>

### <a name="cfstr_mountedvolume"></a><span data-ttu-id="4ec44-204">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="4ec44-204">CFSTR_MOUNTEDVOLUME</span></span>

<span data-ttu-id="4ec44-205">Dieser Format Bezeichner wird verwendet, um einen Pfad auf einem bereitgestellten Volume zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-205">This format identifier is used to transfer a path on a mounted volume.</span></span> <span data-ttu-id="4ec44-206">Sie ähnelt [CF_HDROP](#cf_hdrop), aber Sie enthält nur einen einzigen Pfad und kann die längeren Pfad Zeichenfolgen verarbeiten, die möglicherweise erforderlich sind, um einen Pfad darzustellen, wenn das Volume in einem Ordner bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-206">It is similar to [CF_HDROP](#cf_hdrop), but it contains only a single path and can handle the longer path strings that might be needed to represent a path when the volume is mounted on a folder.</span></span> <span data-ttu-id="4ec44-207">Die Daten bestehen aus einer [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-207">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-208">Der **HGLOBAL** -Member der Struktur verweist auf eine einzelne auf **null** endenden Zeichenfolge, die den voll qualifizierten Dateipfad enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-208">The structure's **hGlobal** member points to a single **null**-terminated string containing the fully qualified file path.</span></span> <span data-ttu-id="4ec44-209">Die Pfad Zeichenfolge muss mit \\ dem Zeichen ' ' enden, gefolgt von dem abschließenden **null**-Zeichen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-209">The path string must end with a '\\' character, followed by the terminating **NULL**.</span></span>

<span data-ttu-id="4ec44-210">Vor Windows 2000 konnten Volumes nur auf Laufwerk Buchstaben eingebunden werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-210">Prior to Windows 2000, volumes could be mounted only on drive letters.</span></span> <span data-ttu-id="4ec44-211">Für Windows 2000-Systeme und spätere Systeme mit einem NTFS-formatierten Laufwerk können Sie auch Volumes in leeren Ordnern einbinden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-211">For Windows 2000 and later systems with an NTFS formatted drive, you can also mount volumes on empty folders.</span></span> <span data-ttu-id="4ec44-212">Diese Funktion ermöglicht es, ein Volume bereitzustellen, ohne einen Laufwerk Buchstaben zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-212">This feature allows a volume to be mounted without taking up a drive letter.</span></span> <span data-ttu-id="4ec44-213">Das bereitgestellte Volume kann alle derzeit unterstützten Formate verwenden, einschließlich FAT, FAT32, NTFS und CDFS.</span><span class="sxs-lookup"><span data-stu-id="4ec44-213">The mounted volume can use any currently supported format, including FAT, FAT32, NTFS, and CDFS.</span></span>

<span data-ttu-id="4ec44-214">Sie können Seiten zu einem Eigenschaften Blatt für Laufwerks Eigenschaften hinzufügen, indem Sie einen [Eigenschaften Blatt Handler](propsheet-handlers.md)implementieren.</span><span class="sxs-lookup"><span data-stu-id="4ec44-214">You can add pages to a Drive Properties property sheet by implementing a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="4ec44-215">Wenn das Volume auf einen Laufwerk Buchstaben eingebunden ist, übergibt die Shell Pfadinformationen mit dem [CF_HDROP](#cf_hdrop) -Format an den Handler.</span><span class="sxs-lookup"><span data-stu-id="4ec44-215">If the volume is mounted on a drive letter, the Shell passes path information to the handler with the [CF_HDROP](#cf_hdrop) format.</span></span> <span data-ttu-id="4ec44-216">Bei Windows 2000 und neueren Systemen wird das CF_HDROP Format verwendet, wenn ein Volume wie bei früheren Systemen auf einem Laufwerk Buchstaben bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-216">With Windows 2000 and later systems, the CF_HDROP format is used when a volume is mounted on a drive letter, just as with earlier systems.</span></span> <span data-ttu-id="4ec44-217">Wenn ein Volume jedoch in einem Ordner bereitgestellt wird, wird der [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) -Format Bezeichner anstelle von CF_HDROP verwendet.</span><span class="sxs-lookup"><span data-stu-id="4ec44-217">However, if a volume is mounted on a folder, the [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) format identifier is used instead of CF_HDROP.</span></span>

<span data-ttu-id="4ec44-218">Wenn nur Laufwerksbuchstaben zum Einbinden von Volumes verwendet werden, werden nur [CF_HDROP](#cf_hdrop) verwendet, und vorhandene Eigenschaften Blatt Handler funktionieren wie bei früheren Systemen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-218">If only drive letters will be used to mount volumes, only [CF_HDROP](#cf_hdrop) will be used, and existing property sheet handlers will work as they did with earlier systems.</span></span> <span data-ttu-id="4ec44-219">Wenn Sie jedoch möchten, dass Ihr Handler eine Seite für Volumes anzeigt, die in Ordnern und Laufwerk Buchstaben eingebunden sind, muss der Handler sowohl das CSFTR_MOUNTEDVOLUME-als auch das CF_HDROP-Format verstehen können.</span><span class="sxs-lookup"><span data-stu-id="4ec44-219">However, if you want your handler to display a page for volumes that are mounted on folders as well as drive letters, the handler must be able to understand both the CSFTR_MOUNTEDVOLUME and CF_HDROP formats.</span></span>

### <a name="cfstr_shellidlist"></a><span data-ttu-id="4ec44-220">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="4ec44-220">CFSTR_SHELLIDLIST</span></span>

<span data-ttu-id="4ec44-221">Dieser Format Bezeichner wird verwendet, wenn die Speicherorte von einem oder mehreren vorhandenen Namespace Objekten übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-221">This format identifier is used when transferring the locations of one or more existing namespace objects.</span></span> <span data-ttu-id="4ec44-222">Es wird auf die gleiche Weise wie [CF_HDROP](#cf_hdrop)verwendet, aber es enthält pidls anstelle von Dateisystem Pfaden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-222">It is used in much the same way as [CF_HDROP](#cf_hdrop), but it contains PIDLs instead of file system paths.</span></span> <span data-ttu-id="4ec44-223">Mithilfe von pidls kann das CFSTR_SHELLIDLIST-Format sowohl virtuelle Objekte als auch Dateisystem Objekte verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="4ec44-223">Using PIDLs allows the CFSTR_SHELLIDLIST format to handle virtual objects as well as file system objects.</span></span> <span data-ttu-id="4ec44-224">Bei den Daten handelt es sich um eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-224">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-225">Der **HGLOBAL** -Member der Struktur verweist auf eine [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="4ec44-225">The structure's **hGlobal** member points to a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span>

<span data-ttu-id="4ec44-226">Der **aoffset** -Member der [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) -Struktur ist ein Array, das Offsets zum Anfang der [**itemittellist**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) -Struktur für jede PIDL enthält, die übertragen wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-226">The **aoffset** member of the [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure is an array containing offsets to the beginning of the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure for each PIDL that is being transferred.</span></span> <span data-ttu-id="4ec44-227">Um eine bestimmte PIDL zu extrahieren, bestimmen Sie zuerst den Index.</span><span class="sxs-lookup"><span data-stu-id="4ec44-227">To extract a particular PIDL, first determine its index.</span></span> <span data-ttu-id="4ec44-228">Fügen Sie dann der Adresse der **CIDA** -Struktur den **aoffset** -Wert hinzu, der diesem Index entspricht.</span><span class="sxs-lookup"><span data-stu-id="4ec44-228">Then, add the **aoffset** value that corresponds to that index to the address of the **CIDA** structure.</span></span>

<span data-ttu-id="4ec44-229">Das erste Element von **aoffset** enthält einen Offset zur voll qualifizierten PIDL eines übergeordneten Ordners.</span><span class="sxs-lookup"><span data-stu-id="4ec44-229">The first element of **aoffset** contains an offset to the fully qualified PIDL of a parent folder.</span></span> <span data-ttu-id="4ec44-230">Wenn diese PIDL leer ist, ist der übergeordnete Ordner der Desktop.</span><span class="sxs-lookup"><span data-stu-id="4ec44-230">If this PIDL is empty, the parent folder is the desktop.</span></span> <span data-ttu-id="4ec44-231">Jedes der verbleibenden Elemente des Arrays enthält einen Offset zu einer der zu übertragenden pidls.</span><span class="sxs-lookup"><span data-stu-id="4ec44-231">Each of the remaining elements of the array contains an offset to one of the PIDLs to be transferred.</span></span> <span data-ttu-id="4ec44-232">Alle diese pidls sind relativ zur PIDL des übergeordneten Ordners.</span><span class="sxs-lookup"><span data-stu-id="4ec44-232">All of these PIDLs are relative to the PIDL of the parent folder.</span></span>

<span data-ttu-id="4ec44-233">Die folgenden beiden Makros können zum Abrufen von pidls aus einer [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) -Struktur verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-233">The following two macros can be used to retrieve PIDLs from a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span> <span data-ttu-id="4ec44-234">Der erste übernimmt einen Zeiger auf die-Struktur und ruft die PIDL des übergeordneten Ordners ab.</span><span class="sxs-lookup"><span data-stu-id="4ec44-234">The first takes a pointer to the structure and retrieves the PIDL of the parent folder.</span></span> <span data-ttu-id="4ec44-235">Der zweite-Wert übernimmt einen Zeiger auf die-Struktur und ruft eine der anderen pidls ab, die durch den NULL basierten Index identifiziert werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-235">The second takes a pointer to the structure and retrieves one of the other PIDLs, identified by its zero-based index.</span></span>


```C++
#define GetPIDLFolder(pida) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[0])

#define GetPIDLItem(pida, i) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[i+1])
```

> [!Note]  
> <span data-ttu-id="4ec44-236">Der von diesen Makros zurückgegebene Wert ist ein Zeiger auf die [**itemittellist**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) -Struktur der PIDL.</span><span class="sxs-lookup"><span data-stu-id="4ec44-236">The value that is returned by these macros is a pointer to the PIDL's [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure.</span></span> <span data-ttu-id="4ec44-237">Da diese Strukturen die Länge variieren, müssen Sie das Ende der Struktur ermitteln, indem Sie die [**shitemid**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) -Strukturen der **itemidlist** -Struktur durchlaufen, bis Sie den 2-Byte- **null** -Wert erreichen, der das Ende markiert.</span><span class="sxs-lookup"><span data-stu-id="4ec44-237">Since these structures vary in length, you must determine the end of the structure by walking through each of the **ITEMIDLIST** structure's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures until you reach the two-byte **NULL** that marks the end.</span></span>

### <a name="cfstr_shellidlistoffset"></a><span data-ttu-id="4ec44-238">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="4ec44-238">CFSTR_SHELLIDLISTOFFSET</span></span>

<span data-ttu-id="4ec44-239">Dieser Format Bezeichner wird mit Formaten wie [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist)und [CFSTR_FILECONTENTS](#cfstr_filecontents) verwendet, um die Position einer Gruppe von Objekten nach einer Übertragung anzugeben.</span><span class="sxs-lookup"><span data-stu-id="4ec44-239">This format identifier is used with formats such as [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist), and [CFSTR_FILECONTENTS](#cfstr_filecontents) to specify the position of a group of objects following a transfer.</span></span> <span data-ttu-id="4ec44-240">Die Daten bestehen aus einer [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-240">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-241">Der **HGLOBAL** -Member der Struktur verweist auf ein Array von [**Punkt**](/previous-versions//dd162805(v=vs.85)) Strukturen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-241">The structure's **hGlobal** member points to an array of [**POINT**](/previous-versions//dd162805(v=vs.85)) structures.</span></span> <span data-ttu-id="4ec44-242">Die erste-Struktur gibt die Bildschirm Koordinaten der oberen linken Ecke des Rechtecks, das die Gruppe einschließt, in Pixel an.</span><span class="sxs-lookup"><span data-stu-id="4ec44-242">The first structure specifies the screen coordinates, in pixels, of the upper-left corner of the rectangle that encloses the group.</span></span> <span data-ttu-id="4ec44-243">Die übrigen Strukturen geben die Speicherorte der einzelnen Objekte relativ zur Position der Gruppe an.</span><span class="sxs-lookup"><span data-stu-id="4ec44-243">The remainder of the structures specify the locations of the individual objects relative to the group's position.</span></span> <span data-ttu-id="4ec44-244">Sie müssen in derselben Reihenfolge vorliegen wie die, die zum Auflisten der Objekte im zugeordneten Format verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="4ec44-244">They must be in the same order as that used to list the objects in the associated format.</span></span>

## <a name="formats-for-transferring-virtual-objects"></a><span data-ttu-id="4ec44-245">Formate für das Übertragen von virtuellen Objekten</span><span class="sxs-lookup"><span data-stu-id="4ec44-245">Formats for Transferring Virtual Objects</span></span>

<span data-ttu-id="4ec44-246">Das CFSTR_SHELLIDLIST-Format kann verwendet werden, um sowohl das Dateisystem als auch virtuelle Objekte zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-246">The CFSTR_SHELLIDLIST format can be used to transfer both file system and virtual objects.</span></span> <span data-ttu-id="4ec44-247">Es gibt jedoch auch mehrere spezielle Formate zum übertragen bestimmter Typen von virtuellen Objekten.</span><span class="sxs-lookup"><span data-stu-id="4ec44-247">However, there are also several specialized formats for transferring particular types of virtual objects.</span></span>

-   [<span data-ttu-id="4ec44-248">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="4ec44-248">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
-   [<span data-ttu-id="4ec44-249">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="4ec44-249">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
-   [<span data-ttu-id="4ec44-250">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="4ec44-250">CFSTR_INETURL</span></span>](#cfstr_ineturl)
-   [<span data-ttu-id="4ec44-251">CFSTR_SHELLURL (veraltet)</span><span class="sxs-lookup"><span data-stu-id="4ec44-251">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)

### <a name="cfstr_netresources"></a><span data-ttu-id="4ec44-252">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="4ec44-252">CFSTR_NETRESOURCES</span></span>

<span data-ttu-id="4ec44-253">Diese Format-ID wird verwendet, wenn Netzwerkressourcen übertragen werden, z. b. eine Domäne oder ein Server.</span><span class="sxs-lookup"><span data-stu-id="4ec44-253">This format identifier is used when transferring network resources, such as a domain or server.</span></span> <span data-ttu-id="4ec44-254">Bei den Daten handelt es sich um eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-254">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-255">Der **HGLOBAL** -Member der Struktur verweist auf eine [**nresarray**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="4ec44-255">The structure's **hGlobal** member points to a [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) structure.</span></span> <span data-ttu-id="4ec44-256">Der **Nr** -Member dieser Struktur gibt eine [**artresource**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) -Struktur an, deren **lpremutename** -Member eine **null**-terminierte Zeichenfolge enthält, die die Netzwerkressource identifiziert.</span><span class="sxs-lookup"><span data-stu-id="4ec44-256">The **nr** member of that structure indicates a [**NETRESOURCE**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) structure whose **lpRemoteName** member contains a **null**-terminated string identifying the network resource.</span></span> <span data-ttu-id="4ec44-257">Das Ablage Ziel kann dann die Daten mit allen WNET-API-Funktionen [(Windows Networking)](../wnet/windows-networking-wnet-.md) , wie z. b. [**wnetaddconnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), zum Ausführen von Netzwerk Vorgängen für das Objekt verwenden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-257">The drop target can then use the data with any of the [Windows Networking (WNet)](../wnet/windows-networking-wnet-.md) API functions, such as [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), to perform network operations on the object.</span></span>

### <a name="cfstr_printergroup"></a><span data-ttu-id="4ec44-258">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="4ec44-258">CFSTR_PRINTERGROUP</span></span>

<span data-ttu-id="4ec44-259">Dieser Format Bezeichner wird beim Übertragen der anzeigen Amen von Druckern verwendet.</span><span class="sxs-lookup"><span data-stu-id="4ec44-259">This format identifier is used when transferring the friendly names of printers.</span></span> <span data-ttu-id="4ec44-260">Bei den Daten handelt es sich um eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-260">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-261">Der **HGLOBAL** -Member der Struktur verweist auf eine Zeichenfolge im gleichen Format wie bei [CF_HDROP](#cf_hdrop).</span><span class="sxs-lookup"><span data-stu-id="4ec44-261">The structure's **hGlobal** member points to a string in the same format as that used with [CF_HDROP](#cf_hdrop).</span></span> <span data-ttu-id="4ec44-262">Der **pfiles** -Member der [**dropfiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) -Struktur enthält jedoch einen oder mehrere anzeigen Amen von Druckern anstelle von Dateipfaden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-262">However, the **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains one or more friendly names of printers instead of file paths.</span></span>

### <a name="cfstr_ineturl"></a><span data-ttu-id="4ec44-263">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="4ec44-263">CFSTR_INETURL</span></span>

<span data-ttu-id="4ec44-264">Dieser Format Bezeichner ersetzt [CFSTR_SHELLURL (veraltet)](#cfstr_shellurl-deprecated).</span><span class="sxs-lookup"><span data-stu-id="4ec44-264">This format identifier replaces [CFSTR_SHELLURL (deprecated)](#cfstr_shellurl-deprecated).</span></span> <span data-ttu-id="4ec44-265">Wenn Sie möchten, dass Ihre Anwendung Zwischenablage-URLs bearbeitet, verwenden Sie CFSTR_INETURL anstelle von CFSTR_SHELLURL (veraltet).</span><span class="sxs-lookup"><span data-stu-id="4ec44-265">If you want your application to manipulate clipboard URLs, use CFSTR_INETURL instead of CFSTR_SHELLURL (deprecated).</span></span> <span data-ttu-id="4ec44-266">Dieses Format gibt die beste Darstellung einer einzelnen URL in der Zwischenablage an.</span><span class="sxs-lookup"><span data-stu-id="4ec44-266">This format gives the best clipboard representation of a single URL.</span></span> <span data-ttu-id="4ec44-267">Wenn Unicode nicht definiert ist, ruft die Anwendung die CF_TEXT/CFSTR_SHELLURL-Version der URL ab.</span><span class="sxs-lookup"><span data-stu-id="4ec44-267">If UNICODE is not defined, the application retrieves the CF_TEXT/CFSTR_SHELLURL version of the URL.</span></span> <span data-ttu-id="4ec44-268">Wenn Unicode definiert ist, ruft die Anwendung die CF_UNICODE Version der URL ab.</span><span class="sxs-lookup"><span data-stu-id="4ec44-268">If UNICODE is defined, the application retrieves the CF_UNICODE version of the URL.</span></span>

### <a name="cfstr_shellurl-deprecated"></a><span data-ttu-id="4ec44-269">CFSTR_SHELLURL (veraltet)</span><span class="sxs-lookup"><span data-stu-id="4ec44-269">CFSTR_SHELLURL (deprecated)</span></span>

> [!Note]  
> <span data-ttu-id="4ec44-270">Der Format Bezeichner ist veraltet. Verwenden Sie stattdessen CFSTR_INETURL.</span><span class="sxs-lookup"><span data-stu-id="4ec44-270">This format identifier has been deprecated; use CFSTR_INETURL instead.</span></span>

 

## <a name="formats-for-communication-between-source-and-target"></a><span data-ttu-id="4ec44-271">Formate für die Kommunikation zwischen Quelle und Ziel</span><span class="sxs-lookup"><span data-stu-id="4ec44-271">Formats for Communication Between Source and Target</span></span>

<span data-ttu-id="4ec44-272">Diese Format Bezeichner ermöglichen die Kommunikation zwischen Quelle und Ziel.</span><span class="sxs-lookup"><span data-stu-id="4ec44-272">These format identifiers allow communication between source and target.</span></span> <span data-ttu-id="4ec44-273">Die Formate unterstützen die Daten und haben Anwendungen ein höheres Maß an Kontrolle über Verschiebe-und Kopiervorgänge oder Drag & Drop-Vorgänge mit shellobjekten.</span><span class="sxs-lookup"><span data-stu-id="4ec44-273">The formats accompany the data and give applications a greater degree of control over move-copy-paste or drag-and-drop operations involving Shell objects.</span></span>

-   [<span data-ttu-id="4ec44-274">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="4ec44-274">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
-   [<span data-ttu-id="4ec44-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="4ec44-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
-   [<span data-ttu-id="4ec44-276">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="4ec44-276">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
-   [<span data-ttu-id="4ec44-277">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="4ec44-277">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
-   [<span data-ttu-id="4ec44-278">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="4ec44-278">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
-   [<span data-ttu-id="4ec44-279">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="4ec44-279">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
-   [<span data-ttu-id="4ec44-280">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="4ec44-280">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
-   [<span data-ttu-id="4ec44-281">Dragwindow</span><span class="sxs-lookup"><span data-stu-id="4ec44-281">DragWindow</span></span>](#dragwindow)

### <a name="cfstr_indragloop"></a><span data-ttu-id="4ec44-282">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="4ec44-282">CFSTR_INDRAGLOOP</span></span>

<span data-ttu-id="4ec44-283">Dieser Format Bezeichner wird von einem Datenobjekt verwendet, um anzugeben, ob es sich um eine Drag & Drop-Schleife handelt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-283">This format identifier is used by a data object to indicate whether it is in a drag-and-drop loop.</span></span> <span data-ttu-id="4ec44-284">Bei den Daten handelt es sich um eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-284">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-285">Der **HGLOBAL** -Member der Struktur verweist auf einen **DWORD** -Wert.</span><span class="sxs-lookup"><span data-stu-id="4ec44-285">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="4ec44-286">Wenn der **DWORD** -Wert ungleich 0 (null) ist, befindet sich das Datenobjekt innerhalb einer Drag & Drop-Schleife.</span><span class="sxs-lookup"><span data-stu-id="4ec44-286">If the **DWORD** value is nonzero, the data object is within a drag-and-drop loop.</span></span> <span data-ttu-id="4ec44-287">Wenn der Wert auf 0 (null) festgelegt ist, befindet sich das Datenobjekt nicht innerhalb einer Drag & Drop-Schleife.</span><span class="sxs-lookup"><span data-stu-id="4ec44-287">If the value is set to zero, the data object is not within a drag-and-drop loop.</span></span>

<span data-ttu-id="4ec44-288">Einige Drop-Ziele können [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) aufrufen und versuchen, Daten zu extrahieren, während sich das Objekt noch innerhalb der Drag & Drop-Schleife befindet.</span><span class="sxs-lookup"><span data-stu-id="4ec44-288">Some drop targets might call [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) and attempt to extract data while the object is still within the drag-and-drop loop.</span></span> <span data-ttu-id="4ec44-289">Das vollständige Rendering des-Objekts für jedes derartige vorkommen kann dazu führen, dass der Zieh Cursor abwartet.</span><span class="sxs-lookup"><span data-stu-id="4ec44-289">Fully rendering the object for each such occurrence might cause the drag cursor to stall.</span></span> <span data-ttu-id="4ec44-290">Wenn das Datenobjekt [CFSTR_INDRAGLOOP](#cfstr_indragloop)unterstützt, kann das Ziel stattdessen dieses Format verwenden, um den Status der Drag & Drop-Schleife zu überprüfen und das speicherintensive Rendering des Objekts zu vermeiden, bis es tatsächlich gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-290">If the data object supports [CFSTR_INDRAGLOOP](#cfstr_indragloop), the target can instead use that format to check the status of the drag-and-drop loop and avoid memory intensive rendering of the object until it is actually dropped.</span></span> <span data-ttu-id="4ec44-291">Die Formate, die Speicher intensiv zum renderingelement sind, sollten weiterhin im [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) -Enumerator und in Aufrufen von [**IDataObject:: QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata)enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="4ec44-291">The formats that are memory intensive to render should still be included in the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) enumerator and in calls to [**IDataObject::QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span></span> <span data-ttu-id="4ec44-292">Wenn das Datenobjekt nicht CFSTR_INDRAGLOOP festgelegt wird, sollte es so agieren, als wäre der Wert auf 0 (null) festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-292">If the data object does not set CFSTR_INDRAGLOOP, it should act as if the value is set to zero.</span></span>

### <a name="cfstr_logicalperformeddropeffect"></a><span data-ttu-id="4ec44-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="4ec44-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="4ec44-294">[Version 5,0.](versions.md) Mit diesem Format Bezeichner kann eine Ablage Quelle die [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) -Methode des Datenobjekts aufrufen, um das Ergebnis einer shelldatenübertragung zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="4ec44-294">[Version 5.0.](versions.md)This format identifier allows a drop source to call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to determine the outcome of a Shell data transfer.</span></span> <span data-ttu-id="4ec44-295">Bei den Daten handelt es sich um eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-295">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-296">Der **HGLOBAL** -Member der Struktur verweist auf ein DWORD, das einen [**dropffect**](../com/dropeffect-constants.md) -Wert enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-296">The structure's **hGlobal** member points to a DWORD containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span>

<span data-ttu-id="4ec44-297">Der [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) -Format Bezeichner war für das Ziel vorgesehen, dem Datenobjekt anzugeben, welcher Vorgang tatsächlich durchgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="4ec44-297">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format identifier was intended to allow the target to indicate to the data object what operation actually took place.</span></span> <span data-ttu-id="4ec44-298">Die Shell verwendet jedoch nach Möglichkeit [optimierte](datascenarios.md) Verschiebungen für Dateisystem Objekte.</span><span class="sxs-lookup"><span data-stu-id="4ec44-298">However, the Shell uses [optimized moves](datascenarios.md) for file system objects whenever possible.</span></span> <span data-ttu-id="4ec44-299">In diesem Fall legt die Shell normalerweise den CFSTR_PERFORMEDDROPEFFECT Wert auf DROPEFFECT_NONE fest, um das Datenobjekt anzugeben, dass die ursprünglichen Daten gelöscht wurden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-299">In that case, the Shell normally sets the CFSTR_PERFORMEDDROPEFFECT value to DROPEFFECT_NONE, to indicate to the data object that the original data has been deleted.</span></span> <span data-ttu-id="4ec44-300">Daher kann die Quelle den CFSTR_PERFORMEDDROPEFFECT Wert nicht verwenden, um zu bestimmen, welcher Vorgang stattfindet.</span><span class="sxs-lookup"><span data-stu-id="4ec44-300">Thus, the source cannot use the CFSTR_PERFORMEDDROPEFFECT value to determine which operation has taken place.</span></span> <span data-ttu-id="4ec44-301">Obwohl die meisten Quellen diese Informationen nicht benötigen, gibt es einige Ausnahmen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-301">While most sources do not need this information, there are some exceptions.</span></span> <span data-ttu-id="4ec44-302">Obwohl durch optimierte Verschiebungen beispielsweise die Notwendigkeit einer Quelle zum Löschen von Daten entfällt, muss die Quelle möglicherweise trotzdem eine verwandte Datenbank aktualisieren, um anzugeben, dass die Dateien verschoben oder kopiert wurden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-302">For instance, even though optimized moves eliminate the need for a source to delete any data, the source might still need to update a related database to indicate that the files have been moved or copied.</span></span>

<span data-ttu-id="4ec44-303">Wenn eine Quelle wissen muss, welcher Vorgang stattfindet, kann Sie die [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) -Methode des Datenobjekts aufrufen und das CFSTR_LOGICALPERFORMEDDROPEFFECT Format anfordern.</span><span class="sxs-lookup"><span data-stu-id="4ec44-303">If a source needs to know which operation took place, it can call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method and request the CFSTR_LOGICALPERFORMEDDROPEFFECT format.</span></span> <span data-ttu-id="4ec44-304">Dieses Format spiegelt im Grunde wider, was aus der Sicht des Benutzers geschieht, nachdem der Vorgang beendet wurde.</span><span class="sxs-lookup"><span data-stu-id="4ec44-304">This format essentially reflects what happens from the user's point of view after the operation is complete.</span></span> <span data-ttu-id="4ec44-305">Wenn eine neue Datei erstellt und die ursprüngliche Datei gelöscht wird, wird dem Benutzer ein Verschiebungs Vorgang angezeigt, und der Datenwert des Formats wird auf DROPEFFECT_MOVE festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-305">If a new file is created and the original file is deleted, the user sees a move operation and the format's data value is set to DROPEFFECT_MOVE.</span></span> <span data-ttu-id="4ec44-306">Wenn die ursprüngliche Datei noch vorhanden ist, wird dem Benutzer ein Kopiervorgang angezeigt, und der Datenwert des Formats wird auf DROPEFFECT_COPY festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-306">If the original file is still there, the user sees a copy operation and the format's data value is set to DROPEFFECT_COPY.</span></span> <span data-ttu-id="4ec44-307">Wenn ein Link erstellt wurde, wird der Datenwert des Formats DROPEFFECT_LINK.</span><span class="sxs-lookup"><span data-stu-id="4ec44-307">If a link was created, the format's data value will be DROPEFFECT_LINK.</span></span>

### <a name="cfstr_pastesucceeded"></a><span data-ttu-id="4ec44-308">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="4ec44-308">CFSTR_PASTESUCCEEDED</span></span>

<span data-ttu-id="4ec44-309">Dieser Format Bezeichner wird vom Ziel verwendet, um das Datenobjekt über seine [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) -Methode zu informieren, dass ein Löschvorgang erfolgreich ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="4ec44-309">This format identifier is used by the target to inform the data object, through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method, that a delete-on-paste operation succeeded.</span></span> <span data-ttu-id="4ec44-310">Bei den Daten handelt es sich um eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-310">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-311">Der **HGLOBAL** -Member der Struktur verweist auf ein **DWORD** , das einen [**dropffect**](../com/dropeffect-constants.md) -Wert enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-311">The structure's **hGlobal** member points to a **DWORD** containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span> <span data-ttu-id="4ec44-312">Dieses Format wird verwendet, um das Datenobjekt zu benachrichtigen, dass es den Ausschneide Vorgang beenden und ggf. die ursprünglichen Daten löschen soll.</span><span class="sxs-lookup"><span data-stu-id="4ec44-312">This format is used to notify the data object that it should complete the cut operation and delete the original data, if necessary.</span></span> <span data-ttu-id="4ec44-313">Weitere Informationen finden Sie unter [Delete-on-Copy-Vorgänge](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="4ec44-313">For more information, see [Delete-on-Paste Operations](datascenarios.md).</span></span>

### <a name="cfstr_performeddropeffect"></a><span data-ttu-id="4ec44-314">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="4ec44-314">CFSTR_PERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="4ec44-315">Dieser Format Bezeichner wird vom Ziel verwendet, um das Datenobjekt über die [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) -Methode des Ergebnisses einer Datenübertragung zu informieren.</span><span class="sxs-lookup"><span data-stu-id="4ec44-315">This format identifier is used by the target to inform the data object through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method of the outcome of a data transfer.</span></span> <span data-ttu-id="4ec44-316">Bei den Daten handelt es sich um eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-316">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-317">Der **HGLOBAL** -Member der Struktur verweist auf ein **DWORD** -Element, das auf den entsprechenden [**droetffect**](../com/dropeffect-constants.md) -Wert festgelegt ist, normalerweise DROPEFFECT_MOVE oder DROPEFFECT_COPY.</span><span class="sxs-lookup"><span data-stu-id="4ec44-317">The structure's **hGlobal** member points to a **DWORD** set to the appropriate [**DROPEFFECT**](../com/dropeffect-constants.md) value, normally DROPEFFECT_MOVE or DROPEFFECT_COPY.</span></span>

<span data-ttu-id="4ec44-318">Dieses Format wird normalerweise verwendet, wenn das Ergebnis eines Vorgangs entweder verschoben oder kopiert werden kann, z. b. bei einem [optimierten](datascenarios.md) verschiebe-oder Löschvorgang.</span><span class="sxs-lookup"><span data-stu-id="4ec44-318">This format is normally used when the outcome of an operation can be either move or copy, such as in an [optimized move](datascenarios.md) or delete-on-paste operation.</span></span> <span data-ttu-id="4ec44-319">Er bietet eine zuverlässige Möglichkeit für das Ziel, dem Datenobjekt mitzuteilen, was tatsächlich passiert ist.</span><span class="sxs-lookup"><span data-stu-id="4ec44-319">It provides a reliable way for the target to tell the data object what actually happened.</span></span> <span data-ttu-id="4ec44-320">Es wurde eingeführt, weil der von [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) zurückgegebene Wert von *pdweffect* nicht zuverlässig anzeigt, welcher Vorgang durchgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="4ec44-320">It was introduced because the value of *pdwEffect* returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) did not reliably indicate which operation had taken place.</span></span> <span data-ttu-id="4ec44-321">Das [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) -Format ist die zuverlässige Möglichkeit, um anzugeben, dass eine nicht optimierte Verschiebung stattfindet.</span><span class="sxs-lookup"><span data-stu-id="4ec44-321">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format is the reliable way to indicate that an unoptimized move has taken place.</span></span>

### <a name="cfstr_preferreddropeffect"></a><span data-ttu-id="4ec44-322">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="4ec44-322">CFSTR_PREFERREDDROPEFFECT</span></span>

<span data-ttu-id="4ec44-323">Dieser Format Bezeichner wird von der Quelle verwendet, um anzugeben, ob die bevorzugte Methode für die Datenübertragung verschoben oder kopiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="4ec44-323">This format identifier is used by the source to specify whether its preferred method of data transfer is move or copy.</span></span> <span data-ttu-id="4ec44-324">Ein Ablage Ziel fordert dieses Format durch Aufrufen der [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) -Methode des Datenobjekts an.</span><span class="sxs-lookup"><span data-stu-id="4ec44-324">A drop target requests this format by calling the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span> <span data-ttu-id="4ec44-325">Bei den Daten handelt es sich um eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-325">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-326">Der **HGLOBAL** -Member der Struktur verweist auf einen **DWORD** -Wert.</span><span class="sxs-lookup"><span data-stu-id="4ec44-326">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="4ec44-327">Dieser Wert wird auf DROPEFFECT_MOVE festgelegt, wenn ein Verschiebungs Vorgang bevorzugt wird, oder DROPEFFECT_COPY, wenn ein Kopiervorgang bevorzugt wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-327">This value is set to DROPEFFECT_MOVE if a move operation is preferred or DROPEFFECT_COPY if a copy operation is preferred.</span></span>

<span data-ttu-id="4ec44-328">Diese Funktion wird verwendet, wenn eine Quelle entweder einen verschiebe-oder Kopiervorgang unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-328">This feature is used when a source can support either a move or copy operation.</span></span> <span data-ttu-id="4ec44-329">Er verwendet das [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) -Format, um seine Präferenz an das Ziel zu übermitteln.</span><span class="sxs-lookup"><span data-stu-id="4ec44-329">It uses the [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) format to communicate its preference to the target.</span></span> <span data-ttu-id="4ec44-330">Da das Ziel nicht zur Einhaltung der Anforderung verpflichtet ist, muss das Ziel die [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) -Methode der Quelle mit einem [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) Format aufrufen, um dem Datenobjekt mitzuteilen, welcher Vorgang tatsächlich ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="4ec44-330">Because the target is not obligated to honor the request, the target must call the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method with a [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format to tell the data object which operation was actually performed.</span></span>

<span data-ttu-id="4ec44-331">Bei einem [Delete-on-Paste-](datascenarios.md) Vorgang wird das CFSTR_PREFERREDDROPFORMAT Format verwendet, um dem Ziel mitzuteilen, ob die Quelle einen Ausschneiden oder eine Kopie durchgeführt hat.</span><span class="sxs-lookup"><span data-stu-id="4ec44-331">With a [delete-on-paste](datascenarios.md) operation, the CFSTR_PREFERREDDROPFORMAT format is used to tell the target whether the source did a cut or copy.</span></span> <span data-ttu-id="4ec44-332">Mit einem Drag & Drop-Vorgang können Sie CFSTR_PREFERREDDROPFORMAT verwenden, um die Aktion der Shell anzugeben.</span><span class="sxs-lookup"><span data-stu-id="4ec44-332">With a drag-and-drop operation, you can use CFSTR_PREFERREDDROPFORMAT to specify the Shell's action.</span></span> <span data-ttu-id="4ec44-333">Wenn dieses Format nicht vorhanden ist, führt die Shell basierend auf dem Kontext eine Standardaktion aus.</span><span class="sxs-lookup"><span data-stu-id="4ec44-333">If this format is not present, the Shell performs a default action, based on context.</span></span> <span data-ttu-id="4ec44-334">Wenn ein Benutzer beispielsweise eine Datei von einem Volume zieht und auf einem anderen Volume löscht, wird die Datei mit der Standardaktion der Shell kopiert.</span><span class="sxs-lookup"><span data-stu-id="4ec44-334">For instance, if a user drags a file from one volume and drops it on another volume, the Shell's default action is to copy the file.</span></span> <span data-ttu-id="4ec44-335">Wenn Sie ein CFSTR_PREFERREDDROPFORMAT Format in das Datenobjekt einschließen, können Sie die Standardaktion überschreiben und die Shell explizit anweisen, die Datei zu kopieren, zu verschieben oder zu verknüpfen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-335">By including a CFSTR_PREFERREDDROPFORMAT format in the data object, you can override the default action and explicitly tell the Shell to copy, move, or link the file.</span></span> <span data-ttu-id="4ec44-336">Wenn der Benutzer das Ziehen mit der rechten Schaltfläche auswählt, CFSTR_PREFERREDDROPFORMAT den Standardbefehl im [Drag](context-menu-handlers.md) & amp; Drop-Kontextmenü angibt.</span><span class="sxs-lookup"><span data-stu-id="4ec44-336">If the user chooses to drag with the right button, CFSTR_PREFERREDDROPFORMAT specifies the default command on the [drag-and-drop](context-menu-handlers.md) shortcut menu.</span></span> <span data-ttu-id="4ec44-337">Der Benutzer kann weiterhin andere Befehle im Menü auswählen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-337">The user is still free to choose other commands on the menu.</span></span>

<span data-ttu-id="4ec44-338">Vor Microsoft Internet Explorer 4,0 hat eine Anwendung angegeben, dass Verknüpfungs Dateitypen übertragen wurden, indem FD_LINKUI im **dwFlags** -Member der [**Filedescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) -Struktur festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="4ec44-338">Before Microsoft Internet Explorer 4.0, an application indicated that it was transferring shortcut file types by setting FD_LINKUI in the **dwFlags** member of the [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure.</span></span> <span data-ttu-id="4ec44-339">Ziele mussten dann einen potenziell zeitaufwändigen Aufruf von [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) verwenden, um herauszufinden, ob das FD_LINKUI-Flag festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="4ec44-339">Targets then had to use a potentially time-consuming call to [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to find out if the FD_LINKUI flag was set.</span></span> <span data-ttu-id="4ec44-340">Die bevorzugte Methode, um anzugeben, dass Verknüpfungen übertragen werden, besteht darin, das CFSTR_PREFERREDDROPEFFECT Format zu verwenden, das auf DROPEFFECT_LINK festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="4ec44-340">Now, the preferred way to indicate that shortcuts are being transferred is to use the CFSTR_PREFERREDDROPEFFECT format set to DROPEFFECT_LINK.</span></span> <span data-ttu-id="4ec44-341">Aus Gründen der Abwärtskompatibilität mit älteren Systemen sollten Quellen jedoch weiterhin das FD_LINKUI-Flag festlegen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-341">However, for backward compatibility with older systems, sources should still set the FD_LINKUI flag.</span></span>

### <a name="cfstr_targetclsid"></a><span data-ttu-id="4ec44-342">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="4ec44-342">CFSTR_TARGETCLSID</span></span>

<span data-ttu-id="4ec44-343">Dieser Format Bezeichner wird von einem Ziel verwendet, um die zugehörige CLSID für die Quelle bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-343">This format identifier is used by a target to provide its CLSID to the source.</span></span> <span data-ttu-id="4ec44-344">Bei den Daten handelt es sich um eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-344">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-345">Der **HGLOBAL** -Member der Struktur verweist auf die CLSID-GUID des Ablage Ziels.</span><span class="sxs-lookup"><span data-stu-id="4ec44-345">The structure's **hGlobal** member points to the CLSID GUID of the drop target.</span></span>

<span data-ttu-id="4ec44-346">Dieses Format wird hauptsächlich verwendet, um zuzulassen, dass Objekte gelöscht werden, indem Sie Sie in den Papierkorb ziehen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-346">This format is used primarily to allow objects to be deleted by dragging them to the Recycle Bin.</span></span> <span data-ttu-id="4ec44-347">Wenn ein Objekt im Papierkorb abgelegt wird, wird die [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) -Methode der Quelle mit einem CFSTR_TARGETCLSID-Format aufgerufen, das auf die CLSID des Papierkorbs (CLSID_RecycleBin) festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="4ec44-347">When an object is dropped in the Recycle Bin, the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method is called with a CFSTR_TARGETCLSID format set to the Recycle Bin's CLSID (CLSID_RecycleBin).</span></span> <span data-ttu-id="4ec44-348">Die Quelle kann dann das ursprüngliche Objekt löschen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-348">The source can then delete the original object.</span></span>

### <a name="cfstr_untrusteddragdrop"></a><span data-ttu-id="4ec44-349">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="4ec44-349">CFSTR_UNTRUSTEDDRAGDROP</span></span>

<span data-ttu-id="4ec44-350">Dieser Format Bezeichner wird von Windows Internet Explorer und der Windows-Shell verwendet, um einen Mechanismus bereitzustellen, mit dem Drag & Drop-Vorgänge, die aus Internet Explorer stammen, in Verbindung mit dem [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) -Flag blockiert werden.</span><span class="sxs-lookup"><span data-stu-id="4ec44-350">This format identifier is used by Windows Internet Explorer and the Windows Shell to provide a mechanism through which to block or prompt for drag-and-drop operations originating from Internet Explorer in conjunction with the [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag.</span></span>

<span data-ttu-id="4ec44-351">**CFSTR_UNTRUSTEDDRAGDROP** wird von der Quelle eines Drag & Drop-Vorgangs hinzugefügt, um anzugeben, dass das Datenobjekt möglicherweise nicht vertrauenswürdige Daten enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-351">**CFSTR_UNTRUSTEDDRAGDROP** is added by the source of a drag-and-drop operation to specify that the data object might contain untrustworthy data.</span></span> <span data-ttu-id="4ec44-352">Die Daten werden durch eine [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) -Struktur dargestellt, die ein globales Speicher Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="4ec44-352">The data is represented by an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="4ec44-353">Der **HGLOBAL** -Member der Struktur verweist auf ein **DWORD** , das auf ein entsprechendes [**URL-Aktionsflag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) festgelegt ist, um eine Richtlinien Überprüfung durch die [**iinternetsecuritymanager::P rocess UrlAction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) -Methode zu bewirken, wobei das [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) -Flag verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="4ec44-353">The structure's **hGlobal** member points to a **DWORD** set to an appropriate [**URL Action**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag to cause a policy check through the [**IInternetSecurityManager::ProcessUrlAction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) method, using the [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) flag.</span></span>

### <a name="dragwindow"></a><span data-ttu-id="4ec44-354">Dragwindow</span><span class="sxs-lookup"><span data-stu-id="4ec44-354">DragWindow</span></span>

<span data-ttu-id="4ec44-355">Dieses Format wird in einem Drag & Drop-Vorgang verwendet, um das Zieh Bild (Fenster) eines Objekts zu identifizieren, sodass seine visuellen Informationen dynamisch aktualisiert werden können.</span><span class="sxs-lookup"><span data-stu-id="4ec44-355">This format is used in a drag-and-drop operation to identify an object's drag image (window) so that its visual information can be updated dynamically.</span></span> <span data-ttu-id="4ec44-356">Wenn ein Objekt über ein Ablage Ziel gezogen wird, aktualisiert eine Anwendung Ihre [**dropdescription**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) -Struktur in Reaktion auf die [**IDropTarget::D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) -oder [**IDropSource:: GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) -Methode.</span><span class="sxs-lookup"><span data-stu-id="4ec44-356">When an object is dragged over a drop target, an application updates its [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) structure in response to the [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) or [**IDropSource::GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) method.</span></span> <span data-ttu-id="4ec44-357">Die **dropdescription** wird mit einem neuen [**dropimagetype**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) -Wert aktualisiert, der die Dekoration angibt, die auf das visuelle Element des Zieh Fensters angewendet werden soll. beispielsweise ein Hinweis darauf, dass die Datei kopiert wird, anstatt verschoben zu werden, oder dass das Objekt an diesem Speicherort nicht gelöscht werden kann.</span><span class="sxs-lookup"><span data-stu-id="4ec44-357">The **DROPDESCRIPTION** is updated with a new [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) value that indicates the decoration to be applied to the drag window's visual; for instance, an indication that the file is being copied rather than moved or that the object cannot be dropped to that location.</span></span> <span data-ttu-id="4ec44-358">Bis das Objekt jedoch eine [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) Nachricht empfängt, werden die visuellen Elemente nicht aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="4ec44-358">However, until the object receives a [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) message, the visuals are not updated.</span></span> <span data-ttu-id="4ec44-359">Dieses Format gibt das **HWND** des Empfänger Zieh Fensters an den Absender der **DDWM_UPDATEWINDOW** Nachricht an.</span><span class="sxs-lookup"><span data-stu-id="4ec44-359">This format provides the **HWND** of the recipient drag window to the sender of the **DDWM_UPDATEWINDOW** message.</span></span>

<span data-ttu-id="4ec44-360">Die Zwischenablage Daten sind vom Typ [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span><span class="sxs-lookup"><span data-stu-id="4ec44-360">The clipboard data is of type [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span></span> <span data-ttu-id="4ec44-361">Dabei handelt es sich um eine **DWORD** -Darstellung eines **HWND**.</span><span class="sxs-lookup"><span data-stu-id="4ec44-361">It is a **DWORD** representation of an **HWND**.</span></span> <span data-ttu-id="4ec44-362">Die Daten können an die **ulongtohandle** -Funktion, die in basetsd. h definiert ist, weitergegeben werden, um ein 64-Bit- **HWND** zur Verwendung auf 64-Bit-Fenstern bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="4ec44-362">The data can be passed to the **ULongToHandle** function, defined in Basetsd.h, to provide a 64-bit **HWND** for use on 64-bit Windows.</span></span>

<span data-ttu-id="4ec44-363">Für dieses Format ist die Einbindung von "shlobj. h" nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="4ec44-363">This format does not require the inclusion of Shlobj.h.</span></span>

 

 
