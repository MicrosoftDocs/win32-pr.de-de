---
description: Beschreibt das Erstellen eines Handlers für benutzerdefinierte Symbol Zuweisungen.
ms.assetid: 23ed3a21-cf62-4440-b983-fae23aa56890
title: Erstellen von Symbol Handlern
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e2c620b6f6a4c05f8996a26c8365e4f4201ee0b4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104979600"
---
# <a name="how-to-create-icon-handlers"></a><span data-ttu-id="42723-103">Erstellen von Symbol Handlern</span><span class="sxs-lookup"><span data-stu-id="42723-103">How to Create Icon Handlers</span></span>

<span data-ttu-id="42723-104">Einem [Dateityp](fa-file-types.md) ist oft ein benutzerdefiniertes Symbol zugeordnet, damit seine Member in Windows-Explorer leicht erkennbar werden.</span><span class="sxs-lookup"><span data-stu-id="42723-104">A [file type](fa-file-types.md) often has a custom icon associated with it, to make its members easily recognizable in Windows Explorer.</span></span> <span data-ttu-id="42723-105">Die einfachste Möglichkeit, einem Dateityp ein benutzerdefiniertes Symbol zuzuweisen, ist die Registrierung der Symbol Datei.</span><span class="sxs-lookup"><span data-stu-id="42723-105">The simplest way to assign a custom icon to a file type is to register the icon's file.</span></span> <span data-ttu-id="42723-106">Ein Symbol, das auf diese Weise registriert ist, ist jedoch für alle Member des Dateityps identisch.</span><span class="sxs-lookup"><span data-stu-id="42723-106">However, an icon registered in this way will be the same for all members of the file type.</span></span> <span data-ttu-id="42723-107">Sie können den Membern des Dateityps durch Implementieren eines *Symbol Handlers* viel mehr Flexibilität zuweisen.</span><span class="sxs-lookup"><span data-stu-id="42723-107">You can have much more flexibility in assigning icons to the members of the file type by implementing an *icon handler*.</span></span>

<span data-ttu-id="42723-108">Ein Symbol Handler ist ein Typ eines Shellerweiterungs Handlers, mit dem Sie den Membern eines Dateityps dynamisch Symbole zuweisen können.</span><span class="sxs-lookup"><span data-stu-id="42723-108">An icon handler is a type of Shell extension handler that allows you to dynamically assign icons to the members of a file type.</span></span> <span data-ttu-id="42723-109">Jedes Mal, wenn eine Datei des Typs angezeigt wird, fragt die Shell den Handler nach dem entsprechenden Symbol ab.</span><span class="sxs-lookup"><span data-stu-id="42723-109">Every time a file of the type is displayed, the Shell queries the handler for the appropriate icon.</span></span> <span data-ttu-id="42723-110">Beispielsweise kann ein Symbol Handler verschiedenen Membern des Dateityps verschiedene Symbole zuweisen oder das Symbol basierend auf dem aktuellen Status der Datei variieren.</span><span class="sxs-lookup"><span data-stu-id="42723-110">For instance, an icon handler can assign different icons to different members of the file type, or vary the icon based on the current state of the file.</span></span>

<span data-ttu-id="42723-111">Die allgemeinen Verfahren zum Implementieren und Registrieren eines Shellerweiterungs Handlers werden unter [Erstellen von Shellerweiterungs Handlern](handlers.md)erläutert.</span><span class="sxs-lookup"><span data-stu-id="42723-111">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="42723-112">Dieses Dokument konzentriert sich auf die Aspekte der Implementierung, die für Symbol Handler spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="42723-112">This document focuses on those aspects of implementation that are specific to icon handlers.</span></span>

-   [<span data-ttu-id="42723-113">Implementieren von Symbol Handlern</span><span class="sxs-lookup"><span data-stu-id="42723-113">Implementing Icon Handlers</span></span>](#step-1-implementing-icon-handlers)
-   [<span data-ttu-id="42723-114">Implementieren der iextracticon-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="42723-114">Implementing the IExtractIcon Interface</span></span>](#step-2-implementing-the-iextracticon-interface)
-   [<span data-ttu-id="42723-115">Registrieren von Symbol Handlern</span><span class="sxs-lookup"><span data-stu-id="42723-115">Registering Icon Handlers</span></span>](#step-3-registering-icon-handlers)
-   [<span data-ttu-id="42723-116">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="42723-116">Related topics</span></span>](#related-topics)

## <a name="instructions"></a><span data-ttu-id="42723-117">Instructions</span><span class="sxs-lookup"><span data-stu-id="42723-117">Instructions</span></span>

### <a name="step-1-implementing-icon-handlers"></a><span data-ttu-id="42723-118">Schritt 1: Implementieren von Symbol Handlern</span><span class="sxs-lookup"><span data-stu-id="42723-118">Step 1: Implementing Icon Handlers</span></span>

<span data-ttu-id="42723-119">Wie bei allen Shellerweiterungs Handlern sind Symbol Handler in-Process-Component Object Model (com)-Objekten, die als DLLs implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="42723-119">Like all Shell extension handlers, icon handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="42723-120">Zusätzlich zu [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown)müssen beide Schnittstellen exportiert werden: [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) und [**iextracticon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona).</span><span class="sxs-lookup"><span data-stu-id="42723-120">They must export two interfaces in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) and [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona).</span></span>

<span data-ttu-id="42723-121">Die Shell initialisiert den Handler über seine [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="42723-121">The Shell initializes the handler through its [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface.</span></span> <span data-ttu-id="42723-122">Diese Schnittstelle wird verwendet, um den Klassen Bezeichner (CLSID) des Handlers anzufordern und den Dateinamen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="42723-122">It uses this interface to request the handler's class identifier (CLSID) and provides it with the file's name.</span></span> <span data-ttu-id="42723-123">Der Rest des Vorgangs erfolgt über die [**iextracticon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="42723-123">The rest of the operation takes place through the [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) interface.</span></span> <span data-ttu-id="42723-124">Eine allgemeine Erörterung der Implementierung von Shellerweiterungs Handlern, einschließlich der **IPersistFile** -Schnittstelle, finden Sie unter [Erstellen von Shellerweiterungs Handlern](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="42723-124">For a general discussion of how to implement Shell extension handlers, including the **IPersistFile** interface, see [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="42723-125">Im restlichen Teil dieses Dokuments wird erläutert, wie die **iextracticon** -Schnittstelle implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="42723-125">The remainder of this document discusses how to implement the **IExtractIcon** interface.</span></span>

### <a name="step-2-implementing-the-iextracticon-interface"></a><span data-ttu-id="42723-126">Schritt 2: Implementieren der iextracticon-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="42723-126">Step 2: Implementing the IExtractIcon Interface</span></span>

<span data-ttu-id="42723-127">Nachdem die Schnittstelle initialisiert wurde, verwendet die Shell die [**iextracticon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) -Schnittstelle des Handlers, um das entsprechende Symbol anzufordern.</span><span class="sxs-lookup"><span data-stu-id="42723-127">After the interface is initialized, the Shell uses the handler's [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) interface to request the appropriate icon.</span></span> <span data-ttu-id="42723-128">Die Schnittstelle verfügt über zwei Methoden: [**iextracticon:: getikonlocation**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-geticonlocation) und [**iextracticon:: Extract**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-extract).</span><span class="sxs-lookup"><span data-stu-id="42723-128">The interface has two methods: [**IExtractIcon::GetIconLocation**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-geticonlocation) and [**IExtractIcon::Extract**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-extract).</span></span>

<span data-ttu-id="42723-129">Symbole werden durch ihren Speicherort im Dateisystem identifiziert.</span><span class="sxs-lookup"><span data-stu-id="42723-129">Icons are identified by their location in the file system.</span></span> <span data-ttu-id="42723-130">Die [**iextracticon:: getikonlocation**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-geticonlocation) -Methode wird aufgerufen, um diese Informationen anzufordern.</span><span class="sxs-lookup"><span data-stu-id="42723-130">The [**IExtractIcon::GetIconLocation**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-geticonlocation) method is called to request this information.</span></span> <span data-ttu-id="42723-131">Legen Sie den Parameter " *sziconfile* " auf den Dateinamen fest.</span><span class="sxs-lookup"><span data-stu-id="42723-131">Set the *szIconFile* parameter to the file name.</span></span> <span data-ttu-id="42723-132">Wenn mehr als ein Symbol in der Datei vorhanden ist, legen Sie *piindex* auf den Index des Symbols fest.</span><span class="sxs-lookup"><span data-stu-id="42723-132">If there is more than one icon in the file, set *piIndex* to the icon's index.</span></span> <span data-ttu-id="42723-133">Weisen Sie den beiden Flag-Variablen entsprechende Werte zu.</span><span class="sxs-lookup"><span data-stu-id="42723-133">Assign appropriate values to the two flag variables.</span></span> <span data-ttu-id="42723-134">Wenn Sie keinen Dateinamen angeben möchten oder wenn Sie nicht möchten, dass die Shell das Symbol extrahiert, legen Sie das Flag " **Gil \_ notfilename** " im *PWFLAGS* -Parameter fest.</span><span class="sxs-lookup"><span data-stu-id="42723-134">If you do not want to specify a file name, or if you do not want the Shell to extract the icon, set the **GIL\_NOTFILENAME** flag in the *pwFlags* parameter.</span></span> <span data-ttu-id="42723-135">Sie müssen " *sziconfile*" keinen Wert zuweisen, aber der Handler muss Symbol Handles bereitstellen, wenn die Shell " [**iextracticon:: Extract**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-extract)" aufruft.</span><span class="sxs-lookup"><span data-stu-id="42723-135">You do not need to assign a value to *szIconFile*, but the handler must provide icon handles when the Shell calls [**IExtractIcon::Extract**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-extract).</span></span>

<span data-ttu-id="42723-136">Wenn Sie einen Dateinamen zurückgeben, versucht die Shell normalerweise, das Symbol aus dem Cache zu laden.</span><span class="sxs-lookup"><span data-stu-id="42723-136">If you return a file name, the Shell normally attempts to load the icon from its cache.</span></span> <span data-ttu-id="42723-137">Um das Laden eines zwischengespeicherten Symbols zu verhindern, legen Sie das Flag " **Gil \_ DontCache** " im *PWFLAGS* -Parameter fest.</span><span class="sxs-lookup"><span data-stu-id="42723-137">To prevent the loading of a cached icon, set the **GIL\_DONTCACHE** flag in the *pwFlags* parameter.</span></span> <span data-ttu-id="42723-138">Wenn ein zwischengespeichertes Symbol nicht geladen wird, ruft die Shell [**iextracticon:: Extract**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-extract) auf, um das Symbol Handle anzufordern.</span><span class="sxs-lookup"><span data-stu-id="42723-138">If a cached icon is not loaded, the Shell then calls [**IExtractIcon::Extract**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-extract) to request the icon handle.</span></span>

<span data-ttu-id="42723-139">Wenn eine Datei und ein Index von [**iextracticon:: getikonlocation**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-geticonlocation)angegeben wurden, werden Sie in den Parametern *pszFile* bzw. *nidinindex* an [**iextracticon:: Extract**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-extract) übergeben.</span><span class="sxs-lookup"><span data-stu-id="42723-139">If a file and index were specified by [**IExtractIcon::GetIconLocation**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-geticonlocation), they are passed to [**IExtractIcon::Extract**](/windows/win32/api/shlobj_core/nf-shlobj_core-iextracticona-extract) in the *pszFile* and *nIconIndex* parameters, respectively.</span></span> <span data-ttu-id="42723-140">Wenn ein Dateiname angegeben wird, kann der Handler S false zurückgeben, damit \_ die Shell das Symbol extrahiert.</span><span class="sxs-lookup"><span data-stu-id="42723-140">If a file name is provided, your handler can return S\_FALSE to have the Shell extract the icon.</span></span> <span data-ttu-id="42723-141">Andernfalls muss Ihr Handler große und kleine Symbole extrahieren oder anderweitig extrahieren und die HICON-Handles den Parametern " *phifilarge* " und " *phikonsmall* " zuweisen.</span><span class="sxs-lookup"><span data-stu-id="42723-141">Otherwise, your handler must extract or otherwise produce large and small icons, and assign their HICON handles to the *phiconLarge* and *phiconSmall* parameters.</span></span> <span data-ttu-id="42723-142">Die Shell fügt die Symbole in Ihren Cache ein, um nachfolgende Aufrufe des Handlers zu beschleunigen.</span><span class="sxs-lookup"><span data-stu-id="42723-142">The Shell adds the icons to its cache to expedite subsequent calls to the handler.</span></span>

### <a name="step-3-registering-icon-handlers"></a><span data-ttu-id="42723-143">Schritt 3: Registrieren von Symbol Handlern</span><span class="sxs-lookup"><span data-stu-id="42723-143">Step 3: Registering Icon Handlers</span></span>

<span data-ttu-id="42723-144">Wenn Sie [ein Symbol](icon.md) für einen [Dateityp](fa-file-types.md)statisch registrieren, erstellen Sie einen **DefaultIcon** -Unterschlüssel unter der ProgID für den Dateityp.</span><span class="sxs-lookup"><span data-stu-id="42723-144">When you [statically register an icon](icon.md) for a [file type](fa-file-types.md), you create a **DefaultIcon** subkey under the ProgID for the file type.</span></span> <span data-ttu-id="42723-145">Der Standardwert wird auf die Datei festgelegt, die das Symbol enthält.</span><span class="sxs-lookup"><span data-stu-id="42723-145">Its default value is set to the file that contains the icon.</span></span> <span data-ttu-id="42723-146">Zum Registrieren eines Symbol Handlers müssen Sie immer noch über den Unterschlüssel **DefaultIcon** verfügen, aber der Standardwert muss auf "%1" festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="42723-146">To register an icon handler, you must still have the **DefaultIcon** subkey, but its default value must be set to "%1".</span></span> <span data-ttu-id="42723-147">Fügen Sie dem **shellex** -Unterschlüssel des ProgID-unter Schlüssels einen **iconhandler** -Unterschlüssel hinzu, und legen Sie dessen Standardwert auf die Zeichen folgen Form der CLSID-GUID des Handlers fest.</span><span class="sxs-lookup"><span data-stu-id="42723-147">Add an **IconHandler** subkey to the **Shellex** subkey of the ProgID subkey, and set its default value to the string form of the handler's CLSID GUID.</span></span> <span data-ttu-id="42723-148">Eine allgemeine Erläuterung zum Registrieren von Shellerweiterungs Handlern finden Sie unter [Erstellen von Shellerweiterungs Handlern](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="42723-148">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](handlers.md).</span></span>

<span data-ttu-id="42723-149">Im folgenden Beispiel wird der Registrierungs Eintrag durch [Anpassen von Symbolen](icon.md) geändert, sodass der MYP-Dateityp nun anstelle eines statisch definierten Symbols einen Kontextmenü Handler verwendet.</span><span class="sxs-lookup"><span data-stu-id="42723-149">The following example modifies the registry entry from [Customizing Icons](icon.md) so that the .myp file type now uses a shortcut menu handler instead of a statically defined icon.</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   MyProgram.1
      (Default) = MyProgram Application
      DefaultIcon
         (Default) = %1
      Shellex
         IconHandler
            (Default) = {The handler's CLSID GUID}
```

## <a name="related-topics"></a><span data-ttu-id="42723-150">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="42723-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="42723-151">Erstellen von Shellerweiterungshandlern</span><span class="sxs-lookup"><span data-stu-id="42723-151">Creating Shell Extension Handlers</span></span>](handlers.md)
</dt> <dt>

[<span data-ttu-id="42723-152">**IPersistFile**</span><span class="sxs-lookup"><span data-stu-id="42723-152">**IPersistFile**</span></span>](/windows/win32/api/objidl/nn-objidl-ipersistfile)
</dt> <dt>

[<span data-ttu-id="42723-153">**Iextracticon**</span><span class="sxs-lookup"><span data-stu-id="42723-153">**IExtractIcon**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona)
</dt> </dl>

 

 
