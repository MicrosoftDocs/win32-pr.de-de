---
description: Symbol Überlagerungs Handler sind Prozess interne Component Object Model (com)-Objekte, die als DLLs implementiert werden.
ms.assetid: ADF27BFD-CC96-43F9-9EBB-DEBE0DEA7B92
title: Implementieren von Symbol Überlagerungs Handlern
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e22c1057f65c50b31c6627846ec77103827a0283
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104979536"
---
# <a name="how-to-implement-icon-overlay-handlers"></a><span data-ttu-id="c64d3-103">Implementieren von Symbol Überlagerungs Handlern</span><span class="sxs-lookup"><span data-stu-id="c64d3-103">How to Implement Icon Overlay Handlers</span></span>

<span data-ttu-id="c64d3-104">Symbol Überlagerungs Handler sind Prozess interne Component Object Model (com)-Objekte, die als DLLs implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="c64d3-104">Icon overlay handlers are in-process Component Object Model (COM) objects, implemented as DLLs.</span></span> <span data-ttu-id="c64d3-105">Sie exportieren eine Schnittstelle zusätzlich zu [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**ishellienoverlayidentifier**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelliconoverlayidentifier).</span><span class="sxs-lookup"><span data-stu-id="c64d3-105">They export one interface in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellIconOverlayIdentifier**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelliconoverlayidentifier).</span></span> <span data-ttu-id="c64d3-106">Diese Schnittstelle verfügt über drei Methoden: [**ishellienoverlayidentifier:: getoverlayinfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo), [**ishellienoverlayidentifier:: GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority)und [**ishellienoverlayidentifier:: ismembership of**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof).</span><span class="sxs-lookup"><span data-stu-id="c64d3-106">This interface has three methods: [**IShellIconOverlayIdentifier::GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo), [**IShellIconOverlayIdentifier::GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority), and [**IShellIconOverlayIdentifier::IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof).</span></span>

## <a name="instructions"></a><span data-ttu-id="c64d3-107">Instructions</span><span class="sxs-lookup"><span data-stu-id="c64d3-107">Instructions</span></span>

### <a name="step-1-implementing-getoverlayinfo"></a><span data-ttu-id="c64d3-108">Schritt 1: Implementieren von getoverlayinfo</span><span class="sxs-lookup"><span data-stu-id="c64d3-108">Step 1: Implementing GetOverlayInfo</span></span>

<span data-ttu-id="c64d3-109">Die [**getoverlayinfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) -Methode wird zuerst während der Initialisierung aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="c64d3-109">The [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) method is first called during initialization.</span></span> <span data-ttu-id="c64d3-110">Die-Methode gibt den voll qualifizierten Pfad der Datei zurück, die das Symbol Überlagerungs Bild enthält, und den zugehörigen Null basierten Index in der Datei.</span><span class="sxs-lookup"><span data-stu-id="c64d3-110">The method returns the fully qualified path of the file that contains the icon overlay image, and its zero-based index within the file.</span></span> <span data-ttu-id="c64d3-111">Anschließend wird das Bild von der Shell der System Abbild Liste hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="c64d3-111">The Shell then adds the image to the system image list.</span></span> <span data-ttu-id="c64d3-112">Symbol Überlagerungen können in jedem der Standard Dateitypen enthalten sein, einschließlich. exe,. dll und. ico.</span><span class="sxs-lookup"><span data-stu-id="c64d3-112">Icon overlays can be contained in any of the standard file types, including .exe, .dll, and .ico.</span></span>

<span data-ttu-id="c64d3-113">Nachdem die Initialisierung fertiggestellt wurde, ruft die Shell [**getoverlayinfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) auf, wenn die Symbol Überlagerung des Handlers angezeigt werden muss.</span><span class="sxs-lookup"><span data-stu-id="c64d3-113">After initialization is complete, the Shell calls [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) when it needs to display the handler's icon overlay.</span></span> <span data-ttu-id="c64d3-114">Die-Methode sollte denselben Dateinamen und Index wie bei der Initialisierung zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="c64d3-114">The method should return the same file name and index that it did during initialization.</span></span> <span data-ttu-id="c64d3-115">Obwohl die Shell das in der System Abbild Liste zwischengespeicherte Bild verwendet, anstatt das Bild aus der Datei zu laden, wird eine Symbol Überlagerung weiterhin durch den Dateinamen und den Index identifiziert.</span><span class="sxs-lookup"><span data-stu-id="c64d3-115">Although the Shell uses the image that is cached in the system image list rather than loading the image from the file, an icon overlay is still identified by its file name and index.</span></span>

### <a name="step-2-implementing-getpriority"></a><span data-ttu-id="c64d3-116">Schritt 2: Implementieren von GetPriority</span><span class="sxs-lookup"><span data-stu-id="c64d3-116">Step 2: Implementing GetPriority</span></span>

<span data-ttu-id="c64d3-117">Die [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) -Methode wird nur während der Initialisierung aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="c64d3-117">The [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) method is called only during initialization.</span></span> <span data-ttu-id="c64d3-118">Er weist der Symbol Überlagerung des Handlers einen Prioritätswert zu.</span><span class="sxs-lookup"><span data-stu-id="c64d3-118">It assigns a priority value to the handler's icon overlay.</span></span> <span data-ttu-id="c64d3-119">Der Wert kann zwischen 0 und 100 liegen, wobei 100 die niedrigste Priorität aufweist.</span><span class="sxs-lookup"><span data-stu-id="c64d3-119">The value can range from zero to 100, where 100 is the lowest priority.</span></span> <span data-ttu-id="c64d3-120">Der Zweck dieses Prioritäts Werts besteht darin, die Shell zu helfen, den Konflikt zu lösen, der auftritt, wenn für ein einzelnes Objekt mehrere Symbol Überlagerungen angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="c64d3-120">The purpose of this priority value is to help the Shell resolve the conflict that arises when multiple icon overlays are specified for a single object.</span></span> <span data-ttu-id="c64d3-121">Die Shell verwendet zunächst einen internen Satz von Regeln, um das Symbol Overlay mit der höchsten Priorität zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="c64d3-121">The Shell first uses an internal set of rules to determine the highest-priority icon overlay.</span></span> <span data-ttu-id="c64d3-122">Wenn diese Regeln den Konflikt nicht lösen, bestimmen die Werte, die den Symbolen zugewiesen sind, **die Priorität.**</span><span class="sxs-lookup"><span data-stu-id="c64d3-122">If these rules do not resolve the conflict, the values assigned to the icon overlays by **GetPriority** determine priority.</span></span>

<span data-ttu-id="c64d3-123">Der Prioritätswert, der von [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) festgelegt wird, ist keine zuverlässige Methode zum Auflösen von Konflikten zwischen nicht verknüpften Symbolen-Handlern.</span><span class="sxs-lookup"><span data-stu-id="c64d3-123">The priority value set by [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) is not a reliable way to resolve conflicts between unrelated icon overlay handlers.</span></span> <span data-ttu-id="c64d3-124">Es gibt keine Möglichkeit für den Handler, zu bestimmen, welche Prioritätswerte andere Handler verwenden.</span><span class="sxs-lookup"><span data-stu-id="c64d3-124">There is no way for your handler to determine what priority values other handlers are using.</span></span> <span data-ttu-id="c64d3-125">Normalerweise sollten Sie den Wert auf 0 (null) festlegen.</span><span class="sxs-lookup"><span data-stu-id="c64d3-125">Normally, you should set the value to zero.</span></span> <span data-ttu-id="c64d3-126">Der Prioritätswert ist jedoch nützlich, wenn Sie zwei oder mehr Symbol Überlagerungs Handler implementiert haben, die Symbol Überlagerungs Symbole für dasselbe Objekt anfordern können.</span><span class="sxs-lookup"><span data-stu-id="c64d3-126">However, the priority value is useful when you have implemented two or more icon overlay handlers that can request icon overlay icons for the same object.</span></span> <span data-ttu-id="c64d3-127">Indem Sie die Prioritätswerte entsprechend festlegen, können Sie angeben, welche der angeforderten Symbol Überlagerungen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c64d3-127">By setting the priority values appropriately, you can specify which of the requested icon overlays will be displayed.</span></span>

### <a name="step-3-implementing-ismemberof"></a><span data-ttu-id="c64d3-128">Schritt 3: Implementieren von ismembership of</span><span class="sxs-lookup"><span data-stu-id="c64d3-128">Step 3: Implementing IsMemberOf</span></span>

<span data-ttu-id="c64d3-129">Die Shell Ruft die [**ismembership of**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof) -Methode auf, um zu bestimmen, ob die Symbol Überlagerung eines Handlers für ein bestimmtes Objekt angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="c64d3-129">The Shell calls the [**IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof) method to determine whether it should display a handler's icon overlay for a particular object.</span></span> <span data-ttu-id="c64d3-130">Die Shell gibt das-Objekt an, indem der Name an die-Methode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="c64d3-130">The Shell specifies the object by passing its name to the method.</span></span> <span data-ttu-id="c64d3-131">Wenn für einen Handler das Symbol Overlay angezeigt werden soll, gibt **ismembership of** S \_ OK zurück.</span><span class="sxs-lookup"><span data-stu-id="c64d3-131">If a handler wants to have its icon overlay displayed, **IsMemberOf** returns S\_OK.</span></span> <span data-ttu-id="c64d3-132">Andernfalls wird S false zurückgegeben \_ .</span><span class="sxs-lookup"><span data-stu-id="c64d3-132">If not, it returns S\_FALSE.</span></span>

<span data-ttu-id="c64d3-133">Symbol Überlagerungs Handler sind normalerweise für die Arbeit mit einer bestimmten Gruppe von Dateien vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="c64d3-133">Icon overlay handlers are normally intended to work with a particular group of files.</span></span> <span data-ttu-id="c64d3-134">Ein typisches Beispiel ist ein [Dateityp](fa-file-types.md), der durch eine bestimmte Dateinamenerweiterung gekennzeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="c64d3-134">A typical example is a [file type](fa-file-types.md), identified by a specific file name extension.</span></span> <span data-ttu-id="c64d3-135">Ein Symbol Überlagerungs Handler kann eine Symbol Überlagerung für alle Dateien des Dateityps anfordern.</span><span class="sxs-lookup"><span data-stu-id="c64d3-135">An icon overlay handler can request an icon overlay for all files of the file type.</span></span> <span data-ttu-id="c64d3-136">Einige Handler fordern eine Symbol Überlagerung nur an, wenn sich eine Datei mit dem Dateityp in einem bestimmten Zustand befindet.</span><span class="sxs-lookup"><span data-stu-id="c64d3-136">Some handlers request an icon overlay only if a file of the file type is in a particular state.</span></span> <span data-ttu-id="c64d3-137">Allerdings können Symbol Überlagerungs Handler das Symbol Overlay für jedes beliebige Objekt anfordern.</span><span class="sxs-lookup"><span data-stu-id="c64d3-137">However, icon overlay handlers are free to request their icon overlay for any object that they choose.</span></span>

 

 
