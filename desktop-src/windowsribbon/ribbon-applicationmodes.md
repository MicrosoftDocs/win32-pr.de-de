---
title: Neukonfigurieren des Menübands mit Anwendungsmodi
description: Das Windows-Menüband-Framework unterstützt die dynamische Neukonfiguration und das verfügbar machen von Kernelementen der Menüband-Benutzeroberfläche zur Laufzeit basierend auf dem Zustand der Anwendung (auch als Kontext bezeichnet).
ms.assetid: 8e9d85c5-33e4-4212-b9e4-2fc3b492c273
keywords:
- Windows-Menüband, Neukonfiguration mit Anwendungsmodi
- Multifunktionsleiste, Neukonfiguration mit Anwendungsmodi
- Neukonfigurieren von Windows-Menüband mit Anwendungsmodi
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83d206c238e6fe7463562077daaa52a5522a79d9
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104390334"
---
# <a name="reconfiguring-the-ribbon-with-application-modes"></a><span data-ttu-id="a39a3-106">Neukonfigurieren des Menübands mit Anwendungsmodi</span><span class="sxs-lookup"><span data-stu-id="a39a3-106">Reconfiguring the Ribbon with Application Modes</span></span>

<span data-ttu-id="a39a3-107">Das Windows-Menüband-Framework unterstützt die dynamische Neukonfiguration und das verfügbar machen von Kernelementen der Menüband-Benutzeroberfläche zur Laufzeit basierend auf dem Zustand der Anwendung (auch als Kontext bezeichnet).</span><span class="sxs-lookup"><span data-stu-id="a39a3-107">The Windows Ribbon framework supports the dynamic reconfiguring and exposing of core elements of the Ribbon UI at run time, based on the application's state (also referred to as context).</span></span> <span data-ttu-id="a39a3-108">Die verschiedenen Zustände, die von einer Anwendung unterstützt werden, werden als Anwendungsmodi bezeichnet und mit bestimmten Elementen im Markup verknüpft.</span><span class="sxs-lookup"><span data-stu-id="a39a3-108">Declared and associated with specific elements in markup, the various states supported by an application are referred to as application modes.</span></span>

-   [<span data-ttu-id="a39a3-109">Introduction (Einführung)</span><span class="sxs-lookup"><span data-stu-id="a39a3-109">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="a39a3-110">Kontextabhängige Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="a39a3-110">Contextual User Interface</span></span>](#contextual-user-interface)
    -   [<span data-ttu-id="a39a3-111">Ein Szenario mit einfachem Anwendungsmodus</span><span class="sxs-lookup"><span data-stu-id="a39a3-111">A Simple Application Mode Scenario</span></span>](#a-simple-application-mode-scenario)
-   [<span data-ttu-id="a39a3-112">Implementieren von Anwendungsmodi</span><span class="sxs-lookup"><span data-stu-id="a39a3-112">Implementing Application Modes</span></span>](#implementing-application-modes)
    -   [<span data-ttu-id="a39a3-113">Identifizieren der Modi</span><span class="sxs-lookup"><span data-stu-id="a39a3-113">Identify the Modes</span></span>](#identify-the-modes)
    -   [<span data-ttu-id="a39a3-114">Zuweisen von Steuerelementen zu Anwendungsmodi</span><span class="sxs-lookup"><span data-stu-id="a39a3-114">Assign Controls to Application Modes</span></span>](#assign-controls-to-application-modes)
    -   [<span data-ttu-id="a39a3-115">Wechseln von Modi zur Laufzeit</span><span class="sxs-lookup"><span data-stu-id="a39a3-115">Switch Modes at Runtime</span></span>](#switch-modes-at-runtime)
-   [<span data-ttu-id="a39a3-116">Anmerkungen</span><span class="sxs-lookup"><span data-stu-id="a39a3-116">Remarks</span></span>](#remarks)
-   [<span data-ttu-id="a39a3-117">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="a39a3-117">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="a39a3-118">Einführung</span><span class="sxs-lookup"><span data-stu-id="a39a3-118">Introduction</span></span>

<span data-ttu-id="a39a3-119">Anwendungsmodi bestehen aus logischen Gruppen von Steuerelementen, die in der Menüband-Benutzeroberfläche einige Kern Anwendungsfunktionen verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-119">Application modes consist of logical groups of controls that expose some core application functionality in the Ribbon UI.</span></span> <span data-ttu-id="a39a3-120">Diese Modi werden von der Anwendung dynamisch aktiviert oder deaktiviert, indem die Framework-Methode [**iuiframework:: setmodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes)aufgerufen wird, die die Sichtbarkeit von mindestens einem Anwendungsmodus aktiviert oder deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="a39a3-120">These modes are dynamically enabled or disabled by the application through a call to the framework method [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes), which turns the visibility of one or more application modes on or off.</span></span>

## <a name="contextual-user-interface"></a><span data-ttu-id="a39a3-121">Kontextabhängige Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="a39a3-121">Contextual User Interface</span></span>

<span data-ttu-id="a39a3-122">Das Menüband-Framework bietet umfassende Benutzer Funktionen, indem dynamische Steuerelemente integriert werden, die nahtlos auf die Benutzerinteraktion und den Anwendungskontext reagieren.</span><span class="sxs-lookup"><span data-stu-id="a39a3-122">The Ribbon framework provides rich user experience by incorporating dynamic controls that respond seamlessly to user interaction and application context.</span></span> <span data-ttu-id="a39a3-123">Diese umfangreiche kontextbezogene Benutzeroberfläche wird durch eine Kombination der folgenden Mechanismen bereitgestellt:</span><span class="sxs-lookup"><span data-stu-id="a39a3-123">This rich contextual UI is delivered through a combination of the following mechanisms:</span></span>

-   <span data-ttu-id="a39a3-124">Kataloge: Sammlungs basierte Steuerelemente, die die dynamische Bearbeitung Ihrer Element Auflistungen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-124">Galleries - collection-based controls that support the dynamic manipulation of their item collections.</span></span>
-   <span data-ttu-id="a39a3-125">Kontextabhängige Registerkarten: Menüband-Registerkarten, deren Sichtbarkeit durch eine Änderung im Arbeitsbereichs Kontext bestimmt wird, z. b. die Auswahl eines Bilds in einem Dokument.</span><span class="sxs-lookup"><span data-stu-id="a39a3-125">Contextual tabs - ribbon tabs that have their visibility determined by a change in workspace context, such as the selection of an image in a document.</span></span>
-   <span data-ttu-id="a39a3-126">Anwendungsmodi: Kern Anwendungsfunktionen, die vom Anwendungskontext abhängig sind.</span><span class="sxs-lookup"><span data-stu-id="a39a3-126">Application modes - core application functionality that is dependent on application context.</span></span>

<span data-ttu-id="a39a3-127">In gewisser Hinsicht ähneln Anwendungsmodi funktionell den Kontext Registerkarten.</span><span class="sxs-lookup"><span data-stu-id="a39a3-127">In some respects, application modes appear functionally similar to contextual tabs.</span></span> <span data-ttu-id="a39a3-128">Der grundlegende Unterschied liegt jedoch in der Absicht und dem Bereich jeder.</span><span class="sxs-lookup"><span data-stu-id="a39a3-128">However, the fundamental distinction lies in the intent and scope of each.</span></span>

<span data-ttu-id="a39a3-129">Kontextbezogene Steuerelemente werden als Reaktion auf eine Änderung des Kontexts in einer Anwendung aktiviert.</span><span class="sxs-lookup"><span data-stu-id="a39a3-129">Contextual controls are activated in response to a change of context within an application.</span></span> <span data-ttu-id="a39a3-130">Beispielsweise wird in Microsoft Paint für Windows 7 eine kontextbezogene Registerkarte angezeigt, die Gruppen von Text bezogenen Befehlen enthält, wenn ein Benutzer einen Textbereich in den Arbeitsbereich einfügt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-130">For example, in Microsoft Paint for Windows 7, a contextual tab that contains groups of text-related commands is displayed when a user inserts a text area into the workspace.</span></span> <span data-ttu-id="a39a3-131">Diese Kontext Registerkarte enthält keine Kern Befehle für die Anwendung und wird nur in der Benutzeroberfläche verfügbar gemacht, da sich der Kontext *innerhalb* der Anwendung geändert hat.</span><span class="sxs-lookup"><span data-stu-id="a39a3-131">This contextual tab does not contain core commands for the application and is only exposed in the UI because the context *within* the application has changed.</span></span> <span data-ttu-id="a39a3-132">Die Kernfunktionalität der Anwendung (die Befehle zum Bearbeiten von Bildern) ist nach wie vor relevant und für den Benutzer verfügbar, auch wenn die Kontext Registerkarte sichtbar ist.</span><span class="sxs-lookup"><span data-stu-id="a39a3-132">The core functionality of the application (the image editing commands) is still relevant and available to the user, even with the contextual tab visible.</span></span>

<span data-ttu-id="a39a3-133">Anwendungsmodi unterscheiden sich von kontextbezogenen Steuerelementen darin, dass Sie die Funktionalität als Reaktion auf Änderungen im Kontext, in dem die Anwendung ausgeführt wird, neu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="a39a3-133">Application modes differ from contextual controls in that they reconfigure functionality in response to changes in the context that the application is operating in.</span></span> <span data-ttu-id="a39a3-134">Anwendungsmodi befinden sich auf einer höheren Abstraktions Ebene. Sie bieten eine Möglichkeit, die Kernfunktionen einer Anwendung neu zu konfigurieren, anstatt vorübergehend Funktionen verfügbar zu machen, bei denen es sich nicht um eine Kernkomponente der Benutzeroberfläche handelt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-134">Application modes sit at a higher level of abstraction; they provide a way to reconfigure the core functionality of an application instead of temporarily exposing functionality that is not a core component of the UI.</span></span> <span data-ttu-id="a39a3-135">Beispielsweise tritt in Microsoft Paint für Windows 7 ein Switch im Anwendungsmodus auf, wenn der Befehl " **Druckvorschau** " aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="a39a3-135">For example, in Microsoft Paint for Windows 7, a switch in application mode occurs when the **Print preview** command is invoked.</span></span> <span data-ttu-id="a39a3-136">Wenn Microsoft Paint zur **Druckvorschau** wechselt, ändert sich der Kontext, in dem die Anwendung ausgeführt wird, von der Bearbeitung in die Vorschau.</span><span class="sxs-lookup"><span data-stu-id="a39a3-136">When Microsoft Paint switches to **Print preview**, the context that the application is operating in changes from editing to previewing.</span></span> <span data-ttu-id="a39a3-137">Folglich wird die Kernfunktionalität der Anwendung geändert, bis die Seiten **Ansicht** abgebrochen wird und die Anwendung erneut in den Bearbeitungs Kontext wechselt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-137">As a result, the core functionality of the application changes until the **Print preview** is canceled and the application enters the editing context again.</span></span>

### <a name="a-simple-application-mode-scenario"></a><span data-ttu-id="a39a3-138">Ein Szenario mit einfachem Anwendungsmodus</span><span class="sxs-lookup"><span data-stu-id="a39a3-138">A Simple Application Mode Scenario</span></span>

<span data-ttu-id="a39a3-139">Im folgenden Szenario wird veranschaulicht, wie Anwendungsmodi in einer Anwendung namens ribbonapp verwendet werden, um diskrete Aspekte der Kernfunktionalität verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-139">The following scenario demonstrates how application modes are used, in an application called RibbonApp, to expose discrete aspects of core functionality.</span></span>

<span data-ttu-id="a39a3-140">In ribbonapp sind zwei Anwendungsmodi definiert:</span><span class="sxs-lookup"><span data-stu-id="a39a3-140">Two application modes are defined in RibbonApp:</span></span>

-   <span data-ttu-id="a39a3-141">Der einfache Modus macht in der Menüband-Benutzeroberfläche **einfache** Befehle verfügbar.</span><span class="sxs-lookup"><span data-stu-id="a39a3-141">**Simple** mode exposes basic commands throughout the Ribbon UI.</span></span> <span data-ttu-id="a39a3-142">Diese Befehle werden immer angezeigt, unabhängig davon, welcher Anwendungsmodus aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="a39a3-142">These commands appear at all times, no matter which application mode is active.</span></span>
-   <span data-ttu-id="a39a3-143">Der **Erweiterte** Modus macht komplexe Befehle verfügbar, die für Benutzer von Experten der Anwendung vorgesehen sind.</span><span class="sxs-lookup"><span data-stu-id="a39a3-143">**Advanced** mode exposes complex commands intended for expert users of the application.</span></span> <span data-ttu-id="a39a3-144">Diese erweiterten Befehle werden neben den einfachen Befehlen in der Multifunktionsleisten-Benutzeroberfläche angezeigt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-144">These advanced commands appear throughout the Ribbon UI, in addition to the simple commands.</span></span>

<span data-ttu-id="a39a3-145">Standardmäßig wird ribbonapp im **einfachen** Modus geöffnet, und die für Anfänger benötigten Befehle werden im **Anwendungsmenü** und auf der Registerkarte **Home** angezeigt. Die folgenden Screenshots zeigen das ribbonapp- **Anwendungsmenü** und die Registerkarte " **Home** " im **einfachen** Modus, wobei die modalen Steuerelemente hervorgehoben werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-145">By default, RibbonApp is set to open in **Simple** mode, and the commands required by novice users are displayed in the **Application Menu** and the **Home** tab. The following screen shots show the RibbonApp **Application Menu** and **Home** tab in **Simple** mode, highlighting the modal controls.</span></span>

![Screenshot, der eine Registerkarte für den einfachen Anwendungsmodus anzeigt](images/overviews/appmode-hometab.png)![Screenshot, der das Anwendungsmenü für den einfachen Anwendungsmodus anzeigt](images/overviews/appmode-simpleappmenu.png)

<span data-ttu-id="a39a3-148">Obwohl diese Befehle für Einsteiger ausreichend sein können, unterstützt die ribbonapp auch expertenbenutzer über einen **erweiterten** Modus, der bei Aktivierung durch Klicken auf die Schaltfläche **zum erweiterten Modus wechseln** im **Anwendungsmenü** zusätzliche Kernfunktionen anzeigt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-148">While these commands may be sufficient for novice users, the RibbonApp also supports expert users through an **Advanced** mode that, when activated by clicking the **Switch to Advanced Mode** button in the **Application Menu**, displays additional core functionality.</span></span>

<span data-ttu-id="a39a3-149">Dieses Szenario kann problemlos implementiert werden, indem verschiedene Elemente im Markup an diskrete Anwendungsmodi gebunden werden, die nach Bedarf aktiviert oder deaktiviert werden können.</span><span class="sxs-lookup"><span data-stu-id="a39a3-149">This scenario is easily implemented by binding various elements in markup to discrete application modes that can be turned on and off as required.</span></span> <span data-ttu-id="a39a3-150">Die folgenden Screenshots zeigen das ribbonapp- **Anwendungsmenü** und die Registerkarte " **Home** " im **erweiterten** Modus, wobei die modalen Steuerelemente hervorgehoben werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-150">The following screen shots show the RibbonApp **Application Menu** and **Home** tab in **Advanced** mode, highlighting the modal controls.</span></span>

![Screenshot, der eine Registerkarte für den erweiterten Anwendungsmodus anzeigt.](images/overviews/appmode-advancedtab.png)![Screenshot, der das Anwendungsmenü für den erweiterten Anwendungsmodus anzeigt](images/overviews/appmode-advancedappmenu.png)

## <a name="implementing-application-modes"></a><span data-ttu-id="a39a3-153">Implementieren von Anwendungsmodi</span><span class="sxs-lookup"><span data-stu-id="a39a3-153">Implementing Application Modes</span></span>

<span data-ttu-id="a39a3-154">In diesem Abschnitt werden die drei Schritte beschrieben, die in der Regel für die Implementierung von Menüband-Framework-Anwendungsmodi</span><span class="sxs-lookup"><span data-stu-id="a39a3-154">This section outlines the three steps typically required for the implementation of Ribbon framework application modes.</span></span> <span data-ttu-id="a39a3-155">Ribbonapp wird verwendet, um ein Beispiel für jeden Schritt bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-155">RibbonApp is used to provide an example for each step.</span></span>

### <a name="identify-the-modes"></a><span data-ttu-id="a39a3-156">Identifizieren der Modi</span><span class="sxs-lookup"><span data-stu-id="a39a3-156">Identify the Modes</span></span>

<span data-ttu-id="a39a3-157">Jeder Modus in einer Anwendung sollte einen logischen Funktions Satz darstellen, der von dem Kontext abhängig ist, in dem eine Anwendung arbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="a39a3-157">Each mode in an application should represent a logical set of functionality that depends on the context an application is able to operate in.</span></span> <span data-ttu-id="a39a3-158">Wenn eine Anwendung z. b. Steuerelemente anzeigt, die nur relevant sind, wenn eine Netzwerkverbindung erkannt wird, arbeiten diese Steuerelemente innerhalb eines Netzwerk Kontexts, der die Erstellung eines **Netzwerk** Modus rechtfertigen könnte.</span><span class="sxs-lookup"><span data-stu-id="a39a3-158">For example, if an application displays controls that are only relevant when a network connection is detected, those controls operate within a networking context that might justify the creation of a **Network** mode.</span></span>

<span data-ttu-id="a39a3-159">Ribbonapp verfügt über zwei Kontexte, die zu einem beliebigen Zeitpunkt aktiv sein können: **einfach** und **erweitert**.</span><span class="sxs-lookup"><span data-stu-id="a39a3-159">RibbonApp has two contexts that can be active at any given time: **Simple** and **Advanced**.</span></span> <span data-ttu-id="a39a3-160">Daher erfordert ribbonapp zwei Modi: **einfach** und **erweitert**.</span><span class="sxs-lookup"><span data-stu-id="a39a3-160">Therefore, RibbonApp requires two modes: **Simple** and **Advanced**.</span></span>

### <a name="assign-controls-to-application-modes"></a><span data-ttu-id="a39a3-161">Zuweisen von Steuerelementen zu Anwendungsmodi</span><span class="sxs-lookup"><span data-stu-id="a39a3-161">Assign Controls to Application Modes</span></span>

<span data-ttu-id="a39a3-162">Nachdem die Anwendungsmodi identifiziert wurden, weisen Sie jedes Menüband-Steuerelement einem Modus zu, indem Sie für Steuerelemente, die Anwendungsmodi unterstützen, ein *applicationmodes* -Attribut im Markup deklarieren.</span><span class="sxs-lookup"><span data-stu-id="a39a3-162">Once the application modes have been identified, assign each Ribbon control to a mode by declaring an *ApplicationModes* attribute in markup for those control elements that support application modes.</span></span>

<span data-ttu-id="a39a3-163">Die Menü Band Ansicht ermöglicht das Angeben von Modi für die folgenden Steuerelemente:</span><span class="sxs-lookup"><span data-stu-id="a39a3-163">The Ribbon View allows modes to be specified on the following control elements:</span></span>

-   <span data-ttu-id="a39a3-164">Kern [**Register**](windowsribbon-element-tab.md) Kartenelemente.</span><span class="sxs-lookup"><span data-stu-id="a39a3-164">Core [**Tab**](windowsribbon-element-tab.md) elements.</span></span>
-   <span data-ttu-id="a39a3-165">[**Gruppieren**](windowsribbon-element-group.md) Sie Elemente, die untergeordnete Elemente eines Kern [**Register**](windowsribbon-element-tab.md) Karten Elements sind.</span><span class="sxs-lookup"><span data-stu-id="a39a3-165">[**Group**](windowsribbon-element-group.md) elements that are child elements of a core [**Tab**](windowsribbon-element-tab.md) element.</span></span>
-   <span data-ttu-id="a39a3-166">[**Schalt**](windowsribbon-element-button.md)Flächen-, [**SplitButton**](windowsribbon-element-splitbutton.md)-und [**DropDownButton**](windowsribbon-element-dropdownbutton.md) -Elemente, die einer [**MenuGroup**](windowsribbon-element-menugroup.md) im [Anwendungsmenü](windowsribbon-controls-applicationmenu.md)zugewiesen sind.</span><span class="sxs-lookup"><span data-stu-id="a39a3-166">[**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md), and [**DropDownButton**](windowsribbon-element-dropdownbutton.md) elements assigned to a [**MenuGroup**](windowsribbon-element-menugroup.md) within the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>
    > [!Note]  
    > <span data-ttu-id="a39a3-167">[**Schalt**](windowsribbon-element-button.md)Flächen-, [**SplitButton**](windowsribbon-element-splitbutton.md)-und [**DropDownButton**](windowsribbon-element-dropdownbutton.md) -Elemente können nur dann einem Modus zugewiesen werden, wenn Sie im [Anwendungsmenü](windowsribbon-controls-applicationmenu.md)gehostet werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-167">[**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md), and [**DropDownButton**](windowsribbon-element-dropdownbutton.md) elements cannot be assigned to a mode unless hosted in the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>

     

<span data-ttu-id="a39a3-168">Im Menüband-Framework werden diese Steuerelemente als modale Steuerelemente bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="a39a3-168">In the Ribbon framework, these control elements are referred to as modal controls.</span></span> <span data-ttu-id="a39a3-169">Sie werden nur angezeigt, wenn ein Modus, an den Sie gebunden sind, in der Benutzeroberfläche aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="a39a3-169">They appear only if a mode to which they are bound is active in the UI.</span></span>

<span data-ttu-id="a39a3-170">Steuerelemente, die in einem modalen Steuerelement enthalten sind, erben das Verhalten des Anwendungsmodus.</span><span class="sxs-lookup"><span data-stu-id="a39a3-170">Control elements that are contained within a modal control inherit the application mode behavior.</span></span> <span data-ttu-id="a39a3-171">Wenn z. b. ein modales [**Gruppen**](windowsribbon-element-group.md) Steuerelement einem **erweiterten** Modus zugewiesen ist und der **Erweiterte** Modus nicht aktiv ist, werden diese **Gruppe** und alle darin vorgesehenen Steuerelemente, modal oder anderweitig, auf der Multifunktionsleisten-Benutzeroberfläche nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-171">For example, if a [**Group**](windowsribbon-element-group.md) modal control is assigned to an **Advanced** mode and the **Advanced** mode is not active, then that **Group** and any controls in it, modal or otherwise, will not be visible in the Ribbon UI.</span></span>

<span data-ttu-id="a39a3-172">Mit der Verwendung des *applicationmodes* -Attributs werden Modi modalen Steuerelementen in einer 1: N-Beziehung (1: N) zugewiesen, bei der ein einzelnes modales Steuerelement mit mehreren Modi verknüpft werden kann.</span><span class="sxs-lookup"><span data-stu-id="a39a3-172">With the use of the *ApplicationModes* attribute, modes are assigned to modal controls in a 1:N (one-to-many) relationship, where a single modal control can be associated with several modes.</span></span>

<span data-ttu-id="a39a3-173">Das Menüband-Framework bezieht sich auf die Zahlen von 0 bis 31 (von 0 bis 31), wobei Modus 0 der Standardmodus ist, der beim Starten einer Menü Bandanwendung automatisch aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="a39a3-173">The Ribbon framework refers to modes numerically, from 0 to 31, with mode 0 considered the default mode that is automatically activated when a Ribbon application starts.</span></span> <span data-ttu-id="a39a3-174">Alle modalen Steuerelemente, die kein *applicationmodes* -Attribut angeben, werden als Member des Standardmodus angesehen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-174">Any modal control that does not specify an *ApplicationModes* attribute is considered to be a member of the default mode.</span></span>

<span data-ttu-id="a39a3-175">In ribbonapp ist **Simple** der Standardmodus, und die Funktionalität im **erweiterten** Modus wird nur angezeigt, wenn er vom Benutzer initiiert wird.</span><span class="sxs-lookup"><span data-stu-id="a39a3-175">In RibbonApp, **Simple** is the default mode, with **Advanced** mode functionality displayed only when it is initiated by the user.</span></span>

<span data-ttu-id="a39a3-176">Im folgenden Beispiel wird das für ribbonapp erforderliche Markup veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="a39a3-176">The following example demonstrates the markup required for RibbonApp.</span></span>


```C++
<Application.Views>
  <Ribbon>

    <!--Application Menu-->
    <Ribbon.ApplicationMenu>
      <ApplicationMenu CommandName='cmdAppMenu'>                    
        <MenuGroup>
          <Button CommandName='cmdSave'/>                        
          <Button CommandName='cmdExportMetadata' ApplicationModes='1'/>                   
        </MenuGroup>              
        <MenuGroup>
          <Button CommandName='cmdSwitchModes' ApplicationModes ='0,1'/>
          <Button CommandName='cmdExit'/>
        </MenuGroup>
      </ApplicationMenu>
    </Ribbon.ApplicationMenu>
            
    <!--Tabs-->
    <Ribbon.Tabs>
      <!--Home Tab-->
      <Tab CommandName='cmdHomeTab'>
                    
        <!--Scaling Policy for Home tab-->
        <Tab.ScalingPolicy>
          <ScalingPolicy>
            <ScalingPolicy.IdealSizes>
              <Scale Group='cmdSimpleControlsGroup' Size='Medium'/>                                
            </ScalingPolicy.IdealSizes>                     
          </ScalingPolicy>
        </Tab.ScalingPolicy>     
                    
        <!--Simple Controls Group-->
        <Group CommandName='cmdSimpleControlsGroup' SizeDefinition='ThreeButtons-OneBigAndTwoSmall'>                        
          <Button CommandName="cmdPaste" />
          <Button CommandName='cmdCut'/>                        
          <Button CommandName='cmdCopy'/>                        
        </Group>
      </Tab>
                
      <!--Advanced Tab-->
      <Tab CommandName='cmdAdvancedTab' ApplicationModes='1'>
        <!--Advanced Controls Group-->
        <Group CommandName='cmdMetadataGroup' ApplicationModes='1' SizeDefinition='TwoButtons'>
          <Button CommandName='cmdEditMetadata' />
          <Button CommandName='cmdCheckErrors' />
        </Group>
      </Tab>
    </Ribbon.Tabs>                   
                             
  </Ribbon>         
</Application.Views>
```



<span data-ttu-id="a39a3-177">In diesem Beispiel wird Folgendes veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="a39a3-177">This example demonstrates the following:</span></span>

-   <span data-ttu-id="a39a3-178">Der Standardmodus 0 muss nicht explizit deklariert werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-178">Default mode 0 does not need to be explicitly declared.</span></span> <span data-ttu-id="a39a3-179">Da modale Steuerelemente, die das *applicationmodes* -Attribut nicht angeben, automatisch an den Modus 0 gebunden werden (**einfacher** Modus im ribbonapp-Beispiel), ist es nicht erforderlich, das-Attribut explizit für modale Standard Steuerelemente zu deklarieren.</span><span class="sxs-lookup"><span data-stu-id="a39a3-179">Because modal controls that do not specify the *ApplicationModes* attribute are automatically bound to mode 0 (**Simple** mode in the RibbonApp example), there is no need to explicitly declare the attribute for default modal controls.</span></span>
-   <span data-ttu-id="a39a3-180">Steuerelemente können an mehrere Modi gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-180">Controls can be bound to multiple modes.</span></span> <span data-ttu-id="a39a3-181">Bei ribbonapp ist die Schaltfläche die einzige Anforderung für das *applicationmodes* -Attribut in einem Steuerelement im **einfachen** Modus `cmdSwitchModes` , da es Teil des **einfachen** und **erweiterten** Modus ist.</span><span class="sxs-lookup"><span data-stu-id="a39a3-181">For RibbonApp, the only need for the *ApplicationModes* attribute in a **Simple** mode control is the `cmdSwitchModes` button , since it is a part of both **Simple** and **Advanced** modes.</span></span> <span data-ttu-id="a39a3-182">Wenn einer der beiden Modi aktiv ist, wird dieses Steuerelement im [Anwendungsmenü](windowsribbon-controls-applicationmenu.md)angezeigt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-182">If either mode is active, this control will appear in the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>
-   <span data-ttu-id="a39a3-183">Modale Steuerelemente erben nicht von ihren übergeordneten Elementen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-183">Modal controls do not inherit from their parents.</span></span> <span data-ttu-id="a39a3-184">Die Registerkarte " **erweitert** " von ribbonapp enthält eine **metadatengruppe** . Beide modalen Steuerelemente werden **dem Modus 1 (** erweiterter Modus) zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-184">The **Advanced** tab of RibbonApp contains a **Metadata** group; both of these modal controls are assigned to mode 1 (**Advanced** mode).</span></span> <span data-ttu-id="a39a3-185">Durch das Zuweisen der Registerkarte " **erweitert** " zu Modus 1 werden untergeordnete Steuerelemente wie die **metadatengruppe** nicht automatisch zu Modus 1 zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-185">Assigning the **Advanced** tab to mode 1 does not automatically assign child controls, such as the **Metadata** group, to mode 1.</span></span> <span data-ttu-id="a39a3-186">Dadurch kann jede Gruppe innerhalb einer Registerkarte zur Laufzeit unabhängig aktiviert oder deaktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-186">This allows any group within a tab to be independently enabled or disabled at runtime.</span></span>
-   <span data-ttu-id="a39a3-187">Nicht modale Steuerelemente können weiterhin auf modusswitches zurückgreifen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-187">Non-modal controls can still rely on mode switches.</span></span> <span data-ttu-id="a39a3-188">Die Schaltflächen **Edit Metadata** und **Check for Errors** von ribbonapp sind für fortgeschrittene Benutzer und nur verfügbar, wenn der Benutzer in den **erweiterten** Modus wechselt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-188">The **Edit Metadata** and **Check for Errors** buttons of RibbonApp are for advanced users and available only when the user switches to **Advanced** mode.</span></span> <span data-ttu-id="a39a3-189">Schaltflächen-Steuerelemente, die nicht im [Anwendungsmenü](windowsribbon-controls-applicationmenu.md) gehostet werden, sind nicht modal. Da diese Schaltflächen jedoch in einem modalen Steuerelement (der **metadatengruppe** ) gehostet werden, sind Sie sichtbar, wenn die Gruppe sichtbar ist.</span><span class="sxs-lookup"><span data-stu-id="a39a3-189">Button controls that are not hosted inside the [Application Menu](windowsribbon-controls-applicationmenu.md) are non-modal; however, because these buttons are hosted inside a modal control (the **Metadata** group), they are visible when the group is visible.</span></span> <span data-ttu-id="a39a3-190">Diese Schaltflächen werden daher angezeigt, wenn der erweiterte Modus aktiviert und die **metadatengruppe** in der Menüband-Benutzeroberfläche verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="a39a3-190">Therefore, these buttons appear when the advanced mode is activated and the **Metadata** group is exposed in the Ribbon UI.</span></span>

### <a name="switch-modes-at-runtime"></a><span data-ttu-id="a39a3-191">Wechseln von Modi zur Laufzeit</span><span class="sxs-lookup"><span data-stu-id="a39a3-191">Switch Modes at Runtime</span></span>

<span data-ttu-id="a39a3-192">Nachdem Modi im Markup definiert wurden, können Sie als Reaktion auf Kontext Ereignisse problemlos aktiviert oder deaktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-192">After modes are defined in markup, they can be easily enabled or disabled in response to contextual events.</span></span> <span data-ttu-id="a39a3-193">Wie bereits erwähnt, werden Menüband-Anwendungen immer im Standardmodus 0 gestartet.</span><span class="sxs-lookup"><span data-stu-id="a39a3-193">As mentioned previously, Ribbon applications always start in the default mode 0.</span></span> <span data-ttu-id="a39a3-194">Nachdem die Anwendung initialisiert wurde und Modus 0 aktiv ist, kann der Satz aktiver Modi durch Aufrufen der [**iuiframework:: setmodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) -Funktion geändert werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-194">After the application has initialized and mode 0 is active, the set of active modes can be changed by calling the [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) function.</span></span> <span data-ttu-id="a39a3-195">Diese Funktion nimmt eine 32-Bit-Ganzzahl als bitweise Darstellung der Modi an, die aktiv sein sollen. das unwichtigste Bit steht für Modus 0 und das signifikanteste Bit steht für Modus 31.</span><span class="sxs-lookup"><span data-stu-id="a39a3-195">This function takes a 32-bit integer as a bitwise representation of the modes that should be active; the least significant bit represents mode 0 and the most significant bit represents mode 31.</span></span> <span data-ttu-id="a39a3-196">Wenn ein Bit auf 0 (null) festgelegt ist, ist der Modus auf der Menüband-Benutzeroberfläche nicht aktiv.</span><span class="sxs-lookup"><span data-stu-id="a39a3-196">If a bit is set to zero, the mode is not active in the Ribbon UI.</span></span>

<span data-ttu-id="a39a3-197">Wenn ein Benutzer in ribbonapp den **erweiterten** Modus aktiviert, werden die erweiterten Befehle neben den einfachen Befehlen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-197">In RibbonApp, when a user enables **Advanced** mode, the advanced commands are displayed alongside the simple commands.</span></span> <span data-ttu-id="a39a3-198">Der Befehls Handler für die Schaltfläche zu erweiterter **Modus wechseln** ruft [**iuiframework:: setmodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) auf, um die Modi 0 (**einfach**) und 1 (**erweitert**) auf der Benutzeroberfläche als aktiv festzulegen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-198">The command handler for the **Switch to Advanced Mode** button calls [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) in order to set modes 0 (**Simple**) and 1 (**Advanced**) as active in the UI.</span></span> <span data-ttu-id="a39a3-199">Das folgende Beispiel zeigt den ribbonapp-Code für diesen Funktions aufrub:</span><span class="sxs-lookup"><span data-stu-id="a39a3-199">The following example is the RibbonApp code for this function call :</span></span>


```C++
const int SIMPLE_MODE = 0;
const int ADVANCED_MODE = 1;
pFramework->SetModes( UI_MAKEAPPMODE(SIMPLE_MODE) | UI_MAKEAPPMODE(ADVANCED_MODE) );
```



> [!Note]  
> <span data-ttu-id="a39a3-200">Das "Multifunktionsleisten-Framework"- \_ makeappmode-Makro vereinfacht das Festlegen dieser Bits ordnungsgemäß für die Vorbereitung des Aufrufens von [**iuiframework:: setmodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes).</span><span class="sxs-lookup"><span data-stu-id="a39a3-200">The Ribbon framework UI\_MAKEAPPMODE macro simplifies the task of setting these bits correctly in preparation for the call to [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes).</span></span>

 

<span data-ttu-id="a39a3-201">In diesem Beispiel wird Folgendes veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="a39a3-201">This example demonstrates the following:</span></span>

-   <span data-ttu-id="a39a3-202">Verwenden Sie das \_ makeappmode-Makro der UI, um einen modussatz zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-202">Use the UI\_MAKEAPPMODE macro to build a mode set.</span></span>
-   <span data-ttu-id="a39a3-203">Modi werden explizit und atomarisch festgelegt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-203">Modes are set explicitly and atomically.</span></span> <span data-ttu-id="a39a3-204">Der ganzzahlige Wert, der an [**iuiframework:: setmodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) übermittelt wird, stellt die Modi dar, die aktiv werden, nachdem die Funktion zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="a39a3-204">The integer value that is passed to [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) represents the modes that will be active after the function returns.</span></span> <span data-ttu-id="a39a3-205">Obwohl der **einfache** Modus zuvor aktiv war, **muss iuiframework:: setmodes** angeben, dass der **einfache** Modus aktiv bleibt, wenn der **Erweiterte** Modus aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="a39a3-205">Although the **Simple** mode was previously active, **IUIFramework::SetModes** must indicate that the **Simple** mode remain active when the **Advanced** mode is activated.</span></span>
-   <span data-ttu-id="a39a3-206">Der Standardmodus kann entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-206">The default mode can be removed.</span></span> <span data-ttu-id="a39a3-207">Obwohl in ribbonapp der Standardmodus (Modus 0) nie entfernt wird, kann er mit dem folgenden-Befehl entfernt werden: `g_pFramework->SetModes(UI_MAKEAPPMODE(ADVANCED_MODE))` , wobei nur die erweiterten Befehle in der Benutzeroberfläche verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-207">Although in RibbonApp the default mode (mode 0) is never removed, it can be removed with the following call: `g_pFramework->SetModes(UI_MAKEAPPMODE(ADVANCED_MODE))`, exposing only the advanced commands in the UI.</span></span>

> [!Note]  
> <span data-ttu-id="a39a3-208">Wenn die Modi einer Anwendung neu konfiguriert werden, versucht das Menüband, die zuvor ausgewählte Registerkarte in der Benutzeroberfläche beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="a39a3-208">When the modes of an application are reconfigured, the Ribbon will attempt to preserve the previously selected tab in the UI.</span></span> <span data-ttu-id="a39a3-209">Wenn der neue Satz von Modi nicht mehr die Registerkarte enthält, die vor dem-Befehl ausgewählt wurde, wählt das Menüband die Registerkarte im Layout aus, die dem [Anwendungsmenü](windowsribbon-controls-applicationmenu.md)am nächsten liegt.</span><span class="sxs-lookup"><span data-stu-id="a39a3-209">If the new set of modes no longer contains the tab that was selected before the call, the Ribbon will select the tab in its layout that is closest to the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span> <span data-ttu-id="a39a3-210">Diese Registerkarte soll die Befehle enthalten, die für den Benutzer am relevantesten sind.</span><span class="sxs-lookup"><span data-stu-id="a39a3-210">This tab is meant to contain the commands that are most relevant to the user.</span></span> <span data-ttu-id="a39a3-211">Weitere Informationen finden Sie unter [Richtlinien](https://msdn.microsoft.com/library/cc872782.aspx)für die Multifunktionsleisten-Benutzer Leistung.</span><span class="sxs-lookup"><span data-stu-id="a39a3-211">For more information, see [Ribbon User Experience Guidelines](https://msdn.microsoft.com/library/cc872782.aspx).</span></span>

 

## <a name="remarks"></a><span data-ttu-id="a39a3-212">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="a39a3-212">Remarks</span></span>

<span data-ttu-id="a39a3-213">Das Menüband muss immer über mindestens einen aktiven Modus verfügen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-213">The Ribbon must have at least one active mode at all times.</span></span> <span data-ttu-id="a39a3-214">Wenn eine Anwendung versucht, alle Modi durch Aufrufen von [**iuiframework:: setmodes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) mit einem Moduswert von 0 zu deaktivieren, \_ wird E FAIL zurückgegeben, und der aktive modussatz bleibt unverändert.</span><span class="sxs-lookup"><span data-stu-id="a39a3-214">If an application attempts to deactivate all modes by calling [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) with a mode value of 0, E\_FAIL is returned and the active mode set remains unchanged.</span></span>

<span data-ttu-id="a39a3-215">Das Framework erfordert, dass in der Menüband-Benutzeroberfläche immer mindestens eine Registerkarte vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="a39a3-215">The framework requires that at least one tab exist in the Ribbon UI at all times.</span></span> <span data-ttu-id="a39a3-216">Folglich muss mindestens eine Registerkarte vom Standardmodus (Modus 0) und nach jedem Modusschalter verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="a39a3-216">As a result, there must be at least one tab exposed by the default mode (mode 0) and after each mode switch.</span></span>

<span data-ttu-id="a39a3-217">Nicht alle Bereiche der Multifunktionsleisten-Benutzeroberfläche sind von Anwendungsmodi betroffen.</span><span class="sxs-lookup"><span data-stu-id="a39a3-217">Not all areas of the Ribbon UI are affected by application modes.</span></span> <span data-ttu-id="a39a3-218">Wenn beispielsweise die Deaktivierung eines Modus das Verschwinden von Schaltflächen aus dem Menüband bewirkt, die zuvor der [Symbolleiste für den schnell Zugriff](windowsribbon-controls-quickaccesstoolbar.md)hinzugefügt wurden, verbleiben diese Schaltflächen auf der Symbolleiste für den schnell Zugriff, sodass Benutzer die an die Schaltflächen gebundenen Befehle ausführen können.</span><span class="sxs-lookup"><span data-stu-id="a39a3-218">For example, if disabling a mode causes the disappearance of buttons from the Ribbon that were previously added to the [Quick Access Toolbar](windowsribbon-controls-quickaccesstoolbar.md), those buttons remain in the Quick Access Toolbar, allowing users to execute the Commands bound to the buttons.</span></span> <span data-ttu-id="a39a3-219">Als allgemeine Regel gilt: Wenn ein Befehl zu einem oder mehreren inaktiven Modi gehört, sollte dieser Befehl auch deaktiviert werden, indem die Eigenschaft [UI \_ pkey \_ aktiviert](windowsribbon-reference-properties-uipkey-enabled.md) auf 0 (Variant \_ false) festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="a39a3-219">As a general rule, if a Command belongs to one or more inactive modes, then that Command should also be disabled by setting the [UI\_PKEY\_Enabled](windowsribbon-reference-properties-uipkey-enabled.md) property to 0 (VARIANT\_FALSE) .</span></span>

## <a name="related-topics"></a><span data-ttu-id="a39a3-220">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="a39a3-220">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a39a3-221">Multifunktionsleisten-Benutzeroberflächen Richtlinien</span><span class="sxs-lookup"><span data-stu-id="a39a3-221">Ribbon User Experience Guidelines</span></span>](https://msdn.microsoft.com/library/cc872782.aspx)
</dt> <dt>

[<span data-ttu-id="a39a3-222">Anzeigen kontextbezogener Registerkarten</span><span class="sxs-lookup"><span data-stu-id="a39a3-222">Displaying Contextual Tabs</span></span>](ribbon-contextualtabs.md)
</dt> </dl>

 

 