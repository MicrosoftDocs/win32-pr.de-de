---
description: Ein Paket mit zwei Zweck ist ein Windows Installer 5,0-Paket, das erstellt wurde, um eine-Anwendung entweder im Benutzer-oder computerspezifischen Installations Kontext installieren zu können.
ms.assetid: b2da9fba-8fdf-48fa-a662-6b3eee1bfe87
title: Erstellung eines einzelnen Pakets
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87c22b9be930be2d2178ea4efb7ba1538320823a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106353601"
---
# <a name="single-package-authoring"></a>Erstellung eines einzelnen Pakets

Ein Paket mit zwei Zweck ist ein Windows Installer 5,0-Paket, das erstellt wurde, um eine-Anwendung entweder im Benutzer-oder computerspezifischen [Installations Kontext](installation-context.md)installieren zu können. Setup Entwickler, die ein Dual-Zweck-Paket für Ihre Anwendung verwenden, können Ihren Benutzern den Installations Kontext zum Installations Zeitpunkt zur Verfügung stellen und können UAC-Anmeldeaufforderungen von benutzerdefinierten Installationen unter Windows 7 oder Windows Server 2008 R2 entfernen. Die Entwicklung eines Pakets mit zwei Zweck Windows Installer 5,0 für die Installation unter Windows 7 und Windows Server 2008 R2 wird als einzelne Paket Erstellung bezeichnet.

Sie können beginnen, Dual-Zweck-Pakete für Windows 7 und Windows Server 2008 R2 zu entwickeln, indem Sie Windows Installer 5,0, die [**msiinstallperuser**](msiinstallperuser.md) -Eigenschaft, die [**ALLUSERS**](allusers.md) -Eigenschaft und die pro Benutzer fähigen, bekannten Ordner und Registrierungen der [Windows-Shell](/previous-versions/windows/desktop/legacy/bb773177(v=vs.85))verwenden. Wenn Windows Installer 5,0 ein Paket mit zwei Zweck auf Windows 7 oder Windows Server 2008 R2 im Einzelbenutzer Kontext installiert, leitet das Installationsprogramm Datei-und Registrierungseinträge an benutzerspezifische Speicherorte um und zeigt keine UAC-Eingabe Aufforderungen für Anmelde Informationen an. Wenn Windows Installer 5,0 ein Paket mit zwei Zweck im computerspezifischen Kontext installiert, leitet das Installationsprogramm Dateien und Registrierungseinträge an Computer spezifische Speicherorte um und fordert UAC-Anmelde Informationen an, um zu bestätigen, dass der Benutzer über ausreichende Berechtigungen zum Installieren von Software für alle Benutzer des Computers verfügt. Nachdem Windows Installer 5,0 eine Anwendung installiert hat, wird für alle nachfolgenden Updates, Reparaturen oder das Entfernen der Anwendung derselbe Installations Kontext verwendet.

**[Windows Installer 4,5 oder früher](not-supported-in-windows-installer-4-5.md):** die [**msiinstallperuser**](msiinstallperuser.md) -Eigenschaft und die pro-Benutzer-Version der Ordner, auf die von den Eigenschaften [**ProgramFilesFolder**](programfilesfolder.md), [**CommonFilesFolder**](commonfilesfolder.md), [**ProgramFiles64Folder**](programfiles64folder.md)und [**CommonFiles64Folder**](commonfiles64folder.md) verwiesen wird, werden nicht unterstützt. Die Ordner " **folderid \_ userprogram files** " und " **folderid \_ userprogramfilescommon** " sind ab Windows 7 und Windows Server 2008 R2 verfügbar. Dies bedeutet, dass Installationen, die für Windows Installer 4,5 oder früher entwickelt wurden, direkte Dateien und Registrierungseinträge in folderid \_ Program Files, folderid \_ programfilescommon, folderid \_ ProgramFilesX64 und folderid \_ ProgramFilesCommonX64. Da es sich hierbei um Standorte handelt, die anderen Benutzern des Computers zur Verfügung stehen, erfordern Windows Vista und spätere Systeme die Anzeige von UAC-Eingabe Aufforderungen für Anmelde Informationen.

Wenn ein Benutzer ein Dual-Purpose-Paket installiert, das für Windows Installer 5,0 mit Windows Installer 4,5 oder früher erstellt wurde, ignoriert das Installationsprogramm die [**msiinstallperuser**](msiinstallperuser.md) -Eigenschaft. In diesem Fall kann die Installation Dateien und Registrierungseinträge an Speicherorte weiterleiten, auf die andere Benutzer zugreifen können, und das System muss UAC-Eingabe Aufforderungen zur Eingabe von Anmelde Informationen anzeigen. Windows Installer 5,0 kann ein Paket installieren, das für Windows Installer 4,5 oder früher entwickelt wurde. bei der Installation werden jedoch Dateien und Registrierungseinträge an Speicherorte weitergeleitet, auf die andere Benutzer zugreifen können, und das System muss UAC-Eingabe Aufforderungen für Anmelde Informationen anzeigen.

## <a name="development-guidelines"></a>Entwicklungs Richtlinien

Befolgen Sie die folgenden Richtlinien für die Erstellung von einzelnen Paketen, um sicherzustellen, dass das Paket entweder im Benutzer-oder computerspezifischen Kontext installiert werden kann. Befolgen Sie diese Richtlinien, um dem Benutzer zu ermöglichen, während der Installation eine pro-Benutzer-oder Computer spezifische Installation auszuwählen und UAC-Eingabe Aufforderungen von pro-Benutzer-Installationen zu entfernen.

-   Die Installation pro Benutzer erfordert Windows Installer 5,0 unter Windows 7 oder Windows Server 2008 R2. Sie sollten den Benutzer darüber informieren, dass das Paket die Computer spezifische Installation der Anwendung in früheren Versionen des Systems unterstützt.
-   Initialisieren Sie die Werte für die Eigenschaften " [**ALLUSERS**](allusers.md) " und " [**msiinstallperuser**](msiinstallperuser.md) " in der [Eigenschafts Tabelle](property-table.md) des Pakets mit zwei Zweck. Verwenden Sie den **ALLUSERS** -Wert 2 und einen **msiinstallperuser** -Wert von 1 als Anfangswerte. Hiermit wird die Installation pro Benutzer als Standardwert für das Paket mit zwei Zweck angegeben.
-   Erstellen Sie ein Dialogfeld für die [Benutzeroberfläche](user-interface.md) des Pakets mit zwei Zweck, das es dem Benutzer ermöglicht, den Kontext zum Installations Zeitpunkt auszuwählen. Erstellen Sie die Steuerelemente in diesem benutzerdefinierten Dialogfeld, um die Werte der Eigenschaften " [**ALLUSERS**](allusers.md) " und " [**msiinstallperuser**](msiinstallperuser.md) " festzulegen. Legen Sie für den Wert " **ALLUSERS** " auf "2" **msiinstallperuser** den Wert 1 fest, um eine Installation pro Benutzer anzugeben, und legen Sie **msiinstallperuser** auf eine leere Zeichenfolge ("") fest, um eine Installation pro Computer anzugeben. Benutzer können auch die **ALLUSERS** und **msiinstallperuser** in der Befehlszeile festlegen, wenn Sie das Paket über die Befehlszeile installieren.
-   Überprüfen Sie das Paket mithilfe [interner Konsistenz Auswertung-ICES](internal-consistency-evaluators-ices.md). Das Paket muss in der Lage sein, die Überprüfung durch [ICE105](ice-105.md) an ein gültiges Paket mit zwei Zweck zu übergeben.
-   Verwenden Sie die- [Registrierungs Tabelle](registry-table.md) und die [removeregistry-Tabelle](removeregistry-table.md) , um Registrierungseinträge während der Installation pro Benutzer an die einzelnen Benutzer Teile der Registrierung umzuleiten. Bei einer pro-Benutzer-Installation werden Registrierungseinträge mit-1 in der Stamm Spalte an den **aktuellen HKEY \_ - \_ Benutzer** umgeleitet, und bei einer Installation pro Computer werden diese an den **lokalen HKEY- \_ \_ Computer** geleitet. In einer pro-Benutzer-Installation werden Registrierungseinträge, die msidbregistryrootclassesroot (0) in der Stamm Spalte enthalten, in die **HKCU** \\ -**Software** \\ **Klassen** umgeleitet, und in einer computerspezifischen Installation werden diese an **HKLM**- \\ **Software** \\ **Klassen** weitergeleitet.
-   Verwenden Sie die [**ProgramFilesFolder**](programfilesfolder.md) -Eigenschaft in der [Verzeichnis Tabelle](directory-table.md) der [32-Bit-Windows Installer Paketen](32-bit-windows-installer-packages.md) , um die Speicherorte von Verzeichnissen anzugeben, die 32-Bit-Komponenten enthalten, die nicht Anwendungs übergreifend verwendet werden. Wenn ein Benutzer das Dual-Zweck-Paket mit dem computerspezifischen Kontext installiert, werden diese Komponenten im Ordner "Programme" auf 32-Bit-Versionen von Windows und im Ordner "Programme (x86)" auf 64-Bit-Versionen des Systems gespeichert. Auf die Komponenten in diesen Verzeichnissen kann von allen Benutzern zugegriffen werden. Wenn ein Benutzer das Dual-Zweck-Paket unter Windows 7 oder Windows Server 2008 R2 mithilfe des benutzerspezifischen Kontexts installiert, werden diese Komponenten im Ordner "Programme" des aktuellen Benutzers gespeichert (z. b. unter% LocalAppData% \\ programs), und nur dieser Benutzer kann darauf zugreifen.
-   Verwenden Sie die [**CommonFilesFolder**](commonfilesfolder.md) -Eigenschaft in der [Verzeichnis Tabelle](directory-table.md) der [32-Bit-Windows Installer Paketen](32-bit-windows-installer-packages.md) , um die Speicherorte von Verzeichnissen anzugeben, die 32-Bit-Komponenten enthalten, die Anwendungs übergreifend verwendet werden. Wenn ein Benutzer das Dual-Zweck-Paket mit dem computerspezifischen Kontext installiert, werden diese Komponenten im Ordner "gemeinsame Dateien" gespeichert, und von allen Benutzern kann darauf zugegriffen werden. Wenn ein Benutzer das Dual-Zweck-Paket unter Windows 7 oder Windows Server 2008 R2 über den Benutzer bezogenen Kontext installiert, werden diese Komponenten im Ordner "Allgemein" des aktuellen Benutzers gespeichert (z. b. bei "% LocalAppData%-Programme Common"), auf den \\ \\ nur dieser Benutzer zugreifen kann.
-   Verwenden Sie die [**ProgramFiles64Folder**](programfiles64folder.md) -Eigenschaft in der [Verzeichnis Tabelle](directory-table.md) der [64-Bit-Windows Installer Paketen](64-bit-windows-installer-packages.md) , um die Speicherorte von Verzeichnissen anzugeben, die 64-Bit-Komponenten enthalten, die nicht Anwendungs übergreifend verwendet werden Wenn ein Benutzer das Dual-Zweck-Paket mit dem computerspezifischen Kontext installiert, werden diese Komponenten im Ordner "Programme" gespeichert. Auf die Komponenten in diesen Verzeichnissen kann von allen Benutzern zugegriffen werden. Wenn ein Benutzer das Dual-Zweck-Paket unter Windows 7 oder Windows Server 2008 R2 mithilfe des benutzerspezifischen Kontexts installiert, werden diese Komponenten im Ordner "Programme" des aktuellen Benutzers gespeichert (z. b. unter% LocalAppData% \\ programs), und nur dieser Benutzer kann darauf zugreifen. Weitere Informationen zum Erstellen eines Pakets für die Installation einer Anwendung auf 64-Bit-Betriebssystemen finden Sie unter [Windows Installer auf 64-Bit-Betriebs](windows-installer-on-64-bit-operating-systems.md)Systemen.
-   Verwenden Sie die [**CommonFiles64Folder**](commonfiles64folder.md) -Eigenschaft in der [Verzeichnis Tabelle](directory-table.md) der [64-Bit-Windows Installer Paketen](64-bit-windows-installer-packages.md) , um die Speicherorte von Verzeichnissen anzugeben, die 64-Bit-Komponenten enthalten, die Anwendungs übergreifend verwendet werden Wenn ein Benutzer das Dual-Zweck-Paket mit dem computerspezifischen Kontext installiert, werden diese Komponenten im Ordner "gemeinsame Dateien" gespeichert, und von allen Benutzern kann darauf zugegriffen werden. Wenn ein Benutzer das Dual-Zweck-Paket unter Windows 7 oder Windows Server 2008 R2 über den Benutzer bezogenen Kontext installiert, werden diese Komponenten im Ordner "Allgemein" des aktuellen Benutzers gespeichert (z. b. bei "% LocalAppData%-Programme Common"), auf den \\ \\ nur dieser Benutzer zugreifen kann.
-   Verwenden Sie die Eigenschaften [**ProgramFilesFolder**](programfilesfolder.md) und [**CommonFilesFolder**](commonfilesfolder.md) in der [Verzeichnis Tabelle](directory-table.md) [64-Bit-Windows Installer Paketen](64-bit-windows-installer-packages.md) , um den Speicherort der Verzeichnisse anzugeben, die 32-Bit-Komponenten enthalten. Verwenden Sie unterschiedliche Namen für die 32-Bit-und 64-Bit-Versionen von Komponenten, die mit demselben Namen bereitgestellt werden, oder speichern Sie die Versionen alternativ in verschiedenen Ordnern. Fügen Sie beispielsweise der Verzeichnis Tabelle Informationen hinzu, um den Speicherort des Verzeichnisses, das die 32-Bit-Version enthält, als \[ ProgramFilesFolder \] \\ *ISV Name* \\ *Anwendungsname* \\ x86 und den Speicherort des Verzeichnisses, das die 64-Bit-Version enthält, als \[ Program64FilesFolder \] \\ *ISV Name* \\ *Application Name* \\ x64 anzugeben. Eine Computer spezifische Installation speichert dann die 32-Bit-Version in "Programme (x86) \\ *ISV Name* \\ *Anwendungsname* \\ x86" und speichert die 64-Bit-Version in "Programme \\ *ISV Name* \\ *Application Name* \\ x64". Bei einer pro-Benutzer-Installation wird die 32-Bit-Version in "% LocalAppData% \\ programs \\ *ISV Name* \\ *Application Name* x86" gespeichert, \\ und die 64-Bit-Version wird unter "% LocalAppData% \\ programs \\ *ISV Name* \\ *Application Name* \\ x64" installiert.
-   Speichern Sie benutzerspezifische Konfigurationsdaten für die Anwendung unter \\ Benutzer \\ *Benutzername* \\ AppData.
-   Speichert Vorlagen und Dateien, die von der Anwendung generiert wurden, in Unterordnern unter \\ Benutzer \\ *Benutzername*.
-   Wenn Ihre Anwendung Shellerweiterungen verwendet, sollten Sie die pro Benutzer fähigen [shellerweiterbarkeits](https://msdn.microsoft.com/library/bb762762.aspx) Punkte verwenden, die ab Windows 7 oder Windows Server 2008 R2 verfügbar sind.
-   Verwenden Sie keine benutzerdefinierten Aktionen in Ihrem Paket, für die eine Rechte Erweiterung erforderlich ist. Die Tabelle " [CustomAction](customaction-table.md) " sollte keine benutzerdefinierten Aktionen enthalten, die mit erhöhten Rechten ausgeführt werden. Weitere Informationen zu erweiterten benutzerdefinierten Aktionen finden Sie unter [Sicherheit für benutzerdefinierte](custom-action-security.md)Aktionen.
-   Schreiben Sie keinen globalen Systemordner. Die [Verzeichnis](directory-table.md) Tabelle sollte keinen Verweis auf die folgenden Eigenschaften des System Ordners enthalten.

    <dl>

[**Ordner "admintools"**](admintoolsfolder.md)  
    [**Commonappdatafolder**](commonappdatafolder.md)  
    [**Fonsordner**](fontsfolder.md)  
    [**System16Folder**](system16folder.md)  
    [**System64Folder**](system64folder.md)  
    [**Systemordner**](systemfolder.md)  
    [**TempFolder**](tempfolder.md)  
    [**Verzeichnis Windows befinden**](windowsfolder.md)  
    [**Windows Volume**](windowsvolume.md)  
    </dl>

-   Installieren Sie keine Common Language Runtime-Assembly im globalen Assemblycache (GAC). Weitere Informationen zum Installieren von Assemblys im globalen Assemblycache finden Sie unter [Hinzufügen](adding-assemblies-to-a-package.md) von Assemblys zu Paketen und installieren [von Common Language Runtime](installation-of-common-language-runtime-assemblies.md)-Assemblys
-   Installieren Sie keine ODBC-Datenquellen. Verwenden Sie die [ODBCDatasource](odbcdatasource-table.md) -Tabelle nicht, um eine Datenquelle zu installieren.
-   Installieren Sie keine Dienste. Verwenden Sie die Tabelle [servicabstall](serviceinstall-table.md) nicht, um einen Dienst zu installieren.

## <a name="example"></a>Beispiel

Ein Beispiel für ein Paket mit zwei Zweck wird in den [Windows SDK Komponenten für Windows Installer Entwickler](platform-sdk-components-for-windows-installer-developers.md) als Datei PUASample1.msi bereitgestellt. Wenn Sie über das aktuelle SDK verfügen, haben Sie Zugriff auf alle Tools und Daten, die für die Reproduktion des Beispiel Installationspakets erforderlich sind. Weitere Informationen zu diesem Beispiel finden Sie unter [Beispiel für die Erstellung eines einzelnen Pakets](single-package-authoring-example.md).

 

 
