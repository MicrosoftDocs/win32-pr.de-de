---
description: In diesem Abschnitt wird beschrieben, wie Sie CAB-Dateien in Installationen einschließen Weitere Informationen finden Sie unter Verwenden von Schränken und komprimierten Quellen.
ms.assetid: 17ea7f76-90b2-48fb-8187-64dc6d294443
title: Einschließen einer CAB-Datei in eine Installation
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 098e660de3f7ec7097ab02613d75219ac0a0d624
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106356677"
---
# <a name="including-a-cabinet-file-in-an-installation"></a><span data-ttu-id="ed6ad-104">Einschließen einer CAB-Datei in eine Installation</span><span class="sxs-lookup"><span data-stu-id="ed6ad-104">Including a Cabinet File in an Installation</span></span>

<span data-ttu-id="ed6ad-105">In diesem Abschnitt wird beschrieben, wie Sie CAB-Dateien in Installationen einschließen</span><span class="sxs-lookup"><span data-stu-id="ed6ad-105">This section describes including cabinet files in installations.</span></span> <span data-ttu-id="ed6ad-106">Weitere Informationen finden Sie unter [Verwenden von Schränken und komprimierten Quellen](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="ed6ad-106">For more information, see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>

<span data-ttu-id="ed6ad-107">**So schließen Sie eine CAB-Datei in ein Installationspaket ein**</span><span class="sxs-lookup"><span data-stu-id="ed6ad-107">**To include a cabinet file in a installation package**</span></span>

1.  <span data-ttu-id="ed6ad-108">Verwenden Sie ein CAB-Erstellungs Tool, um die Quelldateien in eine CAB-Datei zu komprimieren.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-108">Use a cabinet creation tool to compress the source files into a cabinet file.</span></span> <span data-ttu-id="ed6ad-109">Siehe CAB- [Dateien](cabinet-files.md).</span><span class="sxs-lookup"><span data-stu-id="ed6ad-109">See [Cabinet Files](cabinet-files.md).</span></span>
2.  <span data-ttu-id="ed6ad-110">Die CAB-Datei muss sich entweder in einem Datenstream innerhalb der MSI-Datei oder in einer separaten CAB-Datei befinden, die sich im Stammverzeichnis der Quell Struktur befindet, die von der [Verzeichnis Tabelle](directory-table.md)angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-110">The cabinet file must either be located in a data stream inside the .msi file or in a separate cabinet file located at the root of the source tree specified by the [Directory Table](directory-table.md).</span></span>
3.  <span data-ttu-id="ed6ad-111">Bestimmen Sie, ob die Quelle ein komprimierter Typ oder ein gemischter Typ sein soll, der sowohl nicht komprimierte als auch komprimierte Dateien aufweist.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-111">Determine whether the source is to be a compressed type or a mixed type that has both uncompressed and compressed files.</span></span> <span data-ttu-id="ed6ad-112">Siehe [komprimierte und nicht komprimierte Quellen](compressed-and-uncompressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="ed6ad-112">See [Compressed and Uncompressed Sources](compressed-and-uncompressed-sources.md).</span></span> <span data-ttu-id="ed6ad-113">Legen Sie abhängig vom Typ des Quell Bilds die komprimierten oder unkomprimierten Flag-Bits der " [**Wort count Summary**](word-count-summary.md) "-Eigenschaft fest.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-113">Depending on the type of source image, set the compressed or uncompressed flag bits of the [**Word Count Summary**](word-count-summary.md) Property.</span></span>
4.  <span data-ttu-id="ed6ad-114">Fügen Sie der [Dateitabelle](file-table.md) einen Datensatz für jede der Dateien in der CAB-Datei hinzu.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-114">Add a record to the [File table](file-table.md) for each of the files in the cabinet.</span></span> <span data-ttu-id="ed6ad-115">Geben Sie einen Datei Schlüssel in die Datei Spalte ein, der exakt mit dem Datei Schlüssel der Datei in der CAB-Datei übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-115">Enter a file key in the File column that exactly matches the file key of the file in the cabinet.</span></span> <span data-ttu-id="ed6ad-116">Bei den Datei Schlüsseln wird Groß-/Kleinschreibung beachtet.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-116">The file keys are case-sensitive.</span></span> <span data-ttu-id="ed6ad-117">Die Datei Installations Sequenz in der Dateitabelle und der CAB-Datei müssen ebenfalls identisch sein.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-117">The file installation sequence in the File table and the cabinet must also be the same.</span></span> <span data-ttu-id="ed6ad-118">Die Datei Sequenz wird durch die Sequenznummer in der Sequence-Spalte angegeben.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-118">The file sequence is specified by the sequence number in the Sequence column.</span></span> <span data-ttu-id="ed6ad-119">Gehen Sie folgendermaßen vor, um die Sequenznummer für die erste Datei in der CAB-Datei zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-119">To arrive at the sequence number for the first file in the cabinet, do the following.</span></span> <span data-ttu-id="ed6ad-120">Suchen Sie den vorhandenen Datensatz in der [Medien Tabelle](media-table.md) mit dem größten Wert in der DiskId-Spalte.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-120">Find the existing record in the [Media table](media-table.md) having the greatest value in the DiskID column.</span></span> <span data-ttu-id="ed6ad-121">Das LastSequence-Feld dieses Datensatzes gibt die letzte Datei Sequenznummer an, die auf dem Medium verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-121">The LastSequence field of this record gives the last file sequence number used on the media.</span></span> <span data-ttu-id="ed6ad-122">Weisen Sie der Dateitabelle die erste Datei der neuen CAB-Datei eine Sequenznummer zu, die größer ist als die.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-122">In the File table, assign the first file of the new cabinet a sequence number that is greater than this.</span></span> <span data-ttu-id="ed6ad-123">Weisen Sie allen verbleibenden Dateien Sequenznummern in derselben Reihenfolge wie in der CAB-Datei zu.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-123">Assign sequence numbers to all of the remaining files in the same order as in the cabinet file.</span></span> <span data-ttu-id="ed6ad-124">Eine Beschreibung der restlichen Daten Satz Felder finden Sie unter [File Table](file-table.md).</span><span class="sxs-lookup"><span data-stu-id="ed6ad-124">For a description of the remaining record fields, see [File table](file-table.md).</span></span>
5.  <span data-ttu-id="ed6ad-125">Fügen Sie der [Medien Tabelle](media-table.md) für den Schrank einen Datensatz hinzu.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-125">Add a record to the [Media table](media-table.md) for the cabinet.</span></span> <span data-ttu-id="ed6ad-126">Geben Sie einen Wert im Feld DiskId dieses neuen Datensatzes an, der größer ist als der größte bereits in der Tabelle vorhandene DiskId-Wert.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-126">Specify a value in the DiskID field of this new record that is greater than the largest DiskID value already existing in the table.</span></span> <span data-ttu-id="ed6ad-127">Fügen Sie den Namen der CAB-Ausgabe in das CAB-Feld ein.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-127">Put the name of the cabinet into the Cabinet field.</span></span> <span data-ttu-id="ed6ad-128">Dieser Name muss in [Form eines CAB-](cabinet.md) Datentyps vorliegen.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-128">This name must be in the form of a [Cabinet](cabinet.md) data type.</span></span> <span data-ttu-id="ed6ad-129">Stellen Sie dem Namen das Nummern Zeichen "" als Präfix voran, \# Wenn die CAB-Datei ein in der MSI-Datei gespeichertes Datenstream ist.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-129">Prefix the name with a number sign "\#" if the cabinet is a data stream stored in the .msi file.</span></span> <span data-ttu-id="ed6ad-130">Beachten Sie, dass bei einem Datenstrom bei der CAB-Datei die Groß-/Kleinschreibung beachtet wird.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-130">Note that if the cabinet is a data stream, the name of the cabinet is case-sensitive.</span></span> <span data-ttu-id="ed6ad-131">Wenn die CAB-Datei eine separate Datei ist, wird bei dem Namen der Datei nicht zwischen Groß-und Kleinschreibung unterschieden.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-131">If the cabinet is a separate file, the name of the file is not case-sensitive.</span></span>
6.  <span data-ttu-id="ed6ad-132">Bestimmen Sie die größte Datei Sequenznummer in der neuen CAB-Datei, indem Sie die Sequence-Spalte der aktualisierten Dateitabelle überprüfen.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-132">Determine the greatest file sequence number in the new cabinet by checking the Sequence column of the updated File table.</span></span> <span data-ttu-id="ed6ad-133">Geben Sie einen Wert ein, der größer als der Wert für das LastSequence-Feld des neuen Datensatzes der Medien Tabelle ist.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-133">Enter a value that is greater than this into the LastSequence field of the new record of the Media table.</span></span> <span data-ttu-id="ed6ad-134">Eine Beschreibung der restlichen Daten Satz Felder finden Sie unter [Media Table](media-table.md).</span><span class="sxs-lookup"><span data-stu-id="ed6ad-134">For a description of the remaining record fields, see [Media table](media-table.md).</span></span>
7.  <span data-ttu-id="ed6ad-135">Sie können die CAB-Datei im Installationspaket speichern, indem Sie entweder ein Tool wie Msidb.exe oder die [Datenbankfunktionen](database-functions.md)des Installers verwenden.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-135">You can store the cabinet file in the installation package either by using a tool such as Msidb.exe or by using the installer's [Database Functions](database-functions.md).</span></span> <span data-ttu-id="ed6ad-136">In den folgenden vier Schritten wird erläutert, wie Sie die CAB-Dateien mithilfe der-Datenbankfunktionen aus einem Programm hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-136">The following four steps explain how to add the cabinet from a program by using the database functions.</span></span>
8.  <span data-ttu-id="ed6ad-137">Um die CAB-Datei aus einem Programm zum Installationspaket hinzuzufügen, öffnen Sie mithilfe von [**msidatabaseopenview**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa)eine Ansicht in der [ \_ Streams-Tabelle](-streams-table.md) der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-137">To add the cabinet to the installation package from a program open a view on the [\_Streams table](-streams-table.md) of the database using [**MsiDatabaseOpenView**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa).</span></span>
9.  <span data-ttu-id="ed6ad-138">Verwenden Sie [**msirecordsetstring**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) , um die Name-Spalte der \_ Streams-Tabelle auf den Namen festzulegen, der in der CAB-Spalte der [Medien Tabelle](media-table.md)angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-138">Use [**MsiRecordSetString**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) to set the Name column of the \_Streams table to the name appearing in the Cabinet column of the [Media table](media-table.md).</span></span> <span data-ttu-id="ed6ad-139">Lassen Sie das Nummern Zeichen aus: \# .</span><span class="sxs-lookup"><span data-stu-id="ed6ad-139">Omit the number sign: \#.</span></span>
10. <span data-ttu-id="ed6ad-140">Verwenden Sie [**msirecordsetstream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) , um die Datenspalte der \_ Streams-Tabelle auf die Daten der CAB-Datei festzulegen.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-140">Use [**MsiRecordSetStream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) to set the Data column of the \_Streams table to the cabinet's data.</span></span>
11. <span data-ttu-id="ed6ad-141">Verwenden Sie [**msiviewmodify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) , um den Datensatz in der Streams-Tabelle zu aktualisieren \_ .</span><span class="sxs-lookup"><span data-stu-id="ed6ad-141">Use [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) to update the record in the \_Streams table.</span></span>
12. <span data-ttu-id="ed6ad-142">Verwenden Sie die folgende Befehlszeile, um Msidb.exe zum Hinzufügen der CAB-Datei Mycab.cab zum Installationspaket mit dem Namen Mydatabase.msi zu verwenden: Msidb.exe-d mydatabase.msi-a mycab.cab.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-142">To use Msidb.exe to add the cabinet file Mycab.cab to the installation package named Mydatabase.msi, use the following command line: Msidb.exe -d mydatabase.msi -a mycab.cab.</span></span> <span data-ttu-id="ed6ad-143">In diesem Fall sollte die CAB-Spalte der Medien Tabelle die Zeichenfolge: \#mycab.cab enthalten.</span><span class="sxs-lookup"><span data-stu-id="ed6ad-143">In this case, the Cabinet column of the Media table should contain the string: \#mycab.cab.</span></span>

 

 



