---
description: Sie können benutzerdefinierte Aktionen, die auf Dynamic Link Libraries basieren, mithilfe von Debugtools für Windows Debuggen. Das dynamische Debuggen kann nicht mit benutzerdefinierten Aktionen auf der Grundlage von ausführbaren Dateien oder Skripts verwendet werden.
ms.assetid: 4241a27a-c127-4c65-96a2-1d655b343eba
title: Debugging von benutzerdefinierten Aktionen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9ddfbc9952f0dd7fc1b85b5c64fa6a23381ceafe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106368851"
---
# <a name="debugging-custom-actions"></a><span data-ttu-id="7238f-104">Debugging von benutzerdefinierten Aktionen</span><span class="sxs-lookup"><span data-stu-id="7238f-104">Debugging Custom Actions</span></span>

<span data-ttu-id="7238f-105">Sie können benutzerdefinierte Aktionen, die auf [Dynamic Link Libraries](dynamic-link-libraries.md) basieren, mithilfe von [Debugtools für Windows Debuggen](https://www.microsoft.com/?ref=go).</span><span class="sxs-lookup"><span data-stu-id="7238f-105">You can debug custom actions that are based on [dynamic-link libraries](dynamic-link-libraries.md) by using [Debugging Tools for Windows](https://www.microsoft.com/?ref=go).</span></span> <span data-ttu-id="7238f-106">Das dynamische Debuggen kann nicht mit benutzerdefinierten Aktionen auf der Grundlage von [ausführbaren Dateien](executable-files.md) oder [Skripts](scripts.md)verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="7238f-106">It is not possible to use dynamic debugging with custom actions based on [executable files](executable-files.md) or [scripts](scripts.md).</span></span>

<span data-ttu-id="7238f-107">Die in diesem Abschnitt beschriebenen Verfahren können Sie beim Debuggen von Windows Installer benutzerdefinierten Aktionen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="7238f-107">The techniques described in this section can help you debug Windows Installer custom actions.</span></span> <span data-ttu-id="7238f-108">Weitere Informationen zu [Debuggingtools für Windows](https://www.microsoft.com/?ref=go)finden Sie im Abschnitt Treiber Entwicklungs Tools im Windows-Treiberkit (WDK).</span><span class="sxs-lookup"><span data-stu-id="7238f-108">See the Driver Development Tools section of the Windows Driver Kit (WDK) for information about [Debugging Tools for Windows](https://www.microsoft.com/?ref=go).</span></span>

<span data-ttu-id="7238f-109">In Windows Installer wird die msibreak-Umgebungsvariable verwendet, um zu bestimmen, welche benutzerdefinierte Aktion deentschlbelt werden soll.</span><span class="sxs-lookup"><span data-stu-id="7238f-109">Windows Installer uses the MsiBreak environment variable to determine which custom action is to be debugged.</span></span> <span data-ttu-id="7238f-110">Wenn Sie Zugriff auf den Quellcode der benutzerdefinierten Aktion haben, können Sie möglicherweise das Debuggen ohne msibreak verwenden.</span><span class="sxs-lookup"><span data-stu-id="7238f-110">If you have access to the custom action's source code, you may be able to use debugging without MsiBreak.</span></span> <span data-ttu-id="7238f-111">Wenn Sie das Debuggen ohne msibreak starten möchten, legen Sie am Anfang des Aktionscodes ein temporäres Meldungs Feld ab.</span><span class="sxs-lookup"><span data-stu-id="7238f-111">To start debugging without MsiBreak, put a temporary message box at the beginning of the action's code.</span></span> <span data-ttu-id="7238f-112">Wenn das Meldungs Feld während der Installation angezeigt wird, fügen Sie den Debugger an den Prozess an, der das Meldungs Feld besitzt.</span><span class="sxs-lookup"><span data-stu-id="7238f-112">When the message box appears during the installation, attach the debugger to the process owning the message box.</span></span> <span data-ttu-id="7238f-113">Sie können dann alle notwendigen Breakpoints festlegen und das Meldungs Feld schließen, um die Ausführung fortzusetzen.</span><span class="sxs-lookup"><span data-stu-id="7238f-113">You can then set any necessary breakpoints and dismiss the message box to resume execution.</span></span> <span data-ttu-id="7238f-114">Es ist nicht möglich, die früheren Teile der benutzerdefinierten Aktion mit dieser Methode zu debuggen.</span><span class="sxs-lookup"><span data-stu-id="7238f-114">It is not possible to debug the earlier portions of the custom action by this method.</span></span>

<span data-ttu-id="7238f-115">Um die msibreak-Umgebungsvariable zum Debuggen der benutzerdefinierten Aktion zu verwenden, legen Sie msibreak auf den Namen der benutzerdefinierten Aktion in der [Tabelle CustomAction](customaction-table.md)fest.</span><span class="sxs-lookup"><span data-stu-id="7238f-115">To use the MsiBreak environment variable to debug the custom action, set MsiBreak to the custom action's name in the [CustomAction table](customaction-table.md).</span></span> <span data-ttu-id="7238f-116">Msibreak kann entweder eine System-oder eine Benutzer Umgebungsvariable sein.</span><span class="sxs-lookup"><span data-stu-id="7238f-116">MsiBreak can be either a system or a user environment variable.</span></span> <span data-ttu-id="7238f-117">Wenn die Variable als Systemvariable festgelegt wird, ist möglicherweise ein Neustart des Systems erforderlich, wenn der Wert geändert wird, um den neuen Wert zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="7238f-117">If the variable is set as a system variable, a restart of the system may be needed when the value is changed to detect the new value.</span></span>

<span data-ttu-id="7238f-118">Um die msibreak-Umgebungsvariable zum Debuggen einer eingebetteten Benutzeroberfläche zu verwenden, legen Sie den Wert von msibreak auf msiembeddedui fest.</span><span class="sxs-lookup"><span data-stu-id="7238f-118">To use the MsiBreak environment variable to debug an embedded user interface, set the value of MsiBreak to MsiEmbeddedUI.</span></span>

<span data-ttu-id="7238f-119">Windows Installer überprüft nur die msibreak-Umgebungsvariable, wenn der Benutzer ein Administrator ist.</span><span class="sxs-lookup"><span data-stu-id="7238f-119">Windows Installer only checks the MsiBreak environment variable if the user is an Administrator.</span></span> <span data-ttu-id="7238f-120">Das Installationsprogramm ignoriert den Wert von "msibreak", wenn der Benutzer kein Administrator ist, auch wenn es sich um eine [*verwaltete Anwendung*](m-gly.md)handelt.</span><span class="sxs-lookup"><span data-stu-id="7238f-120">The installer ignores the value of MsiBreak if the user is not an Administrator, even if this is a [*managed application*](m-gly.md).</span></span>

<span data-ttu-id="7238f-121">Wenn Sie eine benutzerdefinierte Aktion Debuggen, die mit erhöhten Rechten (System Berechtigungen) in der Ausführungssequenz ausgeführt wird, fügen Sie den Debugger an den Windows Installer-Dienst an.</span><span class="sxs-lookup"><span data-stu-id="7238f-121">If you are debugging a custom action that runs with elevated (system) privileges in the execution sequence, attach the debugger to the Windows Installer service.</span></span> <span data-ttu-id="7238f-122">Beim Debuggen einer benutzerdefinierten Aktion, die mit den Berechtigungen mit Identitätswechsel in der Ausführungssequenz ausgeführt wird, fordert das System ein Dialogfeld an, das angibt, welcher Prozess gedebuggt werden soll.</span><span class="sxs-lookup"><span data-stu-id="7238f-122">When debugging a custom action that runs with impersonated privileges in the execution sequence, the system prompts with a dialog box that indicates which process should be debugged.</span></span> <span data-ttu-id="7238f-123">Der Benutzer wird in einem Dialogfeld aufgefordert, den zu debuggenden Prozess anzugeben.</span><span class="sxs-lookup"><span data-stu-id="7238f-123">The user is prompted with a dialog box indicating which process to debug.</span></span> <span data-ttu-id="7238f-124">Weitere Informationen zu erweiterten benutzerdefinierten Aktionen finden Sie unter [Sicherheit für benutzerdefinierte](custom-action-security.md)Aktionen.</span><span class="sxs-lookup"><span data-stu-id="7238f-124">For more information about elevated custom actions, see [Custom Action Security](custom-action-security.md).</span></span>

<span data-ttu-id="7238f-125">Nachdem der Debugger an den korrekten Prozess angefügt wurde, löst das Installationsprogramm unmittelbar vor dem Aufrufen des Einstiegs Punkts der dll einen Debugger-Breakpoint aus.</span><span class="sxs-lookup"><span data-stu-id="7238f-125">Once the debugger has been attached to the correct process, the installer triggers a debugger breakpoint immediately before calling the entry point of the DLL.</span></span> <span data-ttu-id="7238f-126">Am Haltepunkt ist die DLL bereits in den Prozess geladen und die Einstiegspunkt Adresse wurde festgelegt.</span><span class="sxs-lookup"><span data-stu-id="7238f-126">At the breakpoint, your DLL is already loaded into the process and the entry point address determined.</span></span> <span data-ttu-id="7238f-127">Wenn die DLL für die benutzerdefinierte Aktion nicht geladen werden konnte oder der Einstiegspunkt für die benutzerdefinierte Aktion nicht vorhanden ist, wird kein Haltepunkt ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="7238f-127">If your custom action DLL could not be loaded or the custom action entry point did not exist, no breakpoint is triggered.</span></span> <span data-ttu-id="7238f-128">Da der Haltepunkt vor dem Aufrufen der DLL-Funktion ausgelöst wird, sollten Sie nach dem Auslösen des Breakpoints den Debugger verwenden, um den Schritt fortzusetzen, bis der Einstiegspunkt für die benutzerdefinierte Aktion aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7238f-128">Because the breakpoint is triggered before calling the DLL function, once the breakpoint has been triggered you should use your debugger to step forward until your custom action entry point is called.</span></span> <span data-ttu-id="7238f-129">Alternativ können Sie einen Haltepunkt an einer beliebigen Stelle in der benutzerdefinierten Aktion festlegen und die normale Ausführung fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="7238f-129">Alternately, you can set a breakpoint anywhere in your custom action and resume normal execution.</span></span>

<span data-ttu-id="7238f-130">Der Windows Installer führt DLLs aus, die nicht direkt aus dem dll-Speicherort in der [binären Tabelle](binary-table.md) gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="7238f-130">The Windows Installer executes DLLs not stored in the [Binary table](binary-table.md) directly from the DLL location.</span></span> <span data-ttu-id="7238f-131">Das Installationsprogramm kennt den ursprünglichen Namen einer in der binären Tabelle gespeicherten dll nicht und führt die benutzerdefinierte DLL-Aktion unter einem temporären Dateinamen aus.</span><span class="sxs-lookup"><span data-stu-id="7238f-131">The installer does not know the original name of a DLL stored in the Binary table and runs the DLL custom action under a temporary file name.</span></span> <span data-ttu-id="7238f-132">Die Form des temporären Datei namens lautet MSI-?????. TMP.</span><span class="sxs-lookup"><span data-stu-id="7238f-132">The form of the temporary file name is MSI?????.TMP.</span></span> <span data-ttu-id="7238f-133">Unter Windows XP wird diese temporäre Datei an einem sicheren Speicherort gespeichert, üblicherweise im <WindowFolder> \\ Installationsprogramm.</span><span class="sxs-lookup"><span data-stu-id="7238f-133">On Windows XP, this temporary file is stored in a secure location, commonly <WindowFolder>\\Installer.</span></span>

<span data-ttu-id="7238f-134">Beachten Sie, dass viele DLLs, die für das Debuggen erstellt wurden, den Namen und den Pfad der entsprechenden PDB-Datei als Teil der DLL selbst enthalten.</span><span class="sxs-lookup"><span data-stu-id="7238f-134">Note that many DLLs created for debugging contain the name and path of the corresponding PDB file as part of the DLL itself.</span></span> <span data-ttu-id="7238f-135">Beim Debuggen dieses dll-Typs in einem System, auf dem sich die PDB an dem Speicherort befindet, der in der dll gespeichert ist, können Symbole automatisch vom debuggertool geladen werden.</span><span class="sxs-lookup"><span data-stu-id="7238f-135">When debugging this type of DLL on a system where the PDB can be found at the location stored in the DLL, symbols may be loaded automatically by the debugger tool.</span></span> <span data-ttu-id="7238f-136">In Fällen, in denen die PDB an der gespeicherten Position nicht gefunden werden kann, in der der Debugger das Laden von Symbolen aus dem gespeicherten Speicherort nicht unterstützt, oder wenn die dll nicht mit Debuginformationen erstellt wurde, müssen Sie Ihre Symbol Dateien möglicherweise mit der temporären dll-Datei im Ordner platzieren.</span><span class="sxs-lookup"><span data-stu-id="7238f-136">In situations where the PDB cannot be found at the stored location, where the debugger does not support loading symbols from the stored location, or where the DLL was not built with debugging information, you may need to place your symbol files in the folder with the temporary DLL file.</span></span>

<span data-ttu-id="7238f-137">Das Installationsprogramm fügt der Installationsprotokoll Datei Debuginformationen für benutzerdefinierte Aktions Skripts hinzu.</span><span class="sxs-lookup"><span data-stu-id="7238f-137">The installer adds debugging information for custom action scripts to the installation log file.</span></span>

``` syntax
There is a problem with this Windows Installer package. A script 
required for this install to complete could not be run. Contact your 
support personnel or package vendor.  {Custom action [2] script error 
[3], [4]: [5] Line [6], Column [7], [8] }
```

 

 



