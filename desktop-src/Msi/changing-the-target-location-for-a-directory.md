---
description: Wenn möglich, ist die beste Möglichkeit zum Angeben des Zielspeicher Orts für ein Verzeichnis das Erstellen der Verzeichnis Tabelle in Ihrem Installationspaket, um den richtigen Speicherort bereitzustellen. Weitere Informationen finden Sie unter Verwenden der Verzeichnis Tabelle.
ms.assetid: 2d16e036-2d7f-431d-b646-1addf2f65f3f
title: Ändern des Zielspeicher Orts für ein Verzeichnis
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 818c4e9d555244dd1637e19eb249478f13ea2d48
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104215705"
---
# <a name="changing-the-target-location-for-a-directory"></a><span data-ttu-id="04bf0-104">Ändern des Zielspeicher Orts für ein Verzeichnis</span><span class="sxs-lookup"><span data-stu-id="04bf0-104">Changing the Target Location for a Directory</span></span>

<span data-ttu-id="04bf0-105">Wenn möglich, ist die beste Möglichkeit zum Angeben des Zielspeicher Orts für ein Verzeichnis das Erstellen der [Verzeichnis Tabelle](directory-table.md) in Ihrem Installationspaket, um den richtigen Speicherort bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="04bf0-105">If possible, the best way to specify the target location for a directory is to author the [Directory Table](directory-table.md) in your installation package to provide the correct location.</span></span> <span data-ttu-id="04bf0-106">Weitere Informationen finden Sie unter [Verwenden der Verzeichnis Tabelle](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="04bf0-106">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>

<span data-ttu-id="04bf0-107">Wenn Sie den Speicherort des Verzeichnisses zum Zeitpunkt der Installation ändern müssen, haben Sie folgende Möglichkeiten:</span><span class="sxs-lookup"><span data-stu-id="04bf0-107">If you need to change the directory location at the time of the installation, you have the following options:</span></span>

-   <span data-ttu-id="04bf0-108">Geben Sie den Speicherort eines Verzeichnisses an, indem Sie den Wert einer [öffentlichen Eigenschaft](public-properties.md) in der Befehlszeile festlegen.</span><span class="sxs-lookup"><span data-stu-id="04bf0-108">Specify the location of a directory by setting the value of a [Public Property](public-properties.md) on the command line.</span></span> <span data-ttu-id="04bf0-109">Während der [costfinalize-Aktion](costfinalize-action.md)werden die vom Installationsprogramm verwendeten internen Verzeichnispfade auf den Wert der Eigenschaften aktualisiert, die in der [Verzeichnis Tabelle](directory-table.md)als Schlüssel aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="04bf0-109">During the [CostFinalize Action](costfinalize-action.md), the internal directory paths used by the installer are updated to the value of properties listed as keys in the [Directory Table](directory-table.md).</span></span> <span data-ttu-id="04bf0-110">Weitere Informationen finden Sie unter [Verwenden von Eigenschaften](using-properties.md) und [Festlegen von Werten für öffentliche Eigenschaften in der Befehlszeile](setting-public-property-values-on-the-command-line.md).</span><span class="sxs-lookup"><span data-stu-id="04bf0-110">For more information, see [Using Properties](using-properties.md) and [Setting Public Property Values on the Command Line](setting-public-property-values-on-the-command-line.md).</span></span>
-   <span data-ttu-id="04bf0-111">Geben Sie den Speicherort eines Verzeichnisses mithilfe einer benutzerdefinierten Aktion an.</span><span class="sxs-lookup"><span data-stu-id="04bf0-111">Specify the location of a directory by using a custom action.</span></span> <span data-ttu-id="04bf0-112">Wenn die benutzerdefinierte Aktion vor der [costfinalize-Aktion](costfinalize-action.md)ausgeführt werden soll, können Sie einen [benutzerdefinierten Aktionstyp 51](custom-action-type-51.md) verwenden, um den Wert einer Eigenschaft aus einer formatierten Text Zeichenfolge festzulegen.</span><span class="sxs-lookup"><span data-stu-id="04bf0-112">If the custom action is to run before the [CostFinalize Action](costfinalize-action.md), you can use a [Custom Action Type 51](custom-action-type-51.md) to set the value of a property from a formatted text string.</span></span> <span data-ttu-id="04bf0-113">Wenn die benutzerdefinierte Aktion nach der [costfinalize-Aktion](costfinalize-action.md)ausgeführt wird, können Sie einen [benutzerdefinierten Aktionstyp 35](custom-action-type-35.md) verwenden, um den Wert des Verzeichnis Pfads aus einer formatierten Text Zeichenfolge festzulegen.</span><span class="sxs-lookup"><span data-stu-id="04bf0-113">If the custom action runs after the [CostFinalize Action](costfinalize-action.md), you can use a [Custom Action Type 35](custom-action-type-35.md) to set the value of the directory path from a formatted text string.</span></span> <span data-ttu-id="04bf0-114">Benutzerdefinierte Aktionen, die eine der [System Ordnereigenschaften](property-reference.md) ändern, sollten sowohl in den Ausführungssequenz Tabellen ([InstallExecuteSequence-Tabelle](installexecutesequence-table.md) [*als auch*](f-gly.md) in der [AdminExecuteSequence](adminexecutesequence-table.md)-Tabelle) und in den Sequenz Tabellen der Benutzeroberfläche ("[InstallUISequence](installuisequence-table.md) [*" und "*](b-gly.md) [AdminUISequence](adminuisequence-table.md)") enthalten sein</span><span class="sxs-lookup"><span data-stu-id="04bf0-114">Custom actions that change one of the [System Folder Properties](property-reference.md) should be included in both the execution sequence tables ([InstallExecuteSequence Table](installexecutesequence-table.md) or [AdminExecuteSequence Table](adminexecutesequence-table.md)), and the user interface sequence tables ([InstallUISequence Table](installuisequence-table.md) and [AdminUISequence Table](adminuisequence-table.md)) so that the folder is changed during both [*full UI*](f-gly.md) and [*basic UI*](b-gly.md) installations.</span></span>
-   <span data-ttu-id="04bf0-115">Wenn bei der Installation eine [*vollständige Benutzeroberfläche*](f-gly.md)ausgeführt wird, können Sie den Verzeichnispfad mithilfe von " [**msisettargetpath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) " oder " [settargetpath ControlEvent](settargetpath-controlevent.md) " festlegen.</span><span class="sxs-lookup"><span data-stu-id="04bf0-115">If the installation is running a [*full UI*](f-gly.md), you can use [**MsiSetTargetPath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) or the [SetTargetPath ControlEvent](settargetpath-controlevent.md) to set the directory path.</span></span> <span data-ttu-id="04bf0-116">Überprüfen Sie die Eigenschaft [**productstate**](productstate.md) , um zu bestimmen, ob das Produkt, das diese Komponente enthält, bereits installiert ist, bevor Sie **msisettargetpath** oder settargetpath ControlEvent aufrufen.</span><span class="sxs-lookup"><span data-stu-id="04bf0-116">Check the [**ProductState**](productstate.md) Property to determine whether the product that contains this component is already installed before calling **MsiSetTargetPath** or the SetTargetPath ControlEvent.</span></span> <span data-ttu-id="04bf0-117">Versuchen Sie nicht, den Zielverzeichnis Pfad zu ändern, wenn einige Komponenten, die diesen Pfad verwenden, für den aktuellen Benutzer oder einen anderen Benutzer bereits installiert sind.</span><span class="sxs-lookup"><span data-stu-id="04bf0-117">Do not attempt to change the target directory path if some components that use that path are already installed for the current user or a different user.</span></span>

<span data-ttu-id="04bf0-118">Für alle oben genannten Optionen gelten die folgenden Einschränkungen:</span><span class="sxs-lookup"><span data-stu-id="04bf0-118">The following restrictions apply to all of the above options:</span></span>

-   <span data-ttu-id="04bf0-119">Versuchen Sie nicht, den Zielverzeichnis Pfad zu ändern, wenn einige Komponenten, die den Pfad verwenden, für den aktuellen Benutzer oder für einen anderen Benutzer bereits installiert sind.</span><span class="sxs-lookup"><span data-stu-id="04bf0-119">Do not attempt to change the target directory path if some components that use the path are already installed for the current user or for a different user.</span></span>
-   <span data-ttu-id="04bf0-120">Versuchen Sie nicht, den Zielverzeichnis Pfad während einer [Wartungs Installation](maintenance-installation.md)zu ändern.</span><span class="sxs-lookup"><span data-stu-id="04bf0-120">Do not attempt to change the target directory path during a [Maintenance Installation](maintenance-installation.md).</span></span>

 

 



