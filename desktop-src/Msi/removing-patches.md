---
description: Ab Windows Installer&\# 160; Version&\# 160; 3.0 ist es möglich, Patches zu erstellen und zu installieren, die einzeln und in beliebiger Reihenfolge deinstalliert werden können, ohne die gesamte Anwendung und andere Patches deinstallieren und neu installieren zu müssen.
ms.assetid: 2ad30ac9-eac9-49cf-98ae-5c053a0b500a
title: Entfernen von Patches
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7cd54db3bde3a356a0c3adb299555248bbc87a0b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106358992"
---
# <a name="removing-patches"></a><span data-ttu-id="718dc-103">Entfernen von Patches</span><span class="sxs-lookup"><span data-stu-id="718dc-103">Removing Patches</span></span>

<span data-ttu-id="718dc-104">Ab Windows Installer Version 3,0 ist es möglich, Patches zu erstellen und zu installieren, die einzeln und in beliebiger Reihenfolge deinstalliert werden können, ohne die gesamte Anwendung und andere Patches deinstallieren und neu installieren zu müssen.</span><span class="sxs-lookup"><span data-stu-id="718dc-104">Beginning with Windows Installer version 3.0, it is possible to create and install patches that can be uninstalled singly, and in any order, without having to uninstall and reinstall the entire application and other patches.</span></span> <span data-ttu-id="718dc-105">Windows Installer 3,0 ermöglicht außerdem die Erstellung von [patchpaketen](patch-packages.md) mit einer [msipatchsequence-Tabelle](msipatchsequence-table.md) , die Informationen zur Patchsequenzierung enthält.</span><span class="sxs-lookup"><span data-stu-id="718dc-105">Windows Installer 3.0 also enables [Patch Packages](patch-packages.md) to be authored with a [MsiPatchSequence Table](msipatchsequence-table.md) that contains patch sequencing information.</span></span> <span data-ttu-id="718dc-106">Bei Versionen Windows Installer von, die älter sind als Windows Installer 3,0, besteht die einzige Möglichkeit, bestimmte Patches aus einer Anwendung zu entfernen, darin, die gesamte gepatchte Anwendung zu deinstallieren und dann erneut zu installieren, ohne die zu entfernenden Patches erneut anzuwenden</span><span class="sxs-lookup"><span data-stu-id="718dc-106">With versions of Windows Installer earlier than Windows Installer 3.0, the only method to remove particular patches from an application is to uninstall the entire patched application and then reinstall without reapplying any patches being removed.</span></span>

<span data-ttu-id="718dc-107">Ob ein Patch deinstalliert werden kann, hängt davon ab, wie der Patch erstellt wurde, der Version von Windows Installer, die zur Installation des Patches verwendet wurde, und der Änderungen, die vom Patch an der Anwendung vorgenommen wurden.</span><span class="sxs-lookup"><span data-stu-id="718dc-107">Whether a patch can be uninstalled depends upon how the patch was authored, the version of Windows Installer used to install the patch, and the changes made by the patch to the application.</span></span> <span data-ttu-id="718dc-108">Wenn ein Patch nicht deinstalliert werden kann, besteht die einzige Möglichkeit zum Entfernen des Patches darin, die gesamte Anwendung zu deinstallieren und neu zu installieren, ohne dass der zu entfernende Patch angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="718dc-108">If a patch is not uninstallable, then the only way to remove the patch is to uninstall the entire application and reinstall without applying the patch being removed.</span></span>

<span data-ttu-id="718dc-109">Sie können ein oder mehrere Patches mithilfe der Befehlszeilenoption, der Skript Schnittstelle oder durch Aufrufen von [**msiremovepatches**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) aus einer anderen Anwendung deinstallieren.</span><span class="sxs-lookup"><span data-stu-id="718dc-109">You can uninstall one or more patches using a command line option, the scripting interface, or by calling [**MsiRemovePatches**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) from another application.</span></span> <span data-ttu-id="718dc-110">Weitere Informationen zum Deinstallieren von Patches finden Sie unter Deinstallieren von [Patches](uninstalling-patches.md) .</span><span class="sxs-lookup"><span data-stu-id="718dc-110">See [Uninstalling Patches](uninstalling-patches.md) for more information about how to uninstall patches.</span></span>

<span data-ttu-id="718dc-111">Der Wert der Eigenschaft [**msipatchremove**](msipatchremove.md) listet die zu entfernenden Patches auf.</span><span class="sxs-lookup"><span data-stu-id="718dc-111">The value of the [**MSIPATCHREMOVE**](msipatchremove.md) property lists the patches to be uninstalled.</span></span> <span data-ttu-id="718dc-112">Für jeden Patch in der Liste überprüft das Installationsprogramm, ob der Patch nicht installiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="718dc-112">For each patch in the list, the installer verifies that the patch is uninstallable.</span></span> <span data-ttu-id="718dc-113">Wenn der Benutzer nicht über Berechtigungen zum Entfernen des Patches verfügt, ist der Patch für das Produkt unbekannt, die patchrichtlinie verhindert das Entfernen, oder der Patch wurde als nicht deinstallable gekennzeichnet. der Installer gibt einen Fehler zurück, der auf eine fehlgeschlagene Installations Transaktion hinweist.</span><span class="sxs-lookup"><span data-stu-id="718dc-113">If the user does not have privileges to remove the patch, the patch is unknown for the product, patch policy prevents removal, or the patch was marked as not uninstallable, the installer returns an error that indicates a failed installation transaction.</span></span> <span data-ttu-id="718dc-114">Weitere Informationen zu den Informationen, die bestimmen, ob ein Patch nicht installiert werden kann, finden Sie unter [nicht installierbare Patches](uninstallable-patches.md) .</span><span class="sxs-lookup"><span data-stu-id="718dc-114">See [Uninstallable Patches](uninstallable-patches.md) for more information about what determines whether a patch is not uninstallable.</span></span>

<span data-ttu-id="718dc-115">Nachdem der Patch als Wechsel Datenträger überprüft wurde, entfernt das Installationsprogramm den Patch aus der Patch-Anwendungs Sequenz.</span><span class="sxs-lookup"><span data-stu-id="718dc-115">Once the patch is verified as removable, the installer removes the patch from the patch application sequence.</span></span> <span data-ttu-id="718dc-116">Weitere Informationen darüber, wie Windows Installer 3,0 bestimmt, welche Sequenz beim Anwenden von Patches verwendet werden soll, finden Sie unter [Sequenzieren von Patches](sequencing-patches.md).</span><span class="sxs-lookup"><span data-stu-id="718dc-116">For more information about how Windows Installer 3.0 determines what sequence to use when applying patches see [Sequencing Patches](sequencing-patches.md).</span></span> <span data-ttu-id="718dc-117">Beachten Sie, dass das Entfernen von Patches aus der Sequenz dazu führen kann, dass Patches als veraltet markiert oder ersetzt werden.</span><span class="sxs-lookup"><span data-stu-id="718dc-117">Note that removing patches from the sequence can cause patches marked obsolete or superseded to become active.</span></span>

<span data-ttu-id="718dc-118">Alle Patches, die zum Entfernen ausgewählt wurden, werden in der [**msipatchremovallist**](msipatchremovallist.md) -Eigenschaft aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="718dc-118">All patches selected for removal are listed in the [**MsiPatchRemovalList**](msipatchremovallist.md) property.</span></span> <span data-ttu-id="718dc-119">Diese Eigenschaft ist eine private Eigenschaft, die vom Installationsprogramm festgelegt und in bedingten Ausdrücken verwendet oder durch [benutzerdefinierte Aktionen](custom-actions.md)abgefragt werden kann.</span><span class="sxs-lookup"><span data-stu-id="718dc-119">This property is a private property that is set by the installer and can be used in conditional expressions or queried by [custom actions](custom-actions.md).</span></span> <span data-ttu-id="718dc-120">Die-Eigenschaft enthält die Liste der Patch-Code-GUIDs von Patches, die entfernt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="718dc-120">The property contains the list of patch code GUIDs of patches to be removed.</span></span> <span data-ttu-id="718dc-121">Eine benutzerdefinierte Aktion kann ermitteln, ob der Installationsstatus des Patches angewendet, veraltet oder ersetzt wird, indem die [**msigetpatchinfoex**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) -Eigenschaft oder die [**patchproperty**](patch-patchproperty.md) -Eigenschaft des [Patch-Objekts](patch-object.md)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="718dc-121">A custom action can determine whether the installation state of the patch is applied, obsolete or superseded by calling the [**MsiGetPatchInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) or the [**PatchProperty**](patch-patchproperty.md) property of the [Patch Object](patch-object.md).</span></span>

<span data-ttu-id="718dc-122">Nachdem ein Patch entfernt wurde, ist der Status der Anwendung identisch mit dem Zeitpunkt, an dem der Patch nie installiert wurde.</span><span class="sxs-lookup"><span data-stu-id="718dc-122">After a patch is removed the state of the application is the same as if the patch was never installed.</span></span> <span data-ttu-id="718dc-123">Wenn möglich, schränkt der Installer den Prozess auf die Teilmenge der Features ein, die von dem zu entfernenden Patch betroffen sind.</span><span class="sxs-lookup"><span data-stu-id="718dc-123">If possible, the installer restricts the process to the subset of features affected by the patch being removed.</span></span> <span data-ttu-id="718dc-124">Das Installationsprogramm legt die Eigenschaft [**neu installieren**](reinstall.md) automatisch auf die Liste der betroffenen Features fest.</span><span class="sxs-lookup"><span data-stu-id="718dc-124">The installer automatically sets the [**REINSTALL**](reinstall.md) property to the list of affected features.</span></span> <span data-ttu-id="718dc-125">Dateien, die vom Patch hinzugefügt wurden, werden entfernt, und Dateien, die vom Patch geändert wurden, werden überschrieben.</span><span class="sxs-lookup"><span data-stu-id="718dc-125">Files that were added by the patch are removed and files that were modified by the patch are overwritten.</span></span> <span data-ttu-id="718dc-126">Dateien und Registrierungseinträge werden in der Version wieder hergestellt, die vom Produkt abzüglich des Patches erwartet wird.</span><span class="sxs-lookup"><span data-stu-id="718dc-126">Files and registry entries are restored to the version expected by the product minus the patch.</span></span> <span data-ttu-id="718dc-127">Die Registrierung von Features und Komponenten, die vom Patch hinzugefügt wurden, wird in der Anwendung aufgehoben.</span><span class="sxs-lookup"><span data-stu-id="718dc-127">Features and components that were added by the patch are unregistered from the application.</span></span> <span data-ttu-id="718dc-128">Beachten Sie, dass zusätzliche Inhalte, die vom Patch hinzugefügt werden, auf dem Computer des Benutzers verbleiben können, wenn der Inhalt von einem anderen Patch verwendet wird, der weiterhin anwendbar ist.</span><span class="sxs-lookup"><span data-stu-id="718dc-128">Note that additional content added by the patch can remain on the user's computer if the content is used by another patch that is still applicable.</span></span>

<span data-ttu-id="718dc-129">Wenn eine Datei einer freigegebenen Komponente durch einen Patch aktualisiert wird, wirkt sich diese Änderung auf alle Anwendungen aus, die die Komponente gemeinsam verwenden.</span><span class="sxs-lookup"><span data-stu-id="718dc-129">If a file of a shared component is updated by a patch, the change affects all applications that share the component.</span></span> <span data-ttu-id="718dc-130">Wenn der Patch entfernt wird, wirkt sich die Änderung erneut auf alle Anwendungen aus, die die Komponente gemeinsam verwenden.</span><span class="sxs-lookup"><span data-stu-id="718dc-130">When the patch is removed, again, the change affects all applications that share the component.</span></span> <span data-ttu-id="718dc-131">Dies bedeutet, dass durch das Entfernen eines Patches durch eine Anwendung die Datei der freigegebenen Komponente in einer niedrigeren Version wieder hergestellt werden kann, als von einer anderen Anwendung benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="718dc-131">This means that removal of a patch by one application can restore the file of the shared component to a lower version than required by another application.</span></span> <span data-ttu-id="718dc-132">Dadurch kann die erste Anwendung behoben werden, aber die zweite Anwendung funktioniert nicht mehr.</span><span class="sxs-lookup"><span data-stu-id="718dc-132">This could fix the first application, but cause the second application to stop working.</span></span> <span data-ttu-id="718dc-133">In diesem Fall kann die zweite Anwendung repariert werden, indem Sie die zweite Anwendung mithilfe der Methoden, die in [Neuinstallation eines Features oder einer Anwendung](reinstalling-a-feature-or-application.md)beschrieben werden, neu installieren.</span><span class="sxs-lookup"><span data-stu-id="718dc-133">In this case, the second application can be repaired by reinstalling the second application using the methods describe in [Reinstalling a Feature or Application](reinstalling-a-feature-or-application.md).</span></span> <span data-ttu-id="718dc-134">Dadurch wird die gepatchte Version der Datei wieder hergestellt.</span><span class="sxs-lookup"><span data-stu-id="718dc-134">This will restore the patched version of the file.</span></span>

## <a name="related-topics"></a><span data-ttu-id="718dc-135">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="718dc-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="718dc-136">**Msienumapplicationsex**</span><span class="sxs-lookup"><span data-stu-id="718dc-136">**MsiEnumapplicationsEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumproductsexa)
</dt> <dt>

[<span data-ttu-id="718dc-137">**Msigetpatchinfoex**</span><span class="sxs-lookup"><span data-stu-id="718dc-137">**MsiGetPatchInfoEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa)
</dt> <dt>

[<span data-ttu-id="718dc-138">**Msipatchremove**</span><span class="sxs-lookup"><span data-stu-id="718dc-138">**MSIPATCHREMOVE**</span></span>](msipatchremove.md)
</dt> <dt>

[<span data-ttu-id="718dc-139">**Msiremovepatches**</span><span class="sxs-lookup"><span data-stu-id="718dc-139">**MsiRemovePatches**</span></span>](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa)
</dt> <dt>

[<span data-ttu-id="718dc-140">Patchsequenzierung</span><span class="sxs-lookup"><span data-stu-id="718dc-140">Patch Sequencing</span></span>](sequencing-patches.md)
</dt> <dt>

[<span data-ttu-id="718dc-141">Patch zum Deinstallieren benutzerdefinierter Aktionen</span><span class="sxs-lookup"><span data-stu-id="718dc-141">Patch Uninstall Custom Actions</span></span>](patch-uninstall-custom-actions.md)
</dt> <dt>

[<span data-ttu-id="718dc-142">Nicht installierbare Patches</span><span class="sxs-lookup"><span data-stu-id="718dc-142">Uninstallable Patches</span></span>](uninstallable-patches.md)
</dt> <dt>

[<span data-ttu-id="718dc-143">Patches werden deinstalliert.</span><span class="sxs-lookup"><span data-stu-id="718dc-143">Uninstalling Patches</span></span>](uninstalling-patches.md)
</dt> </dl>

 

 



