---
description: 'In diesem Abschnitt wird eine Liste mit Tipps aufgelistet, die mit der Haupt Windows Installer SDK-Dokumentation verknüpft sind, um Anwendungsentwicklern, Setup Autoren, IT-Experten und Infrastruktur Entwicklern zu helfen, bewährte Methoden für die Verwendung der Windows Installer zu ermitteln:'
ms.assetid: ff48d995-fe6f-4d1b-898d-67574ed3c5b7
title: Bewährte Methoden für Windows Installer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ffaf6aae83afbe510f2b1eefc447e34754296ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104042531"
---
# <a name="windows-installer-best-practices"></a><span data-ttu-id="b2252-103">Bewährte Methoden für Windows Installer</span><span class="sxs-lookup"><span data-stu-id="b2252-103">Windows Installer Best Practices</span></span>

<span data-ttu-id="b2252-104">In diesem Abschnitt wird eine Liste mit Tipps aufgelistet, die mit der Haupt Windows Installer SDK-Dokumentation verknüpft sind, um Anwendungsentwicklern, Setup Autoren, IT-Experten und Infrastruktur Entwicklern zu helfen, bewährte Methoden für die Verwendung der Windows Installer zu ermitteln:</span><span class="sxs-lookup"><span data-stu-id="b2252-104">This section enumerates a list of tips, linked to the main Windows Installer SDK documentation, to help Application Developers, Setup Authors, IT Professionals, and Infrastructure Developers discover best practices for using the Windows Installer:</span></span>

-   [<span data-ttu-id="b2252-105">Aktualisieren Sie die Windows Installer Version.</span><span class="sxs-lookup"><span data-stu-id="b2252-105">Update the Windows Installer version.</span></span>](#update-the-windows-installer-version)
-   [<span data-ttu-id="b2252-106">Erfüllen Sie die Zertifizierungsanforderungen für Windows-Logo.</span><span class="sxs-lookup"><span data-stu-id="b2252-106">Meet the Windows Logo certification requirements.</span></span>](#meet-the-windows-logo-certification-requirements)
-   [<span data-ttu-id="b2252-107">Bereiten Sie das Paket für die Lokalisierung vor.</span><span class="sxs-lookup"><span data-stu-id="b2252-107">Prepare the package for localization.</span></span>](#prepare-the-package-for-localization)
-   [<span data-ttu-id="b2252-108">Aktualisieren Sie Ihre Windows Installer Entwicklungs Tools und-Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="b2252-108">Update your Windows Installer development tools and documentation.</span></span>](#update-your-windows-installer-development-tools-and-documentation)
-   [<span data-ttu-id="b2252-109">Wenn Sie sich entschließen, eine Legacy-Setup Anwendung neu zu verpacken, befolgen Sie die bewährten Vorgehensweisen zum erneuten verpacken.</span><span class="sxs-lookup"><span data-stu-id="b2252-109">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>](#if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices)
-   [<span data-ttu-id="b2252-110">Versuchen Sie nicht, geschützte Ressourcen zu ersetzen.</span><span class="sxs-lookup"><span data-stu-id="b2252-110">Do not try to replace protected resources.</span></span>](#do-not-try-to-replace-protected-resources)
-   [<span data-ttu-id="b2252-111">Verlassen Sie sich nicht auf nicht kritische Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="b2252-111">Do not depend upon non-critical resources.</span></span>](#do-not-depend-upon-non-critical-resources)
-   [<span data-ttu-id="b2252-112">Verwenden Sie die-API, um Windows Installer Konfigurationsinformationen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="b2252-112">Use the API to retrieve Windows Installer configuration information.</span></span>](#use-the-api-to-retrieve-windows-installer-configuration-information)
-   [<span data-ttu-id="b2252-113">Organisieren Sie die Installation Ihrer Anwendung um Komponenten.</span><span class="sxs-lookup"><span data-stu-id="b2252-113">Organize the installation of your application around components.</span></span>](#organize-the-installation-of-your-application-around-components)
-   [<span data-ttu-id="b2252-114">Reduzieren Sie die Größe großer Windows Installer Pakete.</span><span class="sxs-lookup"><span data-stu-id="b2252-114">Reduce the size of large Windows Installer packages.</span></span>](#reduce-the-size-of-large-windows-installer-packages)
-   [<span data-ttu-id="b2252-115">Wenn Sie benutzerdefinierte Aktionen verwenden, befolgen Sie bewährte Methoden für benutzerdefinierte Aktionen.</span><span class="sxs-lookup"><span data-stu-id="b2252-115">If you use custom actions, follow good custom action practices.</span></span>](#if-you-use-custom-actions-follow-good-custom-action-practices)
-   [<span data-ttu-id="b2252-116">Befolgen Sie bei Verwendung von Assemblys gute assemblypraktiken.</span><span class="sxs-lookup"><span data-stu-id="b2252-116">If you use assemblies, follow good assembly practices</span></span>](#if-you-use-assemblies-follow-good-assembly-practices)
-   [<span data-ttu-id="b2252-117">Senden Sie keine gleichzeitigen Installationen.</span><span class="sxs-lookup"><span data-stu-id="b2252-117">Do not ship concurrent installations.</span></span>](#do-not-ship-concurrent-installations)
-   [<span data-ttu-id="b2252-118">Halten Sie die Paketnamen und Paket Codes konsistent.</span><span class="sxs-lookup"><span data-stu-id="b2252-118">Keep package names and package codes consistent.</span></span>](#keep-package-names-and-package-codes-consistent)
-   [<span data-ttu-id="b2252-119">Verwenden Sie die Tabellen "selfreg" und "TypeLib" nicht.</span><span class="sxs-lookup"><span data-stu-id="b2252-119">Do not use the SelfReg and TypeLib tables.</span></span>](#do-not-use-the-selfreg-and-typelib-tables)
-   [<span data-ttu-id="b2252-120">Stellen Sie die Option zur Installation ohne Benutzeroberfläche bereit.</span><span class="sxs-lookup"><span data-stu-id="b2252-120">Provide the option to install without a user interface.</span></span>](#provide-the-option-to-install-without-a-user-interface)
-   [<span data-ttu-id="b2252-121">Vermeiden Sie die Verwendung der alwaysinstallerhöhten-Richtlinie.</span><span class="sxs-lookup"><span data-stu-id="b2252-121">Avoid using the AlwaysInstallElevated policy.</span></span>](#avoid-using-the-alwaysinstallelevated-policy)
-   [<span data-ttu-id="b2252-122">Aktivieren Sie die disablemedia-Richtlinie, um die nicht autorisierte Installation einzuschränken</span><span class="sxs-lookup"><span data-stu-id="b2252-122">Enable the DisableMedia policy to limit unauthorized installation.</span></span>](#enable-the-disablemedia-policy-to-limit-unauthorized-installation)
-   [<span data-ttu-id="b2252-123">Sorgen Sie dafür, dass die ursprünglichen Paket Quelldateien sicher und für Benutzer verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="b2252-123">Keep the original package source files secure and available to users.</span></span>](#keep-the-original-package-source-files-secure-and-available-to-users)
-   [<span data-ttu-id="b2252-124">Aktivieren Sie die ausführliche Protokollierung auf dem Computer des Benutzers bei der Problembehandlung.</span><span class="sxs-lookup"><span data-stu-id="b2252-124">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>](#enable-verbose-logging-on-users-computer-when-troubleshooting-deployment)
-   [<span data-ttu-id="b2252-125">Bei der Installation bleibt der Computer des Benutzers in einem sauberen Zustand.</span><span class="sxs-lookup"><span data-stu-id="b2252-125">Uninstallation leaves the user's computer in a clean state.</span></span>](#uninstallation-leaves-the-users-computer-in-a-clean-state)
-   [<span data-ttu-id="b2252-126">Test Pakete für die Bereitstellung pro Benutzer und pro Computerinstallation.</span><span class="sxs-lookup"><span data-stu-id="b2252-126">Test packages for both per-user and per-machine installation deployment.</span></span>](#test-packages-for-both-per-user-and-per-machine-installation-deployment)
-   [<span data-ttu-id="b2252-127">Planen und testen Sie eine Wartungsstrategie, bevor Sie die Anwendung versenden.</span><span class="sxs-lookup"><span data-stu-id="b2252-127">Plan and test a servicing strategy before shipping the application.</span></span>](#plan-and-test-a-servicing-strategy-before-shipping-the-application)
-   [<span data-ttu-id="b2252-128">Reduzieren Sie die Abhängigkeit von Updates auf den ursprünglichen Quellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-128">Reduce the dependency of updates upon the original sources.</span></span>](#reduce-the-dependency-of-updates-upon-the-original-sources)
-   [<span data-ttu-id="b2252-129">Nicht servierbar-Mergemodule verteilen.</span><span class="sxs-lookup"><span data-stu-id="b2252-129">Do not distribute unserviceable merge modules.</span></span>](#do-not-distribute-unserviceable-merge-modules)
-   [<span data-ttu-id="b2252-130">Vermeiden Sie das Patchen administrativer Installationen.</span><span class="sxs-lookup"><span data-stu-id="b2252-130">Avoid patching administrative installations.</span></span>](#avoid-patching-administrative-installations)
-   [<span data-ttu-id="b2252-131">Registrieren von Updates, die mit erhöhten Rechten ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-131">Register updates to run with elevated privilege.</span></span>](#register-updates-to-run-with-elevated-privilege)
-   [<span data-ttu-id="b2252-132">Verwenden Sie die msipatchsequence-Tabelle, um Patches zu sequenzieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-132">Use the MsiPatchSequence Table to sequence patches.</span></span>](#use-the-msipatchsequence-table-to-sequence-patches)
-   [<span data-ttu-id="b2252-133">Testen Sie das Installationspaket gründlich.</span><span class="sxs-lookup"><span data-stu-id="b2252-133">Test the installation package thoroughly.</span></span>](#test-the-installation-package-thoroughly)
-   [<span data-ttu-id="b2252-134">Beheben Sie alle Validierungs Fehler, bevor Sie ein neues oder überarbeitetes Installationspaket bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-134">Fix all validation errors before deploying a new or revised installation package.</span></span>](#fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package)
-   [<span data-ttu-id="b2252-135">Erstellen Sie eine sichere Installation.</span><span class="sxs-lookup"><span data-stu-id="b2252-135">Author a secure installation.</span></span>](#author-a-secure-installation)
-   [<span data-ttu-id="b2252-136">Verwenden von "pmsihandle" anstelle von "handle"</span><span class="sxs-lookup"><span data-stu-id="b2252-136">Use PMSIHANDLE instead of HANDLE</span></span>](#use-pmsihandle-instead-of-handle)

## <a name="update-the-windows-installer-version"></a><span data-ttu-id="b2252-137">Aktualisieren Sie die Windows Installer Version.</span><span class="sxs-lookup"><span data-stu-id="b2252-137">Update the Windows Installer version.</span></span>

-   <span data-ttu-id="b2252-138">Verwenden Sie Windows Installer 5,0 unter Windows Server 2008 R2 und Windows 7.</span><span class="sxs-lookup"><span data-stu-id="b2252-138">Use Windows Installer 5.0 on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="b2252-139">Dies ist die Windows Installer Version, die mit dem Betriebssystem bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-139">This is the Windows Installer version provided with the operating system.</span></span>
-   <span data-ttu-id="b2252-140">Verwenden Sie Windows Installer 4,5 unter Windows Server 2008, Windows Server 2003 mit Service Pack 1 (SP1), Windows Vista mit Service Pack 1 (SP1) oder Windows XP mit Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="b2252-140">Use Windows Installer 4.5 on Windows Server 2008, Windows Server 2003 with Service Pack 1 (SP1), Windows Vista with Service Pack 1 (SP1), or Windows XP with Service Pack 2 (SP2).</span></span> <span data-ttu-id="b2252-141">Informationen zum Abrufen der neuesten Windows Installer Version finden Sie unter [Windows Installer Redistributables](windows-installer-redistributables.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-141">For information about obtaining the latest Windows Installer version, see [Windows Installer Redistributables](windows-installer-redistributables.md).</span></span>
-   <span data-ttu-id="b2252-142">Verwenden Sie Windows Installer 3,1 unter Windows 2000 mit Service Pack 3 (SP3).</span><span class="sxs-lookup"><span data-stu-id="b2252-142">Use Windows Installer 3.1 on Windows 2000 with Service Pack 3 (SP3).</span></span> <span data-ttu-id="b2252-143">Windows Installer Version 3,1 verfügt über Features, die eine bessere Anwendungs Wartung und das [Patchen](patching.md)ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="b2252-143">Windows Installer version 3.1 has features that facilitate better application servicing and [patching](patching.md).</span></span>
-   <span data-ttu-id="b2252-144">Viele wichtige Features wurden mit Version 3,0 eingeführt und sind im Abschnitt [nicht unterstützt in Windows Installer Version 2,0](not-supported-in-windows-installer-version-2-0.md)aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="b2252-144">Many important features were introduced with version 3.0 and are listed in the section [Not Supported in Windows Installer Version 2.0](not-supported-in-windows-installer-version-2-0.md).</span></span> <span data-ttu-id="b2252-145">Installationspakete und Updates, die für Windows Installer 2,0 erstellt wurden, können mit Windows Installer 3,0 und höher installiert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-145">Installation packages and updates that were created for Windows Installer 2.0 can be installed using Windows Installer 3.0 and later.</span></span> <span data-ttu-id="b2252-146">Patchpakete, die die neuen, von Windows Installer 3,0 verwendeten Tabellen enthalten, können weiterhin mit früheren Versionen von Windows Installer angewendet werden, jedoch ohne die Windows Installer 3,0-Patchen-Funktionalität.</span><span class="sxs-lookup"><span data-stu-id="b2252-146">Patch packages that contain the new tables used by Windows Installer 3.0 can still be applied using earlier versions of Windows Installer but without the Windows Installer 3.0 patching functionality.</span></span> <span data-ttu-id="b2252-147">Es ist auch möglich, Patches zu erstellen, die die Windows Installer 3,0 explizit benötigen, die von früheren Versionen von Windows Installer nicht angewendet werden können.</span><span class="sxs-lookup"><span data-stu-id="b2252-147">It is also possible to author patches that explicitly require the Windows Installer 3.0 that cannot be applied by earlier versions of Windows Installer.</span></span> <span data-ttu-id="b2252-148">Wenn ein Benutzer die Installerversion nicht aktualisieren kann, müssen Sie sicherstellen, dass die Anwendung oder das Update mit einem zukünftigen Update der Windows Installer kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-148">If a user is unable to update the installer version, ensure that your application or update will be compatible with a future update of the Windows Installer.</span></span>
-   <span data-ttu-id="b2252-149">Eine Liste der Windows Installer Features, die von früheren Versionen von Windows Installer nicht unterstützt werden, finden Sie unter [What es New in Windows Installer](what-s-new-in-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-149">For a list of the Windows Installer features not supported by earlier versions of the Windows installer see [What's New in Windows Installer](what-s-new-in-windows-installer.md).</span></span>

## <a name="meet-the-windows-logo-certification-requirements"></a><span data-ttu-id="b2252-150">Erfüllen Sie die Zertifizierungsanforderungen für Windows-Logo.</span><span class="sxs-lookup"><span data-stu-id="b2252-150">Meet the Windows Logo certification requirements.</span></span>

-   <span data-ttu-id="b2252-151">Auch wenn Sie nicht beabsichtigen, Ihre Anwendung an das Logo-Programm zu übermitteln, können Sie nach den Logo Zertifizierungsrichtlinien helfen, Ihr Windows Installer Paket zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="b2252-151">Even if you do not intend to submit your application to the logo program, following the logo certification guidelines can help make your Windows Installer package better.</span></span> <span data-ttu-id="b2252-152">Eine Übersicht über die Logo-Anforderungen und Links zu bestimmten Logo Zertifizierungsprogrammen finden Sie unter [Windows Installer-und Logo-Anforderungen](windows-installer-and-logo-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-152">For an overview of the logo requirements, and links to specific logo certification programs, see [Windows Installer and Logo Requirements](windows-installer-and-logo-requirements.md).</span></span>

## <a name="prepare-the-package-for-localization"></a><span data-ttu-id="b2252-153">Bereiten Sie das Paket für die Lokalisierung vor.</span><span class="sxs-lookup"><span data-stu-id="b2252-153">Prepare the package for localization.</span></span>

-   <span data-ttu-id="b2252-154">Es empfiehlt sich, bei der Erstellung des ursprünglichen Installationspakets eine zukünftige Lokalisierung vorzubereiten.</span><span class="sxs-lookup"><span data-stu-id="b2252-154">It is a good practice to prepare for future localization when authoring the original installation package.</span></span> <span data-ttu-id="b2252-155">Sie können das empfohlene Paket Lokalisierungs Verfahren bei der [Lokalisierung eines Windows Installer Pakets](localizing-a-windows-installer-package.md)befolgen.</span><span class="sxs-lookup"><span data-stu-id="b2252-155">You can follow the suggested package localization procedure in [Localizing a Windows Installer Package](localizing-a-windows-installer-package.md).</span></span>

## <a name="update-your-windows-installer-development-tools-and-documentation"></a><span data-ttu-id="b2252-156">Aktualisieren Sie Ihre Windows Installer Entwicklungs Tools und-Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="b2252-156">Update your Windows Installer development tools and documentation.</span></span>

-   <span data-ttu-id="b2252-157">Die [Windows Installer-Entwicklungs Tools](windows-installer-development-tools.md) sind nicht Verteil Bar, und Sie sollten nur die Versionen dieser Tools verwenden, die von Microsoft zur Verfügung stehen.</span><span class="sxs-lookup"><span data-stu-id="b2252-157">The [Windows Installer Development Tools](windows-installer-development-tools.md) are not redistributable, and you should only use the versions of these tools available from Microsoft.</span></span> <span data-ttu-id="b2252-158">Diese sind in den [Windows SDK Komponenten für Windows Installer Entwickler](platform-sdk-components-for-windows-installer-developers.md) im Microsoft Windows Software Development Kit (SDK) verfügbar.</span><span class="sxs-lookup"><span data-stu-id="b2252-158">These are available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="b2252-159">Mehrere unabhängige Softwarehersteller bieten Tools zum Erstellen oder Ändern von Windows Installer Paketen.</span><span class="sxs-lookup"><span data-stu-id="b2252-159">Several independent software vendors offer tools to create or modify Windows Installer packages.</span></span> <span data-ttu-id="b2252-160">Diese Tools können eine Paket Erstellungs Umgebung bereitstellen, die möglicherweise einfacher zu verwenden ist als die Tools, die im Windows Installer SDK bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-160">These tools can provide a package authoring environment that may be easier to use than the tools provided in the Windows Installer SDK.</span></span> <span data-ttu-id="b2252-161">Weitere Informationen zu diesen Tools finden Sie in den Informationsressourcen, die in [anderen Quellen Windows Installer Informationen](other-sources-of-windows-installer-information.md)erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-161">You can learn more about these tools from the information resources discussed in [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md).</span></span>
-   <span data-ttu-id="b2252-162">Die Funktion zum Erstellen eines Pakets aus Textdateien ist für einige Entwickler möglicherweise intuitiver.</span><span class="sxs-lookup"><span data-stu-id="b2252-162">The capability to build a package from text files may be more intuitive for some developers.</span></span> <span data-ttu-id="b2252-163">Das WiX-Toolset (Windows Installer XML), das auf [SourceForge.net](https://sourceforge.net/projects/wix) verfügbar ist, erstellt Windows-Installationspakete aus XML-Quellcode.</span><span class="sxs-lookup"><span data-stu-id="b2252-163">The Windows Installer XML (WiX) toolset available on [Sourceforge.net](https://sourceforge.net/projects/wix) builds Windows installation packages from XML source code.</span></span>
-   <span data-ttu-id="b2252-164">Die Dokumentation im [Windows Installer SDK](./windows-installer-portal.md) , das in der MSDN-Online Bibliothek veröffentlicht wurde, wird am häufigsten aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="b2252-164">The documentation in the [Windows Installer SDK](./windows-installer-portal.md) released in the MSDN Online Library is updated the most frequently.</span></span>
-   <span data-ttu-id="b2252-165">Verwenden Sie die aktuelle Version von [Msizap.exe](msizap-exe.md) (Version 3.1.4000.2726 oder höher), die in den [Windows SDK Komponenten für Windows Installer Entwickler](platform-sdk-components-for-windows-installer-developers.md) für Windows Vista oder höher verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-165">Use the recent version of [Msizap.exe](msizap-exe.md) (version 3.1.4000.2726 or greater) that is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) for Windows Vista or greater.</span></span> <span data-ttu-id="b2252-166">Kleinere Versionen von Msizap.exe können Informationen zu allen Updates entfernen, die auf andere Anwendungen auf dem Computer des Benutzers angewendet wurden.</span><span class="sxs-lookup"><span data-stu-id="b2252-166">Lesser versions of Msizap.exe can remove information about all updates that have been applied to other applications on the user's computer.</span></span> <span data-ttu-id="b2252-167">Wenn diese Informationen entfernt werden, müssen diese anderen Anwendungen möglicherweise entfernt und erneut installiert werden, um weitere Updates zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="b2252-167">If this information is removed, these other applications may need to be removed and reinstalled to receive additional updates.</span></span>
-   <span data-ttu-id="b2252-168">Der Datenbanktabellen-Editor [Orca.exe](orca-exe.md) ist ein Datenbanktabellen-Editor zum Erstellen und Bearbeiten von Windows Installer Paketen und Mergemodulen.</span><span class="sxs-lookup"><span data-stu-id="b2252-168">The database table editor [Orca.exe](orca-exe.md) is a database table editor for creating and editing Windows Installer packages and merge modules.</span></span> <span data-ttu-id="b2252-169">Es verfügt über eine grundlegende GUI-Schnittstelle, unterstützt jedoch die erweiterte Bearbeitung von Windows Installer-</span><span class="sxs-lookup"><span data-stu-id="b2252-169">It has a basic GUI interface but supports advanced editing of Windows Installer databases.</span></span> <span data-ttu-id="b2252-170">Auch wenn Sie als primäres Entwicklungs Tool eine andere Anwendung verwenden, finden Sie möglicherweise die Verwendung von Orca.exe die bei der Problembehandlung und beim Testen eines Pakets praktisch ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-170">Even if you use another application as your primary development tool, you may find using Orca.exe is convenient when troubleshooting and testing a package.</span></span>
-   <span data-ttu-id="b2252-171">Weitere Informationen zu den aktuellen Windows Installer Informationen, die in Blogs, technischen Chats, Newsgroups, technischen Artikeln und Websites verfügbar sind, finden Sie unter [andere Quellen mit Windows Installer](other-sources-of-windows-installer-information.md) .</span><span class="sxs-lookup"><span data-stu-id="b2252-171">See [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md) for current Windows Installer information available in blogs, technical chats, newsgroups, technical articles, and websites.</span></span>

## <a name="if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices"></a><span data-ttu-id="b2252-172">Wenn Sie sich entschließen, eine Legacy-Setup Anwendung neu zu verpacken, befolgen Sie die bewährten Vorgehensweisen zum erneuten verpacken.</span><span class="sxs-lookup"><span data-stu-id="b2252-172">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>

<span data-ttu-id="b2252-173">Viele Anwendungshersteller stellen systemeigene Windows Installer Pakete für die Installation oder deren Produkte bereit.</span><span class="sxs-lookup"><span data-stu-id="b2252-173">Many application vendors provide native Windows Installer packages for the installation or their products.</span></span> <span data-ttu-id="b2252-174">Software, die eine vorhandene Legacy-Setup-Anwendung in ein Windows Installer Paket konvertiert, wird als Umverpackungs Tool bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="b2252-174">Software that converts an existing legacy setup application into a Windows Installer package is referred to as a repackaging tool.</span></span> <span data-ttu-id="b2252-175">Im Whitepaper [schrittweise Anleitung zum Erstellen von Windows Installer Paketen und zum erneuten Verpacken von Software für die Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) wird ein kommerziell verfügbares Tool zum erneuten Verpacken beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b2252-175">The whitepaper [Step-by-Step Guide to Creating Windows Installer Packages and Repackaging Software for the Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) describes a commercially available repackaging tool.</span></span> <span data-ttu-id="b2252-176">Das erneute Verpacken einer vorhandenen Setup Anwendung ist nicht die beste Entwicklungs Übung.</span><span class="sxs-lookup"><span data-stu-id="b2252-176">Repackaging an existing setup application is not the best development practice.</span></span> <span data-ttu-id="b2252-177">Anwendungen, die von Anfang an entwickelt wurden, um Windows Installer Features zu nutzen, können Benutzern die Installation und den Betrieb erleichtern.</span><span class="sxs-lookup"><span data-stu-id="b2252-177">Applications that have been designed from the start to take advantage of Windows Installer features can be easier for users to install and service.</span></span> <span data-ttu-id="b2252-178">Wenn Sie sich für die Verwendung einer Software zum erneuten Verpacken entscheiden, können Sie mithilfe der folgenden Verfahren ein besseres Windows Installer Paket erzielen.</span><span class="sxs-lookup"><span data-stu-id="b2252-178">If you decide to use a repackaging software the following practices can help you produce a better Windows Installer package.</span></span>

-   <span data-ttu-id="b2252-179">Die Tools zum erneuten Verpacken konvertieren Legacy Installationen in ein Windows Installer Paket, indem ein Bild eines stagingsystems vor und nach der Installation erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-179">Repackaging tools convert legacy installations into a Windows Installer package by taking a picture of a staging system before and after installation.</span></span> <span data-ttu-id="b2252-180">Alle Registrierungs Änderungen, Dateiänderungen oder Systemeinstellungen, die während des Aufzeichnungs Vorgangs auftreten, sind in der-Installation enthalten.</span><span class="sxs-lookup"><span data-stu-id="b2252-180">Any registry changes, file changes, or system setting that occurs during the capture process is included in the installation.</span></span> <span data-ttu-id="b2252-181">Konfigurieren Sie die Hardware und die Software des Computers, der zum erneuten Verpacken der Installation verwendet wird, so nah wie möglich an das System des vorgesehenen Benutzers.</span><span class="sxs-lookup"><span data-stu-id="b2252-181">Configure the hardware and software of the computer used to repackage the installation as close as possible to the intended user's system.</span></span> <span data-ttu-id="b2252-182">Erstellen Sie ein separates Paket für jede andere Hardwarekonfiguration.</span><span class="sxs-lookup"><span data-stu-id="b2252-182">Create a separate package for each different hardware configuration.</span></span> <span data-ttu-id="b2252-183">Ernedas erneute Verpacken mithilfe eines sauberen stagingcomputers.</span><span class="sxs-lookup"><span data-stu-id="b2252-183">Repackage using a clean staging computer.</span></span> <span data-ttu-id="b2252-184">Entfernen Sie alle nicht benötigten Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="b2252-184">Remove any unnecessary applications.</span></span> <span data-ttu-id="b2252-185">Beendet alle unnötigen Prozesse.</span><span class="sxs-lookup"><span data-stu-id="b2252-185">Stop all unnecessary processes.</span></span> <span data-ttu-id="b2252-186">Schließen Sie alle nicht wichtigen Systemdienste.</span><span class="sxs-lookup"><span data-stu-id="b2252-186">Close all non-essential system services.</span></span>
-   <span data-ttu-id="b2252-187">Erstellen Sie immer eine Kopie der ursprünglichen Installation, bevor Sie mit der Arbeit beginnen.</span><span class="sxs-lookup"><span data-stu-id="b2252-187">Always make a copy of the original installation before starting to work on it.</span></span> <span data-ttu-id="b2252-188">Arbeiten Sie immer an der Kopie.</span><span class="sxs-lookup"><span data-stu-id="b2252-188">Always work on the copy.</span></span> <span data-ttu-id="b2252-189">Beenden Sie einen Neuverpackungs nie, bevor Sie das Paket erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="b2252-189">Never stop a repackager before it finishes building the package.</span></span> <span data-ttu-id="b2252-190">Wenn das Paket vom Neuverpackungs beschädigt wird, verfügen Sie weiterhin über das Original.</span><span class="sxs-lookup"><span data-stu-id="b2252-190">If the repackager damages the package you will still have the original.</span></span>
-   <span data-ttu-id="b2252-191">Packen Sie Microsoft-Software Updates nicht erneut in ein Windows Installer Paket.</span><span class="sxs-lookup"><span data-stu-id="b2252-191">Do not repackage Microsoft software updates into a Windows Installer package.</span></span> <span data-ttu-id="b2252-192">Microsoft veröffentlicht Software Updates, z. b. Service Packs, als selbst extrahierende Dateien, die automatisch installiert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-192">Microsoft releases software updates, such as service packs, as self-extracting files that automatically runs installation.</span></span> <span data-ttu-id="b2252-193">Diese Updates verwenden andere Installationsprogramme als die Windows Installer, um geschützte Windows-Ressourcen zu ersetzen, und können nicht in ein Windows Installer Paket konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-193">These updates use different installers than the Windows Installer to replace protected Windows resources and cannot be converted into a Windows Installer package.</span></span> <span data-ttu-id="b2252-194">Weitere Informationen zum Bereitstellen von Windows Service Packs finden Sie im Bereitstellungs Handbuch Service Pack in [Microsoft TechNet](https://technet.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="b2252-194">For information about how to deploy Windows service packs, see the service pack's deployment guide on [Microsoft TechNet](https://technet.microsoft.com/).</span></span>
-   <span data-ttu-id="b2252-195">Verwenden Sie kein Tool zum erneuten Verpacken, um ein Windows Installer Paket in ein neues Paket zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-195">Do not use a repackaging tool to convert a Windows Installer package into a new package.</span></span> <span data-ttu-id="b2252-196">Der Windows Installer fügt dem System und den Anwendungs Ressourcen Konfigurationsinformationen hinzu.</span><span class="sxs-lookup"><span data-stu-id="b2252-196">The Windows Installer adds configuration information to the system as well as application resources.</span></span> <span data-ttu-id="b2252-197">Wenn ein Tool zum erneuten Verpacken das System vor und nach der Installation vergleicht, interpretiert der Neuverpackungs die Konfigurationsinformationen als Teil der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="b2252-197">When a repackaging tool compares the system before and after the installation, the repackager misinterprets the configuration information as part of the application.</span></span> <span data-ttu-id="b2252-198">Dies schadet in der Regel der neu verpackten Anwendung.</span><span class="sxs-lookup"><span data-stu-id="b2252-198">This usually damages the repackaged application.</span></span> <span data-ttu-id="b2252-199">Verwenden Sie stattdessen [Anpassungs Transformationen](a-customization-transform-example.md) , um ein vorhandenes Windows Installer Paket zu ändern, oder erstellen Sie ein neues Paket.</span><span class="sxs-lookup"><span data-stu-id="b2252-199">Instead use [customization transforms](a-customization-transform-example.md) to modify an existing Windows Installer package, or make an new package.</span></span> <span data-ttu-id="b2252-200">Anpassungs Transformationen können mithilfe des [Msitran.exe](msitran-exe.md) Tools erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-200">You can create customization transforms using the [Msitran.exe](msitran-exe.md) tool.</span></span>
-   <span data-ttu-id="b2252-201">Verwenden Sie kein Tool zum erneuten Verpacken, um mehrere Windows Installer Pakete in einem einzelnen Paket zu konsolidieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-201">Do not use a repackaging tool to consolidate several Windows Installer packages into a single package.</span></span> <span data-ttu-id="b2252-202">Stattdessen können Sie das [Msistuff.exe](msistuff-exe.md) -Tool verwenden, um die ausführbare Datei Setup.exe Bootstrap so zu konfigurieren, dass die Pakete nacheinander installiert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-202">Instead you can use the [Msistuff.exe](msistuff-exe.md) tool to configure the Setup.exe bootstrap executable to install the packages one after another.</span></span>
-   <span data-ttu-id="b2252-203">Legen Sie das Windows Installer Paket so fest, dass es vom Kunden problemlos angepasst werden kann.</span><span class="sxs-lookup"><span data-stu-id="b2252-203">Make your Windows Installer package so that it can be easily customized by the customer.</span></span> <span data-ttu-id="b2252-204">Globale Variablen, die während einer Installation von der Windows Installer verwendet werden, können mithilfe von öffentlichen [Eigenschaften](properties.md) oder [Anpassungs Transformationen](a-customization-transform-example.md)festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-204">Global variables used by the Windows Installer during an installation can be set using public [properties](properties.md) or [customization transforms](a-customization-transform-example.md).</span></span> <span data-ttu-id="b2252-205">Stellen Sie eine Dokumentation zur Verwendung dieser Eigenschaften und praktischen Standardwerte für alle anpassbaren Werte bereit.</span><span class="sxs-lookup"><span data-stu-id="b2252-205">Provide documentation for the use of those properties and practical default values for all customizable values.</span></span> <span data-ttu-id="b2252-206">Weitere Informationen zum erhalten und Festlegen von Eigenschaften finden [Sie unter Verwenden von Eigenschaften](using-properties.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-206">For information about getting and setting properties see [Using Properties](using-properties.md).</span></span> <span data-ttu-id="b2252-207">Ein Beispiel für eine Anpassungs Transformation finden Sie unter [Beispiel für eine Anpassungs Transformation](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-207">For an example of a customization transform see [A Customization Transform Example](a-customization-transform-example.md).</span></span>

## <a name="do-not-try-to-replace-protected-resources"></a><span data-ttu-id="b2252-208">Versuchen Sie nicht, geschützte Ressourcen zu ersetzen.</span><span class="sxs-lookup"><span data-stu-id="b2252-208">Do not try to replace protected resources.</span></span>

<span data-ttu-id="b2252-209">Windows Installer Paketen sollten nicht versuchen, geschützte Ressourcen während der Installation oder des Updates zu ersetzen.</span><span class="sxs-lookup"><span data-stu-id="b2252-209">Windows Installer packages should not attempt to replace protected resources during installation or update.</span></span> <span data-ttu-id="b2252-210">Der Windows Installer entfernt oder ersetzt diese Ressourcen nicht, da Windows die Ersetzung wichtiger Systemdateien, Ordner und Registrierungsschlüssel verhindert.</span><span class="sxs-lookup"><span data-stu-id="b2252-210">The Windows Installer does not remove or replace these resources because Windows prevents the replacement of essential system files, folders, and registry keys.</span></span> <span data-ttu-id="b2252-211">Der Schutz dieser Ressourcen verhindert Anwendungs-und Betriebssystem Fehler.</span><span class="sxs-lookup"><span data-stu-id="b2252-211">Protecting these resources prevents application and operating system failures.</span></span>

-   <span data-ttu-id="b2252-212">Bei Ausführung unter Windows Server 2008 oder Windows Vista überspringt das Windows Installer die Installation von Dateien oder Registrierungs Schlüsseln, die durch [Windows-Ressourcenschutz](../wfp/windows-resource-protection-portal.md) (WRP) geschützt sind, das Installationsprogramm gibt eine Warnung in die Protokolldatei ein und setzt den Rest der Installation ohne Fehler fort.</span><span class="sxs-lookup"><span data-stu-id="b2252-212">When running on Windows Server 2008 or Windows Vista, the Windows Installer skips the installation of any file or registry key that is protected by [Windows Resource Protection](../wfp/windows-resource-protection-portal.md) (WRP), the installer enters a warning in the log file, and continues with the remainder of the installation without an error.</span></span> <span data-ttu-id="b2252-213">Weitere Informationen finden [Sie unter Verwenden von Windows Installer und Windows-Ressourcenschutz](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-213">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>
-   <span data-ttu-id="b2252-214">WRP ist der neue Name für den Windows-Datei Schutz (WFP).</span><span class="sxs-lookup"><span data-stu-id="b2252-214">WRP is the new name for Windows File Protection (WFP).</span></span> <span data-ttu-id="b2252-215">WRP schützt Registrierungsschlüssel und Ordner sowie wichtige Systemdateien.</span><span class="sxs-lookup"><span data-stu-id="b2252-215">WRP protects registry keys and folders as well as essential system files.</span></span> <span data-ttu-id="b2252-216">In Windows Server 2003, Windows XP und Windows 2000 konnte das Installationsprogramm die Datei von WFP installieren, wenn das Windows Installer eine durch WFP geschützte Datei gefunden hat.</span><span class="sxs-lookup"><span data-stu-id="b2252-216">In Windows Server 2003, Windows XP, and Windows 2000, when the Windows Installer encountered a WFP-protected file, the installer would request that WFP install the file.</span></span> <span data-ttu-id="b2252-217">Weitere Informationen finden [Sie unter Verwenden von Windows Installer und Windows-Ressourcenschutz](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-217">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>

## <a name="do-not-depend-upon-non-critical-resources"></a><span data-ttu-id="b2252-218">Verlassen Sie sich nicht auf nicht kritische Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="b2252-218">Do not depend upon non-critical resources.</span></span>

<span data-ttu-id="b2252-219">Die Installation oder Aktualisierung sollte aus folgenden Gründen nicht von der Installation nicht kritischer Ressourcen abhängen.</span><span class="sxs-lookup"><span data-stu-id="b2252-219">Your installation or update should not depend upon the installation of non-critical resources for the following reasons.</span></span>

-   <span data-ttu-id="b2252-220">Benutzerdefinierte Aktionen können fehlschlagen, wenn Sie von einer Komponente abhängen, die zu einer Funktion gehört, die der Benutzer anstelle von installiert.</span><span class="sxs-lookup"><span data-stu-id="b2252-220">Custom actions can fail if they depend upon a component belonging to a feature that the user advertises rather than installs.</span></span>
-   <span data-ttu-id="b2252-221">Benutzerdefinierte Aktionen, die vor der [InstallFinalize](installfinalize-action.md) -Aktion sequenziert werden, können fehlschlagen, wenn Sie von einer Komponente abhängen, die eine installierte Assembly enthält.</span><span class="sxs-lookup"><span data-stu-id="b2252-221">Custom actions sequenced before the [InstallFinalize](installfinalize-action.md) action can fail if they depend on a component containing an assembly that is being installed.</span></span> <span data-ttu-id="b2252-222">Der Windows Installer committet Assemblys nicht in den globalen Assemblycache (GAC), bis die InstallFinalize-Aktion abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-222">The Windows Installer does not commit assemblies to the Global Assembly Cache (GAC) until the InstallFinalize action completes.</span></span>

## <a name="use-the-api-to-retrieve-windows-installer-configuration-information"></a><span data-ttu-id="b2252-223">Verwenden Sie die-API, um Windows Installer Konfigurationsinformationen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="b2252-223">Use the API to retrieve Windows Installer configuration information.</span></span>

<span data-ttu-id="b2252-224">Die Installation der Anwendung oder des Updates sollte nicht von direktem Zugriff auf Windows Installer Konfigurationsinformationen abhängen, die auf dem Computer gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="b2252-224">The installation of your application or update should not depend upon direct access to Windows Installer configuration information saved on your computer.</span></span> <span data-ttu-id="b2252-225">Verwenden Sie stattdessen die Windows Installer-Anwendungsprogrammierschnittstelle zum Abrufen von Konfigurationsinformationen.</span><span class="sxs-lookup"><span data-stu-id="b2252-225">Instead use the Windows Installer application programming interface to retrieve configuration information.</span></span> <span data-ttu-id="b2252-226">Der Speicherort und das Format der Konfigurationsinformationen werden vom Windows Installer-Dienst verwaltet und können sich ändern.</span><span class="sxs-lookup"><span data-stu-id="b2252-226">The location and format of configuration information is managed by the Windows Installer service and can change.</span></span>

-   <span data-ttu-id="b2252-227">Die Installations-und Konfigurationsfunktionen der Windows Installer-API werden in der [Installations Funktionsreferenz](installer-function-reference.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b2252-227">The Installation and Configuration Functions of the Windows Installer API are described in the [Installer Function Reference](installer-function-reference.md).</span></span>
-   <span data-ttu-id="b2252-228">Die [Konfigurations Eigenschaften](property-reference.md) werden in der Eigenschaften Referenz beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b2252-228">The [Configuration Properties](property-reference.md) are described in the Property Reference.</span></span>
-   <span data-ttu-id="b2252-229">Die Automatisierungsmethoden und-Eigenschaften werden in der [Automatisierungs Schnittstellenreferenz](automation-interface-reference.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b2252-229">The automation methods and properties are described in the [Automation Interface Reference](automation-interface-reference.md).</span></span> <span data-ttu-id="b2252-230">Das Beispielskript WiLstPrd.vbs die eine Verbindung mit einem Installer-Objekt herstellt und registrierte Produkte und Produktinformationen auflistet.</span><span class="sxs-lookup"><span data-stu-id="b2252-230">The sample script WiLstPrd.vbs connects to an Installer object and enumerates registered products and product information.</span></span> <span data-ttu-id="b2252-231">Weitere Informationen finden Sie unter [Auflisten von Produkten, Eigenschaften, Features und Komponenten](list-products-properties-features-and-components.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-231">For information see [List Products, Properties, Features, and Components](list-products-properties-features-and-components.md).</span></span>

## <a name="organize-the-installation-of-your-application-around-components"></a><span data-ttu-id="b2252-232">Organisieren Sie die Installation Ihrer Anwendung um Komponenten.</span><span class="sxs-lookup"><span data-stu-id="b2252-232">Organize the installation of your application around components.</span></span>

<span data-ttu-id="b2252-233">Der Windows Installer-Dienst installiert oder entfernt Sammlungen von Ressourcen, die als [Komponenten](windows-installer-components.md)bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-233">The Windows Installer service installs or removes collections of resources referred to as [components](windows-installer-components.md).</span></span> <span data-ttu-id="b2252-234">Da Komponenten im allgemeinen gemeinsam genutzt werden, muss der Autor eines Installationspakets den Regeln folgen, wenn die Komponenten eines Features oder einer Anwendung angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-234">Because components are commonly shared, the author of an installation package must follow rules when specifying the components of a feature or application.</span></span>

-   <span data-ttu-id="b2252-235">Befolgen Sie die Komponenten Regeln, wenn Sie [Anwendungen in Komponenten organisieren](organizing-applications-into-components.md) , um sicherzustellen, dass neue Komponenten oder neue Versionen von Komponenten installiert und entfernt werden können, ohne dass andere Anwendungen beschädigt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-235">Adhere to the component rules when [Organizing Applications into Components](organizing-applications-into-components.md) to ensure that new components, or new versions of components, can be installed and removed without damaging other applications.</span></span> <span data-ttu-id="b2252-236">Sie können das unter [Definieren von Installationsprogramm Komponenten](defining-installer-components.md)beschriebene Verfahren befolgen.</span><span class="sxs-lookup"><span data-stu-id="b2252-236">You can follow the procedure described in [Defining Installer Components](defining-installer-components.md).</span></span>
-   <span data-ttu-id="b2252-237">Das Installationsprogramm verfolgt jede Komponente anhand der entsprechenden Komponenten-ID-GUID, die in der [Komponenten Tabelle](component-table.md)angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-237">The installer tracks every component by the respective component ID GUID specified in the [Component table](component-table.md).</span></span> <span data-ttu-id="b2252-238">Es ist von entscheidender Bedeutung für den Betrieb des Windows Installer Verweis Zählmechanismus, dass die Komponenten-ID-GUID korrekt ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-238">It is essential for the operation of the Windows Installer reference-counting mechanism that the component ID GUID is correct.</span></span> <span data-ttu-id="b2252-239">Befolgen Sie die Richtlinien zum [Ändern des Komponenten Codes](changing-the-component-code.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-239">Follow the guidelines in [Changing the Component Code](changing-the-component-code.md).</span></span>
-   <span data-ttu-id="b2252-240">Wenn das Paket die Komponenten Regeln unterbrechen muss, achten Sie auf die möglichen Konsequenzen, und stellen Sie sicher, dass bei der Installation die Komponenten nie installiert werden, wo Sie möglicherweise Komponenten im System des Benutzers beschädigen.</span><span class="sxs-lookup"><span data-stu-id="b2252-240">If your package must break the component rules, be aware of the possible consequences and ensure that your installation never installs these components where they may damage components on the user's system.</span></span> <span data-ttu-id="b2252-241">Weitere Informationen finden Sie unter [Was geschieht, wenn die Komponenten Regeln beschädigt sind?](what-happens-if-the-component-rules-are-broken.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-241">For information see [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md).</span></span>
-   <span data-ttu-id="b2252-242">Beachten Sie, wie das Windows Installer die [Regeln für die Datei Versions](file-versioning-rules.md) Verwaltung anwendet, wenn [vorhandene Dateien ersetzt](replacing-existing-files.md)werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-242">Be aware how the Windows Installer applies the [File Versioning Rules](file-versioning-rules.md) when [Replacing Existing Files](replacing-existing-files.md).</span></span> <span data-ttu-id="b2252-243">Der Windows Installer bestimmt zunächst, ob die Schlüsseldatei der Komponente bereits installiert ist, bevor versucht wird, die Dateien der Komponente zu installieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-243">The Windows Installer first determines whether the component's key file is already installed before attempting to install any of the files of the component.</span></span> <span data-ttu-id="b2252-244">Wenn das Installationsprogramm eine Datei mit dem gleichen Namen wie die Schlüsseldatei der Komponente findet, die am Ziel Speicherort installiert ist, vergleicht Sie die Version, das Datum und die Sprache der beiden Schlüsseldateien und verwendet Datei Versions Regeln, um zu bestimmen, ob die vom Paket bereitgestellte Komponente installiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="b2252-244">If the installer finds a file with the same name as the component's key file installed in the target location, it compares the version, date, and language of the two key files and uses file versioning rules to determine whether to install the component provided by the package.</span></span> <span data-ttu-id="b2252-245">Wenn das Installationsprogramm feststellt, dass es die Komponentenbasis auf der Schlüsseldatei ersetzen muss, verwendet es die Datei Versions Regeln für jede installierte Datei, um zu bestimmen, ob die Datei ersetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="b2252-245">If the installer determines it needs to replace the component base upon the key file, then it uses the file versioning rules on each installed file to determine whether to replace the file.</span></span>

## <a name="reduce-the-size-of-large-windows-installer-packages"></a><span data-ttu-id="b2252-246">Reduzieren Sie die Größe großer Windows Installer Pakete.</span><span class="sxs-lookup"><span data-stu-id="b2252-246">Reduce the size of large Windows Installer packages.</span></span>

<span data-ttu-id="b2252-247">Sehr große Windows-Pakete benötigen Systemressourcen und können für Benutzer schwierig zu installieren sein.</span><span class="sxs-lookup"><span data-stu-id="b2252-247">Very large Windows Packages take system resources and can be difficult for users to install.</span></span> <span data-ttu-id="b2252-248">Es empfiehlt sich, die Größe von sehr großen Windows Installer Paketen mit den folgenden Methoden zu verringern.</span><span class="sxs-lookup"><span data-stu-id="b2252-248">It is good practice to reduce the size of very large Windows Installer Packages by the following methods.</span></span>

-   <span data-ttu-id="b2252-249">Komprimieren Sie die Dateien in der Installation, und speichern Sie Sie in einer CAB-Datei.</span><span class="sxs-lookup"><span data-stu-id="b2252-249">Compress the files in the installation and store them in a cabinet (.cab) file .</span></span> <span data-ttu-id="b2252-250">Das Installationsprogramm ermöglicht die Speicherung der CAB-Datei als separate externe Datei oder als Datenstream im MSI-Paket selbst.</span><span class="sxs-lookup"><span data-stu-id="b2252-250">The Installer allows the .cab file to be stored as a separate external file, or as a data stream in the MSI package itself.</span></span> <span data-ttu-id="b2252-251">Weitere Informationen finden [Sie unter Verwenden von Schränken und komprimierten Quellen](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-251">For information see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>
-   <span data-ttu-id="b2252-252">Entfernen Sie Speicherplatz in der MSI-Datei, indem Sie eine der Optionen verwenden, [die unter Reduzieren der Größe einer MSI-Datei](reducing-the-size-of-an--msi-file.md)erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-252">Remove wasted storage space in the .msi file using one of the options discussed in [Reducing the Size of an .msi File](reducing-the-size-of-an--msi-file.md).</span></span>
-   <span data-ttu-id="b2252-253">Wenn das Windows Installer-Paket mehr als 32767 Dateien enthält, müssen Sie das Schema der Datenbank ändern.</span><span class="sxs-lookup"><span data-stu-id="b2252-253">If your Windows Installer package contains more than 32767 files, you must change the schema of the database.</span></span> <span data-ttu-id="b2252-254">Weitere Informationen finden Sie unter [Erstellen eines großen Pakets](authoring-a-large-package.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-254">For information see [Authoring a Large Package](authoring-a-large-package.md).</span></span>

## <a name="if-you-use-custom-actions-follow-good-custom-action-practices"></a><span data-ttu-id="b2252-255">Wenn Sie benutzerdefinierte Aktionen verwenden, befolgen Sie bewährte Methoden für benutzerdefinierte Aktionen.</span><span class="sxs-lookup"><span data-stu-id="b2252-255">If you use custom actions, follow good custom action practices.</span></span>

<span data-ttu-id="b2252-256">Der Windows Installer verfügt über viele integrierte [Standard Aktionen](standard-actions-reference.md) für die Installation und Wartung von Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="b2252-256">The Windows Installer has many built-in [standard actions](standard-actions-reference.md) for the installation and maintenance of applications.</span></span> <span data-ttu-id="b2252-257">Entwickler sollten versuchen, sich auf die Standard Aktionen zu verlassen, anstatt ihre eigenen [benutzerdefinierten Aktionen](custom-actions.md)zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-257">Developers should attempt to rely upon the standard actions as much as practical, rather than create their own [custom actions](custom-actions.md).</span></span> <span data-ttu-id="b2252-258">Es gibt jedoch Situationen, in denen der Entwickler eines Installationspakets es zum Schreiben einer benutzerdefinierten Aktion findet.</span><span class="sxs-lookup"><span data-stu-id="b2252-258">However, there are situations where the developer of an installation package finds it necessary to write a custom action.</span></span>

-   <span data-ttu-id="b2252-259">Befolgen Sie die Richtlinien zum [Verwenden von benutzerdefinierten Aktionen](using-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-259">Follow the guidelines for [Using Custom Actions](using-custom-actions.md).</span></span>
-   <span data-ttu-id="b2252-260">Befolgen Sie die [Richtlinien zum Sichern von benutzerdefinierten Aktionen](guidelines-for-securing-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-260">Follow the [Guidelines for Securing Custom Actions](guidelines-for-securing-custom-actions.md).</span></span> <span data-ttu-id="b2252-261">Benutzerdefinierte Aktionen, die vertrauliche Informationen verwenden, sollten diese Informationen nicht in das Protokoll schreiben.</span><span class="sxs-lookup"><span data-stu-id="b2252-261">Custom actions that use sensitive information should not write this information into the log.</span></span> <span data-ttu-id="b2252-262">Weitere Informationen finden Sie unter [Sicherheit für benutzerdefinierte Aktionen](custom-action-security.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-262">For information see [Custom Action Security](custom-action-security.md).</span></span>
-   <span data-ttu-id="b2252-263">Benutzerdefinierte Aktionen dürfen nicht versuchen, einen Einstiegspunkt für die System Wiederherstellung innerhalb einer benutzerdefinierten Aktion festzulegen.</span><span class="sxs-lookup"><span data-stu-id="b2252-263">Custom Actions must not attempt to set a System Restore entry point from within a custom action.</span></span> <span data-ttu-id="b2252-264">Weitere Informationen finden Sie [unter Festlegen eines Wiederherstellungs Punkts aus einer benutzerdefinierten Aktion](setting-a-restore-point-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-264">For information see [Setting a restore point from a Custom Action](setting-a-restore-point-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="b2252-265">Gibt Fehlermeldungen von benutzerdefinierten Aktionen zurück und schreibt Sie in das Protokoll, um die Problembehandlung für benutzerdefinierte Aktionen zu vereinfachen</span><span class="sxs-lookup"><span data-stu-id="b2252-265">Return error messages from custom actions and write them to the log to facilitate troubleshooting custom actions.</span></span> <span data-ttu-id="b2252-266">Weitere Informationen finden Sie unter [Fehlermeldung benutzerdefinierte Aktionen](error-message-custom-actions.md) und [zurückgeben von Fehlermeldungen von benutzerdefinierten Aktionen](returning-error-messages-from-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-266">For information see [Error Message Custom Actions](error-message-custom-actions.md) and [Returning Error Messages from Custom Actions](returning-error-messages-from-custom-actions.md).</span></span>
-   <span data-ttu-id="b2252-267">Ändern Sie den Systemstatus nicht in eine sofortige benutzerdefinierte Aktion.</span><span class="sxs-lookup"><span data-stu-id="b2252-267">Do not change the system state from an immediate custom action.</span></span> <span data-ttu-id="b2252-268">Benutzerdefinierte Aktionen, die das System direkt ändern oder einen anderen Systemdienst aufzurufen, müssen bis zu dem Zeitpunkt verzögert werden, zu dem das Installationsskript ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-268">Custom actions that change the system directly or call another system service must be deferred to the time when the installation script is executed.</span></span> <span data-ttu-id="b2252-269">Jeder [benutzerdefinierten Aktion für die verzögerte Ausführung](deferred-execution-custom-actions.md) , die den Systemstatus ändert, muss eine [benutzerdefinierte Rollback-Aktion](rollback-custom-actions.md) voranstehen, um die Systemstatus Änderung bei einem Installations Rollback rückgängig zu machen.</span><span class="sxs-lookup"><span data-stu-id="b2252-269">Every [deferred execution custom action](deferred-execution-custom-actions.md) that changes the system state must be preceded by a [rollback custom action](rollback-custom-actions.md) to undo the system state change on an installation rollback.</span></span> <span data-ttu-id="b2252-270">Weitere Informationen finden [Sie unter Ändern des System Status mithilfe einer benutzerdefinierten Aktion](changing-the-system-state-using-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-270">For information see [Changing the System State Using a Custom Action](changing-the-system-state-using-a-custom-action.md).</span></span>
-   <span data-ttu-id="b2252-271">Benutzerdefinierte Aktionen, bei denen komplexe Installations Vorgänge ausgeführt werden, sollten eine [ausführbare Datei](executable-files.md) oder eine [Dynamic Link Library](dynamic-link-libraries.md)sein.</span><span class="sxs-lookup"><span data-stu-id="b2252-271">Custom actions that perform complex installation operations should be an [executable file](executable-files.md) or [dynamic-link library](dynamic-link-libraries.md).</span></span> <span data-ttu-id="b2252-272">Beschränken Sie die Verwendung von benutzerdefinierten Aktionen auf der Grundlage von [Skripts](scripts.md) auf einfache Installations Vorgänge.</span><span class="sxs-lookup"><span data-stu-id="b2252-272">Limit the use of custom actions based on [scripts](scripts.md) to simple installation operations.</span></span>
-   <span data-ttu-id="b2252-273">Machen Sie die Details, die die benutzerdefinierte Aktion für das System durchführt, leicht für Systemadministratoren auffindbar.</span><span class="sxs-lookup"><span data-stu-id="b2252-273">Make the details of what your custom action does to the system easily discoverable to system administrators.</span></span> <span data-ttu-id="b2252-274">Fügen Sie die Details von Registrierungs Einträgen und Dateien, die von der benutzerdefinierten Aktion verwendet werden, in eine benutzerdefinierte Tabelle ein, und lassen Sie die benutzerdefinierte Aktion aus dieser Tabelle</span><span class="sxs-lookup"><span data-stu-id="b2252-274">Put the details of registry entries and files used by your custom action into a custom table and have the custom action read from this table.</span></span> <span data-ttu-id="b2252-275">Dies wird anhand des Beispiels unter [Verwenden einer benutzerdefinierten Aktion zum Erstellen von Benutzerkonten auf einem lokalen Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md)veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="b2252-275">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span> <span data-ttu-id="b2252-276">Weitere Informationen zum Hinzufügen von benutzerdefinierten Tabellen zu einer Datenbank finden Sie unter [Arbeiten mit Abfragen](working-with-queries.md) und [Beispielen für Datenbankabfragen mithilfe von SQL und Skript](examples-of-database-queries-using-sql-and-script.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-276">For information on adding custom tables to a database, see [Working with Queries](working-with-queries.md) and [Examples of Database Queries Using SQL and Script](examples-of-database-queries-using-sql-and-script.md).</span></span>
-   <span data-ttu-id="b2252-277">Bei benutzerdefinierten Aktionen sollte kein Dialogfeld angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-277">A custom actions should not display a dialog box.</span></span> <span data-ttu-id="b2252-278">Benutzerdefinierte Aktionen, für die eine Benutzeroberfläche erforderlich ist, können stattdessen die [**msiprocessmessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) -Funktion verwenden.</span><span class="sxs-lookup"><span data-stu-id="b2252-278">Custom actions requiring a user interface can use the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function instead.</span></span> <span data-ttu-id="b2252-279">Siehe [Senden von Nachrichten an Windows Installer mithilfe von "msiprocessmessage](sending-messages-to-windows-installer-using-msiprocessmessage.md)".</span><span class="sxs-lookup"><span data-stu-id="b2252-279">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>
-   <span data-ttu-id="b2252-280">Benutzerdefinierte Aktionen dürfen keine Funktionen verwenden, die auf der Seite aufgelistet sind: Funktionen, die [nicht für benutzerdefinierte Aktionen verwendet](functions-not-for-use-in-custom-actions.md)werden können.</span><span class="sxs-lookup"><span data-stu-id="b2252-280">Custom actions must not use any of the functions listed on the page: [Functions Not for Use in Custom Actions](functions-not-for-use-in-custom-actions.md).</span></span>
-   <span data-ttu-id="b2252-281">Wenn die Installation auf einem Terminal Server ausgeführt werden soll, testen Sie, ob alle benutzerdefinierten Aktionen auf einem Terminal Server ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="b2252-281">If the installation is intended to run on a terminal server, test that all your custom actions are capable of running on a terminal server.</span></span> <span data-ttu-id="b2252-282">Weitere Informationen finden Sie unter [**Terminalserver**](terminalserver.md) -Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="b2252-282">For more information see [**TerminalServer**](terminalserver.md) property.</span></span>
-   <span data-ttu-id="b2252-283">Um eine benutzerdefinierte Aktion auszuführen, wenn ein bestimmter Patch deinstalliert wird, muss die benutzerdefinierte Aktion entweder in der ursprünglichen Anwendung vorhanden sein oder sich in einem Patch für das Produkt befinden, das immer angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-283">To have a custom action run when a particular patch is uninstalled the custom action must either be present in the original application or be in a patch for the product that is always applied.</span></span> <span data-ttu-id="b2252-284">Weitere Informationen finden Sie unter [Patch Uninstall Custom Actions](patch-uninstall-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-284">For more information see [Patch Uninstall Custom Actions](patch-uninstall-custom-actions.md).</span></span>
-   <span data-ttu-id="b2252-285">Benutzerdefinierte Aktionen sollten die Benutzeroberflächen Ebene nicht als Bedingung für das Senden von Fehlermeldungen an das Installationsprogramm verwenden, da dies die Protokollierung und externe Nachrichten beeinträchtigen kann.</span><span class="sxs-lookup"><span data-stu-id="b2252-285">Custom actions should not use the UI level as a condition for sending error messages to the installer because this can interfere with logging and external messages.</span></span> <span data-ttu-id="b2252-286">Weitere Informationen finden Sie [unter Bestimmen der Benutzeroberflächen Ebene aus einer benutzerdefinierten Aktion](determining-ui-level-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-286">For information see [Determining UI Level from a Custom Action](determining-ui-level-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="b2252-287">Verwenden Sie bedingte Anweisungen und [bedingte Anweisungs Syntax](conditional-statement-syntax.md) , um sicherzustellen, dass das Paket ordnungsgemäß benutzerdefinierte Aktionen ausführt, keine benutzerdefinierten Aktionen ausführt oder Alternative benutzerdefinierte Aktionen ausführt, wenn das Paket deinstalliert wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-287">Use conditional statements and [Conditional Statement Syntax](conditional-statement-syntax.md) to ensure that your package correctly runs custom actions, does not run a custom actions, or runs alternate custom action when the package is uninstalled.</span></span> <span data-ttu-id="b2252-288">Testen Sie, ob das Paket beim [Deinstallieren von benutzerdefinierten Aktionen](uninstalling-custom-actions.md)erwartungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="b2252-288">Test that the package works as expected when [uninstalling custom actions](uninstalling-custom-actions.md).</span></span> <span data-ttu-id="b2252-289">Weitere Informationen finden [Sie unter während des Entfernens](conditioning-actions-to-run-during-removal.md) auszuführende Maßnahmen.</span><span class="sxs-lookup"><span data-stu-id="b2252-289">For information see [Conditioning Actions to Run During Removal](conditioning-actions-to-run-during-removal.md)</span></span>
-   <span data-ttu-id="b2252-290">Wenn die Installation in der Lage sein muss, von Benutzern ohne Administratorrechte ausgeführt zu werden, testen Sie, um sicherzustellen, dass alle benutzerdefinierten Aktionen mit nicht Administratorrechten ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="b2252-290">If the installation must be capable of being run by users that do not have administrator privileges, test to ensure that all the custom actions can be run with non-administrator privileges.</span></span> <span data-ttu-id="b2252-291">Benutzerdefinierte Aktionen erfordern erweiterte Berechtigungen, um Teile des Systems zu ändern, die Nichtbenutzer spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="b2252-291">Custom actions require elevated privileges to modify parts of the system that are not user specific.</span></span> <span data-ttu-id="b2252-292">Der Installer kann benutzerdefinierte Aktionen mit erhöhten Rechten ausführen, wenn eine verwaltete Anwendung installiert wird oder wenn die System Richtlinie für erweiterte Berechtigungen angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="b2252-292">The installer may run custom actions with elevated privileges if a managed application is being installed or if the system policy has been specified for elevated privileges.</span></span> <span data-ttu-id="b2252-293">Alle benutzerdefinierten Aktionen, für die erhöhte Rechte erforderlich sind, müssen die benutzerdefinierte Aktion "msidbcustomaction typeinscript" und "msidbcustomaction tytaoannehmen" [In-Script Ausführungs Optionen](custom-action-in-script-execution-options.md) in den benutzerdefinierten Aktionstyp einschließen.</span><span class="sxs-lookup"><span data-stu-id="b2252-293">Any custom actions the require elevated privileges must include the msidbCustomActionTypeInScript and msidbCustomActionTypeNoImpersonate [Custom Action In-Script Execution Options](custom-action-in-script-execution-options.md) in the custom action type.</span></span> <span data-ttu-id="b2252-294">Dies wird anhand des Beispiels unter [Verwenden einer benutzerdefinierten Aktion zum Erstellen von Benutzerkonten auf einem lokalen Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md)veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="b2252-294">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span>

## <a name="if-you-use-assemblies-follow-good-assembly-practices"></a><span data-ttu-id="b2252-295">Befolgen Sie bei Verwendung von Assemblys gute assemblypraktiken.</span><span class="sxs-lookup"><span data-stu-id="b2252-295">If you use assemblies, follow good assembly practices</span></span>

<span data-ttu-id="b2252-296">Wenn das [Paket](assemblies.md)softwareupdateiassemblys verwendet, befolgen Sie die Richtlinien zum Hinzufügen von Assemblys [zu einem Paket](adding-assemblies-to-a-package.md), zum [Aktualisieren](updating-assemblies.md) [von](installing-and-removing-assemblies.md)Assemblys</span><span class="sxs-lookup"><span data-stu-id="b2252-296">If your package uses software [assemblies](assemblies.md), follow the guidelines for [Adding Assemblies to a Package](adding-assemblies-to-a-package.md), [Updating Assemblies](updating-assemblies.md), and [Installing and Removing Assemblies](installing-and-removing-assemblies.md).</span></span>

## <a name="do-not-ship-concurrent-installations"></a><span data-ttu-id="b2252-297">Senden Sie keine gleichzeitigen Installationen.</span><span class="sxs-lookup"><span data-stu-id="b2252-297">Do not ship concurrent installations.</span></span>

<span data-ttu-id="b2252-298">[Gleichzeitige Installationen](concurrent-installations.md), auch geschsted-Installationen genannt, installieren während einer aktuell ausgeführten Installation ein weiteres Windows Installer Paket.</span><span class="sxs-lookup"><span data-stu-id="b2252-298">[Concurrent Installations](concurrent-installations.md), also called Nested Installations, install another Windows Installer package during a currently running installation.</span></span> <span data-ttu-id="b2252-299">Die Verwendung gleichzeitiger Installationen ist keine bewährte Vorgehensweise, da Sie für Kunden schwierig zu bedienen sind.</span><span class="sxs-lookup"><span data-stu-id="b2252-299">The use of concurrent installations is not a good practice because they are difficult for customers to service.</span></span> <span data-ttu-id="b2252-300">Das Patchen und Aktualisieren funktioniert möglicherweise nicht mit gleichzeitigen Installationen.</span><span class="sxs-lookup"><span data-stu-id="b2252-300">Patching and upgrading may not work with concurrent installations.</span></span> <span data-ttu-id="b2252-301">Die empfohlene Alternative zur Verwendung gleichzeitiger Installationen besteht darin, stattdessen eine Setup Anwendung und einen externen Benutzeroberflächen Handler zu verwenden, um mehrere Windows Installer Pakete nacheinander zu installieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-301">The recommended alternative to using concurrent installations is to instead use a setup application and external UI handler to install several Windows Installer packages sequentially.</span></span>

<span data-ttu-id="b2252-302">Weitere Informationen zur Verwendung eines externen UI-Handlers finden Sie unter über [Wachen einer Installation mithilfe von "msieintexternalui](monitoring-an-installation-using-msisetexternalui.md)".</span><span class="sxs-lookup"><span data-stu-id="b2252-302">For more information about using an external UI handler see [Monitoring an Installation Using MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span></span> <span data-ttu-id="b2252-303">Weitere Informationen zum Verwenden eines Daten Satz basierten externen Handlers finden Sie unter über [Wachen einer Installation mithilfe von "msieintexternaluirecord](monitoring-an-installation-using-msisetexternaluirecord.md)".</span><span class="sxs-lookup"><span data-stu-id="b2252-303">For more information about using a record-based external handler, see [Monitoring an Installation Using MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span></span>

<span data-ttu-id="b2252-304">Parallele Installationen werden manchmal in kontrollierten Unternehmensumgebungen verwendet, um Anwendungen zu installieren, die nicht für die Öffentlichkeit vorgesehen sind.</span><span class="sxs-lookup"><span data-stu-id="b2252-304">Concurrent installations are sometimes used in controlled corporate environments to install applications that are not intended for the public.</span></span> <span data-ttu-id="b2252-305">Befolgen Sie diese Richtlinien, wenn Sie sich entscheiden, parallele Installationen zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="b2252-305">Follow these guidelines if you decide to use concurrent installations.</span></span>

-   <span data-ttu-id="b2252-306">Verwenden Sie keine gleichzeitigen Installationen zum Installieren oder Aktualisieren eines Versand Produkts.</span><span class="sxs-lookup"><span data-stu-id="b2252-306">Do not use concurrent installations to install or update a shipping product.</span></span>
-   <span data-ttu-id="b2252-307">Bei gleichzeitigen Installationen sollten keine Komponenten gemeinsam genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-307">Concurrent installations should not share components.</span></span>
-   <span data-ttu-id="b2252-308">Eine administrative Installation sollte keine gleichzeitige Installation enthalten.</span><span class="sxs-lookup"><span data-stu-id="b2252-308">An administrative installation should not contain a concurrent installation.</span></span>
-   <span data-ttu-id="b2252-309">Integrierte progressbars sollten nicht mit gleichzeitigen Installationen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-309">Integrated ProgressBars should not be used with concurrent installations.</span></span>
-   <span data-ttu-id="b2252-310">Ressourcen, die angekündigt werden sollen, sollten nicht durch eine parallele Installation installiert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-310">Resources that are to be advertised should not be installed by a concurrent installation.</span></span>
-   <span data-ttu-id="b2252-311">Ein Paket, das eine parallele Installation einer Anwendung ausführt, sollte auch die gleichzeitige Anwendung deinstallieren, wenn das übergeordnete Produkt deinstalliert wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-311">A package that performs a concurrent installation of an application should also uninstall the concurrent application when the parent product is uninstalled.</span></span> <span data-ttu-id="b2252-312">Eine in der Systemsteuerung unter "Software" unter "Programme hinzufügen/entfernen" ist eine untergeordnete Installation im Kontext des übergeordneten Produkts vorhanden.</span><span class="sxs-lookup"><span data-stu-id="b2252-312">A nested installation exists under the context of the parent product in the Add/Remove Programs in Control Panel.</span></span>

## <a name="keep-package-names-and-package-codes-consistent"></a><span data-ttu-id="b2252-313">Halten Sie die Paketnamen und Paket Codes konsistent.</span><span class="sxs-lookup"><span data-stu-id="b2252-313">Keep package names and package codes consistent.</span></span>

<span data-ttu-id="b2252-314">Der MSI-Datei kann ein beliebiger Name zugewiesen werden, der Benutzern hilft, das Paket zu identifizieren, aber der Name sollte nicht geändert werden, ohne dass auch der Produktcode geändert wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-314">The .msi file can be given any name that helps users identify the package, but the name should not be changed without also changing the product code.</span></span>

-   <span data-ttu-id="b2252-315">Geben Sie der MSI-Datei einen benutzerfreundlichen Namen, mit dem der Benutzer den Inhalt des Windows Installer Pakets identifizieren kann.</span><span class="sxs-lookup"><span data-stu-id="b2252-315">Give your .msi file a user-friendly name that enables the user to identify the contents of the Windows Installer package.</span></span>
-   <span data-ttu-id="b2252-316">Der [Produktcode](product-codes.md) ist die Prinzipal Identifizierung einer Anwendung und muss sich ändern, wenn ein umfassendes Update der Anwendung vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-316">The [product code](product-codes.md) is the principal identification of an application and must change whenever there is a comprehensive update to the application.</span></span> <span data-ttu-id="b2252-317">Weitere Informationen finden Sie unter [**ProductCode**](productcode.md) und [Ändern des Produktcodes](changing-the-product-code.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-317">For information, see [**ProductCode**](productcode.md) and [Changing the Product Code](changing-the-product-code.md).</span></span> <span data-ttu-id="b2252-318">Das Ändern des Namens der MSI-Datei der Anwendung wird als umfassende Änderung angesehen und erfordert immer eine entsprechende Änderung des Produktcodes, um die Konsistenz zu gewährleisten.</span><span class="sxs-lookup"><span data-stu-id="b2252-318">Changing the name of the application's .msi file is considered a comprehensive change and always requires a corresponding change of the product code to maintain consistency.</span></span>
-   <span data-ttu-id="b2252-319">Der [Paket Code](package-codes.md) ist der primäre Bezeichner, der vom Installer verwendet wird, um das richtige Paket für eine bestimmte Installation zu suchen und zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="b2252-319">The [package code](package-codes.md) is the primary identifier used by the installer to search for and validate the correct package for a given installation.</span></span> <span data-ttu-id="b2252-320">Keine zwei nonidentical. msi-Dateien sollten jemals denselben Paketcode aufweisen.</span><span class="sxs-lookup"><span data-stu-id="b2252-320">No two nonidentical .msi files should ever have the same package code.</span></span> <span data-ttu-id="b2252-321">Wenn ein Paket geändert wird, ohne den Paket Code zu ändern, verwendet das Installationsprogramm ggf. das neuere Paket nicht, wenn auf beide weiterhin für den Installer zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="b2252-321">If a package is changed without changing the package code, the installer may not use the newer package if both are still accessible to the installer.</span></span> <span data-ttu-id="b2252-322">Der Paketcode wird in der [**Zusammenfassungs Eigenschaft "Revisionsnummer**](revision-number-summary.md) " des [Zusammenfassungs Informationsdaten Stroms](summary-information-stream.md)gespeichert.</span><span class="sxs-lookup"><span data-stu-id="b2252-322">The package code is stored in the [**Revision Number Summary**](revision-number-summary.md) Property of the [Summary Information Stream](summary-information-stream.md).</span></span>
-   <span data-ttu-id="b2252-323">Beachten Sie, dass Buchstaben in Produktcode und Paket Code- [GUIDs](guid.md) alle Großbuchstaben sein müssen.</span><span class="sxs-lookup"><span data-stu-id="b2252-323">Note that letters in product code and package code [GUIDs](guid.md) must all be uppercase.</span></span>

## <a name="do-not-use-the-selfreg-and-typelib-tables"></a><span data-ttu-id="b2252-324">Verwenden Sie die Tabellen "selfreg" und "TypeLib" nicht.</span><span class="sxs-lookup"><span data-stu-id="b2252-324">Do not use the SelfReg and TypeLib tables.</span></span>

-   <span data-ttu-id="b2252-325">Die Autoren von Installationspaketen werden dringend von der Verwendung der Selbstregistrierung und der Tabelle [selfreg](selfreg-table.md) abgeraten.</span><span class="sxs-lookup"><span data-stu-id="b2252-325">Installation package authors are strongly advised against using self registration and the [SelfReg](selfreg-table.md) table.</span></span> <span data-ttu-id="b2252-326">Stattdessen sollten Sie Module registrieren, indem Sie eine oder mehrere Tabellen in der [Registrierungs Tabellen Gruppe](registry-tables-group.md)erstellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-326">Instead they should register modules by authoring one or more of the tables in the [Registry Tables Group](registry-tables-group.md).</span></span> <span data-ttu-id="b2252-327">Viele der Vorteile der Windows Installer gehen bei der Selbstregistrierung verloren, da in der Regel selbst Registrierungs Routinen wichtige Konfigurationsinformationen ausgeblendet werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-327">Many of the benefits of the Windows Installer are lost with self registration because self-registration routines tend to hide critical configuration information.</span></span> <span data-ttu-id="b2252-328">Eine Liste der Gründe für die Vermeidung der Selbstregistrierung finden Sie unter [selfreg Table](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-328">For a list of the reasons for avoiding self registration see [SelfReg table](selfreg-table.md).</span></span>
-   <span data-ttu-id="b2252-329">Autoren von Installationspaketen wird dringend empfohlen, die [typelib](typelib-table.md) -Tabelle zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="b2252-329">Installation package authors are strongly advised against using the [TypeLib](typelib-table.md) table.</span></span> <span data-ttu-id="b2252-330">Anstatt die TypeLib-Tabelle zu verwenden, registrieren Sie Typbibliotheken mithilfe der [Registrierungs](registry-table.md) Tabelle.</span><span class="sxs-lookup"><span data-stu-id="b2252-330">Instead of using the TypeLib table, register type libraries by using [Registry](registry-table.md) table.</span></span> <span data-ttu-id="b2252-331">Wenn eine Installation mit der TypeLib-Tabelle fehlschlägt und ein Rollback ausgeführt werden muss, wird der Computer vom Rollback möglicherweise nicht in demselben Zustand wieder hergestellt, der vor dem Rollback vorhanden war.</span><span class="sxs-lookup"><span data-stu-id="b2252-331">If an installation using the TypeLib table fails and must be rolled back, the rollback may not restore the computer to the same state that existed prior to the rollback.</span></span>

## <a name="provide-the-option-to-install-without-a-user-interface"></a><span data-ttu-id="b2252-332">Stellen Sie die Option zur Installation ohne Benutzeroberfläche bereit.</span><span class="sxs-lookup"><span data-stu-id="b2252-332">Provide the option to install without a user interface.</span></span>

<span data-ttu-id="b2252-333">Administratoren bevorzugen häufig die Bereitstellung von Anwendungen innerhalb einer Corporation, ohne dass eine Benutzerinteraktion erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-333">Administrators often prefer to deploy applications within a corporation without requiring user interaction.</span></span> <span data-ttu-id="b2252-334">Es empfiehlt sich, die Anwendung für die Bereitstellung der Option zu aktivieren, die mit der [Benutzeroberflächen Ebene](user-interface-levels.md) "None" installiert wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-334">It is good practice to enable your application to provide the option of being installed with the [user interface level](user-interface-levels.md) of None.</span></span>

-   <span data-ttu-id="b2252-335">Verwenden Sie [öffentliche Eigenschaften](public-properties.md) für Konfigurationsinformationen.</span><span class="sxs-lookup"><span data-stu-id="b2252-335">Use [public properties](public-properties.md) for configuration information.</span></span> <span data-ttu-id="b2252-336">Administratoren können diese Informationen über die Befehlszeile bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-336">Administrators can provide this information on the command-line.</span></span>
-   <span data-ttu-id="b2252-337">Es ist nicht erforderlich, dass die Installation von Informationen abhängig ist, die von der Benutzerinteraktion mit Dialogfeldern gesammelt wurden.</span><span class="sxs-lookup"><span data-stu-id="b2252-337">Do not require that the installation depend upon information gathered from user interaction with dialog boxes.</span></span> <span data-ttu-id="b2252-338">Diese Informationen sind während einer automatischen Installation nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="b2252-338">This information is not available during a silent installation.</span></span>
-   <span data-ttu-id="b2252-339">Der Computer des Benutzers wird während einer automatischen Installation nicht automatisch neu gestartet.</span><span class="sxs-lookup"><span data-stu-id="b2252-339">Do not automatically restart the user's computer during a silent installation.</span></span>
-   <span data-ttu-id="b2252-340">Administratoren können die [Ebene der Benutzeroberfläche](user-interface-levels.md) bei der Installation mithilfe der [Befehlszeilenoption](command-line-options.md) "/q" festlegen.</span><span class="sxs-lookup"><span data-stu-id="b2252-340">Administrators can set the [user interface level](user-interface-levels.md) when installing by using the [command line option](command-line-options.md) "/q".</span></span> <span data-ttu-id="b2252-341">Die Benutzeroberflächen Ebene kann auch Programm gesteuert mit einem [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui)-Befehl festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-341">The user interface level can also be set programmatically with a call to [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span></span>

## <a name="avoid-using-the-alwaysinstallelevated-policy"></a><span data-ttu-id="b2252-342">Vermeiden Sie die Verwendung der alwaysinstallerhöhten-Richtlinie.</span><span class="sxs-lookup"><span data-stu-id="b2252-342">Avoid using the AlwaysInstallElevated policy.</span></span>

<span data-ttu-id="b2252-343">Wenn die Richtlinie [alwaysinstallerhöhten](alwaysinstallelevated.md) nicht festgelegt ist, werden Anwendungen, die nicht vom Administrator verteilt werden, mit den Berechtigungen des Benutzers installiert, und nur verwaltete Anwendungen erhalten erhöhte Rechte.</span><span class="sxs-lookup"><span data-stu-id="b2252-343">If the [AlwaysInstallElevated](alwaysinstallelevated.md) policy is not set, applications not distributed by the administrator are installed using the user's privileges and only managed applications get elevated privileges.</span></span> <span data-ttu-id="b2252-344">Durch Festlegen dieser Richtlinie wird Windows Installer angewiesen, System Berechtigungen zu verwenden, wenn die Anwendung auf dem System installiert wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-344">Setting this policy directs Windows Installer to use system permissions when it installs the application on the system.</span></span> <span data-ttu-id="b2252-345">Diese Methode kann einen Computer mit einem Sicherheitsrisiko öffnen, denn wenn diese Richtlinie festgelegt ist, kann ein Benutzer, der nicht Administrator ist, Installationen mit [*erhöhten*](e-gly.md) Rechten ausführen und auf sichere Speicherorte auf dem Computer zugreifen.</span><span class="sxs-lookup"><span data-stu-id="b2252-345">This method can open a computer to a security risk, because when this policy is set, a non-administrator user can run installations with [*elevated*](e-gly.md) privileges and access secure locations on the computer.</span></span> <span data-ttu-id="b2252-346">Es empfiehlt sich, eine andere Methode als die alwaysinstallerhöhten-Richtlinie zu verwenden, wenn Sie [ein Paket mit erhöhten Rechten für ein nicht-Administrator-](installing-a-package-with-elevated-privileges-for-a-non-admin.md) oder [Patching-Per-User verwaltete Anwendungen](patching-per-user-managed-applications.md)installieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-346">It is a good practice to use another method than the AlwaysInstallElevated policy when [Installing a Package with Elevated Privileges for a Non-Admin](installing-a-package-with-elevated-privileges-for-a-non-admin.md) or [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

## <a name="enable-the-disablemedia-policy-to-limit-unauthorized-installation"></a><span data-ttu-id="b2252-347">Aktivieren Sie die disablemedia-Richtlinie, um die nicht autorisierte Installation einzuschränken</span><span class="sxs-lookup"><span data-stu-id="b2252-347">Enable the DisableMedia policy to limit unauthorized installation.</span></span>

<span data-ttu-id="b2252-348">Die [disablemedia](disablemedia.md) -Richtlinie kann eine nicht autorisierte Installation von Anwendungen verhindern.</span><span class="sxs-lookup"><span data-stu-id="b2252-348">The [DisableMedia](disablemedia.md) policy can prevent unauthorized installation of applications.</span></span> <span data-ttu-id="b2252-349">Wenn diese Richtlinie aktiviert ist, können Benutzer und Administratoren, die eine Wartungs Installation eines Produkts ausführen, das Dialog Feld "Durchsuchen" nicht zum Durchsuchen von Medienquellen (z. b. CD-ROM) für die Quellen anderer installier barer Produkte verwenden.</span><span class="sxs-lookup"><span data-stu-id="b2252-349">When this policy is enabled, users and administrators running a maintenance installation of one product are prevented from using the Browse Dialog to browse media sources, such as CD-ROM, for the sources of other installable products.</span></span> <span data-ttu-id="b2252-350">Das Durchsuchen anderer Produkte wird verhindert, unabhängig davon, ob die Installation mit erweiterten Berechtigungen erfolgt.</span><span class="sxs-lookup"><span data-stu-id="b2252-350">Browsing for other products is prevented regardless of whether the installation is done with elevated privileges.</span></span> <span data-ttu-id="b2252-351">Der Benutzer kann das Produkt weiterhin von einem Medium aus neu installieren, wenn der Benutzer über eine ordnungsgemäß bezeichnete Medienquelle verfügt.</span><span class="sxs-lookup"><span data-stu-id="b2252-351">It is still possible for the user to reinstall the product from media if the user has a correctly labeled media source.</span></span>

## <a name="keep-the-original-package-source-files-secure-and-available-to-users"></a><span data-ttu-id="b2252-352">Sorgen Sie dafür, dass die ursprünglichen Paket Quelldateien sicher und für Benutzer verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="b2252-352">Keep the original package source files secure and available to users.</span></span>

<span data-ttu-id="b2252-353">In einigen Fällen ist die ursprüngliche Quelle des Windows Installer Pakets möglicherweise erforderlich, um eine Anwendung zu installieren, zu reparieren oder zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-353">In some cases the original source of the Windows Installer package may be needed to install-on-demand, repair, or update an application.</span></span> <span data-ttu-id="b2252-354">Wenn das Installationsprogramm eine verfügbare Quelle nicht finden kann, wird der Benutzer aufgefordert, Medien bereitzustellen oder zu einem Netzwerk Speicherort zu wechseln, der die benötigten Quellen enthält.</span><span class="sxs-lookup"><span data-stu-id="b2252-354">If the installer is unable to locate an available source, the user is asked to provide media or to go to a network location containing the needed sources.</span></span> <span data-ttu-id="b2252-355">Es wird empfohlen, sicherzustellen, dass das Installationsprogramm über die benötigten Quellen verfügt, ohne dass der Benutzer dazu aufgefordert werden muss.</span><span class="sxs-lookup"><span data-stu-id="b2252-355">It is a good practice to ensure that the installer has the sources it needs without having to prompt the user.</span></span>

-   <span data-ttu-id="b2252-356">Verwenden Sie [digitale Signaturen und externe CAB-Dateien](digital-signatures-and-external-cabinet-files.md) , um sicherzustellen, dass die vom Installationsprogramm verwendeten Quellen sicher sind.</span><span class="sxs-lookup"><span data-stu-id="b2252-356">Use [Digital Signatures and External Cabinet Files](digital-signatures-and-external-cabinet-files.md) to ensure that the origial sources being used by the installer are secure.</span></span> <span data-ttu-id="b2252-357">Ein unkomprimiertes Quell Image, das an einem öffentlichen Speicherort gespeichert ist, ist nicht sicher.</span><span class="sxs-lookup"><span data-stu-id="b2252-357">An uncompressed source image stored in an public location is not secure.</span></span>
-   <span data-ttu-id="b2252-358">Fügen Sie eine komplette Liste der Netzwerk-oder URL-Quell Pfade zum Installationspaket der Anwendung in die [**SourceList**](sourcelist.md) -Eigenschaft ein.</span><span class="sxs-lookup"><span data-stu-id="b2252-358">Include a complete list of network or URL source paths to the application's installation package in the [**SOURCELIST**](sourcelist.md) property.</span></span>
-   <span data-ttu-id="b2252-359">Verwenden Sie für den Quellpfad eine DFS-Freigabe (verteiltes Dateisystem).</span><span class="sxs-lookup"><span data-stu-id="b2252-359">Use a Distributed File System (DFS) share for the source path.</span></span>
-   <span data-ttu-id="b2252-360">Verwenden Sie die Windows Installer-API, um Quell Listen Informationen für Windows Installer Anwendungen und Patches abzurufen und zu ändern.</span><span class="sxs-lookup"><span data-stu-id="b2252-360">Use the Windows Installer API to retrieve and modify source list information for Windows Installer applications and patches.</span></span> <span data-ttu-id="b2252-361">Weitere Informationen finden Sie unter [Verwalten von Installations Quellen](managing-installation-sources.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-361">For information see [Managing Installation Sources](managing-installation-sources.md).</span></span>
-   <span data-ttu-id="b2252-362">Verwenden Sie die Methoden und Eigenschaften des [**Installerobjekts**](installer-object.md), des [**Product-Objekts**](product-object.md)und des [**Patch-Objekts**](patch-object.md) , um Quell Listen Informationen für Windows Installer Anwendungen und Patches abzurufen und zu ändern.</span><span class="sxs-lookup"><span data-stu-id="b2252-362">Use the methods and properties of the [**Installer Object**](installer-object.md), [**Product Object**](product-object.md), and [**Patch Object**](patch-object.md) to retrieve and modify source list information for Windows Installer applications and patches.</span></span>
-   <span data-ttu-id="b2252-363">Beachten Sie die unter verhindern der Verwendung [des Zugriffs auf die ursprünglichen Installations Quell](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) Punkte aufgeführten Punkte, um die Möglichkeit zu minimieren, dass Ihr Patch Zugriff auf die ursprünglichen Quellen benötigt.</span><span class="sxs-lookup"><span data-stu-id="b2252-363">Adhere to points listed in [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) points to minimize the possibility that your patch will require access to the original sources.</span></span>
-   <span data-ttu-id="b2252-364">Speichern Sie die Paket Quelldateien an einem Speicherort, bei dem es sich nicht um den temporären Ordner des Systems handelt.</span><span class="sxs-lookup"><span data-stu-id="b2252-364">Store the package source files in a location that is not the system's temporary folder.</span></span> <span data-ttu-id="b2252-365">Windows Installer im temporären Ordner gespeicherten Quelldateien können Benutzern nicht mehr zur Verfügung stehen.</span><span class="sxs-lookup"><span data-stu-id="b2252-365">Windows Installer source files stored in the temporary folder can become unavailable to users.</span></span>

## <a name="enable-verbose-logging-on-users-computer-when-troubleshooting-deployment"></a><span data-ttu-id="b2252-366">Aktivieren Sie die ausführliche Protokollierung auf dem Computer des Benutzers bei der Problembehandlung.</span><span class="sxs-lookup"><span data-stu-id="b2252-366">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>

<span data-ttu-id="b2252-367">[Windows Installer Protokollierung](windows-installer-logging.md) schließt eine ausführliche Protokollierungs Option ein, die auf dem Computer eines Benutzers aktiviert werden kann.</span><span class="sxs-lookup"><span data-stu-id="b2252-367">[Windows Installer Logging](windows-installer-logging.md) includes a verbose logging option that can be enabled on a user's computer.</span></span> <span data-ttu-id="b2252-368">Die Informationen in einem ausführlichen Protokoll können bei der Problembehandlung Windows Installer Paket Bereitstellung hilfreich sein.</span><span class="sxs-lookup"><span data-stu-id="b2252-368">The information in a verbose log can helpful when trying to troubleshoot Windows Installer package deployment.</span></span>

-   <span data-ttu-id="b2252-369">Sie können die ausführliche Protokollierung auf dem Computer des Benutzers aktivieren, indem Sie die [Befehlszeilenoptionen](command-line-options.md), die [**MsiLogging**](msilogging.md) -Eigenschaft, die [Protokollierungs Richtlinie](logging.md), die [**msienablelog**](/windows/desktop/api/Msi/nf-msi-msienableloga)und die [**EnableLog**](installer-enablelog.md) -Methode verwenden.</span><span class="sxs-lookup"><span data-stu-id="b2252-369">You can enable verbose logging on the user's computer by using [Command Line Options](command-line-options.md), the [**MsiLogging**](msilogging.md) property, [Logging policy](logging.md), [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga), and [**EnableLog**](installer-enablelog.md) method.</span></span>
-   <span data-ttu-id="b2252-370">Eine sehr nützliche Ressource zum interpretieren Windows Installer Protokolldateien ist [Wilogutl.exe](wilogutl-exe.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-370">A very useful resource for interpreting Windows Installer log files is [Wilogutl.exe](wilogutl-exe.md).</span></span> <span data-ttu-id="b2252-371">Dieses Tool unterstützt die Analyse von Protokolldateien und zeigt vorgeschlagene Lösungen für Fehler an, die in einer Protokolldatei gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-371">This tool assists the analysis of log files and displays suggested solutions to errors that are found in a log file.</span></span>
-   <span data-ttu-id="b2252-372">Weitere Informationen zur Interpretation Windows Installer Protokolldateien finden Sie im Whitepaper auf der TechNet-Website: [Windows Installer: Vorteile und Implementierung für System Administratoren](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span><span class="sxs-lookup"><span data-stu-id="b2252-372">For more information about interpreting Windows Installer log files, see the white paper available on the TechNet site: [Windows Installer: Benefits and Implementation for System Administrators](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span></span>
-   <span data-ttu-id="b2252-373">Die Protokollierungs Option "ausführliche" sollte nur zur Problembehandlung verwendet werden und sollte nicht beibehalten werden, da dies negative Auswirkungen auf die Systemleistung und den Speicherplatz haben kann.</span><span class="sxs-lookup"><span data-stu-id="b2252-373">The verbose logging option should be used only for troubleshooting purposes and should not be left on because it can have adverse effects on system performance and disk space.</span></span> <span data-ttu-id="b2252-374">Jedes Mal, wenn Sie das Tool "Software" in der Systemsteuerung verwenden, wird eine neue Datei erstellt.</span><span class="sxs-lookup"><span data-stu-id="b2252-374">Each time you use the Add/Remove Programs tool in Control Panel, a new file is created.</span></span>

## <a name="uninstallation-leaves-the-users-computer-in-a-clean-state"></a><span data-ttu-id="b2252-375">Bei der Installation bleibt der Computer des Benutzers in einem sauberen Zustand.</span><span class="sxs-lookup"><span data-stu-id="b2252-375">Uninstallation leaves the user's computer in a clean state.</span></span>

<span data-ttu-id="b2252-376">Die Anwendungs Entfernung ist so wichtig wie die Installation.</span><span class="sxs-lookup"><span data-stu-id="b2252-376">Application removal is as important as installation.</span></span> <span data-ttu-id="b2252-377">Wenn ein Windows Installer Paket deinstalliert wird, sollte es nicht nutzlose Teile von sich selbst auf dem Computer des Benutzers zurückbleiben.</span><span class="sxs-lookup"><span data-stu-id="b2252-377">When a Windows Installer package is uninstalled it should leave no useless parts of itself behind on the user's computer.</span></span>

-   <span data-ttu-id="b2252-378">Wenn eine Datei, die auf dem Computer des Benutzers entfernt worden sein soll, nach dem Ausführen einer Deinstallation weiterhin installiert ist, entfernt das Installationsprogramm möglicherweise nicht die Komponente, die die Datei enthält, aus einem oder mehreren der unter [Entfernen von Dateien](removing-stranded-files.md)mit den Dateien beschriebenen Gründen.</span><span class="sxs-lookup"><span data-stu-id="b2252-378">If a file that should have been removed from the user's computer remains installed after running an uninstall, the installer may not be removing the component containing the file for one or more of the reasons described in [Removing Stranded Files](removing-stranded-files.md).</span></span>
-   <span data-ttu-id="b2252-379">Wenn eine Anwendung registriert werden muss, erstellen Sie das Paket, um Registrierungsinformationen zu entfernen, wenn die Anwendung deinstalliert wird.</span><span class="sxs-lookup"><span data-stu-id="b2252-379">If an application must be registered, author the package to remove registry information when the application is uninstalled.</span></span> <span data-ttu-id="b2252-380">Weitere Informationen finden Sie [unter Hinzufügen oder Entfernen von Registrierungs Schlüsseln für die Installation oder Entfernung von-Komponenten](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-380">For information see [Adding or Removing Registry Keys on the Installation or Removal of Components](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span></span> <span data-ttu-id="b2252-381">Wenn eine Anwendung nicht registriert ist, wird die Anwendung in der Systemsteuerung nicht in der Funktion "Software" aufgeführt und kann nicht mit dem Windows Installer verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-381">If an application is not registered, the application is not listed in the Add or Remove Programs feature in Control Panel and cannot be managed by using the Windows Installer.</span></span>
-   <span data-ttu-id="b2252-382">Wenn Sie eine Anwendung in der Systemsteuerung über das Feature "Software" ausblenden möchten und weiterhin den Windows Installer zur Verwaltung der Anwendung verwenden können, befolgen Sie die Anweisungen unter [Hinzufügen und Entfernen einer Anwendung und belassen der Registrierung in der Registrierung](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-382">To hide an application from the Add or Remove Programs feature in Control Panel and still be able to use the Windows Installer to manage the application, follow the guidelines described in [Adding and Removing an Application and Leaving No Trace in the Registry](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span></span>
-   <span data-ttu-id="b2252-383">Benutzerdefinierte Aktionen sollten bei der Neuinstallation für die Durchführung von oder nicht erforderlich sein.</span><span class="sxs-lookup"><span data-stu-id="b2252-383">Custom actions should be conditioned to run or not as needed upon uninstallation.</span></span> <span data-ttu-id="b2252-384">Bei der Installation und Deinstallation müssen möglicherweise unterschiedliche benutzerdefinierte Aktionen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-384">Different custom actions may need to run on install and uninstall.</span></span>
-   <span data-ttu-id="b2252-385">Benutzerspezifische Anpassungs Informationen können in einer Textdatei auf dem Computer gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-385">User-specific customization information can be stored in a text file on the computer.</span></span> <span data-ttu-id="b2252-386">Dies hat den Vorteil, dass die Datei entfernt werden kann, wenn die Anwendung deinstalliert wird, auch wenn der Benutzer dieser Anpassung derzeit nicht angemeldet ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-386">This has the advantage that the file can be removed when the application is uninstalled, even if the user of this customization is not currently logged on.</span></span>

## <a name="test-packages-for-both-per-user-and-per-machine-installation-deployment"></a><span data-ttu-id="b2252-387">Test Pakete für die Bereitstellung pro Benutzer und pro Computerinstallation.</span><span class="sxs-lookup"><span data-stu-id="b2252-387">Test packages for both per-user and per-machine installation deployment.</span></span>

<span data-ttu-id="b2252-388">Es empfiehlt sich, den Kunden zu ermöglichen, zu entscheiden, ob ein Paket für die Installation entweder im Computer-oder benutzerspezifischen [Installations Kontext](installation-context.md)bereitgestellt werden soll.</span><span class="sxs-lookup"><span data-stu-id="b2252-388">It is good practice to enable customers to decide whether to deploy a package for installation in either the per-machine or per-user [installation context](installation-context.md).</span></span>

-   <span data-ttu-id="b2252-389">Berücksichtigen Sie, ob die Anwendung während des Entwicklungsprozesses nur für bestimmte Benutzer oder alle Benutzer des Computers verfügbar sein soll.</span><span class="sxs-lookup"><span data-stu-id="b2252-389">Consider whether the application should be available to only particular users or all users of the computer during the development process.</span></span>
-   <span data-ttu-id="b2252-390">Überprüfen Sie, ob das Paket sowohl für die Installation pro Benutzer als auch für Computer spezifische Installations Kontexte ordnungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="b2252-390">Test that the package works correctly for both the per-user installation and per-machine installation contexts.</span></span>
-   <span data-ttu-id="b2252-391">Sorgen Sie dafür, dass das Paket problemlos anpassbar ist, und lassen Sie Kunden entscheiden, ob Sie Sie pro Benutzer oder pro Computer bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-391">Make the package easily customizable and let customers decide whether to deploy it per-user or per-machine.</span></span>

## <a name="plan-and-test-a-servicing-strategy-before-shipping-the-application"></a><span data-ttu-id="b2252-392">Planen und testen Sie eine Wartungsstrategie, bevor Sie die Anwendung versenden.</span><span class="sxs-lookup"><span data-stu-id="b2252-392">Plan and test a servicing strategy before shipping the application.</span></span>

<span data-ttu-id="b2252-393">Sie sollten entscheiden, wie Sie die Anwendung bereitstellen möchten, bevor Sie die Anwendung zum ersten Mal bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-393">You should decide how you intend to service the application before deploying the application for the first time.</span></span>

-   <span data-ttu-id="b2252-394">Beachten Sie die Aktualisierungs Typen, die Sie für die spätere Verwendung Ihrer Anwendung erwarten.</span><span class="sxs-lookup"><span data-stu-id="b2252-394">Consider the types of updates you expect to use to service your application in the future.</span></span> <span data-ttu-id="b2252-395">Der Windows Installer stellt drei Arten von Updates bereit: [kleine Updates](small-updates.md), [kleinere](minor-upgrades.md)Upgrades und [größere Upgrades](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-395">The Windows Installer provides three types of updates: [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="b2252-396">Die Unterschiede zwischen diesen werden im Thema [Patching und Upgrades](patching-and-upgrades.md) beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b2252-396">The differences between these are described in [Patching and Upgrades](patching-and-upgrades.md) topic.</span></span>
-   <span data-ttu-id="b2252-397">Bevor Sie Ihre Anwendung versenden, testen Sie, ob Sie nach der Wartung mit den einzelnen Update Typen erwartungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="b2252-397">Before shipping your application, test that it works as expected after servicing with each update type.</span></span>

## <a name="reduce-the-dependency-of-updates-upon-the-original-sources"></a><span data-ttu-id="b2252-398">Reduzieren Sie die Abhängigkeit von Updates auf den ursprünglichen Quellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-398">Reduce the dependency of updates upon the original sources.</span></span>

<span data-ttu-id="b2252-399">Wenn die ursprünglichen Quelldateien erforderlich sind, um Ihre Anwendung zu aktualisieren, kann dies die Wartung der Anwendung erschweren.</span><span class="sxs-lookup"><span data-stu-id="b2252-399">If the original source files are required to update your application, this can make servicing the application more difficult.</span></span> <span data-ttu-id="b2252-400">Die folgenden Methoden können dabei helfen, die Abhängigkeit von Updates auf den ursprünglichen Quellen zu verringern.</span><span class="sxs-lookup"><span data-stu-id="b2252-400">The following methods can help reduce the dependence of updates upon the original sources.</span></span>

-   <span data-ttu-id="b2252-401">Verwenden Sie zum Aktualisieren der Baselineversion der Anwendung einen [*Delta Patch*](d-gly.md) , z. b. die RTM-Version und die Service Pack Versionen.</span><span class="sxs-lookup"><span data-stu-id="b2252-401">Use a [*delta patch*](d-gly.md) to update the baseline versions of your application, such as the RTM version and the service pack versions.</span></span> <span data-ttu-id="b2252-402">Befolgen Sie die Richtlinien für die Verwendung von Delta Patches, die im Thema: [verringern der Patchgröße](reducing-patch-size.md)beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-402">Follow the guidelines for using delta patches described in the topic: [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="b2252-403">Befolgen Sie die Empfehlungen im Thema: [verhindern, dass ein Patch Zugriff auf die ursprüngliche Installationsquelle erfordert](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-403">Follow the recommendations listed in the topic: [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span></span>

## <a name="do-not-distribute-unserviceable-merge-modules"></a><span data-ttu-id="b2252-404">Nicht servierbar-Mergemodule verteilen.</span><span class="sxs-lookup"><span data-stu-id="b2252-404">Do not distribute unserviceable merge modules.</span></span>

<span data-ttu-id="b2252-405">Anwendungen sollten nicht von [Mergemodulen](merge-modules.md) für die Installation der-Komponente abhängen, wenn sich der Besitzer des Mergemoduls und der Besitzer der Anwendung unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="b2252-405">Applications should not depend on [merge modules](merge-modules.md) for the installation of component if the owner of the merge module and the owner of the application are different.</span></span> <span data-ttu-id="b2252-406">Dies kann das bedienen der Anwendung erschweren, da beide Besitzer koordinieren müssen, um die Anwendung oder das Modul zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-406">This can make it difficult to service the application because both owners need to coordinate to update the application or module.</span></span> <span data-ttu-id="b2252-407">Ohne alle Anwendungen zu kennen, die das Mergemodul verwendet haben, kann der Besitzer der Anwendung das Mergemodul nicht aktualisieren, ohne zu riskieren, dass das Update möglicherweise nicht mit einer anderen Anwendung kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-407">Without knowing all the applications that have used the merge module, the owner of the application is unable update the merge module without risking that the update might be incompatible with another application.</span></span> <span data-ttu-id="b2252-408">Der Besitzer des Mergemoduls verfügt über keine direkte Methode zum Aktualisieren von Windows Installer Paketen, auf denen das Mergemodul bereits installiert ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-408">The owner of the merge module has no direct method for updating Windows Installer packages that have already installed the merge module.</span></span>

-   <span data-ttu-id="b2252-409">Es empfiehlt sich, den Benutzern die erforderlichen Komponenten als weitere Windows Installer-Installation bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-409">Consider providing the needed components to users as another Windows Installer installation.</span></span>

## <a name="avoid-patching-administrative-installations"></a><span data-ttu-id="b2252-410">Vermeiden Sie das Patchen administrativer Installationen.</span><span class="sxs-lookup"><span data-stu-id="b2252-410">Avoid patching administrative installations.</span></span>

<span data-ttu-id="b2252-411">Stellen Sie in einem Netzwerk eine [Administrative Installation](administrative-installation.md) des ursprünglichen Windows Installer Pakets Ihrer Anwendung bereit, um Mitgliedern einer Arbeitsgruppe die Installation der Anwendung zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="b2252-411">Provide on a network an [administrative installation](administrative-installation.md) of your application's original Windows Installer package to enable members of a workgroup to install the application.</span></span> <span data-ttu-id="b2252-412">Benutzer dieses administrativen Abbilds sollten dann Updates auf die lokale Instanz der Anwendung auf dem Computer anwenden.</span><span class="sxs-lookup"><span data-stu-id="b2252-412">Users of this administrative image should then apply updates to the local instance of the application located on their computer.</span></span> <span data-ttu-id="b2252-413">Dies sorgt dafür, dass die Benutzer mit dem administrativen Abbild synchronisiert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-413">This keeps users in synchronization with the administrative image.</span></span> <span data-ttu-id="b2252-414">Das Anwenden von Updates auf die administrative Installation wird aus den folgenden Gründen nicht empfohlen.</span><span class="sxs-lookup"><span data-stu-id="b2252-414">Applying updates to the administrative installation is not recommended for the following reasons.</span></span>

-   <span data-ttu-id="b2252-415">Die Größe und Latenz des Downloads, die für Benutzer zum Abrufen eines Updates erforderlich sind, wird im Vergleich zum Herunterladen eines Patches erweitert.</span><span class="sxs-lookup"><span data-stu-id="b2252-415">The size and latency of the download required for users to obtain an update is increased compared to downloading a patch.</span></span> <span data-ttu-id="b2252-416">Das gesamte aktualisierte Windows Installer Paket und die Quelldateien müssen heruntergeladen, wiederholt und neu installiert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-416">The entire updated Windows Installer package and source files must download, recached, and reinstalled.</span></span>
-   <span data-ttu-id="b2252-417">Benutzer können die [Installation nach Bedarf](installation-on-demand.md) nicht durchlaufen und Anwendungen von einer aktualisierten administrativen Installation reparieren, bis Sie die Anwendung wiederholen und erneut installieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-417">Users are unable to [installation-on-demand](installation-on-demand.md) and repair applications from an updated administrative installation until they recache and reinstall the application.</span></span>
-   <span data-ttu-id="b2252-418">Wenn Sie einen Patch auf eine administrative Installation anwenden, wird die digitale Signatur aus dem Paket entfernt.</span><span class="sxs-lookup"><span data-stu-id="b2252-418">Applying a patch to an administrative installation removes the digital signature from the package.</span></span> <span data-ttu-id="b2252-419">Ein Administrator muss das Paket zurückziehen.</span><span class="sxs-lookup"><span data-stu-id="b2252-419">An administrator must resign the package.</span></span> <span data-ttu-id="b2252-420">Weitere Informationen zur Verwendung digitaler Signaturen finden Sie unter [digitale Signaturen und Windows Installer](digital-signatures-and-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-420">For more information about using digital signatures, see [Digital Signatures and Windows Installer](digital-signatures-and-windows-installer.md).</span></span>
-   <span data-ttu-id="b2252-421">Viele binäre Patches Zielen auf das RTM-Image der Anwendung ab und erfordern eine vorherige Dateiversion.</span><span class="sxs-lookup"><span data-stu-id="b2252-421">Many binary patches target the RTM image of the application and require a previous file version.</span></span> <span data-ttu-id="b2252-422">Die lokale Instanz einer Anwendung, die über eine aktualisierte administrative Installation installiert wurde, funktioniert möglicherweise nicht mit anderen Updates.</span><span class="sxs-lookup"><span data-stu-id="b2252-422">The local instance of an application installed from an updated administrative installation may not work with other updates.</span></span> <span data-ttu-id="b2252-423">Viele binäre patchanwendungen können fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="b2252-423">Many binary patch applications can fail.</span></span>
-   <span data-ttu-id="b2252-424">Wenn Sie einen Patch auf eine administrative Installation anwenden, werden die Quelldateien und die MSI-Datei aktualisiert, aber das Netzwerk Image wird nicht mit Informationen über das Update versehen.</span><span class="sxs-lookup"><span data-stu-id="b2252-424">Applying a patch to an administrative installation updates the source files and the .msi file but does not stamp the network image with information about the update.</span></span> <span data-ttu-id="b2252-425">Benutzer können nicht ermitteln, welche Updates von der administrativen Installation empfangen wurden.</span><span class="sxs-lookup"><span data-stu-id="b2252-425">Users cannot determine which updates they have received from the administrative installation.</span></span> <span data-ttu-id="b2252-426">Dadurch ist es unmöglich, auf der Benutzerseite angewendete Updates mit denjenigen zu sequenzieren, die bereits auf dem Administrator Image angewendet wurden.</span><span class="sxs-lookup"><span data-stu-id="b2252-426">This makes it impossible to sequence updates applied on the user side with those already applied on the administrative image side.</span></span>
-   <span data-ttu-id="b2252-427">Patches, die auf eine administrative Installation angewendet werden, sind keine nicht [installierbaren Patches](uninstallable-patches.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-427">Patches applied to an administrative installation are not [uninstallable patches](uninstallable-patches.md).</span></span> <span data-ttu-id="b2252-428">Dadurch kann verhindert werden, dass sich der auf dem Computer des Benutzers zwischengespeicherte Paketcode von dem Paket Code bei der administrativen Installation unterscheidet.</span><span class="sxs-lookup"><span data-stu-id="b2252-428">This can prevent the package code cached on the user's computer from becoming different than the package code on the administrative installation.</span></span> <span data-ttu-id="b2252-429">Wenn sich der Paket Code, der auf dem Computer des Benutzers zwischengespeichert ist, von dem auf dem Computer des Benutzers unterscheidet, installieren Sie die Anwendung über die administrative Installation neu, und Patchen Sie dann den Client Computer.</span><span class="sxs-lookup"><span data-stu-id="b2252-429">If the package code cached on the user's computer becomes different from that on the administrative installation, reinstall the application from the administrative installation and then patch the client computer.</span></span>
-   <span data-ttu-id="b2252-430">Wenn Sie sich dazu entschließen, kleine Updates durch das Patchen eines administrativen Abbilds anzuwenden, befolgen Sie die im Thema: [anwenden kleiner Updates durch Patchen eines administrativen Abbilds](applying-small-updates-by-patching-an-administrative-image.md)beschriebenen Richtlinien.</span><span class="sxs-lookup"><span data-stu-id="b2252-430">If you decide to apply small updates by patching an administrative image, follow the guidelines described in the topic: [Applying Small Updates by Patching an Administrative Image](applying-small-updates-by-patching-an-administrative-image.md).</span></span>

## <a name="register-updates-to-run-with-elevated-privilege"></a><span data-ttu-id="b2252-431">Registrieren von Updates, die mit erhöhten Rechten ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-431">Register updates to run with elevated privilege.</span></span>

<span data-ttu-id="b2252-432">Ab Windows Installer 3,0 ist es möglich, Patches auf eine Anwendung anzuwenden, die in einem Benutzer verwalteten Kontext installiert wurde, nachdem der Patch als erweiterte Berechtigungen registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="b2252-432">Beginning with Windows Installer 3.0, it is possible to apply patches to an application that has been installed in a per-user-managed context, after the patch has been registered as having elevated privileges.</span></span> <span data-ttu-id="b2252-433">Patches können nicht auf Anwendungen angewendet werden, die in einem pro Benutzer verwalteten Kontext unter Verwendung von Versionen von Windows Installer vor Version 3,0 installiert sind.</span><span class="sxs-lookup"><span data-stu-id="b2252-433">You cannot apply patches to applications that are installed in a per-user managed context using versions of Windows Installer earlier than version 3.0.</span></span>

-   <span data-ttu-id="b2252-434">Verwenden Sie die [**sourcelistaddsource**](patch-sourcelistaddsource.md) -Methode oder die [**msisourcelistaddsourceex**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) -Funktion, um ein Patchpaket mit erhöhten Rechten zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-434">Use the [**SourceListAddSource**](patch-sourcelistaddsource.md) method or [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to register a patch package as having elevated privileges.</span></span> <span data-ttu-id="b2252-435">Befolgen Sie die Richtlinien und Beispiele für das [Patchen Per-User verwaltete Anwendungen](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-435">Follow the guidelines and examples provided in [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>
-   <span data-ttu-id="b2252-436">Wenn Sie Windows Installer Version 4,0 unter Windows Vista ausführen, können Sie auch das [Patchen der Benutzerkontensteuerung (User Account Control, UAC)](user-account-control--uac--patching.md) verwenden, um den Autoren von Windows Installer Installationen die Identifizierung Digital signierter Patches zu ermöglichen, die in Zukunft von Benutzern ohne Administratorrechte angewendet werden können.</span><span class="sxs-lookup"><span data-stu-id="b2252-436">When running Windows Installer version 4.0 on Windows Vista you can also use [User Account Control (UAC) Patching](user-account-control--uac--patching.md) to enables the authors of Windows Installer installations to identify digitally-signed patches that can be applied in the future by non-administrator users.</span></span> <span data-ttu-id="b2252-437">Dies ist nur bei der Installation von Paketen im [Installations Kontext](installation-context.md) pro Computer (ALLUSERS = 1) verfügbar.</span><span class="sxs-lookup"><span data-stu-id="b2252-437">This is only available with the installation of packages in the per-machine [installation context](installation-context.md) (ALLUSERS=1).</span></span>
-   <span data-ttu-id="b2252-438">Stellen Sie sicher, dass Patchen mit geringsten Rechten nicht deaktiviert wurde, indem Sie die [**msidisableluapatching**](msidisableluapatching.md) -Eigenschaft oder die [disableluapatching](disableluapatching.md) -Richtlinie festlegen.</span><span class="sxs-lookup"><span data-stu-id="b2252-438">Ensure that least-privilege patching has not been disabled by setting the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property or the [DisableLUAPatching](disableluapatching.md) policy.</span></span>

## <a name="use-the-msipatchsequence-table-to-sequence-patches"></a><span data-ttu-id="b2252-439">Verwenden Sie die msipatchsequence-Tabelle, um Patches zu sequenzieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-439">Use the MsiPatchSequence Table to sequence patches.</span></span>

<span data-ttu-id="b2252-440">Fügen Sie eine [msipatchsequence-Tabelle](msipatchsequence-table.md) in das Paket ein, und fügen Sie patchsequenzierungs Informationen hinzu.</span><span class="sxs-lookup"><span data-stu-id="b2252-440">Include a [MsiPatchSequence Table](msipatchsequence-table.md) in your package and add patch sequencing information.</span></span> <span data-ttu-id="b2252-441">Ab Windows Installer Version 3,0 kann das Installationsprogramm die msipatchsequence-Tabelle verwenden, wenn [mehrere Patches installiert](installing-multiple-patches.md) werden, um die beste patchanwendungssequenz zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="b2252-441">Beginning with Windows Installer version 3.0, the installer can use the MsiPatchSequence Table when [installing multiple patches](installing-multiple-patches.md) to determine the best patch application sequence.</span></span> <span data-ttu-id="b2252-442">Verwenden Sie die Richtlinien, die im Whitepaper [Patch-Sequenzierung in Windows Installer Version 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) beschrieben werden, um patchfamilien zu definieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-442">Use the guidelines described in the [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) white paper for defining patch families.</span></span>

-   <span data-ttu-id="b2252-443">Wenn Sie praktisch sind, geben Sie alle Patches als zu einer einzelnen patchfamilie gehörenden an.</span><span class="sxs-lookup"><span data-stu-id="b2252-443">If practical, specify all patches as belonging to a single patch family.</span></span> <span data-ttu-id="b2252-444">In vielen Fällen bietet eine einzige patchfamilie genügend Flexibilität, um Patches zu sequenzieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-444">In many cases a single patch family provides enough flexibility to sequence patches.</span></span> <span data-ttu-id="b2252-445">Die Komplexität der Erstellung erhöht sich, wenn mehrere patchfamilien verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-445">The complexity of authoring increases when multiple patch families are used.</span></span> <span data-ttu-id="b2252-446">Weisen Sie der patchfamilie einen aussagekräftigen Namen zu, und weisen Sie der patchfamilie Sequenzwerte zu, die sich im Laufe der Zeit vergrößern.</span><span class="sxs-lookup"><span data-stu-id="b2252-446">Assign a meaningful name to the patch family and assign sequence values in that patch family that increase over time.</span></span> <span data-ttu-id="b2252-447">Befolgen Sie das Beispiel für das [mehrfache Patchen](multiple-patching-example.md) , um Patches in der Reihenfolge anzuwenden, in der Sie ausgestellt wurden.</span><span class="sxs-lookup"><span data-stu-id="b2252-447">Follow the [Multiple Patching Example](multiple-patching-example.md) to apply patches in the order in which they have been issued.</span></span>
-   <span data-ttu-id="b2252-448">Verwenden Sie die [patchsequence-Tabelle](patchsequence-table--patchwiz-dll-.md) in [Patchwiz.dll](patchwiz-dll.md) , um die Informationen in der [msipatchsequence-Tabelle](msipatchsequence-table.md)zu generieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-448">Use the [PatchSequence Table](patchsequence-table--patchwiz-dll-.md) in [Patchwiz.dll](patchwiz-dll.md) to generate the information in [MsiPatchSequence Table](msipatchsequence-table.md).</span></span> <span data-ttu-id="b2252-449">Die Version von PATCHWIZ.DLL, die mit Windows Installer 3,0 veröffentlicht wurde, kann automatisch patchsequenzierungs Informationen generieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-449">The version of PATCHWIZ.DLL that was released with Windows Installer 3.0 can automatically generate patch sequencing information.</span></span> <span data-ttu-id="b2252-450">Weitere Informationen zum Hinzufügen eines neuen Patches finden Sie unter [Erstellen von Patchsequenzinformationen](generating-patch-sequence-information---patchwiz-dll-.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-450">For more information on how to add a new patch, see [Generating Patch Sequence Information](generating-patch-sequence-information---patchwiz-dll-.md).</span></span> <span data-ttu-id="b2252-451">Weitere Informationen zu Szenarien für die Patchsequenzierung finden Sie im Whitepaper: [Patchsequenzierung in Windows Installer Version 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span><span class="sxs-lookup"><span data-stu-id="b2252-451">For more information about patch sequencing scenarios, see the whitepaper: [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span></span>

## <a name="test-the-installation-package-thoroughly"></a><span data-ttu-id="b2252-452">Testen Sie das Installationspaket gründlich.</span><span class="sxs-lookup"><span data-stu-id="b2252-452">Test the installation package thoroughly.</span></span>

<span data-ttu-id="b2252-453">Testen Sie die ordnungsgemäße Installation, Reparatur und Löschung Ihres Windows Installer Pakets.</span><span class="sxs-lookup"><span data-stu-id="b2252-453">Test for correct installation, repair, and removal of your Windows Installer package.</span></span> <span data-ttu-id="b2252-454">Sie können den Testprozess in folgende Teile aufteilen.</span><span class="sxs-lookup"><span data-stu-id="b2252-454">You can divide your testing process into the following parts.</span></span>

-   <span data-ttu-id="b2252-455">Installations Tests: Testen Sie die Installation mit allen möglichen Kombinationen von Anwendungs Features.</span><span class="sxs-lookup"><span data-stu-id="b2252-455">Installation Testing - Test the installation with all possible combinations of application features.</span></span> <span data-ttu-id="b2252-456">Testen Sie alle Installationstypen, einschließlich [administrativer Installation](administrative-installation.md), [Rollback-Installation](rollback-installation.md)und [Installation nach Bedarf](installation-on-demand.md).</span><span class="sxs-lookup"><span data-stu-id="b2252-456">Test all types of installation, including [Administrative Installation](administrative-installation.md), [Rollback Installation](rollback-installation.md), and [Installation-On-Demand](installation-on-demand.md).</span></span> <span data-ttu-id="b2252-457">Probieren Sie alle möglichen Installationsmethoden aus, und klicken Sie auf die MSI-Datei, die [Befehlszeilenoptionen](command-line-options.md)und die Installation über die Systemsteuerung.</span><span class="sxs-lookup"><span data-stu-id="b2252-457">Try all possible methods of installation, including clicking on the .msi file, [command line options](command-line-options.md), and installing from the control panel.</span></span> <span data-ttu-id="b2252-458">Testen Sie, ob das Paket von Benutzern in allen möglichen Berechtigungs Kontexten installiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="b2252-458">Test that the package can be installed by users in all possible privilege contexts.</span></span> <span data-ttu-id="b2252-459">Versuchen Sie, das Paket zu installieren, nachdem es mit allen möglichen Methoden bereitgestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="b2252-459">Try installing the package after it has been deployed by all possible methods.</span></span> <span data-ttu-id="b2252-460">Aktivieren Sie [Windows Installer Protokollierung](windows-installer-logging.md) für jeden Test, und beheben Sie alle Fehler, die im Installationsprotokoll und im Ereignisprotokoll gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-460">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="b2252-461">Testen der Benutzeroberfläche: Testen Sie das Paket, wenn es mit allen möglichen [Benutzeroberflächen Ebenen](user-interface-levels.md)installiert ist.</span><span class="sxs-lookup"><span data-stu-id="b2252-461">User Interface Testing - Test the package when installed with all possible [user interface levels](user-interface-levels.md).</span></span> <span data-ttu-id="b2252-462">Testen Sie das installierte Paket ohne Benutzeroberfläche und mit allen Informationen, die über die Benutzeroberfläche bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-462">Test the package installed with no user interface and with all information provided through the user interface.</span></span> <span data-ttu-id="b2252-463">Stellen Sie sicher, [dass der Zugriff auf die](accessibility.md) Benutzeroberfläche und die Benutzeroberfläche für verschiedene Bildschirmauflösungen und Schriftgrößen erwartungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="b2252-463">Ensure the [Accessibility](accessibility.md) of the user interface and that the user interface functions as expected for different screen resolutions and font sizes.</span></span>
-   <span data-ttu-id="b2252-464">Wartung und Reparatur testen: Testen Sie, ob das Paket [Patches und Upgrades](patching-and-upgrades.md) verarbeiten kann, die von einem [kleinen Update](small-updates.md), einem [geringfügigen Upgrade](minor-upgrades.md)und [großen Upgrades](major-upgrades.md)geliefert werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-464">Servicing and Repair Testing - Test that the package can handle [Patching and Upgrades](patching-and-upgrades.md) delivered by a [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="b2252-465">Schreiben Sie vor dem Bereitstellen des Pakets ein Test Update für jeden Typ, und wenden Sie es auf das ursprüngliche Paket an.</span><span class="sxs-lookup"><span data-stu-id="b2252-465">Before deploying the package, write a trial update of each type and try applying it to the original package.</span></span>
-   <span data-ttu-id="b2252-466">Tests deinstallieren: Vergewissern Sie sich, dass beim Entfernen des Pakets keine nutzbaren Teile von sich selbst auf dem Computer des Benutzers liegen und nur die Informationen entfernt wurden, die zum Paket gehören.</span><span class="sxs-lookup"><span data-stu-id="b2252-466">Uninstall Testing - Verify that when the package is removed it leaves no useless parts of itself behind on the user's computer and that only information belonging to the package has been removed.</span></span> <span data-ttu-id="b2252-467">Starten Sie den Testcomputer neu, nachdem Sie das Paket deinstalliert haben, und überprüfen Sie die Integrität der allgemeinen System Tools und anderer Standardanwendungen.</span><span class="sxs-lookup"><span data-stu-id="b2252-467">Reboot the test computer after uninstalling the package and verify the integrity of common system tools and other standard applications.</span></span> <span data-ttu-id="b2252-468">Testen Sie, ob das Paket von Benutzern in allen möglichen Berechtigungs Kontexten entfernt werden kann.</span><span class="sxs-lookup"><span data-stu-id="b2252-468">Test that the package can be removed by users in all possible privilege contexts.</span></span> <span data-ttu-id="b2252-469">Testen Sie alle Methoden, um das Paket zu entfernen, klicken Sie auf die MSI-Datei, verwenden Sie die [Befehlszeilenoptionen](command-line-options.md), und entfernen Sie das Paket aus der Systemsteuerung.</span><span class="sxs-lookup"><span data-stu-id="b2252-469">Test all methods to remove the package, click the .msi file, try the [command line options](command-line-options.md), and try removing the package from the control panel.</span></span> <span data-ttu-id="b2252-470">Aktivieren Sie [Windows Installer Protokollierung](windows-installer-logging.md) für jeden Test, und beheben Sie alle Fehler, die im Installationsprotokoll und im Ereignisprotokoll gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-470">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="b2252-471">Testen von Produktfunktionen: Stellen Sie sicher, dass die Anwendung nach dem installieren, reparieren oder Entfernen des Pakets erwartungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="b2252-471">Product Functionality Testing - Ensure that the application functions as expected after the installation, repair, or removal of the package.</span></span>

## <a name="fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package"></a><span data-ttu-id="b2252-472">Beheben Sie alle Validierungs Fehler, bevor Sie ein neues oder überarbeitetes Installationspaket bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="b2252-472">Fix all validation errors before deploying a new or revised installation package.</span></span>

<span data-ttu-id="b2252-473">Führen Sie die [Paket](package-validation.md) Überprüfung für ein neues oder überarbeitetes Windows Installer Paket aus, bevor Sie es zum ersten Mal installieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-473">Run [package validation](package-validation.md) on a new or revised Windows Installer package before attempting to install it for the first time.</span></span> <span data-ttu-id="b2252-474">Die Überprüfung überprüft die Windows Installer Datenbank auf Erstellungs Fehler.</span><span class="sxs-lookup"><span data-stu-id="b2252-474">Validation checks the Windows Installer database for authoring errors.</span></span> <span data-ttu-id="b2252-475">Wenn Sie versuchen, ein Paket zu installieren, das die Überprüfung nicht besteht, kann das System des Benutzers beschädigt werden.</span><span class="sxs-lookup"><span data-stu-id="b2252-475">Attempting to install a package that does not pass validation can damage the user's system.</span></span>

-   <span data-ttu-id="b2252-476">Sie können das Paket mit [Orca.exe](orca-exe.md) oder [Msival2.exe](msival2-exe.md)validieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-476">You can validate your package using [Orca.exe](orca-exe.md) or [Msival2.exe](msival2-exe.md).</span></span> <span data-ttu-id="b2252-477">Beide Tools werden mit dem Windows SDK bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="b2252-477">Both tools are provided with the Windows SDK.</span></span> <span data-ttu-id="b2252-478">Drittanbieter können auch das Ice-Validierungssystem in Ihre Erstellungs Umgebung integrieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-478">Third-party vendors may also incorporate the ICE validation system into their authoring environment.</span></span>
-   <span data-ttu-id="b2252-479">Sie können den Standardsatz [interner Konsistenz Evaluatoren-ICES](internal-consistency-evaluators-ices.md) verwenden, die in den Cub-Dateien enthalten sind, die mit dem SDK bereitgestellt werden, oder die Validierung anpassen, indem Sie [ein Eis aufbauen](building-an-ice.md) und es der CUB-Datei hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="b2252-479">You can use the standard set of [Internal Consistency Evaluators - ICEs](internal-consistency-evaluators-ices.md) included in the .cub files provided with the SDK, or customize validation by [Building an ICE](building-an-ice.md) and adding it to the .cub file.</span></span>
-   <span data-ttu-id="b2252-480">Sie können den Evalcom2.dll verwenden, um die [Validierungs Automatisierung](validation-automation.md) für Installationspakete und Mergemodule zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="b2252-480">You can use the Evalcom2.dll to implement [Validation Automation](validation-automation.md) for installation packages and merge modules.</span></span>

## <a name="author-a-secure-installation"></a><span data-ttu-id="b2252-481">Erstellen Sie eine sichere Installation.</span><span class="sxs-lookup"><span data-stu-id="b2252-481">Author a secure installation.</span></span>

<span data-ttu-id="b2252-482">Befolgen Sie diese Richtlinien, wenn Sie Ihr Paket entwickeln, um bei der Installation eine sichere Umgebung zu gewährleisten.</span><span class="sxs-lookup"><span data-stu-id="b2252-482">Following these guidelines when developing your package to help maintain a secure environment during installation.</span></span>

-   [<span data-ttu-id="b2252-483">Richtlinien für das Erstellen von sicheren Installationen</span><span class="sxs-lookup"><span data-stu-id="b2252-483">Guidelines for Authoring Secure Installations</span></span>](guidelines-for-authoring-secure-installations.md)
-   [<span data-ttu-id="b2252-484">Richtlinien zum Sichern von Paketen auf gesperrten Computern</span><span class="sxs-lookup"><span data-stu-id="b2252-484">Guidelines for Securing Packages on Locked-Down Computers</span></span>](guidelines-for-securing-packages-on-locked-down-computers.md)
-   [<span data-ttu-id="b2252-485">Richtlinien zum Sichern von benutzerdefinierten Aktionen</span><span class="sxs-lookup"><span data-stu-id="b2252-485">Guidelines for Securing Custom Actions</span></span>](guidelines-for-securing-custom-actions.md)

## <a name="use-pmsihandle-instead-of-handle"></a><span data-ttu-id="b2252-486">Verwenden von "pmsihandle" anstelle von "handle"</span><span class="sxs-lookup"><span data-stu-id="b2252-486">Use PMSIHANDLE instead of HANDLE</span></span>

<span data-ttu-id="b2252-487">Die **pmsihandle** -Typvariablen sind in "MSI. h" definiert.</span><span class="sxs-lookup"><span data-stu-id="b2252-487">The **PMSIHANDLE** type variables is defined in msi.h.</span></span> <span data-ttu-id="b2252-488">Es wird empfohlen, dass Ihre Anwendung den **pmsihandle** -Typ verwendet, da das Installationsprogramm **pmsihandle** -Objekte schließt, wenn Sie den Gültigkeitsbereich verlassen, während die Anwendung **msihandle** -Objekte durch Aufrufen von [**msiclosehandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle)schließen muss.</span><span class="sxs-lookup"><span data-stu-id="b2252-488">It is recommended that your application use the **PMSIHANDLE** type because the installer closes **PMSIHANDLE** objects as they go out of scope, whereas your application must close **MSIHANDLE** objects by calling [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span></span>

<span data-ttu-id="b2252-489">Wenn Sie z. b. Code wie den folgenden verwenden:</span><span class="sxs-lookup"><span data-stu-id="b2252-489">For example, if you use code like this:</span></span>

``` syntax
MSIHANDLE hRec = MsiCreateRecord(3);
```

<span data-ttu-id="b2252-490">Ändern Sie ihn in:</span><span class="sxs-lookup"><span data-stu-id="b2252-490">Change it to:</span></span>

``` syntax
PMSIHANDLE hRec = MsiCreateRecord(3);
```

 

 
