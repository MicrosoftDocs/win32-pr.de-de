---
description: In diesem Abschnitt wird beschrieben, wie Nachrichten von benutzerdefinierten Aktionen gesendet werden, die einen Teil der Installation durch Aufrufen einer Dynamic Link Library oder eines Skripts ausführen.
ms.assetid: 637efccf-920d-421d-9183-528cc3515bf8
title: Zurückgeben von Fehlermeldungen von benutzerdefinierten Aktionen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 480a9e7891680aadc9d8eb4eedba2bad0d2e3dd4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104130669"
---
# <a name="returning-error-messages-from-custom-actions"></a><span data-ttu-id="34037-103">Zurückgeben von Fehlermeldungen von benutzerdefinierten Aktionen</span><span class="sxs-lookup"><span data-stu-id="34037-103">Returning Error Messages from Custom Actions</span></span>

<span data-ttu-id="34037-104">In diesem Abschnitt wird beschrieben, wie Nachrichten von benutzerdefinierten Aktionen gesendet werden, die einen Teil der Installation durch Aufrufen einer Dynamic Link Library oder eines Skripts ausführen.</span><span class="sxs-lookup"><span data-stu-id="34037-104">This section describes how to send messages from custom actions that actually perform a part of the installation by calling a dynamic link library or script.</span></span> <span data-ttu-id="34037-105">Beachten Sie, dass der [benutzerdefinierte Aktionstyp 19](custom-action-type-19.md) nur eine angegebene Fehlermeldung sendet, einen Fehler zurückgibt und dann die Installation beendet.</span><span class="sxs-lookup"><span data-stu-id="34037-105">Note that [Custom Action Type 19](custom-action-type-19.md) only sends a specified error message, returns failure, and then terminates the installation.</span></span> <span data-ttu-id="34037-106">Der benutzerdefinierte Aktionstyp 19 führt keinen Teil der Installation aus.</span><span class="sxs-lookup"><span data-stu-id="34037-106">Custom Action Type 19 does not perform any part of the installation.</span></span>

<span data-ttu-id="34037-107">Um eine Fehlermeldung von einer benutzerdefinierten Aktion zu senden, die eine [Dynamic Link Library](dynamic-link-libraries.md) (dll) verwendet, müssen Sie die benutzerdefinierte Aktion [**msiprocessmessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage)abrufen.</span><span class="sxs-lookup"><span data-stu-id="34037-107">To send an error message from a custom action that uses a [dynamic-link library](dynamic-link-libraries.md) (DLL), have the custom action call [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span></span> <span data-ttu-id="34037-108">Beachten Sie, dass benutzerdefinierte Aktionen, die von einem [doaction ControlEvent](doaction-controlevent.md) gestartet werden, Nachrichten mit der [**Nachrichten**](session-message.md) Methode senden können, aber keine Nachricht mit **msiprocessmessage** senden können.</span><span class="sxs-lookup"><span data-stu-id="34037-108">Note that custom actions launched by a [DoAction ControlEvent](doaction-controlevent.md) can send messages with the [**Message**](session-message.md) method but cannot send a message with **MsiProcessMessage**.</span></span> <span data-ttu-id="34037-109">Auf Systemen vor Windows Server 2003 können benutzerdefinierte Aktionen, die von einem doaction ControlEvent gestartet werden, keine Nachrichten mit der **msiprocessmessage** oder der **Message** -Methode senden.</span><span class="sxs-lookup"><span data-stu-id="34037-109">On systems earlier than Windows Server 2003, custom actions launched by a DoAction ControlEvent cannot send messages with **MsiProcessMessage** or **Message** method.</span></span> <span data-ttu-id="34037-110">Weitere Informationen finden Sie unter [Senden von Nachrichten an Windows Installer mithilfe von "msiprocessmessage](sending-messages-to-windows-installer-using-msiprocessmessage.md)".</span><span class="sxs-lookup"><span data-stu-id="34037-110">For more information, see [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>

<span data-ttu-id="34037-111">**So zeigen Sie eine Fehlermeldung innerhalb einer benutzerdefinierten Aktion mithilfe einer DLL an**</span><span class="sxs-lookup"><span data-stu-id="34037-111">**To display an error message from within a custom action using a DLL**</span></span>

1.  <span data-ttu-id="34037-112">Die benutzerdefinierte Aktion sollte " [**msiprocessmessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) " aufrufen und die Parameter " *hinstall*", " *emessagetype*" und " *hrecord*" übergeben.</span><span class="sxs-lookup"><span data-stu-id="34037-112">The custom action should call [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) and pass in the parameters *hInstall*, *eMessageType*, and *hRecord*.</span></span> <span data-ttu-id="34037-113">Das Handle für die Installation, [benutzerdefinierter Aktionstyp 19](custom-action-type-19.md), kann für die benutzerdefinierte Aktion bereitgestellt werden, wie unter [zugreifen auf die aktuelle Installer-Sitzung von innerhalb einer benutzerdefinierten Aktion](accessing-the-current-installer-session-from-inside-a-custom-action.md) oder über [**MsiOpenProduct**](/windows/desktop/api/Msi/nf-msi-msiopenproducta) oder [**msiopenpackage**](/windows/desktop/api/Msi/nf-msi-msiopenpackagea)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="34037-113">The handle to the installation, [Custom Action Type 19](custom-action-type-19.md), may be provided to the custom action as described in [Accessing the Current Installer Session from Inside a Custom Action](accessing-the-current-installer-session-from-inside-a-custom-action.md) or from [**MsiOpenProduct**](/windows/desktop/api/Msi/nf-msi-msiopenproducta) or [**MsiOpenPackage**](/windows/desktop/api/Msi/nf-msi-msiopenpackagea).</span></span>
2.  <span data-ttu-id="34037-114">Der Parameter *emessagetype* muss einen der Nachrichten Typen angeben, wie in [**msiprocessmessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage)aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="34037-114">The parameter *eMessageType* should specify one of the message types as listed in [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span></span>
3.  <span data-ttu-id="34037-115">Der *hrecord* -Parameter der [**msiprocessmessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) -Funktion hängt vom Nachrichtentyp ab.</span><span class="sxs-lookup"><span data-stu-id="34037-115">The *hRecord* parameter of the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function depends upon the message type.</span></span> <span data-ttu-id="34037-116">Siehe [Senden von Nachrichten an Windows Installer mithilfe von "msiprocessmessage](sending-messages-to-windows-installer-using-msiprocessmessage.md)".</span><span class="sxs-lookup"><span data-stu-id="34037-116">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span> <span data-ttu-id="34037-117">Wenn die Nachricht formatierte Daten enthält, geben Sie die Nachricht in die [Fehler](error-table.md) Tabelle ein. verwenden Sie hierzu die unter [formatierte](formatted.md)Formatierung.</span><span class="sxs-lookup"><span data-stu-id="34037-117">If the message contains formatted data, enter the message into the [Error](error-table.md) table using the formatting described in [Formatted](formatted.md).</span></span>

<span data-ttu-id="34037-118">Um eine Fehlermeldung von einer benutzerdefinierten Aktion zu senden, die [Skripts](scripts.md)verwendet, kann die benutzerdefinierte Aktion die [**Message**](session-message.md) -Methode des [**Session**](session-object.md) -Objekts aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="34037-118">To send an error message from a custom action that uses [Scripts](scripts.md), the custom action may call the [**Message**](session-message.md) method of the [**Session**](session-object.md) object.</span></span>

<span data-ttu-id="34037-119">**So zeigen Sie eine Fehlermeldung innerhalb einer benutzerdefinierten Aktion mithilfe eines Skripts an**</span><span class="sxs-lookup"><span data-stu-id="34037-119">**To display an error message from within a custom action using script**</span></span>

1.  <span data-ttu-id="34037-120">Die benutzerdefinierte Aktion sollte die [**Message**](session-message.md) -Methode des [**Session**](session-object.md) -Objekts aufzurufen und die Parameter *Art* und *Datensatz* übergeben.</span><span class="sxs-lookup"><span data-stu-id="34037-120">The custom action should call the [**Message**](session-message.md) method of the [**Session**](session-object.md) object and pass in the parameters *kind* and *record*.</span></span>
2.  <span data-ttu-id="34037-121">In der *Parameterart* sollte einer der Nachrichten Typen angegeben werden, die in der [**Message**](session-message.md) -Methode aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="34037-121">The parameter *kind* should specify one of the message types listed in the [**Message**](session-message.md) method.</span></span>
3.  <span data-ttu-id="34037-122">Der *Datensatz* -Parameter der [**Message**](session-message.md) -Methode hängt vom Nachrichtentyp ab.</span><span class="sxs-lookup"><span data-stu-id="34037-122">The *record* parameter of the [**Message**](session-message.md) method depends upon the message type.</span></span> <span data-ttu-id="34037-123">Wenn die Nachricht formatierte Daten enthält, geben Sie die Nachricht in die [Fehler](error-table.md) Tabelle ein. verwenden Sie hierzu die unter [formatierte](formatted.md)Formatierung.</span><span class="sxs-lookup"><span data-stu-id="34037-123">If the message contains formatted data, enter the message into the [Error](error-table.md) table using the formatting described in [Formatted](formatted.md).</span></span>

<span data-ttu-id="34037-124">Benutzerdefinierte Aktionen, die [ausführbare Dateien](executable-files.md) verwenden, können keine Nachricht senden, indem Sie [**msiprocessmessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) oder die [**Message**](session-message.md) -Methode aufrufen, da Sie kein Handle für die Installation abrufen können.</span><span class="sxs-lookup"><span data-stu-id="34037-124">Custom actions using [Executable Files](executable-files.md) cannot send a message by calling [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) or the [**Message**](session-message.md) method because they cannot get a handle to the installation.</span></span>

## <a name="related-topics"></a><span data-ttu-id="34037-125">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="34037-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="34037-126">Rückgabewerte für benutzerdefinierte Aktionen</span><span class="sxs-lookup"><span data-stu-id="34037-126">Custom Action Return Values</span></span>](custom-action-return-values.md)
</dt> </dl>

 

 



