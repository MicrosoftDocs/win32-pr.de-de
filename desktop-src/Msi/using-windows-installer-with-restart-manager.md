---
description: Anwendungen, die Windows Installer 4,0 für die Installation und Wartung unter Windows Vista verwenden, verwenden automatisch den Neustart-Manager, um Systemneustarts zu verringern.
ms.assetid: 821739ff-f7a7-4192-ad34-254aa7d74d13
title: Verwenden von Windows Installer mit dem Neustart-Manager
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4160b2241c75ec7305accd1ab4d1295a54fa9f65
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106353131"
---
# <a name="using-windows-installer-with-restart-manager"></a><span data-ttu-id="0e6e9-103">Verwenden von Windows Installer mit dem Neustart-Manager</span><span class="sxs-lookup"><span data-stu-id="0e6e9-103">Using Windows Installer with Restart Manager</span></span>

<span data-ttu-id="0e6e9-104">Anwendungen, die Windows Installer 4,0 für die Installation und Wartung unter Windows Vista verwenden, verwenden automatisch den [Neustart-Manager](../rstmgr/restart-manager-portal.md) , um Systemneustarts zu verringern.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-104">Applications that use Windows Installer 4.0 for installation and servicing on Windows Vista automatically use the [Restart Manager](../rstmgr/restart-manager-portal.md) to reduce system restarts.</span></span> <span data-ttu-id="0e6e9-105">Das Standardverhalten in Windows Vista besteht darin, Anwendungen herunterzufahren, anstatt das Betriebssystem nach Möglichkeit herunterzufahren und neu zu starten.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-105">The default behavior on Windows Vista is to shut down applications rather than shut down and restart the operating system whenever possible.</span></span> <span data-ttu-id="0e6e9-106">In Fällen, in denen ein Systemneustart unvermeidlich ist, können Installer die [Neustart-Manager](../rstmgr/restart-manager-portal.md) -API verwenden, um Neustarts so zu planen, dass die Unterbrechung des Arbeits Flusses des Benutzers minimiert wird.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-106">In cases where a system restart is unavoidable, installers can use the [Restart Manager](../rstmgr/restart-manager-portal.md) API to schedule restarts in such a way that it minimizes the disruption of the user's work flow.</span></span>

<span data-ttu-id="0e6e9-107">Windows Installer Entwickler können die folgenden Aktionen ausführen, um Ihr Paket für die Zusammenarbeit mit dem [Neustart-Manager](../rstmgr/restart-manager-portal.md)vorzubereiten.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-107">Windows Installer developers can perform the following actions to prepare their package to work with the [Restart Manager](../rstmgr/restart-manager-portal.md).</span></span>

-   <span data-ttu-id="0e6e9-108">Fügen Sie das Dialogfeld [msirmfilesinuse](msirmfilesinuse-dialog.md) zum Paket hinzu.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-108">Add the [MsiRMFilesInUse](msirmfilesinuse-dialog.md) dialog box to your package.</span></span> <span data-ttu-id="0e6e9-109">Wenn das Dialogfeld msirmfilesinuse im Paket vorhanden ist, kann der Windows Vista-Benutzer, der eine Installation auf der vollständigen [Benutzeroberflächen Ebene der Benutzeroberfläche](user-interface-levels.md) durchführt, die Option zum automatischen schließen und Neustarten von Anwendungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-109">If the MsiRMFilesInUse dialog box is present in the package, the Windows Vista user running an installation at the Full UI [user interface level](user-interface-levels.md) is given the option to automatically close and restart applications.</span></span> <span data-ttu-id="0e6e9-110">Ein Installationspaket kann Informationen sowohl für das Dialogfeld msirmfilesinuse als auch das Dialogfeld [FilesInUse](filesinuse-dialog.md) enthalten.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-110">An installation package can contain information for both the MsiRMFilesInUse dialog box and the [FilesInUse](filesinuse-dialog.md) dialog box .</span></span> <span data-ttu-id="0e6e9-111">Das Dialogfeld msirmfilesinuse wird nur angezeigt, wenn das Paket mit mindestens Windows Installer 4,0 unter Windows Vista installiert wird und andernfalls ignoriert wird.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-111">The MsiRMFilesInUse dialog box is only displayed if the package is installed with at least Windows Installer 4.0 on Windows Vista, and is otherwise ignored.</span></span> <span data-ttu-id="0e6e9-112">Vorhandene Pakete, die nicht über das Dialogfeld msirmfilesinuse verfügen, funktionieren weiterhin mithilfe des Dialog Felds FilesInUse.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-112">Existing packages that do not have the MsiRMFilesInUse dialog box continue to function using the FilesInUse dialog box.</span></span> <span data-ttu-id="0e6e9-113">Eine Anpassungs Transformation kann verwendet werden, um vorhandene Paketen ein msirmfilesinuse-Dialogfeld hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-113">A customization transform can be used to add an MsiRMFilesInUse dialog box to existing packages.</span></span>

    <span data-ttu-id="0e6e9-114">Endbenutzer führen Installationen in der Regel auf der [Ebene der Benutzeroberfläche der Benutzeroberfläche](user-interface-levels.md)aus.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-114">End-users typically run installations at the Full UI [user interface level](user-interface-levels.md).</span></span> <span data-ttu-id="0e6e9-115">Die grundlegende Benutzeroberfläche oder reduzierte Installationen auf Benutzeroberflächen Ebene bieten dem Benutzer die Möglichkeit, den [Neustart-Manager](../rstmgr/restart-manager-portal.md) zu verwenden, um Systemneustarts zu reduzieren, auch wenn das Dialogfeld [msirmfilesinuse](msirmfilesinuse-dialog.md) nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-115">Basic UI or Reduced UI level installations give the user the option of using the [Restart Manager](../rstmgr/restart-manager-portal.md) to reduce system restarts even if the [MsiRMFilesInUse](msirmfilesinuse-dialog.md) dialog box is not present.</span></span> <span data-ttu-id="0e6e9-116">Bei Installationen mit automatischer Benutzeroberflächen Ebene werden Anwendungen und Dienste immer heruntergefahren, und unter Windows Vista sollte immer der Neustart-Manager verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-116">Silent UI level installations always shut down applications and services, and on Windows Vista, always use Restart Manager.</span></span>

-   <span data-ttu-id="0e6e9-117">Registrieren Sie Anwendungen für einen Neustart mithilfe der [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) -Funktion.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-117">Register applications for a restart using the [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) function.</span></span> <span data-ttu-id="0e6e9-118">Der Neustart-Manager kann nur Anwendungen neu starten, die für den Neustart registriert wurden.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-118">Restart Manager can only restart applications that have been registered for restart.</span></span> <span data-ttu-id="0e6e9-119">Mit dem Neustart-Manager werden registrierte Anwendungen nach der Installation neu gestartet.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-119">Restart Manager restarts registered applications after the installation.</span></span> <span data-ttu-id="0e6e9-120">Wenn für die Installation ein Systemneustart erforderlich ist, startet der Neustart-Manager die registrierte Anwendung nach dem Neustart des Systems neu.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-120">If the installation requires a system restart, Restart Manager restarts the registered application after the system restart.</span></span>
-   <span data-ttu-id="0e6e9-121">Geben Sie "installlogmode \_ rmfilesinuse" an, wenn Sie einen externen Benutzerschnittstellen Handler mit den Funktionen " [**msisettexternalui**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia) " und " [**msitentexternalu"**](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord) aktivieren.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-121">Specify INSTALLLOGMODE\_RMFILESINUSE when enabling an external user-interface handler with the [**MsiSetExternalUI**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia) and [**MsiSetExternalUIRecord**](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord) functions.</span></span> <span data-ttu-id="0e6e9-122">Windows Installer sendet eine installmessage \_ rmfilesinuse-Nachricht für externe Benutzerschnittstellen Handler, die den Neustart- [Manager](../rstmgr/restart-manager-portal.md)unterstützen.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-122">Windows Installer will send a INSTALLMESSAGE\_RMFILESINUSE message for external user-interface handlers that support the [Restart Manager](../rstmgr/restart-manager-portal.md).</span></span> <span data-ttu-id="0e6e9-123">Wenn die Meldung "installmessage rmfilesinuse" von keiner registrierten oder internen Benutzeroberfläche verarbeitet \_ wird, sendet das Installationsprogramm eine installmessage- \_ FilesInUse-Nachricht für Benutzeroberflächen Handler, die das Dialogfeld " [FilesInUse](filesinuse-dialog.md) " unterstützen.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-123">If no registered or internal user-interface handles the INSTALLMESSAGE\_RMFILESINUSE message, the installer sends a INSTALLMESSAGE\_FILESINUSE message for user-interface handlers that support the [FilesInUse](filesinuse-dialog.md) dialog box.</span></span> <span data-ttu-id="0e6e9-124">Weitere Informationen finden Sie unter [Verwenden des Neustart-Managers mit einer externen Benutzeroberfläche](using-restart-manager-with-an-external-ui-.md).</span><span class="sxs-lookup"><span data-stu-id="0e6e9-124">For more information, see [Using Restart Manager with an External UI](using-restart-manager-with-an-external-ui-.md).</span></span>
-   <span data-ttu-id="0e6e9-125">Benutzerdefinierte Aktionen können Ressourcen hinzufügen, die zu einer [Neustart-Manager](../rstmgr/restart-manager-portal.md) -Sitzung gehören.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-125">Custom actions can add resources belonging to a [Restart Manager](../rstmgr/restart-manager-portal.md) session.</span></span> <span data-ttu-id="0e6e9-126">Die benutzerdefinierte Aktion sollte vor der [InstallValidate](installvalidate-action.md) -Aktion sequenziert werden.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-126">The custom action should be sequenced before the [InstallValidate](installvalidate-action.md) action.</span></span> <span data-ttu-id="0e6e9-127">Benutzerdefinierte Aktionen können die [**msirestartmanagersessionkey**](msirestartmanagersessionkey.md) -Eigenschaft verwenden, um den Sitzungsschlüssel abzurufen, und sollten die [**rmjoinsession**](/windows/win32/api/restartmanager/nf-restartmanager-rmjoinsession) -und [**RmEndSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmendsession) -Funktionen der Neustart-Manager-API aufrufen.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-127">Custom actions can use the [**MsiRestartManagerSessionKey**](msirestartmanagersessionkey.md) property to obtain the session key, and should call the [**RmJoinSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmjoinsession) and [**RmEndSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmendsession) functions of the Restart Manager API.</span></span> <span data-ttu-id="0e6e9-128">Benutzerdefinierte Aktionen können keine Ressourcen entfernen, die zu einer Neustart-Manager-Sitzung gehören.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-128">Custom actions cannot remove resources belonging to a Restart Manager session.</span></span> <span data-ttu-id="0e6e9-129">Benutzerdefinierte Aktionen sollten nicht versuchen, Anwendungen mithilfe der Funktionen [**rmshutdown**](/windows/win32/api/restartmanager/nf-restartmanager-rmshutdown), [**RmGetList**](/windows/win32/api/restartmanager/nf-restartmanager-rmgetlist) und [**rmrestart**](/windows/win32/api/restartmanager/nf-restartmanager-rmrestart) herunterzufahren oder neu zu starten.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-129">Custom actions should not attempt to shutdown or restart applications using the [**RmShutdown**](/windows/win32/api/restartmanager/nf-restartmanager-rmshutdown), [**RmGetList**](/windows/win32/api/restartmanager/nf-restartmanager-rmgetlist) and [**RmRestart**](/windows/win32/api/restartmanager/nf-restartmanager-rmrestart) functions.</span></span>
-   <span data-ttu-id="0e6e9-130">Paket Ersteller können eine Bedingung in der [LaunchCondition-Tabelle](launchcondition-table.md) der [**msisystemrebootpending**](msisystemrebootpending.md) -Eigenschaft als Grundlage auswählen, um die Installation des Pakets zu verhindern, wenn ein Systemneustart aussteht.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-130">Package authors can base a condition in the [LaunchCondition table](launchcondition-table.md) on the [**MsiSystemRebootPending**](msisystemrebootpending.md) property to prevent the installation of their package when a system restart is pending.</span></span>
-   <span data-ttu-id="0e6e9-131">Paket Ersteller und-Administratoren können die Interaktion des Windows Installer und den Neustart-Manager mithilfe der [**msirestartmanagercontrol**](msirestartmanagercontrol.md)-, [**msidisablermrestart**](msidisablermrestart.md)-und [**msirmshutdown**](msirmshutdown.md) -Eigenschaften und der [disableautomaticapplicationshutdown](disableautomaticapplicationshutdown.md) -Richtlinie steuern.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-131">Package authors and administrators can control the interaction of the Windows Installer and Restart Manager by using the [**MSIRESTARTMANAGERCONTROL**](msirestartmanagercontrol.md), [**MSIDISABLERMRESTART**](msidisablermrestart.md), [**MSIRMSHUTDOWN**](msirmshutdown.md) properties and the [DisableAutomaticApplicationShutdown](disableautomaticapplicationshutdown.md) policy.</span></span>
-   <span data-ttu-id="0e6e9-132">Anwendungen und Dienste sollten die im Abschnitt [Verwenden von Neustart-Manager](../rstmgr/using-restart-manager.md) der Dokumentation zum [Neustart](../rstmgr/restart-manager-portal.md) -Manager beschriebenen Richtlinien befolgen.</span><span class="sxs-lookup"><span data-stu-id="0e6e9-132">Applications and services should follow the guidelines described in the [Using Restart Manager](../rstmgr/using-restart-manager.md) section of the [Restart Manager](../rstmgr/restart-manager-portal.md) documentation.</span></span>

 

 
