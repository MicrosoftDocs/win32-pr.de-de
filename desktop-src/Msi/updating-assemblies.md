---
description: Die Informationen in diesem Thema enthalten die empfohlenen Richtlinien zum Aktualisieren von Assemblys mithilfe von Windows Installer Patches.
ms.assetid: 60c70d48-aae2-4ea5-a880-ac9e2c83c28c
title: Aktualisieren von Assemblys
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35b185a9943ba20c81a1fa3431dd590eb05648c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104050601"
---
# <a name="updating-assemblies"></a><span data-ttu-id="64537-103">Aktualisieren von Assemblys</span><span class="sxs-lookup"><span data-stu-id="64537-103">Updating Assemblies</span></span>

<span data-ttu-id="64537-104">Die Informationen in diesem Thema enthalten die empfohlenen Richtlinien zum Aktualisieren von Assemblys mithilfe von Windows Installer Patches.</span><span class="sxs-lookup"><span data-stu-id="64537-104">The information in this topic identifies the recommended guidelines for updating assemblies using Windows Installer patches.</span></span>

<span data-ttu-id="64537-105">Autoren von Assemblyaktualisierungen können die folgenden Richtlinien verwenden, die für alle Typen von Assemblys gelten:</span><span class="sxs-lookup"><span data-stu-id="64537-105">Authors of assembly updates can use the following guidelines, which apply to all types of assemblies:</span></span>

-   <span data-ttu-id="64537-106">Die empfohlene Methode zum Aktualisieren einer Assembly besteht darin, den starken Namen der Assembly in der [MsiAssemblyName-Tabelle](msiassemblyname-table.md)zu ändern.</span><span class="sxs-lookup"><span data-stu-id="64537-106">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span> <span data-ttu-id="64537-107">Die neue Assemblyversion kann durch eine neue Komponente oder durch dieselbe Komponente bereitgestellt werden, die die alte Version bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="64537-107">The new assembly version can be provided by a new component or by the same component that provides the old version.</span></span>
-   <span data-ttu-id="64537-108">Wenn die neue Assemblyversion von der gleichen Komponente bereitgestellt wird, ändern Sie den Assemblytyp nicht von einer .NET Framework-Assembly in eine Win32-Assembly oder umgekehrt.</span><span class="sxs-lookup"><span data-stu-id="64537-108">If the new assembly version is provided by the same component, do not change the assembly type from a .NET Framework assembly to a Win32 assembly or vice versa.</span></span>
-   <span data-ttu-id="64537-109">Wenn alle Anwendungen auf dem System die aktualisierte Assembly verwenden müssen, sollten Sie eine Richtlinienassembly bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="64537-109">If all applications on the system must use the updated assembly, you should deploy a policy assembly.</span></span> <span data-ttu-id="64537-110">Eine Richtlinienassembly kann Anwendungen auf dem System umleiten, um die neue Assemblyversion zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="64537-110">A policy assembly can redirect applications on the system to use the new assembly version.</span></span> <span data-ttu-id="64537-111">Richtlinienassemblys sollten durch Erstellen einer neuen Komponente bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="64537-111">Policy assemblies should be provided by creating a new component.</span></span>
-   <span data-ttu-id="64537-112">Zum Deinstallieren von Assemblyaktualisierungen ist Windows Installer 3,0 oder höher erforderlich.</span><span class="sxs-lookup"><span data-stu-id="64537-112">Windows Installer 3.0 or later is required to uninstall assembly updates.</span></span> <span data-ttu-id="64537-113">Weitere Informationen finden Sie unter [Entfernen von Patches](removing-patches.md).</span><span class="sxs-lookup"><span data-stu-id="64537-113">For more information, see [Removing Patches](removing-patches.md).</span></span>
-   <span data-ttu-id="64537-114">Die neuere Version der Assembly sollte dieselbe oder eine höhere Version der Dateien aus zuvor veröffentlichten Assemblys enthalten.</span><span class="sxs-lookup"><span data-stu-id="64537-114">The newer version of the assembly should contain the same or higher versions of files from previously released assemblies.</span></span>
-   <span data-ttu-id="64537-115">Windows Installer 3,0 kann .NET Framework und Win32-Assemblys durch eine komplette Datei Ersetzung oder durch ein kleineres Delta Update bedienen.</span><span class="sxs-lookup"><span data-stu-id="64537-115">Windows Installer 3.0 can service .NET Framework and Win32 assemblies by a complete file replacement or by a smaller delta update.</span></span> <span data-ttu-id="64537-116">Weitere Informationen finden Sie unter [verringern der Patchgröße](reducing-patch-size.md).</span><span class="sxs-lookup"><span data-stu-id="64537-116">For more information, see [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="64537-117">Wenn das Update den starken Namen der Assembly ändert, sind die [msipatcholdassemblyfile](msipatcholdassemblyfile-table.md) -Tabelle und die [msipatcholdassemblyname](msipatcholdassemblyname-table.md) -Tabelle erforderlich, wenn das Patchpaket nicht über eine [msipatchsequence](msipatchsequence-table.md) -Tabelle verfügt.</span><span class="sxs-lookup"><span data-stu-id="64537-117">If your update changes the strong name of the assembly, the [MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md) table and [MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md) table are required if the patch package does not have a [MsiPatchSequence](msipatchsequence-table.md) table.</span></span> <span data-ttu-id="64537-118">Die msipatcholdassemblyfile-Tabelle und die msipatcholdassemblyname-Tabelle sind nicht erforderlich, wenn das Patchpaket Informationen zur Patchsequenzierung in einer msipatchsequence-Tabelle aufweist.</span><span class="sxs-lookup"><span data-stu-id="64537-118">The MsiPatchOldAssemblyFile table and MsiPatchOldAssemblyName table are not required if the patch package has patch sequencing information in a MsiPatchSequence table.</span></span>
-   <span data-ttu-id="64537-119">Vor dem Freigeben eines neuen Patches testen Sie den Patch, indem Sie ihn mit allen zuvor veröffentlichten Patches anwenden.</span><span class="sxs-lookup"><span data-stu-id="64537-119">Before releasing a new patch, test the patch by applying it with all previously released patches.</span></span>

## <a name="updating-win32-assemblies"></a><span data-ttu-id="64537-120">Aktualisieren von Win32</span><span class="sxs-lookup"><span data-stu-id="64537-120">Updating Win32 Assemblies</span></span>

<span data-ttu-id="64537-121">Beachten Sie beim Aktualisieren von Win32-Assemblys die folgenden Richtlinien:</span><span class="sxs-lookup"><span data-stu-id="64537-121">Use the following guidelines when you update Win32 assemblies:</span></span>

-   <span data-ttu-id="64537-122">Ändern Sie den starken Namen der neuen Assembly, die in der [MsiAssemblyName-Tabelle](msiassemblyname-table.md)angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="64537-122">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="64537-123">Wenn Sie möchten, dass die Anwendung immer die neue Version der Assembly verwendet, ohne dass sich dies auf die von anderen Anwendungen auf dem System verwendete Assemblyversion auswirkt, verwenden Sie die gleiche Komponente, um die neue Assemblyversion zu verwenden, die Sie für die alte Assemblyversion</span><span class="sxs-lookup"><span data-stu-id="64537-123">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="64537-124">Behalten Sie die gleiche ComponentID in der [Component](component-table.md) -Tabelle bei.</span><span class="sxs-lookup"><span data-stu-id="64537-124">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="64537-125">Nachdem die Anwendung gepatcht wurde, enthält Sie nur einen Verweis auf die neue Version der Assembly.</span><span class="sxs-lookup"><span data-stu-id="64537-125">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="64537-126">Die alte Version der Assembly kann mit der neuen Version im globalen Assemblycache verbleiben.</span><span class="sxs-lookup"><span data-stu-id="64537-126">The old version of the assembly can remain with the new version in the global assembly cache.</span></span> <span data-ttu-id="64537-127">Dies wirkt sich nicht auf andere Anwendungen auf dem System aus, die die alte Version der Assembly verwenden.</span><span class="sxs-lookup"><span data-stu-id="64537-127">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="64537-128">Wenn dieselbe Komponente sowohl für die neue als auch für die alte Version der Assembly verwendet wird, kann es sich bei dem Update um einen kleineren Delta Patch handeln.</span><span class="sxs-lookup"><span data-stu-id="64537-128">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="64537-129">Wenn die neue Version der Assembly nicht mit allen Systemen kompatibel ist, auf denen Sie Ihre Anwendung installieren möchten, können Sie die neue und alte Version der Assembly als parallele Assemblys installieren.</span><span class="sxs-lookup"><span data-stu-id="64537-129">If the new version of the assembly is not compatible with all the systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="64537-130">Um beide Assemblyversionen nebeneinander zu installieren, erstellen Sie eine neue-Komponente, die die neue Assemblyversion enthält.</span><span class="sxs-lookup"><span data-stu-id="64537-130">To install both assembly versions side-by-side, create a new component to contain the new assembly version.</span></span> <span data-ttu-id="64537-131">Die ComponentID in der [Komponenten](component-table.md) Tabelle für die neue Komponente sollte sich von der Komponenten-ID der Komponente mit der alten Version unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="64537-131">The ComponentId in the [Component](component-table.md) table for the new component should be different from the ComponentId of the component with the old version.</span></span> <span data-ttu-id="64537-132">Nachdem die Anwendung gepatcht wurde, enthält Sie Verweise auf beide Assemblyversionen.</span><span class="sxs-lookup"><span data-stu-id="64537-132">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="64537-133">Anschließend kann die Anwendung durch ein Manifest an die kompatible Version der Assembly weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="64537-133">Then the application can be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="64537-134">Wenn verschiedene Komponenten für die neue und alte Version der Assembly verwendet werden, wird für das Update der vollständige Dateiaustausch verwendet.</span><span class="sxs-lookup"><span data-stu-id="64537-134">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>

## <a name="updating-net-framework-assemblies"></a><span data-ttu-id="64537-135">Aktualisieren .NET Framework Assemblys</span><span class="sxs-lookup"><span data-stu-id="64537-135">Updating .NET Framework Assemblies</span></span>

<span data-ttu-id="64537-136">Verwenden Sie die folgenden Richtlinien, wenn Sie .NET Framework Assemblys Aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="64537-136">Use the following guidelines when you update .NET Framework assemblies.</span></span>

-   <span data-ttu-id="64537-137">Ändern Sie den starken Namen der neuen Assembly, die in der [MsiAssemblyName-Tabelle](msiassemblyname-table.md)angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="64537-137">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="64537-138">Wenn Sie möchten, dass die Anwendung immer die neue Version der Assembly verwendet, ohne die von anderen Anwendungen auf dem System verwendete Assemblyversion zu beeinträchtigen, ändern Sie den starken Namen der neuen Assembly, die in der [Tabelle MsiAssemblyName](msiassemblyname-table.md)angegeben ist, und verwenden Sie dieselbe Komponente, um die neue Assemblyversion aufzunehmen, die Sie für die alte Assemblyversion verwendet haben</span><span class="sxs-lookup"><span data-stu-id="64537-138">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="64537-139">Behalten Sie die gleiche ComponentID in der [Component](component-table.md) -Tabelle bei.</span><span class="sxs-lookup"><span data-stu-id="64537-139">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="64537-140">Nachdem die Anwendung gepatcht wurde, enthält Sie nur einen Verweis auf die neue Version der Assembly.</span><span class="sxs-lookup"><span data-stu-id="64537-140">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="64537-141">Die alte Version der Assembly kann mit der neuen Version im globalen Cache verbleiben.</span><span class="sxs-lookup"><span data-stu-id="64537-141">The old version of the assembly can remain with the new version in the global cache.</span></span> <span data-ttu-id="64537-142">Dies wirkt sich nicht auf andere Anwendungen auf dem System aus, die die alte Version der Assembly verwenden.</span><span class="sxs-lookup"><span data-stu-id="64537-142">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="64537-143">Wenn dieselbe Komponente sowohl für die neue als auch für die alte Version der Assembly verwendet wird, kann es sich bei dem Update um einen kleineren Delta Patch handeln.</span><span class="sxs-lookup"><span data-stu-id="64537-143">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="64537-144">Wenn die neue Version der Assembly nicht mit allen Systemen kompatibel ist, auf denen Sie Ihre Anwendung installieren möchten, können Sie die neue und alte Version der Assembly als parallele Assemblys installieren.</span><span class="sxs-lookup"><span data-stu-id="64537-144">If the new version of the assembly is not compatible with all systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="64537-145">Um beide Assemblyversionen nebeneinander zu installieren, ändern Sie den starken Namen der neuen Assembly, die in der [MsiAssemblyName-Tabelle](msiassemblyname-table.md)angegeben ist, und erstellen Sie eine neue-Komponente, die die neue Assemblyversion enthält.</span><span class="sxs-lookup"><span data-stu-id="64537-145">To install both assembly versions side-by-side, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and create a new component to contain the new assembly version.</span></span> <span data-ttu-id="64537-146">Die ComponentID in der [Komponenten](component-table.md) Tabelle für die neue Komponente sollte sich von der Komponenten-ID der Komponente mit der alten Version unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="64537-146">The ComponentId in the [Component](component-table.md) table for the new component should be different than the ComponentId of the component with the old version.</span></span> <span data-ttu-id="64537-147">Nachdem die Anwendung gepatcht wurde, enthält Sie Verweise auf beide Assemblyversionen.</span><span class="sxs-lookup"><span data-stu-id="64537-147">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="64537-148">Die Anwendung kann dann durch ein Manifest an die kompatible Version der Assembly weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="64537-148">The application can then be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="64537-149">Wenn verschiedene Komponenten für die neue und alte Version der Assembly verwendet werden, wird für das Update der vollständige Dateiaustausch verwendet.</span><span class="sxs-lookup"><span data-stu-id="64537-149">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>
-   <span data-ttu-id="64537-150">Ein direktes Update überschreibt die Kopie einer .NET Framework-Assembly im globalen Assemblycache.</span><span class="sxs-lookup"><span data-stu-id="64537-150">An in-place update overwrites the copy of a .NET Framework Assembly in the global assembly cache.</span></span> <span data-ttu-id="64537-151">Bei dieser Art von Assemblyaktualisierung wird der starke Name der Assembly nicht geändert.</span><span class="sxs-lookup"><span data-stu-id="64537-151">This type of assembly update does not change the strong name of the assembly.</span></span> <span data-ttu-id="64537-152">Nur der Wert im Feld "File Version" der [Tabelle "MsiAssemblyName](msiassemblyname-table.md) " wird geändert.</span><span class="sxs-lookup"><span data-stu-id="64537-152">Only the value in the FileVersion field of the [MsiAssemblyName table](msiassemblyname-table.md) is changed.</span></span> <span data-ttu-id="64537-153">Für das direkte Update einer .NET Framework Assembly ist .NET Framework 1,1 SP1 oder höher erforderlich.</span><span class="sxs-lookup"><span data-stu-id="64537-153">The in-place update of a .NET Framework Assembly requires .NET Framework 1.1 SP1 or greater.</span></span>
    > [!Note]  
    > <span data-ttu-id="64537-154">Der direkte Updatetyp überschreibt die Kopie der Assembly im globalen Cache und kann andere Anwendungen unterbrechen, wenn die neue Version der Assembly nicht vollständig abwärts kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="64537-154">The in-place type of update overwrites the copy of the assembly in the global cache, and can break other applications if the new version of the assembly is not completely backward compatible.</span></span> <span data-ttu-id="64537-155">Die empfohlene Methode zum Aktualisieren einer Assembly besteht darin, den starken Namen der Assembly in der [MsiAssemblyName-Tabelle](msiassemblyname-table.md)zu ändern.</span><span class="sxs-lookup"><span data-stu-id="64537-155">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

     

 

 



