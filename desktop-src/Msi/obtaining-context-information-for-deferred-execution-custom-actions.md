---
description: Da das Installationsskript außerhalb der Installationssitzung ausgeführt werden kann, in der es geschrieben wurde, ist die Sitzung während der Ausführung des Installations Skripts möglicherweise nicht mehr vorhanden.
ms.assetid: 13174c5d-c810-4b5d-9d1e-60ed30b8c44d
title: Abrufen von Kontextinformationen für benutzerdefinierte Aktionen der verzögerten Ausführung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a13cd956509a5b8a4c92e0a53bfa455154a59bcc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103753513"
---
# <a name="obtaining-context-information-for-deferred-execution-custom-actions"></a><span data-ttu-id="e32f1-103">Abrufen von Kontextinformationen für benutzerdefinierte Aktionen der verzögerten Ausführung</span><span class="sxs-lookup"><span data-stu-id="e32f1-103">Obtaining Context Information for Deferred Execution Custom Actions</span></span>

<span data-ttu-id="e32f1-104">Da das Installationsskript außerhalb der Installationssitzung ausgeführt werden kann, in der es geschrieben wurde, ist die Sitzung während der Ausführung des Installations Skripts möglicherweise nicht mehr vorhanden.</span><span class="sxs-lookup"><span data-stu-id="e32f1-104">Because installation script can be executed outside of the installation session in which it was written, the session may no longer exist during execution of the installation script.</span></span> <span data-ttu-id="e32f1-105">In diesem Fall sind die ursprünglichen Sitzungs Handles und Eigenschaften, die während der Installations Sequenz festgelegt werden, für eine benutzerdefinierte Aktion der verzögerten Ausführung nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="e32f1-105">In this case, the original session handle and properties set during the installation sequence are not available to a deferred execution custom action.</span></span> <span data-ttu-id="e32f1-106">Alle Funktionen, die ein Sitzungs handle erfordern, sind auf einige Methoden beschränkt, die Kontextinformationen abrufen können, oder andere Eigenschaften, die während der Skriptausführung benötigt werden, müssen in das Installationsskript geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="e32f1-106">Any functions that require a session handle are restricted to a few methods that can retrieve context information, or else properties that are needed during script execution must be written into the installation script.</span></span> <span data-ttu-id="e32f1-107">Beispielsweise übergeben verzögerte benutzerdefinierte Aktionen, die Dynamic Link Libraries (DLLs) aufzurufen, ein Handle, das nur zum Abrufen einer sehr begrenzten Menge von Informationen verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="e32f1-107">For example, deferred custom actions that call dynamic-link libraries (DLLs) pass a handle which can only be used to obtain a very limited amount of information.</span></span> <span data-ttu-id="e32f1-108">Auf Funktionen, die kein Sitzungs handle erfordern, kann über eine verzögerte benutzerdefinierte Aktion zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="e32f1-108">Functions that do not require a session handle can be accessed from a deferred custom action.</span></span>

<span data-ttu-id="e32f1-109">Benutzerdefinierte Aktionen der verzögerten Ausführung sind auf das Aufrufen der folgenden Funktionen beschränkt, die ein Handle erfordern.</span><span class="sxs-lookup"><span data-stu-id="e32f1-109">Deferred execution custom actions are restricted to calling only the following functions requiring a handle.</span></span>



| <span data-ttu-id="e32f1-110">Funktion</span><span class="sxs-lookup"><span data-stu-id="e32f1-110">Function</span></span>                                       | <span data-ttu-id="e32f1-111">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="e32f1-111">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e32f1-112">**MsiGetProperty**</span><span class="sxs-lookup"><span data-stu-id="e32f1-112">**MsiGetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetpropertya)       | <span data-ttu-id="e32f1-113">Unterstützt eine begrenzte Anzahl von Eigenschaften, wenn Sie mit [benutzerdefinierten Aktionen für die verzögerte Ausführung](deferred-execution-custom-actions.md)verwendet wird: die customaktiondata-Eigenschaft, die [**ProductCode**](productcode.md) -Eigenschaft und die [**UserSID**](usersid.md) -Eigenschaft [Benutzerdefinierte COMMIT-Aktionen](commit-custom-actions.md) können die [**MsiGetProperty**](/windows/desktop/api/Msiquery/nf-msiquery-msigetpropertya) -Funktion nicht zum Abrufen der [**ProductCode**](productcode.md) -Eigenschaft verwenden.</span><span class="sxs-lookup"><span data-stu-id="e32f1-113">Supports a limited set of properties when used with [deferred execution custom actions](deferred-execution-custom-actions.md): the CustomActionData property, [**ProductCode**](productcode.md) property, and [**UserSID**](usersid.md) property.[Commit custom actions](commit-custom-actions.md) cannot use the [**MsiGetProperty**](/windows/desktop/api/Msiquery/nf-msiquery-msigetpropertya) function to obtain the [**ProductCode**](productcode.md) property.</span></span> <span data-ttu-id="e32f1-114">Benutzerdefinierte COMMIT-Aktionen können die customaktiondata-Eigenschaft zum Abrufen des Produktcodes verwenden.</span><span class="sxs-lookup"><span data-stu-id="e32f1-114">Commit custom actions can use the CustomActionData property to obtain the product code.</span></span><br/> |
| [<span data-ttu-id="e32f1-115">**Msiformatrecord**</span><span class="sxs-lookup"><span data-stu-id="e32f1-115">**MsiFormatRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiformatrecorda)     | <span data-ttu-id="e32f1-116">Unterstützt eine begrenzte Anzahl von Eigenschaften, wenn Sie mit [benutzerdefinierten Aktionen für die verzögerte Ausführung](deferred-execution-custom-actions.md)verwendet wird: die Eigenschaften customaktiondata und ProductCode.</span><span class="sxs-lookup"><span data-stu-id="e32f1-116">Supports a limited set of properties when used with [deferred execution custom actions](deferred-execution-custom-actions.md): the CustomActionData and ProductCode properties.</span></span>                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="e32f1-117">**Msigetmode**</span><span class="sxs-lookup"><span data-stu-id="e32f1-117">**MsiGetMode**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode)               | <span data-ttu-id="e32f1-118">Beim Aufrufen von [benutzerdefinierten Aktionen für verzögerte Ausführung](deferred-execution-custom-actions.md), [Commit für benutzerdefinierte Aktionen](commit-custom-actions.md)oder Zurücksetzen von [benutzerdefinierten Aktionen](rollback-custom-actions.md)gibt [**msigetmode**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode) true oder false zurück, wenn es angefordert wird, die Modusparameter msirunmode \_ , geplant, msirunmode \_ Commit oder msirunmode Rollback zu überprüfen \_ .</span><span class="sxs-lookup"><span data-stu-id="e32f1-118">When called from [deferred execution custom actions](deferred-execution-custom-actions.md), [commit custom actions](commit-custom-actions.md), or [rollback custom actions](rollback-custom-actions.md), [**MsiGetMode**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode) returns True or False when requested to check the mode parameters MSIRUNMODE\_SCHEDULED, MSIRUNMODE\_COMMIT, or MSIRUNMODE\_ROLLBACK.</span></span> <span data-ttu-id="e32f1-119">Anforderungen zum Überprüfen anderer Parameter des Testlaufs aus einer verzögerten, Commit-oder Rollback-benutzerdefinierten Aktion gibt false zurück.</span><span class="sxs-lookup"><span data-stu-id="e32f1-119">Requests to check any other run mode parameters from a deferred, commit, or rollback custom action returns False.</span></span><br/>                       |
| [<span data-ttu-id="e32f1-120">**Msigetlanguage**</span><span class="sxs-lookup"><span data-stu-id="e32f1-120">**MsiGetLanguage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetlanguage)       | <span data-ttu-id="e32f1-121">Die numerische Sprach-ID für das aktuelle Produkt. [Benutzerdefinierte COMMIT-Aktionen](commit-custom-actions.md) können die [**msigetlanguage**](/windows/desktop/api/Msiquery/nf-msiquery-msigetlanguage) -Funktion nicht verwenden.</span><span class="sxs-lookup"><span data-stu-id="e32f1-121">The numeric language ID for the current product.[Commit custom actions](commit-custom-actions.md) cannot use the [**MsiGetLanguage**](/windows/desktop/api/Msiquery/nf-msiquery-msigetlanguage) function.</span></span> <span data-ttu-id="e32f1-122">Benutzerdefinierte COMMIT-Aktionen können die customaktiondata-Eigenschaft verwenden, um die numerische Sprach-ID zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="e32f1-122">Commit custom actions can use the CustomActionData property to get the numeric language ID.</span></span><br/>                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="e32f1-123">**Msiprocessmessage**</span><span class="sxs-lookup"><span data-stu-id="e32f1-123">**MsiProcessMessage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) | <span data-ttu-id="e32f1-124">Verarbeitet Fehler-oder Fortschrittsmeldungen von der benutzerdefinierten Aktion.</span><span class="sxs-lookup"><span data-stu-id="e32f1-124">Processes error or progress messages from the custom action.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

<span data-ttu-id="e32f1-125">Für eine benutzerdefinierte Aktion, die in JScript oder VBScript geschrieben ist, ist das install [**Session**](session-object.md) -Objekt erforderlich.</span><span class="sxs-lookup"><span data-stu-id="e32f1-125">A custom action that is written in JScript or VBScript requires the install [**Session**](session-object.md) object.</span></span> <span data-ttu-id="e32f1-126">Dies ist vom Typ **Sitzungs Objekt** , und das Installationsprogramm fügt es dem Skript mit dem Namen "Session" an.</span><span class="sxs-lookup"><span data-stu-id="e32f1-126">This is of the type **Session Object** and the installer attaches it to the script with the name "Session".</span></span> <span data-ttu-id="e32f1-127">Da das **Sitzungs** Objekt während eines Installations Rollbacks möglicherweise nicht vorhanden ist, muss eine verzögerte benutzerdefinierte Aktion, die im Skript geschrieben wurde, eine der folgenden Methoden oder Eigenschaften des **Session** -Objekts verwenden, um den Kontext abzurufen.</span><span class="sxs-lookup"><span data-stu-id="e32f1-127">Because the **Session** object may not exist during an installation rollback, a deferred custom action written in script must use one of the following methods or properties of the **Session** object to retrieve its context.</span></span>



| <span data-ttu-id="e32f1-128">Name</span><span class="sxs-lookup"><span data-stu-id="e32f1-128">Name</span></span>                                                           | <span data-ttu-id="e32f1-129">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="e32f1-129">Description</span></span>                                                                                                                        |
|----------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e32f1-130">**Mode-Eigenschaft**</span><span class="sxs-lookup"><span data-stu-id="e32f1-130">**Mode Property**</span></span>](session-mode.md)                          | <span data-ttu-id="e32f1-131">Gibt true für msirunmode \_ nur geplant zurück.</span><span class="sxs-lookup"><span data-stu-id="e32f1-131">Returns True for MSIRUNMODE\_SCHEDULED only.</span></span>                                                                                       |
| [<span data-ttu-id="e32f1-132">**Property-Eigenschaft (Session-Objekt)**</span><span class="sxs-lookup"><span data-stu-id="e32f1-132">**Property Property (Session Object)**</span></span>](session-session.md)  | <span data-ttu-id="e32f1-133">Gibt die customaktiondata-Eigenschaft, die [**ProductCode**](productcode.md) -Eigenschaft oder die [**UserSID**](usersid.md) -Eigenschaft zurück.</span><span class="sxs-lookup"><span data-stu-id="e32f1-133">Returns the CustomActionData property, [**ProductCode**](productcode.md) property, or [**UserSID**](usersid.md) property.</span></span>        |
| [<span data-ttu-id="e32f1-134">**Language-Eigenschaft (Session-Objekt)**</span><span class="sxs-lookup"><span data-stu-id="e32f1-134">**Language Property (Session Object)**</span></span>](session-language.md) | <span data-ttu-id="e32f1-135">Gibt die numerische Sprach-ID der Installationssitzung zurück.</span><span class="sxs-lookup"><span data-stu-id="e32f1-135">Returns numeric language ID of the installation session.</span></span>                                                                           |
| [<span data-ttu-id="e32f1-136">**Message-Methode**</span><span class="sxs-lookup"><span data-stu-id="e32f1-136">**Message Method**</span></span>](session-message.md)                      | <span data-ttu-id="e32f1-137">Wird aufgerufen, um Fehler und den Fortschritt zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="e32f1-137">Called to handle errors and progress.</span></span>                                                                                              |
| [<span data-ttu-id="e32f1-138">**Installereigenschaft**</span><span class="sxs-lookup"><span data-stu-id="e32f1-138">**Installer Property**</span></span>](session-installer.md)                | <span data-ttu-id="e32f1-139">Gibt das übergeordnete-Objekt zurück, das für Funktionen ohne Sitzung verwendet wird, z. b. Registrierungs Zugriff und installerkonfigurationsverwaltung.</span><span class="sxs-lookup"><span data-stu-id="e32f1-139">Returns the parent object, which is used for non-session functions such as registry access and installer configuration management.</span></span> |



 

<span data-ttu-id="e32f1-140">Eigenschaftswerte, die zum Zeitpunkt der Verarbeitung der Installations Sequenz in das Skript festgelegt werden, sind möglicherweise zum Zeitpunkt der Skriptausführung nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="e32f1-140">Property values that are set at the time the installation sequence is processed into script may be unavailable at the time of script execution.</span></span> <span data-ttu-id="e32f1-141">Nur die folgenden eingeschränkten Eigenschaften sind während der Skriptausführung immer für benutzerdefinierte Aktionen zugänglich.</span><span class="sxs-lookup"><span data-stu-id="e32f1-141">Only the following limited set of properties is always accessible to custom actions during script execution.</span></span>



| <span data-ttu-id="e32f1-142">Eigenschaftenname</span><span class="sxs-lookup"><span data-stu-id="e32f1-142">Property name</span></span>                      | <span data-ttu-id="e32f1-143">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="e32f1-143">Description</span></span>                                                                                                                                                                                                     |
|------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e32f1-144">Customaktiondata</span><span class="sxs-lookup"><span data-stu-id="e32f1-144">CustomActionData</span></span>                   | <span data-ttu-id="e32f1-145">Wert, wenn die benutzerdefinierte Aktion in der Sequenz Tabelle verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="e32f1-145">Value at time custom action is processed in sequence table.</span></span> <span data-ttu-id="e32f1-146">Die customaktiondata-Eigenschaft ist nur für benutzerdefinierte Aktionen mit verzögerter Ausführung verfügbar.</span><span class="sxs-lookup"><span data-stu-id="e32f1-146">The CustomActionData property is only available to deferred execution custom actions.</span></span> <span data-ttu-id="e32f1-147">Sofortige benutzerdefinierte Aktionen haben keinen Zugriff auf diese Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="e32f1-147">Immediate custom actions do not have access to this property.</span></span> |
| [<span data-ttu-id="e32f1-148">**ProductCode**</span><span class="sxs-lookup"><span data-stu-id="e32f1-148">**ProductCode**</span></span>](productcode.md) | <span data-ttu-id="e32f1-149">Eindeutiger Code für das Produkt, eine [GUID](guid.md) -Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="e32f1-149">Unique code for the product, a [GUID](guid.md) string.</span></span>                                                                                                                                                         |
| [<span data-ttu-id="e32f1-150">**UserSID**</span><span class="sxs-lookup"><span data-stu-id="e32f1-150">**UserSID**</span></span>](usersid.md)         | <span data-ttu-id="e32f1-151">Wird vom Installationsprogramm auf die Sicherheits-ID (SID) des Benutzers festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e32f1-151">Set by the installer to the user's security identifier (SID).</span></span>                                                                                                                                                   |



 

<span data-ttu-id="e32f1-152">Wenn für die benutzerdefinierte Aktion verzögerte Ausführung andere Eigenschaften Daten erforderlich sind, müssen die zugehörigen Werte im Installationsskript gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="e32f1-152">If other property data is required by the deferred execution custom action, then their values must be stored in the installation script.</span></span> <span data-ttu-id="e32f1-153">Dies kann mithilfe einer zweiten benutzerdefinierten Aktion erfolgen.</span><span class="sxs-lookup"><span data-stu-id="e32f1-153">This can be done by using a second custom action.</span></span>

<span data-ttu-id="e32f1-154">**So schreiben Sie den Wert einer Eigenschaft in das Installationsskript für die Verwendung während einer benutzerdefinierten Aktion für eine verzögerte Ausführung**</span><span class="sxs-lookup"><span data-stu-id="e32f1-154">**To write the value of a property into the installation script for use during a deferred execution custom action**</span></span>

1.  <span data-ttu-id="e32f1-155">Fügen Sie eine kleine benutzerdefinierte Aktion in die Installations Sequenz ein, mit der die zu berücksichtigende Eigenschaft auf eine Eigenschaft festgelegt wird, die denselben Namen wie die benutzerdefinierte Aktion der verzögerten</span><span class="sxs-lookup"><span data-stu-id="e32f1-155">Insert a small custom action into the installation sequence that sets the property of interest to a property having the same name as the deferred execution custom action.</span></span> <span data-ttu-id="e32f1-156">Wenn beispielsweise der Primärschlüssel für die benutzerdefinierte Aktion für die verzögerte Ausführung "myaction" lautet, legen Sie eine Eigenschaft mit dem Namen "myaction" auf die X-Eigenschaft fest, die Sie abrufen müssen.</span><span class="sxs-lookup"><span data-stu-id="e32f1-156">For example, if the primary key for the deferred execution custom action is "MyAction" set a property named "MyAction" to the property X which you need to retrieve.</span></span> <span data-ttu-id="e32f1-157">Sie müssen die Eigenschaft "myaction" in der Installations Sequenz vor der benutzerdefinierten Aktion "myaction" festlegen.</span><span class="sxs-lookup"><span data-stu-id="e32f1-157">You must set the "MyAction" property in the installation sequence before the "MyAction" custom action.</span></span> <span data-ttu-id="e32f1-158">Obwohl eine beliebige Art von benutzerdefinierter Aktion die Kontext Daten festlegen kann, ist die einfachste Methode, eine benutzerdefinierte Aktion für die Eigenschaften Zuweisung zu verwenden (z. b. [benutzerdefinierter Aktionstyp 51](custom-action-type-51.md)).</span><span class="sxs-lookup"><span data-stu-id="e32f1-158">Although any type of custom action can set the context data, the simplest method is to use a property assignment custom action (for example [Custom Action Type 51](custom-action-type-51.md)).</span></span>
2.  <span data-ttu-id="e32f1-159">Zum Zeitpunkt der Verarbeitung der Installations Sequenz schreibt das Installationsprogramm den Wert der Eigenschaft X in das Ausführungs Skript als Wert der Eigenschaft customaktiondata.</span><span class="sxs-lookup"><span data-stu-id="e32f1-159">At the time when the installation sequence is processed, the installer will write the value of property X into the execution script as the value of the property CustomActionData.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e32f1-160">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="e32f1-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e32f1-161">Informationen zu Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="e32f1-161">About Properties</span></span>](about-properties.md)
</dt> <dt>

[<span data-ttu-id="e32f1-162">Verwenden von Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="e32f1-162">Using Properties</span></span>](using-properties.md)
</dt> <dt>

[<span data-ttu-id="e32f1-163">Eigenschafts Verweis</span><span class="sxs-lookup"><span data-stu-id="e32f1-163">Property Reference</span></span>](property-reference.md)
</dt> </dl>

 

 




