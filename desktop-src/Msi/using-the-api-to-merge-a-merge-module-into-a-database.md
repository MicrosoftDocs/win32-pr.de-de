---
description: Mergemodule stellen eine Standardmethode für Entwickler bereit, um freigegebene Windows Installer Komponenten und Setup Logik für Ihre Anwendungen bereitzustellen.
ms.assetid: 3eb087b1-0f44-40d8-a950-67d489f09408
title: Verwenden der API zum Zusammenführen eines Mergemoduls zu einer Datenbank
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2e68298671045825dda41ad120896fa22c89f068
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106358594"
---
# <a name="using-the-api-to-merge-a-merge-module-into-a-database"></a><span data-ttu-id="1718c-103">Verwenden der API zum Zusammenführen eines Mergemoduls zu einer Datenbank</span><span class="sxs-lookup"><span data-stu-id="1718c-103">Using the API to Merge a Merge Module into a Database</span></span>

<span data-ttu-id="1718c-104">[Mergemodule](merge-modules.md) stellen eine Standardmethode für Entwickler bereit, um freigegebene Windows Installer [*Komponenten*](c-gly.md) und Setup Logik für Ihre Anwendungen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="1718c-104">[Merge modules](merge-modules.md) provide a standard method for developers to deliver shared Windows Installer [*components*](c-gly.md) and setup logic to their applications.</span></span> <span data-ttu-id="1718c-105">Mergemodule müssen mithilfe eines mergetools in ein Installationspaket zusammengeführt werden.</span><span class="sxs-lookup"><span data-stu-id="1718c-105">Merge modules must be merged into an installation package using a merge tool.</span></span> <span data-ttu-id="1718c-106">Die beste Alternative besteht darin, ein frei verteiltes Zusammenführungs Tool zu erwerben oder eines der Zusammenführungs Tools zu erwerben, die von unabhängigen Softwareanbietern zur Verfügung stehen.</span><span class="sxs-lookup"><span data-stu-id="1718c-106">The best alternative is to obtain a freely distributed merge tool or purchase one of the merging tools available from independent software vendors.</span></span> <span data-ttu-id="1718c-107">Beispielsweise können Sie die von [Mergemod.dll](merge-module-automation.md)bereitgestellte Funktionalität nutzen.</span><span class="sxs-lookup"><span data-stu-id="1718c-107">For example you can use the functionality provided by [Mergemod.dll](merge-module-automation.md).</span></span>

<span data-ttu-id="1718c-108">Führen Sie die folgenden Schritte nacheinander aus, um ein Mergemodul mithilfe der-API von [Mergemod.dll](merge-module-automation.md)in einer Windows Installer-Installations Datenbank zusammenzuführen.</span><span class="sxs-lookup"><span data-stu-id="1718c-108">Use the following steps in sequence to merge a merge module into a Windows Installer installation database by the API of [Mergemod.dll](merge-module-automation.md).</span></span>

<span data-ttu-id="1718c-109">**So führen Sie ein Mergemodul in einer Windows Installer-Installations Datenbank zusammen**</span><span class="sxs-lookup"><span data-stu-id="1718c-109">**To merge a merge module into a Windows Installer installation database**</span></span>

1.  <span data-ttu-id="1718c-110">Öffnen Sie mithilfe von [**OpenLog**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-openlog)eine Protokolldatei.</span><span class="sxs-lookup"><span data-stu-id="1718c-110">Open a log file using [**OpenLog**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-openlog).</span></span> <span data-ttu-id="1718c-111">Dieser Schritt ist nur erforderlich, wenn Sie eine Protokolldatei erstellen oder eine vorhandene Protokolldatei für den Mergeprozess Anfügen müssen.</span><span class="sxs-lookup"><span data-stu-id="1718c-111">This step is required only if you need to create a log file, or append an existing log file, for the merge process.</span></span>
2.  <span data-ttu-id="1718c-112">Öffnen Sie die Installations Datenbank, eine [MSI-Datei](windows-installer-file-extensions.md), die das Mergemodul mithilfe von [**OpenDatabase**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-opendatabase)empfängt.</span><span class="sxs-lookup"><span data-stu-id="1718c-112">Open the installation database, an [.msi file](windows-installer-file-extensions.md), that will receive the merge module using [**OpenDatabase**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-opendatabase).</span></span> <span data-ttu-id="1718c-113">Dieser Schritt ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="1718c-113">This step is required.</span></span>
3.  <span data-ttu-id="1718c-114">Öffnen Sie das Mergemodul, eine [MSM-Datei](windows-installer-file-extensions.md), die mit [**OpenModule**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-openmodule)in der Datenbank zusammengeführt wird.</span><span class="sxs-lookup"><span data-stu-id="1718c-114">Open the merge module, an [.msm file](windows-installer-file-extensions.md), that is being merged into the database using [**OpenModule**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-openmodule).</span></span> <span data-ttu-id="1718c-115">Ein Modul muss geöffnet werden, bevor es mit einer Installations Datenbank zusammengeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="1718c-115">A module must be opened before it can be merged with an installation database.</span></span> <span data-ttu-id="1718c-116">Dieser Schritt ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="1718c-116">This step is required.</span></span>
4.  <span data-ttu-id="1718c-117">Führen Sie das Modul mithilfe von [**Merge**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-merge) oder [**mergeex**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-mergeex)in der Installations Datenbank zusammen.</span><span class="sxs-lookup"><span data-stu-id="1718c-117">Merge the module into the installation database by using [**Merge**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-merge) or [**MergeEx**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-mergeex).</span></span> <span data-ttu-id="1718c-118">Beachten Sie, dass **Merge** oder **mergeex** nur einmal aufgerufen werden kann, um eine bestimmte Kombination aus MSI-und MSM-Dateien zusammenzuführen.</span><span class="sxs-lookup"><span data-stu-id="1718c-118">Note that **Merge** or **MergeEx** can only be called once to merge a particular combination of .msi and .msm files.</span></span> <span data-ttu-id="1718c-119">**Mergeex** ist nur verfügbar, wenn [Mergemod.dll-Version 2,0](merge-module-automation.md) oder höher und nur bei Verwendung der [IMsmMerge2](/windows/desktop/api/Mergemod/nn-mergemod-imsmmerge2) -Schnittstelle verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="1718c-119">**MergeEx** is only available when using [Mergemod.dll version 2.0](merge-module-automation.md) or later and only when using the [IMsmMerge2](/windows/desktop/api/Mergemod/nn-mergemod-imsmmerge2) interface.</span></span> <span data-ttu-id="1718c-120">Dieser Schritt ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="1718c-120">This step is required.</span></span>
5.  <span data-ttu-id="1718c-121">Ruft [**get \_ Errors**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-get_errors) auf und untersucht die abgerufene Auflistung von Fehlern bei Mergekonflikten oder anderen Fehlern.</span><span class="sxs-lookup"><span data-stu-id="1718c-121">Call [**get\_Errors**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-get_errors) and examine the retrieved collection of errors for merge conflicts or other errors.</span></span> <span data-ttu-id="1718c-122">Der Abruf ist nicht destruktiv.</span><span class="sxs-lookup"><span data-stu-id="1718c-122">The retrieval is non-destructive.</span></span> <span data-ttu-id="1718c-123">Mehrere Instanzen der Fehlersammlung können durch wiederholtes Lesen von get- **\_ Fehlern** abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="1718c-123">Multiple instances of the error collection may be retrieved by repeatedly reading calling **get\_Errors**.</span></span> <span data-ttu-id="1718c-124">Sie müssen alle Fehler beheben, die für Ihren Fall geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="1718c-124">You will need to resolve any errors as appropriate for your case.</span></span>
6.  <span data-ttu-id="1718c-125">Ordnen Sie die Komponenten des Mergemoduls allen zusätzlichen Features zu, die mithilfe von [**Connect**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-connect)in der Installations Datenbank zusammengeführt wurden oder werden.</span><span class="sxs-lookup"><span data-stu-id="1718c-125">Associate the components of the merge module with any additional features that have been, or will be, merged into the installation database using [**Connect**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-connect).</span></span> <span data-ttu-id="1718c-126">Die Funktion muss bereits vorhanden sein, bevor diese Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="1718c-126">The feature must already exist before calling this method.</span></span> <span data-ttu-id="1718c-127">Dieser Schritt ist nur erforderlich, wenn Sie über zusätzliche Funktionen verfügen. Weitere Informationen finden Sie [unter Verbinden eines Mergemoduls mit mehreren Features](connecting-a-merge-module-to-multiple-features.md) .</span><span class="sxs-lookup"><span data-stu-id="1718c-127">This step is only required if you have additional features, for more information see [Connecting a Merge Module to Multiple Features](connecting-a-merge-module-to-multiple-features.md)</span></span>
7.  <span data-ttu-id="1718c-128">Extrahieren Sie ggf. Quelldateien aus dem Modul, indem Sie eine oder mehrere der folgenden Schritte durchgeführt haben.</span><span class="sxs-lookup"><span data-stu-id="1718c-128">If necessary, extract source files from the module by doing one or more of the following.</span></span>

    <span data-ttu-id="1718c-129">Um Dateien aus einer eingebetteten CAB-Datei zu extrahieren und dann in ein bestimmtes Verzeichnis zu kopieren, verwenden Sie [**ExtractFiles**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-extractfiles) oder [**extractfilesex**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-extractfilesex).</span><span class="sxs-lookup"><span data-stu-id="1718c-129">To extract files from an embedded .cab file and then copy into a specified directory, use [**ExtractFiles**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-extractfiles) or [**ExtractFilesEx**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-extractfilesex).</span></span> <span data-ttu-id="1718c-130">Beachten Sie, dass **extractfilesex** [Mergemod.dll Version 2,0](merge-module-automation.md) oder höher erfordert.</span><span class="sxs-lookup"><span data-stu-id="1718c-130">Note that **ExtractFilesEx** requires [Mergemod.dll version 2.0](merge-module-automation.md) or later.</span></span>

    <span data-ttu-id="1718c-131">Verwenden Sie [**ExtractCab**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-extractcab), um Dateien aus einer eingebetteten CAB-Datei zu extrahieren und Sie dann in einer angegebenen Datei zu speichern.</span><span class="sxs-lookup"><span data-stu-id="1718c-131">To extract files from an embedded .cab file and then save in a specified file, use [**ExtractCAB**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-extractcab).</span></span>

    <span data-ttu-id="1718c-132">Verwenden Sie zum Extrahieren von Dateien aus einem Modul und anschließendes Kopieren in ein Quell Abbild auf dem Datenträger nach der Zusammenführung den Befehl " [**kreatesourceimage**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-createsourceimage).</span><span class="sxs-lookup"><span data-stu-id="1718c-132">To extract files from a module and then copy to a source image on disk after the merge, use [**CreateSourceImage**](/windows/desktop/api/Mergemod/nf-mergemod-imsmmerge2-createsourceimage).</span></span> <span data-ttu-id="1718c-133">Beachten Sie, dass " **kreatesourceimage** " nur mit [Mergemod.dll Version 2,0](merge-module-automation.md) oder höher verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="1718c-133">Note that **CreateSourceImage** is only available with [Mergemod.dll version 2.0](merge-module-automation.md) or later.</span></span>

8.  <span data-ttu-id="1718c-134">Schließen Sie das aktuelle geöffnete Mergemodul mithilfe von [**closemodule**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closemodule).</span><span class="sxs-lookup"><span data-stu-id="1718c-134">Close the current open merge module using [**CloseModule**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closemodule).</span></span> <span data-ttu-id="1718c-135">Dieser Schritt ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="1718c-135">This step is required.</span></span>
9.  <span data-ttu-id="1718c-136">Schließen Sie die aktuelle geöffnete Installations Datenbank mithilfe von [**CloseDatabase**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closedatabase).</span><span class="sxs-lookup"><span data-stu-id="1718c-136">Close the current open installation database using [**CloseDatabase**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closedatabase).</span></span> <span data-ttu-id="1718c-137">Dieser Schritt ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="1718c-137">This step is required.</span></span> <span data-ttu-id="1718c-138">Durch das Schließen einer Datenbank werden alle Abhängigkeitsinformationen gelöscht, aber keine Fehler, die noch nicht abgerufen wurden.</span><span class="sxs-lookup"><span data-stu-id="1718c-138">Closing a database clears all dependency information but does not affect any errors that have not been retrieved.</span></span>
10. <span data-ttu-id="1718c-139">Schließen Sie die aktuelle Protokolldatei mit [**closelog**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closelog).</span><span class="sxs-lookup"><span data-stu-id="1718c-139">Close the current log file using [**CloseLog**](/windows/win32/api/mergemod/nf-mergemod-imsmmerge-closelog).</span></span> <span data-ttu-id="1718c-140">Dieser Schritt ist erforderlich, wenn Sie eine Protokolldatei geöffnet haben.</span><span class="sxs-lookup"><span data-stu-id="1718c-140">This step is required if you have opened a log file.</span></span>

<span data-ttu-id="1718c-141">Nachdem das Modul mithilfe von [Mergemod.dll](merge-module-automation.md)in der Datenbank zusammengeführt wurde, muss die [Medien Tabelle](media-table.md) aktualisiert werden, damit das gewünschte Layout des Quell Bilds beschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="1718c-141">After the module has been merged into the database using [Mergemod.dll](merge-module-automation.md), the [Media Table](media-table.md) must be updated to describe the desired source image layout.</span></span> <span data-ttu-id="1718c-142">Der von Mergemod.dll bereitgestellte Mergeprozess aktualisiert die Medien Tabelle nicht, da der Consumer des Mergemoduls verschiedene Möglichkeiten zum Layout des Quell Bilds auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="1718c-142">The merge process provided by Mergemod.dll does not update the Media Table because the consumer of the merge module can select various ways to layout the source image.</span></span>

 

 
