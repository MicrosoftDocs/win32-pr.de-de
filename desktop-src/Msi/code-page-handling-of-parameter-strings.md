---
description: Sie können einer Installations Datenbank Lokalisierungs Informationen hinzufügen, indem Sie einen Datenbanktabellen-Editor wie z. b. Orca verwenden, der mit dem Windows Installer SDK bereitgestellt wird, oder indem Sie die Datenbankfunktionen einer Anwendung aufrufen.
ms.assetid: cc1eb336-5dec-40cc-8aa5-564cd167855d
title: Code Page Behandlung von Parameter Zeichenfolgen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22a52872472d5509e1abdf35aa12be5afb6a8d13
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104214863"
---
# <a name="code-page-handling-of-parameter-strings"></a><span data-ttu-id="d7f32-103">Code Page Behandlung von Parameter Zeichenfolgen</span><span class="sxs-lookup"><span data-stu-id="d7f32-103">Code Page Handling of Parameter Strings</span></span>

<span data-ttu-id="d7f32-104">Sie können einer Installations Datenbank Lokalisierungs Informationen hinzufügen, indem Sie einen Datenbanktabellen-Editor wie z. b. Orca verwenden, der mit dem Windows Installer SDK bereitgestellt wird, oder indem Sie die [Datenbankfunktionen](database-functions.md) einer Anwendung aufrufen.</span><span class="sxs-lookup"><span data-stu-id="d7f32-104">You can add localization information to an installation database by using a database table editor such as Orca that is provided with the Windows Installer SDK, or by calling the [Database Functions](database-functions.md) from an application.</span></span> <span data-ttu-id="d7f32-105">Achten Sie darauf, nur Zeichen folgen Parameter zu übergeben, die die Codepage der Datenbank verwenden, die lokalisiert wird.</span><span class="sxs-lookup"><span data-stu-id="d7f32-105">Be careful to only pass string parameters that use the code page of the database that is being localized.</span></span> <span data-ttu-id="d7f32-106">Wenn ein Zeichen folgen Parameter Zeichen enthält, die von der Codepage der Datenbank nicht dargestellt werden können, gibt das Installationsprogramm einen Fehler zurück, wenn [**msidatabaseimport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta)aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="d7f32-106">If a string parameter contains characters that cannot be represented by the code page of the database, the Installer returns an error when calling [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="d7f32-107">Eine Liste numerischer Codepages finden Sie unter [lokalisieren der Fehler-und Aktions Text Tabellen](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="d7f32-107">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="d7f32-108">Weitere Informationen finden Sie unter [bestimmen der Codepage einer Installations Datenbank](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="d7f32-108">For more information, see [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

## <a name="adding-localization-information-to-a-database"></a><span data-ttu-id="d7f32-109">Hinzufügen von Lokalisierungs Informationen zu einer Datenbank</span><span class="sxs-lookup"><span data-stu-id="d7f32-109">Adding Localization Information to a Database</span></span>

<span data-ttu-id="d7f32-110">Wenn Sie einer Datenbank Lokalisierungs Informationen hinzufügen, muss die Codepage der Datenbank vom Betriebssystem unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="d7f32-110">When you add localization information to a database, the code page of the database must be supported by the operating system.</span></span> <span data-ttu-id="d7f32-111">Es muss sich nicht um die aktuelle Codepage des Systems handeln.</span><span class="sxs-lookup"><span data-stu-id="d7f32-111">It does not have to be the current code page of the system.</span></span> <span data-ttu-id="d7f32-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) muss für die Daten Bank Codepage **true** zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="d7f32-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) must return **TRUE** for the database code page.</span></span> <span data-ttu-id="d7f32-113">Da ANSI-Zeichen folgen vom System in Unicode konvertiert werden, ist ein Fehler aufgetreten, wenn die Codepage des aktuellen Benutzers nicht mit der Daten Bank Codepage übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="d7f32-113">Because the system converts ANSI strings to Unicode, there is an error if the current user code page is not the same as the database code page.</span></span>

<span data-ttu-id="d7f32-114">Wenn Sie die ANSI-Version der Windows Installer-API aufrufen, wird die lokalisierte Zeichenfolge mithilfe der aktuellen System Codepage in Unicode konvertiert.</span><span class="sxs-lookup"><span data-stu-id="d7f32-114">Calling the ANSI version of the Windows Installer API converts the localized string to Unicode by using the current system code page.</span></span> <span data-ttu-id="d7f32-115">Wenn für die Datenbank ein Commit ausgeführt wird, wird die Unicode-Zeichenfolge mithilfe der Codepage der Datenbank in ANSI konvertiert.</span><span class="sxs-lookup"><span data-stu-id="d7f32-115">When the database is committed, the Unicode string is converted to ANSI using the code page of the database.</span></span> <span data-ttu-id="d7f32-116">Wenn die aktuelle System Codepage von der Codepage der lokalisierten Zeichenfolge abweicht, kann das Ergebnis ein Datenverlust und eine falsche Zeichen folgen Konvertierung sein.</span><span class="sxs-lookup"><span data-stu-id="d7f32-116">If the current system code page differs from the code page of the localized string, the result can be a loss of data and incorrect string conversion.</span></span>

<span data-ttu-id="d7f32-117">Im folgenden Verfahren wird gezeigt, wie die Lokalisierungsdaten gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="d7f32-117">The following procedure shows you how to store the localization data.</span></span>

<span data-ttu-id="d7f32-118">**So speichern Sie Lokalisierungsdaten**</span><span class="sxs-lookup"><span data-stu-id="d7f32-118">**To store localization data**</span></span>

1.  <span data-ttu-id="d7f32-119">Legen Sie die Codepage der Datenbank auf die Codepage der lokalisierten Zeichenfolge fest.</span><span class="sxs-lookup"><span data-stu-id="d7f32-119">Set the code page of the database to the code page of the localized string.</span></span>
2.  <span data-ttu-id="d7f32-120">Konvertieren Sie die ANSI-Zeichenfolge in Unicode, indem Sie die [**multibytedewidechar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) -Funktion verwenden, und geben Sie die Codepage der lokalisierten Daten an.</span><span class="sxs-lookup"><span data-stu-id="d7f32-120">Convert the ANSI string to Unicode by using the [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) function, and specify the code page of the localized data.</span></span>
3.  <span data-ttu-id="d7f32-121">Verwenden Sie die Unicode-Version der Windows Installer-API, um die lokalisierten Daten mit der Unicode-Zeichenfolge hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="d7f32-121">Call the Unicode version of the Windows Installer API by using the Unicode string to add the localized data.</span></span>
4.  <span data-ttu-id="d7f32-122">Übertragen Sie die Lokalisierungs Änderungen mithilfe von [**msidatabasecommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit)in der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d7f32-122">Commit the localization changes to the database by using [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span>

<span data-ttu-id="d7f32-123">Sie können einer Installations Datenbank auch Lokalisierungs Informationen hinzufügen, indem Sie ASCII-Textarchiv Dateien importieren und exportieren.</span><span class="sxs-lookup"><span data-stu-id="d7f32-123">You can also add localization information to an installation database by importing and exporting ASCII text archive files.</span></span> <span data-ttu-id="d7f32-124">Weitere Informationen finden Sie unter [Code Page Handling of importierte and exportierte Tables](code-page-handling-of-imported-and-exported-tables.md).</span><span class="sxs-lookup"><span data-stu-id="d7f32-124">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

 

 
