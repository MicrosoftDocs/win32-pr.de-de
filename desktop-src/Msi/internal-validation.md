---
description: Beim Erstellen eines Installationspakets können Sie die msiviewmodify-Funktion oder die View. Modify-Methode verwenden, um sicherzustellen, dass die eingegebenen Daten syntaktisch korrekt sind.
ms.assetid: c960e9df-dcd6-44d2-8662-40a1dea81f45
title: Interne Validierung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca3c1a9e6f7b7e35b4d7d91287af64eff7812de6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104128376"
---
# <a name="internal-validation"></a><span data-ttu-id="379f4-103">Interne Validierung</span><span class="sxs-lookup"><span data-stu-id="379f4-103">Internal Validation</span></span>

<span data-ttu-id="379f4-104">Beim Erstellen eines Installationspakets können Sie die [**msiviewmodify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) -Funktion oder die View. Modify-Methode verwenden, um sicherzustellen, dass die eingegebenen Daten syntaktisch korrekt sind.</span><span class="sxs-lookup"><span data-stu-id="379f4-104">When authoring an installation package, you can use the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function or the View.Modify method to ensure that the data you enter is syntactically correct.</span></span> <span data-ttu-id="379f4-105">Weitere Informationen finden Sie unter [**Modify-Methode**](view-modify.md).</span><span class="sxs-lookup"><span data-stu-id="379f4-105">For more information, see [**Modify method**](view-modify.md).</span></span> <span data-ttu-id="379f4-106">Auf der niedrigsten Ebene kann die Spalte einer Datenbanktabelle ganze Zahlen (Short oder Long), Zeichen folgen oder Binärdaten speichern.</span><span class="sxs-lookup"><span data-stu-id="379f4-106">At the lowest level, a database table's column can store integers (short or long), strings, or binary data.</span></span> <span data-ttu-id="379f4-107">Ein Installationspaket erfordert jedoch bestimmte ganze Zahlen oder Zeichen folgen in bestimmten Tabellen.</span><span class="sxs-lookup"><span data-stu-id="379f4-107">However, an installation package requires specific integers or strings in certain tables.</span></span> <span data-ttu-id="379f4-108">Diese Spezifikationen werden in der [ \_ Validierungs Tabelle](-validation-table.md)beibehalten.</span><span class="sxs-lookup"><span data-stu-id="379f4-108">These specifications are maintained in the [\_Validation table](-validation-table.md).</span></span> <span data-ttu-id="379f4-109">Beispielsweise ist die FileName-Spalte der [File-Tabelle](file-table.md) eine Zeichen folgen Spalte, aber Sie speichert speziell einen Dateinamen.</span><span class="sxs-lookup"><span data-stu-id="379f4-109">For example, the FileName column of the [File table](file-table.md) is a string column, but it specifically stores a file name.</span></span> <span data-ttu-id="379f4-110">Daher sollte Ihr Eintrag nicht nur eine Zeichenfolge sein, sondern auch die Anforderungen für das Benennen von Dateien erfüllen.</span><span class="sxs-lookup"><span data-stu-id="379f4-110">Therefore, not only should your entry be a string, but it should also follow the requirements for naming files.</span></span>

<span data-ttu-id="379f4-111">Die verschiedenen Validierungs Enumerationswerte, die mit der [**msiviewmodify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) -Funktion verwendet werden, ermöglichen eine sofortige Validierung auf unterschiedlichen Ebenen.</span><span class="sxs-lookup"><span data-stu-id="379f4-111">The various validation enum values used with the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function allow for immediate validation at different levels.</span></span> <span data-ttu-id="379f4-112">Die msimodify-Feld-Überprüfung \_ \_ kann verwendet werden, um einzelne Felder eines Datensatzes zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="379f4-112">The MSIMODIFY\_VALIDATE\_FIELD enum can be used to validate individual fields of a record.</span></span> <span data-ttu-id="379f4-113">Fremdschlüssel werden nicht überprüft.</span><span class="sxs-lookup"><span data-stu-id="379f4-113">It does not validate foreign keys.</span></span> <span data-ttu-id="379f4-114">Die msimodify \_ -Enumeration-Überprüfung überprüft eine ganze Zeile und schließt die Fremdschlüssel Überprüfung ein.</span><span class="sxs-lookup"><span data-stu-id="379f4-114">The MSIMODIFY\_VALIDATE enum validates an entire row and includes foreign key validation.</span></span> <span data-ttu-id="379f4-115">Wenn Sie eine neue Zeile in eine Tabelle einfügen, überprüfen Sie mithilfe der msimodify \_ \_ New-Enumeration, ob Sie gültige Daten hinzufügen, und verwenden Sie eindeutige Primärschlüssel.</span><span class="sxs-lookup"><span data-stu-id="379f4-115">If you are inserting a new row into a table, use the MSIMODIFY\_VALIDATE\_NEW enum to verify that you are adding valid data as well as using unique primary keys.</span></span> <span data-ttu-id="379f4-116">Eine Einfügung schlägt fehl, wenn die Primärschlüssel nicht eindeutig sind.</span><span class="sxs-lookup"><span data-stu-id="379f4-116">An insert fails if the primary keys are not unique.</span></span> <span data-ttu-id="379f4-117">Wenn bei einem Aufruf von **msiviewmodify** mit einer der Überprüfungs Aufstellungen ein Fehler zurückgegeben wird, können Sie [**msiviewgeterror**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) wiederholt aufrufen, um das Problem zu diagnostizieren.</span><span class="sxs-lookup"><span data-stu-id="379f4-117">If a call to **MsiViewModify** with one of the validation enums returns an error, you can make repeated calls to [**MsiViewGetError**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) for diagnosing the problem.</span></span> <span data-ttu-id="379f4-118">**Msiviewgeterror** gibt die Spalte an, in der der Fehler aufgetreten ist, sowie den Enumerationswert, um das Problem zu beheben.</span><span class="sxs-lookup"><span data-stu-id="379f4-118">**MsiViewGetError** indicates the column where the error occurred as well as the enum value to help fix the problem.</span></span> <span data-ttu-id="379f4-119">Weitere Informationen finden Sie unter [**GetError-Methode**](view-geterror.md).</span><span class="sxs-lookup"><span data-stu-id="379f4-119">For more information, see [**GetError method**](view-geterror.md).</span></span>

<span data-ttu-id="379f4-120">Sie können auch die interne Validierung verwenden, um sicherzustellen, dass andere Autoren Daten ordnungsgemäß in die benutzerdefinierte Tabelle eingeben.</span><span class="sxs-lookup"><span data-stu-id="379f4-120">You can also use internal validation to ensure that other authors enter data correctly into your custom table.</span></span> <span data-ttu-id="379f4-121">Fügen Sie jede der Spalten Ihrer benutzerdefinierten Tabelle \_ mithilfe des benutzerdefinierten Tabellennamens und des Spaltennamens als Primärschlüssel zur Validierungs Tabelle hinzu.</span><span class="sxs-lookup"><span data-stu-id="379f4-121">Add each of the columns of your custom table to the \_Validation table using the custom table name and column name as the primary key.</span></span> <span data-ttu-id="379f4-122">Geben Sie eine Beschreibung oder einen Zweck für jede Spalte in der Beschreibungs Spalte der Überprüfungs \_ Tabelle an.</span><span class="sxs-lookup"><span data-stu-id="379f4-122">Provide a description or purpose of each column in the Description column of the \_Validation table.</span></span> <span data-ttu-id="379f4-123">Geben Sie die anwendbaren Anforderungen für jede Spalte mithilfe der Spalten Nullable, MinValue, MaxValue, keytable, KeyColumn, Category und Set ein:</span><span class="sxs-lookup"><span data-stu-id="379f4-123">Enter the applicable requirements for each column using the Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Category, and Set columns:</span></span>

-   <span data-ttu-id="379f4-124">Wenn die Spalte NULL-Werte zulässt, geben Sie "Y" ein.</span><span class="sxs-lookup"><span data-stu-id="379f4-124">If the column is Nullable, enter a 'Y'.</span></span> <span data-ttu-id="379f4-125">Wenn dies nicht der gibt, geben Sie "N" ein.</span><span class="sxs-lookup"><span data-stu-id="379f4-125">If not, enter a 'N'.</span></span>
-   <span data-ttu-id="379f4-126">Wenn es sich bei der Spalte um eine ganzzahlige Spalte handelt, die einen Bereich von ganzen Zahlen enthalten kann, geben Sie diesen Bereich mithilfe der Spalten MinValue und MaxValue ein.</span><span class="sxs-lookup"><span data-stu-id="379f4-126">If the column is an integer column and can contain a range of integers, enter that range using the MinValue and MaxValue columns.</span></span>
-   <span data-ttu-id="379f4-127">Fremdschlüssel Spalten werden mithilfe der keytable-Spalte und der KeyColumn-Spalte identifiziert.</span><span class="sxs-lookup"><span data-stu-id="379f4-127">Foreign key columns are identified using the KeyTable and KeyColumn columns.</span></span>
-   <span data-ttu-id="379f4-128">Geben Sie für Zeichen folgen Spalten eine Kategorie an, z. b. Dateiname, GUID oder Bezeichner.</span><span class="sxs-lookup"><span data-stu-id="379f4-128">For string columns, specify a Category such as Filename, GUID, or Identifier.</span></span> <span data-ttu-id="379f4-129">Weitere Informationen finden Sie unter [Spaltendatentypen](column-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="379f4-129">For more information, see [column data types](column-data-types.md).</span></span>
-   <span data-ttu-id="379f4-130">Wenn sich die Daten nur auf eine bestimmte Anzahl von Werten (Zeichenfolge oder ganze Zahl) beziehen können, verwenden Sie die Set-Spalte, um die zulässigen Werte aufzulisten.</span><span class="sxs-lookup"><span data-stu-id="379f4-130">If the data can only pertain to a specific number of values (string or integer), use the Set column to list the acceptable values.</span></span>

<span data-ttu-id="379f4-131">Im folgenden finden Sie eine Liste der Spalten (zusätzlich zu Tabelle, Spalte und Beschreibung) in der \_ Validierungs Tabelle, die ausgefüllt werden kann, wenn die Spalte den angegebenen Typ hat.</span><span class="sxs-lookup"><span data-stu-id="379f4-131">The following is a list of the columns (in addition to Table, Column, and Description) in the \_Validation table that can be filled in if your column is of the specified type.</span></span> <span data-ttu-id="379f4-132">(Beachten Sie, dass Sie nicht alle Spalten ausfüllen müssen.)</span><span class="sxs-lookup"><span data-stu-id="379f4-132">(Note that you do not have to fill in all the columns.)</span></span>



| <span data-ttu-id="379f4-133">type</span><span class="sxs-lookup"><span data-stu-id="379f4-133">Type</span></span>    | <span data-ttu-id="379f4-134">Spalten</span><span class="sxs-lookup"><span data-stu-id="379f4-134">Columns</span></span>                                                          |
|---------|------------------------------------------------------------------|
| <span data-ttu-id="379f4-135">Integer</span><span class="sxs-lookup"><span data-stu-id="379f4-135">Integer</span></span> | <span data-ttu-id="379f4-136">Nullable, MinValue, MaxValue, keytable, KeyColumn, Set</span><span class="sxs-lookup"><span data-stu-id="379f4-136">Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Set</span></span>           |
| <span data-ttu-id="379f4-137">String</span><span class="sxs-lookup"><span data-stu-id="379f4-137">String</span></span>  | <span data-ttu-id="379f4-138">Nullable, keytable, KeyColumn, Category, Set, MinValue, MaxValue</span><span class="sxs-lookup"><span data-stu-id="379f4-138">Nullable, KeyTable, KeyColumn, Category, Set, MinValue, MaxValue</span></span> |
| <span data-ttu-id="379f4-139">Binary</span><span class="sxs-lookup"><span data-stu-id="379f4-139">Binary</span></span>  | <span data-ttu-id="379f4-140">Nullable, Category (Kategorie muss "Binary" lauten)</span><span class="sxs-lookup"><span data-stu-id="379f4-140">Nullable, Category (Category must be "Binary")</span></span>                   |



 

<span data-ttu-id="379f4-141">Erstellungs Umgebungen verwenden möglicherweise die msimodify- \_ \_ Delete-Löschung.</span><span class="sxs-lookup"><span data-stu-id="379f4-141">Authoring environments may make use of MSIMODIFY\_VALIDATE\_DELETE.</span></span> <span data-ttu-id="379f4-142">Diese Aufzählung geht davon aus, dass Sie die Zeile löschen möchten.</span><span class="sxs-lookup"><span data-stu-id="379f4-142">This enum assumes that you want to delete the row.</span></span> <span data-ttu-id="379f4-143">Es wird keine Feld-oder Fremdschlüssel Validierung ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="379f4-143">No field or foreign key validation is performed.</span></span> <span data-ttu-id="379f4-144">Diese Enumeration führt tatsächlich eine rückgängig-Fremdschlüssel Überprüfung durch.</span><span class="sxs-lookup"><span data-stu-id="379f4-144">This enum actually performs a reverse foreign key validation.</span></span> <span data-ttu-id="379f4-145">Er überprüft die \_ Validierungs Tabelle auf Verweise in den keytable-und KeyColumn-Spalten für die Tabelle, zu der die gelöschte Zeile gehört.</span><span class="sxs-lookup"><span data-stu-id="379f4-145">It checks the \_Validation table for references in the KeyTable and KeyColumn columns for the table to which the "deleted" row belongs.</span></span> <span data-ttu-id="379f4-146">Wenn Spalten vorhanden sind, in denen die Tabelle, die die Zeile "gelöscht" enthält, als potenzieller Fremdschlüssel aufgeführt ist, wird diese Spalte durchlaufen, um festzustellen, ob einer der Werte auf Werte in der Zeile "gelöscht" verweist.</span><span class="sxs-lookup"><span data-stu-id="379f4-146">If there are columns that list the table containing the "deleted" row as a potential foreign key, it cycles through that column to see if any of the values reference values in the "deleted" row.</span></span> <span data-ttu-id="379f4-147">Eine Fehlerrückgabe bedeutet, dass Sie die relationale Integrität der Datenbank durch Löschen der Zeile unterbrechen.</span><span class="sxs-lookup"><span data-stu-id="379f4-147">An error return means that you break the relational integrity of the database by deleting the row.</span></span>

 

 



