---
description: Die folgenden Auswirkungen können sich auf Windows Installer Installationen bei Verwendung eines Terminal Servers auswirken. Setup Entwickler sollten immer testen, ob das Windows Installer Paket wie erwartet installiert wird, wenn Benutzer auch einen Terminal Server verwenden.
ms.assetid: deda9efa-a0fc-4b4e-a531-650ac201fd84
title: Verwenden von Windows Installer mit einem Terminal Server
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d471fa19b4588a01a2730af44fa5e9d978d18859
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104484659"
---
# <a name="using-windows-installer-with-a-terminal-server"></a><span data-ttu-id="53cdb-104">Verwenden von Windows Installer mit einem Terminal Server</span><span class="sxs-lookup"><span data-stu-id="53cdb-104">Using Windows Installer with a Terminal Server</span></span>

<span data-ttu-id="53cdb-105">Die folgenden Auswirkungen können sich auf Windows Installer Installationen bei Verwendung eines Terminal Servers auswirken.</span><span class="sxs-lookup"><span data-stu-id="53cdb-105">The following may affect Windows Installer installations when using a terminal server.</span></span> <span data-ttu-id="53cdb-106">Setup Entwickler sollten immer testen, ob das Windows Installer Paket wie erwartet installiert wird, wenn Benutzer auch einen Terminal Server verwenden.</span><span class="sxs-lookup"><span data-stu-id="53cdb-106">Setup developers should always test that their Windows Installer package installs as expected when users are also using a terminal server.</span></span>

-   <span data-ttu-id="53cdb-107">Unter älteren Betriebssystemen als Windows Server 2008 und Windows Vista muss die System Richtlinie [enableadminungremote](enableadmintsremote.md) festgelegt werden, damit Administratoren in der Client Sitzung Installationen ausführen können.</span><span class="sxs-lookup"><span data-stu-id="53cdb-107">On operating systems earlier than Windows Server 2008 and Windows Vista, the [EnableAdminTSRemote](enableadmintsremote.md) system policy must be set to enable administrators to perform installations in the client session.</span></span> <span data-ttu-id="53cdb-108">Ab Windows Server 2008 und Windows Vista hat die enableadminungsremote-Richtlinie keine Auswirkungen mehr.</span><span class="sxs-lookup"><span data-stu-id="53cdb-108">Beginning with Windows Server 2008 and Windows Vista, the EnableAdminTSRemote policy no longer has any effect.</span></span> <span data-ttu-id="53cdb-109">Unabhängig von der Einstellung können Administratoren und nicht-Administratoren eine Installation in der Client Sitzung oder in der Konsolen Sitzung ausführen.</span><span class="sxs-lookup"><span data-stu-id="53cdb-109">Regardless of its setting, administrators and non-administrators can perform an installation in the client session or the console session.</span></span> <span data-ttu-id="53cdb-110">Administratoren und nicht-Administratoren können in der Konsolen Sitzung immer Windows Installer Installationen ausführen.</span><span class="sxs-lookup"><span data-stu-id="53cdb-110">Administrators and non-administrators can always perform Windows Installer installations in the console session.</span></span>
-   <span data-ttu-id="53cdb-111">Der-Windows Installer verhindert die Installation im [Installations Kontext](installation-context.md) pro Benutzer, wenn die[System Richtlinie](system-policy.md) " [disableuserinstallationen](disableuserinstalls.md)" auf 1 festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="53cdb-111">The Windows Installer prevents installation in the per-user [installation context](installation-context.md) if the [DisableUserInstalls](disableuserinstalls.md)[system policy](system-policy.md) is set to 1.</span></span> <span data-ttu-id="53cdb-112">In diesem Fall ignoriert das Installationsprogramm alle Anwendungen, die als pro Benutzer registriert sind, und sucht nur nach Anwendungen, die als Computer bezogen registriert sind.</span><span class="sxs-lookup"><span data-stu-id="53cdb-112">In this case, the installer ignores all applications registered as per-user and searches only for applications registered as per-machine.</span></span>
-   <span data-ttu-id="53cdb-113">Wenn ein Administrator eine Installation in einer Client Sitzung eines in Windows 2000 gehosteten Terminal Servers durchführt, muss bei der Installation ein UNC-Pfad und kein zugeordneter Laufwerk Buchstabe verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="53cdb-113">When an administrator performs an installation in a client session of a terminal server that is hosted in Windows 2000, the installation must use a UNC path and not a mapped drive letter.</span></span>

<span data-ttu-id="53cdb-114">Entwickler sollten die folgenden Richtlinien befolgen, wenn Sie eine Windows Installer Komponente entwickeln, die mit einem Terminal Server verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="53cdb-114">Developers should adhere to the following guidelines when developing a Windows Installer component that may be used with a terminal server.</span></span>

-   <span data-ttu-id="53cdb-115">Schreiben Sie alle **HKCU** -Registrierungsinformationen in den **HKCU**- \\ **Software** Teil der Registrierung.</span><span class="sxs-lookup"><span data-stu-id="53cdb-115">Write all **HKCU** registry information in the **HKCU**\\**Software** part of the registry.</span></span>
-   <span data-ttu-id="53cdb-116">Das Speichern von Konfigurationsinformationen in INI-Dateien wird nicht empfohlen.</span><span class="sxs-lookup"><span data-stu-id="53cdb-116">Storing configuration information in INI files is not recommended.</span></span>
-   <span data-ttu-id="53cdb-117">Schreiben Sie benutzerspezifische Informationen in die Registrierung, wenn die Anwendung zum ersten Mal ausgeführt wird, und nicht zur Installationszeit.</span><span class="sxs-lookup"><span data-stu-id="53cdb-117">Write per-user information to the registry when the application is run for the first time and not at installation time.</span></span> <span data-ttu-id="53cdb-118">Wenn Sie benutzerspezifische Informationen zur Installationszeit in die Registrierung schreiben müssen, müssen Sie die Benutzer-und computerspezifischen Informationen in verschiedene Windows Installer Komponenten aufteilen.</span><span class="sxs-lookup"><span data-stu-id="53cdb-118">If you must write per-user information to the registry at installation time, separate the per-user and per-machine information into different Windows Installer components.</span></span> <span data-ttu-id="53cdb-119">Erstellen Sie das Paket so, dass das Installationsprogramm bei der Installation der Anwendung nicht versucht, die Komponenten zu überprüfen und zu reparieren, die benutzerspezifische Informationen enthalten.</span><span class="sxs-lookup"><span data-stu-id="53cdb-119">Author the package such that the installer does not attempt to validate and repair the components containing per-user information when the application is installed.</span></span>
-   <span data-ttu-id="53cdb-120">Ein Paket, das nur für Installationen pro Computer verwendet wird, sollte Umgebungsvariablen in die Computerumgebung schreiben, indem es \* in die Spalte Name der [Umgebungs Tabelle](environment-table.md)eingeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="53cdb-120">A package used for only per-machine installations should write environment variables to the computer's environment by including \* in the Name column of the [Environment Table](environment-table.md).</span></span> <span data-ttu-id="53cdb-121">Wenn das Paket für Installationen pro Benutzer oder pro Computer verwendet werden kann, verwenden Sie zwei Komponenten.</span><span class="sxs-lookup"><span data-stu-id="53cdb-121">If the package can be used for per-user installations or per-machine installations, use two components.</span></span> <span data-ttu-id="53cdb-122">Fügen Sie die Komponente "pro Benutzer" in die [Komponenten Tabelle](condition-table.md) ein, und geben Sie die Benutzereinstellungen in der Umgebungs Tabelle ein.</span><span class="sxs-lookup"><span data-stu-id="53cdb-122">Include the per-user component in the [Component Table](condition-table.md) and enter the user settings in the Environment Table.</span></span> <span data-ttu-id="53cdb-123">Fügen Sie die Komponente pro Computer in die Komponenten Tabelle ein, und geben Sie die Computereinstellungen in der Umgebungs Tabelle ein.</span><span class="sxs-lookup"><span data-stu-id="53cdb-123">Include the per-machine component in the Component Table and enter the computer settings in the Environment Table.</span></span> <span data-ttu-id="53cdb-124">Steuern, welche Komponente installiert wird, indem Sie bedingte Anweisungen verwenden, die auf der [**ALLUSERS**](allusers.md) -Eigenschaft im Bedingungs Feld der Komponenten Tabelle basieren.</span><span class="sxs-lookup"><span data-stu-id="53cdb-124">Control which component gets installed by using conditional statements based upon the [**ALLUSERS**](allusers.md) property in the Condition field of the Component Table.</span></span>
-   <span data-ttu-id="53cdb-125">Bei der Durchführung von computerspezifischen Installationen von einem Terminal Server schreibt der Installer Umgebungsvariablen pro Benutzer in **HKCU** \\ **. Standard** \\ **Umgebung**.</span><span class="sxs-lookup"><span data-stu-id="53cdb-125">When performing per-machine installations from a terminal server, the installer writes per-user environment variables to **HKCU**\\ **.Default**\\**Environment**.</span></span> <span data-ttu-id="53cdb-126">Da der Terminal Server diesen Abschnitt der Registrierung nicht repliziert, werden bei der Installation die Umgebungsvariablen pro Benutzer nicht festgelegt.</span><span class="sxs-lookup"><span data-stu-id="53cdb-126">Because the terminal server does not replicate this section of the registry, the installation does not set the per-user environment variables.</span></span>
-   <span data-ttu-id="53cdb-127">Da ein Server konfiguriert werden kann, um zu verhindern, dass Benutzer Anwendungen reparieren, sollte Ihre Anwendung die Groß-/Kleinschreibung fehlender Registrierungsschlüssel behandeln.</span><span class="sxs-lookup"><span data-stu-id="53cdb-127">Because a server may be configured to prevent users from repairing applications, your application should handle the case of missing registry keys gracefully.</span></span>

<span data-ttu-id="53cdb-128">Folgendes gilt, wenn ein Windows Installer Paket, das dll-, exe-oder Skript- [benutzerdefinierte Aktionen](custom-actions.md) verwendet, im Installations Kontext pro Computer auf einem Terminal Server installiert wird.</span><span class="sxs-lookup"><span data-stu-id="53cdb-128">The following applies when a Windows Installer package that uses DLL, EXE, or Script [custom actions](custom-actions.md) is installed in the per-machine installation context on a terminal server.</span></span> <span data-ttu-id="53cdb-129">In diesem Fall legt der Installer die [**Terminalserver**](terminalserver.md) -Eigenschaft fest.</span><span class="sxs-lookup"><span data-stu-id="53cdb-129">In this case, the installer sets the [**TerminalServer**](terminalserver.md) property.</span></span>

-   <span data-ttu-id="53cdb-130">Verzögerte benutzerdefinierte Aktionen werden im Kontext des lokalen Systems ausgeführt, es sei denn, die Aktion verfügt über das **msidbcustomaction typetsaware** -Attribut.</span><span class="sxs-lookup"><span data-stu-id="53cdb-130">Deferred custom actions run in the context of the local system unless the action has the **msidbCustomActionTypeTSAware** attribute.</span></span> <span data-ttu-id="53cdb-131">Dies gilt auch, wenn die benutzerdefinierte Aktion die Identität des Benutzers auf einem System annimmt, das kein Terminal Server ist.</span><span class="sxs-lookup"><span data-stu-id="53cdb-131">This is true even if the custom action impersonates the user on a system that is not a terminal server.</span></span> <span data-ttu-id="53cdb-132">Beachten Sie, dass das Installationsprogramm nicht automatisch sicherstellt, dass diese Änderungen auch in der Registrierung jedes Benutzers auf dem Computer vorgenommen werden, wenn eine benutzerdefinierte Aktion, die über das **msidbcustomaction typetsaware** -Attribut verfügt, die Registrierung des Benutzers ändert.</span><span class="sxs-lookup"><span data-stu-id="53cdb-132">Note that if a custom action having the **msidbCustomActionTypeTSAware** attribute changes the user's registry, the installer does not automatically ensure that those changes are also made in the registry of every user on the computer.</span></span>
-   <span data-ttu-id="53cdb-133">Bei allen Registrierungs Vorgängen in einer verzögerten benutzerdefinierten Aktion, die aus der **HKCU** -Registrierungs Struktur gelesen wird, wird die Standard Registrierungs Struktur des Systems und nicht die Registrierungs Struktur des aktuellen Benutzers angezeigt.</span><span class="sxs-lookup"><span data-stu-id="53cdb-133">Any registry operations in a deferred custom action that read from the **HKCU** registry hive sees the system's default registry hive and not the current user's registry hive.</span></span>
-   <span data-ttu-id="53cdb-134">Alle Registrierungs Vorgänge in einer verzögerten benutzerdefinierten Aktion, die in **HKCU** \\ -**Software** schreiben, werden vom Installationsprogramm erkannt und bei der nächsten Anmeldung des Benutzers auf jeden Benutzer des Computers kopiert.</span><span class="sxs-lookup"><span data-stu-id="53cdb-134">Any registry operations in a deferred custom action that write to **HKCU**\\**Software** are detected by the installer and copied to every user of the computer at the next logon of the user.</span></span>
-   <span data-ttu-id="53cdb-135">Alle Registrierungs Vorgänge in einer verzögerten benutzerdefinierten Aktion, die in **HKCU** schreiben, jedoch nicht unter dem Registrierungsschlüssel für die **HKCU**- \\ **Software** vorhanden sind, werden vom Installationsprogramm nicht erkannt oder kopiert.</span><span class="sxs-lookup"><span data-stu-id="53cdb-135">Any registry operations in a deferred custom action that write to **HKCU**, but are not under the **HKCU**\\**Software** registry key, are not detected by the installer or copied.</span></span>

<span data-ttu-id="53cdb-136">Weitere Informationen finden Sie unter [Terminal Dienste](../termserv/terminal-services-portal.md) im Microsoft Windows Software Development Kit (SDK).</span><span class="sxs-lookup"><span data-stu-id="53cdb-136">For more information, see [Terminal Services](../termserv/terminal-services-portal.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>

## <a name="related-topics"></a><span data-ttu-id="53cdb-137">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="53cdb-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="53cdb-138">Enableadminout-Remote</span><span class="sxs-lookup"><span data-stu-id="53cdb-138">EnableAdminTSRemote</span></span>](enableadmintsremote.md)
</dt> <dt>

[<span data-ttu-id="53cdb-139">**Terminalserver (Eigenschaft)**</span><span class="sxs-lookup"><span data-stu-id="53cdb-139">**TerminalServer property**</span></span>](terminalserver.md)
</dt> <dt>

[<span data-ttu-id="53cdb-140">**Remoteadmints (Eigenschaft)**</span><span class="sxs-lookup"><span data-stu-id="53cdb-140">**RemoteAdminTS property**</span></span>](remoteadmints.md)
</dt> <dt>

[<span data-ttu-id="53cdb-141">Terminaldienste</span><span class="sxs-lookup"><span data-stu-id="53cdb-141">Terminal Services</span></span>](../termserv/terminal-services-portal.md)
</dt> </dl>

 

 
