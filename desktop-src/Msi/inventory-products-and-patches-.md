---
description: 'Benutzer und Anwendungen mit Administratorrechten können Windows Installer-Funktionen verwenden, um die Windows Installer Anwendungen, Features, Komponenten und Patches, die auf dem System installiert sind, zu inventarisieren. Ab Windows Installer&\# 160; 3.0 können Benutzer und Anwendungen, die über Administratorrechte verfügen, die Windows Installer Anwendungen, Features, Komponenten und Patches auflisten, die von allen Benutzern auf dem System installiert werden. Administratoren und Anwendungen können Informationen zu einem Produkt oder Patch für einen bestimmten Benutzer oder für alle Benutzer im System abrufen. Anwendungen können den Funktionsstatus oder den Komponenten Zustand für einen bestimmten Benutzer abrufen. Die Inventur Funktionen, die ab Windows Installer&\# 160; 3.0 verfügbar sind, können den Umfang der gefundenen Elemente durch den Installations Kontext und den Benutzer Kontext einschränken. Es gibt drei mögliche Installations Kontexte: pro Benutzer, pro Computer und pro Benutzer verwaltet. Der Benutzer Kontext kann ein bestimmter Benutzer oder alle Benutzer des Systems sein. Die Versionen der Windows Installer Inventur Funktionen vor Windows Installer&\# 160; 3.0 können nur auf dem System installierte Elemente im Computer Kontext oder im kontextbezogenen Kontext des aktuellen Benutzers auflisten. Diese Einschränkung verhindert eine vollständige Inventur aller Windows Installer Produkte und Patches, die von anderen Benutzern als dem aktuellen Benutzer im System installiert werden. Auflisten von productsenumerating patchesbeschaffung Produktinformationen abrufen von Patchinformationen Abrufen von Informationen über den Status der Komponente'
ms.assetid: ef95c3c8-b4c8-4305-8aa2-07ec74b3121b
title: Verwenden von Windows Installer zum Inventarisieren von Produkten und Patches
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7915a8a58954c2e07a3dae9536ed7bae399e416b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104525163"
---
# <a name="using-windows-installer-to-inventory-products-and-patches"></a><span data-ttu-id="a2f78-109">Verwenden von Windows Installer zum Inventarisieren von Produkten und Patches</span><span class="sxs-lookup"><span data-stu-id="a2f78-109">Using Windows Installer to Inventory Products and Patches</span></span>

<span data-ttu-id="a2f78-110">Benutzer und Anwendungen mit Administratorrechten können Windows Installer-Funktionen verwenden, um die Windows Installer Anwendungen, Features, Komponenten und Patches, die auf dem System installiert sind, zu inventarisieren.</span><span class="sxs-lookup"><span data-stu-id="a2f78-110">Users and applications with administrative privileges can use Windows Installer functions to inventory the Windows Installer applications, features, components and patches installed on the system.</span></span>

<span data-ttu-id="a2f78-111">Ab Windows Installer 3,0 können Benutzer und Anwendungen, die über Administratorrechte verfügen, die Windows Installer Anwendungen, Features, Komponenten und Patches auflisten, die von allen Benutzern auf dem System installiert werden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-111">Beginning with Windows Installer 3.0, users and applications that have administrator privileges can enumerate the Windows Installer applications, features, components and patches installed on the system by all users.</span></span> <span data-ttu-id="a2f78-112">Administratoren und Anwendungen können Informationen zu einem Produkt oder Patch für einen bestimmten Benutzer oder für alle Benutzer im System abrufen.</span><span class="sxs-lookup"><span data-stu-id="a2f78-112">Administrators and applications can obtain information on a product or patch for a particular user or all users in the system.</span></span> <span data-ttu-id="a2f78-113">Anwendungen können den Funktionsstatus oder den Komponenten Zustand für einen bestimmten Benutzer abrufen.</span><span class="sxs-lookup"><span data-stu-id="a2f78-113">Applications can obtain the feature state or component state for a particular user.</span></span>

<span data-ttu-id="a2f78-114">Die Inventur Funktionen, die ab Windows Installer 3,0 verfügbar sind, können den Bereich der gefundenen Elemente durch den Installations Kontext und den Benutzer Kontext einschränken.</span><span class="sxs-lookup"><span data-stu-id="a2f78-114">The inventory functions available beginning with Windows Installer 3.0 can limit the scope of items to be found by installation context and user context.</span></span> <span data-ttu-id="a2f78-115">Es gibt drei mögliche Installations Kontexte: pro Benutzer, pro Computer und pro Benutzer verwaltet.</span><span class="sxs-lookup"><span data-stu-id="a2f78-115">There are three possible installation contexts: per-user, per-machine, and per-user managed.</span></span> <span data-ttu-id="a2f78-116">Der Benutzer Kontext kann ein bestimmter Benutzer oder alle Benutzer des Systems sein.</span><span class="sxs-lookup"><span data-stu-id="a2f78-116">The user context can be a particular user or all users in the system.</span></span>

<span data-ttu-id="a2f78-117">Die Versionen der Windows Installer Inventur Funktionen vor Windows Installer 3,0 können nur Elemente auflisten, die auf dem System im Computer Kontext oder im benutzerspezifischen Kontext des aktuellen Benutzers installiert sind.</span><span class="sxs-lookup"><span data-stu-id="a2f78-117">The versions of the Windows Installer inventory functions earlier than Windows Installer 3.0 can only enumerate items installed on the system in the machine context or in the per-user context of the current user.</span></span> <span data-ttu-id="a2f78-118">Diese Einschränkung verhindert eine vollständige Inventur aller Windows Installer Produkte und Patches, die von anderen Benutzern als dem aktuellen Benutzer im System installiert werden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-118">This limitation prevents a complete inventory of all Windows Installer products and patches installed in the system by users other than the current user.</span></span>

-   [<span data-ttu-id="a2f78-119">Auflisten von Produkten</span><span class="sxs-lookup"><span data-stu-id="a2f78-119">Enumerating Products</span></span>](#enumerating-products)
-   [<span data-ttu-id="a2f78-120">Auflisten von Patches</span><span class="sxs-lookup"><span data-stu-id="a2f78-120">Enumerating Patches</span></span>](#enumerating-patches)
-   [<span data-ttu-id="a2f78-121">Abrufen von Produktinformationen</span><span class="sxs-lookup"><span data-stu-id="a2f78-121">Obtaining Product Information</span></span>](#obtaining-product-information)
-   [<span data-ttu-id="a2f78-122">Abrufen von Patchinformationen</span><span class="sxs-lookup"><span data-stu-id="a2f78-122">Obtaining Patch Information</span></span>](#obtaining-patch-information)
-   [<span data-ttu-id="a2f78-123">Abrufen von Komponenten Zustandsinformationen</span><span class="sxs-lookup"><span data-stu-id="a2f78-123">Obtaining Component State Information</span></span>](#obtaining-component-state-information)
-   [<span data-ttu-id="a2f78-124">Abrufen von Informationen zum Funktionsstatus</span><span class="sxs-lookup"><span data-stu-id="a2f78-124">Obtaining Feature State Information</span></span>](#obtaining-feature-state-information)

## <a name="enumerating-products"></a><span data-ttu-id="a2f78-125">Auflisten von Produkten</span><span class="sxs-lookup"><span data-stu-id="a2f78-125">Enumerating Products</span></span>

<span data-ttu-id="a2f78-126">Verwenden Sie die Funktion " [**msienumproductsex**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) ", um Windows Installer Anwendungen aufzuzählen, die im System installiert sind.</span><span class="sxs-lookup"><span data-stu-id="a2f78-126">Use the [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) function to enumerate Windows Installer applications that are installed in the system.</span></span> <span data-ttu-id="a2f78-127">Diese Funktion kann alle Installationen pro Computer und benutzerspezifische Installationen von Anwendungen (verwaltet und nicht verwaltet) für den aktuellen Benutzer und andere Benutzer im System finden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-127">This function can find all the per-machine installations and per-user installations of applications (managed and unmanaged) for the current user and other users in the system.</span></span> <span data-ttu-id="a2f78-128">Verwenden Sie den *dwcontext* -Parameter, um den zu gefundenen Installations Kontext anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-128">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="a2f78-129">Sie können eine beliebige Kombination der möglichen Installations Kontexte angeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-129">You can specify any one or any combination of the possible installation contexts.</span></span> <span data-ttu-id="a2f78-130">Verwenden Sie den *szusersid* -Parameter, um den Benutzer Kontext der gefundenen Anwendungen anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-130">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

## <a name="enumerating-patches"></a><span data-ttu-id="a2f78-131">Auflisten von Patches</span><span class="sxs-lookup"><span data-stu-id="a2f78-131">Enumerating Patches</span></span>

<span data-ttu-id="a2f78-132">Verwenden Sie die Funktion " [**msienenpatchesex**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) ", um auf eine Anwendung angewendete Patches zu suchen.</span><span class="sxs-lookup"><span data-stu-id="a2f78-132">Use the [**MsiEnumPatchesEx**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) function to find patches applied for an application.</span></span> <span data-ttu-id="a2f78-133">Mit dieser Funktion können Patches gefunden werden, die für eine bestimmte Anwendung oder für alle Anwendungen im System angewendet wurden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-133">This function can find patches applied for a particular application or for all applications in the system.</span></span> <span data-ttu-id="a2f78-134">Mit dieser Funktion können Sie Patches finden, die für den aktuellen Benutzer und andere Benutzer im System auf alle computerspezifischen Installationen und Anwendungen pro Benutzer angewendet werden (verwaltet und nicht verwaltet).</span><span class="sxs-lookup"><span data-stu-id="a2f78-134">This function can find patches applied to all the per-machine installations and per-user installations of applications (managed and unmanaged) for the current user and other users in the system.</span></span>

<span data-ttu-id="a2f78-135">Sie können den Installations Kontext und den Benutzer Kontext verwenden, um die patchenumeration auf einen bestimmten Kontext oder auf alle Kontexte zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="a2f78-135">You can use the installation context and user context to restrict the patch enumeration to a particular context or across all contexts.</span></span> <span data-ttu-id="a2f78-136">Verwenden Sie den *dwcontext* -Parameter, um den zu gefundenen Installations Kontext anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-136">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="a2f78-137">Sie können eine beliebige Kombination der möglichen Installations Kontexte angeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-137">You can specify any one or any combination of the possible installation contexts.</span></span> <span data-ttu-id="a2f78-138">Verwenden Sie den *szusersid* -Parameter, um den Benutzer Kontext der gefundenen Anwendungen anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-138">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

<span data-ttu-id="a2f78-139">**So zählen Sie Patches auf, die für alle von allen Benutzern im System angekündigten oder installierten Produkte angewendet wurden**</span><span class="sxs-lookup"><span data-stu-id="a2f78-139">**To enumerate patches applied for all products advertised or installed by all users in the system**</span></span>

-   <span data-ttu-id="a2f78-140">Aufrufen der Funktion " [**msienenpatchesex**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) ".</span><span class="sxs-lookup"><span data-stu-id="a2f78-140">Call the [**MsiEnumPatchesEx**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) function.</span></span>
    -   <span data-ttu-id="a2f78-141">Verwenden Sie für den Wert des *szproductcode* -Parameters **null** .</span><span class="sxs-lookup"><span data-stu-id="a2f78-141">Use **NULL** for the value of the *szProductCode* parameter.</span></span>
    -   <span data-ttu-id="a2f78-142">Verwenden Sie "s-1-1-0" als Wert des Parameters " *szusersid* ".</span><span class="sxs-lookup"><span data-stu-id="a2f78-142">Use "s-1-1-0" for the value of the *szUserSid* parameter.</span></span>
    -   <span data-ttu-id="a2f78-143">Verwenden Sie "msiinstallcontext \_ all" für den Wert des *dwcontext* -Parameters.</span><span class="sxs-lookup"><span data-stu-id="a2f78-143">Use "MSIINSTALLCONTEXT\_ALL" for the value of the *dwContext* parameter.</span></span>

<span data-ttu-id="a2f78-144">**So zählen Sie Patches auf, die für alle von allen Benutzern im System angekündigten oder installierten Produkte angewendet wurden**</span><span class="sxs-lookup"><span data-stu-id="a2f78-144">**To enumerate patches applied for all products advertised or installed by all users in the system**</span></span>

1.  <span data-ttu-id="a2f78-145">Ruft die [**msienenproductsex**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) -Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="a2f78-145">Call the [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) function.</span></span>

    -   <span data-ttu-id="a2f78-146">Verwenden Sie für den Wert des *szproductcode* -Parameters **null** .</span><span class="sxs-lookup"><span data-stu-id="a2f78-146">Use **NULL** for the value of the *szProductCode* parameter.</span></span>
    -   <span data-ttu-id="a2f78-147">Verwenden Sie "s-1-1-0" als Wert des Parameters " *szusersid* ".</span><span class="sxs-lookup"><span data-stu-id="a2f78-147">Use "s-1-1-0" for the value of the *szUserSid* parameter.</span></span>
    -   <span data-ttu-id="a2f78-148">Verwenden Sie "msiinstallcontext \_ all" für den Wert des *dwcontext* -Parameters.</span><span class="sxs-lookup"><span data-stu-id="a2f78-148">Use "MSIINSTALLCONTEXT\_ALL" for the value of the *dwContext* parameter.</span></span>

    <span data-ttu-id="a2f78-149">Die-Funktion stellt einen Produktcode, einen Benutzer Kontext und einen Installations Kontext für jede gefundene Anwendung bereit.</span><span class="sxs-lookup"><span data-stu-id="a2f78-149">The function provides a product code, user context, and installation context for each application found.</span></span>

2.  <span data-ttu-id="a2f78-150">Für jede in Schritt 1 aufgeführte Anwendung müssen Sie [**msienumpatchesex**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) aufrufen, um die Patches aufzuzählen.</span><span class="sxs-lookup"><span data-stu-id="a2f78-150">For each application enumerated in step 1, call [**MsiEnumPatchesEx**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) to enumerate the patches.</span></span>

    <span data-ttu-id="a2f78-151">Verwenden Sie die Produktcodes, Benutzer Kontexte und Installations Kontexte, die von [**msienüberproductsex**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) abgerufen wurden, um die Werte von *szproductcode*, *szusersid* und *dwcontext* sowie jeden **msienenproductsex** -Funktions aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="a2f78-151">Use the product codes, user contexts and installation contexts obtained from [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) for the values of *szProductCode*, *szUserSid*, and *dwContext*, and each **MsiEnumProductsEx** function call.</span></span>

## <a name="obtaining-product-information"></a><span data-ttu-id="a2f78-152">Abrufen von Produktinformationen</span><span class="sxs-lookup"><span data-stu-id="a2f78-152">Obtaining Product Information</span></span>

<span data-ttu-id="a2f78-153">Verwenden Sie die Funktion [**msigetproductinfoex**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) zum Abrufen von Informationen zu Anwendungen, die im System angekündigt oder installiert werden, sowie zu den Eigenschaften, die abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="a2f78-153">Use the [**MsiGetProductInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) function to get information about applications that are advertised or installed on the system, and the properties that can be retrieved.</span></span> <span data-ttu-id="a2f78-154">Diese Funktion kann Informationen für eine Instanz einer Anwendung erhalten, die unter einem anderen Benutzerkonto als dem aktuellen Benutzer installiert ist, aber eine Instanz eines Produkts, die unter einem nicht verwalteten Benutzerkonto für ein anderes Benutzerkonto als den aktuellen Benutzer angekündigt wird, kann nicht abgefragt werden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-154">This function can get information for an instance of an application installed under a user account other than the current user, but cannot query an instance of a product that is advertised under a per-user unmanaged context for a user account other than the current user.</span></span>

<span data-ttu-id="a2f78-155">Sie können den Installations Kontext und den Benutzer Kontext angeben, um Informationen zu den in einem bestimmten Kontext installierten Anwendungen einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="a2f78-155">You can specify the installation context and user context to restrict information for applications installed in a particular context.</span></span> <span data-ttu-id="a2f78-156">Verwenden Sie den *dwcontext* -Parameter, um den zu gefundenen Installations Kontext anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-156">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="a2f78-157">Sie können nur einen der möglichen Installations Kontexte angeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-157">You can specify only one of the possible installation contexts.</span></span> <span data-ttu-id="a2f78-158">Verwenden Sie den *szusersid* -Parameter, um den Benutzer Kontext der gefundenen Anwendungen anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-158">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

## <a name="obtaining-patch-information"></a><span data-ttu-id="a2f78-159">Abrufen von Patchinformationen</span><span class="sxs-lookup"><span data-stu-id="a2f78-159">Obtaining Patch Information</span></span>

<span data-ttu-id="a2f78-160">Eine Anwendung kann die [**msigetpatchinfoex**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) -Funktion aufrufen, um Informationen über die Anwendung eines Patches an eine angegebene Instanz eines Produkts abzufragen.</span><span class="sxs-lookup"><span data-stu-id="a2f78-160">An application can call the [**MsiGetPatchInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) function to query for information about the application of a patch to a specified instance of a product.</span></span> <span data-ttu-id="a2f78-161">Eigenschaften wie **localpackage**, [**Transformationen**](transforms.md)und **State** können mithilfe dieser Funktion abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-161">Properties such as **LocalPackage**, [**Transforms**](transforms.md), and **State** can be retrieved using this function.</span></span> <span data-ttu-id="a2f78-162">Nicht alle Eigenschaftswerte sind garantiert für benutzerspezifische nicht verwaltete Anwendungen verfügbar, wenn der Benutzer derzeit nicht am Computer angemeldet ist.</span><span class="sxs-lookup"><span data-stu-id="a2f78-162">Not all property values are guaranteed to be available for per-user unmanaged applications if the user is not currently logged in to the machine.</span></span> <span data-ttu-id="a2f78-163">Sie können nur einen der möglichen Installations Kontexte angeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-163">You can specify only one of the possible installation contexts.</span></span>

<span data-ttu-id="a2f78-164">Sie können den Installations Kontext und den Benutzer Kontext angeben, um Informationen auf Patches zu beschränken, die auf Anwendungen angewendet werden, die in einem bestimmten Kontext installiert werden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-164">You can specify the installation context and user context to restrict information to patches applied to applications installed in a particular context.</span></span> <span data-ttu-id="a2f78-165">Verwenden Sie den *dwcontext* -Parameter, um den zu gefundenen Installations Kontext anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-165">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="a2f78-166">Sie können nur einen der möglichen Installations Kontexte angeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-166">You can specify only one of the possible installation contexts.</span></span> <span data-ttu-id="a2f78-167">Verwenden Sie den *szusersid* -Parameter, um den Benutzer Kontext der gefundenen Anwendungen anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-167">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

## <a name="obtaining-component-state-information"></a><span data-ttu-id="a2f78-168">Abrufen von Komponenten Zustandsinformationen</span><span class="sxs-lookup"><span data-stu-id="a2f78-168">Obtaining Component State Information</span></span>

<span data-ttu-id="a2f78-169">Anwendungen können die [**msiquerycomponentstate**](/windows/desktop/api/Msi/nf-msi-msiquerycomponentstatea) -Funktion zum Abrufen des installierten Zustands für eine Komponente abrufen.</span><span class="sxs-lookup"><span data-stu-id="a2f78-169">Applications can call the [**MsiQueryComponentState**](/windows/desktop/api/Msi/nf-msi-msiquerycomponentstatea) function to get the installed state for a component.</span></span> <span data-ttu-id="a2f78-170">Diese Funktion bestimmt, ob die Komponente lokal oder installiert ist, um von der Quelle ausgeführt zu werden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-170">This function determines if the component is installed locally or installed to run from the source.</span></span> <span data-ttu-id="a2f78-171">Die-Funktion kann eine Komponente einer Instanz einer Anwendung Abfragen, die unter Benutzerkonten mit Ausnahme des aktuellen Benutzers installiert ist, vorausgesetzt, dass das Produkt nicht im nicht verwalteten Kontext des Benutzers für ein anderes Benutzerkonto als den aktuellen Benutzer angekündigt wird.</span><span class="sxs-lookup"><span data-stu-id="a2f78-171">The function can query for a component of an instance of an application that is installed under user accounts other than the current user, provided that the product is not advertised under the per-user unmanaged context for a user account other than the current user.</span></span>

<span data-ttu-id="a2f78-172">Sie können einen Installations Kontext und einen Benutzer Kontext angeben, um den Status von Komponenten für Anwendungen zu erhalten, die in einem bestimmten Kontext installiert werden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-172">You can specify an installation context and user context to get the state of components for applications installed in a particular context.</span></span> <span data-ttu-id="a2f78-173">Verwenden Sie den *dwcontext* -Parameter, um den zu gefundenen Installations Kontext anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-173">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="a2f78-174">Sie können nur einen der möglichen Installations Kontexte angeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-174">You can specify only one of the possible installation contexts.</span></span> <span data-ttu-id="a2f78-175">Verwenden Sie den *szusersid* -Parameter, um den Benutzer Kontext der gefundenen Anwendungen anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-175">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

## <a name="obtaining-feature-state-information"></a><span data-ttu-id="a2f78-176">Abrufen von Informationen zum Funktionsstatus</span><span class="sxs-lookup"><span data-stu-id="a2f78-176">Obtaining Feature State Information</span></span>

<span data-ttu-id="a2f78-177">Anwendungen können die Funktion " [**msiqueryfeaturestateex**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa) " aufrufen, um den installierten Zustand für ein Produkt Feature zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a2f78-177">Applications can call the [**MsiQueryFeatureStateEx**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa) function to get the installed state for a product feature.</span></span> <span data-ttu-id="a2f78-178">Diese Funktion bestimmt, ob die Funktion angekündigt, lokal installiert oder installiert wird, um von der Quelle ausgeführt zu werden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-178">This function determines if the feature is advertised, installed locally, or installed to run from the source.</span></span> <span data-ttu-id="a2f78-179">Die-Funktion kann verwendet werden, um beliebige Funktionen einer Instanz einer Anwendung, die unter dem Computer Konto installiert ist, oder einen beliebigen Kontext unter dem aktuellen Benutzerkonto oder den pro Benutzer verwalteten Kontext unter jedem anderen Benutzerkonto als dem aktuellen Benutzer abzufragen.</span><span class="sxs-lookup"><span data-stu-id="a2f78-179">The function can be used to query any feature of an instance of an application installed under the machine account or any context under the current user account or the per-user managed context under any user account other than the current user.</span></span> <span data-ttu-id="a2f78-180">Diese Funktion kann nicht nach einer Anwendung Abfragen, die unter dem nicht verwalteten Benutzer Kontext für ein anderes Benutzerkonto als den aktuellen Benutzer installiert ist.</span><span class="sxs-lookup"><span data-stu-id="a2f78-180">This function cannot query for an application installed under the per-user unmanaged context for a user account other than the current user.</span></span> <span data-ttu-id="a2f78-181">Sie können nur einen der möglichen Installations Kontexte angeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-181">You can specify only one of the possible installation contexts.</span></span>

<span data-ttu-id="a2f78-182">Sie können einen Installations Kontext und einen Benutzer Kontext angeben, um den Status von Features für Anwendungen zu erhalten, die in einem bestimmten Kontext installiert werden.</span><span class="sxs-lookup"><span data-stu-id="a2f78-182">You can specify an installation context and user context to get the state of features for applications installed in a particular context.</span></span> <span data-ttu-id="a2f78-183">Verwenden Sie den *dwcontext* -Parameter, um den zu gefundenen Installations Kontext anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-183">Use the *dwContext* parameter to specify the installation context to be found.</span></span> <span data-ttu-id="a2f78-184">Sie können nur einen der möglichen Installations Kontexte angeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-184">You can specify only one of the possible installation contexts.</span></span> <span data-ttu-id="a2f78-185">Verwenden Sie den *szusersid* -Parameter, um den Benutzer Kontext der gefundenen Anwendungen anzugeben.</span><span class="sxs-lookup"><span data-stu-id="a2f78-185">Use the *szUserSid* parameter to specify the user context of applications to be found.</span></span>

 

 



