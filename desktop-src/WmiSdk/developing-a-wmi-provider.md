---
description: Ein-Anbieter ist ein COM-Objekt (Component Object Model), das als Vermittler zwischen WMI und einem verwalteten Objekt fungiert.
ms.assetid: a4f537ba-9081-43b4-acff-4d206de3d9d7
ms.tgt_platform: multiple
title: Entwickeln eines WMI-Anbieters
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9249c251f75f08f9e5142e70a507b0dced8f91df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106368240"
---
# <a name="developing-a-wmi-provider"></a><span data-ttu-id="52c10-103">Entwickeln eines WMI-Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-103">Developing a WMI Provider</span></span>

<span data-ttu-id="52c10-104">Ein-Anbieter ist ein COM-Objekt (Component Object Model), das als Vermittler zwischen WMI und einem verwalteten Objekt fungiert.</span><span class="sxs-lookup"><span data-stu-id="52c10-104">A provider is a Component Object Model (COM) object that acts as an intermediary between WMI and a managed object.</span></span> <span data-ttu-id="52c10-105">Wenn beispielsweise eine Anwendung oder ein Skript Datenträger Daten mithilfe der WMI [**Win32 \_ LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) -Klasse anfordert, werden die Daten dynamisch über den vorinstallierten [Win32-Anbieter](/windows/desktop/CIMWin32Prov/win32-provider)abgerufen.</span><span class="sxs-lookup"><span data-stu-id="52c10-105">For example, when an application or script requests disk data using the WMI [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class, the data is obtained dynamically through the preinstalled [Win32 provider](/windows/desktop/CIMWin32Prov/win32-provider).</span></span>

<span data-ttu-id="52c10-106">Wenn Sie Daten über WMI für andere Anwendungen bereitstellen möchten, können Sie einen nicht verwalteten Code Anbieter erstellen, indem Sie einen com-Server oder die **WMI-ATL-Assistenten** in Visual Studio schreiben.</span><span class="sxs-lookup"><span data-stu-id="52c10-106">If you want to supply data through WMI to other applications, you can create an unmanaged code provider by writing a COM server or through the **WMI ATL wizards** in Visual Studio.</span></span> <span data-ttu-id="52c10-107">Sie können einen Anbieter für verwalteten Code mithilfe von WMI in der .NET Framework schreiben.</span><span class="sxs-lookup"><span data-stu-id="52c10-107">You can write a managed code provider by using WMI in the .NET Framework.</span></span> <span data-ttu-id="52c10-108">In den Themen in diesem Abschnitt wird beschrieben, wie ein nicht verwalteter com-Anbieter geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="52c10-108">The topics in this section describe the process of writing an unmanaged COM provider.</span></span>

> [!Note]  
> <span data-ttu-id="52c10-109">Um sicherzustellen, dass alle ihre WMI-Klassendefinitionen für verwaltete Objekte im [*WMI-Repository*](gloss-w.md) wieder hergestellt werden, wenn WMI einen Fehler aufweist und neu gestartet wird, verwenden Sie die " [**\# pragma Auto Wiederherstellen**](pragma-autorecover.md) "-Präprozessoranweisung in der MOF-Datei (Managed Object Format).</span><span class="sxs-lookup"><span data-stu-id="52c10-109">To ensure that all of your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your Managed Object Format (MOF) file.</span></span>

 

<span data-ttu-id="52c10-110">Ein Anbieter besteht aus Klassen, die im [*MOF-Schema (Managed Object Format)*](gloss-m.md) und einer DLL-Datei definiert sind, die die Funktionen des Anbieters ausführt.</span><span class="sxs-lookup"><span data-stu-id="52c10-110">A provider consists of classes defined in the [*Managed Object Format (MOF)*](gloss-m.md) schema and a DLL file which carries out the functions of the provider.</span></span> <span data-ttu-id="52c10-111">Beispielsweise ist die MOF-Datei, die die Klassen des Win32-Anbieters definiert, cimwin32. MOF, und die dll wird CIMWin32.dll. beide befinden sich in% windir% \\ system32 \\ WBEM.</span><span class="sxs-lookup"><span data-stu-id="52c10-111">For example, the MOF that defines the classes of the Win32 provider is CIMWin32.mof and the DLL is CIMWin32.dll, both are found in %windir%\\System32\\Wbem.</span></span>

<span data-ttu-id="52c10-112">Das MOF-Schema für den Anbieter kann mehrere Anbieter Typen enthalten.</span><span class="sxs-lookup"><span data-stu-id="52c10-112">The MOF schema for the provider may contain several provider types.</span></span> <span data-ttu-id="52c10-113">Der [Ereignisprotokoll Anbieter](/previous-versions/windows/desktop/eventlogprov/event-log-provider) enthält z. b. in einer MOF-Datei mit dem Namen "ntevt. mof" Instanzen-, Methoden-und Ereignis Anbieter Typen.</span><span class="sxs-lookup"><span data-stu-id="52c10-113">For example, the [Event Log Provider](/previous-versions/windows/desktop/eventlogprov/event-log-provider) has instance, method, and event provider types in one MOF file named Ntevt.mof.</span></span> <span data-ttu-id="52c10-114">Es wird empfohlen, alle Klassen und das Registrierungs Schema für Verwandte Anbieter in einer Datei zusammenzustellen, anstatt eine Datei pro Klasse zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="52c10-114">It is recommended that all of the classes and registration schema for related providers be assembled in one file, rather than creating one file per class.</span></span>

<span data-ttu-id="52c10-115">Zusätzlich zur Verwendung von vorinstallierten Anbietern können Sie auch einen eigenen Anbieter erstellen, um Informationen über ein Hardware Gerät oder den Betrieb der Software bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="52c10-115">In addition to using preinstalled providers, you can create your own provider to supply information about a hardware device or the operations of software.</span></span>

<span data-ttu-id="52c10-116">In der folgenden Tabelle sind die grundlegenden Aufgaben aufgeführt, mit denen ein Anbieter erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="52c10-116">The following table lists the basic tasks that create a provider.</span></span>



| <span data-ttu-id="52c10-117">Aufgabe</span><span class="sxs-lookup"><span data-stu-id="52c10-117">Task</span></span>                                                                                                                                                            | <span data-ttu-id="52c10-118">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="52c10-118">Description</span></span>                                                                                                                                      |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="52c10-119">Entwerfen von Managed Object Format-Klassen (MOF)</span><span class="sxs-lookup"><span data-stu-id="52c10-119">Designing Managed Object Format (MOF) Classes</span></span>](designing-managed-object-format--mof--classes.md)                                                              | <span data-ttu-id="52c10-120">Entwickeln Sie ein Modell für die Entitäten, die Sie über WMI verwalten möchten, und erstellen Sie eine Managed Object Format Datei (MOF), um das Schema zu beschreiben.</span><span class="sxs-lookup"><span data-stu-id="52c10-120">Develop a model for the entities you want to manage through WMI and create a Managed Object Format (MOF) file to describe the schema.</span></span><br/> |
| [<span data-ttu-id="52c10-121">Bereitstellen von Daten für WMI durch Schreiben eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-121">Supplying Data to WMI by Writing a Provider</span></span>](supplying-data-to-wmi-by-writing-a-provider.md)                                                                  | <span data-ttu-id="52c10-122">Erstellen Sie den grundlegendsten Anbieter, der mit WMI gekoppelt ist.</span><span class="sxs-lookup"><span data-stu-id="52c10-122">Create the most basic provider that is coupled to WMI.</span></span><br/>                                                                                |
| [<span data-ttu-id="52c10-123">Einbinden eines Anbieters in eine Anwendung</span><span class="sxs-lookup"><span data-stu-id="52c10-123">Incorporating a Provider in an Application</span></span>](incorporating-a-provider-in-an-application.md)                                                                    | <span data-ttu-id="52c10-124">Fügen Sie den Anbieter als Komponente in eine Anwendung ein, wenn er nicht immer ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="52c10-124">Include the provider as a component within an application if it does not run all of the time.</span></span><br/>                                         |
| [<span data-ttu-id="52c10-125">Registrieren eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-125">Registering a Provider</span></span>](registering-a-provider.md)                                                                                                            | <span data-ttu-id="52c10-126">Registrieren Sie den Anbieter bei com und WMI.</span><span class="sxs-lookup"><span data-stu-id="52c10-126">Register the provider with COM and WMI.</span></span><br/>                                                                                               |
| [<span data-ttu-id="52c10-127">Initialisieren eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-127">Initializing a Provider</span></span>](initializing-a-provider.md)                                                                                                          | <span data-ttu-id="52c10-128">Implementieren Sie die Schnittstellen [**iwbemproviderinit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) und [**iwbemproviderinitsink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink) .</span><span class="sxs-lookup"><span data-stu-id="52c10-128">Implement the [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) and [**IWbemProviderInitSink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink) interfaces.</span></span><br/>   |
| [<span data-ttu-id="52c10-129">Aufrufen von WMI</span><span class="sxs-lookup"><span data-stu-id="52c10-129">Making Calls to WMI</span></span>](making-calls-to-wmi.md)                                                                                                                  | <span data-ttu-id="52c10-130">Ruft WMI-Schnittstellen von einem Anbieter auf.</span><span class="sxs-lookup"><span data-stu-id="52c10-130">Call WMI interfaces from a provider.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="52c10-131">Annehmen der Identität eines Clients</span><span class="sxs-lookup"><span data-stu-id="52c10-131">Impersonating a Client</span></span>](impersonating-a-client.md)                                                                                                            | <span data-ttu-id="52c10-132">Legen Sie Sicherheit für den Zugriff auf eine Client Anwendung fest.</span><span class="sxs-lookup"><span data-stu-id="52c10-132">Set security to access a client application.</span></span><br/>                                                                                          |
| [<span data-ttu-id="52c10-133">Aktualisieren eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-133">Updating a Provider</span></span>](updating-a-provider.md)                                                                                                                  | <span data-ttu-id="52c10-134">Verbessern Sie den Anbieter nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="52c10-134">Improve the provider as needed.</span></span><br/>                                                                                                       |
| [<span data-ttu-id="52c10-135">Entladen eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-135">Unloading a Provider</span></span>](unloading-a-provider.md)                                                                                                                | <span data-ttu-id="52c10-136">Entfernen Sie den Anbieter beim Herunterfahren oder bei Leerlauf des Anbieters aus dem Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="52c10-136">Remove the provider from memory during shutdown or when the provider is idle.</span></span><br/>                                                         |
| <span data-ttu-id="52c10-137">[Debuggen von Anbietern](debugging-providers.md) und [Anbieter Konfiguration und Problem Behandlungs Klassen](provider-configuration-and-troubleshooting-classes.md)</span><span class="sxs-lookup"><span data-stu-id="52c10-137">[Debugging Providers](debugging-providers.md) and [Provider Configuration and Troubleshooting Classes](provider-configuration-and-troubleshooting-classes.md)</span></span> | <span data-ttu-id="52c10-138">Debuggen Sie Ihren Anbieter mithilfe der von WMI bereitgestellten Funktionen.</span><span class="sxs-lookup"><span data-stu-id="52c10-138">Debug your provider using facilities supplied by WMI.</span></span><br/>                                                                                 |
| [<span data-ttu-id="52c10-139">Erhalten und Bereitstellen von Daten auf einem 64-Bit-Computer</span><span class="sxs-lookup"><span data-stu-id="52c10-139">Getting and Providing Data on a 64-bit Computer</span></span>](getting-and-providing-data-on-a-64-bit-computer.md)                                                          | <span data-ttu-id="52c10-140">Evaluieren Sie, ob Sie einen 32-Bit-Anwendungskompatibilitäts-Anbieter benötigen oder ob der 64-Bit-Anbieter Daten für beide Clients bereitstellen kann.</span><span class="sxs-lookup"><span data-stu-id="52c10-140">Evaluate whether you need a 32-bit application compatibility provider or if the 64-bit provider can supply data to both clients.</span></span><br/>      |



 

<span data-ttu-id="52c10-141">In den folgenden Themen werden die Schritte erläutert, die zum Schreiben verschiedener Anbieter Typen erforderlich sind:</span><span class="sxs-lookup"><span data-stu-id="52c10-141">The following topics discuss the steps needed to write different types of providers:</span></span>

-   [<span data-ttu-id="52c10-142">Schreiben eines Instanzanbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-142">Writing an Instance Provider</span></span>](writing-an-instance-provider.md)
-   [<span data-ttu-id="52c10-143">Schreiben eines Methoden Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-143">Writing a Method Provider</span></span>](writing-a-method-provider.md)
-   [<span data-ttu-id="52c10-144">Schreiben eines Ereignis Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-144">Writing an Event Provider</span></span>](writing-an-event-provider.md)
-   [<span data-ttu-id="52c10-145">Schreiben eines Ereignisconsumeranbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-145">Writing an Event Consumer Provider</span></span>](writing-an-event-consumer-provider.md)
-   [<span data-ttu-id="52c10-146">Schreiben eines Klassen Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-146">Writing a Class Provider</span></span>](writing-a-class-provider.md)
-   [<span data-ttu-id="52c10-147">Schreiben eines Eigenschaften Anbieters</span><span class="sxs-lookup"><span data-stu-id="52c10-147">Writing a Property Provider</span></span>](writing-a-property-provider.md)
-   [<span data-ttu-id="52c10-148">Erstellen eines Instanzanbieters in einen High-Performance-Anbieter</span><span class="sxs-lookup"><span data-stu-id="52c10-148">Making an Instance Provider into a High-Performance Provider</span></span>](making-an-instance-provider-into-a-high-performance-provider.md)

 

