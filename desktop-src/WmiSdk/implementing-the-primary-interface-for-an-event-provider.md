---
description: Ein Ereignis Anbieter muss die iwbemeventprovider-Schnittstelle implementieren, um Ereignis Benachrichtigungen zu generieren.
ms.assetid: ae33c9f5-61f7-4488-a281-01d7f9c62c46
ms.tgt_platform: multiple
title: Implementieren der primären Schnittstelle für einen Ereignis Anbieter
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5621a2c6d0901a7925828149dd5c1480c2b11456
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "103960219"
---
# <a name="implementing-the-primary-interface-for-an-event-provider"></a><span data-ttu-id="df4ee-103">Implementieren der primären Schnittstelle für einen Ereignis Anbieter</span><span class="sxs-lookup"><span data-stu-id="df4ee-103">Implementing the Primary Interface for an Event Provider</span></span>

<span data-ttu-id="df4ee-104">Ein Ereignis Anbieter muss die [**iwbemeventprovider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) -Schnittstelle implementieren, um Ereignis Benachrichtigungen zu generieren.</span><span class="sxs-lookup"><span data-stu-id="df4ee-104">An event provider must implement the [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) interface to generate event notifications.</span></span> <span data-ttu-id="df4ee-105">WMI Ruft die [**iwbemeventprovider::P rovideevents**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventprovider-provideevents) -Methode des Anbieters auf und übergibt einen Zeiger auf das sink-Objekt, das eine Implementierung der [**iwbewbjectsink**](iwbemobjectsink.md) -Schnittstelle ist.</span><span class="sxs-lookup"><span data-stu-id="df4ee-105">WMI calls the [**IWbemEventProvider::ProvideEvents**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventprovider-provideevents) method of the provider and passes in a pointer to the sink object, which is an implementation of the [**IWbemObjectSink**](iwbemobjectsink.md) interface.</span></span> <span data-ttu-id="df4ee-106">Wenn der Ereignis Anbieter bereit ist, eine Benachrichtigung zu generieren, ruft der Anbieter die Methode [**iwbexbjectsink::**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) Notification auf.</span><span class="sxs-lookup"><span data-stu-id="df4ee-106">When the event provider is ready to generate a notification, the provider calls the [**IWbemObjectSink::Indicate**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) method.</span></span>

<span data-ttu-id="df4ee-107">Ein Ereignis Anbieter sollte die über [**iwbemeventprovider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) generierten Benachrichtigungen in Ereignis Objekten platzieren.</span><span class="sxs-lookup"><span data-stu-id="df4ee-107">An event provider should place the notifications generated through [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) in event objects.</span></span> <span data-ttu-id="df4ee-108">Sie sollten Ereignis Objekte als Einträge in einem Array von [**IWbemClassObject**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemclassobject) -Schnittstellen implementieren, die durch den *ppobjarray* -Parameter der-Methode [**angegeben**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) werden.</span><span class="sxs-lookup"><span data-stu-id="df4ee-108">You should implement event objects as entries in an array of [**IWbemClassObject**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemclassobject) interfaces represented by the *ppObjArray* parameter of the [**Indicate**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) method.</span></span> <span data-ttu-id="df4ee-109">Da **iwbemclassobjects** com-Objekte sind, muss der Anbieter den Verweis Zähler für die Senke erhöhen, indem er die [**iwbemubjectsink:: adressf**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) -Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="df4ee-109">Because **IWbemClassObjects** are COM objects, the provider must increment the reference count for the sink by calling the [**IWbemObjectSink::AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) method.</span></span> <span data-ttu-id="df4ee-110">Ereignis Anbieter, die viele Benachrichtigungen bereitstellen müssen (z. b. 400-Ereignisse), sollten ein eindeutiges Ereignis Objekt für jede Benachrichtigung erstellen, indem Sie entweder eine neue Instanz erstellen oder eine vorhandene Klonen.</span><span class="sxs-lookup"><span data-stu-id="df4ee-110">Event providers that must supply many notifications (for example, 400 events) should create a unique event object for each notification by either spawning a new instance or cloning an existing one.</span></span> <span data-ttu-id="df4ee-111">WMI hält auf einem Ereignis Objekt nach dem Abschluss des Anzeige Aufrufes niemals an und hat keine besonderen Anforderungen an die **Adressier** Ende **Angabe** oberhalb und über den com-Standard.</span><span class="sxs-lookup"><span data-stu-id="df4ee-111">WMI never holds onto an event object past the completion of the **Indicate** call, and has no special requirements for **AddRef** above and beyond the COM standard.</span></span>

<span data-ttu-id="df4ee-112">Beachten Sie die folgenden Richtlinien, wenn Sie einen Ereignis Anbieter implementieren:</span><span class="sxs-lookup"><span data-stu-id="df4ee-112">Consider the following guidelines when implementing an event provider:</span></span>

-   <span data-ttu-id="df4ee-113">Nehmen Sie während der Wartung eines Client Aufrufes keine Klassenänderungen vor.</span><span class="sxs-lookup"><span data-stu-id="df4ee-113">Do not make any class changes while servicing a client call.</span></span>
-   <span data-ttu-id="df4ee-114">Geben Sie keine ereignisbezogenen Aufrufe aus, z. b. einen Aufruf, der einen Ereignis Filter ändert.</span><span class="sxs-lookup"><span data-stu-id="df4ee-114">Do not issue any event-related calls, such as a call that modifies an event filter.</span></span>
-   <span data-ttu-id="df4ee-115">Verarbeiten Sie alle Anforderungen, die der Windows-Verwaltungsdienst ausgibt (z. b. [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery)), bevor Sie ein Ereignis erneut auslösen.</span><span class="sxs-lookup"><span data-stu-id="df4ee-115">Process any requests that the Windows Management service issues, such as [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery), before refiring an event.</span></span>

    <span data-ttu-id="df4ee-116">Wenn Sie die Anforderung nicht verarbeiten, kann das erneute Auslösen des Ereignisses dazu führen, dass das Ereignis nicht mehr akzeptiert wird.</span><span class="sxs-lookup"><span data-stu-id="df4ee-116">If you do not process the request, then refiring the event might block the event from ever being accepted.</span></span>

-   <span data-ttu-id="df4ee-117">Niemals Aufrufen von [**iwbemubjectsink:: SetStatus**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-setstatus) innerhalb eines Anbieters.</span><span class="sxs-lookup"><span data-stu-id="df4ee-117">Never call [**IWbemObjectSink::SetStatus**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-setstatus) from within a provider.</span></span>

 

 
