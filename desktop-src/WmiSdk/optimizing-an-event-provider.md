---
description: Ein Ereignis Anbieter kann sehr viel Zeit für das Erstellen von Ereignissen aufwenden.
ms.assetid: 5cf414f0-b3a8-4623-9aaa-08e2a28b40c0
ms.tgt_platform: multiple
title: Optimieren eines Ereignis Anbieters
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70eaabfbbd462b831059b10590d7959bdef05cbc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106352546"
---
# <a name="optimizing-an-event-provider"></a><span data-ttu-id="53d1f-103">Optimieren eines Ereignis Anbieters</span><span class="sxs-lookup"><span data-stu-id="53d1f-103">Optimizing an Event Provider</span></span>

<span data-ttu-id="53d1f-104">Ein Ereignis Anbieter kann sehr viel Zeit für das Erstellen von Ereignissen aufwenden.</span><span class="sxs-lookup"><span data-stu-id="53d1f-104">An event provider may devote a great deal of time to creating events.</span></span> <span data-ttu-id="53d1f-105">Wenn keine Client Anwendungen die erstellten Ereignisse verwenden, verschwendet der Anbieter Systemressourcen.</span><span class="sxs-lookup"><span data-stu-id="53d1f-105">If no client applications use the created events, then the provider is wasting system resources.</span></span> <span data-ttu-id="53d1f-106">Außerdem verbringt WMI eine beträchtliche Menge an Ressourcen und sendet komplexe Abfragen an den entsprechenden Anbieter.</span><span class="sxs-lookup"><span data-stu-id="53d1f-106">Further, WMI spends a considerable amount of resources parsing and sending complex queries to the appropriate provider.</span></span> <span data-ttu-id="53d1f-107">Um die Verschwendung von Systemressourcen zu vermeiden und die Leistung Ihres Ereignis Anbieters zu verbessern, können Sie die [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="53d1f-107">To avoid the waste of system resources and to improve the performance of your event provider, you can implement the [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) interface.</span></span> <span data-ttu-id="53d1f-108">**IWbemEventProviderQuerySink** überwacht die Abfragen, die von Client Anwendungen bei WMI registriert werden, mithilfe der [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) -Methode und der [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) -Methode.</span><span class="sxs-lookup"><span data-stu-id="53d1f-108">**IWbemEventProviderQuerySink** monitors the queries that client applications register with WMI by using the [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) and [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) methods.</span></span> <span data-ttu-id="53d1f-109">Wenn Sie die registrierten Client Abfragen überwachen, kann der Anbieter ermitteln, ob Nachrichten an WMI gesendet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="53d1f-109">By monitoring the registered client queries, your provider can determine what if any messages must be sent to WMI.</span></span>

<span data-ttu-id="53d1f-110">WMI ruft [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) für einen Ereignis Anbieter auf, wenn ein Client Consumer eine Ereignis Filter Abfrage registriert, die Verweise auf Ereignisse enthält, die von diesem Ereignis Anbieter unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="53d1f-110">WMI calls [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) on an event provider when a client consumer registers an event filter query that contains references to events supported by that event provider.</span></span> <span data-ttu-id="53d1f-111">Daher kann der Ereignis Anbieter, der für Instanzen Änderungs Ereignisse für die **emailclass** -Klasse verantwortlich ist, so eingerichtet werden, dass nur Benachrichtigungen für den **Absender** generiert werden.</span><span class="sxs-lookup"><span data-stu-id="53d1f-111">So the event provider responsible for instance modification events for the **EmailClass** class can be set up to generate notifications only for **sender**.</span></span> <span data-ttu-id="53d1f-112">Wenn der Anbieter eine Abfrage empfängt, die eine Benachrichtigung über Änderungen an der Eigenschaft " **Subject** " anfordert, kann der Anbieter damit beginnen, diese Benachrichtigungen zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="53d1f-112">When the provider receives a query requesting notification of changes to the **subject** property, the provider can start generating those notifications.</span></span> <span data-ttu-id="53d1f-113">In diesem Szenario ist es nicht erforderlich, dass WMI die Benachrichtigungen verwerfen, die nur vom **Empfänger des Empfängers** geändert werden.</span><span class="sxs-lookup"><span data-stu-id="53d1f-113">In this scenario, WMI is not required to discard the notifications that report **recipient** changes only.</span></span>

<span data-ttu-id="53d1f-114">Ebenso ruft WMI [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) für einen Ereignis Anbieter auf, wenn ein Client Consumer eine Ereignis Filter Abfrage deregister, die Verweise auf Ereignisse enthält, die vom Ereignis Anbieter unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="53d1f-114">Similarly, WMI calls [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) on an event provider when a client consumer deregisters an event filter query that contains references to events supported by the event provider.</span></span> <span data-ttu-id="53d1f-115">Der Zweck von **CancelQuery** besteht darin, dass der Ereignis Anbieter die Liste der Ereignisse aktualisiert, die gesendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="53d1f-115">The purpose of **CancelQuery** is for the event provider to update the list of what events should be sent out.</span></span>

> [!Note]  
> <span data-ttu-id="53d1f-116">Wenn Ihr Anbieter sowohl [**iwbemeventprovider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) als auch [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink)unterstützt, stellen Sie sicher, dass die Implementierung der **IUnknown:: QueryInterface** -Methode Zeiger auf beide Schnittstellen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="53d1f-116">If your provider supports both [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) and [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), ensure that your implementation of the **IUnknown::QueryInterface** method returns pointers to both interfaces.</span></span>

 

 

 



