---
description: Client Anwendungen, die WMI-Schnittstellen aufzurufen, können die Sicherheitsstufen ihrer Prozesse steuern.
ms.assetid: 790b4e40-9b92-464a-a774-dec0b75cedee
ms.tgt_platform: multiple
title: Festlegen der Prozesssicherheit für Client Anwendungen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8bfa0a42390ffa433cff01300b0976d40553665c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104216889"
---
# <a name="setting-client-application-process-security"></a><span data-ttu-id="d06ce-103">Festlegen der Prozesssicherheit für Client Anwendungen</span><span class="sxs-lookup"><span data-stu-id="d06ce-103">Setting Client Application Process Security</span></span>

<span data-ttu-id="d06ce-104">Client Anwendungen, die WMI-Schnittstellen aufzurufen, können die Sicherheitsstufen ihrer Prozesse steuern.</span><span class="sxs-lookup"><span data-stu-id="d06ce-104">Client applications that call WMI interfaces can control the security levels of their processes.</span></span> <span data-ttu-id="d06ce-105">Alle WMI-Anwendungen greifen über com auf WMI zu, und Sie können die com-Funktion [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) aufrufen, um die Sicherheit für Ihre Prozesse festzulegen.</span><span class="sxs-lookup"><span data-stu-id="d06ce-105">All WMI applications access WMI through COM, and you can call the COM function [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) to set security for your processes.</span></span> <span data-ttu-id="d06ce-106">Anwendungen, die asynchrone Aufrufe von WMI und Anwendungen ausführen, die als Ereignisconsumer registriert werden, legen Sicherheitsebenen für den WMI-Aufruf fest.</span><span class="sxs-lookup"><span data-stu-id="d06ce-106">Applications that make asynchronous calls to WMI and applications that register as event consumers set security levels on the call into WMI.</span></span>

<span data-ttu-id="d06ce-107">Wenn Sie keinen expliziten Aufruf von [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity)durchführen, ruft com ihn implizit mit Werten aus der Registrierung auf.</span><span class="sxs-lookup"><span data-stu-id="d06ce-107">If you do not make an explicit call to [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity), COM calls it implicitly with values from the registry.</span></span> <span data-ttu-id="d06ce-108">Die Registrierungs Werte haben jedoch möglicherweise niedrigere Einstellungen für Identitätswechsel und Authentifizierung, die nicht die für WMI erforderliche Sicherheit bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d06ce-108">However, the registry values may have lower settings for impersonation and authentication that do not provide the security required for WMI.</span></span> <span data-ttu-id="d06ce-109">Weitere Informationen finden Sie unter [Festlegen der standardmäßigen Prozess Sicherheitsstufe mithilfe von C++](setting-the-default-process-security-level-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="d06ce-109">For more information, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md).</span></span>

<span data-ttu-id="d06ce-110">Der asynchrone Zugriff auf WMI wird nicht empfohlen.</span><span class="sxs-lookup"><span data-stu-id="d06ce-110">Asynchronous access to WMI is not recommended.</span></span> <span data-ttu-id="d06ce-111">Ein asynchroner Rückruf ermöglicht einem nicht authentifizierten Benutzer das Bereitstellen von Daten für die Senke.</span><span class="sxs-lookup"><span data-stu-id="d06ce-111">An asynchronous callback allows a non-authenticated user to provide data to the sink.</span></span> <span data-ttu-id="d06ce-112">Dies birgt Sicherheitsrisiken für Ihre Skripts und Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="d06ce-112">This poses security risks to your scripts and applications.</span></span> <span data-ttu-id="d06ce-113">Um die Risiken auszuschließen, verwenden Sie die semisynchrone oder synchrone Kommunikation, oder führen Sie in der Client Anwendung ordnungsgemäße Zugriffs Überprüfungen durch.</span><span class="sxs-lookup"><span data-stu-id="d06ce-113">To eliminate the risks, use semisynchronous or synchronous communication, or perform proper access checks in your client application.</span></span> <span data-ttu-id="d06ce-114">Weitere Informationen finden Sie unter [Aufrufen einer Methode](calling-a-method.md).</span><span class="sxs-lookup"><span data-stu-id="d06ce-114">For more information, see [Calling a Method](calling-a-method.md).</span></span>

<span data-ttu-id="d06ce-115">Aufrufe von WMI-Proxys ([**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), [**ienumwbemclassobject**](/windows/desktop/api/Wbemcli/nn-wbemcli-ienumwbemclassobject),[**iwbemcallresult**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemcallresult)oder [**iwbemaktusher**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemrefresher)) verwenden einen Out-of-Process-Zeiger.</span><span class="sxs-lookup"><span data-stu-id="d06ce-115">Calls to any of the WMI proxies ([**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), [**IEnumWbemClassObject**](/windows/desktop/api/Wbemcli/nn-wbemcli-ienumwbemclassobject),[**IWbemCallResult**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemcallresult), or [**IWbemRefresher**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemrefresher)) use an out-of-process pointer.</span></span> <span data-ttu-id="d06ce-116">Weitere Informationen zu den Standardeinstellungen und Empfehlungen finden Sie unter [Festlegen der Sicherheit für IWbemServices und andere](setting-the-security-on-iwbemservices-and-other-proxies.md)Proxys.</span><span class="sxs-lookup"><span data-stu-id="d06ce-116">For more information about the defaults and recommendations, see [Setting the Security on IWbemServices and Other Proxies](setting-the-security-on-iwbemservices-and-other-proxies.md).</span></span>

<span data-ttu-id="d06ce-117">Im folgenden Verfahren werden die Schritte beschrieben, die Sie ausführen müssen, um die Sicherheit für WMI auf dem Anwendungsprozess festzulegen.</span><span class="sxs-lookup"><span data-stu-id="d06ce-117">The following procedure describes the steps you must perform to set the security for WMI on your application process.</span></span>

<span data-ttu-id="d06ce-118">**So legen Sie die Sicherheit für WMI für den Anwendungsprozess fest**</span><span class="sxs-lookup"><span data-stu-id="d06ce-118">**To set security for WMI on your application process**</span></span>

1.  <span data-ttu-id="d06ce-119">Bestimmen Sie die Sicherheitsstufen, die für die Windows-Betriebssysteme erforderlich sind, auf denen die Client Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d06ce-119">Determine the security levels required for the Windows operating systems on which your client application runs.</span></span>
2.  <span data-ttu-id="d06ce-120">Ruft die com- [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) -Funktion auf, um die Standard Sicherheit für den Prozess festzulegen, in dem die Client Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d06ce-120">Call the COM [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) function to set the default security for the process in which the client application runs.</span></span> <span data-ttu-id="d06ce-121">Dadurch wird angegeben, wie viel Sicherheit andere Anwendungen benötigen, um auf den Prozess zuzugreifen, in dem Ihre Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d06ce-121">This declares how much security other applications require to access the process in which your application runs.</span></span>
3.  <span data-ttu-id="d06ce-122">Wenn Sie die Sicherheit eines einzelnen Proxys ändern müssen, z. b. bei einem anderen [**callbemservices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices)-Befehl, aufrufen Sie [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket).</span><span class="sxs-lookup"><span data-stu-id="d06ce-122">If you need to change the security on an individual proxy, for example on another call to [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), call [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket).</span></span>
4.  <span data-ttu-id="d06ce-123">Wenn Sie Remote Hardware oder ein Systemobjekt steuern müssen, das mehr Berechtigungen erfordert, verwenden Sie [**die Funktion "**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges) Funktion", um die erforderlichen Berechtigungen zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="d06ce-123">If you need to control remote hardware or a system object that requires more privilege, use the [**AdjustTokenPrivileges**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges) function to enable the necessary privileges.</span></span> <span data-ttu-id="d06ce-124">Beachten Sie, dass Sie keine Berechtigung aktivieren können, die dem Prozess nicht bereits zugewiesen wurde.</span><span class="sxs-lookup"><span data-stu-id="d06ce-124">Note that you cannot enable a privilege that the process does not already have assigned to it.</span></span> <span data-ttu-id="d06ce-125">Weitere Informationen finden Sie unter über [prüfen des Zugriffs auf private Objekte](/windows/desktop/SecAuthZ/checking-access-to-private-objects).</span><span class="sxs-lookup"><span data-stu-id="d06ce-125">For more information, see [Checking Access to Private Objects](/windows/desktop/SecAuthZ/checking-access-to-private-objects).</span></span>

<span data-ttu-id="d06ce-126">Weitere Informationen zum Festlegen der standardmäßigen Prozess Sicherheitsstufe finden Sie unter [Festlegen der standardmäßigen Prozess Sicherheitsstufe mithilfe von C++](setting-the-default-process-security-level-using-c-.md) und [Festlegen der standardmäßigen Prozess Sicherheitsstufe mithilfe von VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="d06ce-126">For further information about setting the default process security level, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md) and [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

 

 
