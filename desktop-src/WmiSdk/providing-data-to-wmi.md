---
description: WMI stellt über WMI-Anbieter Daten zu überschaubaren Windows-Objekten zur Verfügung.
ms.assetid: 74558c6e-28b6-479f-9de6-2fbad793ae26
ms.tgt_platform: multiple
title: Bereitstellen von Daten für WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60df0384bd6f512b931870775067d9d9e6d4077d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103753681"
---
# <a name="providing-data-to-wmi"></a><span data-ttu-id="d8ba6-103">Bereitstellen von Daten für WMI</span><span class="sxs-lookup"><span data-stu-id="d8ba6-103">Providing Data to WMI</span></span>

<span data-ttu-id="d8ba6-104">WMI stellt über WMI- [*Anbieter*](gloss-p.md)Daten zu überschaubaren Windows-Objekten zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-104">WMI makes data about Windows manageable objects available through WMI [*providers*](gloss-p.md).</span></span> <span data-ttu-id="d8ba6-105">Ein Anbieter ruft Daten von einer Systemkomponente (z. b. einem Prozess) oder einer instrumentierten Anwendung (z. b. SNMP oder IIS) ab und übergibt diese Daten über WMI an eine Verwaltungs Anwendung.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-105">A provider retrieves data from a system component, such as a process, or an instrumented application, such as SNMP or IIS, and passes that data through WMI to a management application.</span></span> <span data-ttu-id="d8ba6-106">Wenn z. b. eine Anwendung oder ein Skript mithilfe der WMI- [**Win32- \_ Prozess**](/windows/desktop/CIMWin32Prov/win32-process) Klasse Prozessinformationen anfordert, werden die Daten dynamisch über einen vorinstallierten Anbieter abgerufen.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-106">For example, when an application or script requests process information using the WMI [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) class, the data is obtained dynamically through a preinstalled provider.</span></span>

<span data-ttu-id="d8ba6-107">In diesem Thema werden die folgenden Abschnitte erläutert:</span><span class="sxs-lookup"><span data-stu-id="d8ba6-107">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="d8ba6-108">Erstellen eines Modells für ein verwaltbares Objekt</span><span class="sxs-lookup"><span data-stu-id="d8ba6-108">Creating a Model for a Manageable Object</span></span>](#creating-a-model-for-a-manageable-object)
-   [<span data-ttu-id="d8ba6-109">Implementieren eines Modells für ein verwaltbares Objekt</span><span class="sxs-lookup"><span data-stu-id="d8ba6-109">Implementing a Model for a Manageable Object</span></span>](#implementing-a-model-for-a-manageable-object)
-   [<span data-ttu-id="d8ba6-110">Bestimmen eines zu implementierenden Anbieter Typs</span><span class="sxs-lookup"><span data-stu-id="d8ba6-110">Determining a Provider Type to Implement</span></span>](#determining-a-provider-type-to-implement)
-   [<span data-ttu-id="d8ba6-111">Bestimmen eines Hostingmodells (Implementierung) für einen Anbieter</span><span class="sxs-lookup"><span data-stu-id="d8ba6-111">Determining a Hosting (Implementation) Model for a Provider</span></span>](#determining-a-hosting-implementation-model-for-a-provider)
-   [<span data-ttu-id="d8ba6-112">Implementieren eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="d8ba6-112">Implementing a Provider</span></span>](#implementing-a-provider)
-   [<span data-ttu-id="d8ba6-113">Registrieren eines Anbieters bei WMI und dem System</span><span class="sxs-lookup"><span data-stu-id="d8ba6-113">Registering a Provider with WMI and the System</span></span>](#registering-a-provider-with-wmi-and-the-system)
-   [<span data-ttu-id="d8ba6-114">Testen eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="d8ba6-114">Testing a Provider</span></span>](#testing-a-provider)
-   [<span data-ttu-id="d8ba6-115">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="d8ba6-115">Related topics</span></span>](#related-topics)

## <a name="creating-a-model-for-a-manageable-object"></a><span data-ttu-id="d8ba6-116">Erstellen eines Modells für ein verwaltbares Objekt</span><span class="sxs-lookup"><span data-stu-id="d8ba6-116">Creating a Model for a Manageable Object</span></span>

<span data-ttu-id="d8ba6-117">Erstellen Sie vor der Entwicklung eines Anbieters ein Datenmodell, das das verwaltbare Objekt darstellt, das über WMI verfügbar gemacht werden soll.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-117">Before developing a provider, create a data model to represent the manageable object to be exposed through WMI.</span></span> <span data-ttu-id="d8ba6-118">Sie planen, welche Datenobjekte der Anbieter verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-118">You plan which data objects your provider will expose.</span></span> <span data-ttu-id="d8ba6-119">Wenn Sie z. b. die Bildschirmauflösung des Desktop Hintergrunds verwalten möchten, müssen Sie entscheiden, wie der Desktop in einer [*MOF-Datei (Managed Object Format)*](gloss-m.md) modelliert werden soll.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-119">For example, if you plan to manage the screen resolution of the desktop background, you must decide how to model the Desktop in a [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

<span data-ttu-id="d8ba6-120">So erstellen Sie ein nützliches Modell:</span><span class="sxs-lookup"><span data-stu-id="d8ba6-120">To create a useful model:</span></span>

-   <span data-ttu-id="d8ba6-121">Ermitteln Sie reale Szenarien, und modellieren Sie die Informationen, die ein Kunde möglicherweise lesen und aktualisieren möchte (z. b. Ändern des Hintergrund Bilds) für jedes verwaltbare Objekt.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-121">Determine real world scenarios and model the information a customer may want to read and update (for example, changing the background image) for each manageable object.</span></span> <span data-ttu-id="d8ba6-122">Dies sind Ihre Klasseneigenschaften.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-122">These are your class properties.</span></span>
-   <span data-ttu-id="d8ba6-123">Bestimmen Sie, welche Art von Aktionen ein Kunde mit jedem verwaltbaren Objekt ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-123">Determine which kind of actions a customer may want to perform with each manageable object.</span></span> <span data-ttu-id="d8ba6-124">Dabei handelt es sich um ihre Methoden.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-124">These are your methods.</span></span>

## <a name="implementing-a-model-for-a-manageable-object"></a><span data-ttu-id="d8ba6-125">Implementieren eines Modells für ein verwaltbares Objekt</span><span class="sxs-lookup"><span data-stu-id="d8ba6-125">Implementing a Model for a Manageable Object</span></span>

<span data-ttu-id="d8ba6-126">Um ein Modell für verwaltbare Objekte zu implementieren, erstellen Sie eine MOF-Datei, die eine WMI-Klasse enthält, die jedes Objekt darstellt.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-126">To implement a model for manageable objects, create a MOF file containing a WMI class that represents each object.</span></span> <span data-ttu-id="d8ba6-127">Weitere Informationen zum Erstellen einer MOF-Datei zum Definieren von WMI-Klassen finden Sie unter [Entwerfen von Managed Object Format-Klassen (MOF)](designing-managed-object-format--mof--classes.md).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-127">For more information about creating a MOF file to define WMI classes, see [Designing Managed Object Format (MOF) Classes](designing-managed-object-format--mof--classes.md).</span></span> <span data-ttu-id="d8ba6-128">Die Registrierung des Anbieters und seiner Klassen ist in der Regel in der MOF-Datei enthalten, obwohl es möglich ist, die [com-API](com-api-for-wmi.md) zum Erstellen von Klassen und Methoden zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-128">The registration of the provider and its classes are usually included in the MOF file, although it is possible to use the [COM API](com-api-for-wmi.md) to create classes and methods.</span></span> <span data-ttu-id="d8ba6-129">Weitere Informationen finden Sie unter [Entwickeln eines WMI-Anbieters](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-129">For more information, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

> [!Note]  
> <span data-ttu-id="d8ba6-130">Um sicherzustellen, dass alle ihre WMI-Klassendefinitionen für verwaltete Objekte im [*WMI-Repository*](gloss-w.md) wieder hergestellt werden, wenn WMI einen Fehler aufweist und neu gestartet wird, verwenden Sie die " [**\# pragma Auto Wiederherstellen**](pragma-autorecover.md) "-Präprozessoranweisung in der [*MOF-Datei (Managed Object Format)*](gloss-m.md) .</span><span class="sxs-lookup"><span data-stu-id="d8ba6-130">To ensure that all your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

 

<span data-ttu-id="d8ba6-131">Nachdem Sie die MOF-Datei erstellt haben, kompilieren Sie Sie mit dem [**Mofcomp.exe**](mofcomp.md) Tool.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-131">After you create the MOF file, compile it using the [**Mofcomp.exe**](mofcomp.md) tool.</span></span> <span data-ttu-id="d8ba6-132">Dies benachrichtigt Sie über Fehler in der MOF-Datei und fügt die WMI-Klasse, die in der MOF-Datei definiert ist, dem [*WMI-Repository*](gloss-w.md) hinzu, sodass die Klasse von einem Anbieter verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-132">This notifies you of errors in your MOF file, and adds the WMI class defined in the MOF file to the [*WMI repository*](gloss-w.md) so that the class can be used by a provider.</span></span>

## <a name="determining-a-provider-type-to-implement"></a><span data-ttu-id="d8ba6-133">Bestimmen eines zu implementierenden Anbieter Typs</span><span class="sxs-lookup"><span data-stu-id="d8ba6-133">Determining a Provider Type to Implement</span></span>

<span data-ttu-id="d8ba6-134">WMI unterstützt eine bestimmte Anzahl von Anbieter Typen, die die Art der von den Anbietern unterstützten Informationen und Vorgänge bestimmt.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-134">WMI supports a certain number of provider types, which determines the nature of the information delivered and operations supported by the providers.</span></span>

<span data-ttu-id="d8ba6-135">Die Anbieter Typen lauten wie folgt:</span><span class="sxs-lookup"><span data-stu-id="d8ba6-135">The provider types are:</span></span>

-   [<span data-ttu-id="d8ba6-136">*Instanzanbieter*</span><span class="sxs-lookup"><span data-stu-id="d8ba6-136">*Instance provider*</span></span>](gloss-i.md)
-   [<span data-ttu-id="d8ba6-137">*Methoden Anbieter*</span><span class="sxs-lookup"><span data-stu-id="d8ba6-137">*Method provider*</span></span>](gloss-m.md)
-   [<span data-ttu-id="d8ba6-138">*Eigenschaften Anbieter*</span><span class="sxs-lookup"><span data-stu-id="d8ba6-138">*Property provider*</span></span>](gloss-p.md)
-   <span data-ttu-id="d8ba6-139">Klassen Anbieter</span><span class="sxs-lookup"><span data-stu-id="d8ba6-139">Class provider</span></span>
-   [<span data-ttu-id="d8ba6-140">*Ereignis Anbieter*</span><span class="sxs-lookup"><span data-stu-id="d8ba6-140">*Event provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="d8ba6-141">*Ereignisconsumeranbieter*</span><span class="sxs-lookup"><span data-stu-id="d8ba6-141">*Event consumer provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="d8ba6-142">*Zuordnungs Anbieter*</span><span class="sxs-lookup"><span data-stu-id="d8ba6-142">*Association provider*</span></span>](gloss-a.md)

<span data-ttu-id="d8ba6-143">Die meisten Anbieter sind Instanzanbieter und Methoden Anbieter.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-143">The vast majority of providers are instance providers and method providers.</span></span> <span data-ttu-id="d8ba6-144">Ein Instanzanbieter ist der häufigste Anbieter und stellt die Instanzen einer bestimmten Klasse bereit.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-144">An instance provider is the most common provider, and it supplies the instances of a given class.</span></span> <span data-ttu-id="d8ba6-145">Ein Methoden Anbieter implementiert die Methoden von einer oder mehreren Klassen.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-145">A method provider implements the methods of one or more classes.</span></span> <span data-ttu-id="d8ba6-146">Weitere Informationen zu den Anbieter Typen finden Sie unter [Entwickeln eines WMI-Anbieters](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-146">For more information about the types of providers, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

## <a name="determining-a-hosting-implementation-model-for-a-provider"></a><span data-ttu-id="d8ba6-147">Bestimmen eines Hostingmodells (Implementierung) für einen Anbieter</span><span class="sxs-lookup"><span data-stu-id="d8ba6-147">Determining a Hosting (Implementation) Model for a Provider</span></span>

<span data-ttu-id="d8ba6-148">WMI-Anbieter sind Binärdateien, die als COM-Objekte implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-148">WMI providers are binaries implemented as COM objects.</span></span> <span data-ttu-id="d8ba6-149">Dies bedeutet, dass jeder Anbieter über eine DLL-Datei verfügt, die innerhalb eines bestimmten Prozesses und Sicherheits Kontexts ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-149">This means that each provider has a DLL file which can be executed within a specific process and security context.</span></span> <span data-ttu-id="d8ba6-150">Dabei bezieht sich WMI auf das [*Hostingmodell*](gloss-h.md).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-150">This is what WMI refers to as the [*hosting model*](gloss-h.md).</span></span> <span data-ttu-id="d8ba6-151">WMI bietet verschiedene Möglichkeiten zum Hosten von Anbietern, die häufigste Methode ist jedoch, das gekoppelte Anbieter Modell (das unter dem WMI-Prozess ausgeführt wird) im networkservicehost-Sicherheitskontext zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-151">WMI offers various ways to host providers, but the most common approach is to use the coupled provider model (running under the WMI process) in the NetworkServiceHost security context.</span></span> <span data-ttu-id="d8ba6-152">Ein WMI-Anbieter kann als gekoppelt oder [*entkoppelt*](gloss-d.md)klassifiziert werden.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-152">A WMI provider can be classified as either coupled or [*decoupled*](gloss-d.md).</span></span>

<span data-ttu-id="d8ba6-153">Der Begriff gekoppelt oder entkoppelter Anbieter bestimmt, unter welchem Host Prozess der Anbieter in Bezug auf den WMIPRVSE.EXE Prozess bereitgestellten WMI ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-153">The term coupled or decoupled provider determines under which host process the provider is running with respect to the WMI provided WMIPRVSE.EXE process.</span></span> <span data-ttu-id="d8ba6-154">Eine bewährte Vorgehensweise besteht darin zu bestimmen, ob die vom Anbieter verfügbar gemachten Verwaltungsdaten und die API oder Anwendung, von der er abhängt, immer im System verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-154">A best practice is to determine if the management data that the provider exposes and the API or application it relies on are always available in the system or not.</span></span> <span data-ttu-id="d8ba6-155">Wenn die API oder Anwendung, auf der der Anbieter basiert, immer verfügbar ist (auf dem System ausgeführt), sollte der Anbieter ein verbundener Anbieter sein. andernfalls muss er ein entkoppelter Anbieter sein.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-155">If the API or application the provider relies on is always available (running on the system), then the provider should be a coupled provider, if not, it must be a decoupled provider.</span></span> <span data-ttu-id="d8ba6-156">Weitere Informationen zum Hosting von Modellen finden Sie unter [Anbieter Hosting und-Sicherheit](provider-hosting-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-156">For more information about hosting models, see [Provider Hosting and Security](provider-hosting-and-security.md).</span></span>

<span data-ttu-id="d8ba6-157">Weitere Informationen zum Erstellen eines gekoppelten Anbieters finden [Sie unter Bereitstellen von Daten für WMI durch Schreiben eines Anbieters](supplying-data-to-wmi-by-writing-a-provider.md). Informationen zum Einbinden eines entkoppelten Anbieters in eine Anwendung finden Sie unter [Einbinden eines Anbieters in eine Anwendung](incorporating-a-provider-in-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-157">For more information about creating a coupled provider, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md), and for information about incorporating a decoupled provider in an application, see [Incorporating a Provider in an Application](incorporating-a-provider-in-an-application.md).</span></span>

<span data-ttu-id="d8ba6-158">Gekoppelte Anbieter können als Prozess intern (in-proc) oder außerhalb des Prozesses (Out-of-Process) beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-158">Coupled providers can be described as in-process (in-proc) or out-of-process (out-of-proc).</span></span> <span data-ttu-id="d8ba6-159">Wenn ein verbundener Anbieter ein in-proc-Anbieter ist, wird er unter einem freigegebenen WMIPRVSE.EXE WMI-Hostingprozess ausgeführt und als com in-proc Server (. dll) implementiert.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-159">When a coupled provider is an in-proc provider, it runs under a shared WMIPRVSE.EXE WMI hosting process and is implemented as a COM in-proc server (.dll).</span></span> <span data-ttu-id="d8ba6-160">Wenn es sich bei einem Anbieter um einen Out-of-proc-Anbieter handelt, wird er von WMI auf Anforderung eines Clients oder Ereignisses gestartet. er wird jedoch als getrennter Prozess ausgeführt und als ausführbare Datei (. exe) implementiert.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-160">When a provider is an out-of-proc provider, it is started by WMI on request of a client or event, but it runs as a separated process and is implemented as an executable (.exe).</span></span>

## <a name="implementing-a-provider"></a><span data-ttu-id="d8ba6-161">Implementieren eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="d8ba6-161">Implementing a Provider</span></span>

<span data-ttu-id="d8ba6-162">Ein Anbieter kann auf folgende Weise implementiert werden:</span><span class="sxs-lookup"><span data-stu-id="d8ba6-162">A provider can be implemented in the following ways:</span></span>

-   <span data-ttu-id="d8ba6-163">Verwenden des ATL-Assistenten in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d8ba6-163">Using the ATL Wizard in Visual Studio.</span></span>

    <span data-ttu-id="d8ba6-164">Der ATL-Assistent generiert Anbieter Code, der einen verbundenen Anbieter implementiert.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-164">The ATL Wizard generates provider code that implements a coupled provider.</span></span> <span data-ttu-id="d8ba6-165">Während Sie den ATL-Assistenten verwenden, können Sie angeben, dass Sie ein in-proc-(. dll) oder out-of-proc-Anbieter-Lauf Zeitmodell (. exe) erstellen möchten.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-165">While using the ATL Wizard, you can specify that you want to create an in-proc (.dll) or out-of-proc (.exe) provider run-time model.</span></span>

-   <span data-ttu-id="d8ba6-166">Definieren eines COM-Objekts, das Ihren Anbieter enthalten soll.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-166">Defining a COM object to contain your provider.</span></span>

    <span data-ttu-id="d8ba6-167">Der Anbieter Code ist in C++ geschrieben.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-167">The provider code is written in C++.</span></span> <span data-ttu-id="d8ba6-168">Weitere Informationen finden Sie unter [Bereitstellen von Daten für WMI durch Schreiben eines Anbieters](supplying-data-to-wmi-by-writing-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-168">For more information, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md).</span></span>

-   <span data-ttu-id="d8ba6-169">Verwenden Sie die Klassen im [**Microsoft. Management. Infrastructure**](/previous-versions//hh872326(v=vs.85)) -Namespace in der .NET Framework, um einen Anbieter mit verwaltetem Code zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-169">Using the classes in the [**Microsoft.Management.Infrastructure**](/previous-versions//hh872326(v=vs.85)) namespace in the .NET Framework to create a provider using managed code.</span></span> <span data-ttu-id="d8ba6-170">(Der **System. Management. Instrumentation** -Namespace wird nicht mehr unterstützt.)</span><span class="sxs-lookup"><span data-stu-id="d8ba6-170">(The **System.Management.Instrumentation** namespace is no longer supported.)</span></span>

    <span data-ttu-id="d8ba6-171">Bei diesem Vorgang wird ein entkoppelter Anbieter erstellt.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-171">This process creates a decoupled provider.</span></span>

## <a name="registering-a-provider-with-wmi-and-the-system"></a><span data-ttu-id="d8ba6-172">Registrieren eines Anbieters bei WMI und dem System</span><span class="sxs-lookup"><span data-stu-id="d8ba6-172">Registering a Provider with WMI and the System</span></span>

<span data-ttu-id="d8ba6-173">Bevor der Anbieter von einem Consumer verwendet wird, ist es wichtig, ihn beim WMI-System und dem Windows com-Subsystem zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-173">Before using the provider from a consumer, it is important to register it with the WMI system and the Windows COM subsystem.</span></span>

<span data-ttu-id="d8ba6-174">Eine MOF-Datei kann mehrere Typen von Anbietern für die gleichen Klassen enthalten.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-174">A MOF file can contain multiple types of providers for the same classes.</span></span> <span data-ttu-id="d8ba6-175">Der gleiche Anbieter Name wird registriert, z. b. eine-Instanz oder ein-Methoden Anbieter.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-175">The same provider name is registered as, for example, an instance or a method provider.</span></span> <span data-ttu-id="d8ba6-176">Weitere Informationen finden Sie unter [Registrieren eines Anbieters](registering-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-176">For more information, see [Registering a Provider](registering-a-provider.md).</span></span>

## <a name="testing-a-provider"></a><span data-ttu-id="d8ba6-177">Testen eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="d8ba6-177">Testing a Provider</span></span>

<span data-ttu-id="d8ba6-178">Wenn der Anbieter Code registriert ist, ist es wichtig, den Anbieter ordnungsgemäß zu testen, indem er den Anbieter von unterschiedlichen Consumern verwendet (z. b. Skripts, verwalteten .NET-Code und C++-Consumer).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-178">When the provider code is registered, it is important to properly test the provider by using the provider from different consumers (for example, scripts, .NET managed code, and C++ consumers).</span></span>

<span data-ttu-id="d8ba6-179">Führen Sie die folgenden Aufgaben aus, um den Anbieter zu testen:</span><span class="sxs-lookup"><span data-stu-id="d8ba6-179">Perform the following tasks to test your provider:</span></span>

-   <span data-ttu-id="d8ba6-180">Stellen Sie sicher, dass der Anbieter ordnungsgemäß geladen wird, indem Sie die Ereignis Benachrichtigungen für das [**MSFT \_ WMIProvider \_ operationevent**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) nachverfolgen</span><span class="sxs-lookup"><span data-stu-id="d8ba6-180">Ensure that your provider is loading properly by tracking the [**MSFT\_WmiProvider\_OperationEvent**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) event notifications.</span></span> <span data-ttu-id="d8ba6-181">Diese Ereignisse werden Sie über etwaige Anbieter Ladefehler informieren.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-181">These events will inform you about any provider load failures.</span></span> <span data-ttu-id="d8ba6-182">Weitere Problem Behandlungs Klassen, die hilfreich sein können, sind [**Win32 \_ ProcessStartTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) und [**Win32 \_ ProcessStopTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-182">Other troubleshooting classes that may be helpful are [**Win32\_ProcessStartTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) and [**Win32\_ProcessStopTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span></span> <span data-ttu-id="d8ba6-183">Weitere Informationen zur Problembehandlung bei Anbietern finden Sie unter [Debuggen von Anbietern](debugging-providers.md) und [Anbieter Konfiguration und Problem](provider-configuration-and-troubleshooting-classes.md)Behandlung von Klassen.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-183">For more information about troubleshooting providers, see [Debugging Providers](debugging-providers.md) and [Provider Configuration and Troubleshooting Classes](provider-configuration-and-troubleshooting-classes.md).</span></span>
-   <span data-ttu-id="d8ba6-184">Wenn es sich bei dem Anbieter um eine Instanz oder einen Methoden Anbieter handelt, stellen Sie sicher, dass Sie jede Anbieter Funktion nacheinander testen, um Verwirrung in der folgenden Code Logik zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-184">If the provider is an instance or method provider, ensure you test each provider capability one-by-one to avoid confusion in following your code logic.</span></span>
-   <span data-ttu-id="d8ba6-185">Erstellen Sie für einen Instanzanbieter eine Client Anwendung oder ein Skript, das jede Schnittstelle des Anbieters aufruft (Enumeration, Get, Put und DELETE).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-185">For an instance provider, create a client application or script that invokes every interface of the provider (enumeration, get, put, and delete).</span></span> <span data-ttu-id="d8ba6-186">Auch wenn der Anbieter nichts implementieren soll, sollte er eine Meldung "nicht unterstützt" zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-186">Even if the provider is not supposed to implement anything, it should return a "not supported" message.</span></span> <span data-ttu-id="d8ba6-187">Sie finden die Rückgabewerte, die bereits in [WMI-Rückgabe Codes](wmi-return-codes.md)definiert sind.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-187">You can find the return values already defined in [WMI Return Codes](wmi-return-codes.md).</span></span>
-   <span data-ttu-id="d8ba6-188">Um sicherzustellen, dass der gewünschte Sicherheitskontext wie geplant funktioniert, rufen Sie die vom Anbieter unterstützten Vorgänge aus einem Sicherheitskontext ohne Administratorrechte auf.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-188">To ensure that the desired security context is working as planned, invoke the provider supported operations from a nonadministrator security context.</span></span> <span data-ttu-id="d8ba6-189">Der Anbieter muss Identitätswechsel unterstützen.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-189">The provider must support impersonation.</span></span> <span data-ttu-id="d8ba6-190">Wenn ein Benutzer, der über die richtigen Sicherheits Anmelde Informationen verfügt, versucht, Daten zu aktualisieren oder einen Vorgang auszuführen, der eine Methode ausführt, sollte der Anbieter den Zugriff mit der entsprechenden Fehlermeldung verweigern.</span><span class="sxs-lookup"><span data-stu-id="d8ba6-190">If a user lacking the correct security credentials tries to update data or perform an operation that executes a method, your provider should deny access with the appropriate error message.</span></span>
-   <span data-ttu-id="d8ba6-191">Weitere Informationen zur Anbieter Sicherheit finden Sie unter [Sichern Ihres Anbieters](securing-your-provider.md).</span><span class="sxs-lookup"><span data-stu-id="d8ba6-191">For more information about provider security, see [Securing Your Provider](securing-your-provider.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d8ba6-192">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="d8ba6-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d8ba6-193">Entwickeln eines WMI-Anbieters</span><span class="sxs-lookup"><span data-stu-id="d8ba6-193">Developing a WMI Provider</span></span>](developing-a-wmi-provider.md)
</dt> <dt>

[<span data-ttu-id="d8ba6-194">Anbieter Hosting und-Sicherheit</span><span class="sxs-lookup"><span data-stu-id="d8ba6-194">Provider Hosting and Security</span></span>](provider-hosting-and-security.md)
</dt> <dt>

[<span data-ttu-id="d8ba6-195">Bereitstellen von Daten für WMI durch Schreiben eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="d8ba6-195">Supplying Data to WMI by Writing a Provider</span></span>](supplying-data-to-wmi-by-writing-a-provider.md)
</dt> <dt>

[<span data-ttu-id="d8ba6-196">Einbinden eines Anbieters in eine Anwendung</span><span class="sxs-lookup"><span data-stu-id="d8ba6-196">Incorporating a Provider in an Application</span></span>](incorporating-a-provider-in-an-application.md)
</dt> <dt>

[<span data-ttu-id="d8ba6-197">Registrieren eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="d8ba6-197">Registering a Provider</span></span>](registering-a-provider.md)
</dt> <dt>

[<span data-ttu-id="d8ba6-198">Problembehandlung bei WMI-Client Anwendungen</span><span class="sxs-lookup"><span data-stu-id="d8ba6-198">Troubleshooting WMI Client Applications</span></span>](troubleshooting-wmi-client-applications.md)
</dt> <dt>

[<span data-ttu-id="d8ba6-199">Sichern Ihres Anbieters</span><span class="sxs-lookup"><span data-stu-id="d8ba6-199">Securing Your Provider</span></span>](securing-your-provider.md)
</dt> <dt>

[<span data-ttu-id="d8ba6-200">Erhalten und Bereitstellen von Daten auf einer 64-Bit-Plattform</span><span class="sxs-lookup"><span data-stu-id="d8ba6-200">Getting and Providing Data on a 64-bit Platform</span></span>](getting-and-providing-data-on-a-64-bit-computer.md)
</dt> </dl>

 

 
