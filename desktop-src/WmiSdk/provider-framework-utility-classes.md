---
description: WMI-C++ Klassen, die Teil des WMI-Anbieter-Frameworks sind, werden nicht mehr zur Verwendung empfohlen.
ms.assetid: d2414a72-3435-4035-bcd9-b3ec87f5709c
ms.tgt_platform: multiple
title: Anbieter Framework-Hilfsprogrammklassen
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cab09c99fe2597cacd81e55a4ed18bd4e286ff16
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106352741"
---
# <a name="provider-framework-utility-classes"></a><span data-ttu-id="d3476-103">Anbieter Framework-Hilfsprogrammklassen</span><span class="sxs-lookup"><span data-stu-id="d3476-103">Provider Framework Utility Classes</span></span>

<span data-ttu-id="d3476-104">\[WMI-C++-Klassen, die Teil des WMI-Anbieter-Frameworks sind und nun im Endzustand berücksichtigt werden, und keine weiteren Entwicklungen, Verbesserungen oder Updates sind für nicht sicherheitsrelevante Probleme verfügbar, die diese Bibliotheken betreffen.</span><span class="sxs-lookup"><span data-stu-id="d3476-104">\[WMI C++ classes that are part of the WMI Provider Framework which is now considered in final state, and no further development, enhancements, or updates will be available for non-security related issues affecting these libraries.</span></span> <span data-ttu-id="d3476-105">Die [Mi-APIs](/previous-versions/windows/desktop/wmi_v2/windows-management-infrastructure) sollten für alle neuen Entwicklungen verwendet werden.\]</span><span class="sxs-lookup"><span data-stu-id="d3476-105">The [MI APIs](/previous-versions/windows/desktop/wmi_v2/windows-management-infrastructure) should be used for all new development.\]</span></span>

<span data-ttu-id="d3476-106">Die Anbieter Framework-Bibliotheken Framedyd.dll (Debugversion) und Framedyn.dll (Releaseversion) implementieren mehrere Anbieter-Hilfsklassen.</span><span class="sxs-lookup"><span data-stu-id="d3476-106">The provider framework libraries Framedyd.dll (debug version) and Framedyn.dll (release version) implement several provider helper classes.</span></span> <span data-ttu-id="d3476-107">Einige Funktionen in Framedyn.dll wurden aus den Header Dateien entfernt.</span><span class="sxs-lookup"><span data-stu-id="d3476-107">Some functions in Framedyn.dll have been removed from the header files.</span></span> <span data-ttu-id="d3476-108">Um diese Funktionen weiterhin zu verwenden, fügen Sie `#define FRAMEWORK_ALLOW_DEPRECATED` Ihrem Code hinzu, bevor Sie fwcommon. h einschließen.</span><span class="sxs-lookup"><span data-stu-id="d3476-108">To continue to use these functions, add `#define FRAMEWORK_ALLOW_DEPRECATED` to your code before including Fwcommon.h.</span></span>

<span data-ttu-id="d3476-109">Sie können einzelne Anbieter entladen, die nicht mehr benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="d3476-109">You can unload individual providers that are no longer required.</span></span>

<span data-ttu-id="d3476-110">Um diese Funktion verwenden zu können, müssen Sie die drei folgenden Änderungen am Anbieter in "maindll. cpp" vornehmen:</span><span class="sxs-lookup"><span data-stu-id="d3476-110">To use this capability, you must make the three following changes to your provider in MainDll.cpp:</span></span>

-   <span data-ttu-id="d3476-111">In der **DllMain** -Funktion, in der Sie [**cwbemproviderglue:: frameworklogindll**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogindll(lpcwstr_plong))aufrufen, müssen Sie einen zweiten Parameter hinzufügen, der ein Zeiger auf einen Long-Wert ist.</span><span class="sxs-lookup"><span data-stu-id="d3476-111">In the function **DllMain** where you call [**CWbemProviderGlue::FrameworkLoginDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogindll(lpcwstr_plong)), you must add a second parameter which is a pointer to a long.</span></span>
-   <span data-ttu-id="d3476-112">In der **DllCanUnloadNow** -Funktion, in der Sie [**cwbemproviderglue:: frameworklogoffdll**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogoffdll(lpcwstr_plong))aufrufen, müssen Sie einen zweiten Parameter hinzufügen, der ein Zeiger auf einen Long-Wert ist.</span><span class="sxs-lookup"><span data-stu-id="d3476-112">In the function **DllCanUnloadNow** where you call [**CWbemProviderGlue::FrameworkLogoffDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogoffdll(lpcwstr_plong)), you must add a second parameter which is a pointer to a long.</span></span>
-   <span data-ttu-id="d3476-113">In der **DllGetClassObject** -Funktion, in der Sie eine Instanz von **cwbemgluefactory** erstellen, müssen Sie einen Parameter hinzufügen, der ein Zeiger auf einen Long-Wert ist.</span><span class="sxs-lookup"><span data-stu-id="d3476-113">In the function **DllGetClassObject** where you create an instance of **CWbemGlueFactory**, you must add a parameter which is a pointer to a long.</span></span>

<span data-ttu-id="d3476-114">In allen drei Fällen muss der Zeiger auf einen Long-Zeiger gleich sein.</span><span class="sxs-lookup"><span data-stu-id="d3476-114">In all three cases, the pointer to a long must be the same pointer.</span></span>

> [!Note]  
> <span data-ttu-id="d3476-115">In "maindll. cpp" müssen die Routinen **DllGetClassObject**, **DllCanUnloadNow**, **DllRegisterServer**, **DllUnregisterServer** und **DllMain** in einem try/catch-Block eingeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="d3476-115">In Maindll.cpp, **DllGetClassObject**, **DllCanUnloadNow**, **DllRegisterServer**, **DllUnregisterServer** and **DllMain** routines must be wrapped in a try/catch block.</span></span>

 

> [!Caution]  
> <span data-ttu-id="d3476-116">Anbieter-Debugbuilds sind für Framedyd.dll mit "framedyd. lib" verknüpft.</span><span class="sxs-lookup"><span data-stu-id="d3476-116">Provider debug builds link with Framedyd.lib for Framedyd.dll.</span></span> <span data-ttu-id="d3476-117">Framedyd.dll befindet sich im bin-Verzeichnis von Microsoft Windows Software Development Kit (SDK) \\ , das nicht im Systempfad enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="d3476-117">Framedyd.dll is in the Microsoft Windows Software Development Kit (SDK) \\bin directory which is not included in the system path.</span></span> <span data-ttu-id="d3476-118">Wenn ein Debugbuild eines Anbieters mit dem Windows-Verwaltungsdienst getestet wird, kann der frameworkanbieter nicht geladen werden, da Framedyd.dll oder eine seiner Abhängigkeiten nicht gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="d3476-118">When a debug build of a provider is tested with the Windows Management service, the framework provider will fail to load because Framedyd.dll or one of its dependencies will not be located.</span></span> <span data-ttu-id="d3476-119">Daher müssen Sie entweder Framedyd.dll aus dem Verzeichnis "Windows SDK \\ bin" in das \\ Verzeichnis "System32 \\ WBEM" Kopieren oder das Windows SDK \\ bin-Verzeichnis dem System Suchpfad hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d3476-119">Therefore, you must either copy Framedyd.dll from the Windows SDK \\bin directory to the \\system32\\wbem directory or add the Windows SDK \\bin directory to the system search path.</span></span>

 

<span data-ttu-id="d3476-120">In der folgenden Tabelle sind die Anbieter Framework-Dienstprogramm Klassen aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="d3476-120">The following table lists the provider framework utility classes.</span></span>



| <span data-ttu-id="d3476-121">Utility-Klasse</span><span class="sxs-lookup"><span data-stu-id="d3476-121">Utility class</span></span>                                          | <span data-ttu-id="d3476-122">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="d3476-122">Description</span></span>                                                                                                                     |
|--------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d3476-123">**Zeichenfolge**</span><span class="sxs-lookup"><span data-stu-id="d3476-123">**CHString**</span></span>](chstring.md)                           | <span data-ttu-id="d3476-124">Stellt Zeichen folgen Vergleichs-und Bearbeitungsfunktionen für WMI bereit.</span><span class="sxs-lookup"><span data-stu-id="d3476-124">Provides string comparison and manipulation functions for WMI.</span></span>                                                                  |
| [<span data-ttu-id="d3476-125">**Chstringarray**</span><span class="sxs-lookup"><span data-stu-id="d3476-125">**CHStringArray**</span></span>](/windows/desktop/api/ChStrArr/nl-chstrarr-chstringarray)                 | <span data-ttu-id="d3476-126">Enthält zum Erstellen und Bearbeiten von Zeichen folgen Arrays.</span><span class="sxs-lookup"><span data-stu-id="d3476-126">Contains for creating and manipulating arrays of CHString.</span></span>                                                                      |
| [<span data-ttu-id="d3476-127">**Treberpointercollection**</span><span class="sxs-lookup"><span data-stu-id="d3476-127">**TRefPointerCollection**</span></span>](/windows/desktop/api/RefPtrCo/nl-refptrco-trefpointercollection) | <span data-ttu-id="d3476-128">Gewährt den Zugriff auf eine Container Klasse für Zeiger.</span><span class="sxs-lookup"><span data-stu-id="d3476-128">Grants access to a container class for pointers.</span></span>                                                                                |
| [<span data-ttu-id="d3476-129">**Wbemtime**</span><span class="sxs-lookup"><span data-stu-id="d3476-129">**WBEMTime**</span></span>](wbemtime.md)                           | <span data-ttu-id="d3476-130">Ermöglicht Konvertierungen zwischen verschiedenen Windows-und ANSI C-Lauf Zeitformaten.</span><span class="sxs-lookup"><span data-stu-id="d3476-130">Facilitates conversions between various Windows and ANSI C run-time time formats.</span></span>                                               |
| [<span data-ttu-id="d3476-131">**Wbemtimespan**</span><span class="sxs-lookup"><span data-stu-id="d3476-131">**WBEMTimeSpan**</span></span>](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan)                   | <span data-ttu-id="d3476-132">Enthält Hilfsfunktionen, die verwendet werden, um den Zeitspannen Unterschied zwischen zwei [**wbemtime**](wbemtime.md) -Objekten zu berechnen und zu speichern.</span><span class="sxs-lookup"><span data-stu-id="d3476-132">Contains helper functions used to calculate and hold the time span difference between two [**WBEMTime**](wbemtime.md) objects.</span></span> |



 

> [!Note]  
> <span data-ttu-id="d3476-133">Die Klassen " [**chstring**](chstring.md) " und " [**chstringarray**](/windows/desktop/api/ChStrArr/nl-chstrarr-chstringarray) " ähneln den Microsoft Foundation Classes (MFC) " **CString** " und " **cstringarray**".</span><span class="sxs-lookup"><span data-stu-id="d3476-133">The [**CHString**](chstring.md) and [**CHStringArray**](/windows/desktop/api/ChStrArr/nl-chstrarr-chstringarray) classes are similar to the Microsoft Foundation Classes (MFC) **CString** and **CStringArray**.</span></span> <span data-ttu-id="d3476-134">Die WMI-Versionen sind vorhanden, damit Entwickler auf Zeichen folgen Manipulation und Vergleichsmethoden zugreifen können, ohne auf MFC zugreifen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="d3476-134">The WMI versions exist so that developers can access to string manipulation and comparison methods without having to access MFC.</span></span> <span data-ttu-id="d3476-135">Die Klassen [**wbemtime**](wbemtime.md) und [**wbemtimespan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) ähneln auch den Klassen MFC **ctime** und **CTimeSpan** .</span><span class="sxs-lookup"><span data-stu-id="d3476-135">The [**WBEMTime**](wbemtime.md) and [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) classes are also similar to the MFC **CTime** and **CTimeSpan** classes.</span></span> <span data-ttu-id="d3476-136">Die WMI-Versionen können Zeit bis zur Nanosekunden-Genauigkeit speichern und können auch in und aus **BSTR** konvertieren.</span><span class="sxs-lookup"><span data-stu-id="d3476-136">The WMI versions are capable of storing time to nanosecond accuracy, and can also convert to and from **BSTR**.</span></span> <span data-ttu-id="d3476-137">Weitere Informationen zu den Klassen CString, cstringarray, ctime und CTimeSpan finden Sie in der [Microsoft Foundation Classes](https://msdn.microsoft.com/library/d06h2x6e(VS.71).aspx) auf MSDN.</span><span class="sxs-lookup"><span data-stu-id="d3476-137">For more information about the CString, CStringArray, CTime, and CTimeSpan classes, see the [Microsoft Foundation Classes](https://msdn.microsoft.com/library/d06h2x6e(VS.71).aspx) on MSDN.</span></span>

 

<span data-ttu-id="d3476-138">Von [**wbemtime**](wbemtime.md) -Methoden zurückgegebene **BSTR** -Werte weisen das [Datums-und Uhrzeit Format](date-and-time-format.md)auf: "YYYYMMDDHHMMSS. mmmmmmsUUU"</span><span class="sxs-lookup"><span data-stu-id="d3476-138">**BSTR** values returned by [**WBEMTime**](wbemtime.md) methods are in [Date and Time Format](date-and-time-format.md): "yyyymmddHHMMSS.mmmmmmsUUU"</span></span>

<span data-ttu-id="d3476-139">Von [**wbemtimespan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) -Methoden zurückgegebene **BSTR** -Werte liegen im [Intervall Format](interval-format.md)vor: "ddddddddhhmmss. mmmmmm: 000"</span><span class="sxs-lookup"><span data-stu-id="d3476-139">**BSTR** values returned by [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) methods are in [Interval Format](interval-format.md): "ddddddddHHMMSS.mmmmmm:000"</span></span>

<span data-ttu-id="d3476-140">Obwohl Zeiten und Zeitspannen intern als Nanosekunden gespeichert werden, werden Sie nicht notwendigerweise mit der Nanosekunden-Genauigkeit gespeichert.</span><span class="sxs-lookup"><span data-stu-id="d3476-140">Although times and time spans are stored internally as nanoseconds, they are not necessarily stored with nanosecond accuracy.</span></span> <span data-ttu-id="d3476-141">Dies liegt daran, dass [**wbemtime**](wbemtime.md) -Objekte mit Zeitformaten erstellt werden können, die auf eine Sekunde (**struct tm** und **time \_ t**) zutreffen.</span><span class="sxs-lookup"><span data-stu-id="d3476-141">This is because [**WBEMTime**](wbemtime.md) objects can be constructed using time formats that are accurate to a second (**struct tm**, and **time\_t**).</span></span> <span data-ttu-id="d3476-142">Durch das Hinzufügen künstlicher Dezimalstellen wird die Genauigkeit nicht erhöht.</span><span class="sxs-lookup"><span data-stu-id="d3476-142">Adding artificial decimal places does not increase the accuracy.</span></span>

 

 
