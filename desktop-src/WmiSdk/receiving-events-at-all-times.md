---
description: Möglicherweise möchten Sie eine Anwendung schreiben, die jederzeit auf Ereignisse reagieren kann.
ms.assetid: 475dca47-b1e5-4362-ab00-9ab9383e92f9
ms.tgt_platform: multiple
title: Empfangen von Ereignissen zu allen Zeitpunkten
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5559068e1e108c6f4185c31f8858a9e4169c50c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104344729"
---
# <a name="receiving-events-at-all-times"></a><span data-ttu-id="1e600-103">Empfangen von Ereignissen zu allen Zeitpunkten</span><span class="sxs-lookup"><span data-stu-id="1e600-103">Receiving Events at All Times</span></span>

<span data-ttu-id="1e600-104">Möglicherweise möchten Sie eine Anwendung schreiben, die jederzeit auf Ereignisse reagieren kann.</span><span class="sxs-lookup"><span data-stu-id="1e600-104">You may want to write an application that can react to events at any time.</span></span> <span data-ttu-id="1e600-105">Ein Administrator möchte z. b. eine e-Mail-Nachricht erhalten, wenn bestimmte leistungsmaßnahmen auf Netzwerkservern abgelehnt werden.</span><span class="sxs-lookup"><span data-stu-id="1e600-105">For example, an administrator may want to receive an email message when specific performance measures decline on network servers.</span></span> <span data-ttu-id="1e600-106">In diesem Fall sollte die Anwendung jederzeit ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="1e600-106">In this case, your application should run at all times.</span></span> <span data-ttu-id="1e600-107">Die kontinuierliche Ausführung einer Anwendung ist jedoch keine effiziente Verwendung von Systemressourcen.</span><span class="sxs-lookup"><span data-stu-id="1e600-107">However, running an application continuously is not an efficient use of system resources.</span></span> <span data-ttu-id="1e600-108">Stattdessen können Sie mit WMI einen permanenten Ereignisconsumer erstellen.</span><span class="sxs-lookup"><span data-stu-id="1e600-108">Instead, WMI allows you to create a permanent event consumer.</span></span> <span data-ttu-id="1e600-109">Permanente Ereignisconsumer müssen besondere Sicherheitsanforderungen erfüllen.</span><span class="sxs-lookup"><span data-stu-id="1e600-109">Permanent event consumers must meet special security requirements.</span></span> <span data-ttu-id="1e600-110">Weitere Informationen finden Sie unter [Sichern von WMI-Ereignissen](securing-wmi-events.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-110">For more information, see [Securing WMI Events](securing-wmi-events.md).</span></span>

<span data-ttu-id="1e600-111">Ein dauerhafter Ereignisconsumer empfängt Ereignisse, bis die Registrierung explizit abgebrochen wird.</span><span class="sxs-lookup"><span data-stu-id="1e600-111">A permanent event consumer receives events until its registration is explicitly canceled.</span></span>

<span data-ttu-id="1e600-112">Bei einem permanenten Ereignisconsumer handelt es sich um eine Kombination der folgenden WMI-Klassen, Filter und COM-Objekte, die sich auf Ihrem System befinden:</span><span class="sxs-lookup"><span data-stu-id="1e600-112">A permanent event consumer is a combination of the following WMI classes, filters, and COM objects that reside on your system:</span></span>

-   <span data-ttu-id="1e600-113">Ein COM-Objekt, das als physischer Consumer bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="1e600-113">A COM object called a physical consumer.</span></span> <span data-ttu-id="1e600-114">WMI bietet mehrere permanente Standard Consumer.</span><span class="sxs-lookup"><span data-stu-id="1e600-114">WMI supplies several standard permanent consumers.</span></span> <span data-ttu-id="1e600-115">Beispielsweise führt der Consumer des aktiven Skript Ereignisses [ein Skript aus, wenn ein Ereignis auftritt](running-a-script-based-on-an-event.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-115">For example, the Active Script Event consumer [runs a script when an event occurs](running-a-script-based-on-an-event.md).</span></span>
-   <span data-ttu-id="1e600-116">Eine neue permanente Consumerklasse.</span><span class="sxs-lookup"><span data-stu-id="1e600-116">A new permanent consumer class.</span></span>
-   <span data-ttu-id="1e600-117">Eine Instanz der permanenten Consumerklasse, die als logischer Consumer bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="1e600-117">An instance of the permanent consumer class called a logical consumer.</span></span>
-   <span data-ttu-id="1e600-118">Ein Filter, der die Abfrage für Ereignisse enthält.</span><span class="sxs-lookup"><span data-stu-id="1e600-118">A filter that contains the query for events.</span></span>
-   <span data-ttu-id="1e600-119">Eine Verknüpfung zwischen dem Consumer und dem Filter.</span><span class="sxs-lookup"><span data-stu-id="1e600-119">A linkage between the consumer and the filter.</span></span>

<span data-ttu-id="1e600-120">Die Eigenschaften eines logischen Ereignisconsumers geben die Aktionen an, die durchgeführt werden sollen, wenn ein Ereignis benachrichtigt wird, aber Sie definieren nicht die Ereignis Abfragen, denen Sie zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="1e600-120">The properties of a logical event consumer specify the actions to perform when notified of an event, but do not define the event queries with which they are associated.</span></span> <span data-ttu-id="1e600-121">Beim signalisieren lädt WMI das COM-Objekt, das den permanenten Ereignisconsumer darstellt, automatisch in den aktiven Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="1e600-121">When signaled, WMI automatically loads the COM object that represents the permanent event consumer into active memory.</span></span> <span data-ttu-id="1e600-122">Dies erfolgt in der Regel während des Starts oder als Reaktion auf ein auslösendes Ereignis.</span><span class="sxs-lookup"><span data-stu-id="1e600-122">Typically, this occurs during startup or in response to a triggering event.</span></span> <span data-ttu-id="1e600-123">Nach der Aktivierung fungiert der Consumer des permanenten Ereignisses als normaler Ereignisconsumer, bleibt aber bestehen, bis er vom Betriebssystem explizit entladen wurde.</span><span class="sxs-lookup"><span data-stu-id="1e600-123">After being activated, the permanent event consumer acts as a normal event consumer, but remains until specifically unloaded by the operating system.</span></span>

<span data-ttu-id="1e600-124">Sie können einen eigenen permanenten Ereignisconsumer schreiben oder die vorinstallierten [Standard Consumerklassen](standard-consumer-classes.md)von WMI verwenden, z. b. [**activescripteventconsumer**](activescripteventconsumer.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-124">You can write your own permanent event consumer or use the WMI preinstalled [Standard Consumer Classes](standard-consumer-classes.md), such as [**ActiveScriptEventConsumer**](activescripteventconsumer.md).</span></span> <span data-ttu-id="1e600-125">Weitere Informationen finden Sie unter [Standard Consumer-Klassen](standard-consumer-classes.md), über [wachen und reagieren auf Ereignisse mit Standardconsumern](monitoring-and-responding-to-events-with-standard-consumers.md)und über [Wachen von Ereignissen](monitoring-events.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-125">For more information, see [Standard Consumer Classes](standard-consumer-classes.md), [Monitoring and Responding to Events with Standard Consumers](monitoring-and-responding-to-events-with-standard-consumers.md), and [Monitoring Events](monitoring-events.md).</span></span>

<span data-ttu-id="1e600-126">Im folgenden Verfahren wird beschrieben, wie Sie einen eigenen permanenten Ereignisconsumer erstellen.</span><span class="sxs-lookup"><span data-stu-id="1e600-126">The following procedure describes how to create your own permanent event consumer.</span></span>

<span data-ttu-id="1e600-127">**So erstellen Sie einen eigenen permanenten Ereignisconsumer**</span><span class="sxs-lookup"><span data-stu-id="1e600-127">**To create your own permanent event consumer**</span></span>

1.  <span data-ttu-id="1e600-128">Bestimmen Sie, welche Art von Ereignissen Sie empfangen möchten.</span><span class="sxs-lookup"><span data-stu-id="1e600-128">Determine what kind of events you want to receive.</span></span>

    <span data-ttu-id="1e600-129">WMI unterstützt systeminterne und extrinsische Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="1e600-129">WMI supports intrinsic and extrinsic events.</span></span> <span data-ttu-id="1e600-130">Ein System internes Ereignis ist ein von WMI vordefiniertes Ereignis, wohingegen ein extrinsisches Ereignis ein Ereignis ist, das von einem Drittanbieter definiert wird.</span><span class="sxs-lookup"><span data-stu-id="1e600-130">An intrinsic event is an event predefined by WMI, whereas an extrinsic event is an event defined by a third party provider.</span></span> <span data-ttu-id="1e600-131">Weitere Informationen finden Sie unter [bestimmen des empfangenden Ereignis Typs](determining-the-type-of-event-to-receive.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-131">For more information, see [Determining the Type of Event to Receive](determining-the-type-of-event-to-receive.md).</span></span>

2.  <span data-ttu-id="1e600-132">[Implementieren Sie einen physischen Consumer](implementing-a-physical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-132">[Implement a physical consumer](implementing-a-physical-consumer.md).</span></span>

    <span data-ttu-id="1e600-133">Der Hauptunterschied zwischen einer Verwaltungs Anwendung und einem [*physischen Consumer*](gloss-p.md) besteht darin, dass ein Benutzer eine Verwaltungs Anwendung lädt und entlädt, während WMI einen physischen Consumer lädt und entlädt.</span><span class="sxs-lookup"><span data-stu-id="1e600-133">The main difference between a management application and a [*physical consumer*](gloss-p.md) is that a user loads and unloads a management application, whereas WMI loads and unloads a physical consumer.</span></span> <span data-ttu-id="1e600-134">Der größte Teil ihrer Codierung sollte dem physischen Consumer unterliegen.</span><span class="sxs-lookup"><span data-stu-id="1e600-134">Most of your coding should be in the physical consumer.</span></span>

    > [!Note]  
    > <span data-ttu-id="1e600-135">Dieser Schritt ist das erste Verfahren, um die Erläuterung zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="1e600-135">This step is first in the procedure for ease of explanation.</span></span> <span data-ttu-id="1e600-136">Im Hinblick auf die Codierung sollten Sie tatsächlich den physischen Consumer zuletzt erstellen.</span><span class="sxs-lookup"><span data-stu-id="1e600-136">In terms of coding, you should actually create the physical consumer last.</span></span> <span data-ttu-id="1e600-137">Auf diese Weise können Sie Ihre Parameter und ihre Logik für ihren permanenten Ereignis Anbieter anordnen, bevor Sie lange codieren.</span><span class="sxs-lookup"><span data-stu-id="1e600-137">That way you can lay out your parameters and logic for your permanent event provider before you start lengthy coding.</span></span> <span data-ttu-id="1e600-138">Es gibt jedoch keine Einschränkung bei der ersten Erstellung des physischen Consumers.</span><span class="sxs-lookup"><span data-stu-id="1e600-138">However, there is no restriction against writing the physical consumer first.</span></span>

     

3.  <span data-ttu-id="1e600-139">[Erstellen Sie eine neue Consumerklasse, in der der physische Consumer beschrieben](creating-a-new-permanent-event-consumer-class.md)wird.</span><span class="sxs-lookup"><span data-stu-id="1e600-139">[Create a new consumer class describing the physical consumer](creating-a-new-permanent-event-consumer-class.md).</span></span>

    <span data-ttu-id="1e600-140">Wie jede beliebige Klasse beschreibt die Consumerklasse die allgemeinen Parameter eines permanenten Ereignisconsumers für WMI.</span><span class="sxs-lookup"><span data-stu-id="1e600-140">Like any class, the consumer class describes the general parameters of a permanent event consumer to WMI.</span></span>

4.  <span data-ttu-id="1e600-141">[Erstellen Sie eine Instanz der Consumer-Klasse](creating-a-logical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-141">[Create an instance of the consumer class](creating-a-logical-consumer.md).</span></span>

    <span data-ttu-id="1e600-142">Wie jede andere WMI-Klasse müssen Sie eine Instanz der Consumer-Klasse erstellen, wenn Sie die-Klasse implementieren möchten.</span><span class="sxs-lookup"><span data-stu-id="1e600-142">Like any other WMI class, you must create an instance of the consumer class if you want to implement the class.</span></span> <span data-ttu-id="1e600-143">Eine Instanz einer Consumerklasse wird auch als [*logischer Consumer*](gloss-l.md)bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="1e600-143">An instance of a consumer class is also known as a [*logical consumer*](gloss-l.md).</span></span> <span data-ttu-id="1e600-144">Der logische Consumer stellt den physischen Consumer von WMI dar.</span><span class="sxs-lookup"><span data-stu-id="1e600-144">The logical consumer represents the physical consumer to WMI.</span></span>

5.  <span data-ttu-id="1e600-145">[Erstellen Sie einen Ereignis Filter](creating-an-event-filter.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-145">[Create an event filter](creating-an-event-filter.md).</span></span>

    <span data-ttu-id="1e600-146">Die Ereignis Abfragen, die permanente Ereignisconsumer aktivieren, werden als [*Ereignis Filter*](gloss-e.md)bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="1e600-146">The event queries that activate permanent event consumers are called [*event filters*](gloss-e.md).</span></span> <span data-ttu-id="1e600-147">Einem einzelnen Ereignis Filter können mehrere logische Ereignisconsumer zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="1e600-147">A single event filter can be associated with multiple logical event consumers.</span></span> <span data-ttu-id="1e600-148">Darüber hinaus können mehrere Ereignis Filter einem einzelnen logischen Ereignisconsumer zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="1e600-148">Furthermore, multiple event filters can be associated with a single logical event consumer.</span></span> <span data-ttu-id="1e600-149">Der Filter ist eine Instanz von [**\_ \_ EventFilter**](--eventfilter.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-149">The filter is an instance of [**\_\_EventFilter**](--eventfilter.md).</span></span>

    <span data-ttu-id="1e600-150">Ein NT-Protokoll Ereignis wird generiert, wenn die Abfrage eines permanenten Ereignis Consumers fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="1e600-150">An NT Log event is generated when a permanent event consumer's query fails.</span></span> <span data-ttu-id="1e600-151">Die Quelle des Ereignisses ist WinMgmt, die Ereignis-ID ist 10, und der Ereignistyp ist Fehler.</span><span class="sxs-lookup"><span data-stu-id="1e600-151">The event's source is WinMgmt, the event ID is 10, and the event type is Error.</span></span>

6.  <span data-ttu-id="1e600-152">[Verknüpfen Sie den Ereignis Filter mit dem logischen Consumer](binding-an-event-filter-with-a-logical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-152">[Link the event filter to the logical consumer](binding-an-event-filter-with-a-logical-consumer.md).</span></span>

    <span data-ttu-id="1e600-153">Indem Sie den Ereignis Filter mit dem logischen Consumer verknüpfen, weisen Sie WMI an, welcher Ereignis Filter zu welchem logischen Consumer gehört.</span><span class="sxs-lookup"><span data-stu-id="1e600-153">By linking the event filter to the logical consumer, you instruct WMI about which event filter belongs to which logical consumer.</span></span> <span data-ttu-id="1e600-154">Logische Ereignisconsumer und Ereignis Filter werden durch eine Association-Klasseninstanz von [**\_ \_ filtertoconsumerbinding**](--filtertoconsumerbinding.md)verknüpft.</span><span class="sxs-lookup"><span data-stu-id="1e600-154">Logical event consumers and event filters are linked by an association class instance of [**\_\_FilterToConsumerBinding**](--filtertoconsumerbinding.md).</span></span> <span data-ttu-id="1e600-155">Wenn ein Ereignis empfangen wird, das einer Ereignis Abfrage entspricht, die in einem Ereignis Filter beschrieben wird, sucht WMI den zugeordneten logischen Ereignisconsumer, indem er die Association-Klasseninstanz betrachtet.</span><span class="sxs-lookup"><span data-stu-id="1e600-155">When an event is received that matches an event query described in an event filter, WMI finds the associated logical event consumer by looking at the association class instance.</span></span> <span data-ttu-id="1e600-156">Nachdem die Consumer-Instanz des logischen Ereignisses gefunden wurde, verwendet WMI eine Instanz der [**\_ \_ eventconsumerproviderregistration**](--eventconsumerproviderregistration.md) -Klasse, um den physischen Ereignisconsumer zu suchen und auszuführen, der dieser Instanz zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="1e600-156">After the logical event consumer instance is located, WMI uses an instance of the [**\_\_EventConsumerProviderRegistration**](--eventconsumerproviderregistration.md) class to locate and run the physical event consumer associated with this instance.</span></span>

7.  <span data-ttu-id="1e600-157">[Schreiben eines Ereignisconsumeranbieters](writing-an-event-consumer-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1e600-157">[Writing an event consumer provider](writing-an-event-consumer-provider.md).</span></span>

    <span data-ttu-id="1e600-158">Der Ereignisconsumeranbieter ist ein COM-Objekt, das den physischen Consumer für WMI sucht.</span><span class="sxs-lookup"><span data-stu-id="1e600-158">The event consumer provider is a COM object that locates the physical consumer for WMI.</span></span>

 

 



