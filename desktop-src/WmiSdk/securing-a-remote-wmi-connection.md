---
description: Um mithilfe von WMI eine Verbindung mit einem Remote Computer herzustellen, stellen Sie sicher, dass die richtigen DCOM-Einstellungen und Sicherheitseinstellungen für den WMI-Namespace für die Verbindung aktiviert sind.
ms.assetid: 96ebaa9b-a062-4300-a637-8eb71cb80d1c
ms.tgt_platform: multiple
title: Sichern einer Remote-WMI-Verbindung
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df2a044e49fed5eaa27fbc246dca3306a6c29650
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104528496"
---
# <a name="securing-a-remote-wmi-connection"></a><span data-ttu-id="121d7-103">Sichern einer Remote-WMI-Verbindung</span><span class="sxs-lookup"><span data-stu-id="121d7-103">Securing a Remote WMI Connection</span></span>

<span data-ttu-id="121d7-104">Um mithilfe von WMI eine Verbindung mit einem Remote Computer herzustellen, stellen Sie sicher, dass die richtigen DCOM-Einstellungen und Sicherheitseinstellungen für den WMI-Namespace für die Verbindung aktiviert sind.</span><span class="sxs-lookup"><span data-stu-id="121d7-104">To connect to a remote computer using WMI, ensure that the correct DCOM settings and WMI namespace security settings are enabled for the connection.</span></span>

<span data-ttu-id="121d7-105">WMI verfügt über Standardeinstellungen für Identitätswechsel, Authentifizierung und Authentifizierungsdienst (NTLM oder Kerberos), die für den Bereitstellungs Zielcomputer in einer Remote Verbindung erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="121d7-105">WMI has default impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the target computer in a remote connection requires.</span></span> <span data-ttu-id="121d7-106">Auf dem lokalen Computer werden möglicherweise andere Standardwerte verwendet, die vom Zielsystem nicht akzeptiert werden.</span><span class="sxs-lookup"><span data-stu-id="121d7-106">Your local machine may use different defaults that the target system does not accept.</span></span> <span data-ttu-id="121d7-107">Sie können diese Einstellungen im Verbindungs Befehl ändern.</span><span class="sxs-lookup"><span data-stu-id="121d7-107">You can change these settings in the connection call.</span></span>

<span data-ttu-id="121d7-108">In diesem Thema werden die folgenden Abschnitte erläutert:</span><span class="sxs-lookup"><span data-stu-id="121d7-108">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="121d7-109">DCOM-Identitätswechsel-und Authentifizierungs Einstellungen für WMI</span><span class="sxs-lookup"><span data-stu-id="121d7-109">DCOM Impersonation and Authentication Settings for WMI</span></span>](#dcom-impersonation-and-authentication-settings-for-wmi)
-   [<span data-ttu-id="121d7-110">Festlegen der DCOM-Sicherheit, damit ein Benutzer Remote auf einen Computer zugreifen kann</span><span class="sxs-lookup"><span data-stu-id="121d7-110">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>](#setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely)
-   [<span data-ttu-id="121d7-111">Zulassen des Zugriffs auf einen bestimmten WMI-Namespace für Benutzer</span><span class="sxs-lookup"><span data-stu-id="121d7-111">Allowing Users Access to a Specific WMI Namespace</span></span>](#allowing-users-access-to-a-specific-wmi-namespace)
-   [<span data-ttu-id="121d7-112">Festlegen der Namespace Sicherheit, um die Datenverschlüsselung für Remote Verbindungen zu erfordern</span><span class="sxs-lookup"><span data-stu-id="121d7-112">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>](#setting-namespace-security-to-require-data-encryption-for-remote-connections)
-   [<span data-ttu-id="121d7-113">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="121d7-113">Related topics</span></span>](#related-topics)

## <a name="dcom-impersonation-and-authentication-settings-for-wmi"></a><span data-ttu-id="121d7-114">DCOM-Identitätswechsel-und Authentifizierungs Einstellungen für WMI</span><span class="sxs-lookup"><span data-stu-id="121d7-114">DCOM Impersonation and Authentication Settings for WMI</span></span>

<span data-ttu-id="121d7-115">WMI verfügt über die Standardeinstellungen für den DCOM-Identitätswechsel, die Authentifizierung und den Authentifizierungsdienst (NTLM oder Kerberos), die für ein Remote System erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="121d7-115">WMI has default DCOM impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the a remote system requires.</span></span> <span data-ttu-id="121d7-116">Ihr lokales System verwendet möglicherweise andere Standardwerte, die vom Ziel Remote System nicht akzeptiert werden.</span><span class="sxs-lookup"><span data-stu-id="121d7-116">Your local system may use different defaults that the target remote system does not accept.</span></span> <span data-ttu-id="121d7-117">Sie können diese Einstellungen im Verbindungs Befehl ändern.</span><span class="sxs-lookup"><span data-stu-id="121d7-117">You can change these settings in the connection call.</span></span> <span data-ttu-id="121d7-118">Weitere Informationen finden Sie unter [Festlegen der Prozesssicherheit für Client Anwendungen](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="121d7-118">For more information, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span> <span data-ttu-id="121d7-119">Für den Authentifizierungsdienst wird jedoch empfohlen, **RPC \_ C \_ authn \_ default** anzugeben und DCOM die Auswahl des entsprechenden Dienstanbieter für den Zielcomputer zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="121d7-119">However, for the authentication service, it is recommended that you specify **RPC\_C\_AUTHN\_DEFAULT** and allow DCOM to choose the appropriate service for the target computer.</span></span>

<span data-ttu-id="121d7-120">Sie können Einstellungen in den Parametern für die Aufrufe von [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) oder [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) in C++ angeben.</span><span class="sxs-lookup"><span data-stu-id="121d7-120">You can supply settings in parameters for the calls to [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) or [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) in C++.</span></span> <span data-ttu-id="121d7-121">In Skripts können Sie Sicherheitseinstellungen in Aufrufen von " [**Swap-Locator. ConnectServer**](swbemlocator-connectserver.md)", in einem " [**Swap Security**](swbemsecurity.md) "-Objekt oder in der Skript- [Monikerzeichenfolge](constructing-a-moniker-string.md) festlegen.</span><span class="sxs-lookup"><span data-stu-id="121d7-121">In scripts, you can establish security settings in calls to [**SWbemLocator.ConnectServer**](swbemlocator-connectserver.md), in an [**SWbemSecurity**](swbemsecurity.md) object, or in the scripting [moniker](constructing-a-moniker-string.md) string.</span></span>

<span data-ttu-id="121d7-122">Eine Liste aller C++-Identitätswechsel Konstanten finden [Sie unter Festlegen der standardmäßigen Prozess Sicherheitsstufe mithilfe von C++](setting-the-default-process-security-level-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="121d7-122">For a list of all the C++ impersonation constants, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md).</span></span> <span data-ttu-id="121d7-123">Informationen zu den Visual Basic Konstanten und Skript Zeichenfolgen für die Verwendung der monikerverbindung finden Sie unter [Festlegen der standardmäßigen Prozess Sicherheitsstufe mithilfe von VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="121d7-123">For the Visual Basic constants and scripting strings for using the moniker connection, see [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

<span data-ttu-id="121d7-124">In der folgenden Tabelle werden die Standardeinstellungen für den DCOM-Identitätswechsel, die Authentifizierung und den Authentifizierungsdienst aufgelistet, die für den Zielcomputer (Computer B) in einer Remote Verbindung erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="121d7-124">The following table lists the default DCOM impersonation, authentication, and authentication service settings required by the target computer (Computer B) in a remote connection.</span></span> <span data-ttu-id="121d7-125">Weitere Informationen finden Sie unter Sichern einer Remote-WMI-Verbindung.</span><span class="sxs-lookup"><span data-stu-id="121d7-125">For more information, see Securing a Remote WMI Connection.</span></span>



| <span data-ttu-id="121d7-126">Computer B-Betriebssystem</span><span class="sxs-lookup"><span data-stu-id="121d7-126">Computer B operating system</span></span> | <span data-ttu-id="121d7-127">Skript Zeichenfolge der Identitätswechsel Ebene</span><span class="sxs-lookup"><span data-stu-id="121d7-127">Impersonation level scripting string</span></span> | <span data-ttu-id="121d7-128">Skript Zeichenfolge auf Authentifizierungs Ebene</span><span class="sxs-lookup"><span data-stu-id="121d7-128">Authentication level scripting string</span></span> | <span data-ttu-id="121d7-129">Authentifizierungsdienst</span><span class="sxs-lookup"><span data-stu-id="121d7-129">Authentication service</span></span> |
|-----------------------------|--------------------------------------|---------------------------------------|------------------------|
| <span data-ttu-id="121d7-130">Windows Vista oder höher</span><span class="sxs-lookup"><span data-stu-id="121d7-130">Windows Vista or later</span></span>      | <span data-ttu-id="121d7-131">Impersonate</span><span class="sxs-lookup"><span data-stu-id="121d7-131">Impersonate</span></span>                          | <span data-ttu-id="121d7-132">Pkt</span><span class="sxs-lookup"><span data-stu-id="121d7-132">Pkt</span></span>                                   | <span data-ttu-id="121d7-133">Kerberos</span><span class="sxs-lookup"><span data-stu-id="121d7-133">Kerberos</span></span>               |



 

<span data-ttu-id="121d7-134">WMI-Remote Verbindungen sind von der [Benutzerkontensteuerung (UAC)](/previous-versions/aa905108(v=msdn.10)) und der [Windows-Firewall](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx)betroffen.</span><span class="sxs-lookup"><span data-stu-id="121d7-134">WMI remote connections are affected by [User Account Control (UAC)](/previous-versions/aa905108(v=msdn.10)) and [Windows Firewall](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span></span> <span data-ttu-id="121d7-135">Weitere Informationen finden Sie unter [Herstellen einer Remote Verbindung mit WMI ab Vista](connecting-to-wmi-remotely-starting-with-vista.md) und [Herstellen einer Verbindung über die Windows-Firewall](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span><span class="sxs-lookup"><span data-stu-id="121d7-135">For more information, see [Connecting to WMI Remotely Starting with Vista](connecting-to-wmi-remotely-starting-with-vista.md) and [Connecting Through Windows Firewall](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span></span>

<span data-ttu-id="121d7-136">Beachten Sie, dass das Herstellen einer Verbindung mit WMI auf dem lokalen Computer über eine Standard Authentifizierungs Ebene von **PKTPRIVACY** verfügt.</span><span class="sxs-lookup"><span data-stu-id="121d7-136">Be aware that connecting to WMI on the local computer has a default authentication level of **PktPrivacy**.</span></span>

## <a name="setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely"></a><span data-ttu-id="121d7-137">Festlegen der DCOM-Sicherheit, damit ein Benutzer Remote auf einen Computer zugreifen kann</span><span class="sxs-lookup"><span data-stu-id="121d7-137">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>

<span data-ttu-id="121d7-138">Die Sicherheit in WMI bezieht sich auf das Herstellen einer Verbindung mit einem WMI-Namespace.</span><span class="sxs-lookup"><span data-stu-id="121d7-138">Security in WMI is related to connecting to a WMI namespace.</span></span> <span data-ttu-id="121d7-139">WMI verwendet DCOM zum Verarbeiten von Remote aufrufen.</span><span class="sxs-lookup"><span data-stu-id="121d7-139">WMI uses DCOM to handle remote calls.</span></span> <span data-ttu-id="121d7-140">Ein Fehler beim Herstellen einer Verbindung mit einem Remote Computer besteht aus einem DCOM-Fehler (Fehler "DCOM-Zugriff verweigert" Decimal-2147024891 oder Hex 0x80070005).</span><span class="sxs-lookup"><span data-stu-id="121d7-140">One reason for failure to connect to a remote computer is due to a DCOM failure (error "DCOM Access Denied" decimal -2147024891 or hex 0x80070005).</span></span> <span data-ttu-id="121d7-141">Weitere Informationen zur DCOM-Sicherheit in WMI für C++-Anwendungen finden Sie unter [Festlegen der Prozesssicherheit für Client](setting-client-application-process-security.md)Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="121d7-141">For more information about DCOM security in WMI for C++ applications, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span>

<span data-ttu-id="121d7-142">Sie können DCOM-Einstellungen für WMI mithilfe des DCOM-Konfigurations Hilfsprogramms (**DCOMCnfg.exe**) konfigurieren, das Sie in der **Systemsteuerung** unter **Verwaltung** finden.</span><span class="sxs-lookup"><span data-stu-id="121d7-142">You can configure DCOM settings for WMI using the DCOM Config utility (**DCOMCnfg.exe**) found in **Administrative Tools** in **Control Panel**.</span></span> <span data-ttu-id="121d7-143">Dieses Hilfsprogramm macht die Einstellungen verfügbar, mit denen bestimmte Benutzer eine Remote Verbindung mit dem Computer über DCOM herstellen können.</span><span class="sxs-lookup"><span data-stu-id="121d7-143">This utility exposes the settings that enable certain users to connect to the computer remotely through DCOM.</span></span> <span data-ttu-id="121d7-144">Mitglieder der Gruppe "Administratoren" können standardmäßig eine Remote Verbindung mit dem Computer herstellen.</span><span class="sxs-lookup"><span data-stu-id="121d7-144">Members of the Administrators group are allowed to remotely connect to the computer by default.</span></span> <span data-ttu-id="121d7-145">Mit diesem Hilfsprogramm können Sie die Sicherheit festlegen, um den WMI-Dienst zu starten, darauf zuzugreifen und ihn zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="121d7-145">With this utility you can set the security to start, access, and configure the WMI service.</span></span>

<span data-ttu-id="121d7-146">Im folgenden Verfahren wird beschrieben, wie Sie DCOM-Remote Start-und Aktivierungs Berechtigungen für bestimmte Benutzer und Gruppen erteilen.</span><span class="sxs-lookup"><span data-stu-id="121d7-146">The following procedure describes how to grant DCOM remote startup and activation permissions for certain users and groups.</span></span> <span data-ttu-id="121d7-147">Wenn Computer a eine Remote Verbindung mit Computer b herstellt, können Sie diese Berechtigungen auf Computer b festlegen, um zuzulassen, dass ein Benutzer oder eine Gruppe, der nicht Teil der Administratoren Gruppe auf Computer b ist, DCOM-Start-und Aktivierungs Aufrufe auf Computer b ausführt.</span><span class="sxs-lookup"><span data-stu-id="121d7-147">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to execute DCOM startup and activation calls on Computer B.</span></span>

<span data-ttu-id="121d7-148">**So erteilen Sie DCOM-Remote Start-und Aktivierungs Berechtigungen für einen Benutzer oder eine Gruppe**</span><span class="sxs-lookup"><span data-stu-id="121d7-148">**To grant DCOM remote launch and activation permissions for a user or group**</span></span>

1.  <span data-ttu-id="121d7-149">Klicken Sie im **Startmenü** auf **Ausführen**, geben Sie **DCOMCNFG** ein, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="121d7-149">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="121d7-150">Erweitern Sie im Dialogfeld **Komponenten Dienste** nacheinander **Komponenten Dienste** und **Computer**, und klicken Sie dann mit der rechten Maustaste auf **Arbeitsplatz** und klicken Sie dann auf **Eigenschaften**.</span><span class="sxs-lookup"><span data-stu-id="121d7-150">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="121d7-151">Klicken Sie im Dialogfeld **Eigenschaften von Arbeitsplatz** auf die Registerkarte **com-Sicherheit** .</span><span class="sxs-lookup"><span data-stu-id="121d7-151">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="121d7-152">Klicken Sie unter **Start- und Aktivierungsberechtigungen** auf **Limits bearbeiten**.</span><span class="sxs-lookup"><span data-stu-id="121d7-152">Under **Launch and Activation Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="121d7-153">Führen Sie im Dialogfeld **Startberechtigung** die folgenden Schritte aus, wenn der Name oder die Gruppe nicht in der **Liste Gruppen oder Benutzernamen** angezeigt wird:</span><span class="sxs-lookup"><span data-stu-id="121d7-153">In the **Launch Permission** dialog box, follow these steps if your name or your group does not appear in the **Groups or user names list**:</span></span>

    1.  <span data-ttu-id="121d7-154">Klicken Sie im Dialogfeld **Startberechtigung** auf **Hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="121d7-154">In the **Launch Permission** dialog box, click **Add**.</span></span>
    2.  <span data-ttu-id="121d7-155">Fügen Sie im Dialogfeld **Benutzer, Computer oder Gruppen auswählen** im Feld **Geben Sie die zu ausgewäfnenden Objektnamen** ein den Namen und die Gruppe ein, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="121d7-155">In the **Select Users, Computers, or Groups** dialog box, add your name and the group in the **Enter the object names to select** box, and then click **OK**.</span></span>

6.  <span data-ttu-id="121d7-156">Wählen Sie im Dialogfeld **Startberechtigung** im Feld **Gruppen-oder Benutzernamen** den Benutzer und die Gruppe aus.</span><span class="sxs-lookup"><span data-stu-id="121d7-156">In the **Launch Permission** dialog box, select your user and group in the **Group or user names** box.</span></span> <span data-ttu-id="121d7-157">Wählen Sie in der Spalte **zulassen** unter **Berechtigungen für Benutzer** die Option **Remote Start** aus, und wählen Sie **Remote Aktivierung** aus, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="121d7-157">In the **Allow** column under **Permissions for User**, select **Remote Launch** and select **Remote Activation**, and then click **OK**.</span></span>

<span data-ttu-id="121d7-158">Im folgenden Verfahren wird beschrieben, wie Sie DCOM-Remote Zugriffsberechtigungen für bestimmte Benutzer und Gruppen erteilen.</span><span class="sxs-lookup"><span data-stu-id="121d7-158">The following procedure describes how to grant DCOM remote access permissions for certain users and groups.</span></span> <span data-ttu-id="121d7-159">Wenn Computer a eine Remote Verbindung mit Computer b herstellt, können Sie diese Berechtigungen auf Computer b festlegen, um zuzulassen, dass ein Benutzer oder eine Gruppe, der nicht Teil der Administratoren Gruppe auf Computer b ist, eine Verbindung mit Computer b herstellt.</span><span class="sxs-lookup"><span data-stu-id="121d7-159">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to connect to Computer B.</span></span>

<span data-ttu-id="121d7-160">**So erteilen Sie DCOM-Remote Zugriffsberechtigungen**</span><span class="sxs-lookup"><span data-stu-id="121d7-160">**To grant DCOM remote access permissions**</span></span>

1.  <span data-ttu-id="121d7-161">Klicken Sie im **Startmenü** auf **Ausführen**, geben Sie **DCOMCNFG** ein, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="121d7-161">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="121d7-162">Erweitern Sie im Dialogfeld **Komponenten Dienste** nacheinander **Komponenten Dienste** und **Computer**, und klicken Sie dann mit der rechten Maustaste auf **Arbeitsplatz** und klicken Sie dann auf **Eigenschaften**.</span><span class="sxs-lookup"><span data-stu-id="121d7-162">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="121d7-163">Klicken Sie im Dialogfeld **Eigenschaften von Arbeitsplatz** auf die Registerkarte **com-Sicherheit** .</span><span class="sxs-lookup"><span data-stu-id="121d7-163">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="121d7-164">Klicken Sie unter **Zugriffsberechtigungen** auf **Limits bearbeiten**.</span><span class="sxs-lookup"><span data-stu-id="121d7-164">Under **Access Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="121d7-165">Wählen Sie im Dialogfeld **Zugriffsberechtigung** die Option **Anonymer Anmelde** Name im Feld **Gruppen-oder Benutzernamen** aus.</span><span class="sxs-lookup"><span data-stu-id="121d7-165">In the **Access Permission** dialog box, select **ANONYMOUS LOGON** name in the **Group or user names** box.</span></span> <span data-ttu-id="121d7-166">Wählen Sie in der Spalte **zulassen** unter **Berechtigungen für Benutzer** die Option **Remote Zugriff** aus, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="121d7-166">In the **Allow** column under **Permissions for User**, select **Remote Access**, and then click **OK**.</span></span>

## <a name="allowing-users-access-to-a-specific-wmi-namespace"></a><span data-ttu-id="121d7-167">Zulassen des Zugriffs auf einen bestimmten WMI-Namespace für Benutzer</span><span class="sxs-lookup"><span data-stu-id="121d7-167">Allowing Users Access to a Specific WMI Namespace</span></span>

<span data-ttu-id="121d7-168">Sie können Benutzern den Zugriff auf einen bestimmten WMI-Namespace erlauben oder ablehnen, indem Sie im WMI-Steuerelement für einen Namespace die Berechtigung "Remote Aktivierung" festlegen.</span><span class="sxs-lookup"><span data-stu-id="121d7-168">You can allow or disallow users access to a specific WMI namespace by setting the "Remote Enable" permission in the WMI Control for a namespace.</span></span> <span data-ttu-id="121d7-169">Wenn ein Benutzer versucht, eine Verbindung mit einem Namespace herzustellen, für den er keinen Zugriff hat, erhalten Sie den Fehler 0x80041003.</span><span class="sxs-lookup"><span data-stu-id="121d7-169">If a user tries to connect to a namespace they are not allowed access to, they will receive error 0x80041003.</span></span> <span data-ttu-id="121d7-170">Diese Berechtigung ist standardmäßig nur für Administratoren aktiviert.</span><span class="sxs-lookup"><span data-stu-id="121d7-170">By default, this permission is enabled only for administrators.</span></span> <span data-ttu-id="121d7-171">Ein Administrator kann den Remote Zugriff auf bestimmte WMI-Namespaces für einen nicht Administrator Benutzer aktivieren.</span><span class="sxs-lookup"><span data-stu-id="121d7-171">An administrator can enable remote access to specific WMI namespaces for a nonadministrator user.</span></span>

<span data-ttu-id="121d7-172">Mit dem folgenden Verfahren werden Berechtigungen für Remote Aktivierung für einen Benutzer ohne Administratorrechte festgelegt.</span><span class="sxs-lookup"><span data-stu-id="121d7-172">The following procedure sets remote enable permissions for a non-administrator user.</span></span>

<span data-ttu-id="121d7-173">**So legen Sie Berechtigungen für Remote Aktivierung fest**</span><span class="sxs-lookup"><span data-stu-id="121d7-173">**To set remote enable permissions**</span></span>

1.  <span data-ttu-id="121d7-174">Stellen Sie mithilfe der WMI-Steuerung eine Verbindung mit dem Remote Computer her.</span><span class="sxs-lookup"><span data-stu-id="121d7-174">Connect to the remote computer using the WMI Control.</span></span>

    <span data-ttu-id="121d7-175">Weitere Informationen zum WMI-Steuerelement finden Sie unter [Festlegen der Namespace Sicherheit mit dem WMI-Steuer](setting-namespace-security-with-the-wmi-control.md)Element.</span><span class="sxs-lookup"><span data-stu-id="121d7-175">For more information about the WMI Control, see [Setting Namespace Security with the WMI Control](setting-namespace-security-with-the-wmi-control.md).</span></span>

2.  <span data-ttu-id="121d7-176">Wählen Sie auf der Registerkarte **Sicherheit** den Namespace aus, und klicken Sie auf **Sicherheit**.</span><span class="sxs-lookup"><span data-stu-id="121d7-176">In the **Security** tab, select the namespace and click **Security**.</span></span>
3.  <span data-ttu-id="121d7-177">Suchen Sie das entsprechende Konto, und überprüfen Sie **Remote Aktivierung** in der Liste der **Berechtigungen** .</span><span class="sxs-lookup"><span data-stu-id="121d7-177">Locate the appropriate account and check **Remote Enable** in the **Permissions** list.</span></span>

## <a name="setting-namespace-security-to-require-data-encryption-for-remote-connections"></a><span data-ttu-id="121d7-178">Festlegen der Namespace Sicherheit, um die Datenverschlüsselung für Remote Verbindungen zu erfordern</span><span class="sxs-lookup"><span data-stu-id="121d7-178">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>

<span data-ttu-id="121d7-179">Ein Administrator oder eine MOF-Datei kann einen WMI-Namespace so konfigurieren, dass keine Daten zurückgegeben werden, es sei denn, Sie verwenden den Datenschutz für den Datenschutz in einer Verbindung mit diesem Namespace in einem Skript als Moniker für die Datenschutz **\_ Ebene " \_ \_ \_ Pkt \_** " und " **PKTPRIVACY** " in einem Skript</span><span class="sxs-lookup"><span data-stu-id="121d7-179">An administrator or a MOF file can configure a WMI namespace so that no data is returned unless you use packet privacy (**RPC\_C\_AUTHN\_LEVEL\_PKT\_PRIVACY** or **PktPrivacy** as a moniker in a script) in a connection to that namespace.</span></span> <span data-ttu-id="121d7-180">Dadurch wird sichergestellt, dass die Daten beim Überschreiten des Netzwerks verschlüsselt werden.</span><span class="sxs-lookup"><span data-stu-id="121d7-180">This ensures that data is encrypted as it crosses the network.</span></span> <span data-ttu-id="121d7-181">Wenn Sie versuchen, eine niedrigere Authentifizierungs Ebene festzulegen, erhalten Sie die Meldung "Zugriff verweigert".</span><span class="sxs-lookup"><span data-stu-id="121d7-181">If you try to set a lower authentication level, you will get an access denied message.</span></span> <span data-ttu-id="121d7-182">Weitere Informationen finden Sie unter [erfordern einer verschlüsselten Verbindung mit einem Namespace](requiring-an-encrypted-connection-to-a-namespace.md).</span><span class="sxs-lookup"><span data-stu-id="121d7-182">For more information, see [Requiring an Encrypted Connection to a Namespace](requiring-an-encrypted-connection-to-a-namespace.md).</span></span>

<span data-ttu-id="121d7-183">Im folgenden VBScript-Codebeispiel wird gezeigt, wie mithilfe von "PKTPRIVACY" eine Verbindung mit einem verschlüsselten Namespace hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="121d7-183">The following VBScript code example shows how to connect to an encrypted namespace using "pktPrivacy".</span></span>


```VB
strComputer = "RemoteComputer"
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate,authenticationLevel=pktPrivacy}!\\" _
                              & strComputer & "\root\EncryptedNamespace")
```



## <a name="related-topics"></a><span data-ttu-id="121d7-184">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="121d7-184">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="121d7-185">Delegierung mit WMI</span><span class="sxs-lookup"><span data-stu-id="121d7-185">Delegating with WMI</span></span>](connecting-to-a-3rd-computer-delegation.md)
</dt> <dt>

[<span data-ttu-id="121d7-186">Erstellen von Prozessen per Remote Verbindung mit WMI</span><span class="sxs-lookup"><span data-stu-id="121d7-186">Creating Processes Remotely with WMI</span></span>](creating-processes-remotely.md)
</dt> <dt>

[<span data-ttu-id="121d7-187">Sichern von C++-Clients und-Anbietern</span><span class="sxs-lookup"><span data-stu-id="121d7-187">Securing C++ Clients and Providers</span></span>](securing-c---clients-and-providers.md)
</dt> <dt>

[<span data-ttu-id="121d7-188">Sichern von Skript Clients</span><span class="sxs-lookup"><span data-stu-id="121d7-188">Securing Scripting Clients</span></span>](securing-scripting-clients.md)
</dt> </dl>

 

 
