---
description: Zum Erstellen eines WMI-Klassen Anbieters müssen Sie die \_ \_ Win32Provider-Instanz, die den Anbieter darstellt, mithilfe einer Instanz von \_ \_ classproviderregistration registrieren.
ms.assetid: ed834969-47e9-47df-9db8-c805b2eb71da
ms.tgt_platform: multiple
title: Registrieren eines Klassen Anbieters
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7bc15893e654f96f8c4e476219389a1f8f2c464a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "103959331"
---
# <a name="registering-a-class-provider"></a><span data-ttu-id="14398-103">Registrieren eines Klassen Anbieters</span><span class="sxs-lookup"><span data-stu-id="14398-103">Registering a Class Provider</span></span>

<span data-ttu-id="14398-104">Zum Erstellen eines WMI-Klassen Anbieters müssen Sie die [**\_ \_ Win32Provider**](--win32provider.md) -Instanz, die den Anbieter darstellt, mithilfe einer Instanz von [**\_ \_ classproviderregistration**](--classproviderregistration.md)registrieren.</span><span class="sxs-lookup"><span data-stu-id="14398-104">To create a WMI class provider you must register the [**\_\_Win32Provider**](--win32provider.md) instance that represents your provider using an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span> <span data-ttu-id="14398-105">Als COM-Objekt muss sich Ihr Anbieter beim Betriebssystem und WMI registrieren.</span><span class="sxs-lookup"><span data-stu-id="14398-105">As a COM object, your provider must register with the operating system and WMI.</span></span> <span data-ttu-id="14398-106">Im folgenden Verfahren wird davon ausgegangen, dass Sie den Registrierungsprozess bereits implementiert haben, wie unter [Registrieren eines Anbieters](registering-a-provider.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="14398-106">The following procedure assumes that you have already implemented the registration process as described in [Registering a Provider](registering-a-provider.md).</span></span> <span data-ttu-id="14398-107">Wenn Ihr Anbieter die meisten Daten im WMI-Repository speichert und diese Daten nur bei der WMI-Initialisierung aktualisiert werden, registrieren Sie Ihre Klasse als Push-Klassen Anbieter.</span><span class="sxs-lookup"><span data-stu-id="14398-107">If your provider stores most data in the WMI repository and that data is updated only on WMI initialization, then register your class as a push class provider.</span></span> <span data-ttu-id="14398-108">Wenn die von Ihnen bereitgestellten Daten häufig geändert werden und dynamisch durch Ihren Code bei jeder WMI-Anforderung abgerufen werden, registrieren Sie den Anbieter als Pull-Klassen Anbieter.</span><span class="sxs-lookup"><span data-stu-id="14398-108">If the data you are providing changes frequently and is retrieved dynamically by your code on every request from WMI, then register your provider as a pull class provider.</span></span>

<span data-ttu-id="14398-109">Im folgenden Verfahren wird beschrieben, wie ein Push-Klassen Anbieter registriert wird.</span><span class="sxs-lookup"><span data-stu-id="14398-109">The following procedure describes how to register a push class provider.</span></span>

<span data-ttu-id="14398-110">**So registrieren Sie einen Push-Klassen Anbieter**</span><span class="sxs-lookup"><span data-stu-id="14398-110">**To register a push class provider**</span></span>

-   <span data-ttu-id="14398-111">Legen Sie die **interaktiontype** -Eigenschaft der [**\_ \_ classproviderregistration**](--classproviderregistration.md) -Instanz auf 1 fest.</span><span class="sxs-lookup"><span data-stu-id="14398-111">Set the **InteractionType** property of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance to 1.</span></span>

    <span data-ttu-id="14398-112">Das Erstellen einer Instanz von [**\_ \_ classproviderregistration**](--classproviderregistration.md) ist Teil des Registrierungsprozesses.</span><span class="sxs-lookup"><span data-stu-id="14398-112">Creating an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md) is part of the registration process.</span></span>

<span data-ttu-id="14398-113">Im folgenden Verfahren wird beschrieben, wie Sie einen Pull Class-Anbieter registrieren.</span><span class="sxs-lookup"><span data-stu-id="14398-113">The following procedure describes how to register a pull class provider.</span></span>

<span data-ttu-id="14398-114">**So registrieren Sie einen Pull-Klassen Anbieter**</span><span class="sxs-lookup"><span data-stu-id="14398-114">**To register a pull class provider**</span></span>

1.  <span data-ttu-id="14398-115">Erstellen Sie eine Instanz der [**\_ \_ Win32Provider**](--win32provider.md) -Klasse, die den Anbieter beschreibt.</span><span class="sxs-lookup"><span data-stu-id="14398-115">Create an instance of the [**\_\_Win32Provider**](--win32provider.md) class that describes the provider.</span></span>
2.  <span data-ttu-id="14398-116">Erstellen Sie eine Instanz der [**\_ \_ classproviderregistration**](--classproviderregistration.md) -Klasse, die den Funktions Satz des Anbieters beschreibt.</span><span class="sxs-lookup"><span data-stu-id="14398-116">Create an instance of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class that describes the feature set of the provider.</span></span>

    <span data-ttu-id="14398-117">Innerhalb der [**\_ \_ classproviderregistration**](--classproviderregistration.md) -Instanz:</span><span class="sxs-lookup"><span data-stu-id="14398-117">Within the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance:</span></span>

    1.  <span data-ttu-id="14398-118">Legen Sie die **interaktiontype** -Eigenschaft fest, um anzugeben, ob der Anbieter ein Push-oder Pull-Anbieter ist.</span><span class="sxs-lookup"><span data-stu-id="14398-118">Set the **InteractionType** property to indicate whether the provider is a push or pull provider.</span></span>
    2.  <span data-ttu-id="14398-119">Markieren Sie die Klasse mit dem [**dynamischen**](standard-wmi-qualifiers.md) und den [**Anbieter**](/windows/desktop/api/Provider/nl-provider-provider) Qualifizierern.</span><span class="sxs-lookup"><span data-stu-id="14398-119">Tag the class with both the [**Dynamic**](standard-wmi-qualifiers.md) and [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifiers.</span></span>

        <span data-ttu-id="14398-120">Der [**dynamische**](standard-wmi-qualifiers.md) Qualifizierer signalisiert, dass WMI einen Anbieter zum Abrufen der Klassen Instanzen verwenden soll.</span><span class="sxs-lookup"><span data-stu-id="14398-120">The [**Dynamic**](standard-wmi-qualifiers.md) qualifier signals that WMI should use a provider to retrieve the class instances.</span></span> <span data-ttu-id="14398-121">Der [**Anbieter Qualifizierer**](/windows/desktop/api/Provider/nl-provider-provider) gibt den Namen des Anbieters an, der von WMI verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="14398-121">The [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifier specifies the name of the provider that WMI should use.</span></span>

    3.  <span data-ttu-id="14398-122">Definieren Sie die Eigenschaften " **resultsetqueries**", " **referencedsetqueries**" und " **unsupportedqueries** ".</span><span class="sxs-lookup"><span data-stu-id="14398-122">Define the **ResultSetQueries**, **ReferencedSetQueries**, and **UnsupportedQueries** properties.</span></span>

        <span data-ttu-id="14398-123">Diese Abfrage Eigenschaften beschreiben ausführliche Informationen zur unterstützten Klasse.</span><span class="sxs-lookup"><span data-stu-id="14398-123">These query properties describe detailed information about the supported class.</span></span>

<span data-ttu-id="14398-124">Neben der Beschreibung der verschiedenen unterstützten Methoden einer Klasse verfügt auch die [**\_ \_ classproviderregistration**](--classproviderregistration.md) -Klasse über drei Eigenschaften, die eine Reihe von Abfragen beschreiben.</span><span class="sxs-lookup"><span data-stu-id="14398-124">In addition to describing the various supported methods of a class, the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class also has three properties that describe a series of queries.</span></span> <span data-ttu-id="14398-125">Bei der gemeinsamen Verwendung beschreiben diese drei Eigenschaften den gesamten vom Klassen Anbieter bereitgestellten Klassen Bereich.</span><span class="sxs-lookup"><span data-stu-id="14398-125">When used together, these three properties describe the entire range of classes supplied by the class provider.</span></span> <span data-ttu-id="14398-126">Jede Abfrage Eigenschaft enthält eine WQL SELECT-Anweisung, die als "Schema Abfrage" bezeichnet wird, um die Typen der unterstützten Klassen anzugeben.</span><span class="sxs-lookup"><span data-stu-id="14398-126">Each query property contains a WQL SELECT statement, called a "schema query," to specify the types of supported classes.</span></span> <span data-ttu-id="14398-127">Schema Abfragen geben einen speziellen Klassennamen mit dem Namen Meta \_ Class an.</span><span class="sxs-lookup"><span data-stu-id="14398-127">Schema queries specify a special class name called meta\_class.</span></span> <span data-ttu-id="14398-128">In der folgenden Tabelle sind die Abfrage Eigenschaften aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="14398-128">The following table lists the query properties.</span></span>



| <span data-ttu-id="14398-129">Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="14398-129">Property</span></span>                 | <span data-ttu-id="14398-130">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="14398-130">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="14398-131">**Resultsetqueries**</span><span class="sxs-lookup"><span data-stu-id="14398-131">**ResultSetQueries**</span></span>     | <span data-ttu-id="14398-132">Enthält Informationen über das Resultset, das der Anbieter bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="14398-132">Contains information about the result set the provider supplies.</span></span> <span data-ttu-id="14398-133">WMI verwendet die Informationen, um zu bestimmen, ob der Anbieter aufgerufen werden soll, um eine Abfrage von einer Anwendung zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="14398-133">WMI uses the information to determine whether to invoke the provider to satisfy a query from an application.</span></span> <span data-ttu-id="14398-134">Diese Eigenschaft beschreibt entweder den Satz aller Klassen, die der Anbieter bereitstellen kann, oder eine übergeordnete Gruppe der verfügbaren Klassen, aber nie eine Teilmenge.</span><span class="sxs-lookup"><span data-stu-id="14398-134">This property describes either the set of all classes that the provider can supply or a superset of the available classes, but never a subset.</span></span> <span data-ttu-id="14398-135">WMI erfordert, dass ein Anbieter mindestens eine Abfrage in dieser Eigenschaft angibt.</span><span class="sxs-lookup"><span data-stu-id="14398-135">WMI requires a provider to specify at least one query in this property.</span></span><br/> <span data-ttu-id="14398-136">Im folgenden Beispiel wird gezeigt, wie **resultsetqueries** festgelegt wird, wenn ein Anbieter eine Association-Klasse bereitstellt, die auf die [**Win32 \_ LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) -Klasse verweist.</span><span class="sxs-lookup"><span data-stu-id="14398-136">The following example shows how to set **ResultSetQueries** when a provider supplies an association class that references the [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class.</span></span><br/> `SELECT * FROM meta_class WHERE __Class = "Win32_LogicalDisk"`<br/> <span data-ttu-id="14398-137">Im folgenden Beispiel wird gezeigt, wie eine allgemeine Abfrage angegeben wird, wenn ein Anbieter Klassen bereitstellt, die auf andere unbekannte Klassen verweisen.</span><span class="sxs-lookup"><span data-stu-id="14398-137">The following example shows how to specify a general query when a provider supplies classes that reference other unknown classes.</span></span><br/> `SELECT * FROM meta_class`<br/> <span data-ttu-id="14398-138">Im folgenden Beispiel wird gezeigt, wie **resultsetqueries** festgelegt wird, wenn ein Anbieter nur Unterklassen bereitstellt, aber nicht die übergeordnete Klasse einer bestimmten Klasse.</span><span class="sxs-lookup"><span data-stu-id="14398-138">The following example shows how to set **ResultSetQueries** when a provider supplies only subclasses, but not the parent class of a given class.</span></span><br/> `SELECT * FROM meta_class WHERE __Dynasty = "MyClass"`<br/> <span data-ttu-id="14398-139">Im folgenden Beispiel wird gezeigt, wie die spezielle \_ \_ Eigenschaft dieser Eigenschaft verwendet und **resultsetqueries** festgelegt wird, wenn ein Anbieter alle Klassen und Unterklassen bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="14398-139">The following example shows how to use the special \_\_this property and set **ResultSetQueries** when a provider supplies all class and subclasses.</span></span><br/> `SELECT * FROM meta_class WHERE __this ISA "MyClass"`<br/> |
| <span data-ttu-id="14398-140">**Referencedsetqueries**</span><span class="sxs-lookup"><span data-stu-id="14398-140">**ReferencedSetQueries**</span></span> | <span data-ttu-id="14398-141">Bestimmt, ob der Anbieter in Schema Abfragen umgangen werden soll, in denen Zuordnungen und Verweise angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="14398-141">Determines whether to bypass the provider in schema queries where associations and references are being requested.</span></span> <span data-ttu-id="14398-142">Anbieter, die Zuordnungs Klassen bereitstellen können, müssen mindestens eine Abfrage in Ihre **referencedsetqueries** -Eigenschaft einschließen.</span><span class="sxs-lookup"><span data-stu-id="14398-142">Providers that can supply association classes must include at least one query in their **ReferencedSetQueries** property.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="14398-143">**Nicht supportedqueries**</span><span class="sxs-lookup"><span data-stu-id="14398-143">**UnsupportedQueries**</span></span>   | <span data-ttu-id="14398-144">Enthält Informationen über das Resultset, das ein Klassen Anbieter nicht bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="14398-144">Contains information about the result set that a class provider does not supply.</span></span> <span data-ttu-id="14398-145">WMI verwendet diese Eigenschaft, um von dem Satz von Klassen, die von **resultsetqueries** impliziert werden, zu subtrahieren.</span><span class="sxs-lookup"><span data-stu-id="14398-145">WMI uses this property to subtract from the set of classes implied by **ResultSetQueries**.</span></span> <span data-ttu-id="14398-146">Ein Klassen Anbieter kann z. b. in der **resultsetqueries** -Unterstützung für alle von MyClass abgeleiteten Klassen angeben und in **unsupportedqueries** eine fehlende Unterstützung für eine bestimmte abgeleitete Klasse angeben.</span><span class="sxs-lookup"><span data-stu-id="14398-146">For example, a class provider can specify in **ResultSetQueries** support for all classes derived from MyClass and specify in **UnsupportedQueries** a lack of support for one particular derived class.</span></span><br/> <span data-ttu-id="14398-147">Weitere Informationen, die ein Anbieter über seine Abfrage Verarbeitungsfunktionen registrieren kann, desto schneller.</span><span class="sxs-lookup"><span data-stu-id="14398-147">The more information that a provider can register about its query processing capabilities, the faster it runs.</span></span> <span data-ttu-id="14398-148">Das Eingeben einer oder mehrerer Abfragen in der **unsupportedqueries** -Eigenschaft ist eine Möglichkeit, spezifisch zu sein. Dies ist besonders wichtig, wenn ein Anbieter von einer Klasse abhängig ist, die er nicht bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="14398-148">Entering one or more queries in the **UnsupportedQueries** property is one way to be specific and is particularly important when a provider relies on a class that it does not supply.</span></span> <span data-ttu-id="14398-149">Wenn eine Anforderung für eine Klasse erfolgt, die in einer Abfrage in der **unsupportedqueries** -Eigenschaft aufgelistet ist, kann WMI die Klasse selbst bereitstellen oder einen alternativen Anbieter aufrufen, um Sie bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="14398-149">When a request is made for a class that is listed in a query in the **UnsupportedQueries** property, WMI can supply the class itself or invoke an alternate provider to supply it.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

<span data-ttu-id="14398-150">Da WMI die-oder-Klausel nicht unterstützt, müssen Sie für jede Klasse eine separate Abfrage erstellen.</span><span class="sxs-lookup"><span data-stu-id="14398-150">Because WMI does not support the OR clause, you must create a separate query for each class.</span></span>

<span data-ttu-id="14398-151">Die folgenden Abfragen werden in **resultsetqueries** angegeben, wenn ein Klassen Anbieter MyClass1, MyClass2 und MyClass3 bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="14398-151">The following queries are specified in **ResultSetQueries** when a class provider supplies MyClass1, MyClass2, and MyClass3.</span></span>


```sql
SELECT * FROM meta_class WHERE __Class = "MyClass1"
SELECT * FROM meta_class WHERE __Class = "MyClass2"
SELECT * FROM meta_class WHERE __Class = "MyClass3"
```



<span data-ttu-id="14398-152">Nur Administratoren können einen Anbieter registrieren oder löschen, indem Sie eine Instanz von [**\_ \_ Win32Provider**](--win32provider.md) und [**\_ \_ classproviderregistration**](--classproviderregistration.md)erstellen.</span><span class="sxs-lookup"><span data-stu-id="14398-152">Only administrators can register or delete a provider by creating an instance of [**\_\_Win32Provider**](--win32provider.md) and [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span>

 

