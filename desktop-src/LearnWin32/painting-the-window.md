---
title: Zeichnen des Fensters
description: Sie haben Ihr Fenster erstellt. Nun möchten Sie etwas darin anzeigen. In der Windows-Terminologie wird dies als "Zeichnen des Fensters" bezeichnet. Zum Kombinieren von Metaphern ist ein Fenster ein leerer Zeichenbereich, der darauf wartet, dass Sie ihn ausfüllen.
ms.assetid: db97a4c9-7592-42d1-a5de-9c468169eefc
ms.topic: article
ms.date: 08/16/2019
ms.openlocfilehash: f0f9d5c2759ea1735e370eb258743364980daee8
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/19/2020
ms.locfileid: "104551949"
---
# <a name="painting-the-window"></a><span data-ttu-id="2db4e-106">Zeichnen des Fensters</span><span class="sxs-lookup"><span data-stu-id="2db4e-106">Painting the Window</span></span>

<span data-ttu-id="2db4e-107">Sie haben Ihr Fenster erstellt.</span><span class="sxs-lookup"><span data-stu-id="2db4e-107">You've created your window.</span></span> <span data-ttu-id="2db4e-108">Nun möchten Sie etwas darin anzeigen.</span><span class="sxs-lookup"><span data-stu-id="2db4e-108">Now you want to show something inside it.</span></span> <span data-ttu-id="2db4e-109">In der Windows-Terminologie wird dies als "Zeichnen des Fensters" bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="2db4e-109">In Windows terminology, this is called painting the window.</span></span> <span data-ttu-id="2db4e-110">Zum Kombinieren von Metaphern ist ein Fenster ein leerer Zeichenbereich, der darauf wartet, dass Sie ihn ausfüllen.</span><span class="sxs-lookup"><span data-stu-id="2db4e-110">To mix metaphors, a window is a blank canvas, waiting for you to fill it.</span></span>

<span data-ttu-id="2db4e-111">Manchmal initiiert das Programm das Zeichnen, um die Darstellung des Fensters zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="2db4e-111">Sometimes your program will initiate painting to update the appearance of the window.</span></span> <span data-ttu-id="2db4e-112">Zu anderen Zeiten werden Sie vom Betriebssystem benachrichtigt, dass Sie einen Teil des Fensters neu zeichnen müssen.</span><span class="sxs-lookup"><span data-stu-id="2db4e-112">At other times, the operating system will notify you that you must repaint a portion of the window.</span></span> <span data-ttu-id="2db4e-113">In diesem Fall sendet das Betriebssystem dem Fenster eine [**WM- \_**](/windows/desktop/gdi/wm-paint) Zeichnungs Nachricht.</span><span class="sxs-lookup"><span data-stu-id="2db4e-113">When this occurs, the operating system sends the window a [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message.</span></span> <span data-ttu-id="2db4e-114">Der Teil des Fensters, der gezeichnet werden muss, wird als *Update Bereich* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="2db4e-114">The portion of the window that must be painted is called the *update region*.</span></span>

<span data-ttu-id="2db4e-115">Wenn ein Fenster zum ersten Mal angezeigt wird, muss der gesamte Client Bereich des Fensters gezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="2db4e-115">The first time a window is shown, the entire client area of the window must be painted.</span></span> <span data-ttu-id="2db4e-116">Daher erhalten Sie immer mindestens eine WM-Zeichnungs [**Nachricht \_**](/windows/desktop/gdi/wm-paint) , wenn Sie ein Fenster anzeigen.</span><span class="sxs-lookup"><span data-stu-id="2db4e-116">Therefore, you will always receive at least one [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message when you show a window.</span></span>

![Abbildung mit dem Aktualisierungs Bereich eines Fensters](images/painting01.png)

<span data-ttu-id="2db4e-118">Sie sind nur für das Zeichnen des Client Bereichs verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="2db4e-118">You are only responsible for painting the client area.</span></span> <span data-ttu-id="2db4e-119">Der umgebende Frame einschließlich der Titelleiste wird automatisch vom Betriebssystem gezeichnet.</span><span class="sxs-lookup"><span data-stu-id="2db4e-119">The surrounding frame, including the title bar, is automatically painted by the operating system.</span></span> <span data-ttu-id="2db4e-120">Nachdem Sie den Client Bereich gezeichnet haben, löschen Sie den Aktualisierungs Bereich, der dem Betriebssystem mitteilt, dass keine weitere WM-Zeichnungs [**Nachricht \_**](/windows/desktop/gdi/wm-paint) gesendet werden muss, bis etwas geändert wird.</span><span class="sxs-lookup"><span data-stu-id="2db4e-120">After you finish painting the client area, you clear the update region, which tells the operating system that it does not need to send another [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message until something changes.</span></span>

<span data-ttu-id="2db4e-121">Nehmen Sie jetzt an, dass der Benutzer ein anderes Fenster verschiebt, sodass ein Teil des Fensters verdeckt wird.</span><span class="sxs-lookup"><span data-stu-id="2db4e-121">Now suppose the user moves another window so that it obscures a portion of your window.</span></span> <span data-ttu-id="2db4e-122">Wenn der verdeckte Teil wieder sichtbar wird, wird dieser Teil dem Aktualisierungs Bereich hinzugefügt, und Ihr Fenster empfängt eine weitere WM-Zeichnungs Nachricht. [**\_**](/windows/desktop/gdi/wm-paint)</span><span class="sxs-lookup"><span data-stu-id="2db4e-122">When the obscured portion becomes visible again, that portion is added to the update region, and your window receives another [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message.</span></span>

![Abbildung, die zeigt, wie sich der Update Bereich ändert, wenn sich zwei Fenster](images/painting02.png)

<span data-ttu-id="2db4e-124">Der Aktualisierungs Bereich ändert sich auch, wenn der Benutzer das Fenster ausdehnt.</span><span class="sxs-lookup"><span data-stu-id="2db4e-124">The update region also changes if the user stretches the window.</span></span> <span data-ttu-id="2db4e-125">Im folgenden Diagramm wird das Fenster vom Benutzer nach rechts gestreckt.</span><span class="sxs-lookup"><span data-stu-id="2db4e-125">In the following diagram, the user stretches the window to the right.</span></span> <span data-ttu-id="2db4e-126">Der neu verfügbar gemachte Bereich auf der rechten Seite des Fensters wird der Aktualisierungs Region hinzugefügt:</span><span class="sxs-lookup"><span data-stu-id="2db4e-126">The newly exposed area on the right side of the window is added to the update region:</span></span>

![Abbildung, die zeigt, wie sich der Update Bereich ändert, wenn die Größe eines Fensters geändert wird](images/painting03.png)

<span data-ttu-id="2db4e-128">Im ersten Beispielprogramm ist die Zeichnungs Routine sehr einfach.</span><span class="sxs-lookup"><span data-stu-id="2db4e-128">In our first example program, the painting routine is very simple.</span></span> <span data-ttu-id="2db4e-129">Es füllt nur den gesamten Client Bereich mit einer voll Tonfarbe aus.</span><span class="sxs-lookup"><span data-stu-id="2db4e-129">It just fills the entire client area with a solid color.</span></span> <span data-ttu-id="2db4e-130">Dennoch genügt dieses Beispiel, um einige wichtige Konzepte zu veranschaulichen.</span><span class="sxs-lookup"><span data-stu-id="2db4e-130">Still, this example is enough to demonstrate some of the important concepts.</span></span>

```C++
switch (uMsg)
{
    case WM_PAINT:
    {
        PAINTSTRUCT ps;
        HDC hdc = BeginPaint(hwnd, &ps);

        // All painting occurs here, between BeginPaint and EndPaint.

        FillRect(hdc, &ps.rcPaint, (HBRUSH) (COLOR_WINDOW+1));

        EndPaint(hwnd, &ps);
    }
    return 0;
}
```

<span data-ttu-id="2db4e-131">Starten Sie den Zeichnungs Vorgang, indem Sie die [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="2db4e-131">Start the painting operation by calling the [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) function.</span></span> <span data-ttu-id="2db4e-132">Diese Funktion füllt die [**paintstruct**](/windows/win32/api/winuser/ns-winuser-paintstruct) -Struktur mit Informationen über die Repaint-Anforderung aus.</span><span class="sxs-lookup"><span data-stu-id="2db4e-132">This function fills in the [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct) structure with information on the repaint request.</span></span> <span data-ttu-id="2db4e-133">Der aktuelle Aktualisierungs Bereich wird im **rcpaint** -Member von **paintstruct** angegeben.</span><span class="sxs-lookup"><span data-stu-id="2db4e-133">The current update region is given in the **rcPaint** member of **PAINTSTRUCT**.</span></span> <span data-ttu-id="2db4e-134">Dieser Aktualisierungs Bereich ist relativ zum Client Bereich definiert:</span><span class="sxs-lookup"><span data-stu-id="2db4e-134">This update region is defined relative to the client area:</span></span>

![Abbildung, die den Ursprung des Client Bereichs anzeigt](images/painting04.png)

<span data-ttu-id="2db4e-136">In Ihrem Zeichnungs Code haben Sie zwei grundlegende Optionen:</span><span class="sxs-lookup"><span data-stu-id="2db4e-136">In your painting code, you have two basic options:</span></span>

- <span data-ttu-id="2db4e-137">Zeichnen Sie den gesamten Client Bereich unabhängig von der Größe des Aktualisierungs Bereichs.</span><span class="sxs-lookup"><span data-stu-id="2db4e-137">Paint the entire client area, regardless of the size of the update region.</span></span> <span data-ttu-id="2db4e-138">Alle Elemente, die außerhalb des Aktualisierungs Bereichs liegen, werden abgeschnitten.</span><span class="sxs-lookup"><span data-stu-id="2db4e-138">Anything that falls outside of the update region is clipped.</span></span> <span data-ttu-id="2db4e-139">Das heißt, das Betriebssystem ignoriert es.</span><span class="sxs-lookup"><span data-stu-id="2db4e-139">That is, the operating system ignores it.</span></span>
- <span data-ttu-id="2db4e-140">Optimieren Sie, indem Sie nur den Teil des Fensters innerhalb des Aktualisierungs Bereichs zeichnen.</span><span class="sxs-lookup"><span data-stu-id="2db4e-140">Optimize by painting just the portion of the window inside the update region.</span></span>

<span data-ttu-id="2db4e-141">Wenn Sie immer den gesamten Client Bereich zeichnen, ist der Code einfacher.</span><span class="sxs-lookup"><span data-stu-id="2db4e-141">If you always paint the entire client area, the code will be simpler.</span></span> <span data-ttu-id="2db4e-142">Wenn Sie jedoch eine komplizierte Zeichnungs Logik haben, kann es effizienter sein, die Bereiche außerhalb der Aktualisierungs Region zu überspringen.</span><span class="sxs-lookup"><span data-stu-id="2db4e-142">If you have complicated painting logic, however, it can be more efficient to skip the areas outside of the update region.</span></span>

<span data-ttu-id="2db4e-143">Die folgende Codezeile füllt den Update Bereich mit einer einzelnen Farbe auf, wobei die Hintergrundfarbe des System definierten Fensters (**Farb \_ Fenster**) verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="2db4e-143">The following line of code fills the update region with a single color, using the system-defined window background color (**COLOR\_WINDOW**).</span></span> <span data-ttu-id="2db4e-144">Die tatsächliche Farbe, die durch das **Farb \_ Fenster** angegeben ist, hängt vom aktuellen Farbschema des Benutzers ab.</span><span class="sxs-lookup"><span data-stu-id="2db4e-144">The actual color indicated by **COLOR\_WINDOW** depends on the user's current color scheme.</span></span>

```C++
FillRect(hdc, &ps.rcPaint, (HBRUSH) (COLOR_WINDOW+1));
```

<span data-ttu-id="2db4e-145">Die Details von [**fillRect**](/windows/desktop/api/winuser/nf-winuser-fillrect) sind für dieses Beispiel nicht wichtig, aber der zweite Parameter gibt die Koordinaten des Rechtecks an, das ausgefüllt werden soll.</span><span class="sxs-lookup"><span data-stu-id="2db4e-145">The details of [**FillRect**](/windows/desktop/api/winuser/nf-winuser-fillrect) are not important for this example, but the second parameter gives the coordinates of the rectangle to fill.</span></span> <span data-ttu-id="2db4e-146">In diesem Fall übergeben wir den gesamten Update Bereich (den **rcpaint** -Member von [**paintstruct**](/windows/win32/api/winuser/ns-winuser-paintstruct)).</span><span class="sxs-lookup"><span data-stu-id="2db4e-146">In this case, we pass in the entire update region (the **rcPaint** member of [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct)).</span></span> <span data-ttu-id="2db4e-147">Bei der ersten [**WM \_**](/windows/desktop/gdi/wm-paint) -Zeichnungs Nachricht muss der gesamte Client Bereich gezeichnet werden, sodass **rcpaint** den gesamten Client Bereich enthält.</span><span class="sxs-lookup"><span data-stu-id="2db4e-147">On the first [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message, the entire client area needs to be painted, so **rcPaint** will contain the entire client area.</span></span> <span data-ttu-id="2db4e-148">Bei nachfolgenden **WM \_ Paint** -Meldungen enthält **rcpaint** möglicherweise ein kleineres Rechteck.</span><span class="sxs-lookup"><span data-stu-id="2db4e-148">On subsequent **WM\_PAINT** messages, **rcPaint** might contain a smaller rectangle.</span></span>

<span data-ttu-id="2db4e-149">Die [**fillRect**](/windows/desktop/api/winuser/nf-winuser-fillrect) -Funktion ist Teil des Graphics Device Interface (GDI), das für einen sehr langen Zeitraum Windows-Grafiken betrieben hat.</span><span class="sxs-lookup"><span data-stu-id="2db4e-149">The [**FillRect**](/windows/desktop/api/winuser/nf-winuser-fillrect) function is part of the Graphics Device Interface (GDI), which has powered Windows graphics for a very long time.</span></span> <span data-ttu-id="2db4e-150">In Windows 7 führte Microsoft eine neue Grafik-Engine mit dem Namen Direct2D ein, die hochleistungsfähige Grafik Vorgänge wie Hardwarebeschleunigung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="2db4e-150">In Windows 7, Microsoft introduced a new graphics engine, named Direct2D, which supports high-performance graphics operations, such as hardware acceleration.</span></span> <span data-ttu-id="2db4e-151">Direct2D ist auch für Windows Vista über das [Platt Form Update für Windows Vista](../win7ip/platform-update-for-windows-vista-overview.md) und für Windows Server 2008 über das Platt Form Update für Windows Server 2008 verfügbar.</span><span class="sxs-lookup"><span data-stu-id="2db4e-151">Direct2D is also available for Windows Vista through the [Platform Update for Windows Vista](../win7ip/platform-update-for-windows-vista-overview.md) and for Windows Server 2008 through the Platform Update for Windows Server 2008.</span></span> <span data-ttu-id="2db4e-152">(GDI wird weiterhin vollständig unterstützt.)</span><span class="sxs-lookup"><span data-stu-id="2db4e-152">(GDI is still fully supported.)</span></span>

<span data-ttu-id="2db4e-153">Nachdem Sie das Zeichnen abgeschlossen haben, können Sie die [**endpaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) -Funktion aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="2db4e-153">After you are done painting, call the [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) function.</span></span> <span data-ttu-id="2db4e-154">Diese Funktion löscht den Update Bereich, der Windows signalisiert, dass das Fenster das Zeichnen selbst abgeschlossen hat.</span><span class="sxs-lookup"><span data-stu-id="2db4e-154">This function clears the update region, which signals to Windows that the window has completed painting itself.</span></span>

## <a name="next"></a><span data-ttu-id="2db4e-155">Nächste</span><span class="sxs-lookup"><span data-stu-id="2db4e-155">Next</span></span>

[<span data-ttu-id="2db4e-156">Schließen des Fensters</span><span class="sxs-lookup"><span data-stu-id="2db4e-156">Closing the Window</span></span>](closing-the-window.md)