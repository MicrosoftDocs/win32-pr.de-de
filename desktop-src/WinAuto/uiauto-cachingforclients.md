---
title: Zwischenspeichern von Eigenschaften der Benutzeroberflächen Automatisierung und Steuerelement Mustern
description: Bei der Verwendung von Microsoft UI Automation müssen Clients häufig mehrere Eigenschaften für mehrere Automatisierungselemente abrufen.
ms.assetid: 948b3bb9-75a9-4197-9680-e6fe7bb86feb
keywords:
- Caching, Eigenschaften der Benutzeroberflächen Automatisierung
- Caching, Eigenschaften
- Caching, Steuerelement Muster für die Benutzeroberflächen Automatisierung
- Caching, Steuerelement Muster
- Benutzeroberflächenautomatisierungs, Caching-Eigenschaften
- Benutzeroberflächen Automatisierung, Zwischenspeichern von Eigenschaften
- Clients, Eigenschaften der Benutzeroberflächen Automatisierung
- Clients, Caching-Steuerelement Muster für die Benutzeroberflächen Automatisierung
- Benutzeroberflächenautomatisierungs, cachingsteuerungmuster
- Benutzeroberflächen Automatisierung, Zwischenspeichern von Steuerelement Mustern
- Steuerelement Muster, Zwischenspeichern
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 69f75a7dc9491565fdfdc0ecc73808c2fb6a9d82
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104388123"
---
# <a name="caching-ui-automation-properties-and-control-patterns"></a><span data-ttu-id="ee6c0-114">Zwischenspeichern von Eigenschaften der Benutzeroberflächen Automatisierung und Steuerelement Mustern</span><span class="sxs-lookup"><span data-stu-id="ee6c0-114">Caching UI Automation Properties and Control Patterns</span></span>

<span data-ttu-id="ee6c0-115">Bei der Verwendung von Microsoft UI Automation müssen Clients häufig mehrere Eigenschaften für mehrere Automatisierungselemente abrufen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-115">When using Microsoft UI Automation, clients often need to retrieve multiple properties for multiple automation elements.</span></span> <span data-ttu-id="ee6c0-116">Ein Client kann einzelne Eigenschaften einzeln abrufen, indem er die Methoden zum Abrufen von Eigenschaften wie z. b. [**iuiautomationelement:: currentname**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) oder [**currentaccesskey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey)verwendet.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-116">A client could retrieve individual properties one element at a time by using the property retrieval methods such as [**IUIAutomationElement::CurrentName**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) or [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span></span> <span data-ttu-id="ee6c0-117">Diese Methode ist jedoch langsam und ineffizient, da für jede abgerufene Eigenschaft ein Prozess übergreifender Abruf erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-117">However, this method is slow and inefficient because it requires a cross-process call for each property being retrieved.</span></span> <span data-ttu-id="ee6c0-118">Um die Leistung zu verbessern, können Clients die Funktionen zum Zwischenspeichern (auch als Massen Abruf bezeichnet) für die Benutzeroberflächen Automatisierung verwenden.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-118">To improve performance, clients can use the caching (also called bulk fetching) capabilities of UI Automation.</span></span> <span data-ttu-id="ee6c0-119">Durch das Caching kann ein Client alle gewünschten Eigenschaften für alle gewünschten Elemente mit einem einzelnen Methoden aufzurufen abrufen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-119">Caching enables a client to retrieve all of the desired properties for all of the desired elements with a single method call.</span></span> <span data-ttu-id="ee6c0-120">Der Client kann dann die einzelnen Eigenschaften nach Bedarf aus dem Cache abrufen und eine neue Momentaufnahme des Caches regelmäßig abrufen, als Reaktion auf Ereignisse, die Änderungen in der Benutzeroberfläche bedeuten.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-120">The client can then retrieve the individual properties from the cache as needed, and can get a new snapshot of the cache periodically, generally in response to events that signify changes in the UI.</span></span>

<span data-ttu-id="ee6c0-121">Die Anwendung kann beim Abrufen eines Benutzeroberflächenautomatisierungs-Elements mithilfe einer Methode, z. b. [**iuiautomation:: elementfrompointbuildcache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**iuiautomationtreewalker:: getfirstchildelementbuildcache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache)oder [**iuiautomationelement:: findfirstbuildcache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache), Caching anfordern.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-121">The application can request caching when it retrieves a UI Automation element by using a method, such as [**IUIAutomation::ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**IUIAutomationTreeWalker::GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache), or [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span></span>

<span data-ttu-id="ee6c0-122">Zwischenspeichern erfolgt auch, wenn Sie beim Abonnieren von Ereignissen eine Cache Anforderung angeben.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-122">Caching also occurs when you specify a cache request while subscribing to events.</span></span> <span data-ttu-id="ee6c0-123">Das Benutzeroberflächenautomatisierungs-Element, das als Quelle eines Ereignisses an Ihren Ereignishandler übermittelt wird, enthält die zwischengespeicherten Eigenschaften und Steuerelement Muster, die von der Cache Anforderung angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-123">The UI Automation element passed to your event handler as the source of an event contains the cached properties and control patterns that are specified by the cache request.</span></span> <span data-ttu-id="ee6c0-124">Alle Änderungen, die an der Cache Anforderung vorgenommen werden, nachdem Sie das Ereignis abonniert haben, haben keine Auswirkungen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-124">Any changes made to the cache request after you subscribe to the event have no effect.</span></span>

<span data-ttu-id="ee6c0-125">Dieses Thema enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="ee6c0-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="ee6c0-126">Cache Anforderungen</span><span class="sxs-lookup"><span data-stu-id="ee6c0-126">Cache Requests</span></span>](#cache-requests)
    -   [<span data-ttu-id="ee6c0-127">Angeben von Eigenschaften-und Steuerelement Mustern zum Zwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="ee6c0-127">Specifying Property and Control Patterns to Cache</span></span>](#specifying-property-and-control-patterns-to-cache)
    -   [<span data-ttu-id="ee6c0-128">Festlegen des Bereichs und Filterns einer Cache Anforderung</span><span class="sxs-lookup"><span data-stu-id="ee6c0-128">Specifying the Scoping and Filtering of a Caching Request</span></span>](#specifying-the-scoping-and-filtering-of-a-caching-request)
    -   [<span data-ttu-id="ee6c0-129">Stärke der Element Verweise</span><span class="sxs-lookup"><span data-stu-id="ee6c0-129">Strength of Element References</span></span>](#strength-of-element-references)
-   [<span data-ttu-id="ee6c0-130">Abrufen von zwischengespeicherten untergeordneten und übergeordneten Elementen</span><span class="sxs-lookup"><span data-stu-id="ee6c0-130">Retrieving Cached Children and Parents</span></span>](#retrieving-cached-children-and-parents)
-   [<span data-ttu-id="ee6c0-131">Abrufen einer neuen Momentaufnahme des Caches</span><span class="sxs-lookup"><span data-stu-id="ee6c0-131">Retrieving a New Snapshot of the Cache</span></span>](#retrieving-a-new-snapshot-of-the-cache)
-   [<span data-ttu-id="ee6c0-132">Beispiele</span><span class="sxs-lookup"><span data-stu-id="ee6c0-132">Examples</span></span>](#examples)
-   [<span data-ttu-id="ee6c0-133">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ee6c0-133">Related topics</span></span>](#related-topics)

## <a name="cache-requests"></a><span data-ttu-id="ee6c0-134">Cache Anforderungen</span><span class="sxs-lookup"><span data-stu-id="ee6c0-134">Cache Requests</span></span>

<span data-ttu-id="ee6c0-135">Zum Zwischenspeichern müssen Sie bestimmen, welche Eigenschaften abgerufen und welche Elemente abgerufen werden sollen. Anschließend können Sie diese Informationen verwenden, um eine Cache Anforderung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-135">Caching involves determining which properties to retrieve and which elements to retrieve them from, and then using this information to create a cache request.</span></span> <span data-ttu-id="ee6c0-136">Wenn der Client eine [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) -Schnittstelle für das UI-Element erhält, speichert die Benutzeroberflächen Automatisierung die in der Cache Anforderung angegebenen Informationen zwischen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-136">Whenever the client obtains an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for UI item, UI Automation caches the information that is specified in the cache request.</span></span>

<span data-ttu-id="ee6c0-137">Beginnen Sie zum Erstellen einer Cache Anforderung mit der [**iuiautomation:: | atecacherequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) -Methode, um einen [**iuiautomationcacherequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) -Schnittstellen Zeiger abzurufen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-137">To create a cache request, begin by using the [**IUIAutomation::CreateCacheRequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) method to retrieve an [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) interface pointer.</span></span> <span data-ttu-id="ee6c0-138">Konfigurieren Sie als nächstes die Cache Anforderung mithilfe der Methoden von **iuiautomationcacherequest**.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-138">Next, configure the cache request by using the methods of **IUIAutomationCacheRequest**.</span></span>

### <a name="specifying-property-and-control-patterns-to-cache"></a><span data-ttu-id="ee6c0-139">Angeben von Eigenschaften-und Steuerelement Mustern zum Zwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="ee6c0-139">Specifying Property and Control Patterns to Cache</span></span>

<span data-ttu-id="ee6c0-140">Sie können Eigenschaften für den Cache angeben, indem Sie [**iuiautomationcacherequest:: AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-140">You can specify properties to cache by calling [**IUIAutomationCacheRequest::AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span></span> <span data-ttu-id="ee6c0-141">Sie können durch den Aufruf von [**iuiautomationcacherequest:: addpattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern)zwischengespeicherten Steuerelement Mustern angeben.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-141">You can specify control patterns to cache by calling [**IUIAutomationCacheRequest::AddPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span></span> <span data-ttu-id="ee6c0-142">Wenn ein Steuerelement Muster zwischengespeichert wird, werden dessen Eigenschaften nicht automatisch zwischengespeichert. Sie müssen die Eigenschaften, die Sie zwischenspeichern möchten, mithilfe von **AddProperty** angeben.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-142">When a control pattern is cached, its properties are not automatically cached; you must specify the properties you want to cache by using **AddProperty**.</span></span>

<span data-ttu-id="ee6c0-143">Sie können eine Steuerelement Muster-Eigenschaft (z. b. die Value-Eigenschaft des [value](uiauto-implementingvalue.md) -Steuerelement Musters) abrufen, ohne das gesamte Steuerelement Muster in den Cache abrufen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-143">You can retrieve a control pattern property (for example, the Value property of the [Value](uiauto-implementingvalue.md) control pattern), without having to retrieve the entire control pattern into the cache.</span></span> <span data-ttu-id="ee6c0-144">Sie müssen das Steuerelement Muster nur abrufen, wenn Sie eine Steuerelement Muster Methode verwenden müssen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-144">You must retrieve the control pattern only if you need to use a control pattern method.</span></span>

### <a name="specifying-the-scoping-and-filtering-of-a-caching-request"></a><span data-ttu-id="ee6c0-145">Festlegen des Bereichs und Filterns einer Cache Anforderung</span><span class="sxs-lookup"><span data-stu-id="ee6c0-145">Specifying the Scoping and Filtering of a Caching Request</span></span>

<span data-ttu-id="ee6c0-146">Sie können die Elemente angeben, deren Eigenschaften und Steuerelement Muster Sie zwischenspeichern möchten, indem Sie die [**iuiautomationcacherequest:: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) -Eigenschaft festlegen, bevor Sie die Anforderung verwenden.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-146">You can specify the elements whose properties and control patterns you want to cache by setting the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property before using the request.</span></span> <span data-ttu-id="ee6c0-147">Der Gültigkeitsbereich ist relativ zu den Elementen, die von der Methode abgerufen werden, an die die Cache Anforderung übermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-147">The scope is relative to the elements that are retrieved by the method to which the cache request is passed.</span></span> <span data-ttu-id="ee6c0-148">Wenn Sie z. b. nur [**TreeScope \_**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)-untergeordnete Elemente festlegen und dann ein Benutzeroberflächenautomatisierungs-Element abrufen, werden die Eigenschaften und Steuerelement Muster der untergeordneten Elemente dieses Elements zwischengespeichert, die Eigenschaften und Steuerelement Muster des Elements selbst werden jedoch nicht zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-148">For example, if you set only [**TreeScope\_Children**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope), and then retrieve a UI Automation element, the properties and control patterns of children of that element are cached, but the properties and control patterns of the element itself are not cached.</span></span> <span data-ttu-id="ee6c0-149">Um sicherzustellen, dass das Zwischenspeichern für das abgerufene Element selbst ausgeführt wird, müssen Sie ein **TreeScope- \_ Element** in die **iuiautomationcacherequest:: TreeScope** -Eigenschaft einschließen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-149">To ensure that caching is done for the retrieved element itself, you must include **TreeScope\_Element** in the **IUIAutomationCacheRequest::TreeScope** property.</span></span> <span data-ttu-id="ee6c0-150">Es ist nicht möglich, den Bereich auf " **TreeScope \_ Parent** " oder " **TreeScope \_**" festzulegen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-150">It is not possible to set the scope to **TreeScope\_Parent** or **TreeScope\_Ancestors**.</span></span> <span data-ttu-id="ee6c0-151">Ein übergeordnetes Element kann jedoch zwischengespeichert werden, wenn ein untergeordnetes Element zwischengespeichert wird. Weitere Informationen hierzu finden Sie in diesem Thema unter „Abrufen von zwischengespeicherten untergeordneten und übergeordneten Elementen“.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-151">However, a parent element can be cached when a child element is cached; see Retrieving Cached Children and Parents in this topic.</span></span>

<span data-ttu-id="ee6c0-152">Der Umfang des zwischen Speicherns wird auch von der [**iuiautomationcacherequest:: TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) -Eigenschaft beeinflusst.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-152">The extent of caching is also affected by the [**IUIAutomationCacheRequest::TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) property.</span></span> <span data-ttu-id="ee6c0-153">Standardmäßig wird das Zwischenspeichern nur für Elemente ausgeführt, die in der Steuerelement Ansicht der Benutzeroberflächenautomatisierungs-Struktur angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-153">By default, caching is performed only for elements that appear in the control view of the UI Automation tree.</span></span> <span data-ttu-id="ee6c0-154">Sie können diese Eigenschaft jedoch ändern, sodass alle Elemente oder nur in der Inhaltsansicht angezeigte Elemente zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-154">However, you can change this property to apply caching to all elements, or only to elements that appear in the content view.</span></span>

### <a name="strength-of-element-references"></a><span data-ttu-id="ee6c0-155">Stärke der Element Verweise</span><span class="sxs-lookup"><span data-stu-id="ee6c0-155">Strength of Element References</span></span>

<span data-ttu-id="ee6c0-156">Wenn Sie ein Automation-Element abrufen, haben Sie standardmäßig Zugriff auf alle Eigenschaften und Steuerelement Muster dieses Elements, einschließlich der Eigenschaften und Steuerelement Muster, die nicht zwischengespeichert wurden.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-156">When you retrieve an automation element, by default you have access to all properties and control patterns of that element, including those properties and control patterns that were not cached.</span></span> <span data-ttu-id="ee6c0-157">Sie können jedoch angeben, dass sich der Verweis auf das Element nur auf zwischengespeicherte Daten bezieht, indem Sie die [**iuiautomationcacherequest:: AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) -Eigenschaft auf **AutomationElementMode \_ None** festlegen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-157">However, you can specify that the reference to the element refers to cached data only, by setting the [**IUIAutomationCacheRequest::AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) property to **AutomationElementMode\_None**.</span></span> <span data-ttu-id="ee6c0-158">In diesem Fall haben Sie keinen Zugriff auf nicht zwischengespeicherte Eigenschaften und Steuerelement Muster von abgerufenen Elementen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-158">In this case, you do not have access to any uncached properties and control patterns of retrieved elements.</span></span> <span data-ttu-id="ee6c0-159">Dies bedeutet, dass Sie nicht mit [**iuiautomationelement:: GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern)auf aktuelle Eigenschaften wie z. b. [**iuiautomationelement::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) /////-dateisenabled zugreifen oder ein Steuerelement Muster abrufen können.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-159">This means that you cannot access any current properties such as [**IUIAutomationElement::CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) or retrieve a control pattern by using [**IUIAutomationElement::GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span></span> <span data-ttu-id="ee6c0-160">Bei zwischengespeicherten Steuerelement Mustern können Sie keine Methoden aufrufen, die Aktionen für das Steuerelement ausführen, wie z. b. [**iuiautomationinvokepattern:: Aufrufen**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="ee6c0-160">On cached control patterns, you cannot call methods that perform actions on the control, such as [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="ee6c0-161">Ein Beispiel für eine Anwendung, für die möglicherweise keine vollständigen Verweise auf Objekte erforderlich sind, ist eine Bildschirm Sprachausgabe, die die Eigenschaften von "Name" und "Steuer Elementtyp" von Elementen in einem Fenster vorab abrufen kann, ohne dass die Automation-Element Objekte</span><span class="sxs-lookup"><span data-stu-id="ee6c0-161">An example of an application that might not need full references to objects is a screen reader, which might prefetch the name and control type properties of elements in a window without needing the automation element objects themselves.</span></span>

## <a name="retrieving-cached-children-and-parents"></a><span data-ttu-id="ee6c0-162">Abrufen von zwischengespeicherten untergeordneten und übergeordneten Elementen</span><span class="sxs-lookup"><span data-stu-id="ee6c0-162">Retrieving Cached Children and Parents</span></span>

<span data-ttu-id="ee6c0-163">Wenn Sie mithilfe der [**iuiautomationcacherequest:: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) -Eigenschaft der Anforderung ein Automatisierungs Element abrufen und das Zwischenspeichern von untergeordneten Elementen dieses Elements anfordern, können Sie die untergeordneten Elemente abrufen, indem Sie [**iuiautomationelement:: getcachedchildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) für das Element aufrufen, das Sie abgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-163">When you retrieve an automation element and request caching for children of that element through the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property of the request, it is possible to get the child elements by calling [**IUIAutomationElement::GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) on the element you retrieved.</span></span>

<span data-ttu-id="ee6c0-164">Wenn ein [**TreeScope- \_ Element**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) in den Bereich der Cache Anforderung eingeschlossen wurde, kann das Stamm Element der Anforderung durch Aufrufen von [**iuiautomationelement:: getcachedparent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) für eines der untergeordneten Elemente abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-164">If [**TreeScope\_Element**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) was included in the scope of the cache request, the root element of the request can be retrieved by calling [**IUIAutomationElement::GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) on any of the child elements.</span></span>

> [!Note]  
> <span data-ttu-id="ee6c0-165">Sie können keine übergeordneten Elemente des Stammelements der Anforderung zwischenspeichern.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-165">You cannot cache parents or ancestors of the root element of the request.</span></span>

 

## <a name="retrieving-a-new-snapshot-of-the-cache"></a><span data-ttu-id="ee6c0-166">Abrufen einer neuen Momentaufnahme des Caches</span><span class="sxs-lookup"><span data-stu-id="ee6c0-166">Retrieving a New Snapshot of the Cache</span></span>

<span data-ttu-id="ee6c0-167">Der Cache ist nur gültig, solange sich nichts in der Benutzeroberfläche ändert.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-167">The cache is valid only as long as nothing changes in the UI.</span></span> <span data-ttu-id="ee6c0-168">Die Anwendung ist für das Abrufen einer neuen Momentaufnahme des Caches zuständig (in der Regel als Reaktion auf Ereignisse).</span><span class="sxs-lookup"><span data-stu-id="ee6c0-168">Your application is responsible for retrieving a new snapshot of the cache, typically, in response to events.</span></span>

<span data-ttu-id="ee6c0-169">Wenn Sie ein Ereignis mit einer Cache Anforderung abonnieren, erhalten Sie eine neue [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) -Momentaufnahme des Caches als Quelle des Ereignisses, wenn der Ereignishandler aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-169">If you subscribe to an event with a cache request, you obtain an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) new snapshot of the cache as the source of the event whenever your event handler is called.</span></span> <span data-ttu-id="ee6c0-170">Sie können auch eine neue Momentaufnahme der zwischengespeicherten Informationen für ein Element abrufen, indem Sie [**iuiautomationelement:: buildupdatedcache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-170">You can also retrieve a new snapshot of cached information for an element by calling [**IUIAutomationElement::BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span></span> <span data-ttu-id="ee6c0-171">Sie können das ursprüngliche [**iuiautomationcacherequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) übergeben, um eine neue Momentaufnahme aller zuvor zwischengespeicherten Informationen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-171">You can pass in the original [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) to get a new snapshot of all information that was previously cached.</span></span>

<span data-ttu-id="ee6c0-172">Durch das Abrufen einer neuen Momentaufnahme des Caches werden die Eigenschaften vorhandener [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) -Verweise nicht geändert.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-172">Retrieving a new snapshot of the cache does not modify the properties of any existing [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) references.</span></span>

## <a name="examples"></a><span data-ttu-id="ee6c0-173">Beispiele</span><span class="sxs-lookup"><span data-stu-id="ee6c0-173">Examples</span></span>

<span data-ttu-id="ee6c0-174">Codebeispiele, die zeigen, wie die zwischen Speicherungs Funktionen der Benutzeroberflächen Automatisierung verwendet werden, finden Sie unter [verwenden](uiauto-howto-use-caching.md)der Zwischenspeicherung.</span><span class="sxs-lookup"><span data-stu-id="ee6c0-174">For code examples that show how to use the caching capabilities of UI Automation, see [How to Use Caching](uiauto-howto-use-caching.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="ee6c0-175">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="ee6c0-175">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="ee6c0-176">**Licher**</span><span class="sxs-lookup"><span data-stu-id="ee6c0-176">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="ee6c0-177">Übersicht über Steuerelementmuster für Benutzeroberflächenautomatisierung</span><span class="sxs-lookup"><span data-stu-id="ee6c0-177">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="ee6c0-178">Abrufen von Benutzeroberflächenautomatisierungs-Elementen</span><span class="sxs-lookup"><span data-stu-id="ee6c0-178">Obtaining UI Automation Elements</span></span>](uiauto-obtainingelements.md)
</dt> <dt>

[<span data-ttu-id="ee6c0-179">Übersicht über die Benutzeroberflächenautomatisierungs-Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="ee6c0-179">UI Automation Properties Overview</span></span>](uiauto-propertiesoverview.md)
</dt> </dl>

 

 




