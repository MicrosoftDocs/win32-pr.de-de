---
title: Implementieren eines Server-Side Benutzeroberflächenautomatisierungs-Anbieters
description: In diesem Thema wird beschrieben, wie ein serverseitiger Microsoft UI Automation-Anbieter für ein benutzerdefiniertes Steuerelement implementiert wird, das in C++ geschrieben ist
ms.assetid: c3a919b2-8b8c-4dde-ad71-587f3845a9f5
keywords:
- Benutzeroberflächen Automatisierung, serverseitige Anbieter Implementierung
- UI-Automatisierung, Anbieter Implementierung
- Benutzeroberflächen Automatisierung, implementieren serverseitiger Anbieter
- Benutzeroberflächen Automatisierung, Implementieren von Anbietern
- Serverseitige Anbieter, implementieren
- Serverseitige Anbieter, Schnittstellen
- Serverseitige Anbieter, Eigenschaftswerte
- Serverseitige Anbieter, Ereignisse
- Serverseitige Anbieter, Zuweisen eines neuen übergeordneten Elements
- Ereignisse, serverseitige Anbieter
- Schnittstellen, serverseitige Anbieter
- Anbieter, implementieren
- Implementieren serverseitiger Anbieter
- Implementieren von Anbietern
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7fafbb9d03a25eb2e4713330c0622c25d17f9ff
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "106339290"
---
# <a name="implement-a-server-side-ui-automation-provider"></a><span data-ttu-id="9f763-117">Implementieren eines Server-Side Benutzeroberflächenautomatisierungs-Anbieters</span><span class="sxs-lookup"><span data-stu-id="9f763-117">Implement a Server-Side UI Automation Provider</span></span>

<span data-ttu-id="9f763-118">In diesem Thema wird beschrieben, wie ein serverseitiger Microsoft UI Automation-Anbieter für ein benutzerdefiniertes Steuerelement implementiert wird, das in C++ geschrieben ist</span><span class="sxs-lookup"><span data-stu-id="9f763-118">This topic describes how to implement a server-side Microsoft UI Automation provider for a custom control written in C++.</span></span> <span data-ttu-id="9f763-119">Sie enthält die folgenden Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="9f763-119">It contains the following sections:</span></span>

-   [<span data-ttu-id="9f763-120">Anbieterschnittstellen</span><span class="sxs-lookup"><span data-stu-id="9f763-120">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="9f763-121">Erforderliche Funktionalität für Benutzeroberflächenautomatisierungs-Anbieter</span><span class="sxs-lookup"><span data-stu-id="9f763-121">Required Functionality for UI Automation Providers</span></span>](#required-functionality-for-ui-automation-providers)
-   [<span data-ttu-id="9f763-122">Eigenschaftswerte</span><span class="sxs-lookup"><span data-stu-id="9f763-122">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="9f763-123">Ereignisse von Anbietern</span><span class="sxs-lookup"><span data-stu-id="9f763-123">Events from Providers</span></span>](#events-from-providers)
-   [<span data-ttu-id="9f763-124">Anbieter Navigation</span><span class="sxs-lookup"><span data-stu-id="9f763-124">Provider Navigation</span></span>](#provider-navigation)
-   [<span data-ttu-id="9f763-125">Zuweisen eines neuen übergeordneten Elements</span><span class="sxs-lookup"><span data-stu-id="9f763-125">Assigning a New Parent</span></span>](#assigning-a-new-parent)
-   [<span data-ttu-id="9f763-126">Neupositionierung des Anbieters</span><span class="sxs-lookup"><span data-stu-id="9f763-126">Provider Repositioning</span></span>](#provider-repositioning)
-   [<span data-ttu-id="9f763-127">Trennen der Verbindung von Anbietern</span><span class="sxs-lookup"><span data-stu-id="9f763-127">Disconnecting Providers</span></span>](#disconnecting-providers)
-   [<span data-ttu-id="9f763-128">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="9f763-128">Related topics</span></span>](#related-topics)

<span data-ttu-id="9f763-129">Codebeispiele, die zeigen, wie serverseitige Anbieter implementiert werden, finden Sie unter Gewusst [-wie-Themen für Benutzeroberflächenautomatisierungs-Anbieter](uiauto-howto-topics-for-uiautomation-providers.md).</span><span class="sxs-lookup"><span data-stu-id="9f763-129">For code examples that show how to implement server-side providers, see [How-To Topics for UI Automation Providers](uiauto-howto-topics-for-uiautomation-providers.md).</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="9f763-130">Anbieterschnittstellen</span><span class="sxs-lookup"><span data-stu-id="9f763-130">Provider Interfaces</span></span>

<span data-ttu-id="9f763-131">Die folgenden Component Object Model (com)-Schnittstellen stellen Funktionalität für benutzerdefinierte Steuerelemente bereit.</span><span class="sxs-lookup"><span data-stu-id="9f763-131">The following Component Object Model (COM) interfaces provide functionality for custom controls.</span></span> <span data-ttu-id="9f763-132">Zum Bereitstellen grundlegender Funktionen muss jeder Benutzeroberflächenautomatisierungs-Anbieter mindestens die [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) -Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="9f763-132">To provide basic functionality, every UI Automation provider must implement at least the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface.</span></span> <span data-ttu-id="9f763-133">Die-Schnittstellen " [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) " und " [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) " sind optional, sollten jedoch für Elemente in einem komplexen Steuerelement implementiert werden, um zusätzliche Funktionen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="9f763-133">The [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) and [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) interfaces are optional, but should be implemented for elements in a complex control to provide additional functionality.</span></span>



| <span data-ttu-id="9f763-134">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="9f763-134">Interface</span></span>                                                                         | <span data-ttu-id="9f763-135">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="9f763-135">Description</span></span>                                                                                                                                                                   |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9f763-136">**IRawElementProviderSimple**</span><span class="sxs-lookup"><span data-stu-id="9f763-136">**IRawElementProviderSimple**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)             | <span data-ttu-id="9f763-137">Stellt grundlegende Funktionen für ein in einem Fenster gehostetes Steuerelement bereit, einschließlich der Unterstützung für Steuerelement Muster und Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="9f763-137">Provides basic functionality for a control hosted in a window, including support for control patterns and properties.</span></span>                                                         |
| [<span data-ttu-id="9f763-138">**IRawElementProviderFragment**</span><span class="sxs-lookup"><span data-stu-id="9f763-138">**IRawElementProviderFragment**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment)         | <span data-ttu-id="9f763-139">Fügt Funktionen für ein Element in einem komplexen Steuerelement hinzu, einschließlich Navigation im Fragment, Festlegen des Fokus und Zurückgeben des umgebenden Rechtecks des Elements.</span><span class="sxs-lookup"><span data-stu-id="9f763-139">Adds functionality for an element in a complex control, including navigating in the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>             |
| [<span data-ttu-id="9f763-140">**IRawElementProviderFragmentRoot**</span><span class="sxs-lookup"><span data-stu-id="9f763-140">**IRawElementProviderFragmentRoot**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) | <span data-ttu-id="9f763-141">Fügt Funktionen für das Stammelement in einem komplexen Steuerelement hinzu, einschließlich Suchen eines untergeordneten Elements an angegebenen Koordinaten und Festlegen des Fokuszustands für das gesamte Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="9f763-141">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span> |



 

> [!Note]  
> <span data-ttu-id="9f763-142">In der Benutzeroberflächenautomatisierungs-API für verwalteten Code bilden diese Schnittstellen eine Vererbungs Hierarchie.</span><span class="sxs-lookup"><span data-stu-id="9f763-142">In the UI Automation API for managed code, these interfaces form an inheritance hierarchy.</span></span> <span data-ttu-id="9f763-143">Dies ist in C++ nicht der Fall, in dem die Schnittstellen vollständig voneinander getrennt sind.</span><span class="sxs-lookup"><span data-stu-id="9f763-143">This is not the case in C++, where the interfaces are completely separate.</span></span>

 

<span data-ttu-id="9f763-144">Die folgenden Schnittstellen bieten zusätzliche Funktionen, aber die Implementierung ist optional.</span><span class="sxs-lookup"><span data-stu-id="9f763-144">The following interfaces provide added functionality but implementation is optional.</span></span>



| <span data-ttu-id="9f763-145">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="9f763-145">Interface</span></span>                                                                         | <span data-ttu-id="9f763-146">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="9f763-146">Description</span></span>                                                                             |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="9f763-147">**Irawelementprovideradvil-Ereignisse**</span><span class="sxs-lookup"><span data-stu-id="9f763-147">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="9f763-148">Ermöglicht dem Anbieter, Anforderungen für Ereignisse zu verfolgen.</span><span class="sxs-lookup"><span data-stu-id="9f763-148">Enables the provider to track requests for events.</span></span>                                      |
| [<span data-ttu-id="9f763-149">**IRawElementProviderHwndOverride**</span><span class="sxs-lookup"><span data-stu-id="9f763-149">**IRawElementProviderHwndOverride**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) | <span data-ttu-id="9f763-150">Ermöglicht das Neupositionieren von Fenster basierten Elementen in der Benutzeroberflächenautomatisierungs-Struktur eines Fragments.</span><span class="sxs-lookup"><span data-stu-id="9f763-150">Enables repositioning of window-based elements in the UI Automation tree of a fragment.</span></span> |



 

## <a name="required-functionality-for-ui-automation-providers"></a><span data-ttu-id="9f763-151">Erforderliche Funktionalität für Benutzeroberflächenautomatisierungs-Anbieter</span><span class="sxs-lookup"><span data-stu-id="9f763-151">Required Functionality for UI Automation Providers</span></span>

<span data-ttu-id="9f763-152">Um mit der Benutzeroberflächen Automatisierung zu kommunizieren, muss das Steuerelement die Hauptbereiche der Funktionalität implementieren, die in der folgenden Tabelle beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="9f763-152">To communicate with UI Automation, your control must implement the main areas of functionality described in the following table.</span></span>



| <span data-ttu-id="9f763-153">Funktionalität</span><span class="sxs-lookup"><span data-stu-id="9f763-153">Functionality</span></span>                                              | <span data-ttu-id="9f763-154">Implementierung</span><span class="sxs-lookup"><span data-stu-id="9f763-154">Implementation</span></span>                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9f763-155">Machen Sie den Anbieter für die Benutzeroberflächen Automatisierung verfügbar.</span><span class="sxs-lookup"><span data-stu-id="9f763-155">Expose the provider to UI Automation.</span></span>                      | <span data-ttu-id="9f763-156">Geben Sie als Antwort auf eine an das Steuerelement Fenster gesendete [**WM- \_ GetObject**](wm-getobject.md) -Nachricht das Objekt zurück, das [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)implementiert.</span><span class="sxs-lookup"><span data-stu-id="9f763-156">In response to a [**WM\_GETOBJECT**](wm-getobject.md) message sent to the control window, return the object that implements [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span></span> <span data-ttu-id="9f763-157">Für Fragmente muss dies der Anbieter für den Fragmentstamm sein.</span><span class="sxs-lookup"><span data-stu-id="9f763-157">For fragments, this must be the provider for the fragment root.</span></span>                                           |
| <span data-ttu-id="9f763-158">Geben Sie Eigenschaftswerte an.</span><span class="sxs-lookup"><span data-stu-id="9f763-158">Provide property values.</span></span>                                   | <span data-ttu-id="9f763-159">Implementieren Sie [**IRawElementProviderSimple:: GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) , um Werte bereitzustellen oder zu überschreiben.</span><span class="sxs-lookup"><span data-stu-id="9f763-159">Implement [**IRawElementProviderSimple::GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) to provide or override values.</span></span>                                                                                                                                                             |
| <span data-ttu-id="9f763-160">Ermöglicht es dem Client, mit dem Steuerelement zu interagieren.</span><span class="sxs-lookup"><span data-stu-id="9f763-160">Enable the client to interact with the control.</span></span>            | <span data-ttu-id="9f763-161">Implementieren Sie Schnittstellen, die jedes geeignete Steuerelement Muster unterstützen, z. b. [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span><span class="sxs-lookup"><span data-stu-id="9f763-161">Implement interfaces that support each appropriate control pattern, such as [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span></span> <span data-ttu-id="9f763-162">Geben Sie diese Steuerelement Muster Anbieter in der Implementierung von [**IRawElementProviderSimple:: GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider)zurück.</span><span class="sxs-lookup"><span data-stu-id="9f763-162">Return these control pattern providers in your implementation of [**IRawElementProviderSimple::GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span></span> |
| <span data-ttu-id="9f763-163">Ereignisse aufwecken.</span><span class="sxs-lookup"><span data-stu-id="9f763-163">Raise events.</span></span>                                              | <span data-ttu-id="9f763-164">[**Uiaraiseautomationevent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), Methoden von [**iproxyproviderwineventsink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span><span class="sxs-lookup"><span data-stu-id="9f763-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), methods of [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span></span>                                                                                                                                                |
| <span data-ttu-id="9f763-165">Aktivieren der Navigation und Fokussierung in einem Fragment</span><span class="sxs-lookup"><span data-stu-id="9f763-165">Enable navigating and focusing in a fragment.</span></span>              | <span data-ttu-id="9f763-166">Implementieren Sie [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) für jedes Element innerhalb des Fragments.</span><span class="sxs-lookup"><span data-stu-id="9f763-166">Implement [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) for each element within the fragment.</span></span> <span data-ttu-id="9f763-167">Nicht erforderlich für Elemente, die nicht Teil eines Fragments sind.</span><span class="sxs-lookup"><span data-stu-id="9f763-167">Not necessary for elements that are not part of a fragment.</span></span>                                                                                                                         |
| <span data-ttu-id="9f763-168">Ermöglicht das Fokussieren und suchen untergeordneter Elemente in einem Fragment.</span><span class="sxs-lookup"><span data-stu-id="9f763-168">Enable focusing and locating child elements in a fragment.</span></span> | <span data-ttu-id="9f763-169">Implementieren Sie [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span><span class="sxs-lookup"><span data-stu-id="9f763-169">Implement [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span></span> <span data-ttu-id="9f763-170">Nicht erforderlich für Elemente, die keine Fragmentstämme sind.</span><span class="sxs-lookup"><span data-stu-id="9f763-170">Not necessary for elements that are not fragment roots.</span></span>                                                                                                                                                          |



 

## <a name="property-values"></a><span data-ttu-id="9f763-171">Eigenschaftswerte</span><span class="sxs-lookup"><span data-stu-id="9f763-171">Property Values</span></span>

<span data-ttu-id="9f763-172">Benutzeroberflächenautomatisierungs-Anbieter für benutzerdefinierte Steuerelemente müssen bestimmte Eigenschaften unterstützen, die von der Benutzeroberflächen Automatisierung und Client Anwendungen verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="9f763-172">UI Automation providers for custom controls must support certain properties that can be used by UI Automation and by client applications.</span></span> <span data-ttu-id="9f763-173">Für Elemente, die in Windows gehostet werden, kann die Benutzeroberflächen Automatisierung einige Eigenschaften vom Standardfenster Anbieter abrufen, muss jedoch andere vom benutzerdefinierten Anbieter erhalten.</span><span class="sxs-lookup"><span data-stu-id="9f763-173">For elements that are hosted in windows, UI Automation can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="9f763-174">In der Regel müssen Anbieter für fensterbasierte Steuerelemente die folgenden Eigenschaften nicht bereitstellen, die durch **PropertyId** identifiziert werden:</span><span class="sxs-lookup"><span data-stu-id="9f763-174">Typically, providers for window-based controls do not need to provide the following properties that are identified by **PROPERTYID**:</span></span>

-   [<span data-ttu-id="9f763-175">**UIA \_ boundingrechglepropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-175">**UIA\_BoundingRectanglePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="9f763-176">**UIA \_ clickablepointpropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-176">**UIA\_ClickablePointPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="9f763-177">**UIA \_ processidpropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-177">**UIA\_ProcessIdPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="9f763-178">**UIA \_ classnamepropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-178">**UIA\_ClassNamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="9f763-179">**UIA \_ haskeyboardfocuspropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-179">**UIA\_HasKeyboardFocusPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="9f763-180">**UIA \_ isenabledpropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-180">**UIA\_IsEnabledPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="9f763-181">**UIA \_ iskeyboardfocus ablepropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-181">**UIA\_IsKeyboardFocusablePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="9f763-182">**UIA \_ ispasswordpropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-182">**UIA\_IsPasswordPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="9f763-183">**UIA- \_ namepropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-183">**UIA\_NamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="9f763-184">**UIA \_ runtimeidpropertyid**</span><span class="sxs-lookup"><span data-stu-id="9f763-184">**UIA\_RuntimeIdPropertyId**</span></span>](uiauto-automation-element-propids.md)

<span data-ttu-id="9f763-185">Die runtimeId-Eigenschaft eines in einem Fenster gehosteten einfachen Elements oder fragmentstamms wird aus dem Fenster abgerufen.</span><span class="sxs-lookup"><span data-stu-id="9f763-185">The RuntimeId property of a simple element or fragment root hosted in a window is obtained from the window.</span></span> <span data-ttu-id="9f763-186">Fragmentelemente unterhalb des Stamms (z. b. Listenelemente in einem Listenfeld) müssen jedoch eigene Bezeichner bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="9f763-186">However, fragment elements below the root, such as list items in a list box, must provide their own identifiers.</span></span> <span data-ttu-id="9f763-187">Weitere Informationen finden Sie unter [**IRawElementProviderFragment:: GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span><span class="sxs-lookup"><span data-stu-id="9f763-187">For more information, see [**IRawElementProviderFragment::GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span></span>

<span data-ttu-id="9f763-188">Die iskeyboardfocverwendbare-Eigenschaft sollte für Anbieter zurückgegeben werden, die in einem Windows Forms Steuerelement gehostet werden.</span><span class="sxs-lookup"><span data-stu-id="9f763-188">The IsKeyboardFocusable property should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="9f763-189">In diesem Fall ist der Standardfensteranbieter möglicherweise nicht in der Lage, den richtigen Wert abzurufen.</span><span class="sxs-lookup"><span data-stu-id="9f763-189">In this case, the default window provider may be unable to retrieve the correct value.</span></span>

<span data-ttu-id="9f763-190">Die Name-Eigenschaft wird in der Regel vom Host Anbieter bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="9f763-190">The Name property is usually supplied by the host provider.</span></span>

## <a name="events-from-providers"></a><span data-ttu-id="9f763-191">Ereignisse von Anbietern</span><span class="sxs-lookup"><span data-stu-id="9f763-191">Events from Providers</span></span>

<span data-ttu-id="9f763-192">Benutzeroberflächenautomatisierungs-Anbieter sollten Ereignisse ausgeben, um Client Anwendungen über Änderungen im Status der Benutzeroberfläche zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="9f763-192">UI Automation providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="9f763-193">Die folgenden Funktionen werden verwendet, um Ereignisse zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="9f763-193">The following functions are used to raise events.</span></span>



| <span data-ttu-id="9f763-194">Funktion</span><span class="sxs-lookup"><span data-stu-id="9f763-194">Function</span></span>                                                                                   | <span data-ttu-id="9f763-195">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="9f763-195">Description</span></span>                                                                                                              |
|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9f763-196">**Uiaraiserautomationevent**</span><span class="sxs-lookup"><span data-stu-id="9f763-196">**UiaRaiseAutomationEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent)                  | <span data-ttu-id="9f763-197">Löst verschiedene Ereignisse aus, einschließlich Ereignissen, die von Steuerelementmustern ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="9f763-197">Raises various events, including events triggered by control patterns.</span></span>                                                   |
| [<span data-ttu-id="9f763-198">**Uiaraiminautomationpropertychangede Vent**</span><span class="sxs-lookup"><span data-stu-id="9f763-198">**UiaRaiseAutomationPropertyChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationpropertychangedevent) | <span data-ttu-id="9f763-199">Löst ein Ereignis aus, wenn eine Benutzeroberflächenautomatisierungs-Eigenschaft geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="9f763-199">Raises an event when a UI Automation property has changed.</span></span>                                                               |
| [<span data-ttu-id="9f763-200">**Uiaraiminstructurechangede Vent**</span><span class="sxs-lookup"><span data-stu-id="9f763-200">**UiaRaiseStructureChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraisestructurechangedevent)      | <span data-ttu-id="9f763-201">Löst ein Ereignis aus, wenn sich die Struktur der Benutzeroberflächenautomatisierungs-Struktur geändert hat, z. b. durch Entfernen oder Hinzufügen eines Elements.</span><span class="sxs-lookup"><span data-stu-id="9f763-201">Raises an event when the structure of the UI Automation tree has changed, for example, by removing or adding an element.</span></span> |



 

<span data-ttu-id="9f763-202">Der Zweck eines Ereignisses besteht darin, den Client über etwas zu benachrichtigen, das in der Benutzeroberfläche stattfindet.</span><span class="sxs-lookup"><span data-stu-id="9f763-202">The purpose of an event is to notify the client of something taking place in the UI.</span></span> <span data-ttu-id="9f763-203">Anbieter sollten ein Ereignis auslösen, unabhängig davon, ob die Änderung durch Benutzereingaben oder durch eine Client Anwendung mithilfe der Benutzeroberflächen Automatisierung ausgelöst wurde.</span><span class="sxs-lookup"><span data-stu-id="9f763-203">Providers should raise an event regardless of whether the change was triggered by user input or by a client application using UI Automation.</span></span> <span data-ttu-id="9f763-204">Beispielsweise sollte das von [**UIA identifizierte Ereignis \_ \_ invokedeventid**](uiauto-event-ids.md) immer dann ausgelöst werden, wenn das-Steuerelement aufgerufen wird. Dies geschieht entweder über eine direkte Benutzereingabe oder durch die Client Anwendung, die [**iuiautomationinvokepattern::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke)Call aufruft.</span><span class="sxs-lookup"><span data-stu-id="9f763-204">For example, the event identified by [**UIA\_Invoke\_InvokedEventId**](uiauto-event-ids.md) should be raised whenever the control is invoked, either through direct user input or by the client application calling [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="9f763-205">Zum Optimieren der Leistung kann ein Anbieter Ereignisse selektiv auslösen oder keine Ereignisse auslösen, wenn für deren Empfang keine Clientanwendung registriert ist.</span><span class="sxs-lookup"><span data-stu-id="9f763-205">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="9f763-206">Die folgenden API-Elemente werden zur Optimierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="9f763-206">The following API elements are used for optimization.</span></span>



| <span data-ttu-id="9f763-207">API-Element</span><span class="sxs-lookup"><span data-stu-id="9f763-207">API Element</span></span>                                                                       | <span data-ttu-id="9f763-208">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="9f763-208">Description</span></span>                                                                                                                                                       |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9f763-209">**Uiaclientsarelistening**</span><span class="sxs-lookup"><span data-stu-id="9f763-209">**UiaClientsAreListening**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening)           | <span data-ttu-id="9f763-210">Diese Funktion bezieht sich darauf, ob Client Anwendungen Benutzeroberflächenautomatisierungs-Ereignisse abonniert haben.</span><span class="sxs-lookup"><span data-stu-id="9f763-210">This function ascertains whether any client applications have subscribed to UI Automation events.</span></span>                                                                 |
| [<span data-ttu-id="9f763-211">**Irawelementprovideradvil-Ereignisse**</span><span class="sxs-lookup"><span data-stu-id="9f763-211">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="9f763-212">Wenn Sie diese Schnittstelle in einem Fragmentstamm implementieren, kann der Anbieter darüber informiert werden, wenn die Registrierung von Ereignis Handlern für Ereignisse auf dem Fragment durch Clients registriert wird.</span><span class="sxs-lookup"><span data-stu-id="9f763-212">Implementing this interface on a fragment root enables the provider to be advised when clients register and unregister event handlers for events on the fragment.</span></span> |



 

> [!Note]  
> <span data-ttu-id="9f763-213">Ähnlich wie bei der Implementierung der Verweis Zählung bei der com-Programmierung ist es für Benutzeroberflächenautomatisierungs-Anbieter wichtig, die Methoden [**irawelementprovideradviseevents:: adviseeventadded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) und [**adviseeventremoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) wie die [**IUnknown:: adressf**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) -und [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) -Methoden der [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) -Schnittstelle zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="9f763-213">Similar to implementing reference counting in COM programming, it is important for UI Automation providers to treat the [**IRawElementProviderAdviseEvents::AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) and [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) methods like the [**IUnknown::AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) and [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) methods of the [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="9f763-214">Solange **adviseeventadded** mehrmals als **adviseeventremoved** für ein bestimmtes Ereignis oder eine bestimmte Eigenschaft bezeichnet wurde, sollte der Anbieter weiterhin entsprechende Ereignisse aufrufen, da einige Clients weiterhin lauschen.</span><span class="sxs-lookup"><span data-stu-id="9f763-214">As long as **AdviseEventAdded** has been called more times than **AdviseEventRemoved** for a specific event or property, the provider should continue to raise corresponding events, because some clients are still listening.</span></span> <span data-ttu-id="9f763-215">Sie können auch Benutzeroberflächenautomatisierungs-Anbieter verwenden, um zu bestimmen, ob mindestens ein Client abhört und, wenn [**dies der Fall**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) ist, alle entsprechenden Ereignisse auslöst.</span><span class="sxs-lookup"><span data-stu-id="9f763-215">Alternatively, UI Automation providers can use the [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) function to determine whether at least one client is listening and, if so, raise all appropriate events.</span></span>

 

## <a name="provider-navigation"></a><span data-ttu-id="9f763-216">Anbieter Navigation</span><span class="sxs-lookup"><span data-stu-id="9f763-216">Provider Navigation</span></span>

<span data-ttu-id="9f763-217">Anbieter für einfache Steuerelemente, wie z. b. eine benutzerdefinierte Schaltfläche, die in einem-Fenster gehostet wird, müssen die Navigation in der Benutzeroberflächenautomatisierungs-Struktur</span><span class="sxs-lookup"><span data-stu-id="9f763-217">Providers for simple controls, such as a custom button hosted in a window, do not need to support navigation in the UI Automation tree.</span></span> <span data-ttu-id="9f763-218">Die Navigation zum und vom Element wird vom Standardanbieter für das Host Fenster behandelt, das in der Implementierung von [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider)angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="9f763-218">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span></span> <span data-ttu-id="9f763-219">Wenn Sie jedoch einen Anbieter für ein komplexes benutzerdefiniertes Steuerelement implementieren, müssen Sie die Navigation zwischen dem Stammknoten des Fragments und seinen Nachfolgern sowie zwischen nebengeordneten Knoten unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9f763-219">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!Note]  
> <span data-ttu-id="9f763-220">Elemente eines anderen Fragments als der Stamm müssen von [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) **null** zurückgeben, da Sie nicht direkt in einem Fenster gehostet werden und kein Standardanbieter die Navigation zu und von Ihnen unterstützen kann.</span><span class="sxs-lookup"><span data-stu-id="9f763-220">Elements of a fragment other than the root must return **NULL** from [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

 

<span data-ttu-id="9f763-221">Die Struktur des Fragments wird durch ihre Implementierung von [**IRawElementProviderFragment:: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate)bestimmt.</span><span class="sxs-lookup"><span data-stu-id="9f763-221">The structure of the fragment is determined by your implementation of [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span></span> <span data-ttu-id="9f763-222">Diese Methode gibt für jedes Fragment und jede mögliche Richtung das Anbieterobjekt für das in dieser Richtung liegende Element zurück.</span><span class="sxs-lookup"><span data-stu-id="9f763-222">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="9f763-223">Wenn kein Element in dieser Richtung vorhanden ist, gibt die Methode **null** zurück.</span><span class="sxs-lookup"><span data-stu-id="9f763-223">If there is no element in that direction, the method returns **NULL**.</span></span>

<span data-ttu-id="9f763-224">Der Fragmentstamm unterstützt nur die Navigation zu untergeordneten Elementen.</span><span class="sxs-lookup"><span data-stu-id="9f763-224">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="9f763-225">Ein Listenfeld gibt z. b. das erste Element in der Liste zurück, wenn die Richtung " **navigatedirection \_ FirstChild**" ist, und gibt das letzte Element zurück, wenn die Richtung " **navigatedirection \_ LastChild**" lautet.</span><span class="sxs-lookup"><span data-stu-id="9f763-225">For example, a list box returns the first item in the list when the direction is **NavigateDirection\_FirstChild**, and returns the last item when the direction is **NavigateDirection\_LastChild**.</span></span> <span data-ttu-id="9f763-226">Der Fragmentstamm unterstützt keine Navigation zu einem übergeordneten Element oder zu gleich geordneten Elementen. Dies wird vom Host Fenster Anbieter behandelt.</span><span class="sxs-lookup"><span data-stu-id="9f763-226">The fragment root does not support navigation to a parent or to siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="9f763-227">Die Nicht-Stammelemente eines Fragments müssen die Navigation zum übergeordneten Element sowie zu allen vorhandenen nebengeordneten und untergeordneten Elementen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9f763-227">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

## <a name="assigning-a-new-parent"></a><span data-ttu-id="9f763-228">Zuweisen eines neuen übergeordneten Elements</span><span class="sxs-lookup"><span data-stu-id="9f763-228">Assigning a New Parent</span></span>

<span data-ttu-id="9f763-229">Popup Fenster sind tatsächlich Fenster der obersten Ebene und werden in der Benutzeroberflächenautomatisierungs-Struktur standardmäßig als untergeordnete Elemente des Desktops angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9f763-229">Pop-up windows are actually top-level windows, and by default, appear in the UI Automation tree as children of the desktop.</span></span> <span data-ttu-id="9f763-230">Eigentlich sind Popupfenster in vielen Fällen jedoch untergeordnete Elemente anderer Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="9f763-230">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="9f763-231">Beispielsweise ist die Dropdownliste eines Kombinationsfelds logischerweise ein untergeordnetes Element des Kombinationsfelds.</span><span class="sxs-lookup"><span data-stu-id="9f763-231">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="9f763-232">Dementsprechend ist ein Menüpopupfenster logischerweise ein untergeordnetes Element des Menüs.</span><span class="sxs-lookup"><span data-stu-id="9f763-232">Similarly, a menu pop-up window is logically a child of the menu.</span></span> <span data-ttu-id="9f763-233">Die Benutzeroberflächen Automatisierung bietet Unterstützung für das Zuweisen eines neuen übergeordneten Elements zu einem Popup Fenster, sodass es als untergeordnetes Element des zugeordneten Steuer Elements angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="9f763-233">UI Automation provides support to assign a new parent to a pop-up window so that it appears to be a child of the associated control.</span></span>

<span data-ttu-id="9f763-234">So weisen Sie einem Popup Fenster ein neues übergeordnetes Element zu:</span><span class="sxs-lookup"><span data-stu-id="9f763-234">To assign a new parent to a pop-up window:</span></span>

1.  <span data-ttu-id="9f763-235">Erstellen Sie einen Anbieter für das Popupfenster.</span><span class="sxs-lookup"><span data-stu-id="9f763-235">Create a provider for the pop-up window.</span></span> <span data-ttu-id="9f763-236">Hierfür muss die Klasse des Popup Fensters im Voraus bekannt sein.</span><span class="sxs-lookup"><span data-stu-id="9f763-236">This requires that the class of the pop-up window be known in advance.</span></span>
2.  <span data-ttu-id="9f763-237">Implementieren Sie alle Eigenschaften und Steuerelement Muster wie üblich für dieses Popup, als wäre es ein eigenes Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="9f763-237">Implement all properties and control patterns as usual for that pop-up, as though it were a control in its own right.</span></span>
3.  <span data-ttu-id="9f763-238">Implementieren Sie die Eigenschaft " [**IRawElementProviderSimple:: Host Provider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) ", sodass Sie den Wert zurückgibt, der von " [**uiahostproviderfromhwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd)" abgerufen wurde, wobei der Parameter das Fenster Handle des Popup Fensters ist.</span><span class="sxs-lookup"><span data-stu-id="9f763-238">Implement the [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) property so that it returns the value obtained from [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), where the parameter is the window handle of the pop-up window.</span></span>
4.  <span data-ttu-id="9f763-239">Implementieren Sie [**IRawElementProviderFragment:: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) für das Popup Fenster und das übergeordnete Element, sodass die Navigation vom logischen übergeordneten Element zu den logischen untergeordneten Elementen und zwischen gleich geordneten untergeordneten Elementen ordnungsgemäß verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="9f763-239">Implement [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="9f763-240">Wenn die Benutzeroberflächen Automatisierung das Popup Fenster findet, erkennt Sie, dass die Navigation standardmäßig überschrieben wird, und überspringt das Popup Fenster, wenn es als untergeordnetes Element des Desktops auftritt.</span><span class="sxs-lookup"><span data-stu-id="9f763-240">When UI Automation encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="9f763-241">Stattdessen ist der Knoten nur über das Fragment erreichbar.</span><span class="sxs-lookup"><span data-stu-id="9f763-241">Instead, the node is reachable only through the fragment.</span></span>

<span data-ttu-id="9f763-242">Das Zuweisen eines neuen übergeordneten Elements eignet sich nicht für Fälle, in denen ein Steuerelement ein Fenster einer beliebigen Klasse hosten kann.</span><span class="sxs-lookup"><span data-stu-id="9f763-242">Assigning a new parent is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="9f763-243">Beispielsweise kann ein Grund leisten-Steuerelement beliebige Fenstertypen in seinen Bändern hosten.</span><span class="sxs-lookup"><span data-stu-id="9f763-243">For example, a rebar control can host any type of window in its bands.</span></span> <span data-ttu-id="9f763-244">Um diese Fälle zu behandeln, unterstützt die Benutzeroberflächen Automatisierung eine alternative Form der Fenster Verlagerung, wie im nächsten Abschnitt beschrieben.</span><span class="sxs-lookup"><span data-stu-id="9f763-244">To handle these cases, UI Automation supports an alternative form of window relocation, as described in the next section.</span></span>

## <a name="provider-repositioning"></a><span data-ttu-id="9f763-245">Neupositionierung des Anbieters</span><span class="sxs-lookup"><span data-stu-id="9f763-245">Provider Repositioning</span></span>

<span data-ttu-id="9f763-246">Benutzeroberflächenautomatisierungs-Fragmente enthalten möglicherweise zwei oder mehr Elemente, die jeweils in einem Fenster enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="9f763-246">UI Automation fragments may contain two or more elements that are each contained in a window.</span></span> <span data-ttu-id="9f763-247">Da jedes Fenster über einen eigenen Standardanbieter verfügt, der das Fenster als untergeordnetes Element eines enthaltenden Fensters ansieht, werden in der Benutzeroberflächenautomatisierungs-Struktur standardmäßig die Fenster im Fragment als untergeordnete Elemente des übergeordneten Fensters angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9f763-247">Because each window has its own default provider that considers the window to be a child of a containing window, the UI Automation tree by default, will show the windows in the fragment as children of the parent window.</span></span> <span data-ttu-id="9f763-248">In den meisten Fällen ist dies wünschenswert, aber manchmal kann es zu Verwirrung führen, da es nicht der logischen Struktur der Benutzeroberfläche entspricht.</span><span class="sxs-lookup"><span data-stu-id="9f763-248">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the UI.</span></span>

<span data-ttu-id="9f763-249">Ein gutes Beispiel hierfür ist ein Grundleistensteuerelement.</span><span class="sxs-lookup"><span data-stu-id="9f763-249">A good example of this is a rebar control.</span></span> <span data-ttu-id="9f763-250">Ein Grund leisten-Steuerelement enthält Bänder, von denen jedes wiederum ein Fenster basiertes Steuerelement enthalten kann, z. b. eine Symbolleiste, ein Eingabefeld oder ein Kombinations Feld.</span><span class="sxs-lookup"><span data-stu-id="9f763-250">A rebar control contains bands, each of which can in turn contain a window-based control, such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="9f763-251">Der Standardfenster Anbieter für das Fenster "Info Leiste" sieht die Band Steuerungs Fenster als untergeordnete Elemente, und der Grund leisten Anbieter sieht die Bänder als untergeordnete Elemente.</span><span class="sxs-lookup"><span data-stu-id="9f763-251">The default window provider for the rebar window sees the band control windows as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="9f763-252">Da der Fenster Anbieter und der Grund leisten Anbieter zusammenarbeiten und ihre untergeordneten Elemente kombinieren, werden sowohl die Bänder als auch die Fenster basierten Steuerelemente als untergeordnete Elemente des Grund leisten-Steuer Elements angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9f763-252">Because the window provider and the rebar provider are working in tandem and combining their children, both the bands and the window-based controls appear as children of the rebar control.</span></span> <span data-ttu-id="9f763-253">Logisch, jedoch sollten nur die Bänder als untergeordnete Elemente des Grund leisten-Steuer Elements angezeigt werden, und jeder Band Anbieter sollte mit dem Standardfenster Anbieter für das enthaltene Steuerelement gekoppelt werden.</span><span class="sxs-lookup"><span data-stu-id="9f763-253">Logically, however, only the bands should appear as children of the rebar control, and each band provider should be coupled with the default window provider for the control it contains.</span></span>

<span data-ttu-id="9f763-254">Um dies zu erreichen, macht der Fragment-Stamm Anbieter für das Grund leisten-Steuerelement einen Satz untergeordneter Elemente verfügbar, die die Bänder darstellen.</span><span class="sxs-lookup"><span data-stu-id="9f763-254">To accomplish this, the fragment root provider for the rebar control exposes a set of children representing the bands.</span></span> <span data-ttu-id="9f763-255">Jedes Band verfügt über einen einzelnen Anbieter, der Eigenschaften und Steuerelement Muster verfügbar machen kann.</span><span class="sxs-lookup"><span data-stu-id="9f763-255">Each band has a single provider that may expose properties and control patterns.</span></span> <span data-ttu-id="9f763-256">In der Implementierung von [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider)gibt der Band Anbieter den Standardfenster Anbieter für das Steuerelement Fenster zurück, das er durch Aufrufen von " [**uiahostproviderfromhwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd)" erhält und dabei den Fenster Handle (**HWND**) des Steuer Elements übergibt.</span><span class="sxs-lookup"><span data-stu-id="9f763-256">In its implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), the band provider returns the default window provider for the control window, which it obtains by calling [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), passing in the control's window handle (**HWND**).</span></span> <span data-ttu-id="9f763-257">Schließlich implementiert der fragmentstammpbieter für die Grund Leiste die [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) -Schnittstelle, und bei der Implementierung von [**IRawElementProviderHwndOverride:: GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd)wird der entsprechende Band Anbieter für das Steuerelement zurückgegeben, das im angegebenen Fenster enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="9f763-257">Finally, the fragment root provider for the rebar implements the [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) interface, and in its implementation of [**IRawElementProviderHwndOverride::GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), it returns the appropriate band provider for the control contained in the specified window.</span></span>

## <a name="disconnecting-providers"></a><span data-ttu-id="9f763-258">Trennen der Verbindung von Anbietern</span><span class="sxs-lookup"><span data-stu-id="9f763-258">Disconnecting Providers</span></span>

<span data-ttu-id="9f763-259">Anwendungen erstellen in der Regel Steuerelemente, wenn Sie benötigt werden, und zerstören Sie anschließend.</span><span class="sxs-lookup"><span data-stu-id="9f763-259">Applications typically create controls as they are needed and destroy them afterward.</span></span> <span data-ttu-id="9f763-260">Nachdem ein Steuerelement zerstört wurde, sollten die dem Steuerelement zugeordneten Benutzeroberflächenautomatisierungs-Anbieter Ressourcen durch Aufrufen von [**uiadisconnectprovider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider)freigegeben werden.</span><span class="sxs-lookup"><span data-stu-id="9f763-260">After destroying a control, the UI Automation provider resources associated with the control should be released by calling the [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span></span>

<span data-ttu-id="9f763-261">Ebenso sollte eine Anwendung die [**uiadisconnectallproviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) -Funktion verwenden, um alle Benutzeroberflächenautomatisierungs-Ressourcen freizugeben, die von allen Anbietern der Anwendung aufbewahrt werden, bevor Sie heruntergefahren werden.</span><span class="sxs-lookup"><span data-stu-id="9f763-261">Similarly, an application should use the [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) function to release all UI Automation resources held by all providers in the application before shutting down.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9f763-262">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="9f763-262">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9f763-263">Programmier Handbuch für Benutzeroberflächenautomatisierungs-Anbieter</span><span class="sxs-lookup"><span data-stu-id="9f763-263">UI Automation Provider Programmer's Guide</span></span>](uiauto-providerportal.md)
</dt> </dl>

 

 