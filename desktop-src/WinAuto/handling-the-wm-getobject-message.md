---
title: Verarbeiten der WM_GETOBJECT Nachricht
description: Sowohl Microsoft Active Accessibility als auch Microsoft UI Automation senden die WM- \_ GetObject-Nachricht an eine Server-oder Anbieter Anwendung, um Informationen über ein Barrierefreies Objekt abzurufen, das vom Server oder Anbieter unterstützt wird.
ms.assetid: 4b8e551f-aba7-4a89-8874-ba690175f525
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 695fad8f050606f0a95a1780551d35499e39d166
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "106338285"
---
# <a name="handling-the-wm_getobject-message"></a><span data-ttu-id="e989c-103">Behandeln der WM- \_ GetObject-Nachricht</span><span class="sxs-lookup"><span data-stu-id="e989c-103">Handling the WM\_GETOBJECT Message</span></span>

<span data-ttu-id="e989c-104">Sowohl Microsoft Active Accessibility als auch Microsoft UI Automation senden die [**WM- \_ GetObject**](wm-getobject.md) -Nachricht an eine Server-oder Anbieter Anwendung, um Informationen über ein Barrierefreies Objekt abzurufen, das vom Server oder Anbieter unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="e989c-104">Both Microsoft Active Accessibility and Microsoft UI Automation send the [**WM\_GETOBJECT**](wm-getobject.md) message to a server or provider application to retrieve information about an accessible object supported by the server or provider.</span></span> <span data-ttu-id="e989c-105">Clients senden **WM \_ GetObject** niemals direkt.</span><span class="sxs-lookup"><span data-stu-id="e989c-105">Clients never send **WM\_GETOBJECT** directly.</span></span> <span data-ttu-id="e989c-106">Stattdessen sendet Microsoft Active Accessibility diese Nachricht, wenn ein Client die Funktionen [**accessibleobjectfrompoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**accessibleobjectfromevent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent)und [**accessibleobjectfromwindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) aufruft.</span><span class="sxs-lookup"><span data-stu-id="e989c-106">Instead, Microsoft Active Accessibility sends this message when a client calls the [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) functions.</span></span> <span data-ttu-id="e989c-107">Die Benutzeroberflächenautomatisierung sendet das **WM- \_ GetObject** -Element, wenn ein Client [**iuiautomation:: elementfromhandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**elementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint)und [**getfocucements**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement)aufruft und Ereignisse behandelt, die vom Client registriert wurden.</span><span class="sxs-lookup"><span data-stu-id="e989c-107">UI Automation sends **WM\_GETOBJECT** when a client calls [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint), and [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), and when handling events for which the client has registered.</span></span>

<span data-ttu-id="e989c-108">Microsoft Active Accessibility oder UI Automation gibt den Objekttyp an, für den Informationen benötigt werden, indem ein Wert, der als *Objekt Bezeichner* bezeichnet wird, mit der [**WM \_ GetObject**](wm-getobject.md) -Nachricht übergeben</span><span class="sxs-lookup"><span data-stu-id="e989c-108">Microsoft Active Accessibility or UI Automation specifies the type of object it needs information for by passing a valued called an *object identifier* with the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="e989c-109">Beim Empfang der Nachricht prüft der Server oder Anbieter den Objekt Bezeichner, um zu bestimmen, wie auf die Nachricht geantwortet werden soll.</span><span class="sxs-lookup"><span data-stu-id="e989c-109">When it receives the message, the server or provider examines the object identifier to determine how to respond to the message.</span></span> <span data-ttu-id="e989c-110">Die Antwort hängt davon ab, ob die empfangende Anwendung Microsoft Active Accessibility (einen Server), eine Benutzeroberflächen Automatisierung (einen Anbieter) oder keines von beiden für das angegebene Objekt implementiert.</span><span class="sxs-lookup"><span data-stu-id="e989c-110">The response depends on whether the receiving application implements Microsoft Active Accessibility (a server), UI Automation (a provider), or neither, for the specified object.</span></span>

-   <span data-ttu-id="e989c-111">Wenn die empfangende Anwendung ein Microsoft Active Accessibility Server ist und [**die WM \_ GetObject**](wm-getobject.md) -Nachricht einen Objekt Bezeichner des [**objID- \_ Clients**](object-identifiers.md)enthält, sollte der Server den Wert zurückgeben, der durch übergeben der [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Schnittstelle des Objekts an die [**lresultfrofubject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) -Funktion abgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="e989c-111">If the receiving application is an Microsoft Active Accessibility server and the [**WM\_GETOBJECT**](wm-getobject.md) message includes an object identifier of [**OBJID\_CLIENT**](object-identifiers.md), the server should return the value obtained by passing the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface of the object to the [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) function.</span></span>
-   <span data-ttu-id="e989c-112">Wenn es sich bei der empfangenden Anwendung um einen AUI-Automatisierungsanbieter handelt und der Objekt Bezeichner **uiarootobjectid** ist, sollte der Anbieter die [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) -Schnittstelle des Objekts zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="e989c-112">If the receiving application is aUI Automation provider and the object identifier is **UiaRootObjectId**, the provider should return the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface of the object.</span></span> <span data-ttu-id="e989c-113">Der Anbieter Ruft die-Schnittstelle durch Aufrufen der [**uiareturnrawelementprovider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) -Funktion ab.</span><span class="sxs-lookup"><span data-stu-id="e989c-113">The provider obtains the interface by calling the [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) function.</span></span>
-   <span data-ttu-id="e989c-114">Wenn die empfangende Anwendung weder Microsoft Active Accessibility noch eine Benutzeroberflächen Automatisierung implementiert, sollte Sie die [**WM- \_ GetObject**](wm-getobject.md) -Nachricht an die [**defwindowproc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) -Funktion übergeben.</span><span class="sxs-lookup"><span data-stu-id="e989c-114">If the receiving application implements neither Microsoft Active Accessibility nor UI Automation, it should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="e989c-115">Durch das übergeben der Nachricht kann das Barrierefreiheits Framework ermitteln, ob ein Proxy für das angegebene Objekt verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="e989c-115">Passing the message enables the accessibility framework to determine if a proxy is available for the specified object.</span></span>
-   <span data-ttu-id="e989c-116">Wenn es sich bei dem Objekt Bezeichner weder um einen [**objID- \_ Client**](object-identifiers.md) noch um uiarootobjectid handelt, sollte die empfangende Anwendung die [**WM- \_ GetObject**](wm-getobject.md) -Nachricht an die [**defwindowproc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) -Funktion übergeben.</span><span class="sxs-lookup"><span data-stu-id="e989c-116">If the object identifier is neither [**OBJID\_CLIENT**](object-identifiers.md) nor UiaRootObjectId, the receiving application should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="e989c-117">Das übergeben der Nachricht ermöglicht dem Barrierefreiheits Framework die Verwendung der Standardanbieter für Standardbenutzer Oberflächen Elemente.</span><span class="sxs-lookup"><span data-stu-id="e989c-117">Passing the message enables the accessibility framework to use the default providers for standard UI elements.</span></span>

<span data-ttu-id="e989c-118">Microsoft Active Accessibility und die Benutzeroberflächen Automatisierung können benutzerdefinierte Objekt Bezeichner in einer [**WM- \_ GetObject**](wm-getobject.md) -Nachricht übergeben, um Anwendungs definierte Werte oder Objekte von einem Server oder Anbieter abzurufen.</span><span class="sxs-lookup"><span data-stu-id="e989c-118">Microsoft Active Accessibility and UI Automation can pass custom object identifiers in a [**WM\_GETOBJECT**](wm-getobject.md) message to retrieve application-defined values or objects from a server or provider.</span></span> <span data-ttu-id="e989c-119">Der Objekt Bezeichner " [**objID \_ nativeom**](object-identifiers.md) " oder " [**objID \_ queryclassnameidx**](object-identifiers.md) " kann zum Abrufen einer systemeigenen Objektmodell Schnittstelle oder zum Anfordern eines bestimmten Proxy Objekts verwendet werden, das von Oleacc.dll unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="e989c-119">The [**OBJID\_NATIVEOM**](object-identifiers.md) or [**OBJID\_QUERYCLASSNAMEIDX**](object-identifiers.md) object identifier can be used to retrieve a native Object Model interface, or to request a specific proxy object that is supported by Oleacc.dll.</span></span>

<span data-ttu-id="e989c-120">Indem sowohl der [**objID- \_ Client**](object-identifiers.md) als auch der **uiarootobjectid** -Objekt Bezeichner verarbeitet wird, kann eine Microsoft Active Accessibility Server-Implementierung parallel zur Implementierung eines Benutzeroberflächenautomatisierungs-Anbieters vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="e989c-120">By handling both the [**OBJID\_CLIENT**](object-identifiers.md) and **UiaRootObjectId** object identifiers, a Microsoft Active Accessibility server implementation can co-exist alongside a UI Automation provider implementation.</span></span> <span data-ttu-id="e989c-121">Da die meisten standardmäßigen Windows-Steuerelemente und allgemeinen Steuerelemente, die von der allgemeinen Steuerelement Bibliothek (ComCtl32.dll) implementiert werden, weder Microsoft Active Accessibility noch eine Benutzeroberflächen Automatisierung implementieren, verarbeiten diese Steuerelemente in der Regel nicht die [**WM \_ GetObject**](wm-getobject.md) -Nachricht</span><span class="sxs-lookup"><span data-stu-id="e989c-121">Because most standard Windows controls and common controls implemented by the common control library (ComCtl32.dll) do not implement either Microsoft Active Accessibility or UI Automation, these controls typically do not handle the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="e989c-122">Stattdessen überprüft das Microsoft Active Accessibility-oder Benutzeroberflächenautomatisierungs-Framework, ob ein Proxy Objekt für ein bestimmtes UI-Element verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="e989c-122">Instead, the Microsoft Active Accessibility or UI Automation framework checks if a proxy object is available for a particular UI element.</span></span> <span data-ttu-id="e989c-123">Andernfalls wird das Standard Proxy Objekt für das Host Fenster Objekt bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="e989c-123">Otherwise, it provides the default proxy object for the host window object.</span></span>

 

 