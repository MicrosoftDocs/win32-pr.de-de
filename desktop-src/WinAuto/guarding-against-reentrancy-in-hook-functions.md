---
title: Schutz vor erneuten eintreten in Hook-Funktionen
description: Während eine Hook-Funktion ein Ereignis verarbeitet, können zusätzliche Ereignisse ausgelöst werden, was dazu führen kann, dass die Hook-Funktion erneut eintritt, bevor die Verarbeitung für das ursprüngliche Ereignis abgeschlossen ist.
ms.assetid: 2382e7a4-82df-423a-8479-66e28baf8105
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 74e2b0dc6f8951bf48ce3fecabd3a81bd345388d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104390777"
---
# <a name="guarding-against-reentrancy-in-hook-functions"></a><span data-ttu-id="bcd8b-103">Schutz vor erneuten eintreten in Hook-Funktionen</span><span class="sxs-lookup"><span data-stu-id="bcd8b-103">Guarding Against Reentrancy in Hook Functions</span></span>

<span data-ttu-id="bcd8b-104">Während eine Hook-Funktion ein Ereignis verarbeitet, können zusätzliche Ereignisse ausgelöst werden, was dazu führen kann, dass die Hook-Funktion erneut eintritt, bevor die Verarbeitung für das ursprüngliche Ereignis abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="bcd8b-104">While a hook function processes an event, additional events may be triggered, which may cause the hook function to reenter before the processing for the original event is finished.</span></span> <span data-ttu-id="bcd8b-105">Das Problem mit dem erneuten eintreten in Hook-Funktionen besteht darin, dass Ereignisse außerhalb der Reihenfolge abgeschlossen werden, es sei denn, die Hook-Funktion behandelt diese Situation.</span><span class="sxs-lookup"><span data-stu-id="bcd8b-105">The problem with reentrancy in hook functions is that events are completed out of sequence unless the hook function handles this situation.</span></span>

<span data-ttu-id="bcd8b-106">Stellen Sie sich z. b. einen Fall vor, in dem eine Hook-Funktion in einem Bildschirm Leseprogramm das [**Ereignis \_ Objekt \_ ValueChange**](event-constants.md) -Ereignis für ein Bearbeitungs Steuerelement verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="bcd8b-106">For example, consider a case where a hook function in a screen reader program is processing the [**EVENT\_OBJECT\_VALUECHANGE**](event-constants.md) event for an edit control.</span></span> <span data-ttu-id="bcd8b-107">Wenn beim Verarbeiten des ersten Wert Änderungs Ereignisses die Hook-Funktion erneut eingegeben wird, um ein nachfolgendes Wert Änderungs Ereignis zu verarbeiten, wird das zweite Ereignis vor dem ersten Ereignis abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="bcd8b-107">If, while processing the first value change event the hook function is reentered to process a subsequent value change event, the second event is completed before the first event.</span></span> <span data-ttu-id="bcd8b-108">Diese Situation führt dazu, dass die Bildschirmausgabe falsche Informationen an den Benutzer übermittelt.</span><span class="sxs-lookup"><span data-stu-id="bcd8b-108">This situation results in the screen reader conveying inaccurate information to the user.</span></span>

<span data-ttu-id="bcd8b-109">Da die Ereignisverarbeitung unterbrochen wird, werden möglicherweise jederzeit weitere Ereignisse empfangen, wenn die Hook-Funktion eine Funktion aufruft, die bewirkt, dass die Nachrichten Warteschlange des besitzenden Threads überprüft wird.</span><span class="sxs-lookup"><span data-stu-id="bcd8b-109">Because event processing is interrupted, additional events might be received any time the hook function calls a function that causes the owning thread's message queue to get checked.</span></span> <span data-ttu-id="bcd8b-110">Dies geschieht, wenn eine der folgenden Aktionen innerhalb der Hook-Funktion aufgerufen wird:</span><span class="sxs-lookup"><span data-stu-id="bcd8b-110">This happens when any of the following are called within the hook function:</span></span>

-   <span data-ttu-id="bcd8b-111">Die Windows [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage)-, [**GetMessage**](/windows/desktop/api/winuser/nf-winuser-getmessage)-, [**PeekMessage**](/windows/desktop/api/winuser/nf-winuser-peekmessagea)-, [**Dialogbox**](/windows/desktop/api/winuser/nf-winuser-dialogboxa)-oder [**MessageBox**](/windows/desktop/api/winuser/nf-winuser-messagebox) -Funktion</span><span class="sxs-lookup"><span data-stu-id="bcd8b-111">The Windows [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), [**GetMessage**](/windows/desktop/api/winuser/nf-winuser-getmessage), [**PeekMessage**](/windows/desktop/api/winuser/nf-winuser-peekmessagea), [**DialogBox**](/windows/desktop/api/winuser/nf-winuser-dialogboxa), or [**MessageBox**](/windows/desktop/api/winuser/nf-winuser-messagebox) function</span></span>
-   <span data-ttu-id="bcd8b-112">Die Microsoft Active Accessibility Functions [**accessibleobjectfromevent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**accessibleobjectfromwindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow), [**accessibleobjectfrompoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)</span><span class="sxs-lookup"><span data-stu-id="bcd8b-112">The Microsoft Active Accessibility functions [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)</span></span>
-   <span data-ttu-id="bcd8b-113">Eine [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Schnittstelle oder eine andere Component Object Model (com)-Eigenschaft oder-Methode, die Prozess Grenzen überschneidet</span><span class="sxs-lookup"><span data-stu-id="bcd8b-113">An [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface or other Component Object Model (COM) property or method that crosses process boundaries</span></span>

<span data-ttu-id="bcd8b-114">Da Hook-Funktionen [**accessibleobjectfromevent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) -und [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Eigenschaften und-Methoden aufzurufen, ist es nicht möglich, den erneuten eintreten zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="bcd8b-114">Because hook functions call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) and [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties and methods, it is not possible to prevent reentrancy.</span></span> <span data-ttu-id="bcd8b-115">Die einzige Lösung besteht darin, dass Client Entwickler in der Hook-Funktion Code hinzufügen können, der einen erneuten eintreten erkennt und geeignete Maßnahmen ergreifen soll, wenn die Hook-Funktion erneut eingegeben wird.</span><span class="sxs-lookup"><span data-stu-id="bcd8b-115">The only solution is for client developers to add code in the hook function that detects reentrancy and take appropriate action if the hook function is reentered.</span></span>

 

 