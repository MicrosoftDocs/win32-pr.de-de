---
title: Abrufen von Benutzeroberflächenautomatisierungs-Elementen
description: In diesem Thema werden verschiedene Möglichkeiten zum Abrufen von iuiautomationelement-Schnittstellen für Benutzeroberflächen Elemente beschrieben.
ms.assetid: 8675851a-4a72-4cbe-ab71-ed6fc891be17
keywords:
- Clients, Abrufen von Benutzeroberflächenautomatisierungs-Elementen
- Clients, Benutzeroberflächenautomatisierungs-Elemente
- Clients, Stamm Elemente
- Clients, Suchbereich
- Benutzeroberflächen Automatisierung, Abrufen von Elementen
- Benutzeroberflächen Automatisierung, Elemente
- Benutzeroberflächenautomatisierungs, Root-Elemente
- Benutzeroberflächenautomatisierungs, Bedingungen
- Benutzeroberflächen Automatisierung, Suchbereich
- Abrufen von Elementen der Benutzeroberflächen Automatisierung
- Stammelemente
- Suchbereich
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: a1adbcea5cea81f97350ef15c491b289e07d3ee6
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/20/2021
ms.locfileid: "106355854"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="859ba-115">Abrufen von Benutzeroberflächenautomatisierungs-Elementen</span><span class="sxs-lookup"><span data-stu-id="859ba-115">Obtaining UI Automation Elements</span></span>

<span data-ttu-id="859ba-116">In diesem Thema werden verschiedene Möglichkeiten zum Abrufen von [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) -Schnittstellen für Benutzeroberflächen Elemente beschrieben.</span><span class="sxs-lookup"><span data-stu-id="859ba-116">This topic describes various ways to obtain [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interfaces for UI elements.</span></span>

<span data-ttu-id="859ba-117">**Iuiautomationelement** wird in der Benutzeroberflächenautomatisierungs- [Client-Beispiel-App für Dokumentinhalte](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient)verwendet.</span><span class="sxs-lookup"><span data-stu-id="859ba-117">**IUIAutomationElement** is used in the [UI Automation document content client sample app](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span></span>

## <a name="root-element"></a><span data-ttu-id="859ba-118">Root-Element</span><span class="sxs-lookup"><span data-stu-id="859ba-118">Root Element</span></span>

<span data-ttu-id="859ba-119">Obwohl Elemente direkt mithilfe von-Methoden abgerufen werden können, wie z. b. [**iuiautomation:: getfocucment**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), benötigen einige Client Anwendungen eine Ansicht der hierarchischen Struktur von Elementen, die als Benutzeroberflächenautomatisierungs-Struktur bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="859ba-119">Although elements can be retrieved directly by using methods, such as [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), some client applications require a view of the hierarchical structure of elements, known as the UI Automation tree.</span></span> <span data-ttu-id="859ba-120">Das Stamm Element dieser Hierarchie ist der Desktop.</span><span class="sxs-lookup"><span data-stu-id="859ba-120">The root element of this hierarchy is the desktop.</span></span> <span data-ttu-id="859ba-121">Sie können dieses Element mithilfe der [**iuiautomation:: getrootelement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) -Methode oder der [**iuiautomation:: getrootelementbuildcache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) -Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="859ba-121">You can obtain this element by using the [**IUIAutomation::GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) method or the [**IUIAutomation::GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) method.</span></span> <span data-ttu-id="859ba-122">Beide Methoden rufen einen [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) -Schnittstellen Zeiger ab.</span><span class="sxs-lookup"><span data-stu-id="859ba-122">Both these methods retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface pointer.</span></span> <span data-ttu-id="859ba-123">Sie können nachfolgende Elemente mithilfe von Methoden suchen, wie z. b. [**iuiautomationelement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) und [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span><span class="sxs-lookup"><span data-stu-id="859ba-123">You can search for descendant elements by using methods, such as [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) and [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span></span>

> [!Note]  
> <span data-ttu-id="859ba-124">Im Allgemeinen sollten Sie versuchen, nur direkte untergeordnete Elemente des Root-Elements abzurufen.</span><span class="sxs-lookup"><span data-stu-id="859ba-124">In general, you should try to obtain only direct children of the root element.</span></span> <span data-ttu-id="859ba-125">Bei einer Suche nach Nachfolgern können Hunderte oder Tausende von Elementen durchlaufen werden.</span><span class="sxs-lookup"><span data-stu-id="859ba-125">A search for descendants may iterate through hundreds or thousands of elements.</span></span> <span data-ttu-id="859ba-126">Wenn Sie versuchen, ein bestimmtes Element auf einer niedrigeren Ebene abzurufen, sollten Sie die Suche aus dem Anwendungsfenster oder aus einem Container auf niedrigerer Ebene starten.</span><span class="sxs-lookup"><span data-stu-id="859ba-126">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>

 

## <a name="conditions"></a><span data-ttu-id="859ba-127">Bedingungen</span><span class="sxs-lookup"><span data-stu-id="859ba-127">Conditions</span></span>

<span data-ttu-id="859ba-128">Für die meisten Techniken, die Sie verwenden, um Benutzeroberflächenautomatisierungs-Elemente abzurufen, müssen Sie eine Bedingung angeben.</span><span class="sxs-lookup"><span data-stu-id="859ba-128">For most techniques you use to retrieve UI Automation elements, you must specify a condition.</span></span> <span data-ttu-id="859ba-129">Eine Bedingung besteht aus einer Reihe von Kriterien, die die Elemente definieren, die Sie abrufen möchten.</span><span class="sxs-lookup"><span data-stu-id="859ba-129">A condition is a set of criteria that defines the elements that you want to retrieve.</span></span> <span data-ttu-id="859ba-130">Eine Bedingung wird durch die [**iuiautomationcondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) -Schnittstelle dargestellt.</span><span class="sxs-lookup"><span data-stu-id="859ba-130">A condition is represented by the [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) interface.</span></span>

<span data-ttu-id="859ba-131">Die einfachste Bedingung ist die true-Bedingung, bei der es sich um ein vordefiniertes Objekt handelt, das angibt, dass alle Elemente im Suchbereich zurückgegeben werden sollen.</span><span class="sxs-lookup"><span data-stu-id="859ba-131">The simplest condition is the true condition, which is a predefined object that specifies that all elements in the search scope are to be returned.</span></span> <span data-ttu-id="859ba-132">Die false-Bedingung ist die Umkehrung der true-Bedingung und ist weniger nützlich, da Sie verhindert, dass Elemente gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="859ba-132">The false condition is the inverse of the true condition and is less useful, because it would prevent any elements from being found.</span></span> <span data-ttu-id="859ba-133">Sie können eine Schnittstelle zu der true-Bedingung mithilfe von [**iuiautomation:: kreatetruecondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition)abrufen.</span><span class="sxs-lookup"><span data-stu-id="859ba-133">You can obtain an interface to the true condition by using [**IUIAutomation::CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span></span>

<span data-ttu-id="859ba-134">Drei weitere vordefinierte Bedingungen, die als Eigenschaften für das [**iuiautomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) -Objekt verfügbar sind, können allein oder in Kombination mit anderen Bedingungen verwendet werden: [**iuiautomation:: ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition)und [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span><span class="sxs-lookup"><span data-stu-id="859ba-134">Three other predefined conditions, available as properties on the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) object, can be used alone or in combination with other conditions: [**IUIAutomation::ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition), and [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span></span> <span data-ttu-id="859ba-135">**RawViewCondition**, das von sich selbst verwendet wird, entspricht der true-Bedingung, da es keine Elemente nach [**den Eigenschaften**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) [**iuiautomationelement::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) Currency.</span><span class="sxs-lookup"><span data-stu-id="859ba-135">**RawViewCondition**, used by itself, is equivalent to the true condition, because it does not filter elements by the [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) or [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) properties.</span></span>

<span data-ttu-id="859ba-136">Andere Bedingungen werden aus Bedingungs Objekten erstellt, von denen jedes einen Eigenschafts Wert angibt.</span><span class="sxs-lookup"><span data-stu-id="859ba-136">Other conditions are built from condition objects, each of which specifies a property value.</span></span> <span data-ttu-id="859ba-137">Beispielsweise kann eine Eigenschafts Bedingung angeben, dass das Element aktiviert ist oder ein bestimmtes Steuerelement Muster unterstützt.</span><span class="sxs-lookup"><span data-stu-id="859ba-137">For example, a property condition might specify that the element is enabled or that it supports a certain control pattern.</span></span>

<span data-ttu-id="859ba-138">Bedingungen, die boolesche Logik verwenden, können kombiniert werden, indem [**iuiautomation:: createandcondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**createorcondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**createnotcondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition)und verwandte Methoden aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="859ba-138">Conditions that use Boolean logic can be combined by calling [**IUIAutomation::CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition), and related methods.</span></span>

## <a name="search-scope"></a><span data-ttu-id="859ba-139">Suchbereich</span><span class="sxs-lookup"><span data-stu-id="859ba-139">Search Scope</span></span>

<span data-ttu-id="859ba-140">Suchvorgänge, die mit [**iuiautomationelement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) oder [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) ausgeführt werden, müssen über einen Bereich und einen Ausgangspunkt verfügen.</span><span class="sxs-lookup"><span data-stu-id="859ba-140">Searches that are performed by using [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) or [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) must have a scope and a starting place.</span></span>

> [!Note]  
> <span data-ttu-id="859ba-141">Alle Kommentare zu diesen beiden Methoden gelten auch für [**iuiautomationelement:: findfirstbuildcache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) und [**findallbuildcache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span><span class="sxs-lookup"><span data-stu-id="859ba-141">Any commentary about these two methods also applies to [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) and [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span></span>

 

<span data-ttu-id="859ba-142">Der Bereich definiert den Leerraum um den Startort, der durchsucht werden soll.</span><span class="sxs-lookup"><span data-stu-id="859ba-142">The scope defines the space around the starting place that is to be searched.</span></span> <span data-ttu-id="859ba-143">Dies kann das Element selbst, seine gleich geordneten Elemente, das übergeordnete Element, seine unmittelbaren untergeordneten Elemente und seine Nachfolger enthalten.</span><span class="sxs-lookup"><span data-stu-id="859ba-143">This might include the element itself, its siblings, its parent, its immediate children, and its descendants.</span></span> <span data-ttu-id="859ba-144">Beachten Sie, dass die **Suchmethoden das Durchsuchen der Microsoft** UI Automation-Struktur nicht unterstützen. Das heißt, dass die Suche nach Vorgänger Elementen nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="859ba-144">Be aware that the **Find** methods do not support searching up the Microsoft UI Automation tree; that is, searching for ancestor elements is not supported.</span></span>

<span data-ttu-id="859ba-145">Der Bereich einer Suche wird durch eine bitweise Kombination von Werten aus dem [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) -enumerierten Typ definiert.</span><span class="sxs-lookup"><span data-stu-id="859ba-145">The scope of a search is defined by a bitwise combination of values from the [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) enumerated type.</span></span>

## <a name="finding-a-known-element"></a><span data-ttu-id="859ba-146">Suchen nach einem bekannten Element</span><span class="sxs-lookup"><span data-stu-id="859ba-146">Finding a Known Element</span></span>

<span data-ttu-id="859ba-147">Um nach einem bekannten Element zu suchen, das anhand des Namens, der Automatisierungs-ID oder einer anderen Eigenschaft oder Kombination von Eigenschaften identifiziert wird, ist es am einfachsten, die [**iuiautomationelement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) -Methode zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="859ba-147">To find a known element that is identified by name, automation ID, or some other property or combination of properties, it is easiest to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) method.</span></span> <span data-ttu-id="859ba-148">Wenn das gesuchte Element ein Anwendungsfenster ist, kann der Ausgangspunkt der Suche das Stamm Element sein.</span><span class="sxs-lookup"><span data-stu-id="859ba-148">If the element sought is an application window, the starting point of the search can be the root element.</span></span>

<span data-ttu-id="859ba-149">Diese Art der Suche nach Benutzeroberflächenautomatisierungs-Elementen ist in automatisierten Testszenarien besonders nützlich.</span><span class="sxs-lookup"><span data-stu-id="859ba-149">This way of finding UI Automation elements is most useful in automated testing scenarios.</span></span>

<span data-ttu-id="859ba-150">Ein Codebeispiel, in dem gezeigt wird, wie ein Wissenselement gefunden wird, finden Sie untersuchen [eines Elements nach Namen](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="859ba-150">For a code example that shows how to find a know element, see [Finding an Element by Name](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="859ba-151">Suchen nach Elementen in einer Unterstruktur</span><span class="sxs-lookup"><span data-stu-id="859ba-151">Finding Elements in a Subtree</span></span>

<span data-ttu-id="859ba-152">Um alle Elemente zu finden, die bestimmte Kriterien erfüllen und mit einem bekannten Element verknüpft sind, können Sie [**iuiautomationelement:: FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) für das bekannte Element aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="859ba-152">To find all elements that meet specific criteria and are related to a known element, you can call [**IUIAutomationElement::FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) on the known element.</span></span> <span data-ttu-id="859ba-153">Verwenden Sie diese Methode z. b., um Listenelemente oder Menü Elemente aus einer Liste oder einem Menü abzurufen oder um alle Steuerelemente in einem Dialogfeld zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="859ba-153">For example, use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>

<span data-ttu-id="859ba-154">Ein Codebeispiel, das zeigt, wie Elemente in einer Unterstruktur gesucht werden, finden Sie untersuchen [verwandter Elemente](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="859ba-154">For a code example that shows how to find elements in a subtree, see [Finding Related Elements](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="walking-a-subtree"></a><span data-ttu-id="859ba-155">Durchlaufen einer Unterstruktur</span><span class="sxs-lookup"><span data-stu-id="859ba-155">Walking a Subtree</span></span>

<span data-ttu-id="859ba-156">Wenn Sie keine Vorkenntnisse zu den Anwendungen haben, mit denen Ihr Client möglicherweise verwendet wird, können Sie mithilfe von [**iuiautomationtreewalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker)eine Unterstruktur aller relevanten Elemente erstellen.</span><span class="sxs-lookup"><span data-stu-id="859ba-156">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span></span> <span data-ttu-id="859ba-157">Der Client kann dies beispielsweise als Reaktion auf ein Ereignis mit Fokus Änderung durchführen. Das heißt, wenn eine Anwendung oder ein Steuerelement den Eingabefokus erhält, überprüft der Benutzeroberflächenautomatisierungs-Client untergeordnete Elemente und möglicherweise alle nachfolgenden Elemente des Fokus Elements</span><span class="sxs-lookup"><span data-stu-id="859ba-157">Your client might do this, for example, in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>

<span data-ttu-id="859ba-158">Beachten Sie, dass das Durchlaufen der Benutzeroberflächenautomatisierungs-strukturressourcen intensiv ist.</span><span class="sxs-lookup"><span data-stu-id="859ba-158">Be aware that walking the UI Automation tree is resource-intensive.</span></span> <span data-ttu-id="859ba-159">Durchlaufen Sie die Struktur nur, wenn es nicht möglich ist, die [**iuiautomationelement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst)-, [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall)-oder [**buildupdatedcache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) -Methoden zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="859ba-159">Walk the tree only when it is not feasible to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall), or [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) methods.</span></span>

<span data-ttu-id="859ba-160">Sie können einen eigenen Baum Durchlauf definieren, indem Sie eine benutzerdefinierte Bedingung an [**iuiautomation:: | atetreewalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker)übergeben, oder Sie können eines der folgenden vordefinierten Objekte verwenden, die als Eigenschaften der [**iuiautomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation)-Basis definiert sind.</span><span class="sxs-lookup"><span data-stu-id="859ba-160">You can define your own tree walker by passing a custom condition to [**IUIAutomation::CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker), or you can use one of the following predefined objects that are defined as properties of the base [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation).</span></span>



| <span data-ttu-id="859ba-161">Object</span><span class="sxs-lookup"><span data-stu-id="859ba-161">Object</span></span>                                                              | <span data-ttu-id="859ba-162">Zweck</span><span class="sxs-lookup"><span data-stu-id="859ba-162">Purpose</span></span>                                                                                                                                                      |
|---------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="859ba-163">**ContentViewWalker**</span><span class="sxs-lookup"><span data-stu-id="859ba-163">**ContentViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) | <span data-ttu-id="859ba-164">Sucht nur nach Elementen, deren [**iuiautomationelement:: Currency-ContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) -Eigenschaft den Wert **true** hat.</span><span class="sxs-lookup"><span data-stu-id="859ba-164">Finds only elements whose [**IUIAutomationElement::CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="859ba-165">**ControlViewWalker**</span><span class="sxs-lookup"><span data-stu-id="859ba-165">**ControlViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) | <span data-ttu-id="859ba-166">Sucht nur nach Elementen, deren [**iuiautomationelement::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) -Eigenschaft auf **true** festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="859ba-166">Finds only elements whose [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="859ba-167">**RawViewWalker**</span><span class="sxs-lookup"><span data-stu-id="859ba-167">**RawViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker)         | <span data-ttu-id="859ba-168">Sucht nach allen Elementen.</span><span class="sxs-lookup"><span data-stu-id="859ba-168">Finds all elements.</span></span>                                                                                                                                          |



 

<span data-ttu-id="859ba-169">Nachdem Sie einen [**iuiautomationtreewalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker)erhalten haben, rufen Sie die **iuiautomationtreewalker:: GetXXX** -Methoden auf, um die Elemente der Unterstruktur zu navigieren, und übergeben Sie das-Element, von dem Sie mit dem durchlaufen beginnen.</span><span class="sxs-lookup"><span data-stu-id="859ba-169">After you obtain an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), call the **IUIAutomationTreeWalker::GetXxx** methods to navigate elements of the subtree, passing in the element from which to start walking.</span></span>

<span data-ttu-id="859ba-170">Die [**iuiautomationtreewalker:: normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) -Methode kann verwendet werden, um zu einem Element in der Teilstruktur von einem anderen Element zu navigieren, das nicht Teil der Ansicht ist.</span><span class="sxs-lookup"><span data-stu-id="859ba-170">The [**IUIAutomationTreeWalker::Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="859ba-171">Nehmen Sie beispielsweise an, Sie erstellen eine Ansicht einer Unterstruktur mithilfe von [**iuiautomation:: ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span><span class="sxs-lookup"><span data-stu-id="859ba-171">For example, suppose you create a view of a subtree by using [**IUIAutomation::ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span></span> <span data-ttu-id="859ba-172">Die Anwendung empfängt eine Benachrichtigung, dass eine Scrollleiste den Eingabefokus erhalten hat.</span><span class="sxs-lookup"><span data-stu-id="859ba-172">Your application receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="859ba-173">Weil eine Scrolllaufleiste aber kein Inhaltselement ist, fehlt sie in Ihrer Ansicht der Unterstruktur.</span><span class="sxs-lookup"><span data-stu-id="859ba-173">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="859ba-174">Sie können jedoch das [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) , das die Bild Lauf Leiste darstellt, an **iuiautomationtreewalker:: normalize** übergeben und den nächsten Vorgänger in der Inhaltsansicht abrufen.</span><span class="sxs-lookup"><span data-stu-id="859ba-174">However, you can pass the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the scroll bar to **IUIAutomationTreeWalker::Normalize** and retrieve the nearest ancestor that is in the content view.</span></span>

<span data-ttu-id="859ba-175">Codebeispiele, die zeigen, wie die [**iuiautomationtreewalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) -Schnittstelle verwendet wird, finden Sie unter Gewusst wie: durch [laufen der Benutzeroberflächenautomatisierungs](uiauto-howto-walk-uiautomation-tree.md)-Struktur</span><span class="sxs-lookup"><span data-stu-id="859ba-175">For code examples that show how to use the [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface, see [How to Walk the UI Automation Tree](uiauto-howto-walk-uiautomation-tree.md).</span></span>

## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="859ba-176">Weitere Möglichkeiten zum Abrufen eines Elements</span><span class="sxs-lookup"><span data-stu-id="859ba-176">Other Ways to Retrieve an Element</span></span>

<span data-ttu-id="859ba-177">Zusätzlich zu Such Vorgängen und Navigation können Sie ein [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) wie folgt abrufen.</span><span class="sxs-lookup"><span data-stu-id="859ba-177">In addition to searches and navigation, you can retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) in the following ways.</span></span>

### <a name="from-an-event"></a><span data-ttu-id="859ba-178">Über ein Ereignis</span><span class="sxs-lookup"><span data-stu-id="859ba-178">From an Event</span></span>

<span data-ttu-id="859ba-179">Wenn Ihre Anwendung ein Benutzeroberflächenautomatisierungs-Ereignis empfängt, wird das an den Ereignishandler über gegebene Quell Objekt durch ein [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement)dargestellt.</span><span class="sxs-lookup"><span data-stu-id="859ba-179">When your application receives a UI Automation event, the source object passed to your event handler is represented by an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span></span> <span data-ttu-id="859ba-180">Wenn Sie z. b. Ereignisse mit Fokus Änderung abonnieren, ist die an [**iuiautomationfocuschangedeventhandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) über gegebene Quelle das Element, das den Fokus erhalten hat.</span><span class="sxs-lookup"><span data-stu-id="859ba-180">For example, if you subscribe to focus-changed events, the source passed to your [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) is the element that received the focus.</span></span> <span data-ttu-id="859ba-181">Weitere Informationen finden Sie unter [Abonnieren von Benutzeroberflächenautomatisierungs-Ereignissen](uiauto-eventsforclients.md).</span><span class="sxs-lookup"><span data-stu-id="859ba-181">For more information, see [Subscribing to UI Automation Events](uiauto-eventsforclients.md).</span></span>

### <a name="from-a-point"></a><span data-ttu-id="859ba-182">Über einen Punkt</span><span class="sxs-lookup"><span data-stu-id="859ba-182">From a Point</span></span>

<span data-ttu-id="859ba-183">Wenn Sie ein [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) von Bildschirm Koordinaten abrufen möchten, z. b. eine Cursorposition, verwenden Sie die [**iuiautomation:: elementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) -Methode.</span><span class="sxs-lookup"><span data-stu-id="859ba-183">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from screen coordinates, for example, a cursor position, use the [**IUIAutomation::ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) method.</span></span>

### <a name="from-a-window-handle"></a><span data-ttu-id="859ba-184">Über ein Fensterhandle</span><span class="sxs-lookup"><span data-stu-id="859ba-184">From a Window Handle</span></span>

<span data-ttu-id="859ba-185">Um ein [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) aus einem **HWND** abzurufen, verwenden Sie die [**iuiautomation:: elementfromhandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) -Methode.</span><span class="sxs-lookup"><span data-stu-id="859ba-185">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from an **HWND**, use the [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) method.</span></span>

### <a name="from-the-focused-control"></a><span data-ttu-id="859ba-186">Über das Steuerelement mit Fokus</span><span class="sxs-lookup"><span data-stu-id="859ba-186">From the Focused Control</span></span>

<span data-ttu-id="859ba-187">Zum Abrufen eines [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) , das das Steuerelement mit Fokus darstellt, verwenden Sie die [**iuiautomation:: getfocumindelement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) -Methode.</span><span class="sxs-lookup"><span data-stu-id="859ba-187">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the focused control, use the [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="859ba-188">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="859ba-188">Related topics</span></span>

[<span data-ttu-id="859ba-189">Übersicht über die Benutzeroberflächenautomatisierungs-Struktur</span><span class="sxs-lookup"><span data-stu-id="859ba-189">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)

[<span data-ttu-id="859ba-190">Benutzeroberflächenautomatisierungs-Dokument Inhalts Client-Beispiel-App</span><span class="sxs-lookup"><span data-stu-id="859ba-190">UI Automation document content client sample app</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient)
