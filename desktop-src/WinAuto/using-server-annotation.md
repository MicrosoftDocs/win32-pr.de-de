---
title: Verwenden der Server Anmerkung
description: Dieses Thema enthält Informationen zum Verwenden der Server Anmerkung zum Angeben eines Rückruf Objekts.
ms.assetid: eeeebddc-2752-4d8f-b4fa-38ce156acc08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb545cd4dd016901d69f67d5ab5cab15dda08875
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "106341311"
---
# <a name="using-server-annotation"></a><span data-ttu-id="69f0f-103">Verwenden der Server Anmerkung</span><span class="sxs-lookup"><span data-stu-id="69f0f-103">Using Server Annotation</span></span>

<span data-ttu-id="69f0f-104">Dieses Thema enthält Informationen zum Verwenden der Server Anmerkung zum Angeben eines Rückruf Objekts.</span><span class="sxs-lookup"><span data-stu-id="69f0f-104">This topic provides information about using server annotation to specify a callback object.</span></span>

<span data-ttu-id="69f0f-105">**So überschreiben Sie eine Eigenschaft, die ein Rückruf Objekt angibt**</span><span class="sxs-lookup"><span data-stu-id="69f0f-105">**To override a property that specifies a callback object**</span></span>

1.  <span data-ttu-id="69f0f-106">Abrufen eines [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Schnittstellen Zeigers auf das barrierefreie Element, das mit Anmerkungen versehen werden soll.</span><span class="sxs-lookup"><span data-stu-id="69f0f-106">Obtain an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer to the accessible element that is to be annotated.</span></span>
2.  <span data-ttu-id="69f0f-107">Ruft [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) für das barrierefreie Element auf, um einen [**iaccidentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) -Schnittstellen Zeiger zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="69f0f-107">Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on the accessible element to get an [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer.</span></span>
3.  <span data-ttu-id="69f0f-108">Rufen Sie [**iaccidentity:: getidentitystring ()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) für den [**iaccidentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) -Schnittstellen Zeiger auf, um eine Zeichenfolge abzurufen, die das barrierefreie Element eindeutig identifiziert, das mit Anmerkungen versehen werden soll.</span><span class="sxs-lookup"><span data-stu-id="69f0f-108">Call [**IAccIdentity::GetIdentityString()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) on the [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer to obtain a string that uniquely identifies the accessible element that is to be annotated.</span></span>
4.  <span data-ttu-id="69f0f-109">Verwenden Sie [**cokreateinstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) oder [**cokreateinstanceex**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) zum Erstellen des [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) -Objekts.</span><span class="sxs-lookup"><span data-stu-id="69f0f-109">Use [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) to create the [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) object.</span></span>
5.  <span data-ttu-id="69f0f-110">Erstellen Sie ein Component Object Model (com)-Objekt, das [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver)implementiert.</span><span class="sxs-lookup"><span data-stu-id="69f0f-110">Create a Component Object Model (COM) object that implements [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span></span>
6.  <span data-ttu-id="69f0f-111">Rufen Sie [**IAccPropServices:: SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver)auf, und übergeben Sie dabei die Identitäts Zeichenfolge, eine GUID, die die zu über schreibende Eigenschaft angibt, und einen Zeiger auf das [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) -Rückruf Objekt.</span><span class="sxs-lookup"><span data-stu-id="69f0f-111">Call [**IAccPropServices::SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), passing the identity string, a GUID indicating the property to be overridden, and a pointer to the [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) callback object.</span></span>
7.  <span data-ttu-id="69f0f-112">Freigeben von Schnittstellen Zeigern und freiem Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="69f0f-112">Release interface pointers and free memory.</span></span>

<span data-ttu-id="69f0f-113">Wenn ein Client die-Eigenschaft des barrierefreien Elements anfordert, wird das Rückruf Objekt aufgerufen, und der Wert wird an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="69f0f-113">When a client requests the property of the accessible element, the callback object will be called and will return the value to the client.</span></span>

<span data-ttu-id="69f0f-114">Wie beim Angeben eines Werts können Server Entwickler alternativ die [**IAccPropServices:: composehwndidentitystring**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) -Methode verwenden, um eine Identitäts Zeichenfolge abzurufen. oder Sie können die [**IAccPropServices:: Server**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) -Methode verwenden und die Parameter " *HWND*", " *idobject*" und " *idchild* " anstelle einer Identitäts Zeichenfolge angeben.</span><span class="sxs-lookup"><span data-stu-id="69f0f-114">As when specifying a value, server developers can alternatively use the [**IAccPropServices::ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) method to obtain an identity string; or they can use the [**IAccPropServices::SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) method and specify the *hwnd*, *idObject*, or *idChild* parameters instead of an identity string.</span></span>

<span data-ttu-id="69f0f-115">Bei Verwendung von [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) oder [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) für ein Container Objekt können Server Entwickler optional festlegen, dass die über schreibenden Informationen auch auf alle untergeordneten Elemente dieses Containers angewendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="69f0f-115">When using either [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) or [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) on a container object, server developers can optionally specify that the overriding information should also apply to all element children of that container.</span></span>

<span data-ttu-id="69f0f-116">Server können die Anmerkung jederzeit mithilfe von [**IAccPropServices:: Clear-**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops)Eigenschaften explizit löschen.</span><span class="sxs-lookup"><span data-stu-id="69f0f-116">Servers can explicitly clear the annotation at any time by using [**IAccPropServices::ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span></span> <span data-ttu-id="69f0f-117">Dies ist in der Regel nicht erforderlich, da der Anmerkung-Dienst Anmerkung-Informationen automatisch bereinigt und freigibt, wenn das barrierefreie Element, das mit Anmerkungen versehen wird, nicht mehr angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="69f0f-117">This is usually not required, as the annotation service will automatically clean up and release annotation information when the accessible element being annotated disappears.</span></span>

<span data-ttu-id="69f0f-118">Im folgenden finden Sie eine Liste der Eigenschaften, die mit dieser Prozedur kommentiert werden können.</span><span class="sxs-lookup"><span data-stu-id="69f0f-118">Below is a list of properties that can be annotated using this procedure.</span></span>

## <a name="properties-supported-when-specifying-a-callback"></a><span data-ttu-id="69f0f-119">Unterstützte Eigenschaften beim Angeben eines Rückrufs</span><span class="sxs-lookup"><span data-stu-id="69f0f-119">Properties Supported When Specifying a Callback</span></span>

<span data-ttu-id="69f0f-120">Beim Angeben eines Rückrufs können die folgenden Eigenschaften mit Anmerkungen versehen werden.</span><span class="sxs-lookup"><span data-stu-id="69f0f-120">When specifying a callback, the following properties can be annotated.</span></span> <span data-ttu-id="69f0f-121">Zurzeit können diese Eigenschaften nicht direkt mit Anmerkungen versehen werden, indem ein-Wert angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="69f0f-121">Currently these properties cannot be annotated directly by specifying a value.</span></span>



| <span data-ttu-id="69f0f-122">Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="69f0f-122">Property</span></span>                      | <span data-ttu-id="69f0f-123">type</span><span class="sxs-lookup"><span data-stu-id="69f0f-123">Type</span></span>                                                             |
|-------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="69f0f-124">Name des PROPID- \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="69f0f-124">PROPID\_ACC\_NAME</span></span>             | <span data-ttu-id="69f0f-125">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="69f0f-125">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="69f0f-126">Beschreibung des PROPID- \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="69f0f-126">PROPID\_ACC\_DESCRIPTION</span></span>      | <span data-ttu-id="69f0f-127">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="69f0f-127">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="69f0f-128">PROPID- \_ Rolle "ACC" \_</span><span class="sxs-lookup"><span data-stu-id="69f0f-128">PROPID\_ACC\_ROLE</span></span>             | <span data-ttu-id="69f0f-129">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-129">VT\_I4</span></span>                                                           |
| <span data-ttu-id="69f0f-130">Status des PROPID- \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="69f0f-130">PROPID\_ACC\_STATE</span></span>            | <span data-ttu-id="69f0f-131">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-131">VT\_I4</span></span>                                                           |
| <span data-ttu-id="69f0f-132">PROPID \_ - \_ Hilfe zum ACC</span><span class="sxs-lookup"><span data-stu-id="69f0f-132">PROPID\_ACC\_HELP</span></span>             | <span data-ttu-id="69f0f-133">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="69f0f-133">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="69f0f-134">PROPID \_ ACC \_ KeyboardShortcut</span><span class="sxs-lookup"><span data-stu-id="69f0f-134">PROPID\_ACC\_KEYBOARDSHORTCUT</span></span> | <span data-ttu-id="69f0f-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="69f0f-135">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="69f0f-136">PROPID \_ ACC \_ DEFAULTACTION</span><span class="sxs-lookup"><span data-stu-id="69f0f-136">PROPID\_ACC\_DEFAULTACTION</span></span>    | <span data-ttu-id="69f0f-137">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="69f0f-137">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="69f0f-138">PROPID- \_ ACC ( \_ ValueMap)</span><span class="sxs-lookup"><span data-stu-id="69f0f-138">PROPID\_ACC\_VALUEMAP</span></span>         | <span data-ttu-id="69f0f-139">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="69f0f-139">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="69f0f-140">PROPID- \_ ACC- \_ rolemap</span><span class="sxs-lookup"><span data-stu-id="69f0f-140">PROPID\_ACC\_ROLEMAP</span></span>          | <span data-ttu-id="69f0f-141">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="69f0f-141">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="69f0f-142">PROPID- \_ ACC- \_ statemap</span><span class="sxs-lookup"><span data-stu-id="69f0f-142">PROPID\_ACC\_STATEMAP</span></span>         | <span data-ttu-id="69f0f-143">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="69f0f-143">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="69f0f-144">PROPID- \_ ACC- \_ Fokus</span><span class="sxs-lookup"><span data-stu-id="69f0f-144">PROPID\_ACC\_FOCUS</span></span>            | <span data-ttu-id="69f0f-145">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-145">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-146">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-146">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="69f0f-147">PROPID- \_ ACC- \_ Auswahl</span><span class="sxs-lookup"><span data-stu-id="69f0f-147">PROPID\_ACC\_SELECTION</span></span>        | <span data-ttu-id="69f0f-148">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-148">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-149">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-149">VT\_I4</span></span><br/> <span data-ttu-id="69f0f-150">VT \_ unbekannt</span><span class="sxs-lookup"><span data-stu-id="69f0f-150">VT\_UNKNOWN</span></span><br/> |
| <span data-ttu-id="69f0f-151">PROPID- \_ ACC über \_ geordnetes Element</span><span class="sxs-lookup"><span data-stu-id="69f0f-151">PROPID\_ACC\_PARENT</span></span>           | <span data-ttu-id="69f0f-152">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-152">VT\_DISPATCH</span></span>                                                     |
| <span data-ttu-id="69f0f-153">PROPID-ACC-Navigations- \_ \_ \_ up</span><span class="sxs-lookup"><span data-stu-id="69f0f-153">PROPID\_ACC\_NAV\_UP</span></span>          | <span data-ttu-id="69f0f-154">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-154">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-155">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-155">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="69f0f-156">PROPID-ACC-Navigationsbereich \_ \_ \_</span><span class="sxs-lookup"><span data-stu-id="69f0f-156">PROPID\_ACC\_NAV\_DOWN</span></span>        | <span data-ttu-id="69f0f-157">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-157">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-158">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-158">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="69f0f-159">PROPID- \_ ACC- \_ NAV \_ Links</span><span class="sxs-lookup"><span data-stu-id="69f0f-159">PROPID\_ACC\_NAV\_LEFT</span></span>        | <span data-ttu-id="69f0f-160">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-160">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-161">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-161">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="69f0f-162">PROPID-ACC-Navigations \_ \_ \_ Recht</span><span class="sxs-lookup"><span data-stu-id="69f0f-162">PROPID\_ACC\_NAV\_RIGHT</span></span>       | <span data-ttu-id="69f0f-163">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-163">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-164">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-164">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="69f0f-165">PROPID- \_ ACC- \_ NAV- \_ Prev</span><span class="sxs-lookup"><span data-stu-id="69f0f-165">PROPID\_ACC\_NAV\_PREV</span></span>        | <span data-ttu-id="69f0f-166">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-166">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-167">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-167">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="69f0f-168">PROPID- \_ ACC- \_ NAV \_ als nächstes</span><span class="sxs-lookup"><span data-stu-id="69f0f-168">PROPID\_ACC\_NAV\_NEXT</span></span>        | <span data-ttu-id="69f0f-169">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-169">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-170">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-170">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="69f0f-171">PROPID- \_ ACC- \_ NAV ( \_ FirstChild)</span><span class="sxs-lookup"><span data-stu-id="69f0f-171">PROPID\_ACC\_NAV\_FIRSTCHILD</span></span>  | <span data-ttu-id="69f0f-172">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-172">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-173">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-173">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="69f0f-174">PROPID- \_ ACC- \_ NAV- \_ LastChild</span><span class="sxs-lookup"><span data-stu-id="69f0f-174">PROPID\_ACC\_NAV\_LASTCHILD</span></span>   | <span data-ttu-id="69f0f-175">VT \_ -Verteilung</span><span class="sxs-lookup"><span data-stu-id="69f0f-175">VT\_DISPATCH</span></span><br/> <span data-ttu-id="69f0f-176">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="69f0f-176">VT\_I4</span></span><br/>                        |



 

 

