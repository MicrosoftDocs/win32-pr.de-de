---
title: Hosten eines Windows-losen ActiveX-Steuer Elements mit MSAA
description: Erfahren Sie, wie Sie einen Steuerelement Container erstellen, der fensterlose Microsoft-ActiveX-Steuerelemente hosten kann, die Microsoft Active Accessibility implementieren.
ms.assetid: 9497561C-37ED-4094-A6B0-C219F63C04B6
keywords:
- MSAA, fensterloses ActiveX-Steuerelement
- Fensterloses ActiveX-Steuerelement, MSAA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9de45313b19490af3c3fffb633f3822ad93d25a4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "103727521"
---
# <a name="how-to-host-an-msaa-windowless-activex-control"></a><span data-ttu-id="86695-105">Hosten eines Windows-losen ActiveX-Steuer Elements mit MSAA</span><span class="sxs-lookup"><span data-stu-id="86695-105">How to Host an MSAA Windowless ActiveX Control</span></span>

<span data-ttu-id="86695-106">Erfahren Sie, wie Sie einen Steuerelement Container erstellen, der fensterlose Microsoft-ActiveX-Steuerelemente hosten kann, die Microsoft Active Accessibility implementieren.</span><span class="sxs-lookup"><span data-stu-id="86695-106">Learn how to create a control container that can host windowless Microsoft ActiveX controls that implement Microsoft Active Accessibility.</span></span> <span data-ttu-id="86695-107">Wenn Sie die hier beschriebenen Schritte ausführen, können Sie sicherstellen, dass alle auf Microsoft Active Accessibility basierten, fensterlosen Steuerelemente, die in Ihrem Steuerelement Container gehostet werden, für die Hilfstechnologie (at)-Client Anwendungen verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="86695-107">By following the steps described here, you can ensure that any Microsoft Active Accessibility-based windowless controls that are hosted in your control container are accessible to assistive technology (AT) client applications.</span></span>

## <a name="what-you-need-to-know"></a><span data-ttu-id="86695-108">Was Sie wissen müssen</span><span class="sxs-lookup"><span data-stu-id="86695-108">What you need to know</span></span>

### <a name="technologies"></a><span data-ttu-id="86695-109">Technologien</span><span class="sxs-lookup"><span data-stu-id="86695-109">Technologies</span></span>

-   [<span data-ttu-id="86695-110">ActiveX-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="86695-110">ActiveX Controls</span></span>](/windows/desktop/com/activex-controls)
-   [<span data-ttu-id="86695-111">Microsoft Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="86695-111">Microsoft Active Accessibility</span></span>](microsoft-active-accessibility.md)

### <a name="prerequisites"></a><span data-ttu-id="86695-112">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="86695-112">Prerequisites</span></span>

-   <span data-ttu-id="86695-113">C/C++</span><span class="sxs-lookup"><span data-stu-id="86695-113">C/C++</span></span>
-   <span data-ttu-id="86695-114">Programmierung von Microsoft Win32 und Component Object Model (com)</span><span class="sxs-lookup"><span data-stu-id="86695-114">Microsoft Win32 and Component Object Model (COM) programming</span></span>
-   <span data-ttu-id="86695-115">Fensterlose ActiveX-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="86695-115">Windowless ActiveX controls</span></span>
-   <span data-ttu-id="86695-116">Microsoft Active Accessibility-Server</span><span class="sxs-lookup"><span data-stu-id="86695-116">Microsoft Active Accessibility servers</span></span>

## <a name="instructions"></a><span data-ttu-id="86695-117">Anweisungen</span><span class="sxs-lookup"><span data-stu-id="86695-117">Instructions</span></span>

### <a name="step-1-provide-the-root-iaccessible-interface-on-behalf-of-the-windowless-control"></a><span data-ttu-id="86695-118">Schritt 1: Stellen Sie die Schnittstelle "IAccessible" im Namen des fensterlosen Steuer Elements bereit.</span><span class="sxs-lookup"><span data-stu-id="86695-118">Step 1: Provide the root IAccessible interface on behalf of the windowless control.</span></span>

<span data-ttu-id="86695-119">Wenn das System den [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Zeiger für den Stamm eines fensterlosen Steuer Elements benötigt, fragt das System den Steuerelement Container ab.</span><span class="sxs-lookup"><span data-stu-id="86695-119">Whenever the system needs the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) pointer for the root of a windowless control, the system queries the control container.</span></span> <span data-ttu-id="86695-120">Zum Abrufen des Zeigers ruft der Container die Implementierung der [**IServiceProvider:: QueryService**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/cc678966(v=vs.85)) -Methode des fensterlosen Steuer Elements auf.</span><span class="sxs-lookup"><span data-stu-id="86695-120">To retrieve the pointer, the container calls the windowless control's implementation of the [**IServiceProvider::QueryService**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/cc678966(v=vs.85)) method.</span></span>

<span data-ttu-id="86695-121">Wenn der Steuerelement Container über eine Microsoft Active Accessibility-Implementierung verfügt, kann er den [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Zeiger des fensterlosen Steuer Elements auf das System zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="86695-121">If the control container has a Microsoft Active Accessibility implementation, it can return the windowless control's [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) pointer to the system.</span></span>

<span data-ttu-id="86695-122">Wenn der Steuerelement Container eine Microsoft UI Automation-Implementierung aufweist, rufen Sie die [**uiaproviderfromiaccessible**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaproviderfromiaccessible) -Funktion auf, um einen [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) -Schnittstellen Zeiger zu erhalten, der das Steuerelement darstellt, und geben Sie dann den **IRawElementProviderSimple** -Schnittstellen Zeiger an das System zurück.</span><span class="sxs-lookup"><span data-stu-id="86695-122">If the control container has a Microsoft UI Automation implementation, call the [**UiaProviderFromIAccessible**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaproviderfromiaccessible) function to obtain an [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface pointer that represents the control, and then return the **IRawElementProviderSimple** interface pointer to the system.</span></span>

### <a name="step-2-respond-to-the-wm_getobject-message-on-behalf-of-the-windowless-control"></a><span data-ttu-id="86695-123">Schritt 2: Antworten auf die WM- \_ GetObject-Nachricht im Namen des fensterlosen Steuer Elements.</span><span class="sxs-lookup"><span data-stu-id="86695-123">Step 2: Respond to the WM\_GETOBJECT message on behalf of the windowless control.</span></span>

<span data-ttu-id="86695-124">Wenn eine Client Anwendung auf ein WinEvent antwortet, das von einem fensterlosen Steuerelement ausgelöst wird, empfängt der Steuerelement Container eine [**WM- \_ GetObject**](wm-getobject.md) -Nachricht für das Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="86695-124">When a client application responds to a WinEvent raised by a windowless control, the control container receives a [**WM\_GETOBJECT**](wm-getobject.md) message on behalf of the control.</span></span> <span data-ttu-id="86695-125">Die Meldung enthält die Objekt-ID des fensterlosen Steuer Elements, das das Ereignis ausgelöst hat.</span><span class="sxs-lookup"><span data-stu-id="86695-125">The message includes the object ID of the windowless control that raised the event.</span></span>

<span data-ttu-id="86695-126">Der Steuerelement Container antwortet, indem er das fensterlose Steuerelement sucht, das die Objekt-ID besitzt, und dann die [**iaccessibleobjectfromid**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessiblehandler-accessibleobjectfromid) -Methode dieses Steuer Elements aufruft.</span><span class="sxs-lookup"><span data-stu-id="86695-126">The control container responds by looking up the windowless control that "owns" the object ID, and then calling that control's [**IAccessibleHandler::AccessibleObjectFromID**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessiblehandler-accessibleobjectfromid) method.</span></span> <span data-ttu-id="86695-127">Die **AccessibleObjectFromID** -Methode gibt den [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Schnittstellen Zeiger für das UI-Element zurück, und der Steuerelement Container gibt den Zeiger auf das System zurück, das diese an die Client Anwendung weiterleitet.</span><span class="sxs-lookup"><span data-stu-id="86695-127">The **AccessibleObjectFromID** method returns the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer for the UI item, and the control container returns the pointer to the system, which forwards it to the client application.</span></span>

### <a name="step-3-implement-the-iaccessiblewindowlesssite-interface"></a><span data-ttu-id="86695-128">Schritt 3: Implementieren Sie die iaccessiblewindowlesssite-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="86695-128">Step 3: Implement the IAccessibleWindowlessSite interface.</span></span>

1.  <span data-ttu-id="86695-129">Implementieren Sie die [**iaccessiblewindowlesssite:: getparameentaccessible**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-getparentaccessible) -Methode.</span><span class="sxs-lookup"><span data-stu-id="86695-129">Implement the [**IAccessibleWindowlessSite::GetParentAccessible**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-getparentaccessible) method.</span></span>

    <span data-ttu-id="86695-130">Wenn eine Client Anwendung Barrierefreiheits Informationen über das übergeordnete Element des Stamm Anbieters des fensterlosen Steuer Elements benötigt, ruft das System die [**IAccessible:: get \_ accParent**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent) -Methode des fensterlosen Steuer Elements auf.</span><span class="sxs-lookup"><span data-stu-id="86695-130">When a client application needs accessibility information about the parent of the windowless control's root provider, the system calls the windowless control's [**IAccessible::get\_accParent**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent) method.</span></span> <span data-ttu-id="86695-131">Das-Steuerelement antwortet, indem er die [**iaccessiblewindowlesssite:: getParser**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-getparentaccessible) -Methode des Steuerelement Containers aufruft, die den [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Zeiger auf das übergeordnete Element des fensterlosen Steuer Elements bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="86695-131">The control responds by calling the control container's [**IAccessibleWindowlessSite::GetParentAccessible**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-getparentaccessible) method, which provides the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) pointer of the windowless control's parent.</span></span>

2.  <span data-ttu-id="86695-132">Implementieren Sie die Methoden [**iaccessiblewindowlesssite:: acquireobjectidrange**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-acquireobjectidrange), [**queryobjectidrange**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-queryobjectidranges)und [**releaseobjectidrange**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-releaseobjectidrange) .</span><span class="sxs-lookup"><span data-stu-id="86695-132">Implement the [**IAccessibleWindowlessSite::AcquireObjectIdRange**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-acquireobjectidrange), [**QueryObjectIdRange**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-queryobjectidranges), and [**ReleaseObjectIdRange**](/windows/desktop/api/oleacc/nf-oleacc-iaccessiblewindowlesssite-releaseobjectidrange) methods.</span></span>

    <span data-ttu-id="86695-133">Der Steuerelement Container muss eine Zuordnung von Objekt-ID-Bereichen zu fensterlosen Steuerelementen aufrechterhalten.</span><span class="sxs-lookup"><span data-stu-id="86695-133">Your control container must maintain a mapping of object ID ranges to windowless controls.</span></span> <span data-ttu-id="86695-134">Die Zuordnung ermöglicht es dem Steuerelement Container, das Steuerelement zu identifizieren, das auf eine bestimmte Anforderung für eine Objekt-ID reagieren soll.</span><span class="sxs-lookup"><span data-stu-id="86695-134">The mapping enables the control container to identify the control that should respond to a particular request for an object ID.</span></span> <span data-ttu-id="86695-135">Die folgende Tabelle zeigt ein Beispiel für das Mapping von Objekt-ID-Bereichen zu fensterlosen Steuerelementen.</span><span class="sxs-lookup"><span data-stu-id="86695-135">The following table shows an example of mapping object ID ranges to windowless controls.</span></span>

    

    | <span data-ttu-id="86695-136">Bereichs Basis</span><span class="sxs-lookup"><span data-stu-id="86695-136">Range base</span></span> | <span data-ttu-id="86695-137">Bereichs Größe</span><span class="sxs-lookup"><span data-stu-id="86695-137">Range size</span></span> | <span data-ttu-id="86695-138">Control</span><span class="sxs-lookup"><span data-stu-id="86695-138">Control</span></span>   |
    |------------|------------|-----------|
    | <span data-ttu-id="86695-139">1000</span><span class="sxs-lookup"><span data-stu-id="86695-139">1000</span></span>       | <span data-ttu-id="86695-140">500</span><span class="sxs-lookup"><span data-stu-id="86695-140">500</span></span>        | <span data-ttu-id="86695-141">Steuerelement 1</span><span class="sxs-lookup"><span data-stu-id="86695-141">Control 1</span></span> |
    | <span data-ttu-id="86695-142">1500</span><span class="sxs-lookup"><span data-stu-id="86695-142">1500</span></span>       | <span data-ttu-id="86695-143">1000</span><span class="sxs-lookup"><span data-stu-id="86695-143">1000</span></span>       | <span data-ttu-id="86695-144">Steuerung 2</span><span class="sxs-lookup"><span data-stu-id="86695-144">Control 2</span></span> |
    | <span data-ttu-id="86695-145">2500</span><span class="sxs-lookup"><span data-stu-id="86695-145">2500</span></span>       | <span data-ttu-id="86695-146">2000</span><span class="sxs-lookup"><span data-stu-id="86695-146">2000</span></span>       | <span data-ttu-id="86695-147">Steuerelement 1</span><span class="sxs-lookup"><span data-stu-id="86695-147">Control 1</span></span> |

    

     

    <span data-ttu-id="86695-148">Der Steuerelement Container muss die Zuordnung von Objekt-ID-Bereichen zu fensterlosen Steuerelementen für sich selbst und alle fensterlosen untergeordneten Elemente aufrechterhalten.</span><span class="sxs-lookup"><span data-stu-id="86695-148">The control container must maintain the mapping of object ID ranges to windowless controls for itself and all windowless children.</span></span> <span data-ttu-id="86695-149">Die Objekt-ID-Bereiche müssen nicht nebeneinander angeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="86695-149">The object ID ranges do not need to be adjacent to one another.</span></span> <span data-ttu-id="86695-150">Um Denial-of-Service-Angriffe zu vermeiden, kann der Steuerelement Container außerdem Grenzwerte für die Anzahl der Bereiche festlegen, die einem bestimmten Steuerelement erteilt werden.</span><span class="sxs-lookup"><span data-stu-id="86695-150">Also, to avoid denial-of-service attacks, the control container can place limits on the number of ranges that are granted to a particular control.</span></span> <span data-ttu-id="86695-151">Es ist jedoch sinnvoll, mehr als einen Bereich pro Steuerelement zuzulassen, damit ein Steuerelement vergrößert werden kann.</span><span class="sxs-lookup"><span data-stu-id="86695-151">However, it is useful to allow more than one range per control, to enable a control to grow.</span></span>

### <a name="step-4-optional-implement-the-iaccessiblehostingelementproviders-interface"></a><span data-ttu-id="86695-152">Schritt 4: optional: Implementieren Sie die iaccessiblehostingelementproviders-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="86695-152">Step 4: Optional: Implement the IAccessibleHostingElementProviders interface.</span></span>

<span data-ttu-id="86695-153">Implementieren Sie die [**iaccessiblehostingelementproviders**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessiblehostingelementproviders) -Schnittstelle, wenn Ihr Steuerelement Container über eine Microsoft Active Accessibility Server-Implementierung verfügt und der Server der Stamm einer Barrierefreiheits Struktur ist, die fensterlose ActiveX-Steuerelemente enthält, die die Benutzeroberflächen Automatisierung unterstützen.</span><span class="sxs-lookup"><span data-stu-id="86695-153">Implement the [**IAccessibleHostingElementProviders**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessiblehostingelementproviders) interface if your control container has a Microsoft Active Accessibility server implementation and the server is the root of an accessibility tree that includes windowless ActiveX controls that support UI Automation.</span></span> <span data-ttu-id="86695-154">Die **iaccessiblehostingelementproviders** -Schnittstelle verfügt über eine einzelne Methode, [**getembeddedfragmentroots**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getembeddedfragmentroots), mit der die [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) -Schnittstellen Zeiger von allen fensterlosen ActiveX-Steuerelementen der Benutzeroberflächen Automatisierung abgerufen werden, die von Ihrem Steuerelement Container gehostet werden.</span><span class="sxs-lookup"><span data-stu-id="86695-154">The **IAccessibleHostingElementProviders** interface has a single method, [**GetEmbeddedFragmentRoots**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getembeddedfragmentroots), which retrieves the [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) interface pointers of all UI Automation windowless ActiveX controls that are hosted by your control container.</span></span>

## <a name="related-topics"></a><span data-ttu-id="86695-155">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="86695-155">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="86695-156">Hosten eines fensterlosen ActiveX-Steuer Elements für die Benutzeroberflächen Automatisierung</span><span class="sxs-lookup"><span data-stu-id="86695-156">How to Host a UI Automation Windowless ActiveX Control</span></span>](host-a-ui-automation-windowless-activex-control.md)
</dt> <dt>

[<span data-ttu-id="86695-157">Barrierefreiheit für das fensterlose ActiveX-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="86695-157">Windowless ActiveX Control Accessibility</span></span>](windowless-activex-control-accessibility.md)
</dt> </dl>

 

 