---
title: Verfügbar machen von Owner-Drawn Listenfeld Elementen
description: Anwendungsentwickler müssen IAccessible nicht implementieren, um die Elemente in einem von einem Besitzer gezeichneten Listenfeld mit dem Format lbs hasstrings verfügbar zu machen, \_ da Microsoft Active Accessibility die Elemente in Listenfeldern in diesem Stil verfügbar macht.
ms.assetid: d54ce297-ce8a-46c0-a86d-4acffa1eda27
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2fbb72285f55796a285cd6e1a8838a629218659b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104390778"
---
# <a name="exposing-owner-drawn-list-box-items"></a><span data-ttu-id="a1647-103">Verfügbar machen von Owner-Drawn Listenfeld Elementen</span><span class="sxs-lookup"><span data-stu-id="a1647-103">Exposing Owner-Drawn List Box Items</span></span>

<span data-ttu-id="a1647-104">Anwendungsentwickler müssen [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) nicht implementieren, um die Elemente in einem von einem Besitzer gezeichneten Listenfeld mit dem Format **lbs \_ hasstrings** verfügbar zu machen, da Microsoft Active Accessibility die Elemente in Listenfeldern in diesem Stil verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="a1647-104">Application developers do not need to implement [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) to expose the items in an owner-drawn list box that has the style **LBS\_HASSTRINGS** because Microsoft Active Accessibility exposes the items in list boxes with this style.</span></span> <span data-ttu-id="a1647-105">Die Elemente in einem vom Besitzer gezeichneten Listenfeld mit dem **lbs \_ hasstrings** -Stil werden als Text angezeigt.</span><span class="sxs-lookup"><span data-stu-id="a1647-105">The items in an owner-drawn list box with the **LBS\_HASSTRINGS** style are displayed as text.</span></span> <span data-ttu-id="a1647-106">Dieser Stil wird jedoch auch mit vom Besitzer gezeichneten Listenfeldern verwendet, in denen kein Text angezeigt wird, sodass die Listenfeld Elemente von Microsoft Active Accessibility verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="a1647-106">However, this style is also used with owner-drawn list boxes that do not display text so that the list box items are exposed by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="a1647-107">Damit Microsoft Active Accessibility, die Elemente in einem von einem Besitzer gezeichneten Listenfeld verfügbar zu machen, das keinen Text anzeigt:</span><span class="sxs-lookup"><span data-stu-id="a1647-107">To allow Microsoft Active Accessibility to expose the items in an owner-drawn list box that does not display text:</span></span>

-   <span data-ttu-id="a1647-108">Verwenden Sie den **lbs \_ hasstrings** -Stil, wenn Sie das Listenfeld erstellen.</span><span class="sxs-lookup"><span data-stu-id="a1647-108">Use the **LBS\_HASSTRINGS** style when creating the list box.</span></span>
-   <span data-ttu-id="a1647-109">Erstellen Sie eine texentsprechung, die jedes Element im Listenfeld benennt oder beschreibt.</span><span class="sxs-lookup"><span data-stu-id="a1647-109">Create a textual counterpart that names or describes each item in the list box.</span></span>
-   <span data-ttu-id="a1647-110">Verwenden Sie beim Hinzufügen von Elementen zum Listenfeld "Besitzer gezeichnet" die [lb- \_ AddString](../controls/lb-addstring.md) -Nachricht, um den Text hinzuzufügen, den Microsoft Active Accessibility verfügbar machen soll.</span><span class="sxs-lookup"><span data-stu-id="a1647-110">When adding items to the owner-drawn list box, use the [LB\_ADDSTRING](../controls/lb-addstring.md) message to add the text that you want Microsoft Active Accessibility to expose.</span></span> <span data-ttu-id="a1647-111">Dieser Text wird nicht angezeigt und ist daher nicht Teil der vom Besitzer gezeichneten Daten.</span><span class="sxs-lookup"><span data-stu-id="a1647-111">This text is not displayed, so it is not part of the owner-drawn data.</span></span> <span data-ttu-id="a1647-112">Fügen Sie die vom Besitzer gezeichneten Elementdaten mithilfe der " [lb \_ ](../controls/lb-setitemdata.md) -Nachricht"-Nachricht hinzu.</span><span class="sxs-lookup"><span data-stu-id="a1647-112">Add the owner-drawn item data using the [LB\_SETITEMDATA](../controls/lb-setitemdata.md) message.</span></span>

<span data-ttu-id="a1647-113">Beachten Sie bei Verwendung der obigen Methode Folgendes:</span><span class="sxs-lookup"><span data-stu-id="a1647-113">When using the above method, note the following:</span></span>

-   <span data-ttu-id="a1647-114">Wenn Sie den **lbs- \_ Sortier** Stil verwenden, wird das Listenfeld mit den angegebenen Zeichen folgen und nicht mit der [WM \_ compareitem](../controls/wm-compareitem.md) -Rückruf Prozedur sortiert.</span><span class="sxs-lookup"><span data-stu-id="a1647-114">If you use the **LBS\_SORT** style, the list box is sorted using the supplied strings and not the [WM\_COMPAREITEM](../controls/wm-compareitem.md) callback procedure.</span></span>
-   <span data-ttu-id="a1647-115">Mit vom Besitzer gezeichneten Variablen Listenfeldern, die mit der Style lbs-Besitzer Zeichenfolge erstellt wurden, verwenden Sie eine globale Variable oder einen anderen Mechanismus, um nachzuverfolgen, wann der **ItemData-Member** der [measureitemstruct](/windows/win32/api/winuser/ns-winuser-measureitemstruct) gültig ist. **\_**</span><span class="sxs-lookup"><span data-stu-id="a1647-115">With owner-drawn variable list boxes created with the style **LBS\_OWNERDRAWVARIABLE**, use a global variable or some other mechanism to keep track of when the **itemData member** of the [MEASUREITEMSTRUCT](/windows/win32/api/winuser/ns-winuser-measureitemstruct) is valid.</span></span> <span data-ttu-id="a1647-116">Die globale Variable wird benötigt, da das System die [WM- \_ MeasureItem](../controls/wm-measureitem.md) -Nachricht sendet, sobald die Zeichenfolge hinzugefügt wird, aber bevor die Elementdaten angefügt werden. an diesem Punkt ist der **ItemData** -Member ungültig.</span><span class="sxs-lookup"><span data-stu-id="a1647-116">The global variable is needed because the system sends the [WM\_MEASUREITEM](../controls/wm-measureitem.md) message as soon as the string is added but before the item data is attached, and at this point the **itemData** member is not valid.</span></span>
-   <span data-ttu-id="a1647-117">Um die Zeichenfolge für ein Element in einem Listenfeld mit dem **lbs \_ hasstrings** -Stil zu ändern, löschen Sie das Element mit der [lb- \_ deletestring](../controls/lb-deletestring.md) -Nachricht, und fügen Sie die neue Zeichenfolge mit der LB \_ AddString-Nachricht hinzu.</span><span class="sxs-lookup"><span data-stu-id="a1647-117">To change the string for an item in a list box with the **LBS\_HASSTRINGS** style, delete the item with the [LB\_DELETESTRING](../controls/lb-deletestring.md) message and add the new string with the LB\_ADDSTRING message.</span></span>

 

 