---
title: Arbeiten mit virtualisierten Elementen
description: In diesem Thema wird beschrieben, wie die vom ItemContainer-und VirtualizedItem-Steuerelement Mustern bereitgestellten Funktionen verwendet werden, um Informationen zu virtualisierten Elementen zu suchen und abzurufen.
ms.assetid: e1898ba0-5ffa-4c61-b378-c7ef7c4a2c52
keywords:
- Clients, Benutzeroberflächenautomatisierungs-virtualisierte Elemente
- Clients, virtualisierte Elemente
- Clients, Steuerelement Muster
- Clients, VirtualizedItem-Steuerelement Muster
- Clients, ItemContainer-Steuerelement Muster
- Clients, Benutzeroberflächenautomatisierungs-VirtualizedItem-Steuerelement Muster
- Clients, Benutzeroberflächenautomatisierungs-Steuerelement Muster
- Clients, UI-Automatisierung, ItemContainer-Steuerelement Muster
- Benutzeroberflächen Automatisierung, virtualisierte Elemente
- Benutzeroberflächenautomatisierungs, Steuerelement Muster
- UI-Automatisierung, VirtualizedItem-Steuerelement Muster
- UI-Automatisierung, ItemContainer-Steuerelement Muster
- VirtualizedItem-Steuerelement Muster
- ItemContainer-Steuerelement Muster
- Steuerelement Muster, VirtualizedItem
- Steuerelement Muster, ItemContainer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb29232b06304079ad5b9dfdfb589ad510a5b51f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104310743"
---
# <a name="working-with-virtualized-items"></a><span data-ttu-id="1fb26-119">Arbeiten mit virtualisierten Elementen</span><span class="sxs-lookup"><span data-stu-id="1fb26-119">Working with Virtualized Items</span></span>

<span data-ttu-id="1fb26-120">In diesem Thema wird beschrieben, wie die vom [ItemContainer](uiauto-implementingitemcontainer.md) -und [VirtualizedItem](uiauto-implementingvirtualizeditem.md) -Steuerelement Mustern bereitgestellten Funktionen verwendet werden, um Informationen zu virtualisierten Elementen zu suchen und abzurufen.</span><span class="sxs-lookup"><span data-stu-id="1fb26-120">This topic describes how to use functionality provided by the [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control patterns to find and retrieve information about virtualized items.</span></span>

-   [<span data-ttu-id="1fb26-121">Übersicht über die Virtualisierung</span><span class="sxs-lookup"><span data-stu-id="1fb26-121">Overview of Virtualization</span></span>](#overview-of-virtualization)
-   [<span data-ttu-id="1fb26-122">Unterstützung der Virtualisierung durch ein Steuerelement</span><span class="sxs-lookup"><span data-stu-id="1fb26-122">How a Control Supports Virtualization</span></span>](#how-a-control-supports-virtualization)
-   [<span data-ttu-id="1fb26-123">Auffinden und erkennen von virtualisierten Elementen durch Clients</span><span class="sxs-lookup"><span data-stu-id="1fb26-123">How Clients Find and Realize Virtualized Items</span></span>](#how-clients-find-and-realize-virtualized-items)
-   [<span data-ttu-id="1fb26-124">Beispiel</span><span class="sxs-lookup"><span data-stu-id="1fb26-124">Example</span></span>](#example)
-   [<span data-ttu-id="1fb26-125">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1fb26-125">Related topics</span></span>](#related-topics)

## <a name="overview-of-virtualization"></a><span data-ttu-id="1fb26-126">Übersicht über die Virtualisierung</span><span class="sxs-lookup"><span data-stu-id="1fb26-126">Overview of Virtualization</span></span>

<span data-ttu-id="1fb26-127">Steuerelemente, die eine große Anzahl untergeordneter Elemente enthalten, können die Virtualisierung verwenden, um die Elemente effizient zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="1fb26-127">Controls that contain a large number of child items can use virtualization to efficiently manage the items.</span></span> <span data-ttu-id="1fb26-128">Bei der Virtualisierung verwaltet das Steuerelement vollständige Informationen im Arbeitsspeicher nur für eine Teilmenge der Elemente zu einem bestimmten Zeitpunkt.</span><span class="sxs-lookup"><span data-stu-id="1fb26-128">With virtualization, the control maintains full information in memory for only a subset of items at any given time.</span></span> <span data-ttu-id="1fb26-129">In der Regel enthält die Teilmenge nur die Elemente, die derzeit für den Benutzer sichtbar sind.</span><span class="sxs-lookup"><span data-stu-id="1fb26-129">Typically, the subset includes only those items that are currently visible to the user.</span></span> <span data-ttu-id="1fb26-130">Vollständige Informationen zu den verbleibenden virtualisierten Elementen werden im Speicher beibehalten und in den Arbeitsspeicher geladen oder realisiert, wie das Steuerelement dies benötigt, z. b. wenn neue Elemente für den Benutzer sichtbar werden.</span><span class="sxs-lookup"><span data-stu-id="1fb26-130">Full information about the remaining virtualized items is kept in storage and is loaded into memory, or realized, as the control needs it, for example, as new items become visible to the user.</span></span>

<span data-ttu-id="1fb26-131">Steuerelemente, die die Virtualisierung verwenden, stellen eine Herausforderung dar, da nur erkannte Elemente vollständig als Microsoft UI Automation-Elemente in der Benutzeroberflächenautomatisierungs-Struktur</span><span class="sxs-lookup"><span data-stu-id="1fb26-131">Controls that use virtualization represent a challenge because only realized items are fully available as Microsoft UI Automation elements in the UI Automation tree.</span></span> <span data-ttu-id="1fb26-132">Virtualisierte Elemente sind nicht in der Struktur vorhanden, sodass keine Informationen über diese Elemente für Clients verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="1fb26-132">Virtualized items do not exist in the tree, so information about them is not available to clients.</span></span> <span data-ttu-id="1fb26-133">Zum Abrufen von Informationen zu virtualisierten Elementen ist es erforderlich, dass die Benutzeroberflächen Automatisierung die Anforderung übergibt, um die Elemente an das Steuerelement zu erkennen.</span><span class="sxs-lookup"><span data-stu-id="1fb26-133">To retrieve information about virtualized items, clients need a way to force UI Automation to pass the request to realize the items to the control.</span></span> <span data-ttu-id="1fb26-134">Nachdem die Elemente realisiert wurden, kann die Benutzeroberflächen Automatisierung für Sie Benutzeroberflächenautomatisierungs-Elemente erstellen.</span><span class="sxs-lookup"><span data-stu-id="1fb26-134">After the items have been realized, UI Automation can create UI Automation elements for them.</span></span> <span data-ttu-id="1fb26-135">Die Benutzeroberflächen Automatisierung beinhaltet zwei Steuerelement Muster, mit denen Clients mit virtualisierten Elementen arbeiten können: [ItemContainer](uiauto-implementingitemcontainer.md) und [VirtualizedItem](uiauto-implementingvirtualizeditem.md).</span><span class="sxs-lookup"><span data-stu-id="1fb26-135">UI Automation includes two control patterns to enable clients to work with virtualized items: [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md).</span></span>

## <a name="how-a-control-supports-virtualization"></a><span data-ttu-id="1fb26-136">Unterstützung der Virtualisierung durch ein Steuerelement</span><span class="sxs-lookup"><span data-stu-id="1fb26-136">How a Control Supports Virtualization</span></span>

<span data-ttu-id="1fb26-137">Jedes Steuerelement, das virtualisierte Elemente enthalten kann, muss das [ItemContainer](uiauto-implementingitemcontainer.md) -Steuerelement Muster unterstützen.</span><span class="sxs-lookup"><span data-stu-id="1fb26-137">Any control that can contain virtualized items must support the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="1fb26-138">Außerdem muss jedes Element, das virtualisiert werden kann, das [VirtualizedItem](uiauto-implementingvirtualizeditem.md) -Steuerelement Muster unterstützen.</span><span class="sxs-lookup"><span data-stu-id="1fb26-138">Further, any item that can be virtualized must support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="1fb26-139">Die Funktionalität, die von den Steuerelement Mustern ItemContainer und VirtualizedItem verfügbar gemacht wird, kann von Clients über die Schnittstellen [**iuiautomationitemcontainerpattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) und [**iuiautomationvirtualizeditempattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="1fb26-139">The functionality that is exposed by the ItemContainer and VirtualizedItem control patterns is accessible to clients through the [**IUIAutomationItemContainerPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) and [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interfaces.</span></span>

## <a name="how-clients-find-and-realize-virtualized-items"></a><span data-ttu-id="1fb26-140">Auffinden und erkennen von virtualisierten Elementen durch Clients</span><span class="sxs-lookup"><span data-stu-id="1fb26-140">How Clients Find and Realize Virtualized Items</span></span>

<span data-ttu-id="1fb26-141">Clients können die [**iuiautomationitemcontainerpattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) -Methode verwenden, um anhand des Werts einer bestimmten Eigenschaft nach untergeordneten Elementen im Container zu suchen.</span><span class="sxs-lookup"><span data-stu-id="1fb26-141">Clients can use the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method to search for child items in the container based on the value of a particular property.</span></span> <span data-ttu-id="1fb26-142">Die-Methode kann auch das erste Element im Container oder das Element, das dem angegebenen Element folgt, abrufen.</span><span class="sxs-lookup"><span data-stu-id="1fb26-142">The method can also retrieve the first item in the container or the item that follows the specified item.</span></span> <span data-ttu-id="1fb26-143">Wenn ein übereinstimmendes untergeordnetes Element gefunden wird, ruft **FindItemByProperty** eine [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) -Schnittstelle für das Element ab.</span><span class="sxs-lookup"><span data-stu-id="1fb26-143">If a matching child item is found, the **FindItemByProperty** retrieves an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for the item.</span></span> <span data-ttu-id="1fb26-144">Wenn jedoch das untergeordnete Element virtualisiert ist, ist die **iuiautomationelement** -Schnittstelle ein Platzhalter.</span><span class="sxs-lookup"><span data-stu-id="1fb26-144">However, if the child item is virtualized, the **IUIAutomationElement** interface is a placeholder.</span></span> <span data-ttu-id="1fb26-145">Der [**UIA \_ E \_ elementnotavailable**](uiauto-error-codes.md) -Fehler tritt auf, wenn der Client versucht, die **iuiautomationelement** -Schnittstelle zum Abrufen von Eigenschafts Werten oder Aufrufen von Methoden zu verwenden, die noch nicht verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="1fb26-145">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error occurs when the client attempts to use the **IUIAutomationElement** interface to retrieve property values or call methods that are not yet available.</span></span> <span data-ttu-id="1fb26-146">Welche Eigenschaften oder Methoden über einen Platzhalter verfügbar sind, hängt von der Implementierung des Steuer Elements ab.</span><span class="sxs-lookup"><span data-stu-id="1fb26-146">Which properties or methods are available through a placeholder depends on the control implementation.</span></span> <span data-ttu-id="1fb26-147">Die einzige Voraussetzung für einen Platzhalter ist die Unterstützung der [**iuiautomationvirtualizeditempattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="1fb26-147">The only requirement for a placeholder is to support the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface.</span></span>

<span data-ttu-id="1fb26-148">Der [**UIA \_ E \_ elementnotavailable**](uiauto-error-codes.md) -Fehler ist ein Hinweis auf den Client, dass ein Element virtualisiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="1fb26-148">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error is an indication to the client that an item may be virtualized.</span></span> <span data-ttu-id="1fb26-149">Der Client sollte Antworten, indem er die [**iuiautomationvirtualizeditempattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) -Schnittstelle für das Element abruft und dann das Element durch Aufrufen der [**iuiautomationvirtualizeditempattern::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) Single-Methode erkennt.</span><span class="sxs-lookup"><span data-stu-id="1fb26-149">The client should respond by retrieving the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface for the item, and then realizing the item by calling the [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method.</span></span> <span data-ttu-id="1fb26-150">Wenn dies erfolgreich ist, ist die [**iuiautomationelement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) -Schnittstelle voll funktionsfähig, und es sind alle entsprechenden Eigenschaften verfügbar.</span><span class="sxs-lookup"><span data-stu-id="1fb26-150">If this succeeds, the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface is fully functional with all appropriate properties available.</span></span>

<span data-ttu-id="1fb26-151">Abhängig von der Implementierung des Steuer Elements führt der Aufruf von [**iuiautomationvirtualizeditempattern:**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize)</span><span class="sxs-lookup"><span data-stu-id="1fb26-151">Depending on the control implementation, calling [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) may cause the control to scroll the item into view.</span></span> <span data-ttu-id="1fb26-152">Ein Client sollte sich jedoch nicht darauf verlassen, dass der Bildlauf in der Sicht durchgeführt oder sichtbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="1fb26-152">However, a client should not rely on the item scrolling into view or made visible.</span></span> <span data-ttu-id="1fb26-153">Um sicherzustellen, dass das Element sichtbar ist, kann der Client die [**iuiautomationscrollitempattern:: ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) -Methode verwenden.</span><span class="sxs-lookup"><span data-stu-id="1fb26-153">To ensure that the item is visible, the client can use the [**IUIAutomationScrollItemPattern::ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) method.</span></span>

## <a name="example"></a><span data-ttu-id="1fb26-154">Beispiel</span><span class="sxs-lookup"><span data-stu-id="1fb26-154">Example</span></span>

<span data-ttu-id="1fb26-155">Beispielcode, der die Verwendung der Benutzeroberflächenautomatisierungs-Unterstützung für die Virtualisierung veranschaulicht, finden Sie unter [Abrufen eines virtualisierten Elements](uiauto-howto-retrieve-virtualized-item.md).</span><span class="sxs-lookup"><span data-stu-id="1fb26-155">For example code that shows how to use the UI Automation support for virtualization, see [How to Retrieve a Virtualized Item](uiauto-howto-retrieve-virtualized-item.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1fb26-156">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1fb26-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1fb26-157">Übersicht über Steuerelementmuster für Benutzeroberflächenautomatisierung</span><span class="sxs-lookup"><span data-stu-id="1fb26-157">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> </dl>

 

 




