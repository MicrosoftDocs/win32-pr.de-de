---
title: Steuerelement Muster ziehen
description: Stellt Richtlinien und Konventionen für das Implementieren des Drag-Steuerelement Musters mithilfe von idragprovider bereit, einschließlich Informationen zu Eigenschaften und Methoden. Das Drag-Steuerelement Muster wird zur Unterstützung von dragfähigen Steuerelementen oder Steuerelementen mit dragfähigen Elementen verwendet.
ms.assetid: 9853E9CB-D04B-4F67-8E9E-7F1F99BACEA7
keywords:
- Benutzeroberflächenautomatisierung, Implementieren eines Drag-Steuerelement Musters
- UI-Automatisierung, Drag-Steuerelement Muster
- UI-Automatisierung, idragprovider
- IDragProvider
- Implementieren von Drag-Steuerungs Mustern für Benutzeroberflächen Automatisierung
- Ziehen von Steuerelement Mustern
- Steuerelement Muster, idragprovider
- Steuerelement Muster, Implementieren der Benutzeroberflächenautomatisierungs-Drag
- Steuerelement Muster, ziehen
- Schnittstellen, idragprovider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548f0212eca37e1890596143f27e9af70e1fb19a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104039211"
---
# <a name="drag-control-pattern"></a><span data-ttu-id="3dba1-114">Steuerelement Muster ziehen</span><span class="sxs-lookup"><span data-stu-id="3dba1-114">Drag Control Pattern</span></span>

<span data-ttu-id="3dba1-115">Stellt Richtlinien und Konventionen für das Implementieren des **Drag** -Steuerelement Musters mithilfe von [**idragprovider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider)bereit, einschließlich Informationen zu Eigenschaften und Methoden.</span><span class="sxs-lookup"><span data-stu-id="3dba1-115">Provides guidelines and conventions for implementing the **Drag** control pattern by using [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), including information about properties and methods.</span></span> <span data-ttu-id="3dba1-116">Das **Drag** -Steuerelement Muster wird zur Unterstützung von dragfähigen Steuerelementen oder Steuerelementen mit dragfähigen Elementen verwendet.</span><span class="sxs-lookup"><span data-stu-id="3dba1-116">The **Drag** control pattern is used to support draggable controls, or controls with draggable items.</span></span>

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="3dba1-117">Implementierungsrichtlinien und -konventionen</span><span class="sxs-lookup"><span data-stu-id="3dba1-117">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="3dba1-118">Verwenden Sie die folgenden Richtlinien und Konventionen, wenn Sie das **Drag** -Steuerelement Muster implementieren:</span><span class="sxs-lookup"><span data-stu-id="3dba1-118">When implementing the **Drag** control pattern, use these guidelines and conventions:</span></span>

-   <span data-ttu-id="3dba1-119">Die [**idragprovider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) -Schnittstelle unterstützt zwei unterschiedliche Zieh Stile: den Quell-/Zielstil und den reinen Quell Stil.</span><span class="sxs-lookup"><span data-stu-id="3dba1-119">The [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) interface supports two different dragging styles: the source/target style, and the source-only style.</span></span> <span data-ttu-id="3dba1-120">Sie müssen den Stil auswählen, der für Ihre Drag & Drop-Szenarien am besten geeignet ist:</span><span class="sxs-lookup"><span data-stu-id="3dba1-120">You need to choose the style that works best for your drag-and-drop scenarios:</span></span>
    -   <span data-ttu-id="3dba1-121">**Quell-/Zielstil:** Jedes mögliche Ablage Ziel wird durch ein Element dargestellt, das die [**idroptargetprovider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) -Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="3dba1-121">**Source/target style:** Each possible drop target is represented by an element that implements the [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) interface.</span></span> <span data-ttu-id="3dba1-122">Während eines Zieh Vorgangs stammen Microsoft UI Automation-Ereignisse aus dem gezogenen Element und aus den Drop-Target-Elementen.</span><span class="sxs-lookup"><span data-stu-id="3dba1-122">During a drag operation, Microsoft UI Automation events originate from the element that is being dragged, and from the drop-target elements.</span></span>
    -   <span data-ttu-id="3dba1-123">**Nur Quelle:** Drop-Ziele werden nicht durch Benutzeroberflächenautomatisierungs-Elemente dargestellt.</span><span class="sxs-lookup"><span data-stu-id="3dba1-123">**Source-only style:** Drop targets are not represented by UI Automation elements.</span></span> <span data-ttu-id="3dba1-124">Während eines Zieh Vorgangs stammen Ereignisse nur aus dem Element, das gezogen wird.</span><span class="sxs-lookup"><span data-stu-id="3dba1-124">During a drag operation, events originate only from the element that is being dragged.</span></span>
-   <span data-ttu-id="3dba1-125">[**Idragprovider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) ist eine schreibgeschützte Schnittstelle, die zum Überwachen von Drag-Vorgängen vorgesehen ist.</span><span class="sxs-lookup"><span data-stu-id="3dba1-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) is a read-only interface intended for monitoring drag operations.</span></span> <span data-ttu-id="3dba1-126">Sie können Sie nicht verwenden, um einen Zieh Vorgang zu steuern.</span><span class="sxs-lookup"><span data-stu-id="3dba1-126">You cannot use it to control a drag operation.</span></span> <span data-ttu-id="3dba1-127">Sie können Zieh Vorgänge automatisieren, indem Sie Maus Eingaben an ein-Steuerelement senden.</span><span class="sxs-lookup"><span data-stu-id="3dba1-127">You can automate drag operations by sending mouse input to a control.</span></span>
-   <span data-ttu-id="3dba1-128">Die [**idragprovider:: isgrab**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) -Eigenschaft ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="3dba1-128">The [**IDragProvider::IsGrabbed**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) property is required.</span></span>
-   <span data-ttu-id="3dba1-129">Die [**idragprovider::D ropeer ffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) -und [**idragprovider::D ropeer**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) -Eigenschaften sind für eine reine Quell Implementierung erforderlich und sind für eine Implementierung des Quell-/Zielstils unzulässig.</span><span class="sxs-lookup"><span data-stu-id="3dba1-129">The [**IDragProvider::DropEffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) and [**IDragProvider::DropEffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) properties are required for a source-only style implementation, and prohibited for a source/target style implementation.</span></span> <span data-ttu-id="3dba1-130">In einer Implementierung des Quell-/Zielstils können Drop-Target-Elemente für Ihre Ablage Effekte abgefragt werden.</span><span class="sxs-lookup"><span data-stu-id="3dba1-130">In a source/target style implementation, drop-target elements can be queried for their drop effects.</span></span>
-   <span data-ttu-id="3dba1-131">Die [**idragprovider:: grabbeditems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) -Eigenschaft stellt das Ziehen mehrerer Elemente dar.</span><span class="sxs-lookup"><span data-stu-id="3dba1-131">The [**IDragProvider::GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) property represents the dragging of multiple items.</span></span> <span data-ttu-id="3dba1-132">Wenn der Benutzer den Zieh Vorgang startet, müssen Sie ein neues Benutzeroberflächenautomatisierungs-Element erstellen, das als Ereignis Quell Element fungiert.</span><span class="sxs-lookup"><span data-stu-id="3dba1-132">When the user begins the drag operation, you need to create a new UI Automation element to serve as the event source element.</span></span> <span data-ttu-id="3dba1-133">Dieses neue Element löst alle Ereignisse aus, die das Quell Element im Quell-oder Ziel Modus ausgelöst hätte, während keines der Elemente, die tatsächlich gezogen werden, Ereignisse auslöst.</span><span class="sxs-lookup"><span data-stu-id="3dba1-133">This new element fires all events that the source element would have fired in either the source/target or source-only mode, while none of the elements that are actually being dragged fire any events.</span></span> <span data-ttu-id="3dba1-134">Wenn der Zieh Vorgang beendet ist, zerstören Sie das Ereignis Quell Element.</span><span class="sxs-lookup"><span data-stu-id="3dba1-134">When the drag operation is complete, destroy the event source element.</span></span>
-   <span data-ttu-id="3dba1-135">Das-Element muss bei der Änderung Eigenschaften geänderte Ereignisse für die Eigenschaften **dropffect** ([**UIA \_ dragdropeer ffectpropertyid**](uiauto-control-pattern-propids.md)) und **dropeer** . ([**UIA \_ dragdropeer ffectspropertyid**](uiauto-control-pattern-propids.md)) auslösen.</span><span class="sxs-lookup"><span data-stu-id="3dba1-135">The element must fire property-changed events for the **DropEffect** ([**UIA\_DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) and **DropEffects** ([**UIA\_DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) properties when they change.</span></span> <span data-ttu-id="3dba1-136">Eigenschaften geänderte Ereignisse für die anderen Eigenschaften sind zulässig, können jedoch von der erforderlichen **DragStart** ([**UIA \_ Drag \_ dragstarteventid**](uiauto-event-ids.md)), **dragcancel** ([**UIA \_ Drag \_ dragcanceleventid**](uiauto-event-ids.md)) und **dragcomplete** ([**UIA \_ Drag \_ dragcompleteeventid**](uiauto-event-ids.md)) abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="3dba1-136">Property-changed events for the other properties are allowed, but can be inferred from the required **DragStart** ([**UIA\_Drag\_DragStartEventId**](uiauto-event-ids.md)), **DragCancel** ([**UIA\_Drag\_DragCancelEventId**](uiauto-event-ids.md)), and **DragComplete** ([**UIA\_Drag\_DragCompleteEventId**](uiauto-event-ids.md)) events.</span></span>
-   

## <a name="required-members-for-idragprovider"></a><span data-ttu-id="3dba1-137">Erforderliche Member für **idragprovider**</span><span class="sxs-lookup"><span data-stu-id="3dba1-137">Required Members for **IDragProvider**</span></span>

<span data-ttu-id="3dba1-138">Die folgenden Eigenschaften und Methoden sind für die Implementierung der [**idragprovider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) -Schnittstelle erforderlich.</span><span class="sxs-lookup"><span data-stu-id="3dba1-138">The following properties and methods are required for implementing the [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) interface.</span></span>



| <span data-ttu-id="3dba1-139">Erforderliche Member</span><span class="sxs-lookup"><span data-stu-id="3dba1-139">Required members</span></span>                                                                        | <span data-ttu-id="3dba1-140">Memberart</span><span class="sxs-lookup"><span data-stu-id="3dba1-140">Member type</span></span> | <span data-ttu-id="3dba1-141">Hinweise</span><span class="sxs-lookup"><span data-stu-id="3dba1-141">Notes</span></span>                                                                         |
|-----------------------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------|
| [<span data-ttu-id="3dba1-142">**Isgrab**</span><span class="sxs-lookup"><span data-stu-id="3dba1-142">**IsGrabbed**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed)                                     | <span data-ttu-id="3dba1-143">Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="3dba1-143">Property</span></span>    | <span data-ttu-id="3dba1-144">Keine</span><span class="sxs-lookup"><span data-stu-id="3dba1-144">None</span></span>                                                                          |
| [<span data-ttu-id="3dba1-145">**Dropffect**</span><span class="sxs-lookup"><span data-stu-id="3dba1-145">**DropEffect**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect)                                   | <span data-ttu-id="3dba1-146">Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="3dba1-146">Property</span></span>    | <span data-ttu-id="3dba1-147">Erforderlich für eine Implementierung des reinen Quell Stils.</span><span class="sxs-lookup"><span data-stu-id="3dba1-147">Required for an implementation of the source-only style.</span></span>                      |
| [<span data-ttu-id="3dba1-148">**Drof ffects**</span><span class="sxs-lookup"><span data-stu-id="3dba1-148">**DropEffects**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects)                                 | <span data-ttu-id="3dba1-149">Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="3dba1-149">Property</span></span>    | <span data-ttu-id="3dba1-150">Erforderlich, wenn mehrere mögliche Ablage Effekte für das eingepackte Element vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="3dba1-150">Required if there is more than one possible drop effect for the grabbed item.</span></span> |
| [<span data-ttu-id="3dba1-151">**Getgrabbeditems**</span><span class="sxs-lookup"><span data-stu-id="3dba1-151">**GetGrabbedItems**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems)                         | <span data-ttu-id="3dba1-152">Methode</span><span class="sxs-lookup"><span data-stu-id="3dba1-152">Method</span></span>      | <span data-ttu-id="3dba1-153">Erforderlich für einen Drag-Vorgang mit mehreren Elementen.</span><span class="sxs-lookup"><span data-stu-id="3dba1-153">Required for a multiple-item drag operation.</span></span>                                  |
| [<span data-ttu-id="3dba1-154">**UIA \_ Drag \_ dragstarteventid**</span><span class="sxs-lookup"><span data-stu-id="3dba1-154">**UIA\_Drag\_DragStartEventId**</span></span>](uiauto-event-ids.md)       | <span data-ttu-id="3dba1-155">Ereignis</span><span class="sxs-lookup"><span data-stu-id="3dba1-155">Event</span></span>       | <span data-ttu-id="3dba1-156">Keine</span><span class="sxs-lookup"><span data-stu-id="3dba1-156">None</span></span>                                                                          |
| [<span data-ttu-id="3dba1-157">**UIA \_ Drag \_ dragcanceleventid**</span><span class="sxs-lookup"><span data-stu-id="3dba1-157">**UIA\_Drag\_DragCancelEventId**</span></span>](uiauto-event-ids.md)     | <span data-ttu-id="3dba1-158">Ereignis</span><span class="sxs-lookup"><span data-stu-id="3dba1-158">Event</span></span>       | <span data-ttu-id="3dba1-159">Keine</span><span class="sxs-lookup"><span data-stu-id="3dba1-159">None</span></span>                                                                          |
| [<span data-ttu-id="3dba1-160">**UIA \_ Drag \_ dragcompleteeventid**</span><span class="sxs-lookup"><span data-stu-id="3dba1-160">**UIA\_Drag\_DragCompleteEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="3dba1-161">Ereignis</span><span class="sxs-lookup"><span data-stu-id="3dba1-161">Event</span></span>       | <span data-ttu-id="3dba1-162">Keine</span><span class="sxs-lookup"><span data-stu-id="3dba1-162">None</span></span>                                                                          |



 

## <a name="related-topics"></a><span data-ttu-id="3dba1-163">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="3dba1-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3dba1-164">Steuerelement Typen und ihre unterstützten Steuerelement Muster</span><span class="sxs-lookup"><span data-stu-id="3dba1-164">Control Types and their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="3dba1-165">DropTarget-Steuerelement Muster</span><span class="sxs-lookup"><span data-stu-id="3dba1-165">DropTarget Control Pattern</span></span>](/windows/desktop/WinAuto/uiauto-implementingdroptarget)
</dt> <dt>

[<span data-ttu-id="3dba1-166">Übersicht über Steuerelementmuster für Benutzeroberflächenautomatisierung</span><span class="sxs-lookup"><span data-stu-id="3dba1-166">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="3dba1-167">Übersicht über die Benutzeroberflächenautomatisierungs-Struktur</span><span class="sxs-lookup"><span data-stu-id="3dba1-167">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> <dt>

[<span data-ttu-id="3dba1-168">Benutzeroberflächenautomatisierungs-Unterstützung für Drag & Drop</span><span class="sxs-lookup"><span data-stu-id="3dba1-168">UI Automation Support for Drag-and-Drop</span></span>](ui-automation-support-for-drag-and-drop.md)
</dt> </dl>

 

 