---
title: Verwenden von QueryService zum Abrufen einer systemeigenen Schnittstelle für ein IAccessible-Objekt
description: Server Entwickler können diese Technik verwenden, um einen Zeiger auf einen benutzerdefinierten Dokument Knoten für ein IAccessible-Objekt verfügbar zu machen. Dabei wird davon ausgegangen, dass Sie bereits IAccessible-Objekte verfügbar machen. Dieses Verfahren ermöglicht es Clients, ein benutzerdefiniertes Objekt von einem Objekt zu erhalten, das nicht zugänglich ist.
ms.assetid: aaa0e840-f8c2-4f3d-9d97-1910f00c1041
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 29d971462154eb12789a74e8cc6edb5aed68c84b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104039286"
---
# <a name="use-queryservice-to-retrieve-a-native-interface-for-an-iaccessible-object"></a><span data-ttu-id="1ed88-105">Verwenden von QueryService zum Abrufen einer systemeigenen Schnittstelle für ein IAccessible-Objekt</span><span class="sxs-lookup"><span data-stu-id="1ed88-105">Use QueryService to retrieve a native interface for an IAccessible object</span></span>

<span data-ttu-id="1ed88-106">Server Entwickler können diese Technik verwenden, um einen Zeiger auf einen benutzerdefinierten Dokument Knoten für ein [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Objekt verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="1ed88-106">Server developers can use this technique to expose a pointer to a custom document node for an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object.</span></span> <span data-ttu-id="1ed88-107">Dabei wird davon ausgegangen, dass Sie bereits **IAccessible** -Objekte verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="1ed88-107">This assumes that you already expose **IAccessible** objects.</span></span> <span data-ttu-id="1ed88-108">Dieses Verfahren ermöglicht es Clients, ein benutzerdefiniertes Objekt von einem Objekt zu erhalten, das nicht **zugänglich** ist.</span><span class="sxs-lookup"><span data-stu-id="1ed88-108">This technique allows clients to get a custom object from an **IAccessible** object.</span></span>

<span data-ttu-id="1ed88-109">**So machen Sie ein System eigenes Objektmodell für eine IAccessible (Server) verfügbar**</span><span class="sxs-lookup"><span data-stu-id="1ed88-109">**To expose a native object model for an IAccessible (servers)**</span></span>

1.  <span data-ttu-id="1ed88-110">Fügen Sie Unterstützung für die **IServiceProvider** -Schnittstelle für Ihr [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Objekt hinzu.</span><span class="sxs-lookup"><span data-stu-id="1ed88-110">Add support for the **IServiceProvider** interface on your [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object.</span></span>
2.  <span data-ttu-id="1ed88-111">Definieren Sie eine GUID, die die Funktionalität des Abrufens der benutzerdefinierten Schnittstelle von einem [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Objekt darstellt.</span><span class="sxs-lookup"><span data-stu-id="1ed88-111">Define a GUID that represents the functionality of obtaining the custom interface from an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) objects.</span></span> <span data-ttu-id="1ed88-112">Dies wird als Dienst-ID bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="1ed88-112">This is called a service ID.</span></span> <span data-ttu-id="1ed88-113">Sie können GUIDGEN.EXE verwenden, um eine Dienst-ID zu generieren oder die Schnittstellen-ID wiederzuverwenden, wenn Sie über eine benutzerdefinierte Schnittstelle verfügen.</span><span class="sxs-lookup"><span data-stu-id="1ed88-113">You can use GUIDGEN.EXE to generate a service ID, or reuse the interface ID if you have a custom interface.</span></span>
3.  <span data-ttu-id="1ed88-114">Implementieren Sie die **IServiceProvider:: QueryService** -Methode, sodass Sie einen Zeiger auf die benutzerdefinierte Schnittstelle zurückgibt, wenn Sie mit der zuvor in diesem Verfahren definierten Dienst-ID aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="1ed88-114">Implement the **IServiceProvider::QueryService** method so that it returns a pointer to the custom interface when called with the service ID defined earlier in this procedure.</span></span> <span data-ttu-id="1ed88-115">**QueryService** sollte **null** für alle anderen Dienst-ID-Werte zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="1ed88-115">**QueryService** should return **NULL** for all other service ID values.</span></span>
4.  <span data-ttu-id="1ed88-116">Veröffentlichen Sie die Dienst-ID, damit Sie von Clients verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="1ed88-116">Publish the service ID so that clients can use it.</span></span>

<span data-ttu-id="1ed88-117">Clients können diese Funktion verwenden, um einen Zeiger auf das benutzerdefinierte Objekt aus einem Objekt zu erhalten, das nicht [**zugänglich**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) ist.</span><span class="sxs-lookup"><span data-stu-id="1ed88-117">Clients can use this functionality to obtain a pointer to the custom object from an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object.</span></span>

<span data-ttu-id="1ed88-118">**So rufen Sie einen Zeiger auf ein benutzerdefiniertes Objekt von einem IAccessible (Clients) ab**</span><span class="sxs-lookup"><span data-stu-id="1ed88-118">**To obtain a pointer to a custom object from an IAccessible (clients)**</span></span>

1.  <span data-ttu-id="1ed88-119">Rufen Sie [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q))(IID \_ IServiceProvider) auf einem [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Schnittstellen Zeiger auf, um einen **IServiceProvider** -Schnittstellen Zeiger zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1ed88-119">Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q))(IID\_IServiceProvider) on an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer to obtain an **IServiceProvider** interface pointer.</span></span>
2.  <span data-ttu-id="1ed88-120">Rufen Sie **IServiceProvider:: QueryService** mit der veröffentlichten Dienst-ID auf, um einen Zeiger auf das benutzerdefinierte Objekt für die [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible)zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1ed88-120">Call **IServiceProvider::QueryService** with the published service ID to obtain a pointer to the custom object for the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).</span></span>
3.  <span data-ttu-id="1ed88-121">Geben Sie die **IServiceProvider** -Schnittstelle frei, wenn Sie nicht mehr benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="1ed88-121">Release the **IServiceProvider** interface if it is no longer needed.</span></span>

<span data-ttu-id="1ed88-122">Um Prozess übergreifend verwendet werden zu können, müssen Server möglicherweise die zurückgegebene Schnittstelle mit Component Object Model (com) registrieren.</span><span class="sxs-lookup"><span data-stu-id="1ed88-122">To be usable across processes, servers might need to register the returned interface with Component Object Model (COM).</span></span>

<span data-ttu-id="1ed88-123">Diese Technik wird von Microsoft Internet Explorer 4,0 und höher verwendet.</span><span class="sxs-lookup"><span data-stu-id="1ed88-123">This technique is used by Microsoft Internet Explorer 4.0 and later.</span></span> <span data-ttu-id="1ed88-124">Sie ermöglicht Clients das Abrufen eines **IHTMLElement2** -Schnittstellen Zeigers, der einem [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Objekt entspricht.</span><span class="sxs-lookup"><span data-stu-id="1ed88-124">It allows clients to obtain an **IHTMLElement2** interface pointer that corresponds to an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object.</span></span>

 

 