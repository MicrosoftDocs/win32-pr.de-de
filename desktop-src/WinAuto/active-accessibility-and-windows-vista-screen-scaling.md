---
title: Active Accessibility-und Windows Vista-Bildschirm Skalierung
description: Windows Vista ermöglicht es Benutzern, die dpi-Einstellung (dots per inch) so zu ändern, dass die meisten Elemente der Benutzeroberfläche auf dem Bildschirm größer erscheinen.
ms.assetid: c781fefd-09f0-4340-b3d3-f4e57308f392
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6db8e192dc01d4c7d75f19741cdfac7b3b08d22c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "104473788"
---
# <a name="active-accessibility-and-windows-vista-screen-scaling"></a><span data-ttu-id="f3315-103">Active Accessibility-und Windows Vista-Bildschirm Skalierung</span><span class="sxs-lookup"><span data-stu-id="f3315-103">Active Accessibility and Windows Vista Screen Scaling</span></span>

<span data-ttu-id="f3315-104">Windows Vista ermöglicht es Benutzern, die dpi-Einstellung (dots per inch) so zu ändern, dass die meisten Elemente der Benutzeroberfläche auf dem Bildschirm größer erscheinen.</span><span class="sxs-lookup"><span data-stu-id="f3315-104">Windows Vista enables users to change the dots-per-inch (dpi) setting so that most UI elements on the screen appear larger.</span></span> <span data-ttu-id="f3315-105">Obwohl dieses Feature seit langem in Microsoft Windows verfügbar ist, musste die Skalierung in früheren Versionen von Anwendungen implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="f3315-105">Although this feature has long been available in Microsoft Windows, in previous versions the scaling had to be implemented by applications.</span></span> <span data-ttu-id="f3315-106">In Windows Vista führt die Desktopfenster-Manager eine Standard Skalierung für alle Anwendungen aus, die ihre eigene Skalierung nicht verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="f3315-106">In Windows Vista, the Desktop Window Manager performs default scaling for all applications that do not handle their own scaling.</span></span> <span data-ttu-id="f3315-107">Microsoft Active Accessibility-Client Anwendungen müssen dieses Feature berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="f3315-107">Microsoft Active Accessibility client applications must take this feature into account.</span></span>

## <a name="scaling-in-windows-vista"></a><span data-ttu-id="f3315-108">Skalierung in Windows Vista</span><span class="sxs-lookup"><span data-stu-id="f3315-108">Scaling in Windows Vista</span></span>

<span data-ttu-id="f3315-109">Die dpi-Standardeinstellung ist 96. Dies bedeutet, dass 96 Pixel eine Breite oder Höhe von einem einzelnen Zoll belegen.</span><span class="sxs-lookup"><span data-stu-id="f3315-109">The default dpi setting is 96, which means that 96 pixels occupy a width or height of one notional inch.</span></span> <span data-ttu-id="f3315-110">Das genaue Maß für ein „Zoll“ ist abhängig von der Größe und der physischen Auflösung des Monitors.</span><span class="sxs-lookup"><span data-stu-id="f3315-110">The exact measure of an "inch" depends on the size and physical resolution of the monitor.</span></span> <span data-ttu-id="f3315-111">Auf einem Monitor mit einer Breite von 12 Zoll bei einer horizontalen Auflösung von 1280 Pixel erstreckt sich eine horizontale Linie von 96 Pixeln beispielsweise über etwas 9/10 eines Zolls.</span><span class="sxs-lookup"><span data-stu-id="f3315-111">For example, on a monitor 12 inches wide, at a horizontal resolution of 1280 pixels, a horizontal line of 96 pixels extends about 9/10 of an inch.</span></span>

<span data-ttu-id="f3315-112">Das Ändern der dpi-Einstellung ist nicht dasselbe wie das Ändern der Bildschirmauflösung.</span><span class="sxs-lookup"><span data-stu-id="f3315-112">Changing the dpi setting is not the same as changing the screen resolution.</span></span> <span data-ttu-id="f3315-113">Bei der DPI-Skalierung bleibt die Anzahl der physischen Pixel auf dem Bildschirm unverändert.</span><span class="sxs-lookup"><span data-stu-id="f3315-113">With dpi scaling, the number of physical pixels on the screen remains the same.</span></span> <span data-ttu-id="f3315-114">Die Skalierung wird jedoch auf die Größe und den Speicherort der Benutzeroberflächen Elemente angewendet.</span><span class="sxs-lookup"><span data-stu-id="f3315-114">However, scaling is applied to the size and location of UI elements.</span></span> <span data-ttu-id="f3315-115">Diese Skalierung kann vom Desktopfenster-Manager (DWM) für den Desktop und für Anwendungen automatisch durchgeführt werden , die nicht ausdrücklich danach verlangen, nicht skaliert zu werden.</span><span class="sxs-lookup"><span data-stu-id="f3315-115">This scaling can be performed automatically by the Desktop Window Manager (DWM) for the desktop and for applications that do not explicitly ask not to be scaled.</span></span>

<span data-ttu-id="f3315-116">Wenn der Benutzer den Skalierungsfaktor auf 120 DPI festlegt, wird ein vertikaler oder horizontaler Zoll auf dem Bildschirm um 25 Prozent vergrößert.</span><span class="sxs-lookup"><span data-stu-id="f3315-116">In effect, when the user sets the scale factor to 120 dpi, a vertical or horizontal inch on the screen becomes bigger by 25 percent.</span></span> <span data-ttu-id="f3315-117">Alle Dimensionen werden entsprechend skaliert.</span><span class="sxs-lookup"><span data-stu-id="f3315-117">All dimensions are scaled accordingly.</span></span> <span data-ttu-id="f3315-118">Der Offset eines Fensters vom oberen und linken Rand des Bildschirms wird um 25 Prozent vergrößert.</span><span class="sxs-lookup"><span data-stu-id="f3315-118">The offset of a window from the top and left edges of the screen increases by 25 percent.</span></span> <span data-ttu-id="f3315-119">Die Größe des Fensters wird im selben Anteil zusammen mit den Offsets und Größen aller darin enthaltenen Benutzeroberflächen Elemente vergrößert.</span><span class="sxs-lookup"><span data-stu-id="f3315-119">The size of the window increases in the same proportion, along with the offsets and sizes of all UI elements it contains.</span></span>

<span data-ttu-id="f3315-120">Standardmäßig führt der DWM keine Skalierung für Anwendungen ohne dpi-Unterstützung durch, wenn der Benutzer den dpi-Wert auf 120 festlegt, er aber ausführt, wenn der dpi-Wert auf einen benutzerdefinierten Wert von 144 oder höher festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="f3315-120">By default, the DWM does not perform scaling for non-dpi-aware applications when the user sets the dpi to 120, but does perform it when the dpi is set to a custom value of 144 or higher.</span></span> <span data-ttu-id="f3315-121">Das Standardverhalten kann vom Benutzer jedoch außer Kraft gesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="f3315-121">However, the user can override the default behavior.</span></span>

<span data-ttu-id="f3315-122">Die Bildschirmskalierung stellt an Anwendungen neue Herausforderungen, die sich in irgendeiner Weise mit Bildschirmkoordinaten befassen.</span><span class="sxs-lookup"><span data-stu-id="f3315-122">Screen scaling creates new challenges for applications that are concerned in any way with screen coordinates.</span></span> <span data-ttu-id="f3315-123">Der Bildschirm enthält jetzt zwei Koordinatensysteme: ein physisches und ein logisches.</span><span class="sxs-lookup"><span data-stu-id="f3315-123">The screen now contains two coordinate systems: physical and logical.</span></span> <span data-ttu-id="f3315-124">Die physischen Koordinaten eines Punkts stellen den tatsächlichen Offset in Pixeln vom oberen linken Rand des Ursprungs dar.</span><span class="sxs-lookup"><span data-stu-id="f3315-124">The physical coordinates of a point are the actual offset in pixels from the top left of the origin.</span></span> <span data-ttu-id="f3315-125">Die logischen Koordinaten sind die Offsets, die sich ergeben würden, wenn die Pixel selbst skaliert würden.</span><span class="sxs-lookup"><span data-stu-id="f3315-125">The logical coordinates are the offsets as they would be if the pixels themselves were scaled.</span></span>

<span data-ttu-id="f3315-126">Angenommen, Sie entwerfen ein Dialogfeld mit einer Schaltfläche an den Koordinaten (100, 48).</span><span class="sxs-lookup"><span data-stu-id="f3315-126">Suppose you design a dialog box with a button at coordinates (100, 48).</span></span> <span data-ttu-id="f3315-127">Wenn dieses Dialogfeld mit dem 96-Standard dpi angezeigt wird, befindet sich die Schaltfläche an den physischen Koordinaten von (100, 48).</span><span class="sxs-lookup"><span data-stu-id="f3315-127">When this dialog box is displayed at the default 96 dpi, the button is located at physical coordinates of (100, 48).</span></span> <span data-ttu-id="f3315-128">Bei 120 dpi befindet er sich an physischen Koordinaten von (125, 60).</span><span class="sxs-lookup"><span data-stu-id="f3315-128">At 120 dpi, it is located at physical coordinates of (125, 60).</span></span> <span data-ttu-id="f3315-129">Aber die logischen Koordinaten sind bei jeder dpi-Einstellung identisch: (100, 48).</span><span class="sxs-lookup"><span data-stu-id="f3315-129">But the logical coordinates are the same at any dpi setting: (100, 48).</span></span>

<span data-ttu-id="f3315-130">Logische Koordinaten sind wichtig, da Sie das Verhalten des Betriebssystems und der Anwendungen unabhängig von der dpi-Einstellung konsistent machen.</span><span class="sxs-lookup"><span data-stu-id="f3315-130">Logical coordinates are important, because they make the behavior of the operating system and applications consistent regardless of the dpi setting.</span></span> <span data-ttu-id="f3315-131">Beispielsweise gibt **System. Windows. Forms. Cursor. Position** normalerweise die logischen Koordinaten zurück.</span><span class="sxs-lookup"><span data-stu-id="f3315-131">For example, **System.Windows.Forms.Cursor.Position** normally returns the logical coordinates.</span></span> <span data-ttu-id="f3315-132">Wenn Sie den Cursor über ein Element in einem Dialogfeld bewegen, werden unabhängig von der dpi-Einstellung dieselben Koordinaten zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="f3315-132">If you move the cursor over an element in a dialog box, the same coordinates are returned regardless of the dpi setting.</span></span> <span data-ttu-id="f3315-133">Wenn Sie ein Steuerelement bei (100, 100) zeichnen, wird es auf diese logischen Koordinaten gezeichnet und nimmt dieselbe relative Position bei jeder dpi-Einstellung an.</span><span class="sxs-lookup"><span data-stu-id="f3315-133">If you draw a control at (100, 100), it is drawn to those logical coordinates, and will occupy the same relative position at any dpi setting.</span></span>

## <a name="scaling-in-active-accessibility-clients"></a><span data-ttu-id="f3315-134">Skalieren in Active Accessibility Clients</span><span class="sxs-lookup"><span data-stu-id="f3315-134">Scaling in Active Accessibility Clients</span></span>

<span data-ttu-id="f3315-135">Microsoft Active Accessibility verwendet keine logischen Koordinaten.</span><span class="sxs-lookup"><span data-stu-id="f3315-135">Microsoft Active Accessibility does not use logical coordinates.</span></span> <span data-ttu-id="f3315-136">Die folgenden Methoden und Funktionen geben entweder physische Koordinaten zurück oder verwenden Sie als Parameter.</span><span class="sxs-lookup"><span data-stu-id="f3315-136">The following methods and functions either return physical coordinates or take them as parameters.</span></span>

-   [<span data-ttu-id="f3315-137">**IAccessible:: accHitTest**</span><span class="sxs-lookup"><span data-stu-id="f3315-137">**IAccessible::accHitTest**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest)
-   [<span data-ttu-id="f3315-138">**IAccessible:: accLocation**</span><span class="sxs-lookup"><span data-stu-id="f3315-138">**IAccessible::accLocation**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation)
-   [<span data-ttu-id="f3315-139">**Accessibleobjectfrompoint**</span><span class="sxs-lookup"><span data-stu-id="f3315-139">**AccessibleObjectFromPoint**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)

<span data-ttu-id="f3315-140">Standardmäßig kann eine Microsoft Active Accessibility-Client Anwendung, die in einer nicht-96-dpi-Umgebung ausgeführt wird, keine korrekten Ergebnisse von diesen Aufrufen abrufen.</span><span class="sxs-lookup"><span data-stu-id="f3315-140">By default, an Microsoft Active Accessibility client application running in a non-96-dpi environment will not be able to obtain correct results from these calls.</span></span> <span data-ttu-id="f3315-141">Da die Cursorposition z. b. in logischen Koordinaten angegeben ist, kann der Client diese Koordinaten nicht einfach an [**accessibleobjectfrompoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint) übergeben, um das Element zu erhalten, das sich unter dem Cursor befindet.</span><span class="sxs-lookup"><span data-stu-id="f3315-141">For example, because the cursor position is in logical coordinates, the client cannot simply pass these coordinates to [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint) to obtain the element that is under the cursor.</span></span>

<span data-ttu-id="f3315-142">Außerdem wird eine Anwendung, die ein Fenster außerhalb des Client Bereichs erstellt, z. b. eine Barrierefreiheits Anwendung, die fokussierte Benutzeroberflächen Elemente hervorhebt, das Fenster nicht an der korrekten Bildschirmposition erstellt, da das Fenster an den logischen Koordinaten platziert wird, nicht an den physischen Koordinaten, die von [**IAccessible:: accLocation**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation)zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="f3315-142">In addition, an application that creates a window outside its client area, such as an accessibility application that highlights focused UI elements, will not create the window at the correct screen location, because the window will be placed at the logical coordinates, not the physical coordinates returned by [**IAccessible::accLocation**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation).</span></span>

<span data-ttu-id="f3315-143">Die Lösung besteht aus zwei Teilen:</span><span class="sxs-lookup"><span data-stu-id="f3315-143">The solution is in two parts:</span></span>

-   <span data-ttu-id="f3315-144">Legen Sie die Client Anwendung "dpi-fähig" ab.</span><span class="sxs-lookup"><span data-stu-id="f3315-144">Make the client application "dpi-aware".</span></span> <span data-ttu-id="f3315-145">Um dies zu erreichen, müssen Sie die Funktion [**SetProcessDPIAware**](/windows/win32/api/winuser/nf-winuser-setprocessdpiaware) beim Start aufrufen.</span><span class="sxs-lookup"><span data-stu-id="f3315-145">To do this, call the [**SetProcessDPIAware**](/windows/win32/api/winuser/nf-winuser-setprocessdpiaware) function at startup.</span></span> <span data-ttu-id="f3315-146">Diese Funktion macht den gesamten Prozess dpi-fähig, was bedeutet, dass alle Fenster, die dem Prozess angehören, nicht skaliert werden.</span><span class="sxs-lookup"><span data-stu-id="f3315-146">This function makes the entire process dpi-aware, meaning that all windows that belong to the process are unscaled.</span></span>
-   <span data-ttu-id="f3315-147">Verwenden Sie Funktionen, die dpi-fähig sind.</span><span class="sxs-lookup"><span data-stu-id="f3315-147">Use functions that are dpi-aware.</span></span> <span data-ttu-id="f3315-148">Wenn Sie z. b. Cursor Koordinaten abrufen möchten, müssen Sie die [**GetPhysicalCursorPos**](/windows/win32/api/winuser/nf-winuser-getphysicalcursorpos) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="f3315-148">For example, to get cursor coordinates, call the [**GetPhysicalCursorPos**](/windows/win32/api/winuser/nf-winuser-getphysicalcursorpos) function.</span></span> <span data-ttu-id="f3315-149">Verwenden Sie [**GetCursor**](/windows/win32/api/winuser/nf-winuser-getcursorpos)nicht. das Verhalten in dpi-fähigen Anwendungen ist nicht definiert.</span><span class="sxs-lookup"><span data-stu-id="f3315-149">Do not use [**GetCursorPos**](/windows/win32/api/winuser/nf-winuser-getcursorpos); its behavior in dpi-aware applications is undefined.</span></span>

<span data-ttu-id="f3315-150">Wenn Ihre Anwendung eine direkte prozessübergreifende Kommunikation mit nicht dpi-fähigen Anwendungen ausführt, haben Sie möglicherweise eine Konvertierung zwischen logischen und physischen Koordinaten mithilfe der Funktionen [**PhysicalToLogicalPoint**](/windows/win32/api/winuser/nf-winuser-physicaltologicalpoint) und [**LogicalToPhysicalPoint**](/windows/win32/api/winuser/nf-winuser-logicaltophysicalpoint) durchführen.</span><span class="sxs-lookup"><span data-stu-id="f3315-150">If your application performs direct cross-process communication with non-dpi-aware applications, you may have convert between logical and physical coordinates by using the [**PhysicalToLogicalPoint**](/windows/win32/api/winuser/nf-winuser-physicaltologicalpoint) and [**LogicalToPhysicalPoint**](/windows/win32/api/winuser/nf-winuser-logicaltophysicalpoint) functions.</span></span>

 

 