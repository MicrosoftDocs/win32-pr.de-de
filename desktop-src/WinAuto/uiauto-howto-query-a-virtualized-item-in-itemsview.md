---
title: Abfragen eines virtualisierten Elements in der Ansicht "Elemente"
description: In diesem Thema wird beschrieben, wie Sie mit der Microsoft-Benutzeroberflächen Automatisierung Benutzeroberflächen Informationen zu virtualisierten Elementen in der Ansicht "Windows 7-Elemente" abrufen.
ms.assetid: a0bff8a1-47b1-4750-8086-e2e65a79099e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a098635d6e1045c6ff4573de088d8455685014d3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104388649"
---
# <a name="how-to-query-a-virtualized-item-in-items-view"></a><span data-ttu-id="6d7d0-103">Abfragen eines virtualisierten Elements in der Ansicht "Elemente"</span><span class="sxs-lookup"><span data-stu-id="6d7d0-103">How to Query a Virtualized Item in Items View</span></span>

<span data-ttu-id="6d7d0-104">In diesem Thema wird beschrieben, wie Sie mit der Microsoft-Benutzeroberflächen Automatisierung Benutzeroberflächen Informationen zu virtualisierten Elementen in der Ansicht "Windows 7-Elemente" abrufen.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-104">This topic describes how to use Microsoft UI Automation to retrieve UI information about virtualized items in the Windows 7 Items View.</span></span> <span data-ttu-id="6d7d0-105">Das Thema enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="6d7d0-105">This topic includes the following sections.</span></span>

> [!Note]  
> <span data-ttu-id="6d7d0-106">Dieses Thema gilt nur für Windows 7.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-106">This topic applies to Windows 7 only.</span></span> <span data-ttu-id="6d7d0-107">Beachten Sie, dass sich die in diesem Thema beschriebenen Barrierefreiheits Funktionen in zukünftigen Windows-Versionen ändern können.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-107">Be aware that the accessibility features described in this topic may change in future versions of Windows.</span></span>

 

-   [<span data-ttu-id="6d7d0-108">Übersicht</span><span class="sxs-lookup"><span data-stu-id="6d7d0-108">Overview</span></span>](#overview)
-   [<span data-ttu-id="6d7d0-109">Struktur der Element Ansicht</span><span class="sxs-lookup"><span data-stu-id="6d7d0-109">Items View Tree Structure</span></span>](#items-view-tree-structure)
-   [<span data-ttu-id="6d7d0-110">Virtualisierung</span><span class="sxs-lookup"><span data-stu-id="6d7d0-110">Virtualization</span></span>](#virtualization)
-   [<span data-ttu-id="6d7d0-111">Abrufen der Anzahl aller Elemente</span><span class="sxs-lookup"><span data-stu-id="6d7d0-111">Obtaining a Count of All Items</span></span>](#obtaining-a-count-of-all-items)
-   [<span data-ttu-id="6d7d0-112">Abrufen eines Element Indexes in Bezug auf alle Elemente</span><span class="sxs-lookup"><span data-stu-id="6d7d0-112">Obtaining an Item Index with Respect to All Items</span></span>](#obtaining-an-item-index-with-respect-to-all-items)
-   [<span data-ttu-id="6d7d0-113">Abrufen eines Verweises auf ein vitualisiertes Element</span><span class="sxs-lookup"><span data-stu-id="6d7d0-113">Obtaining a Reference to a Vitualized Item</span></span>](#obtaining-a-reference-to-a-vitualized-item)
-   [<span data-ttu-id="6d7d0-114">Scrollen eines virtualisierten Elements auf dem Bildschirm</span><span class="sxs-lookup"><span data-stu-id="6d7d0-114">Scrolling a Virtualized Item on Screen</span></span>](#scrolling-a-virtualized-item-on-screen)
-   [<span data-ttu-id="6d7d0-115">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="6d7d0-115">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="6d7d0-116">Übersicht</span><span class="sxs-lookup"><span data-stu-id="6d7d0-116">Overview</span></span>

<span data-ttu-id="6d7d0-117">Die Ansicht Elemente ist eine Benutzeroberflächen Komponente, die es Benutzern ermöglicht, Dateien und andere Elemente anzuzeigen und mit Ihnen zu interagieren.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-117">Items View is a user interface component that enables users to view and interact with files and other items.</span></span> <span data-ttu-id="6d7d0-118">In Windows 7 ersetzt die Ansicht Elemente das Listenansicht-Steuerelement für die Darstellung von Elementen in der Standardansicht von Windows-Explorer.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-118">In Windows 7, Items View replaces the list-view control for presenting items in the default view of Windows Explorer.</span></span> <span data-ttu-id="6d7d0-119">Die Ansicht Elemente wird auch im Dialog Feld allgemeine Elemente, im Startmenü-Suchergebnis und in anderen Benutzeroberflächen Elementen von Windows 7 verwendet, die das Browser-Steuerelement von Explorer verwenden.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-119">Items View is also used in the Common Item Dialog, Start menu search results, and other Windows 7 UI elements that use the Explorer Browser control.</span></span> <span data-ttu-id="6d7d0-120">Im Vergleich zum Listenansicht-Steuerelement bietet die Ansicht "Elemente" die folgenden Vorteile für Benutzer:</span><span class="sxs-lookup"><span data-stu-id="6d7d0-120">Compared to the list-view control, Items View offers the following advantages to users:</span></span>

-   <span data-ttu-id="6d7d0-121">In der Ansicht "Elemente" können Elemente auf viel nützlichere, wünschenswert und relevante Weise dargestellt werden, sodass Benutzer Elemente einfacher, schneller und benutzerfreundlich suchen und organisieren können.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-121">Items View can present items in ways that are more useful, desirable, and relevant, enabling users to find and organize items more simply, quickly, and enjoyably.</span></span>
-   <span data-ttu-id="6d7d0-122">In der Ansicht "Elemente" können große Mengen von Elementen aus Datenquellen mit unterschiedlichen Leistungsmerkmalen angezeigt werden, sodass Benutzer ihre gesamte Auflistung von Elementen über mehrere Quellen hinweg durchsuchen und durchsuchen können.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-122">Items View can display large sets of items from data sources that have different performance characteristics, enabling users to browse and search their entire collection of items across multiple sources.</span></span>

<span data-ttu-id="6d7d0-123">In der folgenden Abbildung wird die Ansicht Elemente in Windows-Explorer angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-123">The following image shows the Items View in Windows Explorer.</span></span>

![Screenshot mit der Ansichts Komponente in Windows-Explorer mit Elementen](images/itemsview.gif)

<span data-ttu-id="6d7d0-125">Aus Sicht eines Entwicklers ähneln die allgemeine Struktur und Funktionalität der Ansicht Elemente der Ansicht des Listenansicht-Steuer Elements.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-125">From a developer's perspective, the general structure and functionality of Items View is similar to that of the list-view control.</span></span> <span data-ttu-id="6d7d0-126">Der Hauptunterschied besteht darin, dass die Ansicht "Elemente" Virtualisierung unterstützt, während das Listenansicht-Steuerelement dies nicht tut.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-126">The main difference is that Items View supports virtualization, whereas the list-view control does not.</span></span> <span data-ttu-id="6d7d0-127">Außerdem werden in der Ansicht "Elemente" zwei neue Schnittstellen zur Benutzeroberflächenautomatisierung verwendet, um sicherzustellen, dass der Zugriff auf virtualisierte Inhalte der Ansicht</span><span class="sxs-lookup"><span data-stu-id="6d7d0-127">Also, Items View uses two new UI Automation interfaces to ensure that virtualized content provided by Items View is accessible.</span></span> <span data-ttu-id="6d7d0-128">Diese Schnittstellen werden in den folgenden Abschnitten dieses Themas beschrieben.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-128">These interfaces are described in the following sections of this topic.</span></span>

<span data-ttu-id="6d7d0-129">Allgemeine Informationen zur Virtualisierung in der Benutzeroberflächen Automatisierung finden Sie unter [Arbeiten mit virtualisierten Elementen](uiauto-workingwithvirtualizeditems.md).</span><span class="sxs-lookup"><span data-stu-id="6d7d0-129">For general information about virtualization in UI Automation, see [Working with Virtualized Items](uiauto-workingwithvirtualizeditems.md).</span></span>

## <a name="items-view-tree-structure"></a><span data-ttu-id="6d7d0-130">Struktur der Element Ansicht</span><span class="sxs-lookup"><span data-stu-id="6d7d0-130">Items View Tree Structure</span></span>

<span data-ttu-id="6d7d0-131">In der Benutzeroberflächenautomatisierungs-Struktur hat das Benutzeroberflächenautomatisierungs-Element der Element Ansicht der obersten Ebene den Namen "itemsview" und den Steuer Elementtyp "List".</span><span class="sxs-lookup"><span data-stu-id="6d7d0-131">In the UI Automation tree, the top level UI Automation element of Items View has the name "ItemsView" and the control type "list".</span></span> <span data-ttu-id="6d7d0-132">In der vorherigen Abbildung ist das itemsview UI Automation-Element rot dargestellt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-132">In the previous image, the ItemsView UI Automation element is outlined in red.</span></span> <span data-ttu-id="6d7d0-133">Unter der obersten Ebene von itemsview sind verschiedene Benutzeroberflächenautomatisierungs-Elemente vorhanden. in diesem Dokument wird jedoch nur auf zwei andere Benutzeroberflächenautomatisierungs-Elemente verwiesen: Gruppenelemente und Listenelemente.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-133">Various UI Automation elements exist below the top level of ItemsView, but only two other UI Automation elements are referenced in this document: group items and list items.</span></span>

<span data-ttu-id="6d7d0-134">Bei den Gruppenelementen handelt es sich um Benutzeroberflächenautomatisierungs-Elemente, die alle Listenelemente dieser Gruppe enthalten – der Steuer Elementtyp ist "Group", und ihre Namen variieren je nach Gruppenname.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-134">The group items are the UI Automation elements that contain all of the list items of that group—their control type is "Group" and their names vary depending on the group name.</span></span> <span data-ttu-id="6d7d0-135">In der vorherigen Abbildung enthält das erste Gruppenelement sowohl den Header "a-h (1)" als auch das Listenelement "Ordner", und sein Name ist "a-h".</span><span class="sxs-lookup"><span data-stu-id="6d7d0-135">In the previous image, the first group item contains both the "A-H (1)" header and the "Folder" list item, and its name is "A-H".</span></span>

<span data-ttu-id="6d7d0-136">Die Listenelemente sind die Benutzeroberflächenautomatisierungs-Elemente, die die Blatt Elemente in der Ansicht darstellen – Ihr Steuer Elementtyp ist "ListItem", und ihre Namen variieren je nach Elementname.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-136">The list items are the UI Automation elements that represent the leaf items in the view—their control type is "ListItem" and their names vary depending on the item name.</span></span> <span data-ttu-id="6d7d0-137">In der vorherigen Abbildung sind die Listenelemente die Blatt Elemente wie "Folder", "Music" und "Picture".</span><span class="sxs-lookup"><span data-stu-id="6d7d0-137">In the previous image, the list elements are the leaf elements such as "Folder", "Music", and "Picture".</span></span> <span data-ttu-id="6d7d0-138">Diese drei Benutzeroberflächenautomatisierungs-Elemente werden durch die Begriffe itemsview-Element, Group-Element und ListItem-Element im restlichen Teil dieses Dokuments bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-138">These three UI Automation elements are referred to by the terms ItemsView element, Group element, and ListItem element in the remainder of this document.</span></span>

## <a name="virtualization"></a><span data-ttu-id="6d7d0-139">Virtualisierung</span><span class="sxs-lookup"><span data-stu-id="6d7d0-139">Virtualization</span></span>

<span data-ttu-id="6d7d0-140">Die Ansicht "Elemente" verwendet die Virtualisierung, d. h., Elemente außerhalb des sichtbaren Bereichs der Ansicht werden nicht aus dem System abgerufen, und die Darstellung der Benutzeroberfläche wird nicht erstellt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-140">Items View uses virtualization, which means that items outside the visible area of the view are not fetched from the system, and the UI representation of them is not created.</span></span> <span data-ttu-id="6d7d0-141">Diese Elemente werden als *virtualisierte Elemente* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-141">These items are called *virtualized items*.</span></span> <span data-ttu-id="6d7d0-142">Da Sie nicht erstellt werden, verfügen virtualisierte Elemente nicht über Benutzeroberflächenautomatisierungs-Elemente und werden daher nicht in der Benutzeroberflächenautomatisierungs-Struktur angezeigt, wenn ein Benutzeroberflächenautomatisierungs-Client die Struktur auflistet.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-142">Because they are not created, virtualized items do not have UI Automation elements and therefore do not appear in the UI Automation tree when a UI Automation client enumerates the tree.</span></span> <span data-ttu-id="6d7d0-143">Außerdem funktionieren Benutzeroberflächenautomatisierungs-Steuerelement Muster nur für sichtbare Elemente.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-143">Also, UI Automation control patterns operate only on visible elements.</span></span> <span data-ttu-id="6d7d0-144">Das [Selection](uiauto-implementingselection.md) -Steuerelement Muster gibt z. b. nur die sichtbaren ausgewählten Elemente zurück, wenn ein Client die [**iuiautomationselectionpattern:: GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) -Methode aufruft.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-144">For example, the [Selection](uiauto-implementingselection.md) control pattern returns only the visible selected items when a client calls the [**IUIAutomationSelectionPattern::GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) method.</span></span>

<span data-ttu-id="6d7d0-145">Die Ansicht Elemente unterstützt die Möglichkeit, die folgenden Informationen zu virtualisierten Elementen abzurufen:</span><span class="sxs-lookup"><span data-stu-id="6d7d0-145">Items View supports the ability to retrieve the following information about virtualized items:</span></span>

-   <span data-ttu-id="6d7d0-146">Gibt die Gesamtzahl der Elemente an, einschließlich virtualisierter Elemente.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-146">A count of the total number of items, including virtualized items</span></span>
-   <span data-ttu-id="6d7d0-147">Benutzeroberflächenautomatisierungs-Elemente für virtualisierte Elemente</span><span class="sxs-lookup"><span data-stu-id="6d7d0-147">UI Automation elements for virtualized items</span></span>
-   <span data-ttu-id="6d7d0-148">Benutzeroberflächenautomatisierungs-Elemente für die ausgewählten virtualisierten Elemente</span><span class="sxs-lookup"><span data-stu-id="6d7d0-148">UI Automation elements for the virtualized items that are selected</span></span>

## <a name="obtaining-a-count-of-all-items"></a><span data-ttu-id="6d7d0-149">Abrufen der Anzahl aller Elemente</span><span class="sxs-lookup"><span data-stu-id="6d7d0-149">Obtaining a Count of All Items</span></span>

<span data-ttu-id="6d7d0-150">Ein Client kann das itemsview-Element verwenden, um die Anzahl aller Elemente sowie die Anzahl der ausgewählten Elemente zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-150">A client can use the ItemsView element to get a count of all items, as well as a count of the selected items.</span></span> <span data-ttu-id="6d7d0-151">Das itemsview-Element bietet zwei Möglichkeiten, um diese Zähler zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-151">The ItemsView element provides two ways to get these counts.</span></span> <span data-ttu-id="6d7d0-152">Der erste besteht darin, die ItemStatus-Eigenschaft des itemsview-Elements abzurufen, und der zweite besteht darin, benutzerdefinierte Eigenschaften aus dem itemsview-Element abzurufen.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-152">The first is by getting the ItemStatus property of the ItemsView element, and the second is by getting custom properties from the ItemsView element.</span></span>

<span data-ttu-id="6d7d0-153">Die ItemStatus-Eigenschaft ist eine Zeichenfolge, die die Anzahl der Elemente und die Anzahl der ausgewählten Elemente, getrennt durch ein Komma, angibt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-153">The ItemStatus property is a string that specifies a count of the total number of items and a count of the selected items, separated by a comma.</span></span> <span data-ttu-id="6d7d0-154">Beispiel: "3 Items, 1 Element ausgewählt".</span><span class="sxs-lookup"><span data-stu-id="6d7d0-154">For example: "3 items, 1 item selected".</span></span> <span data-ttu-id="6d7d0-155">Diese Zeichenfolge ist lokalisiert und kann direkt an den Benutzer übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-155">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="6d7d0-156">Die benutzerdefinierten Eigenschaften des Elements itemsview enthalten eine Eigenschaft für die Element Anzahl und eine weitere für die Auswahl Anzahl.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-156">The custom properties of the ItemsView element include one property for the item count, and another for the selection count.</span></span> <span data-ttu-id="6d7d0-157">Dazu gehören:</span><span class="sxs-lookup"><span data-stu-id="6d7d0-157">They include:</span></span>

-   <span data-ttu-id="6d7d0-158">ItemCount- \_ Eigenschafts- \_ GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162) – die Anzahl aller eindeutigen Elemente in der Sicht.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-158">ItemCount\_Property\_GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162)—The count of all unique items in the view.</span></span> <span data-ttu-id="6d7d0-159">Wenn eine Gruppierung nach einer mehrwertigen Eigenschaft (MVP) erfolgt, sodass ein einzelnes Element mehrmals vorkommen kann, wird jedes Element nur einmal gezählt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-159">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="6d7d0-160">(Uiautomationtype: [**uiautomationtype \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), programmatischer Name: "ItemCount")</span><span class="sxs-lookup"><span data-stu-id="6d7d0-160">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemCount")</span></span>

-   <span data-ttu-id="6d7d0-161">Selecteditemcount- \_ Eigenschafts- \_ GUID (92a053da-2969-4021-BF27-514cfc2e4a69) – die Anzahl der in der Ansicht ausgewählten eindeutigen Elemente.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-161">SelectedItemCount\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The count of all unique items selected in the view.</span></span> <span data-ttu-id="6d7d0-162">Wenn eine Gruppierung nach einer mehrwertigen Eigenschaft (MVP) erfolgt, sodass ein einzelnes Element mehrmals vorkommen kann, wird jedes Element nur einmal gezählt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-162">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="6d7d0-163">(Uiautomationtype: [**uiautomationtype \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), programmatischer Name: "selecteditemcount")</span><span class="sxs-lookup"><span data-stu-id="6d7d0-163">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "SelectedItemCount")</span></span>

<span data-ttu-id="6d7d0-164">Diese benutzerdefinierten Eigenschaften werden in shlguid. h definiert, das im Windows Software Development Kit (SDK) enthalten ist, und diese Eigenschaften werden über die [**iuiautomationregistrar:: registerproperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) -Methode registriert.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-164">These custom properties are defined in Shlguid.h, which is included in the Windows Software Development Kit (SDK), and these properties are registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="6d7d0-165">Benutzeroberflächenautomatisierungs-Clients verwenden **registerproperty** zum Abrufen von Eigenschafts Bezeichners (PropertyIDs) für die benutzerdefinierten Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-165">UI Automation clients use **RegisterProperty** to retrieve property identifiers (PROPERTYIDs) for the custom properties.</span></span>

## <a name="obtaining-an-item-index-with-respect-to-all-items"></a><span data-ttu-id="6d7d0-166">Abrufen eines Element Indexes in Bezug auf alle Elemente</span><span class="sxs-lookup"><span data-stu-id="6d7d0-166">Obtaining an Item Index with Respect to All Items</span></span>

<span data-ttu-id="6d7d0-167">Ein Client kann den Index eines Elements abrufen, indem er entweder die ItemStatus-Eigenschaft eines ListItem-Elements oder eine benutzerdefinierte Eigenschaft eines ListItem-Elements erhält.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-167">A client can obtain the index of an item either by getting the ItemStatus property of a ListItem element, or by getting a custom property of a ListItem element.</span></span>

<span data-ttu-id="6d7d0-168">Die ItemStatus-Eigenschaft ist eine Zeichenfolge, die den Index eines Elements in Bezug auf die Gesamtanzahl von Elementen enthält.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-168">The ItemStatus property is a string that contains the index of an item with respect to the total number of items.</span></span> <span data-ttu-id="6d7d0-169">Beispiel: "Item 1 of 3".</span><span class="sxs-lookup"><span data-stu-id="6d7d0-169">For example: "item 1 of 3".</span></span> <span data-ttu-id="6d7d0-170">Diese Zeichenfolge ist lokalisiert und kann direkt an den Benutzer übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-170">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="6d7d0-171">Die folgende benutzerdefinierte Eigenschaft ruft den Element Index eines ListItem-Elements ab:</span><span class="sxs-lookup"><span data-stu-id="6d7d0-171">The following custom property gets the item index of a ListItem element:</span></span>

-   <span data-ttu-id="6d7d0-172">ItemIndex- \_ Eigenschafts- \_ GUID (92a053da-2969-4021-BF27-514cfc2e4a69) – den 1-basierten absoluten Index eines Elements.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-172">ItemIndex\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The 1-based absolute index of an item.</span></span> <span data-ttu-id="6d7d0-173">Wenn Sie nach einer mehrwertigen Eigenschaft (MVP) gruppiert werden, sodass ein einzelnes Element zweimal angezeigt werden kann, erhält jede Darstellung des Elements einen separaten Index.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-173">If grouped by a multi-value property (MVP) so that a single item can appear twice, each appearance of the item gets a separate index.</span></span>

    <span data-ttu-id="6d7d0-174">(Uiautomationtype: [**uiautomationtype \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), programmatischer Name: "ItemIndex")</span><span class="sxs-lookup"><span data-stu-id="6d7d0-174">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemIndex")</span></span>

<span data-ttu-id="6d7d0-175">Diese benutzerdefinierte Eigenschaft wird in der Datei "shlguid. h" definiert, die im Windows SDK enthalten ist und über die Methode " [**iuiautomationregistrierungs Registrierungsmethode:: registerproperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) " registriert wird.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-175">This custom property is defined in Shlguid.h, which is included in the Windows SDK, and is registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="6d7d0-176">Benutzeroberflächenautomatisierungs-Clients rufen mithilfe von **registerproperty** einen Eigenschafts Bezeichner (PropertyIDs) für die benutzerdefinierte Eigenschaft ab.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-176">UI Automation clients use **RegisterProperty** to retrieve a property identifier (PROPERTYIDs) for the custom property.</span></span>

## <a name="obtaining-a-reference-to-a-vitualized-item"></a><span data-ttu-id="6d7d0-177">Abrufen eines Verweises auf ein vitualisiertes Element</span><span class="sxs-lookup"><span data-stu-id="6d7d0-177">Obtaining a Reference to a Vitualized Item</span></span>

<span data-ttu-id="6d7d0-178">Ein itemsview-Element implementiert das [ItemContainer](uiauto-implementingitemcontainer.md) -Steuerelement Muster ([**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) Interface), das einem Client das Aufrufen eines Benutzeroberflächenautomatisierungs-Elements für ein virtualisiertes Element ermöglicht (ein Element, das sich außerhalb des sichtbaren Bereichs befindet).</span><span class="sxs-lookup"><span data-stu-id="6d7d0-178">An ItemsView element implements the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern ([**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) interface), which allows a client to get a UI Automation element for a virtualized item (an item that is outside the visible area).</span></span> <span data-ttu-id="6d7d0-179">Itemsview ermöglicht es dem Client, ein ListItem-Element Durchsuchen der Eigenschaften "Name" und "Selection" zu suchen – bei dem Versuch, eine andere Eigenschaft zu suchen, tritt ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-179">ItemsView allows the client to find a ListItem element by searching on the Name and Selection properties—attempting to search on any other property will fail.</span></span>

<span data-ttu-id="6d7d0-180">Ein virtuelles Element implementiert nur das [VirtualizedItem](uiauto-implementingvirtualizeditem.md) -Steuerelement Muster ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) -Schnittstelle).</span><span class="sxs-lookup"><span data-stu-id="6d7d0-180">A virtual element implements only the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) interface).</span></span> <span data-ttu-id="6d7d0-181">Da das Element, das von einem virtualisierten Benutzeroberflächenautomatisierungs-Element dargestellt wird, noch nicht vorhanden ist, tritt beim Versuch, ein anderes Steuerelement Muster oder eine Eigenschaft des Elements zu erhalten, ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-181">Because the item that is represented by a virtualized UI Automation element does not exist yet, attempting to get any other control pattern or property of the element will fail.</span></span>

<span data-ttu-id="6d7d0-182">Sowohl ListItem-als auch Group-Elemente werden virtualisiert, aber nur ListItem-Elemente können vom [ItemContainer](uiauto-implementingitemcontainer.md) -Steuerelement Muster zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-182">Both ListItem and Group elements are virtualized, but only ListItem elements can be returned from the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="6d7d0-183">Da der Aufruf der [**iuiautomationitemcontainerpattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) -Methode im UI-Thread ausgeführt wird und blockiert wird, antwortet die Ansicht erst, wenn **FindItemByProperty** zurückgibt, und alle anderen Methodenaufrufe für den Anbieter müssen warten, bis **FindItemByProperty** abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-183">Because the call to the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method runs on the UI thread and is blocking, the view will not respond until **FindItemByProperty** returns, and any other method calls on the provider must wait until **FindItemByProperty** finishes.</span></span> <span data-ttu-id="6d7d0-184">In einigen Fällen muss **FindItemByProperty** das gesamte Dataset vor der Rückgabe verarbeiten, was ressourcenintensiv sein kann.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-184">In some instances, **FindItemByProperty** must process the entire data set before returning, which can be resource-intensive.</span></span> <span data-ttu-id="6d7d0-185">Das Angeben von **null** als Start Element bewirkt, dass **FindItemByProperty** die Suche mit dem ersten Element in der Ansicht startet.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-185">Specifying **NULL** as the starting element causes **FindItemByProperty** to begin the search with the first item in the view.</span></span>

<span data-ttu-id="6d7d0-186">Itemsview unterstützt die folgenden Eigenschaften für [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span><span class="sxs-lookup"><span data-stu-id="6d7d0-186">ItemsView supports the following properties for [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span></span>

-   <span data-ttu-id="6d7d0-187">Name (UIA \_ namepropertyid) – sucht nach dem ersten Element, dessen Name vollständig mit der angegebenen Zeichenfolge übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-187">Name (UIA\_NamePropertyId)—Searches for the first item whose name fully matches the specified string.</span></span> <span data-ttu-id="6d7d0-188">Bei der Suche wird die Groß- und Kleinschreibung nicht berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-188">The search is not case sensitive.</span></span> <span data-ttu-id="6d7d0-189">Platzhalter Zeichen oder partielle Übereinstimmungen werden nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-189">Wildcard characters or partial matching is not supported.</span></span> <span data-ttu-id="6d7d0-190">Wenn ein **null** -Name angegeben wird, wird das nächste Element nach dem Start Element zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-190">If a **NULL** name is specified, the next item after the starting element is returned.</span></span> <span data-ttu-id="6d7d0-191">Durch Angeben von **null** -Namen kann ein Benutzeroberflächenautomatisierungs-Client alle Elemente in der Ansicht auflisten. Allerdings wird davon abgeraten, alle Elemente aufzuzählen, da dadurch alle Elemente in der Ansicht realisiert werden.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-191">Specifying **NULL** names allows a UI Automation client to enumerate all items in the view; however, enumerating all items is discouraged because it causes all items in the view to be realized.</span></span>
-   <span data-ttu-id="6d7d0-192">SelectionItem \_ issselect (UIA \_ selectionitemisselectedpropertyid) – sucht nach dem ersten Element, dessen SelectionItem \_ issgewählte-Eigenschaft mit dem angegebenen Wert übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-192">SelectionItem\_IsSelected (UIA\_SelectionItemIsSelectedPropertyId)—Searches for the first item whose SelectionItem\_IsSelected property matches the specified value.</span></span> <span data-ttu-id="6d7d0-193">Geben Sie **true** an, um das erste ausgewählte Element zu suchen, oder **false** , um das erste nicht ausgewählte Element zu suchen.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-193">Specify **TRUE** to find the first selected item, or **FALSE** to find the first non-selected item.</span></span> <span data-ttu-id="6d7d0-194">Seien Sie vorsichtig, wenn Sie alle ausgewählten Elemente auflisten, weil die Anzahl der ausgewählten Elemente sehr groß sein kann, insbesondere, wenn der Benutzer alle Elemente ausgewählt hat.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-194">Be careful when enumerating all selected items because the number of selected items can be very large, especially if the user has selected all items.</span></span>

## <a name="scrolling-a-virtualized-item-on-screen"></a><span data-ttu-id="6d7d0-195">Scrollen eines virtualisierten Elements auf dem Bildschirm</span><span class="sxs-lookup"><span data-stu-id="6d7d0-195">Scrolling a Virtualized Item on Screen</span></span>

<span data-ttu-id="6d7d0-196">Nachdem Sie einen Verweis auf ein Benutzeroberflächenautomatisierungs-Element für ein virtualisiertes (Bildschirm-) Element abgerufen haben, kann der Client mithilfe der [**iuiautomationvirtualizeitempattern::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) Shoot-Methode des [VirtualizedItem](uiauto-implementingvirtualizeditem.md) -Steuerelement Musters einen Bildlauf durchführen.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-196">After obtaining a reference to a UI Automation element for a virtualized (off-screen) item, the client can scroll the item into view by using the [**IUIAutomationVirtualizeItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method of the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="6d7d0-197">Nachdem das Element erkannt wurde, ist es sichtbar, und alle Eigenschaften und Steuerelement Muster, die normalerweise einem ListItem-Element zugeordnet sind, stehen dem Client zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-197">After the item is realized, it is visible, and all properties and control patterns normally associated with a ListItem element are available to the client.</span></span>

<span data-ttu-id="6d7d0-198">Nur ListItem-Elemente, die von der [**iuiautomationitemcontainerpattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) -Methode abgerufen werden, machen das [VirtualizedItem](uiauto-implementingvirtualizeditem.md) -Steuerelement Muster verfügbar.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-198">Only ListItem elements obtained by the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method expose the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="6d7d0-199">Wenn ein Bild auf einem Bildschirm vom Bildschirm entfernt wird, wird das Element ungültig, und der Client muss **FindItemByProperty** aufrufen, um den Bildschirm Verweis zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-199">When an on-screen element is scrolled off-screen, the element becomes invalid and the client must call **FindItemByProperty** to get the off-screen reference.</span></span>

<span data-ttu-id="6d7d0-200">Es ist auch möglich, Elemente mithilfe des [Scroll](uiauto-implementingscroll.md) -Steuerelement Musters (oder mithilfe der Scrollleisten) in die Ansicht und aus der Ansicht zu verschieben.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-200">It is also possible to move items into and out of view by using the [Scroll](uiauto-implementingscroll.md) control pattern (or by using the scroll bars).</span></span> <span data-ttu-id="6d7d0-201">Elemente und Gruppen werden beim Scrollen in der Ansicht realisiert und virtualisiert, wenn Sie in der Ansicht einen Bildlauf durchführen.</span><span class="sxs-lookup"><span data-stu-id="6d7d0-201">Items and groups are realized as they scroll into view, and are virtualized as they scroll out of view.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6d7d0-202">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="6d7d0-202">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6d7d0-203">Arbeiten mit virtualisierten Elementen</span><span class="sxs-lookup"><span data-stu-id="6d7d0-203">Working with Virtualized Items</span></span>](uiauto-workingwithvirtualizeditems.md)
</dt> </dl>

 

 




