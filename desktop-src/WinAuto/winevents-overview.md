---
title: Übersicht über WinEvents und Active Accessibility
description: Microsoft Active Accessibility-Server rufen WinEvents auf, um Clients zu benachrichtigen, wenn sich ein Barrierefreies Objekt ändert.
ms.assetid: a2d486ee-84ef-4c44-a832-dbc0dae81542
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b351b1ce7b6337c4ca0ac0827daff2978c6611af
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/29/2020
ms.locfileid: "103948385"
---
# <a name="winevents-and-active-accessibility"></a><span data-ttu-id="3fd97-103">WinEvents und Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="3fd97-103">WinEvents and Active Accessibility</span></span>

<span data-ttu-id="3fd97-104">Microsoft Active Accessibility-Server rufen *WinEvents* auf, um Clients zu benachrichtigen, wenn sich ein Barrierefreies Objekt ändert.</span><span class="sxs-lookup"><span data-stu-id="3fd97-104">Microsoft Active Accessibility servers raise *WinEvents* to notify clients when an accessible object changes.</span></span> <span data-ttu-id="3fd97-105">Es gibt zahlreiche Bedingungen, bei denen ein Server einen Client über eine Änderung benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="3fd97-105">There are numerous conditions in which a server notifies a client of a change.</span></span> <span data-ttu-id="3fd97-106">Jede von Active Accessibility Microsoft definierte [Ereignis Konstante](event-constants.md) beschreibt eine Bedingung, über die ein Client benachrichtigt wird.</span><span class="sxs-lookup"><span data-stu-id="3fd97-106">Each [event constant](event-constants.md) defined by Microsoft Active Accessibility describes a condition about which a client is notified.</span></span> <span data-ttu-id="3fd97-107">WinEvents kann beispielsweise Folgendes signalisieren:</span><span class="sxs-lookup"><span data-stu-id="3fd97-107">For example, WinEvents can signal:</span></span>

- <span data-ttu-id="3fd97-108">Wenn ein Objekt erstellt oder zerstört wird.</span><span class="sxs-lookup"><span data-stu-id="3fd97-108">When an object is created or destroyed.</span></span>
- <span data-ttu-id="3fd97-109">Wenn ein Objekt den Fokus erhält oder verliert.</span><span class="sxs-lookup"><span data-stu-id="3fd97-109">When an object receives or loses focus.</span></span>
- <span data-ttu-id="3fd97-110">Wenn sich der Zustand oder der Speicherort eines Objekts ändert.</span><span class="sxs-lookup"><span data-stu-id="3fd97-110">When the state or location of an object changes.</span></span>
- <span data-ttu-id="3fd97-111">Wenn eine Eigenschaft eines Objekts geändert wird.</span><span class="sxs-lookup"><span data-stu-id="3fd97-111">When any property of an object changes.</span></span>

<span data-ttu-id="3fd97-112">Client Anwendungen empfangen Ereignis Benachrichtigungen nicht automatisch. Sie müssen angeben, welche Ereignisse Sie empfangen möchten, indem Sie die [**setwineventhook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="3fd97-112">Client applications do not receive event notifications automatically; they must specify which events they want to receive by calling the [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) function.</span></span> <span data-ttu-id="3fd97-113">Mit **setwineventhook** registriert ein Client, dass ein oder mehrere Ereignisse empfangen werden, und legt eine Hook-Funktion fest, um die angegebenen Ereignisse zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="3fd97-113">With **SetWinEventHook**, a client registers to receive one or more events and sets a hook function to handle the specified events.</span></span> <span data-ttu-id="3fd97-114">Clients können die gleiche Hook-Funktion verwenden, um mehrere Arten von Ereignissen zu verarbeiten, oder Sie können mehrere-Hook-Funktionen verwenden.</span><span class="sxs-lookup"><span data-stu-id="3fd97-114">Clients can use the same hook function to handle multiple types of events, or it can use multipe hook functions.</span></span> <span data-ttu-id="3fd97-115">Clients wird **setwineventhook** einmal für jede Hook-Funktion aufgerufen, die Sie registrieren müssen.</span><span class="sxs-lookup"><span data-stu-id="3fd97-115">Clients call the **SetWinEventHook** once for each hook function it needs to register.</span></span>

<span data-ttu-id="3fd97-116">Hook-Funktionen befinden sich im Code Körper des Clients, in einer DLL, die dem Client Prozess zugeordnet ist, oder in einer DLL, die dem Server Prozess zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="3fd97-116">Hook functions are located within the client's code body, in a DLL mapped into the client's process, or in a DLL mapped into the server's process.</span></span> <span data-ttu-id="3fd97-117">Jede dieser Methoden hat vor-und Nachteile.</span><span class="sxs-lookup"><span data-stu-id="3fd97-117">Each of these methods has advantages and disadvantages.</span></span> <span data-ttu-id="3fd97-118">Weitere Informationen finden Sie unter [Kontext übergreifende und Out-of-Context-Hook-Funktionen](in-context-and-out-of-context-hook-functions.md).</span><span class="sxs-lookup"><span data-stu-id="3fd97-118">For more information, see [In-Context and Out-of-Context Hook Functions](in-context-and-out-of-context-hook-functions.md).</span></span>

<span data-ttu-id="3fd97-119">Zum Benachrichtigen von Clients über ein Ereignis auftreten, wird " [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent)" aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="3fd97-119">To notify clients of an event occurrence, servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span></span> <span data-ttu-id="3fd97-120">Das System überprüft, ob Client Anwendungen Hook-Funktionen für das Ereignis festgelegt haben, und ruft bei Bedarf die entsprechenden Hook-Funktionen auf.</span><span class="sxs-lookup"><span data-stu-id="3fd97-120">The system checks whether any client applications have set hook functions for the event and calls the appropriate hook functions as necessary.</span></span>

<span data-ttu-id="3fd97-121">Wenn die Hook-Funktion des Clients aufgerufen wird, empfängt Sie eine Reihe von Parametern, die das Ereignis und das Objekt beschreiben, das das Ereignis generiert hat.</span><span class="sxs-lookup"><span data-stu-id="3fd97-121">When the client's hook function is called, it receives a number of parameters that describe the event and the object that generated the event.</span></span> <span data-ttu-id="3fd97-122">Um Zugriff auf das Objekt zu erhalten, das das Ereignis generiert hat, ruft die Client-Hook-Funktion [**accessibleobjectfromevent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent)auf.</span><span class="sxs-lookup"><span data-stu-id="3fd97-122">To gain access to the object that generated the event, the client hook function calls [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span></span>

> [!NOTE]
> <span data-ttu-id="3fd97-123">Wenn keine Clients für den Empfang von WinEvents registriert sind, ist die Auswirkungen auf die Leistung eines Servers zum Aufrufen von [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) unerheblich.</span><span class="sxs-lookup"><span data-stu-id="3fd97-123">If no clients have registered to receive WinEvents, the performance impact on a server for calling [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) is negligible.</span></span>
>
> <span data-ttu-id="3fd97-124">Server wenden [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) für Änderungen nur in ihren eigenen zugänglichen Objekten an. Sie werden für Änderungen an vom System bereitgestellten Benutzeroberflächen Elementen nicht als **NotifyWinEvent** bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="3fd97-124">Servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) for changes only in their own accessible objects; they do not call **NotifyWinEvent** for changes in system-provided user interface elements.</span></span>

## <a name="event-driven-communication"></a><span data-ttu-id="3fd97-125">Event-Driven Kommunikation</span><span class="sxs-lookup"><span data-stu-id="3fd97-125">Event-Driven Communication</span></span>

<span data-ttu-id="3fd97-126">Clients müssen einen WinEvent-Hook registrieren, bevor Sie WinEvent-Benachrichtigungen empfangen können.</span><span class="sxs-lookup"><span data-stu-id="3fd97-126">Clients must register a WinEvent hook before they can receive WinEvent notifications.</span></span> <span data-ttu-id="3fd97-127">Um unnötige Rückrufe zu vermeiden und die Leistung zu verbessern, wird empfohlen, nur für die Ereignisse zu registrieren, die Sie empfangen müssen.</span><span class="sxs-lookup"><span data-stu-id="3fd97-127">To avoid unnecessary callbacks and improve performance, clients are advised to register only for the events they need to receive.</span></span>

<span data-ttu-id="3fd97-128">Innerhalb der Hook-Prozedur kann der Client [**accessibleobjectfromevent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) aufrufen, um ein [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) -Objekt für das Element abzurufen, auf das das Ereignis angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="3fd97-128">Inside the hook procedure, the client can call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) to retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object for the element to which the event applies.</span></span> <span data-ttu-id="3fd97-129">Mit diesem Objekt kann der Client mit dem Aufrufen von **IAccessible** -Methoden beginnen, um Informationen abzurufen oder mit dem UI-Element zu interagieren.</span><span class="sxs-lookup"><span data-stu-id="3fd97-129">With this object, the client can begin calling **IAccessible** methods to retrieve information or interact with the UI element.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3fd97-130">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="3fd97-130">Related topics</span></span>

[<span data-ttu-id="3fd97-131">WinEvents</span><span class="sxs-lookup"><span data-stu-id="3fd97-131">WinEvents</span></span>](winevents-infrastructure.md)
