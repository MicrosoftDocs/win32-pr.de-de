---
title: ExpandCollapse-Steuerelement Muster
description: Beschreibt Richtlinien und Konventionen für das Implementieren von iexpandreduseprovider, einschließlich Informationen zu Eigenschaften, Methoden und Ereignissen.
ms.assetid: 0ffc26c3-8696-44f9-b463-902a69e06d21
keywords:
- Benutzeroberflächen Automatisierung, Implementieren eines ExpandCollapse-Steuerelement Musters
- UI-Automatisierung, ExpandCollapse-Steuerelement Muster
- UI-Automatisierung, iexpandreduseprovider
- IExpandCollapseProvider
- Implementieren von ExpandCollapse-Steuerelement Mustern für Benutzeroberflächen Automatisierung
- ExpandCollapse-Steuerelement Muster
- Steuerelement Muster, iexpandreduseprovider
- Steuerelement Muster, Implementieren der Benutzeroberflächen Automatisierung ExpandCollapse
- Steuerelement Muster, ExpandCollapse
- Schnittstellen, iexpandreduseprovider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45bd28ddcc201dcff0a4811a1eb8e04670f93091
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "104036726"
---
# <a name="expandcollapse-control-pattern"></a><span data-ttu-id="b6139-113">ExpandCollapse-Steuerelement Muster</span><span class="sxs-lookup"><span data-stu-id="b6139-113">ExpandCollapse Control Pattern</span></span>

<span data-ttu-id="b6139-114">Beschreibt Richtlinien und Konventionen für das Implementieren von [**iexpandreduseprovider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider), einschließlich Informationen zu Eigenschaften, Methoden und Ereignissen.</span><span class="sxs-lookup"><span data-stu-id="b6139-114">Describes guidelines and conventions for implementing [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider), including information about properties, methods, and events.</span></span> <span data-ttu-id="b6139-115">Das **ExpandCollapse** -Steuerelement Muster wird verwendet, um Steuerelemente zu unterstützen, die visuell erweitert werden, um mehr Inhalt anzuzeigen und den Inhalt auszublenden.</span><span class="sxs-lookup"><span data-stu-id="b6139-115">The **ExpandCollapse** control pattern is used to support controls that visually expand to display more content and collapse to hide content.</span></span>

<span data-ttu-id="b6139-116">Beispiele für Steuerelemente, die dieses Steuerelement Muster implementieren, finden Sie [unter Steuerelement Typen und ihre unterstützten Steuerelement Muster](uiauto-controlpatternmapping.md).</span><span class="sxs-lookup"><span data-stu-id="b6139-116">For examples of controls that implement this control pattern, see [Control Types and Their Supported Control Patterns](uiauto-controlpatternmapping.md).</span></span>

<span data-ttu-id="b6139-117">Dieses Thema enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="b6139-117">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="b6139-118">Implementierungsrichtlinien und -konventionen</span><span class="sxs-lookup"><span data-stu-id="b6139-118">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="b6139-119">Erforderliche Member für **iexpandreduseprovider**</span><span class="sxs-lookup"><span data-stu-id="b6139-119">Required Members for **IExpandCollapseProvider**</span></span>](#required-members-for-iexpandcollapseprovider)
-   [<span data-ttu-id="b6139-120">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="b6139-120">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="b6139-121">Implementierungsrichtlinien und -konventionen</span><span class="sxs-lookup"><span data-stu-id="b6139-121">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="b6139-122">Beachten Sie beim Implementieren des **ExpandCollapse** -Steuerelement Musters die folgenden Richtlinien und Konventionen:</span><span class="sxs-lookup"><span data-stu-id="b6139-122">When implementing the **ExpandCollapse** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="b6139-123">Aggregat Steuerelemente, die mit untergeordneten Objekten erstellt wurden, die die Benutzeroberfläche mit Erweiterungs-/reduzierungsfunktionalität bereitstellen, müssen das **ExpandCollapse** -Steuerelement Muster unterstützen, während deren unter</span><span class="sxs-lookup"><span data-stu-id="b6139-123">Aggregate controls, built with child objects that provide the UI with expand/collapse functionality, must support the **ExpandCollapse** control pattern whereas their child elements do not.</span></span> <span data-ttu-id="b6139-124">Beispielsweise wird ein Kombinations Feld-Steuerelement mit einer Kombination aus Listenfeld-, Schaltflächen-und Bearbeitungs Steuerelementen erstellt, aber es ist nur das übergeordnete Kombinations Feld, das das **ExpandCollapse** -Steuerelement Muster unterstützen muss.</span><span class="sxs-lookup"><span data-stu-id="b6139-124">For example, a combo box control is built with a combination of list box, button, and edit controls, but it is only the parent combo box that must support the **ExpandCollapse** control pattern.</span></span>
    > [!Note]  
    > <span data-ttu-id="b6139-125">Eine Ausnahme stellt das Menü Steuerelement dar, bei dem es sich um ein Aggregat einzelner Menü Element Objekte handelt.</span><span class="sxs-lookup"><span data-stu-id="b6139-125">An exception is the menu control, which is an aggregate of individual menu item objects.</span></span> <span data-ttu-id="b6139-126">Die Menü Element Objekte können das **ExpandCollapse** -Steuerelement Muster unterstützen, aber das übergeordnete Menü Steuerelement ist nicht möglich.</span><span class="sxs-lookup"><span data-stu-id="b6139-126">The menu item objects can support the **ExpandCollapse** control pattern, but the parent menu control cannot.</span></span> <span data-ttu-id="b6139-127">Eine ähnliche Ausnahme gilt für die Struktur-und Strukturelement-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="b6139-127">A similar exception applies to the tree and tree item controls.</span></span>

     

-   <span data-ttu-id="b6139-128">Wenn [**iexpandreduseprovider:: expandredusestate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) eines Steuer Elements auf **expandredusestate \_ leafnode** festgelegt ist, sind alle **ExpandCollapse** -Funktionen für das Steuerelement derzeit inaktiv, und die einzigen Informationen, die mithilfe dieses Steuerelement Musters abgerufen werden können, sind **expandredusestate**.</span><span class="sxs-lookup"><span data-stu-id="b6139-128">When the [**IExpandCollapseProvider::ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) of a control is set to **ExpandCollapseState\_LeafNode**, any **ExpandCollapse** functionality is currently inactive for the control and the only information that can be obtained using this control pattern is the **ExpandCollapseState**.</span></span> <span data-ttu-id="b6139-129">Wenn nachfolgend untergeordnete Objekte hinzugefügt werden, werden die Funktionen " **expandredusestate** " und " **ExpandCollapse** " aktiviert.</span><span class="sxs-lookup"><span data-stu-id="b6139-129">If any child objects are subsequently added, the **ExpandCollapseState** changes and **ExpandCollapse** functionality is activated.</span></span>
-   <span data-ttu-id="b6139-130">[**Expandredusestate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) verweist nur auf die Sichtbarkeit unmittelbarer untergeordneter Objekte. Sie verweist nicht auf die Sichtbarkeit aller untergeordneten Objekte.</span><span class="sxs-lookup"><span data-stu-id="b6139-130">[**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) refers to the visibility of immediate child objects only; it does not refer to the visibility of all descendant objects.</span></span>
-   <span data-ttu-id="b6139-131">[**Iexpandreduseprovider:: Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) -und [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) -Funktionalität ist Steuerelement spezifisch.</span><span class="sxs-lookup"><span data-stu-id="b6139-131">[**IExpandCollapseProvider::Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) and [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) functionality is control-specific.</span></span> <span data-ttu-id="b6139-132">Im Folgenden finden Sie Beispiele dieses Verhaltens.</span><span class="sxs-lookup"><span data-stu-id="b6139-132">The following are examples of this behavior.</span></span>
    -   <span data-ttu-id="b6139-133">Das persönliche Office-Menü kann ein drei-Status-Menü Element ("Erweitert", "reduziert" und "partiallyexpanded") sein, wobei das Steuerelement den zu verwendenden Zustand angibt, wenn " [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) " oder " [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) " aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="b6139-133">The Office Personal Menu can be a three-state menu item ("Expanded", "Collapsed" and "PartiallyExpanded") where the control specifies the state to adopt when [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) or [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) is called.</span></span>
    -   <span data-ttu-id="b6139-134">Wenn Sie " [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) " für ein Strukturelement aufrufen, werden möglicherweise alle Nachfolger oder nur direkt untergeordnete Elemente</span><span class="sxs-lookup"><span data-stu-id="b6139-134">Calling [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) on a tree item may display all descendants or only immediate children.</span></span>
    -   <span data-ttu-id="b6139-135">Wenn das Aufrufen von [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) oder [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) für ein Steuerelement den Zustand seiner Nachfolger Elemente beibehält, sollte ein Sichtbarkeits Änderungs Ereignis gesendet werden, kein Status Änderungs Ereignis.</span><span class="sxs-lookup"><span data-stu-id="b6139-135">If calling [**Expand**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand) or [**Collapse**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse) on a control maintains the state of its descendants, a visibility change event should be sent, not a state change event.</span></span> <span data-ttu-id="b6139-136">Wenn das übergeordnete Steuerelement den Zustand seiner Nachfolger nicht beibehält, wenn es reduziert ist, kann das Steuerelement alle Nachfolger zerstören, die nicht mehr sichtbar sind, und ein zerstörtes Ereignis darstellen. oder Sie kann den [**expandredu-State**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) für jeden Nachfolger ändern und ein Sichtbarkeits Änderungs Ereignis auswerfen.</span><span class="sxs-lookup"><span data-stu-id="b6139-136">If the parent control does not maintain the state of its descendants when collapsed, the control may destroy all the descendants that are no longer visible and raise a destroyed event; or it may change the [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate) for each descendant and raise a visibility change event.</span></span>
-   <span data-ttu-id="b6139-137">Um die Navigation zu gewährleisten, ist es wünschenswert, dass sich ein Objekt unabhängig von seinen übergeordneten Elementen [**expandredusestate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate)in der Microsoft UI Automation-Struktur (mit dem entsprechenden Sichtbarkeits Zustand) befindet.</span><span class="sxs-lookup"><span data-stu-id="b6139-137">To guarantee navigation, it is desirable for an object to be in the Microsoft UI Automation tree (with appropriate visibility state) regardless of its parents [**ExpandCollapseState**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate).</span></span> <span data-ttu-id="b6139-138">Wenn Nachfolger Bedarfs gesteuert generiert werden, werden Sie möglicherweise nur in der Benutzeroberflächenautomatisierungs-Struktur angezeigt, nachdem Sie zum ersten Mal oder nur angezeigt werden, wenn Sie sichtbar sind.</span><span class="sxs-lookup"><span data-stu-id="b6139-138">If descendants are generated on demand, they may only appear in the UI Automation tree after being displayed for the first time or only while they are visible.</span></span>

## <a name="required-members-for-iexpandcollapseprovider"></a><span data-ttu-id="b6139-139">Erforderliche Member für **iexpandreduseprovider**</span><span class="sxs-lookup"><span data-stu-id="b6139-139">Required Members for **IExpandCollapseProvider**</span></span>

<span data-ttu-id="b6139-140">Die folgenden Eigenschaften, Methoden und Ereignisse sind für die Implementierung der [**iexpandreduseprovider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider) -Schnittstelle erforderlich.</span><span class="sxs-lookup"><span data-stu-id="b6139-140">The following properties, methods, and events are required for implementing the [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider) interface.</span></span>



| <span data-ttu-id="b6139-141">Erforderliche Member</span><span class="sxs-lookup"><span data-stu-id="b6139-141">Required members</span></span>                                                                                    | <span data-ttu-id="b6139-142">Memberart</span><span class="sxs-lookup"><span data-stu-id="b6139-142">Member type</span></span> | <span data-ttu-id="b6139-143">Hinweise</span><span class="sxs-lookup"><span data-stu-id="b6139-143">Notes</span></span>                                                                  |
|-----------------------------------------------------------------------------------------------------|-------------|------------------------------------------------------------------------|
| [<span data-ttu-id="b6139-144">**ExpandCollapseState**</span><span class="sxs-lookup"><span data-stu-id="b6139-144">**ExpandCollapseState**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-get_expandcollapsestate)                   | <span data-ttu-id="b6139-145">Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="b6139-145">Property</span></span>    | <span data-ttu-id="b6139-146">Keine</span><span class="sxs-lookup"><span data-stu-id="b6139-146">None</span></span>                                                                   |
| [<span data-ttu-id="b6139-147">**Expand**</span><span class="sxs-lookup"><span data-stu-id="b6139-147">**Expand**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-expand)                                             | <span data-ttu-id="b6139-148">Methode</span><span class="sxs-lookup"><span data-stu-id="b6139-148">Method</span></span>      | <span data-ttu-id="b6139-149">Keine</span><span class="sxs-lookup"><span data-stu-id="b6139-149">None</span></span>                                                                   |
| [<span data-ttu-id="b6139-150">**Reduzieren**</span><span class="sxs-lookup"><span data-stu-id="b6139-150">**Collapse**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iexpandcollapseprovider-collapse)                                         | <span data-ttu-id="b6139-151">Methode</span><span class="sxs-lookup"><span data-stu-id="b6139-151">Method</span></span>      | <span data-ttu-id="b6139-152">Keine</span><span class="sxs-lookup"><span data-stu-id="b6139-152">None</span></span>                                                                   |
| [<span data-ttu-id="b6139-153">**Iuiautomationpropertychangeabventhandler**</span><span class="sxs-lookup"><span data-stu-id="b6139-153">**IUIAutomationPropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationpropertychangedeventhandler) | <span data-ttu-id="b6139-154">Ereignis</span><span class="sxs-lookup"><span data-stu-id="b6139-154">Event</span></span>       | <span data-ttu-id="b6139-155">Diesem Steuerelement sind keine Ereignisse zugeordnet. Verwenden Sie diesen generischen Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="b6139-155">This control has no associated events; use this generic event handler.</span></span> |



 

## <a name="related-topics"></a><span data-ttu-id="b6139-156">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="b6139-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b6139-157">Steuerelement Typen und ihre unterstützten Steuerelement Muster</span><span class="sxs-lookup"><span data-stu-id="b6139-157">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="b6139-158">Übersicht über Steuerelementmuster für Benutzeroberflächenautomatisierung</span><span class="sxs-lookup"><span data-stu-id="b6139-158">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="b6139-159">Übersicht über die Benutzeroberflächenautomatisierungs-Struktur</span><span class="sxs-lookup"><span data-stu-id="b6139-159">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 




