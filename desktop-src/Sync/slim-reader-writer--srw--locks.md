---
description: SRW-Sperren (Slim Reader/Writer) ermöglichen es den Threads eines einzelnen Prozesses, auf freigegebene Ressourcen zuzugreifen. Sie sind für die Geschwindigkeit optimiert und belegen sehr wenig Arbeitsspeicher.
ms.assetid: 2d439b21-291f-4ff0-910a-c1c27e800019
title: SRW-Sperren (Slim Reader/Writer)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe7d76d956e1425531eae43b0daa6817002a92bc
ms.sourcegitcommit: 663239b4560bfd5314e86901c65805c9bbcab07d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/15/2021
ms.locfileid: "106349743"
---
# <a name="slim-readerwriter-srw-locks"></a><span data-ttu-id="1ec91-103">SRW-Sperren (Slim Reader/Writer)</span><span class="sxs-lookup"><span data-stu-id="1ec91-103">Slim Reader/Writer (SRW) Locks</span></span>

<span data-ttu-id="1ec91-104">SRW-Sperren (Slim Reader/Writer) ermöglichen es den Threads eines einzelnen Prozesses, auf freigegebene Ressourcen zuzugreifen. Sie sind für die Geschwindigkeit optimiert und belegen sehr wenig Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="1ec91-104">Slim reader/writer (SRW) locks enable the threads of a single process to access shared resources; they are optimized for speed and occupy very little memory.</span></span> <span data-ttu-id="1ec91-105">Schlanke Lese-/Schreibsperren können nicht Prozess übergreifend gemeinsam verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="1ec91-105">Slim reader-writer locks cannot be shared across processes.</span></span>

<span data-ttu-id="1ec91-106">Lesethreads lesen Daten aus einer freigegebenen Ressource, während Writer-Threads Daten in eine freigegebene Ressource schreiben.</span><span class="sxs-lookup"><span data-stu-id="1ec91-106">Reader threads read data from a shared resource whereas writer threads write data to a shared resource.</span></span> <span data-ttu-id="1ec91-107">Wenn mehrere Threads Lese-und Schreibvorgänge unter Verwendung einer freigegebenen Ressource ausführen, können exklusive Sperren, wie z. b. ein kritischer Abschnitt oder Mutex, zu einem Engpass werden, wenn die Lesethreads fortlaufend ausgeführt werden, Schreibvorgänge jedoch selten</span><span class="sxs-lookup"><span data-stu-id="1ec91-107">When multiple threads are reading and writing using a shared resource, exclusive locks such as a critical section or mutex can become a bottleneck if the reader threads run continuously but write operations are rare.</span></span>

<span data-ttu-id="1ec91-108">SRW-Sperren bieten zwei Modi, in denen Threads auf eine freigegebene Ressource zugreifen können:</span><span class="sxs-lookup"><span data-stu-id="1ec91-108">SRW locks provide two modes in which threads can access a shared resource:</span></span>

-   <span data-ttu-id="1ec91-109">Der Modus "frei **gegeben**", der freigegebenen schreibgeschützten Zugriff auf mehrere Lesethreads gewährt, sodass Sie Daten aus der gemeinsam genutzten Ressource gleichzeitig lesen können.</span><span class="sxs-lookup"><span data-stu-id="1ec91-109">**Shared mode**, which grants shared read-only access to multiple reader threads, which enables them to read data from the shared resource concurrently.</span></span> <span data-ttu-id="1ec91-110">Wenn Lesevorgänge Schreibvorgänge überschreiten, erhöht diese Parallelität die Leistung und den Durchsatz im Vergleich zu kritischen Abschnitten.</span><span class="sxs-lookup"><span data-stu-id="1ec91-110">If read operations exceed write operations, this concurrency increases performance and throughput compared to critical sections.</span></span>
    > [!NOTE]
    > <span data-ttu-id="1ec91-111">SRW-Sperren im Modus "freigegeben" sollten nicht rekursiv abgerufen werden, da dies zu Deadlocks führen kann, wenn Sie mit exklusiver Übernahme kombiniert werden</span><span class="sxs-lookup"><span data-stu-id="1ec91-111">Shared mode SRW locks should not be acquired recursively as this can lead to deadlocks when combined with exclusive acquisition.</span></span>

-   <span data-ttu-id="1ec91-112">**Exklusiver Modus**, der Lese-/Schreibzugriff auf einen Schreib Thread gleichzeitig gewährt.</span><span class="sxs-lookup"><span data-stu-id="1ec91-112">**Exclusive mode**, which grants read/write access to one writer thread at a time.</span></span> <span data-ttu-id="1ec91-113">Wenn die Sperre im exklusiven Modus abgerufen wurde, kann kein anderer Thread auf die freigegebene Ressource zugreifen, bis der Writer die Sperre freigibt.</span><span class="sxs-lookup"><span data-stu-id="1ec91-113">When the lock has been acquired in exclusive mode, no other thread can access the shared resource until the writer releases the lock.</span></span>
    > [!NOTE]
    > <span data-ttu-id="1ec91-114">SRW-Sperren im exklusiven Modus können nicht rekursiv abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="1ec91-114">Exclusive mode SRW locks cannot be acquired recursively.</span></span> <span data-ttu-id="1ec91-115">Wenn ein Thread versucht, eine Sperre abzurufen, die er bereits enthält, schlägt dieser Versuch fehl (für [**tryacquiresrwlockexclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) oder Deadlock (für [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive)).</span><span class="sxs-lookup"><span data-stu-id="1ec91-115">If a thread tries to acquire a lock that it already holds, that attempt will fail (for [**TryAcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) or deadlock (for [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive))</span></span>

<span data-ttu-id="1ec91-116">Eine einzelne SRW-Sperre kann in beiden Modi abgerufen werden. Lesethreads können Sie im Modus "freigegeben" abrufen, während Writer-Threads Sie im exklusiven Modus abrufen können.</span><span class="sxs-lookup"><span data-stu-id="1ec91-116">A single SRW lock can be acquired in either mode; reader threads can acquire it in shared mode whereas writer threads can acquire it in exclusive mode.</span></span> <span data-ttu-id="1ec91-117">Es gibt keine Garantie für die Reihenfolge, in der Threads, die den Besitz anfordern, den Besitz erhalten. SRW-Sperren sind weder fair noch FIFO.</span><span class="sxs-lookup"><span data-stu-id="1ec91-117">There is no guarantee about the order in which threads that request ownership will be granted ownership; SRW locks are neither fair nor FIFO.</span></span>

<span data-ttu-id="1ec91-118">Eine SRW-Sperre ist die Größe eines Zeigers.</span><span class="sxs-lookup"><span data-stu-id="1ec91-118">An SRW lock is the size of a pointer.</span></span> <span data-ttu-id="1ec91-119">Der Vorteil besteht darin, dass es schnell ist, den Sperr Status zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="1ec91-119">The advantage is that it is fast to update the lock state.</span></span> <span data-ttu-id="1ec91-120">Der Nachteil ist, dass nur wenige Zustandsinformationen gespeichert werden können, sodass SRW-Sperren nicht die falsche rekursive Verwendung im freigegebenen Modus erkennen.</span><span class="sxs-lookup"><span data-stu-id="1ec91-120">The disadvantage is that very little state information can be stored, so SRW locks do not detect incorrect recursive use in shared mode.</span></span> <span data-ttu-id="1ec91-121">Außerdem kann ein Thread, der eine SRW-Sperre im freigegebenen Modus besitzt, nicht den Besitz der Sperre auf den exklusiven Modus aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="1ec91-121">In addition, a thread that owns an SRW lock in shared mode cannot upgrade its ownership of the lock to exclusive mode.</span></span>

<span data-ttu-id="1ec91-122">Der Aufrufer muss eine SRWLOCK-Struktur zuordnen und initialisieren, indem er entweder [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) aufruft (um die Struktur dynamisch zu initialisieren), oder die Konstante **SRWLOCK \_ Init** der Struktur Variablen zuweisen (um die Struktur statisch zu initialisieren).</span><span class="sxs-lookup"><span data-stu-id="1ec91-122">The caller must allocate an SRWLOCK structure and initialize it by either calling [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) (to initialize the structure dynamically) or assign the constant **SRWLOCK\_INIT** to the structure variable (to initialize the structure statically).</span></span>

<span data-ttu-id="1ec91-123">Sie können [Application Verifier](/windows-hardware/drivers/devtest/application-verifier) verwenden, um die rekursive Verwendung von SRW-Sperren zu suchen.</span><span class="sxs-lookup"><span data-stu-id="1ec91-123">You can use [Application Verifier](/windows-hardware/drivers/devtest/application-verifier) to find recursive (reentrant) use of SRW locks.</span></span>

<span data-ttu-id="1ec91-124">Im folgenden finden Sie die SRW-Sperr Funktionen.</span><span class="sxs-lookup"><span data-stu-id="1ec91-124">The following are the SRW lock functions.</span></span>

| <span data-ttu-id="1ec91-125">SRW-Sperrfunktion</span><span class="sxs-lookup"><span data-stu-id="1ec91-125">SRW lock function</span></span>                                                | <span data-ttu-id="1ec91-126">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="1ec91-126">Description</span></span>                                                                                                                                       |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="1ec91-127">**AcquireSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="1ec91-127">**AcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive)       | <span data-ttu-id="1ec91-128">Ruft eine SRW-Sperre im exklusiven Modus ab.</span><span class="sxs-lookup"><span data-stu-id="1ec91-128">Acquires an SRW lock in exclusive mode.</span></span>                                                                                                           |
| [<span data-ttu-id="1ec91-129">**AcquireSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="1ec91-129">**AcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockshared)             | <span data-ttu-id="1ec91-130">Ruft eine SRW-Sperre im freigegebenen Modus ab.</span><span class="sxs-lookup"><span data-stu-id="1ec91-130">Acquires an SRW lock in shared mode.</span></span>                                                                                                              |
| [<span data-ttu-id="1ec91-131">**InitializeSRWLock**</span><span class="sxs-lookup"><span data-stu-id="1ec91-131">**InitializeSRWLock**</span></span>](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock)                   | <span data-ttu-id="1ec91-132">Initialisieren Sie eine SRW-Sperre.</span><span class="sxs-lookup"><span data-stu-id="1ec91-132">Initialize an SRW lock.</span></span>                                                                                                                           |
| [<span data-ttu-id="1ec91-133">**ReleaseSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="1ec91-133">**ReleaseSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockexclusive)       | <span data-ttu-id="1ec91-134">Gibt eine SRW-Sperre frei, die im exklusiven Modus geöffnet wurde.</span><span class="sxs-lookup"><span data-stu-id="1ec91-134">Releases an SRW lock that was opened in exclusive mode.</span></span>                                                                                           |
| [<span data-ttu-id="1ec91-135">**ReleaseSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="1ec91-135">**ReleaseSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockshared)             | <span data-ttu-id="1ec91-136">Gibt eine SRW-Sperre frei, die im freigegebenen Modus geöffnet wurde.</span><span class="sxs-lookup"><span data-stu-id="1ec91-136">Releases an SRW lock that was opened in shared mode.</span></span>                                                                                              |
| [<span data-ttu-id="1ec91-137">**SleepConditionVariableSRW**</span><span class="sxs-lookup"><span data-stu-id="1ec91-137">**SleepConditionVariableSRW**</span></span>](/windows/win32/api/synchapi/nf-synchapi-sleepconditionvariablesrw)   | <span data-ttu-id="1ec91-138">Gibt für die angegebene Bedingungs Variable den Ruhezustand an und gibt die angegebene Sperre als atomarischen Vorgang frei.</span><span class="sxs-lookup"><span data-stu-id="1ec91-138">Sleeps on the specified condition variable and releases the specified lock as an atomic operation.</span></span>                                                |
| [<span data-ttu-id="1ec91-139">**Tryacquiresrwlockexclusive**</span><span class="sxs-lookup"><span data-stu-id="1ec91-139">**TryAcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive) | <span data-ttu-id="1ec91-140">Versucht, eine SRW-Sperre (Slim Reader/Writer) im exklusiven Modus zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1ec91-140">Attempts to acquire a slim reader/writer (SRW) lock in exclusive mode.</span></span> <span data-ttu-id="1ec91-141">Wenn der Aufruf erfolgreich ist, übernimmt der aufrufende Thread den Besitz der Sperre.</span><span class="sxs-lookup"><span data-stu-id="1ec91-141">If the call is successful, the calling thread takes ownership of the lock.</span></span> |
| [<span data-ttu-id="1ec91-142">**Tryacquiresrwlockshared**</span><span class="sxs-lookup"><span data-stu-id="1ec91-142">**TryAcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockshared)       | <span data-ttu-id="1ec91-143">Versucht, eine SRW-Sperre (Slim Reader/Writer) im freigegebenen Modus zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1ec91-143">Attempts to acquire a slim reader/writer (SRW) lock in shared mode.</span></span> <span data-ttu-id="1ec91-144">Wenn der Aufruf erfolgreich ist, übernimmt der aufrufende Thread den Besitz der Sperre.</span><span class="sxs-lookup"><span data-stu-id="1ec91-144">If the call is successful, the calling thread takes ownership of the lock.</span></span>    |

 
