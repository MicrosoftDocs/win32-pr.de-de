---
description: Anwendungen müssen den Zugriff auf Variablen synchronisieren, die von mehreren Threads gemeinsam genutzt werden.
ms.assetid: 729c0e68-ef52-4d6c-b771-a89043a937e6
title: Interlocked-Variablen Zugriff
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca2e083d3e3420e870ad9781b0d262df3d0786f1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106363618"
---
# <a name="interlocked-variable-access"></a><span data-ttu-id="4fdd7-103">Interlocked-Variablen Zugriff</span><span class="sxs-lookup"><span data-stu-id="4fdd7-103">Interlocked Variable Access</span></span>

<span data-ttu-id="4fdd7-104">Anwendungen müssen den Zugriff auf Variablen synchronisieren, die von mehreren Threads gemeinsam genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-104">Applications must synchronize access to variables that are shared by multiple threads.</span></span> <span data-ttu-id="4fdd7-105">Anwendungen müssen außerdem sicherstellen, dass Vorgänge für diese Variablen atomisch ausgeführt werden (vollständig oder überhaupt nicht ausgeführt werden).</span><span class="sxs-lookup"><span data-stu-id="4fdd7-105">Applications must also ensure that operations on these variables are performed atomically (performed in their entirety or not at all.)</span></span>

<span data-ttu-id="4fdd7-106">Einfache Lese-und Schreibvorgänge für ordnungsgemäß ausgerichtete 32-Bit-Variablen sind atomarische Vorgänge.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-106">Simple reads and writes to properly-aligned 32-bit variables are atomic operations.</span></span> <span data-ttu-id="4fdd7-107">Dies bedeutet, dass Sie nicht nur einen Teil der Variablen aktualisiert haben. alle Bits werden atomarisch aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-107">In other words, you will not end up with only one portion of the variable updated; all bits are updated in an atomic fashion.</span></span> <span data-ttu-id="4fdd7-108">Es ist jedoch nicht gewährleistet, dass der Zugriff synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-108">However, access is not guaranteed to be synchronized.</span></span> <span data-ttu-id="4fdd7-109">Wenn zwei Threads die gleiche Variable Lesen und schreiben, können Sie nicht feststellen, ob ein Thread seinen Lesevorgang ausführt, bevor der andere den Schreibvorgang ausführt.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-109">If two threads are reading and writing from the same variable, you cannot determine if one thread will perform its read operation before the other performs its write operation.</span></span>

<span data-ttu-id="4fdd7-110">Einfache Lese-und Schreibvorgänge für ordnungsgemäß ausgerichtete 64-Bit-Variablen sind atomarisch auf 64-Bit-Fenstern.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-110">Simple reads and writes to properly aligned 64-bit variables are atomic on 64-bit Windows.</span></span> <span data-ttu-id="4fdd7-111">Lese-und Schreibvorgänge in 64-Bit-Werten sind nicht garantiert atomarisch auf 32-Bit-Fenstern.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-111">Reads and writes to 64-bit values are not guaranteed to be atomic on 32-bit Windows.</span></span> <span data-ttu-id="4fdd7-112">Lese-und Schreibvorgänge für Variablen anderer Größen sind nicht unbedingt atomarisch auf einer beliebigen Plattform.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-112">Reads and writes to variables of other sizes are not guaranteed to be atomic on any platform.</span></span>

## <a name="the-interlocked-api"></a><span data-ttu-id="4fdd7-113">Die Interlocked-API</span><span class="sxs-lookup"><span data-stu-id="4fdd7-113">The Interlocked API</span></span>

<span data-ttu-id="4fdd7-114">Die Interlocked-Funktionen bieten einen einfachen Mechanismus für die Synchronisierung des Zugriffs auf eine Variable, die von mehreren Threads gemeinsam genutzt wird.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-114">The interlocked functions provide a simple mechanism for synchronizing access to a variable that is shared by multiple threads.</span></span> <span data-ttu-id="4fdd7-115">Außerdem führen Sie Vorgänge für Variablen atomarisch aus.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-115">They also perform operations on variables in an atomic manner.</span></span> <span data-ttu-id="4fdd7-116">Die Threads verschiedener Prozesse können diese Funktionen verwenden, wenn sich die Variable im gemeinsam genutzten Speicher befindet.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-116">The threads of different processes can use these functions if the variable is in shared memory.</span></span>

<span data-ttu-id="4fdd7-117">Die Funktionen [**interlockedinkrement**](/windows/win32/api/winnt/nf-winnt-interlockedincrement) und [**InterlockedDecrement**](/windows/win32/api/winnt/nf-winnt-interlockeddecrement) kombinieren die Schritte zum Inkrementieren oder Dekrementieren einer Variablen in einen atomaren Vorgang.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-117">The [**InterlockedIncrement**](/windows/win32/api/winnt/nf-winnt-interlockedincrement) and [**InterlockedDecrement**](/windows/win32/api/winnt/nf-winnt-interlockeddecrement) functions combine the steps involved in incrementing or decrementing a variable into an atomic operation.</span></span> <span data-ttu-id="4fdd7-118">Diese Funktion ist in einem Multitasking-Betriebssystem nützlich, bei dem das System die Ausführung eines Threads unterbrechen kann, um einem anderen Thread einen Slice der Prozessorzeit zu gewähren.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-118">This feature is useful in a multitasking operating system, in which the system can interrupt one thread's execution to grant a slice of processor time to another thread.</span></span> <span data-ttu-id="4fdd7-119">Ohne diese Synchronisierung können zwei Threads denselben Wert lesen, den Wert um 1 erhöhen und den neuen Wert für eine Gesamterhöhung von 1 anstelle von 2 speichern.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-119">Without such synchronization, two threads could read the same value, increment it by 1, and store the new value for a total increase of 1 instead of 2.</span></span> <span data-ttu-id="4fdd7-120">Die Interlocked-Variablen Zugriffs Funktionen schützen gegen diese Art von Fehler.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-120">The interlocked variable-access functions protect against this kind of error.</span></span>

<span data-ttu-id="4fdd7-121">Die [**interlockedexchange**](/windows/win32/api/winnt/nf-winnt-interlockedexchange) -Funktion und die [**interlockedexchangepointer**](/windows/win32/api/winnt/nf-winnt-interlockedexchangepointer) -Funktion tauschen die Werte der angegebenen Variablen atomisch aus.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-121">The [**InterlockedExchange**](/windows/win32/api/winnt/nf-winnt-interlockedexchange) and [**InterlockedExchangePointer**](/windows/win32/api/winnt/nf-winnt-interlockedexchangepointer) functions atomically exchange the values of the specified variables.</span></span> <span data-ttu-id="4fdd7-122">Die [**interlockedexchangeadd**](/windows/win32/api/winnt/nf-winnt-interlockedexchangeadd) -Funktion kombiniert zwei Vorgänge: das Hinzufügen von zwei Variablen und das Speichern des Ergebnisses in einer der Variablen.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-122">The [**InterlockedExchangeAdd**](/windows/win32/api/winnt/nf-winnt-interlockedexchangeadd) function combines two operations: adding two variables together and storing the result in one of the variables.</span></span>

<span data-ttu-id="4fdd7-123">Die Funktionen [**interlockedcompareexchange**](/windows/win32/api/winnt/nf-winnt-interlockedcompareexchange), [**InterlockedCompare64Exchange128**](/previous-versions/windows/desktop/legacy/ms683553(v=vs.85))und [**interlockedcompareexchangepointer**](/windows/win32/api/winnt/nf-winnt-interlockedcompareexchangepointer) kombinieren zwei Vorgänge: Vergleichen von zwei Werten und Speichern eines dritten Werts in einer der Variablen, basierend auf dem Ergebnis des Vergleichs.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-123">The [**InterlockedCompareExchange**](/windows/win32/api/winnt/nf-winnt-interlockedcompareexchange), [**InterlockedCompare64Exchange128**](/previous-versions/windows/desktop/legacy/ms683553(v=vs.85)), and [**InterlockedCompareExchangePointer**](/windows/win32/api/winnt/nf-winnt-interlockedcompareexchangepointer) functions combine two operations: comparing two values and storing a third value in one of the variables, based on the outcome of the comparison.</span></span>

<span data-ttu-id="4fdd7-124">Die Funktionen [**interlockedand**](/windows/win32/api/winnt/nf-winnt-interlockedand), [**interlockedor**](/windows/win32/api/winnt/nf-winnt-interlockedor)und [**interlockedxor**](/windows/win32/api/winnt/nf-winnt-interlockedxor) führen atomarisch und bzw. bzw. bzw. Xor-Vorgänge aus.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-124">The [**InterlockedAnd**](/windows/win32/api/winnt/nf-winnt-interlockedand), [**InterlockedOr**](/windows/win32/api/winnt/nf-winnt-interlockedor), and [**InterlockedXor**](/windows/win32/api/winnt/nf-winnt-interlockedxor) functions atomically perform AND, OR, and XOR operations, respectively.</span></span>

<span data-ttu-id="4fdd7-125">Es gibt Funktionen, die speziell für die Ausführung von Interlocked-Variablen Zugriff auf 64-Bit-Speicher Werte und-Adressen entwickelt wurden und für die Verwendung auf 64-Bit-Fenstern optimiert sind.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-125">There are functions that are specifically designed to perform interlocked variable access on 64-bit memory values and addresses, and are optimized for use on 64-bit Windows.</span></span> <span data-ttu-id="4fdd7-126">Jede dieser Funktionen enthält "64" im Namen; beispielsweise [**InterlockedDecrement64**](/windows/win32/api/winnt/nf-winnt-interlockeddecrement64) und [**InterlockedCompareExchangeAcquire64**](/previous-versions/windows/desktop/legacy/ms683566(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="4fdd7-126">Each of these functions contains "64" in the name; for example, [**InterlockedDecrement64**](/windows/win32/api/winnt/nf-winnt-interlockeddecrement64) and [**InterlockedCompareExchangeAcquire64**](/previous-versions/windows/desktop/legacy/ms683566(v=vs.85)).</span></span>

<span data-ttu-id="4fdd7-127">Die meisten der Interlocked-Funktionen stellen vollständige Speicherbarrieren auf allen Windows-Plattformen bereit.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-127">Most of the interlocked functions provide full memory barriers on all Windows platforms.</span></span> <span data-ttu-id="4fdd7-128">Es gibt auch Funktionen, die die grundlegenden Interlocked-Variablen Zugriffs Vorgänge mit der von bestimmten Prozessoren unterstützten Speicher Bestell Semantik für die Erfassung und Freigabe kombinieren.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-128">There are also functions that combine the basic interlocked variable access operations with the acquire and release memory ordering semantics supported by certain processors.</span></span> <span data-ttu-id="4fdd7-129">Jede dieser Funktionen enthält das Wort "abrufen" oder "Release" in ihren Namen. beispielsweise [**interlockeddecrementpick**](/previous-versions/windows/desktop/legacy/ms683583(v=vs.85)) und [**interlockeddecrementrelease**](/previous-versions/windows/desktop/legacy/ms683586(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="4fdd7-129">Each of these functions contains the word "Acquire" or "Release" in their names; for example, [**InterlockedDecrementAcquire**](/previous-versions/windows/desktop/legacy/ms683583(v=vs.85)) and [**InterlockedDecrementRelease**](/previous-versions/windows/desktop/legacy/ms683586(v=vs.85)).</span></span> <span data-ttu-id="4fdd7-130">Speicher Semantik abrufen gibt an, dass der Arbeitsspeicher Vorgang, der vom aktuellen Thread ausgeführt wird, sichtbar ist, bevor andere Speichervorgänge versucht werden.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-130">Acquire memory semantics specify that the memory operation being performed by the current thread will be visible before any other memory operations are attempted.</span></span> <span data-ttu-id="4fdd7-131">Die Semantik des releasespeichers gibt an, dass der Arbeitsspeicher Vorgang, der vom aktuellen Thread ausgeführt wird, sichtbar ist, nachdem alle anderen Speichervorgänge abgeschlossen wurden.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-131">Release memory semantics specify that the memory operation being performed by the current thread will be visible after all other memory operations have been completed.</span></span> <span data-ttu-id="4fdd7-132">Diese Semantik ermöglicht es Ihnen, Speichervorgänge in einer bestimmten Reihenfolge durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-132">These semantics allow you to force memory operations to be performed in a specific order.</span></span> <span data-ttu-id="4fdd7-133">Verwenden Sie die Semantik zum Abrufen bei der Eingabe einer geschützten Region und releasesemantik, wenn Sie Sie verlässt.</span><span class="sxs-lookup"><span data-stu-id="4fdd7-133">Use acquire semantics when entering a protected region and release semantics when leaving it.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4fdd7-134">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="4fdd7-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4fdd7-135">Intrinsische Compilerfunktionen</span><span class="sxs-lookup"><span data-stu-id="4fdd7-135">Compiler Intrinsics</span></span>](/cpp/intrinsics/compiler-intrinsics?view=vs-2019)
</dt> <dt>

[<span data-ttu-id="4fdd7-136">Synchronisierungs- und Multiprozessorprobleme</span><span class="sxs-lookup"><span data-stu-id="4fdd7-136">Synchronization and Multiprocessor Issues</span></span>](synchronization-and-multiprocessor-issues.md)
</dt> </dl>

 

 
