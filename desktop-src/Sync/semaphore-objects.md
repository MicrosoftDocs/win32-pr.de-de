---
description: Ein Semaphor-Objekt ist ein Synchronisierungs Objekt, das eine Anzahl zwischen null und einem angegebenen maximalen Wert beibehält.
ms.assetid: d9da1d98-a306-4e2d-a149-1eef6a724751
title: Semaphore-Objekte
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a77f36313d76c5d98c786a76f10ad8439965f180
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106350892"
---
# <a name="semaphore-objects"></a><span data-ttu-id="1ea85-103">Semaphore-Objekte</span><span class="sxs-lookup"><span data-stu-id="1ea85-103">Semaphore Objects</span></span>

<span data-ttu-id="1ea85-104">Ein *Semaphor-Objekt* ist ein Synchronisierungs Objekt, das eine Anzahl zwischen null und einem angegebenen maximalen Wert beibehält.</span><span class="sxs-lookup"><span data-stu-id="1ea85-104">A *semaphore object* is a synchronization object that maintains a count between zero and a specified maximum value.</span></span> <span data-ttu-id="1ea85-105">Die Anzahl wird jedes Mal dekrementiert, wenn ein Thread eine Wartezeit für das Semaphor-Objekt abschließt und jedes Mal erhöht wird, wenn ein Thread das Semaphor freigibt.</span><span class="sxs-lookup"><span data-stu-id="1ea85-105">The count is decremented each time a thread completes a wait for the semaphore object and incremented each time a thread releases the semaphore.</span></span> <span data-ttu-id="1ea85-106">Wenn die Anzahl Null erreicht, können keine weiteren Threads mehr darauf warten, dass der Semaphor-Objektzustand signalisiert wird.</span><span class="sxs-lookup"><span data-stu-id="1ea85-106">When the count reaches zero, no more threads can successfully wait for the semaphore object state to become signaled.</span></span> <span data-ttu-id="1ea85-107">Der Status eines Semaphors wird auf „signalisiert“ festgelegt, wenn die Anzahl größer als Null ist, bzw. wird auf „nicht signalisiert“ gesetzt, wenn die Anzahl Null ist.</span><span class="sxs-lookup"><span data-stu-id="1ea85-107">The state of a semaphore is set to signaled when its count is greater than zero, and nonsignaled when its count is zero.</span></span>

<span data-ttu-id="1ea85-108">Das Semaphor-Objekt ist hilfreich beim Steuern einer freigegebenen Ressource, die eine begrenzte Anzahl von Benutzern unterstützen kann.</span><span class="sxs-lookup"><span data-stu-id="1ea85-108">The semaphore object is useful in controlling a shared resource that can support a limited number of users.</span></span> <span data-ttu-id="1ea85-109">Es fungiert als Gate, das die Anzahl der Threads einschränkt, die die Ressource auf eine angegebene maximale Anzahl freigeben.</span><span class="sxs-lookup"><span data-stu-id="1ea85-109">It acts as a gate that limits the number of threads sharing the resource to a specified maximum number.</span></span> <span data-ttu-id="1ea85-110">Beispielsweise kann eine Anwendung eine Beschränkung für die Anzahl der erstellten Fenster festlegen.</span><span class="sxs-lookup"><span data-stu-id="1ea85-110">For example, an application might place a limit on the number of windows that it creates.</span></span> <span data-ttu-id="1ea85-111">Dabei wird ein Semaphor mit einer maximalen Anzahl gleich dem Fenster Limit verwendet. dabei wird die Anzahl verringert, wenn ein Fenster erstellt wird, und jedes Mal erhöht, wenn ein Fenster geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="1ea85-111">It uses a semaphore with a maximum count equal to the window limit, decrementing the count whenever a window is created and incrementing it whenever a window is closed.</span></span> <span data-ttu-id="1ea85-112">Die Anwendung gibt das Semaphor-Objekt an, das in einem der [warte Funktionen](wait-functions.md) aufgerufen wird, bevor jedes Fenster erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="1ea85-112">The application specifies the semaphore object in call to one of the [wait functions](wait-functions.md) before each window is created.</span></span> <span data-ttu-id="1ea85-113">Wenn die Anzahl Null ist – gibt an, dass das Fenster Limit erreicht wurde – wird die Ausführung des Code Erstellungs Codes durch die wait-Funktion blockiert.</span><span class="sxs-lookup"><span data-stu-id="1ea85-113">When the count is zero—indicating that the window limit has been reached—the wait function blocks execution of the window-creation code.</span></span>

<span data-ttu-id="1ea85-114">Ein Thread verwendet die Funktion " [**foratesemaphore**](/windows/desktop/api/WinBase/nf-winbase-createsemaphorea) " oder " [**foratesemaphoreex**](/windows/desktop/api/WinBase/nf-winbase-createsemaphoreexa) ", um ein Semaphor-Objekt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="1ea85-114">A thread uses the [**CreateSemaphore**](/windows/desktop/api/WinBase/nf-winbase-createsemaphorea) or [**CreateSemaphoreEx**](/windows/desktop/api/WinBase/nf-winbase-createsemaphoreexa) function to create a semaphore object.</span></span> <span data-ttu-id="1ea85-115">Der Erstellungsthread gibt die anfängliche Anzahl und den maximalen Wert der Anzahl für das Objekt an.</span><span class="sxs-lookup"><span data-stu-id="1ea85-115">The creating thread specifies the initial count and the maximum value of the count for the object.</span></span> <span data-ttu-id="1ea85-116">Die anfängliche Anzahl darf nicht kleiner als 0 (null) oder größer als der Maximalwert sein.</span><span class="sxs-lookup"><span data-stu-id="1ea85-116">The initial count must be neither less than zero nor greater than the maximum value.</span></span> <span data-ttu-id="1ea85-117">Der Erstellungsthread kann auch einen Namen für das Semaphor-Objekt angeben.</span><span class="sxs-lookup"><span data-stu-id="1ea85-117">The creating thread can also specify a name for the semaphore object.</span></span> <span data-ttu-id="1ea85-118">Threads in anderen Prozessen können ein Handle für ein vorhandenes Semaphor-Objekt öffnen, indem Sie den Namen in einem Befehl der [**opensemaphore**](/windows/win32/api/synchapi/nf-synchapi-opensemaphorew) -Funktion angeben.</span><span class="sxs-lookup"><span data-stu-id="1ea85-118">Threads in other processes can open a handle to an existing semaphore object by specifying its name in a call to the [**OpenSemaphore**](/windows/win32/api/synchapi/nf-synchapi-opensemaphorew) function.</span></span> <span data-ttu-id="1ea85-119">Weitere Informationen zu den Namen von Mutex-, Ereignis-, Semaphore-und Timer-Objekten finden Sie unter [prozessübergreifende Synchronisierung](interprocess-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="1ea85-119">For additional information about names for mutex, event, semaphore, and timer objects, see [Interprocess Synchronization](interprocess-synchronization.md).</span></span>

<span data-ttu-id="1ea85-120">Wenn mehr als ein Thread auf eine Semaphore wartet, wird ein wartender Thread ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="1ea85-120">If more than one thread is waiting on a semaphore, a waiting thread is selected.</span></span> <span data-ttu-id="1ea85-121">Nehmen Sie keine Voraussetzung für eine FIFO-Reihenfolge (First in, First Out).</span><span class="sxs-lookup"><span data-stu-id="1ea85-121">Do not assume a first-in, first-out (FIFO) order.</span></span> <span data-ttu-id="1ea85-122">Externe Ereignisse wie z. b. kernelmodusapcs können die Warte Reihenfolge ändern.</span><span class="sxs-lookup"><span data-stu-id="1ea85-122">External events such as kernel-mode APCs can change the wait order.</span></span>

<span data-ttu-id="1ea85-123">Jedes Mal, wenn eine der [Wait-Funktionen](wait-functions.md) zurückgibt, da der Zustand eines Semaphors auf "signalisiert" festgelegt wurde, wird die Anzahl der Semaphor um eins verringert.</span><span class="sxs-lookup"><span data-stu-id="1ea85-123">Each time one of the [wait functions](wait-functions.md) returns because the state of a semaphore was set to signaled, the count of the semaphore is decreased by one.</span></span> <span data-ttu-id="1ea85-124">Die [**ReleaseSemaphore**](/windows/win32/api/synchapi/nf-synchapi-releasesemaphore) -Funktion vergrößert die Anzahl der Semaphore um einen angegebenen Betrag.</span><span class="sxs-lookup"><span data-stu-id="1ea85-124">The [**ReleaseSemaphore**](/windows/win32/api/synchapi/nf-synchapi-releasesemaphore) function increases a semaphore's count by a specified amount.</span></span> <span data-ttu-id="1ea85-125">Die Anzahl kann nie kleiner als 0 (null) oder größer als der Maximalwert sein.</span><span class="sxs-lookup"><span data-stu-id="1ea85-125">The count can never be less than zero or greater than the maximum value.</span></span>

<span data-ttu-id="1ea85-126">Die anfängliche Anzahl eines Semaphors wird in der Regel auf den maximalen Wert festgelegt.</span><span class="sxs-lookup"><span data-stu-id="1ea85-126">The initial count of a semaphore is typically set to the maximum value.</span></span> <span data-ttu-id="1ea85-127">Die Anzahl wird dann von dieser Ebene verringert, wenn die geschützte Ressource verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="1ea85-127">The count is then decremented from that level as the protected resource is consumed.</span></span> <span data-ttu-id="1ea85-128">Alternativ können Sie ein Semaphor mit einer anfänglichen Anzahl von NULL erstellen, um den Zugriff auf die geschützte Ressource zu blockieren, während die Anwendung initialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="1ea85-128">Alternatively, you can create a semaphore with an initial count of zero to block access to the protected resource while the application is being initialized.</span></span> <span data-ttu-id="1ea85-129">Nach der Initialisierung können Sie [**ReleaseSemaphore**](/windows/win32/api/synchapi/nf-synchapi-releasesemaphore) verwenden, um die Anzahl auf den maximalen Wert zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="1ea85-129">After initialization, you can use [**ReleaseSemaphore**](/windows/win32/api/synchapi/nf-synchapi-releasesemaphore) to increment the count to the maximum value.</span></span>

<span data-ttu-id="1ea85-130">Ein Thread, der ein Mutex-Objekt besitzt, kann wiederholt warten, bis das gleiche Mutex-Objekt signalisiert wird, ohne dass die Ausführung blockiert wird.</span><span class="sxs-lookup"><span data-stu-id="1ea85-130">A thread that owns a mutex object can wait repeatedly for the same mutex object to become signaled without its execution becoming blocked.</span></span> <span data-ttu-id="1ea85-131">Ein Thread, der wiederholt für dasselbe Semaphor-Objekt wartet, verringert jedoch die Anzahl der Semaphor, wenn ein warte Vorgang abgeschlossen ist. der Thread wird blockiert, wenn die Anzahl Null erreicht wird.</span><span class="sxs-lookup"><span data-stu-id="1ea85-131">A thread that waits repeatedly for the same semaphore object, however, decrements the semaphore's count each time a wait operation is completed; the thread is blocked when the count gets to zero.</span></span> <span data-ttu-id="1ea85-132">Ebenso kann nur der Thread, der einen Mutex besitzt, die [**ReleaseMutex**](/windows/win32/api/synchapi/nf-synchapi-releasemutex) -Funktion abrufen, obwohl jeder Thread [**ReleaseSemaphore**](/windows/win32/api/synchapi/nf-synchapi-releasesemaphore) verwenden kann, um die Anzahl eines Semaphor-Objekts zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="1ea85-132">Similarly, only the thread that owns a mutex can successfully call the [**ReleaseMutex**](/windows/win32/api/synchapi/nf-synchapi-releasemutex) function, though any thread can use [**ReleaseSemaphore**](/windows/win32/api/synchapi/nf-synchapi-releasesemaphore) to increase the count of a semaphore object.</span></span>

<span data-ttu-id="1ea85-133">Ein Thread kann den Zähler eines Semaphors mehrmals verringern, indem er das gleiche Semaphor-Objekt in Aufrufen einer beliebigen [Wartefunktion](wait-functions.md)wiederholt angibt.</span><span class="sxs-lookup"><span data-stu-id="1ea85-133">A thread can decrement a semaphore's count more than once by repeatedly specifying the same semaphore object in calls to any of the [wait functions](wait-functions.md).</span></span> <span data-ttu-id="1ea85-134">Das Aufrufen einer der Multiple-Object-Wait-Funktionen mit einem Array, das mehrere Handles desselben Semaphors enthält, führt jedoch nicht zu mehreren dekrements.</span><span class="sxs-lookup"><span data-stu-id="1ea85-134">However, calling one of the multiple-object wait functions with an array that contains multiple handles of the same semaphore does not result in multiple decrements.</span></span>

<span data-ttu-id="1ea85-135">Wenn Sie mit dem Semaphor-Objekt fertig sind, müssen Sie die [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) -Funktion zum Schließen des Handles verwenden.</span><span class="sxs-lookup"><span data-stu-id="1ea85-135">When you have finished using the semaphore object, call the [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) function to close the handle.</span></span> <span data-ttu-id="1ea85-136">Das Semaphor-Objekt wird zerstört, wenn sein letztes Handle geschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="1ea85-136">The semaphore object is destroyed when its last handle has been closed.</span></span> <span data-ttu-id="1ea85-137">Das Schließen des Handles wirkt sich nicht auf die Anzahl der Semaphor aus. Stellen Sie daher vor dem Schließen des Handles oder vor dem Beenden des Prozesses sicher, dass Sie [**ReleaseSemaphore**](/windows/win32/api/synchapi/nf-synchapi-releasesemaphore) aufruft.</span><span class="sxs-lookup"><span data-stu-id="1ea85-137">Closing the handle does not affect the semaphore count; therefore, be sure to call [**ReleaseSemaphore**](/windows/win32/api/synchapi/nf-synchapi-releasesemaphore) before closing the handle or before the process terminates.</span></span> <span data-ttu-id="1ea85-138">Andernfalls tritt für ausstehende warte Vorgänge entweder ein Timeout oder eine unbegrenzte Fortsetzung auf, je nachdem, ob ein Timeout Wert angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="1ea85-138">Otherwise, pending wait operations will either time out or continue indefinitely, depending on whether a time-out value has been specified.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1ea85-139">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="1ea85-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1ea85-140">Verwenden von Semaphore-Objekten</span><span class="sxs-lookup"><span data-stu-id="1ea85-140">Using Semaphore Objects</span></span>](using-semaphore-objects.md)
</dt> </dl>

 

 
