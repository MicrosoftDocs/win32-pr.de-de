---
title: Übersicht über deskriptorheaps
description: Deskriptorheaps enthalten viele Objekttypen, die nicht Teil eines Pipeline Zustands Objekts (PSO) sind, wie z. b. Shader-Ressourcen Sichten (Srvs), ungeordnete Zugriffs Sichten (UAVs), Konstante Puffer Ansichten (cbvs) und Samplers.
ms.assetid: 14561E77-44E0-4A58-8456-F40D59ECA175
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a8bf720ebb71d016457fa4383a8d33aa62e2eee4
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/16/2019
ms.locfileid: "74103404"
---
# <a name="descriptor-heaps-overview"></a><span data-ttu-id="aea01-103">Übersicht über deskriptorheaps</span><span class="sxs-lookup"><span data-stu-id="aea01-103">Descriptor Heaps Overview</span></span>

<span data-ttu-id="aea01-104">Deskriptorheaps enthalten viele Objekttypen, die nicht Teil eines Pipeline Zustands Objekts (PSO) sind, wie z. b. Shader-Ressourcen Sichten (Srvs), ungeordnete Zugriffs Sichten (UAVs), Konstante Puffer Ansichten (cbvs) und Samplers.</span><span class="sxs-lookup"><span data-stu-id="aea01-104">Descriptor heaps contain many object types that are not part of a Pipeline State Object (PSO), such as Shader Resource Views (SRVs), Unordered Access Views (UAVs), Constant Buffer Views (CBVs), and Samplers.</span></span>

-   [<span data-ttu-id="aea01-105">Zweck der deskriptorheaps</span><span class="sxs-lookup"><span data-stu-id="aea01-105">The Purpose of Descriptor Heaps</span></span>](#the-purpose-of-descriptor-heaps)
-   [<span data-ttu-id="aea01-106">Synchronisierung</span><span class="sxs-lookup"><span data-stu-id="aea01-106">Synchronization</span></span>](#synchronization)
-   [<span data-ttu-id="aea01-107">Binding</span><span class="sxs-lookup"><span data-stu-id="aea01-107">Binding</span></span>](#binding)
-   [<span data-ttu-id="aea01-108">Wechseln von Heaps</span><span class="sxs-lookup"><span data-stu-id="aea01-108">Switching heaps</span></span>](#switching-heaps)
-   [<span data-ttu-id="aea01-109">Bundles</span><span class="sxs-lookup"><span data-stu-id="aea01-109">Bundles</span></span>](#bundles)
-   [<span data-ttu-id="aea01-110">Verwaltung</span><span class="sxs-lookup"><span data-stu-id="aea01-110">Management</span></span>](#management)
-   [<span data-ttu-id="aea01-111">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="aea01-111">Related topics</span></span>](#related-topics)

## <a name="the-purpose-of-descriptor-heaps"></a><span data-ttu-id="aea01-112">Zweck der deskriptorheaps</span><span class="sxs-lookup"><span data-stu-id="aea01-112">The Purpose of Descriptor Heaps</span></span>

<span data-ttu-id="aea01-113">Der primäre Zweck eines deskriptorheaps besteht darin, den größten Teil der Arbeitsspeicher Belegung zu umfassen, der zum Speichern der deskriptorspezifikationen von Objekttypen erforderlich ist, auf die sich Shader für einen großen Teil des Renderings als möglich (idealerweise ein ganzer Renderingbereich) beziehen.</span><span class="sxs-lookup"><span data-stu-id="aea01-113">The primary purpose of a descriptor heap is to encompass the bulk of memory allocation required for storing the descriptor specifications of object types that shaders reference for as large of a window of rendering as possible (ideally an entire frame of rendering or more).</span></span> <span data-ttu-id="aea01-114">Wenn eine Anwendung wechselt, welche Texturen die Pipeline schnell von der API sieht, muss im deskriptorheap Speicherplatz vorhanden sein, um deskriptortabellen für jeden benötigten Status dynamisch zu definieren.</span><span class="sxs-lookup"><span data-stu-id="aea01-114">If an application is switching which textures the pipeline sees rapidly from the API, there has to be space in the descriptor heap to define descriptor tables on the fly for every set of state needed.</span></span> <span data-ttu-id="aea01-115">Die Anwendung kann die Definitionen wieder verwenden, wenn die Ressourcen in einem anderen Objekt wieder verwendet werden, oder Sie können den Heap Bereich nur sequenziell zuweisen, wenn verschiedene Objekttypen gewechselt werden.</span><span class="sxs-lookup"><span data-stu-id="aea01-115">The application can choose to reuse definitions if the resources are used again in another object, for example, or just assign the heap space sequentially as it switches various object types.</span></span>

<span data-ttu-id="aea01-116">Deskriptorheaps erlauben auch einzelnen Softwarekomponenten, den deskriptorspeicher getrennt voneinander zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="aea01-116">Descriptor heaps also allow individual software components to manage descriptor storage separately from each other.</span></span>

<span data-ttu-id="aea01-117">Alle Heaps sind für die CPU sichtbar.</span><span class="sxs-lookup"><span data-stu-id="aea01-117">All heaps are visible to the CPU.</span></span> <span data-ttu-id="aea01-118">Die Anwendung kann auch anfordern, welche CPU-Zugriffs Eigenschaften ein deskriptorheap aufweisen soll (sofern vorhanden) – zusammen schreiben, Zurückschreiben usw.</span><span class="sxs-lookup"><span data-stu-id="aea01-118">The application can also request which CPU access properties a descriptor heap should have (if any) – write combined, write back, and so on.</span></span> <span data-ttu-id="aea01-119">Apps können beliebig viele deskriptorheaps mit den gewünschten Eigenschaften erstellen.</span><span class="sxs-lookup"><span data-stu-id="aea01-119">Apps can create as many descriptor heaps as desired with whatever properties are desired.</span></span> <span data-ttu-id="aea01-120">Apps haben immer die Möglichkeit, deskriptorheaps zu erstellen, die ausschließlich für stagingzwecke verwendet werden, deren Größe nicht eingeschränkt ist, sowie zum Kopieren in deskriptorheaps, die bei Bedarf für das Rendering verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="aea01-120">Apps always have the option to create descriptor heaps that are purely for staging purposes that are unconstrained in size, and copying to descriptor heaps that are used for rendering as necessary.</span></span>

<span data-ttu-id="aea01-121">Es gibt einige Einschränkungen in Bezug auf das, was sich im gleichen deskriptorheap befinden kann.</span><span class="sxs-lookup"><span data-stu-id="aea01-121">There are some restrictions in what can go in the same descriptor heap.</span></span> <span data-ttu-id="aea01-122">CBV-, UAV-und SRV-Einträge können sich im gleichen deskriptorheap befinden.</span><span class="sxs-lookup"><span data-stu-id="aea01-122">CBV, UAV and SRV entries can be in the same descriptor heap.</span></span> <span data-ttu-id="aea01-123">Allerdings können sampleneinträge keinen Heap mit CBV-, UAV-oder SRV-Einträgen freigeben.</span><span class="sxs-lookup"><span data-stu-id="aea01-123">However, Samplers entries cannot share a heap with CBV, UAV or SRV entries.</span></span> <span data-ttu-id="aea01-124">In der Regel gibt es zwei Sätze von deskriptorheaps, eine für die gemeinsamen Ressourcen und die zweite für Samplers.</span><span class="sxs-lookup"><span data-stu-id="aea01-124">Typically, there are two sets of descriptor heaps, one for the common resources and the second for Samplers.</span></span>

<span data-ttu-id="aea01-125">Die Verwendung von deskriptorheaps durch Direct3D 12 spiegelt die meisten GPU-Hardware wider, d. h., dass Deskriptoren nur in deskriptorheaps verwendet werden müssen oder dass weniger Adressierungs Bits erforderlich sind, wenn diese Heaps verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="aea01-125">The use of descriptor heaps by Direct3D 12 mirrors what most GPU hardware does, which is to either require descriptors live only in descriptor heaps, or simply that fewer addressing bits are needed if these heaps are used.</span></span> <span data-ttu-id="aea01-126">Direct3D 12 erfordert die Verwendung von deskriptorheaps, es gibt keine Möglichkeit, Deskriptoren an einer beliebigen Stelle im Arbeitsspeicher zu platzieren.</span><span class="sxs-lookup"><span data-stu-id="aea01-126">Direct3D 12 does require the use of descriptor heaps, there is no option to put descriptors anywhere in memory.</span></span>

<span data-ttu-id="aea01-127">Deskriptorheaps können nur direkt von der CPU bearbeitet werden, es gibt keine Option zum Bearbeiten eines deskriptorheap durch die GPU.</span><span class="sxs-lookup"><span data-stu-id="aea01-127">Descriptor heaps can only be edited immediately by the CPU, there is no option to edit a descriptor heap by the GPU.</span></span>

## <a name="synchronization"></a><span data-ttu-id="aea01-128">Synchronization</span><span class="sxs-lookup"><span data-stu-id="aea01-128">Synchronization</span></span>

<span data-ttu-id="aea01-129">Der Inhalt des deskriptorheaps kann vor, während und nach dem Aufzeichnen von Befehlslisten, die auf ihn verweisen, geändert werden.</span><span class="sxs-lookup"><span data-stu-id="aea01-129">Descriptor heap contents can be changed before, during and after recording command lists that reference it.</span></span> <span data-ttu-id="aea01-130">Allerdings können Deskriptoren nicht geändert werden, während eine Befehlsliste, die zur Ausführung übermittelt wird, auf diesen Speicherort verweist, da dadurch eine Racebedingung aufgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="aea01-130">However, descriptors cannot be changed while a command list submitted for execution might reference that location, as this could invoke a race condition.</span></span>

## <a name="binding"></a><span data-ttu-id="aea01-131">Bindung</span><span class="sxs-lookup"><span data-stu-id="aea01-131">Binding</span></span>

<span data-ttu-id="aea01-132">Höchstens ein kombinierter CBV-/SRV-/UU--Heap und ein Sampler-Heap können gleichzeitig gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="aea01-132">At most one CBV/SRV/UAV combined heap and one Sampler heap can be bound at any one time.</span></span> <span data-ttu-id="aea01-133">Diese Heaps werden sowohl für die Grafik-als auch für die Compute-Pipelines gemeinsam genutzt (in ihren PSOs beschrieben).</span><span class="sxs-lookup"><span data-stu-id="aea01-133">These heaps are shared between both the graphics and compute pipelines (described in their PSOs).</span></span>

## <a name="switching-heaps"></a><span data-ttu-id="aea01-134">Wechseln von Heaps</span><span class="sxs-lookup"><span data-stu-id="aea01-134">Switching heaps</span></span>

<span data-ttu-id="aea01-135">Es ist zulässig, dass eine Anwendung Heaps in derselben Befehlsliste oder in verschiedenen Einstellungen mithilfe der [**setdescriptorheaps**](/windows/desktop/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setdescriptorheaps) -und [**Reset**](/windows/desktop/api/d3d12/nf-d3d12-id3d12graphicscommandlist-reset) -APIs wechselt.</span><span class="sxs-lookup"><span data-stu-id="aea01-135">It is acceptable for an application to switch heaps within the same command list or in different ones using the [**SetDescriptorHeaps**](/windows/desktop/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setdescriptorheaps) and [**Reset**](/windows/desktop/api/d3d12/nf-d3d12-id3d12graphicscommandlist-reset) APIs.</span></span> <span data-ttu-id="aea01-136">Bei manchen Hardware kann dies ein kostspieliger Vorgang sein, der einen GPU-Stall erfordert, um alle Arbeiten zu leeren, die vom zurzeit gebundenen deskriptorheap abhängen.</span><span class="sxs-lookup"><span data-stu-id="aea01-136">On some hardware, this can be an expensive operation, requiring a GPU stall to flush all work that depends on the currently bound descriptor heap.</span></span> <span data-ttu-id="aea01-137">Wenn deskriptorheaps geändert werden müssen, sollten Sie daher versuchen, dies zu tun, wenn die GPU-Arbeitsauslastung relativ gering ist, was möglicherweise die Änderungen am Anfang einer Befehlsliste einschränkt.</span><span class="sxs-lookup"><span data-stu-id="aea01-137">As a result, if descriptor heaps must be changed, applications should try to do so when the GPU workload is relatively light, perhaps limiting changes to the start of a command list.</span></span>

## <a name="bundles"></a><span data-ttu-id="aea01-138">Bundles</span><span class="sxs-lookup"><span data-stu-id="aea01-138">Bundles</span></span>

<span data-ttu-id="aea01-139">Bei Paketen kann nur ein Aufruf der [**setdescriptorheaps**](/windows/desktop/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setdescriptorheaps) -Methode erfolgen, und die festgelegten deskriptorheaps müssen genau denen der Befehlsliste entsprechen, die das Paket aufruft.</span><span class="sxs-lookup"><span data-stu-id="aea01-139">With bundles there can only be one call to the [**SetDescriptorHeaps**](/windows/desktop/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setdescriptorheaps) method, and the descriptor heaps set must match exactly those of the command list calling the bundle.</span></span> <span data-ttu-id="aea01-140">Wenn das Paket keine deskriptortabellen ändert, müssen die deskriptorheaps nicht festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="aea01-140">If the bundle does not change descriptor tables, it does not need to set the descriptor heaps.</span></span>

<span data-ttu-id="aea01-141">Eine Liste der API-Aufrufe, die nicht mit Paketen verwendet werden können, finden Sie unter [Erstellen und Aufzeichnen von Befehlslisten und Paketen](recording-command-lists-and-bundles.md).</span><span class="sxs-lookup"><span data-stu-id="aea01-141">For a list of API calls that cannot be used with bundles, refer to [Creating and Recording Command Lists and Bundles](recording-command-lists-and-bundles.md).</span></span>

## <a name="management"></a><span data-ttu-id="aea01-142">Verwaltung</span><span class="sxs-lookup"><span data-stu-id="aea01-142">Management</span></span>

<span data-ttu-id="aea01-143">Um alle Objekte in einer Szene zu erzeugen, werden viele Deskriptoren benötigt, und es gibt verschiedene Verwaltungsstrategien, die befolgt werden können.</span><span class="sxs-lookup"><span data-stu-id="aea01-143">To render all of the objects in a scene, many descriptors will be needed, and there are some different management strategies that can be followed.</span></span>

<span data-ttu-id="aea01-144">Die grundlegendste Strategie besteht darin, einen neuen Bereich des deskriptorheap mit allen Anforderungen für den nächsten zeichnen-Befehl auszufüllen.</span><span class="sxs-lookup"><span data-stu-id="aea01-144">The most basic strategy would be to fill in a fresh area of the descriptor heap with all of the requirements for the next draw call.</span></span> <span data-ttu-id="aea01-145">Bevor Sie also den Draw-Befehl in der Befehlsliste ausgeben, wird ein deskriptortabellenzeiger auf den Anfang der neu aufgefüllten Tabelle festgelegt.</span><span class="sxs-lookup"><span data-stu-id="aea01-145">So, just before issuing the draw call on the command list, a descriptor table pointer would be set to the start of the freshly populated table.</span></span> <span data-ttu-id="aea01-146">Der Vorteil besteht darin, dass es nicht erforderlich ist, den Speicherort eines bestimmten Deskriptors im Heap aufzuzeichnen.</span><span class="sxs-lookup"><span data-stu-id="aea01-146">The upside is that there is no need to record where any particular descriptor is in the heap.</span></span>

<span data-ttu-id="aea01-147">Der Nachteil dieser Strategie besteht darin, dass es möglicherweise viele Wiederholungen von Deskriptoren im deskriptorheap gibt, insbesondere wenn eine sehr ähnliche Szene gerendert wird und der deskriptorheap-Speicherplatz schnell aufgebraucht wird.</span><span class="sxs-lookup"><span data-stu-id="aea01-147">The downside to this strategy is that there could be a lot of repetition of descriptors in the descriptor heap, especially when a very similar scene is being rendered, and that descriptor heap space is going to be used up quickly.</span></span> <span data-ttu-id="aea01-148">Für diejenigen, die auf der GPU gerendert werden, und für diejenigen, die von der CPU aufgezeichnet werden, wäre es wahrscheinlich notwendig, Konflikte zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="aea01-148">Separate descriptor heaps for those being rendered on the GPU and for those being recorded by the CPU, would probably be necessary to avoid conflict.</span></span> <span data-ttu-id="aea01-149">Alternativ kann ein unter Zuordnungs System verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="aea01-149">Alternatively a sub-allocation system could be used.</span></span>

<span data-ttu-id="aea01-150">Außerdem könnte das grundlegende System durch die sorgfältige Verwendung von überschneidenden deskriptortabellen von einem zeichnen-Befehl zum nächsten optimiert werden, sodass nur die neuen erforderlichen Deskriptoren hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="aea01-150">Also, the basic system could be further optimized by careful use of overlapping descriptor tables from one draw call to the next, so that only the new descriptors required are added.</span></span>

<span data-ttu-id="aea01-151">Eine effizientere Strategie als die Basis ist, deskriptorheaps mit Deskriptoren vorab auszufüllen, die für die Objekte (oder Materialien) erforderlich sind, die bekanntermaßen Teil der Szene sind.</span><span class="sxs-lookup"><span data-stu-id="aea01-151">A more efficient strategy than the basic one would be to pre-fill descriptor heaps with descriptors required for the objects (or materials) that are known to be part of the scene.</span></span> <span data-ttu-id="aea01-152">Die Idee besteht darin, dass es nur notwendig ist, die Deskriptortabelle zur zeichnungszeit festzulegen, da der deskriptorheap vorab aufgefüllt wird.</span><span class="sxs-lookup"><span data-stu-id="aea01-152">The idea here is that it is only necessary to set the descriptor table at draw time, as the descriptor heap is populated ahead of time.</span></span>

<span data-ttu-id="aea01-153">Eine Variation der vorab abfüllenden Strategie besteht darin, den deskriptorheap als ein riesiges Array zu behandeln, das alle erforderlichen Deskriptoren in den bekannten Speicherorten enthält.</span><span class="sxs-lookup"><span data-stu-id="aea01-153">A variation of the pre-filling strategy is to treat the descriptor heap as one huge array, containing all the required descriptors in fixed known locations.</span></span> <span data-ttu-id="aea01-154">Dann benötigt der Draw-Befehl nur einen Satz von Konstanten, die die Indizes in das Array von sind, in dem die Deskriptoren verwendet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="aea01-154">Then the draw call needs only to receive a set of constants which are the indices into the array of where the descriptors are that need to be used.</span></span>

<span data-ttu-id="aea01-155">Eine weitere Optimierung besteht darin, sicherzustellen, dass Stamm Konstanten und Stamm Deskriptoren solche enthalten, die am häufigsten geändert werden, anstatt Konstanten im deskriptorheap zu platzieren.</span><span class="sxs-lookup"><span data-stu-id="aea01-155">A further optimization is to ensure root constants and root descriptors contain those that change most frequently, rather than place constants in the descriptor heap.</span></span> <span data-ttu-id="aea01-156">Für die meisten Hardware ist dies eine effiziente Methode zur Handhabung von Konstanten.</span><span class="sxs-lookup"><span data-stu-id="aea01-156">For most hardware this is an efficient way of handling constants.</span></span>

<span data-ttu-id="aea01-157">In der Praxis kann eine Grafik-Engine in unterschiedlichen Situationen eine andere Strategie verwenden und die Elemente jeder Strategie so kombinieren, dass Sie den jeweiligen Zeichnungs Anforderungen entsprechen.</span><span class="sxs-lookup"><span data-stu-id="aea01-157">In practice a graphics engine might use a different strategy in different situations, and combine elements of each strategy to suit the particular drawing requirements.</span></span>

## <a name="related-topics"></a><span data-ttu-id="aea01-158">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="aea01-158">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="aea01-159">Deskriptorheaps</span><span class="sxs-lookup"><span data-stu-id="aea01-159">Descriptor Heaps</span></span>](descriptor-heaps.md)
</dt> </dl>

 

 




