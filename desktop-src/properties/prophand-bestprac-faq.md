---
description: Dieser Artikel enthält bewährte Methoden und häufig gestellte Fragen zum Erstellen und Registrieren von Eigenschaftenhandlern für die Arbeit mit dem Windows-Eigenschaftensystem.
ms.assetid: E583A00B-F615-41c8-AECF-061F1396DB9A
title: Bewährte Methoden und häufig gestellte Fragen zu Eigenschaftenhandlern
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5605c39f1021fcfe91259405bb99f8981510d3dc
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/19/2021
ms.locfileid: "112405953"
---
# <a name="property-handler-best-practices-and-faq"></a><span data-ttu-id="75b1d-103">Bewährte Methoden und häufig gestellte Fragen zu Eigenschaftenhandlern</span><span class="sxs-lookup"><span data-stu-id="75b1d-103">Property Handler Best Practices and FAQ</span></span>

<span data-ttu-id="75b1d-104">In diesem Thema wird erläutert, wie Eigenschaftenhandler für die Arbeit mit dem Windows-Eigenschaftensystem erstellt und registriert werden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-104">This topic explains how to create and register property handlers to work with the Windows property system.</span></span>

<span data-ttu-id="75b1d-105">Dieses Thema ist wie folgt organisiert:</span><span class="sxs-lookup"><span data-stu-id="75b1d-105">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="75b1d-106">Bewährte Methoden</span><span class="sxs-lookup"><span data-stu-id="75b1d-106">Best Practices</span></span>](#property-handler-best-practices-and-faq)
    -   [<span data-ttu-id="75b1d-107">Überschreiben von Dateisystemeigenschaften</span><span class="sxs-lookup"><span data-stu-id="75b1d-107">Overriding File System Properties</span></span>](#overriding-file-system-properties)
    -   [<span data-ttu-id="75b1d-108">Speichern von Eigenschaften in XML-basierten Dateiformaten</span><span class="sxs-lookup"><span data-stu-id="75b1d-108">Storing Properties in XML-based File Formats</span></span>](#storing-properties-in-xml-based-file-formats)
    -   [<span data-ttu-id="75b1d-109">Berechnete Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="75b1d-109">Computed Properties</span></span>](#computed-properties)
-   [<span data-ttu-id="75b1d-110">Häufig gestellte Fragen</span><span class="sxs-lookup"><span data-stu-id="75b1d-110">Frequently Asked Questions</span></span>](#property-handler-best-practices-and-faq)
-   [<span data-ttu-id="75b1d-111">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="75b1d-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="75b1d-112">Bewährte Methoden</span><span class="sxs-lookup"><span data-stu-id="75b1d-112">Best Practices</span></span>

<span data-ttu-id="75b1d-113">Die hier beschriebenen bewährten Methoden bieten nützliche Implementierungstipps.</span><span class="sxs-lookup"><span data-stu-id="75b1d-113">The best practices outlined here provide useful implementation tips.</span></span>

### <a name="overriding-file-system-properties"></a><span data-ttu-id="75b1d-114">Überschreiben von Dateisystemeigenschaften</span><span class="sxs-lookup"><span data-stu-id="75b1d-114">Overriding File System Properties</span></span>

<span data-ttu-id="75b1d-115">Einige Eigenschaften für Dateien werden von der Dateisystemdatenquelle bereitgestellt, z. B.:</span><span class="sxs-lookup"><span data-stu-id="75b1d-115">Some properties for files are provided by the file system data source, such as:</span></span>

-   <span data-ttu-id="75b1d-116">PKEY \_ FileName</span><span class="sxs-lookup"><span data-stu-id="75b1d-116">PKEY\_FileName</span></span>
-   <span data-ttu-id="75b1d-117">\_PKEY-Erweiterung</span><span class="sxs-lookup"><span data-stu-id="75b1d-117">PKEY\_Extension</span></span>
-   <span data-ttu-id="75b1d-118">PKEY \_ ModifiedTime</span><span class="sxs-lookup"><span data-stu-id="75b1d-118">PKEY\_ModifiedTime</span></span>

<span data-ttu-id="75b1d-119">Im Allgemeinen können Eigenschaftshandler keine Werte für diese Eigenschaften bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="75b1d-119">In general, property handlers cannot provide values for these properties.</span></span> <span data-ttu-id="75b1d-120">In einigen Fällen können diese Eigenschaften jedoch auf Der Grundlage von Registrierungsinformationen überschrieben werden, die vom Eigenschaftenhandler bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-120">However, in some cases these properties can be overridden based on registration information provided by the property handler.</span></span> <span data-ttu-id="75b1d-121">Eigenschaftenhandler füllen **HKEY \_ CLASSES \_ ROOT** \\ **CLSID** \\ *{handler clsid}* \\ **OverrideFileSystemProperties** mit den Namen der Eigenschaften auf, die überschrieben werden sollen.</span><span class="sxs-lookup"><span data-stu-id="75b1d-121">Property handlers populate **HKEY\_CLASSES\_ROOT**\\**CLSID**\\ *{handler clsid}*\\**OverrideFileSystemProperties** with the names of properties that they want to override.</span></span> <span data-ttu-id="75b1d-122">Dies ist auf einen festen Satz von Eigenschaften beschränkt, der in der folgenden Liste angezeigt wird, über die das System über Kenntnisse verfügt.</span><span class="sxs-lookup"><span data-stu-id="75b1d-122">This is limited to a fixed set of properties shown in the following list of which the system has knowledge.</span></span>

<span data-ttu-id="75b1d-123">Das Überschreiben wird für die folgenden Eigenschaftswerte unterstützt:</span><span class="sxs-lookup"><span data-stu-id="75b1d-123">Overriding is supported for the following property values:</span></span>

-   [<span data-ttu-id="75b1d-124">System.Kind</span><span class="sxs-lookup"><span data-stu-id="75b1d-124">System.Kind</span></span>](./props-system-kind.md)
-   [<span data-ttu-id="75b1d-125">System.FileName</span><span class="sxs-lookup"><span data-stu-id="75b1d-125">System.FileName</span></span>](./props-system-filename.md)
-   [<span data-ttu-id="75b1d-126">System.IsPinnedToNameSpaceTree</span><span class="sxs-lookup"><span data-stu-id="75b1d-126">System.IsPinnedToNameSpaceTree</span></span>](./props-system-ispinnedtonamespacetree.md)
-   [<span data-ttu-id="75b1d-127">System.ItemNameDisplay</span><span class="sxs-lookup"><span data-stu-id="75b1d-127">System.ItemNameDisplay</span></span>](./props-system-itemnamedisplay.md)
-   [<span data-ttu-id="75b1d-128">System.SFGAOFlags</span><span class="sxs-lookup"><span data-stu-id="75b1d-128">System.SFGAOFlags</span></span>](./props-system-sfgaoflags.md)
-   [<span data-ttu-id="75b1d-129">System.ItemPathDisplay</span><span class="sxs-lookup"><span data-stu-id="75b1d-129">System.ItemPathDisplay</span></span>](./props-system-itempathdisplay.md)
-   [<span data-ttu-id="75b1d-130">System.ItemPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="75b1d-130">System.ItemPathDisplayNarrow</span></span>](./props-system-itempathdisplaynarrow.md)
-   [<span data-ttu-id="75b1d-131">System.ItemFolderNameDisplay</span><span class="sxs-lookup"><span data-stu-id="75b1d-131">System.ItemFolderNameDisplay</span></span>](./props-system-itemfoldernamedisplay.md)
-   [<span data-ttu-id="75b1d-132">System.ItemFolderPathDisplay</span><span class="sxs-lookup"><span data-stu-id="75b1d-132">System.ItemFolderPathDisplay</span></span>](./props-system-itemfolderpathdisplay.md)
-   [<span data-ttu-id="75b1d-133">System.ItemFolderPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="75b1d-133">System.ItemFolderPathDisplayNarrow</span></span>](./props-system-itemfolderpathdisplaynarrow.md)

<span data-ttu-id="75b1d-134">Eine vollständige Liste aller Shell-Eigenschaften finden Sie unter [Shelleigenschaften.](./props.md)</span><span class="sxs-lookup"><span data-stu-id="75b1d-134">For a full list of all Shell properties, see [Shell Properties](./props.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="75b1d-135">Die überschriebenen Eigenschaftswerte werden nur verwendet, wenn die Dateien indiziert werden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-135">The overridden property values are used only when the files are indexed.</span></span> <span data-ttu-id="75b1d-136">Daher werden beim Durchsuchen von Dateien aus der Dateisystemdatenquelle die überschriebenen Werte nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="75b1d-136">Thus, browsing files from the file system data source does not reveal the overridden values.</span></span>

 

### <a name="storing-properties-in-xml-based-file-formats"></a><span data-ttu-id="75b1d-137">Speichern von Eigenschaften in XML-basierten Dateiformaten</span><span class="sxs-lookup"><span data-stu-id="75b1d-137">Storing Properties in XML-based File Formats</span></span>

<span data-ttu-id="75b1d-138">Es gibt zwei grundlegende Optionen zum Speichern von Eigenschaften in XML-basierten Dateiformaten:</span><span class="sxs-lookup"><span data-stu-id="75b1d-138">There are two basic options available for storing properties in XML-based file formats:</span></span>

-   <span data-ttu-id="75b1d-139">Speichern Sie jede Eigenschaft mithilfe von XML-Elementen und -Attributen gemäß dem XML-Schema des Dokuments.</span><span class="sxs-lookup"><span data-stu-id="75b1d-139">Store each property using XML elements and attributes according to the XML schema of the document.</span></span> <span data-ttu-id="75b1d-140">Dieser Ansatz ist "XML-freundlicher".</span><span class="sxs-lookup"><span data-stu-id="75b1d-140">This approach is more "XML friendly".</span></span>
-   <span data-ttu-id="75b1d-141">Serialisieren Sie den gesamten Eigenschaftenspeicher in ein Binary Large Object (BLOB) im Arbeitsspeicher, konvertieren Sie das BLOB in eine Base64-codierte Zeichenfolge, und speichern Sie diese Zeichenfolge dann im XML-Code.</span><span class="sxs-lookup"><span data-stu-id="75b1d-141">Serialize the entire property store into a memory Binary large object (BLOB), convert the BLOB into a base64-encoded string, and then store that string in the XML.</span></span> <span data-ttu-id="75b1d-142">Dies ist der einfachere der beiden Ansätze und kann verwendet werden, um einfache Unterstützung für offene Metadaten bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="75b1d-142">This is the simpler of the two approaches and can be used to trivially provide support for open metadata.</span></span>

<span data-ttu-id="75b1d-143">Einige Handler können diese Ansätze kombinieren, z. B. einige wichtige Werte im XML-Standardformat speichern und den Rest in einem BLOB speichern.</span><span class="sxs-lookup"><span data-stu-id="75b1d-143">Some handlers might combine these approaches, storing some important values in standard XML format and storing the rest in a BLOB, for example.</span></span>

### <a name="computed-properties"></a><span data-ttu-id="75b1d-144">Berechnete Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="75b1d-144">Computed Properties</span></span>

<span data-ttu-id="75b1d-145">Einige Eigenschaften werden von bestimmten Attributen einer Datei abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="75b1d-145">Some properties are derived from specific attributes of a file.</span></span> <span data-ttu-id="75b1d-146">Die [System.Image.Dimensions-Eigenschaft](./props-system-image-dimensions.md) wird beispielsweise durch die tatsächlichen Abmessungen des Bilds in einer Bilddatei bestimmt.</span><span class="sxs-lookup"><span data-stu-id="75b1d-146">For example, the [System.Image.Dimensions](./props-system-image-dimensions.md) property is determined by the actual dimensions of the image in an image file.</span></span> <span data-ttu-id="75b1d-147">Da solche Eigenschaftswerte nicht vom Eigenschaftenhandler geändert werden können, werden sie daher `isInnate="true"` in der Eigenschaftenbeschreibung markiert.</span><span class="sxs-lookup"><span data-stu-id="75b1d-147">Because such property values cannot be changed by the property handler, they are thus marked `isInnate="true"` in the property description.</span></span> <span data-ttu-id="75b1d-148">Andere Eigenschaften werden aus einem Teil einer bestimmten Eigenschaft oder durch Aggregieren der Werte mehrerer Eigenschaften berechnet.</span><span class="sxs-lookup"><span data-stu-id="75b1d-148">Other properties are computed from a part of a specific property or by aggregating the values of multiple properties.</span></span> <span data-ttu-id="75b1d-149">Da Updates dieser "berechneten" Eigenschaften zu Mehrdeutigkeiten in Bezug auf die Änderung der Quellwerte würden, sollten berechnete Eigenschaften in der Eigenschaftenbeschreibung markiert `isInnate="true"` oder als schreibgeschützt gemeldet werden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-149">Because updates to these "computed" properties would create ambiguity as to how the "source" values should be changed, computed properties should be marked `isInnate="true"` in the property description or reported as read-only.</span></span> <span data-ttu-id="75b1d-150">Die zweite Option ist verfügbar, indem der Handler angewiesen wird, S \_ FALSE von [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable)zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="75b1d-150">The latter option is available by instructing the handler to return S\_FALSE from [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="75b1d-151">Häufig gestellte Fragen</span><span class="sxs-lookup"><span data-stu-id="75b1d-151">Frequently Asked Questions</span></span>

<span data-ttu-id="75b1d-152">Dieser Abschnitt enthält Antworten auf häufig gestellte Fragen zu Eigenschaften und Eigenschaftenhandlern sowie begleitende Antworten.</span><span class="sxs-lookup"><span data-stu-id="75b1d-152">This section provides answers to frequently asked questions about properties and property handlers, and accompanying answers.</span></span>

-   <span data-ttu-id="75b1d-153">**Frage:** Warum wird mein Eigenschaftenhandler nicht vom Windows Search Indexer geladen?</span><span class="sxs-lookup"><span data-stu-id="75b1d-153">**Question:** Why isn't my property handler being loaded by the Windows Search indexer?</span></span>

    <span data-ttu-id="75b1d-154">Der Windows Search Indexer wird als Systemdienst ausgeführt und kann keine DLLs laden, die im Benutzerprofilverzeichnis gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="75b1d-154">The Windows Search indexer runs as a system service and cannot load DLLs that are stored in the user profile directory.</span></span> <span data-ttu-id="75b1d-155">Wenn Sie Microsoft Visual Studio erstellen und debuggen, wird die DLL in Ihrem Benutzerprofil abgelegt (daher wird sie nicht vom Indexer geladen).</span><span class="sxs-lookup"><span data-stu-id="75b1d-155">If you are building and debugging using Microsoft Visual Studio, it will place the DLL in your user profile (and therefore it won't be loaded by the indexer).</span></span> <span data-ttu-id="75b1d-156">Um dies zu umgehen, kopieren Sie Ihre DLL außerhalb Ihres Profilordners (z. B. in **C: \\ Programme \\ YourAppName**), und registrieren Sie sie dort.</span><span class="sxs-lookup"><span data-stu-id="75b1d-156">To work around this, copy your DLL outside of your profile folder (for example, into **C:\\Program Files\\YourAppName**) and register it there.</span></span>

    <span data-ttu-id="75b1d-157">Eine spezifischere Anleitung zum Entwickeln von Eigenschaftenhandlern für die Arbeit mit dem Windows Search Indexer finden Sie unter [Developing Property Handlers for Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="75b1d-157">For more specific guidance on developing property handlers to work with the Windows Search indexer, see [Developing Property Handlers for Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span></span>

-   <span data-ttu-id="75b1d-158">**Frage:** Welche Eigenschaften sollten über die [**Enumerationsmethoden IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) und [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) ermittelt werden können?</span><span class="sxs-lookup"><span data-stu-id="75b1d-158">**Question:** Which properties should be discoverable through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) enumeration methods?</span></span>

    <span data-ttu-id="75b1d-159">Nicht alle Clients von Eigenschaftenspeicherobjekten verwenden diese Methoden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-159">Not all clients of property store objects use these methods.</span></span> <span data-ttu-id="75b1d-160">Einige Clients kennen die Eigenschaften, die sie direkt anfordern möchten (nach PKEY-Name) oder empfangen Eigenschafteninformationen über eine Eigenschaftenbeschreibungsliste.</span><span class="sxs-lookup"><span data-stu-id="75b1d-160">Some clients are aware of the properties they plan to request directly (by PKEY name), or receive property information through a property description list.</span></span> <span data-ttu-id="75b1d-161">Die Methoden zur Eigenschaftenermittlung unterstützen mehrere andere Szenarien.</span><span class="sxs-lookup"><span data-stu-id="75b1d-161">The property discovery methods suppport several other scenarios.</span></span> <span data-ttu-id="75b1d-162">Wenn eine Eigenschaft nicht an diesen Szenarien teilnehmen muss, muss sie nicht aufzählt werden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-162">If a property does not need to participate in these scenarios, it does not need to be enumerated.</span></span> <span data-ttu-id="75b1d-163">Daher kann ein Eigenschaftenhandler einen EMPTY-Wert erzeugen, der nicht \_ VT ist, für Eigenschaften, die nicht über die [**Methoden IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) und [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) ermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-163">Hence, a property handler can produce a non-VT\_EMPTY value for properties that are not discovered through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span>

    <span data-ttu-id="75b1d-164">Eigenschaften sollten jedoch über diese Methoden sichtbar sein, wenn eine der folgenden Bedingungen erfüllt ist:</span><span class="sxs-lookup"><span data-stu-id="75b1d-164">However, properties should be visible via these methods if any of the following conditions are met:</span></span>

    -   <span data-ttu-id="75b1d-165">**Wenn die Eigenschaft indiziert ist, sodass sie durchsuchbar ist:** Dies bedeutet, dass es im Windows Search -Eigenschaftenspeicher enthalten ist (angegeben durch `isColumn = "true"` im Eigenschaftenbeschreibungsschema) oder für Volltextsuchen verfügbar ist ( `inInvertedIndex = "true"` ).</span><span class="sxs-lookup"><span data-stu-id="75b1d-165">**If the property is indexed so that it is searchable:** This means it is included in the Windows Search property store (denoted by `isColumn = "true"` in the property description schema) or available for full text searches (`inInvertedIndex = "true"`).</span></span> <span data-ttu-id="75b1d-166">Wenn diese Flags nicht vorhanden sind oder keine Eigenschaftenbeschreibung vorhanden ist, werden Eigenschaften vom Typ "string" automatisch dem invertierten Index hinzugefügt, um die Suche zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="75b1d-166">In the absence of these flags or the absence of a property description, properties of type "string" will be added automatically to the inverted index to enable searching.</span></span> <span data-ttu-id="75b1d-167">Da die Liste der bekannten Eigenschaften (mit installierten Eigenschaftenbeschreibungen) im Eigenschaftensystem sehr groß ist (mehr als 800 Eigenschaften), wäre es unpraktisch, jeden Eigenschaftenhandler nach jeder Eigenschaft zu fragen, die im Eigenschaftensystem registriert ist.</span><span class="sxs-lookup"><span data-stu-id="75b1d-167">Because the list of known properties (those with installed property descriptions) in the property system is very large (more than 800 properties), it would be impractical to ask every property handler for every property registered in the property system.</span></span> <span data-ttu-id="75b1d-168">Stattdessen listet der Indizierungsprozess die relevanten Eigenschaften aus dem Eigenschaftenhandler für jedes Element auf, das indiziert wird, und verwendet die Werte der aufzählten Eigenschaften, um den Volltextindex zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="75b1d-168">Instead, the indexing process enumerates the relevant properties from the property handler for each item it indexes, and it uses the values of the enumerated properties to build the full text index.</span></span>
    -   <span data-ttu-id="75b1d-169">**Wenn die Eigenschaft kopiert werden soll, wenn der Eigenschaftensatz des Elements dupliziert wird:** Um eine Funktion zum Kopieren eines Eigenschaftensatzes zu implementieren, macht das Quellelement die Eigenschaften, die kopiert werden sollen, über die Methoden [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) und [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) sichtbar.</span><span class="sxs-lookup"><span data-stu-id="75b1d-169">**If the property should be copied when the item's property set is duplicated:** To implement a "copy a property set" function, the source item makes the properties that should be copied visible through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span> <span data-ttu-id="75b1d-170">Eigenschaften, die nicht kopiert werden müssen oder nicht sinnvoll sind, sollten nicht eingeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-170">Properties that do not need to be copied or do not make sense being copied should not be included.</span></span>
    -   <span data-ttu-id="75b1d-171">**Wenn der Eigenschaftswert nicht leer ist (VT \_ EMPTY):** Eigenschaftswerte, die leer sind, sind für Clients nicht nützlich.</span><span class="sxs-lookup"><span data-stu-id="75b1d-171">**If the property value is not empty (VT\_EMPTY):** Property values that are empty are not useful for clients.</span></span> <span data-ttu-id="75b1d-172">Wenn Clients versuchen, leere Eigenschaftswerte zurückzugeben, wird der Wert VT \_ EMPTY zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="75b1d-172">When clients attempt to return empty property values, a value of VT\_EMPTY is returned.</span></span> <span data-ttu-id="75b1d-173">Daher sollten Eigenschaften mit leeren Werten nicht aufzählt werden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-173">Thus, properties with empty values should not be enumerated.</span></span>
    -   <span data-ttu-id="75b1d-174">**Wenn die Eigenschaft beim Aufrufen der Funktion "remove properties" entfernt werden soll:** Dieses Feature dient zum Schutz des Datenschutzes. er ermittelt alle Werte aus dem Eigenschaftenhandler über die -Enumeration und entfernt jeden, der vom Benutzer entfernt werden soll.</span><span class="sxs-lookup"><span data-stu-id="75b1d-174">**If the property should be removed when invoking the "remove properties" function:** This feature exists to protect privacy; it discovers all values from the property handler through enumeration and removes each one selected for removal by the user.</span></span>
        > [!Note]  
        > <span data-ttu-id="75b1d-175">Beim Aufzählen von Eigenschaften wird der Eigenschaftensatz, den ein bestimmter Eigenschaftenhandler unterstützt, nicht kommuniziert, wenn der Handler ein festes Schema (und keine geöffneten Metadaten) unterstützt.</span><span class="sxs-lookup"><span data-stu-id="75b1d-175">Enumerating properties does not communicate the set of properties that a particular property handler supports if the handler supports a fixed schema (and not open metadata).</span></span> <span data-ttu-id="75b1d-176">Stattdessen sollten solche Handler den Satz von Eigenschaften dokumentieren, die sie unterstützen.</span><span class="sxs-lookup"><span data-stu-id="75b1d-176">Instead, such handlers should document the set of properties that they support.</span></span>

         

-   <span data-ttu-id="75b1d-177">**Frage:** Gewusst wie wissen, welche Dateiformate offene Metadaten unterstützen?</span><span class="sxs-lookup"><span data-stu-id="75b1d-177">**Question:** How do I know which file formats support open metadata?</span></span>

    <span data-ttu-id="75b1d-178">Informationen zur Unterstützung für geöffnete Metadaten finden Sie unter "Dateitypen, die geöffnete Metadaten unterstützen" in [Dateitypen.](../shell/fa-file-types.md)</span><span class="sxs-lookup"><span data-stu-id="75b1d-178">For information about support for open metadata, see "File Types that Support Open Metadata" in [File Types](../shell/fa-file-types.md).</span></span>

-   <span data-ttu-id="75b1d-179">**Frage:** Können VT \_ NULL-Werte mithilfe eines Eigenschaftenhandlers gespeichert werden?</span><span class="sxs-lookup"><span data-stu-id="75b1d-179">**Question:** Can VT\_NULL values be stored using a property handler?</span></span>

    <span data-ttu-id="75b1d-180">Nein.</span><span class="sxs-lookup"><span data-stu-id="75b1d-180">No.</span></span> <span data-ttu-id="75b1d-181">VT \_ NULL-Werte werden \_ bei Aufrufen von [**IPropertyStore::GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) und [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85))in VT EMPTY konvertiert.</span><span class="sxs-lookup"><span data-stu-id="75b1d-181">VT\_NULL values will be converted to VT\_EMPTY on calls to [**IPropertyStore::GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) and [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="75b1d-182">**Frage:** Welche Datumszeichenfolgenformate werden von der [**PropVariantChangeType-Funktion**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) unterstützt?</span><span class="sxs-lookup"><span data-stu-id="75b1d-182">**Question:** Which date string formats are supported by the [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) function?</span></span>

    <span data-ttu-id="75b1d-183">Im Allgemeinen sollten Eigenschaften, die Datums-/Uhrzeitwerte darstellen, mithilfe von VT FILETIME dargestellt \_ werden.</span><span class="sxs-lookup"><span data-stu-id="75b1d-183">Generally, properties that represent date/time values should be represented using VT\_FILETIME.</span></span> <span data-ttu-id="75b1d-184">Viele Datenquellen stellen diese Informationen jedoch in Zeichenfolgenform bereit.</span><span class="sxs-lookup"><span data-stu-id="75b1d-184">However, many data sources provide this information in string form.</span></span> <span data-ttu-id="75b1d-185">Die [**PropVariantChangeType-Hilfs-API**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) unterstützt das Koercieren einiger Zeichenfolgendatumsformate in [**FILETIME-Werte,**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) wie in der folgenden Tabelle dargestellt.</span><span class="sxs-lookup"><span data-stu-id="75b1d-185">The [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) helper API supports coercing some string date formats into [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) values, as shown in the following table.</span></span>

    

    | <span data-ttu-id="75b1d-186">Format</span><span class="sxs-lookup"><span data-stu-id="75b1d-186">Format</span></span>                  | <span data-ttu-id="75b1d-187">Windows Vista, Windows XP und Microsoft Windows Desktop Search (WDS)</span><span class="sxs-lookup"><span data-stu-id="75b1d-187">Windows Vista, Windows XP, and Microsoft Windows Desktop Search (WDS)</span></span> | <span data-ttu-id="75b1d-188">Windows 7</span><span class="sxs-lookup"><span data-stu-id="75b1d-188">Windows 7</span></span> | <span data-ttu-id="75b1d-189">Hinweise</span><span class="sxs-lookup"><span data-stu-id="75b1d-189">Notes</span></span>                                                                                                                                                                                                 |
    |-------------------------|-----------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="75b1d-190">yyyy/mm/dd:hh:mm:ss.uuu</span><span class="sxs-lookup"><span data-stu-id="75b1d-190">yyyy/mm/dd:hh:mm:ss.uuu</span></span> | <span data-ttu-id="75b1d-191">Ja</span><span class="sxs-lookup"><span data-stu-id="75b1d-191">Yes</span></span>                                                                   | <span data-ttu-id="75b1d-192">Ja</span><span class="sxs-lookup"><span data-stu-id="75b1d-192">Yes</span></span>       | <span data-ttu-id="75b1d-193">UTC; y=year, m=month, d=date, h=hours (24-Stunden-Uhr), m=minutes, s=seconds, u=microseconds</span><span class="sxs-lookup"><span data-stu-id="75b1d-193">UTC; y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds, u=microseconds</span></span>                                                                                                           |
    | <span data-ttu-id="75b1d-194">jjjj-mm-ttThh:mm:ssZ</span><span class="sxs-lookup"><span data-stu-id="75b1d-194">yyyy-mm-ddThh:mm:ssZ</span></span>    | <span data-ttu-id="75b1d-195">Nein</span><span class="sxs-lookup"><span data-stu-id="75b1d-195">No</span></span>                                                                    | <span data-ttu-id="75b1d-196">Ja</span><span class="sxs-lookup"><span data-stu-id="75b1d-196">Yes</span></span>       | <span data-ttu-id="75b1d-197">SPEZIFIKATION DES **ISO8601-Formats** UTC (angegeben durch den Zeitzonenindikator "Z"), y=year, m=month, d=date, h=hours (24-Stunden-Uhr), m=minutes, s=seconds; "T" ist ein Trennzeichen für den Zeitabschnitt.</span><span class="sxs-lookup"><span data-stu-id="75b1d-197">**ISO8601 format specification** UTC (denoted by 'Z' time zone indicator); y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds; 'T' is a delimiter for the time portion.</span></span><br/> |

    

     

-   <span data-ttu-id="75b1d-198">**Frage:** Ist es möglich, einen schreibgeschützten Eigenschaftenhandler zu erstellen?</span><span class="sxs-lookup"><span data-stu-id="75b1d-198">**Question:** Is it possible to create a read-only property handler?</span></span>

    <span data-ttu-id="75b1d-199">Ja.</span><span class="sxs-lookup"><span data-stu-id="75b1d-199">Yes.</span></span> <span data-ttu-id="75b1d-200">Einige Implementierungen von Eigenschaftenhandlern unterstützen das Schreiben von Eigenschaftswerten nicht.</span><span class="sxs-lookup"><span data-stu-id="75b1d-200">Some property handler implementations do not support writing of property values.</span></span> <span data-ttu-id="75b1d-201">Diese Eigenschaftenhandler sollten STGM \_ E \_ ACCESSDENIED bei Aufrufen von **IInitializeXXX::Initialize** zurückgeben, die STGM \_ READWRITE übergeben, oder bei jedem Aufruf von [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="75b1d-201">These property handlers should return STGM\_E\_ACCESSDENIED on calls to **IInitializeXXX::Initialize** that pass STGM\_READWRITE, or on any call to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

    <span data-ttu-id="75b1d-202">Alle im STGM-LESEmodus geöffneten Eigenschaftenhandler \_ sollten STGM \_ E \_ ACCESSDENIED bei Aufrufen von [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85))zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="75b1d-202">All property handlers opened in STGM\_READ mode should return STGM\_E\_ACCESSDENIED on calls to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="75b1d-203">**Frage:** Kann ein Eigenschaftenhandler eine Eigenschaft als schreibgeschützt behandeln, auch wenn das Schema angibt, dass die Eigenschaft schreibbar ist?</span><span class="sxs-lookup"><span data-stu-id="75b1d-203">**Question:** Can a property handler treat a property as read-only, even if the schema indicates that the property is writeable?</span></span>

    <span data-ttu-id="75b1d-204">Ja.</span><span class="sxs-lookup"><span data-stu-id="75b1d-204">Yes.</span></span> <span data-ttu-id="75b1d-205">Im Schemasystem werden Eigenschaften als schreibgeschützt (einschließlich derjenigen mit `isInnate = "true"` ) oder Als Lese-/Schreibzugriff versehen.</span><span class="sxs-lookup"><span data-stu-id="75b1d-205">In the schema system, properties are annotated as read-only (including those with `isInnate = "true"`) or read/write.</span></span> <span data-ttu-id="75b1d-206">Eigenschaftenhandler, die das Schreiben einer bestimmten Eigenschaft, die das Schema besagt, nicht unterstützen, sollten [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) implementieren und S \_ FALSE bei Aufrufen von [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) für diese Eigenschaft zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="75b1d-206">Property handlers that do not support writing a particular property that the schema says should be writeable should implement [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) and return S\_FALSE on calls to [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) for that property.</span></span> <span data-ttu-id="75b1d-207">Dies gibt an, dass die -Eigenschaft im Kontext dieses Handlers und dieser Datei nicht schreibbar ist.</span><span class="sxs-lookup"><span data-stu-id="75b1d-207">This indicates that in the context of this handler and this file, the property is not writeable.</span></span>

    > [!Note]  
    > <span data-ttu-id="75b1d-208">Die umgekehrte Aktion ist nicht möglich.</span><span class="sxs-lookup"><span data-stu-id="75b1d-208">The reverse action is not possible.</span></span> <span data-ttu-id="75b1d-209">Sie können es einem Eigenschaftenhandler nicht ermöglichen, eine Eigenschaft zu schreiben, die im Schema als schreibgeschützt markiert ist.</span><span class="sxs-lookup"><span data-stu-id="75b1d-209">You cannot enable a property handler to write a property that is marked as read-only in the schema</span></span>

     

## <a name="related-topics"></a><span data-ttu-id="75b1d-210">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="75b1d-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="75b1d-211">Grundlegendes zu Eigenschaftenhandlern</span><span class="sxs-lookup"><span data-stu-id="75b1d-211">Understanding Property Handlers</span></span>](./building-property-handlers-properties.md)
</dt> <dt>

[<span data-ttu-id="75b1d-212">Verwenden von Kind-Namen</span><span class="sxs-lookup"><span data-stu-id="75b1d-212">Using Kind Names</span></span>](./building-property-handlers-user-friendly-kind-names.md)
</dt> <dt>

[<span data-ttu-id="75b1d-213">Verwenden von Eigenschaftenlisten</span><span class="sxs-lookup"><span data-stu-id="75b1d-213">Using Property Lists</span></span>](./building-property-handlers-property-lists.md)
</dt> <dt>

[<span data-ttu-id="75b1d-214">Initialisieren von Eigenschaftenhandlern</span><span class="sxs-lookup"><span data-stu-id="75b1d-214">Initializing Property Handlers</span></span>](./building-property-handlers-property-handlers.md)
</dt> <dt>

[<span data-ttu-id="75b1d-215">Registrieren und Verteilen von Eigenschaftenhandlern</span><span class="sxs-lookup"><span data-stu-id="75b1d-215">Registering and Distributing Property Handlers</span></span>](./prophand-reg-dist.md)
</dt> </dl>

 

 
