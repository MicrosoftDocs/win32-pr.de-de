---
description: In diesem Thema wird erläutert, wie Sie Eigenschafts Handler erstellen und registrieren, um mit dem Windows-Eigenschaften System zu arbeiten.
ms.assetid: E583A00B-F615-41c8-AECF-061F1396DB9A
title: Bewährte Methoden und häufig gestellte Fragen zu Eigenschaften Handlern
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5188e66f08f3c6cf449f8bc61feb6aac829d37c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "104218103"
---
# <a name="property-handler-best-practices-and-faq"></a><span data-ttu-id="345e4-103">Bewährte Methoden und häufig gestellte Fragen zu Eigenschaften Handlern</span><span class="sxs-lookup"><span data-stu-id="345e4-103">Property Handler Best Practices and FAQ</span></span>

<span data-ttu-id="345e4-104">In diesem Thema wird erläutert, wie Sie Eigenschafts Handler erstellen und registrieren, um mit dem Windows-Eigenschaften System zu arbeiten.</span><span class="sxs-lookup"><span data-stu-id="345e4-104">This topic explains how to create and register property handlers to work with the Windows property system.</span></span>

<span data-ttu-id="345e4-105">Dieses Thema ist wie folgt organisiert:</span><span class="sxs-lookup"><span data-stu-id="345e4-105">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="345e4-106">Bewährte Methoden</span><span class="sxs-lookup"><span data-stu-id="345e4-106">Best Practices</span></span>](#property-handler-best-practices-and-faq)
    -   [<span data-ttu-id="345e4-107">Überschreiben von Datei System Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="345e4-107">Overriding File System Properties</span></span>](#overriding-file-system-properties)
    -   [<span data-ttu-id="345e4-108">Speichern von Eigenschaften in XML-basierten Dateiformaten</span><span class="sxs-lookup"><span data-stu-id="345e4-108">Storing Properties in XML-based File Formats</span></span>](#storing-properties-in-xml-based-file-formats)
    -   [<span data-ttu-id="345e4-109">Berechnete Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="345e4-109">Computed Properties</span></span>](#computed-properties)
-   [<span data-ttu-id="345e4-110">Häufig gestellte Fragen</span><span class="sxs-lookup"><span data-stu-id="345e4-110">Frequently Asked Questions</span></span>](#property-handler-best-practices-and-faq)
-   [<span data-ttu-id="345e4-111">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="345e4-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="345e4-112">Bewährte Methoden</span><span class="sxs-lookup"><span data-stu-id="345e4-112">Best Practices</span></span>

<span data-ttu-id="345e4-113">Die hier beschriebenen bewährten Methoden bieten nützliche Implementierungs Tipps.</span><span class="sxs-lookup"><span data-stu-id="345e4-113">The best practices outlined here provide useful implementation tips.</span></span>

### <a name="overriding-file-system-properties"></a><span data-ttu-id="345e4-114">Überschreiben von Datei System Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="345e4-114">Overriding File System Properties</span></span>

<span data-ttu-id="345e4-115">Einige Eigenschaften für Dateien werden von der Dateisystem-Datenquelle bereitgestellt, wie z. b.:</span><span class="sxs-lookup"><span data-stu-id="345e4-115">Some properties for files are provided by the file system data source, such as:</span></span>

-   <span data-ttu-id="345e4-116">Pkey \_ filename</span><span class="sxs-lookup"><span data-stu-id="345e4-116">PKEY\_FileName</span></span>
-   <span data-ttu-id="345e4-117">Pkey- \_ Erweiterung</span><span class="sxs-lookup"><span data-stu-id="345e4-117">PKEY\_Extension</span></span>
-   <span data-ttu-id="345e4-118">Pkey- \_ Modifizierungszeit</span><span class="sxs-lookup"><span data-stu-id="345e4-118">PKEY\_ModifiedTime</span></span>

<span data-ttu-id="345e4-119">Im Allgemeinen können Eigenschaften Handler keine Werte für diese Eigenschaften bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="345e4-119">In general, property handlers cannot provide values for these properties.</span></span> <span data-ttu-id="345e4-120">In einigen Fällen können diese Eigenschaften jedoch auf der Grundlage von Registrierungsinformationen überschrieben werden, die vom Eigenschaften Handler bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="345e4-120">However, in some cases these properties can be overridden based on registration information provided by the property handler.</span></span> <span data-ttu-id="345e4-121">Eigenschafts Handler füllen die **HKEY- \_ Klassen \_ root** \\ **CLSID** \\ *{Handler CLSID}* \\ **overridefilesystemproperties** mit den Namen von Eigenschaften auf, die Sie überschreiben möchten.</span><span class="sxs-lookup"><span data-stu-id="345e4-121">Property handlers populate **HKEY\_CLASSES\_ROOT**\\**CLSID**\\ *{handler clsid}*\\**OverrideFileSystemProperties** with the names of properties that they want to override.</span></span> <span data-ttu-id="345e4-122">Dies ist auf einen festgelegten Satz von Eigenschaften beschränkt, der in der folgenden Liste angezeigt wird, in der das System über Kenntnisse verfügt.</span><span class="sxs-lookup"><span data-stu-id="345e4-122">This is limited to a fixed set of properties shown in the following list of which the system has knowledge.</span></span>

<span data-ttu-id="345e4-123">Das Überschreiben wird für die folgenden Eigenschaftswerte unterstützt:</span><span class="sxs-lookup"><span data-stu-id="345e4-123">Overriding is supported for the following property values:</span></span>

-   [<span data-ttu-id="345e4-124">System. Kind</span><span class="sxs-lookup"><span data-stu-id="345e4-124">System.Kind</span></span>](./props-system-kind.md)
-   [<span data-ttu-id="345e4-125">System. filename</span><span class="sxs-lookup"><span data-stu-id="345e4-125">System.FileName</span></span>](./props-system-filename.md)
-   [<span data-ttu-id="345e4-126">System. ispinnedtonamespacetree</span><span class="sxs-lookup"><span data-stu-id="345e4-126">System.IsPinnedToNameSpaceTree</span></span>](./props-system-ispinnedtonamespacetree.md)
-   [<span data-ttu-id="345e4-127">System.ItemNameDisplay</span><span class="sxs-lookup"><span data-stu-id="345e4-127">System.ItemNameDisplay</span></span>](./props-system-itemnamedisplay.md)
-   [<span data-ttu-id="345e4-128">System. sfgaoflags</span><span class="sxs-lookup"><span data-stu-id="345e4-128">System.SFGAOFlags</span></span>](./props-system-sfgaoflags.md)
-   [<span data-ttu-id="345e4-129">System. itempathdisplay</span><span class="sxs-lookup"><span data-stu-id="345e4-129">System.ItemPathDisplay</span></span>](./props-system-itempathdisplay.md)
-   [<span data-ttu-id="345e4-130">System. itempathdisplaynarrow</span><span class="sxs-lookup"><span data-stu-id="345e4-130">System.ItemPathDisplayNarrow</span></span>](./props-system-itempathdisplaynarrow.md)
-   [<span data-ttu-id="345e4-131">System. itemfoldernamedisplay</span><span class="sxs-lookup"><span data-stu-id="345e4-131">System.ItemFolderNameDisplay</span></span>](./props-system-itemfoldernamedisplay.md)
-   [<span data-ttu-id="345e4-132">System. itemfolderpathdisplay</span><span class="sxs-lookup"><span data-stu-id="345e4-132">System.ItemFolderPathDisplay</span></span>](./props-system-itemfolderpathdisplay.md)
-   [<span data-ttu-id="345e4-133">System. itemfolderpathdisplaynarrow</span><span class="sxs-lookup"><span data-stu-id="345e4-133">System.ItemFolderPathDisplayNarrow</span></span>](./props-system-itemfolderpathdisplaynarrow.md)

<span data-ttu-id="345e4-134">Eine vollständige Liste aller Shelleigenschaften finden Sie unter [Shelleigenschaften](./props.md).</span><span class="sxs-lookup"><span data-stu-id="345e4-134">For a full list of all Shell properties, see [Shell Properties](./props.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="345e4-135">Die überschriebenen Eigenschaftswerte werden nur verwendet, wenn die Dateien indiziert werden.</span><span class="sxs-lookup"><span data-stu-id="345e4-135">The overridden property values are used only when the files are indexed.</span></span> <span data-ttu-id="345e4-136">Folglich werden durch das Durchsuchen von Dateien aus der Dateisystem-Datenquelle die überschriebenen Werte nicht offengelegt.</span><span class="sxs-lookup"><span data-stu-id="345e4-136">Thus, browsing files from the file system data source does not reveal the overridden values.</span></span>

 

### <a name="storing-properties-in-xml-based-file-formats"></a><span data-ttu-id="345e4-137">Speichern von Eigenschaften in XML-basierten Dateiformaten</span><span class="sxs-lookup"><span data-stu-id="345e4-137">Storing Properties in XML-based File Formats</span></span>

<span data-ttu-id="345e4-138">Es stehen zwei grundlegende Optionen zum Speichern von Eigenschaften in XML-basierten Dateiformaten zur Verfügung:</span><span class="sxs-lookup"><span data-stu-id="345e4-138">There are two basic options available for storing properties in XML-based file formats:</span></span>

-   <span data-ttu-id="345e4-139">Speichern Sie jede Eigenschaft gemäß dem XML-Schema des Dokuments mithilfe von XML-Elementen und Attributen.</span><span class="sxs-lookup"><span data-stu-id="345e4-139">Store each property using XML elements and attributes according to the XML schema of the document.</span></span> <span data-ttu-id="345e4-140">Diese Vorgehensweise ist eher "XML-freundlich".</span><span class="sxs-lookup"><span data-stu-id="345e4-140">This approach is more "XML friendly".</span></span>
-   <span data-ttu-id="345e4-141">Serialisieren Sie den gesamten Eigenschafts Speicher in ein BLOB (Binary Large Object), konvertieren Sie das BLOB in eine Base64-codierte Zeichenfolge, und speichern Sie diese Zeichenfolge dann in der XML-Datei.</span><span class="sxs-lookup"><span data-stu-id="345e4-141">Serialize the entire property store into a memory Binary large object (BLOB), convert the BLOB into a base64-encoded string, and then store that string in the XML.</span></span> <span data-ttu-id="345e4-142">Dies ist die einfachere der beiden Ansätze und kann verwendet werden, um Unterstützung für geöffnete Metadaten zu bieten.</span><span class="sxs-lookup"><span data-stu-id="345e4-142">This is the simpler of the two approaches and can be used to trivially provide support for open metadata.</span></span>

<span data-ttu-id="345e4-143">Einige Handler können diese Ansätze kombinieren und einige wichtige Werte im XML-Standardformat speichern und den Rest beispielsweise in einem BLOB speichern.</span><span class="sxs-lookup"><span data-stu-id="345e4-143">Some handlers might combine these approaches, storing some important values in standard XML format and storing the rest in a BLOB, for example.</span></span>

### <a name="computed-properties"></a><span data-ttu-id="345e4-144">Berechnete Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="345e4-144">Computed Properties</span></span>

<span data-ttu-id="345e4-145">Einige Eigenschaften werden von bestimmten Attributen einer Datei abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="345e4-145">Some properties are derived from specific attributes of a file.</span></span> <span data-ttu-id="345e4-146">Die [System. Image. Dimensions](./props-system-image-dimensions.md) -Eigenschaft wird z. b. durch die tatsächlichen Dimensionen des Bilds in einer Bilddatei bestimmt.</span><span class="sxs-lookup"><span data-stu-id="345e4-146">For example, the [System.Image.Dimensions](./props-system-image-dimensions.md) property is determined by the actual dimensions of the image in an image file.</span></span> <span data-ttu-id="345e4-147">Da diese Eigenschaftswerte nicht durch den Eigenschaften Handler geändert werden können, werden Sie `isInnate="true"` in der Eigenschafts Beschreibung gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="345e4-147">Because such property values cannot be changed by the property handler, they are thus marked `isInnate="true"` in the property description.</span></span> <span data-ttu-id="345e4-148">Andere Eigenschaften werden aus einem Teil einer bestimmten Eigenschaft oder durch aggregierten der Werte mehrerer Eigenschaften berechnet.</span><span class="sxs-lookup"><span data-stu-id="345e4-148">Other properties are computed from a part of a specific property or by aggregating the values of multiple properties.</span></span> <span data-ttu-id="345e4-149">Da Updates für diese "berechneten" Eigenschaften zu einer Mehrdeutigkeit bei der Änderung der "Source"-Werte führen, sollten berechnete Eigenschaften `isInnate="true"` in der Eigenschafts Beschreibung gekennzeichnet oder als schreibgeschützt gemeldet werden.</span><span class="sxs-lookup"><span data-stu-id="345e4-149">Because updates to these "computed" properties would create ambiguity as to how the "source" values should be changed, computed properties should be marked `isInnate="true"` in the property description or reported as read-only.</span></span> <span data-ttu-id="345e4-150">Die zweite Option ist verfügbar, indem der Handler angewiesen wird, S \_ false aus [**ipropertystorecapabili:: ispropertywrite Table**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable)zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="345e4-150">The latter option is available by instructing the handler to return S\_FALSE from [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="345e4-151">Häufig gestellte Fragen</span><span class="sxs-lookup"><span data-stu-id="345e4-151">Frequently Asked Questions</span></span>

<span data-ttu-id="345e4-152">In diesem Abschnitt finden Sie Antworten auf häufig gestellte Fragen zu Eigenschaften und Eigenschaften Handlern sowie begleitende Antworten.</span><span class="sxs-lookup"><span data-stu-id="345e4-152">This section provides answers to frequently asked questions about properties and property handlers, and accompanying answers.</span></span>

-   <span data-ttu-id="345e4-153">**Frage:** Warum wird mein Eigenschaftenhandler nicht vom Windows Search-Indexer geladen?</span><span class="sxs-lookup"><span data-stu-id="345e4-153">**Question:** Why isn't my property handler being loaded by the Windows Search indexer?</span></span>

    <span data-ttu-id="345e4-154">Der Indexer für Windows-Suche wird als Systemdienst ausgeführt und kann keine DLLs laden, die im Benutzerprofil Verzeichnis gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="345e4-154">The Windows Search indexer runs as a system service and cannot load DLLs that are stored in the user profile directory.</span></span> <span data-ttu-id="345e4-155">Wenn Sie mit Microsoft Visual Studio erstellen und Debuggen, wird die dll in Ihrem Benutzerprofil abgelegt (und wird daher nicht vom Indexer geladen).</span><span class="sxs-lookup"><span data-stu-id="345e4-155">If you are building and debugging using Microsoft Visual Studio, it will place the DLL in your user profile (and therefore it won't be loaded by the indexer).</span></span> <span data-ttu-id="345e4-156">Um dieses Problem zu umgehen, kopieren Sie die dll außerhalb Ihres Profilordners (z. **b. in C: \\ Programme \\ yourappname**), und registrieren Sie Sie dort.</span><span class="sxs-lookup"><span data-stu-id="345e4-156">To work around this, copy your DLL outside of your profile folder (for example, into **C:\\Program Files\\YourAppName**) and register it there.</span></span>

    <span data-ttu-id="345e4-157">Genauere Anleitungen zum Entwickeln von Eigenschaften Handlern für die Verwendung des Windows Search-Indexers finden Sie unter [entwickeln von Eigenschaften Handlern für Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="345e4-157">For more specific guidance on developing property handlers to work with the Windows Search indexer, see [Developing Property Handlers for Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span></span>

-   <span data-ttu-id="345e4-158">**Frage:** Welche Eigenschaften sollten über die Enumerationsmethoden [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) und [**IPropertyStore:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) gefunden werden?</span><span class="sxs-lookup"><span data-stu-id="345e4-158">**Question:** Which properties should be discoverable through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) enumeration methods?</span></span>

    <span data-ttu-id="345e4-159">Nicht alle Clients von Eigenschaften Speicher Objekten verwenden diese Methoden.</span><span class="sxs-lookup"><span data-stu-id="345e4-159">Not all clients of property store objects use these methods.</span></span> <span data-ttu-id="345e4-160">Einige Clients sind mit den Eigenschaften vertraut, die Sie direkt (anhand des pkey-namens) anfordern möchten, oder Sie erhalten Eigenschafts Informationen über eine Eigenschaften Beschreibungs Liste.</span><span class="sxs-lookup"><span data-stu-id="345e4-160">Some clients are aware of the properties they plan to request directly (by PKEY name), or receive property information through a property description list.</span></span> <span data-ttu-id="345e4-161">Die Eigenschaften Ermittlungsmethoden unterstützten verschiedene andere Szenarien.</span><span class="sxs-lookup"><span data-stu-id="345e4-161">The property discovery methods suppport several other scenarios.</span></span> <span data-ttu-id="345e4-162">Wenn eine Eigenschaft nicht an diesen Szenarien teilnehmen muss, muss Sie nicht aufgezählt werden.</span><span class="sxs-lookup"><span data-stu-id="345e4-162">If a property does not need to participate in these scenarios, it does not need to be enumerated.</span></span> <span data-ttu-id="345e4-163">Daher kann ein Eigenschaften Handler einen nicht-VT- \_ Wert für Eigenschaften, die nicht durch die [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) -Methode und die [**IPropertyStore:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) -Methode ermittelt werden, als nicht-VT-Wert ausgeben.</span><span class="sxs-lookup"><span data-stu-id="345e4-163">Hence, a property handler can produce a non-VT\_EMPTY value for properties that are not discovered through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span>

    <span data-ttu-id="345e4-164">Eigenschaften sollten jedoch über diese Methoden sichtbar sein, wenn eine der folgenden Bedingungen erfüllt ist:</span><span class="sxs-lookup"><span data-stu-id="345e4-164">However, properties should be visible via these methods if any of the following conditions are met:</span></span>

    -   <span data-ttu-id="345e4-165">**Wenn die Eigenschaft indiziert ist, sodass Sie durchsuchbar ist:** Dies bedeutet, dass Sie in den Windows Search-Eigenschaften Speicher (angegeben durch `isColumn = "true"` im Eigenschafts Beschreibungs Schema) oder für voll Text suchen ( `inInvertedIndex = "true"` ) enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="345e4-165">**If the property is indexed so that it is searchable:** This means it is included in the Windows Search property store (denoted by `isColumn = "true"` in the property description schema) or available for full text searches (`inInvertedIndex = "true"`).</span></span> <span data-ttu-id="345e4-166">Wenn diese Flags fehlen oder keine Eigenschafts Beschreibung vorhanden ist, werden die Eigenschaften des Typs "String" automatisch dem umgekehrten Index hinzugefügt, um die Suche zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="345e4-166">In the absence of these flags or the absence of a property description, properties of type "string" will be added automatically to the inverted index to enable searching.</span></span> <span data-ttu-id="345e4-167">Da die Liste bekannter Eigenschaften (mit Beschreibungen der installierten Eigenschaften) im Eigenschaften System sehr groß ist (mehr als 800 Eigenschaften), wäre es unpraktisch, jeden Eigenschaften Handler für jede im Eigenschaften System registrierte Eigenschaft zu Fragen.</span><span class="sxs-lookup"><span data-stu-id="345e4-167">Because the list of known properties (those with installed property descriptions) in the property system is very large (more than 800 properties), it would be impractical to ask every property handler for every property registered in the property system.</span></span> <span data-ttu-id="345e4-168">Stattdessen zählt der Indizierungsprozess die relevanten Eigenschaften aus dem Eigenschaften Handler für jedes Element auf, das er indiziert, und verwendet die Werte der enumerationseigenschaften, um den Volltextindex zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="345e4-168">Instead, the indexing process enumerates the relevant properties from the property handler for each item it indexes, and it uses the values of the enumerated properties to build the full text index.</span></span>
    -   <span data-ttu-id="345e4-169">**Wenn die Eigenschaft kopiert werden soll, wenn der Eigenschaften Satz des Elements dupliziert wird:** Um die Funktion "Eigenschaften Satz kopieren" zu implementieren, werden die Eigenschaften, die kopiert werden sollen, durch die [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) -Methode und die [**IPropertyStore:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) -Methode sichtbar.</span><span class="sxs-lookup"><span data-stu-id="345e4-169">**If the property should be copied when the item's property set is duplicated:** To implement a "copy a property set" function, the source item makes the properties that should be copied visible through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span> <span data-ttu-id="345e4-170">Eigenschaften, die nicht kopiert werden müssen oder nicht sinnvoll sind, sollten nicht eingeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="345e4-170">Properties that do not need to be copied or do not make sense being copied should not be included.</span></span>
    -   <span data-ttu-id="345e4-171">**Wenn der Eigenschafts Wert nicht leer ist (VT \_ Empty):** Eigenschaftswerte, die leer sind, sind für Clients nicht nützlich.</span><span class="sxs-lookup"><span data-stu-id="345e4-171">**If the property value is not empty (VT\_EMPTY):** Property values that are empty are not useful for clients.</span></span> <span data-ttu-id="345e4-172">Wenn Clients versuchen, leere Eigenschaftswerte zurückzugeben, wird der Wert "VT \_ empty" zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="345e4-172">When clients attempt to return empty property values, a value of VT\_EMPTY is returned.</span></span> <span data-ttu-id="345e4-173">Daher sollten Eigenschaften mit leeren Werten nicht aufgezählt werden.</span><span class="sxs-lookup"><span data-stu-id="345e4-173">Thus, properties with empty values should not be enumerated.</span></span>
    -   <span data-ttu-id="345e4-174">**Wenn die Eigenschaft entfernt werden soll, wenn die Funktion "Remove Properties" aufgerufen wird:** Diese Funktion ist zum Schutz des Datenschutzes vorhanden. er ermittelt alle Werte aus dem Eigenschafts Handler über die Enumeration und entfernt alle, die vom Benutzer zum Entfernen ausgewählt wurden.</span><span class="sxs-lookup"><span data-stu-id="345e4-174">**If the property should be removed when invoking the "remove properties" function:** This feature exists to protect privacy; it discovers all values from the property handler through enumeration and removes each one selected for removal by the user.</span></span>
        > [!Note]  
        > <span data-ttu-id="345e4-175">Beim Aufzählen von Eigenschaften wird die Gruppe von Eigenschaften, die von einem bestimmten Eigenschaften Handler unterstützt werden, nicht kommuniziert, wenn der Handler ein festes Schema (und nicht geöffnete Metadaten) unterstützt.</span><span class="sxs-lookup"><span data-stu-id="345e4-175">Enumerating properties does not communicate the set of properties that a particular property handler supports if the handler supports a fixed schema (and not open metadata).</span></span> <span data-ttu-id="345e4-176">Stattdessen sollten solche Handler den Satz von Eigenschaften dokumentieren, die Sie unterstützen.</span><span class="sxs-lookup"><span data-stu-id="345e4-176">Instead, such handlers should document the set of properties that they support.</span></span>

         

-   <span data-ttu-id="345e4-177">**Frage:** Gewusst wie Sie wissen, welche Dateiformate offene Metadaten unterstützen?</span><span class="sxs-lookup"><span data-stu-id="345e4-177">**Question:** How do I know which file formats support open metadata?</span></span>

    <span data-ttu-id="345e4-178">Weitere Informationen zur Unterstützung offener Metadaten finden Sie unter "Dateitypen, die offene Metadaten unterstützen" in [Dateitypen](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="345e4-178">For information about support for open metadata, see "File Types that Support Open Metadata" in [File Types](../shell/fa-file-types.md).</span></span>

-   <span data-ttu-id="345e4-179">**Frage:** Können VT \_ NULL-Werte mithilfe eines Eigenschaften Handlers gespeichert werden?</span><span class="sxs-lookup"><span data-stu-id="345e4-179">**Question:** Can VT\_NULL values be stored using a property handler?</span></span>

    <span data-ttu-id="345e4-180">Nein.</span><span class="sxs-lookup"><span data-stu-id="345e4-180">No.</span></span> <span data-ttu-id="345e4-181">\_Die NULL-Werte von VT werden \_ bei Aufrufen von [**IPropertyStore:: GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) und [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85))in VT Empty konvertiert.</span><span class="sxs-lookup"><span data-stu-id="345e4-181">VT\_NULL values will be converted to VT\_EMPTY on calls to [**IPropertyStore::GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) and [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="345e4-182">**Frage:** Welche Datums Zeichen folgen Formate werden von der [**propvariantchangetype**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) -Funktion unterstützt?</span><span class="sxs-lookup"><span data-stu-id="345e4-182">**Question:** Which date string formats are supported by the [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) function?</span></span>

    <span data-ttu-id="345e4-183">Im Allgemeinen sollten Eigenschaften, die Datums-/Uhrzeitwerte darstellen, mithilfe von VT \_ FILETIME dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="345e4-183">Generally, properties that represent date/time values should be represented using VT\_FILETIME.</span></span> <span data-ttu-id="345e4-184">Viele Datenquellen stellen diese Informationen jedoch in Form von Zeichen folgen dar.</span><span class="sxs-lookup"><span data-stu-id="345e4-184">However, many data sources provide this information in string form.</span></span> <span data-ttu-id="345e4-185">Die hilfsapi [**propvariantchangetype**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) unterstützt das Umwandeln einiger Zeichen folgen Datumsformate in [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) -Werte, wie in der folgenden Tabelle gezeigt.</span><span class="sxs-lookup"><span data-stu-id="345e4-185">The [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) helper API supports coercing some string date formats into [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) values, as shown in the following table.</span></span>

    

    | <span data-ttu-id="345e4-186">Format</span><span class="sxs-lookup"><span data-stu-id="345e4-186">Format</span></span>                  | <span data-ttu-id="345e4-187">Windows Vista, Windows XP und Microsoft Windows-Desktop Suche (WDS)</span><span class="sxs-lookup"><span data-stu-id="345e4-187">Windows Vista, Windows XP, and Microsoft Windows Desktop Search (WDS)</span></span> | <span data-ttu-id="345e4-188">Windows 7</span><span class="sxs-lookup"><span data-stu-id="345e4-188">Windows 7</span></span> | <span data-ttu-id="345e4-189">Notizen</span><span class="sxs-lookup"><span data-stu-id="345e4-189">Notes</span></span>                                                                                                                                                                                                 |
    |-------------------------|-----------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="345e4-190">yyyy/mm/dd: hh: mm: SS. uuu</span><span class="sxs-lookup"><span data-stu-id="345e4-190">yyyy/mm/dd:hh:mm:ss.uuu</span></span> | <span data-ttu-id="345e4-191">Ja</span><span class="sxs-lookup"><span data-stu-id="345e4-191">Yes</span></span>                                                                   | <span data-ttu-id="345e4-192">Ja</span><span class="sxs-lookup"><span data-stu-id="345e4-192">Yes</span></span>       | <span data-ttu-id="345e4-193">UTC y = Jahr, m = Monat, d = Datum, h = Stunden (24-Stunden-Takt), m = Minuten, s = Sekunden, u = Mikrosekunden</span><span class="sxs-lookup"><span data-stu-id="345e4-193">UTC; y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds, u=microseconds</span></span>                                                                                                           |
    | <span data-ttu-id="345e4-194">yyyy-mm-ddThh: mm: SSZ</span><span class="sxs-lookup"><span data-stu-id="345e4-194">yyyy-mm-ddThh:mm:ssZ</span></span>    | <span data-ttu-id="345e4-195">Nein</span><span class="sxs-lookup"><span data-stu-id="345e4-195">No</span></span>                                                                    | <span data-ttu-id="345e4-196">Ja</span><span class="sxs-lookup"><span data-stu-id="345e4-196">Yes</span></span>       | <span data-ttu-id="345e4-197">**ISO8601-Format Spezifikation** UTC (angegeben durch den "Z"-Zeit Zonen Indikator); y = Jahr, m = Monat, d = Datum, h = Stunden (24-Stunden-Takt), m = Minuten, s = Sekunden; 'T ' ist ein Trennzeichen für den Uhrzeit Teil.</span><span class="sxs-lookup"><span data-stu-id="345e4-197">**ISO8601 format specification** UTC (denoted by 'Z' time zone indicator); y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds; 'T' is a delimiter for the time portion.</span></span><br/> |

    

     

-   <span data-ttu-id="345e4-198">**Frage:** Ist es möglich, einen schreibgeschützten Eigenschaften Handler zu erstellen?</span><span class="sxs-lookup"><span data-stu-id="345e4-198">**Question:** Is it possible to create a read-only property handler?</span></span>

    <span data-ttu-id="345e4-199">Ja.</span><span class="sxs-lookup"><span data-stu-id="345e4-199">Yes.</span></span> <span data-ttu-id="345e4-200">Einige eigenschaftenhandlerimplementierungen unterstützen nicht das Schreiben von Eigenschafts Werten.</span><span class="sxs-lookup"><span data-stu-id="345e4-200">Some property handler implementations do not support writing of property values.</span></span> <span data-ttu-id="345e4-201">Diese Eigenschaften Handler sollten STGM \_ E \_ AccessDenied bei Aufrufen von **iinitializexxx:: Initialize** zurückgeben, die "STGM- \_ Lese schreiben" oder bei jedem Aufruf von " [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85))" übergeben.</span><span class="sxs-lookup"><span data-stu-id="345e4-201">These property handlers should return STGM\_E\_ACCESSDENIED on calls to **IInitializeXXX::Initialize** that pass STGM\_READWRITE, or on any call to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

    <span data-ttu-id="345e4-202">Alle im STGM-Lesemodus geöffneten Eigenschaften Handler \_ sollten \_ \_ bei Aufrufen von [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85))STGM E AccessDenied zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="345e4-202">All property handlers opened in STGM\_READ mode should return STGM\_E\_ACCESSDENIED on calls to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="345e4-203">**Frage:** Kann ein Eigenschaften Handler eine Eigenschaft als schreibgeschützt behandeln, auch wenn das Schema angibt, dass die Eigenschaft beschreibbar ist?</span><span class="sxs-lookup"><span data-stu-id="345e4-203">**Question:** Can a property handler treat a property as read-only, even if the schema indicates that the property is writeable?</span></span>

    <span data-ttu-id="345e4-204">Ja.</span><span class="sxs-lookup"><span data-stu-id="345e4-204">Yes.</span></span> <span data-ttu-id="345e4-205">Im Schema System werden Eigenschaften schreibgeschützt (einschließlich derjenigen mit `isInnate = "true"` ) oder Lese-/Schreibzugriff.</span><span class="sxs-lookup"><span data-stu-id="345e4-205">In the schema system, properties are annotated as read-only (including those with `isInnate = "true"`) or read/write.</span></span> <span data-ttu-id="345e4-206">Eigenschaften Handler, die das Schreiben einer bestimmten Eigenschaft, die das Schema besagt, nicht unterstützen, sollten [**ipropertystorecapabilitäten**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) implementieren und \_ bei Aufrufen von [**ipropertystorecapabili:: ispropertywritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) für diese Eigenschaft den Wert "false" zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="345e4-206">Property handlers that do not support writing a particular property that the schema says should be writeable should implement [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) and return S\_FALSE on calls to [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) for that property.</span></span> <span data-ttu-id="345e4-207">Dies gibt an, dass die Eigenschaft im Kontext dieses Handlers und dieser Datei nicht beschreibbar ist.</span><span class="sxs-lookup"><span data-stu-id="345e4-207">This indicates that in the context of this handler and this file, the property is not writeable.</span></span>

    > [!Note]  
    > <span data-ttu-id="345e4-208">Die umgekehrte Aktion ist nicht möglich.</span><span class="sxs-lookup"><span data-stu-id="345e4-208">The reverse action is not possible.</span></span> <span data-ttu-id="345e4-209">Sie können einen Eigenschafts Handler nicht aktivieren, um eine Eigenschaft zu schreiben, die im Schema als schreibgeschützt gekennzeichnet ist.</span><span class="sxs-lookup"><span data-stu-id="345e4-209">You cannot enable a property handler to write a property that is marked as read-only in the schema</span></span>

     

## <a name="related-topics"></a><span data-ttu-id="345e4-210">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="345e4-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="345e4-211">Grundlegendes zu Eigenschaften Handlern</span><span class="sxs-lookup"><span data-stu-id="345e4-211">Understanding Property Handlers</span></span>](./building-property-handlers-properties.md)
</dt> <dt>

[<span data-ttu-id="345e4-212">Verwenden von Kind-Namen</span><span class="sxs-lookup"><span data-stu-id="345e4-212">Using Kind Names</span></span>](./building-property-handlers-user-friendly-kind-names.md)
</dt> <dt>

[<span data-ttu-id="345e4-213">Verwenden von Eigenschaften Listen</span><span class="sxs-lookup"><span data-stu-id="345e4-213">Using Property Lists</span></span>](./building-property-handlers-property-lists.md)
</dt> <dt>

[<span data-ttu-id="345e4-214">Initialisieren von Eigenschaften Handlern</span><span class="sxs-lookup"><span data-stu-id="345e4-214">Initializing Property Handlers</span></span>](./building-property-handlers-property-handlers.md)
</dt> <dt>

[<span data-ttu-id="345e4-215">Registrieren und Verteilen von Eigenschaften Handlern</span><span class="sxs-lookup"><span data-stu-id="345e4-215">Registering and Distributing Property Handlers</span></span>](./prophand-reg-dist.md)
</dt> </dl>

 

 
