---
description: Das Windows-Eigenschaften System ist ein erweiterbares Lese-/Schreibsystem mit Daten Definitionen, das eine einheitliche Methode zum Ausdrücken von Metadaten über shellelemente bietet.
ms.assetid: eb2dc2be-fc53-40aa-81f6-f353ab1d3a57
title: Übersicht über das Eigenschaftensystem
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dab3a17eacdbaa9a5d0255004ba544b7c3f7ff2b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106347086"
---
# <a name="property-system-overview"></a><span data-ttu-id="5731e-103">Übersicht über das Eigenschaftensystem</span><span class="sxs-lookup"><span data-stu-id="5731e-103">Property System Overview</span></span>

<span data-ttu-id="5731e-104">Das Windows-Eigenschaften System ist ein erweiterbares Lese-/Schreibsystem mit Daten Definitionen, das eine einheitliche Methode zum Ausdrücken von Metadaten über shellelemente bietet.</span><span class="sxs-lookup"><span data-stu-id="5731e-104">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="5731e-105">Mit dem Windows-Eigenschaften System in Windows Vista und höher können Sie Metadaten für shellelemente speichern und abrufen.</span><span class="sxs-lookup"><span data-stu-id="5731e-105">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="5731e-106">Ein shellelement ist ein beliebiges einzelnes Element, z. b. eine Datei, ein Ordner, eine e-Mail oder ein Kontakt.</span><span class="sxs-lookup"><span data-stu-id="5731e-106">A Shell item is any single piece of content, such as a file, folder, email, or contact.</span></span> <span data-ttu-id="5731e-107">Eine Eigenschaft ist ein einzelner Metadatenelement, das einem shellelement zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="5731e-107">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="5731e-108">Eigenschaftswerte werden als [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) -Struktur ausgedrückt.</span><span class="sxs-lookup"><span data-stu-id="5731e-108">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="5731e-109">Dieses Thema ist wie folgt organisiert:</span><span class="sxs-lookup"><span data-stu-id="5731e-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="5731e-110">Introduction (Einführung)</span><span class="sxs-lookup"><span data-stu-id="5731e-110">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="5731e-111">Entwicklungsszenarien</span><span class="sxs-lookup"><span data-stu-id="5731e-111">Development Scenarios</span></span>](#development-scenarios)
-   [<span data-ttu-id="5731e-112">Eigenschaften und Windows Search</span><span class="sxs-lookup"><span data-stu-id="5731e-112">Properties and Windows Search</span></span>](#properties-and-windows-search)
-   [<span data-ttu-id="5731e-113">Hinweis für Implementierer</span><span class="sxs-lookup"><span data-stu-id="5731e-113">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="5731e-114">Dokumentation zu Windows-Eigenschaften System</span><span class="sxs-lookup"><span data-stu-id="5731e-114">Windows Property System Documentation</span></span>](#windows-property-system-documentation)
-   [<span data-ttu-id="5731e-115">Weitere Ressourcen</span><span class="sxs-lookup"><span data-stu-id="5731e-115">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="5731e-116">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="5731e-116">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="5731e-117">Einführung</span><span class="sxs-lookup"><span data-stu-id="5731e-117">Introduction</span></span>

<span data-ttu-id="5731e-118">Eigenschaften werden durch ihren kanonischen Namen (z. b. `System.Document.LastAuthor` ) und den Eigenschafts Schlüssel (z `PKEY_Document_LastAuthor` . b.) eindeutig identifiziert.</span><span class="sxs-lookup"><span data-stu-id="5731e-118">Properties are uniquely identified by their canonical name (such as `System.Document.LastAuthor`) and property key (such as `PKEY_Document_LastAuthor`).</span></span> <span data-ttu-id="5731e-119">Ein Eigenschafts Schlüssel (pkey) ist der Namensteil eines Name-Wert-Paars, der aus einem pkey/PROPVARIANT-oder einer String/PROPVARIANT besteht, wobei die Zeichenfolge der kanonische Name des pkey (z `System.Document.LastAuthor` . b.) ist.</span><span class="sxs-lookup"><span data-stu-id="5731e-119">A property key (PKEY) is the name portion of a name-value pair that consists of a PKEY/PROPVARIANT or a string/PROPVARIANT, where the string is the canonical name of the PKEY (such as `System.Document.LastAuthor`).</span></span> <span data-ttu-id="5731e-120">Bei einem pkey handelt es sich um eine Definition, die dem Eigenschaften System alle Informationen über die Eigenschaft mitteilt, während der Wert eine tatsächliche Instanz der Eigenschaft ist.</span><span class="sxs-lookup"><span data-stu-id="5731e-120">A PKEY is a definition that tells the property system everything it needs to know about the property, whereas the value is an actual instance of the property.</span></span> <span data-ttu-id="5731e-121">Ein pkey enthält intern eine FormatID und PROPID.</span><span class="sxs-lookup"><span data-stu-id="5731e-121">A PKEY internally contains a formatID and propID.</span></span>

<span data-ttu-id="5731e-122">Eine einzelne Eigenschaft besteht aus den folgenden drei Teilen:</span><span class="sxs-lookup"><span data-stu-id="5731e-122">An individual property consists of the following three pieces:</span></span>

-   <span data-ttu-id="5731e-123">Ein kanonischer Name, z `System.Music.Artist` . b..</span><span class="sxs-lookup"><span data-stu-id="5731e-123">A canonical name, such as `System.Music.Artist`.</span></span>
-   <span data-ttu-id="5731e-124">Eine Schema Beschreibung, die im XML-Dateiformat. PropDesc angegeben und Programm gesteuert über [**ipropertydescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription)ausgedrückt wird.</span><span class="sxs-lookup"><span data-stu-id="5731e-124">A schema description, which is specified in the .propdesc XML file format and expressed programmatically through [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span></span>
-   <span data-ttu-id="5731e-125">Ein-Wert, z. b. der Name eines Sängers.</span><span class="sxs-lookup"><span data-stu-id="5731e-125">A value, such as the name of a singer.</span></span>

<span data-ttu-id="5731e-126">Die Schema Beschreibung besteht aus Informationen über die Eigenschaft, z. b. den Eigenschaftsnamen, den Datentyp, Einschränkungen, Informationen darüber, wie die Eigenschaft mit Sichten und dem Suchsystem interagiert, usw.</span><span class="sxs-lookup"><span data-stu-id="5731e-126">The schema description consists of information about the property, such as the property name, data type, constraints, information on how the property interacts with views and the search system, and so forth.</span></span> <span data-ttu-id="5731e-127">Der Name und die Schema Beschreibung werden global definiert und sind für alle Elemente und Typen identisch.</span><span class="sxs-lookup"><span data-stu-id="5731e-127">The name and schema description are defined globally, and are the same for all items and types.</span></span> <span data-ttu-id="5731e-128">Ein-Wert ist spezifisch für ein einzelnes Element.</span><span class="sxs-lookup"><span data-stu-id="5731e-128">A value is specific to an individual item.</span></span> <span data-ttu-id="5731e-129">Das heißt, die `System.Music.Artist` Eigenschaft wird immer als mehrwertige Zeichenfolge definiert, kann jedoch für jedes Element einen anderen Wert (oder gar keinen Wert) haben.</span><span class="sxs-lookup"><span data-stu-id="5731e-129">That is, the `System.Music.Artist` property is always defined as a multi-value string, but may have a different value (or no value at all) for each item.</span></span>

<span data-ttu-id="5731e-130">Ein Eigenschafts Handler übersetzt in einer Datei gespeicherte Daten in ein strukturiertes Schema, das von erkannt wird und auf das Windows-Explorer, Windows Search und andere Anwendungen zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="5731e-130">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="5731e-131">Diese Systeme können dann mit dem Eigenschaften Handler interagieren, um Eigenschaften in die Datei zu schreiben und diese zu lesen.</span><span class="sxs-lookup"><span data-stu-id="5731e-131">These systems can then interact with the property handler to write and read properties to and from the file.</span></span> <span data-ttu-id="5731e-132">Die übersetzten Daten werden Programm gesteuert verfügbar gemacht und dem Benutzer über den Windows-Explorer in einer Vielzahl von Kontexten angezeigt, einschließlich der Detailansicht, der Infotipps, des Detail Bereichs, der Eigenschaften Seiten usw.</span><span class="sxs-lookup"><span data-stu-id="5731e-132">The translated data is exposed programmatically and shown to the user through Windows Explorer in a variety of contexts including details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="5731e-133">Jeder Eigenschaften Handler ist einem bestimmten Dateityp zugeordnet, der durch die Dateinamenerweiterung gekennzeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="5731e-133">Each property handler is associated with a particular file type, which is identified by the file name extension.</span></span> <span data-ttu-id="5731e-134">Entwickler sollten einen Eigenschafts Handler implementieren, der das systemeigene Format des Dateityps erzeugt und nutzt, z. b. jpg oder PNG, oder den In-Memory-Eigenschaften Speicher verwenden, der das binäre MS-propstore-Format erzeugt und nutzt.</span><span class="sxs-lookup"><span data-stu-id="5731e-134">Developers should implement a property handler that produces and consumes their file type's native format, such as .jpg or .png, or use the In-Memory Property Store, which produces and consumes the MS-PROPSTORE binary format.</span></span>

<span data-ttu-id="5731e-135">Das Windows-Eigenschaften System erstellt ein abstraktes Datenmodell, das eine Abstraktions Ebene aus einzelnen Dateiformaten bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="5731e-135">The Windows Property System creates an abstract data model that provides a level of abstraction from individual file formats.</span></span> <span data-ttu-id="5731e-136">Das abstrakte Datenmodell, das vom Windows-Eigenschaften System bereitgestellt wird, ist eine Methode zum Lesen und Schreiben eines erweiterbaren Satzes von benannten Werten, die einem shellelement zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="5731e-136">The abstract data model provided by the Windows Property System is a method for reading and writing an extensible set of named values that are associated with a Shell item.</span></span> <span data-ttu-id="5731e-137">Der Value-Ausdruck ist flexibel und unterstützt zahlreiche Datentypen, und ist erweiterbar, sodass beliebige Daten (**VT- \_ BLOB**) und Objekte als Wert ausgedrückt werden können.</span><span class="sxs-lookup"><span data-stu-id="5731e-137">The value expression is flexible, supporting many data types, and is extensible, enabling arbitrary data (**VT\_BLOB**) and objects to be expressed as a value.</span></span>

<span data-ttu-id="5731e-138">Aufgrund der Abstraktion können Sie die Attribute oder Metadaten eines beliebigen Elements Abfragen.</span><span class="sxs-lookup"><span data-stu-id="5731e-138">Due to the abstraction, you can query the attributes or metadata of any item.</span></span> <span data-ttu-id="5731e-139">Beispiele für Elemente, die abstrahiert werden können, sind Microsoft Office Dokumente, ID3-Tags und AutoCAD und andere proprietäre Software von Drittanbietern.</span><span class="sxs-lookup"><span data-stu-id="5731e-139">Examples of items that can be abstracted include Microsoft Office documents, ID3 tags, and AutoCAD and other third-party proprietary software.</span></span> <span data-ttu-id="5731e-140">Wenn Sie über eine JPEG-Datei verfügen, können Sie auch die JPEG-und EXIF-Codecs verwenden, um die Bytes der Datei zu lesen und zu ermitteln, was die Abmessungen des Bilds sind.</span><span class="sxs-lookup"><span data-stu-id="5731e-140">Similarly, if you have a .jpeg file, you can use the .jpeg and EXIF codecs to read the bytes of the file to discover what the dimensions of the image are.</span></span> <span data-ttu-id="5731e-141">Wenn Sie stattdessen über eine PNG-Datei verfügen, benötigen Sie einen anderen Codec und einen anderen Code.</span><span class="sxs-lookup"><span data-stu-id="5731e-141">If you have a .png file instead, you need a different codec and different code to do so.</span></span> <span data-ttu-id="5731e-142">Durch die Verwendung des Windows-Eigenschaften Systems wird diese Art von Problem vermieden.</span><span class="sxs-lookup"><span data-stu-id="5731e-142">Using the Windows Property System avoids this sort of problem.</span></span> <span data-ttu-id="5731e-143">Wenn Sie einen neuen Dateityp implementieren, haben Sie die Möglichkeit, die vom Windows-Eigenschaften System angebotene einheitliche Abstraktion einzuschließen und anzugeben, wie die Metadaten nutzbar gemacht werden sollen.</span><span class="sxs-lookup"><span data-stu-id="5731e-143">If you implement a new file type, you have the option to plug into the uniform abstraction offered by the Windows Property System and specify how to make your metadata consumable.</span></span> <span data-ttu-id="5731e-144">Aus diesen Gründen ist es immer vorzuziehen, die vom Windows-Eigenschaften System bereitgestellte allgemeine Plattform zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="5731e-144">For these reasons, it is always preferable to use the common platform provided by the Windows Property System.</span></span>

## <a name="development-scenarios"></a><span data-ttu-id="5731e-145">Entwicklungsszenarien</span><span class="sxs-lookup"><span data-stu-id="5731e-145">Development Scenarios</span></span>

<span data-ttu-id="5731e-146">Eigenschaften werden von Produzenten und Consumern ausgedrückt.</span><span class="sxs-lookup"><span data-stu-id="5731e-146">Properties are expressed by producers and by consumers.</span></span> <span data-ttu-id="5731e-147">In diesem Zusammenhang sind Producer die Erfinder der Eigenschaften im Windows-Eigenschaften System, und Consumer sind Anwendungen (und Ihre Entwickler), die Eigenschafts Informationen von diesem System nutzen.</span><span class="sxs-lookup"><span data-stu-id="5731e-147">In this context, producers are the inventors of properties in the Windows Property System and consumers are applications (and their developers) that consume property information from this system.</span></span> <span data-ttu-id="5731e-148">Die Verwendung von-und-Teilnehmern im Windows-Eigenschaften System ist in der folgenden Tabelle aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="5731e-148">Uses of and participants in the Windows Property System are identified in the following table.</span></span>



| <span data-ttu-id="5731e-149">Verwendung des Windows-Eigenschaften Systems</span><span class="sxs-lookup"><span data-stu-id="5731e-149">Use of the Windows Property System</span></span>                                                                                                                                                                                            | <span data-ttu-id="5731e-150">Teilnehmer</span><span class="sxs-lookup"><span data-stu-id="5731e-150">Participant</span></span> |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| <span data-ttu-id="5731e-151">Ein Baustein, der eine erweiterbare Registrierung von Eigenschafts Beschreibungen, eine in-Memory-Eigenschaften Speicher Implementierung und Dienste zum Binden an Eigenschaften Handler, zum Umrechnen von Typen und zum Serialisieren von Eigenschaften speichern bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="5731e-151">A building block that provides an extensible registry of property descriptions, an in-memory property store implementation, and services for binding to property handlers, converting types, and serializing property stores.</span></span> | <span data-ttu-id="5731e-152">Consumer</span><span class="sxs-lookup"><span data-stu-id="5731e-152">Consumer</span></span>    |
| <span data-ttu-id="5731e-153">Anwendungen, die Eigenschaften auf abstrakte Weise lesen und schreiben möchten.</span><span class="sxs-lookup"><span data-stu-id="5731e-153">Applications that want to read and write properties in an abstract way.</span></span>                                                                                                                                                       | <span data-ttu-id="5731e-154">Consumer</span><span class="sxs-lookup"><span data-stu-id="5731e-154">Consumer</span></span>    |
| <span data-ttu-id="5731e-155">Eigenschaften Erfinder, die neue Eigenschaften für das Eigenschaften System definieren, indem Sie benutzerdefinierte Eigenschafts Schemas definieren und eigene Eigenschaften Handler entwickeln.</span><span class="sxs-lookup"><span data-stu-id="5731e-155">Property inventors who define new properties for the property system by defining custom property schemas and developing their own property handlers.</span></span>                                                                          | <span data-ttu-id="5731e-156">Producer</span><span class="sxs-lookup"><span data-stu-id="5731e-156">Producer</span></span>    |
| <span data-ttu-id="5731e-157">Dateiformat Besitzer, die den Zugriff auf die Eigenschaften aktivieren möchten, die in Ihren benutzerdefinierten Dateiformaten gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="5731e-157">File format owners who want to enable access to the properties stored in their custom file formats.</span></span>                                                                                                                           | <span data-ttu-id="5731e-158">Producer</span><span class="sxs-lookup"><span data-stu-id="5731e-158">Producer</span></span>    |



 

<span data-ttu-id="5731e-159">Consumer nutzen vorhandene Eigenschaften, Schemas und Eigenschafts Handler.</span><span class="sxs-lookup"><span data-stu-id="5731e-159">Consumers consume existing properties, schemas, and property handlers.</span></span> <span data-ttu-id="5731e-160">Zu den verfügbaren Eigenschaften gehören Lese-/Schreibeigenschaften von Eigenschaften Handlern für unterstützte Dateitypen und können auch einige benutzerdefinierte Eigenschaften enthalten.</span><span class="sxs-lookup"><span data-stu-id="5731e-160">Properties available for consumption include read/write properties from property handlers for supported file types and may also include some custom properties.</span></span> <span data-ttu-id="5731e-161">Zu den verfügbaren Schemas gehören mindestens das System Schema und manchmal auch andere.</span><span class="sxs-lookup"><span data-stu-id="5731e-161">Available schemas include at least the system schema, and sometimes others, too.</span></span> <span data-ttu-id="5731e-162">Ein Consumer kann eine Anwendung erstellen, um Metadaten zu nutzen und eine Ansicht basierend auf dem Künstler zu erstellen, unabhängig von den Ordnern, in denen die Elemente gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="5731e-162">A consumer can create an application to consume metadata and build a view based on artist, regardless of what folders the items are stored in.</span></span> <span data-ttu-id="5731e-163">Die Datei Ordnerhierarchie ist irrelevant.</span><span class="sxs-lookup"><span data-stu-id="5731e-163">The file folder hierarchy is irrelevant.</span></span> <span data-ttu-id="5731e-164">Beispielsweise können Sie alle Lied Elemente eines bestimmten Sängers angeben, ohne sich Gedanken über den Speicherort dieser Elemente machen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="5731e-164">For example, you can specify all song items by a particular singer without being concerned about the location of such items.</span></span> <span data-ttu-id="5731e-165">Dieses komplexe End-to-End-Szenario ist nicht auf das Windows-Eigenschaften System beschränkt, sondern umfasst mehrere verschiedene Komponenten, z. b. die Indizierungs-und Suchordner.</span><span class="sxs-lookup"><span data-stu-id="5731e-165">This complex, end-to-end scenario is not limited to the Windows Property System, but involves several different components, such as the indexing and search folders.</span></span>

<span data-ttu-id="5731e-166">Eigenschaften Erfinder oder Entwickler von Drittanbietern sind Producer im Windows-Eigenschaften System.</span><span class="sxs-lookup"><span data-stu-id="5731e-166">Property inventors, or third-party developers, are producers in the Windows Property System.</span></span> <span data-ttu-id="5731e-167">Wenn Sie die Definition einer neuen Eigenschaft vorbereiten, überprüfen Sie zunächst den Satz von Eigenschaften, den Windows definiert.</span><span class="sxs-lookup"><span data-stu-id="5731e-167">When preparing to define a new property, first inspect the set of properties that Windows defines.</span></span> <span data-ttu-id="5731e-168">Wenn Sie ein solches finden, das Ihren Anforderungen entspricht, verwenden Sie die-Eigenschaft und die Semantik, die der erforderlichen Verwendung entsprechen. verwenden Sie diese Eigenschaft nicht, und erfinden Sie keine neue.</span><span class="sxs-lookup"><span data-stu-id="5731e-168">If you find one that meets your needs, of the type and semantics that match your required use, use that property and do not invent a new one.</span></span> <span data-ttu-id="5731e-169">Wenn Sie eine neue benutzerdefinierte Eigenschaft definieren, versuchen Sie, eine Vereinbarung mit anderen Entwicklern zu erhalten, die Sie verwenden möchten, und das Ergebnis dieser Vereinbarung zu veröffentlichen, damit Sie der Benutzer Community dieser Eigenschaft beitreten können.</span><span class="sxs-lookup"><span data-stu-id="5731e-169">If you are defining a new custom property, try to obtain agreement with other developers that might want to use it and publish the result of that agreement so that they can join the community of users of that property.</span></span>

<span data-ttu-id="5731e-170">Producer können die Vorteile der Windows Explorer-Funktionalität nutzen.</span><span class="sxs-lookup"><span data-stu-id="5731e-170">Producers can take advantage of Windows Explorer functionality.</span></span> <span data-ttu-id="5731e-171">Wenn Sie z. b. ein neues Bildformat schreiben und einen Eigenschafts Handler implementieren, wird das neue Dateiformat in Windows-Explorer verfügbar.</span><span class="sxs-lookup"><span data-stu-id="5731e-171">For example, if you are writing a new image format, and implement a property handler, your new file format becomes available in Windows Explorer.</span></span> <span data-ttu-id="5731e-172">Benutzer können dann Ihre Fotos markieren und ihre Auflistung von Fotos basierend auf einer beliebigen Eigenschaft im Windows-Eigenschaften System pivotieren.</span><span class="sxs-lookup"><span data-stu-id="5731e-172">Users can then tag their photographs and pivot their collection of photographs based on any property in the Windows Property System.</span></span> <span data-ttu-id="5731e-173">Tatsächlich kann alles, was die Shell mit Eigenschaften vornimmt, Entwickler von Drittanbietern in ihren eigenen Anwendungen ausführen.</span><span class="sxs-lookup"><span data-stu-id="5731e-173">In fact, anything that Shell does with properties, third-party developers can do in their own applications.</span></span> <span data-ttu-id="5731e-174">Dies schließt das Gruppieren, sortieren, Abfragen und Anzeigen von vollständigen Eigenschaften ein.</span><span class="sxs-lookup"><span data-stu-id="5731e-174">This includes grouping, sorting, querying, and displaying full properties.</span></span> <span data-ttu-id="5731e-175">Der Benutzer, den Windows Explorer bereitstellt, kann größtenteils von Drittanbietern mit öffentlich verfügbaren APIs implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="5731e-175">The user experience that Windows Explorer provides can be largely implemented by third parties with publically available APIs.</span></span> <span data-ttu-id="5731e-176">Windows-Explorer kann mithilfe dieser APIs ersetzt oder erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="5731e-176">Windows Explorer can be replaced or extended using these APIs.</span></span>

<span data-ttu-id="5731e-177">Aus der Sicht einer Anwendung, die das Shell-Datenmodell verwendet, gibt es eine Vielzahl von Szenarios, in denen die Verwendung des Windows-Eigenschaften Systems beteiligt ist.</span><span class="sxs-lookup"><span data-stu-id="5731e-177">From the point of view of an application that uses the Shell data model, there are a huge variety of scenarios that involve the use of the Windows property system.</span></span> <span data-ttu-id="5731e-178">Medien Verwaltungs Anwendungen sind ein hervorragendes Beispiel.</span><span class="sxs-lookup"><span data-stu-id="5731e-178">Media management applications are a prominent example.</span></span> <span data-ttu-id="5731e-179">Zu den Kerneigenschaften System Szenarios zählen Szenarien wie das Lesen der Schlüsselwort Eigenschaft eines Fotos oder das Festlegen der DateTaken-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="5731e-179">Core property system scenarios include scenarios such as reading the keyword property of a photograph or setting the datetaken property.</span></span> <span data-ttu-id="5731e-180">Beispiele für End-to-End-Integrationsszenarien, die vom Windows-Eigenschaften System aktiviert werden, für die jedoch mehrere andere Komponenten erforderlich sind, einschließlich der Anzeige aller Bilder oder der Suche nach einem Dokument, das ein Schlüsselwort enthält.</span><span class="sxs-lookup"><span data-stu-id="5731e-180">Examples of end-to-end integration scenarios that the Windows Property System enables, but that require several other components to function, include showing all pictures, or finding a document that contains a keyword.</span></span>

## <a name="properties-and-windows-search"></a><span data-ttu-id="5731e-181">Eigenschaften und Windows Search</span><span class="sxs-lookup"><span data-stu-id="5731e-181">Properties and Windows Search</span></span>

<span data-ttu-id="5731e-182">Eigenschaften dienen Producer und Consumern, wenn Sie mit der Windows-Suche und-Indizierung in eine Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="5731e-182">Properties serve both producers and consumers when they interface with Windows Search and indexing.</span></span> <span data-ttu-id="5731e-183">Windows Search verfügt über einen Cache mit Eigenschafts Werten, die in der Implementierung des Windows-Suchdienst (WSS) verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="5731e-183">Windows Search has a cache of property values that are used in the implementation of the Windows Search Service (WSS).</span></span> <span data-ttu-id="5731e-184">Diese Eigenschaftswerte können Programm gesteuert mithilfe des Windows Search-OLE DB Anbieters oder mithilfe von [**isearchfolderitemfactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory)abgefragt werden, das Elemente in Suchergebnissen und Abfrage basierten Sichten darstellt.</span><span class="sxs-lookup"><span data-stu-id="5731e-184">These property values can be programmatically queried by using the Windows Search OLE DB provider, or through [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), which represents items in search results and query-based views.</span></span> <span data-ttu-id="5731e-185">Windows Search sammelt und speichert dann Eigenschaften, die von Filter Handlern oder Eigenschaften Handlern ausgegeben werden, wenn ein Element wie ein Word-Dokument indiziert wird.</span><span class="sxs-lookup"><span data-stu-id="5731e-185">Windows Search then collects and stores properties emitted by filter handlers or property handlers when an item such as a Word document is indexed.</span></span> <span data-ttu-id="5731e-186">Dieser Speicher wird verworfen und neu erstellt, wenn der Index neu erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="5731e-186">This store is discarded and rebuilt when the index is rebuilt.</span></span>

> [!Note]  
> <span data-ttu-id="5731e-187">Beachten Sie Folgendes: Wenn Sie ein Schema erneut registrieren, werden Änderungen, die an Attributen von zuvor definierten Eigenschaften vorgenommen wurden, möglicherweise vom Indexer nicht beachtet.</span><span class="sxs-lookup"><span data-stu-id="5731e-187">Remember that when you reregister a schema, changes made to attributes of previously defined properties may not be respected by the indexer.</span></span> <span data-ttu-id="5731e-188">Die Lösung besteht darin, den Index neu zu erstellen oder neue Eigenschaften einzuführen, die die Änderungen widerspiegeln, anstatt alte zu aktualisieren (nicht empfohlen).</span><span class="sxs-lookup"><span data-stu-id="5731e-188">The solution is either to rebuild the index, or introduce new properties that reflect the changes instead of updating old ones (not recommended).</span></span> <span data-ttu-id="5731e-189">Weitere Informationen finden Sie weiter unten in diesem Thema [unter Hinweise zu Implementierern](#note-to-implementers) .</span><span class="sxs-lookup"><span data-stu-id="5731e-189">For more information, see [Note to Implementers](#note-to-implementers) later in this topic.</span></span>

 

<span data-ttu-id="5731e-190">Beispielsweise möchte ein Entwickler, der eine Medien Anwendung erstellt, Benutzern der Anwendung alle verfügbaren Musik von einem bestimmten Künstler anzeigen.</span><span class="sxs-lookup"><span data-stu-id="5731e-190">For example, a developer creating a media application wants to show users of the application all available music by a particular artist.</span></span> <span data-ttu-id="5731e-191">Die Anwendung bietet dem Benutzer eine Liste der verfügbaren Künstler und generiert dann eine Liste aller verfügbaren Musik, die vom Benutzer ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="5731e-191">The application would provide the user with a list of available artists, and then generate a list of all available music by the artist that the user selects.</span></span> <span data-ttu-id="5731e-192">Oder ein Endbenutzer möchte eine Abfrage für? Artist: Beethoven? durchführen und für die vollständige Liste der verfügbaren Eigenschaften im Verlauf der Searche offengelegt werden.</span><span class="sxs-lookup"><span data-stu-id="5731e-192">Or an end user might want to do a query for ?artist:Beethoven?, and be exposed to the full list of available properties in the course of their searche.</span></span> <span data-ttu-id="5731e-193">Dieses Beispiel umfasst die Verwendung des Shell-Namespace, der Eigenschaften Handler und/oder das Abfragen des Indexes über eine der folgenden Aktionen:</span><span class="sxs-lookup"><span data-stu-id="5731e-193">This example involves the use of the Shell namespace, property handlers, and/or querying the index through one of the following:</span></span>

-   <span data-ttu-id="5731e-194">Eine shelldatenquelle.</span><span class="sxs-lookup"><span data-stu-id="5731e-194">A Shell data source.</span></span>
-   <span data-ttu-id="5731e-195">Ein OLE DB-Anbieter.</span><span class="sxs-lookup"><span data-stu-id="5731e-195">An OLE DB provider.</span></span>
-   <span data-ttu-id="5731e-196">Eine gespeicherte Suchdatei (. Search-MS), die verwendet wird, um eine Abfrage zu initiieren, indem Sie zur Suchdatei in Windows-Explorer navigiert oder Programm gesteuert an [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) gebunden wird.</span><span class="sxs-lookup"><span data-stu-id="5731e-196">A Saved Search file (.search-ms) that is used to initiate a query by navigating to the search file in Windows Explorer or binding to [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) programmatically.</span></span>

> [!Note]  
> <span data-ttu-id="5731e-197">Obwohl die `System.Kind` Eigenschaft nicht an diesem Medien Anwendungsszenario teilnimmt, könnte Sie verwendet werden, um eine Abfrage zu erstellen, die alle. Search-MS-Dateien in einem bestimmten Bereich zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="5731e-197">Although the `System.Kind` property does not participate in this media application scenario, it could be used to build a query that would return all of the .search-ms files in a particular scope.</span></span>

 

<span data-ttu-id="5731e-198">Die bevorzugte Methode für den Zugriff auf die Such-APIs und die Erstellung von Windows Search-Anwendungen ist die Verwendung einer shelldatenquelle.</span><span class="sxs-lookup"><span data-stu-id="5731e-198">The preferred way to access the Search APIs and create Windows Search applications is through a Shell data source.</span></span> <span data-ttu-id="5731e-199">[**Isearchfolderitemfactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) ist eine Komponente, mit der Instanzen der Suchordner-Datenquelle erstellt werden können. Dies ist eine Art "virtuelle" Datenquelle, die von der Shell bereitgestellt wird, die Abfragen für andere Datenquellen im Shellnamespace ausführen und Ergebnisse aufzählen kann.</span><span class="sxs-lookup"><span data-stu-id="5731e-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is a component that can create instances of the Search folder data source, which is a sort of "virtual" data source provided by the Shell that can execute queries over other data sources in the Shell namespace and enumerate results.</span></span> <span data-ttu-id="5731e-200">Dies kann entweder mithilfe des Indexers oder durch manuelles auflisten und Überprüfen von Elementen in den angegebenen Bereichen durchlaufen werden.</span><span class="sxs-lookup"><span data-stu-id="5731e-200">It can do so either by using the indexer, or by manually enumerating and inspecting items in the specified scopes.</span></span>

<span data-ttu-id="5731e-201">Entwickler von Drittanbietern können Anwendungen erstellen, die die Daten im Index über programmgesteuerte Abfragen nutzen, und die Daten im Index erweitern, damit benutzerdefinierte Datei-und Elementtypen von Windows Search indiziert werden.</span><span class="sxs-lookup"><span data-stu-id="5731e-201">Third-party developers can create applications that consume the data in the index through programmatic queries, and can extend the data in the index for custom file and item types to be indexed by Windows Search.</span></span> <span data-ttu-id="5731e-202">Wenn Sie Abfrageergebnisse in Windows-Explorer anzeigen möchten, müssen Sie eine Shell-Datenquelle implementieren, bevor Sie einen Protokollhandler zum Erweitern des Indexes erstellen können.</span><span class="sxs-lookup"><span data-stu-id="5731e-202">If you want to show query results in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="5731e-203">Wenn allerdings alle Abfragen Programm gesteuert werden (z. b. über OLE DB) und vom Anwendungscode und nicht von der Shell interpretiert werden, wird ein Shellnamespace weiterhin bevorzugt, ist aber nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="5731e-203">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application?s code rather than the Shell, then a Shell namespace is still preferred but not required.</span></span> <span data-ttu-id="5731e-204">Ein Protokollhandler ist erforderlich, damit Windows Informationen zum Inhalt der Datei, z. b. Elemente in Datenbanken oder benutzerdefinierten Dateitypen, abrufen kann.</span><span class="sxs-lookup"><span data-stu-id="5731e-204">A protocol handler is required for Windows to obtain information about file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="5731e-205">Obwohl Windows Search den Namen und die Eigenschaften der Datei indizieren kann, enthält Windows keine Informationen zum Inhalt der Datei.</span><span class="sxs-lookup"><span data-stu-id="5731e-205">While Windows Search can index the name and properties of the file, Windows has no information about the content of the file.</span></span> <span data-ttu-id="5731e-206">Folglich können solche Elemente in der Windows-Shell nicht indiziert oder verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="5731e-206">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="5731e-207">Durch Implementieren eines benutzerdefinierten Protokoll Handlers können Sie diese Elemente verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="5731e-207">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="5731e-208">Eine Liste der Handler, die von dem Entwickler Szenario identifiziert werden, das Sie zu erreichen versuchen, finden Sie unter "Übersicht über Handler" in der [Windows-Suche als Entwicklungsplattform](../search/-search-3x-wds-development-ovr.md).</span><span class="sxs-lookup"><span data-stu-id="5731e-208">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](../search/-search-3x-wds-development-ovr.md).</span></span>

> [!Note]  
> <span data-ttu-id="5731e-209">Eine shelldatenquelle wird manchmal als Shellnamespace Erweiterung bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5731e-209">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="5731e-210">Ein Handler wird manchmal als Shellerweiterung oder Shellerweiterungs Handler bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5731e-210">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

## <a name="note-to-implementers"></a><span data-ttu-id="5731e-211">Hinweis für Implementierer</span><span class="sxs-lookup"><span data-stu-id="5731e-211">Note to Implementers</span></span>

<span data-ttu-id="5731e-212">Aufgrund möglicher Schwierigkeiten, die der Indexer bei der Verwendung des Schema Schema des Eigenschaften Systems aufweisen kann, ist es wichtig, Attribute sorgfältig und strategisch für die erste Version des Schemas zu definieren.</span><span class="sxs-lookup"><span data-stu-id="5731e-212">Due to potential difficulties that the indexer may have when consuming the property system's schema, it is critical that you define attributes carefully and strategically for the first release of the schema.</span></span> <span data-ttu-id="5731e-213">Alle Änderungen an Attributen (Typ, Spaltenbreite, ggf.) werden in der Datenbank nach der Registrierung eines Schemas nicht wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="5731e-213">Any changes to attributes (type, column width, whether indexible) will not be reflected in the database after a schema has been registered.</span></span> <span data-ttu-id="5731e-214">Die einzigen Möglichkeiten, diese Änderungen zu erkennen, nachdem das Schema einmal auf einem System registriert wurde, würden entweder den Index neu erstellen und dann das neue Schema registrieren oder das Schema registrieren und dann für jede nachfolgende Version eine neue Eigenschaft erstellen. beispielsweise `PKEY_GroupName_PropertyNameV2` , `PKEY_GroupName_PropertyNameV3` usw.</span><span class="sxs-lookup"><span data-stu-id="5731e-214">The only ways to have these changes recognized after the schema has been registered once on a system would be either to rebuild the index and then register the new schema, or to register the schema and then create a new property for each subsequent release; for example `PKEY_GroupName_PropertyNameV2`, `PKEY_GroupName_PropertyNameV3`, and so forth.</span></span> <span data-ttu-id="5731e-215">Es wird nicht empfohlen, neue Eigenschaften auf diese Weise zu erstellen, da sich mehrere überflüssige Spalten möglicherweise auf die Systemleistung auswirken.</span><span class="sxs-lookup"><span data-stu-id="5731e-215">We do not recommend creating new properties in this manner, because multiple extraneous columns may impact system performance.</span></span>

## <a name="windows-property-system-documentation"></a><span data-ttu-id="5731e-216">Dokumentation zu Windows-Eigenschaften System</span><span class="sxs-lookup"><span data-stu-id="5731e-216">Windows Property System Documentation</span></span>

<span data-ttu-id="5731e-217">Der Rest dieser Dokumentation enthält die folgenden Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="5731e-217">The remainder of this documentation contains the following sections:</span></span>

-   [<span data-ttu-id="5731e-218">Entwicklerhandbuch für Windows-Eigenschaften System</span><span class="sxs-lookup"><span data-stu-id="5731e-218">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)

    <span data-ttu-id="5731e-219">Beschreibt ausführlich, wie die wichtigsten Entwicklungsszenarien mithilfe des Windows-Eigenschaften Systems implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="5731e-219">Describes in detail how to implement the main development scenarios using the Windows Property System.</span></span>

-   [<span data-ttu-id="5731e-220">Eigenschaften System Referenz</span><span class="sxs-lookup"><span data-stu-id="5731e-220">Property System Reference</span></span>](property-system-reference.md)

    <span data-ttu-id="5731e-221">Dokumentiert die [Fenster Eigenschaften](props.md), [das Eigenschafts Beschreibungs Schema](property-description-schema.md), [Schnittstellen](interfaces.md), [Funktionen](functions.md), [Strukturen](structures.md), [Konstanten, Enumerationen und Flags](constants--enumerations--and-flags.md) des Windows-Eigenschaften Systems.</span><span class="sxs-lookup"><span data-stu-id="5731e-221">Documents the [Windows Properties](props.md), [Property Description Schema](property-description-schema.md), [Interfaces](interfaces.md), [Functions](functions.md), [Structures](structures.md), and [Constants, Enumerations, and Flags](constants--enumerations--and-flags.md) of the Windows Property System.</span></span>

-   [<span data-ttu-id="5731e-222">Eigenschaftensystem-Codebeispiele</span><span class="sxs-lookup"><span data-stu-id="5731e-222">Property System Code Samples</span></span>](property-system-code-samples.md)

    <span data-ttu-id="5731e-223">Beschreibt Beispiele, die veranschaulichen, wie das Windows-Eigenschaften System verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="5731e-223">Describes samples that demonstrate how to use the Windows Property System.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="5731e-224">Weitere Ressourcen</span><span class="sxs-lookup"><span data-stu-id="5731e-224">Additional Resources</span></span>

-   <span data-ttu-id="5731e-225">Weitere Informationen zur Wiederverwendung des In-Memory-Eigenschaften Speicher finden Sie unter [Initialisieren von Eigenschaften Handlern](building-property-handlers-property-handlers.md) und [**pscreatememorypropertystore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span><span class="sxs-lookup"><span data-stu-id="5731e-225">For information about reusing the In-Memory Property Store, see [Initializing Property Handlers](building-property-handlers-property-handlers.md) and [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span></span>
-   <span data-ttu-id="5731e-226">Eine Spezifikation des Binärdatei Formats von Microsoft Property Store finden Sie unter [ \[ MS \_ propstore \] ](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span><span class="sxs-lookup"><span data-stu-id="5731e-226">For a specification of the Microsoft Property Store Binary File Format, see [\[MS\_PROPSTORE\]](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span></span>
-   <span data-ttu-id="5731e-227">Die Beziehung zwischen der Windows-Suche und-Indizierung und der Erweiterung des Indexes werden in den folgenden Themen in Windows Search erläutert:</span><span class="sxs-lookup"><span data-stu-id="5731e-227">The relationship between Windows Search and indexing, and how to extend the index, are explained in the following topics in Windows Search:</span></span>
    -   [<span data-ttu-id="5731e-228">Entwickeln von Filter Handlern für Windows Search</span><span class="sxs-lookup"><span data-stu-id="5731e-228">Developing Filter Handlers for Windows Search</span></span>](../search/-search-ifilter-conceptual.md)
    -   [<span data-ttu-id="5731e-229">Entwickeln von Protokoll Handlern für Windows Search</span><span class="sxs-lookup"><span data-stu-id="5731e-229">Developing Protocol Handlers for Windows Search</span></span>](../search/-search-3x-wds-phaddins.md)
    -   [<span data-ttu-id="5731e-230">Entwickeln von Eigenschaften Handlern für Windows Search</span><span class="sxs-lookup"><span data-stu-id="5731e-230">Developing Property Handlers for Windows Search</span></span>](../search/-search-3x-wds-extidx-propertyhandlers.md)
    -   <span data-ttu-id="5731e-231">Informationen zum Herunterladen von Windows 7 oder zum aktualisierten Windows Vista SDK finden Sie in der [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span><span class="sxs-lookup"><span data-stu-id="5731e-231">For the Windows 7 or updated Windows Vista SDK download, see the [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span></span>

## <a name="related-topics"></a><span data-ttu-id="5731e-232">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="5731e-232">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5731e-233">Entwicklerhandbuch für Windows-Eigenschaften System</span><span class="sxs-lookup"><span data-stu-id="5731e-233">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)
</dt> <dt>

[<span data-ttu-id="5731e-234">Eigenschaften System Referenz</span><span class="sxs-lookup"><span data-stu-id="5731e-234">Property System Reference</span></span>](property-system-reference.md)
</dt> <dt>

[<span data-ttu-id="5731e-235">Eigenschaftensystem-Codebeispiele</span><span class="sxs-lookup"><span data-stu-id="5731e-235">Property System Code Samples</span></span>](property-system-code-samples.md)
</dt> </dl>

 

 
