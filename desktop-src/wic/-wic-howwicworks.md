---
description: Weitere Informationen zur Funktionsweise der Windows-Abbild Erstellungs Komponente
ms.assetid: c233e25b-bec6-4e67-8fbf-2bf9b70c7522
title: Funktionsweise der Windows-Abbild Erstellungs Komponente
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9bc9fe31ae4346f2c2d1f0b273e78ed10a0ec7e6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "103757836"
---
# <a name="how-the-windows-imaging-component-works"></a><span data-ttu-id="e4054-103">Funktionsweise der Windows-Abbild Erstellungs Komponente</span><span class="sxs-lookup"><span data-stu-id="e4054-103">How the Windows Imaging Component Works</span></span>

<span data-ttu-id="e4054-104">Dieses Thema enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="e4054-104">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="e4054-105">Ermittlung und Schiedsgerichtsbarkeit</span><span class="sxs-lookup"><span data-stu-id="e4054-105">Discovery and Arbitration</span></span>](#discovery-and-arbitration)
-   [<span data-ttu-id="e4054-106">Decodierung</span><span class="sxs-lookup"><span data-stu-id="e4054-106">Decoding</span></span>](#decoding)
-   [<span data-ttu-id="e4054-107">Codieren</span><span class="sxs-lookup"><span data-stu-id="e4054-107">Encoding</span></span>](#encoding)
-   [<span data-ttu-id="e4054-108">Die Lebensdauer eines Codecs.</span><span class="sxs-lookup"><span data-stu-id="e4054-108">The Lifetime of a Codec</span></span>](#the-lifetime-of-a-codec)
-   [<span data-ttu-id="e4054-109">Gewusst wie: WIC-aktivierter Codec</span><span class="sxs-lookup"><span data-stu-id="e4054-109">How to WIC-enabled a Codec</span></span>](#how-to-wic-enabled-a-codec)
-   [<span data-ttu-id="e4054-110">Multithread-Apartment Unterstützung in WIC</span><span class="sxs-lookup"><span data-stu-id="e4054-110">Multi-Threaded Apartment Support in WIC</span></span>](#multi-threaded-apartment-support-in-wic)
-   [<span data-ttu-id="e4054-111">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="e4054-111">Related topics</span></span>](#related-topics)

## <a name="discovery-and-arbitration"></a><span data-ttu-id="e4054-112">Ermittlung und Schiedsgerichtsbarkeit</span><span class="sxs-lookup"><span data-stu-id="e4054-112">Discovery and Arbitration</span></span>

<span data-ttu-id="e4054-113">Bevor ein Bild decodiert werden kann, muss ein entsprechender Codec gefunden werden, der das Bildformat decodieren kann.</span><span class="sxs-lookup"><span data-stu-id="e4054-113">Before an image can be decoded, an appropriate codec must be found that can decode that image format.</span></span> <span data-ttu-id="e4054-114">In den meisten Systemen ist kein Ermittlungs Vorgang erforderlich, da die unterstützten Bildformate hart codiert sind.</span><span class="sxs-lookup"><span data-stu-id="e4054-114">In most systems, because the supported image formats are hard-coded, no discovery process is required.</span></span> <span data-ttu-id="e4054-115">Da die WIC-Plattform (Windows Imaging Component) erweiterbar ist, müssen Sie in der Lage sein, das Format eines Bilds zu identifizieren und mit einem passenden Codec abzugleichen.</span><span class="sxs-lookup"><span data-stu-id="e4054-115">Because the Windows Imaging Component (WIC) platform is extensible, it’s necessary to be able to identify the format of an image and match it with an appropriate codec.</span></span>

<span data-ttu-id="e4054-116">Zur Unterstützung der Lauf Zeit Ermittlung muss jedes Bildformat ein Identifizierungs Muster aufweisen, mit dem der entsprechende Decoder für dieses Format identifiziert werden kann.</span><span class="sxs-lookup"><span data-stu-id="e4054-116">To support run-time discovery, each image format must have an identifying pattern that can be used to identify the appropriate decoder for that format.</span></span> <span data-ttu-id="e4054-117">(Es wird dringend empfohlen, dass Sie für neue Dateiformate eine GUID für das identifizierende Muster verwenden, da es garantiert eindeutig ist.) Das Identifizierungs Muster muss in jede Bilddatei eingebettet werden, die diesem Bildformat entspricht.</span><span class="sxs-lookup"><span data-stu-id="e4054-117">(It is strongly recommended that, for new file formats, you use a GUID for the identifying pattern, because it is guaranteed to be unique.) The identifying pattern must be embedded in each image file that conforms to that image format.</span></span> <span data-ttu-id="e4054-118">Jeder Decoder verfügt über einen Registrierungs Eintrag, der das identifizierende Muster oder Muster der Bildformate angibt, die es decodieren kann.</span><span class="sxs-lookup"><span data-stu-id="e4054-118">Each decoder has a registry entry that specifies the identifying pattern or patterns of the image formats it can decode.</span></span> <span data-ttu-id="e4054-119">Wenn eine Anwendung ein Image öffnen muss, fordert Sie einen Decoder von WIC an.</span><span class="sxs-lookup"><span data-stu-id="e4054-119">When an application needs to open an image, it requests a decoder from WIC.</span></span> <span data-ttu-id="e4054-120">WIC sucht in der Registrierung nach den verfügbaren Decodern und überprüft jeden Registrierungs Eintrag auf ein identifizierendes Muster, das mit dem in der Bilddatei eingebetteten Muster übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="e4054-120">WIC looks up the available decoders in the registry, and checks each registry entry for an identifying pattern that matches the pattern embedded in the image file.</span></span> <span data-ttu-id="e4054-121">Weitere Informationen zu Decoder-Registrierungs Einträgen finden Sie unter [encoderspezifische Registrierungseinträge](-wic-decoderregentries.md) .</span><span class="sxs-lookup"><span data-stu-id="e4054-121">For more information on decoder registry entries, see [Encoder-Specific Registry Entries](-wic-decoderregentries.md)</span></span>

<span data-ttu-id="e4054-122">Wenn WIC einen einzelnen Decoder findet, der mit dem identifizierenden Muster im Image übereinstimmt, erstellt er eine Instanz des Decoders und übergibt die Bilddatei an ihn.</span><span class="sxs-lookup"><span data-stu-id="e4054-122">When WIC finds a single decoder that matches the identifying pattern in the image, it creates an instance of the decoder and passes the image file to it.</span></span> <span data-ttu-id="e4054-123">Wenn WIC mehr als eine Übereinstimmung findet, wird für jeden übereinstimmenden Decoder eine Methode namens [**QueryCapability**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-querycapability) aufgerufen, um Sie zu untersuchen und die beste Übereinstimmung zu finden.</span><span class="sxs-lookup"><span data-stu-id="e4054-123">If WIC finds more than one match, it invokes a method called [**QueryCapability**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-querycapability) on each matching decoder to arbitrate among them and find the best match.</span></span> <span data-ttu-id="e4054-124">Weitere Informationen finden Sie im Abschnitt [queryfunktionen](-wic-imp-iwicbitmapdecoder.md) des [implementierenden iwicbitmapdecoders](-wic-imp-iwicbitmapdecoder.md).</span><span class="sxs-lookup"><span data-stu-id="e4054-124">For more information, see the [QueryCapabilities](-wic-imp-iwicbitmapdecoder.md) section in the [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md).</span></span>

## <a name="decoding"></a><span data-ttu-id="e4054-125">Decodierung</span><span class="sxs-lookup"><span data-stu-id="e4054-125">Decoding</span></span>

<span data-ttu-id="e4054-126">Nachdem der entsprechende Decoder ausgewählt und instanziiert wurde, spricht die Anwendung direkt mit dem Decoder.</span><span class="sxs-lookup"><span data-stu-id="e4054-126">After the appropriate decoder has been selected and instantiated, the application talks directly to the decoder.</span></span> <span data-ttu-id="e4054-127">Der Decoder hat mehrere Aufgaben, die er über verschiedene Schnittstellen implementiert.</span><span class="sxs-lookup"><span data-stu-id="e4054-127">The decoder has several responsibilities, which it implements through various interfaces.</span></span> <span data-ttu-id="e4054-128">Diese Dienste können wie folgt klassifiziert werden:</span><span class="sxs-lookup"><span data-stu-id="e4054-128">These services can be classified as:</span></span>

-   <span data-ttu-id="e4054-129">Dienste auf Container Ebene</span><span class="sxs-lookup"><span data-stu-id="e4054-129">Container-level services</span></span>
-   <span data-ttu-id="e4054-130">Dienste auf Frame-Ebene</span><span class="sxs-lookup"><span data-stu-id="e4054-130">Frame-level services</span></span>
-   <span data-ttu-id="e4054-131">Metadatenenumerationsdienste</span><span class="sxs-lookup"><span data-stu-id="e4054-131">Metadata enumeration services</span></span>
-   <span data-ttu-id="e4054-132">Native Decoder-Transformationen</span><span class="sxs-lookup"><span data-stu-id="e4054-132">Native decoder transforms</span></span>
-   <span data-ttu-id="e4054-133">Fortschritts Benachrichtigungen und Abbruch Unterstützung</span><span class="sxs-lookup"><span data-stu-id="e4054-133">Progress notifications and cancellation support</span></span>
-   <span data-ttu-id="e4054-134">Rohverarbeitungs Dienste</span><span class="sxs-lookup"><span data-stu-id="e4054-134">Raw processing services</span></span>

<span data-ttu-id="e4054-135">Dienste auf Container-Ebene umfassen das Abrufen der Miniaturansicht der obersten Ebene (falls unterstützt), der Vorschau, der Farb Kontexte, der Palette (falls zutreffend) und des Container Formats sowie das Bereitstellen des Zugriffs auf die einzelnen Bildframes innerhalb des Containers.</span><span class="sxs-lookup"><span data-stu-id="e4054-135">Container-level services include retrieving the top-level thumbnail (if supported), preview, color contexts, palette (if applicable), and container format, as well as providing access to the individual image frames within the container.</span></span> <span data-ttu-id="e4054-136">(Einige Container enthalten nur einen einzelnen Frame, während andere, z. b. Tagged Image File Format (TIFF), mehrere Frames enthalten können.) Diese Dienste umfassen auch die Bereitstellung von Informationen zum Decoder und dessen Funktionen in Bezug auf eine bestimmte Bilddatei.</span><span class="sxs-lookup"><span data-stu-id="e4054-136">(Some containers contain only a single frame while others, such as Tagged Image File Format (TIFF), can contain multiple frames.) This set of services also includes providing information about the decoder itself, and its capabilities with respect to a specific image file.</span></span>

<span data-ttu-id="e4054-137">Einzelne Frames verfügen über eigene Miniaturansichten und können auch über eigene Farb Kontexte, Paletten und andere Eigenschaften verfügen, die auf Frame-Ebene verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="e4054-137">Individual frames have their own thumbnails, and may also have their own color contexts, palettes, and other properties, which are exposed at the frame level.</span></span> <span data-ttu-id="e4054-138">Der wichtigste Vorgang, der auf der Frame-Ebene ausgeführt wird, ist jedoch die tatsächliche Decodierung der Bildbits für diesen Frame.</span><span class="sxs-lookup"><span data-stu-id="e4054-138">The most important operation performed at the frame level, though, is the actual decoding of the image bits for that frame.</span></span>

<span data-ttu-id="e4054-139">WIC stellt metadatenreader für die gängigsten Metadatenformate (IFD, EXIF, IPTC, XMP, APP0, App1 und andere Formate) bereit und unterstützt außerdem die Erweiterbarkeit für Metadatenformate von Drittanbietern.</span><span class="sxs-lookup"><span data-stu-id="e4054-139">WIC provides metadata readers for the most common metadata formats (IFD, EXIF, IPTC, XMP, APP0, APP1, and other formats), and also supports extensibility for third-party metadata formats.</span></span> <span data-ttu-id="e4054-140">Dadurch wird der Codec der Verantwortung für das Durchsuchen von Metadaten freigegeben.</span><span class="sxs-lookup"><span data-stu-id="e4054-140">This frees the codec of the responsibility for parsing metadata.</span></span> <span data-ttu-id="e4054-141">Der Codec ist jedoch für das Auflisten der Metadatenblöcke und das Anfordern eines metadatenreaders für jeden Block verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="e4054-141">However, the codec is responsible for enumerating the metadata blocks and requesting a metadata reader for each block.</span></span> <span data-ttu-id="e4054-142">WIC führt die Ermittlung für Metadatenhandler auf die gleiche Weise durch wie bei Codecs, basierend auf einem Muster im Block Header, das mit einem Muster im Registrierungs Eintrag des metadatenhandlers übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="e4054-142">WIC performs discovery for metadata handlers the same way it does for codecs, based on a pattern in the block header matching a pattern in the metadata handler’s registry entry.</span></span> <span data-ttu-id="e4054-143">Weitere Informationen finden Sie in den [Codierungs spezifischen Registrierungs Einträgen](-wic-decoderregentries.md) .</span><span class="sxs-lookup"><span data-stu-id="e4054-143">For more information, see the [Encoder-Specific Registry Entries](-wic-decoderregentries.md)</span></span>

<span data-ttu-id="e4054-144">Decoders sind nicht für die systemeigene Unterstützung von Transformations Vorgängen erforderlich. Dadurch werden jedoch erhebliche Leistungsoptimierungen ermöglicht, die eine bessere Endbenutzer Leistung ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="e4054-144">Decoders are not required to natively support transform operations, but doing so enables significant performance optimizations that provide a better end-user experience.</span></span> <span data-ttu-id="e4054-145">Beispielsweise kann eine Anwendung eine Pipeline verschiedener Transformationen (Skalierung, Zuschneiden, Drehung und Pixel Formatkonvertierung) erstellen, die vor dem Rendern des Bilds für ein Bild durchgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="e4054-145">For example, an application can create a pipeline of various transforms (scaling, cropping, rotation, and pixel format conversion) to perform on an image before the image is rendered.</span></span> <span data-ttu-id="e4054-146">Weitere Informationen zu Transformations Pipelines finden Sie unter [IWICBitmapSource](-wic-imp-iwicbitmapsource.md).</span><span class="sxs-lookup"><span data-stu-id="e4054-146">For more information on transform pipelines, see [IWICBitmapSource](-wic-imp-iwicbitmapsource.md).</span></span> <span data-ttu-id="e4054-147">Nachdem eine Transformations Pipeline erstellt wurde, fordert die Anwendung die endgültige Transformation in der Pipeline an, um die Bitmap zu erzeugen, die sich aus der Anwendung aller Transformationen auf die Bildquelle ergibt.</span><span class="sxs-lookup"><span data-stu-id="e4054-147">After creating a transform pipeline, the application requests the final transform in the pipeline to produce the bitmap that results from applying all the transforms to the image source.</span></span> <span data-ttu-id="e4054-148">Wenn der Decoder an dieser Stelle in der Lage ist, Transformations Vorgänge auszuführen, fragt WIC, welche der angeforderten Transformationen er ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="e4054-148">At that point, if the decoder itself is able to perform transform operations, WIC asks which of the requested transforms it can perform.</span></span> <span data-ttu-id="e4054-149">Alle angeforderten Transformationen, die der Decoder nicht ausführen kann, werden von WIC für das decodierte Bild ausgeführt, bevor es an den Aufrufer zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="e4054-149">Any requested transforms the decoder cannot perform will be performed by WIC on the decoded image before returning it to the caller.</span></span> <span data-ttu-id="e4054-150">Diese optimierte Transformations Pipeline bietet eine bessere Leistung als die sequenzielle Ausführung jeder Transformation im Speicher, insbesondere dann, wenn einige oder alle Transformationen während des Decodierungs Vorgangs durchgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="e4054-150">This optimized transform pipeline provides better performance than performing each transform sequentially in memory, particularly when some or all of the transforms can be accomplished during the decoding process.</span></span>

<span data-ttu-id="e4054-151">Status Benachrichtigungen und Abbruch Unterstützung ermöglichen es einer Anwendung, Status Benachrichtigungen für lange Vorgänge anzufordern. Außerdem kann die Anwendung den Benutzern die Möglichkeit geben, einen Vorgang abzubrechen, der zu lange dauert.</span><span class="sxs-lookup"><span data-stu-id="e4054-151">Progress notifications and cancellation support enable an application to request progress notifications for lengthy operations, and also enable the application to give the user an opportunity to cancel an operation that is taking too long.</span></span> <span data-ttu-id="e4054-152">Dies ist wichtig, denn wenn ein Benutzer einen Vorgang nicht abbrechen kann, hat er möglicherweise den Meinung, dass der Prozess nicht reagiert hat, und versucht, ihn abzubrechen, indem er die Anwendung schließt.</span><span class="sxs-lookup"><span data-stu-id="e4054-152">This is important because if a user cannot cancel an operation, he or she may feel the process has hung, and try to cancel it by closing the application.</span></span>

<span data-ttu-id="e4054-153">Diese Schnittstellen werden im Abschnitt über die [Implementierung eines WIC-Enabled Decoders](-wic-implementingwicdecoder.md)ausführlich beschrieben.</span><span class="sxs-lookup"><span data-stu-id="e4054-153">These interfaces are described in detail in the section on [Implementing a WIC-Enabled Decoder](-wic-implementingwicdecoder.md).</span></span>

<span data-ttu-id="e4054-154">Die rohverarbeitungs Dienste umfassen das Anpassen von Kameraeinstellungen wie z. b. das verfügbar machen, den Kontrast und das Schärfen oder das Ändern des Farb Raums vor der Verarbeitung der rohbits.</span><span class="sxs-lookup"><span data-stu-id="e4054-154">Raw processing services include adjusting camera settings, such as exposure, contrast, and sharpening, or changing the color space before processing the raw bits.</span></span>

## <a name="encoding"></a><span data-ttu-id="e4054-155">Codierung</span><span class="sxs-lookup"><span data-stu-id="e4054-155">Encoding</span></span>

<span data-ttu-id="e4054-156">Wie Decoders haben Encoder Verantwortlichkeiten, die Sie über Schnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="e4054-156">Like decoders, encoders have responsibilities that they implement through interfaces.</span></span> <span data-ttu-id="e4054-157">Die von Encodern bereitgestellten Dienste ergänzen die Dienste, die von Decodern bereitgestellt werden, mit dem Unterschied, dass Sie Bilddaten schreiben, anstatt Sie zu lesen.</span><span class="sxs-lookup"><span data-stu-id="e4054-157">The services that encoders provide are complementary to the services provided by decoders, except they write out image data rather than reading it.</span></span> <span data-ttu-id="e4054-158">Encoder stellen auch Dienste in den folgenden Kategorien bereit:</span><span class="sxs-lookup"><span data-stu-id="e4054-158">Encoders also provide services in the following categories:</span></span>

-   <span data-ttu-id="e4054-159">Dienste auf Container Ebene</span><span class="sxs-lookup"><span data-stu-id="e4054-159">Container-level services</span></span>
-   <span data-ttu-id="e4054-160">Dienste auf Frame-Ebene</span><span class="sxs-lookup"><span data-stu-id="e4054-160">Frame-level services</span></span>
-   <span data-ttu-id="e4054-161">Metadatenenumeration und Aktualisierungs Dienste</span><span class="sxs-lookup"><span data-stu-id="e4054-161">Metadata enumeration and update services</span></span>
-   <span data-ttu-id="e4054-162">Fortschritts Benachrichtigung und Abbruch Unterstützung</span><span class="sxs-lookup"><span data-stu-id="e4054-162">Progress notification and cancellation support</span></span>

<span data-ttu-id="e4054-163">Dienste auf Container-Ebene für einen Encoder beinhalten das Festlegen der Miniaturansicht der obersten Ebene (falls unterstützt), der Vorschau und der Palette (falls zutreffend) und durchlaufen der einzelnen Bildframes, damit Sie in den Container serialisiert werden können.</span><span class="sxs-lookup"><span data-stu-id="e4054-163">Container-level services for an encoder include setting the top-level thumbnail (if supported), preview, and palette (if applicable), and iterating through the individual image frames so they can be serialized into the container.</span></span>

<span data-ttu-id="e4054-164">Dienste auf Frame-Ebene für einen Encoder spiegeln die Werte für den Decoder wider, mit dem Unterschied, dass Sie die Bilddaten, die Miniaturansicht und eine beliebige zugeordnete Palette oder andere Komponente schreiben, anstatt Sie zu lesen.</span><span class="sxs-lookup"><span data-stu-id="e4054-164">Frame-level services for an encoder mirror those for the decoder, except that they write out the image data, thumbnail, and any associated palette or other component, rather than reading them.</span></span>

<span data-ttu-id="e4054-165">Außerdem umfassen metadatenenumerationsdienste für einen Encoder das Durchlaufen der zu schreibenden Metadatenblöcke und das Aufrufen der entsprechenden metadatenwriter, um die Metadaten auf den Datenträger zu serialisieren.</span><span class="sxs-lookup"><span data-stu-id="e4054-165">Also, metadata enumeration services for an encoder include iterating through the metadata blocks to be written, and invoking the appropriate metadata writers to serialize the metadata to disk.</span></span>

<span data-ttu-id="e4054-166">Diese Schnittstellen werden im Abschnitt über die [Implementierung eines WIC-Enabled Encoders](-wic-implementingwicencoder.md)ausführlich beschrieben.</span><span class="sxs-lookup"><span data-stu-id="e4054-166">These interfaces are described in detail in the section on [Implementing a WIC-Enabled Encoder](-wic-implementingwicencoder.md).</span></span>

## <a name="the-lifetime-of-a-codec"></a><span data-ttu-id="e4054-167">Die Lebensdauer eines Codecs.</span><span class="sxs-lookup"><span data-stu-id="e4054-167">The Lifetime of a Codec</span></span>

<span data-ttu-id="e4054-168">Ein WIC-Codec wird instanziiert, um ein einzelnes Bild zu verarbeiten, und weist normalerweise eine kurze Lebensdauer auf.</span><span class="sxs-lookup"><span data-stu-id="e4054-168">A WIC codec is instantiated to handle a single image, and usually has a short lifetime.</span></span> <span data-ttu-id="e4054-169">Sie wird erstellt, wenn ein Bild geladen wird, und wird freigegeben, wenn das Bild geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="e4054-169">It’s created when an image is loaded and is released when the image is closed.</span></span> <span data-ttu-id="e4054-170">Eine Anwendung verwendet möglicherweise eine große Anzahl von Codecs gleichzeitig mit überlappenden Lebens dauern (Scrollen Sie durch ein Verzeichnis mit Hunderten von Bildern), und mehrere Anwendungen können dies gleichzeitig durchführen.</span><span class="sxs-lookup"><span data-stu-id="e4054-170">An application may use a large number of codecs simultaneously with overlapping lifetimes (think of scrolling through a directory containing hundreds of images), and multiple applications may be doing this at the same time.</span></span>

<span data-ttu-id="e4054-171">Obwohl einige Codecs eine Lebensdauer aufweisen, die auf die Lebensdauer des Prozesses beschränkt ist, in dem Sie leben, ist dies bei WIC-Codecs nicht der Fall.</span><span class="sxs-lookup"><span data-stu-id="e4054-171">Although some codecs have a lifetime that is scoped to the lifetime of the process in which they live, this is not the case with WIC codecs.</span></span> <span data-ttu-id="e4054-172">Die Windows Vista-Fotogalerie, Windows-Explorer und die Photo Viewer sowie zahlreiche andere Anwendungen basieren auf WIC und verwenden ihren Codec zum Anzeigen von Bildern und Miniaturansichten.</span><span class="sxs-lookup"><span data-stu-id="e4054-172">The Windows Vista Photo Gallery, Windows Explorer, and Photo Viewer, as well as numerous other applications, are built on WIC and will be using your codec to display images and thumbnails.</span></span> <span data-ttu-id="e4054-173">Wenn die Lebensdauer Ihres Codecs auf die Lebensdauer des Prozesses festgelegt wurde, wird jedes Mal, wenn ein Bild oder eine Miniaturansicht in Windows Vista Explorer angezeigt wurde, der Codec, der zum Decodieren dieses Images instanziiert wurde, im Arbeitsspeicher verbleiben, bis der Benutzer das nächste Mal seinen Computer neu gestartet hat.</span><span class="sxs-lookup"><span data-stu-id="e4054-173">If the lifetime of your codec were scoped to the lifetime of the process, every time an image or thumbnail was displayed in the Windows Vista Explorer, the codec instantiated to decode that image would remain in memory until the next time the user restarted his or her computer.</span></span> <span data-ttu-id="e4054-174">Wenn Ihr Codec nie entladen wird, sind seine Ressourcen tatsächlich "kompromittiert", da Sie nicht von einer anderen Komponente im System verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="e4054-174">If your codec is never unloaded, its resources are, in effect, "leaked" because they can't be used by any other component in the system.</span></span>

## <a name="how-to-wic-enabled-a-codec"></a><span data-ttu-id="e4054-175">Gewusst wie: WIC-aktivierter Codec</span><span class="sxs-lookup"><span data-stu-id="e4054-175">How to WIC-enabled a Codec</span></span>

1.  <span data-ttu-id="e4054-176">Implementieren Sie eine Decoder-Klasse auf Container-Ebene und eine Decoder-Klasse auf Frame-Ebene, die die erforderlichen WIC-Schnittstellen zum Decodieren von Bildern und durchlaufen von metadatenblöcken verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="e4054-176">Implement a container-level decoder class and a frame-level decoder class that exposes the required WIC interfaces for decoding images and iterating through blocks of metadata.</span></span> <span data-ttu-id="e4054-177">Dies ermöglicht allen WIC-basierten Anwendungen die Interaktion mit Ihrem Codec auf dieselbe Weise, wie Sie mit Standardbild Formaten interagieren.</span><span class="sxs-lookup"><span data-stu-id="e4054-177">This enables all WIC-based applications to interact with your codec the same way they interact with standard image formats.</span></span>
2.  <span data-ttu-id="e4054-178">Implementieren Sie eine Encoder-Klasse auf Container Ebene und eine Encoder-Klasse auf Frame-Ebene, die die erforderlichen WIC-Schnittstellen für die Codierung von Bildern und das Serialisieren von metadatenblöcken in eine Bilddatei verfügbar macht</span><span class="sxs-lookup"><span data-stu-id="e4054-178">Implement a container-level encoder class and a frame-level encoder class that exposes the required WIC interfaces for encoding images and serializing blocks of metadata into an image file.</span></span>
3.  <span data-ttu-id="e4054-179">Wenn Ihr Containerformat nicht auf einem TIFF-oder JPEG-Container basiert, müssen Sie möglicherweise Metadatenhandler für die allgemeinen Metadatenformate (EXIF, XMP) schreiben.</span><span class="sxs-lookup"><span data-stu-id="e4054-179">If your container format is not based on a TIFF or JPEG container, you may need to write metadata handlers for the common metadata formats (EXIF, XMP).</span></span> <span data-ttu-id="e4054-180">Wenn Sie jedoch ein TIFF-oder JPEG-basiertes Containerformat verwenden, ist dies nicht erforderlich, da Sie an die vom System bereitgestellten Metadatenhandler delegieren können.</span><span class="sxs-lookup"><span data-stu-id="e4054-180">However, if you use a TIFF-based or JPEG-based container format, this is not necessary because you can delegate to the system-provided metadata handlers.</span></span>
4.  <span data-ttu-id="e4054-181">Betten Sie ein eindeutiges Identifikationsmuster (Wir empfehlen eine GUID) in alle Ihre Bilddateien ein.</span><span class="sxs-lookup"><span data-stu-id="e4054-181">Embed a unique identifying pattern (we recommend a GUID) in all your image files.</span></span> <span data-ttu-id="e4054-182">Dadurch kann Ihr Bildformat während der Ermittlung mit Ihrem Codec abgeglichen werden.</span><span class="sxs-lookup"><span data-stu-id="e4054-182">This enables your image format to be matched against your codec during the discovery.</span></span> <span data-ttu-id="e4054-183">Wenn Sie einen WIC-Wrapper für ein vorhandenes Bildformat schreiben, müssen Sie ein Muster von Bits suchen, das der Encoder immer in seine Bilddateien schreibt, die für dieses Bildformat eindeutig sind, und dieses als identifizierendes Muster verwenden.)</span><span class="sxs-lookup"><span data-stu-id="e4054-183">If you are writing a WIC wrapper for an existing image format, you must find a pattern of bits that the encoder always writes into its image files that’s unique to that image format, and use this as the identifying pattern.)</span></span>
5.  <span data-ttu-id="e4054-184">Registrieren Sie Ihren Codec beim Installations Zeitpunkt.</span><span class="sxs-lookup"><span data-stu-id="e4054-184">Register your codec at installation time.</span></span> <span data-ttu-id="e4054-185">Dadurch kann der Codec zur Laufzeit ermittelt werden, indem das identifizierende Muster in der Registrierung mit dem in die Bilddatei eingebetteten Muster übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="e4054-185">This enables your codec to be discovered at run time by matching the identifying pattern in the registry with the pattern embedded in the image file.</span></span>
6.  <span data-ttu-id="e4054-186">Ab Windows 7 erfordert WIC, dass Codecs den com-Apartment-Typ "beide" aufweisen.</span><span class="sxs-lookup"><span data-stu-id="e4054-186">As of Windows 7, WIC requires that codecs be of COM apartment type "Both".</span></span> <span data-ttu-id="e4054-187">Dies bedeutet, dass Sie die entsprechende Sperre durchführen müssen, um Apartment übergreifende Aufrufer und Aufrufer in Szenarios mit mehreren Threads zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="e4054-187">This means that you must do the appropriate locking to handle cross-apartment callers and callers in multi-threaded scenarios.</span></span> <span data-ttu-id="e4054-188">Weitere Informationen finden Sie im nächsten Abschnitt der Multithread-Apartment Unterstützung.</span><span class="sxs-lookup"><span data-stu-id="e4054-188">For more information, see the next section on multi-threaded apartment support.</span></span>
7.  <span data-ttu-id="e4054-189">Unterstützung für 64-Bit-Plattformen: für Windows 7 erfordert WIC, dass WIC-Codecs von Drittanbietern sowohl als native 32-Bit-als auch als 64-Bit-Binärdateien geliefert werden.</span><span class="sxs-lookup"><span data-stu-id="e4054-189">Support for 64-bit platforms: For Windows 7, WIC will require that third-party WIC codecs be delivered as both 32-bit and 64-bit native binaries.</span></span> <span data-ttu-id="e4054-190">Außerdem muss das 32-Bit-Formular auf 64-Bit-Systemen installiert und ausgeführt werden, und der Drittanbieter Windows 7 Codec-Installer muss sowohl die 32-Bit-als auch die 64-Bit-Binärdatei auf einem 64-Bit-System installieren.</span><span class="sxs-lookup"><span data-stu-id="e4054-190">Further, the 32-bit form must install and run on 64-bit systems, and the third party Windows 7 codec installer must install both the 32-bit and 64-bit binaries on 64-bit systems.</span></span>

## <a name="multi-threaded-apartment-support-in-wic"></a><span data-ttu-id="e4054-191">Multithread-Apartment Unterstützung in WIC</span><span class="sxs-lookup"><span data-stu-id="e4054-191">Multi-Threaded Apartment Support in WIC</span></span>

<span data-ttu-id="e4054-192">Objekte innerhalb eines Multithread-Apartment (MTA) können gleichzeitig durch eine beliebige Anzahl von Threads im MTA aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="e4054-192">Objects within a Multi-Threaded Apartment (MTA) may be called concurrently by any number of threads within the MTA.</span></span> <span data-ttu-id="e4054-193">Dies ermöglicht eine bessere Leistung für Multikernsysteme und bestimmte Server Szenarien.</span><span class="sxs-lookup"><span data-stu-id="e4054-193">This allows for better performance on multi-core systems and certain server scenarios.</span></span> <span data-ttu-id="e4054-194">Darüber hinaus können WIC-Codecs in einem MTA andere Objekte im MTA aufrufen, ohne die Marshallingkosten im Zusammenhang mit dem Aufruf zwischen Threads in verschiedenen STA-Apartments zu haben.</span><span class="sxs-lookup"><span data-stu-id="e4054-194">In addition, WIC codecs in an MTA can call other objects in the MTA without the marshalling cost associated with calling between threads in different STA apartments.</span></span> <span data-ttu-id="e4054-195">In Windows 7 wurden alle in-Box-WIC-Codecs aktualisiert, um MTAs zu unterstützen, einschließlich JPEG, TIFF, PNG, GIF, ICO und BMP.</span><span class="sxs-lookup"><span data-stu-id="e4054-195">In Windows 7, all in-box WIC codecs have been updated to support MTAs, including JPEG, TIFF, PNG, GIF, ICO, and BMP.</span></span> <span data-ttu-id="e4054-196">Es wird dringend empfohlen, dass Drittanbieter-Codecs für die Unterstützung von MTAs geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="e4054-196">It is highly recommended that third-party codecs be written to support MTAs.</span></span> <span data-ttu-id="e4054-197">Codecs von Drittanbietern, die MTAs nicht unterstützen, verursachen aufgrund von Marshalling erhebliche Leistungskosten in Multithreadanwendungen.</span><span class="sxs-lookup"><span data-stu-id="e4054-197">Third-party codecs that do not to support MTAs cause significant performance costs in multi-threaded applications because of marshaling.</span></span> <span data-ttu-id="e4054-198">Zum Aktivieren der MTA-Unterstützung muss die ordnungsgemäße Synchronisierung im Codec von Drittanbietern implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="e4054-198">Enabling MTA support requires proper synchronization to be implemented in the third-party codec.</span></span> <span data-ttu-id="e4054-199">Die genaue Implementierung dieser Synchronisierungs Verfahren geht über den Rahmen dieses Artikels hinaus.</span><span class="sxs-lookup"><span data-stu-id="e4054-199">Exact implementation of these synchronization techniques is beyond the scope of this paper.</span></span> <span data-ttu-id="e4054-200">Weitere Informationen zum Synchronisieren von COM-Objekten finden [Sie unter verstehen und Verwenden von COM-Threading Modellen](/previous-versions/ms809971(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="e4054-200">For more information on synchronizing COM objects, see [Understanding and Using COM Threading Models](/previous-versions/ms809971(v=msdn.10)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="e4054-201">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="e4054-201">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="e4054-202">**Licher**</span><span class="sxs-lookup"><span data-stu-id="e4054-202">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="e4054-203">Einführung (Schreiben eines WIC-Enabled Codecs)</span><span class="sxs-lookup"><span data-stu-id="e4054-203">Introduction (How to Write a WIC-Enabled CODEC)</span></span>](-wic-howtowriteacodec-intro.md)
</dt> <dt>

[<span data-ttu-id="e4054-204">Implementieren eines WIC-Enabled Decoders</span><span class="sxs-lookup"><span data-stu-id="e4054-204">Implementing a WIC-Enabled Decoder</span></span>](-wic-implementingwicdecoder.md)
</dt> <dt>

[<span data-ttu-id="e4054-205">Schreiben eines WIC-Enabled Codecs</span><span class="sxs-lookup"><span data-stu-id="e4054-205">How to Write a WIC-Enabled CODEC</span></span>](-wic-howtowriteacodec.md)
</dt> <dt>

[<span data-ttu-id="e4054-206">Übersicht über die Windows Imaging-Komponente</span><span class="sxs-lookup"><span data-stu-id="e4054-206">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> <dt>

[<span data-ttu-id="e4054-207">Übersicht über WIC-Metadaten</span><span class="sxs-lookup"><span data-stu-id="e4054-207">WIC Metadata Overview</span></span>](-wic-about-metadata.md)
</dt> </dl>

 

 



