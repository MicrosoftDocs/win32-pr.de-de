---
description: Um eine Protokolldatei zum Lesen zu öffnen, nennen Sie pdhopesquery, und geben Sie einen Pfad zur Protokolldatei an.
ms.assetid: 1d8f8662-df1f-4f84-8b65-c152f79cc5c6
title: Arbeiten mit Protokolldateien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ba2032b90036f8f58c07d8c7e80e7e7ac2b2701c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106357750"
---
# <a name="working-with-log-files"></a><span data-ttu-id="828f4-103">Arbeiten mit Protokolldateien</span><span class="sxs-lookup"><span data-stu-id="828f4-103">Working with Log Files</span></span>

<span data-ttu-id="828f4-104">Um eine Protokolldatei zum Lesen zu öffnen, nennen Sie [**pdhopesquery**](/windows/desktop/api/Pdh/nf-pdh-pdhopenquerya) , und geben Sie einen Pfad zur Protokolldatei an.</span><span class="sxs-lookup"><span data-stu-id="828f4-104">To open a log file for reading, call [**PdhOpenQuery**](/windows/desktop/api/Pdh/nf-pdh-pdhopenquerya) and specify a path to the log file.</span></span> <span data-ttu-id="828f4-105">Um eine Protokolldatei zum Schreiben zu öffnen, müssen Sie [**pdhoptolog**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga)abrufen.</span><span class="sxs-lookup"><span data-stu-id="828f4-105">To open a log file for writing, you must call [**PdhOpenLog**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga).</span></span> <span data-ttu-id="828f4-106">Um eine Protokolldatei zu schließen, müssen Sie je nach Funktion, die Sie zum Öffnen der Protokolldatei verwendet haben, entweder [**pdhclosequery**](/windows/desktop/api/Pdh/nf-pdh-pdhclosequery) oder [**pdhcloselog**](/windows/desktop/api/Pdh/nf-pdh-pdhcloselog) abrufen.</span><span class="sxs-lookup"><span data-stu-id="828f4-106">To close a log file, call either [**PdhCloseQuery**](/windows/desktop/api/Pdh/nf-pdh-pdhclosequery) or [**PdhCloseLog**](/windows/desktop/api/Pdh/nf-pdh-pdhcloselog) depending on which function you used to open the log file.</span></span>

## <a name="reading-from-a-log-file"></a><span data-ttu-id="828f4-107">Lesen aus einer Protokolldatei</span><span class="sxs-lookup"><span data-stu-id="828f4-107">Reading from a log file</span></span>

<span data-ttu-id="828f4-108">Das Lesen von Leistungsdaten aus einer Protokolldatei ist identisch mit dem Lesen von Daten aus einer echt Zeit Quelle – Sie öffnen eine Abfrage, fügen der Abfrage Leistungsindikatoren hinzu und nennen [**pdhcollectquerydata**](/windows/desktop/api/Pdh/nf-pdh-pdhcollectquerydata) , um ein Beispiel aus der Protokolldatei zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="828f4-108">Reading performance data from a log file is the same as reading data from a real time source—you open a query, add counters to the query and call [**PdhCollectQueryData**](/windows/desktop/api/Pdh/nf-pdh-pdhcollectquerydata) to collect a sample from the log file.</span></span> <span data-ttu-id="828f4-109">**Pdhcollectquerydata** gibt PDH \_ keine \_ weiteren \_ Daten zurück, wenn Sie das Ende der Protokolldatei erreichen.</span><span class="sxs-lookup"><span data-stu-id="828f4-109">**PdhCollectQueryData** returns PDH\_NO\_MORE\_DATA when you reach the end of the log file.</span></span>

<span data-ttu-id="828f4-110">Jedes Beispiel in der Protokolldatei enthält einen Zeitstempel für den Zeitpunkt, zu dem es ursprünglich gesammelt und in die Protokolldatei geschrieben wurde.</span><span class="sxs-lookup"><span data-stu-id="828f4-110">Each sample in the log file contains a time stamp for when it was originally collected and written to the log file.</span></span> <span data-ttu-id="828f4-111">Um den Zeitstempel für das erste und letzte Beispiel in der Protokolldatei abzurufen, rufen Sie die [**pdhgetdatasourcetimerange**](/windows/desktop/api/Pdh/nf-pdh-pdhgetdatasourcetimerangea) -Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="828f4-111">To retrieve the time stamp for the first and last sample in the log file, call the [**PdhGetDataSourceTimeRange**](/windows/desktop/api/Pdh/nf-pdh-pdhgetdatasourcetimerangea) function.</span></span> <span data-ttu-id="828f4-112">Wenn Sie die aus dem Protokoll gelesenen Beispiele auf einen bestimmten Zeitraum beschränken möchten, finden Sie weitere Informationen unter [Festlegen eines Zeit Bereichs für eine Abfrage](setting-a-time-range-for-a-query.md).</span><span class="sxs-lookup"><span data-stu-id="828f4-112">If you want to limit the samples that you read from the log to a specific time range, see [Setting a Time Range for a Query](setting-a-time-range-for-a-query.md).</span></span>

<span data-ttu-id="828f4-113">Wenn Sie nicht wissen, welche Leistungs Objekte und-Indikatoren in der Protokolldatei vorhanden sind, können Sie [**pdhenumubjects**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectsa) zum Ermitteln der Liste der Objekte abrufen.</span><span class="sxs-lookup"><span data-stu-id="828f4-113">If you do not know which performance objects and counters exist in the log file, you can call [**PdhEnumObjects**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectsa) to determine the list of objects.</span></span> <span data-ttu-id="828f4-114">Bei einem Objekt können Sie entweder [**pdhenumubjectitems**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa) oder [**PdhExpandWildCardPath**](/windows/desktop/api/Pdh/nf-pdh-pdhexpandwildcardpatha) aufrufen, um eine Liste der Instanzen und Indikatoren des Objekts abzurufen, die in der Protokolldatei enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="828f4-114">Given an object, you can call either [**PdhEnumObjectItems**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa) or [**PdhExpandWildCardPath**](/windows/desktop/api/Pdh/nf-pdh-pdhexpandwildcardpatha) to retrieve a list of the object's instances and counters contained in the log file.</span></span>

<span data-ttu-id="828f4-115">Wenn Sie [**pdhenumubjectitems**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa)aufrufen, verwenden Sie die Instanz-und die Counter-Listen, um einen Pfad für jede mögliche Kombination von Instanz und Counter zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="828f4-115">If you call [**PdhEnumObjectItems**](/windows/desktop/api/Pdh/nf-pdh-pdhenumobjectitemsa), use the instance and counter lists to create a path for each possible combination of instance and counter.</span></span> <span data-ttu-id="828f4-116">Wenn Sie [**pdhaddcounter**](/windows/desktop/api/Pdh/nf-pdh-pdhaddcountera) zum Hinzufügen des Zählers zur Abfrage abrufen, schlägt die Funktion fehl, wenn die Protokolldatei die angegebene Kombination nicht enthält.</span><span class="sxs-lookup"><span data-stu-id="828f4-116">When you call [**PdhAddCounter**](/windows/desktop/api/Pdh/nf-pdh-pdhaddcountera) to add the counter to the query, the function will fail if the log file does not contain the given combination.</span></span>

<span data-ttu-id="828f4-117">Wenn Sie [**PdhExpandWildCardPath**](/windows/desktop/api/Pdh/nf-pdh-pdhexpandwildcardpatha)verwenden, können Sie einen Pfad erstellen, der einen Platzhalter für den Instanznamen und-Wert enthält, z \\ . b. Object ( \* ) \\ \* .</span><span class="sxs-lookup"><span data-stu-id="828f4-117">If you use [**PdhExpandWildCardPath**](/windows/desktop/api/Pdh/nf-pdh-pdhexpandwildcardpatha), you can create a path that contains a wildcard for the instance name and counter, for example, \\object(\*)\\\*.</span></span> <span data-ttu-id="828f4-118">Die Funktion gibt einen ungültigen PDH-Pfad zurück, \_ \_ Wenn das Objekt keine Instanz enthält.</span><span class="sxs-lookup"><span data-stu-id="828f4-118">The function returns PDH\_INVALID\_PATH if the object does not contain an instance.</span></span> <span data-ttu-id="828f4-119">Nennen Sie in diesem Fall **PdhExpandWildCardPath** mithilfe eines Platzhalters nur für Counter (z \\ . b. Object) \\ \* .</span><span class="sxs-lookup"><span data-stu-id="828f4-119">In this case, call **PdhExpandWildCardPath** using a wildcard for counter only, for example, \\object\\\*.</span></span>

<span data-ttu-id="828f4-120">Neuere Betriebssysteme können Protokolldateien lesen, die auf älteren Betriebssystemen generiert wurden. Protokolldateien, die unter Windows Vista und späteren Betriebssystemen erstellt wurden, können jedoch nicht unter früheren Betriebssystemen gelesen werden.</span><span class="sxs-lookup"><span data-stu-id="828f4-120">Newer operating systems can read log files that were generated on older operating systems; however, log files that were created on Windows Vista and later operating systems cannot be read on earlier operating systems.</span></span>

<span data-ttu-id="828f4-121">Ein Beispiel für das Lesen von Daten aus einer Protokolldatei finden Sie unter [Lesen von Leistungsdaten aus einer Protokolldatei](reading-performance-data-from-a-log-file.md).</span><span class="sxs-lookup"><span data-stu-id="828f4-121">For an example that reads data from a log file, see [Reading Performance Data from a Log File](reading-performance-data-from-a-log-file.md).</span></span>

## <a name="reading-from-multiple-log-files"></a><span data-ttu-id="828f4-122">Lesen aus mehreren Protokolldateien</span><span class="sxs-lookup"><span data-stu-id="828f4-122">Reading from multiple log files</span></span>

<span data-ttu-id="828f4-123">Wenn Sie eine Abfrage erstellen müssen, die aus mehreren Protokolldateien liest, rufen Sie [**pdhbindinputdatasource**](/windows/desktop/api/Pdh/nf-pdh-pdhbindinputdatasourcea) auf, um die Protokolldateien zu binden.</span><span class="sxs-lookup"><span data-stu-id="828f4-123">If you need to create a query that reads from several log files, call the [**PdhBindInputDataSource**](/windows/desktop/api/Pdh/nf-pdh-pdhbindinputdatasourcea) to bind the log files together.</span></span> <span data-ttu-id="828f4-124">Sie müssen dann PDH-Funktionen verwenden, die mit "H" enden, z. b. " [**pdhopenqueryh**](/windows/desktop/api/Pdh/nf-pdh-pdhopenqueryh)".</span><span class="sxs-lookup"><span data-stu-id="828f4-124">You then need to use PDH functions that end in 'H', for example, [**PdhOpenQueryH**](/windows/desktop/api/Pdh/nf-pdh-pdhopenqueryh).</span></span>

## <a name="writing-to-a-log-file"></a><span data-ttu-id="828f4-125">Schreiben in eine Protokolldatei</span><span class="sxs-lookup"><span data-stu-id="828f4-125">Writing to a log file</span></span>

<span data-ttu-id="828f4-126">Rufen Sie vor dem Schreiben in eine Protokolldatei [**pdhopenquery**](/windows/desktop/api/Pdh/nf-pdh-pdhopenquerya) auf, um eine Abfrage zu erstellen, und geben Sie die Quelle der Leistungsdaten an (entweder Echtzeitdaten oder eine Protokolldatei).</span><span class="sxs-lookup"><span data-stu-id="828f4-126">Before writing to a log file, call [**PdhOpenQuery**](/windows/desktop/api/Pdh/nf-pdh-pdhopenquerya) to create a query and specify the source of the performance data, either real time data or a log file.</span></span> <span data-ttu-id="828f4-127">Fügen Sie dann die Leistungsindikatoren hinzu, die Sie Abfragen möchten.</span><span class="sxs-lookup"><span data-stu-id="828f4-127">Then, add the counters that you want to query.</span></span>

<span data-ttu-id="828f4-128">Um die Zieldatei zu öffnen, nennen Sie [**pdhoptolog**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga).</span><span class="sxs-lookup"><span data-stu-id="828f4-128">To open the destination file, call [**PdhOpenLog**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga).</span></span> <span data-ttu-id="828f4-129">Geben Sie die Abfrage an, wenn Sie die Protokolldatei öffnen.</span><span class="sxs-lookup"><span data-stu-id="828f4-129">Specify the query when you open the log file.</span></span> <span data-ttu-id="828f4-130">Um die Leistungsdaten zu erfassen und in die Protokolldatei zu schreiben, nennen Sie [**pdhupdatelog**](/windows/desktop/api/Pdh/nf-pdh-pdhupdateloga).</span><span class="sxs-lookup"><span data-stu-id="828f4-130">To collect the performance data and write it to the log file, call [**PdhUpdateLog**](/windows/desktop/api/Pdh/nf-pdh-pdhupdateloga).</span></span>

<span data-ttu-id="828f4-131">Wenn die gegen Daten in eine durch Trennzeichen getrennte (. CSV) oder durch Tabstopps getrennte (. TSV) Protokolldatei geschrieben werden und der Pfad eine Platzhalter Instanz enthält, wird der Pfad erweitert, und nur die Instanzen, die zum Zeitpunkt der Erweiterung des Pfads vorhanden sind, sind in der Protokolldatei enthalten.</span><span class="sxs-lookup"><span data-stu-id="828f4-131">If the counter data is being written to comma-delimited (.csv) or tab-delimited (.tsv) log file and the path contains a wildcard instance, the path is expanded and only those instances that exist at the time the path is expanded are included in the log file.</span></span> <span data-ttu-id="828f4-132">Bei Binärdateien (. blg) oder SQL-Protokolldateien wird der Platzhalter jedoch nicht erweitert, sodass die Protokolldatei-Instanzen enthält, die während der Protokollierung erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="828f4-132">However, for binary (.blg) or SQL log files, the wildcard is not expanded so that the log file contains instances that are created during logging.</span></span>

<span data-ttu-id="828f4-133">Ein Beispiel für das Schreiben von Daten in eine Protokolldatei finden Sie unter [Schreiben von Leistungsdaten in eine Protokolldatei](writing-performance-data-to-a-log-file.md).</span><span class="sxs-lookup"><span data-stu-id="828f4-133">For an example that writes data to a log file, see [Writing Performance Data to a Log File](writing-performance-data-to-a-log-file.md).</span></span>

## <a name="compressing-a-log-file"></a><span data-ttu-id="828f4-134">Komprimieren einer Protokolldatei</span><span class="sxs-lookup"><span data-stu-id="828f4-134">Compressing a log file</span></span>

<span data-ttu-id="828f4-135">Sie können die [**pdhcomputecounterstatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) -Funktion verwenden, um eine Protokolldatei zu komprimieren.</span><span class="sxs-lookup"><span data-stu-id="828f4-135">You can use the [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) function to compress a log file.</span></span> <span data-ttu-id="828f4-136">Lesen Sie z. b. zehn Datensätze aus einer Protokolldatei, und nennen Sie **pdhcomputecounterstatistics** , um den Mittelwert zu berechnen und dann den Mittelwert in eine Ausgabeprotokoll Datei zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="828f4-136">For example, read ten records from a log file, call **PdhComputeCounterStatistics** to compute the mean value and then write the mean value to an output log file.</span></span>

<span data-ttu-id="828f4-137">Das folgende Thema enthält zusätzliche Informationen zur Verwendung einer Protokolldatei.</span><span class="sxs-lookup"><span data-stu-id="828f4-137">The following topic provides additional information on using a log file.</span></span>

-   [<span data-ttu-id="828f4-138">Die Größe einer Protokolldatei wird erhalten.</span><span class="sxs-lookup"><span data-stu-id="828f4-138">Getting the Size of a Log File</span></span>](getting-the-size-of-a-log-file.md)

 

 



