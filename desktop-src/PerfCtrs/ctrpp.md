---
description: Beim ctrpp-Tool handelt es sich um einen Präprozessor, der das Zähler Manifest analysiert und überprüft.
ms.assetid: 3939f6a1-0a94-429d-a71e-b37f045fea13
title: CTRPP
ms.topic: reference
ms.date: 08/17/2020
topic_type:
- APIRef
- kbSyntax
api_name:
- CTRPP
api_type:
- NA
api_location: ''
ms.openlocfilehash: dce12de641dda7b07871a4447190772533598748
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/05/2021
ms.locfileid: "104351858"
---
# <a name="ctrpp"></a><span data-ttu-id="8c59b-103">CTRPP</span><span class="sxs-lookup"><span data-stu-id="8c59b-103">CTRPP</span></span>

<span data-ttu-id="8c59b-104">Beim ctrpp-Tool handelt es sich um einen Präprozessor, der das Manifest für Ihren v2-Anbieter analysiert und überprüft.</span><span class="sxs-lookup"><span data-stu-id="8c59b-104">The CTRPP tool is a pre-processor that parses and validates the manifest for your V2 provider.</span></span> <span data-ttu-id="8c59b-105">Das Tool generiert `.rc` Ressourcen mit den Zeichen folgen, die von Consumern Ihres Anbieters benötigt werden, und generiert einen `.h` Header mit Code, den Sie zum Bereitstellen der Counter-Daten verwenden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-105">The tool generates `.rc` resources with the strings needed by consumers of your provider, and it generates a `.h` header with code that you use to provide your counter data.</span></span> <span data-ttu-id="8c59b-106">Sie sollten das ctrpp-Tool während der Erstellung Ihres Anbieters ausführen.</span><span class="sxs-lookup"><span data-stu-id="8c59b-106">You should run the CTRPP tool during the build of your provider.</span></span> <span data-ttu-id="8c59b-107">Sie sollten den generierten Code als Ausgangspunkt verwenden, wenn Sie den Anbieter entwickeln, anstatt zu versuchen, diesen Code selbst zu generieren.</span><span class="sxs-lookup"><span data-stu-id="8c59b-107">You should use the generated code as a starting point when developing your provider instead of trying to generate this code yourself.</span></span>

```syntax
ctrpp -o codeFile -rc rcFile [-legacy] [-MemoryRoutines] [-NotificationCallback] [-prefix prefix] [-ch symFile] [-backcompat] inputFile
```

## <a name="arguments"></a><span data-ttu-id="8c59b-108">Argumente</span><span class="sxs-lookup"><span data-stu-id="8c59b-108">Arguments</span></span>

|<span data-ttu-id="8c59b-109">Option</span><span class="sxs-lookup"><span data-stu-id="8c59b-109">Option</span></span>              |<span data-ttu-id="8c59b-110">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="8c59b-110">Description</span></span>
|--------------------|-----------
|<span data-ttu-id="8c59b-111">*Eingabedatei*</span><span class="sxs-lookup"><span data-stu-id="8c59b-111">*inputFile*</span></span>         |<span data-ttu-id="8c59b-112">**Erforderlich:** Gibt den Namen der `.man` (XML-Manifest)-Datei an, die ihre Leistungsindikatoren definiert.</span><span class="sxs-lookup"><span data-stu-id="8c59b-112">**Required:** Specifies the name of the `.man` (XML manifest) file that defines your counters.</span></span>
|<span data-ttu-id="8c59b-113">**-o-** *Codedatei*</span><span class="sxs-lookup"><span data-stu-id="8c59b-113">**-o** *codeFile*</span></span>   |<span data-ttu-id="8c59b-114">**Erforderlich:** Gibt den Namen der `.h` Codedatei an, die von ctrpp generiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="8c59b-114">**Required:** Specifies the name of the `.h` code file to be generated by CTRPP.</span></span> <span data-ttu-id="8c59b-115">Diese Datei enthält C/C++-Inline Hilfsfunktionen, mit denen die Initialisierung und die Initialisierung des Anbieters vereinfacht werden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-115">This file will contain C/C++ inline helper functions that simplify initializing and uninitializing your provider.</span></span>
|<span data-ttu-id="8c59b-116">**-RC** *rcfile*</span><span class="sxs-lookup"><span data-stu-id="8c59b-116">**-rc** *rcFile*</span></span>    |<span data-ttu-id="8c59b-117">**Erforderlich:** Gibt den Namen der `.rc` (Ressourcen Datei) an, die von ctrpp generiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="8c59b-117">**Required:** Specifies the name of the `.rc` (resource file) to be generated by CTRPP.</span></span> <span data-ttu-id="8c59b-118">Diese Datei enthält die Zeichen folgen Tabelle des Anbieters.</span><span class="sxs-lookup"><span data-stu-id="8c59b-118">This file will contain the provider's string table.</span></span>
|<span data-ttu-id="8c59b-119">**-ch-** *symfile*</span><span class="sxs-lookup"><span data-stu-id="8c59b-119">**-ch** *symFile*</span></span>   |<span data-ttu-id="8c59b-120">Gibt den Namen der optionalen `.h` Symbol Datei an, die von ctrpp generiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="8c59b-120">Specifies the name of the optional `.h` symbol file to be generated by CTRPP.</span></span> <span data-ttu-id="8c59b-121">Diese Datei enthält C/C++-Symbole für die Namen und GUIDs der einzelnen Gegensätze im Anbieter.</span><span class="sxs-lookup"><span data-stu-id="8c59b-121">This file will contain C/C++ symbols for the names and GUIDs of each counterset in the provider.</span></span>
|<span data-ttu-id="8c59b-122">**-Präfix** *Präfix*</span><span class="sxs-lookup"><span data-stu-id="8c59b-122">**-prefix** *prefix*</span></span>|<span data-ttu-id="8c59b-123">Gibt das Präfix an, das für die in der generierten Header Datei definierten Variablen und Funktionen verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="8c59b-123">Specifies the prefix to use for the variables and functions defined in the generated header file.</span></span>
|<span data-ttu-id="8c59b-124">**-Notificationcallback**</span><span class="sxs-lookup"><span data-stu-id="8c59b-124">**-NotificationCallback**</span></span>|<span data-ttu-id="8c59b-125">Ändert die Standard Signatur der [**counterinitialize**](counterinitialize.md) -Funktion, um Parameter zum Angeben des Namens der Rückruf Funktionen " [*controlcallback*](/windows/desktop/api/Perflib/nc-perflib-perflibrequest)", " [*Zuordnungs Speicher*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_alloc)" und " [*Freispeicher*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_free) " einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="8c59b-125">Changes the default signature of the [**CounterInitialize**](counterinitialize.md) function to include parameters for specifying the name of [*ControlCallback*](/windows/desktop/api/Perflib/nc-perflib-perflibrequest), [*AllocateMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_alloc), and [*FreeMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_free) callback functions.</span></span> <span data-ttu-id="8c59b-126">Dieses Argument hat denselben Effekt wie das Einschließen des- `callback` Attributs in das [**Provider**](/windows/desktop/PerfCtrs/performance-counters-provider--counters--element) -Element.</span><span class="sxs-lookup"><span data-stu-id="8c59b-126">This argument has the same effect as including the `callback` attribute in the [**provider**](/windows/desktop/PerfCtrs/performance-counters-provider--counters--element) element.</span></span>
|<span data-ttu-id="8c59b-127">**-** *OutputFile* migrieren</span><span class="sxs-lookup"><span data-stu-id="8c59b-127">**-migrate** *outputFile*</span></span>|<span data-ttu-id="8c59b-128">Anstatt `.h` -und- `.rc` Dateien zu erstellen, aktualisiert das *inputFile* -Manifest auf die neueste Version und speichert Sie in *OutputFile*.</span><span class="sxs-lookup"><span data-stu-id="8c59b-128">Instead of generating `.h` and `.rc` files, upgrades the *inputFile* manifest to the latest version and saves it to *outputFile*.</span></span> <span data-ttu-id="8c59b-129">Dieser Switch kann nicht mit anderen Switches verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-129">This switch cannot be used with other switches.</span></span> <span data-ttu-id="8c59b-130">Verwendung: `CTRPP -migrate NewFile.man OldFile.man`</span><span class="sxs-lookup"><span data-stu-id="8c59b-130">Usage: `CTRPP -migrate NewFile.man OldFile.man`</span></span>
|<span data-ttu-id="8c59b-131">**-Backcompat**</span><span class="sxs-lookup"><span data-stu-id="8c59b-131">**-BackCompat**</span></span>     |<span data-ttu-id="8c59b-132">**Veraltet:** Unterstützung für Kernel Modus-Anbieter wurde in Windows 7 hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="8c59b-132">**Deprecated:** Support for kernel-mode providers was added in Windows 7.</span></span> <span data-ttu-id="8c59b-133">Standardmäßig ist der von ctrpp für kernelmodusanbieter generierte Code mit früheren Versionen von Windows nicht kompatibel (der Treiber wird aufgrund fehlender APIs nicht geladen `Pcw***` ).</span><span class="sxs-lookup"><span data-stu-id="8c59b-133">By default, the code generated by CTRPP for kernel-mode providers will be incompatible with earlier versions of Windows (driver will fail to load due to missing `Pcw***` APIs).</span></span> <span data-ttu-id="8c59b-134">Legen `-BackCompat` Sie fest, um die Kompatibilität mit früheren Versionen von Windows zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="8c59b-134">Set `-BackCompat` to enable compatibility with earlier versions of Windows.</span></span> <span data-ttu-id="8c59b-135">Der Treiber lädt die erforderlichen APIs dynamisch, und der generierte Code deaktiviert den Anbieter automatisch, wenn die APIs nicht verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="8c59b-135">The driver will dynamically load the necessary APIs and the generated code will silently disable the provider if the APIs are not available.</span></span>
|<span data-ttu-id="8c59b-136">**-Memoryroutinen**</span><span class="sxs-lookup"><span data-stu-id="8c59b-136">**-MemoryRoutines**</span></span> |<span data-ttu-id="8c59b-137">**Veraltet:** Bei Verwendung mit dem- `-Legacy` Schalter schließt Vorlagen für Speicher Routinen in den generierten Code ein.</span><span class="sxs-lookup"><span data-stu-id="8c59b-137">**Deprecated:** When used with the `-Legacy` switch, includes templates for memory routines in the generated code.</span></span> <span data-ttu-id="8c59b-138">Andernfalls hat dieses Argument denselben Effekt wie der `-NotificationCallback` Switch.</span><span class="sxs-lookup"><span data-stu-id="8c59b-138">Otherwise, this argument has the same effect as the `-NotificationCallback` switch.</span></span>
|<span data-ttu-id="8c59b-139">**-Legacy**</span><span class="sxs-lookup"><span data-stu-id="8c59b-139">**-Legacy**</span></span>         |<span data-ttu-id="8c59b-140">**Veraltet:** Generiert `*.h` `*.c` `*.rc` die Dateien,, und `*_r.h` mithilfe der Windows Vista-Code Vorlagen (generiert perfautoinitialize und perfautocleanup anstelle von counterinitialize und countercleanup).</span><span class="sxs-lookup"><span data-stu-id="8c59b-140">**Deprecated:** Generates `*.h`, `*.c`, `*.rc`, and `*_r.h` files using the Windows Vista code templates (generates PerfAutoInitialize and PerfAutoCleanup instead of CounterInitialize and CounterCleanup).</span></span> <span data-ttu-id="8c59b-141">Dieser Switch kann mit **-memoryroutinen** und **-notificationcallback** verwendet werden, kann aber nicht mit anderen Switches verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-141">This switch can be used with **-MemoryRoutines** and **-NotificationCallback** but cannot be used with any other switches.</span></span> <span data-ttu-id="8c59b-142">Verwenden Sie den Schalter " **-o** " oder " **-RC** " nicht mit diesem Switch.</span><span class="sxs-lookup"><span data-stu-id="8c59b-142">Do not use the **-o** or **-rc** switches with this switch.</span></span> <span data-ttu-id="8c59b-143">Die generierten Dateien werden basierend auf dem Namen des Manifests benannt und in das Verzeichnis geschrieben, das das Manifest enthielt.</span><span class="sxs-lookup"><span data-stu-id="8c59b-143">The generated files will be named based on the name of the manifest and will be written to the directory that contained the manifest.</span></span> <span data-ttu-id="8c59b-144">Verwendung: `CTRPP -legacy OldFile.man`</span><span class="sxs-lookup"><span data-stu-id="8c59b-144">Usage: `CTRPP -legacy OldFile.man`</span></span>

## <a name="remarks"></a><span data-ttu-id="8c59b-145">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="8c59b-145">Remarks</span></span>

<span data-ttu-id="8c59b-146">Das ctrpp-Tool generiert eine `.h` Codedatei, eine `.rc` Ressourcen Datei und generiert optional eine `.h` Symbol Datei.</span><span class="sxs-lookup"><span data-stu-id="8c59b-146">The CTRPP tool generates a `.h` code file, an `.rc` resource file, and optionally generates a `.h` symbol file.</span></span>

### <a name="using-the-generated-resource-file"></a><span data-ttu-id="8c59b-147">Verwenden der generierten Ressourcen Datei</span><span class="sxs-lookup"><span data-stu-id="8c59b-147">Using the generated resource file</span></span>

<span data-ttu-id="8c59b-148">Das ctrpp-Tool generiert eine `.rc` Ressourcen Datei, die die lokalisierbaren Zeichen folgen enthält, die von Consumern der Anbieter-Gegensätze benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-148">The CTRPP tool will generate a `.rc` resource file that contains the localizable strings needed by consumers of the provider's countersets.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8c59b-149">Die Ressourcen aus dieser Datei müssen in der Binärdatei des Anbieters enthalten sein, und der vollständige Pfad zur Binärdatei des Anbieters muss bei der Installation des Anbieter Manifests registriert werden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-149">The resources from this file must be included into your provider binary and the full path to the provider binary must be registered during the installation of your provider's manifest.</span></span> <span data-ttu-id="8c59b-150">Consumer, die die Ressourcen nicht finden und laden können, können die Gegensätze Ihres Anbieters nicht verwenden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-150">Consumers that are unable to locate and load the resources will be unable to use your provider's countersets.</span></span>

<span data-ttu-id="8c59b-151">Die Zeichen folgen Ressourcen sollten wie folgt behandelt werden:</span><span class="sxs-lookup"><span data-stu-id="8c59b-151">The string resources should be handled as follows:</span></span>

- <span data-ttu-id="8c59b-152">Der Entwickler bearbeitet die Anbieter Manifest- `.man` Datei, um das- `applicationIdentity` Attribut des Anbieters auf den Namen der Binärdatei des Anbieters () festzulegen. DLL,. SYS oder. EXE), das die Zeichen folgen Ressourcen für den Anbieter enthält und als Teil der Anbieter Komponente installiert wird.</span><span class="sxs-lookup"><span data-stu-id="8c59b-152">The developer edits the provider manifest (`.man`) file to set the `applicationIdentity` attribute of the provider to the name of a provider binary (.DLL, .SYS, or .EXE) that will contain the string resources for the provider and will be installed as part of the provider component.</span></span>
- <span data-ttu-id="8c59b-153">Das ctrpp-Tool liest das Anbieter Manifest und generiert eine- `.rc` Datei.</span><span class="sxs-lookup"><span data-stu-id="8c59b-153">The CTRPP tool reads the provider manifest and generates an `.rc` file.</span></span>
- <span data-ttu-id="8c59b-154">Mit dem RC-Tool [(Ressourcen Compiler)](../menurc/resource-compiler.md) werden die Daten aus der ctrpp-generierten `.rc` Datei kompiliert, um eine Datei zu generieren, `.res` die die binären Ressourcen enthält.</span><span class="sxs-lookup"><span data-stu-id="8c59b-154">The [RC (resource compiler)](../menurc/resource-compiler.md) tool compiles the data from the CTRPP-generated `.rc` file to generate a `.res` file containing the binary resources.</span></span> <span data-ttu-id="8c59b-155">Dies kann entweder durch direktes Kompilieren der ctrpp-generierten `.rc` Datei oder durch Kompilieren einer anderen `.rc` Datei erfolgen, die die durch ctrpp generierte `.rc` Datei über eine- `#include` Direktive enthält.</span><span class="sxs-lookup"><span data-stu-id="8c59b-155">This can be done either by directly compiling the CTRPP-generated `.rc` file OR by compiling another `.rc` file that includes the CTRPP-generated `.rc` file via an `#include` directive.</span></span>
- <span data-ttu-id="8c59b-156">Der Linker bettet die Daten aus der RC-generierten `.res` Datei in die Binärdatei des Anbieters ein.</span><span class="sxs-lookup"><span data-stu-id="8c59b-156">The linker embeds the data from the RC-generated `.res` file into the provider binary.</span></span>
- <span data-ttu-id="8c59b-157">Während der Installation wird die Binärdatei des Anbieters auf das System des Benutzers kopiert, und das Anbieter Manifest wird mithilfe des [Lodctr-Tools](/windows-server/administration/windows-commands/lodctr)registriert.</span><span class="sxs-lookup"><span data-stu-id="8c59b-157">During installation, the provider binary is copied onto the user's system and the provider manifest is registered using the [lodctr tool](/windows-server/administration/windows-commands/lodctr).</span></span> <span data-ttu-id="8c59b-158">Das lodctr-Tool konvertiert das `applicationIdentity` -Attribut des Anbieter Manifests in einen vollständigen Pfad und zeichnet den vollständigen Pfad zur Binärdatei des Anbieters in der Registrierung auf.</span><span class="sxs-lookup"><span data-stu-id="8c59b-158">The lodctr tool converts the `applicationIdentity` attribute of the provider manifest into a full path and records the full path to the provider binary in the registry.</span></span>
  - <span data-ttu-id="8c59b-159">Wenn sich die Anbieter Binärdatei im selben Verzeichnis wie das Manifest befindet, verwenden Sie: `lodctr.exe /m:"C:\full\manifest\path\manifest.man"` .</span><span class="sxs-lookup"><span data-stu-id="8c59b-159">If the provider binary is in the same directory as the manifest, use: `lodctr.exe /m:"C:\full\manifest\path\manifest.man"`.</span></span> <span data-ttu-id="8c59b-160">lodctr kombiniert den angegebenen manifestressfad mit dem-Attribut des Manifests `applicationIdentity` , um den vollständigen Pfad zu bilden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-160">lodctr will combine the specified manifest path with the manifest's `applicationIdentity` attribute to form the full path.</span></span>
  - <span data-ttu-id="8c59b-161">Verwenden Sie andernfalls `lodctr.exe /m:"C:\full\manifest\path\manifest.man" "c:\full\binary\path"`.</span><span class="sxs-lookup"><span data-stu-id="8c59b-161">Otherwise, use `lodctr.exe /m:"C:\full\manifest\path\manifest.man" "c:\full\binary\path"`.</span></span> <span data-ttu-id="8c59b-162">lodctr kombiniert den angegebenen binären Pfad mit dem-Attribut des Manifests `applicationIdentity` , um den vollständigen Pfad zu bilden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-162">lodctr will combine the specified binary path with the manifest's `applicationIdentity` attribute to form the full path.</span></span>
  - <span data-ttu-id="8c59b-163">Zu Diagnose Zwecken können Sie den aufgezeichneten vollständigen Pfad überprüfen, indem Sie den `ApplicationIdentity` Wert des Registrierungsschlüssels überprüfen `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\_V2Providers\{<ProviderGuid>}` .</span><span class="sxs-lookup"><span data-stu-id="8c59b-163">For diagnostic purposes, you can inspect the recorded full path by checking the `ApplicationIdentity` value of registry key `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\_V2Providers\{<ProviderGuid>}`.</span></span>
  - <span data-ttu-id="8c59b-164">Wenn die Binärdatei MUI für die Lokalisierung verwendet, stellen Sie sicher, dass Sie die MUI-Datei zusammen mit der Binärdatei kopieren.</span><span class="sxs-lookup"><span data-stu-id="8c59b-164">If the binary is using MUI for localization, be sure to copy the MUI file along with the binary.</span></span>
- <span data-ttu-id="8c59b-165">Während der CounterSet-Auflistung verwendet der Consumer den aufgezeichneten vollständigen Pfad zur Anbieter Binärdatei, um die erforderlichen Zeichen folgen aus den Ressourcen der Anbieter Binärdatei zu suchen und zu laden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-165">During counterset collection, the consumer uses the recorded full path to the provider binary to locate and load the necessary strings from the provider binary's resources.</span></span>

### <a name="using-the-generated-code-file-in-a-user-mode-provider"></a><span data-ttu-id="8c59b-166">Verwenden der generierten Codedatei in einem benutzermodusanbieter</span><span class="sxs-lookup"><span data-stu-id="8c59b-166">Using the generated code file in a user-mode provider</span></span>

<span data-ttu-id="8c59b-167">Das ctrpp-Tool generiert eine `.h` C/C++-Codedatei.</span><span class="sxs-lookup"><span data-stu-id="8c59b-167">The CTRPP tool will generate a `.h` C/C++ code file.</span></span> <span data-ttu-id="8c59b-168">Wenn das-Attribut des Anbieter Manifests `providerType` auf festgelegt ist `userMode` , enthält die generierte Codedatei die folgenden Definitionen, die beim Programmieren eines benutzermodusanbieters hilfreich sind:</span><span class="sxs-lookup"><span data-stu-id="8c59b-168">If the provider manifest's `providerType` attribute is set to `userMode`, the generated code file will contain the following definitions that are helpful in coding a user-mode provider:</span></span>

- <span data-ttu-id="8c59b-169">Eine Anbieter Initialisierungsfunktion mit dem Namen [ \* **prefix \* counterinitialize**](counterinitialize.md).</span><span class="sxs-lookup"><span data-stu-id="8c59b-169">An provider initialization function named [\***prefix\*CounterInitialize**](counterinitialize.md).</span></span>
- <span data-ttu-id="8c59b-170">Eine Anbieter Bereinigungs Funktion namens [ \* **prefix \* countercleanup**](countercleanup.md).</span><span class="sxs-lookup"><span data-stu-id="8c59b-170">A provider cleanup function named [\***prefix\*CounterCleanup**](countercleanup.md).</span></span>
- <span data-ttu-id="8c59b-171">Eine Global \***Provider** _-Variable, die das von der _ \*_prefix_CounterInitialize\*\*-Funktion geöffnete Anbieter handle speichert.</span><span class="sxs-lookup"><span data-stu-id="8c59b-171">A global ***provider** _ variable that stores the provider handle opened by the _ *_prefix_CounterInitialize** function.</span></span> <span data-ttu-id="8c59b-172">Der Name der Variablen ist der Wert des- `symbol` Attributs des- `provider` Elements im Manifest.</span><span class="sxs-lookup"><span data-stu-id="8c59b-172">The variable's name is the value of the `symbol` attribute of the `provider` element in the manifest.</span></span> <span data-ttu-id="8c59b-173">Diese Variable sollte in Aufrufen von `PerfCreateInstance` , `PerfDeleteInstance` und anderen APIs zum Steuern der Daten des Anbieters verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-173">This variable should be used in calls to `PerfCreateInstance`, `PerfDeleteInstance`, and other APIs for controlling your provider's data.</span></span>
- <span data-ttu-id="8c59b-174">Für jede CounterSet-Variable eine Global \***CounterSet \* GUID** -Variable mit der Counter Set-GUID.</span><span class="sxs-lookup"><span data-stu-id="8c59b-174">For each counterset, a global \***counterset\*GUID** variable with the counterset GUID.</span></span> <span data-ttu-id="8c59b-175">Der Name der Variablen ist der Wert des `counterSet` `symbol` Attributs des Elements plus des Suffixes "GUID", z. b. `MyCounterSetGUID` .</span><span class="sxs-lookup"><span data-stu-id="8c59b-175">The variable's name is the value of the `counterSet` element's `symbol` attribute plus the suffix "GUID", e.g. `MyCounterSetGUID`.</span></span> <span data-ttu-id="8c59b-176">Diese Variable sollte in Aufrufen von `PerfCreateInstance` , `PerfDeleteInstance` und anderen APIs zum Steuern der Daten des Anbieters verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-176">This variable should be used in calls to `PerfCreateInstance`, `PerfDeleteInstance`, and other APIs for controlling your provider's data.</span></span>
- <span data-ttu-id="8c59b-177">Für jeden Leistungs Bewert ein ***Counter*** -Makro mit dem Wert des Zählers `id` .</span><span class="sxs-lookup"><span data-stu-id="8c59b-177">For each counter, a ***counter*** macro with the counter's `id` value.</span></span> <span data-ttu-id="8c59b-178">Der Name des Makros ist der Wert des `counter` - `symbol` Attributs des Elements.</span><span class="sxs-lookup"><span data-stu-id="8c59b-178">The macro's name is the value of the `counter` element's `symbol` attribute.</span></span> <span data-ttu-id="8c59b-179">Dieses Makro sollte in Aufrufen von `PerfSetCounterRefValue` , `PerfSetULongLongCounterValue` und anderen APIs zum Festlegen der Daten des Anbieters verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="8c59b-179">This macro should be used in calls to `PerfSetCounterRefValue`, `PerfSetULongLongCounterValue`, and other APIs for setting your provider's data.</span></span>

<span data-ttu-id="8c59b-180">In den Funktionsnamen verweist ***prefix*** auf den Wert des `-prefix` Befehlszeilen Parameters.</span><span class="sxs-lookup"><span data-stu-id="8c59b-180">In the function names, ***prefix*** refers to the value of the `-prefix` command-line parameter.</span></span> <span data-ttu-id="8c59b-181">Wenn der `-prefix` -Parameter nicht verwendet wird, werden die Funktionen `CounterInitialize` und benannt `CounterCleanup` .</span><span class="sxs-lookup"><span data-stu-id="8c59b-181">If the `-prefix` parameter is not used the functions will be named `CounterInitialize` and `CounterCleanup`.</span></span>

### <a name="using-the-generated-code-file-in-a-kernel-mode-provider"></a><span data-ttu-id="8c59b-182">Verwenden der generierten Codedatei in einem kernelmodusanbieter</span><span class="sxs-lookup"><span data-stu-id="8c59b-182">Using the generated code file in a kernel-mode provider</span></span>

<span data-ttu-id="8c59b-183">Das ctrpp-Tool generiert eine `.h` C/C++-Codedatei.</span><span class="sxs-lookup"><span data-stu-id="8c59b-183">The CTRPP tool will generate a `.h` C/C++ code file.</span></span> <span data-ttu-id="8c59b-184">Wenn das-Attribut des Anbieter Manifests `providerType` auf festgelegt ist `kernelMode` , enthält die generierte Codedatei die folgenden Definitionen, die beim Codieren der Gegensätze eines Kernel Modus-Anbieters hilfreich sind:</span><span class="sxs-lookup"><span data-stu-id="8c59b-184">If the provider manifest's `providerType` attribute is set to `kernelMode`, the generated code file will contain the following definitions that are helpful in coding a kernel-mode provider's countersets:</span></span>

- <span data-ttu-id="8c59b-185">Eine CounterSet-Initialisierungsfunktion mit dem Namen " <b> *prefix* Register *counter set*</b>".</span><span class="sxs-lookup"><span data-stu-id="8c59b-185">A counterset initialization function named <b>*prefix* Register *Counterset*</b>.</span></span> <span data-ttu-id="8c59b-186">Diese Funktion füllt eine [reginfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) -Struktur aus und ruft dann [pcwregister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwregister)auf, wobei das resultierende CounterSet-Registrierungs Handle in die globale ***CounterSet*** -Variable eingefügt wird.</span><span class="sxs-lookup"><span data-stu-id="8c59b-186">This function fills in a [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) structure then invokes [PcwRegister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwregister), putting the resulting counterset registration handle into the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="8c59b-187">Eine CounterSet-Bereinigungs Funktion namens <b> *prefix* Unregister *CounterSet*</b>.</span><span class="sxs-lookup"><span data-stu-id="8c59b-187">A counterset cleanup function named <b>*prefix* Unregister *Counterset*</b>.</span></span> <span data-ttu-id="8c59b-188">Diese Funktion ruft [pcwunregister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwunregister) für das CounterSet-Registrierungs Handle in der globalen ***CounterSet*** -Variable auf.</span><span class="sxs-lookup"><span data-stu-id="8c59b-188">This function invokes [PcwUnregister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwunregister) on the counterset registration handle in the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="8c59b-189">Eine instanzerstellungs-Funktion mit dem Namen <b> *prefix* Create *CounterSet*</b>.</span><span class="sxs-lookup"><span data-stu-id="8c59b-189">An instance creation function named <b>*prefix* Create *Counterset*</b>.</span></span> <span data-ttu-id="8c59b-190">Diese Funktion füllt ein Array von [pcwdata](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) -Strukturen auf und ruft dann [pcwkreateinstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcreateinstance) mit dem CounterSet-Registrierungs Handle in der globalen ***CounterSet*** -Variable auf.</span><span class="sxs-lookup"><span data-stu-id="8c59b-190">This function fills in an array of [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) structures then invokes [PcwCreateInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcreateinstance) using the counterset registration handle in the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="8c59b-191">Eine instanzbereinigungs Funktion mit dem Namen <b> *prefix* close *CounterSet*</b>.</span><span class="sxs-lookup"><span data-stu-id="8c59b-191">An instance cleanup function named <b>*prefix* Close *Counterset*</b>.</span></span> <span data-ttu-id="8c59b-192">Diese Funktion ruft [pcwcloseinstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcloseinstance)auf.</span><span class="sxs-lookup"><span data-stu-id="8c59b-192">This function invokes [PcwCloseInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcloseinstance).</span></span>
- <span data-ttu-id="8c59b-193">Eine instanzberichterstattungs-Funktion mit dem Namen <b> *prefix* fügt *CounterSet* hinzu</b> , das von der Counter Set-Rückruffunktion verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="8c59b-193">An instance reporting function named <b>*prefix* Add *Counterset*</b> to be used from the counterset callback function.</span></span> <span data-ttu-id="8c59b-194">Diese Funktion füllt ein Array von [pcwdata](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) -Strukturen aus und ruft dann [pcwaddinstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwaddinstance)auf.</span><span class="sxs-lookup"><span data-stu-id="8c59b-194">This function fills in an array of [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) structures then invokes [PcwAddInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwaddinstance).</span></span>
- <span data-ttu-id="8c59b-195">**Windows SDK 20h1 und höher:** Eine reginfo-Initialisierungsfunktion mit dem Namen <b> *prefix* initregistrationinformation *CounterSet*</b> für die Verwendung in erweiterten Szenarien.</span><span class="sxs-lookup"><span data-stu-id="8c59b-195">**Windows SDK 20H1 and later:** A RegInfo initialization function named <b>*prefix* InitRegistrationInformation *Counterset*</b> for use in advanced scenarios.</span></span> <span data-ttu-id="8c59b-196">Diese Funktion füllt eine [reginfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) -Struktur aus.</span><span class="sxs-lookup"><span data-stu-id="8c59b-196">This function fills in a [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) structure.</span></span> <span data-ttu-id="8c59b-197">Diese Funktion kann in Fällen verwendet werden, in denen das generierte <b> *Präfix für die Präfix* Registrierung nicht</b> Ihren Anforderungen entspricht, z. b. Wenn Sie die Werte in der reginfo-Struktur anpassen oder das zurückgegebene Handle in einer anderen Variablen speichern möchten.</span><span class="sxs-lookup"><span data-stu-id="8c59b-197">This function can be used in cases where the generated <b>*prefix* Register *Counterset*</b> does not meet your needs, e.g. when you want to customize the values in the RegInfo structure or when you want to store the returned handle in another variable.</span></span>

<span data-ttu-id="8c59b-198">In den Funktionsnamen verweist ***prefix*** auf den Wert des `-prefix` Befehlszeilen Parameters.</span><span class="sxs-lookup"><span data-stu-id="8c59b-198">In the function names, ***prefix*** refers to the value of the `-prefix` command-line parameter.</span></span> <span data-ttu-id="8c59b-199">Wenn der- `-prefix` Parameter nicht verwendet wird, haben die Funktionen kein Präfix.</span><span class="sxs-lookup"><span data-stu-id="8c59b-199">If the `-prefix` parameter is not used the functions will have no prefix.</span></span>

> [!NOTE]
> <span data-ttu-id="8c59b-200">Die generierte <b> *prefix\*\*counter set*</b> -Funktion wird verwendet, wenn Sie über einen CounterSet-Rückruf verfügen.</span><span class="sxs-lookup"><span data-stu-id="8c59b-200">The generated <b>*prefix* Add *Counterset*</b> function is used when you have a counterset callback.</span></span> <span data-ttu-id="8c59b-201">Die generierten <b> *Präfix* Create *CounterSet*</b> -und <b> *prefix* close *CounterSet*</b> -Funktionen werden verwendet, wenn Sie über keinen CounterSet-Rückruf verfügen.</span><span class="sxs-lookup"><span data-stu-id="8c59b-201">The generated <b>*prefix* Create *Counterset*</b> and <b>*prefix* Close *Counterset*</b> functions are used when you do not have a counterset callback.</span></span>

### <a name="using-the-generated-symbol-file"></a><span data-ttu-id="8c59b-202">Verwenden der generierten Symbol Datei</span><span class="sxs-lookup"><span data-stu-id="8c59b-202">Using the generated symbol file</span></span>

<span data-ttu-id="8c59b-203">Wenn der Parameter **-ch** in der Befehlszeile angegeben wird, generiert das ctrpp-Tool eine `.h` Symbol Datei.</span><span class="sxs-lookup"><span data-stu-id="8c59b-203">If the **-ch** parameter is specified on the command line, the CTRPP tool will generate a `.h` symbol file.</span></span> <span data-ttu-id="8c59b-204">Diese Datei enthält die C/C++-Symbole für die Namen und GUIDs der einzelnen Gegensätze im Anbieter.</span><span class="sxs-lookup"><span data-stu-id="8c59b-204">This file contains the C/C++ symbols for the names and GUIDs of each counterset in the provider.</span></span> <span data-ttu-id="8c59b-205">Die Symbole können verwendet werden, wenn Programme geschrieben werden, die hart codiert sind, um die Daten aus dieser gegen Menge mit den [Perflib v2-consumerfunktionen](using-the-perflib-functions-to-consume-counter-data.md)zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="8c59b-205">The symbols can be used when writing programs that are hard-coded to consume the data from this counterset using the [PerfLib V2 Consumer functions](using-the-perflib-functions-to-consume-counter-data.md).</span></span>

## <a name="requirements"></a><span data-ttu-id="8c59b-206">Anforderungen</span><span class="sxs-lookup"><span data-stu-id="8c59b-206">Requirements</span></span>

|                         ||
|-------------------------|----
| <span data-ttu-id="8c59b-207">Unterstützte Mindestversion (Client)</span><span class="sxs-lookup"><span data-stu-id="8c59b-207">Minimum supported client</span></span>| <span data-ttu-id="8c59b-208">Nur Windows Vista \[ -Desktop-Apps\]</span><span class="sxs-lookup"><span data-stu-id="8c59b-208">Windows Vista \[desktop apps only\]</span></span>
| <span data-ttu-id="8c59b-209">Unterstützte Mindestversion (Server)</span><span class="sxs-lookup"><span data-stu-id="8c59b-209">Minimum supported server</span></span>| <span data-ttu-id="8c59b-210">Nur Windows Server 2008 \[ -Desktop-Apps\]</span><span class="sxs-lookup"><span data-stu-id="8c59b-210">Windows Server 2008 \[desktop apps only\]</span></span>
