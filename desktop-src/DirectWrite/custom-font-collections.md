---
title: Benutzerdefinierte Schriftart Auflistungen (Windows 7/8)
description: DirectWrite ermöglicht mithilfe der getsystemfontcollection-Methode von idschreitefactory den Zugriff auf die System Schriftart Auflistung.
ms.assetid: ec892904-6778-4fbd-93b4-62d0db5b82ea
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39aa764330f27b72051ef682c6ce5f1176c42c7d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/20/2020
ms.locfileid: "103728681"
---
# <a name="custom-font-collections-windows-78"></a><span data-ttu-id="ce10a-103">Benutzerdefinierte Schriftart Auflistungen (Windows 7/8)</span><span class="sxs-lookup"><span data-stu-id="ce10a-103">Custom Font Collections (Windows 7/8)</span></span>

<span data-ttu-id="ce10a-104">[DirectWrite](direct-write-portal.md) ermöglicht mithilfe der [**idwrite-Factory:: getsystemfontcollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection) -Methode den Zugriff auf die System Schriftart Auflistung.</span><span class="sxs-lookup"><span data-stu-id="ce10a-104">[DirectWrite](direct-write-portal.md) provides access to the system font collection by using the [**IDWriteFactory::GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection) method.</span></span> <span data-ttu-id="ce10a-105">Dies ist die am häufigsten verwendete Schriftart Auflistung.</span><span class="sxs-lookup"><span data-stu-id="ce10a-105">This is the font collection that is most frequently used.</span></span> <span data-ttu-id="ce10a-106">Einige Anwendungen müssen jedoch Schriftarten verwenden, die nicht auf dem System installiert sind, z. b. aus enthaltenen Schriftart Dateien oder Schriftart Dateien, die in die Anwendung eingebettet sind.</span><span class="sxs-lookup"><span data-stu-id="ce10a-106">However some applications have to use fonts that are not installed on the system, such as from included font files or font files embedded in the application.</span></span>

<span data-ttu-id="ce10a-107">Wenn sich die gewünschten Schriftarten nicht in der System Schriftart Auflistung befinden, können Sie eine benutzerdefinierte Schriftart Sammlung erstellen, die von " [**idschreitefontcollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection)" abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="ce10a-107">If the fonts that you want are not in the system font collection, you can create a custom font collection derived from [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection).</span></span>

<span data-ttu-id="ce10a-108">Diese Übersicht besteht aus den folgenden Teilen:</span><span class="sxs-lookup"><span data-stu-id="ce10a-108">This overview consists of the following parts:</span></span>

-   [<span data-ttu-id="ce10a-109">Registrieren und Aufheben der Registrierung eines Schriftart Sammlungs Lade Moduls</span><span class="sxs-lookup"><span data-stu-id="ce10a-109">Registering and unregistering a Font Collection Loader</span></span>](#registering-and-unregistering-a-font-collection-loader)
-   [<span data-ttu-id="ce10a-110">Idschreitefontcollectionloader</span><span class="sxs-lookup"><span data-stu-id="ce10a-110">IDWriteFontCollectionLoader</span></span>](#idwritefontcollectionloader)
-   [<span data-ttu-id="ce10a-111">Idschreitefontfileenumerator</span><span class="sxs-lookup"><span data-stu-id="ce10a-111">IDWriteFontFileEnumerator</span></span>](#idwritefontfileenumerator)
-   [<span data-ttu-id="ce10a-112">"Kreatecustomfontfilereferenzierung"</span><span class="sxs-lookup"><span data-stu-id="ce10a-112">CreateCustomFontFileReference</span></span>](#createcustomfontfilereference)
-   [<span data-ttu-id="ce10a-113">Idschreitefontfileloader</span><span class="sxs-lookup"><span data-stu-id="ce10a-113">IDWriteFontFileLoader</span></span>](#idwritefontfileloader)
-   [<span data-ttu-id="ce10a-114">Idschreitefontfilestream</span><span class="sxs-lookup"><span data-stu-id="ce10a-114">IDWriteFontFileStream</span></span>](#idwritefontfilestream)

## <a name="registering-and-unregistering-a-font-collection-loader"></a><span data-ttu-id="ce10a-115">Registrieren und Aufheben der Registrierung eines Schriftart Sammlungs Lade Moduls</span><span class="sxs-lookup"><span data-stu-id="ce10a-115">Registering and unregistering a Font Collection Loader</span></span>

<span data-ttu-id="ce10a-116">Sie registrieren ein Schriftart Sammlungs Lade Tool mithilfe der [**idwrite-Factory:: registerfontcollectionloader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-registerfontcollectionloader) -Methode, und übergeben Sie eine [**idschreitefontcollectionloader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) -Schnittstelle, die von der Anwendung als Singleton-Objekt implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="ce10a-116">You register a font collection loader by using the [**IDWriteFactory::RegisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-registerfontcollectionloader) method and passing it an [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) interface implemented by the application as a singleton object.</span></span> <span data-ttu-id="ce10a-117">Dieses Objekt lädt die Schriftarten, wenn die benutzerdefinierte Auflistung angefordert wird.</span><span class="sxs-lookup"><span data-stu-id="ce10a-117">This object will load the fonts when the custom collection is requested.</span></span> <span data-ttu-id="ce10a-118">Sowohl die System Schriftart Auflistung als auch benutzerdefinierte Schriftart Sammlungen werden zwischengespeichert, sodass die Schriftarten nur einmal geladen werden.</span><span class="sxs-lookup"><span data-stu-id="ce10a-118">Both the system font collection and custom font collections are cached, so the fonts are only loaded one time.</span></span>

<span data-ttu-id="ce10a-119">Das Schriftart Sammlungs Lade Tool muss schließlich mithilfe von [**idwrite-Factory:: unregisterfontcollectionloader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader)entladen werden.</span><span class="sxs-lookup"><span data-stu-id="ce10a-119">The font collection loader must be unloaded eventually by using the [**IDWriteFactory::UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader).</span></span>

> [!Note]  
> <span data-ttu-id="ce10a-120">Beim Registrieren des Lade Moduls für Schriftart Sammlungen wird der Verweis Zähler hinzugefügt. [**unregisterfontcollectionloader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader) kann nicht innerhalb des Dekonstruktors aufgerufen werden, oder das Auflistungs Lade Objekt wird nie die Registrierung aufheben.</span><span class="sxs-lookup"><span data-stu-id="ce10a-120">Registering the font collection loader adds to the reference count; do not call [**UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader) from within the destructor or the collection loader object will never be unregistered.</span></span>

 

## <a name="idwritefontcollectionloader"></a><span data-ttu-id="ce10a-121">Idschreitefontcollectionloader</span><span class="sxs-lookup"><span data-stu-id="ce10a-121">IDWriteFontCollectionLoader</span></span>

<span data-ttu-id="ce10a-122">Sie erstellen ein [**idwrite-fontfileenumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) -Objekt, indem Sie die [**idwrite-Factory:: anatecustomfontcollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) verwenden und ihr einen Anwendungs definierten Schlüssel übergeben.</span><span class="sxs-lookup"><span data-stu-id="ce10a-122">You create an [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) object by using the [**IDWriteFactory::CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) and passing it an application-defined key.</span></span> <span data-ttu-id="ce10a-123">Der Schlüssel ist ein void-Zeiger, und der Datentyp, das Format und die Bedeutung werden von der Anwendung definiert und sind für das Schriftart System nicht transparent.</span><span class="sxs-lookup"><span data-stu-id="ce10a-123">The key is a void pointer and the data type, format, and meaning are defined by the application and are opaque to the font system.</span></span>

<span data-ttu-id="ce10a-124">Der Schlüssel kann ein beliebiger Schlüssel sein, aber für [DirectWrite](direct-write-portal.md) ist Folgendes erforderlich:</span><span class="sxs-lookup"><span data-stu-id="ce10a-124">Whereas the key can be anything, [DirectWrite](direct-write-portal.md) requires that each key is both:</span></span>

-   <span data-ttu-id="ce10a-125">Eindeutig für eine einzelne Schriftart Auflistung innerhalb des Gültigkeits Bereichs des Lade Moduls.</span><span class="sxs-lookup"><span data-stu-id="ce10a-125">Unique to a single font collection within the scope of the loader.</span></span>
-   <span data-ttu-id="ce10a-126">Gültig, bis die Registrierung des Lade Moduls mithilfe der Factory aufgehoben wird.</span><span class="sxs-lookup"><span data-stu-id="ce10a-126">Valid until the loader is unregistered using the factory.</span></span>

<span data-ttu-id="ce10a-127">Wenn die Methode " [**samatecustomfontcollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) " aufgerufen wird, ruft [DirectWrite](direct-write-portal.md) an eine [**idschreitefontcollectionloader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) -Schnittstelle zurück, die von der Anwendung als Singleton-Objekt implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="ce10a-127">When the [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) method is called, [DirectWrite](direct-write-portal.md) calls back to an [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) interface implemented as a singleton object by the application.</span></span> <span data-ttu-id="ce10a-128">Die [**idwrite-fontcollectionloader::**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) -Rückruf Methode wird von DirectWrite zum Abrufen eines [**idwrite-fontfileenumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) -Objekts verwendet, das von der Anwendung implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="ce10a-128">The [**IDWriteFontCollectionLoader::CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) callback method is used by DirectWrite to retrieve an [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) object implemented by the application.</span></span> <span data-ttu-id="ce10a-129">Das [**idwrite-Factory**](/windows/win32/api/dwrite/nn-dwrite-idwritefactory) -Objekt, das zum Erstellen der Auflistung verwendet wird, wird an diese Methode übermittelt und sollte vom Schriftart Datei-Enumerator verwendet werden, um die [**idwrite-fontfile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) -Objekte zu erstellen, die in die Auflistung eingeschlossen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="ce10a-129">The [**IDWriteFactory**](/windows/win32/api/dwrite/nn-dwrite-idwritefactory) object that is being used to create the collection is passed to this method and should be used by the font file enumerator to create the [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) objects to be included in the collection.</span></span>

<span data-ttu-id="ce10a-130">Der an diese Methode über gegebene Schlüssel identifiziert die Schriftart Auflistung und ist derselbe Schlüssel, der an die Datei " [**kreatecustomfontcollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection)" übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="ce10a-130">The key passed to this method identifies the font collection and is the same key passed to [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection).</span></span>

## <a name="idwritefontfileenumerator"></a><span data-ttu-id="ce10a-131">Idschreitefontfileenumerator</span><span class="sxs-lookup"><span data-stu-id="ce10a-131">IDWriteFontFileEnumerator</span></span>

<span data-ttu-id="ce10a-132">Das Anwendungs definierte [**idwrite-fontfileenumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) -Objekt, das von der Methode " [**forateenumeratorfromkey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) " erstellt wurde, wird zum Auflisten der Schriftart Dateien in einer Auflistung verwendet und erstellt ein [**idwrite-fontfile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) -Objekt für jede Datei.</span><span class="sxs-lookup"><span data-stu-id="ce10a-132">The application-defined [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) object that was created by the [**CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) method is used to enumerate the font files in a collection, creating an [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object for each file.</span></span> <span data-ttu-id="ce10a-133">Die [**idwrite-fontfileenumerator:: arvenext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) -Methode ändert die Position in die nächste Schriftart Datei.</span><span class="sxs-lookup"><span data-stu-id="ce10a-133">The [**IDWriteFontFileEnumerator::MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) method changes the position to the next font file.</span></span> <span data-ttu-id="ce10a-134">Wenn an der Position eine Datei vorhanden ist, wird " *hascurrentfile* " auf " **true**" festgelegt.</span><span class="sxs-lookup"><span data-stu-id="ce10a-134">If there is a file at the position, it will set the *hasCurrentFile* to **TRUE**.</span></span> <span data-ttu-id="ce10a-135">Andernfalls wird Sie auf " **false** " festgelegt, und die Methode gibt " **S \_ OK**" zurück.</span><span class="sxs-lookup"><span data-stu-id="ce10a-135">Otherwise it will be set to **FALSE** and the method will return **S\_OK**.</span></span>

> [!Note]  
> <span data-ttu-id="ce10a-136">Der Enumerator für Schriftart Dateien muss vor dem ersten Element positioniert und beim ersten-Befehl von " [**muvenext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext)" erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="ce10a-136">The font file enumerator must start positioned before the first element and advanced at the first call to [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext).</span></span>

 

<span data-ttu-id="ce10a-137">Ein [**idwrite-fontfile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) -Objekt wird von der [**idschreitefontfileenumerator:: getcurrentfontfile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) -Methode ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="ce10a-137">An [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object is output by the [**IDWriteFontFileEnumerator::GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) method.</span></span> <span data-ttu-id="ce10a-138">Wenn an der aktuellen Position keine Schriftart Datei vorhanden ist, da " [**muvenext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) " noch nicht aufgerufen wurde oder hascurrentfile auf **false** festgelegt wurde, gibt **getcurrentfontfile** den Wert **E \_ Fail** zurück.</span><span class="sxs-lookup"><span data-stu-id="ce10a-138">If there is no font file at the current position, because [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) has not yet been called or hasCurrentFile was set to **FALSE**, then **GetCurrentFontFile** will return **E\_FAIL**.</span></span>

## <a name="createcustomfontfilereference"></a><span data-ttu-id="ce10a-139">"Kreatecustomfontfilereferenzierung"</span><span class="sxs-lookup"><span data-stu-id="ce10a-139">CreateCustomFontFileReference</span></span>

<span data-ttu-id="ce10a-140">Das [**idwrite-fontfile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) -Objekt, das von [**getcurrentfontfile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) ausgegeben wird, kann durch Aufrufen von " [**idwrite tefactory:: createcustomfontfilereferenzierung**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference)" erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="ce10a-140">The [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object output by [**GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) can be created by calling [**IDWriteFactory::CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference).</span></span> <span data-ttu-id="ce10a-141">Der Verweis Schlüssel der Schriftart Datei identifiziert einen bestimmten Schriftart Datei Verweis und muss innerhalb des Schriftart Datei Lade Moduls eindeutig sein, das die Datei lädt.</span><span class="sxs-lookup"><span data-stu-id="ce10a-141">The font file reference key identifies a specific font file reference and must be unique within the font file loader that will load the file.</span></span>

## <a name="idwritefontfileloader"></a><span data-ttu-id="ce10a-142">Idschreitefontfileloader</span><span class="sxs-lookup"><span data-stu-id="ce10a-142">IDWriteFontFileLoader</span></span>

<span data-ttu-id="ce10a-143">Die Methode " [**kreatecustomfontfilereferenzierung**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference) " nimmt ein von der Anwendung implementiertes [**idschreitefontfileloader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileloader) -Objekt an, das zum Laden der Schriftart verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="ce10a-143">The [**CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference) method takes an [**IDWriteFontFileLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileloader) object implemented by the application that is used to load the font.</span></span> <span data-ttu-id="ce10a-144">Der " [**idwrite:: deestreamfromkey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileloader-createstreamfromkey) "-Rückruf Methode wird der Schlüssel übergeben und ein " [**idschreitefontfilestream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) "-Objekt ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="ce10a-144">The [**IDWriteFontFileLoader::CreateStreamFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileloader-createstreamfromkey) callback method is passed the key and outputs an [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) object.</span></span>

## <a name="idwritefontfilestream"></a><span data-ttu-id="ce10a-145">Idschreitefontfilestream</span><span class="sxs-lookup"><span data-stu-id="ce10a-145">IDWriteFontFileStream</span></span>

<span data-ttu-id="ce10a-146">Das von der Anwendung implementierte [**idschreitefontfilestream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) -Objekt stellt die Schriftart Datei Daten für einen Schriftart Datei Verweis von einem benutzerdefinierten Schriftart Datei Lade Tool bereit.</span><span class="sxs-lookup"><span data-stu-id="ce10a-146">The application-implemented [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) object provides the font file data for a font file reference from a custom font file loader.</span></span> <span data-ttu-id="ce10a-147">Zusammen mit der Dateigröße und dem Zeitpunkt des letzten Schreibvorgangs stellt Sie eine Methode ("[**infofilefragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment)") zum Abrufen von Datei Fragmenten bereit, die in ein " [**idschreitefontfile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) "-Objekt kompiliert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="ce10a-147">Together with the file size and last write time, it provides a method ([**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment)) for retrieving file fragments that are to be compiled into an [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object.</span></span>

> [!Note]  
> <span data-ttu-id="ce10a-148">Die Implementierung von "read [**filefragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment) " sollte einen Fehler zurückgeben, wenn das angeforderte Fragment außerhalb der Datei Begrenzungen liegt.</span><span class="sxs-lookup"><span data-stu-id="ce10a-148">[**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment) implementations should return an error if the requested fragment is outside the file bounds.</span></span>

 

<span data-ttu-id="ce10a-149">Ein [**idwrite-fontfilestream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) kann den Inhalt der Schriftart Datei von einem beliebigen Standort aus aufrufen, z. b. von der lokalen Festplatte oder von eingebetteten Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="ce10a-149">An [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) can get the font file contents from anywhere, such as the local hard disk drive, or embedded resources.</span></span>

 

 