---
description: Die Kommunikation umfasst häufig große Datenmengen oder Daten mit unbekannter Länge.
ms.assetid: e7b12b9e-8caa-4dad-b81f-b609ccb92c9f
title: Verwenden von secbufferde SC und secbuffer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3ca7d8155a610263838d2baf2a7d1c8fc96ec874
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "103867236"
---
# <a name="using-secbufferdesc-and-secbuffer"></a><span data-ttu-id="b5612-103">Verwenden von secbufferde SC und secbuffer</span><span class="sxs-lookup"><span data-stu-id="b5612-103">Using SecBufferDesc and SecBuffer</span></span>

<span data-ttu-id="b5612-104">Die Kommunikation umfasst häufig große Datenmengen oder Daten mit unbekannter Länge.</span><span class="sxs-lookup"><span data-stu-id="b5612-104">Communication often involves potentially large amounts of data or data of unknown length.</span></span> <span data-ttu-id="b5612-105">Das Senden und empfangen von Daten erfolgt in beiden Fällen ähnlich oder identisch.</span><span class="sxs-lookup"><span data-stu-id="b5612-105">Sending and receiving data is done in similar or identical fashion in both of these cases.</span></span> <span data-ttu-id="b5612-106">Für den Umgang mit unbekannter Länge und potenziell großen Datenmengen erfolgt die SSPI-Kommunikation mithilfe der beiden Strukturen [**secbufferdesc**](/windows/desktop/api/Sspi/ns-sspi-secbufferdesc) und [**secbuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer).</span><span class="sxs-lookup"><span data-stu-id="b5612-106">To deal with unknown length and potentially large amounts of data, SSPI communication is done using two structures, [**SecBufferDesc**](/windows/desktop/api/Sspi/ns-sspi-secbufferdesc) and [**SecBuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer).</span></span>

<span data-ttu-id="b5612-107">Eine [**secbufferdebug**](/windows/desktop/api/Sspi/ns-sspi-secbufferdesc) -Struktur ist ein Container für ein Array von [**secbuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) -Strukturen.</span><span class="sxs-lookup"><span data-stu-id="b5612-107">A [**SecBufferDesc**](/windows/desktop/api/Sspi/ns-sspi-secbufferdesc) structure is a container for an array of [**SecBuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) structures.</span></span> <span data-ttu-id="b5612-108">Eine **secbufferdebug** -Struktur verfügt über die folgenden Member:</span><span class="sxs-lookup"><span data-stu-id="b5612-108">A **SecBufferDesc** structure has the following members:</span></span>

-   <span data-ttu-id="b5612-109">Versionsnummer</span><span class="sxs-lookup"><span data-stu-id="b5612-109">Version number</span></span>
-   <span data-ttu-id="b5612-110">Anzahl der [**secbuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) -Elemente</span><span class="sxs-lookup"><span data-stu-id="b5612-110">Number of [**SecBuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) elements</span></span>
-   <span data-ttu-id="b5612-111">Adresse des Arrays der [**secbuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) -Strukturen</span><span class="sxs-lookup"><span data-stu-id="b5612-111">Address of the array of [**SecBuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) structures</span></span>

<span data-ttu-id="b5612-112">Eine [**secbuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) -Struktur enthält die folgenden drei Elemente:</span><span class="sxs-lookup"><span data-stu-id="b5612-112">A [**SecBuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) structure contains the following three members:</span></span>

-   <span data-ttu-id="b5612-113">Anzahl von Bytes im Puffer</span><span class="sxs-lookup"><span data-stu-id="b5612-113">Number of bytes in the buffer</span></span>
-   <span data-ttu-id="b5612-114">Der Typ der Informationen, die im Datenelement enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="b5612-114">Type of information contained in the data item</span></span>
-   <span data-ttu-id="b5612-115">Die Bytes selbst</span><span class="sxs-lookup"><span data-stu-id="b5612-115">The bytes themselves</span></span>

<span data-ttu-id="b5612-116">Eine gesamte SSPI-Nachricht besteht häufig aus einem Array von [**secbuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) -Strukturen.</span><span class="sxs-lookup"><span data-stu-id="b5612-116">A whole SSPI message often consists of an array of [**SecBuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) structures.</span></span>

<span data-ttu-id="b5612-117">Die folgenden Puffer Datentypen werden wie folgt definiert.</span><span class="sxs-lookup"><span data-stu-id="b5612-117">The following buffer data types are defined as follows.</span></span>



| <span data-ttu-id="b5612-118">Puffertyp</span><span class="sxs-lookup"><span data-stu-id="b5612-118">Buffer type</span></span>                | <span data-ttu-id="b5612-119">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="b5612-119">Meaning</span></span>                                                                                                                                |
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b5612-120">secbuffer ist \_ leer.</span><span class="sxs-lookup"><span data-stu-id="b5612-120">SECBUFFER\_EMPTY</span></span>           | <span data-ttu-id="b5612-121">Nicht definiert, ersetzt durch die Funktion des [*Sicherheitspakets*](../secgloss/s-gly.md)</span><span class="sxs-lookup"><span data-stu-id="b5612-121">Undefined, replaced by the [*security package*](../secgloss/s-gly.md) function</span></span> |
| <span data-ttu-id="b5612-122">secbuffer- \_ Daten</span><span class="sxs-lookup"><span data-stu-id="b5612-122">SECBUFFER\_DATA</span></span>            | <span data-ttu-id="b5612-123">Paketdaten</span><span class="sxs-lookup"><span data-stu-id="b5612-123">Packet data</span></span>                                                                                                                            |
| <span data-ttu-id="b5612-124">secbuffer- \_ Token</span><span class="sxs-lookup"><span data-stu-id="b5612-124">SECBUFFER\_TOKEN</span></span>           | <span data-ttu-id="b5612-125">Sicherheits Token</span><span class="sxs-lookup"><span data-stu-id="b5612-125">Security token</span></span>                                                                                                                         |
| <span data-ttu-id="b5612-126">secbuffer \_ pkg-Parameter \_</span><span class="sxs-lookup"><span data-stu-id="b5612-126">SECBUFFER\_PKG\_PARAMS</span></span>     | <span data-ttu-id="b5612-127">Paket spezifische Parameter</span><span class="sxs-lookup"><span data-stu-id="b5612-127">Package-specific parameters</span></span>                                                                                                            |
| <span data-ttu-id="b5612-128">secbuffer \_ fehlt.</span><span class="sxs-lookup"><span data-stu-id="b5612-128">SECBUFFER\_MISSING</span></span>         | <span data-ttu-id="b5612-129">Fehlender Daten Indikator</span><span class="sxs-lookup"><span data-stu-id="b5612-129">Missing data indicator</span></span>                                                                                                                 |
| <span data-ttu-id="b5612-130">secbuffer- \_ Zusatz</span><span class="sxs-lookup"><span data-stu-id="b5612-130">SECBUFFER\_EXTRA</span></span>           | <span data-ttu-id="b5612-131">Zusätzliche Daten</span><span class="sxs-lookup"><span data-stu-id="b5612-131">Extra data</span></span>                                                                                                                             |
| <span data-ttu-id="b5612-132">secbuffer- \_ Stream</span><span class="sxs-lookup"><span data-stu-id="b5612-132">SECBUFFER\_STREAM</span></span>          | <span data-ttu-id="b5612-133">Sicherheitsstreamdaten</span><span class="sxs-lookup"><span data-stu-id="b5612-133">Security stream data</span></span>                                                                                                                   |
| <span data-ttu-id="b5612-134">secbuffer- \_ streamnachspann \_</span><span class="sxs-lookup"><span data-stu-id="b5612-134">SECBUFFER\_STREAM\_TRAILER</span></span> | <span data-ttu-id="b5612-135">Sicherheitsstreamnachspann</span><span class="sxs-lookup"><span data-stu-id="b5612-135">Security stream trailer</span></span>                                                                                                                |
| <span data-ttu-id="b5612-136">secbuffer \_ - \_ Streamheader</span><span class="sxs-lookup"><span data-stu-id="b5612-136">SECBUFFER\_STREAM\_HEADER</span></span>  | <span data-ttu-id="b5612-137">Sicherheitsstreamheader</span><span class="sxs-lookup"><span data-stu-id="b5612-137">Security stream header</span></span>                                                                                                                 |



 

<span data-ttu-id="b5612-138">Die Puffer Typen oben können mit einem bitweisen **or** -Vorgang mit einem der folgenden Puffer Typen kombiniert werden.</span><span class="sxs-lookup"><span data-stu-id="b5612-138">The buffer types above can be combined using a bitwise-**OR** operation with either of the following buffer types.</span></span>



| <span data-ttu-id="b5612-139">Puffertyp</span><span class="sxs-lookup"><span data-stu-id="b5612-139">Buffer type</span></span>         | <span data-ttu-id="b5612-140">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="b5612-140">Meaning</span></span>                                                                          |
|---------------------|----------------------------------------------------------------------------------|
| <span data-ttu-id="b5612-141">secbuffer- \_ attrmask</span><span class="sxs-lookup"><span data-stu-id="b5612-141">SECBUFFER\_ATTRMASK</span></span> | <span data-ttu-id="b5612-142">Maskieren von Sicherheits Attributen Durchtrennen der Attributflags vom Puffertyp.</span><span class="sxs-lookup"><span data-stu-id="b5612-142">Mask security attributes by separating the attribute flags from the buffer type.</span></span> |
| <span data-ttu-id="b5612-143">secbuffer \_ schreibgeschützt</span><span class="sxs-lookup"><span data-stu-id="b5612-143">SECBUFFER\_READONLY</span></span> | <span data-ttu-id="b5612-144">Der Puffer ist schreibgeschützt.</span><span class="sxs-lookup"><span data-stu-id="b5612-144">Buffer is read-only</span></span>                                                              |



 

<span data-ttu-id="b5612-145">Vor jedem Aufrufen einer SSPI-API, die einen [**secbufferdesc**](/windows/desktop/api/Sspi/ns-sspi-secbufferdesc) -Parameter erfordert, werden ein oder mehrere [**secbuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) -Array Elemente deklariert und initialisiert.</span><span class="sxs-lookup"><span data-stu-id="b5612-145">Before each call to an SSPI API that requires a [**SecBufferDesc**](/windows/desktop/api/Sspi/ns-sspi-secbufferdesc) parameter, one or more [**SecBuffer**](/windows/desktop/api/Sspi/ns-sspi-secbuffer) array elements are declared and initialized.</span></span> <span data-ttu-id="b5612-146">Es können z. b. zwei Sicherheitspuffer vorhanden sein: eine mit Eingabe Nachrichten Daten und die andere für das vom Sicherheitspaket zurückgegebene, nicht transparente Sicherheits Token.</span><span class="sxs-lookup"><span data-stu-id="b5612-146">For example, there can be two security buffers: one that contains input message data and the other for the output opaque security token returned by the security package.</span></span> <span data-ttu-id="b5612-147">Die Reihenfolge der Sicherheitspuffer im Sicherheitspuffer Deskriptor ist nicht wichtig, aber jeder Puffer muss mit dem entsprechenden Typ gekennzeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="b5612-147">The order of security buffers in the security buffer descriptor is not important, but each buffer must be tagged with its appropriate type.</span></span> <span data-ttu-id="b5612-148">Ein Schreib geschütztes-Tag kann mit jedem Eingabepuffer verwendet werden, der nicht vom [*Sicherheitspaket*](../secgloss/s-gly.md)geändert werden darf.</span><span class="sxs-lookup"><span data-stu-id="b5612-148">A read-only tag can be used with any input buffer that must not be modified by the [*security package*](../secgloss/s-gly.md).</span></span>

<span data-ttu-id="b5612-149">Die Größe des Ausgabepuffers, der das Sicherheits Token enthalten soll, ist wichtig.</span><span class="sxs-lookup"><span data-stu-id="b5612-149">The size of the output buffer that is expected to contain the security token is important.</span></span> <span data-ttu-id="b5612-150">Eine Anwendung kann die maximale Tokengröße für ein Sicherheitspaket während des ersten Setups ermitteln.</span><span class="sxs-lookup"><span data-stu-id="b5612-150">An application can find the maximum token size for a security package during initial setup.</span></span> <span data-ttu-id="b5612-151">Der- [**enumeratesecuritypackages-Enumerationstyp**](/windows/desktop/api/Sspi/nf-sspi-enumeratesecuritypackagesa) gibt ein Array von Zeigern auf Sicherheitspaket Informationen zurück.</span><span class="sxs-lookup"><span data-stu-id="b5612-151">The call to [**EnumerateSecurityPackages**](/windows/desktop/api/Sspi/nf-sspi-enumeratesecuritypackagesa) returns an array of pointers to security package information.</span></span> <span data-ttu-id="b5612-152">Die Struktur der Sicherheitspaket Informationen enthält die maximale Tokengröße für jedes Paket.</span><span class="sxs-lookup"><span data-stu-id="b5612-152">The security package information structure contains the maximum token size for each package.</span></span> <span data-ttu-id="b5612-153">In diesem Beispiel befinden sich die Informationen im **cbmaxtoken** -Member der [**secpkginfo**](/windows/desktop/api/Sspi/ns-sspi-secpkginfoa) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="b5612-153">In the example, the information is in the **cbMaxToken** member of the [**SecPkgInfo**](/windows/desktop/api/Sspi/ns-sspi-secpkginfoa) structure.</span></span> <span data-ttu-id="b5612-154">Die gleichen Informationen können später mithilfe von [**querysecuritypackageinfo**](/windows/desktop/api/Sspi/nf-sspi-querysecuritypackageinfoa)abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="b5612-154">The same information can be obtained later using [**QuerySecurityPackageInfo**](/windows/desktop/api/Sspi/nf-sspi-querysecuritypackageinfoa).</span></span>

<span data-ttu-id="b5612-155">Die Anwendung initialisiert die Puffer Zeiger und-Größen in der Puffer Beschreibung, um anzugeben, wo Nachrichten Daten und andere Informationen gefunden werden können.</span><span class="sxs-lookup"><span data-stu-id="b5612-155">The application initializes the buffer pointers and sizes in the buffer description to indicate where message data and other information can be found.</span></span>

<span data-ttu-id="b5612-156">Weitere Informationen finden Sie unter [Beispiel Code für secbuffer und secbufferdesc](secbuffer-and-secbufferdesc-example-code.md).</span><span class="sxs-lookup"><span data-stu-id="b5612-156">For details, see [SecBuffer and SecBufferDesc Example Code](secbuffer-and-secbufferdesc-example-code.md).</span></span>

 

 
