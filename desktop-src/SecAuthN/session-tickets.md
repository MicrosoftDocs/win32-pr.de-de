---
description: Anstatt die verschlüsselten Sitzungsschlüssel an beide Prinzipale zu senden, sendet der KDC sowohl den Client-als auch die Server Kopien des Sitzungsschlüssels an den Client.
ms.assetid: 6b20ab30-2cd9-4f2e-a26b-316980c4bc78
title: Sitzungs Tickets
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 762223311dd71f8bded5e021372d3a281f711eda
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106349392"
---
# <a name="session-tickets"></a><span data-ttu-id="53103-103">Sitzungs Tickets</span><span class="sxs-lookup"><span data-stu-id="53103-103">Session Tickets</span></span>

<span data-ttu-id="53103-104">Anstatt die verschlüsselten Sitzungsschlüssel an beide Prinzipale zu senden, sendet der [KDC](key-distribution-center.md) sowohl den Client-als auch die Server Kopien des [*Sitzungsschlüssels*](../secgloss/s-gly.md) an den Client.</span><span class="sxs-lookup"><span data-stu-id="53103-104">Instead of sending the encrypted session keys to both of the principals, the [KDC](key-distribution-center.md) sends both the client's and the server's copies of the [*session key*](../secgloss/s-gly.md) to the client.</span></span> <span data-ttu-id="53103-105">Die Client Kopie des Sitzungsschlüssels wird mit dem [*Hauptschlüssel*](../secgloss/m-gly.md) des Clients verschlüsselt und kann daher von keiner anderen Entität entschlüsselt werden.</span><span class="sxs-lookup"><span data-stu-id="53103-105">The client's copy of the session key is encrypted with the client's [*master key*](../secgloss/m-gly.md) and therefore cannot be decrypted by any other entity.</span></span> <span data-ttu-id="53103-106">Die Server Kopie des Sitzungsschlüssels wird zusammen mit den Autorisierungs Daten über den Client in einer Datenstruktur, die als Ticket bezeichnet wird, eingebettet.</span><span class="sxs-lookup"><span data-stu-id="53103-106">The server's copy of the session key is embedded, along with authorization data about the client, in a data structure called a ticket.</span></span> <span data-ttu-id="53103-107">Das Ticket ist vollständig mit dem Hauptschlüssel des Servers verschlüsselt und kann daher nicht vom Client oder einer anderen Entität gelesen oder geändert werden, die keinen Zugriff auf den Hauptschlüssel des Servers hat.</span><span class="sxs-lookup"><span data-stu-id="53103-107">The ticket is entirely encrypted with the server's master key and therefore cannot be read or changed by the client or any other entity that does not have access to the server's master key.</span></span> <span data-ttu-id="53103-108">Es liegt in der Verantwortung des Clients, das Ticket sicher zu speichern, bis die Verbindung mit dem Server hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="53103-108">It is the responsibility of the client to store the ticket safely until contact with the server.</span></span>

> [!Note]  
> <span data-ttu-id="53103-109">Der KDC stellt nur einen Dienst zur Ticket Gewährung bereit.</span><span class="sxs-lookup"><span data-stu-id="53103-109">The KDC only provides a ticket-granting service.</span></span> <span data-ttu-id="53103-110">Der Client und der Server sind dafür verantwortlich, die entsprechenden Hauptschlüssel sicher zu halten.</span><span class="sxs-lookup"><span data-stu-id="53103-110">The client and server are responsible for keeping their respective master keys secure.</span></span>

 

<span data-ttu-id="53103-111">Wenn der Client die KDC-Antwort empfängt, extrahiert er das Ticket und seine eigene Kopie des Sitzungsschlüssels, wobei beide in einem sicheren Cache abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="53103-111">When the client receives the KDC's response, it extracts the ticket and its own copy of the session key, putting both aside in a secure cache.</span></span> <span data-ttu-id="53103-112">Zum Einrichten einer sicheren Sitzung mit dem Server wird dem Server eine Nachricht gesendet, die aus dem Ticket besteht, weiterhin mit dem Hauptschlüssel des Servers verschlüsselt ist, und eine [Authentifikator-Nachricht](authenticator-messages.md) , die mit dem Sitzungsschlüssel verschlüsselt ist.</span><span class="sxs-lookup"><span data-stu-id="53103-112">To establish a secure session with the server, it sends the server a message consisting of the ticket, still encrypted with the server's master key, and an [authenticator message](authenticator-messages.md) encrypted with the session key.</span></span> <span data-ttu-id="53103-113">Die Ticket-und Authenticator-Nachricht sind die [*Anmelde*](../secgloss/c-gly.md) Informationen des Clients auf dem Server.</span><span class="sxs-lookup"><span data-stu-id="53103-113">Together, the ticket and authenticator message are the client's [*credentials*](../secgloss/c-gly.md) to the server.</span></span>

<span data-ttu-id="53103-114">Wenn der Server Anmelde Informationen von einem Client empfängt, entschlüsselt er das Ticket mit dem [*Hauptschlüssel*](../secgloss/m-gly.md), extrahiert den [*Sitzungsschlüssel*](../secgloss/s-gly.md)und verwendet den Sitzungsschlüssel zum Entschlüsseln der authentifikatornachricht des Clients.</span><span class="sxs-lookup"><span data-stu-id="53103-114">When the server receives credentials from a client, it decrypts the ticket with its [*master key*](../secgloss/m-gly.md), extracts the [*session key*](../secgloss/s-gly.md), and uses the session key to decrypt the client's authenticator message.</span></span> <span data-ttu-id="53103-115">Wenn alles auscheckt, weiß der Server, dass die Anmelde Informationen des Clients von der KDC, einer vertrauenswürdigen Zertifizierungsstelle, ausgestellt wurden.</span><span class="sxs-lookup"><span data-stu-id="53103-115">If everything checks out, the server knows that the client's credentials were issued by the KDC, a trusted authority.</span></span> <span data-ttu-id="53103-116">Bei gegenseitiger Authentifizierung antwortet der Server, indem er den Zeitstempel aus der Authentifikator-Nachricht des Clients mithilfe des Sitzungsschlüssels verschlüsselt.</span><span class="sxs-lookup"><span data-stu-id="53103-116">For mutual authentication, the server responds by encrypting the time stamp from the client's authenticator message using the session key.</span></span> <span data-ttu-id="53103-117">Diese verschlüsselte Nachricht wird an den Client gesendet.</span><span class="sxs-lookup"><span data-stu-id="53103-117">This encrypted message is sent to the client.</span></span> <span data-ttu-id="53103-118">Der Client entschlüsselt dann die Nachricht.</span><span class="sxs-lookup"><span data-stu-id="53103-118">The client then decrypts the message.</span></span> <span data-ttu-id="53103-119">Wenn die zurückgegebene Meldung mit dem Zeitstempel in der ursprünglichen authentifikatornachricht identisch ist, wird der Server authentifiziert.</span><span class="sxs-lookup"><span data-stu-id="53103-119">If the returned message is the same as the time stamp in the original authenticator message, the server is authenticated.</span></span>

<span data-ttu-id="53103-120">Ein zusätzlicher Vorteil ist, dass der Server die Sitzungsschlüssel, die er verwendet, nicht mit seinen Clients speichern muss.</span><span class="sxs-lookup"><span data-stu-id="53103-120">As an added benefit, the server does not need to store the session keys it uses with its clients.</span></span> <span data-ttu-id="53103-121">Es ist für jeden Client zuständig, das Ticket für den Server im Ticket Cache zu verwalten und dieses Ticket bei jedem Zugriff auf den Server zu präsentieren.</span><span class="sxs-lookup"><span data-stu-id="53103-121">It is each client's responsibility to manage the ticket for the server in its ticket cache and to present that ticket each time it accesses the server.</span></span> <span data-ttu-id="53103-122">Wenn der Server ein Ticket von einem Client empfängt, verwendet er seinen Hauptschlüssel, um das Ticket zu entschlüsseln und den Sitzungsschlüssel zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="53103-122">Whenever the server receives a ticket from a client, it uses its master key to decrypt the ticket and extract the session key.</span></span> <span data-ttu-id="53103-123">Wenn der Server den Sitzungsschlüssel nicht mehr benötigt, wird der Schlüssel gelöscht.</span><span class="sxs-lookup"><span data-stu-id="53103-123">When the server no longer needs the session key, the key is deleted.</span></span>

<span data-ttu-id="53103-124">Der Client muss nicht jedes Mal auf den KDC zugreifen, wenn er auf diesen speziellen Server zugreifen möchte.</span><span class="sxs-lookup"><span data-stu-id="53103-124">The client does not need to access the KDC each time it wants access to this particular server.</span></span> <span data-ttu-id="53103-125">Tickets können wieder verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="53103-125">Tickets can be reused.</span></span> <span data-ttu-id="53103-126">Als Vorsichtsmaßnahme vor der Möglichkeit eines Ticket Diebstahls verfügen Tickets über eine Ablaufzeit, die durch die KDC in der Ticket Struktur angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="53103-126">As a precaution against the possibility of ticket theft, tickets have an expiration time, specified by the KDC in the ticket structure.</span></span> <span data-ttu-id="53103-127">Wie lange ein Ticket gültig ist, hängt von der Kerberos-Richtlinie für den Bereich ab.</span><span class="sxs-lookup"><span data-stu-id="53103-127">How long a ticket is valid depends on Kerberos policy for the realm.</span></span> <span data-ttu-id="53103-128">Tickets sind in der Regel nicht länger als acht Stunden, sondern über die Länge einer normalen [*Anmelde Sitzung*](../secgloss/l-gly.md).</span><span class="sxs-lookup"><span data-stu-id="53103-128">Typically, tickets are good for no longer than eight hours, about the length of a normal [*logon session*](../secgloss/l-gly.md).</span></span> <span data-ttu-id="53103-129">Wenn sich der Benutzer auf einer Client Arbeitsstation abmeldet, wird der Cache des Client Tickets geleert, und alle Tickets und Client Sitzungsschlüssel werden zerstört.</span><span class="sxs-lookup"><span data-stu-id="53103-129">When the user at a client workstation logs off, the client ticket cache is flushed and all tickets and client session keys are destroyed.</span></span>

 

 
