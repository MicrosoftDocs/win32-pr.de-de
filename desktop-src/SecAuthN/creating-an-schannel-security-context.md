---
description: Erläutert das Einrichten eines Sicherheits Kontexts, der die Kommunikation zwischen einem Client und einem Server schützt.
ms.assetid: eb1eadb2-14b2-4265-994a-dcea4208e650
title: Erstellen eines SChannel-Sicherheits Kontexts
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 23e364e6319fbaddb50bffaf59541af9e8f43bfb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106348004"
---
# <a name="creating-an-schannel-security-context"></a><span data-ttu-id="c9ab5-103">Erstellen eines SChannel-Sicherheits Kontexts</span><span class="sxs-lookup"><span data-stu-id="c9ab5-103">Creating an Schannel Security Context</span></span>

<span data-ttu-id="c9ab5-104">Zum Einrichten eines [*Sicherheits Kontexts*](/windows/desktop/SecGloss/s-gly) , der die Kommunikation zwischen einem Client und einem Server schützt, müssen beide am folgenden Informationsaustausch Prozess teilnehmen:</span><span class="sxs-lookup"><span data-stu-id="c9ab5-104">To establish a [*security context*](/windows/desktop/SecGloss/s-gly) that will protect communications between a client and server, both must participate in the following information exchange process:</span></span>

## <a name="client"></a><span data-ttu-id="c9ab5-105">Client</span><span class="sxs-lookup"><span data-stu-id="c9ab5-105">Client</span></span>

1.  <span data-ttu-id="c9ab5-106">Der Client ruft die [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) -Funktion auf.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-106">The client calls the [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) function.</span></span>
2.  <span data-ttu-id="c9ab5-107">SChannel beginnt mit dem Erstellen eines Sicherheits Kontexts gemäß den Regeln des ausgewählten Sicherheitsprotokolls.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-107">Schannel begins creating a security context according to the rules of the selected security protocol.</span></span> <span data-ttu-id="c9ab5-108">Der Rückgabecode der Funktion gibt an, ob die Funktion vom Client erneut aufgerufen werden muss.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-108">The function's return code indicates whether the client must call the function again.</span></span> <span data-ttu-id="c9ab5-109">[**InitializeSecurityContext (allgemein)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) gibt möglicherweise ein Token zurück, das den Kontext darstellt.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-109">[**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) may return a token that represents the context.</span></span>
3.  <span data-ttu-id="c9ab5-110">Wenn ein Token zurückgegeben wurde, sendet der Client es an den Server.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-110">If a token was returned, the client sends it to the server.</span></span>
4.  <span data-ttu-id="c9ab5-111">Wenn [**InitializeSecurityContext (allgemein)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) sec \_ E OK zurückgibt \_ , ist der Client abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-111">When [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) returns SEC\_E\_OK, the client is done.</span></span> <span data-ttu-id="c9ab5-112">Wenn die Funktion Sekunde zurück \_ gibt \_ , die ich weiterhin \_ benötigtes, muss der Client warten, bis der Server ihm ein Token sendet.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-112">If the function returns SEC\_I\_CONTINUE\_NEEDED, the client must wait for the server to send it a token.</span></span> <span data-ttu-id="c9ab5-113">Wenn der Client über das Token vom Server verfügt, muss die [*Funktion*](/windows/desktop/SecGloss/c-gly) **InitializeSecurityContext (General)** erneut aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-113">When the client has the token from the server, it must call the **InitializeSecurityContext (General)** [*function*](/windows/desktop/SecGloss/c-gly) again.</span></span> <span data-ttu-id="c9ab5-114">(Kehren Sie zu Schritt 2 zurück.)</span><span class="sxs-lookup"><span data-stu-id="c9ab5-114">(Return to step 2.)</span></span>

## <a name="server"></a><span data-ttu-id="c9ab5-115">Server</span><span class="sxs-lookup"><span data-stu-id="c9ab5-115">Server</span></span>

1.  <span data-ttu-id="c9ab5-116">Der Server wartet darauf, dass ein Client eine Nachricht sendet, die ein Sicherheits Token enthält.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-116">The server waits for a client to send a message that contains a security token.</span></span> <span data-ttu-id="c9ab5-117">Der Server übergibt das vom Client empfangene Token an die Funktion " [**akzeptsecuritycontext (allgemein)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) ".</span><span class="sxs-lookup"><span data-stu-id="c9ab5-117">The server passes the token received from the client into the [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span>
2.  <span data-ttu-id="c9ab5-118">SChannel baut auf dem partiellen Sicherheitskontext auf, der durch das Token dargestellt wird.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-118">Schannel builds on the partial security context represented by the token.</span></span> <span data-ttu-id="c9ab5-119">SChannel gibt ein Token an den Server zurück, und einen Rückgabecode, der angibt, ob der Server die Funktion erneut abrufen muss.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-119">Schannel returns a token to the server, and a return code indicating whether the server must call the function again.</span></span>
3.  <span data-ttu-id="c9ab5-120">Wenn ein Token zurückgegeben wurde, sendet der Server es an den Client.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-120">If a token was returned, the server sends it to the client.</span></span>
4.  <span data-ttu-id="c9ab5-121">Wenn " [**Accept-SecurityContext (allgemein)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) " sec \_ E OK zurückgibt, erfolgt \_ der Server.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-121">When [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) returns SEC\_E\_OK, the server is done.</span></span> <span data-ttu-id="c9ab5-122">Wenn die Funktion "s" zurückgibt \_ , die ich \_ weiterhin \_ benötigtes, muss der Server warten, bis der Client ihm ein Token sendet.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-122">If the function returns SEC\_I\_CONTINUE\_NEEDED, then the server must wait for the client to send it a token.</span></span> <span data-ttu-id="c9ab5-123">Wenn der Server über das Token des Clients verfügt, muss er die Funktion " **Accept tsecuritycontext (General)** " erneut abrufen.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-123">When the server has the token from the client, it must call the **AcceptSecurityContext (General)** function again.</span></span> <span data-ttu-id="c9ab5-124">(Kehren Sie zu Schritt 2 zurück.)</span><span class="sxs-lookup"><span data-stu-id="c9ab5-124">(Return to step 2.)</span></span>

<span data-ttu-id="c9ab5-125">Wenn eine der beiden Funktionen einen anderen Wert als s OK zurückgibt \_ \_ , ist der Vorgang \_ \_ weiterhin \_ erforderlich, oder \_ \_ \_ es ist keine unvollständige Nachricht (siehe folgender Absatz) aufgetreten.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-125">If either function returns a value other than SEC\_E\_OK, SEC\_I\_CONTINUE\_NEEDED, or SEC\_E\_INCOMPLETE\_MESSAGE (see the following paragraph) an error has occurred.</span></span> <span data-ttu-id="c9ab5-126">Der Client und der Server sollten die [**Delta Context**](/windows/desktop/api/Sspi/nf-sspi-deletesecuritycontext) -Funktion zum Löschen des teilweise eingerichteten Sicherheits Kontexts abrufen.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-126">The client and server should call the [**DeleteSecurityContext**](/windows/desktop/api/Sspi/nf-sspi-deletesecuritycontext) function to delete the partially established security context.</span></span>

<span data-ttu-id="c9ab5-127">Ein Sonderfall, der die Client-und Server Verarbeitung ändern kann, liegt vor, wenn zu wenig oder zu viele Informationen von der anderen Partei an den Client oder Server gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="c9ab5-127">A special case that can alter client and server processing is when too little or too much information is sent to the client or server from the other party.</span></span> <span data-ttu-id="c9ab5-128">Wenn zu wenig Informationen angezeigt werden, geben beide Funktionen eine nicht abgeschlossene Sekunde in Sekunden zurück \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="c9ab5-128">In the case of too little information, both functions return SEC\_E\_INCOMPLETE\_MESSAGE.</span></span> <span data-ttu-id="c9ab5-129">Informationen zum erkennen und behandeln unzureichender oder übermäßiger Informationen finden Sie unter [von SChannel zurückgegebene zusätzliche Puffer](extra-buffers-returned-by-schannel.md).</span><span class="sxs-lookup"><span data-stu-id="c9ab5-129">For information about recognizing and handling insufficient or excess information, see [Extra buffers Returned by Schannel](extra-buffers-returned-by-schannel.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c9ab5-130">Zugehörige Themen</span><span class="sxs-lookup"><span data-stu-id="c9ab5-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c9ab5-131">Durchführen der Authentifizierung mithilfe von SChannel</span><span class="sxs-lookup"><span data-stu-id="c9ab5-131">Performing Authentication Using Schannel</span></span>](performing-authentication-using-schannel.md)
</dt> <dt>

[<span data-ttu-id="c9ab5-132">Zuordnung von Zertifikaten</span><span class="sxs-lookup"><span data-stu-id="c9ab5-132">Mapping Certificates</span></span>](mapping-certificates.md)
</dt> <dt>

[<span data-ttu-id="c9ab5-133">Manuelles Überprüfen von SChannel-Anmelde Informationen</span><span class="sxs-lookup"><span data-stu-id="c9ab5-133">Manually Validating Schannel Credentials</span></span>](manually-validating-schannel-credentials.md)
</dt> </dl>

 

 
