---
description: Gibt Anmelde Informationen zurück, um einen nicht in die Domäne eingebundenen Container mit Active Directory zu authentifizieren.
title: 'Iccgdomainauthanmelde Informationen:: getpasswordanmeldeinformationen-Methode (ccgplugins. h)'
ms.topic: reference
ms.date: 10/21/2020
topic_type:
- APIRef
- kbSyntax
api_name:
- ICcgDomainAuthCredentials.GetPasswordCredentials
api_type:
- COM
api_location:
- ccgplugins.h
ms.openlocfilehash: abd70a109e491773b374ae32787760d265167baa
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/22/2021
ms.locfileid: "106361509"
---
# <a name="iccgdomainauthcredentialsgetpasswordcredentials-method"></a>Iccgdomainauthanmelde Informationen:: getpasswordanmelde-Methode

Gibt Anmelde Informationen zurück, um einen nicht in die Domäne eingebundenen Container mit Active Directory zu authentifizieren.

## <a name="syntax"></a>Syntax


```C++
HRESULT GetPasswordCredentials(
[in] LPCWSTR pluginInput, 
[out] LPWSTR* domainName, 
[out] LPWSTR* username, 
[out] LPWSTR* password);
);
```



## <a name="parameters"></a>Parameter

<dl> <dt>

*plugininput* \[ in\]
</dt> <dd>

Eine Eingabe Zeichenfolge, die von der Container Laufzeit übermittelt wird. Die Client Implementierung verwendet die angegebene Eingabe Zeichenfolge zum Abrufen von Authentifizierungs Anmelde Informationen, die in der Regel von einem sicheren Speicher Anbieter stammen und in den Ausgabeparametern zurückgegeben werden. Die Eingabe Zeichenfolge wird für den Host Compute Services (HCS) in einer Datei mit Anmelde Informations Spezifikation bereitgestellt. Weitere Informationen finden Sie im Abschnitt **Hinweise**.

</dd> </dl>

<dl> <dt>

*Domain Name* \[ vorgenommen\]
</dt> <dd>

Der Domänen Name für die Anmelde Informationen.

</dd> </dl>

<dl> <dt>

*Benutzername* \[ vorgenommen\]
</dt> <dd>

Der Benutzername für die Anmelde Informationen.

</dd> </dl>

<dl> <dt>

*Kennwort* \[ vorgenommen\]
</dt> <dd>

Das Kennwort für die Anmelde Informationen.

</dd> </dl>

## <a name="return-value"></a>Rückgabewert

Der Rückgabewert ist ein **HRESULT**. Der Wert S OK gibt an, dass \_ der Vorgang erfolgreich war.

## <a name="remarks"></a>Bemerkungen

Die API kann gleichzeitig aufgerufen werden. Deshalb muss der Entwickler sicherstellen, dass die Implementierung Thread sicher ist. Außerdem wird das COM-Objekt außerhalb der Prozedur aktiviert und muss entsprechend registriert werden. 

Der Implementierer muss für die com-CLSID unter "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CCG\COMClasses" einen Schlüssel hinzufügen. Der Schreibzugriff auf "ccg\comclasses" ist auf System-und Administrator Konten beschränkt. 

Im folgenden finden Sie eine Beispieldatei für die Anmelde Informations Spezifikation. Informationen zum Bereitstellen dieser Datei an docker finden Sie unter [Ausführen eines Containers mit einem GMSA](/virtualization/windowscontainers/manage-containers/gmsa-run-container).

```json
{
    "CmsPlugins": [
        "ActiveDirectory"
    ],
    "DomainJoinConfig": {
        "Sid": "S-1-5-21-3700119848-2853083131-2094573802",
        "MachineAccountName": "gmsa1",
        "Guid": "630a7dd3-2d3e-4471-ae91-1d9ea2556cd5",
        "DnsTreeName": "contoso.com",
        "DnsName": "contoso.com",
        "NetBiosName": "CONTOSO"
    },
    "ActiveDirectoryConfig": {
        "GroupManagedServiceAccounts": [
            {
                "Name": "gmsa1",
                "Scope": "contoso.com"
            },
            {
                "Name": "gmsa1",
                "Scope": "CONTOSO"
            }
        ],
        "HostAccountConfig": {
            "PortableCcgVersion": "1",
            "PluginGUID": "{CFCA0441-511D-4B2A-862E-20348A78760B}",
            "PluginInput": "contoso.com:gmsaccg:<password>"
        }
    }
}

```

## <a name="examples"></a>Beispiele

Das folgende Beispiel zeigt eine einfache Implementierung von **iccgdomainauthanmeldeinformationen**. Beachten Sie, dass in diesem Beispiel zur Veranschaulichung die Anmelde Informationen abgerufen werden, indem Sie einfach die Eingabe Zeichenfolge auswerten. Eine reale Implementierung speichert die Anmelde Informationen in einem sicheren Datenspeicher und verwendet die Eingabe Zeichenfolge, um die Anmelde Informationen zu suchen. Außerdem wurden die Standard Implementierungen der com-Methode aus Gründen der Kürze aus diesem Beispiel ausgelassen.


```C++
// UUID generated by the developer
[uuid("cfca0441-511d-4b2a-862e-20348a78760b")] 
class CCGStubPlugin : public RuntimeClass<RuntimeClassFlags<RuntimeClassType::ClassicCom>, ICcgDomainAuthCredentials >
{
   public:
    CCGStubPlugin() {}

    ~CCGStubPlugin() {}

    IFACEMETHODIMP GetPasswordCredentials(
        _In_ LPCWSTR pluginInput,
        _Outptr_ LPWSTR *domainName,
        _Outptr_ LPWSTR *username,
        _Outptr_ LPWSTR *password)
    {
        std::wstring domainParsed, userParsed, passwordParsed; 
        try
        {
            if(domainName == NULL || username == NULL || password == NULL)
            {
                return STG_E_INVALIDPARAMETER;
            }
            *domainName = NULL;
            *username = NULL;
            *password = NULL;
            wstring pluginInputString(pluginInput);
            if (count(pluginInputString.begin(), pluginInputString.end(), ':') < 2)
            {
                return CO_E_NOT_SUPPORTED;
            }
            // Extract creds of this format Domain:Username:Password
            size_t sep1 = pluginInputString.find(L":");
            size_t sep2 = pluginInputString.find(L":", sep1 + 1);
            domainParsed = pluginInputString.substr(0, sep1);
            userParsed = pluginInputString.substr(sep1 + 1, sep2 - sep1 - 1);
            passwordParsed = pluginInputString.substr(sep2 + 1);
        }
        catch (...)
        {
            return EVENT_E_INTERNALERROR;
        }

        auto userCo = wil::make_cotaskmem_string_nothrow(userParsed.c_str());
        auto passwordCo = wil::make_cotaskmem_string_nothrow(passwordParsed.c_str());
        auto domainCo = wil::make_cotaskmem_string_nothrow(domainParsed.c_str());
        if (userCo == nullptr || passwordCo == nullptr || domainCo == nullptr)
        {
            return STG_E_INSUFFICIENTMEMORY;
        }

        *domainName = domainCo.release();
        *username = userCo.release();
        *password = passwordCo.release();
        return S_OK;
    }
};
CoCreatableClass(CCGStubPlugin);

```



## <a name="requirements"></a>Anforderungen




| Anforderung | Wert |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Unterstützte Mindestversion (Server) | Windows Server, Version 2004                                    |
| Header                   | ccgplugins. h   |
| IID                    | 6ecda518-2010-4437-8bc3-46e752b7b172          |



 

