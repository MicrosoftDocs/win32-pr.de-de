---
description: Ermöglicht der Serverkomponente einer Transport Anwendung das Einrichten eines Sicherheits Kontexts zwischen dem Server und einem Remote Client.
ms.assetid: a53f733e-b646-4431-b021-a2c446308849
title: Akzeptsecuritycontext (kredssp)-Funktion
ms.topic: article
ms.date: 07/25/2019
ms.openlocfilehash: 681e03ea15729cc8726d63551e8b7b0a2b39ecac
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106353501"
---
# <a name="acceptsecuritycontext-credssp-function"></a><span data-ttu-id="f0912-103">Akzeptsecuritycontext (kredssp)-Funktion</span><span class="sxs-lookup"><span data-stu-id="f0912-103">AcceptSecurityContext (CredSSP) function</span></span>

<span data-ttu-id="f0912-104">Mit der Funktion " **Accept-SecurityContext" ("andssp")** kann die Serverkomponente einer Transport Anwendung einen Sicherheitskontext zwischen dem Server und einem Remote Client einrichten.</span><span class="sxs-lookup"><span data-stu-id="f0912-104">The **AcceptSecurityContext (CredSSP)** function lets the server component of a transport application establish a security context between the server and a remote client.</span></span> <span data-ttu-id="f0912-105">Der Remote Client ruft die [**InitializeSecurityContext (**](initializesecuritycontext--credssp.md) aufgerufenen)-Funktion auf, um den Prozess der Einrichtung eines Sicherheits Kontexts zu starten.</span><span class="sxs-lookup"><span data-stu-id="f0912-105">The remote client calls the [**InitializeSecurityContext (CredSSP)**](initializesecuritycontext--credssp.md) function to start the process of establishing a security context.</span></span> <span data-ttu-id="f0912-106">Der Server kann mindestens ein Antwort Token vom Remote Client anfordern, um das Einrichten des Sicherheits Kontexts abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="f0912-106">The server can require one or more reply tokens from the remote client to complete establishing the security context.</span></span>

## <a name="syntax"></a><span data-ttu-id="f0912-107">Syntax</span><span class="sxs-lookup"><span data-stu-id="f0912-107">Syntax</span></span>

```C++
SECURITY_STATUS SEC_ENTRY AcceptSecurityContext(
  _In_opt_    PCredHandle    phCredential,
  _In_opt_    PCtxtHandle    phContext,
  _In_opt_    PSecBufferDesc pInput,
  _In_        unsigned long  fContextReq,
  _In_        unsigned long  TargetDataRep,
  _Inout_opt_ PCtxtHandle    phNewContext,
  _Inout_opt_ PSecBufferDesc pOutput,
  _Out_       unsigned long  *pfContextAttr,
  _Out_opt_   PTimeStamp     ptsExpiry
);
```

## <a name="parameters"></a><span data-ttu-id="f0912-108">Parameter</span><span class="sxs-lookup"><span data-stu-id="f0912-108">Parameters</span></span>

<span data-ttu-id="f0912-109">*phcredential* \[ in, optional\]</span><span class="sxs-lookup"><span data-stu-id="f0912-109">*phCredential* \[in, optional\]</span></span>

<span data-ttu-id="f0912-110">Ein Handle für die Server Anmelde Informationen.</span><span class="sxs-lookup"><span data-stu-id="f0912-110">A handle to the server credentials.</span></span> <span data-ttu-id="f0912-111">Um dieses Handle abzurufen, ruft der Server die Funktion [**AcquireCredentialsHandle (kredssp)**](acquirecredentialshandle--credssp.md) entweder mit der "secpkg up \_ INBOUND"-oder "secpkg"-Funktion auf, die \_ \_ \_ beide Flags festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="f0912-111">To retrieve this handle, the server calls the [**AcquireCredentialsHandle (CredSSP)**](acquirecredentialshandle--credssp.md) function with either the SECPKG\_CRED\_INBOUND or SECPKG\_CRED\_BOTH flag set.</span></span>

<span data-ttu-id="f0912-112">*phcontext* \[ in, optional\]</span><span class="sxs-lookup"><span data-stu-id="f0912-112">*phContext* \[in, optional\]</span></span>

<span data-ttu-id="f0912-113">Ein Zeiger auf eine [ctxthandle](sspi-handles.md) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="f0912-113">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="f0912-114">Beim ersten Aufrufen von " **Accept-SecurityContext" (** aufzurufen) ist dieser Zeiger **null**.</span><span class="sxs-lookup"><span data-stu-id="f0912-114">On the first call to **AcceptSecurityContext (CredSSP)**, this pointer is **NULL**.</span></span> <span data-ttu-id="f0912-115">Bei nachfolgenden Aufrufen gibt *phcontext* den teilweise formatierten Kontext an, der im *phnewcontext* -Parameter durch den ersten Aufruf zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f0912-115">On subsequent calls, *phContext* specifies the partially formed context returned in the *phNewContext* parameter by the first call.</span></span>

<span data-ttu-id="f0912-116">*pinput* \[ in, optional\]</span><span class="sxs-lookup"><span data-stu-id="f0912-116">*pInput* \[in, optional\]</span></span>

<span data-ttu-id="f0912-117">Ein Zeiger auf eine [**secbufferdesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) -Struktur, die durch einen Client aufrufen von [**InitializeSecurityContext (kredssp)**](initializesecuritycontext--credssp.md)generiert wird.</span><span class="sxs-lookup"><span data-stu-id="f0912-117">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure generated by a client call to [**InitializeSecurityContext (CredSSP)**](initializesecuritycontext--credssp.md).</span></span> <span data-ttu-id="f0912-118">Die-Struktur enthält den Eingabepuffer Deskriptor.</span><span class="sxs-lookup"><span data-stu-id="f0912-118">The structure contains the input buffer descriptor.</span></span>

<span data-ttu-id="f0912-119">Der erste Puffer muss den Typ " **secbuffer \_ Token** " aufweisen und das vom Client empfangene Sicherheits Token enthalten.</span><span class="sxs-lookup"><span data-stu-id="f0912-119">The first buffer must be of type **SECBUFFER\_TOKEN** and contain the security token received from the client.</span></span> <span data-ttu-id="f0912-120">Der zweite Puffer muss den Typ " **secbuffer \_ empty**" aufweisen.</span><span class="sxs-lookup"><span data-stu-id="f0912-120">The second buffer should be of type **SECBUFFER\_EMPTY**.</span></span>

<span data-ttu-id="f0912-121">*"f"* \[ in\]</span><span class="sxs-lookup"><span data-stu-id="f0912-121">*fContextReq* \[in\]</span></span>

<span data-ttu-id="f0912-122">-Bitflags, die die Attribute angeben, die vom Server zum Einrichten des Kontexts benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="f0912-122">-Bit flags that specify the attributes required by the server to establish the context.</span></span> <span data-ttu-id="f0912-123">Bitflags können mithilfe von bitweisen **or** -Vorgängen kombiniert werden.</span><span class="sxs-lookup"><span data-stu-id="f0912-123">Bit flags can be combined by using bitwise-**OR** operations.</span></span> <span data-ttu-id="f0912-124">Dieser Parameter kann einen oder mehrere der folgenden Werte aufweisen.</span><span class="sxs-lookup"><span data-stu-id="f0912-124">This parameter can be one or more of the following values.</span></span>

| <span data-ttu-id="f0912-125">Wert</span><span class="sxs-lookup"><span data-stu-id="f0912-125">Value</span></span>                          | <span data-ttu-id="f0912-126">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="f0912-126">Meaning</span></span>                                                                                                                                                                                                        |
|--------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f0912-127">**ASC \_ req \_ Arbeits \_ Speicher zuweisen**</span><span class="sxs-lookup"><span data-stu-id="f0912-127">**ASC\_REQ\_ALLOCATE\_MEMORY**</span></span> | <span data-ttu-id="f0912-128">Der Credential Security Support Provider (kredssp) weist Ausgabepuffer zu.</span><span class="sxs-lookup"><span data-stu-id="f0912-128">Credential Security Support Provider (CredSSP) will allocate output buffers.</span></span> <span data-ttu-id="f0912-129">Wenn Sie die Ausgabepuffer nicht mehr verwenden, geben Sie Sie frei, indem Sie die [**freecontextbuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) -Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="f0912-129">When you have finished using the output buffers, free them by calling the [**FreeContextBuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) function.</span></span> |
| <span data-ttu-id="f0912-130">**ASC \_ req- \_ Verbindung**</span><span class="sxs-lookup"><span data-stu-id="f0912-130">**ASC\_REQ\_CONNECTION**</span></span>       | <span data-ttu-id="f0912-131">Der Sicherheitskontext verarbeitet keine Formatierungs Meldungen.</span><span class="sxs-lookup"><span data-stu-id="f0912-131">The security context will not handle formatting messages.</span></span>                                                                                                                                                      |
| <span data-ttu-id="f0912-132">**ASC \_ req-Delegat \_**</span><span class="sxs-lookup"><span data-stu-id="f0912-132">**ASC\_REQ\_DELEGATE**</span></span>         | <span data-ttu-id="f0912-133">Der Server kann die Identität des Clients annehmen.</span><span class="sxs-lookup"><span data-stu-id="f0912-133">The server is allowed to impersonate the client.</span></span> <span data-ttu-id="f0912-134">Dieses Flag für die eingeschränkte Delegierung ignorieren.</span><span class="sxs-lookup"><span data-stu-id="f0912-134">Ignore this flag for constrained delegation.</span></span>                                                         |
| <span data-ttu-id="f0912-135">**\_Erweiterte ASC req- \_ \_ Fehler**</span><span class="sxs-lookup"><span data-stu-id="f0912-135">**ASC\_REQ\_EXTENDED\_ERROR**</span></span>  | <span data-ttu-id="f0912-136">Wenn Fehler auftreten, wird die Remote Partei benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="f0912-136">When errors occur, the remote party will be notified.</span></span>                                                                                                                                                          |
| <span data-ttu-id="f0912-137">**ASC \_ req \_ Replay \_ Detect**</span><span class="sxs-lookup"><span data-stu-id="f0912-137">**ASC\_REQ\_REPLAY\_DETECT**</span></span>   | <span data-ttu-id="f0912-138">Erkennen wieder gewiedergabe Pakete.</span><span class="sxs-lookup"><span data-stu-id="f0912-138">Detect replayed packets.</span></span>                                                                                                                                                                                       |
| <span data-ttu-id="f0912-139">**ASC \_ req- \_ Sequenz \_ Erkennung**</span><span class="sxs-lookup"><span data-stu-id="f0912-139">**ASC\_REQ\_SEQUENCE\_DETECT**</span></span> | <span data-ttu-id="f0912-140">Erkennen, dass Nachrichten außerhalb der Reihenfolge empfangen wurden.</span><span class="sxs-lookup"><span data-stu-id="f0912-140">Detect messages received out of sequence.</span></span>                                                                                                                                                                      |
| <span data-ttu-id="f0912-141">**ASC \_ req- \_ Stream**</span><span class="sxs-lookup"><span data-stu-id="f0912-141">**ASC\_REQ\_STREAM**</span></span>           | <span data-ttu-id="f0912-142">Unterstützen einer Datenstrom orientierten Verbindung.</span><span class="sxs-lookup"><span data-stu-id="f0912-142">Support a stream-oriented connection.</span></span>                                                                                                                                                                          |

<span data-ttu-id="f0912-143">Informationen zu möglichen Attributflags und deren Bedeutung finden Sie unter [Kontext Anforderungen](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="f0912-143">For possible attribute flags and their meanings, see [Context Requirements](context-requirements.md).</span></span> <span data-ttu-id="f0912-144">Flags, die für diesen Parameter verwendet werden, wird ASC \_ req vorangestellt, z \_ . b. asc req-Delegat \_ .</span><span class="sxs-lookup"><span data-stu-id="f0912-144">Flags used for this parameter are prefixed with ASC\_REQ, for example, ASC\_REQ\_DELEGATE.</span></span>

<span data-ttu-id="f0912-145">Die angeforderten Attribute werden möglicherweise nicht vom Client unterstützt.</span><span class="sxs-lookup"><span data-stu-id="f0912-145">The requested attributes may not be supported by the client.</span></span> <span data-ttu-id="f0912-146">Weitere Informationen finden Sie unter dem Parameter *pfContextAttr* .</span><span class="sxs-lookup"><span data-stu-id="f0912-146">For more information, see the *pfContextAttr* parameter.</span></span>

<span data-ttu-id="f0912-147">*Targetdatarep* \[ in\]</span><span class="sxs-lookup"><span data-stu-id="f0912-147">*TargetDataRep* \[in\]</span></span>

<span data-ttu-id="f0912-148">Die Datendarstellung (z. b. Byte Reihenfolge) für das Ziel.</span><span class="sxs-lookup"><span data-stu-id="f0912-148">The data representation, such as byte ordering, on the target.</span></span> <span data-ttu-id="f0912-149">Dieser Parameter kann entweder " **Security \_ native \_ drep** " oder " **Security \_ Network \_ drep**" lauten.</span><span class="sxs-lookup"><span data-stu-id="f0912-149">This parameter can be either **SECURITY\_NATIVE\_DREP** or **SECURITY\_NETWORK\_DREP**.</span></span>

<span data-ttu-id="f0912-150">*phnewcontext* \[ in, out, optional\]</span><span class="sxs-lookup"><span data-stu-id="f0912-150">*phNewContext* \[in, out, optional\]</span></span>

<span data-ttu-id="f0912-151">Ein Zeiger auf eine [ctxthandle](sspi-handles.md) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="f0912-151">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="f0912-152">Beim ersten Aufrufen von " **Accept-SecurityContext" (** aufzurufen) empfängt dieser Zeiger das neue Kontext handle.</span><span class="sxs-lookup"><span data-stu-id="f0912-152">On the first call to **AcceptSecurityContext (CredSSP)**, this pointer receives the new context handle.</span></span> <span data-ttu-id="f0912-153">Bei nachfolgenden Aufrufen kann *phnewcontext* mit dem im Parameter *phcontext* angegebenen Handle identisch sein.</span><span class="sxs-lookup"><span data-stu-id="f0912-153">On subsequent calls, *phNewContext* can be the same as the handle specified in the *phContext* parameter.</span></span>

<span data-ttu-id="f0912-154">*poutput* \[ in, out, optional\]</span><span class="sxs-lookup"><span data-stu-id="f0912-154">*pOutput* \[in, out, optional\]</span></span>

<span data-ttu-id="f0912-155">Ein Zeiger auf eine [**secbufferdesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) -Struktur, die den Ausgabepuffer Deskriptor enthält.</span><span class="sxs-lookup"><span data-stu-id="f0912-155">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure that contains the output buffer descriptor.</span></span> <span data-ttu-id="f0912-156">Dieser Puffer wird an den Client gesendet, damit er in weitere Aufrufe von [**InitializeSecurityContext (aufzurufen)**](initializesecuritycontext--credssp.md)eingegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f0912-156">This buffer is sent to the client for input into additional calls to [**InitializeSecurityContext (CredSSP)**](initializesecuritycontext--credssp.md).</span></span> <span data-ttu-id="f0912-157">Ein Ausgabepuffer kann auch dann generiert werden, wenn die Funktion sec \_ E OK zurückgibt \_ .</span><span class="sxs-lookup"><span data-stu-id="f0912-157">An output buffer may be generated even if the function returns SEC\_E\_OK.</span></span> <span data-ttu-id="f0912-158">Jeder generierte Puffer muss an die Client Anwendung zurückgesendet werden.</span><span class="sxs-lookup"><span data-stu-id="f0912-158">Any buffer generated must be sent back to the client application.</span></span>

<span data-ttu-id="f0912-159">Bei der Ausgabe empfängt dieser Puffer ein Token für den Sicherheitskontext.</span><span class="sxs-lookup"><span data-stu-id="f0912-159">On output, this buffer receives a token for the security context.</span></span> <span data-ttu-id="f0912-160">Das Token muss an den Client gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="f0912-160">The token must be sent to the client.</span></span> <span data-ttu-id="f0912-161">Die Funktion kann auch einen Puffer vom Typ "secbuffer extra" zurückgeben \_ .</span><span class="sxs-lookup"><span data-stu-id="f0912-161">The function can also return a buffer of type SECBUFFER\_EXTRA.</span></span>

<span data-ttu-id="f0912-162">*pfContextAttr* \[ vorgenommen\]</span><span class="sxs-lookup"><span data-stu-id="f0912-162">*pfContextAttr* \[out\]</span></span>

<span data-ttu-id="f0912-163">Ein Zeiger auf einen Satz von Bitflags, die die Attribute des eingerichteten Kontexts angeben.</span><span class="sxs-lookup"><span data-stu-id="f0912-163">A pointer to a set of bit flags that indicate the attributes of the established context.</span></span> <span data-ttu-id="f0912-164">Eine Beschreibung der verschiedenen Attribute finden Sie unter [Kontext Anforderungen](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="f0912-164">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span> <span data-ttu-id="f0912-165">Die für diesen Parameter verwendeten Flags haben das Präfix ASC \_ RET, z. b. asc ret-Delegat \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="f0912-165">Flags used for this parameter are prefixed with ASC\_RET, for example, ASC\_RET\_DELEGATE.</span></span>

<span data-ttu-id="f0912-166">Suchen Sie erst nach sicherheitsbezogenen Attributen, wenn der abschließende Funktions aufruger erfolgreich zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="f0912-166">Do not check for security-related attributes until the final function call returns successfully.</span></span> <span data-ttu-id="f0912-167">Attributflags, die sich nicht auf die Sicherheit beziehen, wie z. b. das von ASC \_ ret \_ zugewiesene \_ arbeitsspeicherflag, können vor der letzten Rückgabe geprüft werden</span><span class="sxs-lookup"><span data-stu-id="f0912-167">Attribute flags not related to security, such as the ASC\_RET\_ALLOCATED\_MEMORY flag, can be checked before the final return.</span></span>

<span data-ttu-id="f0912-168">*ptsexpiry* \[ Out, optional\]</span><span class="sxs-lookup"><span data-stu-id="f0912-168">*ptsExpiry* \[out, optional\]</span></span>

<span data-ttu-id="f0912-169">Ein Zeiger auf eine [**Zeitstempel**](timestamp.md) Struktur, die die Ablaufzeit des Kontexts empfängt.</span><span class="sxs-lookup"><span data-stu-id="f0912-169">A pointer to a [**TimeStamp**](timestamp.md) structure that receives the expiration time of the context.</span></span> <span data-ttu-id="f0912-170">Es wird empfohlen, dass das Sicherheitspaket diesen Wert immer in der Ortszeit zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="f0912-170">We recommend that the security package always return this value in local time.</span></span>

> [!Note]  
> <span data-ttu-id="f0912-171">Bis zum letzten Aufruf des Authentifizierungs Vorgangs kann die Ablaufzeit für den Kontext falsch sein, da in späteren Phasen der Aushandlung Weitere Informationen bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="f0912-171">Until the last call of the authentication process, the expiration time for the context can be incorrect because more information will be provided during later stages of the negotiation.</span></span> <span data-ttu-id="f0912-172">Daher muss *ptstimestamp* bis zum letzten aufrufsbefehl **null** sein.</span><span class="sxs-lookup"><span data-stu-id="f0912-172">Therefore, *ptsTimeStamp* must be **NULL** until the last call to the function.</span></span>

## <a name="return-value"></a><span data-ttu-id="f0912-173">Rückgabewert</span><span class="sxs-lookup"><span data-stu-id="f0912-173">Return value</span></span>

<span data-ttu-id="f0912-174">Diese Funktion gibt einen der folgenden Werte zurück.</span><span class="sxs-lookup"><span data-stu-id="f0912-174">This function returns one of the following values.</span></span>

| <span data-ttu-id="f0912-175">Rückgabecode/-wert</span><span class="sxs-lookup"><span data-stu-id="f0912-175">Return code/value</span></span>                                   | <span data-ttu-id="f0912-176">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="f0912-176">Description</span></span>                                                                                                                                                                 |
|-----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f0912-177">SEC_E_INCOMPLETE_MESSAGE</span><span class="sxs-lookup"><span data-stu-id="f0912-177">SEC_E_INCOMPLETE_MESSAGE</span></span> <br/> <span data-ttu-id="f0912-178">0x80090318l</span><span class="sxs-lookup"><span data-stu-id="f0912-178">0x80090318L</span></span>          | <span data-ttu-id="f0912-179">Die Funktion wurde erfolgreich ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="f0912-179">The function succeeded.</span></span> <span data-ttu-id="f0912-180">Die Daten im Eingabepuffer sind unvollständig.</span><span class="sxs-lookup"><span data-stu-id="f0912-180">The data in the input buffer is incomplete.</span></span> <span data-ttu-id="f0912-181">Die Anwendung muss zusätzliche Daten vom Client lesen und " [<strong>akzeptsecuritycontext (</strong>](acceptsecuritycontext--credssp.md) aufzurufen)" erneut aufrufen.</span><span class="sxs-lookup"><span data-stu-id="f0912-181">The application must read additional data from the client and call [<strong>AcceptSecurityContext (CredSSP)</strong>](acceptsecuritycontext--credssp.md) again.</span></span> |
| <span data-ttu-id="f0912-182">SEC_E_INSUFFICIENT_MEMORY</span><span class="sxs-lookup"><span data-stu-id="f0912-182">SEC_E_INSUFFICIENT_MEMORY</span></span> <br/> <span data-ttu-id="f0912-183">0x80090300l</span><span class="sxs-lookup"><span data-stu-id="f0912-183">0x80090300L</span></span>         | <span data-ttu-id="f0912-184">Die Funktion ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f0912-184">The function failed.</span></span> <span data-ttu-id="f0912-185">Es ist nicht genügend Arbeitsspeicher verfügbar, um die angeforderte Aktion abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="f0912-185">There is not enough memory available to complete the requested action.</span></span>                                                                                 |
| <span data-ttu-id="f0912-186">SEC_E_INTERNAL_ERROR</span><span class="sxs-lookup"><span data-stu-id="f0912-186">SEC_E_INTERNAL_ERROR</span></span> <br/> <span data-ttu-id="f0912-187">0x80090304l</span><span class="sxs-lookup"><span data-stu-id="f0912-187">0x80090304L</span></span>              | <span data-ttu-id="f0912-188">Die Funktion ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f0912-188">The function failed.</span></span> <span data-ttu-id="f0912-189">Es ist ein Fehler aufgetreten, der keinem SSPI-Fehlercode zugeordnet wurde.</span><span class="sxs-lookup"><span data-stu-id="f0912-189">An error occurred that did not map to an SSPI error code.</span></span>                                                                                              |
| <span data-ttu-id="f0912-190">SEC_E_INVALID_HANDLE</span><span class="sxs-lookup"><span data-stu-id="f0912-190">SEC_E_INVALID_HANDLE</span></span> <br/> <span data-ttu-id="f0912-191">0x80100003l</span><span class="sxs-lookup"><span data-stu-id="f0912-191">0x80100003L</span></span>              | <span data-ttu-id="f0912-192">Die Funktion ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f0912-192">The function failed.</span></span> <span data-ttu-id="f0912-193">Das an die Funktion über gegebene Handle ist ungültig.</span><span class="sxs-lookup"><span data-stu-id="f0912-193">The handle passed to the function is not valid.</span></span>                                                                                                        |
| <span data-ttu-id="f0912-194">SEC_E_INVALID_TOKEN</span><span class="sxs-lookup"><span data-stu-id="f0912-194">SEC_E_INVALID_TOKEN</span></span> <br/> <span data-ttu-id="f0912-195">0x80090308l</span><span class="sxs-lookup"><span data-stu-id="f0912-195">0x80090308L</span></span>               | <span data-ttu-id="f0912-196">Die Funktion ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f0912-196">The function failed.</span></span> <span data-ttu-id="f0912-197">Das an die Funktion übergebenen Token ist ungültig.</span><span class="sxs-lookup"><span data-stu-id="f0912-197">The token passed to the function is not valid.</span></span>                                                                                                         |
| <span data-ttu-id="f0912-198">SEC_E_LOGON_DENIED</span><span class="sxs-lookup"><span data-stu-id="f0912-198">SEC_E_LOGON_DENIED</span></span> <br/> <span data-ttu-id="f0912-199">0x8009030cl</span><span class="sxs-lookup"><span data-stu-id="f0912-199">0x8009030CL</span></span>                | <span data-ttu-id="f0912-200">Die Anmeldung ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f0912-200">The logon failed.</span></span>                                                                                                                                                           |
| <span data-ttu-id="f0912-201">SEC_E_NO_AUTHENTICATING_AUTHORITY</span><span class="sxs-lookup"><span data-stu-id="f0912-201">SEC_E_NO_AUTHENTICATING_AUTHORITY</span></span> <br/> <span data-ttu-id="f0912-202">0x80090311l</span><span class="sxs-lookup"><span data-stu-id="f0912-202">0x80090311L</span></span> | <span data-ttu-id="f0912-203">Die Funktion ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f0912-203">The function failed.</span></span> <span data-ttu-id="f0912-204">Es konnte keine Autorität für die Authentifizierung kontaktiert werden.</span><span class="sxs-lookup"><span data-stu-id="f0912-204">No authority could be contacted for authentication.</span></span> <span data-ttu-id="f0912-205">Dies kann auf folgende Bedingungen zurückzuführen sein:</span><span class="sxs-lookup"><span data-stu-id="f0912-205">This could be due to the following conditions:</span></span><br/><ul><li><span data-ttu-id="f0912-206">Der Domänen Name der authentifizier enden Partei ist falsch.</span><span class="sxs-lookup"><span data-stu-id="f0912-206">The domain name of the authenticating party is incorrect.</span></span></li><li><span data-ttu-id="f0912-207">Die Domäne ist nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="f0912-207">The domain is unavailable.</span></span></li><li><span data-ttu-id="f0912-208">Die Vertrauensstellung ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f0912-208">The trust relationship has failed.</span></span> |
| <span data-ttu-id="f0912-209">SEC_E_NO_CREDENTIALS</span><span class="sxs-lookup"><span data-stu-id="f0912-209">SEC_E_NO_CREDENTIALS</span></span> <br/><span data-ttu-id="f0912-210">0x8009030el</span><span class="sxs-lookup"><span data-stu-id="f0912-210">0x8009030EL</span></span>               | <span data-ttu-id="f0912-211">Die Funktion ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f0912-211">The function failed.</span></span> <span data-ttu-id="f0912-212">Der im Parameter " *phcredential* " angegebene Anmelde Informations Handle ist ungültig.</span><span class="sxs-lookup"><span data-stu-id="f0912-212">The credentials handle specified in the *phCredential* parameter is not valid.</span></span>                            |
| <span data-ttu-id="f0912-213">SEC_E_OK</span><span class="sxs-lookup"><span data-stu-id="f0912-213">SEC_E_OK</span></span> <br/> <span data-ttu-id="f0912-214">0x00000000L</span><span class="sxs-lookup"><span data-stu-id="f0912-214">0x00000000L</span></span>                          | <span data-ttu-id="f0912-215">Die Funktion wurde erfolgreich ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="f0912-215">The function succeeded.</span></span> <span data-ttu-id="f0912-216">Der vom Client empfangene Sicherheitskontext wurde akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="f0912-216">The security context received from the client was accepted.</span></span> <span data-ttu-id="f0912-217">Wenn die Funktion ein Ausgabe Token generiert hat, muss das Token an den Client Prozess gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="f0912-217">If the function generated an output token, the token must be sent to the client process.</span></span> |
| <span data-ttu-id="f0912-218">SEC_E_UNSUPPORTED_FUNCTION</span><span class="sxs-lookup"><span data-stu-id="f0912-218">SEC_E_UNSUPPORTED_FUNCTION</span></span> <br/> <span data-ttu-id="f0912-219">0x80090302l</span><span class="sxs-lookup"><span data-stu-id="f0912-219">0x80090302L</span></span>        | <span data-ttu-id="f0912-220">Die Funktion ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f0912-220">The function failed.</span></span> <span data-ttu-id="f0912-221">Der *fContextReq* -Parameter hat ein ungültiges Kontext Attribut Flag (ASC_REQ_DELEGATE oder ASC_REQ_PROMPT_FOR_CREDS) angegeben.</span><span class="sxs-lookup"><span data-stu-id="f0912-221">The *fContextReq* parameter specified a context attribute flag (ASC_REQ_DELEGATE or ASC_REQ_PROMPT_FOR_CREDS) that was not valid.</span></span>                       |
| <span data-ttu-id="f0912-222">SEC_I_COMPLETE_AND_CONTINUE</span><span class="sxs-lookup"><span data-stu-id="f0912-222">SEC_I_COMPLETE_AND_CONTINUE</span></span> <br/> <span data-ttu-id="f0912-223">0x00090314l</span><span class="sxs-lookup"><span data-stu-id="f0912-223">0x00090314L</span></span>       | <span data-ttu-id="f0912-224">Die Funktion wurde erfolgreich ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="f0912-224">The function succeeded.</span></span> <span data-ttu-id="f0912-225">Der Server muss [**completeauthtoken**](/windows/win32/api/sspi/nf-sspi-completeauthtoken) aufzurufen und das Ausgabe Token an den Client übergeben.</span><span class="sxs-lookup"><span data-stu-id="f0912-225">The server must call [**CompleteAuthToken**](/windows/win32/api/sspi/nf-sspi-completeauthtoken) and pass the output token to the client.</span></span> <span data-ttu-id="f0912-226">Der Server muss dann auf ein Rückgabe Token vom Client warten, bevor er einen weiteren [**calltsecuritycontext (**](acceptsecuritycontext--credssp.md)aufzurufen) aufruft.</span><span class="sxs-lookup"><span data-stu-id="f0912-226">The server must then wait for a return token from the client before making another call to [**AcceptSecurityContext (CredSSP)**](acceptsecuritycontext--credssp.md).</span></span> |
| <span data-ttu-id="f0912-227">SEC_I_COMPLETE_NEEDED</span><span class="sxs-lookup"><span data-stu-id="f0912-227">SEC_I_COMPLETE_NEEDED</span></span> <br/> <span data-ttu-id="f0912-228">0x00090313l</span><span class="sxs-lookup"><span data-stu-id="f0912-228">0x00090313L</span></span>             | <span data-ttu-id="f0912-229">Die Funktion wurde erfolgreich ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="f0912-229">The function succeeded.</span></span> <span data-ttu-id="f0912-230">Der Server muss die Nachricht vom Client vor dem Aufrufen von [ **completeauthtoken** abschließen.](/windows/win32/api/sspi/nf-sspi-completeauthtoken)</span><span class="sxs-lookup"><span data-stu-id="f0912-230">The server must finish building the message from the client before calling [**CompleteAuthToken**](/windows/win32/api/sspi/nf-sspi-completeauthtoken)</span></span>                             |
| <span data-ttu-id="f0912-231">SEC_I_CONTINUE_NEEDED</span><span class="sxs-lookup"><span data-stu-id="f0912-231">SEC_I_CONTINUE_NEEDED</span></span> <br/> <span data-ttu-id="f0912-232">0x00090312l</span><span class="sxs-lookup"><span data-stu-id="f0912-232">0x00090312L</span></span>             | <span data-ttu-id="f0912-233">Die Funktion wurde erfolgreich ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="f0912-233">The function succeeded.</span></span> <span data-ttu-id="f0912-234">Der Server muss das Ausgabe Token an den Client senden und auf ein zurück gegebenes Token warten.</span><span class="sxs-lookup"><span data-stu-id="f0912-234">The server must send the output token to the client and wait for a returned token.</span></span> <span data-ttu-id="f0912-235">Das zurückgegebene Token sollte bei einem weiteren Aufrufen von "Accept- [**SecurityContext (kredssp)**](acceptsecuritycontext--credssp.md)" in *pinput* übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="f0912-235">The returned token should be passed in *pInput* for another call to [**AcceptSecurityContext (CredSSP)**](acceptsecuritycontext--credssp.md).</span></span>


## <a name="remarks"></a><span data-ttu-id="f0912-236">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="f0912-236">Remarks</span></span>

<span data-ttu-id="f0912-237">Die Funktion " **Accept-SecurityContext (** Auflistungs Kontext)" ist der Server, der der Funktion " [**InitializeSecurityContext (kredssp)**](initializesecuritycontext--credssp.md) " entspricht.</span><span class="sxs-lookup"><span data-stu-id="f0912-237">The **AcceptSecurityContext (CredSSP)** function is the server counterpart to the [**InitializeSecurityContext (CredSSP)**](initializesecuritycontext--credssp.md) function.</span></span>

<span data-ttu-id="f0912-238">Wenn der Server eine Anforderung von einem Client empfängt, verwendet er den *fContextReq* -Parameter, um anzugeben, was für die Sitzung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="f0912-238">When the server receives a request from a client, it uses the *fContextReq* parameter to specify what it requires of the session.</span></span> <span data-ttu-id="f0912-239">Auf diese Weise kann ein Server verlangen, dass Clients eine vertrauliche oder [*Integritäts*](../secgloss/i-gly.md)aktivierte Sitzung verwenden können. Clients, die diese Anforderung nicht erfüllen können, können abgelehnt werden.</span><span class="sxs-lookup"><span data-stu-id="f0912-239">In this fashion, a server can require that clients be capable of using a confidential or [*integrity*](../secgloss/i-gly.md)-checked session; it can reject clients that cannot meet that demand.</span></span> <span data-ttu-id="f0912-240">Alternativ kann ein Server nichts erfordern. was der Client erfordert oder bereitstellen kann, wird im Parameter *pfContextAttr* zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="f0912-240">Alternatively, a server can require nothing; whatever the client requires or can provide is returned in the *pfContextAttr* parameter.</span></span>

<span data-ttu-id="f0912-241">Die Parameter " *f* " und " *pfContextAttr* " sind Bitmasken, die verschiedene Kontext Attribute darstellen.</span><span class="sxs-lookup"><span data-stu-id="f0912-241">The *fContextReq* and *pfContextAttr* parameters are bitmasks that represent various context attributes.</span></span> <span data-ttu-id="f0912-242">Eine Beschreibung der verschiedenen Attribute finden Sie unter [Kontext Anforderungen](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="f0912-242">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span>

> [!Note]  
> <span data-ttu-id="f0912-243">Während der Parameter " *pfContextAttr* " bei erfolgreicher Rückgabe gültig ist, sollten Sie die Flags in Bezug auf Sicherheitsaspekte des Kontexts nur bei der letzten erfolgreichen Rückgabe überprüfen.</span><span class="sxs-lookup"><span data-stu-id="f0912-243">While the *pfContextAttr* parameter is valid on any successful return, you should examine the flags pertaining to security aspects of the context only on the final successful return.</span></span> <span data-ttu-id="f0912-244">Zwischen Rückgabewerte können festgelegt werden, z. b. das von ISC \_ ret \_ zugewiesene \_ arbeitsspeicherflag.</span><span class="sxs-lookup"><span data-stu-id="f0912-244">Intermediate returns can set, for example, the ISC\_RET\_ALLOCATED\_MEMORY flag.</span></span>

<span data-ttu-id="f0912-245">Der Aufrufer ist dafür verantwortlich, zu bestimmen, ob die abschließenden Kontext Attribute ausreichend sind.</span><span class="sxs-lookup"><span data-stu-id="f0912-245">The caller is responsible for determining whether the final context attributes are sufficient.</span></span> <span data-ttu-id="f0912-246">Wenn beispielsweise Vertraulichkeit (Verschlüsselung) angefordert wurde, Sie aber nicht eingerichtet werden konnte, können einige Anwendungen die Verbindung sofort beenden.</span><span class="sxs-lookup"><span data-stu-id="f0912-246">For example, if confidentiality (encryption) was requested but could not be established, some applications may choose to shut down the connection immediately.</span></span> <span data-ttu-id="f0912-247">Wenn der Sicherheitskontext nicht eingerichtet werden kann, muss der Server den teilweise erstellten Kontext durch Aufrufen der [**Delta Context**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) -Funktion freigeben.</span><span class="sxs-lookup"><span data-stu-id="f0912-247">If the security context cannot be established, the server must free the partially created context by calling the [**DeleteSecurityContext**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) function.</span></span> <span data-ttu-id="f0912-248">Informationen dazu, wann Sie die **Delta Context** -Funktion aufzurufen, finden Sie unter **Delta Context**.</span><span class="sxs-lookup"><span data-stu-id="f0912-248">For information about when to call the **DeleteSecurityContext** function, see **DeleteSecurityContext**.</span></span>

<span data-ttu-id="f0912-249">Nachdem der Sicherheitskontext eingerichtet wurde, kann die Serveranwendung die [**querysecuritycontexttoken**](/windows/win32/api/sspi/nf-sspi-querysecuritycontexttoken) -Funktion verwenden, um ein Handle für das Benutzerkonto abzurufen, dem das Client Zertifikat zugeordnet wurde.</span><span class="sxs-lookup"><span data-stu-id="f0912-249">After the security context has been established, the server application can use the [**QuerySecurityContextToken**](/windows/win32/api/sspi/nf-sspi-querysecuritycontexttoken) function to retrieve a handle to the user account to which the client certificate was mapped.</span></span> <span data-ttu-id="f0912-250">Der Server kann die Identität des Benutzers auch mit der Identität [**atesecuritycontext**](/windows/win32/api/sspi/nf-sspi-impersonatesecuritycontext) -Funktion annehmen.</span><span class="sxs-lookup"><span data-stu-id="f0912-250">Also, the server can use the [**ImpersonateSecurityContext**](/windows/win32/api/sspi/nf-sspi-impersonatesecuritycontext) function to impersonate the user.</span></span>

## <a name="requirements"></a><span data-ttu-id="f0912-251">Anforderungen</span><span class="sxs-lookup"><span data-stu-id="f0912-251">Requirements</span></span>

| <span data-ttu-id="f0912-252">Anforderung</span><span class="sxs-lookup"><span data-stu-id="f0912-252">Requirement</span></span> | <span data-ttu-id="f0912-253">Wert</span><span class="sxs-lookup"><span data-stu-id="f0912-253">Value</span></span> |
|--------------------------|-------------------------------------------|
| <span data-ttu-id="f0912-254">Unterstützte Mindestversion (Client)</span><span class="sxs-lookup"><span data-stu-id="f0912-254">Minimum supported client</span></span> | <span data-ttu-id="f0912-255">Nur Windows Vista \[ -Desktop-Apps\]</span><span class="sxs-lookup"><span data-stu-id="f0912-255">Windows�Vista \[desktop apps only\]</span></span>       |
| <span data-ttu-id="f0912-256">Unterstützte Mindestversion (Server)</span><span class="sxs-lookup"><span data-stu-id="f0912-256">Minimum supported server</span></span> | <span data-ttu-id="f0912-257">Nur Windows Server 2008 \[ -Desktop-Apps\]</span><span class="sxs-lookup"><span data-stu-id="f0912-257">Windows Server�2008 \[desktop apps only\]</span></span> |
| <span data-ttu-id="f0912-258">Header</span><span class="sxs-lookup"><span data-stu-id="f0912-258">Header</span></span>                   | <span data-ttu-id="f0912-259">SSPI. h (Include Security. h)</span><span class="sxs-lookup"><span data-stu-id="f0912-259">Sspi.h (include Security.h)</span></span>               |
| <span data-ttu-id="f0912-260">Bibliothek</span><span class="sxs-lookup"><span data-stu-id="f0912-260">Library</span></span>                  | <span data-ttu-id="f0912-261">Secur32. lib</span><span class="sxs-lookup"><span data-stu-id="f0912-261">Secur32.lib</span></span>                               |
| <span data-ttu-id="f0912-262">DLL</span><span class="sxs-lookup"><span data-stu-id="f0912-262">DLL</span></span>                      | <span data-ttu-id="f0912-263">Secur32.dll</span><span class="sxs-lookup"><span data-stu-id="f0912-263">Secur32.dll</span></span>                               |

## <a name="see-also"></a><span data-ttu-id="f0912-264">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="f0912-264">See also</span></span>

- [<span data-ttu-id="f0912-265">SSPI-Funktionen</span><span class="sxs-lookup"><span data-stu-id="f0912-265">SSPI Functions</span></span>](authentication-functions.md#sspi-functions)
- [<span data-ttu-id="f0912-266">**Delta Context-Kontext**</span><span class="sxs-lookup"><span data-stu-id="f0912-266">**DeleteSecurityContext**</span></span>](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext)
- [<span data-ttu-id="f0912-267">**InitializeSecurityContext (kredssp)**</span><span class="sxs-lookup"><span data-stu-id="f0912-267">**InitializeSecurityContext (CredSSP)**</span></span>](initializesecuritycontext--credssp.md)
