---
description: Da das Kerberos-Protokoll ursprünglich entworfen wurde, wurde ein Hauptschlüssel für einen Benutzer von einem vom Benutzer bereitgestellten Kennwort abgeleitet.
ms.assetid: b8fcb68d-751e-4495-ab92-8b70c96aaa7a
title: Ticket-Granting Tickets
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39dff161ba2d905f676fe6b6b5e7e7d5289ee550
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "104129313"
---
# <a name="ticket-granting-tickets"></a><span data-ttu-id="30731-103">Ticket-Granting Tickets</span><span class="sxs-lookup"><span data-stu-id="30731-103">Ticket-Granting Tickets</span></span>

<span data-ttu-id="30731-104">Da das [*Kerberos-Protokoll*](../secgloss/k-gly.md) ursprünglich entworfen wurde, wurde ein Hauptschlüssel für einen Benutzer von einem vom Benutzer bereitgestellten Kennwort abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="30731-104">As the [*Kerberos protocol*](../secgloss/k-gly.md) was originally designed, a master key for a user was derived from a password provided by the user.</span></span> <span data-ttu-id="30731-105">Wenn ein Benutzer sich angemeldet hat, hat der Kerberos-Client auf der Arbeitsstation des Benutzers das Kennwort vom Benutzer akzeptiert und in einen Verschlüsselungsschlüssel konvertiert, indem der Text über eine unidirektionale [*Hash*](../secgloss/h-gly.md) Funktion übergeben wurde.</span><span class="sxs-lookup"><span data-stu-id="30731-105">When a user logged on, the Kerberos client on the user's workstation accepted the password from the user and converted it into an encryption key by passing the text through a one-way [*hash*](../secgloss/h-gly.md) function.</span></span> <span data-ttu-id="30731-106">Der resultierende Hash war der [*Hauptschlüssel*](../secgloss/m-gly.md)des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="30731-106">The resulting hash was the user's [*master key*](../secgloss/m-gly.md).</span></span> <span data-ttu-id="30731-107">Der Client hat diesen *Hauptschlüssel* zum Entschlüsseln von [*Sitzungs Schlüsseln*](../secgloss/s-gly.md) verwendet, die von KDC empfangen wurden.</span><span class="sxs-lookup"><span data-stu-id="30731-107">The client used this *master key* to decrypt [*session keys*](../secgloss/s-gly.md) received from KDC.</span></span>

<span data-ttu-id="30731-108">Das Problem mit dem ursprünglichen Kerberos-Entwurf besteht darin, dass der Client den Hauptschlüssel des Benutzers jedes Mal benötigt, wenn er einen Sitzungsschlüssel aus dem KDC entschlüsselt.</span><span class="sxs-lookup"><span data-stu-id="30731-108">The problem with the original Kerberos design is the client needs the user's master key each time it decrypts a session key from the KDC.</span></span> <span data-ttu-id="30731-109">Dies bedeutet, dass der Client den Benutzer zum Anfang jedes Client/Server-Austauschs auffordern muss, oder der Client muss den Benutzerschlüssel auf der Arbeitsstation speichern.</span><span class="sxs-lookup"><span data-stu-id="30731-109">That means either the client must ask the user for the password at the beginning of every client/server exchange, or the client must store the user's key on the workstation.</span></span> <span data-ttu-id="30731-110">Häufige Unterbrechungen des Benutzers sind zu stark aufdringlich.</span><span class="sxs-lookup"><span data-stu-id="30731-110">Frequent interruptions of the user are too intrusive.</span></span> <span data-ttu-id="30731-111">Wenn Sie den Schlüssel auf der Arbeitsstation speichern, riskieren Sie die Gefährdung eines Schlüssels, der vom Benutzer Kennwort abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="30731-111">Storing the key on the workstation risks compromising a key derived from the user password which is a long term key.</span></span>

<span data-ttu-id="30731-112">Die Lösung des Kerberos-Protokolls für dieses Problem besteht darin, dass der Client einen temporären Schlüssel vom KDC erhält.</span><span class="sxs-lookup"><span data-stu-id="30731-112">The Kerberos protocol's solution to this problem is for the client to get a temporary key from the KDC.</span></span> <span data-ttu-id="30731-113">Dieser temporäre Schlüssel eignet sich nur für diese [*Anmelde Sitzung*](../secgloss/l-gly.md).</span><span class="sxs-lookup"><span data-stu-id="30731-113">This temporary key is good only for this [*logon session*](../secgloss/l-gly.md).</span></span> <span data-ttu-id="30731-114">Wenn sich ein Benutzer anmeldet, fordert der Client ein Ticket für den KDC an, so wie er ein Ticket für jeden anderen Dienst anfordern würde.</span><span class="sxs-lookup"><span data-stu-id="30731-114">When a user logs on, the client requests a ticket for the KDC just as it would request a ticket for any other service.</span></span> <span data-ttu-id="30731-115">Der KDC antwortet, indem er einen Anmelde Sitzungsschlüssel und ein Ticket für einen speziellen Server erstellt, den vollständigen Ticket Erteilungs Dienst des KDC.</span><span class="sxs-lookup"><span data-stu-id="30731-115">The KDC responds by creating a logon session key and a ticket for a special server, the KDC's full ticket-granting service.</span></span> <span data-ttu-id="30731-116">Eine Kopie des Anmelde Sitzungsschlüssels ist in das Ticket eingebettet, und das Ticket wird mit dem Hauptschlüssel des KDC verschlüsselt.</span><span class="sxs-lookup"><span data-stu-id="30731-116">One copy of the logon session key is embedded in the ticket, and the ticket is encrypted with the KDC's master key.</span></span> <span data-ttu-id="30731-117">Eine andere Kopie des Anmelde Sitzungsschlüssels wird mit dem Hauptschlüssel des Benutzers verschlüsselt, der aus dem Anmelde Kennwort des Benutzers abgeleitet wurde.</span><span class="sxs-lookup"><span data-stu-id="30731-117">Another copy of the logon session key is encrypted with the user's master key derived from the user's logon password.</span></span> <span data-ttu-id="30731-118">Sowohl das Ticket als auch der verschlüsselte Sitzungsschlüssel werden an den Client gesendet.</span><span class="sxs-lookup"><span data-stu-id="30731-118">Both the ticket and the encrypted session key are sent to the client.</span></span>

<span data-ttu-id="30731-119">Wenn der Client die KDC-Antwort erhält, entschlüsselt er den Anmelde Sitzungsschlüssel mit dem Hauptschlüssel des Benutzers, der aus dem Kennwort des Benutzers abgeleitet wurde.</span><span class="sxs-lookup"><span data-stu-id="30731-119">When the client gets the KDC's reply, it decrypts the logon session key with the user's master key derived from the user's password.</span></span> <span data-ttu-id="30731-120">Der Client benötigt nicht mehr den Schlüssel, der aus dem Kennwort des Benutzers abgeleitet wurde, da der Client nun den Anmelde Sitzungsschlüssel verwendet, um seine Kopie eines beliebigen Server Sitzungsschlüssels zu entschlüsseln, der vom KDC abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="30731-120">The client no longer needs the key derived from the user's password because the client will now use the logon session key to decrypt its copy of any server session key it gets from the KDC.</span></span> <span data-ttu-id="30731-121">Der Client speichert den Anmelde Sitzungsschlüssel in seinem Ticket Cache zusammen mit dem Ticket für den vollständigen Ticket Erteilungs Dienst des KDC.</span><span class="sxs-lookup"><span data-stu-id="30731-121">The client stores the logon session key in its ticket cache along with its ticket for the KDC's full ticket-granting service.</span></span>

<span data-ttu-id="30731-122">Das Ticket für den vollständigen Ticket Erteilungs Dienst wird als Ticket Erteilungs Ticket (TGT) bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="30731-122">The ticket for the full ticket-granting service is called a ticket-granting ticket (TGT).</span></span> <span data-ttu-id="30731-123">Wenn der Client die KDC nach einem Ticket an einen Server anfordert, werden die [*Anmelde*](../secgloss/c-gly.md) Informationen in Form einer Authentifikator-Nachricht und eines Tickets angezeigt – in diesem Fall ein TGT –, so wie es Anmelde Informationen für jeden anderen Dienst darstellen würde.</span><span class="sxs-lookup"><span data-stu-id="30731-123">When the client asks the KDC for a ticket to a server, it presents [*credentials*](../secgloss/c-gly.md) in the form of an authenticator message and a ticket — in this case a TGT — just as it would present credentials to any other service.</span></span> <span data-ttu-id="30731-124">Der Ticket Erteilungs Dienst öffnet den TGT mit dem Hauptschlüssel, extrahiert den Anmelde Sitzungsschlüssel für diesen Client und verwendet den Anmelde Sitzungsschlüssel, um die Client Kopie eines Sitzungsschlüssels für den Server zu verschlüsseln.</span><span class="sxs-lookup"><span data-stu-id="30731-124">The ticket-granting service opens the TGT with its master key, extracts the logon session key for this client, and uses the logon session key to encrypt the client's copy of a session key for the server.</span></span>

 

 
