---
description: Das TLS-Handshake-Protokoll (Transport Layer Security) ist für die Authentifizierung und den Schlüsselaustausch zuständig, die erforderlich sind, um sichere Sitzungen einzurichten oder fortzusetzen.
ms.assetid: 65fb4db3-e505-457a-9159-dba0b506ea0b
title: TLS-Handshake-Protokoll
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e0c7cfa9e9db54a6035abe147ce00bbde59bcc86
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "106350022"
---
# <a name="tls-handshake-protocol"></a><span data-ttu-id="91daa-103">TLS-Handshake-Protokoll</span><span class="sxs-lookup"><span data-stu-id="91daa-103">TLS Handshake Protocol</span></span>

<span data-ttu-id="91daa-104">Das TLS-Handshake-Protokoll ( [*Transport Layer Security*](../secgloss/t-gly.md) ) ist für die Authentifizierung und den Schlüsselaustausch zuständig, die erforderlich sind, um sichere Sitzungen einzurichten oder fortzusetzen.</span><span class="sxs-lookup"><span data-stu-id="91daa-104">The [*Transport Layer Security*](../secgloss/t-gly.md) (TLS) Handshake Protocol is responsible for the authentication and key exchange necessary to establish or resume secure sessions.</span></span> <span data-ttu-id="91daa-105">Beim Einrichten einer sicheren [*Sitzung*](../secgloss/s-gly.md)verwaltet das Handshake-Protokoll Folgendes:</span><span class="sxs-lookup"><span data-stu-id="91daa-105">When establishing a secure [*session*](../secgloss/s-gly.md), the Handshake Protocol manages the following:</span></span>

-   <span data-ttu-id="91daa-106">Cipher Suite-Aushandlung</span><span class="sxs-lookup"><span data-stu-id="91daa-106">Cipher suite negotiation</span></span>
-   <span data-ttu-id="91daa-107">Authentifizierung des Servers und optional des Clients</span><span class="sxs-lookup"><span data-stu-id="91daa-107">Authentication of the server and optionally, the client</span></span>
-   <span data-ttu-id="91daa-108">Informationsaustausch für Sitzungsschlüssel.</span><span class="sxs-lookup"><span data-stu-id="91daa-108">Session key information exchange.</span></span>

## <a name="cipher-suite-negotiation"></a><span data-ttu-id="91daa-109">Cipher Suite-Aushandlung</span><span class="sxs-lookup"><span data-stu-id="91daa-109">Cipher Suite Negotiation</span></span>

<span data-ttu-id="91daa-110">Der Client und der Server stellen eine Verbindung her und wählen die Verschlüsselungs Sammlung aus, die im gesamten Nachrichtenaustausch verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="91daa-110">The client and server make contact and choose the cipher suite that will be used throughout their message exchange.</span></span>

## <a name="authentication"></a><span data-ttu-id="91daa-111">Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="91daa-111">Authentication</span></span>

<span data-ttu-id="91daa-112">In TLS weist ein Server seine Identität dem Client zu.</span><span class="sxs-lookup"><span data-stu-id="91daa-112">In TLS, a server proves its identity to the client.</span></span> <span data-ttu-id="91daa-113">Außerdem muss der Client seine Identität möglicherweise dem Server nachweisen.</span><span class="sxs-lookup"><span data-stu-id="91daa-113">The client might also need to prove its identity to the server.</span></span> <span data-ttu-id="91daa-114">PKI, die Verwendung von [*öffentlichen/privaten Schlüsselpaaren*](../secgloss/p-gly.md), ist die Grundlage für diese Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="91daa-114">PKI, the use of [*public/private key pairs*](../secgloss/p-gly.md), is the basis of this authentication.</span></span> <span data-ttu-id="91daa-115">Die genaue Methode, die für die Authentifizierung verwendet wird, wird von der ausgehandelten Chiffre Sammlung bestimmt.</span><span class="sxs-lookup"><span data-stu-id="91daa-115">The exact method used for authentication is determined by the cipher suite negotiated.</span></span>

## <a name="key-exchange"></a><span data-ttu-id="91daa-116">Schlüsselaustausch</span><span class="sxs-lookup"><span data-stu-id="91daa-116">Key Exchange</span></span>

<span data-ttu-id="91daa-117">Der Client und der Server tauschen Zufallszahlen und eine besondere Zahl aus, die als geheimer Hauptschlüssel bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="91daa-117">The client and server exchange random numbers and a special number called the Pre-Master Secret.</span></span> <span data-ttu-id="91daa-118">Diese Zahlen werden mit zusätzlichen Daten kombiniert, sodass Client und Server ihren gemeinsamen geheimen Schlüssel erstellen können, der als geheimer Hauptschlüssel bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="91daa-118">These numbers are combined with additional data permitting client and server to create their shared secret, called the Master Secret.</span></span> <span data-ttu-id="91daa-119">Der geheime Hauptschlüssel wird von Client und Server verwendet, um den geheimen Lese Schlüssel zu generieren. Dies ist der für das [*Hashwert*](../secgloss/h-gly.md)verwendete Sitzungsschlüssel und der Schlüssel zum Schreiben, bei dem es sich um den [*Sitzungsschlüssel*](../secgloss/s-gly.md) handelt, der für die Verschlüsselung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="91daa-119">The Master Secret is used by client and server to generate the write MAC secret, which is the session key used for [*hashing*](../secgloss/h-gly.md), and the write key, which is the [*session key*](../secgloss/s-gly.md) used for encryption.</span></span>

## <a name="establishing-a-secure-session-by-using-tls"></a><span data-ttu-id="91daa-120">Einrichten einer sicheren Sitzung mithilfe von TLS</span><span class="sxs-lookup"><span data-stu-id="91daa-120">Establishing a Secure Session by Using TLS</span></span>

<span data-ttu-id="91daa-121">Das TLS-Handshake-Protokoll umfasst die folgenden Schritte:</span><span class="sxs-lookup"><span data-stu-id="91daa-121">The TLS Handshake Protocol involves the following steps:</span></span>

1.  <span data-ttu-id="91daa-122">Der Client sendet eine "Client Hello"-Meldung sowie den Zufallswert und die unterstützten Verschlüsselungs Sammlungen des Clients an den Server.</span><span class="sxs-lookup"><span data-stu-id="91daa-122">The client sends a "Client hello" message to the server, along with the client's random value and supported cipher suites.</span></span>
2.  <span data-ttu-id="91daa-123">Der Server antwortet, indem er eine "Server Hello"-Meldung zusammen mit dem zufälligen Wert des Servers an den Client sendet.</span><span class="sxs-lookup"><span data-stu-id="91daa-123">The server responds by sending a "Server hello" message to the client, along with the server's random value.</span></span>
3.  <span data-ttu-id="91daa-124">Der Server sendet sein Zertifikat zur Authentifizierung an den Client und fordert möglicherweise ein Zertifikat vom Client an.</span><span class="sxs-lookup"><span data-stu-id="91daa-124">The server sends its certificate to the client for authentication and may request a certificate from the client.</span></span> <span data-ttu-id="91daa-125">Der Server sendet die Meldung "Server Hello Done".</span><span class="sxs-lookup"><span data-stu-id="91daa-125">The server sends the "Server hello done" message.</span></span>
4.  <span data-ttu-id="91daa-126">Wenn der Server ein Zertifikat vom Client angefordert hat, sendet der Client es.</span><span class="sxs-lookup"><span data-stu-id="91daa-126">If the server has requested a certificate from the client, the client sends it.</span></span>
5.  <span data-ttu-id="91daa-127">Der Client erstellt einen zufälligen geheimen Hauptschlüssel und verschlüsselt ihn mit dem [*öffentlichen Schlüssel*](../secgloss/p-gly.md) aus dem Zertifikat des Servers, wobei der verschlüsselte geheime Hauptschlüssel an den Server gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="91daa-127">The client creates a random Pre-Master Secret and encrypts it with the [*public key*](../secgloss/p-gly.md) from the server's certificate, sending the encrypted Pre-Master Secret to the server.</span></span>
6.  <span data-ttu-id="91daa-128">Der Server empfängt den geheimen Hauptschlüssel.</span><span class="sxs-lookup"><span data-stu-id="91daa-128">The server receives the Pre-Master Secret.</span></span> <span data-ttu-id="91daa-129">Der Server und der Client generieren jeweils den geheimen Haupt [*Schlüssel und die Sitzungsschlüssel*](../secgloss/s-gly.md) basierend auf dem geheimen Hauptschlüssel.</span><span class="sxs-lookup"><span data-stu-id="91daa-129">The server and client each generate the Master Secret and [*session keys*](../secgloss/s-gly.md) based on the Pre-Master Secret.</span></span>
7.  <span data-ttu-id="91daa-130">Der Client sendet eine Benachrichtigung vom Typ "Verschlüsselungs Spezifikation ändern" an den Server, um anzugeben, dass der Client die neuen [*Sitzungsschlüssel*](../secgloss/s-gly.md) für das [*hashten*](../secgloss/h-gly.md) und Verschlüsseln von Nachrichten verwendet.</span><span class="sxs-lookup"><span data-stu-id="91daa-130">The client sends "Change cipher spec" notification to server to indicate that the client will start using the new [*session keys*](../secgloss/s-gly.md) for [*hashing*](../secgloss/h-gly.md) and encrypting messages.</span></span> <span data-ttu-id="91daa-131">Der Client sendet außerdem die Meldung "der Client wurde beendet".</span><span class="sxs-lookup"><span data-stu-id="91daa-131">Client also sends "Client finished" message.</span></span>
8.  <span data-ttu-id="91daa-132">Der Server empfängt "Verschlüsselungs Spezifikation ändern" und schaltet seinen Sicherheitsstatus auf Datensatzebene mithilfe der [*Sitzungsschlüssel*](../secgloss/s-gly.md)in die [*symmetrische Verschlüsselung*](../secgloss/s-gly.md) ein.</span><span class="sxs-lookup"><span data-stu-id="91daa-132">Server receives "Change cipher spec" and switches its record layer security state to [*symmetric encryption*](../secgloss/s-gly.md) using the [*session keys*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="91daa-133">Der Server sendet die Meldung "der Server wurde beendet" an den Client.</span><span class="sxs-lookup"><span data-stu-id="91daa-133">Server sends "Server finished" message to the client.</span></span>
9.  <span data-ttu-id="91daa-134">Client und Server können nun Anwendungsdaten über den gesicherten Kanal austauschen, den Sie eingerichtet haben.</span><span class="sxs-lookup"><span data-stu-id="91daa-134">Client and server can now exchange application data over the secured channel they have established.</span></span> <span data-ttu-id="91daa-135">Alle vom Client an den Server und vom Server an den Client gesendeten Nachrichten werden mit dem Sitzungsschlüssel verschlüsselt.</span><span class="sxs-lookup"><span data-stu-id="91daa-135">All messages sent from client to server and from server to client are encrypted using session key.</span></span>

## <a name="resuming-a-secure-session-by-using-tls"></a><span data-ttu-id="91daa-136">Fortsetzen einer sicheren Sitzung mithilfe von TLS</span><span class="sxs-lookup"><span data-stu-id="91daa-136">Resuming a Secure Session by Using TLS</span></span>

1.  <span data-ttu-id="91daa-137">Der Client sendet eine "Client Hello"-Meldung mithilfe der Sitzungs-ID der Sitzung, die fortgesetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="91daa-137">The client sends a "Client hello" message using the Session ID of the session to be resumed.</span></span>
2.  <span data-ttu-id="91daa-138">Der Server überprüft seinen Sitzungs Cache auf eine passende Sitzungs-ID.</span><span class="sxs-lookup"><span data-stu-id="91daa-138">The server checks its session cache for a matching Session ID.</span></span> <span data-ttu-id="91daa-139">Wenn eine Entsprechung gefunden wird und der Server die Sitzung fortsetzen kann, sendet er eine "Server Hello"-Meldung mit der Sitzungs-ID.</span><span class="sxs-lookup"><span data-stu-id="91daa-139">If a match is found, and the server is able to resume the session, it sends a "Server hello" message with the Session ID.</span></span>
    > [!Note]  
    > <span data-ttu-id="91daa-140">Wenn keine Sitzungs-ID gefunden wird, generiert der Server eine neue Sitzungs-ID, und der TLS-Client und-Server führen einen vollständigen Handshake aus.</span><span class="sxs-lookup"><span data-stu-id="91daa-140">If a session ID match is not found, the server generates a new session ID and the TLS client and server perform a full handshake.</span></span>

     

3.  <span data-ttu-id="91daa-141">Client und Server müssen die Nachrichten "Änderung der Verschlüsselungs Spezifikation" austauschen und "Client wurde beendet" und "Server beendet" senden.</span><span class="sxs-lookup"><span data-stu-id="91daa-141">Client and server must exchange "Change cipher spec" messages and send "Client finished" and "Server finished" messages.</span></span>
4.  <span data-ttu-id="91daa-142">Client und Server können nun den Anwendungsdaten Austausch über den sicheren Kanal fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="91daa-142">Client and server can now resume application data exchange over the secure channel.</span></span>

 

 
