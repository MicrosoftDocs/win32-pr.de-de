---
description: Initiiert den Client seitigen ausgehenden [*Sicherheitskontext*](../secgloss/s-gly.md) von einem Anmelde Informations Handle mithilfe der eingeschränkten SChannel- [*Delegierung*](../secgloss/s-gly.md).
ms.assetid: c451089a-d10d-469c-99dd-43d75a6b0b2a
title: InitializeSecurityContext (SChannel)-Funktion (SSPI. h)
ms.topic: reference
ms.date: 07/25/2019
ms.openlocfilehash: ac552370727659e43b762d55019132ac1c4ea1e5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/07/2021
ms.locfileid: "106343037"
---
# <a name="initializesecuritycontext-schannel-function"></a><span data-ttu-id="f5cbc-103">InitializeSecurityContext-Funktion (SChannel)</span><span class="sxs-lookup"><span data-stu-id="f5cbc-103">InitializeSecurityContext (Schannel) function</span></span>

<span data-ttu-id="f5cbc-104">Die Funktion **InitializeSecurityContext (SChannel)** initiiert den Client seitigen ausgehenden [*Sicherheitskontext*](../secgloss/s-gly.md) von einem Anmelde Informationen-handle.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-104">The **InitializeSecurityContext (Schannel)** function initiates the client side, outbound [*security context*](../secgloss/s-gly.md) from a credential handle.</span></span> <span data-ttu-id="f5cbc-105">Die-Funktion wird verwendet, um einen [*Sicherheitskontext*](../secgloss/s-gly.md) zwischen der Client Anwendung und einem Remotepeer zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-105">The function is used to build a [*security context*](../secgloss/s-gly.md) between the client application and a remote peer.</span></span> <span data-ttu-id="f5cbc-106">**InitializeSecurityContext (SChannel)** gibt ein Token zurück, das der Client an den Remotepeer übergeben muss, den der Peer wiederum über den [**calltsecuritycontext (SChannel)**](acceptsecuritycontext--schannel.md) -Befehl an die lokale Sicherheits Implementierung übermittelt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-106">**InitializeSecurityContext (Schannel)** returns a token that the client must pass to the remote peer, which the peer in turn submits to the local security implementation through the [**AcceptSecurityContext (Schannel)**](acceptsecuritycontext--schannel.md) call.</span></span> <span data-ttu-id="f5cbc-107">Das generierte Token sollte von allen Aufrufern als nicht transparent angesehen werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-107">The token generated should be considered opaque by all callers.</span></span>

<span data-ttu-id="f5cbc-108">In der Regel wird die **InitializeSecurityContext-Funktion (SChannel)** in einer Schleife aufgerufen, bis ein ausreichender [*Sicherheitskontext*](../secgloss/s-gly.md) eingerichtet wird.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-108">Typically, the **InitializeSecurityContext (Schannel)** function is called in a loop until a sufficient [*security context*](../secgloss/s-gly.md) is established.</span></span>

## <a name="syntax"></a><span data-ttu-id="f5cbc-109">Syntax</span><span class="sxs-lookup"><span data-stu-id="f5cbc-109">Syntax</span></span>


```C++
SECURITY_STATUS SEC_Entry InitializeSecurityContext(
  _In_opt_    PCredHandle    phCredential,
  _In_opt_    PCtxtHandle    phContext,
  _In_opt_    SEC_CHAR       *pszTargetName,
  _In_        ULONG          fContextReq,
  _In_        ULONG          Reserved1,
  _In_        ULONG          TargetDataRep,
  _In_opt_    PSecBufferDesc pInput,
  _In_        ULONG          Reserved2,
  _Inout_opt_ PCtxtHandle    phNewContext,
  _Inout_opt_ PSecBufferDesc pOutput,
  _Out_       PULONG         pfContextAttr,
  _Out_opt_   PTimeStamp     ptsExpiry
);
```



## <a name="parameters"></a><span data-ttu-id="f5cbc-110">Parameter</span><span class="sxs-lookup"><span data-stu-id="f5cbc-110">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="f5cbc-111">*phcredential* \[ in, optional\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-111">*phCredential* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-112">Ein Handle für die Anmelde Informationen, die von [**AcquireCredentialsHandle (SChannel)**](acquirecredentialshandle--schannel.md)zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-112">A handle to the credentials returned by [**AcquireCredentialsHandle (Schannel)**](acquirecredentialshandle--schannel.md).</span></span> <span data-ttu-id="f5cbc-113">Dieses Handle wird zum Erstellen des [*Sicherheits Kontexts*](../secgloss/s-gly.md)verwendet.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-113">This handle is used to build the [*security context*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="f5cbc-114">Die Funktion **InitializeSecurityContext (SChannel)** erfordert mindestens ausgehende Anmelde Informationen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-114">The **InitializeSecurityContext (Schannel)** function requires at least OUTBOUND credentials.</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-115">*phcontext* \[ in, optional\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-115">*phContext* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-116">Ein Zeiger auf eine [ctxthandle](sspi-handles.md) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-116">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="f5cbc-117">Beim ersten Aufrufe von **InitializeSecurityContext (SChannel)** ist dieser Zeiger **null**.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-117">On the first call to **InitializeSecurityContext (Schannel)**, this pointer is **NULL**.</span></span> <span data-ttu-id="f5cbc-118">Beim zweiten-Befehl ist dieser Parameter ein Zeiger auf das Handle des partiell formatierten Kontexts, der durch den ersten-Befehl im *phnewcontext* -Parameter zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-118">On the second call, this parameter is a pointer to the handle to the partially formed context returned in the *phNewContext* parameter by the first call.</span></span>

<span data-ttu-id="f5cbc-119">Geben Sie beim ersten aufzurufen von **InitializeSecurityContext (SChannel)** **null** an.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-119">On the first call to **InitializeSecurityContext (Schannel)**, specify **NULL**.</span></span> <span data-ttu-id="f5cbc-120">Geben Sie bei zukünftigen aufrufen das Token an, das nach dem ersten Aufruf dieser Funktion im Parameter " *phnewcontext* " empfangen wurde.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-120">On future calls, specify the token received in the *phNewContext* parameter after the first call to this function.</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-121">*psztargetname* \[ in, optional\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-121">*pszTargetName* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-122">Ein Zeiger auf eine NULL-terminierte Zeichenfolge, die den Zielserver eindeutig identifiziert.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-122">A pointer to a null-terminated string that uniquely identifies the target server.</span></span> <span data-ttu-id="f5cbc-123">SChannel verwendet diesen Wert, um das Serverzertifikat zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-123">Schannel uses this value to verify the server certificate.</span></span> <span data-ttu-id="f5cbc-124">SChannel verwendet diesen Wert auch, um die Sitzung im Sitzungs Cache zu finden, wenn eine Verbindung wieder hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-124">Schannel also uses this value to locate the session in the session cache when reestablishing a connection.</span></span> <span data-ttu-id="f5cbc-125">Die zwischengespeicherte Sitzung wird nur verwendet, wenn alle der folgenden Bedingungen erfüllt sind:</span><span class="sxs-lookup"><span data-stu-id="f5cbc-125">The cached session is used only if all of the following conditions are met:</span></span>

-   <span data-ttu-id="f5cbc-126">Der Zielname ist identisch.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-126">The target name is the same.</span></span>
-   <span data-ttu-id="f5cbc-127">Der Cache Eintrag ist nicht abgelaufen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-127">The cache entry has not expired.</span></span>
-   <span data-ttu-id="f5cbc-128">Der Anwendungsprozess, der die Funktion aufruft, ist identisch.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-128">The application process that calls the function is the same.</span></span>
-   <span data-ttu-id="f5cbc-129">Die Anmelde Sitzung ist identisch.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-129">The logon session is the same.</span></span>
-   <span data-ttu-id="f5cbc-130">Das Anmelde Informations Handle ist identisch.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-130">The credential handle is the same.</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-131">*"f"* \[ in\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-131">*fContextReq* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-132">Bitflags, die Anforderungen für den Kontext angeben.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-132">Bit flags that indicate requests for the context.</span></span> <span data-ttu-id="f5cbc-133">Nicht alle Pakete können alle Anforderungen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-133">Not all packages can support all requirements.</span></span> <span data-ttu-id="f5cbc-134">Flags, die für diesen Parameter verwendet werden, haben das Präfix ISC \_ req \_ , z \_ . b. ISC req-Delegat \_ .</span><span class="sxs-lookup"><span data-stu-id="f5cbc-134">Flags used for this parameter are prefixed with ISC\_REQ\_, for example, ISC\_REQ\_DELEGATE.</span></span> <span data-ttu-id="f5cbc-135">Dieser Parameter kann mindestens eines der folgenden Attributflags sein.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-135">This parameter can be one or more of the following attributes flags.</span></span>



<table><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><thead><tr class="header"><th><span data-ttu-id="f5cbc-136">Wert</span><span class="sxs-lookup"><span data-stu-id="f5cbc-136">Value</span></span></th><th><span data-ttu-id="f5cbc-137">Bedeutung</span><span class="sxs-lookup"><span data-stu-id="f5cbc-137">Meaning</span></span></th></tr></thead><tbody><tr class="odd"><td><span id="ISC_REQ_ALLOCATE_MEMORY"></span><span id="isc_req_allocate_memory"></span><dl> <span data-ttu-id="f5cbc-138"><dt><strong>ISC_REQ_ALLOCATE_MEMORY</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-138"><dt><strong>ISC_REQ_ALLOCATE_MEMORY</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-139">Das [*Sicherheitspaket*](../secgloss/s-gly.md) weist Ihnen Ausgabepuffer zu.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-139">The [*security package*](../secgloss/s-gly.md) allocates output buffers for you.</span></span> <span data-ttu-id="f5cbc-140">Wenn Sie die Ausgabepuffer nicht mehr verwenden, geben Sie Sie frei, indem Sie die [<strong>freecontextbuffer</strong>] (/Windows/Win32/API/SSPI/NF-SSPI-freecontextbuffer)-Funktion aufrufen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-140">When you have finished using the output buffers, free them by calling the [<strong>FreeContextBuffer</strong>](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) function.</span></span><br/></td></tr><tr class="even"><td><span id="ISC_REQ_CONFIDENTIALITY"></span><span id="isc_req_confidentiality"></span><dl> <span data-ttu-id="f5cbc-141"><dt><strong>ISC_REQ_CONFIDENTIALITY</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-141"><dt><strong>ISC_REQ_CONFIDENTIALITY</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-142">Verschlüsseln Sie Nachrichten mithilfe der [<strong>verschlüsseltmessage</strong>] (EncryptMessage--General.MD)-Funktion.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-142">Encrypt messages by using the [<strong>EncryptMessage</strong>](encryptmessage--general.md) function.</span></span><br/></td></tr><tr class="odd"><td><span id="ISC_REQ_CONNECTION"></span><span id="isc_req_connection"></span><dl> <span data-ttu-id="f5cbc-143"><dt><strong>ISC_REQ_CONNECTION</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-143"><dt><strong>ISC_REQ_CONNECTION</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-144">Der [*Sicherheitskontext*](../secgloss/s-gly.md) verarbeitet keine Formatierungs Meldungen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-144">The [*security context*](../secgloss/s-gly.md) will not handle formatting messages.</span></span><br/></td></tr><tr class="even"><td><span id="ISC_REQ_EXTENDED_ERROR"></span><span id="isc_req_extended_error"></span><dl> <span data-ttu-id="f5cbc-145"><dt><strong>ISC_REQ_EXTENDED_ERROR</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-145"><dt><strong>ISC_REQ_EXTENDED_ERROR</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-146">Wenn Fehler auftreten, wird die Remote Partei benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-146">When errors occur, the remote party will be notified.</span></span><br/></td></tr><tr class="odd"><td><span id="ISC_REQ_INTEGRITY"></span><span id="isc_req_integrity"></span><dl> <span data-ttu-id="f5cbc-147"><dt><strong>ISC_REQ_INTEGRITY</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-147"><dt><strong>ISC_REQ_INTEGRITY</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-148">Signieren von Nachrichten und Überprüfen von Signaturen mithilfe der Funktionen [<strong>verschlüsseltmessage</strong>] (EncryptMessage--General.MD) und [<strong>makesignature</strong>] (makesignature.MD).</span><span class="sxs-lookup"><span data-stu-id="f5cbc-148">Sign messages and verify signatures by using the [<strong>EncryptMessage</strong>](encryptmessage--general.md) and [<strong>MakeSignature</strong>](makesignature.md) functions.</span></span><br/></td></tr><tr class="even"><td><span id="ISC_REQ_MANUAL_CRED_VALIDATION"></span><span id="isc_req_manual_cred_validation"></span><dl> <span data-ttu-id="f5cbc-149"><dt><strong>ISC_REQ_MANUAL_CRED_VALIDATION</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-149"><dt><strong>ISC_REQ_MANUAL_CRED_VALIDATION</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-150">SChannel darf den Server nicht automatisch authentifizieren.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-150">Schannel must not authenticate the server automatically.</span></span><br/></td></tr><tr class="odd"><td><span id="ISC_REQ_MUTUAL_AUTH"></span><span id="isc_req_mutual_auth"></span><dl> <span data-ttu-id="f5cbc-151"><dt><strong>ISC_REQ_MUTUAL_AUTH</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-151"><dt><strong>ISC_REQ_MUTUAL_AUTH</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-152">Die Richtlinie für die gegenseitige Authentifizierung des Dienstanbieter wird erfüllt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-152">The mutual authentication policy of the service will be satisfied.</span></span><br/><blockquote>[!Caution]<br />
<span data-ttu-id="f5cbc-153">Dies bedeutet nicht notwendigerweise, dass die gegenseitige Authentifizierung durchgeführt wird, sondern nur, dass die Authentifizierungs Richtlinie des Dienstanbieter erfüllt ist.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-153">This does not necessarily mean that mutual authentication is performed, only that the authentication policy of the service is satisfied.</span></span> <span data-ttu-id="f5cbc-154">Um sicherzustellen, dass die gegenseitige Authentifizierung erfolgt, wenden Sie die [<strong>QueryContextAttributes (SChannel)</strong>] (QueryContextAttributes--Schannel.MD)-Funktion an.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-154">To ensure that mutual authentication is performed, call the [<strong>QueryContextAttributes (Schannel)</strong>](querycontextattributes--schannel.md) function.</span></span></blockquote><br/></td></tr><tr class="even"><td><span id="ISC_REQ_REPLAY_DETECT"></span><span id="isc_req_replay_detect"></span><dl> <span data-ttu-id="f5cbc-155"><dt><strong>ISC_REQ_REPLAY_DETECT</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-155"><dt><strong>ISC_REQ_REPLAY_DETECT</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-156">Erkennen von wiedergegebenen Nachrichten, die mithilfe der Funktionen [<strong>verschlüsseltmessage</strong>] (EncryptMessage--General.MD) oder [<strong>makesignature</strong>] (makesignature.MD) codiert wurden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-156">Detect replayed messages that have been encoded by using the [<strong>EncryptMessage</strong>](encryptmessage--general.md) or [<strong>MakeSignature</strong>](makesignature.md) functions.</span></span><br/></td></tr><tr class="odd"><td><span id="ISC_REQ_SEQUENCE_DETECT"></span><span id="isc_req_sequence_detect"></span><dl> <span data-ttu-id="f5cbc-157"><dt><strong>ISC_REQ_SEQUENCE_DETECT</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-157"><dt><strong>ISC_REQ_SEQUENCE_DETECT</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-158">Erkennen, dass Nachrichten außerhalb der Reihenfolge empfangen wurden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-158">Detect messages received out of sequence.</span></span><br/></td></tr><tr class="even"><td><span id="ISC_REQ_STREAM"></span><span id="isc_req_stream"></span><dl> <span data-ttu-id="f5cbc-159"><dt><strong>ISC_REQ_STREAM</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-159"><dt><strong>ISC_REQ_STREAM</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-160">Unterstützen einer Datenstrom orientierten Verbindung.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-160">Support a stream-oriented connection.</span></span><br/></td></tr><tr class="odd"><td><span id="ISC_REQ_USE_SUPPLIED_CREDS"></span><span id="isc_req_use_supplied_creds"></span><dl> <span data-ttu-id="f5cbc-161"><dt><strong>ISC_REQ_USE_SUPPLIED_CREDS</strong></dt> </span><span class="sxs-lookup"><span data-stu-id="f5cbc-161"><dt><strong>ISC_REQ_USE_SUPPLIED_CREDS</strong></dt> </span></span></dl></td><td><span data-ttu-id="f5cbc-162">SChannel darf nicht versuchen, Anmelde Informationen für den Client automatisch bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-162">Schannel must not attempt to supply credentials for the client automatically.</span></span><br/></td></tr></tbody></table>



 

<span data-ttu-id="f5cbc-163">Die angeforderten Attribute werden möglicherweise nicht vom Client unterstützt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-163">The requested attributes may not be supported by the client.</span></span> <span data-ttu-id="f5cbc-164">Weitere Informationen finden Sie unter dem Parameter *pfContextAttr* .</span><span class="sxs-lookup"><span data-stu-id="f5cbc-164">For more information, see the *pfContextAttr* parameter.</span></span>

<span data-ttu-id="f5cbc-165">Weitere Beschreibungen der verschiedenen Attribute finden Sie unter [Kontext Anforderungen](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="f5cbc-165">For further descriptions of the various attributes, see [Context Requirements](context-requirements.md).</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-166">*"Reserved1"* \[ in\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-166">*Reserved1* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-167">Dieser Parameter ist reserviert und muss auf 0 (null) festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-167">This parameter is reserved and must be set to zero.</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-168">*Targetdatarep* \[ in\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-168">*TargetDataRep* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-169">Dieser Parameter wird nicht mit SChannel verwendet.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-169">This parameter is not used with Schannel.</span></span> <span data-ttu-id="f5cbc-170">Legen Sie den Wert auf NULL fest.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-170">Set it to zero.</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-171">*pinput* \[ in, optional\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-171">*pInput* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-172">Ein Zeiger auf eine [**secbufferdesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) -Struktur, die Zeiger auf die Puffer enthält, die als Eingabe für das Paket bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-172">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure that contains pointers to the buffers supplied as input to the package.</span></span> <span data-ttu-id="f5cbc-173">Der Wert dieses Parameters muss beim ersten Aufrufen der Funktion **null** sein, es sei denn, der Client Kontext wurde vom Server initiiert.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-173">Unless the client context was initiated by the server, the value of this parameter must be **NULL** on the first call to the function.</span></span> <span data-ttu-id="f5cbc-174">Bei nachfolgenden Aufrufen der Funktion oder wenn der Client Kontext vom Server initiiert wurde, ist der Wert dieses Parameters ein Zeiger auf einen Puffer, der ausreichend Arbeitsspeicher für das vom Remote Computer zurückgegebene Token zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-174">On subsequent calls to the function or when the client context was initiated by the server, the value of this parameter is a pointer to a buffer allocated with enough memory to hold the token returned by the remote computer.</span></span>

<span data-ttu-id="f5cbc-175">Bei Aufrufen dieser Funktion nach dem ersten Aufruf müssen zwei Puffer vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-175">On calls to this function after the initial call, there must be two buffers.</span></span> <span data-ttu-id="f5cbc-176">Der erste verfügt über einen **typsecbuffer- \_ Token** und enthält das vom Server empfangene Token.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-176">The first has type **SECBUFFER\_TOKEN** and contains the token received from the server.</span></span> <span data-ttu-id="f5cbc-177">Der zweite Puffer weist den Typ " **secbuffer \_ empty**" auf. Legen Sie die Member **pvbuffer** und **cbbuffer** auf NULL fest.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-177">The second buffer has type **SECBUFFER\_EMPTY**; set both the **pvBuffer** and **cbBuffer** members to zero.</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-178">*"Reserved2"* \[ in\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-178">*Reserved2* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-179">Dieser Parameter ist reserviert und muss auf 0 (null) festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-179">This parameter is reserved and must be set to zero.</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-180">*phnewcontext* \[ in, out, optional\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-180">*phNewContext* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-181">Ein Zeiger auf eine [ctxthandle](sspi-handles.md) -Struktur.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-181">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="f5cbc-182">Beim ersten Aufrufe von **InitializeSecurityContext (SChannel)** empfängt dieser Zeiger das neue Kontext handle.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-182">On the first call to **InitializeSecurityContext (Schannel)**, this pointer receives the new context handle.</span></span> <span data-ttu-id="f5cbc-183">Beim zweiten-Befehl kann *phnewcontext* mit dem im *phcontext* -Parameter angegebenen Handle identisch sein.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-183">On the second call, *phNewContext* can be the same as the handle specified in the *phContext* parameter.</span></span>

<span data-ttu-id="f5cbc-184">Übergeben Sie bei aufrufen nach dem ersten Aufruf das hier zurückgegebene Handle als *phcontext* -Parameter, und geben Sie für *phnewcontext* **null** an.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-184">On calls after the first call, pass the handle returned here as the *phContext* parameter and specify **NULL** for *phNewContext*.</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-185">*poutput* \[ in, out, optional\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-185">*pOutput* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-186">Ein Zeiger auf eine [**secbufferdesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) -Struktur, die Zeiger auf die [**secbuffer**](/windows/win32/api/sspi/ns-sspi-secbuffer) -Struktur enthält, die die Ausgabedaten empfängt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-186">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure that contains pointers to the [**SecBuffer**](/windows/win32/api/sspi/ns-sspi-secbuffer) structure that receives the output data.</span></span> <span data-ttu-id="f5cbc-187">Wenn ein Puffer \_ in der Eingabe als Sek. gelesen wurde, wird er in der Ausgabe angezeigt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-187">If a buffer was typed as SEC\_READWRITE in the input, it will be there on output.</span></span> <span data-ttu-id="f5cbc-188">Das System weist einen Puffer für das Sicherheits Token zu, wenn dies angefordert wird (über den ISC \_ -req \_ \_ -Speicher Belegungs Speicher), und gibt die Adresse im Puffer Deskriptor für das Sicherheits Token ein.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-188">The system will allocate a buffer for the security token if requested (through ISC\_REQ\_ALLOCATE\_MEMORY) and fill in the address in the buffer descriptor for the security token.</span></span>

<span data-ttu-id="f5cbc-189">Wenn das \_ kennflag für die ISC req- \_ \_ Speicher Belegungskapazität angegeben wird, belegt der Schannel-SSP Arbeitsspeicher für den Puffer und fügt die entsprechenden Informationen in [**secbufferdesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc)ein.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-189">If the ISC\_REQ\_ALLOCATE\_MEMORY flag is specified, the Schannel SSP will allocate memory for the buffer and put the appropriate information in the [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc).</span></span> <span data-ttu-id="f5cbc-190">Außerdem muss der Aufrufer einen Puffer vom Typ " **secbuffer- \_ Warnung**" übergeben.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-190">In addition, the caller must pass in a buffer of type **SECBUFFER\_ALERT**.</span></span> <span data-ttu-id="f5cbc-191">Wenn bei der Ausgabe eine Warnung generiert wird, enthält dieser Puffer Informationen zu dieser Warnung, und die Funktion schlägt fehl.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-191">On output, if an alert is generated, this buffer contains information about that alert, and the function fails.</span></span>

</dd> <dt>

<span data-ttu-id="f5cbc-192">*pfContextAttr* \[ vorgenommen\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-192">*pfContextAttr* \[out\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-193">Ein Zeiger auf eine Variable, die einen Satz von Bitflags empfangen soll, die die [*Attribute*](../secgloss/a-gly.md#_security_attribute_gly) des eingerichteten Kontexts angeben.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-193">A pointer to a variable to receive a set of bit flags that indicate the [*attributes*](../secgloss/a-gly.md#_security_attribute_gly) of the established context.</span></span> <span data-ttu-id="f5cbc-194">Eine Beschreibung der verschiedenen Attribute finden Sie unter [Kontext Anforderungen](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="f5cbc-194">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span>

<span data-ttu-id="f5cbc-195">Flags, die für diesen Parameter verwendet werden, haben das Präfix ISC \_ RET, wie z \_ \_ . b. ISC</span><span class="sxs-lookup"><span data-stu-id="f5cbc-195">Flags used for this parameter are prefixed with ISC\_RET, such as ISC\_RET\_DELEGATE.</span></span> <span data-ttu-id="f5cbc-196">Eine Liste gültiger Werte finden Sie unter dem Parameter *fContextReq* .</span><span class="sxs-lookup"><span data-stu-id="f5cbc-196">For a list of valid values, see the *fContextReq* parameter.</span></span>

<span data-ttu-id="f5cbc-197">Suchen Sie erst nach sicherheitsbezogenen Attributen, wenn der abschließende Funktions aufruger erfolgreich zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-197">Do not check for security-related attributes until the final function call returns successfully.</span></span> <span data-ttu-id="f5cbc-198">Attributflags, die sich nicht auf die Sicherheit beziehen, wie z. b. das von ASC \_ ret \_ zugewiesene \_ arbeitsspeicherflag, können vor der letzten Rückgabe geprüft werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-198">Attribute flags that are not related to security, such as the ASC\_RET\_ALLOCATED\_MEMORY flag, can be checked before the final return.</span></span>

> [!Note]  
> <span data-ttu-id="f5cbc-199">Bestimmte Kontext Attribute können während der Aushandlung mit einem Remotepeer geändert werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-199">Particular context attributes can change during negotiation with a remote peer.</span></span>

 

</dd> <dt>

<span data-ttu-id="f5cbc-200">*ptsexpiry* \[ Out, optional\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-200">*ptsExpiry* \[out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="f5cbc-201">Ein Zeiger auf eine [**Zeitstempel**](timestamp.md) Struktur, die die Ablaufzeit des Kontexts empfängt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-201">A pointer to a [**TimeStamp**](timestamp.md) structure that receives the expiration time of the context.</span></span> <span data-ttu-id="f5cbc-202">Es wird empfohlen, dass das [*Sicherheitspaket*](../secgloss/s-gly.md) diesen Wert immer in der lokalen Zeit zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-202">It is recommended that the [*security package*](../secgloss/s-gly.md) always return this value in local time.</span></span> <span data-ttu-id="f5cbc-203">Dieser Parameter ist optional, und für kurzlebige Clients sollte **null** übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-203">This parameter is optional and **NULL** should be passed for short-lived clients.</span></span>

</dd> </dl>

## <a name="return-value"></a><span data-ttu-id="f5cbc-204">Rückgabewert</span><span class="sxs-lookup"><span data-stu-id="f5cbc-204">Return value</span></span>

<span data-ttu-id="f5cbc-205">Wenn die Funktion erfolgreich ausgeführt wird, gibt die Funktion einen der folgenden Erfolgs Codes zurück.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-205">If the function succeeds, the function returns one of the following success codes.</span></span>



| <span data-ttu-id="f5cbc-206">Rückgabecode</span><span class="sxs-lookup"><span data-stu-id="f5cbc-206">Return code</span></span>                                                                                                    | <span data-ttu-id="f5cbc-207">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="f5cbc-207">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|----------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <span data-ttu-id="f5cbc-208"><dt>**SEK \_ . \_ \_ und \_ fortfahren**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-208"><dt>**SEC\_I\_COMPLETE\_AND\_CONTINUE**</dt></span></span> </dl> | <span data-ttu-id="f5cbc-209">Der Client muss das [**completeauthtoken**](/windows/win32/api/sspi/nf-sspi-completeauthtoken) -Element aufzurufen und die Ausgabe dann an den Server übergeben.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-209">The client must call [**CompleteAuthToken**](/windows/win32/api/sspi/nf-sspi-completeauthtoken) and then pass the output to the server.</span></span> <span data-ttu-id="f5cbc-210">Der Client wartet dann auf ein zurück gegebenes Token und übergibt es in einem anderen-Befehl an [**InitializeSecurityContext (SChannel)**](initializesecuritycontext--schannel.md).</span><span class="sxs-lookup"><span data-stu-id="f5cbc-210">The client then waits for a returned token and passes it, in another call, to [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md).</span></span><br/>                                                                                                                                                                                                                                                                |
| <dl> <span data-ttu-id="f5cbc-211"><dt>**SEK \_ . \_ \_**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-211"><dt>**SEC\_I\_COMPLETE\_NEEDED**</dt></span></span> </dl>        | <span data-ttu-id="f5cbc-212">Der Client muss die Erstellung der Nachricht abschließen und dann die [**completeauthtoken**](/windows/win32/api/sspi/nf-sspi-completeauthtoken) -Funktion aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-212">The client must finish building the message and then call the [**CompleteAuthToken**](/windows/win32/api/sspi/nf-sspi-completeauthtoken) function.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <dl> <span data-ttu-id="f5cbc-213"><dt>**SEK \_ . \_ \_**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-213"><dt>**SEC\_I\_CONTINUE\_NEEDED**</dt></span></span> </dl>        | <span data-ttu-id="f5cbc-214">Der Client muss das Ausgabe Token an den Server senden und auf ein Rückgabe Token warten.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-214">The client must send the output token to the server and wait for a return token.</span></span> <span data-ttu-id="f5cbc-215">Das zurückgegebene Token wird dann in einem anderen Befehl von [**InitializeSecurityContext (SChannel)**](initializesecuritycontext--schannel.md)übergeben.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-215">The returned token is then passed in another call to [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md).</span></span> <span data-ttu-id="f5cbc-216">Das Ausgabe Token kann leer sein.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-216">The output token can be empty.</span></span><br/>                                                                                                                                                                                                                                                                                     |
| <dl> <span data-ttu-id="f5cbc-217"><dt>**Sek., \_ \_ unvollständige \_ Anmelde Informationen**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-217"><dt>**SEC\_I\_INCOMPLETE\_CREDENTIALS**</dt></span></span> </dl> | <span data-ttu-id="f5cbc-218">Der Server hat die Client Authentifizierung angefordert, und die angegebenen Anmelde Informationen enthalten entweder kein Zertifikat, oder das Zertifikat wurde nicht von einer Zertifizierungsstelle (Certification Authority, ca) ausgestellt, die vom Server als vertrauenswürdig eingestuft wird.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-218">The server has requested client authentication, and the supplied credentials either do not include a certificate or the certificate was not issued by a certification authority (CA) that is trusted by the server.</span></span> <span data-ttu-id="f5cbc-219">Weitere Informationen finden Sie in den Hinweisen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-219">For more information, see Remarks.</span></span><br/>                                                                                                                                                                                         |
| <dl> <span data-ttu-id="f5cbc-220"><dt>**Sekunde \_ E \_ unvollständige \_ Nachricht**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-220"><dt>**SEC\_E\_INCOMPLETE\_MESSAGE**</dt></span></span> </dl>     | <span data-ttu-id="f5cbc-221">Die Daten für die gesamte Nachricht wurden nicht aus der Übertragung gelesen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-221">Data for the whole message was not read from the wire.</span></span><br/> <span data-ttu-id="f5cbc-222">Wenn dieser Wert zurückgegeben wird, enthält der *pinput* -Puffer eine [**secbuffer**](/windows/win32/api/sspi/ns-sspi-secbuffer) -Struktur mit einem **buffertype** -Member von **secbuffer \_ fehlt**.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-222">When this value is returned, the *pInput* buffer contains a [**SecBuffer**](/windows/win32/api/sspi/ns-sspi-secbuffer) structure with a **BufferType** member of **SECBUFFER\_MISSING**.</span></span> <span data-ttu-id="f5cbc-223">Der **cbbuffer** -Member von **secbuffer** enthält einen Wert, der die Anzahl zusätzlicher Bytes angibt, die die Funktion vom Client lesen muss, bevor diese Funktion erfolgreich ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-223">The **cbBuffer** member of **SecBuffer** contains a value that indicates the number of additional bytes that the function must read from the client before this function succeeds.</span></span> <span data-ttu-id="f5cbc-224">Obwohl diese Zahl nicht immer genau ist, kann Sie verwendet werden, um die Leistung zu verbessern, indem mehrere Aufrufe dieser Funktion vermieden werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-224">While this number is not always accurate, using it can help improve performance by avoiding multiple calls to this function.</span></span><br/> |
| <dl> <span data-ttu-id="f5cbc-225"><dt>**Sek. \_ E \_ OK**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-225"><dt>**SEC\_E\_OK**</dt></span></span> </dl>                      | <span data-ttu-id="f5cbc-226">Der [*Sicherheitskontext*](../secgloss/s-gly.md) wurde erfolgreich initialisiert.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-226">The [*security context*](../secgloss/s-gly.md) was successfully initialized.</span></span> <span data-ttu-id="f5cbc-227">Es ist kein weiterer [**InitializeSecurityContext (SChannel)**](initializesecuritycontext--schannel.md) -Aufrufe erforderlich.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-227">There is no need for another [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md) call.</span></span> <span data-ttu-id="f5cbc-228">Wenn die Funktion ein Ausgabe Token zurückgibt, d. h., wenn das secbuffer- \_ Token in *poutput* eine Länge ungleich NULL aufweist, muss dieses Token an den Server gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-228">If the function returns an output token, that is, if the SECBUFFER\_TOKEN in *pOutput* is of nonzero length, that token must be sent to the server.</span></span><br/>                                                                                                                               |



 

<span data-ttu-id="f5cbc-229">Wenn die Funktion fehlschlägt, gibt die Funktion einen der folgenden Fehlercodes zurück.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-229">If the function fails, the function returns one of the following error codes.</span></span>



| <span data-ttu-id="f5cbc-230">Rückgabecode</span><span class="sxs-lookup"><span data-stu-id="f5cbc-230">Return code</span></span>                                                                                                            | <span data-ttu-id="f5cbc-231">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="f5cbc-231">Description</span></span>                                                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <span data-ttu-id="f5cbc-232"><dt>**SEK \_ b \_ nicht genügend Arbeits \_ Speicher**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-232"><dt>**SEC\_E\_INSUFFICIENT\_MEMORY**</dt></span></span> </dl>            | <span data-ttu-id="f5cbc-233">Es ist nicht genügend Arbeitsspeicher verfügbar, um die angeforderte Aktion abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-233">There is not enough memory available to complete the requested action.</span></span><br/>                                                                                                                                                                                                                   |
| <dl> <span data-ttu-id="f5cbc-234"><dt>**Sek. \_ E ( \_ interner \_ Fehler)**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-234"><dt>**SEC\_E\_INTERNAL\_ERROR**</dt></span></span> </dl>                 | <span data-ttu-id="f5cbc-235">Es ist ein Fehler aufgetreten, der keinem SSPI-Fehlercode zugeordnet wurde.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-235">An error occurred that did not map to an SSPI error code.</span></span><br/>                                                                                                                                                                                                                                |
| <dl> <span data-ttu-id="f5cbc-236"><dt>**s \_ E \_ ungültiges \_ handle**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-236"><dt>**SEC\_E\_INVALID\_HANDLE**</dt></span></span> </dl>                 | <span data-ttu-id="f5cbc-237">Das an die Funktion über gegebene Handle ist ungültig.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-237">The handle passed to the function is not valid.</span></span><br/>                                                                                                                                                                                                                                          |
| <dl> <span data-ttu-id="f5cbc-238"><dt>**s \_ E \_ ungültiges \_ Token**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-238"><dt>**SEC\_E\_INVALID\_TOKEN**</dt></span></span> </dl>                  | <span data-ttu-id="f5cbc-239">Der Fehler tritt auf, wenn ein ungültiges Eingabe Token vorliegt, z. b. ein Token, das während der Übertragung beschädigt ist, ein Token falscher Größe oder ein Token, das an die falsche [*eingeschränkte Delegierung*](../secgloss/s-gly.md)geleitet wurde.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-239">The error is due to a malformed input token, such as a token corrupted in transit, a token of incorrect size, or a token passed into the wrong [*constrained delegation*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="f5cbc-240">Das Übergeben eines Tokens an das falsche Paket kann erfolgen, wenn der Client und der Server nicht die ordnungsgemäße [*eingeschränkte Delegierung*](../secgloss/s-gly.md)ausgehandelt haben.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-240">Passing a token to the wrong package can happen if the client and server did not negotiate the proper [*constrained delegation*](../secgloss/s-gly.md).</span></span><br/> |
| <dl> <span data-ttu-id="f5cbc-241"><dt>**Sek. \_ E- \_ Anmeldung \_ verweigert**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-241"><dt>**SEC\_E\_LOGON\_DENIED**</dt></span></span> </dl>                   | <span data-ttu-id="f5cbc-242">Die Anmeldung ist fehlgeschlagen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-242">The logon failed.</span></span><br/>                                                                                                                                                                                                                                                                        |
| <dl> <span data-ttu-id="f5cbc-243"><dt>**s \_ E \_ keine \_ authentifizier Ende Zertifizierungsstelle \_**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-243"><dt>**SEC\_E\_NO\_AUTHENTICATING\_AUTHORITY**</dt></span></span> </dl>   | <span data-ttu-id="f5cbc-244">Es konnte keine Autorität für die Authentifizierung kontaktiert werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-244">No authority could be contacted for authentication.</span></span> <span data-ttu-id="f5cbc-245">Der Domänen Name der authentifizier enden Partei ist möglicherweise falsch, die Domäne kann nicht erreichbar sein, oder es ist ein Fehler bei der Vertrauensstellung aufgetreten.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-245">The domain name of the authenticating party could be wrong, the domain could be unreachable, or there might have been a trust relationship failure.</span></span><br/>                                                                                  |
| <dl> <span data-ttu-id="f5cbc-246"><dt>**s \_ E \_ keine \_ Anmelde Informationen**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-246"><dt>**SEC\_E\_NO\_CREDENTIALS**</dt></span></span> </dl>                 | <span data-ttu-id="f5cbc-247">In der [*eingeschränkten Delegierung*](../secgloss/s-gly.md)sind keine Anmelde Informationen verfügbar.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-247">No credentials are available in the [*constrained delegation*](../secgloss/s-gly.md).</span></span><br/>                                                                                                                                                  |
| <dl> <span data-ttu-id="f5cbc-248"><dt>**Sekunde \_ E \_ Ziel \_ unbekannt**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-248"><dt>**SEC\_E\_TARGET\_UNKNOWN**</dt></span></span> </dl>                 | <span data-ttu-id="f5cbc-249">Das Ziel wurde nicht erkannt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-249">The target was not recognized.</span></span><br/>                                                                                                                                                                                                                                                           |
| <dl> <span data-ttu-id="f5cbc-250"><dt>**s \_ E \_ nicht unterstützte \_ Funktion**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-250"><dt>**SEC\_E\_UNSUPPORTED\_FUNCTION**</dt></span></span> </dl>           | <span data-ttu-id="f5cbc-251">\_ \_ \_ \_ \_ \_ Im *fContextReq* -Parameter wurde ein ungültiges Kontext Attribut Kennzeichen (ISC req-Delegat oder ISC req-Eingabeaufforderung für die Anmelde Informationen) angegeben.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-251">A context attribute flag that is not valid (ISC\_REQ\_DELEGATE or ISC\_REQ\_PROMPT\_FOR\_CREDS) was specified in the *fContextReq* parameter.</span></span><br/>                                                                                                                                            |
| <dl> <span data-ttu-id="f5cbc-252"><dt>**SEK \_ . \_ falscher \_ Prinzipal**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-252"><dt>**SEC\_E\_WRONG\_PRINCIPAL**</dt></span></span> </dl>                | <span data-ttu-id="f5cbc-253">Der Prinzipal, der die Authentifizierungsanforderung empfangen hat, ist nicht mit dem Prinzipal identisch, der an den *psztargetname* -Parameter übergeben wurde.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-253">The principal that received the authentication request is not the same as the one passed into the *pszTargetName* parameter.</span></span> <span data-ttu-id="f5cbc-254">Dies weist auf einen Fehler bei der gegenseitigen Authentifizierung hin.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-254">This indicates a failure in mutual authentication.</span></span><br/>                                                                                                          |
| <dl> <span data-ttu-id="f5cbc-255"><dt>**Sek. nicht übereinstimmende \_ \_ Anwendungs \_ Protokoll \_**</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-255"><dt>**SEC\_E\_APPLICATION\_PROTOCOL\_MISMATCH**</dt></span></span> </dl> | <span data-ttu-id="f5cbc-256">Zwischen dem Client und dem Server ist kein gängiges Anwendungsprotokoll vorhanden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-256">No common application protocol exists between the client and the server.</span></span><br/>                                                                                                                                                                                                                 |



 

## <a name="remarks"></a><span data-ttu-id="f5cbc-257">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="f5cbc-257">Remarks</span></span>

<span data-ttu-id="f5cbc-258">Der Aufrufer ist dafür verantwortlich, zu bestimmen, ob die abschließenden Kontext Attribute ausreichend sind.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-258">The caller is responsible for determining whether the final context attributes are sufficient.</span></span> <span data-ttu-id="f5cbc-259">Wenn beispielsweise Vertraulichkeit angefordert wurde, Sie aber nicht eingerichtet werden konnte, können einige Anwendungen die Verbindung sofort beenden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-259">If, for example, confidentiality was requested, but could not be established, some applications may choose to shut down the connection immediately.</span></span>

<span data-ttu-id="f5cbc-260">Wenn Attribute des [*Sicherheits Kontexts*](../secgloss/s-gly.md) nicht ausreichen, muss der Client den teilweise erstellten Kontext durch Aufrufen der [**Delta Context**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) -Funktion freigeben.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-260">If attributes of the [*security context*](../secgloss/s-gly.md) are not sufficient, the client must free the partially created context by calling the [**DeleteSecurityContext**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) function.</span></span>

<span data-ttu-id="f5cbc-261">Die Funktion **InitializeSecurityContext (SChannel)** wird von einem Client verwendet, um einen ausgehenden Kontext zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-261">The **InitializeSecurityContext (Schannel)** function is used by a client to initialize an outbound context.</span></span>

<span data-ttu-id="f5cbc-262">Bei einem zweistufigen [*Sicherheitskontext*](../secgloss/s-gly.md)sieht die aufrufende Sequenz wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="f5cbc-262">For a two-leg [*security context*](../secgloss/s-gly.md), the calling sequence is as follows:</span></span>

1.  <span data-ttu-id="f5cbc-263">Der Client ruft die-Funktion auf, wobei *phcontext* auf **null** festgelegt ist, und füllt den Puffer Deskriptor mit der Eingabe Nachricht.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-263">The client calls the function with *phContext* set to **NULL** and fills in the buffer descriptor with the input message.</span></span>
2.  <span data-ttu-id="f5cbc-264">Das [*Sicherheitspaket*](../secgloss/s-gly.md) überprüft die Parameter und erstellt ein undurchsichtiges Token, das es im Token-Element im Puffer Array platziert.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-264">The [*security package*](../secgloss/s-gly.md) examines the parameters and constructs an opaque token, placing it in the TOKEN element in the buffer array.</span></span> <span data-ttu-id="f5cbc-265">Wenn der *Parameter "Parameter" den Wert* "ISC \_ req \_ -Speicher Belegungs Flag" enthält \_ , ordnet das [*Sicherheitspaket*](../secgloss/s-gly.md) den Arbeitsspeicher zu und gibt den Zeiger im Token-Element zurück.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-265">If the *fContextReq* parameter includes the ISC\_REQ\_ALLOCATE\_MEMORY flag, the [*security package*](../secgloss/s-gly.md) allocates the memory and returns the pointer in the TOKEN element.</span></span>
3.  <span data-ttu-id="f5cbc-266">Der Client sendet das Token, das im *poutput* -Puffer zurückgegeben wurde, an den Zielserver.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-266">The client sends the token returned in the *pOutput* buffer to the target server.</span></span> <span data-ttu-id="f5cbc-267">Der Server übergibt dann das Token als Eingabe Argument in einem Rückruf der Funktion " [**Accept-SecurityContext" (SChannel)**](acceptsecuritycontext--schannel.md) .</span><span class="sxs-lookup"><span data-stu-id="f5cbc-267">The server then passes the token as an input argument in a call to the [**AcceptSecurityContext (Schannel)**](acceptsecuritycontext--schannel.md) function.</span></span>
4.  <span data-ttu-id="f5cbc-268">" [**Akzeptsecuritycontext" (SChannel)**](acceptsecuritycontext--schannel.md) kann ein Token zurückgeben, das der Server für einen zweiten **callalizesecuritycontext (SChannel)** an den Client sendet, wenn der erste zurückgegebene Befehl "Sek." zurückgegeben wird \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="f5cbc-268">[**AcceptSecurityContext (Schannel)**](acceptsecuritycontext--schannel.md) may return a token, which the server sends to the client for a second call to **InitializeSecurityContext (Schannel)** if the first call returned SEC\_I\_CONTINUE\_NEEDED.</span></span>

<span data-ttu-id="f5cbc-269">Bei mehrstufigen [*Sicherheits Kontexten*](../secgloss/s-gly.md), wie z. b. der gegenseitigen Authentifizierung, sieht die Aufruf Sequenz wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="f5cbc-269">For multiple-leg [*security context*](../secgloss/s-gly.md)s, such as mutual authentication, the calling sequence is as follows:</span></span>

1.  <span data-ttu-id="f5cbc-270">Der Client ruft die-Funktion wie zuvor beschrieben auf, aber das Paket gibt den Fortschritt zurück, der für den \_ \_ \_ erfolgreichen Erfolg benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-270">The client calls the function as described earlier, but the package returns the SEC\_I\_CONTINUE\_NEEDED success code.</span></span>
2.  <span data-ttu-id="f5cbc-271">Der Client sendet das Ausgabe Token an den Server und wartet auf die Antwort des Servers.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-271">The client sends the output token to the server and waits for the server's reply.</span></span>
3.  <span data-ttu-id="f5cbc-272">Beim Empfang der Serverantwort ruft der Client erneut **InitializeSecurityContext (SChannel)** auf, wobei *phcontext* auf das Handle festgelegt ist, das beim letzten Aufruf zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-272">Upon receipt of the server's response, the client calls **InitializeSecurityContext (Schannel)** again, with *phContext* set to the handle that was returned from the last call.</span></span> <span data-ttu-id="f5cbc-273">Das vom Server empfangene Token wird im *pinput* -Parameter bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-273">The token received from the server is supplied in the *pInput* parameter.</span></span>

<span data-ttu-id="f5cbc-274">Wenn der Server erfolgreich geantwortet hat, gibt das [*Sicherheitspaket*](../secgloss/s-gly.md) SEK \_ . E OK zurück, \_ und es wird eine sichere Sitzung eingerichtet.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-274">If the server has successfully responded, the [*security package*](../secgloss/s-gly.md) returns SEC\_E\_OK and a secure session is established.</span></span>

<span data-ttu-id="f5cbc-275">Wenn die Funktion eine der Fehler Antworten zurückgibt, wird die Antwort des Servers nicht akzeptiert, und die Sitzung wird nicht festgelegt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-275">If the function returns one of the error responses, the server's response is not accepted, and the session is not established.</span></span>

<span data-ttu-id="f5cbc-276">Wenn die Funktion Sekunden zurück \_ gibt \_ , die ich \_ benötigtes, SEK \_ ., \_ \_ benötigtes \_ \_ \_ und \_ fortfahren, werden die Schritte 2 und 3 wiederholt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-276">If the function returns SEC\_I\_CONTINUE\_NEEDED, SEC\_I\_COMPLETE\_NEEDED, or SEC\_I\_COMPLETE\_AND\_CONTINUE, steps 2 and 3 are repeated.</span></span>

<span data-ttu-id="f5cbc-277">Um einen [*Sicherheitskontext*](../secgloss/s-gly.md)zu initialisieren, sind möglicherweise mehrere Aufrufe dieser Funktion erforderlich, je nach dem zugrunde liegenden Authentifizierungsmechanismus sowie den im *fContextReq* -Parameter angegebenen Optionen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-277">To initialize a [*security context*](../secgloss/s-gly.md), more than one call to this function may be required, depending on the underlying authentication mechanism as well as the choices specified in the *fContextReq* parameter.</span></span>

<span data-ttu-id="f5cbc-278">Die Parameter " *stmtreq* " und " *pfcontextattributes* " sind Bitmasken, die verschiedene Kontext Attribute darstellen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-278">The *fContextReq* and *pfContextAttributes* parameters are bitmasks that represent various context attributes.</span></span> <span data-ttu-id="f5cbc-279">Eine Beschreibung der verschiedenen Attribute finden Sie unter [Kontext Anforderungen](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="f5cbc-279">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span> <span data-ttu-id="f5cbc-280">Der *pfcontextattributes* -Parameter ist bei erfolgreicher Rückgabe gültig, aber nur bei der letzten erfolgreichen Rückgabe sollten Sie die Flags untersuchen, die die Sicherheitsaspekte des Kontexts betreffen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-280">The *pfContextAttributes* parameter is valid on any successful return, but only on the final successful return should you examine the flags that pertain to security aspects of the context.</span></span> <span data-ttu-id="f5cbc-281">Zwischen Rückgabewerte können festgelegt werden, z. b. das von ISC \_ ret \_ zugewiesene \_ arbeitsspeicherflag.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-281">Intermediate returns can set, for example, the ISC\_RET\_ALLOCATED\_MEMORY flag.</span></span>

<span data-ttu-id="f5cbc-282">Wenn das \_ Flag für die Verwendung von ISC req- \_ \_ \_ verwendender Kennwort festgelegt ist, muss das [*Sicherheitspaket*](../secgloss/s-gly.md) \_ \_ im *pinput* -Eingabepuffer nach einem secbuffer-pkg-Parametertyp suchen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-282">If the ISC\_REQ\_USE\_SUPPLIED\_CREDS flag is set, the [*security package*](../secgloss/s-gly.md) must look for a SECBUFFER\_PKG\_PARAMS buffer type in the *pInput* input buffer.</span></span> <span data-ttu-id="f5cbc-283">Dabei handelt es sich nicht um eine generische Lösung, Sie ermöglicht jedoch eine starke Kopplung von [*Sicherheitspaketen*](../secgloss/s-gly.md) und Anwendungen, wenn dies angebracht ist.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-283">This is not a generic solution, but it allows for a strong pairing of [*security package*](../secgloss/s-gly.md) and application when appropriate.</span></span>

<span data-ttu-id="f5cbc-284">Wenn ISC \_ req \_ Speicher belegt wurde, muss der Aufrufer \_ den Speicher freigeben, indem er die [**freecontextbuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) -Funktion aufruft.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-284">If ISC\_REQ\_ALLOCATE\_MEMORY was specified, the caller must free the memory by calling the [**FreeContextBuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) function.</span></span>

<span data-ttu-id="f5cbc-285">Das Eingabe Token könnte z. b. die Herausforderung von einem LAN-Manager sein.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-285">For example, the input token could be the challenge from a LAN Manager.</span></span> <span data-ttu-id="f5cbc-286">In diesem Fall wäre das Ausgabe Token die NTLM-verschlüsselte Antwort auf die Abfrage.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-286">In this case, the output token would be the NTLM-encrypted response to the challenge.</span></span>

<span data-ttu-id="f5cbc-287">Welche Aktion der Client durchführt, hängt vom Rückgabecode dieser Funktion ab.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-287">The action the client takes depends on the return code from this function.</span></span> <span data-ttu-id="f5cbc-288">Wenn der Rückgabecode sec \_ E \_ OK ist, gibt es keinen zweiten **InitializeSecurityContext (SChannel)** -Befehl, und es wird keine Antwort vom Server erwartet.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-288">If the return code is SEC\_E\_OK, there will be no second **InitializeSecurityContext (Schannel)** call, and no response from the server is expected.</span></span> <span data-ttu-id="f5cbc-289">Wenn es sich bei dem Rückgabecode um "s" handelt \_ \_ \_ , erwartet der Client ein Token als Antwort vom Server und übergibt ihn in einem zweiten **callalizesecuritycontext (SChannel)**.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-289">If the return code is SEC\_I\_CONTINUE\_NEEDED, the client expects a token in response from the server and passes it in a second call to **InitializeSecurityContext (Schannel)**.</span></span> <span data-ttu-id="f5cbc-290">Der von \_ mir \_ \_ benötigte Rückgabecode gibt an, dass der Client die Erstellung der Nachricht abschließen und die [**completeauthtoken**](/windows/win32/api/sspi/nf-sspi-completeauthtoken) -Funktion aufzurufen muss.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-290">The SEC\_I\_COMPLETE\_NEEDED return code indicates that the client must finish building the message and call the [**CompleteAuthToken**](/windows/win32/api/sspi/nf-sspi-completeauthtoken) function.</span></span> <span data-ttu-id="f5cbc-291">Der Code "s \_ I \_ Complete \_ and \_ Continue" umfasst beide Aktionen.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-291">The SEC\_I\_COMPLETE\_AND\_CONTINUE code incorporates both of these actions.</span></span>

<span data-ttu-id="f5cbc-292">Wenn **InitializeSecurityContext (SChannel)** beim ersten (oder einzigen) Aufruf Erfolg zurückgibt, muss der Aufrufer schließlich die [**Delta Context**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) -Funktion für das zurückgegebene Handle aufzurufen, auch wenn der Aufruf in einem späteren Abschnitt des Authentifizierungs Austauschs fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-292">If **InitializeSecurityContext (Schannel)** returns success on the first (or only) call, then the caller must eventually call the [**DeleteSecurityContext**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) function on the returned handle, even if the call fails on a later leg of the authentication exchange.</span></span>

<span data-ttu-id="f5cbc-293">Der Client ruft **InitializeSecurityContext (SChannel)** möglicherweise erneut auf, nachdem er erfolgreich abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-293">The client may call **InitializeSecurityContext (Schannel)** again after it has completed successfully.</span></span> <span data-ttu-id="f5cbc-294">Dies gibt dem [*Sicherheitspaket*](../secgloss/s-gly.md) an, dass eine erneute Authentifizierung gewünscht wird.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-294">This indicates to the [*security package*](../secgloss/s-gly.md) that a reauthentication is wanted.</span></span>

<span data-ttu-id="f5cbc-295">Kernelmodusaufrufer haben die folgenden Unterschiede: der Zielname ist eine [*Unicode*](../secgloss/u-gly.md) -Zeichenfolge, die mithilfe von [**virtualbelegc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc)im virtuellen Arbeitsspeicher zugeordnet werden muss. Er darf nicht aus dem Pool zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-295">Kernel mode callers have the following differences: the target name is a [*Unicode*](../secgloss/u-gly.md) string that must be allocated in virtual memory by using [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc); it must not be allocated from the pool.</span></span> <span data-ttu-id="f5cbc-296">Puffer, die in *pinput* und *poutput* übergeben und bereitgestellt werden, müssen sich im virtuellen Speicher befinden, nicht im Pool.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-296">Buffers passed and supplied in *pInput* and *pOutput* must be in virtual memory, not in the pool.</span></span>

<span data-ttu-id="f5cbc-297">Wenn die Funktion "SEK \_ . I" unvollständige Anmelde Informationen zurückgibt \_ \_ , überprüfen Sie, ob in Ihren Anmelde Informationen ein gültiges und vertrauenswürdiges Zertifikat angegeben</span><span class="sxs-lookup"><span data-stu-id="f5cbc-297">If the function returns SEC\_I\_INCOMPLETE\_CREDENTIALS, check that you specified a valid and trusted certificate in your credentials.</span></span> <span data-ttu-id="f5cbc-298">Das Zertifikat wird angegeben, wenn die [**AcquireCredentialsHandle-Funktion (SChannel)**](acquirecredentialshandle--schannel.md) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-298">The certificate is specified when calling the [**AcquireCredentialsHandle (Schannel)**](acquirecredentialshandle--schannel.md) function.</span></span> <span data-ttu-id="f5cbc-299">Bei dem Zertifikat muss es sich um ein Client Authentifizierungszertifikat handeln, das von einer Zertifizierungsstelle (Certification Authority, ca) ausgestellt wurde</span><span class="sxs-lookup"><span data-stu-id="f5cbc-299">The certificate must be a client authentication certificate issued by a certification authority (CA) trusted by the server.</span></span> <span data-ttu-id="f5cbc-300">Rufen Sie zum Abrufen einer Liste der Zertifizierungsstellen, denen der Server vertraut, die [**QueryContextAttributes-Funktion (SChannel)**](querycontextattributes--schannel.md) auf, und geben Sie das Attribut "secpkg \_ attr \_ Aussteller \_ List Ex" an \_ .</span><span class="sxs-lookup"><span data-stu-id="f5cbc-300">To obtain a list of the CAs trusted by the server, call the [**QueryContextAttributes (Schannel)**](querycontextattributes--schannel.md) function and specify the SECPKG\_ATTR\_ISSUER\_LIST\_EX attribute.</span></span>

<span data-ttu-id="f5cbc-301">Nachdem eine Client Anwendung ein Authentifizierungszertifikat von einer Zertifizierungsstelle erhalten hat, die vom Server als vertrauenswürdig eingestuft wird, erstellt die Anwendung neue Anmelde Informationen, indem Sie die Funktion [**AcquireCredentialsHandle (SChannel)**](acquirecredentialshandle--schannel.md) aufruft und anschließend **InitializeSecurityContext (SChannel)** aufruft, wobei die neuen Anmelde Informationen im Parameter *phcredential* angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="f5cbc-301">After a client application receives an authentication certificate from a CA that is trusted by the server, the application creates a new credential by calling the [**AcquireCredentialsHandle (Schannel)**](acquirecredentialshandle--schannel.md) function and then calling **InitializeSecurityContext (Schannel)** again, specifying the new credential in the *phCredential* parameter.</span></span>

## <a name="requirements"></a><span data-ttu-id="f5cbc-302">Anforderungen</span><span class="sxs-lookup"><span data-stu-id="f5cbc-302">Requirements</span></span>



| <span data-ttu-id="f5cbc-303">Anforderung</span><span class="sxs-lookup"><span data-stu-id="f5cbc-303">Requirement</span></span> | <span data-ttu-id="f5cbc-304">Wert</span><span class="sxs-lookup"><span data-stu-id="f5cbc-304">Value</span></span> |
|-------------------------------------|--------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f5cbc-305">Unterstützte Mindestversion (Client)</span><span class="sxs-lookup"><span data-stu-id="f5cbc-305">Minimum supported client</span></span><br/> | <span data-ttu-id="f5cbc-306">\[Nur Desktop-Apps Windows 8.1\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-306">Windows 8.1 \[desktop apps only\]</span></span><br/>                                                           |
| <span data-ttu-id="f5cbc-307">Unterstützte Mindestversion (Server)</span><span class="sxs-lookup"><span data-stu-id="f5cbc-307">Minimum supported server</span></span><br/> | <span data-ttu-id="f5cbc-308">Nur Windows Server 2012 R2 \[ -Desktop-Apps\]</span><span class="sxs-lookup"><span data-stu-id="f5cbc-308">Windows Server 2012 R2 \[desktop apps only\]</span></span><br/>                                                |
| <span data-ttu-id="f5cbc-309">Header</span><span class="sxs-lookup"><span data-stu-id="f5cbc-309">Header</span></span><br/>                   | <dl> <span data-ttu-id="f5cbc-310"><dt>SSPI. h (Include Security. h)</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-310"><dt>Sspi.h (include Security.h)</dt></span></span> </dl> |
| <span data-ttu-id="f5cbc-311">Bibliothek</span><span class="sxs-lookup"><span data-stu-id="f5cbc-311">Library</span></span><br/>                  | <dl> <span data-ttu-id="f5cbc-312"><dt>Secur32. lib</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-312"><dt>Secur32.lib</dt></span></span> </dl>                 |
| <span data-ttu-id="f5cbc-313">DLL</span><span class="sxs-lookup"><span data-stu-id="f5cbc-313">DLL</span></span><br/>                      | <dl> <span data-ttu-id="f5cbc-314"><dt>Secur32.dll</dt></span><span class="sxs-lookup"><span data-stu-id="f5cbc-314"><dt>Secur32.dll</dt></span></span> </dl>                 |



## <a name="see-also"></a><span data-ttu-id="f5cbc-315">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="f5cbc-315">See also</span></span>

<dl> <dt>

[<span data-ttu-id="f5cbc-316">SSPI-Funktionen</span><span class="sxs-lookup"><span data-stu-id="f5cbc-316">SSPI Functions</span></span>](authentication-functions.md#sspi-functions)
</dt> <dt>

[<span data-ttu-id="f5cbc-317">**Akzeptsecuritycontext (SChannel)**</span><span class="sxs-lookup"><span data-stu-id="f5cbc-317">**AcceptSecurityContext (Schannel)**</span></span>](acceptsecuritycontext--schannel.md)
</dt> <dt>

[<span data-ttu-id="f5cbc-318">**AcquireCredentialsHandle (SChannel)**</span><span class="sxs-lookup"><span data-stu-id="f5cbc-318">**AcquireCredentialsHandle (Schannel)**</span></span>](acquirecredentialshandle--schannel.md)
</dt> <dt>

[<span data-ttu-id="f5cbc-319">**CompleteAuthToken**</span><span class="sxs-lookup"><span data-stu-id="f5cbc-319">**CompleteAuthToken**</span></span>](/windows/win32/api/sspi/nf-sspi-completeauthtoken)
</dt> <dt>

[<span data-ttu-id="f5cbc-320">**Delta Context-Kontext**</span><span class="sxs-lookup"><span data-stu-id="f5cbc-320">**DeleteSecurityContext**</span></span>](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext)
</dt> <dt>

[<span data-ttu-id="f5cbc-321">**Freecontextbuffer**</span><span class="sxs-lookup"><span data-stu-id="f5cbc-321">**FreeContextBuffer**</span></span>](/windows/win32/api/sspi/nf-sspi-freecontextbuffer)
</dt> <dt>

[<span data-ttu-id="f5cbc-322">**Secbuffer**</span><span class="sxs-lookup"><span data-stu-id="f5cbc-322">**SecBuffer**</span></span>](/windows/win32/api/sspi/ns-sspi-secbuffer)
</dt> <dt>

[<span data-ttu-id="f5cbc-323">**Secbufferdebug**</span><span class="sxs-lookup"><span data-stu-id="f5cbc-323">**SecBufferDesc**</span></span>](/windows/win32/api/sspi/ns-sspi-secbufferdesc)
</dt> </dl>

 

 
